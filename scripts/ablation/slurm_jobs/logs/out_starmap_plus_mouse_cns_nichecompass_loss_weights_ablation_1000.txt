None
Run timestamp: 03072023_131347_1000.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_1000']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9530; val_auprc_score: 0.9493; val_best_acc_score: 0.8855; val_best_f1_score: 0.8864; train_kl_reg_loss: 713.5640; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13462.1751; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14175.7390; train_optim_loss: 14175.7390; val_kl_reg_loss: 896.8243; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11668.5506; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12565.3749; val_optim_loss: 12565.3749
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9642; val_auprc_score: 0.9605; val_best_acc_score: 0.9048; val_best_f1_score: 0.9052; train_kl_reg_loss: 891.0041; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 11347.4585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12238.4626; train_optim_loss: 12238.4626; val_kl_reg_loss: 808.2795; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10833.3995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11641.6790; val_optim_loss: 11641.6790
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9664; val_auprc_score: 0.9634; val_best_acc_score: 0.9086; val_best_f1_score: 0.9090; train_kl_reg_loss: 817.5527; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10791.8581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11609.4109; train_optim_loss: 11609.4109; val_kl_reg_loss: 775.1511; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10423.4336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11198.5847; val_optim_loss: 11198.5847
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9692; val_auprc_score: 0.9676; val_best_acc_score: 0.9120; val_best_f1_score: 0.9123; train_kl_reg_loss: 764.7345; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10513.7039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11278.4383; train_optim_loss: 11278.4383; val_kl_reg_loss: 706.5863; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10238.2819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10944.8682; val_optim_loss: 10944.8682
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9698; val_auprc_score: 0.9686; val_best_acc_score: 0.9112; val_best_f1_score: 0.9121; train_kl_reg_loss: 728.5779; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10324.7071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11053.2850; train_optim_loss: 11053.2850; val_kl_reg_loss: 695.9077; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10059.5213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10755.4290; val_optim_loss: 10755.4290
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9702; val_auprc_score: 0.9689; val_best_acc_score: 0.9106; val_best_f1_score: 0.9117; train_kl_reg_loss: 703.9509; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10180.8711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10884.8221; train_optim_loss: 10884.8221; val_kl_reg_loss: 669.2495; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9925.0047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10594.2542; val_optim_loss: 10594.2542
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9700; val_auprc_score: 0.9693; val_best_acc_score: 0.9102; val_best_f1_score: 0.9100; train_kl_reg_loss: 687.3741; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10079.6618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10767.0359; train_optim_loss: 10767.0359; val_kl_reg_loss: 654.4263; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9876.1389; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10530.5653; val_optim_loss: 10530.5653
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9701; val_auprc_score: 0.9689; val_best_acc_score: 0.9104; val_best_f1_score: 0.9113; train_kl_reg_loss: 675.2530; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9984.6955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10659.9486; train_optim_loss: 10659.9486; val_kl_reg_loss: 644.5621; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9765.7719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10410.3339; val_optim_loss: 10410.3339
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9698; val_auprc_score: 0.9686; val_best_acc_score: 0.9102; val_best_f1_score: 0.9113; train_kl_reg_loss: 666.5939; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9895.8923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10562.4862; train_optim_loss: 10562.4862; val_kl_reg_loss: 645.2109; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9724.9249; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10370.1358; val_optim_loss: 10370.1358
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9695; val_auprc_score: 0.9686; val_best_acc_score: 0.9090; val_best_f1_score: 0.9099; train_kl_reg_loss: 660.6665; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9827.8905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10488.5570; train_optim_loss: 10488.5570; val_kl_reg_loss: 649.5116; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9656.0354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10305.5470; val_optim_loss: 10305.5470
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9695; val_auprc_score: 0.9687; val_best_acc_score: 0.9088; val_best_f1_score: 0.9101; train_kl_reg_loss: 656.3340; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9762.2093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10418.5434; train_optim_loss: 10418.5434; val_kl_reg_loss: 631.8472; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9600.9866; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10232.8336; val_optim_loss: 10232.8336
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9698; val_auprc_score: 0.9695; val_best_acc_score: 0.9092; val_best_f1_score: 0.9089; train_kl_reg_loss: 653.6918; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9711.6995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10365.3913; train_optim_loss: 10365.3913; val_kl_reg_loss: 630.4108; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9560.9830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10191.3938; val_optim_loss: 10191.3938
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9705; val_auprc_score: 0.9707; val_best_acc_score: 0.9106; val_best_f1_score: 0.9114; train_kl_reg_loss: 652.1123; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9662.8718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10314.9841; train_optim_loss: 10314.9841; val_kl_reg_loss: 634.9130; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9549.4005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10184.3135; val_optim_loss: 10184.3135
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9694; val_auprc_score: 0.9694; val_best_acc_score: 0.9083; val_best_f1_score: 0.9085; train_kl_reg_loss: 650.6694; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9623.1504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10273.8199; train_optim_loss: 10273.8199; val_kl_reg_loss: 633.1147; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9512.6276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10145.7422; val_optim_loss: 10145.7422
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9710; val_auprc_score: 0.9713; val_best_acc_score: 0.9105; val_best_f1_score: 0.9113; train_kl_reg_loss: 649.8868; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9581.7930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10231.6798; train_optim_loss: 10231.6798; val_kl_reg_loss: 628.9619; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9465.9266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10094.8885; val_optim_loss: 10094.8885
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9698; val_auprc_score: 0.9704; val_best_acc_score: 0.9098; val_best_f1_score: 0.9101; train_kl_reg_loss: 650.0727; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9539.2645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10189.3372; train_optim_loss: 10189.3372; val_kl_reg_loss: 642.0321; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9444.0325; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10086.0646; val_optim_loss: 10086.0646
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9707; val_auprc_score: 0.9712; val_best_acc_score: 0.9109; val_best_f1_score: 0.9113; train_kl_reg_loss: 651.2142; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9521.9584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10173.1726; train_optim_loss: 10173.1726; val_kl_reg_loss: 630.3214; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9430.7975; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10061.1189; val_optim_loss: 10061.1189
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9703; val_auprc_score: 0.9708; val_best_acc_score: 0.9113; val_best_f1_score: 0.9111; train_kl_reg_loss: 652.1921; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9490.3593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10142.5514; train_optim_loss: 10142.5514; val_kl_reg_loss: 643.6342; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9399.0406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10042.6747; val_optim_loss: 10042.6747
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9701; val_auprc_score: 0.9711; val_best_acc_score: 0.9100; val_best_f1_score: 0.9107; train_kl_reg_loss: 653.2544; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9463.4310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10116.6854; train_optim_loss: 10116.6854; val_kl_reg_loss: 633.0954; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9410.0529; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10043.1484; val_optim_loss: 10043.1484
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9698; val_auprc_score: 0.9706; val_best_acc_score: 0.9095; val_best_f1_score: 0.9098; train_kl_reg_loss: 655.7310; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9441.7705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10097.5015; train_optim_loss: 10097.5015; val_kl_reg_loss: 644.9974; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9390.8084; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10035.8057; val_optim_loss: 10035.8057
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9698; val_auprc_score: 0.9707; val_best_acc_score: 0.9104; val_best_f1_score: 0.9099; train_kl_reg_loss: 658.0312; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9413.1392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10071.1704; train_optim_loss: 10071.1704; val_kl_reg_loss: 642.0984; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9374.3639; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10016.4624; val_optim_loss: 10016.4624
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9702; val_auprc_score: 0.9719; val_best_acc_score: 0.9105; val_best_f1_score: 0.9092; train_kl_reg_loss: 659.4120; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9391.2533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10050.6653; train_optim_loss: 10050.6653; val_kl_reg_loss: 641.1710; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9371.6679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10012.8389; val_optim_loss: 10012.8389
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9695; val_auprc_score: 0.9708; val_best_acc_score: 0.9092; val_best_f1_score: 0.9091; train_kl_reg_loss: 661.4148; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9376.1891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10037.6039; train_optim_loss: 10037.6039; val_kl_reg_loss: 641.3854; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9351.6275; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9993.0130; val_optim_loss: 9993.0130
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9701; val_auprc_score: 0.9712; val_best_acc_score: 0.9108; val_best_f1_score: 0.9104; train_kl_reg_loss: 663.5963; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9358.7422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10022.3384; train_optim_loss: 10022.3384; val_kl_reg_loss: 658.7480; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9338.3509; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9997.0988; val_optim_loss: 9997.0988
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9711; val_auprc_score: 0.9727; val_best_acc_score: 0.9125; val_best_f1_score: 0.9119; train_kl_reg_loss: 666.0174; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9344.5308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10010.5482; train_optim_loss: 10010.5482; val_kl_reg_loss: 649.6105; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9339.7201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9989.3305; val_optim_loss: 9989.3305
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9695; val_auprc_score: 0.9701; val_best_acc_score: 0.9100; val_best_f1_score: 0.9099; train_kl_reg_loss: 667.8266; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9324.1771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9992.0037; train_optim_loss: 9992.0037; val_kl_reg_loss: 656.0143; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9328.6705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9984.6849; val_optim_loss: 9984.6849
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9701; val_auprc_score: 0.9715; val_best_acc_score: 0.9104; val_best_f1_score: 0.9099; train_kl_reg_loss: 669.9166; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9308.5607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9978.4773; train_optim_loss: 9978.4773; val_kl_reg_loss: 662.3403; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9343.5681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10005.9083; val_optim_loss: 10005.9083
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9704; val_auprc_score: 0.9709; val_best_acc_score: 0.9127; val_best_f1_score: 0.9123; train_kl_reg_loss: 672.5414; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9296.1268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9968.6681; train_optim_loss: 9968.6681; val_kl_reg_loss: 661.5303; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9322.2433; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9983.7736; val_optim_loss: 9983.7736
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9698; val_auprc_score: 0.9718; val_best_acc_score: 0.9106; val_best_f1_score: 0.9101; train_kl_reg_loss: 674.4226; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9276.4383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9950.8609; train_optim_loss: 9950.8609; val_kl_reg_loss: 664.8944; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9328.7228; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9993.6174; val_optim_loss: 9993.6174
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9696; val_auprc_score: 0.9710; val_best_acc_score: 0.9097; val_best_f1_score: 0.9097; train_kl_reg_loss: 677.1552; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9274.5469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9951.7021; train_optim_loss: 9951.7021; val_kl_reg_loss: 666.5867; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9326.0870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9992.6737; val_optim_loss: 9992.6737
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9686; val_auprc_score: 0.9701; val_best_acc_score: 0.9092; val_best_f1_score: 0.9087; train_kl_reg_loss: 678.6174; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9247.7096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9926.3271; train_optim_loss: 9926.3271; val_kl_reg_loss: 664.4716; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9319.5335; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9984.0051; val_optim_loss: 9984.0051
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9695; val_auprc_score: 0.9711; val_best_acc_score: 0.9112; val_best_f1_score: 0.9105; train_kl_reg_loss: 680.5726; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9240.7746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9921.3472; train_optim_loss: 9921.3472; val_kl_reg_loss: 665.5191; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9316.3511; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9981.8703; val_optim_loss: 9981.8703
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9696; val_auprc_score: 0.9712; val_best_acc_score: 0.9108; val_best_f1_score: 0.9098; train_kl_reg_loss: 683.3036; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9236.6231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9919.9267; train_optim_loss: 9919.9267; val_kl_reg_loss: 667.0186; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9327.0978; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9994.1164; val_optim_loss: 9994.1164
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9687; val_auprc_score: 0.9708; val_best_acc_score: 0.9099; val_best_f1_score: 0.9086; train_kl_reg_loss: 685.1401; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9229.5080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9914.6481; train_optim_loss: 9914.6481; val_kl_reg_loss: 675.0265; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9346.2768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10021.3034; val_optim_loss: 10021.3034
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9696; val_auprc_score: 0.9717; val_best_acc_score: 0.9129; val_best_f1_score: 0.9119; train_kl_reg_loss: 687.4658; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9214.8120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9902.2779; train_optim_loss: 9902.2779; val_kl_reg_loss: 676.3227; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9334.7498; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10011.0724; val_optim_loss: 10011.0724
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9694; val_auprc_score: 0.9714; val_best_acc_score: 0.9122; val_best_f1_score: 0.9112; train_kl_reg_loss: 689.2399; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9206.9002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9896.1401; train_optim_loss: 9896.1401; val_kl_reg_loss: 677.4729; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9356.0507; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10033.5236; val_optim_loss: 10033.5236

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9695; val_auprc_score: 0.9713; val_best_acc_score: 0.9114; val_best_f1_score: 0.9113; train_kl_reg_loss: 685.7869; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9147.9613; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9833.7483; train_optim_loss: 9833.7483; val_kl_reg_loss: 668.8983; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9292.5889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9961.4873; val_optim_loss: 9961.4873
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9698; val_auprc_score: 0.9720; val_best_acc_score: 0.9110; val_best_f1_score: 0.9108; train_kl_reg_loss: 685.9015; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9142.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9828.6098; train_optim_loss: 9828.6098; val_kl_reg_loss: 671.2249; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9296.8588; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9968.0837; val_optim_loss: 9968.0837
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9706; val_auprc_score: 0.9730; val_best_acc_score: 0.9127; val_best_f1_score: 0.9121; train_kl_reg_loss: 686.7197; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9136.0034; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9822.7231; train_optim_loss: 9822.7231; val_kl_reg_loss: 669.2125; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9288.3277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9957.5402; val_optim_loss: 9957.5402
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9700; val_auprc_score: 0.9722; val_best_acc_score: 0.9127; val_best_f1_score: 0.9123; train_kl_reg_loss: 686.9871; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9140.9061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9827.8933; train_optim_loss: 9827.8933; val_kl_reg_loss: 673.5676; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9307.9364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9981.5041; val_optim_loss: 9981.5041
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9702; val_auprc_score: 0.9724; val_best_acc_score: 0.9123; val_best_f1_score: 0.9118; train_kl_reg_loss: 687.3671; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9137.6989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9825.0660; train_optim_loss: 9825.0660; val_kl_reg_loss: 671.5960; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9306.9262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9978.5221; val_optim_loss: 9978.5221
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9693; val_auprc_score: 0.9717; val_best_acc_score: 0.9102; val_best_f1_score: 0.9098; train_kl_reg_loss: 687.4789; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9137.5233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9825.0021; train_optim_loss: 9825.0021; val_kl_reg_loss: 675.2079; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9293.1309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9968.3390; val_optim_loss: 9968.3390
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9694; val_auprc_score: 0.9714; val_best_acc_score: 0.9117; val_best_f1_score: 0.9112; train_kl_reg_loss: 687.8627; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9129.0247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9816.8874; train_optim_loss: 9816.8874; val_kl_reg_loss: 671.3967; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9296.0955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9967.4921; val_optim_loss: 9967.4921

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9692; val_auprc_score: 0.9714; val_best_acc_score: 0.9107; val_best_f1_score: 0.9101; train_kl_reg_loss: 686.8084; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9119.8319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9806.6403; train_optim_loss: 9806.6403; val_kl_reg_loss: 671.8156; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9264.1131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9935.9285; val_optim_loss: 9935.9285
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9688; val_auprc_score: 0.9711; val_best_acc_score: 0.9112; val_best_f1_score: 0.9105; train_kl_reg_loss: 686.9802; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9125.9172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9812.8974; train_optim_loss: 9812.8974; val_kl_reg_loss: 672.4809; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9288.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9960.9887; val_optim_loss: 9960.9887
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9704; val_auprc_score: 0.9730; val_best_acc_score: 0.9123; val_best_f1_score: 0.9115; train_kl_reg_loss: 687.2955; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9121.5256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9808.8212; train_optim_loss: 9808.8212; val_kl_reg_loss: 672.7610; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9278.7236; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9951.4844; val_optim_loss: 9951.4844
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9694; val_auprc_score: 0.9710; val_best_acc_score: 0.9114; val_best_f1_score: 0.9107; train_kl_reg_loss: 687.2470; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9127.2128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9814.4598; train_optim_loss: 9814.4598; val_kl_reg_loss: 673.3880; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9322.5685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9995.9566; val_optim_loss: 9995.9566
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9687; val_auprc_score: 0.9702; val_best_acc_score: 0.9104; val_best_f1_score: 0.9098; train_kl_reg_loss: 687.4750; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9126.8200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9814.2949; train_optim_loss: 9814.2949; val_kl_reg_loss: 673.4739; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9318.2788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9991.7528; val_optim_loss: 9991.7528

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9690; val_auprc_score: 0.9711; val_best_acc_score: 0.9110; val_best_f1_score: 0.9103; train_kl_reg_loss: 687.9308; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9128.8422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9816.7729; train_optim_loss: 9816.7729; val_kl_reg_loss: 672.2211; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9288.9543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9961.1754; val_optim_loss: 9961.1754
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9693; val_auprc_score: 0.9715; val_best_acc_score: 0.9114; val_best_f1_score: 0.9106; train_kl_reg_loss: 687.6451; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9122.2864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9809.9315; train_optim_loss: 9809.9315; val_kl_reg_loss: 672.6548; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9288.0924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9960.7471; val_optim_loss: 9960.7471
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9696; val_auprc_score: 0.9721; val_best_acc_score: 0.9112; val_best_f1_score: 0.9104; train_kl_reg_loss: 687.3486; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9124.2953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9811.6439; train_optim_loss: 9811.6439; val_kl_reg_loss: 672.5448; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9297.8993; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9970.4442; val_optim_loss: 9970.4442
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9693; val_auprc_score: 0.9718; val_best_acc_score: 0.9110; val_best_f1_score: 0.9103; train_kl_reg_loss: 687.3577; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9126.0435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9813.4013; train_optim_loss: 9813.4013; val_kl_reg_loss: 672.6790; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9310.3892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9983.0683; val_optim_loss: 9983.0683

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 52 min 16 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
Val AUROC score: 0.9696
Val AUPRC score: 0.9723
Val best accuracy score: 0.9115
Val best F1 score: 0.9108
Val gene expr MSE score: 0.6934

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
