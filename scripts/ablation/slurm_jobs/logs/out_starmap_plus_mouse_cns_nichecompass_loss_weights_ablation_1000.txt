None
Run timestamp: 16072023_134919_1000.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_1000']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1818, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1818, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9706; val_auprc_score: 0.9541; val_best_acc_score: 0.9317; val_best_f1_score: 0.9337; train_kl_reg_loss: 13331.6613; train_edge_recon_loss: 2755911.8997; train_gene_expr_recon_loss: 2098018.9473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4867262.4896; train_optim_loss: 4867262.4896; val_kl_reg_loss: 13971.4137; val_edge_recon_loss: 2645530.8295; val_gene_expr_recon_loss: 2011810.1364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4671312.3864; val_optim_loss: 4671312.3864
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9758; val_auprc_score: 0.9628; val_best_acc_score: 0.9423; val_best_f1_score: 0.9440; train_kl_reg_loss: 13575.2006; train_edge_recon_loss: 2603695.0013; train_gene_expr_recon_loss: 1976278.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4593548.2708; train_optim_loss: 4593548.2708; val_kl_reg_loss: 12124.3880; val_edge_recon_loss: 2627716.4091; val_gene_expr_recon_loss: 1959290.9943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4599131.7727; val_optim_loss: 4599131.7727
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9789; val_auprc_score: 0.9671; val_best_acc_score: 0.9493; val_best_f1_score: 0.9508; train_kl_reg_loss: 13178.4702; train_edge_recon_loss: 2593327.3841; train_gene_expr_recon_loss: 1934161.5046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4540667.3594; train_optim_loss: 4540667.3594; val_kl_reg_loss: 12967.7752; val_edge_recon_loss: 2627586.9545; val_gene_expr_recon_loss: 1921379.0511; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4561933.7273; val_optim_loss: 4561933.7273
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9805; val_auprc_score: 0.9712; val_best_acc_score: 0.9515; val_best_f1_score: 0.9525; train_kl_reg_loss: 13166.8061; train_edge_recon_loss: 2584597.6016; train_gene_expr_recon_loss: 1901279.5059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4499043.9167; train_optim_loss: 4499043.9167; val_kl_reg_loss: 13389.8094; val_edge_recon_loss: 2620372.7045; val_gene_expr_recon_loss: 1888623.1364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4522385.5909; val_optim_loss: 4522385.5909
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9794; val_auprc_score: 0.9684; val_best_acc_score: 0.9516; val_best_f1_score: 0.9529; train_kl_reg_loss: 13315.4563; train_edge_recon_loss: 2581372.2422; train_gene_expr_recon_loss: 1869005.8704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4463693.5573; train_optim_loss: 4463693.5573; val_kl_reg_loss: 10973.7840; val_edge_recon_loss: 2622790.7727; val_gene_expr_recon_loss: 1878592.5284; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4512357.0909; val_optim_loss: 4512357.0909
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9815; val_auprc_score: 0.9720; val_best_acc_score: 0.9534; val_best_f1_score: 0.9546; train_kl_reg_loss: 13784.5429; train_edge_recon_loss: 2582788.7122; train_gene_expr_recon_loss: 1841581.2637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4438154.5339; train_optim_loss: 4438154.5339; val_kl_reg_loss: 13339.1891; val_edge_recon_loss: 2613773.8636; val_gene_expr_recon_loss: 1833164.7784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4460277.8636; val_optim_loss: 4460277.8636
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9816; val_auprc_score: 0.9720; val_best_acc_score: 0.9559; val_best_f1_score: 0.9571; train_kl_reg_loss: 13275.2784; train_edge_recon_loss: 2579577.1016; train_gene_expr_recon_loss: 1811097.7285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4403950.0938; train_optim_loss: 4403950.0938; val_kl_reg_loss: 12961.5296; val_edge_recon_loss: 2612605.2614; val_gene_expr_recon_loss: 1805328.1136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4430894.9773; val_optim_loss: 4430894.9773
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9801; val_auprc_score: 0.9695; val_best_acc_score: 0.9539; val_best_f1_score: 0.9552; train_kl_reg_loss: 13261.6551; train_edge_recon_loss: 2579467.1185; train_gene_expr_recon_loss: 1784694.9290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4377423.7292; train_optim_loss: 4377423.7292; val_kl_reg_loss: 12876.4605; val_edge_recon_loss: 2616756.2841; val_gene_expr_recon_loss: 1789627.3295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4419260.1136; val_optim_loss: 4419260.1136
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9806; val_auprc_score: 0.9703; val_best_acc_score: 0.9557; val_best_f1_score: 0.9569; train_kl_reg_loss: 13331.5140; train_edge_recon_loss: 2577948.5482; train_gene_expr_recon_loss: 1761685.2077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4352965.2917; train_optim_loss: 4352965.2917; val_kl_reg_loss: 12866.8196; val_edge_recon_loss: 2613556.9773; val_gene_expr_recon_loss: 1781542.5398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4407966.3182; val_optim_loss: 4407966.3182
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9801; val_auprc_score: 0.9691; val_best_acc_score: 0.9532; val_best_f1_score: 0.9546; train_kl_reg_loss: 13112.4043; train_edge_recon_loss: 2578920.6354; train_gene_expr_recon_loss: 1736803.7773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4328836.8333; train_optim_loss: 4328836.8333; val_kl_reg_loss: 13134.8001; val_edge_recon_loss: 2615113.6932; val_gene_expr_recon_loss: 1751192.3352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4379440.7955; val_optim_loss: 4379440.7955
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9811; val_auprc_score: 0.9698; val_best_acc_score: 0.9553; val_best_f1_score: 0.9566; train_kl_reg_loss: 13204.2773; train_edge_recon_loss: 2577496.4531; train_gene_expr_recon_loss: 1717623.8229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4308324.5547; train_optim_loss: 4308324.5547; val_kl_reg_loss: 12406.4570; val_edge_recon_loss: 2613221.0000; val_gene_expr_recon_loss: 1734032.6023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4359660.0682; val_optim_loss: 4359660.0682
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9815; val_auprc_score: 0.9718; val_best_acc_score: 0.9563; val_best_f1_score: 0.9576; train_kl_reg_loss: 13239.4776; train_edge_recon_loss: 2576112.3659; train_gene_expr_recon_loss: 1700412.8014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4289764.6536; train_optim_loss: 4289764.6536; val_kl_reg_loss: 13440.0236; val_edge_recon_loss: 2608244.1591; val_gene_expr_recon_loss: 1723314.8352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4344999.0682; val_optim_loss: 4344999.0682
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9816; val_auprc_score: 0.9720; val_best_acc_score: 0.9570; val_best_f1_score: 0.9581; train_kl_reg_loss: 13299.5307; train_edge_recon_loss: 2577243.0521; train_gene_expr_recon_loss: 1685662.6100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4276205.2109; train_optim_loss: 4276205.2109; val_kl_reg_loss: 12804.7554; val_edge_recon_loss: 2610976.5341; val_gene_expr_recon_loss: 1728386.5795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4352167.8636; val_optim_loss: 4352167.8636
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9825; val_auprc_score: 0.9737; val_best_acc_score: 0.9583; val_best_f1_score: 0.9594; train_kl_reg_loss: 13377.0200; train_edge_recon_loss: 2574231.8919; train_gene_expr_recon_loss: 1675105.0059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4262713.8971; train_optim_loss: 4262713.8971; val_kl_reg_loss: 13294.6214; val_edge_recon_loss: 2603445.8068; val_gene_expr_recon_loss: 1715472.9886; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4332213.5000; val_optim_loss: 4332213.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9807; val_auprc_score: 0.9706; val_best_acc_score: 0.9567; val_best_f1_score: 0.9580; train_kl_reg_loss: 13515.8373; train_edge_recon_loss: 2573120.2083; train_gene_expr_recon_loss: 1661131.5052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4247767.5417; train_optim_loss: 4247767.5417; val_kl_reg_loss: 12890.6861; val_edge_recon_loss: 2609698.5227; val_gene_expr_recon_loss: 1700110.8523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4322700.0227; val_optim_loss: 4322700.0227
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9823; val_auprc_score: 0.9726; val_best_acc_score: 0.9576; val_best_f1_score: 0.9587; train_kl_reg_loss: 13532.9929; train_edge_recon_loss: 2574825.4766; train_gene_expr_recon_loss: 1652222.4414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4240580.9049; train_optim_loss: 4240580.9049; val_kl_reg_loss: 13339.5310; val_edge_recon_loss: 2609426.1364; val_gene_expr_recon_loss: 1691786.3295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4314552.0227; val_optim_loss: 4314552.0227
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9820; val_auprc_score: 0.9733; val_best_acc_score: 0.9581; val_best_f1_score: 0.9593; train_kl_reg_loss: 13576.5052; train_edge_recon_loss: 2574551.2721; train_gene_expr_recon_loss: 1644697.4460; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4232825.2174; train_optim_loss: 4232825.2174; val_kl_reg_loss: 13116.0050; val_edge_recon_loss: 2604524.5455; val_gene_expr_recon_loss: 1686722.5966; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4304363.1591; val_optim_loss: 4304363.1591
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9816; val_auprc_score: 0.9725; val_best_acc_score: 0.9563; val_best_f1_score: 0.9577; train_kl_reg_loss: 13645.7780; train_edge_recon_loss: 2573233.0443; train_gene_expr_recon_loss: 1637103.7826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4223982.6133; train_optim_loss: 4223982.6133; val_kl_reg_loss: 13122.3802; val_edge_recon_loss: 2608468.2159; val_gene_expr_recon_loss: 1679443.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4301033.6364; val_optim_loss: 4301033.6364
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9807; val_auprc_score: 0.9706; val_best_acc_score: 0.9572; val_best_f1_score: 0.9584; train_kl_reg_loss: 13719.6851; train_edge_recon_loss: 2573207.0846; train_gene_expr_recon_loss: 1631809.6504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4218736.4154; train_optim_loss: 4218736.4154; val_kl_reg_loss: 13306.2310; val_edge_recon_loss: 2608444.1591; val_gene_expr_recon_loss: 1673403.9034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4295154.3636; val_optim_loss: 4295154.3636
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9814; val_auprc_score: 0.9714; val_best_acc_score: 0.9575; val_best_f1_score: 0.9587; train_kl_reg_loss: 13741.5665; train_edge_recon_loss: 2573304.2057; train_gene_expr_recon_loss: 1626144.7350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4213190.5052; train_optim_loss: 4213190.5052; val_kl_reg_loss: 13354.2459; val_edge_recon_loss: 2603899.2955; val_gene_expr_recon_loss: 1668665.2614; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4285918.8750; val_optim_loss: 4285918.8750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9811; val_auprc_score: 0.9710; val_best_acc_score: 0.9581; val_best_f1_score: 0.9593; train_kl_reg_loss: 13793.0599; train_edge_recon_loss: 2572164.9974; train_gene_expr_recon_loss: 1621475.0807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4207433.1380; train_optim_loss: 4207433.1380; val_kl_reg_loss: 13660.3740; val_edge_recon_loss: 2602588.4545; val_gene_expr_recon_loss: 1671223.3011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4287472.0909; val_optim_loss: 4287472.0909
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9827; val_auprc_score: 0.9742; val_best_acc_score: 0.9591; val_best_f1_score: 0.9603; train_kl_reg_loss: 13865.5323; train_edge_recon_loss: 2569166.0885; train_gene_expr_recon_loss: 1614826.4902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4197858.1107; train_optim_loss: 4197858.1107; val_kl_reg_loss: 13677.4107; val_edge_recon_loss: 2600438.3295; val_gene_expr_recon_loss: 1670792.5739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4284908.2955; val_optim_loss: 4284908.2955
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9808; val_auprc_score: 0.9708; val_best_acc_score: 0.9582; val_best_f1_score: 0.9594; train_kl_reg_loss: 13900.0187; train_edge_recon_loss: 2570602.2214; train_gene_expr_recon_loss: 1610639.0488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4195141.2773; train_optim_loss: 4195141.2773; val_kl_reg_loss: 13704.1350; val_edge_recon_loss: 2604208.3295; val_gene_expr_recon_loss: 1664063.1193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4281975.6136; val_optim_loss: 4281975.6136
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9820; val_auprc_score: 0.9732; val_best_acc_score: 0.9583; val_best_f1_score: 0.9595; train_kl_reg_loss: 13932.5677; train_edge_recon_loss: 2570806.6719; train_gene_expr_recon_loss: 1607543.2773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4192282.5286; train_optim_loss: 4192282.5286; val_kl_reg_loss: 13540.0621; val_edge_recon_loss: 2601515.1136; val_gene_expr_recon_loss: 1663288.2727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4278343.4545; val_optim_loss: 4278343.4545
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9821; val_auprc_score: 0.9735; val_best_acc_score: 0.9585; val_best_f1_score: 0.9597; train_kl_reg_loss: 13941.4216; train_edge_recon_loss: 2568438.6745; train_gene_expr_recon_loss: 1605946.0111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4188326.1055; train_optim_loss: 4188326.1055; val_kl_reg_loss: 12895.0277; val_edge_recon_loss: 2600543.3636; val_gene_expr_recon_loss: 1681887.3807; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4295325.8182; val_optim_loss: 4295325.8182
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9823; val_auprc_score: 0.9733; val_best_acc_score: 0.9591; val_best_f1_score: 0.9602; train_kl_reg_loss: 14077.7720; train_edge_recon_loss: 2569477.5208; train_gene_expr_recon_loss: 1600174.0736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4183729.3516; train_optim_loss: 4183729.3516; val_kl_reg_loss: 13845.6616; val_edge_recon_loss: 2603973.8977; val_gene_expr_recon_loss: 1656865.9432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4274685.5227; val_optim_loss: 4274685.5227
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9825; val_auprc_score: 0.9740; val_best_acc_score: 0.9601; val_best_f1_score: 0.9612; train_kl_reg_loss: 14039.2442; train_edge_recon_loss: 2568870.8203; train_gene_expr_recon_loss: 1597752.4264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4180662.4909; train_optim_loss: 4180662.4909; val_kl_reg_loss: 13589.9684; val_edge_recon_loss: 2600636.7500; val_gene_expr_recon_loss: 1658454.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4272681.3182; val_optim_loss: 4272681.3182
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9811; val_auprc_score: 0.9710; val_best_acc_score: 0.9581; val_best_f1_score: 0.9592; train_kl_reg_loss: 14069.6003; train_edge_recon_loss: 2568286.7630; train_gene_expr_recon_loss: 1595434.9056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4177791.2656; train_optim_loss: 4177791.2656; val_kl_reg_loss: 13726.7917; val_edge_recon_loss: 2606257.0000; val_gene_expr_recon_loss: 1666431.2727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4286415.1136; val_optim_loss: 4286415.1136
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9815; val_auprc_score: 0.9719; val_best_acc_score: 0.9598; val_best_f1_score: 0.9610; train_kl_reg_loss: 14112.7595; train_edge_recon_loss: 2568294.8151; train_gene_expr_recon_loss: 1591923.3444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4174330.9102; train_optim_loss: 4174330.9102; val_kl_reg_loss: 14026.0062; val_edge_recon_loss: 2599147.7045; val_gene_expr_recon_loss: 1658275.1989; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4271448.9545; val_optim_loss: 4271448.9545
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9826; val_auprc_score: 0.9736; val_best_acc_score: 0.9600; val_best_f1_score: 0.9610; train_kl_reg_loss: 14130.3181; train_edge_recon_loss: 2567135.7344; train_gene_expr_recon_loss: 1591075.9414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4172342.0091; train_optim_loss: 4172342.0091; val_kl_reg_loss: 13946.6659; val_edge_recon_loss: 2596285.2045; val_gene_expr_recon_loss: 1656140.7102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4266372.6136; val_optim_loss: 4266372.6136
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9829; val_auprc_score: 0.9745; val_best_acc_score: 0.9606; val_best_f1_score: 0.9616; train_kl_reg_loss: 14156.5038; train_edge_recon_loss: 2567349.6953; train_gene_expr_recon_loss: 1587979.9486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4169486.1484; train_optim_loss: 4169486.1484; val_kl_reg_loss: 13848.6822; val_edge_recon_loss: 2595817.5000; val_gene_expr_recon_loss: 1654730.0682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4264396.2500; val_optim_loss: 4264396.2500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9828; val_auprc_score: 0.9755; val_best_acc_score: 0.9601; val_best_f1_score: 0.9612; train_kl_reg_loss: 14186.6315; train_edge_recon_loss: 2569171.3138; train_gene_expr_recon_loss: 1586428.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4169786.8216; train_optim_loss: 4169786.8216; val_kl_reg_loss: 13739.9813; val_edge_recon_loss: 2599023.6250; val_gene_expr_recon_loss: 1658096.6932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4270860.2500; val_optim_loss: 4270860.2500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9836; val_auprc_score: 0.9751; val_best_acc_score: 0.9617; val_best_f1_score: 0.9627; train_kl_reg_loss: 14217.5755; train_edge_recon_loss: 2567574.2865; train_gene_expr_recon_loss: 1585393.7383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4167185.5977; train_optim_loss: 4167185.5977; val_kl_reg_loss: 13919.1630; val_edge_recon_loss: 2591774.3977; val_gene_expr_recon_loss: 1655048.8977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4260742.5000; val_optim_loss: 4260742.5000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9828; val_auprc_score: 0.9739; val_best_acc_score: 0.9605; val_best_f1_score: 0.9616; train_kl_reg_loss: 14243.2289; train_edge_recon_loss: 2567021.7083; train_gene_expr_recon_loss: 1583559.4427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4164824.3724; train_optim_loss: 4164824.3724; val_kl_reg_loss: 13969.3912; val_edge_recon_loss: 2593868.1477; val_gene_expr_recon_loss: 1652819.5341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4260657.0114; val_optim_loss: 4260657.0114
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9814; val_auprc_score: 0.9721; val_best_acc_score: 0.9585; val_best_f1_score: 0.9596; train_kl_reg_loss: 14267.8989; train_edge_recon_loss: 2566386.6042; train_gene_expr_recon_loss: 1580466.9759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4161121.4870; train_optim_loss: 4161121.4870; val_kl_reg_loss: 13789.3461; val_edge_recon_loss: 2601563.3523; val_gene_expr_recon_loss: 1660983.7386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4276336.4545; val_optim_loss: 4276336.4545
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9824; val_auprc_score: 0.9734; val_best_acc_score: 0.9600; val_best_f1_score: 0.9612; train_kl_reg_loss: 14268.6091; train_edge_recon_loss: 2566883.2331; train_gene_expr_recon_loss: 1577992.0729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4159143.9297; train_optim_loss: 4159143.9297; val_kl_reg_loss: 13908.2845; val_edge_recon_loss: 2595561.4545; val_gene_expr_recon_loss: 1660479.8011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4269949.5455; val_optim_loss: 4269949.5455
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9836; val_auprc_score: 0.9741; val_best_acc_score: 0.9623; val_best_f1_score: 0.9632; train_kl_reg_loss: 14287.0282; train_edge_recon_loss: 2568241.3190; train_gene_expr_recon_loss: 1578652.4499; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4161180.7956; train_optim_loss: 4161180.7956; val_kl_reg_loss: 13931.1737; val_edge_recon_loss: 2589509.8636; val_gene_expr_recon_loss: 1658584.8977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4262025.9091; val_optim_loss: 4262025.9091
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9842; val_auprc_score: 0.9764; val_best_acc_score: 0.9618; val_best_f1_score: 0.9628; train_kl_reg_loss: 14317.9535; train_edge_recon_loss: 2567062.2917; train_gene_expr_recon_loss: 1576898.0527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4158278.2943; train_optim_loss: 4158278.2943; val_kl_reg_loss: 14004.7242; val_edge_recon_loss: 2590229.9318; val_gene_expr_recon_loss: 1657438.4830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4261673.1136; val_optim_loss: 4261673.1136

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9824; val_auprc_score: 0.9739; val_best_acc_score: 0.9595; val_best_f1_score: 0.9606; train_kl_reg_loss: 14384.1867; train_edge_recon_loss: 2563946.8932; train_gene_expr_recon_loss: 1552538.0143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4130869.0990; train_optim_loss: 4130869.0990; val_kl_reg_loss: 14099.4281; val_edge_recon_loss: 2593883.6136; val_gene_expr_recon_loss: 1646002.8580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4253985.8636; val_optim_loss: 4253985.8636
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9838; val_auprc_score: 0.9756; val_best_acc_score: 0.9614; val_best_f1_score: 0.9623; train_kl_reg_loss: 14412.2970; train_edge_recon_loss: 2563667.6576; train_gene_expr_recon_loss: 1551293.3118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4129373.2786; train_optim_loss: 4129373.2786; val_kl_reg_loss: 14133.5772; val_edge_recon_loss: 2589581.6136; val_gene_expr_recon_loss: 1642376.1989; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4246091.3636; val_optim_loss: 4246091.3636
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9833; val_auprc_score: 0.9746; val_best_acc_score: 0.9609; val_best_f1_score: 0.9620; train_kl_reg_loss: 14474.7448; train_edge_recon_loss: 2561175.9167; train_gene_expr_recon_loss: 1550641.0703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4126291.7357; train_optim_loss: 4126291.7357; val_kl_reg_loss: 14216.2724; val_edge_recon_loss: 2586885.7159; val_gene_expr_recon_loss: 1643423.2784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4244525.3182; val_optim_loss: 4244525.3182
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9833; val_auprc_score: 0.9743; val_best_acc_score: 0.9615; val_best_f1_score: 0.9625; train_kl_reg_loss: 14531.3038; train_edge_recon_loss: 2562532.6172; train_gene_expr_recon_loss: 1548613.3776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4125677.2943; train_optim_loss: 4125677.2943; val_kl_reg_loss: 14281.1955; val_edge_recon_loss: 2585699.3523; val_gene_expr_recon_loss: 1646903.5398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4246884.0227; val_optim_loss: 4246884.0227
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9821; val_auprc_score: 0.9732; val_best_acc_score: 0.9593; val_best_f1_score: 0.9603; train_kl_reg_loss: 14557.8570; train_edge_recon_loss: 2563687.4232; train_gene_expr_recon_loss: 1549076.1484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4127321.4336; train_optim_loss: 4127321.4336; val_kl_reg_loss: 14313.7551; val_edge_recon_loss: 2592605.4659; val_gene_expr_recon_loss: 1643177.7443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4250096.9318; val_optim_loss: 4250096.9318
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9828; val_auprc_score: 0.9740; val_best_acc_score: 0.9593; val_best_f1_score: 0.9603; train_kl_reg_loss: 14607.8898; train_edge_recon_loss: 2561344.2878; train_gene_expr_recon_loss: 1548018.8424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4123971.0117; train_optim_loss: 4123971.0117; val_kl_reg_loss: 14343.9673; val_edge_recon_loss: 2592297.2955; val_gene_expr_recon_loss: 1646150.2784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4252791.5227; val_optim_loss: 4252791.5227
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9828; val_auprc_score: 0.9746; val_best_acc_score: 0.9604; val_best_f1_score: 0.9614; train_kl_reg_loss: 14627.3670; train_edge_recon_loss: 2562390.5247; train_gene_expr_recon_loss: 1546880.4753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4123898.3763; train_optim_loss: 4123898.3763; val_kl_reg_loss: 14366.6104; val_edge_recon_loss: 2591389.6932; val_gene_expr_recon_loss: 1647861.6023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4253617.9318; val_optim_loss: 4253617.9318

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9820; val_auprc_score: 0.9731; val_best_acc_score: 0.9586; val_best_f1_score: 0.9597; train_kl_reg_loss: 14675.7244; train_edge_recon_loss: 2562175.7474; train_gene_expr_recon_loss: 1544396.1302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4121247.5938; train_optim_loss: 4121247.5938; val_kl_reg_loss: 14367.5109; val_edge_recon_loss: 2592350.9773; val_gene_expr_recon_loss: 1645503.7841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4252222.3068; val_optim_loss: 4252222.3068
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9826; val_auprc_score: 0.9734; val_best_acc_score: 0.9607; val_best_f1_score: 0.9616; train_kl_reg_loss: 14664.7986; train_edge_recon_loss: 2561517.2734; train_gene_expr_recon_loss: 1544420.6009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4120602.6784; train_optim_loss: 4120602.6784; val_kl_reg_loss: 14356.7673; val_edge_recon_loss: 2586848.7614; val_gene_expr_recon_loss: 1643897.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4245103.0455; val_optim_loss: 4245103.0455
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9828; val_auprc_score: 0.9740; val_best_acc_score: 0.9597; val_best_f1_score: 0.9608; train_kl_reg_loss: 14662.4021; train_edge_recon_loss: 2561522.0573; train_gene_expr_recon_loss: 1545182.3294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4121366.7904; train_optim_loss: 4121366.7904; val_kl_reg_loss: 14358.2883; val_edge_recon_loss: 2586914.7159; val_gene_expr_recon_loss: 1643514.9205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4244787.9545; val_optim_loss: 4244787.9545
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9837; val_auprc_score: 0.9752; val_best_acc_score: 0.9608; val_best_f1_score: 0.9619; train_kl_reg_loss: 14668.2283; train_edge_recon_loss: 2560853.6901; train_gene_expr_recon_loss: 1544552.6536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4120074.5677; train_optim_loss: 4120074.5677; val_kl_reg_loss: 14358.3426; val_edge_recon_loss: 2587984.3977; val_gene_expr_recon_loss: 1643689.1420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4246031.8864; val_optim_loss: 4246031.8864

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 53 min 6 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
Val AUROC score: 0.9814
Val AUPRC score: 0.9719
Val best accuracy score: 0.9599
Val best F1 score: 0.9609
Val gene expr MSE score: 0.5175

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
