Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9963; val_auprc_score: 0.9954; val_best_acc_score: 0.9787; val_best_f1_score: 0.9789; train_kl_reg_loss: 5796.9253; train_edge_recon_loss: 257448.6000; train_gene_expr_recon_loss: 66886.6099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330132.1352; train_optim_loss: 330132.1352; val_kl_reg_loss: 5817.0573; val_edge_recon_loss: 256948.3531; val_gene_expr_recon_loss: 66855.7506; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329621.1611; val_optim_loss: 329621.1611
None
Run timestamp: 13072023_034847_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '20', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1643088
Number of validation edges: 182565
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9891; val_auprc_score: 0.9870; val_best_acc_score: 0.9542; val_best_f1_score: 0.9550; train_kl_reg_loss: 6162.8261; train_edge_recon_loss: 265900.0258; train_gene_expr_recon_loss: 76599.3192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 348662.1711; train_optim_loss: 348662.1711; val_kl_reg_loss: 5893.4317; val_edge_recon_loss: 262111.1329; val_gene_expr_recon_loss: 71394.1885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 339398.7542; val_optim_loss: 339398.7542

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9966; val_auprc_score: 0.9957; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 5796.9338; train_edge_recon_loss: 257321.4580; train_gene_expr_recon_loss: 66407.3760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329525.7676; train_optim_loss: 329525.7676; val_kl_reg_loss: 5793.0118; val_edge_recon_loss: 256876.9869; val_gene_expr_recon_loss: 66389.1390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329059.1374; val_optim_loss: 329059.1374
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9924; val_auprc_score: 0.9909; val_best_acc_score: 0.9645; val_best_f1_score: 0.9650; train_kl_reg_loss: 5894.8881; train_edge_recon_loss: 261590.5949; train_gene_expr_recon_loss: 69718.0827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 337203.5659; train_optim_loss: 337203.5659; val_kl_reg_loss: 5876.2218; val_edge_recon_loss: 260681.2061; val_gene_expr_recon_loss: 69112.9935; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335670.4209; val_optim_loss: 335670.4209
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9967; val_auprc_score: 0.9960; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 5796.8105; train_edge_recon_loss: 257278.6743; train_gene_expr_recon_loss: 66327.2913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329402.7760; train_optim_loss: 329402.7760; val_kl_reg_loss: 5792.8264; val_edge_recon_loss: 256739.1479; val_gene_expr_recon_loss: 66288.8058; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328820.7804; val_optim_loss: 328820.7804
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9938; val_auprc_score: 0.9926; val_best_acc_score: 0.9685; val_best_f1_score: 0.9690; train_kl_reg_loss: 5837.9364; train_edge_recon_loss: 260531.1128; train_gene_expr_recon_loss: 68435.6446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 334804.6937; train_optim_loss: 334804.6937; val_kl_reg_loss: 5681.7293; val_edge_recon_loss: 260038.6286; val_gene_expr_recon_loss: 68552.3017; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334272.6593; val_optim_loss: 334272.6593
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9967; val_auprc_score: 0.9958; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 5796.0027; train_edge_recon_loss: 257187.1108; train_gene_expr_recon_loss: 66300.9022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329284.0160; train_optim_loss: 329284.0160; val_kl_reg_loss: 5785.3763; val_edge_recon_loss: 256769.8831; val_gene_expr_recon_loss: 66322.2826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328877.5415; val_optim_loss: 328877.5415
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9942; val_auprc_score: 0.9928; val_best_acc_score: 0.9703; val_best_f1_score: 0.9706; train_kl_reg_loss: 5802.5571; train_edge_recon_loss: 259991.4942; train_gene_expr_recon_loss: 67924.0804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333718.1321; train_optim_loss: 333718.1321; val_kl_reg_loss: 5845.5227; val_edge_recon_loss: 259531.5395; val_gene_expr_recon_loss: 68103.6718; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333480.7342; val_optim_loss: 333480.7342
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9967; val_auprc_score: 0.9960; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 5792.3941; train_edge_recon_loss: 257218.6573; train_gene_expr_recon_loss: 66252.3738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329263.4249; train_optim_loss: 329263.4249; val_kl_reg_loss: 5777.1951; val_edge_recon_loss: 256769.7533; val_gene_expr_recon_loss: 66282.1485; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328829.0980; val_optim_loss: 328829.0980
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9967; val_auprc_score: 0.9959; val_best_acc_score: 0.9797; val_best_f1_score: 0.9798; train_kl_reg_loss: 5790.3683; train_edge_recon_loss: 257227.9017; train_gene_expr_recon_loss: 66285.7693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329304.0392; train_optim_loss: 329304.0392; val_kl_reg_loss: 5788.0906; val_edge_recon_loss: 256801.5537; val_gene_expr_recon_loss: 66265.4063; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328855.0510; val_optim_loss: 328855.0510
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9946; val_auprc_score: 0.9933; val_best_acc_score: 0.9720; val_best_f1_score: 0.9724; train_kl_reg_loss: 5780.0991; train_edge_recon_loss: 259651.9227; train_gene_expr_recon_loss: 67642.5066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333074.5284; train_optim_loss: 333074.5284; val_kl_reg_loss: 5711.0115; val_edge_recon_loss: 258985.7819; val_gene_expr_recon_loss: 67839.6398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332536.4333; val_optim_loss: 332536.4333
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9968; val_auprc_score: 0.9960; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 5789.9537; train_edge_recon_loss: 257220.2677; train_gene_expr_recon_loss: 66267.6837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329277.9049; train_optim_loss: 329277.9049; val_kl_reg_loss: 5789.1855; val_edge_recon_loss: 256612.9452; val_gene_expr_recon_loss: 66292.0935; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328694.2235; val_optim_loss: 328694.2235
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9951; val_auprc_score: 0.9939; val_best_acc_score: 0.9742; val_best_f1_score: 0.9745; train_kl_reg_loss: 5763.4949; train_edge_recon_loss: 259348.7642; train_gene_expr_recon_loss: 67485.3149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332597.5741; train_optim_loss: 332597.5741; val_kl_reg_loss: 5837.6757; val_edge_recon_loss: 258891.5681; val_gene_expr_recon_loss: 72121.9936; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 336851.2374; val_optim_loss: 336851.2374
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9968; val_auprc_score: 0.9961; val_best_acc_score: 0.9803; val_best_f1_score: 0.9804; train_kl_reg_loss: 5786.9426; train_edge_recon_loss: 257218.1029; train_gene_expr_recon_loss: 66213.8504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329218.8958; train_optim_loss: 329218.8958; val_kl_reg_loss: 5785.4784; val_edge_recon_loss: 256670.2303; val_gene_expr_recon_loss: 66221.3864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328677.0961; val_optim_loss: 328677.0961
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9954; val_auprc_score: 0.9943; val_best_acc_score: 0.9755; val_best_f1_score: 0.9758; train_kl_reg_loss: 5757.0869; train_edge_recon_loss: 259172.5250; train_gene_expr_recon_loss: 66853.4096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331783.0215; train_optim_loss: 331783.0215; val_kl_reg_loss: 5711.6902; val_edge_recon_loss: 258570.5544; val_gene_expr_recon_loss: 67204.5659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331486.8107; val_optim_loss: 331486.8107
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9968; val_auprc_score: 0.9959; val_best_acc_score: 0.9804; val_best_f1_score: 0.9805; train_kl_reg_loss: 5788.4111; train_edge_recon_loss: 257153.8690; train_gene_expr_recon_loss: 66219.5606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329161.8406; train_optim_loss: 329161.8406; val_kl_reg_loss: 5787.8071; val_edge_recon_loss: 256632.9825; val_gene_expr_recon_loss: 66228.2759; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328649.0661; val_optim_loss: 328649.0661
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9956; val_auprc_score: 0.9945; val_best_acc_score: 0.9762; val_best_f1_score: 0.9765; train_kl_reg_loss: 5755.4338; train_edge_recon_loss: 258906.4483; train_gene_expr_recon_loss: 62596.4883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327258.3710; train_optim_loss: 327258.3710; val_kl_reg_loss: 5805.6309; val_edge_recon_loss: 258413.9747; val_gene_expr_recon_loss: 67396.6698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331616.2749; val_optim_loss: 331616.2749
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9969; val_auprc_score: 0.9962; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 5788.1760; train_edge_recon_loss: 257164.1868; train_gene_expr_recon_loss: 66204.7708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329157.1333; train_optim_loss: 329157.1333; val_kl_reg_loss: 5788.5336; val_edge_recon_loss: 256632.3402; val_gene_expr_recon_loss: 66255.1530; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328676.0262; val_optim_loss: 328676.0262
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9961; val_auprc_score: 0.9952; val_best_acc_score: 0.9773; val_best_f1_score: 0.9775; train_kl_reg_loss: 5746.9724; train_edge_recon_loss: 258763.3004; train_gene_expr_recon_loss: 58714.6451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 323224.9179; train_optim_loss: 323224.9179; val_kl_reg_loss: 5740.4262; val_edge_recon_loss: 258433.9944; val_gene_expr_recon_loss: 57451.8681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321626.2884; val_optim_loss: 321626.2884
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9968; val_auprc_score: 0.9960; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 5786.1470; train_edge_recon_loss: 257132.2207; train_gene_expr_recon_loss: 66217.0112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329135.3789; train_optim_loss: 329135.3789; val_kl_reg_loss: 5774.9394; val_edge_recon_loss: 256675.7332; val_gene_expr_recon_loss: 66200.9536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328651.6271; val_optim_loss: 328651.6271
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9956; val_auprc_score: 0.9944; val_best_acc_score: 0.9768; val_best_f1_score: 0.9770; train_kl_reg_loss: 5739.9671; train_edge_recon_loss: 258617.5053; train_gene_expr_recon_loss: 58092.8794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322450.3517; train_optim_loss: 322450.3517; val_kl_reg_loss: 5701.5058; val_edge_recon_loss: 258199.9328; val_gene_expr_recon_loss: 58091.2231; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321992.6623; val_optim_loss: 321992.6623
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9968; val_auprc_score: 0.9960; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 5784.4840; train_edge_recon_loss: 257182.7580; train_gene_expr_recon_loss: 66191.9005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329159.1422; train_optim_loss: 329159.1422; val_kl_reg_loss: 5786.8759; val_edge_recon_loss: 256640.4874; val_gene_expr_recon_loss: 66251.2300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328678.5934; val_optim_loss: 328678.5934
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9958; val_auprc_score: 0.9946; val_best_acc_score: 0.9772; val_best_f1_score: 0.9774; train_kl_reg_loss: 5739.8729; train_edge_recon_loss: 258520.9726; train_gene_expr_recon_loss: 57885.8505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322146.6962; train_optim_loss: 322146.6962; val_kl_reg_loss: 5774.8956; val_edge_recon_loss: 258269.9126; val_gene_expr_recon_loss: 56356.5011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320401.3082; val_optim_loss: 320401.3082
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9968; val_auprc_score: 0.9960; val_best_acc_score: 0.9806; val_best_f1_score: 0.9807; train_kl_reg_loss: 5782.2950; train_edge_recon_loss: 257186.9402; train_gene_expr_recon_loss: 66202.0933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329171.3288; train_optim_loss: 329171.3288; val_kl_reg_loss: 5775.7287; val_edge_recon_loss: 256638.4806; val_gene_expr_recon_loss: 66235.2363; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328649.4452; val_optim_loss: 328649.4452
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9965; val_auprc_score: 0.9956; val_best_acc_score: 0.9790; val_best_f1_score: 0.9792; train_kl_reg_loss: 5736.3936; train_edge_recon_loss: 258384.8601; train_gene_expr_recon_loss: 57910.0825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322031.3361; train_optim_loss: 322031.3361; val_kl_reg_loss: 5746.0739; val_edge_recon_loss: 257998.0804; val_gene_expr_recon_loss: 57548.1086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321292.2634; val_optim_loss: 321292.2634

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9969; val_auprc_score: 0.9962; val_best_acc_score: 0.9806; val_best_f1_score: 0.9807; train_kl_reg_loss: 5781.3316; train_edge_recon_loss: 257150.2153; train_gene_expr_recon_loss: 66110.7771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329042.3243; train_optim_loss: 329042.3243; val_kl_reg_loss: 5778.3359; val_edge_recon_loss: 256711.6202; val_gene_expr_recon_loss: 66201.8421; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328691.7981; val_optim_loss: 328691.7981
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9963; val_auprc_score: 0.9954; val_best_acc_score: 0.9791; val_best_f1_score: 0.9793; train_kl_reg_loss: 5733.8506; train_edge_recon_loss: 258307.8907; train_gene_expr_recon_loss: 57515.5124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321557.2539; train_optim_loss: 321557.2539; val_kl_reg_loss: 5676.7741; val_edge_recon_loss: 257704.8553; val_gene_expr_recon_loss: 57871.4305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321253.0603; val_optim_loss: 321253.0603
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9970; val_auprc_score: 0.9963; val_best_acc_score: 0.9805; val_best_f1_score: 0.9806; train_kl_reg_loss: 5784.4592; train_edge_recon_loss: 257131.0147; train_gene_expr_recon_loss: 66117.3075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329032.7817; train_optim_loss: 329032.7817; val_kl_reg_loss: 5779.7777; val_edge_recon_loss: 256805.5794; val_gene_expr_recon_loss: 66140.5205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328725.8781; val_optim_loss: 328725.8781
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9962; val_auprc_score: 0.9952; val_best_acc_score: 0.9790; val_best_f1_score: 0.9792; train_kl_reg_loss: 5733.0768; train_edge_recon_loss: 258256.8542; train_gene_expr_recon_loss: 57443.8471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321433.7784; train_optim_loss: 321433.7784; val_kl_reg_loss: 5763.7430; val_edge_recon_loss: 257677.2863; val_gene_expr_recon_loss: 57795.3457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321236.3757; val_optim_loss: 321236.3757
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9968; val_auprc_score: 0.9961; val_best_acc_score: 0.9803; val_best_f1_score: 0.9804; train_kl_reg_loss: 5783.5608; train_edge_recon_loss: 257122.9690; train_gene_expr_recon_loss: 66120.3412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329026.8708; train_optim_loss: 329026.8708; val_kl_reg_loss: 5779.2092; val_edge_recon_loss: 256717.6669; val_gene_expr_recon_loss: 66107.3065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328604.1819; val_optim_loss: 328604.1819
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9791; val_best_f1_score: 0.9793; train_kl_reg_loss: 5733.8618; train_edge_recon_loss: 258118.0004; train_gene_expr_recon_loss: 57421.2751; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321273.1374; train_optim_loss: 321273.1374; val_kl_reg_loss: 5777.9989; val_edge_recon_loss: 257734.8564; val_gene_expr_recon_loss: 57835.9355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321348.7918; val_optim_loss: 321348.7918
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9968; val_auprc_score: 0.9960; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 5785.7607; train_edge_recon_loss: 257150.8818; train_gene_expr_recon_loss: 66122.0525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329058.6948; train_optim_loss: 329058.6948; val_kl_reg_loss: 5781.4335; val_edge_recon_loss: 256620.4111; val_gene_expr_recon_loss: 66119.8355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328521.6797; val_optim_loss: 328521.6797

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9966; val_auprc_score: 0.9957; val_best_acc_score: 0.9805; val_best_f1_score: 0.9806; train_kl_reg_loss: 5749.9644; train_edge_recon_loss: 257860.6032; train_gene_expr_recon_loss: 57083.7544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320694.3218; train_optim_loss: 320694.3218; val_kl_reg_loss: 5742.2566; val_edge_recon_loss: 257437.2507; val_gene_expr_recon_loss: 57574.9744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320754.4817; val_optim_loss: 320754.4817
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9969; val_auprc_score: 0.9963; val_best_acc_score: 0.9806; val_best_f1_score: 0.9807; train_kl_reg_loss: 5786.1635; train_edge_recon_loss: 257128.4851; train_gene_expr_recon_loss: 66105.9515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329020.6000; train_optim_loss: 329020.6000; val_kl_reg_loss: 5781.3217; val_edge_recon_loss: 256683.5344; val_gene_expr_recon_loss: 66125.6180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328590.4732; val_optim_loss: 328590.4732
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9968; val_auprc_score: 0.9961; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 5740.4264; train_edge_recon_loss: 257823.7937; train_gene_expr_recon_loss: 57042.7837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320607.0036; train_optim_loss: 320607.0036; val_kl_reg_loss: 5730.6845; val_edge_recon_loss: 257264.5250; val_gene_expr_recon_loss: 57614.4909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320609.7009; val_optim_loss: 320609.7009
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9968; val_auprc_score: 0.9961; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 5785.9993; train_edge_recon_loss: 257100.4002; train_gene_expr_recon_loss: 66110.1075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328996.5068; train_optim_loss: 328996.5068; val_kl_reg_loss: 5783.8513; val_edge_recon_loss: 256707.1389; val_gene_expr_recon_loss: 66136.4799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328627.4701; val_optim_loss: 328627.4701
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9967; val_auprc_score: 0.9957; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 5735.9114; train_edge_recon_loss: 257834.6887; train_gene_expr_recon_loss: 57022.6197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320593.2200; train_optim_loss: 320593.2200; val_kl_reg_loss: 5718.5188; val_edge_recon_loss: 257277.1008; val_gene_expr_recon_loss: 57571.1814; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320566.8007; val_optim_loss: 320566.8007
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9969; val_auprc_score: 0.9962; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 5783.4948; train_edge_recon_loss: 257156.0238; train_gene_expr_recon_loss: 66128.2522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329067.7707; train_optim_loss: 329067.7707; val_kl_reg_loss: 5781.1855; val_edge_recon_loss: 256630.8456; val_gene_expr_recon_loss: 66162.0140; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328574.0449; val_optim_loss: 328574.0449
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9969; val_auprc_score: 0.9961; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 5735.4658; train_edge_recon_loss: 257753.7546; train_gene_expr_recon_loss: 57001.8036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320491.0239; train_optim_loss: 320491.0239; val_kl_reg_loss: 5736.6591; val_edge_recon_loss: 257282.1927; val_gene_expr_recon_loss: 57584.4448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320603.2970; val_optim_loss: 320603.2970
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9969; val_auprc_score: 0.9961; val_best_acc_score: 0.9807; val_best_f1_score: 0.9808; train_kl_reg_loss: 5784.6812; train_edge_recon_loss: 257107.7848; train_gene_expr_recon_loss: 66100.3965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328992.8627; train_optim_loss: 328992.8627; val_kl_reg_loss: 5782.2250; val_edge_recon_loss: 256692.0889; val_gene_expr_recon_loss: 66090.3073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328564.6215; val_optim_loss: 328564.6215

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 550 min 19 sec.
Using best model state, which was in epoch 11.

--- MODEL EVALUATION ---
Val AUROC score: 0.9961
Val AUPRC score: 0.9951
Val best accuracy score: 0.9776
Val best F1 score: 0.9778
Val gene expr MSE score: 1.9081

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9969; val_auprc_score: 0.9963; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 5784.8678; train_edge_recon_loss: 257142.8900; train_gene_expr_recon_loss: 66106.9997; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329034.7573; train_optim_loss: 329034.7573; val_kl_reg_loss: 5779.5391; val_edge_recon_loss: 256735.4765; val_gene_expr_recon_loss: 66084.3556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328599.3709; val_optim_loss: 328599.3709
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9969; val_auprc_score: 0.9961; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 5785.5456; train_edge_recon_loss: 257172.9328; train_gene_expr_recon_loss: 66124.3903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329082.8690; train_optim_loss: 329082.8690; val_kl_reg_loss: 5779.8522; val_edge_recon_loss: 256673.0450; val_gene_expr_recon_loss: 66150.5809; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328603.4779; val_optim_loss: 328603.4779
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9969; val_auprc_score: 0.9961; val_best_acc_score: 0.9805; val_best_f1_score: 0.9806; train_kl_reg_loss: 5784.6830; train_edge_recon_loss: 257138.9970; train_gene_expr_recon_loss: 66125.8569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329049.5368; train_optim_loss: 329049.5368; val_kl_reg_loss: 5783.6833; val_edge_recon_loss: 256779.4585; val_gene_expr_recon_loss: 66186.4010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328749.5426; val_optim_loss: 328749.5426
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9969; val_auprc_score: 0.9962; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 5784.6731; train_edge_recon_loss: 257126.4975; train_gene_expr_recon_loss: 66114.1307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329025.3013; train_optim_loss: 329025.3013; val_kl_reg_loss: 5779.1475; val_edge_recon_loss: 256663.9116; val_gene_expr_recon_loss: 66049.0992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328492.1573; val_optim_loss: 328492.1573
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9970; val_auprc_score: 0.9963; val_best_acc_score: 0.9810; val_best_f1_score: 0.9811; train_kl_reg_loss: 5784.6785; train_edge_recon_loss: 257109.3778; train_gene_expr_recon_loss: 66111.9963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329006.0530; train_optim_loss: 329006.0530; val_kl_reg_loss: 5781.5367; val_edge_recon_loss: 256519.0749; val_gene_expr_recon_loss: 66211.0843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328511.6960; val_optim_loss: 328511.6960
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9970; val_auprc_score: 0.9963; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 5784.6264; train_edge_recon_loss: 257145.4238; train_gene_expr_recon_loss: 66110.5146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329040.5648; train_optim_loss: 329040.5648; val_kl_reg_loss: 5780.7869; val_edge_recon_loss: 256560.8164; val_gene_expr_recon_loss: 66218.2877; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328559.8906; val_optim_loss: 328559.8906
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9970; val_auprc_score: 0.9963; val_best_acc_score: 0.9806; val_best_f1_score: 0.9807; train_kl_reg_loss: 5783.6260; train_edge_recon_loss: 257132.7555; train_gene_expr_recon_loss: 66108.9029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329025.2844; train_optim_loss: 329025.2844; val_kl_reg_loss: 5780.1780; val_edge_recon_loss: 256619.9261; val_gene_expr_recon_loss: 66117.8913; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328517.9960; val_optim_loss: 328517.9960
Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9968; val_auprc_score: 0.9959; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 5782.8654; train_edge_recon_loss: 257106.9156; train_gene_expr_recon_loss: 66102.4904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328992.2715; train_optim_loss: 328992.2715; val_kl_reg_loss: 5779.4616; val_edge_recon_loss: 256670.7717; val_gene_expr_recon_loss: 66126.1449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328576.3784; val_optim_loss: 328576.3784

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 64/100 |████████████--------| 64.0% val_auroc_score: 0.9968; val_auprc_score: 0.9959; val_best_acc_score: 0.9808; val_best_f1_score: 0.9809; train_kl_reg_loss: 5784.2001; train_edge_recon_loss: 257145.4519; train_gene_expr_recon_loss: 66104.4021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329034.0539; train_optim_loss: 329034.0539; val_kl_reg_loss: 5779.7487; val_edge_recon_loss: 256636.3209; val_gene_expr_recon_loss: 66143.5002; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328559.5697; val_optim_loss: 328559.5697
Epoch 65/100 |█████████████-------| 65.0% val_auroc_score: 0.9969; val_auprc_score: 0.9963; val_best_acc_score: 0.9806; val_best_f1_score: 0.9807; train_kl_reg_loss: 5784.2541; train_edge_recon_loss: 257095.4239; train_gene_expr_recon_loss: 66120.9493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329000.6269; train_optim_loss: 329000.6269; val_kl_reg_loss: 5778.5193; val_edge_recon_loss: 256674.8763; val_gene_expr_recon_loss: 66137.4875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328590.8831; val_optim_loss: 328590.8831
Epoch 66/100 |█████████████-------| 66.0% val_auroc_score: 0.9969; val_auprc_score: 0.9961; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 5784.6099; train_edge_recon_loss: 257138.0415; train_gene_expr_recon_loss: 66133.8457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329056.4975; train_optim_loss: 329056.4975; val_kl_reg_loss: 5780.5961; val_edge_recon_loss: 256636.7501; val_gene_expr_recon_loss: 66083.1260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328500.4720; val_optim_loss: 328500.4720
Epoch 67/100 |█████████████-------| 67.0% val_auroc_score: 0.9969; val_auprc_score: 0.9962; val_best_acc_score: 0.9807; val_best_f1_score: 0.9808; train_kl_reg_loss: 5784.1854; train_edge_recon_loss: 257080.3664; train_gene_expr_recon_loss: 66106.8160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328971.3678; train_optim_loss: 328971.3678; val_kl_reg_loss: 5776.5848; val_edge_recon_loss: 256610.6022; val_gene_expr_recon_loss: 66172.6980; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328559.8853; val_optim_loss: 328559.8853

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1542 min 0 sec.
Using best model state, which was in epoch 59.

--- MODEL EVALUATION ---
Val AUROC score: 0.9968
Val AUPRC score: 0.9960
Val best accuracy score: 0.9804
Val best F1 score: 0.9806
Val gene expr MSE score: 1.8168

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
