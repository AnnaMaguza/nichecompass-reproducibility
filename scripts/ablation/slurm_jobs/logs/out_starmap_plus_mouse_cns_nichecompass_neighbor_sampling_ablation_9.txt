None
Run timestamp: 24072023_201311_9.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_9']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9815; val_auprc_score: 0.9746; val_best_acc_score: 0.9445; val_best_f1_score: 0.9460; train_kl_reg_loss: 100773.4619; train_edge_recon_loss: 27016344.9596; train_gene_expr_recon_loss: 11835012.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38952130.5074; train_optim_loss: 38952130.5074; val_kl_reg_loss: 120723.6288; val_edge_recon_loss: 26199474.4262; val_gene_expr_recon_loss: 10839501.6066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37159699.8033; val_optim_loss: 37159699.8033
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9831; val_auprc_score: 0.9773; val_best_acc_score: 0.9477; val_best_f1_score: 0.9491; train_kl_reg_loss: 116447.8557; train_edge_recon_loss: 26040549.1176; train_gene_expr_recon_loss: 10620957.1765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36777954.1471; train_optim_loss: 36777954.1471; val_kl_reg_loss: 106411.8628; val_edge_recon_loss: 26061550.9836; val_gene_expr_recon_loss: 10445749.1803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36613711.8033; val_optim_loss: 36613711.8033
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9867; val_auprc_score: 0.9822; val_best_acc_score: 0.9548; val_best_f1_score: 0.9559; train_kl_reg_loss: 102232.0075; train_edge_recon_loss: 25941320.6250; train_gene_expr_recon_loss: 10323352.9540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36366905.6103; train_optim_loss: 36366905.6103; val_kl_reg_loss: 92123.0396; val_edge_recon_loss: 25935585.4426; val_gene_expr_recon_loss: 10205252.9836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36232961.2459; val_optim_loss: 36232961.2459
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9880; val_auprc_score: 0.9841; val_best_acc_score: 0.9593; val_best_f1_score: 0.9602; train_kl_reg_loss: 90731.1810; train_edge_recon_loss: 25860222.4816; train_gene_expr_recon_loss: 10140506.8382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36091460.4926; train_optim_loss: 36091460.4926; val_kl_reg_loss: 85375.5046; val_edge_recon_loss: 25853174.7213; val_gene_expr_recon_loss: 10108437.7213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36046987.8033; val_optim_loss: 36046987.8033
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9888; val_auprc_score: 0.9856; val_best_acc_score: 0.9602; val_best_f1_score: 0.9610; train_kl_reg_loss: 84592.0631; train_edge_recon_loss: 25798078.7022; train_gene_expr_recon_loss: 10026548.9816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35909219.7868; train_optim_loss: 35909219.7868; val_kl_reg_loss: 79132.7223; val_edge_recon_loss: 25838053.7705; val_gene_expr_recon_loss: 9996839.1803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35914025.7049; val_optim_loss: 35914025.7049
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9888; val_auprc_score: 0.9851; val_best_acc_score: 0.9612; val_best_f1_score: 0.9620; train_kl_reg_loss: 79237.3968; train_edge_recon_loss: 25765432.9375; train_gene_expr_recon_loss: 9943278.7721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35787949.1397; train_optim_loss: 35787949.1397; val_kl_reg_loss: 75627.4120; val_edge_recon_loss: 25813938.6885; val_gene_expr_recon_loss: 9933924.6066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35823490.5574; val_optim_loss: 35823490.5574
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9900; val_auprc_score: 0.9869; val_best_acc_score: 0.9642; val_best_f1_score: 0.9650; train_kl_reg_loss: 74579.5736; train_edge_recon_loss: 25715587.7316; train_gene_expr_recon_loss: 9886818.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35676986.1471; train_optim_loss: 35676986.1471; val_kl_reg_loss: 70478.0307; val_edge_recon_loss: 25773716.9508; val_gene_expr_recon_loss: 9909168.8689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35753363.9344; val_optim_loss: 35753363.9344
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9909; val_auprc_score: 0.9881; val_best_acc_score: 0.9664; val_best_f1_score: 0.9669; train_kl_reg_loss: 70613.1357; train_edge_recon_loss: 25700490.1728; train_gene_expr_recon_loss: 9824385.9963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35595489.3309; train_optim_loss: 35595489.3309; val_kl_reg_loss: 68283.9872; val_edge_recon_loss: 25733516.1311; val_gene_expr_recon_loss: 9845221.4918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35647021.4426; val_optim_loss: 35647021.4426
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9908; val_auprc_score: 0.9879; val_best_acc_score: 0.9667; val_best_f1_score: 0.9674; train_kl_reg_loss: 67555.2152; train_edge_recon_loss: 25672336.4816; train_gene_expr_recon_loss: 9785609.4743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35525501.2794; train_optim_loss: 35525501.2794; val_kl_reg_loss: 66523.0628; val_edge_recon_loss: 25728370.0328; val_gene_expr_recon_loss: 9832420.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35627312.9836; val_optim_loss: 35627312.9836
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9912; val_auprc_score: 0.9881; val_best_acc_score: 0.9673; val_best_f1_score: 0.9678; train_kl_reg_loss: 65233.2635; train_edge_recon_loss: 25649436.5882; train_gene_expr_recon_loss: 9747845.1195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35462515.0000; train_optim_loss: 35462515.0000; val_kl_reg_loss: 62916.9396; val_edge_recon_loss: 25722550.0656; val_gene_expr_recon_loss: 9800707.2951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35586174.2951; val_optim_loss: 35586174.2951
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9914; val_auprc_score: 0.9883; val_best_acc_score: 0.9681; val_best_f1_score: 0.9687; train_kl_reg_loss: 62701.6245; train_edge_recon_loss: 25638092.1066; train_gene_expr_recon_loss: 9719412.2353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35420205.9926; train_optim_loss: 35420205.9926; val_kl_reg_loss: 61411.1878; val_edge_recon_loss: 25709604.2623; val_gene_expr_recon_loss: 9800653.7377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35571669.3115; val_optim_loss: 35571669.3115
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9921; val_auprc_score: 0.9893; val_best_acc_score: 0.9701; val_best_f1_score: 0.9706; train_kl_reg_loss: 60455.7051; train_edge_recon_loss: 25622675.3787; train_gene_expr_recon_loss: 9695775.6066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35378906.7794; train_optim_loss: 35378906.7794; val_kl_reg_loss: 59180.3655; val_edge_recon_loss: 25672114.1967; val_gene_expr_recon_loss: 9800488.8033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35531783.6721; val_optim_loss: 35531783.6721
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9922; val_auprc_score: 0.9897; val_best_acc_score: 0.9716; val_best_f1_score: 0.9720; train_kl_reg_loss: 59013.5835; train_edge_recon_loss: 25617429.6029; train_gene_expr_recon_loss: 9657467.3649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35333910.5000; train_optim_loss: 35333910.5000; val_kl_reg_loss: 57167.5765; val_edge_recon_loss: 25646218.3934; val_gene_expr_recon_loss: 9785723.8197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35489109.7049; val_optim_loss: 35489109.7049
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9930; val_auprc_score: 0.9906; val_best_acc_score: 0.9720; val_best_f1_score: 0.9725; train_kl_reg_loss: 57395.8282; train_edge_recon_loss: 25612597.2721; train_gene_expr_recon_loss: 9640684.3456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35310677.4926; train_optim_loss: 35310677.4926; val_kl_reg_loss: 57091.5656; val_edge_recon_loss: 25640192.0000; val_gene_expr_recon_loss: 9761536.9016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35458820.8525; val_optim_loss: 35458820.8525
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9926; val_auprc_score: 0.9901; val_best_acc_score: 0.9732; val_best_f1_score: 0.9736; train_kl_reg_loss: 56276.3751; train_edge_recon_loss: 25597939.4228; train_gene_expr_recon_loss: 9612886.7224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35267102.5515; train_optim_loss: 35267102.5515; val_kl_reg_loss: 55209.4691; val_edge_recon_loss: 25631914.0328; val_gene_expr_recon_loss: 9737516.2295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35424639.9344; val_optim_loss: 35424639.9344
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9936; val_auprc_score: 0.9915; val_best_acc_score: 0.9743; val_best_f1_score: 0.9746; train_kl_reg_loss: 55223.0501; train_edge_recon_loss: 25586315.2647; train_gene_expr_recon_loss: 9591088.1434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35232626.5294; train_optim_loss: 35232626.5294; val_kl_reg_loss: 54464.7752; val_edge_recon_loss: 25644087.9016; val_gene_expr_recon_loss: 9760464.3770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35459016.9836; val_optim_loss: 35459016.9836
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9933; val_auprc_score: 0.9913; val_best_acc_score: 0.9739; val_best_f1_score: 0.9743; train_kl_reg_loss: 53939.1478; train_edge_recon_loss: 25595208.2537; train_gene_expr_recon_loss: 9583127.2206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35232274.6176; train_optim_loss: 35232274.6176; val_kl_reg_loss: 50743.4169; val_edge_recon_loss: 25685050.2623; val_gene_expr_recon_loss: 9776722.9836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35512516.5246; val_optim_loss: 35512516.5246
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9935; val_auprc_score: 0.9914; val_best_acc_score: 0.9749; val_best_f1_score: 0.9753; train_kl_reg_loss: 53246.8213; train_edge_recon_loss: 25573310.2279; train_gene_expr_recon_loss: 9562492.5110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35189049.6029; train_optim_loss: 35189049.6029; val_kl_reg_loss: 52551.5582; val_edge_recon_loss: 25625945.7705; val_gene_expr_recon_loss: 9741079.4754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35419576.9836; val_optim_loss: 35419576.9836
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9936; val_auprc_score: 0.9912; val_best_acc_score: 0.9755; val_best_f1_score: 0.9759; train_kl_reg_loss: 52623.9057; train_edge_recon_loss: 25567870.3309; train_gene_expr_recon_loss: 9550057.0735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35170551.3529; train_optim_loss: 35170551.3529; val_kl_reg_loss: 52611.2763; val_edge_recon_loss: 25625188.9180; val_gene_expr_recon_loss: 9742700.0164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35420499.8689; val_optim_loss: 35420499.8689
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9941; val_auprc_score: 0.9924; val_best_acc_score: 0.9760; val_best_f1_score: 0.9763; train_kl_reg_loss: 52130.2158; train_edge_recon_loss: 25562116.5846; train_gene_expr_recon_loss: 9522537.4393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35136784.2132; train_optim_loss: 35136784.2132; val_kl_reg_loss: 51244.6402; val_edge_recon_loss: 25627151.8033; val_gene_expr_recon_loss: 9721901.9016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35400298.4262; val_optim_loss: 35400298.4262
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9940; val_auprc_score: 0.9919; val_best_acc_score: 0.9765; val_best_f1_score: 0.9768; train_kl_reg_loss: 51538.2995; train_edge_recon_loss: 25554153.4449; train_gene_expr_recon_loss: 9507860.8456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35113552.5368; train_optim_loss: 35113552.5368; val_kl_reg_loss: 50636.3021; val_edge_recon_loss: 25609305.5410; val_gene_expr_recon_loss: 9753006.9508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35412948.8525; val_optim_loss: 35412948.8525
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9944; val_auprc_score: 0.9927; val_best_acc_score: 0.9766; val_best_f1_score: 0.9769; train_kl_reg_loss: 50773.8005; train_edge_recon_loss: 25562575.5368; train_gene_expr_recon_loss: 9490368.4338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35103717.8676; train_optim_loss: 35103717.8676; val_kl_reg_loss: 49947.4868; val_edge_recon_loss: 25597017.5738; val_gene_expr_recon_loss: 9718286.8525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35365251.8033; val_optim_loss: 35365251.8033
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9942; val_auprc_score: 0.9923; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 50346.8233; train_edge_recon_loss: 25554400.0221; train_gene_expr_recon_loss: 9473452.7004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35078199.5588; train_optim_loss: 35078199.5588; val_kl_reg_loss: 49844.7031; val_edge_recon_loss: 25609568.3279; val_gene_expr_recon_loss: 9751992.7705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35411405.5082; val_optim_loss: 35411405.5082
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9947; val_auprc_score: 0.9931; val_best_acc_score: 0.9780; val_best_f1_score: 0.9783; train_kl_reg_loss: 49912.8346; train_edge_recon_loss: 25552107.5221; train_gene_expr_recon_loss: 9459396.5974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35061416.9485; train_optim_loss: 35061416.9485; val_kl_reg_loss: 49756.0029; val_edge_recon_loss: 25579301.1803; val_gene_expr_recon_loss: 9744464.6721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35373522.1639; val_optim_loss: 35373522.1639
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9943; val_auprc_score: 0.9916; val_best_acc_score: 0.9785; val_best_f1_score: 0.9787; train_kl_reg_loss: 49522.8521; train_edge_recon_loss: 25548150.5625; train_gene_expr_recon_loss: 9450269.0129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35047942.2721; train_optim_loss: 35047942.2721; val_kl_reg_loss: 49865.3737; val_edge_recon_loss: 25588883.8033; val_gene_expr_recon_loss: 9742273.2951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35381022.5574; val_optim_loss: 35381022.5574
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9945; val_auprc_score: 0.9925; val_best_acc_score: 0.9781; val_best_f1_score: 0.9784; train_kl_reg_loss: 49641.2614; train_edge_recon_loss: 25540539.0956; train_gene_expr_recon_loss: 9430419.5901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35020599.9706; train_optim_loss: 35020599.9706; val_kl_reg_loss: 48922.1640; val_edge_recon_loss: 25570539.2131; val_gene_expr_recon_loss: 9725247.9672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35344709.4426; val_optim_loss: 35344709.4426
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9948; val_auprc_score: 0.9930; val_best_acc_score: 0.9790; val_best_f1_score: 0.9793; train_kl_reg_loss: 49066.3700; train_edge_recon_loss: 25540075.8787; train_gene_expr_recon_loss: 9423918.3419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35013060.6176; train_optim_loss: 35013060.6176; val_kl_reg_loss: 48382.3660; val_edge_recon_loss: 25585952.9180; val_gene_expr_recon_loss: 9751172.0656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35385507.3443; val_optim_loss: 35385507.3443
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9951; val_auprc_score: 0.9937; val_best_acc_score: 0.9793; val_best_f1_score: 0.9796; train_kl_reg_loss: 48664.6392; train_edge_recon_loss: 25544604.5662; train_gene_expr_recon_loss: 9404863.5956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34998132.7868; train_optim_loss: 34998132.7868; val_kl_reg_loss: 47953.0683; val_edge_recon_loss: 25554915.2459; val_gene_expr_recon_loss: 9752617.6885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35355486.0328; val_optim_loss: 35355486.0328
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9951; val_auprc_score: 0.9934; val_best_acc_score: 0.9791; val_best_f1_score: 0.9793; train_kl_reg_loss: 48432.4533; train_edge_recon_loss: 25535399.1397; train_gene_expr_recon_loss: 9389898.4945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34973730.1397; train_optim_loss: 34973730.1397; val_kl_reg_loss: 47853.8642; val_edge_recon_loss: 25559252.6230; val_gene_expr_recon_loss: 9751771.4918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35358878.0984; val_optim_loss: 35358878.0984
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9952; val_auprc_score: 0.9936; val_best_acc_score: 0.9789; val_best_f1_score: 0.9792; train_kl_reg_loss: 48241.4817; train_edge_recon_loss: 25536770.5846; train_gene_expr_recon_loss: 9382685.9926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34967698.0515; train_optim_loss: 34967698.0515; val_kl_reg_loss: 47984.2412; val_edge_recon_loss: 25549592.8852; val_gene_expr_recon_loss: 9734261.1967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35331838.4918; val_optim_loss: 35331838.4918
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9950; val_auprc_score: 0.9936; val_best_acc_score: 0.9789; val_best_f1_score: 0.9792; train_kl_reg_loss: 47922.7536; train_edge_recon_loss: 25526411.1875; train_gene_expr_recon_loss: 9378703.4026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34953037.3897; train_optim_loss: 34953037.3897; val_kl_reg_loss: 46862.2565; val_edge_recon_loss: 25554757.7049; val_gene_expr_recon_loss: 9766713.3934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35368333.3115; val_optim_loss: 35368333.3115
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9953; val_auprc_score: 0.9938; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 47677.3488; train_edge_recon_loss: 25524605.5735; train_gene_expr_recon_loss: 9363452.6066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34935735.4706; train_optim_loss: 34935735.4706; val_kl_reg_loss: 47511.7551; val_edge_recon_loss: 25551158.6557; val_gene_expr_recon_loss: 9766182.1475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35364852.3279; val_optim_loss: 35364852.3279
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9952; val_auprc_score: 0.9936; val_best_acc_score: 0.9797; val_best_f1_score: 0.9799; train_kl_reg_loss: 47880.1944; train_edge_recon_loss: 25523035.4007; train_gene_expr_recon_loss: 9350473.1149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34921388.7721; train_optim_loss: 34921388.7721; val_kl_reg_loss: 47196.8056; val_edge_recon_loss: 25582225.1475; val_gene_expr_recon_loss: 9775293.9672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35404715.6721; val_optim_loss: 35404715.6721
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9953; val_auprc_score: 0.9935; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 47419.6541; train_edge_recon_loss: 25524901.4669; train_gene_expr_recon_loss: 9341255.7932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34913576.9485; train_optim_loss: 34913576.9485; val_kl_reg_loss: 46871.4210; val_edge_recon_loss: 25587732.8852; val_gene_expr_recon_loss: 9807321.7705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35441926.1639; val_optim_loss: 35441926.1639

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9954; val_auprc_score: 0.9942; val_best_acc_score: 0.9799; val_best_f1_score: 0.9802; train_kl_reg_loss: 49394.7294; train_edge_recon_loss: 25515443.3088; train_gene_expr_recon_loss: 9252106.1415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34816944.2206; train_optim_loss: 34816944.2206; val_kl_reg_loss: 50349.1766; val_edge_recon_loss: 25563332.7869; val_gene_expr_recon_loss: 9739497.1639; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35353179.1475; val_optim_loss: 35353179.1475
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9955; val_auprc_score: 0.9941; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 51228.9943; train_edge_recon_loss: 25505680.8824; train_gene_expr_recon_loss: 9243770.2224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34800680.0441; train_optim_loss: 34800680.0441; val_kl_reg_loss: 51270.3289; val_edge_recon_loss: 25528040.8197; val_gene_expr_recon_loss: 9746781.1639; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35326092.2623; val_optim_loss: 35326092.2623
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9956; val_auprc_score: 0.9943; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 52003.9729; train_edge_recon_loss: 25510906.0515; train_gene_expr_recon_loss: 9235873.4577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34798783.4632; train_optim_loss: 34798783.4632; val_kl_reg_loss: 51567.3637; val_edge_recon_loss: 25553474.0656; val_gene_expr_recon_loss: 9753426.7049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35358467.7377; val_optim_loss: 35358467.7377
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9958; val_auprc_score: 0.9944; val_best_acc_score: 0.9808; val_best_f1_score: 0.9811; train_kl_reg_loss: 52135.6057; train_edge_recon_loss: 25513168.5772; train_gene_expr_recon_loss: 9232554.0230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34797858.2316; train_optim_loss: 34797858.2316; val_kl_reg_loss: 51725.0097; val_edge_recon_loss: 25540138.1967; val_gene_expr_recon_loss: 9786465.2131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35378328.1967; val_optim_loss: 35378328.1967
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9956; val_auprc_score: 0.9940; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 52374.6882; train_edge_recon_loss: 25514989.5809; train_gene_expr_recon_loss: 9231813.6002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34799177.8787; train_optim_loss: 34799177.8787; val_kl_reg_loss: 52126.0636; val_edge_recon_loss: 25541580.6885; val_gene_expr_recon_loss: 9757754.5246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35351460.9836; val_optim_loss: 35351460.9836
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9952; val_auprc_score: 0.9935; val_best_acc_score: 0.9797; val_best_f1_score: 0.9799; train_kl_reg_loss: 52572.5539; train_edge_recon_loss: 25513780.0993; train_gene_expr_recon_loss: 9233711.6360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34800064.2941; train_optim_loss: 34800064.2941; val_kl_reg_loss: 52150.4159; val_edge_recon_loss: 25552386.5246; val_gene_expr_recon_loss: 9747181.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35351717.7049; val_optim_loss: 35351717.7049

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9956; val_auprc_score: 0.9939; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 52652.1713; train_edge_recon_loss: 25493665.3529; train_gene_expr_recon_loss: 9222293.5331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34768611.1103; train_optim_loss: 34768611.1103; val_kl_reg_loss: 52252.2737; val_edge_recon_loss: 25531587.2459; val_gene_expr_recon_loss: 9749788.0820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35333627.6066; val_optim_loss: 35333627.6066
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9955; val_auprc_score: 0.9940; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 52772.4002; train_edge_recon_loss: 25513874.1103; train_gene_expr_recon_loss: 9212040.8419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34778687.3603; train_optim_loss: 34778687.3603; val_kl_reg_loss: 52360.0914; val_edge_recon_loss: 25552644.0656; val_gene_expr_recon_loss: 9773829.9344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35378834.0328; val_optim_loss: 35378834.0328
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9955; val_auprc_score: 0.9940; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 52871.2900; train_edge_recon_loss: 25509290.8382; train_gene_expr_recon_loss: 9207253.4081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34769415.5956; train_optim_loss: 34769415.5956; val_kl_reg_loss: 52570.0992; val_edge_recon_loss: 25537909.4754; val_gene_expr_recon_loss: 9748856.1967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35339335.7377; val_optim_loss: 35339335.7377
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9954; val_auprc_score: 0.9938; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 52956.2374; train_edge_recon_loss: 25508284.1544; train_gene_expr_recon_loss: 9219830.8713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34781071.2684; train_optim_loss: 34781071.2684; val_kl_reg_loss: 52458.4601; val_edge_recon_loss: 25543034.6557; val_gene_expr_recon_loss: 9752277.6393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35347770.8197; val_optim_loss: 35347770.8197

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 240 min 23 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
Val AUROC score: 0.9953
Val AUPRC score: 0.9939
Val best accuracy score: 0.9800
Val best F1 score: 0.9802
Val gene expr MSE score: 0.6333

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
