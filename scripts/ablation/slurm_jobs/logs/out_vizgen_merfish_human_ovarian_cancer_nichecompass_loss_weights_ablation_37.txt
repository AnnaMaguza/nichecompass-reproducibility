None
Run timestamp: 17072023_195223_37.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_37']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9752; val_auprc_score: 0.9739; val_best_acc_score: 0.9209; val_best_f1_score: 0.9218; train_kl_reg_loss: 11957.5933; train_edge_recon_loss: 2672807.8220; train_gene_expr_recon_loss: 2148021.3915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4832786.7928; train_optim_loss: 4832786.7928; val_kl_reg_loss: 12135.1555; val_edge_recon_loss: 2669233.8386; val_gene_expr_recon_loss: 2056641.2239; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4738010.1909; val_optim_loss: 4738010.1909
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9798; val_auprc_score: 0.9786; val_best_acc_score: 0.9293; val_best_f1_score: 0.9297; train_kl_reg_loss: 12226.2179; train_edge_recon_loss: 2611395.0995; train_gene_expr_recon_loss: 2011170.8746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4634792.1843; train_optim_loss: 4634792.1843; val_kl_reg_loss: 13279.7616; val_edge_recon_loss: 2671078.7114; val_gene_expr_recon_loss: 1978411.4534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4662769.9318; val_optim_loss: 4662769.9318
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9807; val_auprc_score: 0.9799; val_best_acc_score: 0.9313; val_best_f1_score: 0.9321; train_kl_reg_loss: 12447.2592; train_edge_recon_loss: 2608624.3170; train_gene_expr_recon_loss: 1950213.7103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4571285.2928; train_optim_loss: 4571285.2928; val_kl_reg_loss: 12451.4439; val_edge_recon_loss: 2660800.7295; val_gene_expr_recon_loss: 1939150.3977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4612402.5727; val_optim_loss: 4612402.5727
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9816; val_auprc_score: 0.9802; val_best_acc_score: 0.9336; val_best_f1_score: 0.9343; train_kl_reg_loss: 12640.1863; train_edge_recon_loss: 2606893.8686; train_gene_expr_recon_loss: 1917519.1800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4537053.2337; train_optim_loss: 4537053.2337; val_kl_reg_loss: 12131.1645; val_edge_recon_loss: 2661635.7432; val_gene_expr_recon_loss: 1911481.6057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4585248.4864; val_optim_loss: 4585248.4864
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9825; val_auprc_score: 0.9807; val_best_acc_score: 0.9360; val_best_f1_score: 0.9367; train_kl_reg_loss: 12604.9753; train_edge_recon_loss: 2603728.9369; train_gene_expr_recon_loss: 1896096.7921; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4512430.7047; train_optim_loss: 4512430.7047; val_kl_reg_loss: 12296.6891; val_edge_recon_loss: 2655834.0818; val_gene_expr_recon_loss: 1896895.0068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4565025.7773; val_optim_loss: 4565025.7773
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9823; val_auprc_score: 0.9808; val_best_acc_score: 0.9353; val_best_f1_score: 0.9360; train_kl_reg_loss: 12666.4293; train_edge_recon_loss: 2601535.0922; train_gene_expr_recon_loss: 1883776.7732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4497978.3019; train_optim_loss: 4497978.3019; val_kl_reg_loss: 12160.3694; val_edge_recon_loss: 2657360.2864; val_gene_expr_recon_loss: 1897803.2580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4567323.9227; val_optim_loss: 4567323.9227
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9829; val_auprc_score: 0.9810; val_best_acc_score: 0.9373; val_best_f1_score: 0.9379; train_kl_reg_loss: 12724.3683; train_edge_recon_loss: 2599437.5188; train_gene_expr_recon_loss: 1877873.1030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4490034.9985; train_optim_loss: 4490034.9985; val_kl_reg_loss: 12391.5322; val_edge_recon_loss: 2653704.2727; val_gene_expr_recon_loss: 1881204.5261; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4547300.3227; val_optim_loss: 4547300.3227
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9835; val_auprc_score: 0.9812; val_best_acc_score: 0.9381; val_best_f1_score: 0.9388; train_kl_reg_loss: 12740.9134; train_edge_recon_loss: 2598182.5003; train_gene_expr_recon_loss: 1872328.9715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4483252.3819; train_optim_loss: 4483252.3819; val_kl_reg_loss: 12717.8483; val_edge_recon_loss: 2653605.0864; val_gene_expr_recon_loss: 1880954.2580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4547277.2136; val_optim_loss: 4547277.2136
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9829; val_auprc_score: 0.9812; val_best_acc_score: 0.9368; val_best_f1_score: 0.9375; train_kl_reg_loss: 12760.4699; train_edge_recon_loss: 2596246.1902; train_gene_expr_recon_loss: 1869297.2794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4478303.9435; train_optim_loss: 4478303.9435; val_kl_reg_loss: 12531.2197; val_edge_recon_loss: 2649610.5136; val_gene_expr_recon_loss: 1884816.3909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4546958.1136; val_optim_loss: 4546958.1136
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9835; val_auprc_score: 0.9814; val_best_acc_score: 0.9393; val_best_f1_score: 0.9401; train_kl_reg_loss: 12769.0679; train_edge_recon_loss: 2596651.4129; train_gene_expr_recon_loss: 1867054.4730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4476474.9572; train_optim_loss: 4476474.9572; val_kl_reg_loss: 12589.0242; val_edge_recon_loss: 2649346.7841; val_gene_expr_recon_loss: 1876585.7148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4538521.5000; val_optim_loss: 4538521.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9839; val_auprc_score: 0.9817; val_best_acc_score: 0.9398; val_best_f1_score: 0.9405; train_kl_reg_loss: 12778.6123; train_edge_recon_loss: 2595078.1375; train_gene_expr_recon_loss: 1865180.4157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4473037.1655; train_optim_loss: 4473037.1655; val_kl_reg_loss: 12550.4813; val_edge_recon_loss: 2652768.4523; val_gene_expr_recon_loss: 1874026.1216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4539345.0409; val_optim_loss: 4539345.0409
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9834; val_auprc_score: 0.9818; val_best_acc_score: 0.9379; val_best_f1_score: 0.9385; train_kl_reg_loss: 12790.9101; train_edge_recon_loss: 2595383.1115; train_gene_expr_recon_loss: 1864809.0280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4472983.0428; train_optim_loss: 4472983.0428; val_kl_reg_loss: 12626.8565; val_edge_recon_loss: 2649111.7318; val_gene_expr_recon_loss: 1873220.3250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4534958.9273; val_optim_loss: 4534958.9273
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9842; val_auprc_score: 0.9823; val_best_acc_score: 0.9399; val_best_f1_score: 0.9405; train_kl_reg_loss: 12785.8641; train_edge_recon_loss: 2593625.1871; train_gene_expr_recon_loss: 1863479.9235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4469890.9664; train_optim_loss: 4469890.9664; val_kl_reg_loss: 12464.2779; val_edge_recon_loss: 2644872.9909; val_gene_expr_recon_loss: 1883241.8330; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4540579.1045; val_optim_loss: 4540579.1045
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9838; val_auprc_score: 0.9819; val_best_acc_score: 0.9392; val_best_f1_score: 0.9400; train_kl_reg_loss: 12808.4171; train_edge_recon_loss: 2593914.0448; train_gene_expr_recon_loss: 1863371.6720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4470094.1436; train_optim_loss: 4470094.1436; val_kl_reg_loss: 12294.7193; val_edge_recon_loss: 2647131.5932; val_gene_expr_recon_loss: 1875913.0080; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4535339.2955; val_optim_loss: 4535339.2955
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9841; val_auprc_score: 0.9819; val_best_acc_score: 0.9400; val_best_f1_score: 0.9406; train_kl_reg_loss: 12788.6864; train_edge_recon_loss: 2593856.2974; train_gene_expr_recon_loss: 1862118.1062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4468763.0886; train_optim_loss: 4468763.0886; val_kl_reg_loss: 12377.1287; val_edge_recon_loss: 2645637.6000; val_gene_expr_recon_loss: 1875572.5011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4533587.2273; val_optim_loss: 4533587.2273
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9840; val_auprc_score: 0.9819; val_best_acc_score: 0.9392; val_best_f1_score: 0.9402; train_kl_reg_loss: 12789.7375; train_edge_recon_loss: 2592208.0201; train_gene_expr_recon_loss: 1860922.2054; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4465919.9638; train_optim_loss: 4465919.9638; val_kl_reg_loss: 12392.1505; val_edge_recon_loss: 2644584.2818; val_gene_expr_recon_loss: 1873749.7818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4530726.2591; val_optim_loss: 4530726.2591
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9848; val_auprc_score: 0.9830; val_best_acc_score: 0.9404; val_best_f1_score: 0.9409; train_kl_reg_loss: 12780.7700; train_edge_recon_loss: 2591861.0960; train_gene_expr_recon_loss: 1860981.8357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4465623.7021; train_optim_loss: 4465623.7021; val_kl_reg_loss: 12674.8405; val_edge_recon_loss: 2645156.6614; val_gene_expr_recon_loss: 1869929.2795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4527760.7864; val_optim_loss: 4527760.7864
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9846; val_auprc_score: 0.9823; val_best_acc_score: 0.9417; val_best_f1_score: 0.9423; train_kl_reg_loss: 12783.3228; train_edge_recon_loss: 2590789.7296; train_gene_expr_recon_loss: 1859903.8228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4463476.8712; train_optim_loss: 4463476.8712; val_kl_reg_loss: 12407.3788; val_edge_recon_loss: 2643417.4636; val_gene_expr_recon_loss: 1870628.2443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4526453.0955; val_optim_loss: 4526453.0955
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9842; val_auprc_score: 0.9820; val_best_acc_score: 0.9405; val_best_f1_score: 0.9411; train_kl_reg_loss: 12773.8733; train_edge_recon_loss: 2591567.9567; train_gene_expr_recon_loss: 1859520.6002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4463862.4272; train_optim_loss: 4463862.4272; val_kl_reg_loss: 12659.2531; val_edge_recon_loss: 2643031.6591; val_gene_expr_recon_loss: 1872142.5148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4527833.4364; val_optim_loss: 4527833.4364
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9848; val_auprc_score: 0.9832; val_best_acc_score: 0.9417; val_best_f1_score: 0.9419; train_kl_reg_loss: 12778.8377; train_edge_recon_loss: 2590431.4728; train_gene_expr_recon_loss: 1858264.6474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4461474.9511; train_optim_loss: 4461474.9511; val_kl_reg_loss: 12530.3911; val_edge_recon_loss: 2643719.9068; val_gene_expr_recon_loss: 1869395.7420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4525646.0273; val_optim_loss: 4525646.0273
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9849; val_auprc_score: 0.9834; val_best_acc_score: 0.9412; val_best_f1_score: 0.9416; train_kl_reg_loss: 12768.7468; train_edge_recon_loss: 2590685.7716; train_gene_expr_recon_loss: 1858648.1457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4462102.6665; train_optim_loss: 4462102.6665; val_kl_reg_loss: 12438.7901; val_edge_recon_loss: 2644909.0591; val_gene_expr_recon_loss: 1869898.6489; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4527246.4909; val_optim_loss: 4527246.4909
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9845; val_auprc_score: 0.9824; val_best_acc_score: 0.9414; val_best_f1_score: 0.9420; train_kl_reg_loss: 12749.3092; train_edge_recon_loss: 2590224.3310; train_gene_expr_recon_loss: 1858386.8176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4461360.4638; train_optim_loss: 4461360.4638; val_kl_reg_loss: 12592.5138; val_edge_recon_loss: 2648384.3864; val_gene_expr_recon_loss: 1870292.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4531269.6818; val_optim_loss: 4531269.6818
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9854; val_auprc_score: 0.9834; val_best_acc_score: 0.9423; val_best_f1_score: 0.9428; train_kl_reg_loss: 12738.4959; train_edge_recon_loss: 2590210.0866; train_gene_expr_recon_loss: 1858515.6044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4461464.1823; train_optim_loss: 4461464.1823; val_kl_reg_loss: 12367.4765; val_edge_recon_loss: 2641494.7682; val_gene_expr_recon_loss: 1870318.7284; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4524181.0045; val_optim_loss: 4524181.0045
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9855; val_auprc_score: 0.9837; val_best_acc_score: 0.9426; val_best_f1_score: 0.9430; train_kl_reg_loss: 12735.9000; train_edge_recon_loss: 2590308.7322; train_gene_expr_recon_loss: 1858088.9330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4461133.5621; train_optim_loss: 4461133.5621; val_kl_reg_loss: 12709.5632; val_edge_recon_loss: 2639401.9614; val_gene_expr_recon_loss: 1869599.9773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4521711.4909; val_optim_loss: 4521711.4909
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9855; val_auprc_score: 0.9838; val_best_acc_score: 0.9431; val_best_f1_score: 0.9437; train_kl_reg_loss: 12712.6702; train_edge_recon_loss: 2590294.5929; train_gene_expr_recon_loss: 1856889.7714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4459897.0356; train_optim_loss: 4459897.0356; val_kl_reg_loss: 12441.9989; val_edge_recon_loss: 2639822.9886; val_gene_expr_recon_loss: 1872671.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4524936.9182; val_optim_loss: 4524936.9182
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9856; val_auprc_score: 0.9837; val_best_acc_score: 0.9445; val_best_f1_score: 0.9450; train_kl_reg_loss: 12702.7445; train_edge_recon_loss: 2589995.9896; train_gene_expr_recon_loss: 1857394.2566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4460092.9919; train_optim_loss: 4460092.9919; val_kl_reg_loss: 12659.0052; val_edge_recon_loss: 2639963.0318; val_gene_expr_recon_loss: 1869676.2034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4522298.2227; val_optim_loss: 4522298.2227
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9860; val_auprc_score: 0.9844; val_best_acc_score: 0.9439; val_best_f1_score: 0.9445; train_kl_reg_loss: 12700.3091; train_edge_recon_loss: 2587876.2026; train_gene_expr_recon_loss: 1856688.5322; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4457265.0443; train_optim_loss: 4457265.0443; val_kl_reg_loss: 12290.4616; val_edge_recon_loss: 2640216.4545; val_gene_expr_recon_loss: 1869513.9739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4522020.9045; val_optim_loss: 4522020.9045
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9863; val_auprc_score: 0.9847; val_best_acc_score: 0.9444; val_best_f1_score: 0.9449; train_kl_reg_loss: 12681.7297; train_edge_recon_loss: 2588594.5596; train_gene_expr_recon_loss: 1856154.6876; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4457430.9807; train_optim_loss: 4457430.9807; val_kl_reg_loss: 12536.8908; val_edge_recon_loss: 2640789.8591; val_gene_expr_recon_loss: 1871688.3432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4525015.1045; val_optim_loss: 4525015.1045

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9859; val_auprc_score: 0.9838; val_best_acc_score: 0.9447; val_best_f1_score: 0.9453; train_kl_reg_loss: 12711.8139; train_edge_recon_loss: 2585023.2014; train_gene_expr_recon_loss: 1837262.9947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4434998.0107; train_optim_loss: 4434998.0107; val_kl_reg_loss: 12377.7370; val_edge_recon_loss: 2637030.3750; val_gene_expr_recon_loss: 1851224.3693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4500632.4773; val_optim_loss: 4500632.4773
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9864; val_auprc_score: 0.9847; val_best_acc_score: 0.9456; val_best_f1_score: 0.9459; train_kl_reg_loss: 12633.2298; train_edge_recon_loss: 2585054.6522; train_gene_expr_recon_loss: 1835462.5207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4433150.3931; train_optim_loss: 4433150.3931; val_kl_reg_loss: 12408.5562; val_edge_recon_loss: 2632553.1841; val_gene_expr_recon_loss: 1850194.8489; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4495156.6045; val_optim_loss: 4495156.6045
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9859; val_auprc_score: 0.9838; val_best_acc_score: 0.9448; val_best_f1_score: 0.9452; train_kl_reg_loss: 12629.2594; train_edge_recon_loss: 2584538.8564; train_gene_expr_recon_loss: 1834829.7789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4431997.8936; train_optim_loss: 4431997.8936; val_kl_reg_loss: 12453.6995; val_edge_recon_loss: 2636266.8773; val_gene_expr_recon_loss: 1849983.2932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4498703.8591; val_optim_loss: 4498703.8591
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9863; val_auprc_score: 0.9844; val_best_acc_score: 0.9451; val_best_f1_score: 0.9454; train_kl_reg_loss: 12619.9388; train_edge_recon_loss: 2583791.2709; train_gene_expr_recon_loss: 1834576.4599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4430987.6660; train_optim_loss: 4430987.6660; val_kl_reg_loss: 12412.4106; val_edge_recon_loss: 2636183.8614; val_gene_expr_recon_loss: 1851495.6943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4500091.9773; val_optim_loss: 4500091.9773
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9867; val_auprc_score: 0.9848; val_best_acc_score: 0.9459; val_best_f1_score: 0.9462; train_kl_reg_loss: 12630.7433; train_edge_recon_loss: 2583594.4504; train_gene_expr_recon_loss: 1834195.1642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4430420.3406; train_optim_loss: 4430420.3406; val_kl_reg_loss: 12429.1501; val_edge_recon_loss: 2634390.4477; val_gene_expr_recon_loss: 1850190.4057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4497010.0045; val_optim_loss: 4497010.0045
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9863; val_auprc_score: 0.9845; val_best_acc_score: 0.9449; val_best_f1_score: 0.9453; train_kl_reg_loss: 12636.3084; train_edge_recon_loss: 2583481.8768; train_gene_expr_recon_loss: 1833994.2729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4430112.4572; train_optim_loss: 4430112.4572; val_kl_reg_loss: 12417.2689; val_edge_recon_loss: 2633192.5318; val_gene_expr_recon_loss: 1850339.0977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4495948.9091; val_optim_loss: 4495948.9091

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9866; val_auprc_score: 0.9848; val_best_acc_score: 0.9457; val_best_f1_score: 0.9460; train_kl_reg_loss: 12667.1627; train_edge_recon_loss: 2583868.9740; train_gene_expr_recon_loss: 1830879.8363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4427415.9725; train_optim_loss: 4427415.9725; val_kl_reg_loss: 12434.7829; val_edge_recon_loss: 2633593.3341; val_gene_expr_recon_loss: 1848008.3682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4494036.4955; val_optim_loss: 4494036.4955
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9863; val_auprc_score: 0.9845; val_best_acc_score: 0.9445; val_best_f1_score: 0.9449; train_kl_reg_loss: 12662.3616; train_edge_recon_loss: 2583935.7951; train_gene_expr_recon_loss: 1831167.6573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4427765.8147; train_optim_loss: 4427765.8147; val_kl_reg_loss: 12422.9322; val_edge_recon_loss: 2637549.3841; val_gene_expr_recon_loss: 1847543.7568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4497516.0682; val_optim_loss: 4497516.0682
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9864; val_auprc_score: 0.9844; val_best_acc_score: 0.9450; val_best_f1_score: 0.9456; train_kl_reg_loss: 12652.8296; train_edge_recon_loss: 2583381.7709; train_gene_expr_recon_loss: 1830825.8649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4426860.4751; train_optim_loss: 4426860.4751; val_kl_reg_loss: 12424.3726; val_edge_recon_loss: 2634655.7909; val_gene_expr_recon_loss: 1848907.3886; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4495987.5682; val_optim_loss: 4495987.5682
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9866; val_auprc_score: 0.9849; val_best_acc_score: 0.9459; val_best_f1_score: 0.9464; train_kl_reg_loss: 12648.4429; train_edge_recon_loss: 2582666.0700; train_gene_expr_recon_loss: 1830527.5942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4425842.1039; train_optim_loss: 4425842.1039; val_kl_reg_loss: 12427.4757; val_edge_recon_loss: 2634086.6182; val_gene_expr_recon_loss: 1844729.3955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4491243.4591; val_optim_loss: 4491243.4591
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9867; val_auprc_score: 0.9850; val_best_acc_score: 0.9453; val_best_f1_score: 0.9456; train_kl_reg_loss: 12648.5909; train_edge_recon_loss: 2582093.0550; train_gene_expr_recon_loss: 1830631.4229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4425373.0652; train_optim_loss: 4425373.0652; val_kl_reg_loss: 12418.0171; val_edge_recon_loss: 2636839.5273; val_gene_expr_recon_loss: 1846713.7068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4495971.2727; val_optim_loss: 4495971.2727
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9866; val_auprc_score: 0.9850; val_best_acc_score: 0.9452; val_best_f1_score: 0.9457; train_kl_reg_loss: 12649.6079; train_edge_recon_loss: 2583837.3157; train_gene_expr_recon_loss: 1830567.2052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4427054.1385; train_optim_loss: 4427054.1385; val_kl_reg_loss: 12418.0002; val_edge_recon_loss: 2635877.8182; val_gene_expr_recon_loss: 1847459.9466; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4495755.7727; val_optim_loss: 4495755.7727
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9868; val_auprc_score: 0.9853; val_best_acc_score: 0.9458; val_best_f1_score: 0.9461; train_kl_reg_loss: 12647.4442; train_edge_recon_loss: 2583511.0102; train_gene_expr_recon_loss: 1830845.2696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4427003.7245; train_optim_loss: 4427003.7245; val_kl_reg_loss: 12412.7394; val_edge_recon_loss: 2634913.5000; val_gene_expr_recon_loss: 1848868.6284; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4496194.8727; val_optim_loss: 4496194.8727
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9865; val_auprc_score: 0.9845; val_best_acc_score: 0.9454; val_best_f1_score: 0.9460; train_kl_reg_loss: 12650.0237; train_edge_recon_loss: 2583330.8714; train_gene_expr_recon_loss: 1830127.9454; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4426108.8549; train_optim_loss: 4426108.8549; val_kl_reg_loss: 12449.3082; val_edge_recon_loss: 2634019.3545; val_gene_expr_recon_loss: 1847194.9841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4493663.6773; val_optim_loss: 4493663.6773

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9866; val_auprc_score: 0.9848; val_best_acc_score: 0.9460; val_best_f1_score: 0.9464; train_kl_reg_loss: 12657.7322; train_edge_recon_loss: 2583679.2215; train_gene_expr_recon_loss: 1830203.8087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4426540.7525; train_optim_loss: 4426540.7525; val_kl_reg_loss: 12415.6854; val_edge_recon_loss: 2632590.2682; val_gene_expr_recon_loss: 1845985.9989; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4490991.9636; val_optim_loss: 4490991.9636
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9865; val_auprc_score: 0.9845; val_best_acc_score: 0.9460; val_best_f1_score: 0.9465; train_kl_reg_loss: 12655.3966; train_edge_recon_loss: 2583092.4891; train_gene_expr_recon_loss: 1830405.5028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4426153.3936; train_optim_loss: 4426153.3936; val_kl_reg_loss: 12425.4469; val_edge_recon_loss: 2634272.7250; val_gene_expr_recon_loss: 1847773.2261; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4494471.3864; val_optim_loss: 4494471.3864
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9867; val_auprc_score: 0.9845; val_best_acc_score: 0.9460; val_best_f1_score: 0.9464; train_kl_reg_loss: 12655.7737; train_edge_recon_loss: 2583964.3388; train_gene_expr_recon_loss: 1830266.0032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4426886.1115; train_optim_loss: 4426886.1115; val_kl_reg_loss: 12423.4301; val_edge_recon_loss: 2631949.5068; val_gene_expr_recon_loss: 1844948.9875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4489321.9273; val_optim_loss: 4489321.9273
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9865; val_auprc_score: 0.9848; val_best_acc_score: 0.9456; val_best_f1_score: 0.9461; train_kl_reg_loss: 12655.6917; train_edge_recon_loss: 2582667.7322; train_gene_expr_recon_loss: 1830612.2062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4425935.6339; train_optim_loss: 4425935.6339; val_kl_reg_loss: 12428.5389; val_edge_recon_loss: 2634056.9386; val_gene_expr_recon_loss: 1845049.2580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4491534.7500; val_optim_loss: 4491534.7500
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9867; val_auprc_score: 0.9848; val_best_acc_score: 0.9454; val_best_f1_score: 0.9459; train_kl_reg_loss: 12652.8645; train_edge_recon_loss: 2582978.8691; train_gene_expr_recon_loss: 1829514.5913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4425146.3299; train_optim_loss: 4425146.3299; val_kl_reg_loss: 12436.3393; val_edge_recon_loss: 2633963.0523; val_gene_expr_recon_loss: 1847151.7273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4493551.1227; val_optim_loss: 4493551.1227
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9865; val_auprc_score: 0.9846; val_best_acc_score: 0.9459; val_best_f1_score: 0.9462; train_kl_reg_loss: 12656.2714; train_edge_recon_loss: 2583737.6436; train_gene_expr_recon_loss: 1830890.9641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4427284.8849; train_optim_loss: 4427284.8849; val_kl_reg_loss: 12429.6797; val_edge_recon_loss: 2632705.5795; val_gene_expr_recon_loss: 1847379.5807; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4492514.8227; val_optim_loss: 4492514.8227
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9867; val_auprc_score: 0.9848; val_best_acc_score: 0.9461; val_best_f1_score: 0.9467; train_kl_reg_loss: 12653.8407; train_edge_recon_loss: 2582736.8406; train_gene_expr_recon_loss: 1829622.4416; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4425013.1197; train_optim_loss: 4425013.1197; val_kl_reg_loss: 12428.5570; val_edge_recon_loss: 2630156.9659; val_gene_expr_recon_loss: 1847898.9443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4490484.4727; val_optim_loss: 4490484.4727

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9864; val_auprc_score: 0.9845; val_best_acc_score: 0.9449; val_best_f1_score: 0.9455; train_kl_reg_loss: 12656.6823; train_edge_recon_loss: 2583857.7935; train_gene_expr_recon_loss: 1829863.2909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4426377.7617; train_optim_loss: 4426377.7617; val_kl_reg_loss: 12429.0308; val_edge_recon_loss: 2634400.0614; val_gene_expr_recon_loss: 1845791.7750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4492620.8909; val_optim_loss: 4492620.8909
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9867; val_auprc_score: 0.9847; val_best_acc_score: 0.9460; val_best_f1_score: 0.9467; train_kl_reg_loss: 12657.5891; train_edge_recon_loss: 2582778.2533; train_gene_expr_recon_loss: 1829916.1837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4425352.0219; train_optim_loss: 4425352.0219; val_kl_reg_loss: 12430.1701; val_edge_recon_loss: 2631501.3500; val_gene_expr_recon_loss: 1846770.0602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4490701.5682; val_optim_loss: 4490701.5682
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9862; val_auprc_score: 0.9840; val_best_acc_score: 0.9454; val_best_f1_score: 0.9459; train_kl_reg_loss: 12656.0056; train_edge_recon_loss: 2582851.4766; train_gene_expr_recon_loss: 1830510.5345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4426018.0168; train_optim_loss: 4426018.0168; val_kl_reg_loss: 12426.8507; val_edge_recon_loss: 2634134.1614; val_gene_expr_recon_loss: 1847373.6795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4493934.7000; val_optim_loss: 4493934.7000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9862; val_auprc_score: 0.9838; val_best_acc_score: 0.9456; val_best_f1_score: 0.9460; train_kl_reg_loss: 12656.4008; train_edge_recon_loss: 2582819.3949; train_gene_expr_recon_loss: 1829513.4418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4424989.2337; train_optim_loss: 4424989.2337; val_kl_reg_loss: 12427.6304; val_edge_recon_loss: 2635517.0727; val_gene_expr_recon_loss: 1846685.8455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4494630.5409; val_optim_loss: 4494630.5409

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 182 min 55 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
Val AUROC score: 0.9867
Val AUPRC score: 0.9847
Val best accuracy score: 0.9460
Val best F1 score: 0.9464
Val gene expr MSE score: 8.5163

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
