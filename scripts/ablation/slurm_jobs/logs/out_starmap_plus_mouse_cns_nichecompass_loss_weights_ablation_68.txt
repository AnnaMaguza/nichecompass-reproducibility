None
Run timestamp: 28072023_105933_68.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_68']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9867; val_auprc_score: 0.9802; val_best_acc_score: 0.9599; val_best_f1_score: 0.9608; train_kl_reg_loss: 2178.0583; train_edge_recon_loss: 27637.5086; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29815.5668; train_optim_loss: 29815.5668; val_kl_reg_loss: 2226.4605; val_edge_recon_loss: 25777.6502; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28004.1106; val_optim_loss: 28004.1106
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9896; val_auprc_score: 0.9846; val_best_acc_score: 0.9687; val_best_f1_score: 0.9692; train_kl_reg_loss: 2316.5255; train_edge_recon_loss: 27037.5493; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29354.0748; train_optim_loss: 29354.0748; val_kl_reg_loss: 2297.7488; val_edge_recon_loss: 25679.8656; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27977.6143; val_optim_loss: 27977.6143
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9910; val_auprc_score: 0.9866; val_best_acc_score: 0.9716; val_best_f1_score: 0.9721; train_kl_reg_loss: 2329.3889; train_edge_recon_loss: 26958.9817; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29288.3706; train_optim_loss: 29288.3706; val_kl_reg_loss: 2306.0423; val_edge_recon_loss: 25639.8302; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27945.8725; val_optim_loss: 27945.8725
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9920; val_auprc_score: 0.9881; val_best_acc_score: 0.9744; val_best_f1_score: 0.9748; train_kl_reg_loss: 2334.6901; train_edge_recon_loss: 26930.1584; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29264.8486; train_optim_loss: 29264.8486; val_kl_reg_loss: 2284.6776; val_edge_recon_loss: 25563.0108; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27847.6884; val_optim_loss: 27847.6884
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9928; val_auprc_score: 0.9892; val_best_acc_score: 0.9751; val_best_f1_score: 0.9755; train_kl_reg_loss: 2342.6450; train_edge_recon_loss: 26886.0300; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29228.6750; train_optim_loss: 29228.6750; val_kl_reg_loss: 2292.8764; val_edge_recon_loss: 25589.9398; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27882.8161; val_optim_loss: 27882.8161
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9932; val_auprc_score: 0.9897; val_best_acc_score: 0.9781; val_best_f1_score: 0.9784; train_kl_reg_loss: 2343.1560; train_edge_recon_loss: 26878.8558; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29222.0118; train_optim_loss: 29222.0118; val_kl_reg_loss: 2329.4344; val_edge_recon_loss: 25548.3320; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27877.7664; val_optim_loss: 27877.7664
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9933; val_auprc_score: 0.9896; val_best_acc_score: 0.9791; val_best_f1_score: 0.9794; train_kl_reg_loss: 2346.3003; train_edge_recon_loss: 26851.5569; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29197.8572; train_optim_loss: 29197.8572; val_kl_reg_loss: 2380.8311; val_edge_recon_loss: 25509.0201; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27889.8513; val_optim_loss: 27889.8513
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9943; val_auprc_score: 0.9915; val_best_acc_score: 0.9801; val_best_f1_score: 0.9804; train_kl_reg_loss: 2348.2521; train_edge_recon_loss: 26840.9328; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29189.1850; train_optim_loss: 29189.1850; val_kl_reg_loss: 2326.2668; val_edge_recon_loss: 25511.2736; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27837.5404; val_optim_loss: 27837.5404
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9947; val_auprc_score: 0.9920; val_best_acc_score: 0.9813; val_best_f1_score: 0.9815; train_kl_reg_loss: 2348.9706; train_edge_recon_loss: 26835.3972; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29184.3678; train_optim_loss: 29184.3678; val_kl_reg_loss: 2392.2862; val_edge_recon_loss: 25497.3793; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27889.6655; val_optim_loss: 27889.6655
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9952; val_auprc_score: 0.9929; val_best_acc_score: 0.9825; val_best_f1_score: 0.9827; train_kl_reg_loss: 2353.3635; train_edge_recon_loss: 26812.1733; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29165.5368; train_optim_loss: 29165.5368; val_kl_reg_loss: 2348.9117; val_edge_recon_loss: 25493.9432; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27842.8549; val_optim_loss: 27842.8549
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9952; val_auprc_score: 0.9926; val_best_acc_score: 0.9831; val_best_f1_score: 0.9833; train_kl_reg_loss: 2353.6242; train_edge_recon_loss: 26806.0374; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29159.6615; train_optim_loss: 29159.6615; val_kl_reg_loss: 2361.5946; val_edge_recon_loss: 25465.3220; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27826.9167; val_optim_loss: 27826.9167
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9954; val_auprc_score: 0.9930; val_best_acc_score: 0.9837; val_best_f1_score: 0.9839; train_kl_reg_loss: 2355.6099; train_edge_recon_loss: 26794.6658; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29150.2756; train_optim_loss: 29150.2756; val_kl_reg_loss: 2368.3116; val_edge_recon_loss: 25487.8266; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27856.1382; val_optim_loss: 27856.1382
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9960; val_auprc_score: 0.9941; val_best_acc_score: 0.9843; val_best_f1_score: 0.9844; train_kl_reg_loss: 2357.4643; train_edge_recon_loss: 26786.4592; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29143.9234; train_optim_loss: 29143.9234; val_kl_reg_loss: 2407.7593; val_edge_recon_loss: 25482.2335; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27889.9927; val_optim_loss: 27889.9927
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9962; val_auprc_score: 0.9946; val_best_acc_score: 0.9850; val_best_f1_score: 0.9852; train_kl_reg_loss: 2359.3238; train_edge_recon_loss: 26776.5884; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29135.9122; train_optim_loss: 29135.9122; val_kl_reg_loss: 2374.4059; val_edge_recon_loss: 25464.7107; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27839.1167; val_optim_loss: 27839.1167
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9963; val_auprc_score: 0.9943; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 2360.3182; train_edge_recon_loss: 26772.7248; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29133.0430; train_optim_loss: 29133.0430; val_kl_reg_loss: 2371.7911; val_edge_recon_loss: 25425.8733; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27797.6643; val_optim_loss: 27797.6643
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9967; val_auprc_score: 0.9953; val_best_acc_score: 0.9862; val_best_f1_score: 0.9863; train_kl_reg_loss: 2361.7194; train_edge_recon_loss: 26765.1475; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29126.8668; train_optim_loss: 29126.8668; val_kl_reg_loss: 2383.5650; val_edge_recon_loss: 25431.5465; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27815.1114; val_optim_loss: 27815.1114
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9965; val_auprc_score: 0.9947; val_best_acc_score: 0.9862; val_best_f1_score: 0.9863; train_kl_reg_loss: 2362.6101; train_edge_recon_loss: 26758.6971; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29121.3072; train_optim_loss: 29121.3072; val_kl_reg_loss: 2338.8789; val_edge_recon_loss: 25433.0608; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27771.9397; val_optim_loss: 27771.9397
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9963; val_auprc_score: 0.9942; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 2363.3501; train_edge_recon_loss: 26753.9594; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29117.3096; train_optim_loss: 29117.3096; val_kl_reg_loss: 2359.5189; val_edge_recon_loss: 25443.3262; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27802.8450; val_optim_loss: 27802.8450
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9968; val_auprc_score: 0.9953; val_best_acc_score: 0.9871; val_best_f1_score: 0.9872; train_kl_reg_loss: 2365.1012; train_edge_recon_loss: 26745.6852; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29110.7864; train_optim_loss: 29110.7864; val_kl_reg_loss: 2391.7352; val_edge_recon_loss: 25415.7804; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27807.5156; val_optim_loss: 27807.5156
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9968; val_auprc_score: 0.9947; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 2364.0298; train_edge_recon_loss: 26746.7730; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29110.8028; train_optim_loss: 29110.8028; val_kl_reg_loss: 2362.3645; val_edge_recon_loss: 25412.7537; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27775.1182; val_optim_loss: 27775.1182
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9968; val_auprc_score: 0.9947; val_best_acc_score: 0.9874; val_best_f1_score: 0.9875; train_kl_reg_loss: 2365.4310; train_edge_recon_loss: 26737.5243; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29102.9554; train_optim_loss: 29102.9554; val_kl_reg_loss: 2357.0263; val_edge_recon_loss: 25434.0154; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27791.0418; val_optim_loss: 27791.0418

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9968; val_auprc_score: 0.9949; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 2357.7171; train_edge_recon_loss: 26723.7147; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29081.4318; train_optim_loss: 29081.4318; val_kl_reg_loss: 2375.9640; val_edge_recon_loss: 25398.0438; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27774.0078; val_optim_loss: 27774.0078
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9970; val_auprc_score: 0.9952; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 2358.1705; train_edge_recon_loss: 26719.5918; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29077.7623; train_optim_loss: 29077.7623; val_kl_reg_loss: 2383.5117; val_edge_recon_loss: 25398.0797; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27781.5913; val_optim_loss: 27781.5913
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9970; val_auprc_score: 0.9952; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 2358.1217; train_edge_recon_loss: 26716.6716; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29074.7933; train_optim_loss: 29074.7933; val_kl_reg_loss: 2378.9606; val_edge_recon_loss: 25400.8952; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27779.8558; val_optim_loss: 27779.8558
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9970; val_auprc_score: 0.9953; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 2356.7357; train_edge_recon_loss: 26722.2146; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29078.9504; train_optim_loss: 29078.9504; val_kl_reg_loss: 2384.4462; val_edge_recon_loss: 25395.6206; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27780.0668; val_optim_loss: 27780.0668

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 170 min 13 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
Val AUROC score: 0.9966
Val AUPRC score: 0.9950
Val best accuracy score: 0.9862
Val best F1 score: 0.9863
Val target rna MSE score: 0.9684
Val source rna MSE score: 0.3148

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
