None
Run timestamp: 16072023_011949_1012.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_1012']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9446; val_auprc_score: 0.9308; val_best_acc_score: 0.8834; val_best_f1_score: 0.8912; train_kl_reg_loss: 19407.5208; train_edge_recon_loss: 26942799.6088; train_gene_expr_recon_loss: 13264668.4324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40226875.5294; train_optim_loss: 40226875.5294; val_kl_reg_loss: 20471.4786; val_edge_recon_loss: 26875550.2895; val_gene_expr_recon_loss: 12710033.6842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39606055.3684; val_optim_loss: 39606055.3684
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9624; val_auprc_score: 0.9541; val_best_acc_score: 0.9040; val_best_f1_score: 0.9078; train_kl_reg_loss: 18343.7687; train_edge_recon_loss: 26255148.2794; train_gene_expr_recon_loss: 12384341.3603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38657833.4353; train_optim_loss: 38657833.4353; val_kl_reg_loss: 17011.8902; val_edge_recon_loss: 26841765.2895; val_gene_expr_recon_loss: 12142090.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39000867.9474; val_optim_loss: 39000867.9474
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9666; val_auprc_score: 0.9576; val_best_acc_score: 0.9136; val_best_f1_score: 0.9167; train_kl_reg_loss: 17155.2647; train_edge_recon_loss: 26152638.8882; train_gene_expr_recon_loss: 12004819.9368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38174614.1353; train_optim_loss: 38174614.1353; val_kl_reg_loss: 16844.6444; val_edge_recon_loss: 26760641.6842; val_gene_expr_recon_loss: 11876790.4868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38654276.6842; val_optim_loss: 38654276.6842
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9669; val_auprc_score: 0.9574; val_best_acc_score: 0.9173; val_best_f1_score: 0.9204; train_kl_reg_loss: 16985.7338; train_edge_recon_loss: 26106904.3941; train_gene_expr_recon_loss: 11780039.3676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37903929.4471; train_optim_loss: 37903929.4471; val_kl_reg_loss: 16676.2396; val_edge_recon_loss: 26674080.6316; val_gene_expr_recon_loss: 11665110.0789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38355866.7368; val_optim_loss: 38355866.7368
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9696; val_auprc_score: 0.9624; val_best_acc_score: 0.9179; val_best_f1_score: 0.9205; train_kl_reg_loss: 16824.1946; train_edge_recon_loss: 26087706.6118; train_gene_expr_recon_loss: 11630976.2574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37735507.0118; train_optim_loss: 37735507.0118; val_kl_reg_loss: 16355.9072; val_edge_recon_loss: 26733863.1842; val_gene_expr_recon_loss: 11550407.5132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38300626.8947; val_optim_loss: 38300626.8947
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9697; val_auprc_score: 0.9617; val_best_acc_score: 0.9203; val_best_f1_score: 0.9231; train_kl_reg_loss: 17056.4273; train_edge_recon_loss: 26081670.2559; train_gene_expr_recon_loss: 11538361.6824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37637088.3471; train_optim_loss: 37637088.3471; val_kl_reg_loss: 16806.8944; val_edge_recon_loss: 26662974.6579; val_gene_expr_recon_loss: 11525448.6579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38205230.4211; val_optim_loss: 38205230.4211
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9711; val_auprc_score: 0.9630; val_best_acc_score: 0.9238; val_best_f1_score: 0.9266; train_kl_reg_loss: 16752.8651; train_edge_recon_loss: 26060258.9294; train_gene_expr_recon_loss: 11476503.9471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37553515.8471; train_optim_loss: 37553515.8471; val_kl_reg_loss: 14658.0785; val_edge_recon_loss: 26612079.1842; val_gene_expr_recon_loss: 11496392.1184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38123129.5263; val_optim_loss: 38123129.5263
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9706; val_auprc_score: 0.9628; val_best_acc_score: 0.9207; val_best_f1_score: 0.9233; train_kl_reg_loss: 16911.3524; train_edge_recon_loss: 26025146.8941; train_gene_expr_recon_loss: 11422659.7426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37464717.9529; train_optim_loss: 37464717.9529; val_kl_reg_loss: 17062.1984; val_edge_recon_loss: 26610115.3947; val_gene_expr_recon_loss: 11424927.9868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38052105.6842; val_optim_loss: 38052105.6842
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9726; val_auprc_score: 0.9648; val_best_acc_score: 0.9246; val_best_f1_score: 0.9273; train_kl_reg_loss: 16927.4800; train_edge_recon_loss: 26030850.8206; train_gene_expr_recon_loss: 11399841.8250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37447620.1412; train_optim_loss: 37447620.1412; val_kl_reg_loss: 16778.4205; val_edge_recon_loss: 26566639.0263; val_gene_expr_recon_loss: 11384682.9079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37968100.3684; val_optim_loss: 37968100.3684
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9725; val_auprc_score: 0.9649; val_best_acc_score: 0.9249; val_best_f1_score: 0.9274; train_kl_reg_loss: 16918.0746; train_edge_recon_loss: 26033013.9912; train_gene_expr_recon_loss: 11365378.2397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37415310.4118; train_optim_loss: 37415310.4118; val_kl_reg_loss: 16587.5818; val_edge_recon_loss: 26593944.0000; val_gene_expr_recon_loss: 11416940.7105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38027472.3684; val_optim_loss: 38027472.3684
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9728; val_auprc_score: 0.9657; val_best_acc_score: 0.9251; val_best_f1_score: 0.9276; train_kl_reg_loss: 16914.8164; train_edge_recon_loss: 26021461.1794; train_gene_expr_recon_loss: 11349691.6176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37388067.6000; train_optim_loss: 37388067.6000; val_kl_reg_loss: 16309.2342; val_edge_recon_loss: 26605938.0263; val_gene_expr_recon_loss: 11363625.7632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37985873.0526; val_optim_loss: 37985873.0526
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9743; val_auprc_score: 0.9674; val_best_acc_score: 0.9284; val_best_f1_score: 0.9304; train_kl_reg_loss: 16977.8989; train_edge_recon_loss: 26007307.6176; train_gene_expr_recon_loss: 11340290.0765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37364575.6176; train_optim_loss: 37364575.6176; val_kl_reg_loss: 16773.7895; val_edge_recon_loss: 26525174.3158; val_gene_expr_recon_loss: 11363304.0789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37905252.1579; val_optim_loss: 37905252.1579
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9732; val_auprc_score: 0.9654; val_best_acc_score: 0.9271; val_best_f1_score: 0.9294; train_kl_reg_loss: 16907.0512; train_edge_recon_loss: 26004523.6324; train_gene_expr_recon_loss: 11328149.4956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37349580.2000; train_optim_loss: 37349580.2000; val_kl_reg_loss: 15431.5558; val_edge_recon_loss: 26566702.7895; val_gene_expr_recon_loss: 11389409.1579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37971543.5263; val_optim_loss: 37971543.5263
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9745; val_auprc_score: 0.9673; val_best_acc_score: 0.9281; val_best_f1_score: 0.9302; train_kl_reg_loss: 16951.9787; train_edge_recon_loss: 26006421.9147; train_gene_expr_recon_loss: 11320314.4691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37343688.4471; train_optim_loss: 37343688.4471; val_kl_reg_loss: 16754.7373; val_edge_recon_loss: 26555099.4474; val_gene_expr_recon_loss: 11337587.0395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37909441.2105; val_optim_loss: 37909441.2105
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9732; val_auprc_score: 0.9650; val_best_acc_score: 0.9265; val_best_f1_score: 0.9291; train_kl_reg_loss: 16913.7731; train_edge_recon_loss: 25986091.8147; train_gene_expr_recon_loss: 11314166.5897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37317172.1588; train_optim_loss: 37317172.1588; val_kl_reg_loss: 16408.5783; val_edge_recon_loss: 26519488.7895; val_gene_expr_recon_loss: 11335585.7632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37871483.0000; val_optim_loss: 37871483.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9742; val_auprc_score: 0.9674; val_best_acc_score: 0.9275; val_best_f1_score: 0.9299; train_kl_reg_loss: 16931.2260; train_edge_recon_loss: 25965401.8500; train_gene_expr_recon_loss: 11307621.3000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37289954.2765; train_optim_loss: 37289954.2765; val_kl_reg_loss: 16651.1890; val_edge_recon_loss: 26534441.1053; val_gene_expr_recon_loss: 11309658.0921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37860750.3684; val_optim_loss: 37860750.3684
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9740; val_auprc_score: 0.9670; val_best_acc_score: 0.9266; val_best_f1_score: 0.9289; train_kl_reg_loss: 16906.4075; train_edge_recon_loss: 25970621.1088; train_gene_expr_recon_loss: 11301291.3603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37288818.9118; train_optim_loss: 37288818.9118; val_kl_reg_loss: 16357.4730; val_edge_recon_loss: 26513638.8947; val_gene_expr_recon_loss: 11380780.0395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37910776.3684; val_optim_loss: 37910776.3684
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9753; val_auprc_score: 0.9675; val_best_acc_score: 0.9306; val_best_f1_score: 0.9325; train_kl_reg_loss: 16915.0698; train_edge_recon_loss: 25977519.7824; train_gene_expr_recon_loss: 11297847.1897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37292282.0471; train_optim_loss: 37292282.0471; val_kl_reg_loss: 16661.5642; val_edge_recon_loss: 26452479.9211; val_gene_expr_recon_loss: 11339370.1053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37808511.3684; val_optim_loss: 37808511.3684
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9746; val_auprc_score: 0.9668; val_best_acc_score: 0.9296; val_best_f1_score: 0.9320; train_kl_reg_loss: 16866.2749; train_edge_recon_loss: 25968122.3824; train_gene_expr_recon_loss: 11294146.5824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37279135.2353; train_optim_loss: 37279135.2353; val_kl_reg_loss: 16399.8876; val_edge_recon_loss: 26504112.3684; val_gene_expr_recon_loss: 11364269.8026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37884782.2105; val_optim_loss: 37884782.2105
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9743; val_auprc_score: 0.9665; val_best_acc_score: 0.9285; val_best_f1_score: 0.9309; train_kl_reg_loss: 16933.4323; train_edge_recon_loss: 25956067.0176; train_gene_expr_recon_loss: 11291027.1397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37264027.5412; train_optim_loss: 37264027.5412; val_kl_reg_loss: 16442.3076; val_edge_recon_loss: 26539705.6842; val_gene_expr_recon_loss: 11334742.1184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37890890.1053; val_optim_loss: 37890890.1053
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9752; val_auprc_score: 0.9679; val_best_acc_score: 0.9306; val_best_f1_score: 0.9327; train_kl_reg_loss: 16874.1310; train_edge_recon_loss: 25945758.9059; train_gene_expr_recon_loss: 11291200.3162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37253833.3353; train_optim_loss: 37253833.3353; val_kl_reg_loss: 16574.1557; val_edge_recon_loss: 26501098.7105; val_gene_expr_recon_loss: 11335171.3553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37852844.3158; val_optim_loss: 37852844.3158
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9761; val_auprc_score: 0.9689; val_best_acc_score: 0.9317; val_best_f1_score: 0.9335; train_kl_reg_loss: 16946.0363; train_edge_recon_loss: 25957952.5265; train_gene_expr_recon_loss: 11283995.1147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37258893.5471; train_optim_loss: 37258893.5471; val_kl_reg_loss: 16662.2567; val_edge_recon_loss: 26474876.7368; val_gene_expr_recon_loss: 11331715.8947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37823255.1579; val_optim_loss: 37823255.1579

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9757; val_auprc_score: 0.9685; val_best_acc_score: 0.9315; val_best_f1_score: 0.9340; train_kl_reg_loss: 17725.4489; train_edge_recon_loss: 25929828.8676; train_gene_expr_recon_loss: 11182649.7721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37130204.1176; train_optim_loss: 37130204.1176; val_kl_reg_loss: 17193.3250; val_edge_recon_loss: 26451432.9474; val_gene_expr_recon_loss: 11217460.0789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37686086.4211; val_optim_loss: 37686086.4211
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9760; val_auprc_score: 0.9691; val_best_acc_score: 0.9315; val_best_f1_score: 0.9335; train_kl_reg_loss: 17256.6675; train_edge_recon_loss: 25930124.1765; train_gene_expr_recon_loss: 11173063.1176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37120443.9235; train_optim_loss: 37120443.9235; val_kl_reg_loss: 16769.5308; val_edge_recon_loss: 26451566.8421; val_gene_expr_recon_loss: 11231178.1842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37699514.3158; val_optim_loss: 37699514.3158
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9758; val_auprc_score: 0.9686; val_best_acc_score: 0.9322; val_best_f1_score: 0.9342; train_kl_reg_loss: 16964.9079; train_edge_recon_loss: 25926218.9618; train_gene_expr_recon_loss: 11169512.5971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37112696.5647; train_optim_loss: 37112696.5647; val_kl_reg_loss: 16534.6182; val_edge_recon_loss: 26426105.4211; val_gene_expr_recon_loss: 11209754.9868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37652395.1579; val_optim_loss: 37652395.1579
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9760; val_auprc_score: 0.9685; val_best_acc_score: 0.9321; val_best_f1_score: 0.9342; train_kl_reg_loss: 16796.7152; train_edge_recon_loss: 25916567.3235; train_gene_expr_recon_loss: 11170199.3162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37103563.3412; train_optim_loss: 37103563.3412; val_kl_reg_loss: 16446.5875; val_edge_recon_loss: 26438234.0789; val_gene_expr_recon_loss: 11196491.2763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37651172.0000; val_optim_loss: 37651172.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9762; val_auprc_score: 0.9691; val_best_acc_score: 0.9317; val_best_f1_score: 0.9337; train_kl_reg_loss: 16736.5317; train_edge_recon_loss: 25906215.4824; train_gene_expr_recon_loss: 11164380.8500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37087332.9588; train_optim_loss: 37087332.9588; val_kl_reg_loss: 16336.4618; val_edge_recon_loss: 26463410.3158; val_gene_expr_recon_loss: 11181753.1842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37661500.0526; val_optim_loss: 37661500.0526
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9758; val_auprc_score: 0.9684; val_best_acc_score: 0.9306; val_best_f1_score: 0.9327; train_kl_reg_loss: 16705.1213; train_edge_recon_loss: 25909520.0471; train_gene_expr_recon_loss: 11163494.0485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37089719.1412; train_optim_loss: 37089719.1412; val_kl_reg_loss: 16361.8386; val_edge_recon_loss: 26458591.6316; val_gene_expr_recon_loss: 11205380.8684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37680334.2632; val_optim_loss: 37680334.2632
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9756; val_auprc_score: 0.9675; val_best_acc_score: 0.9318; val_best_f1_score: 0.9338; train_kl_reg_loss: 16677.1632; train_edge_recon_loss: 25916072.2029; train_gene_expr_recon_loss: 11167303.2015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37100052.5765; train_optim_loss: 37100052.5765; val_kl_reg_loss: 16255.0351; val_edge_recon_loss: 26456747.7895; val_gene_expr_recon_loss: 11213326.0526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37686328.8947; val_optim_loss: 37686328.8947
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9762; val_auprc_score: 0.9692; val_best_acc_score: 0.9320; val_best_f1_score: 0.9340; train_kl_reg_loss: 16673.3292; train_edge_recon_loss: 25917223.6676; train_gene_expr_recon_loss: 11164394.0574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37098291.0353; train_optim_loss: 37098291.0353; val_kl_reg_loss: 16291.7854; val_edge_recon_loss: 26461685.4737; val_gene_expr_recon_loss: 11215266.8026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37693244.0526; val_optim_loss: 37693244.0526

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9771; val_auprc_score: 0.9703; val_best_acc_score: 0.9326; val_best_f1_score: 0.9348; train_kl_reg_loss: 16703.4748; train_edge_recon_loss: 25903173.3500; train_gene_expr_recon_loss: 11151011.7162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37070888.5529; train_optim_loss: 37070888.5529; val_kl_reg_loss: 16398.8259; val_edge_recon_loss: 26429147.3947; val_gene_expr_recon_loss: 11212080.7632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37657626.6842; val_optim_loss: 37657626.6842
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9764; val_auprc_score: 0.9694; val_best_acc_score: 0.9324; val_best_f1_score: 0.9344; train_kl_reg_loss: 16765.4819; train_edge_recon_loss: 25898324.2912; train_gene_expr_recon_loss: 11148367.9662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37063457.7000; train_optim_loss: 37063457.7000; val_kl_reg_loss: 16456.8737; val_edge_recon_loss: 26439826.6579; val_gene_expr_recon_loss: 11206643.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37662926.7368; val_optim_loss: 37662926.7368
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9766; val_auprc_score: 0.9697; val_best_acc_score: 0.9326; val_best_f1_score: 0.9345; train_kl_reg_loss: 16795.5753; train_edge_recon_loss: 25910587.6118; train_gene_expr_recon_loss: 11147447.5662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37074830.8294; train_optim_loss: 37074830.8294; val_kl_reg_loss: 16471.4213; val_edge_recon_loss: 26444763.7632; val_gene_expr_recon_loss: 11185563.4868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37646798.8421; val_optim_loss: 37646798.8421
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9769; val_auprc_score: 0.9702; val_best_acc_score: 0.9331; val_best_f1_score: 0.9349; train_kl_reg_loss: 16805.7217; train_edge_recon_loss: 25912552.9059; train_gene_expr_recon_loss: 11146275.9574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37075634.6000; train_optim_loss: 37075634.6000; val_kl_reg_loss: 16451.1418; val_edge_recon_loss: 26408305.4737; val_gene_expr_recon_loss: 11199456.5263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37624213.1579; val_optim_loss: 37624213.1579
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9760; val_auprc_score: 0.9684; val_best_acc_score: 0.9324; val_best_f1_score: 0.9345; train_kl_reg_loss: 16795.6643; train_edge_recon_loss: 25895719.6147; train_gene_expr_recon_loss: 11146279.7221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37058795.0824; train_optim_loss: 37058795.0824; val_kl_reg_loss: 16446.1412; val_edge_recon_loss: 26409349.7895; val_gene_expr_recon_loss: 11178227.7895; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37604023.5789; val_optim_loss: 37604023.5789
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9759; val_auprc_score: 0.9687; val_best_acc_score: 0.9308; val_best_f1_score: 0.9330; train_kl_reg_loss: 16794.9551; train_edge_recon_loss: 25919318.4235; train_gene_expr_recon_loss: 11144674.9529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37080788.3706; train_optim_loss: 37080788.3706; val_kl_reg_loss: 16433.3409; val_edge_recon_loss: 26495034.6842; val_gene_expr_recon_loss: 11196373.9211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37707842.1053; val_optim_loss: 37707842.1053
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9769; val_auprc_score: 0.9703; val_best_acc_score: 0.9329; val_best_f1_score: 0.9350; train_kl_reg_loss: 16777.8176; train_edge_recon_loss: 25899082.3941; train_gene_expr_recon_loss: 11140529.0662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37056389.2353; train_optim_loss: 37056389.2353; val_kl_reg_loss: 16433.4807; val_edge_recon_loss: 26437143.5000; val_gene_expr_recon_loss: 11180898.6579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37634475.7895; val_optim_loss: 37634475.7895
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9773; val_auprc_score: 0.9704; val_best_acc_score: 0.9336; val_best_f1_score: 0.9356; train_kl_reg_loss: 16775.8771; train_edge_recon_loss: 25898138.7088; train_gene_expr_recon_loss: 11142389.0441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37057303.6588; train_optim_loss: 37057303.6588; val_kl_reg_loss: 16411.1914; val_edge_recon_loss: 26394933.0000; val_gene_expr_recon_loss: 11186069.8816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37597414.1579; val_optim_loss: 37597414.1579
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9773; val_auprc_score: 0.9710; val_best_acc_score: 0.9339; val_best_f1_score: 0.9357; train_kl_reg_loss: 16762.1842; train_edge_recon_loss: 25887242.1235; train_gene_expr_recon_loss: 11146630.9088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37050635.1588; train_optim_loss: 37050635.1588; val_kl_reg_loss: 16412.6763; val_edge_recon_loss: 26419703.6053; val_gene_expr_recon_loss: 11174377.9211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37610494.1053; val_optim_loss: 37610494.1053
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9760; val_auprc_score: 0.9691; val_best_acc_score: 0.9321; val_best_f1_score: 0.9340; train_kl_reg_loss: 16751.6268; train_edge_recon_loss: 25912759.6588; train_gene_expr_recon_loss: 11143086.3279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37072597.6000; train_optim_loss: 37072597.6000; val_kl_reg_loss: 16394.8059; val_edge_recon_loss: 26500393.2368; val_gene_expr_recon_loss: 11169870.9342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37686659.1053; val_optim_loss: 37686659.1053
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9767; val_auprc_score: 0.9701; val_best_acc_score: 0.9321; val_best_f1_score: 0.9341; train_kl_reg_loss: 16739.7051; train_edge_recon_loss: 25901665.9500; train_gene_expr_recon_loss: 11145722.3941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37064128.0765; train_optim_loss: 37064128.0765; val_kl_reg_loss: 16386.1535; val_edge_recon_loss: 26431920.5263; val_gene_expr_recon_loss: 11179878.8684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37628185.8421; val_optim_loss: 37628185.8421
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9767; val_auprc_score: 0.9696; val_best_acc_score: 0.9332; val_best_f1_score: 0.9350; train_kl_reg_loss: 16745.8824; train_edge_recon_loss: 25899831.6647; train_gene_expr_recon_loss: 11147211.7676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37063789.2588; train_optim_loss: 37063789.2588; val_kl_reg_loss: 16407.0339; val_edge_recon_loss: 26428248.4474; val_gene_expr_recon_loss: 11190722.6974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37635378.0526; val_optim_loss: 37635378.0526

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9773; val_auprc_score: 0.9706; val_best_acc_score: 0.9332; val_best_f1_score: 0.9349; train_kl_reg_loss: 16749.0069; train_edge_recon_loss: 25918252.4235; train_gene_expr_recon_loss: 11147920.5868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37082921.9588; train_optim_loss: 37082921.9588; val_kl_reg_loss: 16406.2484; val_edge_recon_loss: 26436763.6316; val_gene_expr_recon_loss: 11192270.8289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37645440.8421; val_optim_loss: 37645440.8421
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9764; val_auprc_score: 0.9694; val_best_acc_score: 0.9325; val_best_f1_score: 0.9347; train_kl_reg_loss: 16752.4519; train_edge_recon_loss: 25911919.1529; train_gene_expr_recon_loss: 11145261.6368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37073933.2176; train_optim_loss: 37073933.2176; val_kl_reg_loss: 16416.3365; val_edge_recon_loss: 26457468.6842; val_gene_expr_recon_loss: 11207475.4474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37681360.4211; val_optim_loss: 37681360.4211
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9759; val_auprc_score: 0.9687; val_best_acc_score: 0.9315; val_best_f1_score: 0.9335; train_kl_reg_loss: 16752.6164; train_edge_recon_loss: 25904766.3176; train_gene_expr_recon_loss: 11145254.0676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37066773.0000; train_optim_loss: 37066773.0000; val_kl_reg_loss: 16411.5674; val_edge_recon_loss: 26466123.1053; val_gene_expr_recon_loss: 11210425.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37692959.7895; val_optim_loss: 37692959.7895
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9777; val_auprc_score: 0.9712; val_best_acc_score: 0.9336; val_best_f1_score: 0.9354; train_kl_reg_loss: 16749.6819; train_edge_recon_loss: 25908857.2059; train_gene_expr_recon_loss: 11147843.8397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37073450.7000; train_optim_loss: 37073450.7000; val_kl_reg_loss: 16411.6971; val_edge_recon_loss: 26410515.8421; val_gene_expr_recon_loss: 11179370.1974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37606297.7895; val_optim_loss: 37606297.7895

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 90 min 35 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9765
Val AUPRC score: 0.9695
Val best accuracy score: 0.9326
Val best F1 score: 0.9347
Val gene expr MSE score: 2.6248

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
