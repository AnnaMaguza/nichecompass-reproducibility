None
Run timestamp: 24072023_201415_15.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '20', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_15']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 915209
Number of validation edges: 101689
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9855; val_auprc_score: 0.9809; val_best_acc_score: 0.9510; val_best_f1_score: 0.9523; train_kl_reg_loss: 92591.1895; train_edge_recon_loss: 26524373.4922; train_gene_expr_recon_loss: 11280391.5509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37897356.2148; train_optim_loss: 37897356.2148; val_kl_reg_loss: 90352.8611; val_edge_recon_loss: 25990957.4171; val_gene_expr_recon_loss: 10465572.5829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36546882.9146; val_optim_loss: 36546882.9146
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9882; val_auprc_score: 0.9845; val_best_acc_score: 0.9581; val_best_f1_score: 0.9590; train_kl_reg_loss: 82179.0285; train_edge_recon_loss: 25890086.5168; train_gene_expr_recon_loss: 10292733.6216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36264999.0962; train_optim_loss: 36264999.0962; val_kl_reg_loss: 73300.8951; val_edge_recon_loss: 25833715.4874; val_gene_expr_recon_loss: 10146400.4724; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36053416.7839; val_optim_loss: 36053416.7839
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9903; val_auprc_score: 0.9874; val_best_acc_score: 0.9639; val_best_f1_score: 0.9647; train_kl_reg_loss: 68931.2894; train_edge_recon_loss: 25769783.5582; train_gene_expr_recon_loss: 10082948.7545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35921663.6018; train_optim_loss: 35921663.6018; val_kl_reg_loss: 61534.4814; val_edge_recon_loss: 25755640.3920; val_gene_expr_recon_loss: 10010502.8543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35827677.7688; val_optim_loss: 35827677.7688
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9916; val_auprc_score: 0.9886; val_best_acc_score: 0.9688; val_best_f1_score: 0.9693; train_kl_reg_loss: 60585.5371; train_edge_recon_loss: 25686293.1868; train_gene_expr_recon_loss: 9987306.8781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35734185.5772; train_optim_loss: 35734185.5772; val_kl_reg_loss: 55696.3069; val_edge_recon_loss: 25728807.3668; val_gene_expr_recon_loss: 9956572.3920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35741076.1005; val_optim_loss: 35741076.1005
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9933; val_auprc_score: 0.9911; val_best_acc_score: 0.9722; val_best_f1_score: 0.9726; train_kl_reg_loss: 55592.1438; train_edge_recon_loss: 25649134.0548; train_gene_expr_recon_loss: 9925469.1535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35630195.2975; train_optim_loss: 35630195.2975; val_kl_reg_loss: 52851.1681; val_edge_recon_loss: 25674553.2563; val_gene_expr_recon_loss: 9895845.1709; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35623249.5276; val_optim_loss: 35623249.5276
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9937; val_auprc_score: 0.9915; val_best_acc_score: 0.9755; val_best_f1_score: 0.9758; train_kl_reg_loss: 51490.0726; train_edge_recon_loss: 25607041.6309; train_gene_expr_recon_loss: 9885911.7989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35544443.4944; train_optim_loss: 35544443.4944; val_kl_reg_loss: 49636.8409; val_edge_recon_loss: 25625127.7186; val_gene_expr_recon_loss: 9887379.0854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35562143.5578; val_optim_loss: 35562143.5578
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9948; val_auprc_score: 0.9929; val_best_acc_score: 0.9783; val_best_f1_score: 0.9786; train_kl_reg_loss: 48963.8186; train_edge_recon_loss: 25578374.5034; train_gene_expr_recon_loss: 9844836.6784; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35472174.9944; train_optim_loss: 35472174.9944; val_kl_reg_loss: 47507.4217; val_edge_recon_loss: 25600238.2513; val_gene_expr_recon_loss: 9939534.1281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35587279.8593; val_optim_loss: 35587279.8593
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9949; val_auprc_score: 0.9932; val_best_acc_score: 0.9789; val_best_f1_score: 0.9792; train_kl_reg_loss: 47078.3831; train_edge_recon_loss: 25555363.9709; train_gene_expr_recon_loss: 9760586.1988; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35363028.5548; train_optim_loss: 35363028.5548; val_kl_reg_loss: 45223.4442; val_edge_recon_loss: 25581533.4271; val_gene_expr_recon_loss: 9672509.7186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35299266.3719; val_optim_loss: 35299266.3719
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9950; val_auprc_score: 0.9928; val_best_acc_score: 0.9799; val_best_f1_score: 0.9801; train_kl_reg_loss: 45505.5227; train_edge_recon_loss: 25542499.4407; train_gene_expr_recon_loss: 9568997.5235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35157002.5503; train_optim_loss: 35157002.5503; val_kl_reg_loss: 44144.0399; val_edge_recon_loss: 25572221.2362; val_gene_expr_recon_loss: 9631468.3442; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35247833.5477; val_optim_loss: 35247833.5477
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9955; val_auprc_score: 0.9941; val_best_acc_score: 0.9805; val_best_f1_score: 0.9808; train_kl_reg_loss: 44238.8056; train_edge_recon_loss: 25539981.0213; train_gene_expr_recon_loss: 9170868.2128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34755088.0347; train_optim_loss: 34755088.0347; val_kl_reg_loss: 43205.8212; val_edge_recon_loss: 25561580.0302; val_gene_expr_recon_loss: 9049820.6131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34654606.4523; val_optim_loss: 34654606.4523
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9959; val_auprc_score: 0.9946; val_best_acc_score: 0.9814; val_best_f1_score: 0.9815; train_kl_reg_loss: 43104.4442; train_edge_recon_loss: 25526345.9653; train_gene_expr_recon_loss: 8759973.3272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34329423.6488; train_optim_loss: 34329423.6488; val_kl_reg_loss: 42052.6599; val_edge_recon_loss: 25548663.3166; val_gene_expr_recon_loss: 8748571.5854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34339287.6683; val_optim_loss: 34339287.6683
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9961; val_auprc_score: 0.9947; val_best_acc_score: 0.9819; val_best_f1_score: 0.9821; train_kl_reg_loss: 42290.5660; train_edge_recon_loss: 25526058.2931; train_gene_expr_recon_loss: 8344923.6541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33913272.5380; train_optim_loss: 33913272.5380; val_kl_reg_loss: 41157.6553; val_edge_recon_loss: 25551806.3719; val_gene_expr_recon_loss: 8680273.2814; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34273237.2965; val_optim_loss: 34273237.2965
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9963; val_auprc_score: 0.9950; val_best_acc_score: 0.9825; val_best_f1_score: 0.9827; train_kl_reg_loss: 41367.6648; train_edge_recon_loss: 25509549.0738; train_gene_expr_recon_loss: 8046595.7472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33597512.5011; train_optim_loss: 33597512.5011; val_kl_reg_loss: 40616.0621; val_edge_recon_loss: 25554000.3216; val_gene_expr_recon_loss: 8081889.0779; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33676505.5377; val_optim_loss: 33676505.5377
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9964; val_auprc_score: 0.9952; val_best_acc_score: 0.9830; val_best_f1_score: 0.9832; train_kl_reg_loss: 41046.9605; train_edge_recon_loss: 25510383.7640; train_gene_expr_recon_loss: 7936870.2117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33488300.9228; train_optim_loss: 33488300.9228; val_kl_reg_loss: 40354.0285; val_edge_recon_loss: 25531798.6533; val_gene_expr_recon_loss: 8099796.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33671948.8442; val_optim_loss: 33671948.8442
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9966; val_auprc_score: 0.9955; val_best_acc_score: 0.9831; val_best_f1_score: 0.9833; train_kl_reg_loss: 40514.4723; train_edge_recon_loss: 25500174.0626; train_gene_expr_recon_loss: 7914899.8599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33455588.4172; train_optim_loss: 33455588.4172; val_kl_reg_loss: 38731.4379; val_edge_recon_loss: 25506765.3367; val_gene_expr_recon_loss: 8118815.2990; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33664312.0101; val_optim_loss: 33664312.0101
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9967; val_auprc_score: 0.9954; val_best_acc_score: 0.9841; val_best_f1_score: 0.9843; train_kl_reg_loss: 40050.0031; train_edge_recon_loss: 25496268.4687; train_gene_expr_recon_loss: 7901252.4869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33437570.9116; train_optim_loss: 33437570.9116; val_kl_reg_loss: 39514.0778; val_edge_recon_loss: 25497308.2814; val_gene_expr_recon_loss: 8060936.3216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33597758.6734; val_optim_loss: 33597758.6734
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9967; val_auprc_score: 0.9955; val_best_acc_score: 0.9843; val_best_f1_score: 0.9844; train_kl_reg_loss: 39531.2805; train_edge_recon_loss: 25487895.1119; train_gene_expr_recon_loss: 7888531.8893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33415958.2886; train_optim_loss: 33415958.2886; val_kl_reg_loss: 39216.9126; val_edge_recon_loss: 25508032.7136; val_gene_expr_recon_loss: 8054985.0075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33602234.5327; val_optim_loss: 33602234.5327
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9969; val_auprc_score: 0.9958; val_best_acc_score: 0.9846; val_best_f1_score: 0.9847; train_kl_reg_loss: 39424.0497; train_edge_recon_loss: 25486388.2617; train_gene_expr_recon_loss: 7879578.7959; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33405391.0850; train_optim_loss: 33405391.0850; val_kl_reg_loss: 38590.5492; val_edge_recon_loss: 25500146.2613; val_gene_expr_recon_loss: 8072649.5905; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33611386.3920; val_optim_loss: 33611386.3920
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9971; val_auprc_score: 0.9961; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 39014.4494; train_edge_recon_loss: 25483470.8490; train_gene_expr_recon_loss: 7869294.5383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33391779.8658; train_optim_loss: 33391779.8658; val_kl_reg_loss: 37606.7182; val_edge_recon_loss: 25486036.4824; val_gene_expr_recon_loss: 8073838.0955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33597481.3769; val_optim_loss: 33597481.3769
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9970; val_auprc_score: 0.9960; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 38726.8069; train_edge_recon_loss: 25473952.2763; train_gene_expr_recon_loss: 7843349.4706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33356028.5492; train_optim_loss: 33356028.5492; val_kl_reg_loss: 38291.9650; val_edge_recon_loss: 25502389.6985; val_gene_expr_recon_loss: 8396934.5503; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33937616.3618; val_optim_loss: 33937616.3618
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9967; val_auprc_score: 0.9952; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 38384.1041; train_edge_recon_loss: 25478356.1253; train_gene_expr_recon_loss: 7853282.1994; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33370022.4485; train_optim_loss: 33370022.4485; val_kl_reg_loss: 36962.4495; val_edge_recon_loss: 25501716.6432; val_gene_expr_recon_loss: 8102181.6533; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33640860.6834; val_optim_loss: 33640860.6834
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9971; val_auprc_score: 0.9959; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 38154.6437; train_edge_recon_loss: 25468598.2617; train_gene_expr_recon_loss: 7827542.2794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33334295.1991; train_optim_loss: 33334295.1991; val_kl_reg_loss: 37237.1469; val_edge_recon_loss: 25484011.2663; val_gene_expr_recon_loss: 8067466.6432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33588715.0854; val_optim_loss: 33588715.0854
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9973; val_auprc_score: 0.9965; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 38141.9072; train_edge_recon_loss: 25466427.6342; train_gene_expr_recon_loss: 7820408.6829; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33324978.2204; train_optim_loss: 33324978.2204; val_kl_reg_loss: 37202.3188; val_edge_recon_loss: 25478627.1658; val_gene_expr_recon_loss: 8070275.1683; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33586104.6533; val_optim_loss: 33586104.6533
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9972; val_auprc_score: 0.9963; val_best_acc_score: 0.9865; val_best_f1_score: 0.9866; train_kl_reg_loss: 37804.3109; train_edge_recon_loss: 25471405.6409; train_gene_expr_recon_loss: 7813830.9136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33323040.8568; train_optim_loss: 33323040.8568; val_kl_reg_loss: 36752.9975; val_edge_recon_loss: 25467961.5477; val_gene_expr_recon_loss: 8073972.9397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33578687.5075; val_optim_loss: 33578687.5075
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9971; val_auprc_score: 0.9960; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 37780.8189; train_edge_recon_loss: 25460265.9866; train_gene_expr_recon_loss: 7805765.3596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33303812.1387; train_optim_loss: 33303812.1387; val_kl_reg_loss: 37276.1120; val_edge_recon_loss: 25492580.6432; val_gene_expr_recon_loss: 8087712.5050; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33617569.1558; val_optim_loss: 33617569.1558
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9971; val_auprc_score: 0.9959; val_best_acc_score: 0.9867; val_best_f1_score: 0.9869; train_kl_reg_loss: 37737.8664; train_edge_recon_loss: 25460664.4094; train_gene_expr_recon_loss: 7799843.3272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33298245.5694; train_optim_loss: 33298245.5694; val_kl_reg_loss: 36884.6952; val_edge_recon_loss: 25466408.8241; val_gene_expr_recon_loss: 8087487.5503; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33590781.1156; val_optim_loss: 33590781.1156
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9969; val_auprc_score: 0.9956; val_best_acc_score: 0.9860; val_best_f1_score: 0.9862; train_kl_reg_loss: 37586.2202; train_edge_recon_loss: 25458217.5157; train_gene_expr_recon_loss: 7793744.7139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33289548.4139; train_optim_loss: 33289548.4139; val_kl_reg_loss: 36392.9482; val_edge_recon_loss: 25495945.9799; val_gene_expr_recon_loss: 8086684.3593; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33619023.2663; val_optim_loss: 33619023.2663
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9973; val_auprc_score: 0.9965; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 37528.3904; train_edge_recon_loss: 25452029.9497; train_gene_expr_recon_loss: 7788331.6149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33277889.9083; train_optim_loss: 33277889.9083; val_kl_reg_loss: 37305.3939; val_edge_recon_loss: 25479609.5377; val_gene_expr_recon_loss: 8101373.8995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33618288.8543; val_optim_loss: 33618288.8543

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9973; val_auprc_score: 0.9964; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 40932.0846; train_edge_recon_loss: 25438721.6264; train_gene_expr_recon_loss: 7694708.4645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33174362.1588; train_optim_loss: 33174362.1588; val_kl_reg_loss: 42473.7157; val_edge_recon_loss: 25473447.9095; val_gene_expr_recon_loss: 8068921.0176; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33584842.7136; val_optim_loss: 33584842.7136
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9974; val_auprc_score: 0.9965; val_best_acc_score: 0.9872; val_best_f1_score: 0.9872; train_kl_reg_loss: 43486.5572; train_edge_recon_loss: 25441611.0872; train_gene_expr_recon_loss: 7682913.5162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33168011.1208; train_optim_loss: 33168011.1208; val_kl_reg_loss: 43858.2767; val_edge_recon_loss: 25452227.1558; val_gene_expr_recon_loss: 8076897.8543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33572983.3065; val_optim_loss: 33572983.3065
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9973; val_auprc_score: 0.9964; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 44247.2574; train_edge_recon_loss: 25444303.5145; train_gene_expr_recon_loss: 7676949.2360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33165500.0022; train_optim_loss: 33165500.0022; val_kl_reg_loss: 44172.7141; val_edge_recon_loss: 25441380.4020; val_gene_expr_recon_loss: 8074057.2085; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33559610.2915; val_optim_loss: 33559610.2915
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9973; val_auprc_score: 0.9963; val_best_acc_score: 0.9875; val_best_f1_score: 0.9875; train_kl_reg_loss: 44710.5232; train_edge_recon_loss: 25433390.3333; train_gene_expr_recon_loss: 7673846.6633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33151947.5179; train_optim_loss: 33151947.5179; val_kl_reg_loss: 44411.1533; val_edge_recon_loss: 25445717.6985; val_gene_expr_recon_loss: 8077877.5151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33568006.5126; val_optim_loss: 33568006.5126
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9973; val_auprc_score: 0.9965; val_best_acc_score: 0.9872; val_best_f1_score: 0.9873; train_kl_reg_loss: 44847.1152; train_edge_recon_loss: 25440555.6454; train_gene_expr_recon_loss: 7671168.8943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33156571.6398; train_optim_loss: 33156571.6398; val_kl_reg_loss: 44634.0714; val_edge_recon_loss: 25453892.4221; val_gene_expr_recon_loss: 8078768.6482; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33577295.0754; val_optim_loss: 33577295.0754
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9974; val_auprc_score: 0.9964; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 44898.0487; train_edge_recon_loss: 25439345.0089; train_gene_expr_recon_loss: 7669148.6507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33153391.7103; train_optim_loss: 33153391.7103; val_kl_reg_loss: 44541.9102; val_edge_recon_loss: 25448529.7487; val_gene_expr_recon_loss: 8087471.5402; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33580543.2060; val_optim_loss: 33580543.2060
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9974; val_auprc_score: 0.9964; val_best_acc_score: 0.9877; val_best_f1_score: 0.9878; train_kl_reg_loss: 45009.0846; train_edge_recon_loss: 25433340.9754; train_gene_expr_recon_loss: 7665093.6577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33143443.7148; train_optim_loss: 33143443.7148; val_kl_reg_loss: 44603.3176; val_edge_recon_loss: 25445560.0101; val_gene_expr_recon_loss: 8094610.8216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33584774.1709; val_optim_loss: 33584774.1709

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9974; val_auprc_score: 0.9965; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 45059.3483; train_edge_recon_loss: 25437351.3546; train_gene_expr_recon_loss: 7652553.9343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33134964.6633; train_optim_loss: 33134964.6633; val_kl_reg_loss: 44898.6319; val_edge_recon_loss: 25447264.0603; val_gene_expr_recon_loss: 8084784.5050; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33576947.2362; val_optim_loss: 33576947.2362
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9974; val_auprc_score: 0.9964; val_best_acc_score: 0.9872; val_best_f1_score: 0.9873; train_kl_reg_loss: 45313.8247; train_edge_recon_loss: 25436739.4452; train_gene_expr_recon_loss: 7650435.6952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33132488.9676; train_optim_loss: 33132488.9676; val_kl_reg_loss: 45089.1829; val_edge_recon_loss: 25465832.7337; val_gene_expr_recon_loss: 8089316.0126; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33600238.0603; val_optim_loss: 33600238.0603
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9973; val_auprc_score: 0.9964; val_best_acc_score: 0.9871; val_best_f1_score: 0.9872; train_kl_reg_loss: 45464.8922; train_edge_recon_loss: 25435575.9888; train_gene_expr_recon_loss: 7650865.7226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33131906.6152; train_optim_loss: 33131906.6152; val_kl_reg_loss: 45201.2450; val_edge_recon_loss: 25478685.0251; val_gene_expr_recon_loss: 8092439.5050; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33616325.8894; val_optim_loss: 33616325.8894
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9976; val_auprc_score: 0.9969; val_best_acc_score: 0.9874; val_best_f1_score: 0.9875; train_kl_reg_loss: 45566.8183; train_edge_recon_loss: 25434694.6477; train_gene_expr_recon_loss: 7651621.5808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33131882.9955; train_optim_loss: 33131882.9955; val_kl_reg_loss: 45318.2365; val_edge_recon_loss: 25470047.5578; val_gene_expr_recon_loss: 8095257.4975; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33610623.2965; val_optim_loss: 33610623.2965

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 602 min 22 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9973
Val AUPRC score: 0.9963
Val best accuracy score: 0.9870
Val best F1 score: 0.9871
Val gene expr MSE score: 0.6297

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
