None
Run timestamp: 25072023_023222_14.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '20', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_14']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1643088
Number of validation edges: 182565
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9872; val_auprc_score: 0.9851; val_best_acc_score: 0.9471; val_best_f1_score: 0.9481; train_kl_reg_loss: 14724.1832; train_edge_recon_loss: 2638445.2942; train_gene_expr_recon_loss: 729803.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3382973.3661; train_optim_loss: 3382973.3661; val_kl_reg_loss: 12903.9377; val_edge_recon_loss: 2618702.3761; val_gene_expr_recon_loss: 695312.5235; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3326918.8333; val_optim_loss: 3326918.8333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9908; val_auprc_score: 0.9891; val_best_acc_score: 0.9581; val_best_f1_score: 0.9587; train_kl_reg_loss: 12472.6842; train_edge_recon_loss: 2600104.7429; train_gene_expr_recon_loss: 684467.1120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3297044.5382; train_optim_loss: 3297044.5382; val_kl_reg_loss: 12009.9378; val_edge_recon_loss: 2606102.7482; val_gene_expr_recon_loss: 681033.9639; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3299146.6530; val_optim_loss: 3299146.6530
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9922; val_auprc_score: 0.9910; val_best_acc_score: 0.9620; val_best_f1_score: 0.9625; train_kl_reg_loss: 11909.5288; train_edge_recon_loss: 2591695.4193; train_gene_expr_recon_loss: 678107.1884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3281712.1379; train_optim_loss: 3281712.1379; val_kl_reg_loss: 11738.8205; val_edge_recon_loss: 2599644.3197; val_gene_expr_recon_loss: 676362.5315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3287745.6765; val_optim_loss: 3287745.6765
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9921; val_auprc_score: 0.9904; val_best_acc_score: 0.9635; val_best_f1_score: 0.9640; train_kl_reg_loss: 11603.3428; train_edge_recon_loss: 2588329.4597; train_gene_expr_recon_loss: 675227.1292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3275159.9335; train_optim_loss: 3275159.9335; val_kl_reg_loss: 11136.2622; val_edge_recon_loss: 2598665.8827; val_gene_expr_recon_loss: 675857.6981; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3285659.8424; val_optim_loss: 3285659.8424
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9928; val_auprc_score: 0.9913; val_best_acc_score: 0.9647; val_best_f1_score: 0.9652; train_kl_reg_loss: 11421.5620; train_edge_recon_loss: 2585322.1893; train_gene_expr_recon_loss: 673732.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3270476.5447; train_optim_loss: 3270476.5447; val_kl_reg_loss: 11568.7826; val_edge_recon_loss: 2595157.2391; val_gene_expr_recon_loss: 674058.5214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3280784.5438; val_optim_loss: 3280784.5438
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9938; val_auprc_score: 0.9926; val_best_acc_score: 0.9682; val_best_f1_score: 0.9685; train_kl_reg_loss: 11287.9048; train_edge_recon_loss: 2583741.0344; train_gene_expr_recon_loss: 672061.7714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3267090.7110; train_optim_loss: 3267090.7110; val_kl_reg_loss: 11274.2397; val_edge_recon_loss: 2591242.6047; val_gene_expr_recon_loss: 674798.5641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3277315.4037; val_optim_loss: 3277315.4037
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9939; val_auprc_score: 0.9927; val_best_acc_score: 0.9689; val_best_f1_score: 0.9692; train_kl_reg_loss: 11174.2998; train_edge_recon_loss: 2581505.7284; train_gene_expr_recon_loss: 668858.9361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3261538.9656; train_optim_loss: 3261538.9656; val_kl_reg_loss: 10814.8523; val_edge_recon_loss: 2589855.5011; val_gene_expr_recon_loss: 647763.4911; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3248433.8480; val_optim_loss: 3248433.8480
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9940; val_auprc_score: 0.9926; val_best_acc_score: 0.9694; val_best_f1_score: 0.9698; train_kl_reg_loss: 11103.2029; train_edge_recon_loss: 2579719.3414; train_gene_expr_recon_loss: 678429.9808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3269252.5254; train_optim_loss: 3269252.5254; val_kl_reg_loss: 11147.2766; val_edge_recon_loss: 2590382.7080; val_gene_expr_recon_loss: 664765.8233; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3266295.8099; val_optim_loss: 3266295.8099
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9944; val_auprc_score: 0.9933; val_best_acc_score: 0.9703; val_best_f1_score: 0.9707; train_kl_reg_loss: 11067.2555; train_edge_recon_loss: 2578836.0230; train_gene_expr_recon_loss: 685542.9653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3275446.2439; train_optim_loss: 3275446.2439; val_kl_reg_loss: 11050.6977; val_edge_recon_loss: 2587565.8456; val_gene_expr_recon_loss: 706550.5276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3305167.0711; val_optim_loss: 3305167.0711
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9945; val_auprc_score: 0.9932; val_best_acc_score: 0.9712; val_best_f1_score: 0.9716; train_kl_reg_loss: 10995.5162; train_edge_recon_loss: 2577603.9979; train_gene_expr_recon_loss: 652841.7588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3241441.2720; train_optim_loss: 3241441.2720; val_kl_reg_loss: 10691.0862; val_edge_recon_loss: 2587518.7724; val_gene_expr_recon_loss: 579583.6357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3177793.4891; val_optim_loss: 3177793.4891
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9944; val_auprc_score: 0.9932; val_best_acc_score: 0.9707; val_best_f1_score: 0.9711; train_kl_reg_loss: 10972.0642; train_edge_recon_loss: 2576958.9253; train_gene_expr_recon_loss: 612226.5880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3200157.5797; train_optim_loss: 3200157.5797; val_kl_reg_loss: 11072.5427; val_edge_recon_loss: 2584327.4321; val_gene_expr_recon_loss: 615006.0082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3210405.9811; val_optim_loss: 3210405.9811
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9946; val_auprc_score: 0.9934; val_best_acc_score: 0.9723; val_best_f1_score: 0.9727; train_kl_reg_loss: 10955.4552; train_edge_recon_loss: 2575881.6864; train_gene_expr_recon_loss: 584103.8662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3170941.0074; train_optim_loss: 3170941.0074; val_kl_reg_loss: 10871.4155; val_edge_recon_loss: 2583091.6362; val_gene_expr_recon_loss: 599087.5829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3193050.6373; val_optim_loss: 3193050.6373
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9948; val_auprc_score: 0.9936; val_best_acc_score: 0.9732; val_best_f1_score: 0.9735; train_kl_reg_loss: 10927.8798; train_edge_recon_loss: 2575702.1056; train_gene_expr_recon_loss: 583363.0448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3169993.0292; train_optim_loss: 3169993.0292; val_kl_reg_loss: 10573.3879; val_edge_recon_loss: 2581468.9370; val_gene_expr_recon_loss: 590165.6555; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3182207.9797; val_optim_loss: 3182207.9797
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9944; val_auprc_score: 0.9931; val_best_acc_score: 0.9712; val_best_f1_score: 0.9715; train_kl_reg_loss: 10911.3816; train_edge_recon_loss: 2574598.0624; train_gene_expr_recon_loss: 582484.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3167993.6264; train_optim_loss: 3167993.6264; val_kl_reg_loss: 10812.2979; val_edge_recon_loss: 2585788.1768; val_gene_expr_recon_loss: 582160.5277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3178761.0007; val_optim_loss: 3178761.0007

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9950; val_auprc_score: 0.9937; val_best_acc_score: 0.9741; val_best_f1_score: 0.9743; train_kl_reg_loss: 11519.0541; train_edge_recon_loss: 2571629.3745; train_gene_expr_recon_loss: 573718.9199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3156867.3488; train_optim_loss: 3156867.3488; val_kl_reg_loss: 11505.9308; val_edge_recon_loss: 2579961.1779; val_gene_expr_recon_loss: 583952.5007; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3175419.6117; val_optim_loss: 3175419.6117
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9952; val_auprc_score: 0.9940; val_best_acc_score: 0.9744; val_best_f1_score: 0.9747; train_kl_reg_loss: 11628.0435; train_edge_recon_loss: 2571185.3065; train_gene_expr_recon_loss: 576653.1208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3159466.4699; train_optim_loss: 3159466.4699; val_kl_reg_loss: 11548.4419; val_edge_recon_loss: 2579089.5770; val_gene_expr_recon_loss: 575274.2476; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3165912.2644; val_optim_loss: 3165912.2644
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9953; val_auprc_score: 0.9942; val_best_acc_score: 0.9742; val_best_f1_score: 0.9745; train_kl_reg_loss: 11649.2217; train_edge_recon_loss: 2570605.1114; train_gene_expr_recon_loss: 574408.2354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3156662.5699; train_optim_loss: 3156662.5699; val_kl_reg_loss: 11543.9190; val_edge_recon_loss: 2578901.5133; val_gene_expr_recon_loss: 575603.5288; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3166048.9657; val_optim_loss: 3166048.9657
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9952; val_auprc_score: 0.9940; val_best_acc_score: 0.9744; val_best_f1_score: 0.9748; train_kl_reg_loss: 11635.7561; train_edge_recon_loss: 2570315.7327; train_gene_expr_recon_loss: 573449.6533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3155401.1425; train_optim_loss: 3155401.1425; val_kl_reg_loss: 11573.4001; val_edge_recon_loss: 2578922.7581; val_gene_expr_recon_loss: 574523.5204; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3165019.6733; val_optim_loss: 3165019.6733
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9953; val_auprc_score: 0.9941; val_best_acc_score: 0.9746; val_best_f1_score: 0.9749; train_kl_reg_loss: 11653.4605; train_edge_recon_loss: 2569953.0119; train_gene_expr_recon_loss: 574326.8443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3155933.3163; train_optim_loss: 3155933.3163; val_kl_reg_loss: 11558.6572; val_edge_recon_loss: 2578671.4772; val_gene_expr_recon_loss: 575494.3325; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3165724.4734; val_optim_loss: 3165724.4734
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9953; val_auprc_score: 0.9941; val_best_acc_score: 0.9749; val_best_f1_score: 0.9752; train_kl_reg_loss: 11607.4018; train_edge_recon_loss: 2570586.9568; train_gene_expr_recon_loss: 573653.2862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3155847.6446; train_optim_loss: 3155847.6446; val_kl_reg_loss: 11567.0538; val_edge_recon_loss: 2579492.6681; val_gene_expr_recon_loss: 578046.8769; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3169106.5973; val_optim_loss: 3169106.5973
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9955; val_auprc_score: 0.9943; val_best_acc_score: 0.9754; val_best_f1_score: 0.9756; train_kl_reg_loss: 11611.5605; train_edge_recon_loss: 2570174.2213; train_gene_expr_recon_loss: 574078.9774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3155864.7592; train_optim_loss: 3155864.7592; val_kl_reg_loss: 11467.3493; val_edge_recon_loss: 2577810.3284; val_gene_expr_recon_loss: 576573.5765; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3165851.2563; val_optim_loss: 3165851.2563
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9953; val_auprc_score: 0.9942; val_best_acc_score: 0.9748; val_best_f1_score: 0.9750; train_kl_reg_loss: 11578.8759; train_edge_recon_loss: 2570534.0136; train_gene_expr_recon_loss: 574250.4838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3156363.3756; train_optim_loss: 3156363.3756; val_kl_reg_loss: 11457.7180; val_edge_recon_loss: 2579416.2097; val_gene_expr_recon_loss: 577794.4816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3168668.4083; val_optim_loss: 3168668.4083

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9953; val_auprc_score: 0.9942; val_best_acc_score: 0.9750; val_best_f1_score: 0.9753; train_kl_reg_loss: 11623.3412; train_edge_recon_loss: 2569709.0157; train_gene_expr_recon_loss: 571354.9732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3152687.3305; train_optim_loss: 3152687.3305; val_kl_reg_loss: 11537.1372; val_edge_recon_loss: 2576643.7143; val_gene_expr_recon_loss: 574698.5210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3162879.3711; val_optim_loss: 3162879.3711
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9955; val_auprc_score: 0.9945; val_best_acc_score: 0.9753; val_best_f1_score: 0.9756; train_kl_reg_loss: 11652.2667; train_edge_recon_loss: 2569321.4957; train_gene_expr_recon_loss: 572594.4101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3153568.1708; train_optim_loss: 3153568.1708; val_kl_reg_loss: 11575.8258; val_edge_recon_loss: 2578654.4489; val_gene_expr_recon_loss: 574522.0646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3164752.3466; val_optim_loss: 3164752.3466
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9956; val_auprc_score: 0.9946; val_best_acc_score: 0.9757; val_best_f1_score: 0.9760; train_kl_reg_loss: 11664.7864; train_edge_recon_loss: 2569284.3734; train_gene_expr_recon_loss: 572422.4800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3153371.6377; train_optim_loss: 3153371.6377; val_kl_reg_loss: 11571.3160; val_edge_recon_loss: 2576131.3365; val_gene_expr_recon_loss: 574426.9136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3162129.5658; val_optim_loss: 3162129.5658
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9955; val_auprc_score: 0.9946; val_best_acc_score: 0.9755; val_best_f1_score: 0.9757; train_kl_reg_loss: 11660.7248; train_edge_recon_loss: 2569709.9039; train_gene_expr_recon_loss: 578226.2878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3159596.9179; train_optim_loss: 3159596.9179; val_kl_reg_loss: 11594.2325; val_edge_recon_loss: 2578816.0336; val_gene_expr_recon_loss: 578625.4416; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3169035.7090; val_optim_loss: 3169035.7090
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9955; val_auprc_score: 0.9945; val_best_acc_score: 0.9756; val_best_f1_score: 0.9758; train_kl_reg_loss: 11666.3959; train_edge_recon_loss: 2569176.6705; train_gene_expr_recon_loss: 577233.4796; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3158076.5467; train_optim_loss: 3158076.5467; val_kl_reg_loss: 11569.6715; val_edge_recon_loss: 2577567.9037; val_gene_expr_recon_loss: 581836.1383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3170973.7129; val_optim_loss: 3170973.7129
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9954; val_auprc_score: 0.9943; val_best_acc_score: 0.9755; val_best_f1_score: 0.9757; train_kl_reg_loss: 11661.6092; train_edge_recon_loss: 2569931.1994; train_gene_expr_recon_loss: 577821.6298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3159414.4386; train_optim_loss: 3159414.4386; val_kl_reg_loss: 11596.3293; val_edge_recon_loss: 2576447.5774; val_gene_expr_recon_loss: 582794.7140; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3170838.6127; val_optim_loss: 3170838.6127
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9954; val_auprc_score: 0.9943; val_best_acc_score: 0.9751; val_best_f1_score: 0.9754; train_kl_reg_loss: 11665.0516; train_edge_recon_loss: 2569527.9462; train_gene_expr_recon_loss: 577844.5983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3159037.5949; train_optim_loss: 3159037.5949; val_kl_reg_loss: 11564.4315; val_edge_recon_loss: 2578818.3414; val_gene_expr_recon_loss: 577613.9059; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3167996.6859; val_optim_loss: 3167996.6859

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9954; val_auprc_score: 0.9941; val_best_acc_score: 0.9751; val_best_f1_score: 0.9754; train_kl_reg_loss: 11656.6576; train_edge_recon_loss: 2569415.1069; train_gene_expr_recon_loss: 574668.9800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3155740.7435; train_optim_loss: 3155740.7435; val_kl_reg_loss: 11569.4888; val_edge_recon_loss: 2577592.9132; val_gene_expr_recon_loss: 579505.8655; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3168668.2644; val_optim_loss: 3168668.2644
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9956; val_auprc_score: 0.9945; val_best_acc_score: 0.9754; val_best_f1_score: 0.9757; train_kl_reg_loss: 11659.9883; train_edge_recon_loss: 2569416.5296; train_gene_expr_recon_loss: 577371.4321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3158447.9495; train_optim_loss: 3158447.9495; val_kl_reg_loss: 11570.1004; val_edge_recon_loss: 2577737.0420; val_gene_expr_recon_loss: 579678.0711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3168985.2174; val_optim_loss: 3168985.2174
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9956; val_auprc_score: 0.9946; val_best_acc_score: 0.9753; val_best_f1_score: 0.9756; train_kl_reg_loss: 11658.4489; train_edge_recon_loss: 2569735.0443; train_gene_expr_recon_loss: 576793.2092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3158186.7015; train_optim_loss: 3158186.7015; val_kl_reg_loss: 11568.1699; val_edge_recon_loss: 2578138.4377; val_gene_expr_recon_loss: 578884.6858; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3168591.2906; val_optim_loss: 3168591.2906
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9955; val_auprc_score: 0.9943; val_best_acc_score: 0.9756; val_best_f1_score: 0.9758; train_kl_reg_loss: 11661.4599; train_edge_recon_loss: 2569106.8192; train_gene_expr_recon_loss: 576450.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3157218.9193; train_optim_loss: 3157218.9193; val_kl_reg_loss: 11568.1877; val_edge_recon_loss: 2577665.1117; val_gene_expr_recon_loss: 579195.5186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3168428.8109; val_optim_loss: 3168428.8109

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 339 min 11 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9955
Val AUPRC score: 0.9944
Val best accuracy score: 0.9755
Val best F1 score: 0.9757
Val gene expr MSE score: 1.7553

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
