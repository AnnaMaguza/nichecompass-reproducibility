None
Run timestamp: 16072023_154126_1004.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_1004']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1818, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1818, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9701; val_auprc_score: 0.9556; val_best_acc_score: 0.9248; val_best_f1_score: 0.9272; train_kl_reg_loss: 10008.5785; train_edge_recon_loss: 2907650.4336; train_gene_expr_recon_loss: 20787267.0521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23704926.0208; train_optim_loss: 23704926.0208; val_kl_reg_loss: 13427.2226; val_edge_recon_loss: 2740918.8523; val_gene_expr_recon_loss: 19844463.4545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22598809.4545; val_optim_loss: 22598809.4545
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9768; val_auprc_score: 0.9656; val_best_acc_score: 0.9384; val_best_f1_score: 0.9401; train_kl_reg_loss: 15049.2501; train_edge_recon_loss: 2667124.7839; train_gene_expr_recon_loss: 19536674.3854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22218848.4167; train_optim_loss: 22218848.4167; val_kl_reg_loss: 16437.5108; val_edge_recon_loss: 2726585.9091; val_gene_expr_recon_loss: 19254513.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21997536.2727; val_optim_loss: 21997536.2727
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9777; val_auprc_score: 0.9660; val_best_acc_score: 0.9427; val_best_f1_score: 0.9442; train_kl_reg_loss: 16019.0312; train_edge_recon_loss: 2660711.7227; train_gene_expr_recon_loss: 19018017.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21694748.6042; train_optim_loss: 21694748.6042; val_kl_reg_loss: 19326.6449; val_edge_recon_loss: 2725970.3182; val_gene_expr_recon_loss: 18793727.2727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21539024.0000; val_optim_loss: 21539024.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9801; val_auprc_score: 0.9706; val_best_acc_score: 0.9457; val_best_f1_score: 0.9472; train_kl_reg_loss: 17918.8601; train_edge_recon_loss: 2657349.1341; train_gene_expr_recon_loss: 18502269.4792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21177537.5208; train_optim_loss: 21177537.5208; val_kl_reg_loss: 17039.0431; val_edge_recon_loss: 2725683.6364; val_gene_expr_recon_loss: 18308737.4545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21051460.0909; val_optim_loss: 21051460.0909
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9788; val_auprc_score: 0.9672; val_best_acc_score: 0.9441; val_best_f1_score: 0.9457; train_kl_reg_loss: 16691.2310; train_edge_recon_loss: 2653322.4362; train_gene_expr_recon_loss: 18039277.8646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20709291.5104; train_optim_loss: 20709291.5104; val_kl_reg_loss: 18126.5428; val_edge_recon_loss: 2738399.3182; val_gene_expr_recon_loss: 17944880.7273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20701406.3636; val_optim_loss: 20701406.3636
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9785; val_auprc_score: 0.9672; val_best_acc_score: 0.9434; val_best_f1_score: 0.9450; train_kl_reg_loss: 16478.0654; train_edge_recon_loss: 2649936.4440; train_gene_expr_recon_loss: 17632583.1771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20298997.6458; train_optim_loss: 20298997.6458; val_kl_reg_loss: 15457.7125; val_edge_recon_loss: 2723186.4091; val_gene_expr_recon_loss: 17661970.8182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20400614.8182; val_optim_loss: 20400614.8182
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9782; val_auprc_score: 0.9669; val_best_acc_score: 0.9420; val_best_f1_score: 0.9437; train_kl_reg_loss: 16248.1805; train_edge_recon_loss: 2651239.1510; train_gene_expr_recon_loss: 17330008.8073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19997496.0938; train_optim_loss: 19997496.0938; val_kl_reg_loss: 16066.9367; val_edge_recon_loss: 2737809.4659; val_gene_expr_recon_loss: 17488709.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20242585.4545; val_optim_loss: 20242585.4545
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9781; val_auprc_score: 0.9669; val_best_acc_score: 0.9426; val_best_f1_score: 0.9444; train_kl_reg_loss: 16090.3113; train_edge_recon_loss: 2646736.1458; train_gene_expr_recon_loss: 17071696.4583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19734522.8333; train_optim_loss: 19734522.8333; val_kl_reg_loss: 16522.3189; val_edge_recon_loss: 2724492.5114; val_gene_expr_recon_loss: 17257643.1364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19998658.0909; val_optim_loss: 19998658.0909
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9777; val_auprc_score: 0.9668; val_best_acc_score: 0.9405; val_best_f1_score: 0.9424; train_kl_reg_loss: 16295.9360; train_edge_recon_loss: 2646880.3229; train_gene_expr_recon_loss: 16870574.1406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19533750.4167; train_optim_loss: 19533750.4167; val_kl_reg_loss: 16045.7779; val_edge_recon_loss: 2726012.2386; val_gene_expr_recon_loss: 17067744.3636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19809802.2727; val_optim_loss: 19809802.2727
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9762; val_auprc_score: 0.9637; val_best_acc_score: 0.9393; val_best_f1_score: 0.9413; train_kl_reg_loss: 16434.2532; train_edge_recon_loss: 2642404.1992; train_gene_expr_recon_loss: 16714816.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19373655.0417; train_optim_loss: 19373655.0417; val_kl_reg_loss: 12834.4980; val_edge_recon_loss: 2727431.7955; val_gene_expr_recon_loss: 17045143.4545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19785409.6364; val_optim_loss: 19785409.6364
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9762; val_auprc_score: 0.9639; val_best_acc_score: 0.9395; val_best_f1_score: 0.9414; train_kl_reg_loss: 17015.8156; train_edge_recon_loss: 2641225.8229; train_gene_expr_recon_loss: 16559571.3229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19217812.9062; train_optim_loss: 19217812.9062; val_kl_reg_loss: 15574.3503; val_edge_recon_loss: 2715718.6364; val_gene_expr_recon_loss: 16949900.8636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19681193.7273; val_optim_loss: 19681193.7273
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9764; val_auprc_score: 0.9660; val_best_acc_score: 0.9384; val_best_f1_score: 0.9404; train_kl_reg_loss: 16533.6949; train_edge_recon_loss: 2636410.0130; train_gene_expr_recon_loss: 16449703.5781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19102647.2812; train_optim_loss: 19102647.2812; val_kl_reg_loss: 15770.8785; val_edge_recon_loss: 2717350.2159; val_gene_expr_recon_loss: 16791000.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19524121.5455; val_optim_loss: 19524121.5455
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9758; val_auprc_score: 0.9646; val_best_acc_score: 0.9373; val_best_f1_score: 0.9394; train_kl_reg_loss: 16595.6471; train_edge_recon_loss: 2634549.0833; train_gene_expr_recon_loss: 16360035.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19011180.3542; train_optim_loss: 19011180.3542; val_kl_reg_loss: 15165.3859; val_edge_recon_loss: 2714527.0682; val_gene_expr_recon_loss: 16786997.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19516690.4545; val_optim_loss: 19516690.4545
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9754; val_auprc_score: 0.9640; val_best_acc_score: 0.9363; val_best_f1_score: 0.9385; train_kl_reg_loss: 16842.2783; train_edge_recon_loss: 2634347.0234; train_gene_expr_recon_loss: 16256138.7604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18907327.9896; train_optim_loss: 18907327.9896; val_kl_reg_loss: 16516.1238; val_edge_recon_loss: 2711187.6364; val_gene_expr_recon_loss: 16702298.6364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19430002.2727; val_optim_loss: 19430002.2727
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9753; val_auprc_score: 0.9632; val_best_acc_score: 0.9367; val_best_f1_score: 0.9390; train_kl_reg_loss: 16779.3311; train_edge_recon_loss: 2631050.2995; train_gene_expr_recon_loss: 16192094.9792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18839924.6146; train_optim_loss: 18839924.6146; val_kl_reg_loss: 16688.2561; val_edge_recon_loss: 2711871.3068; val_gene_expr_recon_loss: 16710863.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19439423.0909; val_optim_loss: 19439423.0909
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9757; val_auprc_score: 0.9636; val_best_acc_score: 0.9384; val_best_f1_score: 0.9406; train_kl_reg_loss: 16834.1024; train_edge_recon_loss: 2629619.1107; train_gene_expr_recon_loss: 16108977.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18755430.8021; train_optim_loss: 18755430.8021; val_kl_reg_loss: 16717.2829; val_edge_recon_loss: 2702062.8864; val_gene_expr_recon_loss: 16625024.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19343804.1818; val_optim_loss: 19343804.1818
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9745; val_auprc_score: 0.9608; val_best_acc_score: 0.9367; val_best_f1_score: 0.9387; train_kl_reg_loss: 16936.7599; train_edge_recon_loss: 2628293.1458; train_gene_expr_recon_loss: 16077590.0260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18722819.8854; train_optim_loss: 18722819.8854; val_kl_reg_loss: 16949.7371; val_edge_recon_loss: 2700084.4659; val_gene_expr_recon_loss: 16592191.2273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19309225.5455; val_optim_loss: 19309225.5455
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9756; val_auprc_score: 0.9646; val_best_acc_score: 0.9379; val_best_f1_score: 0.9399; train_kl_reg_loss: 17013.9551; train_edge_recon_loss: 2627707.5833; train_gene_expr_recon_loss: 16021266.9115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18665988.3854; train_optim_loss: 18665988.3854; val_kl_reg_loss: 16879.3035; val_edge_recon_loss: 2693252.5682; val_gene_expr_recon_loss: 16530832.4545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19240964.2727; val_optim_loss: 19240964.2727
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9757; val_auprc_score: 0.9641; val_best_acc_score: 0.9391; val_best_f1_score: 0.9410; train_kl_reg_loss: 17045.5585; train_edge_recon_loss: 2627465.1185; train_gene_expr_recon_loss: 15960529.1510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18605039.8125; train_optim_loss: 18605039.8125; val_kl_reg_loss: 16933.2460; val_edge_recon_loss: 2693124.7273; val_gene_expr_recon_loss: 16572961.1818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19283019.3636; val_optim_loss: 19283019.3636
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9756; val_auprc_score: 0.9644; val_best_acc_score: 0.9369; val_best_f1_score: 0.9389; train_kl_reg_loss: 17080.2137; train_edge_recon_loss: 2624255.7891; train_gene_expr_recon_loss: 15927464.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18568800.3542; train_optim_loss: 18568800.3542; val_kl_reg_loss: 16640.3362; val_edge_recon_loss: 2693977.4886; val_gene_expr_recon_loss: 16458799.4545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19169417.2727; val_optim_loss: 19169417.2727
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9745; val_auprc_score: 0.9625; val_best_acc_score: 0.9360; val_best_f1_score: 0.9383; train_kl_reg_loss: 17131.3087; train_edge_recon_loss: 2625250.6784; train_gene_expr_recon_loss: 15905200.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18547582.8333; train_optim_loss: 18547582.8333; val_kl_reg_loss: 16590.4377; val_edge_recon_loss: 2696431.4886; val_gene_expr_recon_loss: 16501470.2727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19214492.0909; val_optim_loss: 19214492.0909
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9738; val_auprc_score: 0.9620; val_best_acc_score: 0.9347; val_best_f1_score: 0.9368; train_kl_reg_loss: 17211.0836; train_edge_recon_loss: 2623531.2331; train_gene_expr_recon_loss: 15865649.8958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18506392.1771; train_optim_loss: 18506392.1771; val_kl_reg_loss: 17051.2239; val_edge_recon_loss: 2698668.3068; val_gene_expr_recon_loss: 16537671.3182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19253390.8182; val_optim_loss: 19253390.8182
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9740; val_auprc_score: 0.9612; val_best_acc_score: 0.9362; val_best_f1_score: 0.9385; train_kl_reg_loss: 17212.3345; train_edge_recon_loss: 2622673.6302; train_gene_expr_recon_loss: 15845608.7448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18485494.7292; train_optim_loss: 18485494.7292; val_kl_reg_loss: 16394.9448; val_edge_recon_loss: 2688862.0000; val_gene_expr_recon_loss: 16500247.2727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19205504.2727; val_optim_loss: 19205504.2727
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9738; val_auprc_score: 0.9615; val_best_acc_score: 0.9350; val_best_f1_score: 0.9372; train_kl_reg_loss: 17260.4412; train_edge_recon_loss: 2623413.6758; train_gene_expr_recon_loss: 15792775.8490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18433449.9792; train_optim_loss: 18433449.9792; val_kl_reg_loss: 16825.6437; val_edge_recon_loss: 2696606.7045; val_gene_expr_recon_loss: 16493303.1364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19206735.4545; val_optim_loss: 19206735.4545

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9744; val_auprc_score: 0.9610; val_best_acc_score: 0.9367; val_best_f1_score: 0.9386; train_kl_reg_loss: 17465.8060; train_edge_recon_loss: 2615437.4531; train_gene_expr_recon_loss: 15603196.8958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18236100.2083; train_optim_loss: 18236100.2083; val_kl_reg_loss: 16952.9551; val_edge_recon_loss: 2684943.4773; val_gene_expr_recon_loss: 16359750.5909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19061647.0909; val_optim_loss: 19061647.0909
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9724; val_auprc_score: 0.9589; val_best_acc_score: 0.9341; val_best_f1_score: 0.9363; train_kl_reg_loss: 16995.3732; train_edge_recon_loss: 2612184.2578; train_gene_expr_recon_loss: 15584375.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18213554.8125; train_optim_loss: 18213554.8125; val_kl_reg_loss: 16532.4683; val_edge_recon_loss: 2681980.4886; val_gene_expr_recon_loss: 16369185.0455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19067698.0000; val_optim_loss: 19067698.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9753; val_auprc_score: 0.9637; val_best_acc_score: 0.9359; val_best_f1_score: 0.9383; train_kl_reg_loss: 16793.9137; train_edge_recon_loss: 2610778.8372; train_gene_expr_recon_loss: 15567991.1458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18195563.9062; train_optim_loss: 18195563.9062; val_kl_reg_loss: 16459.8418; val_edge_recon_loss: 2671017.9432; val_gene_expr_recon_loss: 16376224.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19063702.6364; val_optim_loss: 19063702.6364
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9741; val_auprc_score: 0.9624; val_best_acc_score: 0.9355; val_best_f1_score: 0.9375; train_kl_reg_loss: 16765.9599; train_edge_recon_loss: 2610694.1549; train_gene_expr_recon_loss: 15566456.3177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18193916.4167; train_optim_loss: 18193916.4167; val_kl_reg_loss: 16432.8541; val_edge_recon_loss: 2679712.0000; val_gene_expr_recon_loss: 16345780.2727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19041925.0909; val_optim_loss: 19041925.0909
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9744; val_auprc_score: 0.9623; val_best_acc_score: 0.9373; val_best_f1_score: 0.9396; train_kl_reg_loss: 16758.9605; train_edge_recon_loss: 2608428.1458; train_gene_expr_recon_loss: 15547806.6042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18172993.7292; train_optim_loss: 18172993.7292; val_kl_reg_loss: 16428.3404; val_edge_recon_loss: 2668139.7500; val_gene_expr_recon_loss: 16356596.5909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19041164.7273; val_optim_loss: 19041164.7273
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9753; val_auprc_score: 0.9643; val_best_acc_score: 0.9371; val_best_f1_score: 0.9396; train_kl_reg_loss: 16772.1506; train_edge_recon_loss: 2608185.0326; train_gene_expr_recon_loss: 15555850.0729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18180807.3333; train_optim_loss: 18180807.3333; val_kl_reg_loss: 16477.8784; val_edge_recon_loss: 2663815.1136; val_gene_expr_recon_loss: 16383363.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19063656.8182; val_optim_loss: 19063656.8182
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9745; val_auprc_score: 0.9630; val_best_acc_score: 0.9360; val_best_f1_score: 0.9386; train_kl_reg_loss: 16795.1128; train_edge_recon_loss: 2608451.8099; train_gene_expr_recon_loss: 15550578.8542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18175825.7604; train_optim_loss: 18175825.7604; val_kl_reg_loss: 16498.1492; val_edge_recon_loss: 2670659.8523; val_gene_expr_recon_loss: 16392611.9545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19079770.0000; val_optim_loss: 19079770.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9737; val_auprc_score: 0.9607; val_best_acc_score: 0.9357; val_best_f1_score: 0.9382; train_kl_reg_loss: 16801.8252; train_edge_recon_loss: 2609172.0885; train_gene_expr_recon_loss: 15539407.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18165381.1458; train_optim_loss: 18165381.1458; val_kl_reg_loss: 16505.9695; val_edge_recon_loss: 2669973.0114; val_gene_expr_recon_loss: 16411279.2273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19097758.4545; val_optim_loss: 19097758.4545
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9742; val_auprc_score: 0.9616; val_best_acc_score: 0.9370; val_best_f1_score: 0.9393; train_kl_reg_loss: 16827.3151; train_edge_recon_loss: 2604945.7331; train_gene_expr_recon_loss: 15537593.2552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18159366.3229; train_optim_loss: 18159366.3229; val_kl_reg_loss: 16538.8328; val_edge_recon_loss: 2666826.5000; val_gene_expr_recon_loss: 16372450.0455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19055815.4545; val_optim_loss: 19055815.4545

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9743; val_auprc_score: 0.9623; val_best_acc_score: 0.9359; val_best_f1_score: 0.9383; train_kl_reg_loss: 16878.9817; train_edge_recon_loss: 2606414.1445; train_gene_expr_recon_loss: 15505336.9844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18128630.1042; train_optim_loss: 18128630.1042; val_kl_reg_loss: 16583.9794; val_edge_recon_loss: 2665088.2273; val_gene_expr_recon_loss: 16378237.6818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19059909.9091; val_optim_loss: 19059909.9091
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9741; val_auprc_score: 0.9614; val_best_acc_score: 0.9370; val_best_f1_score: 0.9390; train_kl_reg_loss: 16904.4475; train_edge_recon_loss: 2605915.6602; train_gene_expr_recon_loss: 15506732.7448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18129552.9375; train_optim_loss: 18129552.9375; val_kl_reg_loss: 16569.3181; val_edge_recon_loss: 2666083.4091; val_gene_expr_recon_loss: 16352022.5455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19034675.1818; val_optim_loss: 19034675.1818
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9738; val_auprc_score: 0.9612; val_best_acc_score: 0.9363; val_best_f1_score: 0.9385; train_kl_reg_loss: 16898.9503; train_edge_recon_loss: 2606334.7161; train_gene_expr_recon_loss: 15515265.4635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18138499.1979; train_optim_loss: 18138499.1979; val_kl_reg_loss: 16558.4628; val_edge_recon_loss: 2664526.2955; val_gene_expr_recon_loss: 16371098.7273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19052183.5455; val_optim_loss: 19052183.5455
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9742; val_auprc_score: 0.9615; val_best_acc_score: 0.9375; val_best_f1_score: 0.9396; train_kl_reg_loss: 16880.9084; train_edge_recon_loss: 2607623.2630; train_gene_expr_recon_loss: 15512503.3490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18137007.4896; train_optim_loss: 18137007.4896; val_kl_reg_loss: 16548.1674; val_edge_recon_loss: 2662054.2273; val_gene_expr_recon_loss: 16361835.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19040437.4545; val_optim_loss: 19040437.4545
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9733; val_auprc_score: 0.9607; val_best_acc_score: 0.9357; val_best_f1_score: 0.9378; train_kl_reg_loss: 16861.9558; train_edge_recon_loss: 2606765.4154; train_gene_expr_recon_loss: 15504500.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18128127.4062; train_optim_loss: 18128127.4062; val_kl_reg_loss: 16526.1895; val_edge_recon_loss: 2667636.2955; val_gene_expr_recon_loss: 16374334.1818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19058496.7273; val_optim_loss: 19058496.7273
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9747; val_auprc_score: 0.9627; val_best_acc_score: 0.9370; val_best_f1_score: 0.9394; train_kl_reg_loss: 16849.8450; train_edge_recon_loss: 2605420.1367; train_gene_expr_recon_loss: 15503033.8854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18125303.8333; train_optim_loss: 18125303.8333; val_kl_reg_loss: 16520.1744; val_edge_recon_loss: 2660973.9773; val_gene_expr_recon_loss: 16371171.6364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19048665.5455; val_optim_loss: 19048665.5455

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9746; val_auprc_score: 0.9624; val_best_acc_score: 0.9368; val_best_f1_score: 0.9392; train_kl_reg_loss: 16843.6827; train_edge_recon_loss: 2605749.9258; train_gene_expr_recon_loss: 15499147.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18121740.8542; train_optim_loss: 18121740.8542; val_kl_reg_loss: 16524.5402; val_edge_recon_loss: 2667706.3068; val_gene_expr_recon_loss: 16354728.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19038958.9091; val_optim_loss: 19038958.9091
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9742; val_auprc_score: 0.9623; val_best_acc_score: 0.9383; val_best_f1_score: 0.9405; train_kl_reg_loss: 16845.0063; train_edge_recon_loss: 2606027.2799; train_gene_expr_recon_loss: 15497304.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18120177.1250; train_optim_loss: 18120177.1250; val_kl_reg_loss: 16522.8398; val_edge_recon_loss: 2661633.5000; val_gene_expr_recon_loss: 16384273.3182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19062429.7273; val_optim_loss: 19062429.7273
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9749; val_auprc_score: 0.9629; val_best_acc_score: 0.9370; val_best_f1_score: 0.9395; train_kl_reg_loss: 16843.0451; train_edge_recon_loss: 2605366.9948; train_gene_expr_recon_loss: 15504350.0677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18126560.0729; train_optim_loss: 18126560.0729; val_kl_reg_loss: 16522.5240; val_edge_recon_loss: 2660514.3864; val_gene_expr_recon_loss: 16345597.2727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19022634.1818; val_optim_loss: 19022634.1818
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9748; val_auprc_score: 0.9619; val_best_acc_score: 0.9371; val_best_f1_score: 0.9394; train_kl_reg_loss: 16846.0869; train_edge_recon_loss: 2605762.7773; train_gene_expr_recon_loss: 15496305.9896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18118914.8542; train_optim_loss: 18118914.8542; val_kl_reg_loss: 16511.5144; val_edge_recon_loss: 2661421.3523; val_gene_expr_recon_loss: 16328867.6818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19006800.4545; val_optim_loss: 19006800.4545
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9756; val_auprc_score: 0.9643; val_best_acc_score: 0.9380; val_best_f1_score: 0.9403; train_kl_reg_loss: 16843.5841; train_edge_recon_loss: 2604765.8073; train_gene_expr_recon_loss: 15494065.2552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18115674.6458; train_optim_loss: 18115674.6458; val_kl_reg_loss: 16518.5662; val_edge_recon_loss: 2661878.1364; val_gene_expr_recon_loss: 16371845.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19050242.0909; val_optim_loss: 19050242.0909
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9751; val_auprc_score: 0.9622; val_best_acc_score: 0.9385; val_best_f1_score: 0.9407; train_kl_reg_loss: 16846.0939; train_edge_recon_loss: 2607365.8477; train_gene_expr_recon_loss: 15499557.5729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18123769.5000; train_optim_loss: 18123769.5000; val_kl_reg_loss: 16519.6315; val_edge_recon_loss: 2660447.0455; val_gene_expr_recon_loss: 16389423.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19066390.5455; val_optim_loss: 19066390.5455
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9755; val_auprc_score: 0.9641; val_best_acc_score: 0.9389; val_best_f1_score: 0.9407; train_kl_reg_loss: 16841.0114; train_edge_recon_loss: 2606008.7279; train_gene_expr_recon_loss: 15492088.5365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18114938.2292; train_optim_loss: 18114938.2292; val_kl_reg_loss: 16508.9140; val_edge_recon_loss: 2653997.0568; val_gene_expr_recon_loss: 16336156.5909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19006662.6364; val_optim_loss: 19006662.6364
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9736; val_auprc_score: 0.9605; val_best_acc_score: 0.9361; val_best_f1_score: 0.9385; train_kl_reg_loss: 16841.5338; train_edge_recon_loss: 2606743.5495; train_gene_expr_recon_loss: 15502128.1458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18125713.2500; train_optim_loss: 18125713.2500; val_kl_reg_loss: 16509.6785; val_edge_recon_loss: 2666346.6591; val_gene_expr_recon_loss: 16337756.7727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19020612.9091; val_optim_loss: 19020612.9091
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9749; val_auprc_score: 0.9630; val_best_acc_score: 0.9379; val_best_f1_score: 0.9402; train_kl_reg_loss: 16841.3275; train_edge_recon_loss: 2605072.0990; train_gene_expr_recon_loss: 15494654.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18116567.5938; train_optim_loss: 18116567.5938; val_kl_reg_loss: 16510.8003; val_edge_recon_loss: 2660420.2273; val_gene_expr_recon_loss: 16337853.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19014784.0000; val_optim_loss: 19014784.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9755; val_auprc_score: 0.9645; val_best_acc_score: 0.9368; val_best_f1_score: 0.9390; train_kl_reg_loss: 16842.6104; train_edge_recon_loss: 2605688.4479; train_gene_expr_recon_loss: 15494889.9583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18117420.9896; train_optim_loss: 18117420.9896; val_kl_reg_loss: 16505.1918; val_edge_recon_loss: 2664449.4432; val_gene_expr_recon_loss: 16369589.9545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19050544.3636; val_optim_loss: 19050544.3636
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9762; val_auprc_score: 0.9658; val_best_acc_score: 0.9379; val_best_f1_score: 0.9402; train_kl_reg_loss: 16838.1544; train_edge_recon_loss: 2605373.2643; train_gene_expr_recon_loss: 15505329.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18127541.3646; train_optim_loss: 18127541.3646; val_kl_reg_loss: 16509.0771; val_edge_recon_loss: 2658675.1023; val_gene_expr_recon_loss: 16376159.2273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19051343.5455; val_optim_loss: 19051343.5455

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9739; val_auprc_score: 0.9607; val_best_acc_score: 0.9365; val_best_f1_score: 0.9387; train_kl_reg_loss: 16837.6872; train_edge_recon_loss: 2606198.6523; train_gene_expr_recon_loss: 15491987.6719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18115024.1146; train_optim_loss: 18115024.1146; val_kl_reg_loss: 16518.0809; val_edge_recon_loss: 2658721.3295; val_gene_expr_recon_loss: 16378026.2727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19053265.7273; val_optim_loss: 19053265.7273
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9756; val_auprc_score: 0.9646; val_best_acc_score: 0.9377; val_best_f1_score: 0.9397; train_kl_reg_loss: 16839.8739; train_edge_recon_loss: 2605719.7969; train_gene_expr_recon_loss: 15503841.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18126400.8542; train_optim_loss: 18126400.8542; val_kl_reg_loss: 16522.5385; val_edge_recon_loss: 2661380.0568; val_gene_expr_recon_loss: 16411618.3182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19089521.0000; val_optim_loss: 19089521.0000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9745; val_auprc_score: 0.9638; val_best_acc_score: 0.9368; val_best_f1_score: 0.9391; train_kl_reg_loss: 16839.1882; train_edge_recon_loss: 2604519.5833; train_gene_expr_recon_loss: 15512842.5573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18134201.3646; train_optim_loss: 18134201.3646; val_kl_reg_loss: 16509.0110; val_edge_recon_loss: 2664621.2273; val_gene_expr_recon_loss: 16352838.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19033968.2727; val_optim_loss: 19033968.2727
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9750; val_auprc_score: 0.9634; val_best_acc_score: 0.9380; val_best_f1_score: 0.9401; train_kl_reg_loss: 16837.4654; train_edge_recon_loss: 2607451.2812; train_gene_expr_recon_loss: 15498813.7708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18123102.5833; train_optim_loss: 18123102.5833; val_kl_reg_loss: 16502.4143; val_edge_recon_loss: 2661894.9773; val_gene_expr_recon_loss: 16343163.9545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19021561.2727; val_optim_loss: 19021561.2727

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 68 min 43 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
Val AUROC score: 0.9746
Val AUPRC score: 0.9629
Val best accuracy score: 0.9369
Val best F1 score: 0.9388
Val gene expr MSE score: 0.5234

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
