None
Run timestamp: 14072023_063122_1.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9595; val_auprc_score: 0.9467; val_best_acc_score: 0.9049; val_best_f1_score: 0.9087; train_kl_reg_loss: 29691.3855; train_edge_recon_loss: 2789771.1576; train_gene_expr_recon_loss: 1289933.1243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4109395.6706; train_optim_loss: 4109395.6706; val_kl_reg_loss: 29453.6032; val_edge_recon_loss: 2683244.3750; val_gene_expr_recon_loss: 1149492.9830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3862190.9659; val_optim_loss: 3862190.9659
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9698; val_auprc_score: 0.9571; val_best_acc_score: 0.9280; val_best_f1_score: 0.9303; train_kl_reg_loss: 31385.0311; train_edge_recon_loss: 2625090.0013; train_gene_expr_recon_loss: 1113081.2041; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3769556.2279; train_optim_loss: 3769556.2279; val_kl_reg_loss: 29637.3688; val_edge_recon_loss: 2648872.0909; val_gene_expr_recon_loss: 1088229.2443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3766738.7273; val_optim_loss: 3766738.7273
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9728; val_auprc_score: 0.9623; val_best_acc_score: 0.9329; val_best_f1_score: 0.9349; train_kl_reg_loss: 29305.0653; train_edge_recon_loss: 2613770.7344; train_gene_expr_recon_loss: 1070175.3337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3713251.1276; train_optim_loss: 3713251.1276; val_kl_reg_loss: 27346.4305; val_edge_recon_loss: 2638086.2727; val_gene_expr_recon_loss: 1055883.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3721316.1818; val_optim_loss: 3721316.1818
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9751; val_auprc_score: 0.9658; val_best_acc_score: 0.9358; val_best_f1_score: 0.9376; train_kl_reg_loss: 27104.5570; train_edge_recon_loss: 2608420.3242; train_gene_expr_recon_loss: 1043060.4450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3678585.3372; train_optim_loss: 3678585.3372; val_kl_reg_loss: 24976.8890; val_edge_recon_loss: 2640329.5455; val_gene_expr_recon_loss: 1037271.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3702577.7727; val_optim_loss: 3702577.7727
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9779; val_auprc_score: 0.9696; val_best_acc_score: 0.9420; val_best_f1_score: 0.9436; train_kl_reg_loss: 25416.2735; train_edge_recon_loss: 2604770.3047; train_gene_expr_recon_loss: 1023772.0378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3653958.6315; train_optim_loss: 3653958.6315; val_kl_reg_loss: 24133.1842; val_edge_recon_loss: 2623641.6705; val_gene_expr_recon_loss: 1018724.8580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3666499.6818; val_optim_loss: 3666499.6818
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9782; val_auprc_score: 0.9691; val_best_acc_score: 0.9447; val_best_f1_score: 0.9463; train_kl_reg_loss: 24512.5494; train_edge_recon_loss: 2597074.6185; train_gene_expr_recon_loss: 1006730.7718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3628317.9401; train_optim_loss: 3628317.9401; val_kl_reg_loss: 24174.0212; val_edge_recon_loss: 2624322.2159; val_gene_expr_recon_loss: 1001287.5653; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3649783.7727; val_optim_loss: 3649783.7727
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9792; val_auprc_score: 0.9704; val_best_acc_score: 0.9471; val_best_f1_score: 0.9488; train_kl_reg_loss: 23976.3872; train_edge_recon_loss: 2593535.9492; train_gene_expr_recon_loss: 993560.2350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3611072.5703; train_optim_loss: 3611072.5703; val_kl_reg_loss: 23086.7333; val_edge_recon_loss: 2618318.0227; val_gene_expr_recon_loss: 991874.4943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3633279.2841; val_optim_loss: 3633279.2841
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9790; val_auprc_score: 0.9698; val_best_acc_score: 0.9475; val_best_f1_score: 0.9489; train_kl_reg_loss: 23524.8548; train_edge_recon_loss: 2589511.7188; train_gene_expr_recon_loss: 980913.0553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3593949.6276; train_optim_loss: 3593949.6276; val_kl_reg_loss: 22644.3600; val_edge_recon_loss: 2621697.1136; val_gene_expr_recon_loss: 982163.9119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3626505.4091; val_optim_loss: 3626505.4091
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9804; val_auprc_score: 0.9714; val_best_acc_score: 0.9510; val_best_f1_score: 0.9524; train_kl_reg_loss: 22974.2911; train_edge_recon_loss: 2588821.9870; train_gene_expr_recon_loss: 970593.0915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3582389.3802; train_optim_loss: 3582389.3802; val_kl_reg_loss: 21473.5459; val_edge_recon_loss: 2612617.8750; val_gene_expr_recon_loss: 972980.5653; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3607072.0000; val_optim_loss: 3607072.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9811; val_auprc_score: 0.9732; val_best_acc_score: 0.9521; val_best_f1_score: 0.9535; train_kl_reg_loss: 22353.9289; train_edge_recon_loss: 2587855.2188; train_gene_expr_recon_loss: 962323.4147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3572532.5677; train_optim_loss: 3572532.5677; val_kl_reg_loss: 21735.1270; val_edge_recon_loss: 2611196.7955; val_gene_expr_recon_loss: 965049.9489; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3597981.8864; val_optim_loss: 3597981.8864
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9824; val_auprc_score: 0.9755; val_best_acc_score: 0.9524; val_best_f1_score: 0.9537; train_kl_reg_loss: 22104.4107; train_edge_recon_loss: 2585151.6328; train_gene_expr_recon_loss: 954612.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3561868.7552; train_optim_loss: 3561868.7552; val_kl_reg_loss: 21151.5455; val_edge_recon_loss: 2614129.4432; val_gene_expr_recon_loss: 957471.6847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3592752.6477; val_optim_loss: 3592752.6477
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9822; val_auprc_score: 0.9747; val_best_acc_score: 0.9531; val_best_f1_score: 0.9544; train_kl_reg_loss: 21682.0501; train_edge_recon_loss: 2581473.2292; train_gene_expr_recon_loss: 947538.8408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3550694.1094; train_optim_loss: 3550694.1094; val_kl_reg_loss: 21040.8780; val_edge_recon_loss: 2610286.4886; val_gene_expr_recon_loss: 952215.1080; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3583542.5000; val_optim_loss: 3583542.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9831; val_auprc_score: 0.9766; val_best_acc_score: 0.9543; val_best_f1_score: 0.9554; train_kl_reg_loss: 21341.8975; train_edge_recon_loss: 2581695.5339; train_gene_expr_recon_loss: 940698.9951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3543736.4297; train_optim_loss: 3543736.4297; val_kl_reg_loss: 20300.1046; val_edge_recon_loss: 2610252.0568; val_gene_expr_recon_loss: 951224.3324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3581776.4659; val_optim_loss: 3581776.4659
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9814; val_auprc_score: 0.9738; val_best_acc_score: 0.9531; val_best_f1_score: 0.9544; train_kl_reg_loss: 20838.2816; train_edge_recon_loss: 2581483.4284; train_gene_expr_recon_loss: 935493.6823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3537815.3906; train_optim_loss: 3537815.3906; val_kl_reg_loss: 19990.3940; val_edge_recon_loss: 2610026.5795; val_gene_expr_recon_loss: 944204.9176; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3574221.8977; val_optim_loss: 3574221.8977
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9828; val_auprc_score: 0.9751; val_best_acc_score: 0.9549; val_best_f1_score: 0.9561; train_kl_reg_loss: 20634.3710; train_edge_recon_loss: 2582098.2188; train_gene_expr_recon_loss: 930676.7048; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3533409.2969; train_optim_loss: 3533409.2969; val_kl_reg_loss: 19716.1720; val_edge_recon_loss: 2608873.6932; val_gene_expr_recon_loss: 939201.3352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3567791.2045; val_optim_loss: 3567791.2045
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9841; val_auprc_score: 0.9779; val_best_acc_score: 0.9556; val_best_f1_score: 0.9569; train_kl_reg_loss: 20405.6253; train_edge_recon_loss: 2579204.9805; train_gene_expr_recon_loss: 925605.9372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3525216.5378; train_optim_loss: 3525216.5378; val_kl_reg_loss: 19689.8440; val_edge_recon_loss: 2603785.6705; val_gene_expr_recon_loss: 935188.8864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3558664.4205; val_optim_loss: 3558664.4205
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9832; val_auprc_score: 0.9763; val_best_acc_score: 0.9549; val_best_f1_score: 0.9562; train_kl_reg_loss: 20131.8495; train_edge_recon_loss: 2578206.2643; train_gene_expr_recon_loss: 921902.3366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3520240.4492; train_optim_loss: 3520240.4492; val_kl_reg_loss: 19801.9710; val_edge_recon_loss: 2603501.0682; val_gene_expr_recon_loss: 931191.4347; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3554494.4886; val_optim_loss: 3554494.4886
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9842; val_auprc_score: 0.9777; val_best_acc_score: 0.9571; val_best_f1_score: 0.9581; train_kl_reg_loss: 20003.1049; train_edge_recon_loss: 2575383.4154; train_gene_expr_recon_loss: 917737.8392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3513124.3685; train_optim_loss: 3513124.3685; val_kl_reg_loss: 19225.2306; val_edge_recon_loss: 2602785.5341; val_gene_expr_recon_loss: 928187.8807; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3550198.6136; val_optim_loss: 3550198.6136
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9837; val_auprc_score: 0.9768; val_best_acc_score: 0.9564; val_best_f1_score: 0.9577; train_kl_reg_loss: 19767.2456; train_edge_recon_loss: 2576071.0729; train_gene_expr_recon_loss: 914032.4795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3509870.7904; train_optim_loss: 3509870.7904; val_kl_reg_loss: 19210.5641; val_edge_recon_loss: 2602525.4545; val_gene_expr_recon_loss: 928509.2443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3550245.2614; val_optim_loss: 3550245.2614
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9846; val_auprc_score: 0.9781; val_best_acc_score: 0.9580; val_best_f1_score: 0.9590; train_kl_reg_loss: 19602.9437; train_edge_recon_loss: 2576550.6979; train_gene_expr_recon_loss: 910666.0124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3506819.6458; train_optim_loss: 3506819.6458; val_kl_reg_loss: 18855.1883; val_edge_recon_loss: 2600731.2614; val_gene_expr_recon_loss: 923958.8523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3543545.2841; val_optim_loss: 3543545.2841
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9838; val_auprc_score: 0.9765; val_best_acc_score: 0.9584; val_best_f1_score: 0.9595; train_kl_reg_loss: 19388.6486; train_edge_recon_loss: 2574859.0495; train_gene_expr_recon_loss: 907442.8053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3501690.5117; train_optim_loss: 3501690.5117; val_kl_reg_loss: 18769.3116; val_edge_recon_loss: 2600585.9318; val_gene_expr_recon_loss: 924518.7472; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3543873.9773; val_optim_loss: 3543873.9773
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9840; val_auprc_score: 0.9767; val_best_acc_score: 0.9589; val_best_f1_score: 0.9599; train_kl_reg_loss: 19175.3426; train_edge_recon_loss: 2574656.9128; train_gene_expr_recon_loss: 903555.6400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3497387.8932; train_optim_loss: 3497387.8932; val_kl_reg_loss: 18590.0432; val_edge_recon_loss: 2599114.8636; val_gene_expr_recon_loss: 924937.8636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3542642.7841; val_optim_loss: 3542642.7841
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9852; val_auprc_score: 0.9797; val_best_acc_score: 0.9596; val_best_f1_score: 0.9606; train_kl_reg_loss: 19074.0942; train_edge_recon_loss: 2573213.8594; train_gene_expr_recon_loss: 900958.2604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3493246.2057; train_optim_loss: 3493246.2057; val_kl_reg_loss: 18885.1151; val_edge_recon_loss: 2599187.7727; val_gene_expr_recon_loss: 922802.6790; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3540875.5795; val_optim_loss: 3540875.5795
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9847; val_auprc_score: 0.9784; val_best_acc_score: 0.9590; val_best_f1_score: 0.9601; train_kl_reg_loss: 19014.6292; train_edge_recon_loss: 2574150.0794; train_gene_expr_recon_loss: 898686.3613; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3491851.0755; train_optim_loss: 3491851.0755; val_kl_reg_loss: 18572.4224; val_edge_recon_loss: 2600609.4773; val_gene_expr_recon_loss: 920325.6449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3539507.5455; val_optim_loss: 3539507.5455
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9864; val_auprc_score: 0.9812; val_best_acc_score: 0.9613; val_best_f1_score: 0.9623; train_kl_reg_loss: 18870.5475; train_edge_recon_loss: 2571153.7943; train_gene_expr_recon_loss: 896737.5485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3486761.8945; train_optim_loss: 3486761.8945; val_kl_reg_loss: 18268.0768; val_edge_recon_loss: 2591328.5455; val_gene_expr_recon_loss: 918881.5085; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3528478.1364; val_optim_loss: 3528478.1364
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9856; val_auprc_score: 0.9805; val_best_acc_score: 0.9596; val_best_f1_score: 0.9606; train_kl_reg_loss: 18752.9508; train_edge_recon_loss: 2570992.7122; train_gene_expr_recon_loss: 893197.7826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3482943.4479; train_optim_loss: 3482943.4479; val_kl_reg_loss: 18296.8661; val_edge_recon_loss: 2600148.7045; val_gene_expr_recon_loss: 916191.2642; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3534636.8523; val_optim_loss: 3534636.8523
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9855; val_auprc_score: 0.9799; val_best_acc_score: 0.9604; val_best_f1_score: 0.9615; train_kl_reg_loss: 18655.7643; train_edge_recon_loss: 2571892.9128; train_gene_expr_recon_loss: 892285.8701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3482834.5456; train_optim_loss: 3482834.5456; val_kl_reg_loss: 18040.3894; val_edge_recon_loss: 2598971.0000; val_gene_expr_recon_loss: 917120.1222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3534131.5341; val_optim_loss: 3534131.5341
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9854; val_auprc_score: 0.9796; val_best_acc_score: 0.9603; val_best_f1_score: 0.9613; train_kl_reg_loss: 18576.7289; train_edge_recon_loss: 2571260.7513; train_gene_expr_recon_loss: 889106.0837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3478943.5508; train_optim_loss: 3478943.5508; val_kl_reg_loss: 18150.5392; val_edge_recon_loss: 2596524.0909; val_gene_expr_recon_loss: 914331.0256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3529005.6932; val_optim_loss: 3529005.6932
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9853; val_auprc_score: 0.9789; val_best_acc_score: 0.9608; val_best_f1_score: 0.9618; train_kl_reg_loss: 18384.9830; train_edge_recon_loss: 2570253.9049; train_gene_expr_recon_loss: 887115.4014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3475754.2904; train_optim_loss: 3475754.2904; val_kl_reg_loss: 17896.7967; val_edge_recon_loss: 2597445.3636; val_gene_expr_recon_loss: 916219.4801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3531561.6818; val_optim_loss: 3531561.6818

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9844; val_auprc_score: 0.9780; val_best_acc_score: 0.9614; val_best_f1_score: 0.9624; train_kl_reg_loss: 18371.3675; train_edge_recon_loss: 2568057.3945; train_gene_expr_recon_loss: 882116.8037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3468545.5573; train_optim_loss: 3468545.5573; val_kl_reg_loss: 17846.9859; val_edge_recon_loss: 2597340.4432; val_gene_expr_recon_loss: 913439.4176; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3528626.8409; val_optim_loss: 3528626.8409
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9865; val_auprc_score: 0.9814; val_best_acc_score: 0.9615; val_best_f1_score: 0.9624; train_kl_reg_loss: 18335.7568; train_edge_recon_loss: 2569344.2448; train_gene_expr_recon_loss: 881971.4447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3469651.4388; train_optim_loss: 3469651.4388; val_kl_reg_loss: 17840.2773; val_edge_recon_loss: 2593692.2159; val_gene_expr_recon_loss: 913353.7869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3524886.2614; val_optim_loss: 3524886.2614
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9865; val_auprc_score: 0.9813; val_best_acc_score: 0.9624; val_best_f1_score: 0.9632; train_kl_reg_loss: 18246.0567; train_edge_recon_loss: 2570442.2643; train_gene_expr_recon_loss: 880302.1406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3468990.4661; train_optim_loss: 3468990.4661; val_kl_reg_loss: 17804.8673; val_edge_recon_loss: 2592851.0341; val_gene_expr_recon_loss: 913767.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3524423.3182; val_optim_loss: 3524423.3182
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9856; val_auprc_score: 0.9800; val_best_acc_score: 0.9605; val_best_f1_score: 0.9615; train_kl_reg_loss: 18235.3187; train_edge_recon_loss: 2568993.5417; train_gene_expr_recon_loss: 879591.9017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3466820.7513; train_optim_loss: 3466820.7513; val_kl_reg_loss: 17775.5799; val_edge_recon_loss: 2596135.6932; val_gene_expr_recon_loss: 910776.7869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3524688.0568; val_optim_loss: 3524688.0568
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9859; val_auprc_score: 0.9805; val_best_acc_score: 0.9620; val_best_f1_score: 0.9629; train_kl_reg_loss: 18272.6297; train_edge_recon_loss: 2567393.5742; train_gene_expr_recon_loss: 880044.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3465710.3581; train_optim_loss: 3465710.3581; val_kl_reg_loss: 17676.5081; val_edge_recon_loss: 2592859.6136; val_gene_expr_recon_loss: 911250.0511; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3521786.1705; val_optim_loss: 3521786.1705
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9858; val_auprc_score: 0.9802; val_best_acc_score: 0.9620; val_best_f1_score: 0.9628; train_kl_reg_loss: 18226.4841; train_edge_recon_loss: 2568289.3815; train_gene_expr_recon_loss: 880131.7686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3466647.6406; train_optim_loss: 3466647.6406; val_kl_reg_loss: 17755.1610; val_edge_recon_loss: 2592104.9318; val_gene_expr_recon_loss: 913221.8949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3523082.0114; val_optim_loss: 3523082.0114
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9852; val_auprc_score: 0.9793; val_best_acc_score: 0.9617; val_best_f1_score: 0.9626; train_kl_reg_loss: 18176.2343; train_edge_recon_loss: 2566671.3008; train_gene_expr_recon_loss: 878650.6198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3463498.1484; train_optim_loss: 3463498.1484; val_kl_reg_loss: 17769.4941; val_edge_recon_loss: 2593810.9545; val_gene_expr_recon_loss: 911566.2699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3523146.7045; val_optim_loss: 3523146.7045
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9861; val_auprc_score: 0.9807; val_best_acc_score: 0.9617; val_best_f1_score: 0.9627; train_kl_reg_loss: 18179.6484; train_edge_recon_loss: 2568772.8815; train_gene_expr_recon_loss: 878973.3490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3465925.8854; train_optim_loss: 3465925.8854; val_kl_reg_loss: 17646.2953; val_edge_recon_loss: 2594601.2386; val_gene_expr_recon_loss: 913854.4943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3526102.0455; val_optim_loss: 3526102.0455
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9864; val_auprc_score: 0.9810; val_best_acc_score: 0.9626; val_best_f1_score: 0.9635; train_kl_reg_loss: 18133.7276; train_edge_recon_loss: 2568195.4349; train_gene_expr_recon_loss: 877659.5947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3463988.7552; train_optim_loss: 3463988.7552; val_kl_reg_loss: 17633.6987; val_edge_recon_loss: 2590523.5455; val_gene_expr_recon_loss: 908881.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3517038.2273; val_optim_loss: 3517038.2273
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9863; val_auprc_score: 0.9805; val_best_acc_score: 0.9627; val_best_f1_score: 0.9636; train_kl_reg_loss: 18136.1676; train_edge_recon_loss: 2567487.1003; train_gene_expr_recon_loss: 878066.2178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3463689.4844; train_optim_loss: 3463689.4844; val_kl_reg_loss: 17736.2496; val_edge_recon_loss: 2592478.8295; val_gene_expr_recon_loss: 911179.7358; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3521394.7955; val_optim_loss: 3521394.7955
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9865; val_auprc_score: 0.9818; val_best_acc_score: 0.9620; val_best_f1_score: 0.9630; train_kl_reg_loss: 18141.1583; train_edge_recon_loss: 2568188.9193; train_gene_expr_recon_loss: 878082.8014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3464412.8776; train_optim_loss: 3464412.8776; val_kl_reg_loss: 17618.7275; val_edge_recon_loss: 2592541.5341; val_gene_expr_recon_loss: 914617.6761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3524777.9773; val_optim_loss: 3524777.9773
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9863; val_auprc_score: 0.9808; val_best_acc_score: 0.9627; val_best_f1_score: 0.9634; train_kl_reg_loss: 18112.5337; train_edge_recon_loss: 2568599.8685; train_gene_expr_recon_loss: 878518.2051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3465230.6107; train_optim_loss: 3465230.6107; val_kl_reg_loss: 17639.5399; val_edge_recon_loss: 2592729.5795; val_gene_expr_recon_loss: 911768.6733; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3522137.7841; val_optim_loss: 3522137.7841
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9860; val_auprc_score: 0.9805; val_best_acc_score: 0.9616; val_best_f1_score: 0.9625; train_kl_reg_loss: 18114.1521; train_edge_recon_loss: 2567403.2109; train_gene_expr_recon_loss: 878082.2295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3463599.5846; train_optim_loss: 3463599.5846; val_kl_reg_loss: 17546.1821; val_edge_recon_loss: 2593356.5341; val_gene_expr_recon_loss: 912677.5994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3523580.2955; val_optim_loss: 3523580.2955

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9862; val_auprc_score: 0.9802; val_best_acc_score: 0.9632; val_best_f1_score: 0.9641; train_kl_reg_loss: 18061.9465; train_edge_recon_loss: 2568649.7982; train_gene_expr_recon_loss: 877895.2949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3464607.0273; train_optim_loss: 3464607.0273; val_kl_reg_loss: 17602.6414; val_edge_recon_loss: 2594016.0341; val_gene_expr_recon_loss: 908275.3835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3519894.0909; val_optim_loss: 3519894.0909
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9861; val_auprc_score: 0.9808; val_best_acc_score: 0.9610; val_best_f1_score: 0.9620; train_kl_reg_loss: 18056.0558; train_edge_recon_loss: 2566714.4505; train_gene_expr_recon_loss: 877433.0840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3462203.6042; train_optim_loss: 3462203.6042; val_kl_reg_loss: 17592.8105; val_edge_recon_loss: 2595032.0682; val_gene_expr_recon_loss: 913025.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3525650.7614; val_optim_loss: 3525650.7614
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9862; val_auprc_score: 0.9808; val_best_acc_score: 0.9612; val_best_f1_score: 0.9621; train_kl_reg_loss: 18053.2483; train_edge_recon_loss: 2566805.4622; train_gene_expr_recon_loss: 877131.7249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3461990.4310; train_optim_loss: 3461990.4310; val_kl_reg_loss: 17539.3670; val_edge_recon_loss: 2595953.3068; val_gene_expr_recon_loss: 908835.0881; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3522327.7841; val_optim_loss: 3522327.7841
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9862; val_auprc_score: 0.9813; val_best_acc_score: 0.9609; val_best_f1_score: 0.9620; train_kl_reg_loss: 18052.4671; train_edge_recon_loss: 2567694.0078; train_gene_expr_recon_loss: 876518.3877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3462264.8659; train_optim_loss: 3462264.8659; val_kl_reg_loss: 17558.7895; val_edge_recon_loss: 2595272.0568; val_gene_expr_recon_loss: 911441.0369; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3524271.9091; val_optim_loss: 3524271.9091

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 31 min 30 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9864
Val AUPRC score: 0.9814
Val best accuracy score: 0.9621
Val best F1 score: 0.9630
Val gene expr MSE score: 0.6492

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
