None
Run timestamp: 15072023_033026_156.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_156']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9842; val_auprc_score: 0.9813; val_best_acc_score: 0.9417; val_best_f1_score: 0.9429; train_kl_reg_loss: 15473.4958; train_edge_recon_loss: 26411112.1668; train_gene_expr_recon_loss: 838564.0465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27265149.6804; train_optim_loss: 27265149.6804; val_kl_reg_loss: 13559.3055; val_edge_recon_loss: 26300930.4669; val_gene_expr_recon_loss: 774544.1071; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27089033.8328; val_optim_loss: 27089033.8328
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9877; val_auprc_score: 0.9851; val_best_acc_score: 0.9510; val_best_f1_score: 0.9521; train_kl_reg_loss: 12962.9506; train_edge_recon_loss: 25971856.0147; train_gene_expr_recon_loss: 758075.1823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26742894.1722; train_optim_loss: 26742894.1722; val_kl_reg_loss: 12797.0781; val_edge_recon_loss: 26013758.2578; val_gene_expr_recon_loss: 749277.4771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26775832.8153; val_optim_loss: 26775832.8153
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9907; val_auprc_score: 0.9885; val_best_acc_score: 0.9604; val_best_f1_score: 0.9612; train_kl_reg_loss: 13036.1535; train_edge_recon_loss: 25862302.7742; train_gene_expr_recon_loss: 735431.9078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26610770.8293; train_optim_loss: 26610770.8293; val_kl_reg_loss: 13210.8716; val_edge_recon_loss: 25991964.7875; val_gene_expr_recon_loss: 726633.9236; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26731809.5610; val_optim_loss: 26731809.5610
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9911; val_auprc_score: 0.9889; val_best_acc_score: 0.9624; val_best_f1_score: 0.9631; train_kl_reg_loss: 13239.0730; train_edge_recon_loss: 25816825.5780; train_gene_expr_recon_loss: 721443.2724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26551507.9271; train_optim_loss: 26551507.9271; val_kl_reg_loss: 13092.0741; val_edge_recon_loss: 25868894.0000; val_gene_expr_recon_loss: 716728.0137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26598714.1394; val_optim_loss: 26598714.1394
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9919; val_auprc_score: 0.9898; val_best_acc_score: 0.9643; val_best_f1_score: 0.9649; train_kl_reg_loss: 13471.6994; train_edge_recon_loss: 25784275.0846; train_gene_expr_recon_loss: 711178.4447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26508925.2180; train_optim_loss: 26508925.2180; val_kl_reg_loss: 13424.8505; val_edge_recon_loss: 25889157.7143; val_gene_expr_recon_loss: 708468.8955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26611051.3380; val_optim_loss: 26611051.3380
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9922; val_auprc_score: 0.9903; val_best_acc_score: 0.9653; val_best_f1_score: 0.9659; train_kl_reg_loss: 13626.7426; train_edge_recon_loss: 25758104.8627; train_gene_expr_recon_loss: 704269.9725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26476001.5516; train_optim_loss: 26476001.5516; val_kl_reg_loss: 13487.9202; val_edge_recon_loss: 25871896.1324; val_gene_expr_recon_loss: 706955.6733; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26592339.7073; val_optim_loss: 26592339.7073
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9926; val_auprc_score: 0.9906; val_best_acc_score: 0.9671; val_best_f1_score: 0.9676; train_kl_reg_loss: 13728.3569; train_edge_recon_loss: 25740651.2560; train_gene_expr_recon_loss: 698949.2789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26453328.8728; train_optim_loss: 26453328.8728; val_kl_reg_loss: 13641.9264; val_edge_recon_loss: 25808421.1638; val_gene_expr_recon_loss: 699242.9253; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26521306.0209; val_optim_loss: 26521306.0209
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9932; val_auprc_score: 0.9913; val_best_acc_score: 0.9689; val_best_f1_score: 0.9694; train_kl_reg_loss: 13837.0660; train_edge_recon_loss: 25719401.8317; train_gene_expr_recon_loss: 694983.2371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26428222.1389; train_optim_loss: 26428222.1389; val_kl_reg_loss: 13957.7831; val_edge_recon_loss: 25819563.4495; val_gene_expr_recon_loss: 697142.1476; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26530663.4077; val_optim_loss: 26530663.4077
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9935; val_auprc_score: 0.9917; val_best_acc_score: 0.9696; val_best_f1_score: 0.9700; train_kl_reg_loss: 13827.3331; train_edge_recon_loss: 25701724.1963; train_gene_expr_recon_loss: 692451.0954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26408002.6237; train_optim_loss: 26408002.6237; val_kl_reg_loss: 13581.8978; val_edge_recon_loss: 25784657.5261; val_gene_expr_recon_loss: 691575.4286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26489814.8293; val_optim_loss: 26489814.8293
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9938; val_auprc_score: 0.9919; val_best_acc_score: 0.9719; val_best_f1_score: 0.9722; train_kl_reg_loss: 13822.3233; train_edge_recon_loss: 25694356.6362; train_gene_expr_recon_loss: 690243.9210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26398422.8883; train_optim_loss: 26398422.8883; val_kl_reg_loss: 13623.7135; val_edge_recon_loss: 25747735.5749; val_gene_expr_recon_loss: 690411.6411; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26451770.9129; val_optim_loss: 26451770.9129
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9940; val_auprc_score: 0.9922; val_best_acc_score: 0.9728; val_best_f1_score: 0.9732; train_kl_reg_loss: 13799.9413; train_edge_recon_loss: 25682274.0822; train_gene_expr_recon_loss: 688575.5071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26384649.5306; train_optim_loss: 26384649.5306; val_kl_reg_loss: 13883.9072; val_edge_recon_loss: 25750796.8711; val_gene_expr_recon_loss: 688994.1733; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26453675.0314; val_optim_loss: 26453675.0314
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9938; val_auprc_score: 0.9919; val_best_acc_score: 0.9729; val_best_f1_score: 0.9732; train_kl_reg_loss: 13801.2183; train_edge_recon_loss: 25665443.1939; train_gene_expr_recon_loss: 687014.7332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26366259.1148; train_optim_loss: 26366259.1148; val_kl_reg_loss: 14133.5685; val_edge_recon_loss: 25735634.1463; val_gene_expr_recon_loss: 686780.0109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26436547.7491; val_optim_loss: 26436547.7491
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9944; val_auprc_score: 0.9928; val_best_acc_score: 0.9744; val_best_f1_score: 0.9747; train_kl_reg_loss: 13829.9744; train_edge_recon_loss: 25654063.2118; train_gene_expr_recon_loss: 686139.5417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26354032.6967; train_optim_loss: 26354032.6967; val_kl_reg_loss: 13586.1490; val_edge_recon_loss: 25723182.1394; val_gene_expr_recon_loss: 686945.8412; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26423714.0767; val_optim_loss: 26423714.0767
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9943; val_auprc_score: 0.9925; val_best_acc_score: 0.9745; val_best_f1_score: 0.9748; train_kl_reg_loss: 13821.8160; train_edge_recon_loss: 25648317.3235; train_gene_expr_recon_loss: 684688.4443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26346827.5981; train_optim_loss: 26346827.5981; val_kl_reg_loss: 13933.6822; val_edge_recon_loss: 25710372.8571; val_gene_expr_recon_loss: 685866.8463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26410173.3589; val_optim_loss: 26410173.3589
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9949; val_auprc_score: 0.9933; val_best_acc_score: 0.9765; val_best_f1_score: 0.9768; train_kl_reg_loss: 13731.3249; train_edge_recon_loss: 25639446.1358; train_gene_expr_recon_loss: 684444.4780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26337621.9294; train_optim_loss: 26337621.9294; val_kl_reg_loss: 13521.8697; val_edge_recon_loss: 25691140.8571; val_gene_expr_recon_loss: 684566.7949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26389229.5052; val_optim_loss: 26389229.5052
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9948; val_auprc_score: 0.9932; val_best_acc_score: 0.9757; val_best_f1_score: 0.9760; train_kl_reg_loss: 13719.2706; train_edge_recon_loss: 25631663.4298; train_gene_expr_recon_loss: 683480.0377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26328862.7525; train_optim_loss: 26328862.7525; val_kl_reg_loss: 13475.2192; val_edge_recon_loss: 25690032.6760; val_gene_expr_recon_loss: 684732.0457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26388239.9233; val_optim_loss: 26388239.9233
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9949; val_auprc_score: 0.9934; val_best_acc_score: 0.9763; val_best_f1_score: 0.9765; train_kl_reg_loss: 13704.2126; train_edge_recon_loss: 25626103.9341; train_gene_expr_recon_loss: 683036.3621; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26322844.5074; train_optim_loss: 26322844.5074; val_kl_reg_loss: 13722.0215; val_edge_recon_loss: 25695832.6551; val_gene_expr_recon_loss: 684905.5640; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26394460.2160; val_optim_loss: 26394460.2160
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9946; val_auprc_score: 0.9928; val_best_acc_score: 0.9764; val_best_f1_score: 0.9766; train_kl_reg_loss: 13701.3609; train_edge_recon_loss: 25621122.5198; train_gene_expr_recon_loss: 681881.1848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26316705.0473; train_optim_loss: 26316705.0473; val_kl_reg_loss: 13412.0969; val_edge_recon_loss: 25681172.8084; val_gene_expr_recon_loss: 684009.2415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26378594.1533; val_optim_loss: 26378594.1533
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9947; val_auprc_score: 0.9927; val_best_acc_score: 0.9771; val_best_f1_score: 0.9773; train_kl_reg_loss: 13729.3452; train_edge_recon_loss: 25609923.7618; train_gene_expr_recon_loss: 681816.7927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26305469.8798; train_optim_loss: 26305469.8798; val_kl_reg_loss: 13184.5577; val_edge_recon_loss: 25683509.3449; val_gene_expr_recon_loss: 683518.4941; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26380212.4390; val_optim_loss: 26380212.4390
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9951; val_auprc_score: 0.9935; val_best_acc_score: 0.9778; val_best_f1_score: 0.9780; train_kl_reg_loss: 13629.9404; train_edge_recon_loss: 25611655.5493; train_gene_expr_recon_loss: 680932.2670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26306217.7657; train_optim_loss: 26306217.7657; val_kl_reg_loss: 14042.4517; val_edge_recon_loss: 25670849.8955; val_gene_expr_recon_loss: 683556.9865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26368449.2265; val_optim_loss: 26368449.2265
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9948; val_auprc_score: 0.9930; val_best_acc_score: 0.9770; val_best_f1_score: 0.9772; train_kl_reg_loss: 13675.9686; train_edge_recon_loss: 25604520.9232; train_gene_expr_recon_loss: 681255.4682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26299452.3367; train_optim_loss: 26299452.3367; val_kl_reg_loss: 13973.2151; val_edge_recon_loss: 25695565.3589; val_gene_expr_recon_loss: 683311.5305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26392850.1185; val_optim_loss: 26392850.1185
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9951; val_auprc_score: 0.9935; val_best_acc_score: 0.9777; val_best_f1_score: 0.9779; train_kl_reg_loss: 13650.2642; train_edge_recon_loss: 25602491.6656; train_gene_expr_recon_loss: 680337.6521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26296479.5330; train_optim_loss: 26296479.5330; val_kl_reg_loss: 13602.8652; val_edge_recon_loss: 25643832.4251; val_gene_expr_recon_loss: 683683.3713; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26341118.7108; val_optim_loss: 26341118.7108
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9951; val_auprc_score: 0.9933; val_best_acc_score: 0.9785; val_best_f1_score: 0.9787; train_kl_reg_loss: 13670.5889; train_edge_recon_loss: 25595929.1234; train_gene_expr_recon_loss: 679865.8854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26289465.6106; train_optim_loss: 26289465.6106; val_kl_reg_loss: 13574.5406; val_edge_recon_loss: 25638474.3206; val_gene_expr_recon_loss: 681474.9839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26333523.7770; val_optim_loss: 26333523.7770
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9949; val_auprc_score: 0.9930; val_best_acc_score: 0.9775; val_best_f1_score: 0.9778; train_kl_reg_loss: 13640.9786; train_edge_recon_loss: 25594834.7137; train_gene_expr_recon_loss: 679548.4908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26288024.1761; train_optim_loss: 26288024.1761; val_kl_reg_loss: 13503.3701; val_edge_recon_loss: 25668687.3031; val_gene_expr_recon_loss: 682551.8863; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26364742.5923; val_optim_loss: 26364742.5923
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9951; val_auprc_score: 0.9934; val_best_acc_score: 0.9780; val_best_f1_score: 0.9783; train_kl_reg_loss: 13667.1555; train_edge_recon_loss: 25581811.0939; train_gene_expr_recon_loss: 678838.0324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26274316.2653; train_optim_loss: 26274316.2653; val_kl_reg_loss: 13757.6319; val_edge_recon_loss: 25636955.7491; val_gene_expr_recon_loss: 680150.9103; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26330864.3624; val_optim_loss: 26330864.3624
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9951; val_auprc_score: 0.9934; val_best_acc_score: 0.9779; val_best_f1_score: 0.9782; train_kl_reg_loss: 13674.7077; train_edge_recon_loss: 25582502.9271; train_gene_expr_recon_loss: 678917.7198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26275095.3592; train_optim_loss: 26275095.3592; val_kl_reg_loss: 13538.4025; val_edge_recon_loss: 25654942.8780; val_gene_expr_recon_loss: 682250.6444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26350731.9443; val_optim_loss: 26350731.9443
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9953; val_auprc_score: 0.9936; val_best_acc_score: 0.9793; val_best_f1_score: 0.9796; train_kl_reg_loss: 13692.6930; train_edge_recon_loss: 25579849.1823; train_gene_expr_recon_loss: 678738.7163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26272280.5935; train_optim_loss: 26272280.5935; val_kl_reg_loss: 13593.7928; val_edge_recon_loss: 25637893.1498; val_gene_expr_recon_loss: 682509.5851; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26333996.5087; val_optim_loss: 26333996.5087
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9953; val_auprc_score: 0.9936; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 13696.1539; train_edge_recon_loss: 25574542.5407; train_gene_expr_recon_loss: 677874.9076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26266113.5865; train_optim_loss: 26266113.5865; val_kl_reg_loss: 13756.6814; val_edge_recon_loss: 25623697.8467; val_gene_expr_recon_loss: 679112.1855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26316566.7805; val_optim_loss: 26316566.7805
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9952; val_auprc_score: 0.9935; val_best_acc_score: 0.9788; val_best_f1_score: 0.9790; train_kl_reg_loss: 13660.5077; train_edge_recon_loss: 25579349.4523; train_gene_expr_recon_loss: 677892.0378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26270901.9860; train_optim_loss: 26270901.9860; val_kl_reg_loss: 13565.7644; val_edge_recon_loss: 25626242.0279; val_gene_expr_recon_loss: 679476.3415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26319284.1185; val_optim_loss: 26319284.1185
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9951; val_auprc_score: 0.9933; val_best_acc_score: 0.9783; val_best_f1_score: 0.9786; train_kl_reg_loss: 13696.3556; train_edge_recon_loss: 25573643.7347; train_gene_expr_recon_loss: 677631.7953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26264971.9030; train_optim_loss: 26264971.9030; val_kl_reg_loss: 13443.1105; val_edge_recon_loss: 25604510.3206; val_gene_expr_recon_loss: 680134.4861; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26298087.8885; val_optim_loss: 26298087.8885
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9954; val_auprc_score: 0.9936; val_best_acc_score: 0.9791; val_best_f1_score: 0.9793; train_kl_reg_loss: 13689.5312; train_edge_recon_loss: 25568062.0877; train_gene_expr_recon_loss: 677808.3516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26259559.9550; train_optim_loss: 26259559.9550; val_kl_reg_loss: 13202.8927; val_edge_recon_loss: 25615982.5505; val_gene_expr_recon_loss: 678970.1892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26308155.6167; val_optim_loss: 26308155.6167
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9951; val_auprc_score: 0.9934; val_best_acc_score: 0.9786; val_best_f1_score: 0.9788; train_kl_reg_loss: 13656.3468; train_edge_recon_loss: 25569990.7580; train_gene_expr_recon_loss: 676880.4842; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26260527.6098; train_optim_loss: 26260527.6098; val_kl_reg_loss: 13222.6001; val_edge_recon_loss: 25612319.8537; val_gene_expr_recon_loss: 679270.0605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26304812.5157; val_optim_loss: 26304812.5157
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9952; val_auprc_score: 0.9935; val_best_acc_score: 0.9791; val_best_f1_score: 0.9794; train_kl_reg_loss: 13668.4884; train_edge_recon_loss: 25560924.9418; train_gene_expr_recon_loss: 676600.7256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26251194.1528; train_optim_loss: 26251194.1528; val_kl_reg_loss: 13719.0404; val_edge_recon_loss: 25609343.5052; val_gene_expr_recon_loss: 678864.8519; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26301927.3728; val_optim_loss: 26301927.3728
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9951; val_auprc_score: 0.9932; val_best_acc_score: 0.9789; val_best_f1_score: 0.9792; train_kl_reg_loss: 13685.9933; train_edge_recon_loss: 25562772.6711; train_gene_expr_recon_loss: 676527.1302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26252985.8045; train_optim_loss: 26252985.8045; val_kl_reg_loss: 13725.0160; val_edge_recon_loss: 25618790.9268; val_gene_expr_recon_loss: 679542.8545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26312058.8084; val_optim_loss: 26312058.8084

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9955; val_auprc_score: 0.9939; val_best_acc_score: 0.9797; val_best_f1_score: 0.9799; train_kl_reg_loss: 13877.5160; train_edge_recon_loss: 25545710.8417; train_gene_expr_recon_loss: 670480.3910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26230068.7308; train_optim_loss: 26230068.7308; val_kl_reg_loss: 13951.5065; val_edge_recon_loss: 25598798.5784; val_gene_expr_recon_loss: 672746.1923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26285496.2439; val_optim_loss: 26285496.2439
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9955; val_auprc_score: 0.9938; val_best_acc_score: 0.9801; val_best_f1_score: 0.9802; train_kl_reg_loss: 13937.3004; train_edge_recon_loss: 25542199.9697; train_gene_expr_recon_loss: 669742.7011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26225880.0101; train_optim_loss: 26225880.0101; val_kl_reg_loss: 13903.8495; val_edge_recon_loss: 25589379.3031; val_gene_expr_recon_loss: 672073.8702; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26275357.0244; val_optim_loss: 26275357.0244
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9958; val_auprc_score: 0.9943; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 13943.5849; train_edge_recon_loss: 25536247.6462; train_gene_expr_recon_loss: 668874.3802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26219065.5974; train_optim_loss: 26219065.5974; val_kl_reg_loss: 13834.9582; val_edge_recon_loss: 25583554.1603; val_gene_expr_recon_loss: 672433.8097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26269822.9547; val_optim_loss: 26269822.9547
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9955; val_auprc_score: 0.9937; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 13906.9196; train_edge_recon_loss: 25530875.2684; train_gene_expr_recon_loss: 668877.8458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26213660.0310; train_optim_loss: 26213660.0310; val_kl_reg_loss: 13709.8271; val_edge_recon_loss: 25584969.1916; val_gene_expr_recon_loss: 671270.9209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26269949.9094; val_optim_loss: 26269949.9094
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9956; val_auprc_score: 0.9939; val_best_acc_score: 0.9806; val_best_f1_score: 0.9807; train_kl_reg_loss: 13833.2323; train_edge_recon_loss: 25537766.2917; train_gene_expr_recon_loss: 668796.6651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26220396.1994; train_optim_loss: 26220396.1994; val_kl_reg_loss: 13787.7597; val_edge_recon_loss: 25580883.8746; val_gene_expr_recon_loss: 672211.1627; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26266882.7805; val_optim_loss: 26266882.7805
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9955; val_auprc_score: 0.9938; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 13859.2543; train_edge_recon_loss: 25540779.0636; train_gene_expr_recon_loss: 668985.1745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26223623.4864; train_optim_loss: 26223623.4864; val_kl_reg_loss: 13829.5925; val_edge_recon_loss: 25575929.8258; val_gene_expr_recon_loss: 671948.3911; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26261707.7770; val_optim_loss: 26261707.7770
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9956; val_auprc_score: 0.9939; val_best_acc_score: 0.9805; val_best_f1_score: 0.9806; train_kl_reg_loss: 13894.5589; train_edge_recon_loss: 25528994.5834; train_gene_expr_recon_loss: 668760.2684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26211649.3910; train_optim_loss: 26211649.3910; val_kl_reg_loss: 13853.3982; val_edge_recon_loss: 25580866.6899; val_gene_expr_recon_loss: 672295.5538; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26267015.5958; val_optim_loss: 26267015.5958
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9958; val_auprc_score: 0.9940; val_best_acc_score: 0.9809; val_best_f1_score: 0.9810; train_kl_reg_loss: 13844.9078; train_edge_recon_loss: 25534192.5834; train_gene_expr_recon_loss: 668713.6627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26216751.1753; train_optim_loss: 26216751.1753; val_kl_reg_loss: 13816.4472; val_edge_recon_loss: 25570507.2474; val_gene_expr_recon_loss: 670175.3722; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26254499.0732; val_optim_loss: 26254499.0732
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9958; val_auprc_score: 0.9943; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 13841.3002; train_edge_recon_loss: 25527190.9325; train_gene_expr_recon_loss: 668558.5633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26209590.7704; train_optim_loss: 26209590.7704; val_kl_reg_loss: 13763.2968; val_edge_recon_loss: 25556555.4704; val_gene_expr_recon_loss: 670694.0183; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26241012.7805; val_optim_loss: 26241012.7805
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9956; val_auprc_score: 0.9939; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 13754.4112; train_edge_recon_loss: 25525981.2413; train_gene_expr_recon_loss: 668761.0927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26208496.7308; train_optim_loss: 26208496.7308; val_kl_reg_loss: 13775.5501; val_edge_recon_loss: 25583688.8084; val_gene_expr_recon_loss: 671720.5904; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26269185.0035; val_optim_loss: 26269185.0035
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9958; val_auprc_score: 0.9941; val_best_acc_score: 0.9811; val_best_f1_score: 0.9814; train_kl_reg_loss: 13803.1461; train_edge_recon_loss: 25531131.0628; train_gene_expr_recon_loss: 668411.2024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26213345.3918; train_optim_loss: 26213345.3918; val_kl_reg_loss: 13706.3752; val_edge_recon_loss: 25558785.7073; val_gene_expr_recon_loss: 670440.3615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26242932.4042; val_optim_loss: 26242932.4042
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9957; val_auprc_score: 0.9941; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 13751.1882; train_edge_recon_loss: 25530331.0101; train_gene_expr_recon_loss: 668562.9025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26212645.0815; train_optim_loss: 26212645.0815; val_kl_reg_loss: 13698.1038; val_edge_recon_loss: 25565286.9059; val_gene_expr_recon_loss: 671625.8012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26250610.8362; val_optim_loss: 26250610.8362
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9959; val_auprc_score: 0.9944; val_best_acc_score: 0.9812; val_best_f1_score: 0.9813; train_kl_reg_loss: 13751.8870; train_edge_recon_loss: 25539406.5097; train_gene_expr_recon_loss: 668251.7051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26221410.0908; train_optim_loss: 26221410.0908; val_kl_reg_loss: 13626.0302; val_edge_recon_loss: 25571524.3624; val_gene_expr_recon_loss: 670936.4917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26256086.8711; val_optim_loss: 26256086.8711

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9956; val_auprc_score: 0.9938; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 13724.6879; train_edge_recon_loss: 25526713.3305; train_gene_expr_recon_loss: 667687.9696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26208125.9806; train_optim_loss: 26208125.9806; val_kl_reg_loss: 13654.8939; val_edge_recon_loss: 25569389.1359; val_gene_expr_recon_loss: 670568.0708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26253612.0627; val_optim_loss: 26253612.0627
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9959; val_auprc_score: 0.9944; val_best_acc_score: 0.9811; val_best_f1_score: 0.9812; train_kl_reg_loss: 13754.0048; train_edge_recon_loss: 25526462.0272; train_gene_expr_recon_loss: 667438.6186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26207654.6237; train_optim_loss: 26207654.6237; val_kl_reg_loss: 13674.0340; val_edge_recon_loss: 25570872.2230; val_gene_expr_recon_loss: 670317.1082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26254863.4913; val_optim_loss: 26254863.4913
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9957; val_auprc_score: 0.9939; val_best_acc_score: 0.9812; val_best_f1_score: 0.9813; train_kl_reg_loss: 13774.3211; train_edge_recon_loss: 25529277.1016; train_gene_expr_recon_loss: 667870.2670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26210921.7029; train_optim_loss: 26210921.7029; val_kl_reg_loss: 13688.4137; val_edge_recon_loss: 25566245.8188; val_gene_expr_recon_loss: 670026.8221; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26249961.0453; val_optim_loss: 26249961.0453
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9957; val_auprc_score: 0.9942; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 13784.8728; train_edge_recon_loss: 25523346.0295; train_gene_expr_recon_loss: 667763.4859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26204894.3786; train_optim_loss: 26204894.3786; val_kl_reg_loss: 13693.7407; val_edge_recon_loss: 25568328.9965; val_gene_expr_recon_loss: 671003.6810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26253026.4111; val_optim_loss: 26253026.4111

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1051 min 27 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
Val AUROC score: 0.9957
Val AUPRC score: 0.9941
Val best accuracy score: 0.9806
Val best F1 score: 0.9808
Val gene expr MSE score: 1.7375

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
