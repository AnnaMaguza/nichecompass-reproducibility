None
Run timestamp: 03072023_171838_1009.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_1009']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9837; val_auprc_score: 0.9786; val_best_acc_score: 0.9480; val_best_f1_score: 0.9489; train_kl_reg_loss: 5223.4827; train_edge_recon_loss: 31257.6846; train_gene_expr_recon_loss: 118340.6897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154821.8569; train_optim_loss: 154821.8569; val_kl_reg_loss: 4590.5112; val_edge_recon_loss: 29820.9295; val_gene_expr_recon_loss: 108660.1307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143071.5713; val_optim_loss: 143071.5713
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9879; val_auprc_score: 0.9844; val_best_acc_score: 0.9567; val_best_f1_score: 0.9575; train_kl_reg_loss: 4352.3043; train_edge_recon_loss: 29785.1716; train_gene_expr_recon_loss: 105822.5599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139960.0358; train_optim_loss: 139960.0358; val_kl_reg_loss: 4016.1330; val_edge_recon_loss: 29156.7012; val_gene_expr_recon_loss: 104395.9768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137568.8110; val_optim_loss: 137568.8110
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9895; val_auprc_score: 0.9869; val_best_acc_score: 0.9596; val_best_f1_score: 0.9604; train_kl_reg_loss: 4018.5699; train_edge_recon_loss: 29257.3176; train_gene_expr_recon_loss: 102555.4137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135831.3016; train_optim_loss: 135831.3016; val_kl_reg_loss: 3840.0860; val_edge_recon_loss: 28861.4201; val_gene_expr_recon_loss: 101719.5364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134421.0412; val_optim_loss: 134421.0412
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9909; val_auprc_score: 0.9885; val_best_acc_score: 0.9620; val_best_f1_score: 0.9626; train_kl_reg_loss: 3860.3641; train_edge_recon_loss: 28932.2445; train_gene_expr_recon_loss: 100504.6584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133297.2670; train_optim_loss: 133297.2670; val_kl_reg_loss: 3718.4634; val_edge_recon_loss: 28459.6469; val_gene_expr_recon_loss: 100348.1452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132526.2553; val_optim_loss: 132526.2553
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9914; val_auprc_score: 0.9893; val_best_acc_score: 0.9640; val_best_f1_score: 0.9646; train_kl_reg_loss: 3762.9445; train_edge_recon_loss: 28703.1161; train_gene_expr_recon_loss: 98769.1152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131235.1758; train_optim_loss: 131235.1758; val_kl_reg_loss: 3628.0805; val_edge_recon_loss: 28120.7637; val_gene_expr_recon_loss: 98992.3182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130741.1620; val_optim_loss: 130741.1620
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9920; val_auprc_score: 0.9901; val_best_acc_score: 0.9652; val_best_f1_score: 0.9658; train_kl_reg_loss: 3718.1343; train_edge_recon_loss: 28515.8074; train_gene_expr_recon_loss: 97485.8221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129719.7639; train_optim_loss: 129719.7639; val_kl_reg_loss: 3633.4338; val_edge_recon_loss: 28010.3464; val_gene_expr_recon_loss: 97649.8131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129293.5926; val_optim_loss: 129293.5926
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9925; val_auprc_score: 0.9911; val_best_acc_score: 0.9661; val_best_f1_score: 0.9666; train_kl_reg_loss: 3691.2953; train_edge_recon_loss: 28381.8546; train_gene_expr_recon_loss: 96348.8792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128422.0295; train_optim_loss: 128422.0295; val_kl_reg_loss: 3622.3935; val_edge_recon_loss: 27923.5616; val_gene_expr_recon_loss: 97055.3632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128601.3176; val_optim_loss: 128601.3176
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9930; val_auprc_score: 0.9917; val_best_acc_score: 0.9656; val_best_f1_score: 0.9661; train_kl_reg_loss: 3681.6824; train_edge_recon_loss: 28276.2683; train_gene_expr_recon_loss: 95565.5855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127523.5362; train_optim_loss: 127523.5362; val_kl_reg_loss: 3658.4496; val_edge_recon_loss: 27843.3490; val_gene_expr_recon_loss: 96884.5271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128386.3253; val_optim_loss: 128386.3253
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9932; val_auprc_score: 0.9915; val_best_acc_score: 0.9674; val_best_f1_score: 0.9679; train_kl_reg_loss: 3680.0743; train_edge_recon_loss: 28179.4093; train_gene_expr_recon_loss: 94739.8649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126599.3486; train_optim_loss: 126599.3486; val_kl_reg_loss: 3622.5703; val_edge_recon_loss: 27832.8481; val_gene_expr_recon_loss: 96004.2449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127459.6627; val_optim_loss: 127459.6627
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9933; val_auprc_score: 0.9921; val_best_acc_score: 0.9671; val_best_f1_score: 0.9677; train_kl_reg_loss: 3684.8503; train_edge_recon_loss: 28097.8175; train_gene_expr_recon_loss: 94183.3739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125966.0417; train_optim_loss: 125966.0417; val_kl_reg_loss: 3663.9403; val_edge_recon_loss: 27729.1224; val_gene_expr_recon_loss: 95690.5907; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127083.6538; val_optim_loss: 127083.6538
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9935; val_auprc_score: 0.9923; val_best_acc_score: 0.9676; val_best_f1_score: 0.9680; train_kl_reg_loss: 3692.5017; train_edge_recon_loss: 28043.4329; train_gene_expr_recon_loss: 93776.7785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125512.7134; train_optim_loss: 125512.7134; val_kl_reg_loss: 3678.1144; val_edge_recon_loss: 27673.3280; val_gene_expr_recon_loss: 95364.6601; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126716.1019; val_optim_loss: 126716.1019
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9943; val_auprc_score: 0.9934; val_best_acc_score: 0.9682; val_best_f1_score: 0.9688; train_kl_reg_loss: 3701.3258; train_edge_recon_loss: 27992.9848; train_gene_expr_recon_loss: 93182.5818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124876.8924; train_optim_loss: 124876.8924; val_kl_reg_loss: 3657.2577; val_edge_recon_loss: 27623.0334; val_gene_expr_recon_loss: 95078.6187; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126358.9104; val_optim_loss: 126358.9104
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9937; val_auprc_score: 0.9927; val_best_acc_score: 0.9676; val_best_f1_score: 0.9682; train_kl_reg_loss: 3714.8470; train_edge_recon_loss: 27927.1550; train_gene_expr_recon_loss: 92796.6726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124438.6745; train_optim_loss: 124438.6745; val_kl_reg_loss: 3649.9420; val_edge_recon_loss: 27608.3597; val_gene_expr_recon_loss: 95042.4529; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126300.7544; val_optim_loss: 126300.7544
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9942; val_auprc_score: 0.9929; val_best_acc_score: 0.9691; val_best_f1_score: 0.9695; train_kl_reg_loss: 3728.3412; train_edge_recon_loss: 27885.2013; train_gene_expr_recon_loss: 92385.1594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123998.7020; train_optim_loss: 123998.7020; val_kl_reg_loss: 3672.6479; val_edge_recon_loss: 27605.6111; val_gene_expr_recon_loss: 94901.3862; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126179.6452; val_optim_loss: 126179.6452
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9942; val_auprc_score: 0.9931; val_best_acc_score: 0.9695; val_best_f1_score: 0.9700; train_kl_reg_loss: 3744.4967; train_edge_recon_loss: 27837.9504; train_gene_expr_recon_loss: 92148.3188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123730.7659; train_optim_loss: 123730.7659; val_kl_reg_loss: 3682.7085; val_edge_recon_loss: 27552.3177; val_gene_expr_recon_loss: 94947.2679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126182.2938; val_optim_loss: 126182.2938
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9944; val_auprc_score: 0.9935; val_best_acc_score: 0.9693; val_best_f1_score: 0.9697; train_kl_reg_loss: 3755.4603; train_edge_recon_loss: 27809.4429; train_gene_expr_recon_loss: 91767.5612; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123332.4641; train_optim_loss: 123332.4641; val_kl_reg_loss: 3704.6622; val_edge_recon_loss: 27521.8879; val_gene_expr_recon_loss: 94877.6101; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126104.1604; val_optim_loss: 126104.1604
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9949; val_auprc_score: 0.9940; val_best_acc_score: 0.9695; val_best_f1_score: 0.9698; train_kl_reg_loss: 3769.9074; train_edge_recon_loss: 27773.5965; train_gene_expr_recon_loss: 91644.1650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123187.6687; train_optim_loss: 123187.6687; val_kl_reg_loss: 3687.2063; val_edge_recon_loss: 27554.9504; val_gene_expr_recon_loss: 94741.2851; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125983.4413; val_optim_loss: 125983.4413
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9945; val_auprc_score: 0.9935; val_best_acc_score: 0.9696; val_best_f1_score: 0.9701; train_kl_reg_loss: 3783.8461; train_edge_recon_loss: 27744.7814; train_gene_expr_recon_loss: 91365.5327; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 122894.1604; train_optim_loss: 122894.1604; val_kl_reg_loss: 3743.1770; val_edge_recon_loss: 27477.4846; val_gene_expr_recon_loss: 94915.9005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126136.5631; val_optim_loss: 126136.5631
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9944; val_auprc_score: 0.9931; val_best_acc_score: 0.9681; val_best_f1_score: 0.9686; train_kl_reg_loss: 3800.4267; train_edge_recon_loss: 27713.7868; train_gene_expr_recon_loss: 91135.4788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 122649.6924; train_optim_loss: 122649.6924; val_kl_reg_loss: 3737.3707; val_edge_recon_loss: 27512.1353; val_gene_expr_recon_loss: 94898.9996; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126148.5061; val_optim_loss: 126148.5061
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9946; val_auprc_score: 0.9936; val_best_acc_score: 0.9704; val_best_f1_score: 0.9708; train_kl_reg_loss: 3809.8021; train_edge_recon_loss: 27695.0092; train_gene_expr_recon_loss: 90938.5859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 122443.3974; train_optim_loss: 122443.3974; val_kl_reg_loss: 3751.1878; val_edge_recon_loss: 27464.8906; val_gene_expr_recon_loss: 94709.6744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125925.7536; val_optim_loss: 125925.7536
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9949; val_auprc_score: 0.9942; val_best_acc_score: 0.9696; val_best_f1_score: 0.9701; train_kl_reg_loss: 3820.3173; train_edge_recon_loss: 27674.4364; train_gene_expr_recon_loss: 90786.5493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 122281.3029; train_optim_loss: 122281.3029; val_kl_reg_loss: 3750.7804; val_edge_recon_loss: 27489.1104; val_gene_expr_recon_loss: 94928.6351; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126168.5252; val_optim_loss: 126168.5252
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9944; val_auprc_score: 0.9934; val_best_acc_score: 0.9682; val_best_f1_score: 0.9687; train_kl_reg_loss: 3833.3507; train_edge_recon_loss: 27664.7342; train_gene_expr_recon_loss: 90625.0100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 122123.0948; train_optim_loss: 122123.0948; val_kl_reg_loss: 3757.8748; val_edge_recon_loss: 27468.9072; val_gene_expr_recon_loss: 94830.1540; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126056.9362; val_optim_loss: 126056.9362
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9947; val_auprc_score: 0.9936; val_best_acc_score: 0.9701; val_best_f1_score: 0.9706; train_kl_reg_loss: 3837.7793; train_edge_recon_loss: 27657.7656; train_gene_expr_recon_loss: 90446.2767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121941.8215; train_optim_loss: 121941.8215; val_kl_reg_loss: 3784.0022; val_edge_recon_loss: 27437.9241; val_gene_expr_recon_loss: 94648.2153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125870.1412; val_optim_loss: 125870.1412
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9951; val_auprc_score: 0.9944; val_best_acc_score: 0.9694; val_best_f1_score: 0.9699; train_kl_reg_loss: 3853.8238; train_edge_recon_loss: 27625.8952; train_gene_expr_recon_loss: 90308.0127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121787.7316; train_optim_loss: 121787.7316; val_kl_reg_loss: 3765.0827; val_edge_recon_loss: 27406.6737; val_gene_expr_recon_loss: 95231.9912; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126403.7473; val_optim_loss: 126403.7473
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9948; val_auprc_score: 0.9940; val_best_acc_score: 0.9694; val_best_f1_score: 0.9699; train_kl_reg_loss: 3863.9563; train_edge_recon_loss: 27609.9032; train_gene_expr_recon_loss: 90125.2469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121599.1065; train_optim_loss: 121599.1065; val_kl_reg_loss: 3838.3088; val_edge_recon_loss: 27460.9714; val_gene_expr_recon_loss: 94878.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126177.4600; val_optim_loss: 126177.4600
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9950; val_auprc_score: 0.9943; val_best_acc_score: 0.9707; val_best_f1_score: 0.9710; train_kl_reg_loss: 3869.7583; train_edge_recon_loss: 27613.0596; train_gene_expr_recon_loss: 89995.8267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121478.6446; train_optim_loss: 121478.6446; val_kl_reg_loss: 3816.2210; val_edge_recon_loss: 27481.5932; val_gene_expr_recon_loss: 94930.6332; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126228.4476; val_optim_loss: 126228.4476
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9947; val_auprc_score: 0.9936; val_best_acc_score: 0.9693; val_best_f1_score: 0.9698; train_kl_reg_loss: 3879.2408; train_edge_recon_loss: 27596.5574; train_gene_expr_recon_loss: 89930.7792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121406.5772; train_optim_loss: 121406.5772; val_kl_reg_loss: 3826.4734; val_edge_recon_loss: 27423.0664; val_gene_expr_recon_loss: 94883.3914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126132.9304; val_optim_loss: 126132.9304

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9948; val_auprc_score: 0.9937; val_best_acc_score: 0.9702; val_best_f1_score: 0.9706; train_kl_reg_loss: 3865.3185; train_edge_recon_loss: 27515.8823; train_gene_expr_recon_loss: 89104.7481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120485.9490; train_optim_loss: 120485.9490; val_kl_reg_loss: 3808.3759; val_edge_recon_loss: 27386.2253; val_gene_expr_recon_loss: 94822.2165; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126016.8176; val_optim_loss: 126016.8176
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9951; val_auprc_score: 0.9943; val_best_acc_score: 0.9707; val_best_f1_score: 0.9711; train_kl_reg_loss: 3857.9413; train_edge_recon_loss: 27532.0685; train_gene_expr_recon_loss: 88981.8389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120371.8488; train_optim_loss: 120371.8488; val_kl_reg_loss: 3805.9646; val_edge_recon_loss: 27376.3887; val_gene_expr_recon_loss: 94890.0595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126072.4133; val_optim_loss: 126072.4133
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9950; val_auprc_score: 0.9940; val_best_acc_score: 0.9704; val_best_f1_score: 0.9708; train_kl_reg_loss: 3855.5133; train_edge_recon_loss: 27526.6359; train_gene_expr_recon_loss: 88946.3900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120328.5393; train_optim_loss: 120328.5393; val_kl_reg_loss: 3806.8939; val_edge_recon_loss: 27374.8466; val_gene_expr_recon_loss: 94798.7942; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125980.5353; val_optim_loss: 125980.5353
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9952; val_auprc_score: 0.9945; val_best_acc_score: 0.9703; val_best_f1_score: 0.9707; train_kl_reg_loss: 3855.9755; train_edge_recon_loss: 27529.4125; train_gene_expr_recon_loss: 89027.6306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120413.0187; train_optim_loss: 120413.0187; val_kl_reg_loss: 3801.2702; val_edge_recon_loss: 27384.0372; val_gene_expr_recon_loss: 94820.1343; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126005.4423; val_optim_loss: 126005.4423

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 80 min 54 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
Val AUROC score: 0.9950
Val AUPRC score: 0.9939
Val best accuracy score: 0.9705
Val best F1 score: 0.9708
Val gene expr MSE score: 0.6411

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
