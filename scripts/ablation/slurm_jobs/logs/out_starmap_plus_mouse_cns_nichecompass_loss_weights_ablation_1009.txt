None
Run timestamp: 16072023_175043_1009.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_1009']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1818, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1818, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9789; val_auprc_score: 0.9671; val_best_acc_score: 0.9477; val_best_f1_score: 0.9491; train_kl_reg_loss: 22547.0102; train_edge_recon_loss: 26700657.2337; train_gene_expr_recon_loss: 2157830.2334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28881034.4511; train_optim_loss: 28881034.4511; val_kl_reg_loss: 18787.6740; val_edge_recon_loss: 26001779.8537; val_gene_expr_recon_loss: 2060578.9726; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28081146.5366; val_optim_loss: 28081146.5366
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9829; val_auprc_score: 0.9741; val_best_acc_score: 0.9559; val_best_f1_score: 0.9569; train_kl_reg_loss: 17865.7093; train_edge_recon_loss: 25822272.7011; train_gene_expr_recon_loss: 2011635.0353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27851773.4511; train_optim_loss: 27851773.4511; val_kl_reg_loss: 17449.7094; val_edge_recon_loss: 25819068.6829; val_gene_expr_recon_loss: 2012107.5488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27848626.0488; val_optim_loss: 27848626.0488
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9838; val_auprc_score: 0.9753; val_best_acc_score: 0.9601; val_best_f1_score: 0.9611; train_kl_reg_loss: 17180.7194; train_edge_recon_loss: 25692276.7011; train_gene_expr_recon_loss: 1962819.5088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27672276.9076; train_optim_loss: 27672276.9076; val_kl_reg_loss: 16967.7666; val_edge_recon_loss: 25764006.7317; val_gene_expr_recon_loss: 1968176.5640; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27749151.1220; val_optim_loss: 27749151.1220
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9865; val_auprc_score: 0.9802; val_best_acc_score: 0.9635; val_best_f1_score: 0.9644; train_kl_reg_loss: 16984.8245; train_edge_recon_loss: 25648716.4728; train_gene_expr_recon_loss: 1931498.9905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27597200.2391; train_optim_loss: 27597200.2391; val_kl_reg_loss: 16297.1352; val_edge_recon_loss: 25712765.1220; val_gene_expr_recon_loss: 1934045.0549; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27663107.3659; val_optim_loss: 27663107.3659
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9887; val_auprc_score: 0.9836; val_best_acc_score: 0.9666; val_best_f1_score: 0.9673; train_kl_reg_loss: 16983.6062; train_edge_recon_loss: 25598087.8587; train_gene_expr_recon_loss: 1909133.8186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27524205.3152; train_optim_loss: 27524205.3152; val_kl_reg_loss: 16978.9462; val_edge_recon_loss: 25625943.3171; val_gene_expr_recon_loss: 1918006.2927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27560928.7317; val_optim_loss: 27560928.7317
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9892; val_auprc_score: 0.9843; val_best_acc_score: 0.9683; val_best_f1_score: 0.9688; train_kl_reg_loss: 17014.9868; train_edge_recon_loss: 25571139.5707; train_gene_expr_recon_loss: 1892631.6576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27480786.2011; train_optim_loss: 27480786.2011; val_kl_reg_loss: 16938.3482; val_edge_recon_loss: 25625617.1220; val_gene_expr_recon_loss: 1904126.7805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27546682.0976; val_optim_loss: 27546682.0976
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9895; val_auprc_score: 0.9845; val_best_acc_score: 0.9704; val_best_f1_score: 0.9709; train_kl_reg_loss: 16997.7352; train_edge_recon_loss: 25542680.7554; train_gene_expr_recon_loss: 1878846.0031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27438524.5163; train_optim_loss: 27438524.5163; val_kl_reg_loss: 16723.2777; val_edge_recon_loss: 25587972.0976; val_gene_expr_recon_loss: 1894144.5091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27498840.0000; val_optim_loss: 27498840.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9901; val_auprc_score: 0.9853; val_best_acc_score: 0.9705; val_best_f1_score: 0.9710; train_kl_reg_loss: 16933.1765; train_edge_recon_loss: 25532311.3967; train_gene_expr_recon_loss: 1868862.2065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27418106.7663; train_optim_loss: 27418106.7663; val_kl_reg_loss: 16688.5267; val_edge_recon_loss: 25603876.3415; val_gene_expr_recon_loss: 1885856.8476; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27506421.6585; val_optim_loss: 27506421.6585
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9915; val_auprc_score: 0.9880; val_best_acc_score: 0.9736; val_best_f1_score: 0.9740; train_kl_reg_loss: 16901.3934; train_edge_recon_loss: 25517424.4239; train_gene_expr_recon_loss: 1861667.9440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27395993.8207; train_optim_loss: 27395993.8207; val_kl_reg_loss: 16648.7397; val_edge_recon_loss: 25573745.9512; val_gene_expr_recon_loss: 1874275.3384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27464669.8537; val_optim_loss: 27464669.8537
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9913; val_auprc_score: 0.9870; val_best_acc_score: 0.9733; val_best_f1_score: 0.9737; train_kl_reg_loss: 16950.9797; train_edge_recon_loss: 25513110.6359; train_gene_expr_recon_loss: 1853830.8332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27383892.4348; train_optim_loss: 27383892.4348; val_kl_reg_loss: 16537.3140; val_edge_recon_loss: 25571679.2195; val_gene_expr_recon_loss: 1872450.6098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27460667.1707; val_optim_loss: 27460667.1707
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9923; val_auprc_score: 0.9886; val_best_acc_score: 0.9722; val_best_f1_score: 0.9726; train_kl_reg_loss: 16868.7204; train_edge_recon_loss: 25516362.6957; train_gene_expr_recon_loss: 1849133.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27382365.4402; train_optim_loss: 27382365.4402; val_kl_reg_loss: 17055.9483; val_edge_recon_loss: 25587268.8780; val_gene_expr_recon_loss: 1869284.3963; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27473609.2195; val_optim_loss: 27473609.2195
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9919; val_auprc_score: 0.9883; val_best_acc_score: 0.9728; val_best_f1_score: 0.9733; train_kl_reg_loss: 16865.7866; train_edge_recon_loss: 25499015.3696; train_gene_expr_recon_loss: 1843854.7232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27359735.9348; train_optim_loss: 27359735.9348; val_kl_reg_loss: 16606.8276; val_edge_recon_loss: 25577041.0732; val_gene_expr_recon_loss: 1863968.6128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27457616.4390; val_optim_loss: 27457616.4390
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9926; val_auprc_score: 0.9893; val_best_acc_score: 0.9757; val_best_f1_score: 0.9760; train_kl_reg_loss: 16924.0537; train_edge_recon_loss: 25482460.5924; train_gene_expr_recon_loss: 1840339.5774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27339724.2120; train_optim_loss: 27339724.2120; val_kl_reg_loss: 16489.7663; val_edge_recon_loss: 25545599.1220; val_gene_expr_recon_loss: 1859885.3354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27421974.3415; val_optim_loss: 27421974.3415
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9930; val_auprc_score: 0.9897; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 16905.0196; train_edge_recon_loss: 25482746.8913; train_gene_expr_recon_loss: 1838527.8040; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27338179.7391; train_optim_loss: 27338179.7391; val_kl_reg_loss: 16874.6303; val_edge_recon_loss: 25546612.9756; val_gene_expr_recon_loss: 1860158.4055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27423646.0976; val_optim_loss: 27423646.0976
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9934; val_auprc_score: 0.9901; val_best_acc_score: 0.9771; val_best_f1_score: 0.9774; train_kl_reg_loss: 16940.5576; train_edge_recon_loss: 25469462.5707; train_gene_expr_recon_loss: 1835931.8451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27322335.0054; train_optim_loss: 27322335.0054; val_kl_reg_loss: 16820.2071; val_edge_recon_loss: 25528317.0244; val_gene_expr_recon_loss: 1857063.1585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27402200.3902; val_optim_loss: 27402200.3902
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9931; val_auprc_score: 0.9900; val_best_acc_score: 0.9775; val_best_f1_score: 0.9778; train_kl_reg_loss: 16954.3653; train_edge_recon_loss: 25468260.1957; train_gene_expr_recon_loss: 1832453.5897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27317668.1250; train_optim_loss: 27317668.1250; val_kl_reg_loss: 16939.4780; val_edge_recon_loss: 25544564.4878; val_gene_expr_recon_loss: 1853170.3018; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27414674.0976; val_optim_loss: 27414674.0976
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9936; val_auprc_score: 0.9906; val_best_acc_score: 0.9786; val_best_f1_score: 0.9789; train_kl_reg_loss: 16977.9739; train_edge_recon_loss: 25458443.3207; train_gene_expr_recon_loss: 1830669.9395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27306091.2120; train_optim_loss: 27306091.2120; val_kl_reg_loss: 16789.7925; val_edge_recon_loss: 25507953.7073; val_gene_expr_recon_loss: 1854443.5701; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27379187.0244; val_optim_loss: 27379187.0244
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9939; val_auprc_score: 0.9912; val_best_acc_score: 0.9788; val_best_f1_score: 0.9791; train_kl_reg_loss: 16987.4619; train_edge_recon_loss: 25441585.7500; train_gene_expr_recon_loss: 1828061.8043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27286635.0380; train_optim_loss: 27286635.0380; val_kl_reg_loss: 16848.6129; val_edge_recon_loss: 25474921.0244; val_gene_expr_recon_loss: 1847102.8262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27338872.5854; val_optim_loss: 27338872.5854
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9943; val_auprc_score: 0.9914; val_best_acc_score: 0.9797; val_best_f1_score: 0.9800; train_kl_reg_loss: 16980.9525; train_edge_recon_loss: 25446833.4293; train_gene_expr_recon_loss: 1826257.1135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27290071.5380; train_optim_loss: 27290071.5380; val_kl_reg_loss: 16866.8831; val_edge_recon_loss: 25499526.2927; val_gene_expr_recon_loss: 1852134.1280; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27368527.2683; val_optim_loss: 27368527.2683
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9942; val_auprc_score: 0.9911; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 17022.9036; train_edge_recon_loss: 25442388.0924; train_gene_expr_recon_loss: 1823120.4728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27282531.4130; train_optim_loss: 27282531.4130; val_kl_reg_loss: 17060.5136; val_edge_recon_loss: 25498591.2683; val_gene_expr_recon_loss: 1844920.6067; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27360572.4390; val_optim_loss: 27360572.4390
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9947; val_auprc_score: 0.9921; val_best_acc_score: 0.9822; val_best_f1_score: 0.9825; train_kl_reg_loss: 17021.1206; train_edge_recon_loss: 25440203.2120; train_gene_expr_recon_loss: 1823745.7201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27280970.0435; train_optim_loss: 27280970.0435; val_kl_reg_loss: 16971.9784; val_edge_recon_loss: 25465968.7317; val_gene_expr_recon_loss: 1840997.3598; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27323938.0976; val_optim_loss: 27323938.0976
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9943; val_auprc_score: 0.9917; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 16980.5353; train_edge_recon_loss: 25437705.0870; train_gene_expr_recon_loss: 1821667.9372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27276353.5272; train_optim_loss: 27276353.5272; val_kl_reg_loss: 16979.4184; val_edge_recon_loss: 25499209.4634; val_gene_expr_recon_loss: 1843861.5488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27360050.5366; val_optim_loss: 27360050.5366
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9952; val_auprc_score: 0.9932; val_best_acc_score: 0.9816; val_best_f1_score: 0.9819; train_kl_reg_loss: 17035.8666; train_edge_recon_loss: 25427698.5054; train_gene_expr_recon_loss: 1819467.5044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27264201.8804; train_optim_loss: 27264201.8804; val_kl_reg_loss: 16939.9698; val_edge_recon_loss: 25460172.8293; val_gene_expr_recon_loss: 1841273.8476; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27318386.5366; val_optim_loss: 27318386.5366
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9947; val_auprc_score: 0.9921; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 17065.7296; train_edge_recon_loss: 25424202.1033; train_gene_expr_recon_loss: 1818379.4219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27259647.2065; train_optim_loss: 27259647.2065; val_kl_reg_loss: 17096.8303; val_edge_recon_loss: 25492439.2195; val_gene_expr_recon_loss: 1842090.5305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27351626.5366; val_optim_loss: 27351626.5366
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9945; val_auprc_score: 0.9916; val_best_acc_score: 0.9819; val_best_f1_score: 0.9821; train_kl_reg_loss: 17072.7949; train_edge_recon_loss: 25415229.2772; train_gene_expr_recon_loss: 1817171.2629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27249473.3043; train_optim_loss: 27249473.3043; val_kl_reg_loss: 17003.0464; val_edge_recon_loss: 25486206.4878; val_gene_expr_recon_loss: 1840122.5305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27343332.4878; val_optim_loss: 27343332.4878
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9951; val_auprc_score: 0.9922; val_best_acc_score: 0.9830; val_best_f1_score: 0.9832; train_kl_reg_loss: 17096.5605; train_edge_recon_loss: 25420680.1033; train_gene_expr_recon_loss: 1818030.0374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27255806.7011; train_optim_loss: 27255806.7011; val_kl_reg_loss: 16898.6849; val_edge_recon_loss: 25451965.5610; val_gene_expr_recon_loss: 1841233.8994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27310098.0488; val_optim_loss: 27310098.0488
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9946; val_auprc_score: 0.9920; val_best_acc_score: 0.9825; val_best_f1_score: 0.9827; train_kl_reg_loss: 17106.1592; train_edge_recon_loss: 25414904.0000; train_gene_expr_recon_loss: 1813637.0768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27245647.2772; train_optim_loss: 27245647.2772; val_kl_reg_loss: 17021.5009; val_edge_recon_loss: 25442839.4634; val_gene_expr_recon_loss: 1842384.0732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27302245.1220; val_optim_loss: 27302245.1220
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9951; val_auprc_score: 0.9928; val_best_acc_score: 0.9826; val_best_f1_score: 0.9828; train_kl_reg_loss: 17093.9663; train_edge_recon_loss: 25412332.8587; train_gene_expr_recon_loss: 1814740.3842; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27244167.2174; train_optim_loss: 27244167.2174; val_kl_reg_loss: 17216.0181; val_edge_recon_loss: 25474850.1951; val_gene_expr_recon_loss: 1838295.7226; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27330361.8049; val_optim_loss: 27330361.8049
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9951; val_auprc_score: 0.9926; val_best_acc_score: 0.9824; val_best_f1_score: 0.9826; train_kl_reg_loss: 17120.4045; train_edge_recon_loss: 25408656.7011; train_gene_expr_recon_loss: 1812524.3495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27238301.4457; train_optim_loss: 27238301.4457; val_kl_reg_loss: 16709.2956; val_edge_recon_loss: 25458352.0000; val_gene_expr_recon_loss: 1838881.2561; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27313942.6341; val_optim_loss: 27313942.6341
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9951; val_auprc_score: 0.9925; val_best_acc_score: 0.9835; val_best_f1_score: 0.9837; train_kl_reg_loss: 17108.5763; train_edge_recon_loss: 25402635.6848; train_gene_expr_recon_loss: 1810387.7140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27230131.9457; train_optim_loss: 27230131.9457; val_kl_reg_loss: 16932.6575; val_edge_recon_loss: 25451078.4878; val_gene_expr_recon_loss: 1838976.5030; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27306987.5610; val_optim_loss: 27306987.5610
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9955; val_auprc_score: 0.9930; val_best_acc_score: 0.9836; val_best_f1_score: 0.9838; train_kl_reg_loss: 17135.1958; train_edge_recon_loss: 25394145.6957; train_gene_expr_recon_loss: 1810932.5754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27222213.5217; train_optim_loss: 27222213.5217; val_kl_reg_loss: 16704.9059; val_edge_recon_loss: 25465237.7073; val_gene_expr_recon_loss: 1837560.5823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27319503.1707; val_optim_loss: 27319503.1707

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9957; val_auprc_score: 0.9934; val_best_acc_score: 0.9848; val_best_f1_score: 0.9850; train_kl_reg_loss: 17412.6461; train_edge_recon_loss: 25391576.0924; train_gene_expr_recon_loss: 1791811.2819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27200799.8967; train_optim_loss: 27200799.8967; val_kl_reg_loss: 17234.4784; val_edge_recon_loss: 25425788.0976; val_gene_expr_recon_loss: 1818355.1982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27261377.7073; val_optim_loss: 27261377.7073
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9957; val_auprc_score: 0.9938; val_best_acc_score: 0.9838; val_best_f1_score: 0.9840; train_kl_reg_loss: 17405.5943; train_edge_recon_loss: 25379450.7772; train_gene_expr_recon_loss: 1791089.1950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27187945.6359; train_optim_loss: 27187945.6359; val_kl_reg_loss: 17160.4989; val_edge_recon_loss: 25437049.5610; val_gene_expr_recon_loss: 1816108.8598; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27270318.9756; val_optim_loss: 27270318.9756
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9958; val_auprc_score: 0.9940; val_best_acc_score: 0.9840; val_best_f1_score: 0.9842; train_kl_reg_loss: 17384.6204; train_edge_recon_loss: 25373196.2989; train_gene_expr_recon_loss: 1790064.6977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27180645.5707; train_optim_loss: 27180645.5707; val_kl_reg_loss: 17243.0178; val_edge_recon_loss: 25450893.7073; val_gene_expr_recon_loss: 1817092.3384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27285229.2683; val_optim_loss: 27285229.2683
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9960; val_auprc_score: 0.9941; val_best_acc_score: 0.9844; val_best_f1_score: 0.9846; train_kl_reg_loss: 17371.1790; train_edge_recon_loss: 25381121.2500; train_gene_expr_recon_loss: 1787857.8971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27186350.3804; train_optim_loss: 27186350.3804; val_kl_reg_loss: 17082.9708; val_edge_recon_loss: 25441959.5122; val_gene_expr_recon_loss: 1817709.6616; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27276752.1463; val_optim_loss: 27276752.1463
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9952; val_auprc_score: 0.9926; val_best_acc_score: 0.9832; val_best_f1_score: 0.9834; train_kl_reg_loss: 17309.8104; train_edge_recon_loss: 25374220.8804; train_gene_expr_recon_loss: 1786163.2347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27177693.8913; train_optim_loss: 27177693.8913; val_kl_reg_loss: 17128.9817; val_edge_recon_loss: 25452134.6829; val_gene_expr_recon_loss: 1817910.0732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27287173.7073; val_optim_loss: 27287173.7073

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9954; val_auprc_score: 0.9930; val_best_acc_score: 0.9843; val_best_f1_score: 0.9844; train_kl_reg_loss: 17319.2853; train_edge_recon_loss: 25376139.3696; train_gene_expr_recon_loss: 1784807.6919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27178266.3152; train_optim_loss: 27178266.3152; val_kl_reg_loss: 17097.0607; val_edge_recon_loss: 25430883.6098; val_gene_expr_recon_loss: 1817105.1829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27265086.1463; val_optim_loss: 27265086.1463
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9954; val_auprc_score: 0.9928; val_best_acc_score: 0.9837; val_best_f1_score: 0.9839; train_kl_reg_loss: 17345.4869; train_edge_recon_loss: 25382509.6304; train_gene_expr_recon_loss: 1784220.6613; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27184075.7391; train_optim_loss: 27184075.7391; val_kl_reg_loss: 17127.8158; val_edge_recon_loss: 25451180.0000; val_gene_expr_recon_loss: 1816947.0274; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27285254.9268; val_optim_loss: 27285254.9268
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9961; val_auprc_score: 0.9942; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 17340.0040; train_edge_recon_loss: 25373519.7500; train_gene_expr_recon_loss: 1784598.8648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27175458.6793; train_optim_loss: 27175458.6793; val_kl_reg_loss: 17118.1995; val_edge_recon_loss: 25422946.7805; val_gene_expr_recon_loss: 1817089.1738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27257154.3415; val_optim_loss: 27257154.3415
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9958; val_auprc_score: 0.9938; val_best_acc_score: 0.9839; val_best_f1_score: 0.9841; train_kl_reg_loss: 17343.8149; train_edge_recon_loss: 25376008.9783; train_gene_expr_recon_loss: 1784070.1321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27177422.9293; train_optim_loss: 27177422.9293; val_kl_reg_loss: 17135.4081; val_edge_recon_loss: 25427617.7073; val_gene_expr_recon_loss: 1814942.9329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27259696.1463; val_optim_loss: 27259696.1463
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9960; val_auprc_score: 0.9941; val_best_acc_score: 0.9849; val_best_f1_score: 0.9851; train_kl_reg_loss: 17351.5120; train_edge_recon_loss: 25376332.0978; train_gene_expr_recon_loss: 1783186.4827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27176870.1196; train_optim_loss: 27176870.1196; val_kl_reg_loss: 17118.6746; val_edge_recon_loss: 25397021.9512; val_gene_expr_recon_loss: 1813491.2866; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27227631.8537; val_optim_loss: 27227631.8537
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9960; val_auprc_score: 0.9940; val_best_acc_score: 0.9848; val_best_f1_score: 0.9849; train_kl_reg_loss: 17335.2504; train_edge_recon_loss: 25375801.8043; train_gene_expr_recon_loss: 1784622.2670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27177759.3750; train_optim_loss: 27177759.3750; val_kl_reg_loss: 17119.3216; val_edge_recon_loss: 25390129.9024; val_gene_expr_recon_loss: 1820104.4146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27227353.4146; val_optim_loss: 27227353.4146
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9960; val_auprc_score: 0.9937; val_best_acc_score: 0.9843; val_best_f1_score: 0.9845; train_kl_reg_loss: 17331.2170; train_edge_recon_loss: 25367128.6902; train_gene_expr_recon_loss: 1782786.6827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27167246.6196; train_optim_loss: 27167246.6196; val_kl_reg_loss: 17129.7960; val_edge_recon_loss: 25418389.6098; val_gene_expr_recon_loss: 1814191.0701; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27249710.6341; val_optim_loss: 27249710.6341
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9959; val_auprc_score: 0.9940; val_best_acc_score: 0.9850; val_best_f1_score: 0.9851; train_kl_reg_loss: 17331.8221; train_edge_recon_loss: 25370822.3859; train_gene_expr_recon_loss: 1783120.1861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27171274.3804; train_optim_loss: 27171274.3804; val_kl_reg_loss: 17106.7916; val_edge_recon_loss: 25395800.1951; val_gene_expr_recon_loss: 1818243.2805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27231150.1463; val_optim_loss: 27231150.1463
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9957; val_auprc_score: 0.9936; val_best_acc_score: 0.9852; val_best_f1_score: 0.9853; train_kl_reg_loss: 17330.8770; train_edge_recon_loss: 25380504.0489; train_gene_expr_recon_loss: 1783687.9969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27181522.9565; train_optim_loss: 27181522.9565; val_kl_reg_loss: 17124.3675; val_edge_recon_loss: 25415737.5610; val_gene_expr_recon_loss: 1813805.7378; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27246667.5122; val_optim_loss: 27246667.5122
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9960; val_auprc_score: 0.9937; val_best_acc_score: 0.9847; val_best_f1_score: 0.9849; train_kl_reg_loss: 17323.8819; train_edge_recon_loss: 25365723.0109; train_gene_expr_recon_loss: 1783383.0153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27166429.8913; train_optim_loss: 27166429.8913; val_kl_reg_loss: 17108.1046; val_edge_recon_loss: 25404517.3171; val_gene_expr_recon_loss: 1813500.4268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27235125.9024; val_optim_loss: 27235125.9024

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9961; val_auprc_score: 0.9939; val_best_acc_score: 0.9848; val_best_f1_score: 0.9849; train_kl_reg_loss: 17326.0524; train_edge_recon_loss: 25374220.8152; train_gene_expr_recon_loss: 1785022.8383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27176569.7337; train_optim_loss: 27176569.7337; val_kl_reg_loss: 17109.3575; val_edge_recon_loss: 25426773.3171; val_gene_expr_recon_loss: 1814119.5610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27258002.2927; val_optim_loss: 27258002.2927
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9957; val_auprc_score: 0.9933; val_best_acc_score: 0.9842; val_best_f1_score: 0.9843; train_kl_reg_loss: 17327.0069; train_edge_recon_loss: 25369037.9783; train_gene_expr_recon_loss: 1782483.4358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27168848.4402; train_optim_loss: 27168848.4402; val_kl_reg_loss: 17116.6977; val_edge_recon_loss: 25407089.7073; val_gene_expr_recon_loss: 1817297.6189; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27241504.1463; val_optim_loss: 27241504.1463
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9958; val_auprc_score: 0.9934; val_best_acc_score: 0.9842; val_best_f1_score: 0.9844; train_kl_reg_loss: 17332.0545; train_edge_recon_loss: 25369126.4783; train_gene_expr_recon_loss: 1782789.6576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27169248.2337; train_optim_loss: 27169248.2337; val_kl_reg_loss: 17113.3127; val_edge_recon_loss: 25425938.7317; val_gene_expr_recon_loss: 1814847.6037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27257899.4634; val_optim_loss: 27257899.4634
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9958; val_auprc_score: 0.9935; val_best_acc_score: 0.9847; val_best_f1_score: 0.9849; train_kl_reg_loss: 17333.9322; train_edge_recon_loss: 25376392.4674; train_gene_expr_recon_loss: 1782879.4001; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27176605.8043; train_optim_loss: 27176605.8043; val_kl_reg_loss: 17121.6859; val_edge_recon_loss: 25392151.3659; val_gene_expr_recon_loss: 1819783.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27229056.1951; val_optim_loss: 27229056.1951

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 164 min 27 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
Val AUROC score: 0.9957
Val AUPRC score: 0.9937
Val best accuracy score: 0.9839
Val best F1 score: 0.9841
Val gene expr MSE score: 0.4868

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
