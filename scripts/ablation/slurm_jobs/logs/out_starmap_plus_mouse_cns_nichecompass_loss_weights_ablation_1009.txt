None
Run timestamp: 02072023_165903_1009.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_1009']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9835; val_auprc_score: 0.9787; val_best_acc_score: 0.9472; val_best_f1_score: 0.9481; train_kl_reg_loss: 5257.0045; train_edge_recon_loss: 31246.8975; train_gene_expr_recon_loss: 116994.3800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153498.2823; train_optim_loss: 153498.2823; val_kl_reg_loss: 4647.0114; val_edge_recon_loss: 29922.9319; val_gene_expr_recon_loss: 107268.4057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141838.3498; val_optim_loss: 141838.3498
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9868; val_auprc_score: 0.9828; val_best_acc_score: 0.9557; val_best_f1_score: 0.9565; train_kl_reg_loss: 4395.3874; train_edge_recon_loss: 29774.6803; train_gene_expr_recon_loss: 104878.2342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139048.3018; train_optim_loss: 139048.3018; val_kl_reg_loss: 4019.0645; val_edge_recon_loss: 29175.1089; val_gene_expr_recon_loss: 103606.0215; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136800.1947; val_optim_loss: 136800.1947
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9890; val_auprc_score: 0.9859; val_best_acc_score: 0.9585; val_best_f1_score: 0.9591; train_kl_reg_loss: 4028.3001; train_edge_recon_loss: 29264.5019; train_gene_expr_recon_loss: 101843.4585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135136.2605; train_optim_loss: 135136.2605; val_kl_reg_loss: 3821.6479; val_edge_recon_loss: 28786.2220; val_gene_expr_recon_loss: 101467.5339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134075.4038; val_optim_loss: 134075.4038
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9909; val_auprc_score: 0.9890; val_best_acc_score: 0.9613; val_best_f1_score: 0.9618; train_kl_reg_loss: 3866.0825; train_edge_recon_loss: 28948.8726; train_gene_expr_recon_loss: 99856.8712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132671.8264; train_optim_loss: 132671.8264; val_kl_reg_loss: 3674.3712; val_edge_recon_loss: 28368.6654; val_gene_expr_recon_loss: 99750.0598; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131793.0964; val_optim_loss: 131793.0964
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9915; val_auprc_score: 0.9897; val_best_acc_score: 0.9630; val_best_f1_score: 0.9637; train_kl_reg_loss: 3774.5597; train_edge_recon_loss: 28711.7592; train_gene_expr_recon_loss: 98275.1260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130761.4451; train_optim_loss: 130761.4451; val_kl_reg_loss: 3760.3889; val_edge_recon_loss: 28289.1858; val_gene_expr_recon_loss: 98663.1340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130712.7094; val_optim_loss: 130712.7094
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9926; val_auprc_score: 0.9913; val_best_acc_score: 0.9635; val_best_f1_score: 0.9641; train_kl_reg_loss: 3728.3666; train_edge_recon_loss: 28537.2482; train_gene_expr_recon_loss: 97088.1606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129353.7755; train_optim_loss: 129353.7755; val_kl_reg_loss: 3696.0375; val_edge_recon_loss: 28120.3119; val_gene_expr_recon_loss: 97668.5739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129484.9232; val_optim_loss: 129484.9232
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9928; val_auprc_score: 0.9913; val_best_acc_score: 0.9647; val_best_f1_score: 0.9652; train_kl_reg_loss: 3704.7823; train_edge_recon_loss: 28394.0557; train_gene_expr_recon_loss: 96137.2369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128236.0748; train_optim_loss: 128236.0748; val_kl_reg_loss: 3668.1880; val_edge_recon_loss: 27967.6943; val_gene_expr_recon_loss: 96925.2073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128561.0899; val_optim_loss: 128561.0899
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9932; val_auprc_score: 0.9919; val_best_acc_score: 0.9652; val_best_f1_score: 0.9657; train_kl_reg_loss: 3695.5112; train_edge_recon_loss: 28298.4612; train_gene_expr_recon_loss: 95327.8949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127321.8671; train_optim_loss: 127321.8671; val_kl_reg_loss: 3639.8504; val_edge_recon_loss: 27907.0707; val_gene_expr_recon_loss: 96409.4573; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127956.3784; val_optim_loss: 127956.3784
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9933; val_auprc_score: 0.9919; val_best_acc_score: 0.9657; val_best_f1_score: 0.9663; train_kl_reg_loss: 3693.7475; train_edge_recon_loss: 28194.1862; train_gene_expr_recon_loss: 94615.7168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126503.6505; train_optim_loss: 126503.6505; val_kl_reg_loss: 3638.9413; val_edge_recon_loss: 27838.6719; val_gene_expr_recon_loss: 96133.1986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127610.8114; val_optim_loss: 127610.8114
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9938; val_auprc_score: 0.9925; val_best_acc_score: 0.9660; val_best_f1_score: 0.9665; train_kl_reg_loss: 3695.8561; train_edge_recon_loss: 28126.0965; train_gene_expr_recon_loss: 93950.7843; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125772.7368; train_optim_loss: 125772.7368; val_kl_reg_loss: 3653.3381; val_edge_recon_loss: 27811.2268; val_gene_expr_recon_loss: 95840.1353; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127304.6995; val_optim_loss: 127304.6995
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9935; val_auprc_score: 0.9922; val_best_acc_score: 0.9655; val_best_f1_score: 0.9660; train_kl_reg_loss: 3699.3385; train_edge_recon_loss: 28060.2232; train_gene_expr_recon_loss: 93513.0955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125272.6572; train_optim_loss: 125272.6572; val_kl_reg_loss: 3671.1514; val_edge_recon_loss: 27718.9344; val_gene_expr_recon_loss: 95334.9524; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126725.0377; val_optim_loss: 126725.0377
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9943; val_auprc_score: 0.9933; val_best_acc_score: 0.9676; val_best_f1_score: 0.9680; train_kl_reg_loss: 3715.3568; train_edge_recon_loss: 27996.0338; train_gene_expr_recon_loss: 93119.5110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124830.9015; train_optim_loss: 124830.9015; val_kl_reg_loss: 3664.0127; val_edge_recon_loss: 27635.8044; val_gene_expr_recon_loss: 95455.0743; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126754.8925; val_optim_loss: 126754.8925
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9944; val_auprc_score: 0.9932; val_best_acc_score: 0.9682; val_best_f1_score: 0.9685; train_kl_reg_loss: 3724.7160; train_edge_recon_loss: 27942.9890; train_gene_expr_recon_loss: 92792.5529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124460.2579; train_optim_loss: 124460.2579; val_kl_reg_loss: 3685.8647; val_edge_recon_loss: 27659.4891; val_gene_expr_recon_loss: 95212.4888; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126557.8428; val_optim_loss: 126557.8428
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9944; val_auprc_score: 0.9936; val_best_acc_score: 0.9687; val_best_f1_score: 0.9691; train_kl_reg_loss: 3739.3073; train_edge_recon_loss: 27885.9425; train_gene_expr_recon_loss: 92341.2092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123966.4592; train_optim_loss: 123966.4592; val_kl_reg_loss: 3695.4032; val_edge_recon_loss: 27542.3803; val_gene_expr_recon_loss: 95032.3104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126270.0936; val_optim_loss: 126270.0936
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9947; val_auprc_score: 0.9940; val_best_acc_score: 0.9689; val_best_f1_score: 0.9693; train_kl_reg_loss: 3751.4627; train_edge_recon_loss: 27849.4420; train_gene_expr_recon_loss: 92022.4735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123623.3782; train_optim_loss: 123623.3782; val_kl_reg_loss: 3695.7096; val_edge_recon_loss: 27572.3679; val_gene_expr_recon_loss: 95029.6658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126297.7433; val_optim_loss: 126297.7433
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9948; val_auprc_score: 0.9940; val_best_acc_score: 0.9689; val_best_f1_score: 0.9693; train_kl_reg_loss: 3764.2902; train_edge_recon_loss: 27825.6777; train_gene_expr_recon_loss: 91792.9032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123382.8711; train_optim_loss: 123382.8711; val_kl_reg_loss: 3754.8642; val_edge_recon_loss: 27535.6401; val_gene_expr_recon_loss: 95063.5707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126354.0753; val_optim_loss: 126354.0753
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9945; val_auprc_score: 0.9935; val_best_acc_score: 0.9680; val_best_f1_score: 0.9684; train_kl_reg_loss: 3779.2683; train_edge_recon_loss: 27785.4645; train_gene_expr_recon_loss: 91547.6894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123112.4221; train_optim_loss: 123112.4221; val_kl_reg_loss: 3766.1312; val_edge_recon_loss: 27502.9780; val_gene_expr_recon_loss: 94667.0158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125936.1248; val_optim_loss: 125936.1248
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9946; val_auprc_score: 0.9938; val_best_acc_score: 0.9688; val_best_f1_score: 0.9694; train_kl_reg_loss: 3786.9230; train_edge_recon_loss: 27773.5695; train_gene_expr_recon_loss: 91301.7208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 122862.2134; train_optim_loss: 122862.2134; val_kl_reg_loss: 3763.3971; val_edge_recon_loss: 27530.2631; val_gene_expr_recon_loss: 94784.6111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126078.2713; val_optim_loss: 126078.2713
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9948; val_auprc_score: 0.9937; val_best_acc_score: 0.9687; val_best_f1_score: 0.9692; train_kl_reg_loss: 3804.8506; train_edge_recon_loss: 27741.0227; train_gene_expr_recon_loss: 91051.0803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 122596.9536; train_optim_loss: 122596.9536; val_kl_reg_loss: 3797.4405; val_edge_recon_loss: 27508.3923; val_gene_expr_recon_loss: 94910.0534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126215.8862; val_optim_loss: 126215.8862
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9948; val_auprc_score: 0.9941; val_best_acc_score: 0.9691; val_best_f1_score: 0.9696; train_kl_reg_loss: 3817.7191; train_edge_recon_loss: 27707.3485; train_gene_expr_recon_loss: 90912.9378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 122438.0054; train_optim_loss: 122438.0054; val_kl_reg_loss: 3769.2714; val_edge_recon_loss: 27477.6640; val_gene_expr_recon_loss: 94859.6404; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126106.5755; val_optim_loss: 126106.5755
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9947; val_auprc_score: 0.9939; val_best_acc_score: 0.9692; val_best_f1_score: 0.9696; train_kl_reg_loss: 3826.7350; train_edge_recon_loss: 27695.3739; train_gene_expr_recon_loss: 90683.2642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 122205.3730; train_optim_loss: 122205.3730; val_kl_reg_loss: 3774.3866; val_edge_recon_loss: 27476.6886; val_gene_expr_recon_loss: 94740.0694; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125991.1448; val_optim_loss: 125991.1448

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9949; val_auprc_score: 0.9940; val_best_acc_score: 0.9698; val_best_f1_score: 0.9701; train_kl_reg_loss: 3815.4842; train_edge_recon_loss: 27606.7574; train_gene_expr_recon_loss: 89924.6346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121346.8762; train_optim_loss: 121346.8762; val_kl_reg_loss: 3750.6831; val_edge_recon_loss: 27412.9460; val_gene_expr_recon_loss: 94537.8601; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125701.4886; val_optim_loss: 125701.4886
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9953; val_auprc_score: 0.9945; val_best_acc_score: 0.9701; val_best_f1_score: 0.9706; train_kl_reg_loss: 3811.6045; train_edge_recon_loss: 27611.7882; train_gene_expr_recon_loss: 89809.1953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121232.5883; train_optim_loss: 121232.5883; val_kl_reg_loss: 3760.2039; val_edge_recon_loss: 27392.2536; val_gene_expr_recon_loss: 94671.4882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125823.9451; val_optim_loss: 125823.9451
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9949; val_auprc_score: 0.9941; val_best_acc_score: 0.9692; val_best_f1_score: 0.9696; train_kl_reg_loss: 3809.7002; train_edge_recon_loss: 27613.2499; train_gene_expr_recon_loss: 89800.5658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121223.5157; train_optim_loss: 121223.5157; val_kl_reg_loss: 3733.5546; val_edge_recon_loss: 27450.3256; val_gene_expr_recon_loss: 94540.5025; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125724.3824; val_optim_loss: 125724.3824
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9950; val_auprc_score: 0.9943; val_best_acc_score: 0.9695; val_best_f1_score: 0.9699; train_kl_reg_loss: 3805.9820; train_edge_recon_loss: 27617.4729; train_gene_expr_recon_loss: 89833.0590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121256.5138; train_optim_loss: 121256.5138; val_kl_reg_loss: 3752.4130; val_edge_recon_loss: 27436.3639; val_gene_expr_recon_loss: 94826.3481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126015.1248; val_optim_loss: 126015.1248
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9951; val_auprc_score: 0.9942; val_best_acc_score: 0.9699; val_best_f1_score: 0.9702; train_kl_reg_loss: 3807.9368; train_edge_recon_loss: 27605.1114; train_gene_expr_recon_loss: 89717.7611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121130.8093; train_optim_loss: 121130.8093; val_kl_reg_loss: 3754.3901; val_edge_recon_loss: 27442.8435; val_gene_expr_recon_loss: 94777.0318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125974.2660; val_optim_loss: 125974.2660

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9948; val_auprc_score: 0.9940; val_best_acc_score: 0.9692; val_best_f1_score: 0.9697; train_kl_reg_loss: 3808.2234; train_edge_recon_loss: 27598.2113; train_gene_expr_recon_loss: 89612.1378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121018.5723; train_optim_loss: 121018.5723; val_kl_reg_loss: 3750.0254; val_edge_recon_loss: 27429.1092; val_gene_expr_recon_loss: 94489.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125668.1814; val_optim_loss: 125668.1814
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9948; val_auprc_score: 0.9939; val_best_acc_score: 0.9690; val_best_f1_score: 0.9696; train_kl_reg_loss: 3807.1365; train_edge_recon_loss: 27599.0079; train_gene_expr_recon_loss: 89528.8456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120934.9898; train_optim_loss: 120934.9898; val_kl_reg_loss: 3746.8269; val_edge_recon_loss: 27455.8013; val_gene_expr_recon_loss: 94605.3876; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125808.0166; val_optim_loss: 125808.0166
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9947; val_auprc_score: 0.9939; val_best_acc_score: 0.9695; val_best_f1_score: 0.9700; train_kl_reg_loss: 3804.8734; train_edge_recon_loss: 27593.8395; train_gene_expr_recon_loss: 89662.6284; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121061.3411; train_optim_loss: 121061.3411; val_kl_reg_loss: 3747.8613; val_edge_recon_loss: 27418.3120; val_gene_expr_recon_loss: 94698.1425; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125864.3159; val_optim_loss: 125864.3159
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9951; val_auprc_score: 0.9942; val_best_acc_score: 0.9702; val_best_f1_score: 0.9707; train_kl_reg_loss: 3805.4108; train_edge_recon_loss: 27597.3046; train_gene_expr_recon_loss: 89572.0583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120974.7736; train_optim_loss: 120974.7736; val_kl_reg_loss: 3751.8897; val_edge_recon_loss: 27433.9419; val_gene_expr_recon_loss: 94573.9019; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125759.7330; val_optim_loss: 125759.7330
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9949; val_auprc_score: 0.9938; val_best_acc_score: 0.9694; val_best_f1_score: 0.9699; train_kl_reg_loss: 3805.2442; train_edge_recon_loss: 27593.9470; train_gene_expr_recon_loss: 89593.0564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120992.2476; train_optim_loss: 120992.2476; val_kl_reg_loss: 3751.0533; val_edge_recon_loss: 27431.7827; val_gene_expr_recon_loss: 94718.7732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125901.6099; val_optim_loss: 125901.6099

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9949; val_auprc_score: 0.9940; val_best_acc_score: 0.9695; val_best_f1_score: 0.9700; train_kl_reg_loss: 3807.1873; train_edge_recon_loss: 27597.5277; train_gene_expr_recon_loss: 89601.7998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121006.5148; train_optim_loss: 121006.5148; val_kl_reg_loss: 3749.3479; val_edge_recon_loss: 27416.9570; val_gene_expr_recon_loss: 94655.6462; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125821.9506; val_optim_loss: 125821.9506
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9952; val_auprc_score: 0.9940; val_best_acc_score: 0.9703; val_best_f1_score: 0.9708; train_kl_reg_loss: 3804.8234; train_edge_recon_loss: 27594.8387; train_gene_expr_recon_loss: 89596.3315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120995.9939; train_optim_loss: 120995.9939; val_kl_reg_loss: 3748.3405; val_edge_recon_loss: 27410.6942; val_gene_expr_recon_loss: 94550.1949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125709.2300; val_optim_loss: 125709.2300
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9952; val_auprc_score: 0.9945; val_best_acc_score: 0.9701; val_best_f1_score: 0.9704; train_kl_reg_loss: 3804.8480; train_edge_recon_loss: 27596.5226; train_gene_expr_recon_loss: 89546.4974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120947.8679; train_optim_loss: 120947.8679; val_kl_reg_loss: 3747.4847; val_edge_recon_loss: 27431.4922; val_gene_expr_recon_loss: 94797.2590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125976.2357; val_optim_loss: 125976.2357
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9952; val_auprc_score: 0.9945; val_best_acc_score: 0.9705; val_best_f1_score: 0.9708; train_kl_reg_loss: 3804.6095; train_edge_recon_loss: 27599.9446; train_gene_expr_recon_loss: 89637.6461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121042.2002; train_optim_loss: 121042.2002; val_kl_reg_loss: 3747.9641; val_edge_recon_loss: 27425.0864; val_gene_expr_recon_loss: 94397.9076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125570.9590; val_optim_loss: 125570.9590
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9949; val_auprc_score: 0.9937; val_best_acc_score: 0.9696; val_best_f1_score: 0.9701; train_kl_reg_loss: 3804.9397; train_edge_recon_loss: 27599.1460; train_gene_expr_recon_loss: 89634.8833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121038.9693; train_optim_loss: 121038.9693; val_kl_reg_loss: 3747.5993; val_edge_recon_loss: 27414.0925; val_gene_expr_recon_loss: 94521.9901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125683.6820; val_optim_loss: 125683.6820
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9954; val_auprc_score: 0.9946; val_best_acc_score: 0.9704; val_best_f1_score: 0.9709; train_kl_reg_loss: 3804.9056; train_edge_recon_loss: 27601.8535; train_gene_expr_recon_loss: 89601.1255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121007.8845; train_optim_loss: 121007.8845; val_kl_reg_loss: 3749.6452; val_edge_recon_loss: 27420.9045; val_gene_expr_recon_loss: 94466.8901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125637.4407; val_optim_loss: 125637.4407
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9951; val_auprc_score: 0.9944; val_best_acc_score: 0.9697; val_best_f1_score: 0.9702; train_kl_reg_loss: 3804.9783; train_edge_recon_loss: 27591.4646; train_gene_expr_recon_loss: 89529.6113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120926.0542; train_optim_loss: 120926.0542; val_kl_reg_loss: 3749.6629; val_edge_recon_loss: 27399.0733; val_gene_expr_recon_loss: 94930.5278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126079.2637; val_optim_loss: 126079.2637
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9951; val_auprc_score: 0.9945; val_best_acc_score: 0.9699; val_best_f1_score: 0.9704; train_kl_reg_loss: 3804.3745; train_edge_recon_loss: 27606.2148; train_gene_expr_recon_loss: 89584.3436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120994.9330; train_optim_loss: 120994.9330; val_kl_reg_loss: 3747.6134; val_edge_recon_loss: 27419.6644; val_gene_expr_recon_loss: 94785.5036; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125952.7811; val_optim_loss: 125952.7811

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9952; val_auprc_score: 0.9946; val_best_acc_score: 0.9705; val_best_f1_score: 0.9710; train_kl_reg_loss: 3803.4157; train_edge_recon_loss: 27598.8412; train_gene_expr_recon_loss: 89618.3529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121020.6094; train_optim_loss: 121020.6094; val_kl_reg_loss: 3747.5021; val_edge_recon_loss: 27414.2537; val_gene_expr_recon_loss: 94594.0615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125755.8169; val_optim_loss: 125755.8169
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9952; val_auprc_score: 0.9944; val_best_acc_score: 0.9702; val_best_f1_score: 0.9706; train_kl_reg_loss: 3803.9574; train_edge_recon_loss: 27597.9258; train_gene_expr_recon_loss: 89516.8773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120918.7608; train_optim_loss: 120918.7608; val_kl_reg_loss: 3747.1139; val_edge_recon_loss: 27412.2380; val_gene_expr_recon_loss: 94663.9455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125823.2973; val_optim_loss: 125823.2973
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9951; val_auprc_score: 0.9944; val_best_acc_score: 0.9697; val_best_f1_score: 0.9702; train_kl_reg_loss: 3803.8152; train_edge_recon_loss: 27603.0656; train_gene_expr_recon_loss: 89613.3677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121020.2484; train_optim_loss: 121020.2484; val_kl_reg_loss: 3747.2222; val_edge_recon_loss: 27411.2738; val_gene_expr_recon_loss: 94607.8312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125766.3272; val_optim_loss: 125766.3272
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9948; val_auprc_score: 0.9942; val_best_acc_score: 0.9692; val_best_f1_score: 0.9697; train_kl_reg_loss: 3804.3130; train_edge_recon_loss: 27591.1306; train_gene_expr_recon_loss: 89609.1586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121004.6023; train_optim_loss: 121004.6023; val_kl_reg_loss: 3748.6164; val_edge_recon_loss: 27439.0947; val_gene_expr_recon_loss: 94698.2599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125885.9705; val_optim_loss: 125885.9705

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 119 min 0 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9950
Val AUPRC score: 0.9943
Val best accuracy score: 0.9689
Val best F1 score: 0.9694
Val gene expr MSE score: 0.6259

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
