None
Run timestamp: 28062023_141826_42.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis', '--reference_batches', 'batch1', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--timestamp_suffix', '_42']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1818, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1818, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 16025
Number of validation nodes: 1781
Number of training edges: 72476
Number of validation edges: 8052
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
heaps
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9805; val_auprc_score: 0.9789; val_best_acc_score: 0.9326; val_best_f1_score: 0.9341; train_kl_reg_loss: 975.8972; train_edge_recon_loss: 344308.2743; train_gene_expr_recon_loss: 219416.2543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 564700.4236; train_optim_loss: 564700.4236; val_kl_reg_loss: 2721.1549; val_edge_recon_loss: 335659.1406; val_gene_expr_recon_loss: 205639.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 544019.6250; val_optim_loss: 544019.6250
heaps
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9696; val_auprc_score: 0.9667; val_best_acc_score: 0.9123; val_best_f1_score: 0.9145; train_kl_reg_loss: 10329.6053; train_edge_recon_loss: 288629.3264; train_gene_expr_recon_loss: 203936.2283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 502895.1597; train_optim_loss: 502895.1597; val_kl_reg_loss: 14996.6567; val_edge_recon_loss: 269947.4844; val_gene_expr_recon_loss: 201546.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 486490.9688; val_optim_loss: 486490.9688
heaps
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9805; val_auprc_score: 0.9775; val_best_acc_score: 0.9306; val_best_f1_score: 0.9316; train_kl_reg_loss: 11240.6019; train_edge_recon_loss: 268985.6788; train_gene_expr_recon_loss: 197032.8368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 477259.1146; train_optim_loss: 477259.1146; val_kl_reg_loss: 9304.5586; val_edge_recon_loss: 265315.7969; val_gene_expr_recon_loss: 196176.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 470797.2188; val_optim_loss: 470797.2188
heaps
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9842; val_auprc_score: 0.9828; val_best_acc_score: 0.9395; val_best_f1_score: 0.9402; train_kl_reg_loss: 10083.9652; train_edge_recon_loss: 266263.2760; train_gene_expr_recon_loss: 194531.0851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 470878.3212; train_optim_loss: 470878.3212; val_kl_reg_loss: 9415.4570; val_edge_recon_loss: 264521.9531; val_gene_expr_recon_loss: 194659.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468596.5000; val_optim_loss: 468596.5000
heaps
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9864; val_auprc_score: 0.9851; val_best_acc_score: 0.9455; val_best_f1_score: 0.9460; train_kl_reg_loss: 9223.5568; train_edge_recon_loss: 265039.3316; train_gene_expr_recon_loss: 192323.7543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 466586.6441; train_optim_loss: 466586.6441; val_kl_reg_loss: 9299.5039; val_edge_recon_loss: 262146.6484; val_gene_expr_recon_loss: 193144.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 464590.2500; val_optim_loss: 464590.2500
heaps
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9882; val_auprc_score: 0.9865; val_best_acc_score: 0.9501; val_best_f1_score: 0.9509; train_kl_reg_loss: 9119.5918; train_edge_recon_loss: 263199.6936; train_gene_expr_recon_loss: 191061.3655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463380.6493; train_optim_loss: 463380.6493; val_kl_reg_loss: 8816.7231; val_edge_recon_loss: 260810.0938; val_gene_expr_recon_loss: 192059.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461686.5000; val_optim_loss: 461686.5000
heaps
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9887; val_auprc_score: 0.9856; val_best_acc_score: 0.9507; val_best_f1_score: 0.9518; train_kl_reg_loss: 8240.1570; train_edge_recon_loss: 263645.5009; train_gene_expr_recon_loss: 193044.7873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464930.4462; train_optim_loss: 464930.4462; val_kl_reg_loss: 7816.8589; val_edge_recon_loss: 260908.2188; val_gene_expr_recon_loss: 193724.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462449.7031; val_optim_loss: 462449.7031
heaps
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9901; val_auprc_score: 0.9884; val_best_acc_score: 0.9553; val_best_f1_score: 0.9560; train_kl_reg_loss: 8809.6176; train_edge_recon_loss: 261922.1293; train_gene_expr_recon_loss: 190247.2075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460978.9566; train_optim_loss: 460978.9566; val_kl_reg_loss: 8505.4424; val_edge_recon_loss: 260987.2656; val_gene_expr_recon_loss: 190807.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460300.1562; val_optim_loss: 460300.1562
heaps
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9907; val_auprc_score: 0.9886; val_best_acc_score: 0.9575; val_best_f1_score: 0.9584; train_kl_reg_loss: 8538.1869; train_edge_recon_loss: 261805.0399; train_gene_expr_recon_loss: 189272.2830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459615.5087; train_optim_loss: 459615.5087; val_kl_reg_loss: 8470.3745; val_edge_recon_loss: 259799.9531; val_gene_expr_recon_loss: 189850.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458120.5781; val_optim_loss: 458120.5781
heaps
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9911; val_auprc_score: 0.9885; val_best_acc_score: 0.9598; val_best_f1_score: 0.9604; train_kl_reg_loss: 8368.3450; train_edge_recon_loss: 262020.7734; train_gene_expr_recon_loss: 188303.1293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458692.2448; train_optim_loss: 458692.2448; val_kl_reg_loss: 8187.8289; val_edge_recon_loss: 259765.4297; val_gene_expr_recon_loss: 189362.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457315.3438; val_optim_loss: 457315.3438
heaps
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9901; val_auprc_score: 0.9868; val_best_acc_score: 0.9564; val_best_f1_score: 0.9570; train_kl_reg_loss: 8228.2144; train_edge_recon_loss: 261027.0556; train_gene_expr_recon_loss: 187850.3793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 457105.6458; train_optim_loss: 457105.6458; val_kl_reg_loss: 8031.3228; val_edge_recon_loss: 261881.1250; val_gene_expr_recon_loss: 188860.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458773.3594; val_optim_loss: 458773.3594
heaps
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9912; val_auprc_score: 0.9890; val_best_acc_score: 0.9596; val_best_f1_score: 0.9601; train_kl_reg_loss: 8064.7903; train_edge_recon_loss: 260812.0078; train_gene_expr_recon_loss: 187358.3212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 456235.1233; train_optim_loss: 456235.1233; val_kl_reg_loss: 7941.2939; val_edge_recon_loss: 260067.4766; val_gene_expr_recon_loss: 188720.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456729.7500; val_optim_loss: 456729.7500
heaps
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9921; val_auprc_score: 0.9910; val_best_acc_score: 0.9592; val_best_f1_score: 0.9597; train_kl_reg_loss: 7953.5809; train_edge_recon_loss: 260524.9123; train_gene_expr_recon_loss: 186833.7734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455312.2656; train_optim_loss: 455312.2656; val_kl_reg_loss: 7850.0488; val_edge_recon_loss: 259723.2969; val_gene_expr_recon_loss: 188105.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455678.5156; val_optim_loss: 455678.5156
heaps
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9924; val_auprc_score: 0.9899; val_best_acc_score: 0.9624; val_best_f1_score: 0.9632; train_kl_reg_loss: 7763.8242; train_edge_recon_loss: 260990.2656; train_gene_expr_recon_loss: 187069.4783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455823.5608; train_optim_loss: 455823.5608; val_kl_reg_loss: 7462.8125; val_edge_recon_loss: 259100.2109; val_gene_expr_recon_loss: 188141.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454704.3125; val_optim_loss: 454704.3125
heaps
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9921; val_auprc_score: 0.9908; val_best_acc_score: 0.9605; val_best_f1_score: 0.9609; train_kl_reg_loss: 7868.0903; train_edge_recon_loss: 260706.8915; train_gene_expr_recon_loss: 186342.8993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454917.8802; train_optim_loss: 454917.8802; val_kl_reg_loss: 7585.6431; val_edge_recon_loss: 260227.5469; val_gene_expr_recon_loss: 187512.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455325.5625; val_optim_loss: 455325.5625
heaps
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9933; val_auprc_score: 0.9923; val_best_acc_score: 0.9639; val_best_f1_score: 0.9643; train_kl_reg_loss: 7819.4894; train_edge_recon_loss: 260232.0252; train_gene_expr_recon_loss: 185664.4045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453715.9201; train_optim_loss: 453715.9201; val_kl_reg_loss: 7673.4663; val_edge_recon_loss: 259421.0781; val_gene_expr_recon_loss: 186906.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454001.3750; val_optim_loss: 454001.3750
heaps
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9925; val_auprc_score: 0.9903; val_best_acc_score: 0.9628; val_best_f1_score: 0.9634; train_kl_reg_loss: 7778.0100; train_edge_recon_loss: 260172.1675; train_gene_expr_recon_loss: 185125.7118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453075.8889; train_optim_loss: 453075.8889; val_kl_reg_loss: 7642.8862; val_edge_recon_loss: 259118.3984; val_gene_expr_recon_loss: 186671.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453432.4062; val_optim_loss: 453432.4062
heaps
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9929; val_auprc_score: 0.9907; val_best_acc_score: 0.9644; val_best_f1_score: 0.9650; train_kl_reg_loss: 7709.8430; train_edge_recon_loss: 260267.8828; train_gene_expr_recon_loss: 184869.8255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452847.5486; train_optim_loss: 452847.5486; val_kl_reg_loss: 7611.9834; val_edge_recon_loss: 258473.7031; val_gene_expr_recon_loss: 186372.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452458.2188; val_optim_loss: 452458.2188
heaps
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9929; val_auprc_score: 0.9909; val_best_acc_score: 0.9645; val_best_f1_score: 0.9652; train_kl_reg_loss: 7597.5428; train_edge_recon_loss: 260031.1832; train_gene_expr_recon_loss: 185706.8715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453335.5938; train_optim_loss: 453335.5938; val_kl_reg_loss: 7761.7803; val_edge_recon_loss: 258969.8125; val_gene_expr_recon_loss: 185740.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452471.6562; val_optim_loss: 452471.6562
heaps
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9922; val_auprc_score: 0.9886; val_best_acc_score: 0.9637; val_best_f1_score: 0.9641; train_kl_reg_loss: 7780.9448; train_edge_recon_loss: 260014.1927; train_gene_expr_recon_loss: 184454.1233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452249.2604; train_optim_loss: 452249.2604; val_kl_reg_loss: 7664.2175; val_edge_recon_loss: 259952.7969; val_gene_expr_recon_loss: 185067.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452684.0469; val_optim_loss: 452684.0469
heaps
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9935; val_auprc_score: 0.9922; val_best_acc_score: 0.9663; val_best_f1_score: 0.9666; train_kl_reg_loss: 7721.1671; train_edge_recon_loss: 259950.8576; train_gene_expr_recon_loss: 183762.1016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451434.1233; train_optim_loss: 451434.1233; val_kl_reg_loss: 7569.9592; val_edge_recon_loss: 258684.1016; val_gene_expr_recon_loss: 185270.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451524.2500; val_optim_loss: 451524.2500
heaps
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9932; val_auprc_score: 0.9908; val_best_acc_score: 0.9663; val_best_f1_score: 0.9668; train_kl_reg_loss: 7684.3352; train_edge_recon_loss: 259667.5807; train_gene_expr_recon_loss: 183411.5191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450763.4358; train_optim_loss: 450763.4358; val_kl_reg_loss: 7549.6504; val_edge_recon_loss: 258754.9922; val_gene_expr_recon_loss: 184511.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450816.2500; val_optim_loss: 450816.2500
heaps
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9938; val_auprc_score: 0.9928; val_best_acc_score: 0.9658; val_best_f1_score: 0.9664; train_kl_reg_loss: 7637.2829; train_edge_recon_loss: 259990.7075; train_gene_expr_recon_loss: 183078.9627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450706.9514; train_optim_loss: 450706.9514; val_kl_reg_loss: 7478.6873; val_edge_recon_loss: 258848.1797; val_gene_expr_recon_loss: 184256.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450583.3906; val_optim_loss: 450583.3906
heaps
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9930; val_auprc_score: 0.9898; val_best_acc_score: 0.9665; val_best_f1_score: 0.9670; train_kl_reg_loss: 7489.8301; train_edge_recon_loss: 259821.7161; train_gene_expr_recon_loss: 183941.3785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451252.9288; train_optim_loss: 451252.9288; val_kl_reg_loss: 7452.4175; val_edge_recon_loss: 259081.7109; val_gene_expr_recon_loss: 185362.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451897.0625; val_optim_loss: 451897.0625
heaps
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9929; val_auprc_score: 0.9909; val_best_acc_score: 0.9667; val_best_f1_score: 0.9671; train_kl_reg_loss: 7742.5813; train_edge_recon_loss: 259716.5747; train_gene_expr_recon_loss: 182813.5469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450272.7031; train_optim_loss: 450272.7031; val_kl_reg_loss: 7624.3625; val_edge_recon_loss: 258975.8516; val_gene_expr_recon_loss: 183858.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450458.9375; val_optim_loss: 450458.9375
heaps
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9936; val_auprc_score: 0.9921; val_best_acc_score: 0.9681; val_best_f1_score: 0.9683; train_kl_reg_loss: 7717.4746; train_edge_recon_loss: 259315.4089; train_gene_expr_recon_loss: 181975.3299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449008.2135; train_optim_loss: 449008.2135; val_kl_reg_loss: 7621.3442; val_edge_recon_loss: 259460.6406; val_gene_expr_recon_loss: 183810.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450892.8750; val_optim_loss: 450892.8750
heaps
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9939; val_auprc_score: 0.9917; val_best_acc_score: 0.9686; val_best_f1_score: 0.9690; train_kl_reg_loss: 7656.2837; train_edge_recon_loss: 259225.4332; train_gene_expr_recon_loss: 181880.6207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448762.3385; train_optim_loss: 448762.3385; val_kl_reg_loss: 7585.8787; val_edge_recon_loss: 259089.1875; val_gene_expr_recon_loss: 183150.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449825.9531; val_optim_loss: 449825.9531
heaps
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9950; val_auprc_score: 0.9944; val_best_acc_score: 0.9697; val_best_f1_score: 0.9700; train_kl_reg_loss: 7628.8491; train_edge_recon_loss: 259296.4141; train_gene_expr_recon_loss: 181700.0217; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448625.2882; train_optim_loss: 448625.2882; val_kl_reg_loss: 7481.7029; val_edge_recon_loss: 259616.4219; val_gene_expr_recon_loss: 182753.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449851.2344; val_optim_loss: 449851.2344
heaps
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9946; val_auprc_score: 0.9936; val_best_acc_score: 0.9714; val_best_f1_score: 0.9717; train_kl_reg_loss: 7610.3073; train_edge_recon_loss: 259343.0330; train_gene_expr_recon_loss: 181396.0538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448349.3958; train_optim_loss: 448349.3958; val_kl_reg_loss: 7447.5840; val_edge_recon_loss: 258464.4531; val_gene_expr_recon_loss: 182695.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448607.2188; val_optim_loss: 448607.2188
heaps
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9940; val_auprc_score: 0.9923; val_best_acc_score: 0.9690; val_best_f1_score: 0.9693; train_kl_reg_loss: 7609.0823; train_edge_recon_loss: 259147.1424; train_gene_expr_recon_loss: 181176.5451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447932.7691; train_optim_loss: 447932.7691; val_kl_reg_loss: 7547.3596; val_edge_recon_loss: 258715.5234; val_gene_expr_recon_loss: 183163.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449426.2188; val_optim_loss: 449426.2188
heaps
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9947; val_auprc_score: 0.9933; val_best_acc_score: 0.9729; val_best_f1_score: 0.9731; train_kl_reg_loss: 7586.1117; train_edge_recon_loss: 259406.7517; train_gene_expr_recon_loss: 181150.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448143.3316; train_optim_loss: 448143.3316; val_kl_reg_loss: 7578.8157; val_edge_recon_loss: 258378.8672; val_gene_expr_recon_loss: 182136.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448093.9219; val_optim_loss: 448093.9219
heaps
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9940; val_auprc_score: 0.9915; val_best_acc_score: 0.9699; val_best_f1_score: 0.9702; train_kl_reg_loss: 7647.7305; train_edge_recon_loss: 259129.4809; train_gene_expr_recon_loss: 180498.0373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447275.2465; train_optim_loss: 447275.2465; val_kl_reg_loss: 7460.8533; val_edge_recon_loss: 259159.4922; val_gene_expr_recon_loss: 181776.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448397.3438; val_optim_loss: 448397.3438
heaps
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9953; val_auprc_score: 0.9938; val_best_acc_score: 0.9732; val_best_f1_score: 0.9734; train_kl_reg_loss: 7612.8621; train_edge_recon_loss: 259039.0833; train_gene_expr_recon_loss: 180400.6953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447052.6389; train_optim_loss: 447052.6389; val_kl_reg_loss: 7474.1995; val_edge_recon_loss: 257957.8594; val_gene_expr_recon_loss: 181951.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447383.8125; val_optim_loss: 447383.8125
heaps
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9942; val_auprc_score: 0.9923; val_best_acc_score: 0.9710; val_best_f1_score: 0.9713; train_kl_reg_loss: 7617.5670; train_edge_recon_loss: 259056.2700; train_gene_expr_recon_loss: 180051.8012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446725.6389; train_optim_loss: 446725.6389; val_kl_reg_loss: 7534.1931; val_edge_recon_loss: 258631.4688; val_gene_expr_recon_loss: 181151.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447317.4688; val_optim_loss: 447317.4688
heaps
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9948; val_auprc_score: 0.9936; val_best_acc_score: 0.9727; val_best_f1_score: 0.9729; train_kl_reg_loss: 7519.1011; train_edge_recon_loss: 259012.9592; train_gene_expr_recon_loss: 181079.7630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447611.8299; train_optim_loss: 447611.8299; val_kl_reg_loss: 7665.6802; val_edge_recon_loss: 258114.3281; val_gene_expr_recon_loss: 182226.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448006.4844; val_optim_loss: 448006.4844
heaps
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9953; val_auprc_score: 0.9943; val_best_acc_score: 0.9735; val_best_f1_score: 0.9738; train_kl_reg_loss: 7749.1020; train_edge_recon_loss: 258764.7474; train_gene_expr_recon_loss: 179928.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446441.9288; train_optim_loss: 446441.9288; val_kl_reg_loss: 7684.3418; val_edge_recon_loss: 257648.6328; val_gene_expr_recon_loss: 180846.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446179.7344; val_optim_loss: 446179.7344
heaps
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9953; val_auprc_score: 0.9936; val_best_acc_score: 0.9745; val_best_f1_score: 0.9749; train_kl_reg_loss: 7709.1570; train_edge_recon_loss: 258886.1806; train_gene_expr_recon_loss: 179374.2925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445969.6285; train_optim_loss: 445969.6285; val_kl_reg_loss: 7542.3403; val_edge_recon_loss: 258362.6094; val_gene_expr_recon_loss: 180690.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446595.5156; val_optim_loss: 446595.5156
heaps
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9949; val_auprc_score: 0.9937; val_best_acc_score: 0.9729; val_best_f1_score: 0.9733; train_kl_reg_loss: 7656.1576; train_edge_recon_loss: 258754.2500; train_gene_expr_recon_loss: 179341.6953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445752.1024; train_optim_loss: 445752.1024; val_kl_reg_loss: 7586.8389; val_edge_recon_loss: 258685.3672; val_gene_expr_recon_loss: 180207.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446479.9062; val_optim_loss: 446479.9062
heaps
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9953; val_auprc_score: 0.9943; val_best_acc_score: 0.9735; val_best_f1_score: 0.9737; train_kl_reg_loss: 7632.7308; train_edge_recon_loss: 258769.6892; train_gene_expr_recon_loss: 178816.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445219.1997; train_optim_loss: 445219.1997; val_kl_reg_loss: 7567.1125; val_edge_recon_loss: 258662.9375; val_gene_expr_recon_loss: 180576.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446806.1250; val_optim_loss: 446806.1250
heaps
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9953; val_auprc_score: 0.9940; val_best_acc_score: 0.9753; val_best_f1_score: 0.9756; train_kl_reg_loss: 7636.2185; train_edge_recon_loss: 258446.0477; train_gene_expr_recon_loss: 178938.3594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445020.6250; train_optim_loss: 445020.6250; val_kl_reg_loss: 7446.7422; val_edge_recon_loss: 258228.6641; val_gene_expr_recon_loss: 181140.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446816.0000; val_optim_loss: 446816.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

heaps
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9952; val_auprc_score: 0.9939; val_best_acc_score: 0.9748; val_best_f1_score: 0.9750; train_kl_reg_loss: 7582.0310; train_edge_recon_loss: 258458.4488; train_gene_expr_recon_loss: 178603.9818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444644.4618; train_optim_loss: 444644.4618; val_kl_reg_loss: 7544.1975; val_edge_recon_loss: 258037.8359; val_gene_expr_recon_loss: 179491.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445073.4375; val_optim_loss: 445073.4375
heaps
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9950; val_auprc_score: 0.9930; val_best_acc_score: 0.9727; val_best_f1_score: 0.9731; train_kl_reg_loss: 7666.1717; train_edge_recon_loss: 258357.7535; train_gene_expr_recon_loss: 178089.1615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444113.0816; train_optim_loss: 444113.0816; val_kl_reg_loss: 7549.0046; val_edge_recon_loss: 258360.6953; val_gene_expr_recon_loss: 179122.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445032.1875; val_optim_loss: 445032.1875
heaps
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9949; val_auprc_score: 0.9926; val_best_acc_score: 0.9726; val_best_f1_score: 0.9728; train_kl_reg_loss: 7639.4057; train_edge_recon_loss: 258609.7873; train_gene_expr_recon_loss: 178101.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444350.6094; train_optim_loss: 444350.6094; val_kl_reg_loss: 7544.1877; val_edge_recon_loss: 258398.6250; val_gene_expr_recon_loss: 179571.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445514.2969; val_optim_loss: 445514.2969
heaps
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9949; val_auprc_score: 0.9923; val_best_acc_score: 0.9734; val_best_f1_score: 0.9737; train_kl_reg_loss: 7637.1636; train_edge_recon_loss: 258103.6901; train_gene_expr_recon_loss: 177815.2127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443556.0694; train_optim_loss: 443556.0694; val_kl_reg_loss: 7552.2402; val_edge_recon_loss: 257544.5781; val_gene_expr_recon_loss: 179713.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444809.8906; val_optim_loss: 444809.8906
heaps
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9959; val_auprc_score: 0.9941; val_best_acc_score: 0.9756; val_best_f1_score: 0.9758; train_kl_reg_loss: 7634.8097; train_edge_recon_loss: 258622.5920; train_gene_expr_recon_loss: 177769.0365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444026.4427; train_optim_loss: 444026.4427; val_kl_reg_loss: 7522.6348; val_edge_recon_loss: 257620.0938; val_gene_expr_recon_loss: 179345.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444488.1094; val_optim_loss: 444488.1094
heaps
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9956; val_auprc_score: 0.9943; val_best_acc_score: 0.9742; val_best_f1_score: 0.9743; train_kl_reg_loss: 7627.0180; train_edge_recon_loss: 258444.7630; train_gene_expr_recon_loss: 178017.0165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444088.7934; train_optim_loss: 444088.7934; val_kl_reg_loss: 7518.5952; val_edge_recon_loss: 258496.1641; val_gene_expr_recon_loss: 179538.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445553.1406; val_optim_loss: 445553.1406
heaps
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9952; val_auprc_score: 0.9937; val_best_acc_score: 0.9739; val_best_f1_score: 0.9741; train_kl_reg_loss: 7617.3146; train_edge_recon_loss: 258661.6554; train_gene_expr_recon_loss: 177774.6580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444053.6302; train_optim_loss: 444053.6302; val_kl_reg_loss: 7518.7866; val_edge_recon_loss: 257745.0078; val_gene_expr_recon_loss: 179612.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444876.4531; val_optim_loss: 444876.4531
heaps
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9960; val_auprc_score: 0.9944; val_best_acc_score: 0.9755; val_best_f1_score: 0.9757; train_kl_reg_loss: 7617.9694; train_edge_recon_loss: 258575.3368; train_gene_expr_recon_loss: 177891.8828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444085.1910; train_optim_loss: 444085.1910; val_kl_reg_loss: 7537.7158; val_edge_recon_loss: 258687.5078; val_gene_expr_recon_loss: 179480.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445705.6875; val_optim_loss: 445705.6875
heaps
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9952; val_auprc_score: 0.9940; val_best_acc_score: 0.9742; val_best_f1_score: 0.9746; train_kl_reg_loss: 7628.3149; train_edge_recon_loss: 258517.8229; train_gene_expr_recon_loss: 177950.1693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444096.3056; train_optim_loss: 444096.3056; val_kl_reg_loss: 7516.9277; val_edge_recon_loss: 258207.6953; val_gene_expr_recon_loss: 179421.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445145.9219; val_optim_loss: 445145.9219

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

heaps
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9951; val_auprc_score: 0.9928; val_best_acc_score: 0.9749; val_best_f1_score: 0.9751; train_kl_reg_loss: 7615.4638; train_edge_recon_loss: 258446.6519; train_gene_expr_recon_loss: 177692.3281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443754.4462; train_optim_loss: 443754.4462; val_kl_reg_loss: 7519.5820; val_edge_recon_loss: 257857.9688; val_gene_expr_recon_loss: 179529.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444907.2188; val_optim_loss: 444907.2188
heaps
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9960; val_auprc_score: 0.9950; val_best_acc_score: 0.9742; val_best_f1_score: 0.9745; train_kl_reg_loss: 7618.0856; train_edge_recon_loss: 258448.4062; train_gene_expr_recon_loss: 177817.0729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443883.5625; train_optim_loss: 443883.5625; val_kl_reg_loss: 7512.6128; val_edge_recon_loss: 258428.1719; val_gene_expr_recon_loss: 179543.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445484.2656; val_optim_loss: 445484.2656
heaps
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9939; val_auprc_score: 0.9923; val_best_acc_score: 0.9724; val_best_f1_score: 0.9727; train_kl_reg_loss: 7616.2162; train_edge_recon_loss: 258649.8872; train_gene_expr_recon_loss: 177790.3715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444056.4688; train_optim_loss: 444056.4688; val_kl_reg_loss: 7511.2603; val_edge_recon_loss: 258757.8750; val_gene_expr_recon_loss: 179370.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445639.7031; val_optim_loss: 445639.7031
heaps
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9953; val_auprc_score: 0.9926; val_best_acc_score: 0.9744; val_best_f1_score: 0.9747; train_kl_reg_loss: 7609.7974; train_edge_recon_loss: 258630.1806; train_gene_expr_recon_loss: 177925.0660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444165.0503; train_optim_loss: 444165.0503; val_kl_reg_loss: 7511.6042; val_edge_recon_loss: 258338.7031; val_gene_expr_recon_loss: 179381.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445232.2656; val_optim_loss: 445232.2656

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 39 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
Val AUROC score: 0.9952
Val AUPRC score: 0.9929
Val best accuracy score: 0.9757
Val best F1 score: 0.9759
Val gene expr MSE score: 1.0730

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
