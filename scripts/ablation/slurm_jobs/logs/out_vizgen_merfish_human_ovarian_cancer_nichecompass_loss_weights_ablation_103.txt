None
Run timestamp: 18072023_102319_103.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_103']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9765; val_auprc_score: 0.9751; val_best_acc_score: 0.9206; val_best_f1_score: 0.9214; train_kl_reg_loss: 105630.1280; train_edge_recon_loss: 27399981.1674; train_gene_expr_recon_loss: 14036799.2887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41542410.5429; train_optim_loss: 41542410.5429; val_kl_reg_loss: 93205.7380; val_edge_recon_loss: 26560953.2848; val_gene_expr_recon_loss: 13279427.8608; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39933586.9241; val_optim_loss: 39933586.9241
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9861; val_auprc_score: 0.9853; val_best_acc_score: 0.9404; val_best_f1_score: 0.9410; train_kl_reg_loss: 78104.8073; train_edge_recon_loss: 26297667.8312; train_gene_expr_recon_loss: 13087018.3259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39462790.9550; train_optim_loss: 39462790.9550; val_kl_reg_loss: 67757.7649; val_edge_recon_loss: 26326486.4810; val_gene_expr_recon_loss: 12994121.8861; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39388366.1899; val_optim_loss: 39388366.1899
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9917; val_auprc_score: 0.9911; val_best_acc_score: 0.9556; val_best_f1_score: 0.9559; train_kl_reg_loss: 61667.6778; train_edge_recon_loss: 26136964.9754; train_gene_expr_recon_loss: 12937839.6371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39136472.2869; train_optim_loss: 39136472.2869; val_kl_reg_loss: 57313.5822; val_edge_recon_loss: 26216648.5380; val_gene_expr_recon_loss: 12897602.4778; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39171564.6203; val_optim_loss: 39171564.6203
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9934; val_auprc_score: 0.9928; val_best_acc_score: 0.9617; val_best_f1_score: 0.9619; train_kl_reg_loss: 55431.3840; train_edge_recon_loss: 26016215.6617; train_gene_expr_recon_loss: 12851403.8330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38923050.8987; train_optim_loss: 38923050.8987; val_kl_reg_loss: 54398.0398; val_edge_recon_loss: 26108967.1835; val_gene_expr_recon_loss: 12830795.9304; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38994161.0633; val_optim_loss: 38994161.0633
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9934; val_auprc_score: 0.9929; val_best_acc_score: 0.9619; val_best_f1_score: 0.9622; train_kl_reg_loss: 53887.0501; train_edge_recon_loss: 25976129.0007; train_gene_expr_recon_loss: 12785542.5545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38815558.6034; train_optim_loss: 38815558.6034; val_kl_reg_loss: 51380.6478; val_edge_recon_loss: 26080835.6519; val_gene_expr_recon_loss: 12795551.8892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38927768.0633; val_optim_loss: 38927768.0633
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9941; val_auprc_score: 0.9936; val_best_acc_score: 0.9644; val_best_f1_score: 0.9647; train_kl_reg_loss: 51729.3335; train_edge_recon_loss: 25952774.9592; train_gene_expr_recon_loss: 12754168.5985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38758672.8790; train_optim_loss: 38758672.8790; val_kl_reg_loss: 50023.7600; val_edge_recon_loss: 26060649.4747; val_gene_expr_recon_loss: 12754154.3449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38864827.4684; val_optim_loss: 38864827.4684
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9945; val_auprc_score: 0.9940; val_best_acc_score: 0.9658; val_best_f1_score: 0.9659; train_kl_reg_loss: 49940.3332; train_edge_recon_loss: 25919145.1343; train_gene_expr_recon_loss: 12732186.0503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38701271.5204; train_optim_loss: 38701271.5204; val_kl_reg_loss: 48328.1304; val_edge_recon_loss: 26028092.5570; val_gene_expr_recon_loss: 12745406.6519; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38821827.3544; val_optim_loss: 38821827.3544
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9945; val_auprc_score: 0.9939; val_best_acc_score: 0.9658; val_best_f1_score: 0.9660; train_kl_reg_loss: 49317.4831; train_edge_recon_loss: 25901376.0141; train_gene_expr_recon_loss: 12710159.0232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38660852.5190; train_optim_loss: 38660852.5190; val_kl_reg_loss: 49244.5650; val_edge_recon_loss: 26021302.0380; val_gene_expr_recon_loss: 12747737.0253; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38818283.5696; val_optim_loss: 38818283.5696
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9948; val_auprc_score: 0.9941; val_best_acc_score: 0.9674; val_best_f1_score: 0.9676; train_kl_reg_loss: 48013.5805; train_edge_recon_loss: 25899822.5471; train_gene_expr_recon_loss: 12696400.4399; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38644236.5584; train_optim_loss: 38644236.5584; val_kl_reg_loss: 47632.7470; val_edge_recon_loss: 25994718.1582; val_gene_expr_recon_loss: 12737343.4430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38779694.3038; val_optim_loss: 38779694.3038
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9949; val_auprc_score: 0.9943; val_best_acc_score: 0.9672; val_best_f1_score: 0.9674; train_kl_reg_loss: 47183.5975; train_edge_recon_loss: 25887264.1990; train_gene_expr_recon_loss: 12683714.9694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38618162.7806; train_optim_loss: 38618162.7806; val_kl_reg_loss: 44285.7667; val_edge_recon_loss: 25996612.7848; val_gene_expr_recon_loss: 12730600.3544; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38771498.9747; val_optim_loss: 38771498.9747
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9949; val_auprc_score: 0.9942; val_best_acc_score: 0.9677; val_best_f1_score: 0.9679; train_kl_reg_loss: 46253.5942; train_edge_recon_loss: 25875000.5956; train_gene_expr_recon_loss: 12671102.9276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38592357.1561; train_optim_loss: 38592357.1561; val_kl_reg_loss: 46189.6747; val_edge_recon_loss: 25970529.1772; val_gene_expr_recon_loss: 12731970.6139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38748689.3418; val_optim_loss: 38748689.3418
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9954; val_auprc_score: 0.9948; val_best_acc_score: 0.9688; val_best_f1_score: 0.9690; train_kl_reg_loss: 45516.7959; train_edge_recon_loss: 25863271.0366; train_gene_expr_recon_loss: 12660255.8544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38569043.6878; train_optim_loss: 38569043.6878; val_kl_reg_loss: 45148.7184; val_edge_recon_loss: 25987714.1962; val_gene_expr_recon_loss: 12718872.1266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38751735.0633; val_optim_loss: 38751735.0633
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9956; val_auprc_score: 0.9949; val_best_acc_score: 0.9706; val_best_f1_score: 0.9708; train_kl_reg_loss: 44957.2401; train_edge_recon_loss: 25859549.4473; train_gene_expr_recon_loss: 12657326.2947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38561832.9761; train_optim_loss: 38561832.9761; val_kl_reg_loss: 43558.8965; val_edge_recon_loss: 25975158.5443; val_gene_expr_recon_loss: 12714468.2753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38733185.6835; val_optim_loss: 38733185.6835
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9958; val_auprc_score: 0.9953; val_best_acc_score: 0.9711; val_best_f1_score: 0.9712; train_kl_reg_loss: 44412.4794; train_edge_recon_loss: 25842871.1463; train_gene_expr_recon_loss: 12646461.6266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38533745.2940; train_optim_loss: 38533745.2940; val_kl_reg_loss: 43185.0793; val_edge_recon_loss: 25946551.8165; val_gene_expr_recon_loss: 12715182.5063; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38704919.3544; val_optim_loss: 38704919.3544
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9959; val_auprc_score: 0.9953; val_best_acc_score: 0.9714; val_best_f1_score: 0.9715; train_kl_reg_loss: 44136.8526; train_edge_recon_loss: 25834843.0394; train_gene_expr_recon_loss: 12642925.9139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38521905.7904; train_optim_loss: 38521905.7904; val_kl_reg_loss: 42790.4840; val_edge_recon_loss: 25932715.0506; val_gene_expr_recon_loss: 12695167.1266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38670672.6203; val_optim_loss: 38670672.6203
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9959; val_auprc_score: 0.9955; val_best_acc_score: 0.9718; val_best_f1_score: 0.9719; train_kl_reg_loss: 43839.1381; train_edge_recon_loss: 25826847.8298; train_gene_expr_recon_loss: 12635158.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38505845.0830; train_optim_loss: 38505845.0830; val_kl_reg_loss: 43395.2023; val_edge_recon_loss: 25930675.8038; val_gene_expr_recon_loss: 12706344.4430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38680415.4430; val_optim_loss: 38680415.4430
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9959; val_auprc_score: 0.9953; val_best_acc_score: 0.9718; val_best_f1_score: 0.9719; train_kl_reg_loss: 43593.4178; train_edge_recon_loss: 25820619.9620; train_gene_expr_recon_loss: 12631518.9409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38495732.3530; train_optim_loss: 38495732.3530; val_kl_reg_loss: 44076.7143; val_edge_recon_loss: 25928470.1772; val_gene_expr_recon_loss: 12706350.6203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38678897.5063; val_optim_loss: 38678897.5063
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9959; val_auprc_score: 0.9954; val_best_acc_score: 0.9715; val_best_f1_score: 0.9716; train_kl_reg_loss: 43567.1652; train_edge_recon_loss: 25812988.0977; train_gene_expr_recon_loss: 12622577.2085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38479132.4374; train_optim_loss: 38479132.4374; val_kl_reg_loss: 43433.3968; val_edge_recon_loss: 25914247.7658; val_gene_expr_recon_loss: 12684892.2627; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38642573.3291; val_optim_loss: 38642573.3291
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9961; val_auprc_score: 0.9955; val_best_acc_score: 0.9728; val_best_f1_score: 0.9731; train_kl_reg_loss: 43363.5886; train_edge_recon_loss: 25809228.0745; train_gene_expr_recon_loss: 12619465.7940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38472057.4276; train_optim_loss: 38472057.4276; val_kl_reg_loss: 42570.8344; val_edge_recon_loss: 25903978.4620; val_gene_expr_recon_loss: 12701147.2215; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38647696.4684; val_optim_loss: 38647696.4684
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9964; val_auprc_score: 0.9958; val_best_acc_score: 0.9739; val_best_f1_score: 0.9741; train_kl_reg_loss: 43383.6427; train_edge_recon_loss: 25807921.2947; train_gene_expr_recon_loss: 12611472.9989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38462777.9381; train_optim_loss: 38462777.9381; val_kl_reg_loss: 43176.4233; val_edge_recon_loss: 25902281.7025; val_gene_expr_recon_loss: 12687031.7373; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38632490.0380; val_optim_loss: 38632490.0380
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9963; val_auprc_score: 0.9958; val_best_acc_score: 0.9737; val_best_f1_score: 0.9738; train_kl_reg_loss: 43135.1107; train_edge_recon_loss: 25794956.5977; train_gene_expr_recon_loss: 12609753.0039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38447844.6976; train_optim_loss: 38447844.6976; val_kl_reg_loss: 42741.7891; val_edge_recon_loss: 25889418.8165; val_gene_expr_recon_loss: 12694492.9652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38626653.4937; val_optim_loss: 38626653.4937
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9963; val_auprc_score: 0.9957; val_best_acc_score: 0.9734; val_best_f1_score: 0.9735; train_kl_reg_loss: 43049.8030; train_edge_recon_loss: 25791985.8263; train_gene_expr_recon_loss: 12612160.4364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38447196.0774; train_optim_loss: 38447196.0774; val_kl_reg_loss: 42884.0302; val_edge_recon_loss: 25888765.2848; val_gene_expr_recon_loss: 12709148.3386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38640797.7468; val_optim_loss: 38640797.7468
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9964; val_auprc_score: 0.9958; val_best_acc_score: 0.9741; val_best_f1_score: 0.9743; train_kl_reg_loss: 42988.1560; train_edge_recon_loss: 25787424.8326; train_gene_expr_recon_loss: 12604592.7989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38435005.7679; train_optim_loss: 38435005.7679; val_kl_reg_loss: 42684.4759; val_edge_recon_loss: 25885864.6266; val_gene_expr_recon_loss: 12700662.6139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38629211.7089; val_optim_loss: 38629211.7089
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9965; val_auprc_score: 0.9961; val_best_acc_score: 0.9743; val_best_f1_score: 0.9745; train_kl_reg_loss: 42855.6885; train_edge_recon_loss: 25783617.2743; train_gene_expr_recon_loss: 12604066.6593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38430539.6118; train_optim_loss: 38430539.6118; val_kl_reg_loss: 41418.3499; val_edge_recon_loss: 25884043.7975; val_gene_expr_recon_loss: 12707225.9335; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38632688.1392; val_optim_loss: 38632688.1392
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9966; val_auprc_score: 0.9962; val_best_acc_score: 0.9744; val_best_f1_score: 0.9745; train_kl_reg_loss: 42521.4593; train_edge_recon_loss: 25783765.8404; train_gene_expr_recon_loss: 12603160.1705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38429447.4487; train_optim_loss: 38429447.4487; val_kl_reg_loss: 42174.0183; val_edge_recon_loss: 25900776.0316; val_gene_expr_recon_loss: 12689256.8133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38632206.8101; val_optim_loss: 38632206.8101

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9967; val_auprc_score: 0.9962; val_best_acc_score: 0.9757; val_best_f1_score: 0.9758; train_kl_reg_loss: 46626.7869; train_edge_recon_loss: 25756514.5408; train_gene_expr_recon_loss: 12503112.5081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38306253.8397; train_optim_loss: 38306253.8397; val_kl_reg_loss: 46815.0655; val_edge_recon_loss: 25867405.3101; val_gene_expr_recon_loss: 12601179.4272; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38515399.8354; val_optim_loss: 38515399.8354
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9968; val_auprc_score: 0.9964; val_best_acc_score: 0.9757; val_best_f1_score: 0.9758; train_kl_reg_loss: 48128.7606; train_edge_recon_loss: 25745256.0000; train_gene_expr_recon_loss: 12482638.5088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38276023.3221; train_optim_loss: 38276023.3221; val_kl_reg_loss: 47763.8560; val_edge_recon_loss: 25859013.5633; val_gene_expr_recon_loss: 12601058.2184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38507835.6709; val_optim_loss: 38507835.6709
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9969; val_auprc_score: 0.9964; val_best_acc_score: 0.9764; val_best_f1_score: 0.9765; train_kl_reg_loss: 48512.4580; train_edge_recon_loss: 25756539.1125; train_gene_expr_recon_loss: 12485572.4233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38290624.0014; train_optim_loss: 38290624.0014; val_kl_reg_loss: 47581.7355; val_edge_recon_loss: 25851583.5886; val_gene_expr_recon_loss: 12603038.1013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38502203.4557; val_optim_loss: 38502203.4557
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9968; val_auprc_score: 0.9963; val_best_acc_score: 0.9762; val_best_f1_score: 0.9763; train_kl_reg_loss: 48515.7955; train_edge_recon_loss: 25749936.6920; train_gene_expr_recon_loss: 12480341.8850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38278794.3657; train_optim_loss: 38278794.3657; val_kl_reg_loss: 48392.6284; val_edge_recon_loss: 25845032.9367; val_gene_expr_recon_loss: 12589537.0981; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38482962.7215; val_optim_loss: 38482962.7215
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9969; val_auprc_score: 0.9964; val_best_acc_score: 0.9767; val_best_f1_score: 0.9768; train_kl_reg_loss: 48576.0346; train_edge_recon_loss: 25744288.6807; train_gene_expr_recon_loss: 12473924.8453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38266789.5668; train_optim_loss: 38266789.5668; val_kl_reg_loss: 47456.1613; val_edge_recon_loss: 25844066.9367; val_gene_expr_recon_loss: 12601023.7753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38492546.9620; val_optim_loss: 38492546.9620
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9970; val_auprc_score: 0.9965; val_best_acc_score: 0.9763; val_best_f1_score: 0.9765; train_kl_reg_loss: 48225.2482; train_edge_recon_loss: 25748658.9487; train_gene_expr_recon_loss: 12475391.0626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38272275.2729; train_optim_loss: 38272275.2729; val_kl_reg_loss: 47537.3913; val_edge_recon_loss: 25830963.9494; val_gene_expr_recon_loss: 12587687.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38466188.8987; val_optim_loss: 38466188.8987
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9969; val_auprc_score: 0.9964; val_best_acc_score: 0.9764; val_best_f1_score: 0.9765; train_kl_reg_loss: 48102.0417; train_edge_recon_loss: 25751444.7039; train_gene_expr_recon_loss: 12468930.5320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38268477.2532; train_optim_loss: 38268477.2532; val_kl_reg_loss: 47283.5674; val_edge_recon_loss: 25860764.3671; val_gene_expr_recon_loss: 12593894.7785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38501942.6962; val_optim_loss: 38501942.6962
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9969; val_auprc_score: 0.9965; val_best_acc_score: 0.9766; val_best_f1_score: 0.9767; train_kl_reg_loss: 47982.1809; train_edge_recon_loss: 25745671.8530; train_gene_expr_recon_loss: 12470648.3463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38264302.4360; train_optim_loss: 38264302.4360; val_kl_reg_loss: 47762.2259; val_edge_recon_loss: 25866162.9051; val_gene_expr_recon_loss: 12581519.8671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38495445.0253; val_optim_loss: 38495445.0253
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9969; val_auprc_score: 0.9964; val_best_acc_score: 0.9765; val_best_f1_score: 0.9767; train_kl_reg_loss: 47817.2408; train_edge_recon_loss: 25746719.6828; train_gene_expr_recon_loss: 12467424.6878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38261961.6217; train_optim_loss: 38261961.6217; val_kl_reg_loss: 46920.1764; val_edge_recon_loss: 25860370.8608; val_gene_expr_recon_loss: 12567446.3829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38474737.3165; val_optim_loss: 38474737.3165
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9967; val_auprc_score: 0.9962; val_best_acc_score: 0.9762; val_best_f1_score: 0.9763; train_kl_reg_loss: 47795.1454; train_edge_recon_loss: 25745325.7138; train_gene_expr_recon_loss: 12467774.0341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38260894.9114; train_optim_loss: 38260894.9114; val_kl_reg_loss: 47476.4232; val_edge_recon_loss: 25850552.7975; val_gene_expr_recon_loss: 12575009.2025; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38473038.4937; val_optim_loss: 38473038.4937

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9970; val_auprc_score: 0.9965; val_best_acc_score: 0.9770; val_best_f1_score: 0.9771; train_kl_reg_loss: 48198.2253; train_edge_recon_loss: 25742571.7236; train_gene_expr_recon_loss: 12450735.9149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38241505.8692; train_optim_loss: 38241505.8692; val_kl_reg_loss: 47535.1250; val_edge_recon_loss: 25844836.8228; val_gene_expr_recon_loss: 12579386.3101; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38471758.3544; val_optim_loss: 38471758.3544
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9970; val_auprc_score: 0.9965; val_best_acc_score: 0.9768; val_best_f1_score: 0.9769; train_kl_reg_loss: 48238.4823; train_edge_recon_loss: 25739897.9880; train_gene_expr_recon_loss: 12451651.1776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38239787.6301; train_optim_loss: 38239787.6301; val_kl_reg_loss: 47482.5765; val_edge_recon_loss: 25854050.0063; val_gene_expr_recon_loss: 12580775.0475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38482307.6076; val_optim_loss: 38482307.6076
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9970; val_auprc_score: 0.9966; val_best_acc_score: 0.9764; val_best_f1_score: 0.9765; train_kl_reg_loss: 48255.2558; train_edge_recon_loss: 25737046.0584; train_gene_expr_recon_loss: 12452471.7127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38237772.9775; train_optim_loss: 38237772.9775; val_kl_reg_loss: 47570.6416; val_edge_recon_loss: 25844630.2722; val_gene_expr_recon_loss: 12569838.9494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38462039.8354; val_optim_loss: 38462039.8354
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9970; val_auprc_score: 0.9965; val_best_acc_score: 0.9768; val_best_f1_score: 0.9769; train_kl_reg_loss: 48309.7393; train_edge_recon_loss: 25747439.0338; train_gene_expr_recon_loss: 12448563.3506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38244312.0703; train_optim_loss: 38244312.0703; val_kl_reg_loss: 47560.5856; val_edge_recon_loss: 25836321.2975; val_gene_expr_recon_loss: 12575472.2816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38459354.0633; val_optim_loss: 38459354.0633
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9969; val_auprc_score: 0.9964; val_best_acc_score: 0.9766; val_best_f1_score: 0.9767; train_kl_reg_loss: 48211.4366; train_edge_recon_loss: 25740358.6174; train_gene_expr_recon_loss: 12451432.8657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38240002.9480; train_optim_loss: 38240002.9480; val_kl_reg_loss: 47480.1174; val_edge_recon_loss: 25855333.4114; val_gene_expr_recon_loss: 12567436.4430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38470250.2025; val_optim_loss: 38470250.2025
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9969; val_auprc_score: 0.9964; val_best_acc_score: 0.9764; val_best_f1_score: 0.9765; train_kl_reg_loss: 48197.3576; train_edge_recon_loss: 25740404.7764; train_gene_expr_recon_loss: 12446158.7950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38234760.9311; train_optim_loss: 38234760.9311; val_kl_reg_loss: 47482.6611; val_edge_recon_loss: 25856890.4051; val_gene_expr_recon_loss: 12566333.9177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38470707.0380; val_optim_loss: 38470707.0380
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9970; val_auprc_score: 0.9966; val_best_acc_score: 0.9772; val_best_f1_score: 0.9773; train_kl_reg_loss: 48208.6062; train_edge_recon_loss: 25741071.9571; train_gene_expr_recon_loss: 12449539.1445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38238819.7089; train_optim_loss: 38238819.7089; val_kl_reg_loss: 47539.8062; val_edge_recon_loss: 25819590.2785; val_gene_expr_recon_loss: 12565500.8165; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38432630.9114; val_optim_loss: 38432630.9114
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9971; val_auprc_score: 0.9967; val_best_acc_score: 0.9771; val_best_f1_score: 0.9772; train_kl_reg_loss: 48232.9826; train_edge_recon_loss: 25740385.7159; train_gene_expr_recon_loss: 12452292.2581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38240910.9437; train_optim_loss: 38240910.9437; val_kl_reg_loss: 47584.8418; val_edge_recon_loss: 25843136.2975; val_gene_expr_recon_loss: 12555548.2975; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38446269.3038; val_optim_loss: 38446269.3038
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9970; val_auprc_score: 0.9965; val_best_acc_score: 0.9769; val_best_f1_score: 0.9770; train_kl_reg_loss: 48317.7095; train_edge_recon_loss: 25735341.2855; train_gene_expr_recon_loss: 12448327.0738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38231986.0323; train_optim_loss: 38231986.0323; val_kl_reg_loss: 47622.6685; val_edge_recon_loss: 25845375.0570; val_gene_expr_recon_loss: 12569822.7120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38462820.3291; val_optim_loss: 38462820.3291
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9970; val_auprc_score: 0.9965; val_best_acc_score: 0.9769; val_best_f1_score: 0.9770; train_kl_reg_loss: 48292.0373; train_edge_recon_loss: 25743775.5921; train_gene_expr_recon_loss: 12448485.0309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38240552.6498; train_optim_loss: 38240552.6498; val_kl_reg_loss: 47565.2961; val_edge_recon_loss: 25843426.4430; val_gene_expr_recon_loss: 12572322.7785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38463314.5696; val_optim_loss: 38463314.5696
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9970; val_auprc_score: 0.9965; val_best_acc_score: 0.9767; val_best_f1_score: 0.9768; train_kl_reg_loss: 48263.9914; train_edge_recon_loss: 25743832.8446; train_gene_expr_recon_loss: 12450858.4096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38242955.2293; train_optim_loss: 38242955.2293; val_kl_reg_loss: 47588.6044; val_edge_recon_loss: 25849899.7532; val_gene_expr_recon_loss: 12570009.6297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38467497.9241; val_optim_loss: 38467497.9241

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9970; val_auprc_score: 0.9964; val_best_acc_score: 0.9765; val_best_f1_score: 0.9766; train_kl_reg_loss: 48309.3303; train_edge_recon_loss: 25739493.4262; train_gene_expr_recon_loss: 12448664.4413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38236467.1617; train_optim_loss: 38236467.1617; val_kl_reg_loss: 47572.6874; val_edge_recon_loss: 25850634.5000; val_gene_expr_recon_loss: 12567734.1013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38465941.3671; val_optim_loss: 38465941.3671
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9970; val_auprc_score: 0.9966; val_best_acc_score: 0.9770; val_best_f1_score: 0.9772; train_kl_reg_loss: 48292.1918; train_edge_recon_loss: 25739339.6385; train_gene_expr_recon_loss: 12443681.7278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38231313.5218; train_optim_loss: 38231313.5218; val_kl_reg_loss: 47564.6627; val_edge_recon_loss: 25841963.4304; val_gene_expr_recon_loss: 12569473.1108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38459001.2785; val_optim_loss: 38459001.2785
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9971; val_auprc_score: 0.9967; val_best_acc_score: 0.9772; val_best_f1_score: 0.9773; train_kl_reg_loss: 48307.3417; train_edge_recon_loss: 25738031.7384; train_gene_expr_recon_loss: 12447779.8010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38234118.9241; train_optim_loss: 38234118.9241; val_kl_reg_loss: 47552.5499; val_edge_recon_loss: 25835897.8228; val_gene_expr_recon_loss: 12562319.8924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38445770.2658; val_optim_loss: 38445770.2658
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9970; val_auprc_score: 0.9965; val_best_acc_score: 0.9769; val_best_f1_score: 0.9770; train_kl_reg_loss: 48312.5144; train_edge_recon_loss: 25741731.8523; train_gene_expr_recon_loss: 12444762.8892; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38234807.2574; train_optim_loss: 38234807.2574; val_kl_reg_loss: 47559.7401; val_edge_recon_loss: 25846766.4430; val_gene_expr_recon_loss: 12577156.0759; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38471482.2278; val_optim_loss: 38471482.2278

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 913 min 44 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
Val AUROC score: 0.9970
Val AUPRC score: 0.9966
Val best accuracy score: 0.9767
Val best F1 score: 0.9768
Val gene expr MSE score: 8.2861

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
