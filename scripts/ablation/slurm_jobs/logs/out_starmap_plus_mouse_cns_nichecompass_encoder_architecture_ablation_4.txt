None
Run timestamp: 19072023_211520_4.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '30000.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9826; val_auprc_score: 0.9772; val_best_acc_score: 0.9447; val_best_f1_score: 0.9462; train_kl_reg_loss: 95338.1940; train_edge_recon_loss: 26886967.3268; train_gene_expr_recon_loss: 11801907.0598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38784212.6064; train_optim_loss: 38784212.6064; val_kl_reg_loss: 112520.3344; val_edge_recon_loss: 26134254.6500; val_gene_expr_recon_loss: 10819346.3375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37066121.4000; val_optim_loss: 37066121.4000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9854; val_auprc_score: 0.9812; val_best_acc_score: 0.9500; val_best_f1_score: 0.9513; train_kl_reg_loss: 107056.2029; train_edge_recon_loss: 26010034.3755; train_gene_expr_recon_loss: 10590564.9485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36707655.4381; train_optim_loss: 36707655.4381; val_kl_reg_loss: 100279.1221; val_edge_recon_loss: 25972352.5000; val_gene_expr_recon_loss: 10389218.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36461850.6000; val_optim_loss: 36461850.6000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9873; val_auprc_score: 0.9840; val_best_acc_score: 0.9551; val_best_f1_score: 0.9563; train_kl_reg_loss: 94020.0078; train_edge_recon_loss: 25918837.5688; train_gene_expr_recon_loss: 10277953.5883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36290811.1266; train_optim_loss: 36290811.1266; val_kl_reg_loss: 88161.3639; val_edge_recon_loss: 25932396.1000; val_gene_expr_recon_loss: 10200749.8250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36221307.1500; val_optim_loss: 36221307.1500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9891; val_auprc_score: 0.9861; val_best_acc_score: 0.9606; val_best_f1_score: 0.9616; train_kl_reg_loss: 84173.8807; train_edge_recon_loss: 25822023.6885; train_gene_expr_recon_loss: 10097104.2851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36003301.8526; train_optim_loss: 36003301.8526; val_kl_reg_loss: 80506.8131; val_edge_recon_loss: 25801578.2500; val_gene_expr_recon_loss: 10033878.1125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35915963.2500; val_optim_loss: 35915963.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9901; val_auprc_score: 0.9873; val_best_acc_score: 0.9628; val_best_f1_score: 0.9635; train_kl_reg_loss: 77406.6372; train_edge_recon_loss: 25768456.8456; train_gene_expr_recon_loss: 9987295.4548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35833158.9819; train_optim_loss: 35833158.9819; val_kl_reg_loss: 74014.8855; val_edge_recon_loss: 25784874.7000; val_gene_expr_recon_loss: 9966491.0750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35825380.8000; val_optim_loss: 35825380.8000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9902; val_auprc_score: 0.9873; val_best_acc_score: 0.9634; val_best_f1_score: 0.9643; train_kl_reg_loss: 72600.0886; train_edge_recon_loss: 25723082.9764; train_gene_expr_recon_loss: 9900463.1947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35696146.2921; train_optim_loss: 35696146.2921; val_kl_reg_loss: 67239.2915; val_edge_recon_loss: 25769317.9250; val_gene_expr_recon_loss: 9909365.6125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35745922.9000; val_optim_loss: 35745922.9000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9908; val_auprc_score: 0.9884; val_best_acc_score: 0.9653; val_best_f1_score: 0.9659; train_kl_reg_loss: 68677.1679; train_edge_recon_loss: 25694231.0014; train_gene_expr_recon_loss: 9833183.7872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35596091.9054; train_optim_loss: 35596091.9054; val_kl_reg_loss: 65847.8655; val_edge_recon_loss: 25723013.9250; val_gene_expr_recon_loss: 9846670.6625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35635532.5000; val_optim_loss: 35635532.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9915; val_auprc_score: 0.9887; val_best_acc_score: 0.9677; val_best_f1_score: 0.9683; train_kl_reg_loss: 65411.9057; train_edge_recon_loss: 25677580.3727; train_gene_expr_recon_loss: 9784539.3088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35527531.5716; train_optim_loss: 35527531.5716; val_kl_reg_loss: 63957.0010; val_edge_recon_loss: 25700752.7750; val_gene_expr_recon_loss: 9800305.4250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35565015.3500; val_optim_loss: 35565015.3500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9920; val_auprc_score: 0.9895; val_best_acc_score: 0.9697; val_best_f1_score: 0.9702; train_kl_reg_loss: 62737.9455; train_edge_recon_loss: 25649922.8762; train_gene_expr_recon_loss: 9750151.8609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35462812.6453; train_optim_loss: 35462812.6453; val_kl_reg_loss: 61427.1629; val_edge_recon_loss: 25680966.1000; val_gene_expr_recon_loss: 9790984.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35533377.9000; val_optim_loss: 35533377.9000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9927; val_auprc_score: 0.9906; val_best_acc_score: 0.9716; val_best_f1_score: 0.9720; train_kl_reg_loss: 60615.4445; train_edge_recon_loss: 25639491.3769; train_gene_expr_recon_loss: 9698312.3282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35398419.1433; train_optim_loss: 35398419.1433; val_kl_reg_loss: 59175.9043; val_edge_recon_loss: 25688849.9500; val_gene_expr_recon_loss: 9744547.5125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35492573.3500; val_optim_loss: 35492573.3500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9934; val_auprc_score: 0.9914; val_best_acc_score: 0.9729; val_best_f1_score: 0.9733; train_kl_reg_loss: 59324.4465; train_edge_recon_loss: 25616569.4854; train_gene_expr_recon_loss: 9673167.7733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35349061.7079; train_optim_loss: 35349061.7079; val_kl_reg_loss: 59642.3610; val_edge_recon_loss: 25675499.7750; val_gene_expr_recon_loss: 9727599.6625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35462741.5500; val_optim_loss: 35462741.5500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9933; val_auprc_score: 0.9913; val_best_acc_score: 0.9733; val_best_f1_score: 0.9737; train_kl_reg_loss: 58316.2802; train_edge_recon_loss: 25604760.2698; train_gene_expr_recon_loss: 9641842.1001; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35304918.6537; train_optim_loss: 35304918.6537; val_kl_reg_loss: 57570.5925; val_edge_recon_loss: 25654267.8500; val_gene_expr_recon_loss: 9723088.8625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35434927.3500; val_optim_loss: 35434927.3500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9939; val_auprc_score: 0.9923; val_best_acc_score: 0.9740; val_best_f1_score: 0.9745; train_kl_reg_loss: 57357.9863; train_edge_recon_loss: 25597696.5508; train_gene_expr_recon_loss: 9612462.7636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35267517.3630; train_optim_loss: 35267517.3630; val_kl_reg_loss: 56238.9961; val_edge_recon_loss: 25629666.1000; val_gene_expr_recon_loss: 9698485.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35384390.6000; val_optim_loss: 35384390.6000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9943; val_auprc_score: 0.9928; val_best_acc_score: 0.9745; val_best_f1_score: 0.9749; train_kl_reg_loss: 56136.1074; train_edge_recon_loss: 25592450.6008; train_gene_expr_recon_loss: 9587227.7830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35235814.4256; train_optim_loss: 35235814.4256; val_kl_reg_loss: 55612.2556; val_edge_recon_loss: 25637910.1000; val_gene_expr_recon_loss: 9657896.2875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35351418.8500; val_optim_loss: 35351418.8500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9941; val_auprc_score: 0.9921; val_best_acc_score: 0.9748; val_best_f1_score: 0.9751; train_kl_reg_loss: 55400.2821; train_edge_recon_loss: 25582564.2726; train_gene_expr_recon_loss: 9564956.9944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35202921.5522; train_optim_loss: 35202921.5522; val_kl_reg_loss: 53523.9815; val_edge_recon_loss: 25649439.8000; val_gene_expr_recon_loss: 9664401.3875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35367365.1000; val_optim_loss: 35367365.1000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9946; val_auprc_score: 0.9930; val_best_acc_score: 0.9761; val_best_f1_score: 0.9765; train_kl_reg_loss: 54828.0326; train_edge_recon_loss: 25581212.6537; train_gene_expr_recon_loss: 9543229.6745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35179270.3310; train_optim_loss: 35179270.3310; val_kl_reg_loss: 53340.1457; val_edge_recon_loss: 25604742.8500; val_gene_expr_recon_loss: 9660467.5875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35318550.9500; val_optim_loss: 35318550.9500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9940; val_auprc_score: 0.9923; val_best_acc_score: 0.9757; val_best_f1_score: 0.9760; train_kl_reg_loss: 54076.3337; train_edge_recon_loss: 25579265.9277; train_gene_expr_recon_loss: 9539863.0334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35173205.2907; train_optim_loss: 35173205.2907; val_kl_reg_loss: 52096.7728; val_edge_recon_loss: 25632024.1000; val_gene_expr_recon_loss: 9646998.3250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35331119.0500; val_optim_loss: 35331119.0500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9948; val_auprc_score: 0.9933; val_best_acc_score: 0.9766; val_best_f1_score: 0.9769; train_kl_reg_loss: 53508.0419; train_edge_recon_loss: 25567664.1363; train_gene_expr_recon_loss: 9517160.6634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35138332.8456; train_optim_loss: 35138332.8456; val_kl_reg_loss: 52439.9470; val_edge_recon_loss: 25575662.0750; val_gene_expr_recon_loss: 9648880.2750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35276982.4500; val_optim_loss: 35276982.4500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9947; val_auprc_score: 0.9931; val_best_acc_score: 0.9768; val_best_f1_score: 0.9772; train_kl_reg_loss: 53565.5598; train_edge_recon_loss: 25564275.2768; train_gene_expr_recon_loss: 9501998.3713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35119839.2156; train_optim_loss: 35119839.2156; val_kl_reg_loss: 51837.3245; val_edge_recon_loss: 25604109.9500; val_gene_expr_recon_loss: 9642768.5875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35298715.9500; val_optim_loss: 35298715.9500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9949; val_auprc_score: 0.9934; val_best_acc_score: 0.9769; val_best_f1_score: 0.9772; train_kl_reg_loss: 53100.6099; train_edge_recon_loss: 25555301.2935; train_gene_expr_recon_loss: 9479923.5695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35088325.5188; train_optim_loss: 35088325.5188; val_kl_reg_loss: 52950.9612; val_edge_recon_loss: 25613610.4750; val_gene_expr_recon_loss: 9623151.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35289713.5000; val_optim_loss: 35289713.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9945; val_auprc_score: 0.9927; val_best_acc_score: 0.9772; val_best_f1_score: 0.9775; train_kl_reg_loss: 52728.5105; train_edge_recon_loss: 25554624.8373; train_gene_expr_recon_loss: 9471657.0932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35079010.5257; train_optim_loss: 35079010.5257; val_kl_reg_loss: 52551.3195; val_edge_recon_loss: 25602012.1500; val_gene_expr_recon_loss: 9627435.2750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35281998.9000; val_optim_loss: 35281998.9000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9948; val_auprc_score: 0.9930; val_best_acc_score: 0.9776; val_best_f1_score: 0.9779; train_kl_reg_loss: 51929.1521; train_edge_recon_loss: 25560827.5800; train_gene_expr_recon_loss: 9471871.3449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35084628.0501; train_optim_loss: 35084628.0501; val_kl_reg_loss: 51754.2256; val_edge_recon_loss: 25578011.4750; val_gene_expr_recon_loss: 9617747.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35247512.5500; val_optim_loss: 35247512.5500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9950; val_auprc_score: 0.9936; val_best_acc_score: 0.9776; val_best_f1_score: 0.9779; train_kl_reg_loss: 51905.8676; train_edge_recon_loss: 25542651.5243; train_gene_expr_recon_loss: 9453872.2636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35048429.6579; train_optim_loss: 35048429.6579; val_kl_reg_loss: 51588.7262; val_edge_recon_loss: 25605778.0500; val_gene_expr_recon_loss: 9628492.5500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35285859.1500; val_optim_loss: 35285859.1500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9952; val_auprc_score: 0.9938; val_best_acc_score: 0.9786; val_best_f1_score: 0.9788; train_kl_reg_loss: 51771.3372; train_edge_recon_loss: 25543568.8484; train_gene_expr_recon_loss: 9440063.4312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35035403.6217; train_optim_loss: 35035403.6217; val_kl_reg_loss: 52107.0630; val_edge_recon_loss: 25581496.6750; val_gene_expr_recon_loss: 9628100.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35261703.7000; val_optim_loss: 35261703.7000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9956; val_auprc_score: 0.9945; val_best_acc_score: 0.9791; val_best_f1_score: 0.9794; train_kl_reg_loss: 51431.4358; train_edge_recon_loss: 25541106.8122; train_gene_expr_recon_loss: 9429807.5076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35022345.7357; train_optim_loss: 35022345.7357; val_kl_reg_loss: 51304.7730; val_edge_recon_loss: 25574253.5750; val_gene_expr_recon_loss: 9582686.2250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35208244.9000; val_optim_loss: 35208244.9000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9953; val_auprc_score: 0.9940; val_best_acc_score: 0.9781; val_best_f1_score: 0.9784; train_kl_reg_loss: 50847.0074; train_edge_recon_loss: 25539096.5369; train_gene_expr_recon_loss: 9423863.3296; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35013806.7705; train_optim_loss: 35013806.7705; val_kl_reg_loss: 50735.2055; val_edge_recon_loss: 25591790.0500; val_gene_expr_recon_loss: 9602677.5875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35245203.0000; val_optim_loss: 35245203.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9955; val_auprc_score: 0.9942; val_best_acc_score: 0.9792; val_best_f1_score: 0.9795; train_kl_reg_loss: 50621.8812; train_edge_recon_loss: 25536116.2726; train_gene_expr_recon_loss: 9416345.6342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35003083.8164; train_optim_loss: 35003083.8164; val_kl_reg_loss: 49514.4226; val_edge_recon_loss: 25571102.3750; val_gene_expr_recon_loss: 9613262.5875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35233879.3000; val_optim_loss: 35233879.3000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9957; val_auprc_score: 0.9945; val_best_acc_score: 0.9790; val_best_f1_score: 0.9793; train_kl_reg_loss: 50682.2581; train_edge_recon_loss: 25534658.4868; train_gene_expr_recon_loss: 9405038.1905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34990378.9040; train_optim_loss: 34990378.9040; val_kl_reg_loss: 50160.9678; val_edge_recon_loss: 25567894.5000; val_gene_expr_recon_loss: 9594489.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35212544.7000; val_optim_loss: 35212544.7000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9953; val_auprc_score: 0.9940; val_best_acc_score: 0.9794; val_best_f1_score: 0.9797; train_kl_reg_loss: 50731.0731; train_edge_recon_loss: 25533589.3157; train_gene_expr_recon_loss: 9398722.7281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34983043.0821; train_optim_loss: 34983043.0821; val_kl_reg_loss: 50473.5961; val_edge_recon_loss: 25564977.2000; val_gene_expr_recon_loss: 9593462.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35208913.5000; val_optim_loss: 35208913.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9955; val_auprc_score: 0.9944; val_best_acc_score: 0.9788; val_best_f1_score: 0.9791; train_kl_reg_loss: 53239.1328; train_edge_recon_loss: 25519886.3088; train_gene_expr_recon_loss: 9316857.8588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34889983.3102; train_optim_loss: 34889983.3102; val_kl_reg_loss: 53765.0975; val_edge_recon_loss: 25561556.8500; val_gene_expr_recon_loss: 9543799.0375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35159120.9500; val_optim_loss: 35159120.9500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9958; val_auprc_score: 0.9943; val_best_acc_score: 0.9795; val_best_f1_score: 0.9797; train_kl_reg_loss: 54680.6233; train_edge_recon_loss: 25523550.4729; train_gene_expr_recon_loss: 9300940.5925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34879171.7163; train_optim_loss: 34879171.7163; val_kl_reg_loss: 54211.8343; val_edge_recon_loss: 25541785.7000; val_gene_expr_recon_loss: 9562895.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35158893.4000; val_optim_loss: 35158893.4000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9957; val_auprc_score: 0.9946; val_best_acc_score: 0.9798; val_best_f1_score: 0.9801; train_kl_reg_loss: 55391.4501; train_edge_recon_loss: 25506166.6175; train_gene_expr_recon_loss: 9297433.0153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34858991.0376; train_optim_loss: 34858991.0376; val_kl_reg_loss: 55243.9717; val_edge_recon_loss: 25552835.0750; val_gene_expr_recon_loss: 9534327.2625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35142406.1000; val_optim_loss: 35142406.1000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9959; val_auprc_score: 0.9947; val_best_acc_score: 0.9797; val_best_f1_score: 0.9800; train_kl_reg_loss: 55674.8947; train_edge_recon_loss: 25526694.7065; train_gene_expr_recon_loss: 9292221.8387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34874591.4103; train_optim_loss: 34874591.4103; val_kl_reg_loss: 55166.1786; val_edge_recon_loss: 25539591.3250; val_gene_expr_recon_loss: 9528553.0875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35123310.6000; val_optim_loss: 35123310.6000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9958; val_auprc_score: 0.9945; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 55860.3822; train_edge_recon_loss: 25517761.0376; train_gene_expr_recon_loss: 9289347.3380; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34862968.6843; train_optim_loss: 34862968.6843; val_kl_reg_loss: 55080.9173; val_edge_recon_loss: 25550493.0000; val_gene_expr_recon_loss: 9547354.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35152928.1500; val_optim_loss: 35152928.1500
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9958; val_auprc_score: 0.9948; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 55758.0843; train_edge_recon_loss: 25515588.0473; train_gene_expr_recon_loss: 9282822.9611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34854169.1460; train_optim_loss: 34854169.1460; val_kl_reg_loss: 55180.8838; val_edge_recon_loss: 25546472.0750; val_gene_expr_recon_loss: 9557394.6500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35159047.6500; val_optim_loss: 35159047.6500
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9959; val_auprc_score: 0.9944; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 56068.8350; train_edge_recon_loss: 25515773.4103; train_gene_expr_recon_loss: 9286380.8665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34858223.0737; train_optim_loss: 34858223.0737; val_kl_reg_loss: 54967.2366; val_edge_recon_loss: 25548077.7750; val_gene_expr_recon_loss: 9544602.8250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35147647.7500; val_optim_loss: 35147647.7500
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9958; val_auprc_score: 0.9946; val_best_acc_score: 0.9797; val_best_f1_score: 0.9799; train_kl_reg_loss: 56048.6629; train_edge_recon_loss: 25518479.7274; train_gene_expr_recon_loss: 9274015.4604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34848543.7886; train_optim_loss: 34848543.7886; val_kl_reg_loss: 55697.2866; val_edge_recon_loss: 25540075.5000; val_gene_expr_recon_loss: 9495382.9812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35091155.8000; val_optim_loss: 35091155.8000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9958; val_auprc_score: 0.9944; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 56209.5034; train_edge_recon_loss: 25507699.5299; train_gene_expr_recon_loss: 9280646.7573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34844555.7441; train_optim_loss: 34844555.7441; val_kl_reg_loss: 55349.4697; val_edge_recon_loss: 25552473.5500; val_gene_expr_recon_loss: 9520911.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35128734.8500; val_optim_loss: 35128734.8500
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9960; val_auprc_score: 0.9950; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 56253.9350; train_edge_recon_loss: 25510493.7469; train_gene_expr_recon_loss: 9275295.5897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34842043.2211; train_optim_loss: 34842043.2211; val_kl_reg_loss: 55588.5770; val_edge_recon_loss: 25544969.2750; val_gene_expr_recon_loss: 9541868.9875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35142426.7000; val_optim_loss: 35142426.7000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9960; val_auprc_score: 0.9948; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 56275.1277; train_edge_recon_loss: 25507897.1961; train_gene_expr_recon_loss: 9271453.6537; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34835626.0417; train_optim_loss: 34835626.0417; val_kl_reg_loss: 55317.9219; val_edge_recon_loss: 25535998.2500; val_gene_expr_recon_loss: 9530158.2375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35121474.3000; val_optim_loss: 35121474.3000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9959; val_auprc_score: 0.9944; val_best_acc_score: 0.9799; val_best_f1_score: 0.9801; train_kl_reg_loss: 56361.0940; train_edge_recon_loss: 25506737.3408; train_gene_expr_recon_loss: 9266008.4228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34829106.7816; train_optim_loss: 34829106.7816; val_kl_reg_loss: 55627.8181; val_edge_recon_loss: 25548024.6500; val_gene_expr_recon_loss: 9540548.1375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35144200.7000; val_optim_loss: 35144200.7000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9958; val_auprc_score: 0.9946; val_best_acc_score: 0.9795; val_best_f1_score: 0.9797; train_kl_reg_loss: 56421.3786; train_edge_recon_loss: 25511246.3366; train_gene_expr_recon_loss: 9270537.0911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34838204.8401; train_optim_loss: 34838204.8401; val_kl_reg_loss: 55723.0056; val_edge_recon_loss: 25545557.8750; val_gene_expr_recon_loss: 9538350.4875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35139631.3500; val_optim_loss: 35139631.3500
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9960; val_auprc_score: 0.9948; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 56437.3418; train_edge_recon_loss: 25505050.7010; train_gene_expr_recon_loss: 9254894.1940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34816382.1919; train_optim_loss: 34816382.1919; val_kl_reg_loss: 55853.1680; val_edge_recon_loss: 25538382.8500; val_gene_expr_recon_loss: 9539317.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35133553.9000; val_optim_loss: 35133553.9000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9956; val_auprc_score: 0.9943; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 56595.5681; train_edge_recon_loss: 25505625.3129; train_gene_expr_recon_loss: 9260868.2225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34823089.0403; train_optim_loss: 34823089.0403; val_kl_reg_loss: 55960.1317; val_edge_recon_loss: 25541442.4250; val_gene_expr_recon_loss: 9517259.7875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35114662.1500; val_optim_loss: 35114662.1500
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9959; val_auprc_score: 0.9947; val_best_acc_score: 0.9798; val_best_f1_score: 0.9801; train_kl_reg_loss: 56637.8923; train_edge_recon_loss: 25510371.4631; train_gene_expr_recon_loss: 9251489.1008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34818498.4089; train_optim_loss: 34818498.4089; val_kl_reg_loss: 55934.8963; val_edge_recon_loss: 25539381.8000; val_gene_expr_recon_loss: 9528849.1375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35124165.7000; val_optim_loss: 35124165.7000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 267 min 28 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
Val AUROC score: 0.9958
Val AUPRC score: 0.9945
Val best accuracy score: 0.9792
Val best F1 score: 0.9795
Val gene expr MSE score: 0.6285

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
