None
Run timestamp: 26072023_074319_4.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '30.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9901; val_auprc_score: 0.9867; val_best_acc_score: 0.9657; val_best_f1_score: 0.9664; train_kl_reg_loss: 5892.6065; train_edge_recon_loss: 260062.1881; train_gene_expr_recon_loss: 12885.4196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278840.2145; train_optim_loss: 278840.2145; val_kl_reg_loss: 5826.2494; val_edge_recon_loss: 256648.0852; val_gene_expr_recon_loss: 11899.1044; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274373.4387; val_optim_loss: 274373.4387
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9918; val_auprc_score: 0.9882; val_best_acc_score: 0.9714; val_best_f1_score: 0.9719; train_kl_reg_loss: 5831.7204; train_edge_recon_loss: 257120.9347; train_gene_expr_recon_loss: 11527.6516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274480.3066; train_optim_loss: 274480.3066; val_kl_reg_loss: 5853.0255; val_edge_recon_loss: 255844.1921; val_gene_expr_recon_loss: 11281.6969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272978.9161; val_optim_loss: 272978.9161
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9928; val_auprc_score: 0.9898; val_best_acc_score: 0.9737; val_best_f1_score: 0.9741; train_kl_reg_loss: 5802.1793; train_edge_recon_loss: 256687.3570; train_gene_expr_recon_loss: 11167.5706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273657.1070; train_optim_loss: 273657.1070; val_kl_reg_loss: 5698.8196; val_edge_recon_loss: 255619.7981; val_gene_expr_recon_loss: 11072.6439; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272391.2619; val_optim_loss: 272391.2619
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9941; val_auprc_score: 0.9914; val_best_acc_score: 0.9773; val_best_f1_score: 0.9777; train_kl_reg_loss: 5788.3861; train_edge_recon_loss: 256444.5919; train_gene_expr_recon_loss: 10971.0987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273204.0765; train_optim_loss: 273204.0765; val_kl_reg_loss: 5688.9165; val_edge_recon_loss: 255293.0250; val_gene_expr_recon_loss: 10869.9095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271851.8515; val_optim_loss: 271851.8515
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9950; val_auprc_score: 0.9930; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 5784.3741; train_edge_recon_loss: 256152.3776; train_gene_expr_recon_loss: 10838.5652; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272775.3172; train_optim_loss: 272775.3172; val_kl_reg_loss: 5850.5247; val_edge_recon_loss: 255012.8389; val_gene_expr_recon_loss: 10751.6594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271615.0234; val_optim_loss: 271615.0234
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9951; val_auprc_score: 0.9925; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 5779.9721; train_edge_recon_loss: 256004.9220; train_gene_expr_recon_loss: 10735.2873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272520.1813; train_optim_loss: 272520.1813; val_kl_reg_loss: 5689.9609; val_edge_recon_loss: 255030.7566; val_gene_expr_recon_loss: 10673.6282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271394.3449; val_optim_loss: 271394.3449
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9951; val_auprc_score: 0.9929; val_best_acc_score: 0.9820; val_best_f1_score: 0.9822; train_kl_reg_loss: 5774.4624; train_edge_recon_loss: 255916.0922; train_gene_expr_recon_loss: 10664.0457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272354.6005; train_optim_loss: 272354.6005; val_kl_reg_loss: 5836.6002; val_edge_recon_loss: 254943.0762; val_gene_expr_recon_loss: 10604.6668; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271384.3433; val_optim_loss: 271384.3433
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9959; val_auprc_score: 0.9939; val_best_acc_score: 0.9838; val_best_f1_score: 0.9839; train_kl_reg_loss: 5772.4474; train_edge_recon_loss: 255780.8118; train_gene_expr_recon_loss: 10619.7717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272173.0313; train_optim_loss: 272173.0313; val_kl_reg_loss: 5653.2530; val_edge_recon_loss: 254548.6395; val_gene_expr_recon_loss: 10608.4230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270810.3162; val_optim_loss: 270810.3162
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9959; val_auprc_score: 0.9943; val_best_acc_score: 0.9839; val_best_f1_score: 0.9841; train_kl_reg_loss: 5771.8761; train_edge_recon_loss: 255648.2832; train_gene_expr_recon_loss: 10588.7434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272008.9024; train_optim_loss: 272008.9024; val_kl_reg_loss: 5742.0052; val_edge_recon_loss: 254323.3851; val_gene_expr_recon_loss: 10571.4908; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270636.8809; val_optim_loss: 270636.8809
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9958; val_auprc_score: 0.9936; val_best_acc_score: 0.9841; val_best_f1_score: 0.9843; train_kl_reg_loss: 5772.6009; train_edge_recon_loss: 255500.6036; train_gene_expr_recon_loss: 10560.5259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271833.7307; train_optim_loss: 271833.7307; val_kl_reg_loss: 5800.0659; val_edge_recon_loss: 254512.8598; val_gene_expr_recon_loss: 10515.8551; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270828.7812; val_optim_loss: 270828.7812
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9963; val_auprc_score: 0.9945; val_best_acc_score: 0.9848; val_best_f1_score: 0.9849; train_kl_reg_loss: 5772.5320; train_edge_recon_loss: 255429.4550; train_gene_expr_recon_loss: 10531.1834; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271733.1703; train_optim_loss: 271733.1703; val_kl_reg_loss: 5751.7378; val_edge_recon_loss: 254544.7053; val_gene_expr_recon_loss: 10520.7410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270817.1851; val_optim_loss: 270817.1851
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9962; val_auprc_score: 0.9944; val_best_acc_score: 0.9852; val_best_f1_score: 0.9853; train_kl_reg_loss: 5770.5577; train_edge_recon_loss: 255398.0963; train_gene_expr_recon_loss: 10518.4337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271687.0873; train_optim_loss: 271687.0873; val_kl_reg_loss: 5701.1738; val_edge_recon_loss: 254347.3349; val_gene_expr_recon_loss: 10493.9009; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270542.4093; val_optim_loss: 270542.4093
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9962; val_auprc_score: 0.9944; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 5770.3741; train_edge_recon_loss: 255373.2369; train_gene_expr_recon_loss: 10505.0272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271648.6378; train_optim_loss: 271648.6378; val_kl_reg_loss: 5777.0084; val_edge_recon_loss: 254277.6262; val_gene_expr_recon_loss: 10470.7331; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270525.3673; val_optim_loss: 270525.3673
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9966; val_auprc_score: 0.9950; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 5772.5271; train_edge_recon_loss: 255326.3279; train_gene_expr_recon_loss: 10488.0531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271586.9081; train_optim_loss: 271586.9081; val_kl_reg_loss: 5733.0842; val_edge_recon_loss: 254090.9178; val_gene_expr_recon_loss: 10478.2771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270302.2787; val_optim_loss: 270302.2787
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9965; val_auprc_score: 0.9949; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 5774.7602; train_edge_recon_loss: 255200.6617; train_gene_expr_recon_loss: 10467.4836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271442.9057; train_optim_loss: 271442.9057; val_kl_reg_loss: 5815.5053; val_edge_recon_loss: 254233.9027; val_gene_expr_recon_loss: 10420.1121; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270469.5207; val_optim_loss: 270469.5207
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9967; val_auprc_score: 0.9953; val_best_acc_score: 0.9862; val_best_f1_score: 0.9863; train_kl_reg_loss: 5775.0646; train_edge_recon_loss: 255152.4244; train_gene_expr_recon_loss: 10467.8535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271395.3426; train_optim_loss: 271395.3426; val_kl_reg_loss: 5795.5805; val_edge_recon_loss: 254268.8219; val_gene_expr_recon_loss: 10441.8862; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270506.2894; val_optim_loss: 270506.2894
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9967; val_auprc_score: 0.9952; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 5774.8215; train_edge_recon_loss: 255121.7248; train_gene_expr_recon_loss: 10452.3148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271348.8610; train_optim_loss: 271348.8610; val_kl_reg_loss: 5812.0906; val_edge_recon_loss: 254007.7295; val_gene_expr_recon_loss: 10407.2850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270227.1045; val_optim_loss: 270227.1045
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9966; val_auprc_score: 0.9951; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 5772.9269; train_edge_recon_loss: 255148.7293; train_gene_expr_recon_loss: 10448.3220; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271369.9782; train_optim_loss: 271369.9782; val_kl_reg_loss: 5780.9568; val_edge_recon_loss: 254237.4524; val_gene_expr_recon_loss: 10422.5597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270440.9690; val_optim_loss: 270440.9690
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9966; val_auprc_score: 0.9949; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 5774.2978; train_edge_recon_loss: 255087.4855; train_gene_expr_recon_loss: 10443.4913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271305.2744; train_optim_loss: 271305.2744; val_kl_reg_loss: 5825.2246; val_edge_recon_loss: 254083.2810; val_gene_expr_recon_loss: 10414.4254; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270322.9307; val_optim_loss: 270322.9307
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9970; val_auprc_score: 0.9955; val_best_acc_score: 0.9877; val_best_f1_score: 0.9877; train_kl_reg_loss: 5775.4173; train_edge_recon_loss: 255070.7311; train_gene_expr_recon_loss: 10426.0159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271272.1645; train_optim_loss: 271272.1645; val_kl_reg_loss: 5790.7135; val_edge_recon_loss: 253907.7257; val_gene_expr_recon_loss: 10418.9094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270117.3475; val_optim_loss: 270117.3475
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9969; val_auprc_score: 0.9955; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 5775.6237; train_edge_recon_loss: 255008.5249; train_gene_expr_recon_loss: 10422.2852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271206.4338; train_optim_loss: 271206.4338; val_kl_reg_loss: 5761.8536; val_edge_recon_loss: 253851.7820; val_gene_expr_recon_loss: 10390.2113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270003.8471; val_optim_loss: 270003.8471
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9969; val_auprc_score: 0.9954; val_best_acc_score: 0.9874; val_best_f1_score: 0.9875; train_kl_reg_loss: 5776.4127; train_edge_recon_loss: 255021.7780; train_gene_expr_recon_loss: 10422.9763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271221.1670; train_optim_loss: 271221.1670; val_kl_reg_loss: 5787.5565; val_edge_recon_loss: 253941.1515; val_gene_expr_recon_loss: 10380.5641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270109.2719; val_optim_loss: 270109.2719
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9970; val_auprc_score: 0.9955; val_best_acc_score: 0.9879; val_best_f1_score: 0.9880; train_kl_reg_loss: 5775.3841; train_edge_recon_loss: 255040.8309; train_gene_expr_recon_loss: 10412.2285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271228.4433; train_optim_loss: 271228.4433; val_kl_reg_loss: 5772.5308; val_edge_recon_loss: 253729.4358; val_gene_expr_recon_loss: 10384.5788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269886.5453; val_optim_loss: 269886.5453
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9969; val_auprc_score: 0.9954; val_best_acc_score: 0.9880; val_best_f1_score: 0.9880; train_kl_reg_loss: 5779.2373; train_edge_recon_loss: 254951.5097; train_gene_expr_recon_loss: 10410.9238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271141.6705; train_optim_loss: 271141.6705; val_kl_reg_loss: 5764.7830; val_edge_recon_loss: 253876.6641; val_gene_expr_recon_loss: 10385.7491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270027.1959; val_optim_loss: 270027.1959
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9970; val_auprc_score: 0.9956; val_best_acc_score: 0.9883; val_best_f1_score: 0.9884; train_kl_reg_loss: 5779.5185; train_edge_recon_loss: 254897.9810; train_gene_expr_recon_loss: 10402.4695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271079.9690; train_optim_loss: 271079.9690; val_kl_reg_loss: 5784.1552; val_edge_recon_loss: 253781.9110; val_gene_expr_recon_loss: 10359.8178; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269925.8842; val_optim_loss: 269925.8842
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9972; val_auprc_score: 0.9959; val_best_acc_score: 0.9884; val_best_f1_score: 0.9885; train_kl_reg_loss: 5781.5303; train_edge_recon_loss: 254886.2261; train_gene_expr_recon_loss: 10408.5009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271076.2574; train_optim_loss: 271076.2574; val_kl_reg_loss: 5798.8259; val_edge_recon_loss: 253771.9773; val_gene_expr_recon_loss: 10378.9352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269949.7390; val_optim_loss: 269949.7390
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9969; val_auprc_score: 0.9952; val_best_acc_score: 0.9881; val_best_f1_score: 0.9881; train_kl_reg_loss: 5784.6353; train_edge_recon_loss: 254849.4632; train_gene_expr_recon_loss: 10399.2887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271033.3870; train_optim_loss: 271033.3870; val_kl_reg_loss: 5812.8421; val_edge_recon_loss: 253789.8465; val_gene_expr_recon_loss: 10385.1711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269987.8604; val_optim_loss: 269987.8604

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9971; val_auprc_score: 0.9956; val_best_acc_score: 0.9882; val_best_f1_score: 0.9883; train_kl_reg_loss: 5781.0217; train_edge_recon_loss: 254776.6521; train_gene_expr_recon_loss: 10352.1856; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270909.8592; train_optim_loss: 270909.8592; val_kl_reg_loss: 5796.9203; val_edge_recon_loss: 253708.6061; val_gene_expr_recon_loss: 10319.9057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269825.4327; val_optim_loss: 269825.4327
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9971; val_auprc_score: 0.9954; val_best_acc_score: 0.9886; val_best_f1_score: 0.9887; train_kl_reg_loss: 5773.5337; train_edge_recon_loss: 254727.4458; train_gene_expr_recon_loss: 10339.7623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270840.7415; train_optim_loss: 270840.7415; val_kl_reg_loss: 5787.5689; val_edge_recon_loss: 253532.1978; val_gene_expr_recon_loss: 10331.2952; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269651.0620; val_optim_loss: 269651.0620
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9973; val_auprc_score: 0.9960; val_best_acc_score: 0.9890; val_best_f1_score: 0.9891; train_kl_reg_loss: 5769.0043; train_edge_recon_loss: 254767.4739; train_gene_expr_recon_loss: 10330.3937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270866.8719; train_optim_loss: 270866.8719; val_kl_reg_loss: 5760.6016; val_edge_recon_loss: 253531.9889; val_gene_expr_recon_loss: 10315.3031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269607.8934; val_optim_loss: 269607.8934
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9973; val_auprc_score: 0.9959; val_best_acc_score: 0.9890; val_best_f1_score: 0.9891; train_kl_reg_loss: 5764.4408; train_edge_recon_loss: 254710.0129; train_gene_expr_recon_loss: 10327.1831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270801.6369; train_optim_loss: 270801.6369; val_kl_reg_loss: 5766.0677; val_edge_recon_loss: 253525.9451; val_gene_expr_recon_loss: 10298.2950; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269590.3073; val_optim_loss: 269590.3073
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9971; val_auprc_score: 0.9957; val_best_acc_score: 0.9888; val_best_f1_score: 0.9888; train_kl_reg_loss: 5762.4484; train_edge_recon_loss: 254711.9846; train_gene_expr_recon_loss: 10327.4320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270801.8650; train_optim_loss: 270801.8650; val_kl_reg_loss: 5769.6570; val_edge_recon_loss: 253664.3472; val_gene_expr_recon_loss: 10316.4425; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269750.4475; val_optim_loss: 269750.4475
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9973; val_auprc_score: 0.9961; val_best_acc_score: 0.9892; val_best_f1_score: 0.9893; train_kl_reg_loss: 5761.1531; train_edge_recon_loss: 254736.3624; train_gene_expr_recon_loss: 10320.0299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270817.5456; train_optim_loss: 270817.5456; val_kl_reg_loss: 5771.6332; val_edge_recon_loss: 253361.9933; val_gene_expr_recon_loss: 10318.6120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269452.2387; val_optim_loss: 269452.2387
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9971; val_auprc_score: 0.9958; val_best_acc_score: 0.9888; val_best_f1_score: 0.9889; train_kl_reg_loss: 5757.6602; train_edge_recon_loss: 254728.0669; train_gene_expr_recon_loss: 10323.6007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270809.3277; train_optim_loss: 270809.3277; val_kl_reg_loss: 5768.1237; val_edge_recon_loss: 253629.5627; val_gene_expr_recon_loss: 10289.8719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269687.5588; val_optim_loss: 269687.5588
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9973; val_auprc_score: 0.9961; val_best_acc_score: 0.9890; val_best_f1_score: 0.9891; train_kl_reg_loss: 5758.5515; train_edge_recon_loss: 254708.9792; train_gene_expr_recon_loss: 10321.3769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270788.9076; train_optim_loss: 270788.9076; val_kl_reg_loss: 5761.8889; val_edge_recon_loss: 253461.0112; val_gene_expr_recon_loss: 10306.6084; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269529.5078; val_optim_loss: 269529.5078
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9973; val_auprc_score: 0.9961; val_best_acc_score: 0.9892; val_best_f1_score: 0.9893; train_kl_reg_loss: 5758.6792; train_edge_recon_loss: 254684.5827; train_gene_expr_recon_loss: 10324.0858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270767.3477; train_optim_loss: 270767.3477; val_kl_reg_loss: 5772.1592; val_edge_recon_loss: 253436.2149; val_gene_expr_recon_loss: 10302.0339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269510.4075; val_optim_loss: 269510.4075
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9973; val_auprc_score: 0.9957; val_best_acc_score: 0.9887; val_best_f1_score: 0.9888; train_kl_reg_loss: 5755.6336; train_edge_recon_loss: 254687.7139; train_gene_expr_recon_loss: 10313.1375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270756.4850; train_optim_loss: 270756.4850; val_kl_reg_loss: 5756.7282; val_edge_recon_loss: 253600.6255; val_gene_expr_recon_loss: 10304.9045; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269662.2579; val_optim_loss: 269662.2579

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9974; val_auprc_score: 0.9960; val_best_acc_score: 0.9896; val_best_f1_score: 0.9897; train_kl_reg_loss: 5756.6346; train_edge_recon_loss: 254674.3106; train_gene_expr_recon_loss: 10314.2685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270745.2139; train_optim_loss: 270745.2139; val_kl_reg_loss: 5758.9545; val_edge_recon_loss: 253493.8740; val_gene_expr_recon_loss: 10293.9495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269546.7774; val_optim_loss: 269546.7774
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9973; val_auprc_score: 0.9957; val_best_acc_score: 0.9893; val_best_f1_score: 0.9893; train_kl_reg_loss: 5759.0365; train_edge_recon_loss: 254687.7085; train_gene_expr_recon_loss: 10306.1707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270752.9155; train_optim_loss: 270752.9155; val_kl_reg_loss: 5759.9448; val_edge_recon_loss: 253529.3444; val_gene_expr_recon_loss: 10301.5458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269590.8349; val_optim_loss: 269590.8349
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9972; val_auprc_score: 0.9958; val_best_acc_score: 0.9888; val_best_f1_score: 0.9889; train_kl_reg_loss: 5756.1042; train_edge_recon_loss: 254624.5038; train_gene_expr_recon_loss: 10313.0958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270693.7037; train_optim_loss: 270693.7037; val_kl_reg_loss: 5760.6189; val_edge_recon_loss: 253471.3060; val_gene_expr_recon_loss: 10297.6768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269529.6018; val_optim_loss: 269529.6018
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9970; val_auprc_score: 0.9956; val_best_acc_score: 0.9891; val_best_f1_score: 0.9892; train_kl_reg_loss: 5757.1814; train_edge_recon_loss: 254669.0085; train_gene_expr_recon_loss: 10303.2055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270729.3956; train_optim_loss: 270729.3956; val_kl_reg_loss: 5764.4192; val_edge_recon_loss: 253574.6811; val_gene_expr_recon_loss: 10307.2022; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269646.3035; val_optim_loss: 269646.3035

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 417 min 24 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
Val AUROC score: 0.9971
Val AUPRC score: 0.9954
Val best accuracy score: 0.9888
Val best F1 score: 0.9888
Val gene expr MSE score: 0.6732

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
