None
Run timestamp: 15072023_182125_1002.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_1002']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9876; val_auprc_score: 0.9856; val_best_acc_score: 0.9484; val_best_f1_score: 0.9492; train_kl_reg_loss: 11744.1516; train_edge_recon_loss: 2646515.8368; train_gene_expr_recon_loss: 1310017.4071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3968277.3993; train_optim_loss: 3968277.3993; val_kl_reg_loss: 11927.2105; val_edge_recon_loss: 2621286.8021; val_gene_expr_recon_loss: 1251545.2355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3884759.2338; val_optim_loss: 3884759.2338
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9904; val_auprc_score: 0.9885; val_best_acc_score: 0.9577; val_best_f1_score: 0.9583; train_kl_reg_loss: 12383.4411; train_edge_recon_loss: 2601716.8465; train_gene_expr_recon_loss: 1237412.6291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3851512.9138; train_optim_loss: 3851512.9138; val_kl_reg_loss: 12329.6064; val_edge_recon_loss: 2609265.6181; val_gene_expr_recon_loss: 1222029.4340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3843624.6678; val_optim_loss: 3843624.6678
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9909; val_auprc_score: 0.9892; val_best_acc_score: 0.9597; val_best_f1_score: 0.9603; train_kl_reg_loss: 12721.1933; train_edge_recon_loss: 2592958.4106; train_gene_expr_recon_loss: 1218972.6034; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3824652.2040; train_optim_loss: 3824652.2040; val_kl_reg_loss: 12544.7398; val_edge_recon_loss: 2604268.7859; val_gene_expr_recon_loss: 1215017.3883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3831830.9132; val_optim_loss: 3831830.9132
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9914; val_auprc_score: 0.9897; val_best_acc_score: 0.9611; val_best_f1_score: 0.9618; train_kl_reg_loss: 12846.6020; train_edge_recon_loss: 2589683.2834; train_gene_expr_recon_loss: 1211578.9449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3814108.8283; train_optim_loss: 3814108.8283; val_kl_reg_loss: 12683.9159; val_edge_recon_loss: 2600670.7604; val_gene_expr_recon_loss: 1208121.8542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3821476.5347; val_optim_loss: 3821476.5347
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9917; val_auprc_score: 0.9899; val_best_acc_score: 0.9622; val_best_f1_score: 0.9628; train_kl_reg_loss: 12925.1162; train_edge_recon_loss: 2586965.7617; train_gene_expr_recon_loss: 1207308.9372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3807199.8185; train_optim_loss: 3807199.8185; val_kl_reg_loss: 12917.5818; val_edge_recon_loss: 2598323.1458; val_gene_expr_recon_loss: 1204839.6655; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3816080.3924; val_optim_loss: 3816080.3924
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9915; val_auprc_score: 0.9896; val_best_acc_score: 0.9632; val_best_f1_score: 0.9638; train_kl_reg_loss: 12937.9954; train_edge_recon_loss: 2585368.6416; train_gene_expr_recon_loss: 1204456.8820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3802763.5180; train_optim_loss: 3802763.5180; val_kl_reg_loss: 12629.5975; val_edge_recon_loss: 2597954.3565; val_gene_expr_recon_loss: 1204274.9705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3814858.9387; val_optim_loss: 3814858.9387
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9920; val_auprc_score: 0.9902; val_best_acc_score: 0.9647; val_best_f1_score: 0.9652; train_kl_reg_loss: 12936.5013; train_edge_recon_loss: 2584025.6064; train_gene_expr_recon_loss: 1203696.7771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3800658.8837; train_optim_loss: 3800658.8837; val_kl_reg_loss: 12831.7345; val_edge_recon_loss: 2594944.7141; val_gene_expr_recon_loss: 1202560.2755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3810336.7106; val_optim_loss: 3810336.7106
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9918; val_auprc_score: 0.9900; val_best_acc_score: 0.9641; val_best_f1_score: 0.9647; train_kl_reg_loss: 12936.3654; train_edge_recon_loss: 2582351.0520; train_gene_expr_recon_loss: 1202585.5641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3797872.9820; train_optim_loss: 3797872.9820; val_kl_reg_loss: 12669.9952; val_edge_recon_loss: 2594566.6539; val_gene_expr_recon_loss: 1202101.5868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3809338.2407; val_optim_loss: 3809338.2407
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9924; val_auprc_score: 0.9907; val_best_acc_score: 0.9656; val_best_f1_score: 0.9662; train_kl_reg_loss: 12927.0434; train_edge_recon_loss: 2581846.1439; train_gene_expr_recon_loss: 1202071.8497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3796845.0373; train_optim_loss: 3796845.0373; val_kl_reg_loss: 12914.3792; val_edge_recon_loss: 2593348.3530; val_gene_expr_recon_loss: 1201798.5631; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3808061.2998; val_optim_loss: 3808061.2998
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9922; val_auprc_score: 0.9902; val_best_acc_score: 0.9657; val_best_f1_score: 0.9662; train_kl_reg_loss: 12901.9670; train_edge_recon_loss: 2580302.4986; train_gene_expr_recon_loss: 1201111.5685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3794316.0338; train_optim_loss: 3794316.0338; val_kl_reg_loss: 12646.6906; val_edge_recon_loss: 2592381.7222; val_gene_expr_recon_loss: 1201951.6568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3806980.0787; val_optim_loss: 3806980.0787
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9926; val_auprc_score: 0.9906; val_best_acc_score: 0.9666; val_best_f1_score: 0.9672; train_kl_reg_loss: 12898.6223; train_edge_recon_loss: 2579485.2364; train_gene_expr_recon_loss: 1200973.1795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3793357.0374; train_optim_loss: 3793357.0374; val_kl_reg_loss: 12680.0392; val_edge_recon_loss: 2592080.9271; val_gene_expr_recon_loss: 1200780.5394; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3805541.4977; val_optim_loss: 3805541.4977
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9929; val_auprc_score: 0.9910; val_best_acc_score: 0.9679; val_best_f1_score: 0.9684; train_kl_reg_loss: 12869.5991; train_edge_recon_loss: 2579393.2362; train_gene_expr_recon_loss: 1200389.5967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3792652.4316; train_optim_loss: 3792652.4316; val_kl_reg_loss: 12736.3793; val_edge_recon_loss: 2587305.7581; val_gene_expr_recon_loss: 1202673.6395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3802715.7708; val_optim_loss: 3802715.7708
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9931; val_auprc_score: 0.9915; val_best_acc_score: 0.9681; val_best_f1_score: 0.9686; train_kl_reg_loss: 12873.5747; train_edge_recon_loss: 2578420.6503; train_gene_expr_recon_loss: 1200182.5328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3791476.7586; train_optim_loss: 3791476.7586; val_kl_reg_loss: 12730.1325; val_edge_recon_loss: 2589980.7106; val_gene_expr_recon_loss: 1201844.0122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3804554.8519; val_optim_loss: 3804554.8519
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9928; val_auprc_score: 0.9909; val_best_acc_score: 0.9681; val_best_f1_score: 0.9685; train_kl_reg_loss: 12833.6708; train_edge_recon_loss: 2577505.5069; train_gene_expr_recon_loss: 1200516.7620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3790855.9425; train_optim_loss: 3790855.9425; val_kl_reg_loss: 12644.1543; val_edge_recon_loss: 2586271.4942; val_gene_expr_recon_loss: 1199879.6777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3798795.3252; val_optim_loss: 3798795.3252
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9931; val_auprc_score: 0.9913; val_best_acc_score: 0.9694; val_best_f1_score: 0.9699; train_kl_reg_loss: 12819.8453; train_edge_recon_loss: 2576734.0593; train_gene_expr_recon_loss: 1199838.3423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3789392.2483; train_optim_loss: 3789392.2483; val_kl_reg_loss: 12615.7484; val_edge_recon_loss: 2588257.8102; val_gene_expr_recon_loss: 1200986.2703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3801859.8426; val_optim_loss: 3801859.8426
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9933; val_auprc_score: 0.9917; val_best_acc_score: 0.9697; val_best_f1_score: 0.9701; train_kl_reg_loss: 12805.4256; train_edge_recon_loss: 2575879.3385; train_gene_expr_recon_loss: 1199599.2060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3788283.9747; train_optim_loss: 3788283.9747; val_kl_reg_loss: 12778.4610; val_edge_recon_loss: 2585226.2836; val_gene_expr_recon_loss: 1202399.5341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3800404.2928; val_optim_loss: 3800404.2928
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9935; val_auprc_score: 0.9919; val_best_acc_score: 0.9699; val_best_f1_score: 0.9703; train_kl_reg_loss: 12773.6179; train_edge_recon_loss: 2575846.3701; train_gene_expr_recon_loss: 1199383.1311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3788003.1161; train_optim_loss: 3788003.1161; val_kl_reg_loss: 12741.0388; val_edge_recon_loss: 2586910.8981; val_gene_expr_recon_loss: 1200367.1337; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3800019.0822; val_optim_loss: 3800019.0822
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9935; val_auprc_score: 0.9920; val_best_acc_score: 0.9699; val_best_f1_score: 0.9704; train_kl_reg_loss: 12743.2812; train_edge_recon_loss: 2575672.2765; train_gene_expr_recon_loss: 1198875.8992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3787291.4545; train_optim_loss: 3787291.4545; val_kl_reg_loss: 12468.8634; val_edge_recon_loss: 2586562.1319; val_gene_expr_recon_loss: 1199150.8536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3798181.8461; val_optim_loss: 3798181.8461
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9935; val_auprc_score: 0.9919; val_best_acc_score: 0.9704; val_best_f1_score: 0.9708; train_kl_reg_loss: 12724.9963; train_edge_recon_loss: 2574293.7785; train_gene_expr_recon_loss: 1198706.1011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3785724.8729; train_optim_loss: 3785724.8729; val_kl_reg_loss: 12546.5901; val_edge_recon_loss: 2585307.5000; val_gene_expr_recon_loss: 1199520.9450; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3797375.0231; val_optim_loss: 3797375.0231
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9933; val_auprc_score: 0.9915; val_best_acc_score: 0.9698; val_best_f1_score: 0.9703; train_kl_reg_loss: 12701.5112; train_edge_recon_loss: 2574458.5664; train_gene_expr_recon_loss: 1198635.3812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3785795.4537; train_optim_loss: 3785795.4537; val_kl_reg_loss: 12926.3727; val_edge_recon_loss: 2585381.1678; val_gene_expr_recon_loss: 1200128.7992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3798436.3333; val_optim_loss: 3798436.3333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9932; val_auprc_score: 0.9913; val_best_acc_score: 0.9700; val_best_f1_score: 0.9704; train_kl_reg_loss: 12683.2008; train_edge_recon_loss: 2574368.9932; train_gene_expr_recon_loss: 1198340.3897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3785392.5851; train_optim_loss: 3785392.5851; val_kl_reg_loss: 12736.9068; val_edge_recon_loss: 2582955.7766; val_gene_expr_recon_loss: 1198676.7980; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3794369.4850; val_optim_loss: 3794369.4850
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9935; val_auprc_score: 0.9916; val_best_acc_score: 0.9709; val_best_f1_score: 0.9713; train_kl_reg_loss: 12653.8971; train_edge_recon_loss: 2573441.1523; train_gene_expr_recon_loss: 1197988.0838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3784083.1312; train_optim_loss: 3784083.1312; val_kl_reg_loss: 12558.8576; val_edge_recon_loss: 2580450.7940; val_gene_expr_recon_loss: 1199478.7251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3792488.3854; val_optim_loss: 3792488.3854
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9936; val_auprc_score: 0.9919; val_best_acc_score: 0.9708; val_best_f1_score: 0.9712; train_kl_reg_loss: 12642.9434; train_edge_recon_loss: 2573045.0143; train_gene_expr_recon_loss: 1198106.4285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3783794.3837; train_optim_loss: 3783794.3837; val_kl_reg_loss: 12570.8056; val_edge_recon_loss: 2580206.2373; val_gene_expr_recon_loss: 1199060.4086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3791837.4468; val_optim_loss: 3791837.4468
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9932; val_auprc_score: 0.9913; val_best_acc_score: 0.9695; val_best_f1_score: 0.9700; train_kl_reg_loss: 12615.7200; train_edge_recon_loss: 2573867.0071; train_gene_expr_recon_loss: 1198219.7588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3784702.4868; train_optim_loss: 3784702.4868; val_kl_reg_loss: 12629.0285; val_edge_recon_loss: 2585216.3762; val_gene_expr_recon_loss: 1199941.1892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3797786.5914; val_optim_loss: 3797786.5914
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9934; val_auprc_score: 0.9915; val_best_acc_score: 0.9711; val_best_f1_score: 0.9715; train_kl_reg_loss: 12604.4593; train_edge_recon_loss: 2572854.9213; train_gene_expr_recon_loss: 1197651.6336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3783111.0159; train_optim_loss: 3783111.0159; val_kl_reg_loss: 12685.3055; val_edge_recon_loss: 2584534.7558; val_gene_expr_recon_loss: 1198545.1944; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3795765.2639; val_optim_loss: 3795765.2639
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9937; val_auprc_score: 0.9919; val_best_acc_score: 0.9714; val_best_f1_score: 0.9719; train_kl_reg_loss: 12581.2881; train_edge_recon_loss: 2571576.3835; train_gene_expr_recon_loss: 1197714.7944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3781872.4659; train_optim_loss: 3781872.4659; val_kl_reg_loss: 12300.6720; val_edge_recon_loss: 2579429.1181; val_gene_expr_recon_loss: 1199977.9439; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3791707.7280; val_optim_loss: 3791707.7280
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9938; val_auprc_score: 0.9921; val_best_acc_score: 0.9723; val_best_f1_score: 0.9727; train_kl_reg_loss: 12563.5729; train_edge_recon_loss: 2572478.0288; train_gene_expr_recon_loss: 1197614.5304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3782656.1340; train_optim_loss: 3782656.1340; val_kl_reg_loss: 12658.8685; val_edge_recon_loss: 2579438.9653; val_gene_expr_recon_loss: 1199962.5723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3792060.4016; val_optim_loss: 3792060.4016
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9933; val_auprc_score: 0.9913; val_best_acc_score: 0.9713; val_best_f1_score: 0.9717; train_kl_reg_loss: 12534.6257; train_edge_recon_loss: 2572115.3863; train_gene_expr_recon_loss: 1197725.5028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3782375.5114; train_optim_loss: 3782375.5114; val_kl_reg_loss: 12543.2695; val_edge_recon_loss: 2581501.4259; val_gene_expr_recon_loss: 1199934.1916; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3793978.8831; val_optim_loss: 3793978.8831
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9933; val_auprc_score: 0.9915; val_best_acc_score: 0.9710; val_best_f1_score: 0.9714; train_kl_reg_loss: 12519.4844; train_edge_recon_loss: 2571160.3176; train_gene_expr_recon_loss: 1197551.0503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3781230.8547; train_optim_loss: 3781230.8547; val_kl_reg_loss: 12254.6800; val_edge_recon_loss: 2583099.9387; val_gene_expr_recon_loss: 1198673.3605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3794027.9826; val_optim_loss: 3794027.9826
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9932; val_auprc_score: 0.9913; val_best_acc_score: 0.9707; val_best_f1_score: 0.9711; train_kl_reg_loss: 12510.3725; train_edge_recon_loss: 2571251.7437; train_gene_expr_recon_loss: 1197800.6391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3781562.7517; train_optim_loss: 3781562.7517; val_kl_reg_loss: 12389.4643; val_edge_recon_loss: 2581597.6019; val_gene_expr_recon_loss: 1200556.7488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3794543.8056; val_optim_loss: 3794543.8056

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9937; val_auprc_score: 0.9918; val_best_acc_score: 0.9726; val_best_f1_score: 0.9730; train_kl_reg_loss: 12582.9721; train_edge_recon_loss: 2567704.5064; train_gene_expr_recon_loss: 1188430.5592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3768718.0431; train_optim_loss: 3768718.0431; val_kl_reg_loss: 12360.1590; val_edge_recon_loss: 2577871.7083; val_gene_expr_recon_loss: 1191139.9207; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3781371.7824; val_optim_loss: 3781371.7824
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9942; val_auprc_score: 0.9925; val_best_acc_score: 0.9733; val_best_f1_score: 0.9736; train_kl_reg_loss: 12349.2559; train_edge_recon_loss: 2569049.4725; train_gene_expr_recon_loss: 1187483.6981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3768882.4222; train_optim_loss: 3768882.4222; val_kl_reg_loss: 12217.7004; val_edge_recon_loss: 2576471.2986; val_gene_expr_recon_loss: 1189613.8206; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3778302.8125; val_optim_loss: 3778302.8125
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9938; val_auprc_score: 0.9920; val_best_acc_score: 0.9724; val_best_f1_score: 0.9728; train_kl_reg_loss: 12254.6454; train_edge_recon_loss: 2567826.3722; train_gene_expr_recon_loss: 1186764.0680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3766845.0827; train_optim_loss: 3766845.0827; val_kl_reg_loss: 12116.7642; val_edge_recon_loss: 2577323.8565; val_gene_expr_recon_loss: 1188574.9902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3778015.6215; val_optim_loss: 3778015.6215
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9940; val_auprc_score: 0.9922; val_best_acc_score: 0.9727; val_best_f1_score: 0.9731; train_kl_reg_loss: 12199.9923; train_edge_recon_loss: 2567661.5076; train_gene_expr_recon_loss: 1186776.7306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3766638.2272; train_optim_loss: 3766638.2272; val_kl_reg_loss: 12128.7905; val_edge_recon_loss: 2576237.2211; val_gene_expr_recon_loss: 1189397.4433; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3777763.4664; val_optim_loss: 3777763.4664
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9938; val_auprc_score: 0.9921; val_best_acc_score: 0.9722; val_best_f1_score: 0.9726; train_kl_reg_loss: 12157.9510; train_edge_recon_loss: 2567352.7320; train_gene_expr_recon_loss: 1186417.8444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3765928.5253; train_optim_loss: 3765928.5253; val_kl_reg_loss: 12063.0892; val_edge_recon_loss: 2579133.6192; val_gene_expr_recon_loss: 1189094.2130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3780290.9144; val_optim_loss: 3780290.9144
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9939; val_auprc_score: 0.9920; val_best_acc_score: 0.9726; val_best_f1_score: 0.9730; train_kl_reg_loss: 12135.4047; train_edge_recon_loss: 2567569.0316; train_gene_expr_recon_loss: 1186209.3707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3765913.8062; train_optim_loss: 3765913.8062; val_kl_reg_loss: 12045.4026; val_edge_recon_loss: 2576515.1678; val_gene_expr_recon_loss: 1189579.1476; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3778139.7188; val_optim_loss: 3778139.7188
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9938; val_auprc_score: 0.9918; val_best_acc_score: 0.9725; val_best_f1_score: 0.9729; train_kl_reg_loss: 12106.4926; train_edge_recon_loss: 2567310.0044; train_gene_expr_recon_loss: 1186241.2407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3765657.7346; train_optim_loss: 3765657.7346; val_kl_reg_loss: 11974.2149; val_edge_recon_loss: 2577582.4734; val_gene_expr_recon_loss: 1188456.2593; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3778012.9479; val_optim_loss: 3778012.9479
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9937; val_auprc_score: 0.9919; val_best_acc_score: 0.9723; val_best_f1_score: 0.9727; train_kl_reg_loss: 12094.3632; train_edge_recon_loss: 2567538.9994; train_gene_expr_recon_loss: 1185827.9926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3765461.3539; train_optim_loss: 3765461.3539; val_kl_reg_loss: 12014.0915; val_edge_recon_loss: 2578150.8866; val_gene_expr_recon_loss: 1188863.7095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3779028.6910; val_optim_loss: 3779028.6910

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9939; val_auprc_score: 0.9920; val_best_acc_score: 0.9731; val_best_f1_score: 0.9734; train_kl_reg_loss: 12114.2469; train_edge_recon_loss: 2567366.4603; train_gene_expr_recon_loss: 1184575.6022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3764056.3101; train_optim_loss: 3764056.3101; val_kl_reg_loss: 12017.6652; val_edge_recon_loss: 2575009.3218; val_gene_expr_recon_loss: 1186862.8519; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3773889.8333; val_optim_loss: 3773889.8333
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9941; val_auprc_score: 0.9923; val_best_acc_score: 0.9730; val_best_f1_score: 0.9733; train_kl_reg_loss: 12111.2703; train_edge_recon_loss: 2567142.5662; train_gene_expr_recon_loss: 1184605.7141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3763859.5523; train_optim_loss: 3763859.5523; val_kl_reg_loss: 12021.7521; val_edge_recon_loss: 2576544.6968; val_gene_expr_recon_loss: 1187158.0747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3775724.5324; val_optim_loss: 3775724.5324
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9939; val_auprc_score: 0.9920; val_best_acc_score: 0.9729; val_best_f1_score: 0.9731; train_kl_reg_loss: 12101.5680; train_edge_recon_loss: 2566420.6400; train_gene_expr_recon_loss: 1184546.4726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3763068.6815; train_optim_loss: 3763068.6815; val_kl_reg_loss: 12031.7845; val_edge_recon_loss: 2577880.8438; val_gene_expr_recon_loss: 1188382.8021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3778295.4329; val_optim_loss: 3778295.4329
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9939; val_auprc_score: 0.9922; val_best_acc_score: 0.9729; val_best_f1_score: 0.9733; train_kl_reg_loss: 12094.9618; train_edge_recon_loss: 2567518.3108; train_gene_expr_recon_loss: 1184421.0345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3764034.3061; train_optim_loss: 3764034.3061; val_kl_reg_loss: 11994.6751; val_edge_recon_loss: 2576901.3299; val_gene_expr_recon_loss: 1188155.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3777051.0336; val_optim_loss: 3777051.0336
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9940; val_auprc_score: 0.9923; val_best_acc_score: 0.9729; val_best_f1_score: 0.9732; train_kl_reg_loss: 12086.2325; train_edge_recon_loss: 2567838.0625; train_gene_expr_recon_loss: 1184653.2207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3764577.5123; train_optim_loss: 3764577.5123; val_kl_reg_loss: 12005.3392; val_edge_recon_loss: 2577128.7280; val_gene_expr_recon_loss: 1186475.7980; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3775609.8646; val_optim_loss: 3775609.8646

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9939; val_auprc_score: 0.9919; val_best_acc_score: 0.9728; val_best_f1_score: 0.9731; train_kl_reg_loss: 12091.8499; train_edge_recon_loss: 2567071.2248; train_gene_expr_recon_loss: 1184158.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3763321.3799; train_optim_loss: 3763321.3799; val_kl_reg_loss: 11997.8978; val_edge_recon_loss: 2578552.8981; val_gene_expr_recon_loss: 1187290.3113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3777841.1019; val_optim_loss: 3777841.1019
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9943; val_auprc_score: 0.9927; val_best_acc_score: 0.9735; val_best_f1_score: 0.9737; train_kl_reg_loss: 12092.0867; train_edge_recon_loss: 2566823.8076; train_gene_expr_recon_loss: 1184223.1660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3763139.0631; train_optim_loss: 3763139.0631; val_kl_reg_loss: 11999.2779; val_edge_recon_loss: 2574828.4039; val_gene_expr_recon_loss: 1186864.6927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3773692.3692; val_optim_loss: 3773692.3692
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9941; val_auprc_score: 0.9923; val_best_acc_score: 0.9732; val_best_f1_score: 0.9735; train_kl_reg_loss: 12089.1881; train_edge_recon_loss: 2567599.2726; train_gene_expr_recon_loss: 1184337.5723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3764026.0337; train_optim_loss: 3764026.0337; val_kl_reg_loss: 12001.8254; val_edge_recon_loss: 2576776.2315; val_gene_expr_recon_loss: 1186862.2326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3775640.2928; val_optim_loss: 3775640.2928
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9939; val_auprc_score: 0.9920; val_best_acc_score: 0.9727; val_best_f1_score: 0.9730; train_kl_reg_loss: 12089.9403; train_edge_recon_loss: 2567377.3315; train_gene_expr_recon_loss: 1183900.4030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3763367.6768; train_optim_loss: 3763367.6768; val_kl_reg_loss: 12007.0191; val_edge_recon_loss: 2577194.7894; val_gene_expr_recon_loss: 1187984.3484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3777186.1597; val_optim_loss: 3777186.1597
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9940; val_auprc_score: 0.9923; val_best_acc_score: 0.9731; val_best_f1_score: 0.9734; train_kl_reg_loss: 12089.9202; train_edge_recon_loss: 2566999.5700; train_gene_expr_recon_loss: 1184050.7759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3763140.2677; train_optim_loss: 3763140.2677; val_kl_reg_loss: 12003.4190; val_edge_recon_loss: 2574692.4433; val_gene_expr_recon_loss: 1187324.3432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3774020.2072; val_optim_loss: 3774020.2072
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9942; val_auprc_score: 0.9925; val_best_acc_score: 0.9734; val_best_f1_score: 0.9737; train_kl_reg_loss: 12086.3596; train_edge_recon_loss: 2567551.8582; train_gene_expr_recon_loss: 1184082.9423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3763721.1587; train_optim_loss: 3763721.1587; val_kl_reg_loss: 12001.0812; val_edge_recon_loss: 2575816.9491; val_gene_expr_recon_loss: 1188213.3368; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3776031.3715; val_optim_loss: 3776031.3715

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9941; val_auprc_score: 0.9923; val_best_acc_score: 0.9726; val_best_f1_score: 0.9730; train_kl_reg_loss: 12087.1632; train_edge_recon_loss: 2567252.1210; train_gene_expr_recon_loss: 1184210.1005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3763549.3805; train_optim_loss: 3763549.3805; val_kl_reg_loss: 11999.9136; val_edge_recon_loss: 2577234.9352; val_gene_expr_recon_loss: 1187498.4178; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3776733.2465; val_optim_loss: 3776733.2465
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9940; val_auprc_score: 0.9921; val_best_acc_score: 0.9730; val_best_f1_score: 0.9734; train_kl_reg_loss: 12085.7718; train_edge_recon_loss: 2567782.2369; train_gene_expr_recon_loss: 1184119.1291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3763987.1331; train_optim_loss: 3763987.1331; val_kl_reg_loss: 11998.0817; val_edge_recon_loss: 2576769.9954; val_gene_expr_recon_loss: 1187236.1730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3776004.2535; val_optim_loss: 3776004.2535
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9940; val_auprc_score: 0.9923; val_best_acc_score: 0.9731; val_best_f1_score: 0.9734; train_kl_reg_loss: 12085.5880; train_edge_recon_loss: 2566969.7171; train_gene_expr_recon_loss: 1184206.9970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3763262.3053; train_optim_loss: 3763262.3053; val_kl_reg_loss: 11997.2457; val_edge_recon_loss: 2575387.4803; val_gene_expr_recon_loss: 1188259.6869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3775644.4201; val_optim_loss: 3775644.4201
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9938; val_auprc_score: 0.9917; val_best_acc_score: 0.9727; val_best_f1_score: 0.9730; train_kl_reg_loss: 12085.2288; train_edge_recon_loss: 2567352.9973; train_gene_expr_recon_loss: 1183957.7495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3763395.9792; train_optim_loss: 3763395.9792; val_kl_reg_loss: 11997.9627; val_edge_recon_loss: 2576888.3796; val_gene_expr_recon_loss: 1186734.1522; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3775620.4954; val_optim_loss: 3775620.4954

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 699 min 10 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
Val AUROC score: 0.9939
Val AUPRC score: 0.9919
Val best accuracy score: 0.9730
Val best F1 score: 0.9732
Val gene expr MSE score: 2.6217

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
