Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9964; val_auprc_score: 0.9954; val_best_acc_score: 0.9790; val_best_f1_score: 0.9792; train_kl_reg_loss: 5796.9833; train_edge_recon_loss: 257469.3205; train_gene_expr_recon_loss: 56830.7172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320097.0208; train_optim_loss: 320097.0208; val_kl_reg_loss: 5790.0131; val_edge_recon_loss: 257127.9825; val_gene_expr_recon_loss: 57242.2888; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320160.2843; val_optim_loss: 320160.2843
None
Run timestamp: 13072023_032425_3.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9825; val_auprc_score: 0.9791; val_best_acc_score: 0.9394; val_best_f1_score: 0.9412; train_kl_reg_loss: 6171.6328; train_edge_recon_loss: 267384.6528; train_gene_expr_recon_loss: 77281.2802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 350837.5659; train_optim_loss: 350837.5659; val_kl_reg_loss: 5931.2585; val_edge_recon_loss: 263556.1688; val_gene_expr_recon_loss: 71242.9351; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 340730.3623; val_optim_loss: 340730.3623
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9963; val_auprc_score: 0.9954; val_best_acc_score: 0.9786; val_best_f1_score: 0.9788; train_kl_reg_loss: 5796.6027; train_edge_recon_loss: 257541.2860; train_gene_expr_recon_loss: 56813.5065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320151.3951; train_optim_loss: 320151.3951; val_kl_reg_loss: 5789.5872; val_edge_recon_loss: 257359.2953; val_gene_expr_recon_loss: 57242.9181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320391.7995; val_optim_loss: 320391.7995
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9884; val_auprc_score: 0.9863; val_best_acc_score: 0.9516; val_best_f1_score: 0.9525; train_kl_reg_loss: 5918.7398; train_edge_recon_loss: 262720.6466; train_gene_expr_recon_loss: 69663.1800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 338302.5658; train_optim_loss: 338302.5658; val_kl_reg_loss: 5787.0287; val_edge_recon_loss: 262909.3219; val_gene_expr_recon_loss: 68582.0573; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 337278.4078; val_optim_loss: 337278.4078
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9963; val_auprc_score: 0.9955; val_best_acc_score: 0.9788; val_best_f1_score: 0.9790; train_kl_reg_loss: 5795.9492; train_edge_recon_loss: 257474.7196; train_gene_expr_recon_loss: 56817.7470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320088.4159; train_optim_loss: 320088.4159; val_kl_reg_loss: 5790.0376; val_edge_recon_loss: 257303.4112; val_gene_expr_recon_loss: 57187.2942; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320280.7426; val_optim_loss: 320280.7426
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9904; val_auprc_score: 0.9887; val_best_acc_score: 0.9577; val_best_f1_score: 0.9584; train_kl_reg_loss: 5862.9561; train_edge_recon_loss: 261798.7852; train_gene_expr_recon_loss: 67802.2248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 335463.9658; train_optim_loss: 335463.9658; val_kl_reg_loss: 5727.0794; val_edge_recon_loss: 261821.9660; val_gene_expr_recon_loss: 67387.7244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334936.7688; val_optim_loss: 334936.7688
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9911; val_auprc_score: 0.9892; val_best_acc_score: 0.9608; val_best_f1_score: 0.9614; train_kl_reg_loss: 5838.2023; train_edge_recon_loss: 261071.6697; train_gene_expr_recon_loss: 66988.4495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333898.3213; train_optim_loss: 333898.3213; val_kl_reg_loss: 5756.3688; val_edge_recon_loss: 261030.2588; val_gene_expr_recon_loss: 66722.3113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333508.9374; val_optim_loss: 333508.9374
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9962; val_auprc_score: 0.9953; val_best_acc_score: 0.9786; val_best_f1_score: 0.9789; train_kl_reg_loss: 5795.9781; train_edge_recon_loss: 257541.5867; train_gene_expr_recon_loss: 56825.0628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320162.6278; train_optim_loss: 320162.6278; val_kl_reg_loss: 5788.3778; val_edge_recon_loss: 257439.5808; val_gene_expr_recon_loss: 57218.8327; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320446.7917; val_optim_loss: 320446.7917
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9917; val_auprc_score: 0.9901; val_best_acc_score: 0.9627; val_best_f1_score: 0.9632; train_kl_reg_loss: 5816.9820; train_edge_recon_loss: 260596.9806; train_gene_expr_recon_loss: 66588.7399; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333002.7024; train_optim_loss: 333002.7024; val_kl_reg_loss: 5804.8829; val_edge_recon_loss: 260823.4125; val_gene_expr_recon_loss: 66365.6860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332993.9825; val_optim_loss: 332993.9825
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9963; val_auprc_score: 0.9955; val_best_acc_score: 0.9787; val_best_f1_score: 0.9789; train_kl_reg_loss: 5794.6947; train_edge_recon_loss: 257530.2649; train_gene_expr_recon_loss: 56808.1176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320133.0773; train_optim_loss: 320133.0773; val_kl_reg_loss: 5786.9671; val_edge_recon_loss: 257323.4556; val_gene_expr_recon_loss: 57199.1876; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320309.6106; val_optim_loss: 320309.6106
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9920; val_auprc_score: 0.9900; val_best_acc_score: 0.9637; val_best_f1_score: 0.9643; train_kl_reg_loss: 5804.7855; train_edge_recon_loss: 260379.1898; train_gene_expr_recon_loss: 66313.8427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332497.8184; train_optim_loss: 332497.8184; val_kl_reg_loss: 5673.7064; val_edge_recon_loss: 260847.5037; val_gene_expr_recon_loss: 66140.4209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332661.6302; val_optim_loss: 332661.6302

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9962; val_auprc_score: 0.9951; val_best_acc_score: 0.9785; val_best_f1_score: 0.9787; train_kl_reg_loss: 5793.7538; train_edge_recon_loss: 257477.2412; train_gene_expr_recon_loss: 56805.7787; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320076.7736; train_optim_loss: 320076.7736; val_kl_reg_loss: 5788.2102; val_edge_recon_loss: 257109.8558; val_gene_expr_recon_loss: 57235.6634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320133.7297; val_optim_loss: 320133.7297
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9925; val_auprc_score: 0.9908; val_best_acc_score: 0.9653; val_best_f1_score: 0.9659; train_kl_reg_loss: 5793.9268; train_edge_recon_loss: 260113.8429; train_gene_expr_recon_loss: 66111.2426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332019.0122; train_optim_loss: 332019.0122; val_kl_reg_loss: 5750.9138; val_edge_recon_loss: 260534.4282; val_gene_expr_recon_loss: 66086.9447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332372.2863; val_optim_loss: 332372.2863
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9925; val_auprc_score: 0.9906; val_best_acc_score: 0.9658; val_best_f1_score: 0.9664; train_kl_reg_loss: 5792.4990; train_edge_recon_loss: 259941.4947; train_gene_expr_recon_loss: 65962.8646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331696.8588; train_optim_loss: 331696.8588; val_kl_reg_loss: 5797.8213; val_edge_recon_loss: 260279.7814; val_gene_expr_recon_loss: 65826.2624; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331903.8646; val_optim_loss: 331903.8646
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9786; val_best_f1_score: 0.9789; train_kl_reg_loss: 5794.0463; train_edge_recon_loss: 257499.4107; train_gene_expr_recon_loss: 56825.5858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320119.0429; train_optim_loss: 320119.0429; val_kl_reg_loss: 5788.2420; val_edge_recon_loss: 257316.4051; val_gene_expr_recon_loss: 57192.7008; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320297.3473; val_optim_loss: 320297.3473
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9932; val_auprc_score: 0.9917; val_best_acc_score: 0.9671; val_best_f1_score: 0.9675; train_kl_reg_loss: 5782.8774; train_edge_recon_loss: 259838.3362; train_gene_expr_recon_loss: 65852.8897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331474.1030; train_optim_loss: 331474.1030; val_kl_reg_loss: 5814.0835; val_edge_recon_loss: 260029.6848; val_gene_expr_recon_loss: 65916.6871; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331760.4556; val_optim_loss: 331760.4556
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9961; val_auprc_score: 0.9950; val_best_acc_score: 0.9785; val_best_f1_score: 0.9787; train_kl_reg_loss: 5793.8708; train_edge_recon_loss: 257480.9692; train_gene_expr_recon_loss: 56828.1401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320102.9802; train_optim_loss: 320102.9802; val_kl_reg_loss: 5791.9849; val_edge_recon_loss: 257394.6473; val_gene_expr_recon_loss: 57186.0369; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320372.6690; val_optim_loss: 320372.6690
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9933; val_auprc_score: 0.9916; val_best_acc_score: 0.9683; val_best_f1_score: 0.9687; train_kl_reg_loss: 5780.9116; train_edge_recon_loss: 259701.9465; train_gene_expr_recon_loss: 65761.0631; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331243.9209; train_optim_loss: 331243.9209; val_kl_reg_loss: 5823.9721; val_edge_recon_loss: 259880.4324; val_gene_expr_recon_loss: 65752.2706; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331456.6743; val_optim_loss: 331456.6743
Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9788; val_best_f1_score: 0.9790; train_kl_reg_loss: 5793.1748; train_edge_recon_loss: 257487.5134; train_gene_expr_recon_loss: 56812.4703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320093.1587; train_optim_loss: 320093.1587; val_kl_reg_loss: 5789.9146; val_edge_recon_loss: 257382.2601; val_gene_expr_recon_loss: 57239.4840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320411.6598; val_optim_loss: 320411.6598
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9937; val_auprc_score: 0.9921; val_best_acc_score: 0.9695; val_best_f1_score: 0.9698; train_kl_reg_loss: 5787.2522; train_edge_recon_loss: 259668.1805; train_gene_expr_recon_loss: 65667.1390; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331122.5719; train_optim_loss: 331122.5719; val_kl_reg_loss: 5822.6950; val_edge_recon_loss: 259718.4667; val_gene_expr_recon_loss: 65679.9692; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331221.1312; val_optim_loss: 331221.1312
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9937; val_auprc_score: 0.9924; val_best_acc_score: 0.9691; val_best_f1_score: 0.9695; train_kl_reg_loss: 5785.1253; train_edge_recon_loss: 259454.9260; train_gene_expr_recon_loss: 65608.2201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330848.2713; train_optim_loss: 330848.2713; val_kl_reg_loss: 5720.7236; val_edge_recon_loss: 259464.0111; val_gene_expr_recon_loss: 65622.4925; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330807.2274; val_optim_loss: 330807.2274
Epoch 64/100 |████████████--------| 64.0% val_auroc_score: 0.9963; val_auprc_score: 0.9955; val_best_acc_score: 0.9787; val_best_f1_score: 0.9788; train_kl_reg_loss: 5794.4427; train_edge_recon_loss: 257548.5517; train_gene_expr_recon_loss: 56812.9609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320155.9552; train_optim_loss: 320155.9552; val_kl_reg_loss: 5789.3840; val_edge_recon_loss: 257285.6243; val_gene_expr_recon_loss: 57204.6493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320279.6571; val_optim_loss: 320279.6571
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9940; val_auprc_score: 0.9926; val_best_acc_score: 0.9702; val_best_f1_score: 0.9706; train_kl_reg_loss: 5784.3328; train_edge_recon_loss: 259370.0462; train_gene_expr_recon_loss: 65570.6468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330725.0257; train_optim_loss: 330725.0257; val_kl_reg_loss: 5821.8718; val_edge_recon_loss: 259603.5524; val_gene_expr_recon_loss: 65557.0711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330982.4948; val_optim_loss: 330982.4948

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 65/100 |█████████████-------| 65.0% val_auroc_score: 0.9963; val_auprc_score: 0.9954; val_best_acc_score: 0.9789; val_best_f1_score: 0.9791; train_kl_reg_loss: 5793.8952; train_edge_recon_loss: 257477.9077; train_gene_expr_recon_loss: 56834.2135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320106.0166; train_optim_loss: 320106.0166; val_kl_reg_loss: 5789.3747; val_edge_recon_loss: 257175.0374; val_gene_expr_recon_loss: 57223.7781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320188.1905; val_optim_loss: 320188.1905
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9942; val_auprc_score: 0.9928; val_best_acc_score: 0.9713; val_best_f1_score: 0.9716; train_kl_reg_loss: 5786.6657; train_edge_recon_loss: 259289.9622; train_gene_expr_recon_loss: 65499.3784; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330576.0063; train_optim_loss: 330576.0063; val_kl_reg_loss: 5717.1995; val_edge_recon_loss: 259352.8194; val_gene_expr_recon_loss: 65636.5393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330706.5589; val_optim_loss: 330706.5589
Epoch 66/100 |█████████████-------| 66.0% val_auroc_score: 0.9962; val_auprc_score: 0.9953; val_best_acc_score: 0.9786; val_best_f1_score: 0.9788; train_kl_reg_loss: 5795.2788; train_edge_recon_loss: 257409.6739; train_gene_expr_recon_loss: 56824.7082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320029.6605; train_optim_loss: 320029.6605; val_kl_reg_loss: 5788.8982; val_edge_recon_loss: 257384.0908; val_gene_expr_recon_loss: 57199.0261; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320372.0157; val_optim_loss: 320372.0157
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9940; val_auprc_score: 0.9924; val_best_acc_score: 0.9711; val_best_f1_score: 0.9714; train_kl_reg_loss: 5786.2224; train_edge_recon_loss: 259188.4475; train_gene_expr_recon_loss: 65458.1299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330432.7999; train_optim_loss: 330432.7999; val_kl_reg_loss: 5646.9713; val_edge_recon_loss: 259431.3257; val_gene_expr_recon_loss: 65642.2470; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330720.5434; val_optim_loss: 330720.5434
Epoch 67/100 |█████████████-------| 67.0% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9784; val_best_f1_score: 0.9787; train_kl_reg_loss: 5794.7556; train_edge_recon_loss: 257542.5376; train_gene_expr_recon_loss: 56828.5772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320165.8702; train_optim_loss: 320165.8702; val_kl_reg_loss: 5788.9458; val_edge_recon_loss: 257327.5092; val_gene_expr_recon_loss: 57237.9575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320354.4123; val_optim_loss: 320354.4123
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9940; val_auprc_score: 0.9924; val_best_acc_score: 0.9713; val_best_f1_score: 0.9717; train_kl_reg_loss: 5791.0989; train_edge_recon_loss: 259141.7111; train_gene_expr_recon_loss: 65421.8108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330354.6210; train_optim_loss: 330354.6210; val_kl_reg_loss: 5756.4485; val_edge_recon_loss: 259279.7982; val_gene_expr_recon_loss: 65385.4535; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330421.6999; val_optim_loss: 330421.6999
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9941; val_auprc_score: 0.9925; val_best_acc_score: 0.9714; val_best_f1_score: 0.9718; train_kl_reg_loss: 5788.6019; train_edge_recon_loss: 259041.2402; train_gene_expr_recon_loss: 65389.6594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330219.5013; train_optim_loss: 330219.5013; val_kl_reg_loss: 5789.1895; val_edge_recon_loss: 259197.3879; val_gene_expr_recon_loss: 65408.4016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330394.9780; val_optim_loss: 330394.9780
Epoch 68/100 |█████████████-------| 68.0% val_auroc_score: 0.9963; val_auprc_score: 0.9954; val_best_acc_score: 0.9787; val_best_f1_score: 0.9789; train_kl_reg_loss: 5793.9630; train_edge_recon_loss: 257523.3471; train_gene_expr_recon_loss: 56815.4486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320132.7587; train_optim_loss: 320132.7587; val_kl_reg_loss: 5786.0358; val_edge_recon_loss: 257303.2839; val_gene_expr_recon_loss: 57187.5861; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320276.9060; val_optim_loss: 320276.9060

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 996 min 50 sec.
Using best model state, which was in epoch 60.

--- MODEL EVALUATION ---
Val AUROC score: 0.9963
Val AUPRC score: 0.9954
Val best accuracy score: 0.9786
Val best F1 score: 0.9788
Val gene expr MSE score: 1.7716

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9943; val_auprc_score: 0.9930; val_best_acc_score: 0.9720; val_best_f1_score: 0.9723; train_kl_reg_loss: 5790.3756; train_edge_recon_loss: 258945.6246; train_gene_expr_recon_loss: 65350.8384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330086.8388; train_optim_loss: 330086.8388; val_kl_reg_loss: 5637.2238; val_edge_recon_loss: 259112.2159; val_gene_expr_recon_loss: 65664.0941; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330413.5352; val_optim_loss: 330413.5352
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9946; val_auprc_score: 0.9933; val_best_acc_score: 0.9731; val_best_f1_score: 0.9734; train_kl_reg_loss: 5790.0066; train_edge_recon_loss: 258931.6192; train_gene_expr_recon_loss: 65339.0961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330060.7217; train_optim_loss: 330060.7217; val_kl_reg_loss: 5811.9809; val_edge_recon_loss: 258923.9216; val_gene_expr_recon_loss: 65473.0728; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330208.9767; val_optim_loss: 330208.9767
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9947; val_auprc_score: 0.9934; val_best_acc_score: 0.9733; val_best_f1_score: 0.9737; train_kl_reg_loss: 5791.7645; train_edge_recon_loss: 258963.4867; train_gene_expr_recon_loss: 65294.5724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330049.8236; train_optim_loss: 330049.8236; val_kl_reg_loss: 5812.0952; val_edge_recon_loss: 259250.0409; val_gene_expr_recon_loss: 65404.8142; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330466.9502; val_optim_loss: 330466.9502
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9946; val_auprc_score: 0.9932; val_best_acc_score: 0.9732; val_best_f1_score: 0.9735; train_kl_reg_loss: 5790.8795; train_edge_recon_loss: 258914.1204; train_gene_expr_recon_loss: 65275.7818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329980.7816; train_optim_loss: 329980.7816; val_kl_reg_loss: 5755.2190; val_edge_recon_loss: 258812.1223; val_gene_expr_recon_loss: 65432.0992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329999.4404; val_optim_loss: 329999.4404
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9946; val_auprc_score: 0.9931; val_best_acc_score: 0.9740; val_best_f1_score: 0.9744; train_kl_reg_loss: 5793.4831; train_edge_recon_loss: 258782.1312; train_gene_expr_recon_loss: 65244.9149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329820.5288; train_optim_loss: 329820.5288; val_kl_reg_loss: 5799.5556; val_edge_recon_loss: 258779.9206; val_gene_expr_recon_loss: 65445.5973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330025.0744; val_optim_loss: 330025.0744
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9943; val_auprc_score: 0.9928; val_best_acc_score: 0.9733; val_best_f1_score: 0.9736; train_kl_reg_loss: 5796.1146; train_edge_recon_loss: 258775.4446; train_gene_expr_recon_loss: 65210.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329781.8472; train_optim_loss: 329781.8472; val_kl_reg_loss: 5800.1801; val_edge_recon_loss: 258710.7909; val_gene_expr_recon_loss: 65393.6168; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329904.5874; val_optim_loss: 329904.5874
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9945; val_auprc_score: 0.9930; val_best_acc_score: 0.9735; val_best_f1_score: 0.9738; train_kl_reg_loss: 5797.4003; train_edge_recon_loss: 258617.2175; train_gene_expr_recon_loss: 65169.2634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329583.8816; train_optim_loss: 329583.8816; val_kl_reg_loss: 5763.2413; val_edge_recon_loss: 258919.7373; val_gene_expr_recon_loss: 65448.9183; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330131.8954; val_optim_loss: 330131.8954
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9942; val_auprc_score: 0.9927; val_best_acc_score: 0.9730; val_best_f1_score: 0.9734; train_kl_reg_loss: 5794.5517; train_edge_recon_loss: 258684.2106; train_gene_expr_recon_loss: 65175.9335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329654.6953; train_optim_loss: 329654.6953; val_kl_reg_loss: 5753.8520; val_edge_recon_loss: 258621.3542; val_gene_expr_recon_loss: 65320.4050; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329695.6130; val_optim_loss: 329695.6130
