Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9964; val_auprc_score: 0.9954; val_best_acc_score: 0.9790; val_best_f1_score: 0.9792; train_kl_reg_loss: 5796.9833; train_edge_recon_loss: 257469.3205; train_gene_expr_recon_loss: 56830.7172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320097.0208; train_optim_loss: 320097.0208; val_kl_reg_loss: 5790.0131; val_edge_recon_loss: 257127.9825; val_gene_expr_recon_loss: 57242.2888; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320160.2843; val_optim_loss: 320160.2843
None
Run timestamp: 13072023_032425_3.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9825; val_auprc_score: 0.9791; val_best_acc_score: 0.9394; val_best_f1_score: 0.9412; train_kl_reg_loss: 6171.6328; train_edge_recon_loss: 267384.6528; train_gene_expr_recon_loss: 77281.2802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 350837.5659; train_optim_loss: 350837.5659; val_kl_reg_loss: 5931.2585; val_edge_recon_loss: 263556.1688; val_gene_expr_recon_loss: 71242.9351; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 340730.3623; val_optim_loss: 340730.3623
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9963; val_auprc_score: 0.9954; val_best_acc_score: 0.9786; val_best_f1_score: 0.9788; train_kl_reg_loss: 5796.6027; train_edge_recon_loss: 257541.2860; train_gene_expr_recon_loss: 56813.5065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320151.3951; train_optim_loss: 320151.3951; val_kl_reg_loss: 5789.5872; val_edge_recon_loss: 257359.2953; val_gene_expr_recon_loss: 57242.9181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320391.7995; val_optim_loss: 320391.7995
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9884; val_auprc_score: 0.9863; val_best_acc_score: 0.9516; val_best_f1_score: 0.9525; train_kl_reg_loss: 5918.7398; train_edge_recon_loss: 262720.6466; train_gene_expr_recon_loss: 69663.1800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 338302.5658; train_optim_loss: 338302.5658; val_kl_reg_loss: 5787.0287; val_edge_recon_loss: 262909.3219; val_gene_expr_recon_loss: 68582.0573; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 337278.4078; val_optim_loss: 337278.4078
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9963; val_auprc_score: 0.9955; val_best_acc_score: 0.9788; val_best_f1_score: 0.9790; train_kl_reg_loss: 5795.9492; train_edge_recon_loss: 257474.7196; train_gene_expr_recon_loss: 56817.7470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320088.4159; train_optim_loss: 320088.4159; val_kl_reg_loss: 5790.0376; val_edge_recon_loss: 257303.4112; val_gene_expr_recon_loss: 57187.2942; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320280.7426; val_optim_loss: 320280.7426
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9904; val_auprc_score: 0.9887; val_best_acc_score: 0.9577; val_best_f1_score: 0.9584; train_kl_reg_loss: 5862.9561; train_edge_recon_loss: 261798.7852; train_gene_expr_recon_loss: 67802.2248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 335463.9658; train_optim_loss: 335463.9658; val_kl_reg_loss: 5727.0794; val_edge_recon_loss: 261821.9660; val_gene_expr_recon_loss: 67387.7244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334936.7688; val_optim_loss: 334936.7688
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9911; val_auprc_score: 0.9892; val_best_acc_score: 0.9608; val_best_f1_score: 0.9614; train_kl_reg_loss: 5838.2023; train_edge_recon_loss: 261071.6697; train_gene_expr_recon_loss: 66988.4495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333898.3213; train_optim_loss: 333898.3213; val_kl_reg_loss: 5756.3688; val_edge_recon_loss: 261030.2588; val_gene_expr_recon_loss: 66722.3113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333508.9374; val_optim_loss: 333508.9374
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9962; val_auprc_score: 0.9953; val_best_acc_score: 0.9786; val_best_f1_score: 0.9789; train_kl_reg_loss: 5795.9781; train_edge_recon_loss: 257541.5867; train_gene_expr_recon_loss: 56825.0628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320162.6278; train_optim_loss: 320162.6278; val_kl_reg_loss: 5788.3778; val_edge_recon_loss: 257439.5808; val_gene_expr_recon_loss: 57218.8327; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320446.7917; val_optim_loss: 320446.7917
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9917; val_auprc_score: 0.9901; val_best_acc_score: 0.9627; val_best_f1_score: 0.9632; train_kl_reg_loss: 5816.9820; train_edge_recon_loss: 260596.9806; train_gene_expr_recon_loss: 66588.7399; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333002.7024; train_optim_loss: 333002.7024; val_kl_reg_loss: 5804.8829; val_edge_recon_loss: 260823.4125; val_gene_expr_recon_loss: 66365.6860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332993.9825; val_optim_loss: 332993.9825
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9963; val_auprc_score: 0.9955; val_best_acc_score: 0.9787; val_best_f1_score: 0.9789; train_kl_reg_loss: 5794.6947; train_edge_recon_loss: 257530.2649; train_gene_expr_recon_loss: 56808.1176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320133.0773; train_optim_loss: 320133.0773; val_kl_reg_loss: 5786.9671; val_edge_recon_loss: 257323.4556; val_gene_expr_recon_loss: 57199.1876; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320309.6106; val_optim_loss: 320309.6106
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9920; val_auprc_score: 0.9900; val_best_acc_score: 0.9637; val_best_f1_score: 0.9643; train_kl_reg_loss: 5804.7855; train_edge_recon_loss: 260379.1898; train_gene_expr_recon_loss: 66313.8427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332497.8184; train_optim_loss: 332497.8184; val_kl_reg_loss: 5673.7064; val_edge_recon_loss: 260847.5037; val_gene_expr_recon_loss: 66140.4209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332661.6302; val_optim_loss: 332661.6302

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9962; val_auprc_score: 0.9951; val_best_acc_score: 0.9785; val_best_f1_score: 0.9787; train_kl_reg_loss: 5793.7538; train_edge_recon_loss: 257477.2412; train_gene_expr_recon_loss: 56805.7787; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320076.7736; train_optim_loss: 320076.7736; val_kl_reg_loss: 5788.2102; val_edge_recon_loss: 257109.8558; val_gene_expr_recon_loss: 57235.6634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320133.7297; val_optim_loss: 320133.7297
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9925; val_auprc_score: 0.9908; val_best_acc_score: 0.9653; val_best_f1_score: 0.9659; train_kl_reg_loss: 5793.9268; train_edge_recon_loss: 260113.8429; train_gene_expr_recon_loss: 66111.2426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332019.0122; train_optim_loss: 332019.0122; val_kl_reg_loss: 5750.9138; val_edge_recon_loss: 260534.4282; val_gene_expr_recon_loss: 66086.9447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332372.2863; val_optim_loss: 332372.2863
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9925; val_auprc_score: 0.9906; val_best_acc_score: 0.9658; val_best_f1_score: 0.9664; train_kl_reg_loss: 5792.4990; train_edge_recon_loss: 259941.4947; train_gene_expr_recon_loss: 65962.8646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331696.8588; train_optim_loss: 331696.8588; val_kl_reg_loss: 5797.8213; val_edge_recon_loss: 260279.7814; val_gene_expr_recon_loss: 65826.2624; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331903.8646; val_optim_loss: 331903.8646
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9786; val_best_f1_score: 0.9789; train_kl_reg_loss: 5794.0463; train_edge_recon_loss: 257499.4107; train_gene_expr_recon_loss: 56825.5858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320119.0429; train_optim_loss: 320119.0429; val_kl_reg_loss: 5788.2420; val_edge_recon_loss: 257316.4051; val_gene_expr_recon_loss: 57192.7008; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320297.3473; val_optim_loss: 320297.3473
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9932; val_auprc_score: 0.9917; val_best_acc_score: 0.9671; val_best_f1_score: 0.9675; train_kl_reg_loss: 5782.8774; train_edge_recon_loss: 259838.3362; train_gene_expr_recon_loss: 65852.8897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331474.1030; train_optim_loss: 331474.1030; val_kl_reg_loss: 5814.0835; val_edge_recon_loss: 260029.6848; val_gene_expr_recon_loss: 65916.6871; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331760.4556; val_optim_loss: 331760.4556
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9961; val_auprc_score: 0.9950; val_best_acc_score: 0.9785; val_best_f1_score: 0.9787; train_kl_reg_loss: 5793.8708; train_edge_recon_loss: 257480.9692; train_gene_expr_recon_loss: 56828.1401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320102.9802; train_optim_loss: 320102.9802; val_kl_reg_loss: 5791.9849; val_edge_recon_loss: 257394.6473; val_gene_expr_recon_loss: 57186.0369; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320372.6690; val_optim_loss: 320372.6690
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9933; val_auprc_score: 0.9916; val_best_acc_score: 0.9683; val_best_f1_score: 0.9687; train_kl_reg_loss: 5780.9116; train_edge_recon_loss: 259701.9465; train_gene_expr_recon_loss: 65761.0631; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331243.9209; train_optim_loss: 331243.9209; val_kl_reg_loss: 5823.9721; val_edge_recon_loss: 259880.4324; val_gene_expr_recon_loss: 65752.2706; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331456.6743; val_optim_loss: 331456.6743
Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9788; val_best_f1_score: 0.9790; train_kl_reg_loss: 5793.1748; train_edge_recon_loss: 257487.5134; train_gene_expr_recon_loss: 56812.4703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320093.1587; train_optim_loss: 320093.1587; val_kl_reg_loss: 5789.9146; val_edge_recon_loss: 257382.2601; val_gene_expr_recon_loss: 57239.4840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320411.6598; val_optim_loss: 320411.6598
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9937; val_auprc_score: 0.9921; val_best_acc_score: 0.9695; val_best_f1_score: 0.9698; train_kl_reg_loss: 5787.2522; train_edge_recon_loss: 259668.1805; train_gene_expr_recon_loss: 65667.1390; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331122.5719; train_optim_loss: 331122.5719; val_kl_reg_loss: 5822.6950; val_edge_recon_loss: 259718.4667; val_gene_expr_recon_loss: 65679.9692; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331221.1312; val_optim_loss: 331221.1312
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9937; val_auprc_score: 0.9924; val_best_acc_score: 0.9691; val_best_f1_score: 0.9695; train_kl_reg_loss: 5785.1253; train_edge_recon_loss: 259454.9260; train_gene_expr_recon_loss: 65608.2201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330848.2713; train_optim_loss: 330848.2713; val_kl_reg_loss: 5720.7236; val_edge_recon_loss: 259464.0111; val_gene_expr_recon_loss: 65622.4925; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330807.2274; val_optim_loss: 330807.2274
Epoch 64/100 |████████████--------| 64.0% val_auroc_score: 0.9963; val_auprc_score: 0.9955; val_best_acc_score: 0.9787; val_best_f1_score: 0.9788; train_kl_reg_loss: 5794.4427; train_edge_recon_loss: 257548.5517; train_gene_expr_recon_loss: 56812.9609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320155.9552; train_optim_loss: 320155.9552; val_kl_reg_loss: 5789.3840; val_edge_recon_loss: 257285.6243; val_gene_expr_recon_loss: 57204.6493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320279.6571; val_optim_loss: 320279.6571
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9940; val_auprc_score: 0.9926; val_best_acc_score: 0.9702; val_best_f1_score: 0.9706; train_kl_reg_loss: 5784.3328; train_edge_recon_loss: 259370.0462; train_gene_expr_recon_loss: 65570.6468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330725.0257; train_optim_loss: 330725.0257; val_kl_reg_loss: 5821.8718; val_edge_recon_loss: 259603.5524; val_gene_expr_recon_loss: 65557.0711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330982.4948; val_optim_loss: 330982.4948

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 65/100 |█████████████-------| 65.0% val_auroc_score: 0.9963; val_auprc_score: 0.9954; val_best_acc_score: 0.9789; val_best_f1_score: 0.9791; train_kl_reg_loss: 5793.8952; train_edge_recon_loss: 257477.9077; train_gene_expr_recon_loss: 56834.2135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320106.0166; train_optim_loss: 320106.0166; val_kl_reg_loss: 5789.3747; val_edge_recon_loss: 257175.0374; val_gene_expr_recon_loss: 57223.7781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320188.1905; val_optim_loss: 320188.1905
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9942; val_auprc_score: 0.9928; val_best_acc_score: 0.9713; val_best_f1_score: 0.9716; train_kl_reg_loss: 5786.6657; train_edge_recon_loss: 259289.9622; train_gene_expr_recon_loss: 65499.3784; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330576.0063; train_optim_loss: 330576.0063; val_kl_reg_loss: 5717.1995; val_edge_recon_loss: 259352.8194; val_gene_expr_recon_loss: 65636.5393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330706.5589; val_optim_loss: 330706.5589
Epoch 66/100 |█████████████-------| 66.0% val_auroc_score: 0.9962; val_auprc_score: 0.9953; val_best_acc_score: 0.9786; val_best_f1_score: 0.9788; train_kl_reg_loss: 5795.2788; train_edge_recon_loss: 257409.6739; train_gene_expr_recon_loss: 56824.7082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320029.6605; train_optim_loss: 320029.6605; val_kl_reg_loss: 5788.8982; val_edge_recon_loss: 257384.0908; val_gene_expr_recon_loss: 57199.0261; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320372.0157; val_optim_loss: 320372.0157
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9940; val_auprc_score: 0.9924; val_best_acc_score: 0.9711; val_best_f1_score: 0.9714; train_kl_reg_loss: 5786.2224; train_edge_recon_loss: 259188.4475; train_gene_expr_recon_loss: 65458.1299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330432.7999; train_optim_loss: 330432.7999; val_kl_reg_loss: 5646.9713; val_edge_recon_loss: 259431.3257; val_gene_expr_recon_loss: 65642.2470; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330720.5434; val_optim_loss: 330720.5434
Epoch 67/100 |█████████████-------| 67.0% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9784; val_best_f1_score: 0.9787; train_kl_reg_loss: 5794.7556; train_edge_recon_loss: 257542.5376; train_gene_expr_recon_loss: 56828.5772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320165.8702; train_optim_loss: 320165.8702; val_kl_reg_loss: 5788.9458; val_edge_recon_loss: 257327.5092; val_gene_expr_recon_loss: 57237.9575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320354.4123; val_optim_loss: 320354.4123
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9940; val_auprc_score: 0.9924; val_best_acc_score: 0.9713; val_best_f1_score: 0.9717; train_kl_reg_loss: 5791.0989; train_edge_recon_loss: 259141.7111; train_gene_expr_recon_loss: 65421.8108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330354.6210; train_optim_loss: 330354.6210; val_kl_reg_loss: 5756.4485; val_edge_recon_loss: 259279.7982; val_gene_expr_recon_loss: 65385.4535; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330421.6999; val_optim_loss: 330421.6999
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9941; val_auprc_score: 0.9925; val_best_acc_score: 0.9714; val_best_f1_score: 0.9718; train_kl_reg_loss: 5788.6019; train_edge_recon_loss: 259041.2402; train_gene_expr_recon_loss: 65389.6594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330219.5013; train_optim_loss: 330219.5013; val_kl_reg_loss: 5789.1895; val_edge_recon_loss: 259197.3879; val_gene_expr_recon_loss: 65408.4016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330394.9780; val_optim_loss: 330394.9780
Epoch 68/100 |█████████████-------| 68.0% val_auroc_score: 0.9963; val_auprc_score: 0.9954; val_best_acc_score: 0.9787; val_best_f1_score: 0.9789; train_kl_reg_loss: 5793.9630; train_edge_recon_loss: 257523.3471; train_gene_expr_recon_loss: 56815.4486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320132.7587; train_optim_loss: 320132.7587; val_kl_reg_loss: 5786.0358; val_edge_recon_loss: 257303.2839; val_gene_expr_recon_loss: 57187.5861; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320276.9060; val_optim_loss: 320276.9060

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 996 min 50 sec.
Using best model state, which was in epoch 60.

--- MODEL EVALUATION ---
Val AUROC score: 0.9963
Val AUPRC score: 0.9954
Val best accuracy score: 0.9786
Val best F1 score: 0.9788
Val gene expr MSE score: 1.7716

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9943; val_auprc_score: 0.9930; val_best_acc_score: 0.9720; val_best_f1_score: 0.9723; train_kl_reg_loss: 5790.3756; train_edge_recon_loss: 258945.6246; train_gene_expr_recon_loss: 65350.8384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330086.8388; train_optim_loss: 330086.8388; val_kl_reg_loss: 5637.2238; val_edge_recon_loss: 259112.2159; val_gene_expr_recon_loss: 65664.0941; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330413.5352; val_optim_loss: 330413.5352
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9946; val_auprc_score: 0.9933; val_best_acc_score: 0.9731; val_best_f1_score: 0.9734; train_kl_reg_loss: 5790.0066; train_edge_recon_loss: 258931.6192; train_gene_expr_recon_loss: 65339.0961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330060.7217; train_optim_loss: 330060.7217; val_kl_reg_loss: 5811.9809; val_edge_recon_loss: 258923.9216; val_gene_expr_recon_loss: 65473.0728; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330208.9767; val_optim_loss: 330208.9767
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9947; val_auprc_score: 0.9934; val_best_acc_score: 0.9733; val_best_f1_score: 0.9737; train_kl_reg_loss: 5791.7645; train_edge_recon_loss: 258963.4867; train_gene_expr_recon_loss: 65294.5724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330049.8236; train_optim_loss: 330049.8236; val_kl_reg_loss: 5812.0952; val_edge_recon_loss: 259250.0409; val_gene_expr_recon_loss: 65404.8142; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330466.9502; val_optim_loss: 330466.9502
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9946; val_auprc_score: 0.9932; val_best_acc_score: 0.9732; val_best_f1_score: 0.9735; train_kl_reg_loss: 5790.8795; train_edge_recon_loss: 258914.1204; train_gene_expr_recon_loss: 65275.7818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329980.7816; train_optim_loss: 329980.7816; val_kl_reg_loss: 5755.2190; val_edge_recon_loss: 258812.1223; val_gene_expr_recon_loss: 65432.0992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329999.4404; val_optim_loss: 329999.4404
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9946; val_auprc_score: 0.9931; val_best_acc_score: 0.9740; val_best_f1_score: 0.9744; train_kl_reg_loss: 5793.4831; train_edge_recon_loss: 258782.1312; train_gene_expr_recon_loss: 65244.9149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329820.5288; train_optim_loss: 329820.5288; val_kl_reg_loss: 5799.5556; val_edge_recon_loss: 258779.9206; val_gene_expr_recon_loss: 65445.5973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330025.0744; val_optim_loss: 330025.0744
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9943; val_auprc_score: 0.9928; val_best_acc_score: 0.9733; val_best_f1_score: 0.9736; train_kl_reg_loss: 5796.1146; train_edge_recon_loss: 258775.4446; train_gene_expr_recon_loss: 65210.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329781.8472; train_optim_loss: 329781.8472; val_kl_reg_loss: 5800.1801; val_edge_recon_loss: 258710.7909; val_gene_expr_recon_loss: 65393.6168; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329904.5874; val_optim_loss: 329904.5874
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9945; val_auprc_score: 0.9930; val_best_acc_score: 0.9735; val_best_f1_score: 0.9738; train_kl_reg_loss: 5797.4003; train_edge_recon_loss: 258617.2175; train_gene_expr_recon_loss: 65169.2634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329583.8816; train_optim_loss: 329583.8816; val_kl_reg_loss: 5763.2413; val_edge_recon_loss: 258919.7373; val_gene_expr_recon_loss: 65448.9183; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330131.8954; val_optim_loss: 330131.8954
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9942; val_auprc_score: 0.9927; val_best_acc_score: 0.9730; val_best_f1_score: 0.9734; train_kl_reg_loss: 5794.5517; train_edge_recon_loss: 258684.2106; train_gene_expr_recon_loss: 65175.9335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329654.6953; train_optim_loss: 329654.6953; val_kl_reg_loss: 5753.8520; val_edge_recon_loss: 258621.3542; val_gene_expr_recon_loss: 65320.4050; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329695.6130; val_optim_loss: 329695.6130
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9946; val_auprc_score: 0.9933; val_best_acc_score: 0.9742; val_best_f1_score: 0.9745; train_kl_reg_loss: 5797.9068; train_edge_recon_loss: 258616.3808; train_gene_expr_recon_loss: 65169.9834; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329584.2712; train_optim_loss: 329584.2712; val_kl_reg_loss: 5784.1625; val_edge_recon_loss: 258717.6356; val_gene_expr_recon_loss: 65533.9444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330035.7431; val_optim_loss: 330035.7431
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9948; val_auprc_score: 0.9935; val_best_acc_score: 0.9744; val_best_f1_score: 0.9747; train_kl_reg_loss: 5799.0537; train_edge_recon_loss: 258590.8505; train_gene_expr_recon_loss: 65133.2468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329523.1512; train_optim_loss: 329523.1512; val_kl_reg_loss: 5825.7120; val_edge_recon_loss: 258619.8411; val_gene_expr_recon_loss: 65512.7701; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329958.3241; val_optim_loss: 329958.3241
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9944; val_auprc_score: 0.9928; val_best_acc_score: 0.9737; val_best_f1_score: 0.9740; train_kl_reg_loss: 5801.6268; train_edge_recon_loss: 258541.6204; train_gene_expr_recon_loss: 65126.3455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329469.5927; train_optim_loss: 329469.5927; val_kl_reg_loss: 5786.0162; val_edge_recon_loss: 258621.3224; val_gene_expr_recon_loss: 65276.1483; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329683.4864; val_optim_loss: 329683.4864
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9947; val_auprc_score: 0.9932; val_best_acc_score: 0.9739; val_best_f1_score: 0.9743; train_kl_reg_loss: 5798.3363; train_edge_recon_loss: 258517.9758; train_gene_expr_recon_loss: 65095.5361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329411.8479; train_optim_loss: 329411.8479; val_kl_reg_loss: 5785.1414; val_edge_recon_loss: 258453.1666; val_gene_expr_recon_loss: 65383.5974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329621.9052; val_optim_loss: 329621.9052
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9946; val_auprc_score: 0.9932; val_best_acc_score: 0.9744; val_best_f1_score: 0.9748; train_kl_reg_loss: 5802.2385; train_edge_recon_loss: 258460.4808; train_gene_expr_recon_loss: 65090.6554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329353.3742; train_optim_loss: 329353.3742; val_kl_reg_loss: 5837.7165; val_edge_recon_loss: 258261.2801; val_gene_expr_recon_loss: 65557.3919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329656.3882; val_optim_loss: 329656.3882
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9944; val_auprc_score: 0.9927; val_best_acc_score: 0.9747; val_best_f1_score: 0.9749; train_kl_reg_loss: 5801.5031; train_edge_recon_loss: 258395.8700; train_gene_expr_recon_loss: 65070.7689; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329268.1427; train_optim_loss: 329268.1427; val_kl_reg_loss: 5806.3323; val_edge_recon_loss: 258692.2914; val_gene_expr_recon_loss: 65543.6657; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330042.2886; val_optim_loss: 330042.2886
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9948; val_auprc_score: 0.9933; val_best_acc_score: 0.9749; val_best_f1_score: 0.9752; train_kl_reg_loss: 5804.7227; train_edge_recon_loss: 258355.9436; train_gene_expr_recon_loss: 65051.1597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329211.8259; train_optim_loss: 329211.8259; val_kl_reg_loss: 5781.2605; val_edge_recon_loss: 258212.7607; val_gene_expr_recon_loss: 65639.4672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329633.4896; val_optim_loss: 329633.4896
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9946; val_auprc_score: 0.9931; val_best_acc_score: 0.9746; val_best_f1_score: 0.9750; train_kl_reg_loss: 5801.9162; train_edge_recon_loss: 258450.9190; train_gene_expr_recon_loss: 65027.5869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329280.4222; train_optim_loss: 329280.4222; val_kl_reg_loss: 5770.8920; val_edge_recon_loss: 258551.5514; val_gene_expr_recon_loss: 65030.3083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329352.7525; val_optim_loss: 329352.7525
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9947; val_auprc_score: 0.9931; val_best_acc_score: 0.9747; val_best_f1_score: 0.9750; train_kl_reg_loss: 5806.1319; train_edge_recon_loss: 258347.3896; train_gene_expr_recon_loss: 64958.6324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329112.1539; train_optim_loss: 329112.1539; val_kl_reg_loss: 5804.8734; val_edge_recon_loss: 258492.1912; val_gene_expr_recon_loss: 64554.5136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328851.5774; val_optim_loss: 328851.5774
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9950; val_auprc_score: 0.9937; val_best_acc_score: 0.9758; val_best_f1_score: 0.9761; train_kl_reg_loss: 5802.3256; train_edge_recon_loss: 258390.8188; train_gene_expr_recon_loss: 64883.2334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329076.3778; train_optim_loss: 329076.3778; val_kl_reg_loss: 5787.5910; val_edge_recon_loss: 258451.1239; val_gene_expr_recon_loss: 65406.5805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329645.2951; val_optim_loss: 329645.2951
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9944; val_auprc_score: 0.9928; val_best_acc_score: 0.9744; val_best_f1_score: 0.9747; train_kl_reg_loss: 5804.7877; train_edge_recon_loss: 258369.1470; train_gene_expr_recon_loss: 64779.1431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328953.0774; train_optim_loss: 328953.0774; val_kl_reg_loss: 5780.7623; val_edge_recon_loss: 258469.2691; val_gene_expr_recon_loss: 64585.6517; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328835.6823; val_optim_loss: 328835.6823
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9944; val_auprc_score: 0.9925; val_best_acc_score: 0.9749; val_best_f1_score: 0.9752; train_kl_reg_loss: 5809.0596; train_edge_recon_loss: 258235.4043; train_gene_expr_recon_loss: 64605.7138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328650.1769; train_optim_loss: 328650.1769; val_kl_reg_loss: 5802.1632; val_edge_recon_loss: 258324.4124; val_gene_expr_recon_loss: 62779.0448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326905.6199; val_optim_loss: 326905.6199
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9945; val_auprc_score: 0.9928; val_best_acc_score: 0.9744; val_best_f1_score: 0.9747; train_kl_reg_loss: 5803.9234; train_edge_recon_loss: 258326.8016; train_gene_expr_recon_loss: 64553.3851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328684.1106; train_optim_loss: 328684.1106; val_kl_reg_loss: 5814.4959; val_edge_recon_loss: 258416.0658; val_gene_expr_recon_loss: 64428.6216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328659.1833; val_optim_loss: 328659.1833
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9949; val_auprc_score: 0.9935; val_best_acc_score: 0.9756; val_best_f1_score: 0.9759; train_kl_reg_loss: 5808.7056; train_edge_recon_loss: 258275.7622; train_gene_expr_recon_loss: 64668.0753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328752.5430; train_optim_loss: 328752.5430; val_kl_reg_loss: 5819.2090; val_edge_recon_loss: 258103.6393; val_gene_expr_recon_loss: 65889.9101; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329812.7588; val_optim_loss: 329812.7588
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9949; val_auprc_score: 0.9932; val_best_acc_score: 0.9757; val_best_f1_score: 0.9760; train_kl_reg_loss: 5807.3605; train_edge_recon_loss: 258278.1465; train_gene_expr_recon_loss: 64964.1222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329049.6293; train_optim_loss: 329049.6293; val_kl_reg_loss: 5811.2541; val_edge_recon_loss: 258291.6835; val_gene_expr_recon_loss: 67304.5705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331407.5090; val_optim_loss: 331407.5090
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9949; val_auprc_score: 0.9933; val_best_acc_score: 0.9761; val_best_f1_score: 0.9764; train_kl_reg_loss: 5808.9212; train_edge_recon_loss: 258255.3066; train_gene_expr_recon_loss: 65473.2168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329537.4448; train_optim_loss: 329537.4448; val_kl_reg_loss: 5780.0321; val_edge_recon_loss: 257946.0566; val_gene_expr_recon_loss: 62608.2717; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326334.3613; val_optim_loss: 326334.3613
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9946; val_auprc_score: 0.9931; val_best_acc_score: 0.9747; val_best_f1_score: 0.9750; train_kl_reg_loss: 5809.3275; train_edge_recon_loss: 258190.3326; train_gene_expr_recon_loss: 65542.6253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329542.2855; train_optim_loss: 329542.2855; val_kl_reg_loss: 5840.4285; val_edge_recon_loss: 258226.3456; val_gene_expr_recon_loss: 70302.0824; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334368.8572; val_optim_loss: 334368.8572
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9950; val_auprc_score: 0.9935; val_best_acc_score: 0.9762; val_best_f1_score: 0.9764; train_kl_reg_loss: 5808.4815; train_edge_recon_loss: 258181.5250; train_gene_expr_recon_loss: 65878.8815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329868.8882; train_optim_loss: 329868.8882; val_kl_reg_loss: 5785.1395; val_edge_recon_loss: 258072.1535; val_gene_expr_recon_loss: 67712.9668; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331570.2600; val_optim_loss: 331570.2600
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9947; val_auprc_score: 0.9930; val_best_acc_score: 0.9758; val_best_f1_score: 0.9761; train_kl_reg_loss: 5810.1704; train_edge_recon_loss: 258192.6002; train_gene_expr_recon_loss: 65839.7914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329842.5616; train_optim_loss: 329842.5616; val_kl_reg_loss: 5818.3086; val_edge_recon_loss: 258072.4438; val_gene_expr_recon_loss: 66893.1674; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330783.9191; val_optim_loss: 330783.9191
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9948; val_auprc_score: 0.9932; val_best_acc_score: 0.9755; val_best_f1_score: 0.9758; train_kl_reg_loss: 5811.2542; train_edge_recon_loss: 258137.9308; train_gene_expr_recon_loss: 66248.5655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330197.7503; train_optim_loss: 330197.7503; val_kl_reg_loss: 5793.3589; val_edge_recon_loss: 258348.6225; val_gene_expr_recon_loss: 45905.7689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 310047.7519; val_optim_loss: 310047.7519
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9948; val_auprc_score: 0.9932; val_best_acc_score: 0.9754; val_best_f1_score: 0.9757; train_kl_reg_loss: 5810.6066; train_edge_recon_loss: 258150.6219; train_gene_expr_recon_loss: 66118.7024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330079.9309; train_optim_loss: 330079.9309; val_kl_reg_loss: 5809.3406; val_edge_recon_loss: 257918.7586; val_gene_expr_recon_loss: 67629.1614; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331357.2593; val_optim_loss: 331357.2593
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9947; val_auprc_score: 0.9932; val_best_acc_score: 0.9758; val_best_f1_score: 0.9761; train_kl_reg_loss: 5809.0730; train_edge_recon_loss: 258138.1923; train_gene_expr_recon_loss: 66045.5815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329992.8464; train_optim_loss: 329992.8464; val_kl_reg_loss: 5767.1878; val_edge_recon_loss: 257979.0679; val_gene_expr_recon_loss: 71552.5882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335298.8438; val_optim_loss: 335298.8438
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9948; val_auprc_score: 0.9932; val_best_acc_score: 0.9762; val_best_f1_score: 0.9765; train_kl_reg_loss: 5812.4013; train_edge_recon_loss: 258086.3621; train_gene_expr_recon_loss: 65068.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328966.8544; train_optim_loss: 328966.8544; val_kl_reg_loss: 5814.1449; val_edge_recon_loss: 257935.6316; val_gene_expr_recon_loss: 87709.0230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 351458.7992; val_optim_loss: 351458.7992
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9949; val_auprc_score: 0.9935; val_best_acc_score: 0.9758; val_best_f1_score: 0.9761; train_kl_reg_loss: 5812.5481; train_edge_recon_loss: 258103.2455; train_gene_expr_recon_loss: 67248.7720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331164.5656; train_optim_loss: 331164.5656; val_kl_reg_loss: 5765.7625; val_edge_recon_loss: 258225.8115; val_gene_expr_recon_loss: 60829.0723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 324820.6453; val_optim_loss: 324820.6453

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9950; val_auprc_score: 0.9934; val_best_acc_score: 0.9766; val_best_f1_score: 0.9769; train_kl_reg_loss: 5803.1354; train_edge_recon_loss: 257924.0285; train_gene_expr_recon_loss: 72127.7075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 335854.8715; train_optim_loss: 335854.8715; val_kl_reg_loss: 5807.6255; val_edge_recon_loss: 257861.5864; val_gene_expr_recon_loss: 65445.6650; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329114.8776; val_optim_loss: 329114.8776
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9953; val_auprc_score: 0.9941; val_best_acc_score: 0.9774; val_best_f1_score: 0.9777; train_kl_reg_loss: 5807.5588; train_edge_recon_loss: 257900.2233; train_gene_expr_recon_loss: 73098.4057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 336806.1881; train_optim_loss: 336806.1881; val_kl_reg_loss: 5808.6013; val_edge_recon_loss: 257652.0258; val_gene_expr_recon_loss: 86871.1691; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 350331.7964; val_optim_loss: 350331.7964
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9953; val_auprc_score: 0.9937; val_best_acc_score: 0.9774; val_best_f1_score: 0.9777; train_kl_reg_loss: 5805.9474; train_edge_recon_loss: 257824.5724; train_gene_expr_recon_loss: 78299.1528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 341929.6727; train_optim_loss: 341929.6727; val_kl_reg_loss: 5804.5443; val_edge_recon_loss: 257693.7301; val_gene_expr_recon_loss: 84972.2672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 348470.5414; val_optim_loss: 348470.5414
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9952; val_auprc_score: 0.9936; val_best_acc_score: 0.9773; val_best_f1_score: 0.9775; train_kl_reg_loss: 5802.4232; train_edge_recon_loss: 257885.8408; train_gene_expr_recon_loss: 71545.6204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 335233.8843; train_optim_loss: 335233.8843; val_kl_reg_loss: 5807.1789; val_edge_recon_loss: 257718.2687; val_gene_expr_recon_loss: 79942.9663; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 343468.4139; val_optim_loss: 343468.4139

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 832 min 58 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
Val AUROC score: 0.9949
Val AUPRC score: 0.9933
Val best accuracy score: 0.9761
Val best F1 score: 0.9764
Val gene expr MSE score: 1.7911

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
