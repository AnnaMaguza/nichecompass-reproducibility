None
Run timestamp: 20072023_093816_3.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '2', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9540; val_auprc_score: 0.9456; val_best_acc_score: 0.8902; val_best_f1_score: 0.8957; train_kl_reg_loss: 43461.9550; train_edge_recon_loss: 26792380.1389; train_gene_expr_recon_loss: 7331684.9023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34167526.9630; train_optim_loss: 34167526.9630; val_kl_reg_loss: 40614.6792; val_edge_recon_loss: 26715780.4907; val_gene_expr_recon_loss: 6767011.8495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33523407.0185; val_optim_loss: 33523407.0185
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9695; val_auprc_score: 0.9647; val_best_acc_score: 0.9120; val_best_f1_score: 0.9148; train_kl_reg_loss: 38113.3459; train_edge_recon_loss: 26237136.0000; train_gene_expr_recon_loss: 6597261.5841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32872510.9177; train_optim_loss: 32872510.9177; val_kl_reg_loss: 35237.2058; val_edge_recon_loss: 26553852.5833; val_gene_expr_recon_loss: 6469515.8935; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33058605.6759; val_optim_loss: 33058605.6759
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9747; val_auprc_score: 0.9712; val_best_acc_score: 0.9198; val_best_f1_score: 0.9220; train_kl_reg_loss: 35243.3487; train_edge_recon_loss: 26119200.0442; train_gene_expr_recon_loss: 6389283.6605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32543727.0195; train_optim_loss: 32543727.0195; val_kl_reg_loss: 34468.5273; val_edge_recon_loss: 26498721.2870; val_gene_expr_recon_loss: 6342107.7130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32875297.5648; val_optim_loss: 32875297.5648
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9776; val_auprc_score: 0.9745; val_best_acc_score: 0.9268; val_best_f1_score: 0.9287; train_kl_reg_loss: 34545.3064; train_edge_recon_loss: 26066267.6831; train_gene_expr_recon_loss: 6289155.4668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32389968.4558; train_optim_loss: 32389968.4558; val_kl_reg_loss: 33394.6770; val_edge_recon_loss: 26434365.6944; val_gene_expr_recon_loss: 6254786.5486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32722547.0463; val_optim_loss: 32722547.0463
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9783; val_auprc_score: 0.9749; val_best_acc_score: 0.9277; val_best_f1_score: 0.9296; train_kl_reg_loss: 34436.2053; train_edge_recon_loss: 26040324.6780; train_gene_expr_recon_loss: 6228796.6885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32303557.5586; train_optim_loss: 32303557.5586; val_kl_reg_loss: 33833.4972; val_edge_recon_loss: 26412831.3426; val_gene_expr_recon_loss: 6230310.9306; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32676975.8333; val_optim_loss: 32676975.8333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9789; val_auprc_score: 0.9759; val_best_acc_score: 0.9293; val_best_f1_score: 0.9311; train_kl_reg_loss: 34443.0041; train_edge_recon_loss: 26011987.5844; train_gene_expr_recon_loss: 6191094.1242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32237524.6883; train_optim_loss: 32237524.6883; val_kl_reg_loss: 34232.8898; val_edge_recon_loss: 26371308.4630; val_gene_expr_recon_loss: 6189086.7662; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32594628.0833; val_optim_loss: 32594628.0833
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9804; val_auprc_score: 0.9777; val_best_acc_score: 0.9318; val_best_f1_score: 0.9334; train_kl_reg_loss: 34271.5848; train_edge_recon_loss: 25986757.7510; train_gene_expr_recon_loss: 6167445.5885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32188474.9012; train_optim_loss: 32188474.9012; val_kl_reg_loss: 32961.8196; val_edge_recon_loss: 26386456.8889; val_gene_expr_recon_loss: 6171241.3102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32590660.0463; val_optim_loss: 32590660.0463
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9808; val_auprc_score: 0.9779; val_best_acc_score: 0.9334; val_best_f1_score: 0.9350; train_kl_reg_loss: 34020.6128; train_edge_recon_loss: 25973580.9702; train_gene_expr_recon_loss: 6148530.2456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32156131.8313; train_optim_loss: 32156131.8313; val_kl_reg_loss: 33175.0329; val_edge_recon_loss: 26368874.3981; val_gene_expr_recon_loss: 6149455.1412; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32551504.6574; val_optim_loss: 32551504.6574
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9821; val_auprc_score: 0.9796; val_best_acc_score: 0.9362; val_best_f1_score: 0.9377; train_kl_reg_loss: 34343.7918; train_edge_recon_loss: 25948277.5895; train_gene_expr_recon_loss: 6136645.6299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32119267.0154; train_optim_loss: 32119267.0154; val_kl_reg_loss: 32438.8294; val_edge_recon_loss: 26364741.8426; val_gene_expr_recon_loss: 6143521.3588; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32540701.9352; val_optim_loss: 32540701.9352
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9827; val_auprc_score: 0.9800; val_best_acc_score: 0.9370; val_best_f1_score: 0.9387; train_kl_reg_loss: 34338.4136; train_edge_recon_loss: 25953308.2233; train_gene_expr_recon_loss: 6121042.0059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32108688.6409; train_optim_loss: 32108688.6409; val_kl_reg_loss: 33324.7123; val_edge_recon_loss: 26328974.3611; val_gene_expr_recon_loss: 6132112.7662; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32494411.9167; val_optim_loss: 32494411.9167
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9822; val_auprc_score: 0.9797; val_best_acc_score: 0.9367; val_best_f1_score: 0.9381; train_kl_reg_loss: 34302.7629; train_edge_recon_loss: 25946477.0689; train_gene_expr_recon_loss: 6109355.2945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32090135.1564; train_optim_loss: 32090135.1564; val_kl_reg_loss: 34041.6786; val_edge_recon_loss: 26329036.7130; val_gene_expr_recon_loss: 6122936.6343; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32486014.9815; val_optim_loss: 32486014.9815
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9827; val_auprc_score: 0.9800; val_best_acc_score: 0.9377; val_best_f1_score: 0.9393; train_kl_reg_loss: 34239.2288; train_edge_recon_loss: 25929218.2716; train_gene_expr_recon_loss: 6112912.3524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32076369.8519; train_optim_loss: 32076369.8519; val_kl_reg_loss: 32400.0375; val_edge_recon_loss: 26364122.2037; val_gene_expr_recon_loss: 6130946.8241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32527469.0833; val_optim_loss: 32527469.0833
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9831; val_auprc_score: 0.9804; val_best_acc_score: 0.9397; val_best_f1_score: 0.9411; train_kl_reg_loss: 34277.3610; train_edge_recon_loss: 25916742.3066; train_gene_expr_recon_loss: 6102291.6021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32053311.2366; train_optim_loss: 32053311.2366; val_kl_reg_loss: 32716.3914; val_edge_recon_loss: 26325662.7500; val_gene_expr_recon_loss: 6112061.4398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32470440.6667; val_optim_loss: 32470440.6667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9835; val_auprc_score: 0.9811; val_best_acc_score: 0.9387; val_best_f1_score: 0.9399; train_kl_reg_loss: 34145.8849; train_edge_recon_loss: 25899093.6317; train_gene_expr_recon_loss: 6094068.7377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32027308.2562; train_optim_loss: 32027308.2562; val_kl_reg_loss: 33182.0238; val_edge_recon_loss: 26324448.9537; val_gene_expr_recon_loss: 6106301.5278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32463932.5463; val_optim_loss: 32463932.5463
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9835; val_auprc_score: 0.9810; val_best_acc_score: 0.9402; val_best_f1_score: 0.9414; train_kl_reg_loss: 34249.5681; train_edge_recon_loss: 25897627.3220; train_gene_expr_recon_loss: 6088954.7801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32020831.6667; train_optim_loss: 32020831.6667; val_kl_reg_loss: 33178.8874; val_edge_recon_loss: 26305926.4537; val_gene_expr_recon_loss: 6090505.4884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32429610.8704; val_optim_loss: 32429610.8704
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9836; val_auprc_score: 0.9808; val_best_acc_score: 0.9405; val_best_f1_score: 0.9419; train_kl_reg_loss: 34464.5357; train_edge_recon_loss: 25889592.0288; train_gene_expr_recon_loss: 6085700.6939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32009757.2356; train_optim_loss: 32009757.2356; val_kl_reg_loss: 33434.9898; val_edge_recon_loss: 26326487.2593; val_gene_expr_recon_loss: 6119928.4977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32479850.7593; val_optim_loss: 32479850.7593
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9848; val_auprc_score: 0.9827; val_best_acc_score: 0.9425; val_best_f1_score: 0.9436; train_kl_reg_loss: 34360.3394; train_edge_recon_loss: 25896107.6800; train_gene_expr_recon_loss: 6081362.6893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32011830.7171; train_optim_loss: 32011830.7171; val_kl_reg_loss: 33133.7158; val_edge_recon_loss: 26313464.2685; val_gene_expr_recon_loss: 6096150.5046; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32442748.4259; val_optim_loss: 32442748.4259
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9840; val_auprc_score: 0.9811; val_best_acc_score: 0.9418; val_best_f1_score: 0.9430; train_kl_reg_loss: 34278.0974; train_edge_recon_loss: 25892088.9979; train_gene_expr_recon_loss: 6073755.1129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32000122.1862; train_optim_loss: 32000122.1862; val_kl_reg_loss: 34107.2608; val_edge_recon_loss: 26301984.8519; val_gene_expr_recon_loss: 6100385.4514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32436477.5556; val_optim_loss: 32436477.5556
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9841; val_auprc_score: 0.9810; val_best_acc_score: 0.9418; val_best_f1_score: 0.9429; train_kl_reg_loss: 34739.9771; train_edge_recon_loss: 25873713.9907; train_gene_expr_recon_loss: 6073750.5170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31982204.4877; train_optim_loss: 31982204.4877; val_kl_reg_loss: 33846.1953; val_edge_recon_loss: 26313581.6019; val_gene_expr_recon_loss: 6095997.5949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32443425.2870; val_optim_loss: 32443425.2870

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9850; val_auprc_score: 0.9827; val_best_acc_score: 0.9436; val_best_f1_score: 0.9448; train_kl_reg_loss: 36144.8970; train_edge_recon_loss: 25862682.9053; train_gene_expr_recon_loss: 6001296.8081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31900124.6163; train_optim_loss: 31900124.6163; val_kl_reg_loss: 35460.8569; val_edge_recon_loss: 26268385.4167; val_gene_expr_recon_loss: 6013131.6713; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32316977.9537; val_optim_loss: 32316977.9537
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9850; val_auprc_score: 0.9825; val_best_acc_score: 0.9437; val_best_f1_score: 0.9447; train_kl_reg_loss: 36898.6842; train_edge_recon_loss: 25853022.3333; train_gene_expr_recon_loss: 5986859.3410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31876780.3395; train_optim_loss: 31876780.3395; val_kl_reg_loss: 36290.8224; val_edge_recon_loss: 26263233.0833; val_gene_expr_recon_loss: 6007386.3565; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32306910.2315; val_optim_loss: 32306910.2315
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9849; val_auprc_score: 0.9823; val_best_acc_score: 0.9440; val_best_f1_score: 0.9450; train_kl_reg_loss: 37183.5514; train_edge_recon_loss: 25852703.7366; train_gene_expr_recon_loss: 5985186.2073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31875073.4938; train_optim_loss: 31875073.4938; val_kl_reg_loss: 36346.7645; val_edge_recon_loss: 26255035.2778; val_gene_expr_recon_loss: 6002031.5903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32293413.6481; val_optim_loss: 32293413.6481
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9850; val_auprc_score: 0.9824; val_best_acc_score: 0.9443; val_best_f1_score: 0.9453; train_kl_reg_loss: 37310.8657; train_edge_recon_loss: 25855619.5854; train_gene_expr_recon_loss: 5985655.7351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31878586.2119; train_optim_loss: 31878586.2119; val_kl_reg_loss: 36671.6056; val_edge_recon_loss: 26254450.4259; val_gene_expr_recon_loss: 6004397.6736; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32295519.6852; val_optim_loss: 32295519.6852
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9855; val_auprc_score: 0.9829; val_best_acc_score: 0.9451; val_best_f1_score: 0.9461; train_kl_reg_loss: 37445.8500; train_edge_recon_loss: 25848778.2840; train_gene_expr_recon_loss: 5979267.8413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31865491.9856; train_optim_loss: 31865491.9856; val_kl_reg_loss: 36718.2345; val_edge_recon_loss: 26235179.0463; val_gene_expr_recon_loss: 5998169.7222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32270066.9259; val_optim_loss: 32270066.9259
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9850; val_auprc_score: 0.9823; val_best_acc_score: 0.9442; val_best_f1_score: 0.9454; train_kl_reg_loss: 37493.4529; train_edge_recon_loss: 25853019.5772; train_gene_expr_recon_loss: 5980387.4090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31870900.4486; train_optim_loss: 31870900.4486; val_kl_reg_loss: 36526.2997; val_edge_recon_loss: 26255781.3981; val_gene_expr_recon_loss: 5995026.3287; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32287334.0556; val_optim_loss: 32287334.0556
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9856; val_auprc_score: 0.9833; val_best_acc_score: 0.9449; val_best_f1_score: 0.9459; train_kl_reg_loss: 37614.0869; train_edge_recon_loss: 25844359.6152; train_gene_expr_recon_loss: 5977550.6384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31859524.3539; train_optim_loss: 31859524.3539; val_kl_reg_loss: 36529.9267; val_edge_recon_loss: 26257265.7037; val_gene_expr_recon_loss: 5998243.0023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32292038.5926; val_optim_loss: 32292038.5926
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9854; val_auprc_score: 0.9828; val_best_acc_score: 0.9443; val_best_f1_score: 0.9453; train_kl_reg_loss: 37303.8649; train_edge_recon_loss: 25852045.6193; train_gene_expr_recon_loss: 5975056.4470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31864405.9527; train_optim_loss: 31864405.9527; val_kl_reg_loss: 36510.9758; val_edge_recon_loss: 26264232.7870; val_gene_expr_recon_loss: 6008735.8565; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32309479.6111; val_optim_loss: 32309479.6111
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9855; val_auprc_score: 0.9829; val_best_acc_score: 0.9448; val_best_f1_score: 0.9457; train_kl_reg_loss: 37206.6175; train_edge_recon_loss: 25850043.8693; train_gene_expr_recon_loss: 5979071.4923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31866321.9784; train_optim_loss: 31866321.9784; val_kl_reg_loss: 36536.3640; val_edge_recon_loss: 26238505.9630; val_gene_expr_recon_loss: 5999060.1991; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32274102.5926; val_optim_loss: 32274102.5926

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9857; val_auprc_score: 0.9834; val_best_acc_score: 0.9450; val_best_f1_score: 0.9461; train_kl_reg_loss: 37354.9155; train_edge_recon_loss: 25844435.4300; train_gene_expr_recon_loss: 5968366.7328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31850157.0988; train_optim_loss: 31850157.0988; val_kl_reg_loss: 36535.5063; val_edge_recon_loss: 26242865.8981; val_gene_expr_recon_loss: 5992909.2824; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32272310.5833; val_optim_loss: 32272310.5833
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9858; val_auprc_score: 0.9836; val_best_acc_score: 0.9455; val_best_f1_score: 0.9464; train_kl_reg_loss: 37391.8043; train_edge_recon_loss: 25851329.4228; train_gene_expr_recon_loss: 5964595.9388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31853317.1718; train_optim_loss: 31853317.1718; val_kl_reg_loss: 36557.1967; val_edge_recon_loss: 26241119.2778; val_gene_expr_recon_loss: 5994156.8634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32271833.2963; val_optim_loss: 32271833.2963
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9852; val_auprc_score: 0.9827; val_best_acc_score: 0.9439; val_best_f1_score: 0.9449; train_kl_reg_loss: 37372.8644; train_edge_recon_loss: 25843372.7973; train_gene_expr_recon_loss: 5965685.3004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31846430.9146; train_optim_loss: 31846430.9146; val_kl_reg_loss: 36555.9710; val_edge_recon_loss: 26265628.0556; val_gene_expr_recon_loss: 5993401.2523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32295585.2778; val_optim_loss: 32295585.2778
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9855; val_auprc_score: 0.9832; val_best_acc_score: 0.9450; val_best_f1_score: 0.9460; train_kl_reg_loss: 37516.5532; train_edge_recon_loss: 25845119.2099; train_gene_expr_recon_loss: 5967521.5674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31850157.3282; train_optim_loss: 31850157.3282; val_kl_reg_loss: 36702.7482; val_edge_recon_loss: 26247031.7685; val_gene_expr_recon_loss: 5984687.0486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32268421.5926; val_optim_loss: 32268421.5926
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9853; val_auprc_score: 0.9829; val_best_acc_score: 0.9445; val_best_f1_score: 0.9454; train_kl_reg_loss: 37579.7110; train_edge_recon_loss: 25845710.2428; train_gene_expr_recon_loss: 5969507.7793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31852797.6924; train_optim_loss: 31852797.6924; val_kl_reg_loss: 36759.0825; val_edge_recon_loss: 26268113.1667; val_gene_expr_recon_loss: 5987772.5903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32292644.7963; val_optim_loss: 32292644.7963
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9859; val_auprc_score: 0.9834; val_best_acc_score: 0.9453; val_best_f1_score: 0.9462; train_kl_reg_loss: 37597.1085; train_edge_recon_loss: 25839452.7593; train_gene_expr_recon_loss: 5965922.3917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31842972.2716; train_optim_loss: 31842972.2716; val_kl_reg_loss: 36856.9321; val_edge_recon_loss: 26245628.2222; val_gene_expr_recon_loss: 5988296.6435; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32270781.8241; val_optim_loss: 32270781.8241
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9857; val_auprc_score: 0.9832; val_best_acc_score: 0.9456; val_best_f1_score: 0.9466; train_kl_reg_loss: 37628.9689; train_edge_recon_loss: 25850939.3611; train_gene_expr_recon_loss: 5962220.8588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31850789.2181; train_optim_loss: 31850789.2181; val_kl_reg_loss: 36788.7805; val_edge_recon_loss: 26240160.3148; val_gene_expr_recon_loss: 5968302.4444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32245251.5463; val_optim_loss: 32245251.5463
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9854; val_auprc_score: 0.9828; val_best_acc_score: 0.9450; val_best_f1_score: 0.9459; train_kl_reg_loss: 37603.0086; train_edge_recon_loss: 25848591.6379; train_gene_expr_recon_loss: 5964861.8230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31851056.4486; train_optim_loss: 31851056.4486; val_kl_reg_loss: 36745.5732; val_edge_recon_loss: 26251965.2222; val_gene_expr_recon_loss: 5990646.3356; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32279357.1389; val_optim_loss: 32279357.1389
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9853; val_auprc_score: 0.9829; val_best_acc_score: 0.9437; val_best_f1_score: 0.9449; train_kl_reg_loss: 37653.4048; train_edge_recon_loss: 25834704.1687; train_gene_expr_recon_loss: 5962495.0952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31834852.6749; train_optim_loss: 31834852.6749; val_kl_reg_loss: 36864.3135; val_edge_recon_loss: 26275980.2593; val_gene_expr_recon_loss: 5988875.7546; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32301720.2500; val_optim_loss: 32301720.2500
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9855; val_auprc_score: 0.9831; val_best_acc_score: 0.9445; val_best_f1_score: 0.9456; train_kl_reg_loss: 37730.0409; train_edge_recon_loss: 25850310.3241; train_gene_expr_recon_loss: 5965266.9144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31853307.2829; train_optim_loss: 31853307.2829; val_kl_reg_loss: 36730.2832; val_edge_recon_loss: 26236933.0648; val_gene_expr_recon_loss: 5977526.2870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32251189.6574; val_optim_loss: 32251189.6574
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9857; val_auprc_score: 0.9834; val_best_acc_score: 0.9448; val_best_f1_score: 0.9460; train_kl_reg_loss: 37710.9404; train_edge_recon_loss: 25843373.7130; train_gene_expr_recon_loss: 5966230.6821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31847315.3302; train_optim_loss: 31847315.3302; val_kl_reg_loss: 36819.0574; val_edge_recon_loss: 26240619.9630; val_gene_expr_recon_loss: 5991539.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32268978.1852; val_optim_loss: 32268978.1852

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9854; val_auprc_score: 0.9829; val_best_acc_score: 0.9441; val_best_f1_score: 0.9453; train_kl_reg_loss: 37707.5672; train_edge_recon_loss: 25841705.7984; train_gene_expr_recon_loss: 5963647.6790; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31843061.0586; train_optim_loss: 31843061.0586; val_kl_reg_loss: 36897.0577; val_edge_recon_loss: 26259453.1667; val_gene_expr_recon_loss: 5994269.2801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32290619.4722; val_optim_loss: 32290619.4722
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9856; val_auprc_score: 0.9831; val_best_acc_score: 0.9455; val_best_f1_score: 0.9464; train_kl_reg_loss: 37727.7006; train_edge_recon_loss: 25840382.6142; train_gene_expr_recon_loss: 5962173.2178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31840283.5247; train_optim_loss: 31840283.5247; val_kl_reg_loss: 36943.2631; val_edge_recon_loss: 26240602.8426; val_gene_expr_recon_loss: 5983061.6065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32260607.5926; val_optim_loss: 32260607.5926
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9855; val_auprc_score: 0.9831; val_best_acc_score: 0.9447; val_best_f1_score: 0.9456; train_kl_reg_loss: 37770.3194; train_edge_recon_loss: 25844565.0576; train_gene_expr_recon_loss: 5964708.3765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31847043.7222; train_optim_loss: 31847043.7222; val_kl_reg_loss: 36831.7651; val_edge_recon_loss: 26261056.0278; val_gene_expr_recon_loss: 5989363.5787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32287251.3889; val_optim_loss: 32287251.3889
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9854; val_auprc_score: 0.9826; val_best_acc_score: 0.9445; val_best_f1_score: 0.9454; train_kl_reg_loss: 37742.8621; train_edge_recon_loss: 25849405.6842; train_gene_expr_recon_loss: 5962921.8616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31850070.3899; train_optim_loss: 31850070.3899; val_kl_reg_loss: 36867.7441; val_edge_recon_loss: 26253700.4259; val_gene_expr_recon_loss: 5989882.1134; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32280450.2222; val_optim_loss: 32280450.2222

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 131 min 8 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9854
Val AUPRC score: 0.9830
Val best accuracy score: 0.9439
Val best F1 score: 0.9449
Val gene expr MSE score: 1.5781

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
