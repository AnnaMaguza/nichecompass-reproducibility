None
Run timestamp: 24072023_222244_3.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9362; val_auprc_score: 0.9159; val_best_acc_score: 0.8771; val_best_f1_score: 0.8853; train_kl_reg_loss: 19699.0810; train_edge_recon_loss: 2728298.5596; train_gene_expr_recon_loss: 789547.5479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3537545.1882; train_optim_loss: 3537545.1882; val_kl_reg_loss: 17715.5926; val_edge_recon_loss: 2693046.6349; val_gene_expr_recon_loss: 723573.2780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3434335.5197; val_optim_loss: 3434335.5197
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9481; val_auprc_score: 0.9325; val_best_acc_score: 0.8882; val_best_f1_score: 0.8952; train_kl_reg_loss: 16891.6290; train_edge_recon_loss: 2643904.6662; train_gene_expr_recon_loss: 701452.0974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3362248.3930; train_optim_loss: 3362248.3930; val_kl_reg_loss: 15959.2640; val_edge_recon_loss: 2684157.0230; val_gene_expr_recon_loss: 685485.0016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3385601.2961; val_optim_loss: 3385601.2961
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9587; val_auprc_score: 0.9475; val_best_acc_score: 0.9024; val_best_f1_score: 0.9071; train_kl_reg_loss: 15238.2951; train_edge_recon_loss: 2632547.5529; train_gene_expr_recon_loss: 674405.1812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3322191.0316; train_optim_loss: 3322191.0316; val_kl_reg_loss: 14564.7074; val_edge_recon_loss: 2675147.2171; val_gene_expr_recon_loss: 664019.7048; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3353731.6316; val_optim_loss: 3353731.6316
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9638; val_auprc_score: 0.9548; val_best_acc_score: 0.9097; val_best_f1_score: 0.9134; train_kl_reg_loss: 14587.4481; train_edge_recon_loss: 2624217.0419; train_gene_expr_recon_loss: 656828.2924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3295632.7835; train_optim_loss: 3295632.7835; val_kl_reg_loss: 14091.9151; val_edge_recon_loss: 2672750.3125; val_gene_expr_recon_loss: 651305.1900; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3338147.4211; val_optim_loss: 3338147.4211
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9663; val_auprc_score: 0.9574; val_best_acc_score: 0.9138; val_best_f1_score: 0.9174; train_kl_reg_loss: 14355.8500; train_edge_recon_loss: 2617828.5471; train_gene_expr_recon_loss: 644086.0864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3276270.4846; train_optim_loss: 3276270.4846; val_kl_reg_loss: 14010.3138; val_edge_recon_loss: 2669158.7072; val_gene_expr_recon_loss: 641070.6349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3324239.6678; val_optim_loss: 3324239.6678
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9682; val_auprc_score: 0.9590; val_best_acc_score: 0.9186; val_best_f1_score: 0.9214; train_kl_reg_loss: 14135.4946; train_edge_recon_loss: 2614860.2588; train_gene_expr_recon_loss: 635671.1122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3264666.8654; train_optim_loss: 3264666.8654; val_kl_reg_loss: 13083.8765; val_edge_recon_loss: 2668037.3257; val_gene_expr_recon_loss: 633354.8668; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3314476.0724; val_optim_loss: 3314476.0724
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9689; val_auprc_score: 0.9602; val_best_acc_score: 0.9200; val_best_f1_score: 0.9229; train_kl_reg_loss: 13882.1173; train_edge_recon_loss: 2616384.7846; train_gene_expr_recon_loss: 629163.0298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3259429.9423; train_optim_loss: 3259429.9423; val_kl_reg_loss: 13767.3847; val_edge_recon_loss: 2659525.9013; val_gene_expr_recon_loss: 627052.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3300345.9507; val_optim_loss: 3300345.9507
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9697; val_auprc_score: 0.9608; val_best_acc_score: 0.9206; val_best_f1_score: 0.9231; train_kl_reg_loss: 13845.7088; train_edge_recon_loss: 2612044.5835; train_gene_expr_recon_loss: 624443.6415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3250333.9279; train_optim_loss: 3250333.9279; val_kl_reg_loss: 13177.0287; val_edge_recon_loss: 2665805.6217; val_gene_expr_recon_loss: 623889.5395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3302872.1809; val_optim_loss: 3302872.1809
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9701; val_auprc_score: 0.9611; val_best_acc_score: 0.9215; val_best_f1_score: 0.9246; train_kl_reg_loss: 13654.7947; train_edge_recon_loss: 2609584.0474; train_gene_expr_recon_loss: 621190.9504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3244429.7945; train_optim_loss: 3244429.7945; val_kl_reg_loss: 13146.8338; val_edge_recon_loss: 2660054.5099; val_gene_expr_recon_loss: 620395.1456; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3293596.5164; val_optim_loss: 3293596.5164
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9708; val_auprc_score: 0.9622; val_best_acc_score: 0.9224; val_best_f1_score: 0.9252; train_kl_reg_loss: 13550.7152; train_edge_recon_loss: 2607702.7779; train_gene_expr_recon_loss: 618136.8418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3239390.3342; train_optim_loss: 3239390.3342; val_kl_reg_loss: 13185.0079; val_edge_recon_loss: 2659319.1020; val_gene_expr_recon_loss: 622212.8372; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3294716.9276; val_optim_loss: 3294716.9276
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9710; val_auprc_score: 0.9630; val_best_acc_score: 0.9223; val_best_f1_score: 0.9250; train_kl_reg_loss: 13351.5699; train_edge_recon_loss: 2608081.8941; train_gene_expr_recon_loss: 616014.5083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3237447.9735; train_optim_loss: 3237447.9735; val_kl_reg_loss: 13026.5874; val_edge_recon_loss: 2663382.8322; val_gene_expr_recon_loss: 617795.4877; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3294204.9079; val_optim_loss: 3294204.9079
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9714; val_auprc_score: 0.9631; val_best_acc_score: 0.9239; val_best_f1_score: 0.9264; train_kl_reg_loss: 13250.0163; train_edge_recon_loss: 2608535.0629; train_gene_expr_recon_loss: 614338.6692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236123.7526; train_optim_loss: 3236123.7526; val_kl_reg_loss: 12750.1415; val_edge_recon_loss: 2666057.0625; val_gene_expr_recon_loss: 615169.2541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3293976.4539; val_optim_loss: 3293976.4539
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9726; val_auprc_score: 0.9639; val_best_acc_score: 0.9261; val_best_f1_score: 0.9286; train_kl_reg_loss: 13183.9803; train_edge_recon_loss: 2606369.3070; train_gene_expr_recon_loss: 612746.5703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3232299.8636; train_optim_loss: 3232299.8636; val_kl_reg_loss: 12763.2891; val_edge_recon_loss: 2658513.2895; val_gene_expr_recon_loss: 615920.7928; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3287197.3520; val_optim_loss: 3287197.3520
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9730; val_auprc_score: 0.9661; val_best_acc_score: 0.9245; val_best_f1_score: 0.9269; train_kl_reg_loss: 13155.4255; train_edge_recon_loss: 2603006.1074; train_gene_expr_recon_loss: 611580.1066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3227741.6463; train_optim_loss: 3227741.6463; val_kl_reg_loss: 12828.2011; val_edge_recon_loss: 2664232.8092; val_gene_expr_recon_loss: 614308.6505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3291369.6612; val_optim_loss: 3291369.6612
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9737; val_auprc_score: 0.9656; val_best_acc_score: 0.9279; val_best_f1_score: 0.9303; train_kl_reg_loss: 12988.0999; train_edge_recon_loss: 2605460.8680; train_gene_expr_recon_loss: 610195.7606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3228644.7254; train_optim_loss: 3228644.7254; val_kl_reg_loss: 12737.5372; val_edge_recon_loss: 2654699.2336; val_gene_expr_recon_loss: 614279.0979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3281715.8816; val_optim_loss: 3281715.8816
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9745; val_auprc_score: 0.9671; val_best_acc_score: 0.9283; val_best_f1_score: 0.9304; train_kl_reg_loss: 12935.1569; train_edge_recon_loss: 2601141.9018; train_gene_expr_recon_loss: 609214.2532; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3223291.3132; train_optim_loss: 3223291.3132; val_kl_reg_loss: 12491.3338; val_edge_recon_loss: 2656466.0691; val_gene_expr_recon_loss: 613083.9005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3282041.3059; val_optim_loss: 3282041.3059
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9751; val_auprc_score: 0.9685; val_best_acc_score: 0.9295; val_best_f1_score: 0.9315; train_kl_reg_loss: 12854.8059; train_edge_recon_loss: 2603626.1857; train_gene_expr_recon_loss: 608213.9559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3224694.9507; train_optim_loss: 3224694.9507; val_kl_reg_loss: 12421.3839; val_edge_recon_loss: 2658753.0625; val_gene_expr_recon_loss: 611384.6957; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3282559.1480; val_optim_loss: 3282559.1480
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9751; val_auprc_score: 0.9682; val_best_acc_score: 0.9295; val_best_f1_score: 0.9319; train_kl_reg_loss: 12851.0401; train_edge_recon_loss: 2603145.6162; train_gene_expr_recon_loss: 607671.0320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3223667.6901; train_optim_loss: 3223667.6901; val_kl_reg_loss: 12563.9117; val_edge_recon_loss: 2658443.5789; val_gene_expr_recon_loss: 609999.4803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3281006.9704; val_optim_loss: 3281006.9704
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9760; val_auprc_score: 0.9692; val_best_acc_score: 0.9316; val_best_f1_score: 0.9337; train_kl_reg_loss: 12837.4432; train_edge_recon_loss: 2601615.5044; train_gene_expr_recon_loss: 607159.1099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3221612.0559; train_optim_loss: 3221612.0559; val_kl_reg_loss: 12371.1881; val_edge_recon_loss: 2652822.4243; val_gene_expr_recon_loss: 611149.7097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3276343.3257; val_optim_loss: 3276343.3257
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9755; val_auprc_score: 0.9693; val_best_acc_score: 0.9303; val_best_f1_score: 0.9325; train_kl_reg_loss: 12815.2219; train_edge_recon_loss: 2602430.4184; train_gene_expr_recon_loss: 606361.8356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3221607.4750; train_optim_loss: 3221607.4750; val_kl_reg_loss: 12671.2453; val_edge_recon_loss: 2653696.9605; val_gene_expr_recon_loss: 609495.7253; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3275863.9474; val_optim_loss: 3275863.9474
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9751; val_auprc_score: 0.9676; val_best_acc_score: 0.9303; val_best_f1_score: 0.9324; train_kl_reg_loss: 12747.1976; train_edge_recon_loss: 2600352.6118; train_gene_expr_recon_loss: 606049.7835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3219149.6007; train_optim_loss: 3219149.6007; val_kl_reg_loss: 12379.9763; val_edge_recon_loss: 2653374.2138; val_gene_expr_recon_loss: 609044.9457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3274799.1382; val_optim_loss: 3274799.1382
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9735; val_auprc_score: 0.9651; val_best_acc_score: 0.9295; val_best_f1_score: 0.9313; train_kl_reg_loss: 12724.1910; train_edge_recon_loss: 2600196.1136; train_gene_expr_recon_loss: 605603.4681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3218523.7702; train_optim_loss: 3218523.7702; val_kl_reg_loss: 12682.4585; val_edge_recon_loss: 2651463.0329; val_gene_expr_recon_loss: 609263.3454; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3273408.8388; val_optim_loss: 3273408.8388
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9759; val_auprc_score: 0.9682; val_best_acc_score: 0.9328; val_best_f1_score: 0.9350; train_kl_reg_loss: 12693.4931; train_edge_recon_loss: 2599699.1699; train_gene_expr_recon_loss: 605086.6588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3217479.3213; train_optim_loss: 3217479.3213; val_kl_reg_loss: 12559.4002; val_edge_recon_loss: 2647012.1184; val_gene_expr_recon_loss: 608396.2377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3267967.7434; val_optim_loss: 3267967.7434
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9768; val_auprc_score: 0.9701; val_best_acc_score: 0.9333; val_best_f1_score: 0.9352; train_kl_reg_loss: 12652.6129; train_edge_recon_loss: 2599554.4493; train_gene_expr_recon_loss: 604681.9493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3216889.0096; train_optim_loss: 3216889.0096; val_kl_reg_loss: 12240.5473; val_edge_recon_loss: 2648932.1908; val_gene_expr_recon_loss: 607519.8840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3268692.6151; val_optim_loss: 3268692.6151
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9769; val_auprc_score: 0.9709; val_best_acc_score: 0.9332; val_best_f1_score: 0.9351; train_kl_reg_loss: 12578.9076; train_edge_recon_loss: 2599275.6294; train_gene_expr_recon_loss: 604205.2556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3216059.7908; train_optim_loss: 3216059.7908; val_kl_reg_loss: 12238.2357; val_edge_recon_loss: 2653563.5132; val_gene_expr_recon_loss: 607135.9613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3272937.7204; val_optim_loss: 3272937.7204
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9772; val_auprc_score: 0.9711; val_best_acc_score: 0.9328; val_best_f1_score: 0.9343; train_kl_reg_loss: 12568.3451; train_edge_recon_loss: 2599664.6290; train_gene_expr_recon_loss: 603360.0900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3215593.0625; train_optim_loss: 3215593.0625; val_kl_reg_loss: 12174.5726; val_edge_recon_loss: 2655108.1053; val_gene_expr_recon_loss: 609017.9753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3276300.6875; val_optim_loss: 3276300.6875
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9769; val_auprc_score: 0.9706; val_best_acc_score: 0.9323; val_best_f1_score: 0.9343; train_kl_reg_loss: 12591.8569; train_edge_recon_loss: 2597266.0662; train_gene_expr_recon_loss: 603276.0748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3213133.9941; train_optim_loss: 3213133.9941; val_kl_reg_loss: 12343.2536; val_edge_recon_loss: 2654300.4211; val_gene_expr_recon_loss: 607084.6357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3273728.2993; val_optim_loss: 3273728.2993

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9777; val_auprc_score: 0.9715; val_best_acc_score: 0.9333; val_best_f1_score: 0.9352; train_kl_reg_loss: 12682.0273; train_edge_recon_loss: 2596370.9555; train_gene_expr_recon_loss: 598705.5275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3207758.5147; train_optim_loss: 3207758.5147; val_kl_reg_loss: 12292.5440; val_edge_recon_loss: 2653093.4901; val_gene_expr_recon_loss: 601798.9589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3267185.0000; val_optim_loss: 3267185.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9774; val_auprc_score: 0.9710; val_best_acc_score: 0.9334; val_best_f1_score: 0.9352; train_kl_reg_loss: 12683.9577; train_edge_recon_loss: 2596981.6801; train_gene_expr_recon_loss: 598014.3165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3207679.9555; train_optim_loss: 3207679.9555; val_kl_reg_loss: 12377.7774; val_edge_recon_loss: 2655099.5428; val_gene_expr_recon_loss: 602780.8224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3270258.1546; val_optim_loss: 3270258.1546
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9782; val_auprc_score: 0.9721; val_best_acc_score: 0.9340; val_best_f1_score: 0.9357; train_kl_reg_loss: 12749.7043; train_edge_recon_loss: 2596071.7849; train_gene_expr_recon_loss: 597883.2309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3206704.7110; train_optim_loss: 3206704.7110; val_kl_reg_loss: 12376.3331; val_edge_recon_loss: 2650742.8651; val_gene_expr_recon_loss: 602233.8528; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3265353.0461; val_optim_loss: 3265353.0461
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9775; val_auprc_score: 0.9709; val_best_acc_score: 0.9341; val_best_f1_score: 0.9362; train_kl_reg_loss: 12737.7787; train_edge_recon_loss: 2595673.0574; train_gene_expr_recon_loss: 597629.7031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3206040.5397; train_optim_loss: 3206040.5397; val_kl_reg_loss: 12433.7949; val_edge_recon_loss: 2649172.1250; val_gene_expr_recon_loss: 603190.3725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3264796.2961; val_optim_loss: 3264796.2961
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9778; val_auprc_score: 0.9715; val_best_acc_score: 0.9345; val_best_f1_score: 0.9364; train_kl_reg_loss: 12734.0352; train_edge_recon_loss: 2596098.3783; train_gene_expr_recon_loss: 597547.0486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3206379.4610; train_optim_loss: 3206379.4610; val_kl_reg_loss: 12358.1489; val_edge_recon_loss: 2648726.0921; val_gene_expr_recon_loss: 602791.1390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3263875.3618; val_optim_loss: 3263875.3618
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9784; val_auprc_score: 0.9723; val_best_acc_score: 0.9360; val_best_f1_score: 0.9377; train_kl_reg_loss: 12725.6141; train_edge_recon_loss: 2596102.8305; train_gene_expr_recon_loss: 597213.8506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3206042.3059; train_optim_loss: 3206042.3059; val_kl_reg_loss: 12364.3130; val_edge_recon_loss: 2647502.2533; val_gene_expr_recon_loss: 600769.8166; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3260636.3684; val_optim_loss: 3260636.3684
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9778; val_auprc_score: 0.9720; val_best_acc_score: 0.9352; val_best_f1_score: 0.9371; train_kl_reg_loss: 12667.7827; train_edge_recon_loss: 2595606.3504; train_gene_expr_recon_loss: 597142.0011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3205416.1357; train_optim_loss: 3205416.1357; val_kl_reg_loss: 12372.9119; val_edge_recon_loss: 2650081.5592; val_gene_expr_recon_loss: 602103.2253; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3264557.7105; val_optim_loss: 3264557.7105
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9780; val_auprc_score: 0.9717; val_best_acc_score: 0.9355; val_best_f1_score: 0.9369; train_kl_reg_loss: 12689.0872; train_edge_recon_loss: 2595682.9629; train_gene_expr_recon_loss: 597242.2403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3205614.2949; train_optim_loss: 3205614.2949; val_kl_reg_loss: 12382.5450; val_edge_recon_loss: 2647924.3586; val_gene_expr_recon_loss: 600746.8100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3261053.7171; val_optim_loss: 3261053.7171
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9788; val_auprc_score: 0.9728; val_best_acc_score: 0.9360; val_best_f1_score: 0.9379; train_kl_reg_loss: 12663.2422; train_edge_recon_loss: 2595096.6724; train_gene_expr_recon_loss: 597308.0074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3205067.9243; train_optim_loss: 3205067.9243; val_kl_reg_loss: 12395.0126; val_edge_recon_loss: 2644210.4934; val_gene_expr_recon_loss: 601363.8265; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3257969.3454; val_optim_loss: 3257969.3454
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9775; val_auprc_score: 0.9708; val_best_acc_score: 0.9338; val_best_f1_score: 0.9359; train_kl_reg_loss: 12682.9131; train_edge_recon_loss: 2595897.7283; train_gene_expr_recon_loss: 597034.9257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3205615.5684; train_optim_loss: 3205615.5684; val_kl_reg_loss: 12311.6233; val_edge_recon_loss: 2653898.3553; val_gene_expr_recon_loss: 600060.0197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3266269.9836; val_optim_loss: 3266269.9836
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9774; val_auprc_score: 0.9705; val_best_acc_score: 0.9345; val_best_f1_score: 0.9365; train_kl_reg_loss: 12707.7899; train_edge_recon_loss: 2594659.0673; train_gene_expr_recon_loss: 596928.9298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3204295.7875; train_optim_loss: 3204295.7875; val_kl_reg_loss: 12307.4289; val_edge_recon_loss: 2648458.6513; val_gene_expr_recon_loss: 603934.2377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3264700.3158; val_optim_loss: 3264700.3158
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9782; val_auprc_score: 0.9719; val_best_acc_score: 0.9354; val_best_f1_score: 0.9372; train_kl_reg_loss: 12692.7072; train_edge_recon_loss: 2595633.1835; train_gene_expr_recon_loss: 597144.6008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3205470.4919; train_optim_loss: 3205470.4919; val_kl_reg_loss: 12406.9663; val_edge_recon_loss: 2650068.7829; val_gene_expr_recon_loss: 602106.7459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3264582.4836; val_optim_loss: 3264582.4836
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9775; val_auprc_score: 0.9708; val_best_acc_score: 0.9347; val_best_f1_score: 0.9365; train_kl_reg_loss: 12623.0673; train_edge_recon_loss: 2594771.0235; train_gene_expr_recon_loss: 596642.9556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3204037.0500; train_optim_loss: 3204037.0500; val_kl_reg_loss: 12335.5601; val_edge_recon_loss: 2650235.4112; val_gene_expr_recon_loss: 601820.7385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3264391.7105; val_optim_loss: 3264391.7105

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9782; val_auprc_score: 0.9725; val_best_acc_score: 0.9344; val_best_f1_score: 0.9364; train_kl_reg_loss: 12640.3023; train_edge_recon_loss: 2594498.7162; train_gene_expr_recon_loss: 596075.6595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3203214.6761; train_optim_loss: 3203214.6761; val_kl_reg_loss: 12303.8735; val_edge_recon_loss: 2649569.1908; val_gene_expr_recon_loss: 600770.9178; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3262643.9737; val_optim_loss: 3262643.9737
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9786; val_auprc_score: 0.9727; val_best_acc_score: 0.9356; val_best_f1_score: 0.9375; train_kl_reg_loss: 12634.7372; train_edge_recon_loss: 2594749.4801; train_gene_expr_recon_loss: 596173.1888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3203557.4033; train_optim_loss: 3203557.4033; val_kl_reg_loss: 12286.5447; val_edge_recon_loss: 2647469.4967; val_gene_expr_recon_loss: 599932.0403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3259688.1020; val_optim_loss: 3259688.1020
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9785; val_auprc_score: 0.9726; val_best_acc_score: 0.9354; val_best_f1_score: 0.9373; train_kl_reg_loss: 12641.2587; train_edge_recon_loss: 2596391.8430; train_gene_expr_recon_loss: 595902.8492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3204935.9537; train_optim_loss: 3204935.9537; val_kl_reg_loss: 12293.5613; val_edge_recon_loss: 2647260.2336; val_gene_expr_recon_loss: 600230.4095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3259784.2138; val_optim_loss: 3259784.2138
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9783; val_auprc_score: 0.9721; val_best_acc_score: 0.9346; val_best_f1_score: 0.9364; train_kl_reg_loss: 12641.7577; train_edge_recon_loss: 2595543.9309; train_gene_expr_recon_loss: 595969.7345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3204155.4254; train_optim_loss: 3204155.4254; val_kl_reg_loss: 12322.9883; val_edge_recon_loss: 2649106.1579; val_gene_expr_recon_loss: 601963.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3263392.5789; val_optim_loss: 3263392.5789

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 48 min 23 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
Val AUROC score: 0.9778
Val AUPRC score: 0.9718
Val best accuracy score: 0.9344
Val best F1 score: 0.9363
Val gene expr MSE score: 1.4328

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
