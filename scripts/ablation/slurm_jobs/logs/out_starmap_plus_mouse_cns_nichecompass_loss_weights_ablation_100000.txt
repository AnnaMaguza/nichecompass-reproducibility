None
Run timestamp: 21072023_165914_100000.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_100000']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1818, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1818, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9732; val_auprc_score: 0.9654; val_best_acc_score: 0.9261; val_best_f1_score: 0.9273; train_kl_reg_loss: 297.5954; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 21453.3595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21750.9549; train_optim_loss: 21750.9549; val_kl_reg_loss: 263.9880; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19967.6862; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20231.6742; val_optim_loss: 20231.6742
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9759; val_auprc_score: 0.9701; val_best_acc_score: 0.9321; val_best_f1_score: 0.9327; train_kl_reg_loss: 279.5754; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 20237.6561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20517.2314; train_optim_loss: 20517.2314; val_kl_reg_loss: 287.6348; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19553.7904; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19841.4252; val_optim_loss: 19841.4252
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9781; val_auprc_score: 0.9734; val_best_acc_score: 0.9363; val_best_f1_score: 0.9370; train_kl_reg_loss: 302.0638; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19890.5108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20192.5746; train_optim_loss: 20192.5746; val_kl_reg_loss: 307.8035; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19272.0849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19579.8881; val_optim_loss: 19579.8881
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9803; val_auprc_score: 0.9761; val_best_acc_score: 0.9403; val_best_f1_score: 0.9412; train_kl_reg_loss: 320.6193; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19617.1933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19937.8127; train_optim_loss: 19937.8127; val_kl_reg_loss: 315.9691; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19078.7799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19394.7488; val_optim_loss: 19394.7488
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9819; val_auprc_score: 0.9787; val_best_acc_score: 0.9426; val_best_f1_score: 0.9430; train_kl_reg_loss: 334.4685; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19392.0061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19726.4746; train_optim_loss: 19726.4746; val_kl_reg_loss: 325.9349; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 18831.0249; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19156.9598; val_optim_loss: 19156.9598
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9830; val_auprc_score: 0.9808; val_best_acc_score: 0.9439; val_best_f1_score: 0.9448; train_kl_reg_loss: 341.0018; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19169.7884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19510.7901; train_optim_loss: 19510.7901; val_kl_reg_loss: 331.8795; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 18694.4996; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19026.3792; val_optim_loss: 19026.3792
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9836; val_auprc_score: 0.9818; val_best_acc_score: 0.9449; val_best_f1_score: 0.9455; train_kl_reg_loss: 345.3034; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 18974.6112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19319.9146; train_optim_loss: 19319.9146; val_kl_reg_loss: 335.7951; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 18511.9022; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18847.6974; val_optim_loss: 18847.6974
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9840; val_auprc_score: 0.9830; val_best_acc_score: 0.9451; val_best_f1_score: 0.9454; train_kl_reg_loss: 354.3600; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 18776.2520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19130.6121; train_optim_loss: 19130.6121; val_kl_reg_loss: 354.7290; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 18319.3312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18674.0604; val_optim_loss: 18674.0604
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9847; val_auprc_score: 0.9849; val_best_acc_score: 0.9449; val_best_f1_score: 0.9453; train_kl_reg_loss: 371.9685; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 18576.0481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18948.0167; train_optim_loss: 18948.0167; val_kl_reg_loss: 380.3116; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 18209.7375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18590.0490; val_optim_loss: 18590.0490
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9847; val_auprc_score: 0.9855; val_best_acc_score: 0.9459; val_best_f1_score: 0.9457; train_kl_reg_loss: 396.1548; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 18401.2496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18797.4044; train_optim_loss: 18797.4044; val_kl_reg_loss: 399.5166; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17961.6515; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18361.1679; val_optim_loss: 18361.1679
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9838; val_auprc_score: 0.9854; val_best_acc_score: 0.9451; val_best_f1_score: 0.9450; train_kl_reg_loss: 423.8927; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 18241.8897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18665.7824; train_optim_loss: 18665.7824; val_kl_reg_loss: 423.4459; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17833.3951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18256.8411; val_optim_loss: 18256.8411
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9837; val_auprc_score: 0.9850; val_best_acc_score: 0.9451; val_best_f1_score: 0.9450; train_kl_reg_loss: 451.9428; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 18067.9700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18519.9127; train_optim_loss: 18519.9127; val_kl_reg_loss: 462.4413; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17652.7872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18115.2282; val_optim_loss: 18115.2282
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9832; val_auprc_score: 0.9853; val_best_acc_score: 0.9445; val_best_f1_score: 0.9438; train_kl_reg_loss: 479.0264; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17944.8875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18423.9139; train_optim_loss: 18423.9139; val_kl_reg_loss: 487.6379; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17542.1640; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18029.8018; val_optim_loss: 18029.8018
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9829; val_auprc_score: 0.9857; val_best_acc_score: 0.9446; val_best_f1_score: 0.9441; train_kl_reg_loss: 502.8495; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17814.6427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18317.4923; train_optim_loss: 18317.4923; val_kl_reg_loss: 511.5551; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17434.8218; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17946.3770; val_optim_loss: 17946.3770
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9829; val_auprc_score: 0.9859; val_best_acc_score: 0.9442; val_best_f1_score: 0.9440; train_kl_reg_loss: 526.8804; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17722.6287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18249.5092; train_optim_loss: 18249.5092; val_kl_reg_loss: 528.1124; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17384.4909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17912.6034; val_optim_loss: 17912.6034
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9816; val_auprc_score: 0.9834; val_best_acc_score: 0.9418; val_best_f1_score: 0.9411; train_kl_reg_loss: 547.0381; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17623.7107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18170.7487; train_optim_loss: 18170.7487; val_kl_reg_loss: 550.8667; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17315.3148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17866.1814; val_optim_loss: 17866.1814
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9823; val_auprc_score: 0.9857; val_best_acc_score: 0.9438; val_best_f1_score: 0.9427; train_kl_reg_loss: 566.7587; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17545.9060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18112.6646; train_optim_loss: 18112.6646; val_kl_reg_loss: 567.4468; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17203.2295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17770.6763; val_optim_loss: 17770.6763
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9819; val_auprc_score: 0.9854; val_best_acc_score: 0.9431; val_best_f1_score: 0.9418; train_kl_reg_loss: 583.6111; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17474.5115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18058.1227; train_optim_loss: 18058.1227; val_kl_reg_loss: 583.8958; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17131.4232; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17715.3189; val_optim_loss: 17715.3189
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9814; val_auprc_score: 0.9850; val_best_acc_score: 0.9424; val_best_f1_score: 0.9415; train_kl_reg_loss: 599.0455; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17403.6416; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18002.6871; train_optim_loss: 18002.6871; val_kl_reg_loss: 592.8822; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17089.8267; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17682.7089; val_optim_loss: 17682.7089
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9814; val_auprc_score: 0.9852; val_best_acc_score: 0.9427; val_best_f1_score: 0.9416; train_kl_reg_loss: 614.7094; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17348.8630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17963.5723; train_optim_loss: 17963.5723; val_kl_reg_loss: 605.9701; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17043.9291; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17649.8991; val_optim_loss: 17649.8991
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9802; val_auprc_score: 0.9842; val_best_acc_score: 0.9403; val_best_f1_score: 0.9393; train_kl_reg_loss: 626.6083; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17277.1356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17903.7439; train_optim_loss: 17903.7439; val_kl_reg_loss: 621.6699; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16976.3247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17597.9946; val_optim_loss: 17597.9946
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9804; val_auprc_score: 0.9838; val_best_acc_score: 0.9423; val_best_f1_score: 0.9409; train_kl_reg_loss: 639.1156; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17225.3645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17864.4801; train_optim_loss: 17864.4801; val_kl_reg_loss: 630.8270; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16959.4374; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17590.2645; val_optim_loss: 17590.2645
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9802; val_auprc_score: 0.9844; val_best_acc_score: 0.9402; val_best_f1_score: 0.9386; train_kl_reg_loss: 650.3616; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17194.0130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17844.3746; train_optim_loss: 17844.3746; val_kl_reg_loss: 648.1042; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16939.0821; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17587.1863; val_optim_loss: 17587.1863
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9801; val_auprc_score: 0.9840; val_best_acc_score: 0.9411; val_best_f1_score: 0.9394; train_kl_reg_loss: 661.5732; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17158.8532; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17820.4264; train_optim_loss: 17820.4264; val_kl_reg_loss: 653.9299; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16917.8189; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17571.7488; val_optim_loss: 17571.7488
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9797; val_auprc_score: 0.9837; val_best_acc_score: 0.9411; val_best_f1_score: 0.9397; train_kl_reg_loss: 671.1051; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17121.8713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17792.9763; train_optim_loss: 17792.9763; val_kl_reg_loss: 670.6882; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16934.5665; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17605.2546; val_optim_loss: 17605.2546
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9794; val_auprc_score: 0.9839; val_best_acc_score: 0.9400; val_best_f1_score: 0.9391; train_kl_reg_loss: 680.5002; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17086.0880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17766.5882; train_optim_loss: 17766.5882; val_kl_reg_loss: 680.7161; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16881.2955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17562.0114; val_optim_loss: 17562.0114
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9789; val_auprc_score: 0.9835; val_best_acc_score: 0.9395; val_best_f1_score: 0.9386; train_kl_reg_loss: 687.9469; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17051.2985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17739.2455; train_optim_loss: 17739.2455; val_kl_reg_loss: 682.8614; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16846.3051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17529.1666; val_optim_loss: 17529.1666
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9784; val_auprc_score: 0.9834; val_best_acc_score: 0.9392; val_best_f1_score: 0.9381; train_kl_reg_loss: 697.0684; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17012.4639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17709.5323; train_optim_loss: 17709.5323; val_kl_reg_loss: 690.1137; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16815.6819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17505.7954; val_optim_loss: 17505.7954
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9783; val_auprc_score: 0.9827; val_best_acc_score: 0.9389; val_best_f1_score: 0.9376; train_kl_reg_loss: 703.7504; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16984.9254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17688.6758; train_optim_loss: 17688.6758; val_kl_reg_loss: 699.7333; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16826.9388; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17526.6721; val_optim_loss: 17526.6721
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9782; val_auprc_score: 0.9830; val_best_acc_score: 0.9392; val_best_f1_score: 0.9377; train_kl_reg_loss: 710.6480; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16965.0049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17675.6529; train_optim_loss: 17675.6529; val_kl_reg_loss: 704.6584; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16780.2508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17484.9094; val_optim_loss: 17484.9094
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9783; val_auprc_score: 0.9833; val_best_acc_score: 0.9395; val_best_f1_score: 0.9380; train_kl_reg_loss: 717.3757; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16945.3757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17662.7514; train_optim_loss: 17662.7514; val_kl_reg_loss: 698.8149; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16827.7345; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17526.5494; val_optim_loss: 17526.5494
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9777; val_auprc_score: 0.9829; val_best_acc_score: 0.9393; val_best_f1_score: 0.9378; train_kl_reg_loss: 723.3816; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16913.3288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17636.7104; train_optim_loss: 17636.7104; val_kl_reg_loss: 713.2244; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16820.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17534.0370; val_optim_loss: 17534.0370
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9779; val_auprc_score: 0.9823; val_best_acc_score: 0.9390; val_best_f1_score: 0.9372; train_kl_reg_loss: 729.5713; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16866.3831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17595.9544; train_optim_loss: 17595.9544; val_kl_reg_loss: 715.6155; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16745.9570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17461.5726; val_optim_loss: 17461.5726
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9778; val_auprc_score: 0.9829; val_best_acc_score: 0.9390; val_best_f1_score: 0.9372; train_kl_reg_loss: 734.2559; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16866.3311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17600.5870; train_optim_loss: 17600.5870; val_kl_reg_loss: 730.3308; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16766.6156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17496.9463; val_optim_loss: 17496.9463
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9774; val_auprc_score: 0.9828; val_best_acc_score: 0.9387; val_best_f1_score: 0.9367; train_kl_reg_loss: 740.0135; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16849.4543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17589.4677; train_optim_loss: 17589.4677; val_kl_reg_loss: 737.0545; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16781.5658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17518.6204; val_optim_loss: 17518.6204
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9758; val_auprc_score: 0.9815; val_best_acc_score: 0.9355; val_best_f1_score: 0.9337; train_kl_reg_loss: 743.5499; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16828.2767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17571.8265; train_optim_loss: 17571.8265; val_kl_reg_loss: 733.9291; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16857.7270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17591.6557; val_optim_loss: 17591.6557
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9745; val_auprc_score: 0.9802; val_best_acc_score: 0.9347; val_best_f1_score: 0.9330; train_kl_reg_loss: 750.1703; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16798.2400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17548.4103; train_optim_loss: 17548.4103; val_kl_reg_loss: 751.3877; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16889.7878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17641.1754; val_optim_loss: 17641.1754

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9783; val_auprc_score: 0.9833; val_best_acc_score: 0.9395; val_best_f1_score: 0.9377; train_kl_reg_loss: 735.4347; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16648.8675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17384.3022; train_optim_loss: 17384.3022; val_kl_reg_loss: 722.2362; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16722.3115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17444.5480; val_optim_loss: 17444.5480
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9779; val_auprc_score: 0.9824; val_best_acc_score: 0.9393; val_best_f1_score: 0.9375; train_kl_reg_loss: 731.7000; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16593.5348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17325.2347; train_optim_loss: 17325.2347; val_kl_reg_loss: 716.9148; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16707.0587; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17423.9735; val_optim_loss: 17423.9735
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9777; val_auprc_score: 0.9826; val_best_acc_score: 0.9389; val_best_f1_score: 0.9369; train_kl_reg_loss: 728.3592; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16555.2657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17283.6249; train_optim_loss: 17283.6249; val_kl_reg_loss: 716.3207; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16738.9568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17455.2775; val_optim_loss: 17455.2775
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9784; val_auprc_score: 0.9836; val_best_acc_score: 0.9398; val_best_f1_score: 0.9378; train_kl_reg_loss: 726.2864; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16533.6420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17259.9284; train_optim_loss: 17259.9284; val_kl_reg_loss: 714.2238; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16718.8469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17433.0707; val_optim_loss: 17433.0707
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9776; val_auprc_score: 0.9829; val_best_acc_score: 0.9395; val_best_f1_score: 0.9375; train_kl_reg_loss: 725.3222; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16508.0384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17233.3606; train_optim_loss: 17233.3606; val_kl_reg_loss: 711.9701; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16699.5557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17411.5257; val_optim_loss: 17411.5257
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9777; val_auprc_score: 0.9831; val_best_acc_score: 0.9385; val_best_f1_score: 0.9364; train_kl_reg_loss: 724.8495; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16504.5031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17229.3526; train_optim_loss: 17229.3526; val_kl_reg_loss: 716.3808; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16690.4003; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17406.7812; val_optim_loss: 17406.7812
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9776; val_auprc_score: 0.9829; val_best_acc_score: 0.9387; val_best_f1_score: 0.9366; train_kl_reg_loss: 724.7718; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16484.7850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17209.5569; train_optim_loss: 17209.5569; val_kl_reg_loss: 711.6345; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16728.1215; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17439.7560; val_optim_loss: 17439.7560
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9772; val_auprc_score: 0.9823; val_best_acc_score: 0.9385; val_best_f1_score: 0.9364; train_kl_reg_loss: 724.5620; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16478.6285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17203.1906; train_optim_loss: 17203.1906; val_kl_reg_loss: 716.8658; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16710.6237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17427.4895; val_optim_loss: 17427.4895
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9770; val_auprc_score: 0.9824; val_best_acc_score: 0.9387; val_best_f1_score: 0.9365; train_kl_reg_loss: 724.9440; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16468.0061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17192.9501; train_optim_loss: 17192.9501; val_kl_reg_loss: 717.4125; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16751.8615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17469.2740; val_optim_loss: 17469.2740
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9771; val_auprc_score: 0.9826; val_best_acc_score: 0.9387; val_best_f1_score: 0.9365; train_kl_reg_loss: 725.8154; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16463.0635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17188.8789; train_optim_loss: 17188.8789; val_kl_reg_loss: 715.4650; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16804.2914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17519.7564; val_optim_loss: 17519.7564

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9776; val_auprc_score: 0.9828; val_best_acc_score: 0.9388; val_best_f1_score: 0.9366; train_kl_reg_loss: 724.1457; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16461.2863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17185.4320; train_optim_loss: 17185.4320; val_kl_reg_loss: 714.2704; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16719.5359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17433.8062; val_optim_loss: 17433.8062
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9776; val_auprc_score: 0.9830; val_best_acc_score: 0.9393; val_best_f1_score: 0.9371; train_kl_reg_loss: 724.6537; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16458.0071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17182.6608; train_optim_loss: 17182.6608; val_kl_reg_loss: 714.2955; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16736.2675; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17450.5630; val_optim_loss: 17450.5630
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9772; val_auprc_score: 0.9818; val_best_acc_score: 0.9381; val_best_f1_score: 0.9358; train_kl_reg_loss: 724.6863; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16457.1497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17181.8360; train_optim_loss: 17181.8360; val_kl_reg_loss: 716.2247; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16801.2335; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17517.4582; val_optim_loss: 17517.4582
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9777; val_auprc_score: 0.9831; val_best_acc_score: 0.9385; val_best_f1_score: 0.9362; train_kl_reg_loss: 724.9191; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16441.4867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17166.4058; train_optim_loss: 17166.4058; val_kl_reg_loss: 714.7865; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16722.0454; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17436.8319; val_optim_loss: 17436.8319

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 56 min 34 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
Val AUROC score: 0.9777
Val AUPRC score: 0.9824
Val best accuracy score: 0.9386
Val best F1 score: 0.9366
Val gene expr MSE score: 0.4878

Computing neighbor graph...
