None
Run timestamp: 15072023_211654_1006.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_1006']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9789; val_auprc_score: 0.9756; val_best_acc_score: 0.9312; val_best_f1_score: 0.9332; train_kl_reg_loss: 12074.5528; train_edge_recon_loss: 2713097.2761; train_gene_expr_recon_loss: 13177535.7433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15902707.5725; train_optim_loss: 15902707.5725; val_kl_reg_loss: 13673.6197; val_edge_recon_loss: 2672641.7882; val_gene_expr_recon_loss: 12518135.6759; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15204451.0556; val_optim_loss: 15204451.0556
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9818; val_auprc_score: 0.9790; val_best_acc_score: 0.9362; val_best_f1_score: 0.9380; train_kl_reg_loss: 14139.9708; train_edge_recon_loss: 2643123.3552; train_gene_expr_recon_loss: 12285381.5478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14942644.8765; train_optim_loss: 14942644.8765; val_kl_reg_loss: 14403.0850; val_edge_recon_loss: 2653207.0567; val_gene_expr_recon_loss: 12104693.5370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14772303.6481; val_optim_loss: 14772303.6481
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9832; val_auprc_score: 0.9809; val_best_acc_score: 0.9380; val_best_f1_score: 0.9395; train_kl_reg_loss: 14649.1629; train_edge_recon_loss: 2633582.9644; train_gene_expr_recon_loss: 12064979.0463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14713211.1703; train_optim_loss: 14713211.1703; val_kl_reg_loss: 14113.9847; val_edge_recon_loss: 2644455.3032; val_gene_expr_recon_loss: 11999215.1296; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14657784.4583; val_optim_loss: 14657784.4583
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9852; val_auprc_score: 0.9832; val_best_acc_score: 0.9421; val_best_f1_score: 0.9435; train_kl_reg_loss: 14873.1643; train_edge_recon_loss: 2627850.9907; train_gene_expr_recon_loss: 11985741.5118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14628465.6759; train_optim_loss: 14628465.6759; val_kl_reg_loss: 14500.1502; val_edge_recon_loss: 2641440.0683; val_gene_expr_recon_loss: 11955624.8981; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14611565.1435; val_optim_loss: 14611565.1435
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9849; val_auprc_score: 0.9826; val_best_acc_score: 0.9429; val_best_f1_score: 0.9443; train_kl_reg_loss: 14940.8591; train_edge_recon_loss: 2624135.8682; train_gene_expr_recon_loss: 11946839.9923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14585916.7202; train_optim_loss: 14585916.7202; val_kl_reg_loss: 14904.0983; val_edge_recon_loss: 2641584.5475; val_gene_expr_recon_loss: 11926381.6111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14582870.2222; val_optim_loss: 14582870.2222
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9858; val_auprc_score: 0.9839; val_best_acc_score: 0.9432; val_best_f1_score: 0.9443; train_kl_reg_loss: 14964.4758; train_edge_recon_loss: 2620877.9873; train_gene_expr_recon_loss: 11925748.5098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14561590.9758; train_optim_loss: 14561590.9758; val_kl_reg_loss: 15079.9825; val_edge_recon_loss: 2637457.1782; val_gene_expr_recon_loss: 11911036.2546; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14563573.3981; val_optim_loss: 14563573.3981
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9856; val_auprc_score: 0.9830; val_best_acc_score: 0.9448; val_best_f1_score: 0.9462; train_kl_reg_loss: 14970.2951; train_edge_recon_loss: 2619588.1520; train_gene_expr_recon_loss: 11919176.4599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14553734.9033; train_optim_loss: 14553734.9033; val_kl_reg_loss: 15006.3487; val_edge_recon_loss: 2632262.8877; val_gene_expr_recon_loss: 11916769.5324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14564038.7685; val_optim_loss: 14564038.7685
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9863; val_auprc_score: 0.9842; val_best_acc_score: 0.9453; val_best_f1_score: 0.9464; train_kl_reg_loss: 14947.3871; train_edge_recon_loss: 2617808.7074; train_gene_expr_recon_loss: 11914699.2562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14547455.3524; train_optim_loss: 14547455.3524; val_kl_reg_loss: 14691.9590; val_edge_recon_loss: 2634260.7442; val_gene_expr_recon_loss: 11908007.8519; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14556960.5417; val_optim_loss: 14556960.5417
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9870; val_auprc_score: 0.9849; val_best_acc_score: 0.9472; val_best_f1_score: 0.9481; train_kl_reg_loss: 14937.4658; train_edge_recon_loss: 2616204.4914; train_gene_expr_recon_loss: 11906327.0252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14537468.9769; train_optim_loss: 14537468.9769; val_kl_reg_loss: 14902.5138; val_edge_recon_loss: 2630144.5394; val_gene_expr_recon_loss: 11899100.3148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14544147.3287; val_optim_loss: 14544147.3287
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9869; val_auprc_score: 0.9848; val_best_acc_score: 0.9477; val_best_f1_score: 0.9486; train_kl_reg_loss: 14893.1934; train_edge_recon_loss: 2614335.3546; train_gene_expr_recon_loss: 11905994.1127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14535222.6507; train_optim_loss: 14535222.6507; val_kl_reg_loss: 14658.5071; val_edge_recon_loss: 2628308.9965; val_gene_expr_recon_loss: 11933277.7037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14576245.2037; val_optim_loss: 14576245.2037
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9865; val_auprc_score: 0.9843; val_best_acc_score: 0.9467; val_best_f1_score: 0.9478; train_kl_reg_loss: 14871.2913; train_edge_recon_loss: 2613125.1373; train_gene_expr_recon_loss: 11900115.3488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14528111.7819; train_optim_loss: 14528111.7819; val_kl_reg_loss: 14903.3717; val_edge_recon_loss: 2630147.5868; val_gene_expr_recon_loss: 11911831.7963; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14556882.7500; val_optim_loss: 14556882.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9874; val_auprc_score: 0.9851; val_best_acc_score: 0.9481; val_best_f1_score: 0.9490; train_kl_reg_loss: 14810.1332; train_edge_recon_loss: 2613331.2913; train_gene_expr_recon_loss: 11897631.8287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14525773.2567; train_optim_loss: 14525773.2567; val_kl_reg_loss: 14783.0715; val_edge_recon_loss: 2630169.5023; val_gene_expr_recon_loss: 11905762.0370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14550714.6111; val_optim_loss: 14550714.6111
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9876; val_auprc_score: 0.9857; val_best_acc_score: 0.9487; val_best_f1_score: 0.9498; train_kl_reg_loss: 14776.6675; train_edge_recon_loss: 2612578.8472; train_gene_expr_recon_loss: 11896591.9532; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14523947.4707; train_optim_loss: 14523947.4707; val_kl_reg_loss: 14757.7369; val_edge_recon_loss: 2628160.8692; val_gene_expr_recon_loss: 11893634.6343; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14536553.2454; val_optim_loss: 14536553.2454
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9871; val_auprc_score: 0.9848; val_best_acc_score: 0.9483; val_best_f1_score: 0.9495; train_kl_reg_loss: 14739.7103; train_edge_recon_loss: 2611521.5210; train_gene_expr_recon_loss: 11894160.5319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14520421.7613; train_optim_loss: 14520421.7613; val_kl_reg_loss: 14453.6447; val_edge_recon_loss: 2628410.1921; val_gene_expr_recon_loss: 11899585.5880; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14542449.4306; val_optim_loss: 14542449.4306
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9862; val_auprc_score: 0.9835; val_best_acc_score: 0.9478; val_best_f1_score: 0.9488; train_kl_reg_loss: 14692.1860; train_edge_recon_loss: 2610897.4167; train_gene_expr_recon_loss: 11892556.1080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14518145.7150; train_optim_loss: 14518145.7150; val_kl_reg_loss: 14923.4613; val_edge_recon_loss: 2626668.9606; val_gene_expr_recon_loss: 11885704.5463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14527296.9676; val_optim_loss: 14527296.9676
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9874; val_auprc_score: 0.9853; val_best_acc_score: 0.9493; val_best_f1_score: 0.9502; train_kl_reg_loss: 14652.8730; train_edge_recon_loss: 2610899.1678; train_gene_expr_recon_loss: 11887908.7397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14513460.7834; train_optim_loss: 14513460.7834; val_kl_reg_loss: 14634.4764; val_edge_recon_loss: 2624867.1678; val_gene_expr_recon_loss: 11888624.1713; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14528125.8148; val_optim_loss: 14528125.8148
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9881; val_auprc_score: 0.9859; val_best_acc_score: 0.9508; val_best_f1_score: 0.9516; train_kl_reg_loss: 14615.0627; train_edge_recon_loss: 2609379.9311; train_gene_expr_recon_loss: 11883280.5021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14507275.4877; train_optim_loss: 14507275.4877; val_kl_reg_loss: 14342.4745; val_edge_recon_loss: 2623082.5185; val_gene_expr_recon_loss: 11878162.2963; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14515587.2870; val_optim_loss: 14515587.2870
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9886; val_auprc_score: 0.9866; val_best_acc_score: 0.9520; val_best_f1_score: 0.9529; train_kl_reg_loss: 14571.5406; train_edge_recon_loss: 2609711.8247; train_gene_expr_recon_loss: 11884482.9383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14508766.2968; train_optim_loss: 14508766.2968; val_kl_reg_loss: 14386.3333; val_edge_recon_loss: 2623707.4051; val_gene_expr_recon_loss: 11897492.9954; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14535586.7222; val_optim_loss: 14535586.7222
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9885; val_auprc_score: 0.9866; val_best_acc_score: 0.9523; val_best_f1_score: 0.9534; train_kl_reg_loss: 14530.8920; train_edge_recon_loss: 2608621.9547; train_gene_expr_recon_loss: 11883296.3873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14506449.2325; train_optim_loss: 14506449.2325; val_kl_reg_loss: 14364.3274; val_edge_recon_loss: 2621836.3819; val_gene_expr_recon_loss: 11888887.7454; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14525088.4676; val_optim_loss: 14525088.4676
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9881; val_auprc_score: 0.9859; val_best_acc_score: 0.9515; val_best_f1_score: 0.9523; train_kl_reg_loss: 14495.8664; train_edge_recon_loss: 2607887.4055; train_gene_expr_recon_loss: 11878544.3308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14500927.6080; train_optim_loss: 14500927.6080; val_kl_reg_loss: 14461.2487; val_edge_recon_loss: 2622236.3715; val_gene_expr_recon_loss: 11897319.3657; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14534016.9907; val_optim_loss: 14534016.9907
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9882; val_auprc_score: 0.9860; val_best_acc_score: 0.9513; val_best_f1_score: 0.9522; train_kl_reg_loss: 14454.0527; train_edge_recon_loss: 2609242.6155; train_gene_expr_recon_loss: 11879715.0041; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14503411.6780; train_optim_loss: 14503411.6780; val_kl_reg_loss: 14504.0686; val_edge_recon_loss: 2622631.2176; val_gene_expr_recon_loss: 11888287.4444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14525422.7407; val_optim_loss: 14525422.7407

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9880; val_auprc_score: 0.9858; val_best_acc_score: 0.9512; val_best_f1_score: 0.9521; train_kl_reg_loss: 15364.9192; train_edge_recon_loss: 2600039.2425; train_gene_expr_recon_loss: 11801038.8421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14416443.0123; train_optim_loss: 14416443.0123; val_kl_reg_loss: 14904.9960; val_edge_recon_loss: 2616445.5880; val_gene_expr_recon_loss: 11821851.3657; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14453201.9398; val_optim_loss: 14453201.9398
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9882; val_auprc_score: 0.9859; val_best_acc_score: 0.9513; val_best_f1_score: 0.9522; train_kl_reg_loss: 14661.8040; train_edge_recon_loss: 2599477.4895; train_gene_expr_recon_loss: 11791903.5900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14406042.8966; train_optim_loss: 14406042.8966; val_kl_reg_loss: 14252.6397; val_edge_recon_loss: 2613777.5683; val_gene_expr_recon_loss: 11807286.0926; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14435316.3148; val_optim_loss: 14435316.3148
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9884; val_auprc_score: 0.9863; val_best_acc_score: 0.9517; val_best_f1_score: 0.9527; train_kl_reg_loss: 14364.3290; train_edge_recon_loss: 2598888.1400; train_gene_expr_recon_loss: 11787024.8724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14400277.3431; train_optim_loss: 14400277.3431; val_kl_reg_loss: 14214.0786; val_edge_recon_loss: 2612078.1192; val_gene_expr_recon_loss: 11811016.1157; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14437308.3287; val_optim_loss: 14437308.3287
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9882; val_auprc_score: 0.9861; val_best_acc_score: 0.9514; val_best_f1_score: 0.9523; train_kl_reg_loss: 14218.5552; train_edge_recon_loss: 2599379.2206; train_gene_expr_recon_loss: 11784241.8004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14397839.5741; train_optim_loss: 14397839.5741; val_kl_reg_loss: 14105.5894; val_edge_recon_loss: 2612198.6134; val_gene_expr_recon_loss: 11807786.4120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14434090.6065; val_optim_loss: 14434090.6065
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9881; val_auprc_score: 0.9860; val_best_acc_score: 0.9512; val_best_f1_score: 0.9521; train_kl_reg_loss: 14120.9822; train_edge_recon_loss: 2599429.9514; train_gene_expr_recon_loss: 11787483.8447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14401034.7886; train_optim_loss: 14401034.7886; val_kl_reg_loss: 14057.4027; val_edge_recon_loss: 2613806.9005; val_gene_expr_recon_loss: 11820474.3565; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14448338.6667; val_optim_loss: 14448338.6667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9882; val_auprc_score: 0.9860; val_best_acc_score: 0.9517; val_best_f1_score: 0.9527; train_kl_reg_loss: 14044.5895; train_edge_recon_loss: 2597363.3519; train_gene_expr_recon_loss: 11782420.4455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14393828.3940; train_optim_loss: 14393828.3940; val_kl_reg_loss: 13941.1799; val_edge_recon_loss: 2614173.5602; val_gene_expr_recon_loss: 11795904.7824; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14424019.5000; val_optim_loss: 14424019.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9883; val_auprc_score: 0.9861; val_best_acc_score: 0.9518; val_best_f1_score: 0.9527; train_kl_reg_loss: 13982.1679; train_edge_recon_loss: 2598683.9651; train_gene_expr_recon_loss: 11786396.8981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14399063.0273; train_optim_loss: 14399063.0273; val_kl_reg_loss: 13823.8149; val_edge_recon_loss: 2613498.7998; val_gene_expr_recon_loss: 11792546.6296; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14419869.2500; val_optim_loss: 14419869.2500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9885; val_auprc_score: 0.9865; val_best_acc_score: 0.9523; val_best_f1_score: 0.9532; train_kl_reg_loss: 13932.0815; train_edge_recon_loss: 2597694.7635; train_gene_expr_recon_loss: 11783776.1013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14395402.9527; train_optim_loss: 14395402.9527; val_kl_reg_loss: 13733.2465; val_edge_recon_loss: 2612712.9919; val_gene_expr_recon_loss: 11807156.8889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14433603.1435; val_optim_loss: 14433603.1435
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9885; val_auprc_score: 0.9865; val_best_acc_score: 0.9524; val_best_f1_score: 0.9532; train_kl_reg_loss: 13890.1605; train_edge_recon_loss: 2597899.5574; train_gene_expr_recon_loss: 11780393.8148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14392183.5257; train_optim_loss: 14392183.5257; val_kl_reg_loss: 13753.4344; val_edge_recon_loss: 2609686.1863; val_gene_expr_recon_loss: 11809181.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14432620.8241; val_optim_loss: 14432620.8241
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9888; val_auprc_score: 0.9865; val_best_acc_score: 0.9525; val_best_f1_score: 0.9534; train_kl_reg_loss: 13849.3120; train_edge_recon_loss: 2597846.7883; train_gene_expr_recon_loss: 11781380.0242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14393076.1353; train_optim_loss: 14393076.1353; val_kl_reg_loss: 13813.1563; val_edge_recon_loss: 2611647.6667; val_gene_expr_recon_loss: 11810854.0463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14436314.8889; val_optim_loss: 14436314.8889
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9887; val_auprc_score: 0.9867; val_best_acc_score: 0.9531; val_best_f1_score: 0.9541; train_kl_reg_loss: 13824.0788; train_edge_recon_loss: 2597212.4437; train_gene_expr_recon_loss: 11778499.4866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14389536.0036; train_optim_loss: 14389536.0036; val_kl_reg_loss: 13692.5889; val_edge_recon_loss: 2609073.0799; val_gene_expr_recon_loss: 11805478.0880; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14428243.7639; val_optim_loss: 14428243.7639

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9884; val_auprc_score: 0.9861; val_best_acc_score: 0.9521; val_best_f1_score: 0.9531; train_kl_reg_loss: 13940.4204; train_edge_recon_loss: 2596123.9988; train_gene_expr_recon_loss: 11765760.7644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14375825.1878; train_optim_loss: 14375825.1878; val_kl_reg_loss: 13850.5433; val_edge_recon_loss: 2610806.0891; val_gene_expr_recon_loss: 11784090.9213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14408747.5880; val_optim_loss: 14408747.5880
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9882; val_auprc_score: 0.9862; val_best_acc_score: 0.9517; val_best_f1_score: 0.9528; train_kl_reg_loss: 13975.2217; train_edge_recon_loss: 2597073.6565; train_gene_expr_recon_loss: 11766929.9733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14377978.8529; train_optim_loss: 14377978.8529; val_kl_reg_loss: 13810.1113; val_edge_recon_loss: 2613395.7743; val_gene_expr_recon_loss: 11793883.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14421089.7407; val_optim_loss: 14421089.7407
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9884; val_auprc_score: 0.9863; val_best_acc_score: 0.9523; val_best_f1_score: 0.9531; train_kl_reg_loss: 13962.4616; train_edge_recon_loss: 2596256.8188; train_gene_expr_recon_loss: 11764457.4419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14374676.7310; train_optim_loss: 14374676.7310; val_kl_reg_loss: 13831.8521; val_edge_recon_loss: 2610595.8819; val_gene_expr_recon_loss: 11796924.5093; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14421352.2315; val_optim_loss: 14421352.2315
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9883; val_auprc_score: 0.9859; val_best_acc_score: 0.9516; val_best_f1_score: 0.9525; train_kl_reg_loss: 13946.7159; train_edge_recon_loss: 2595740.2221; train_gene_expr_recon_loss: 11768965.9424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14378652.8837; train_optim_loss: 14378652.8837; val_kl_reg_loss: 13778.0295; val_edge_recon_loss: 2613303.4236; val_gene_expr_recon_loss: 11774727.4769; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14401808.9444; val_optim_loss: 14401808.9444
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9883; val_auprc_score: 0.9862; val_best_acc_score: 0.9525; val_best_f1_score: 0.9534; train_kl_reg_loss: 13928.1882; train_edge_recon_loss: 2596464.3349; train_gene_expr_recon_loss: 11762296.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14372689.3431; train_optim_loss: 14372689.3431; val_kl_reg_loss: 13768.5227; val_edge_recon_loss: 2609707.7025; val_gene_expr_recon_loss: 11788439.2407; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14411915.4398; val_optim_loss: 14411915.4398
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9886; val_auprc_score: 0.9867; val_best_acc_score: 0.9523; val_best_f1_score: 0.9533; train_kl_reg_loss: 13912.4824; train_edge_recon_loss: 2597136.3945; train_gene_expr_recon_loss: 11763710.7582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14374759.6415; train_optim_loss: 14374759.6415; val_kl_reg_loss: 13757.5417; val_edge_recon_loss: 2610099.0648; val_gene_expr_recon_loss: 11804746.8194; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14428603.4259; val_optim_loss: 14428603.4259
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9882; val_auprc_score: 0.9859; val_best_acc_score: 0.9514; val_best_f1_score: 0.9523; train_kl_reg_loss: 13891.5120; train_edge_recon_loss: 2596111.5177; train_gene_expr_recon_loss: 11760126.2922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14370129.3282; train_optim_loss: 14370129.3282; val_kl_reg_loss: 13739.1380; val_edge_recon_loss: 2612520.8866; val_gene_expr_recon_loss: 11789148.2037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14415408.2037; val_optim_loss: 14415408.2037
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9886; val_auprc_score: 0.9864; val_best_acc_score: 0.9527; val_best_f1_score: 0.9535; train_kl_reg_loss: 13882.7849; train_edge_recon_loss: 2597000.1012; train_gene_expr_recon_loss: 11769508.0936; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14380390.9841; train_optim_loss: 14380390.9841; val_kl_reg_loss: 13729.1595; val_edge_recon_loss: 2608652.9236; val_gene_expr_recon_loss: 11809759.3472; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14432141.4213; val_optim_loss: 14432141.4213

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9884; val_auprc_score: 0.9862; val_best_acc_score: 0.9519; val_best_f1_score: 0.9528; train_kl_reg_loss: 13871.5550; train_edge_recon_loss: 2595846.4839; train_gene_expr_recon_loss: 11759514.1481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14369232.1692; train_optim_loss: 14369232.1692; val_kl_reg_loss: 13739.7280; val_edge_recon_loss: 2610356.7454; val_gene_expr_recon_loss: 11783171.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14407267.7361; val_optim_loss: 14407267.7361
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9886; val_auprc_score: 0.9865; val_best_acc_score: 0.9526; val_best_f1_score: 0.9535; train_kl_reg_loss: 13874.8173; train_edge_recon_loss: 2596029.8319; train_gene_expr_recon_loss: 11765894.2829; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14375798.9362; train_optim_loss: 14375798.9362; val_kl_reg_loss: 13741.8415; val_edge_recon_loss: 2610357.3067; val_gene_expr_recon_loss: 11792297.8148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14416397.0139; val_optim_loss: 14416397.0139
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9884; val_auprc_score: 0.9862; val_best_acc_score: 0.9523; val_best_f1_score: 0.9531; train_kl_reg_loss: 13877.0855; train_edge_recon_loss: 2596052.4043; train_gene_expr_recon_loss: 11760111.7922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14370041.2798; train_optim_loss: 14370041.2798; val_kl_reg_loss: 13754.7668; val_edge_recon_loss: 2609895.5833; val_gene_expr_recon_loss: 11808740.8148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14432391.1574; val_optim_loss: 14432391.1574
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9882; val_auprc_score: 0.9860; val_best_acc_score: 0.9518; val_best_f1_score: 0.9528; train_kl_reg_loss: 13880.2232; train_edge_recon_loss: 2595690.9896; train_gene_expr_recon_loss: 11761082.0715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14370653.2989; train_optim_loss: 14370653.2989; val_kl_reg_loss: 13750.0920; val_edge_recon_loss: 2610468.4375; val_gene_expr_recon_loss: 11792040.8889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14416259.4074; val_optim_loss: 14416259.4074

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 557 min 37 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
Val AUROC score: 0.9882
Val AUPRC score: 0.9860
Val best accuracy score: 0.9521
Val best F1 score: 0.9529
Val gene expr MSE score: 2.5914

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
