None
Run timestamp: 16072023_202456_2002.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_2002']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9835; val_auprc_score: 0.9780; val_best_acc_score: 0.9471; val_best_f1_score: 0.9484; train_kl_reg_loss: 29477.5202; train_edge_recon_loss: 2682123.8355; train_gene_expr_recon_loss: 1204181.2651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3915782.6264; train_optim_loss: 3915782.6264; val_kl_reg_loss: 27555.2203; val_edge_recon_loss: 2614123.3320; val_gene_expr_recon_loss: 1095929.3227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3737607.8607; val_optim_loss: 3737607.8607
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9870; val_auprc_score: 0.9829; val_best_acc_score: 0.9556; val_best_f1_score: 0.9568; train_kl_reg_loss: 26272.8209; train_edge_recon_loss: 2601629.1884; train_gene_expr_recon_loss: 1074598.8157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3702500.8125; train_optim_loss: 3702500.8125; val_kl_reg_loss: 23985.3275; val_edge_recon_loss: 2599523.3074; val_gene_expr_recon_loss: 1050212.5020; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3673721.1434; val_optim_loss: 3673721.1434
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9881; val_auprc_score: 0.9841; val_best_acc_score: 0.9608; val_best_f1_score: 0.9617; train_kl_reg_loss: 23767.8929; train_edge_recon_loss: 2590565.7619; train_gene_expr_recon_loss: 1038432.3927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3652766.0510; train_optim_loss: 3652766.0510; val_kl_reg_loss: 22642.8906; val_edge_recon_loss: 2591785.3770; val_gene_expr_recon_loss: 1021859.9857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3636288.2377; val_optim_loss: 3636288.2377
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9897; val_auprc_score: 0.9865; val_best_acc_score: 0.9631; val_best_f1_score: 0.9639; train_kl_reg_loss: 22049.9352; train_edge_recon_loss: 2583800.6443; train_gene_expr_recon_loss: 1017951.3824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3623801.9586; train_optim_loss: 3623801.9586; val_kl_reg_loss: 20760.4690; val_edge_recon_loss: 2584409.8648; val_gene_expr_recon_loss: 1005862.5717; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3611032.8852; val_optim_loss: 3611032.8852
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9907; val_auprc_score: 0.9874; val_best_acc_score: 0.9659; val_best_f1_score: 0.9666; train_kl_reg_loss: 20773.7116; train_edge_recon_loss: 2577201.9913; train_gene_expr_recon_loss: 1003737.8401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3601713.5446; train_optim_loss: 3601713.5446; val_kl_reg_loss: 19874.4115; val_edge_recon_loss: 2582975.4754; val_gene_expr_recon_loss: 995937.4170; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3598787.3074; val_optim_loss: 3598787.3074
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9916; val_auprc_score: 0.9889; val_best_acc_score: 0.9686; val_best_f1_score: 0.9691; train_kl_reg_loss: 19747.1799; train_edge_recon_loss: 2575517.1677; train_gene_expr_recon_loss: 994235.2117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3589499.5561; train_optim_loss: 3589499.5561; val_kl_reg_loss: 18892.8810; val_edge_recon_loss: 2577901.5041; val_gene_expr_recon_loss: 989356.1465; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3586150.5287; val_optim_loss: 3586150.5287
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9916; val_auprc_score: 0.9890; val_best_acc_score: 0.9690; val_best_f1_score: 0.9694; train_kl_reg_loss: 18919.4447; train_edge_recon_loss: 2572539.0634; train_gene_expr_recon_loss: 987386.0142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3578844.5253; train_optim_loss: 3578844.5253; val_kl_reg_loss: 18538.9444; val_edge_recon_loss: 2576789.5779; val_gene_expr_recon_loss: 981940.7766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3577269.3074; val_optim_loss: 3577269.3074
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9932; val_auprc_score: 0.9912; val_best_acc_score: 0.9731; val_best_f1_score: 0.9736; train_kl_reg_loss: 18307.1483; train_edge_recon_loss: 2568892.4485; train_gene_expr_recon_loss: 981319.4408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3568519.0381; train_optim_loss: 3568519.0381; val_kl_reg_loss: 17665.2717; val_edge_recon_loss: 2572181.7746; val_gene_expr_recon_loss: 982706.6691; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3572553.7500; val_optim_loss: 3572553.7500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9936; val_auprc_score: 0.9917; val_best_acc_score: 0.9726; val_best_f1_score: 0.9729; train_kl_reg_loss: 17735.6745; train_edge_recon_loss: 2567337.0312; train_gene_expr_recon_loss: 975652.9197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3560725.6310; train_optim_loss: 3560725.6310; val_kl_reg_loss: 17233.8124; val_edge_recon_loss: 2571906.4467; val_gene_expr_recon_loss: 978151.3770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3567291.6148; val_optim_loss: 3567291.6148
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9941; val_auprc_score: 0.9923; val_best_acc_score: 0.9741; val_best_f1_score: 0.9744; train_kl_reg_loss: 17294.6115; train_edge_recon_loss: 2564747.2082; train_gene_expr_recon_loss: 971444.0908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3553485.9090; train_optim_loss: 3553485.9090; val_kl_reg_loss: 16895.3823; val_edge_recon_loss: 2569193.1025; val_gene_expr_recon_loss: 976514.4775; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3562602.9508; val_optim_loss: 3562602.9508
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9938; val_auprc_score: 0.9916; val_best_acc_score: 0.9742; val_best_f1_score: 0.9746; train_kl_reg_loss: 16840.4900; train_edge_recon_loss: 2563910.3479; train_gene_expr_recon_loss: 968502.8073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3549253.6415; train_optim_loss: 3549253.6415; val_kl_reg_loss: 16369.8362; val_edge_recon_loss: 2569388.5082; val_gene_expr_recon_loss: 971724.4498; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3557482.8197; val_optim_loss: 3557482.8197
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9943; val_auprc_score: 0.9925; val_best_acc_score: 0.9763; val_best_f1_score: 0.9766; train_kl_reg_loss: 16488.0387; train_edge_recon_loss: 2562560.6264; train_gene_expr_recon_loss: 966018.0161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3545066.6829; train_optim_loss: 3545066.6829; val_kl_reg_loss: 16160.5028; val_edge_recon_loss: 2565392.7828; val_gene_expr_recon_loss: 970163.6127; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3551716.9016; val_optim_loss: 3551716.9016
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9949; val_auprc_score: 0.9933; val_best_acc_score: 0.9773; val_best_f1_score: 0.9776; train_kl_reg_loss: 16213.8157; train_edge_recon_loss: 2560598.2656; train_gene_expr_recon_loss: 962125.9334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3538938.0110; train_optim_loss: 3538938.0110; val_kl_reg_loss: 15991.5381; val_edge_recon_loss: 2566226.9057; val_gene_expr_recon_loss: 969834.5789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3552053.0287; val_optim_loss: 3552053.0287
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9951; val_auprc_score: 0.9937; val_best_acc_score: 0.9773; val_best_f1_score: 0.9776; train_kl_reg_loss: 15954.5047; train_edge_recon_loss: 2560242.9292; train_gene_expr_recon_loss: 959910.5055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3536107.9384; train_optim_loss: 3536107.9384; val_kl_reg_loss: 15688.2107; val_edge_recon_loss: 2565745.5820; val_gene_expr_recon_loss: 969853.5953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3551287.4139; val_optim_loss: 3551287.4139
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9950; val_auprc_score: 0.9935; val_best_acc_score: 0.9775; val_best_f1_score: 0.9777; train_kl_reg_loss: 15757.8600; train_edge_recon_loss: 2559299.7831; train_gene_expr_recon_loss: 957317.8441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3532375.4913; train_optim_loss: 3532375.4913; val_kl_reg_loss: 15481.0300; val_edge_recon_loss: 2560923.0779; val_gene_expr_recon_loss: 973396.2592; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3549800.3648; val_optim_loss: 3549800.3648
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9954; val_auprc_score: 0.9939; val_best_acc_score: 0.9787; val_best_f1_score: 0.9789; train_kl_reg_loss: 15557.2357; train_edge_recon_loss: 2557930.6535; train_gene_expr_recon_loss: 954611.3095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3528099.1967; train_optim_loss: 3528099.1967; val_kl_reg_loss: 15335.3638; val_edge_recon_loss: 2564807.6680; val_gene_expr_recon_loss: 966659.1814; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3546802.1967; val_optim_loss: 3546802.1967
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9957; val_auprc_score: 0.9943; val_best_acc_score: 0.9801; val_best_f1_score: 0.9804; train_kl_reg_loss: 15404.6235; train_edge_recon_loss: 2557878.9292; train_gene_expr_recon_loss: 952801.3222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3526084.8764; train_optim_loss: 3526084.8764; val_kl_reg_loss: 15086.3262; val_edge_recon_loss: 2562012.7951; val_gene_expr_recon_loss: 965897.5697; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3542996.6926; val_optim_loss: 3542996.6926
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9957; val_auprc_score: 0.9945; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 15286.0311; train_edge_recon_loss: 2557469.6232; train_gene_expr_recon_loss: 953449.7152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3526205.3741; train_optim_loss: 3526205.3741; val_kl_reg_loss: 15110.2660; val_edge_recon_loss: 2560736.2910; val_gene_expr_recon_loss: 963496.7480; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3539343.3074; val_optim_loss: 3539343.3074
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9961; val_auprc_score: 0.9947; val_best_acc_score: 0.9813; val_best_f1_score: 0.9815; train_kl_reg_loss: 15155.6955; train_edge_recon_loss: 2557223.1475; train_gene_expr_recon_loss: 950990.6152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3523369.4472; train_optim_loss: 3523369.4472; val_kl_reg_loss: 14696.5753; val_edge_recon_loss: 2560385.6189; val_gene_expr_recon_loss: 944852.5451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3519934.7705; val_optim_loss: 3519934.7705
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9956; val_auprc_score: 0.9941; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 15051.6852; train_edge_recon_loss: 2555711.9936; train_gene_expr_recon_loss: 946220.9959; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3516984.6710; train_optim_loss: 3516984.6710; val_kl_reg_loss: 14910.4706; val_edge_recon_loss: 2559806.0328; val_gene_expr_recon_loss: 942290.9037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3517007.4139; val_optim_loss: 3517007.4139
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9958; val_auprc_score: 0.9943; val_best_acc_score: 0.9813; val_best_f1_score: 0.9815; train_kl_reg_loss: 14954.0647; train_edge_recon_loss: 2555491.9807; train_gene_expr_recon_loss: 940645.2108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3511091.2541; train_optim_loss: 3511091.2541; val_kl_reg_loss: 14889.9405; val_edge_recon_loss: 2560151.5574; val_gene_expr_recon_loss: 962373.5861; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3537415.0738; val_optim_loss: 3537415.0738
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9960; val_auprc_score: 0.9947; val_best_acc_score: 0.9817; val_best_f1_score: 0.9819; train_kl_reg_loss: 14873.0724; train_edge_recon_loss: 2555683.1503; train_gene_expr_recon_loss: 937498.0980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3508054.3153; train_optim_loss: 3508054.3153; val_kl_reg_loss: 14789.5499; val_edge_recon_loss: 2561070.0697; val_gene_expr_recon_loss: 972783.7111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3548643.3484; val_optim_loss: 3548643.3484
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9962; val_auprc_score: 0.9950; val_best_acc_score: 0.9815; val_best_f1_score: 0.9817; train_kl_reg_loss: 14786.9006; train_edge_recon_loss: 2555353.2923; train_gene_expr_recon_loss: 934425.5655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3504565.7610; train_optim_loss: 3504565.7610; val_kl_reg_loss: 14698.0356; val_edge_recon_loss: 2559688.6639; val_gene_expr_recon_loss: 947182.8719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3521569.5820; val_optim_loss: 3521569.5820
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9965; val_auprc_score: 0.9954; val_best_acc_score: 0.9822; val_best_f1_score: 0.9823; train_kl_reg_loss: 14759.1672; train_edge_recon_loss: 2553847.3801; train_gene_expr_recon_loss: 931403.1270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3500009.6742; train_optim_loss: 3500009.6742; val_kl_reg_loss: 14576.2147; val_edge_recon_loss: 2558566.0451; val_gene_expr_recon_loss: 956350.8084; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3529493.0861; val_optim_loss: 3529493.0861

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9966; val_auprc_score: 0.9956; val_best_acc_score: 0.9827; val_best_f1_score: 0.9829; train_kl_reg_loss: 15030.0887; train_edge_recon_loss: 2553248.5253; train_gene_expr_recon_loss: 927294.7870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3495573.3961; train_optim_loss: 3495573.3961; val_kl_reg_loss: 14966.2049; val_edge_recon_loss: 2557106.9918; val_gene_expr_recon_loss: 971313.4477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3543386.6270; val_optim_loss: 3543386.6270
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9965; val_auprc_score: 0.9953; val_best_acc_score: 0.9822; val_best_f1_score: 0.9824; train_kl_reg_loss: 15174.2577; train_edge_recon_loss: 2552852.5933; train_gene_expr_recon_loss: 920799.1574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3488826.0110; train_optim_loss: 3488826.0110; val_kl_reg_loss: 14922.8330; val_edge_recon_loss: 2557570.3115; val_gene_expr_recon_loss: 953658.8391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3526151.9918; val_optim_loss: 3526151.9918
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9962; val_auprc_score: 0.9946; val_best_acc_score: 0.9821; val_best_f1_score: 0.9823; train_kl_reg_loss: 15160.5114; train_edge_recon_loss: 2551799.0873; train_gene_expr_recon_loss: 920303.3809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3487262.9812; train_optim_loss: 3487262.9812; val_kl_reg_loss: 14960.7993; val_edge_recon_loss: 2558157.1680; val_gene_expr_recon_loss: 948119.5840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3521237.5492; val_optim_loss: 3521237.5492
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9966; val_auprc_score: 0.9954; val_best_acc_score: 0.9827; val_best_f1_score: 0.9829; train_kl_reg_loss: 15160.6591; train_edge_recon_loss: 2553754.6167; train_gene_expr_recon_loss: 918776.5731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3487691.8460; train_optim_loss: 3487691.8460; val_kl_reg_loss: 14952.2148; val_edge_recon_loss: 2557201.1066; val_gene_expr_recon_loss: 961843.8740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3533997.2172; val_optim_loss: 3533997.2172

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 146 min 35 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
Val AUROC score: 0.9959
Val AUPRC score: 0.9943
Val best accuracy score: 0.9812
Val best F1 score: 0.9814
Val gene expr MSE score: 0.6501

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
