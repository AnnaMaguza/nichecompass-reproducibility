None
Run timestamp: 03072023_122014_2002.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_2002']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9844; val_auprc_score: 0.9768; val_best_acc_score: 0.9560; val_best_f1_score: 0.9571; train_kl_reg_loss: 5768.8609; train_edge_recon_loss: 264435.8097; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270204.6709; train_optim_loss: 270204.6709; val_kl_reg_loss: 5608.8121; val_edge_recon_loss: 257511.3543; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263120.1673; val_optim_loss: 263120.1673
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9877; val_auprc_score: 0.9817; val_best_acc_score: 0.9650; val_best_f1_score: 0.9658; train_kl_reg_loss: 5664.9799; train_edge_recon_loss: 258010.4874; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263675.4672; train_optim_loss: 263675.4672; val_kl_reg_loss: 5632.0131; val_edge_recon_loss: 256515.3924; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262147.4050; val_optim_loss: 262147.4050
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9885; val_auprc_score: 0.9827; val_best_acc_score: 0.9672; val_best_f1_score: 0.9679; train_kl_reg_loss: 5652.4612; train_edge_recon_loss: 257301.4227; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262953.8842; train_optim_loss: 262953.8842; val_kl_reg_loss: 5665.5816; val_edge_recon_loss: 256109.7180; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261775.3015; val_optim_loss: 261775.3015
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9909; val_auprc_score: 0.9866; val_best_acc_score: 0.9718; val_best_f1_score: 0.9723; train_kl_reg_loss: 5641.8893; train_edge_recon_loss: 257010.0034; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262651.8925; train_optim_loss: 262651.8925; val_kl_reg_loss: 5464.5234; val_edge_recon_loss: 255649.3253; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261113.8491; val_optim_loss: 261113.8491
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9910; val_auprc_score: 0.9861; val_best_acc_score: 0.9730; val_best_f1_score: 0.9734; train_kl_reg_loss: 5631.2482; train_edge_recon_loss: 256794.9240; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262426.1720; train_optim_loss: 262426.1720; val_kl_reg_loss: 5516.4633; val_edge_recon_loss: 255567.9905; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261084.4539; val_optim_loss: 261084.4539
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9919; val_auprc_score: 0.9880; val_best_acc_score: 0.9742; val_best_f1_score: 0.9746; train_kl_reg_loss: 5625.1449; train_edge_recon_loss: 256619.2544; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262244.3991; train_optim_loss: 262244.3991; val_kl_reg_loss: 5671.2601; val_edge_recon_loss: 255389.4326; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261060.6934; val_optim_loss: 261060.6934
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9928; val_auprc_score: 0.9896; val_best_acc_score: 0.9752; val_best_f1_score: 0.9755; train_kl_reg_loss: 5620.2285; train_edge_recon_loss: 256409.8620; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262030.0909; train_optim_loss: 262030.0909; val_kl_reg_loss: 5539.8590; val_edge_recon_loss: 255299.2702; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260839.1291; val_optim_loss: 260839.1291
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9933; val_auprc_score: 0.9901; val_best_acc_score: 0.9753; val_best_f1_score: 0.9757; train_kl_reg_loss: 5619.9163; train_edge_recon_loss: 256219.2986; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261839.2150; train_optim_loss: 261839.2150; val_kl_reg_loss: 5740.7246; val_edge_recon_loss: 255100.0195; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260840.7439; val_optim_loss: 260840.7439
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9935; val_auprc_score: 0.9901; val_best_acc_score: 0.9774; val_best_f1_score: 0.9778; train_kl_reg_loss: 5619.3286; train_edge_recon_loss: 256085.0909; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261704.4191; train_optim_loss: 261704.4191; val_kl_reg_loss: 5555.4315; val_edge_recon_loss: 255045.7979; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260601.2298; val_optim_loss: 260601.2298
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9941; val_auprc_score: 0.9911; val_best_acc_score: 0.9788; val_best_f1_score: 0.9791; train_kl_reg_loss: 5613.6381; train_edge_recon_loss: 256083.6192; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261697.2570; train_optim_loss: 261697.2570; val_kl_reg_loss: 5719.0648; val_edge_recon_loss: 254981.9588; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260701.0236; val_optim_loss: 260701.0236
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9943; val_auprc_score: 0.9910; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 5612.3138; train_edge_recon_loss: 255938.7148; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261551.0288; train_optim_loss: 261551.0288; val_kl_reg_loss: 5657.7837; val_edge_recon_loss: 254936.9103; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260594.6934; val_optim_loss: 260594.6934
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9947; val_auprc_score: 0.9917; val_best_acc_score: 0.9813; val_best_f1_score: 0.9815; train_kl_reg_loss: 5607.1095; train_edge_recon_loss: 255866.1763; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261473.2856; train_optim_loss: 261473.2856; val_kl_reg_loss: 5496.7395; val_edge_recon_loss: 254812.2034; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260308.9444; val_optim_loss: 260308.9444
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9949; val_auprc_score: 0.9921; val_best_acc_score: 0.9819; val_best_f1_score: 0.9821; train_kl_reg_loss: 5604.6518; train_edge_recon_loss: 255781.2172; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261385.8693; train_optim_loss: 261385.8693; val_kl_reg_loss: 5566.2287; val_edge_recon_loss: 254682.8099; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260249.0397; val_optim_loss: 260249.0397
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9949; val_auprc_score: 0.9917; val_best_acc_score: 0.9829; val_best_f1_score: 0.9831; train_kl_reg_loss: 5602.4339; train_edge_recon_loss: 255622.2953; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261224.7292; train_optim_loss: 261224.7292; val_kl_reg_loss: 5535.1385; val_edge_recon_loss: 254626.8786; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260162.0172; val_optim_loss: 260162.0172
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9956; val_auprc_score: 0.9936; val_best_acc_score: 0.9835; val_best_f1_score: 0.9837; train_kl_reg_loss: 5595.7199; train_edge_recon_loss: 255656.7156; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261252.4354; train_optim_loss: 261252.4354; val_kl_reg_loss: 5662.9201; val_edge_recon_loss: 254436.3963; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260099.3161; val_optim_loss: 260099.3161
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9953; val_auprc_score: 0.9926; val_best_acc_score: 0.9838; val_best_f1_score: 0.9840; train_kl_reg_loss: 5596.2149; train_edge_recon_loss: 255535.2433; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261131.4583; train_optim_loss: 261131.4583; val_kl_reg_loss: 5597.7348; val_edge_recon_loss: 254350.9867; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259948.7213; val_optim_loss: 259948.7213
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9957; val_auprc_score: 0.9932; val_best_acc_score: 0.9840; val_best_f1_score: 0.9842; train_kl_reg_loss: 5588.0953; train_edge_recon_loss: 255577.9852; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261166.0807; train_optim_loss: 261166.0807; val_kl_reg_loss: 5480.1239; val_edge_recon_loss: 254536.8112; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260016.9352; val_optim_loss: 260016.9352
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9959; val_auprc_score: 0.9936; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 5583.6297; train_edge_recon_loss: 255520.0788; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261103.7086; train_optim_loss: 261103.7086; val_kl_reg_loss: 5552.6640; val_edge_recon_loss: 254179.2982; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259731.9616; val_optim_loss: 259731.9616
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9960; val_auprc_score: 0.9940; val_best_acc_score: 0.9853; val_best_f1_score: 0.9855; train_kl_reg_loss: 5580.5682; train_edge_recon_loss: 255438.3972; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261018.9654; train_optim_loss: 261018.9654; val_kl_reg_loss: 5554.8835; val_edge_recon_loss: 254243.1637; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259798.0474; val_optim_loss: 259798.0474
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9960; val_auprc_score: 0.9935; val_best_acc_score: 0.9852; val_best_f1_score: 0.9853; train_kl_reg_loss: 5580.8965; train_edge_recon_loss: 255337.8570; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260918.7533; train_optim_loss: 260918.7533; val_kl_reg_loss: 5525.8398; val_edge_recon_loss: 254211.4772; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259737.3174; val_optim_loss: 259737.3174
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9961; val_auprc_score: 0.9940; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 5578.7266; train_edge_recon_loss: 255269.9125; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260848.6391; train_optim_loss: 260848.6391; val_kl_reg_loss: 5616.5351; val_edge_recon_loss: 254267.4511; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259883.9874; val_optim_loss: 259883.9874
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9960; val_auprc_score: 0.9937; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 5573.2172; train_edge_recon_loss: 255302.6656; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260875.8824; train_optim_loss: 260875.8824; val_kl_reg_loss: 5561.0515; val_edge_recon_loss: 254352.0789; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259913.1299; val_optim_loss: 259913.1299

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9963; val_auprc_score: 0.9941; val_best_acc_score: 0.9865; val_best_f1_score: 0.9866; train_kl_reg_loss: 5555.3734; train_edge_recon_loss: 255147.4361; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260702.8094; train_optim_loss: 260702.8094; val_kl_reg_loss: 5523.6415; val_edge_recon_loss: 254005.5156; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259529.1578; val_optim_loss: 259529.1578
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9968; val_auprc_score: 0.9950; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 5547.1855; train_edge_recon_loss: 255175.2032; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260722.3889; train_optim_loss: 260722.3889; val_kl_reg_loss: 5522.5701; val_edge_recon_loss: 253810.8553; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259333.4255; val_optim_loss: 259333.4255
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9963; val_auprc_score: 0.9943; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 5546.6294; train_edge_recon_loss: 255091.3635; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260637.9926; train_optim_loss: 260637.9926; val_kl_reg_loss: 5497.2108; val_edge_recon_loss: 254303.4705; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259800.6816; val_optim_loss: 259800.6816
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9965; val_auprc_score: 0.9946; val_best_acc_score: 0.9868; val_best_f1_score: 0.9869; train_kl_reg_loss: 5544.8023; train_edge_recon_loss: 255077.1204; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260621.9227; train_optim_loss: 260621.9227; val_kl_reg_loss: 5503.3050; val_edge_recon_loss: 253961.1555; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259464.4611; val_optim_loss: 259464.4611
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9966; val_auprc_score: 0.9946; val_best_acc_score: 0.9872; val_best_f1_score: 0.9873; train_kl_reg_loss: 5542.7164; train_edge_recon_loss: 255083.3085; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260626.0253; train_optim_loss: 260626.0253; val_kl_reg_loss: 5531.2764; val_edge_recon_loss: 253875.9088; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259407.1857; val_optim_loss: 259407.1857
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9966; val_auprc_score: 0.9946; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 5538.1810; train_edge_recon_loss: 255149.9411; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260688.1220; train_optim_loss: 260688.1220; val_kl_reg_loss: 5494.5490; val_edge_recon_loss: 254189.6532; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259684.2024; val_optim_loss: 259684.2024

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9969; val_auprc_score: 0.9954; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 5540.8152; train_edge_recon_loss: 255073.5836; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260614.3991; train_optim_loss: 260614.3991; val_kl_reg_loss: 5523.5124; val_edge_recon_loss: 253771.3763; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259294.8886; val_optim_loss: 259294.8886
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9968; val_auprc_score: 0.9950; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 5541.0470; train_edge_recon_loss: 255045.1056; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260586.1525; train_optim_loss: 260586.1525; val_kl_reg_loss: 5520.4906; val_edge_recon_loss: 253707.4900; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259227.9800; val_optim_loss: 259227.9800
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9967; val_auprc_score: 0.9948; val_best_acc_score: 0.9872; val_best_f1_score: 0.9873; train_kl_reg_loss: 5538.1626; train_edge_recon_loss: 255077.1833; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260615.3461; train_optim_loss: 260615.3461; val_kl_reg_loss: 5522.4387; val_edge_recon_loss: 253854.4749; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259376.9127; val_optim_loss: 259376.9127
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9967; val_auprc_score: 0.9946; val_best_acc_score: 0.9875; val_best_f1_score: 0.9876; train_kl_reg_loss: 5538.7428; train_edge_recon_loss: 255061.2989; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260600.0414; train_optim_loss: 260600.0414; val_kl_reg_loss: 5519.9437; val_edge_recon_loss: 253727.0246; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259246.9680; val_optim_loss: 259246.9680
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9966; val_auprc_score: 0.9945; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 5536.7354; train_edge_recon_loss: 255169.6247; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260706.3605; train_optim_loss: 260706.3605; val_kl_reg_loss: 5512.8939; val_edge_recon_loss: 253817.8635; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259330.7577; val_optim_loss: 259330.7577
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9965; val_auprc_score: 0.9942; val_best_acc_score: 0.9872; val_best_f1_score: 0.9873; train_kl_reg_loss: 5536.6835; train_edge_recon_loss: 255089.8408; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260626.5242; train_optim_loss: 260626.5242; val_kl_reg_loss: 5513.0448; val_edge_recon_loss: 254032.1214; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259545.1668; val_optim_loss: 259545.1668

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9965; val_auprc_score: 0.9942; val_best_acc_score: 0.9872; val_best_f1_score: 0.9873; train_kl_reg_loss: 5535.1288; train_edge_recon_loss: 255137.6757; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260672.8046; train_optim_loss: 260672.8046; val_kl_reg_loss: 5516.4269; val_edge_recon_loss: 253913.8537; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259430.2802; val_optim_loss: 259430.2802
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9969; val_auprc_score: 0.9950; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 5537.8198; train_edge_recon_loss: 255017.7875; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260555.6076; train_optim_loss: 260555.6076; val_kl_reg_loss: 5517.2577; val_edge_recon_loss: 253788.9995; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259306.2561; val_optim_loss: 259306.2561
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9966; val_auprc_score: 0.9949; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 5536.7417; train_edge_recon_loss: 255037.3843; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260574.1263; train_optim_loss: 260574.1263; val_kl_reg_loss: 5519.5572; val_edge_recon_loss: 253859.5968; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259379.1542; val_optim_loss: 259379.1542
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9963; val_auprc_score: 0.9941; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 5537.4738; train_edge_recon_loss: 255071.5672; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260609.0406; train_optim_loss: 260609.0406; val_kl_reg_loss: 5517.7003; val_edge_recon_loss: 254121.1816; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259638.8822; val_optim_loss: 259638.8822

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 212 min 45 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9966
Val AUPRC score: 0.9946
Val best accuracy score: 0.9871
Val best F1 score: 0.9872
Val gene expr MSE score: 0.9291

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
