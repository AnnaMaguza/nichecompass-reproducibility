None
Run timestamp: 28072023_154957_64.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_64']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9701; val_auprc_score: 0.9679; val_best_acc_score: 0.9111; val_best_f1_score: 0.9127; train_kl_reg_loss: 1959.1051; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 119258.8277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 121217.9327; train_optim_loss: 121217.9327; val_kl_reg_loss: 1471.0964; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 109593.7743; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 111064.8706; val_optim_loss: 111064.8706
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9764; val_auprc_score: 0.9746; val_best_acc_score: 0.9227; val_best_f1_score: 0.9240; train_kl_reg_loss: 1378.2116; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 108107.2858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 109485.4973; train_optim_loss: 109485.4973; val_kl_reg_loss: 1297.9179; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 106097.8147; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 107395.7327; val_optim_loss: 107395.7327
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9785; val_auprc_score: 0.9771; val_best_acc_score: 0.9268; val_best_f1_score: 0.9271; train_kl_reg_loss: 1279.8233; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 106061.3671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 107341.1905; train_optim_loss: 107341.1905; val_kl_reg_loss: 1241.1690; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 105128.3589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 106369.5279; val_optim_loss: 106369.5279
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9798; val_auprc_score: 0.9785; val_best_acc_score: 0.9295; val_best_f1_score: 0.9302; train_kl_reg_loss: 1240.8503; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 105369.2247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 106610.0749; train_optim_loss: 106610.0749; val_kl_reg_loss: 1216.3496; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 104672.7458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105889.0954; val_optim_loss: 105889.0954
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9782; val_auprc_score: 0.9765; val_best_acc_score: 0.9265; val_best_f1_score: 0.9268; train_kl_reg_loss: 1219.3592; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 105095.0803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 106314.4396; train_optim_loss: 106314.4396; val_kl_reg_loss: 1209.1302; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 104503.0692; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105712.1992; val_optim_loss: 105712.1992
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9792; val_auprc_score: 0.9781; val_best_acc_score: 0.9274; val_best_f1_score: 0.9281; train_kl_reg_loss: 1204.4783; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 104939.4291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 106143.9075; train_optim_loss: 106143.9075; val_kl_reg_loss: 1209.3662; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 104399.9822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105609.3483; val_optim_loss: 105609.3483
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9804; val_auprc_score: 0.9794; val_best_acc_score: 0.9301; val_best_f1_score: 0.9307; train_kl_reg_loss: 1194.7308; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 104784.4945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105979.2252; train_optim_loss: 105979.2252; val_kl_reg_loss: 1176.2026; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 104306.9471; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105483.1494; val_optim_loss: 105483.1494
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9810; val_auprc_score: 0.9799; val_best_acc_score: 0.9310; val_best_f1_score: 0.9310; train_kl_reg_loss: 1189.9549; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 104687.5103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105877.4652; train_optim_loss: 105877.4652; val_kl_reg_loss: 1176.9802; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 104316.6337; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105493.6138; val_optim_loss: 105493.6138
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9795; val_auprc_score: 0.9781; val_best_acc_score: 0.9288; val_best_f1_score: 0.9292; train_kl_reg_loss: 1186.2617; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 104654.2125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105840.4743; train_optim_loss: 105840.4743; val_kl_reg_loss: 1171.3025; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 104222.2994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105393.6017; val_optim_loss: 105393.6017
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9813; val_auprc_score: 0.9803; val_best_acc_score: 0.9314; val_best_f1_score: 0.9322; train_kl_reg_loss: 1183.7289; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 104621.3858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105805.1147; train_optim_loss: 105805.1147; val_kl_reg_loss: 1168.3796; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 104398.8133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105567.1928; val_optim_loss: 105567.1928
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9813; val_auprc_score: 0.9800; val_best_acc_score: 0.9322; val_best_f1_score: 0.9332; train_kl_reg_loss: 1182.4209; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 104557.0839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105739.5049; train_optim_loss: 105739.5049; val_kl_reg_loss: 1179.2464; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 104433.8204; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105613.0667; val_optim_loss: 105613.0667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9819; val_auprc_score: 0.9807; val_best_acc_score: 0.9329; val_best_f1_score: 0.9332; train_kl_reg_loss: 1183.1858; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 104562.5536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105745.7394; train_optim_loss: 105745.7394; val_kl_reg_loss: 1145.8914; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 104195.7673; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105341.6587; val_optim_loss: 105341.6587
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9800; val_auprc_score: 0.9784; val_best_acc_score: 0.9298; val_best_f1_score: 0.9303; train_kl_reg_loss: 1182.3827; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 104500.8234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105683.2061; train_optim_loss: 105683.2061; val_kl_reg_loss: 1171.8414; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 104388.8342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105560.6755; val_optim_loss: 105560.6755
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9813; val_auprc_score: 0.9802; val_best_acc_score: 0.9316; val_best_f1_score: 0.9322; train_kl_reg_loss: 1182.0585; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 104443.1376; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105625.1961; train_optim_loss: 105625.1961; val_kl_reg_loss: 1169.9128; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 104190.5471; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105360.4598; val_optim_loss: 105360.4598
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9839; val_auprc_score: 0.9831; val_best_acc_score: 0.9367; val_best_f1_score: 0.9375; train_kl_reg_loss: 1181.0966; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 104426.3560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105607.4526; train_optim_loss: 105607.4526; val_kl_reg_loss: 1176.5389; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 104296.4168; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105472.9554; val_optim_loss: 105472.9554
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9827; val_auprc_score: 0.9816; val_best_acc_score: 0.9344; val_best_f1_score: 0.9351; train_kl_reg_loss: 1181.4884; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 104388.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105570.1967; train_optim_loss: 105570.1967; val_kl_reg_loss: 1165.9357; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 104160.9007; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105326.8366; val_optim_loss: 105326.8366
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9842; val_auprc_score: 0.9833; val_best_acc_score: 0.9373; val_best_f1_score: 0.9378; train_kl_reg_loss: 1181.5434; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 104381.0171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105562.5605; train_optim_loss: 105562.5605; val_kl_reg_loss: 1165.9504; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 104273.4851; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105439.4353; val_optim_loss: 105439.4353
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9817; val_auprc_score: 0.9803; val_best_acc_score: 0.9329; val_best_f1_score: 0.9336; train_kl_reg_loss: 1181.9903; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 104338.8779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105520.8682; train_optim_loss: 105520.8682; val_kl_reg_loss: 1158.4182; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 104114.4565; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105272.8746; val_optim_loss: 105272.8746
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9841; val_auprc_score: 0.9834; val_best_acc_score: 0.9372; val_best_f1_score: 0.9376; train_kl_reg_loss: 1181.3934; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 104337.3325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105518.7259; train_optim_loss: 105518.7259; val_kl_reg_loss: 1183.2687; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 104206.1506; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105389.4193; val_optim_loss: 105389.4193
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9815; val_auprc_score: 0.9804; val_best_acc_score: 0.9321; val_best_f1_score: 0.9323; train_kl_reg_loss: 1181.7752; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 104309.4929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105491.2681; train_optim_loss: 105491.2681; val_kl_reg_loss: 1184.2773; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 104069.1113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105253.3886; val_optim_loss: 105253.3886
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9834; val_auprc_score: 0.9825; val_best_acc_score: 0.9356; val_best_f1_score: 0.9356; train_kl_reg_loss: 1181.5195; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 104279.0619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105460.5813; train_optim_loss: 105460.5813; val_kl_reg_loss: 1185.5855; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 104151.1018; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105336.6873; val_optim_loss: 105336.6873
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9821; val_auprc_score: 0.9809; val_best_acc_score: 0.9327; val_best_f1_score: 0.9331; train_kl_reg_loss: 1181.2086; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 104296.5372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105477.7459; train_optim_loss: 105477.7459; val_kl_reg_loss: 1195.4525; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 104203.6360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105399.0881; val_optim_loss: 105399.0881
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9829; val_auprc_score: 0.9819; val_best_acc_score: 0.9349; val_best_f1_score: 0.9353; train_kl_reg_loss: 1182.1301; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 104297.8648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105479.9949; train_optim_loss: 105479.9949; val_kl_reg_loss: 1178.5874; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 104106.5910; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105285.1784; val_optim_loss: 105285.1784
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9823; val_auprc_score: 0.9810; val_best_acc_score: 0.9336; val_best_f1_score: 0.9342; train_kl_reg_loss: 1180.8155; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 104299.3700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105480.1855; train_optim_loss: 105480.1855; val_kl_reg_loss: 1177.9316; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 104198.2456; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105376.1773; val_optim_loss: 105376.1773

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9843; val_auprc_score: 0.9834; val_best_acc_score: 0.9372; val_best_f1_score: 0.9375; train_kl_reg_loss: 1158.9919; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103808.2663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104967.2581; train_optim_loss: 104967.2581; val_kl_reg_loss: 1142.9429; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103860.8012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105003.7440; val_optim_loss: 105003.7440
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9853; val_auprc_score: 0.9846; val_best_acc_score: 0.9391; val_best_f1_score: 0.9392; train_kl_reg_loss: 1151.4712; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103721.6160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104873.0872; train_optim_loss: 104873.0872; val_kl_reg_loss: 1140.4297; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103765.6600; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104906.0897; val_optim_loss: 104906.0897
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9856; val_auprc_score: 0.9850; val_best_acc_score: 0.9395; val_best_f1_score: 0.9403; train_kl_reg_loss: 1150.4582; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103763.2296; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104913.6878; train_optim_loss: 104913.6878; val_kl_reg_loss: 1142.0572; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103808.9252; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104950.9824; val_optim_loss: 104950.9824
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9855; val_auprc_score: 0.9848; val_best_acc_score: 0.9396; val_best_f1_score: 0.9404; train_kl_reg_loss: 1150.3084; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103734.5288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104884.8372; train_optim_loss: 104884.8372; val_kl_reg_loss: 1135.4257; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103764.2361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104899.6617; val_optim_loss: 104899.6617
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9853; val_auprc_score: 0.9847; val_best_acc_score: 0.9386; val_best_f1_score: 0.9391; train_kl_reg_loss: 1151.3052; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103730.0847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104881.3900; train_optim_loss: 104881.3900; val_kl_reg_loss: 1145.5384; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103911.4733; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105057.0118; val_optim_loss: 105057.0118
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9858; val_auprc_score: 0.9850; val_best_acc_score: 0.9401; val_best_f1_score: 0.9408; train_kl_reg_loss: 1150.1620; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103696.2172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104846.3792; train_optim_loss: 104846.3792; val_kl_reg_loss: 1135.8823; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103774.4006; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104910.2829; val_optim_loss: 104910.2829
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9856; val_auprc_score: 0.9849; val_best_acc_score: 0.9400; val_best_f1_score: 0.9407; train_kl_reg_loss: 1150.1290; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103719.1365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104869.2655; train_optim_loss: 104869.2655; val_kl_reg_loss: 1138.6142; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103704.4783; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104843.0923; val_optim_loss: 104843.0923
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9859; val_auprc_score: 0.9852; val_best_acc_score: 0.9405; val_best_f1_score: 0.9412; train_kl_reg_loss: 1150.5017; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103708.2266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104858.7283; train_optim_loss: 104858.7283; val_kl_reg_loss: 1142.3168; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103907.4658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105049.7825; val_optim_loss: 105049.7825
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9866; val_auprc_score: 0.9861; val_best_acc_score: 0.9421; val_best_f1_score: 0.9427; train_kl_reg_loss: 1151.0056; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103669.3965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104820.4020; train_optim_loss: 104820.4020; val_kl_reg_loss: 1138.1892; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103902.8020; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105040.9914; val_optim_loss: 105040.9914
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9857; val_auprc_score: 0.9851; val_best_acc_score: 0.9397; val_best_f1_score: 0.9399; train_kl_reg_loss: 1150.1822; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103695.1398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104845.3219; train_optim_loss: 104845.3219; val_kl_reg_loss: 1143.3090; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103777.0982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104920.4073; val_optim_loss: 104920.4073
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9861; val_auprc_score: 0.9856; val_best_acc_score: 0.9408; val_best_f1_score: 0.9414; train_kl_reg_loss: 1150.3223; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103694.1976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104844.5199; train_optim_loss: 104844.5199; val_kl_reg_loss: 1140.2379; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103840.5139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104980.7518; val_optim_loss: 104980.7518

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9862; val_auprc_score: 0.9856; val_best_acc_score: 0.9411; val_best_f1_score: 0.9417; train_kl_reg_loss: 1148.5495; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103643.8245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104792.3740; train_optim_loss: 104792.3740; val_kl_reg_loss: 1138.4564; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103761.0019; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104899.4583; val_optim_loss: 104899.4583
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9856; val_auprc_score: 0.9848; val_best_acc_score: 0.9398; val_best_f1_score: 0.9405; train_kl_reg_loss: 1149.4811; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103628.6029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104778.0840; train_optim_loss: 104778.0840; val_kl_reg_loss: 1140.6487; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103717.1545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104857.8034; val_optim_loss: 104857.8034
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9860; val_auprc_score: 0.9853; val_best_acc_score: 0.9407; val_best_f1_score: 0.9413; train_kl_reg_loss: 1149.3455; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103622.6159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104771.9615; train_optim_loss: 104771.9615; val_kl_reg_loss: 1139.8502; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103814.7388; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104954.5889; val_optim_loss: 104954.5889
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9859; val_auprc_score: 0.9852; val_best_acc_score: 0.9404; val_best_f1_score: 0.9410; train_kl_reg_loss: 1148.5721; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103631.9109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104780.4830; train_optim_loss: 104780.4830; val_kl_reg_loss: 1141.9327; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103725.2568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104867.1896; val_optim_loss: 104867.1896

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 804 min 56 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
val AUROC score: 0.9857
val AUPRC score: 0.9849
val best accuracy score: 0.9401
val best F1 score: 0.9408
val target rna MSE score: 1.4874
val source rna MSE score: 0.1074

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
