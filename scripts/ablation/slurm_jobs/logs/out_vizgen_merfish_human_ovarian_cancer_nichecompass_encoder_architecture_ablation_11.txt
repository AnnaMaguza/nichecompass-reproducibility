None
Run timestamp: 07082023_222454_11.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_fc_layers_encoder', '1', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--n_sampled_neighbors', '4', '--node_batch_size', 'None', '--timestamp_suffix', '_11']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_hidden: 500, n_latent: 1385, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1385, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 500
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1385, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 500

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9899; val_auprc_score: 0.9891; val_best_acc_score: 0.9516; val_best_f1_score: 0.9520; train_kl_reg_loss: 7876.4064; train_edge_recon_loss: 269448.5826; train_gene_expr_recon_loss: 180993.9034; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 458318.8926; train_optim_loss: 458318.8926; val_kl_reg_loss: 7927.2309; val_edge_recon_loss: 265356.3360; val_gene_expr_recon_loss: 153687.8585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 426971.4251; val_optim_loss: 426971.4251
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9926; val_auprc_score: 0.9920; val_best_acc_score: 0.9586; val_best_f1_score: 0.9589; train_kl_reg_loss: 8198.6361; train_edge_recon_loss: 263778.2536; train_gene_expr_recon_loss: 149026.8967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 421003.7862; train_optim_loss: 421003.7862; val_kl_reg_loss: 8275.8650; val_edge_recon_loss: 264222.9859; val_gene_expr_recon_loss: 144972.7176; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 417471.5688; val_optim_loss: 417471.5688
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9940; val_auprc_score: 0.9935; val_best_acc_score: 0.9645; val_best_f1_score: 0.9647; train_kl_reg_loss: 8248.8440; train_edge_recon_loss: 262938.5002; train_gene_expr_recon_loss: 144551.5902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 415738.9341; train_optim_loss: 415738.9341; val_kl_reg_loss: 8147.7277; val_edge_recon_loss: 263530.0205; val_gene_expr_recon_loss: 142534.9619; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 414212.7093; val_optim_loss: 414212.7093
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9945; val_auprc_score: 0.9940; val_best_acc_score: 0.9654; val_best_f1_score: 0.9656; train_kl_reg_loss: 8239.2029; train_edge_recon_loss: 262484.9600; train_gene_expr_recon_loss: 142916.9657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 413641.1285; train_optim_loss: 413641.1285; val_kl_reg_loss: 8172.8863; val_edge_recon_loss: 263455.9415; val_gene_expr_recon_loss: 141216.2091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 412845.0368; val_optim_loss: 412845.0368
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9941; val_auprc_score: 0.9938; val_best_acc_score: 0.9636; val_best_f1_score: 0.9637; train_kl_reg_loss: 8219.7621; train_edge_recon_loss: 262198.2280; train_gene_expr_recon_loss: 141964.1862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 412382.1764; train_optim_loss: 412382.1764; val_kl_reg_loss: 8324.6976; val_edge_recon_loss: 263021.1345; val_gene_expr_recon_loss: 141155.3524; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 412501.1833; val_optim_loss: 412501.1833
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9950; val_auprc_score: 0.9947; val_best_acc_score: 0.9675; val_best_f1_score: 0.9676; train_kl_reg_loss: 8193.1360; train_edge_recon_loss: 262054.4174; train_gene_expr_recon_loss: 141530.9842; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 411778.5379; train_optim_loss: 411778.5379; val_kl_reg_loss: 8220.3646; val_edge_recon_loss: 262894.1925; val_gene_expr_recon_loss: 140231.9505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 411346.5084; val_optim_loss: 411346.5084
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9951; val_auprc_score: 0.9947; val_best_acc_score: 0.9680; val_best_f1_score: 0.9681; train_kl_reg_loss: 8185.2864; train_edge_recon_loss: 261797.0861; train_gene_expr_recon_loss: 140877.5934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 410859.9662; train_optim_loss: 410859.9662; val_kl_reg_loss: 8147.1698; val_edge_recon_loss: 263293.7033; val_gene_expr_recon_loss: 141391.5287; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 412832.4020; val_optim_loss: 412832.4020
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9953; val_auprc_score: 0.9948; val_best_acc_score: 0.9686; val_best_f1_score: 0.9688; train_kl_reg_loss: 8168.1542; train_edge_recon_loss: 261743.7962; train_gene_expr_recon_loss: 140534.6304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 410446.5807; train_optim_loss: 410446.5807; val_kl_reg_loss: 8151.7627; val_edge_recon_loss: 262635.1966; val_gene_expr_recon_loss: 139740.3061; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 410527.2652; val_optim_loss: 410527.2652
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9954; val_auprc_score: 0.9949; val_best_acc_score: 0.9691; val_best_f1_score: 0.9692; train_kl_reg_loss: 8162.8881; train_edge_recon_loss: 261554.1634; train_gene_expr_recon_loss: 140722.6717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 410439.7232; train_optim_loss: 410439.7232; val_kl_reg_loss: 8025.7760; val_edge_recon_loss: 262493.9936; val_gene_expr_recon_loss: 139954.1498; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 410473.9196; val_optim_loss: 410473.9196
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9952; val_auprc_score: 0.9946; val_best_acc_score: 0.9690; val_best_f1_score: 0.9692; train_kl_reg_loss: 8147.9606; train_edge_recon_loss: 261451.5768; train_gene_expr_recon_loss: 140080.7084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 409680.2458; train_optim_loss: 409680.2458; val_kl_reg_loss: 8089.1350; val_edge_recon_loss: 262567.9490; val_gene_expr_recon_loss: 139570.9706; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 410228.0556; val_optim_loss: 410228.0556
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9956; val_auprc_score: 0.9952; val_best_acc_score: 0.9698; val_best_f1_score: 0.9699; train_kl_reg_loss: 8150.3066; train_edge_recon_loss: 261354.0704; train_gene_expr_recon_loss: 139814.5839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 409318.9608; train_optim_loss: 409318.9608; val_kl_reg_loss: 8084.3825; val_edge_recon_loss: 262565.6184; val_gene_expr_recon_loss: 138422.2922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 409072.2937; val_optim_loss: 409072.2937
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9956; val_auprc_score: 0.9952; val_best_acc_score: 0.9702; val_best_f1_score: 0.9704; train_kl_reg_loss: 8133.6091; train_edge_recon_loss: 261311.3052; train_gene_expr_recon_loss: 139494.9537; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 408939.8681; train_optim_loss: 408939.8681; val_kl_reg_loss: 8088.0561; val_edge_recon_loss: 262263.7343; val_gene_expr_recon_loss: 138902.0515; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 409253.8428; val_optim_loss: 409253.8428
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9957; val_auprc_score: 0.9952; val_best_acc_score: 0.9708; val_best_f1_score: 0.9708; train_kl_reg_loss: 8133.4936; train_edge_recon_loss: 261297.1887; train_gene_expr_recon_loss: 139313.2538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 408743.9358; train_optim_loss: 408743.9358; val_kl_reg_loss: 8099.1495; val_edge_recon_loss: 262472.5546; val_gene_expr_recon_loss: 143258.4790; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 413830.1824; val_optim_loss: 413830.1824
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9956; val_auprc_score: 0.9953; val_best_acc_score: 0.9705; val_best_f1_score: 0.9707; train_kl_reg_loss: 8132.4928; train_edge_recon_loss: 261178.5170; train_gene_expr_recon_loss: 139300.6803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 408611.6904; train_optim_loss: 408611.6904; val_kl_reg_loss: 8143.5964; val_edge_recon_loss: 262431.8958; val_gene_expr_recon_loss: 137844.0193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 408419.5116; val_optim_loss: 408419.5116
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9956; val_auprc_score: 0.9952; val_best_acc_score: 0.9699; val_best_f1_score: 0.9700; train_kl_reg_loss: 8139.4919; train_edge_recon_loss: 261211.2346; train_gene_expr_recon_loss: 139299.1190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 408649.8453; train_optim_loss: 408649.8453; val_kl_reg_loss: 8147.6957; val_edge_recon_loss: 262096.6813; val_gene_expr_recon_loss: 137914.3259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 408158.7032; val_optim_loss: 408158.7032
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9955; val_auprc_score: 0.9950; val_best_acc_score: 0.9702; val_best_f1_score: 0.9704; train_kl_reg_loss: 8125.7368; train_edge_recon_loss: 261136.4764; train_gene_expr_recon_loss: 138651.8723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 407914.0852; train_optim_loss: 407914.0852; val_kl_reg_loss: 8203.6621; val_edge_recon_loss: 262139.0946; val_gene_expr_recon_loss: 137489.5005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 407832.2580; val_optim_loss: 407832.2580
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9953; val_auprc_score: 0.9947; val_best_acc_score: 0.9699; val_best_f1_score: 0.9700; train_kl_reg_loss: 8124.8893; train_edge_recon_loss: 261091.9175; train_gene_expr_recon_loss: 138894.8468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 408111.6536; train_optim_loss: 408111.6536; val_kl_reg_loss: 8282.6993; val_edge_recon_loss: 262272.8159; val_gene_expr_recon_loss: 137400.3098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 407955.8248; val_optim_loss: 407955.8248
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9958; val_auprc_score: 0.9954; val_best_acc_score: 0.9712; val_best_f1_score: 0.9713; train_kl_reg_loss: 8129.8219; train_edge_recon_loss: 261069.5014; train_gene_expr_recon_loss: 139234.6067; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 408433.9299; train_optim_loss: 408433.9299; val_kl_reg_loss: 8243.1345; val_edge_recon_loss: 262189.4705; val_gene_expr_recon_loss: 139128.4126; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 409561.0183; val_optim_loss: 409561.0183
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9957; val_auprc_score: 0.9953; val_best_acc_score: 0.9711; val_best_f1_score: 0.9712; train_kl_reg_loss: 8134.9546; train_edge_recon_loss: 261044.8020; train_gene_expr_recon_loss: 138710.7606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 407890.5170; train_optim_loss: 407890.5170; val_kl_reg_loss: 8072.8600; val_edge_recon_loss: 262165.6711; val_gene_expr_recon_loss: 137812.3623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 408050.8937; val_optim_loss: 408050.8937
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9959; val_auprc_score: 0.9954; val_best_acc_score: 0.9718; val_best_f1_score: 0.9719; train_kl_reg_loss: 8117.7077; train_edge_recon_loss: 261029.4587; train_gene_expr_recon_loss: 138510.8704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 407658.0367; train_optim_loss: 407658.0367; val_kl_reg_loss: 8197.0656; val_edge_recon_loss: 261758.8351; val_gene_expr_recon_loss: 137655.2505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 407611.1517; val_optim_loss: 407611.1517
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9958; val_auprc_score: 0.9953; val_best_acc_score: 0.9716; val_best_f1_score: 0.9716; train_kl_reg_loss: 8133.6135; train_edge_recon_loss: 260968.9481; train_gene_expr_recon_loss: 138333.5139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 407436.0755; train_optim_loss: 407436.0755; val_kl_reg_loss: 8228.0252; val_edge_recon_loss: 261866.0449; val_gene_expr_recon_loss: 136528.6429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 406622.7123; val_optim_loss: 406622.7123
