None
Run timestamp: 16072023_180440_1012.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_1012']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1818, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1818, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9719; val_auprc_score: 0.9565; val_best_acc_score: 0.9316; val_best_f1_score: 0.9335; train_kl_reg_loss: 17261.5662; train_edge_recon_loss: 27638883.7083; train_gene_expr_recon_loss: 20997932.2917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 48654077.5833; train_optim_loss: 48654077.5833; val_kl_reg_loss: 20012.7907; val_edge_recon_loss: 26514064.1818; val_gene_expr_recon_loss: 19963079.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 46497155.6364; val_optim_loss: 46497155.6364
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9739; val_auprc_score: 0.9594; val_best_acc_score: 0.9392; val_best_f1_score: 0.9412; train_kl_reg_loss: 19013.6049; train_edge_recon_loss: 26040655.5521; train_gene_expr_recon_loss: 19748670.6458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45808339.7083; train_optim_loss: 45808339.7083; val_kl_reg_loss: 18783.6814; val_edge_recon_loss: 26364140.3636; val_gene_expr_recon_loss: 19376158.1818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45759082.1818; val_optim_loss: 45759082.1818
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9790; val_auprc_score: 0.9680; val_best_acc_score: 0.9474; val_best_f1_score: 0.9488; train_kl_reg_loss: 18976.5919; train_edge_recon_loss: 25935455.1250; train_gene_expr_recon_loss: 19298422.0521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45252853.7917; train_optim_loss: 45252853.7917; val_kl_reg_loss: 20360.7584; val_edge_recon_loss: 26269322.0909; val_gene_expr_recon_loss: 19348514.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45638198.3636; val_optim_loss: 45638198.3636
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9793; val_auprc_score: 0.9683; val_best_acc_score: 0.9492; val_best_f1_score: 0.9505; train_kl_reg_loss: 19234.6408; train_edge_recon_loss: 25875741.0000; train_gene_expr_recon_loss: 18968930.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44863906.3333; train_optim_loss: 44863906.3333; val_kl_reg_loss: 20339.6721; val_edge_recon_loss: 26243328.4545; val_gene_expr_recon_loss: 18689359.1818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 44953027.2727; val_optim_loss: 44953027.2727
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9800; val_auprc_score: 0.9701; val_best_acc_score: 0.9525; val_best_f1_score: 0.9537; train_kl_reg_loss: 19199.1576; train_edge_recon_loss: 25848198.8125; train_gene_expr_recon_loss: 18677713.4479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44545111.3333; train_optim_loss: 44545111.3333; val_kl_reg_loss: 23230.0554; val_edge_recon_loss: 26134974.6364; val_gene_expr_recon_loss: 18440325.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 44598530.9091; val_optim_loss: 44598530.9091
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9794; val_auprc_score: 0.9685; val_best_acc_score: 0.9518; val_best_f1_score: 0.9535; train_kl_reg_loss: 22173.6272; train_edge_recon_loss: 25816504.8854; train_gene_expr_recon_loss: 18358198.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44196876.6667; train_optim_loss: 44196876.6667; val_kl_reg_loss: 17882.5974; val_edge_recon_loss: 26167354.6364; val_gene_expr_recon_loss: 18190293.6364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 44375530.9091; val_optim_loss: 44375530.9091
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9789; val_auprc_score: 0.9677; val_best_acc_score: 0.9516; val_best_f1_score: 0.9530; train_kl_reg_loss: 21264.8385; train_edge_recon_loss: 25804811.7604; train_gene_expr_recon_loss: 18078619.0104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43904695.5625; train_optim_loss: 43904695.5625; val_kl_reg_loss: 16692.7782; val_edge_recon_loss: 26199155.5455; val_gene_expr_recon_loss: 18024792.2727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 44240640.5455; val_optim_loss: 44240640.5455
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9801; val_auprc_score: 0.9684; val_best_acc_score: 0.9548; val_best_f1_score: 0.9561; train_kl_reg_loss: 20455.0404; train_edge_recon_loss: 25798666.3542; train_gene_expr_recon_loss: 17792510.2917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43611631.7292; train_optim_loss: 43611631.7292; val_kl_reg_loss: 22452.9420; val_edge_recon_loss: 26212076.0000; val_gene_expr_recon_loss: 17692489.2727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43927018.3636; val_optim_loss: 43927018.3636
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9799; val_auprc_score: 0.9683; val_best_acc_score: 0.9545; val_best_f1_score: 0.9557; train_kl_reg_loss: 20788.2412; train_edge_recon_loss: 25796296.0312; train_gene_expr_recon_loss: 17558348.0104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43375432.1458; train_optim_loss: 43375432.1458; val_kl_reg_loss: 19306.7879; val_edge_recon_loss: 26184777.2727; val_gene_expr_recon_loss: 17515458.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43719542.1818; val_optim_loss: 43719542.1818
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9809; val_auprc_score: 0.9714; val_best_acc_score: 0.9535; val_best_f1_score: 0.9550; train_kl_reg_loss: 19034.1716; train_edge_recon_loss: 25770617.4479; train_gene_expr_recon_loss: 17311473.4219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43101125.1250; train_optim_loss: 43101125.1250; val_kl_reg_loss: 18956.0425; val_edge_recon_loss: 26127515.1818; val_gene_expr_recon_loss: 17325979.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43472450.3636; val_optim_loss: 43472450.3636
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9813; val_auprc_score: 0.9718; val_best_acc_score: 0.9551; val_best_f1_score: 0.9564; train_kl_reg_loss: 19163.3307; train_edge_recon_loss: 25752236.7604; train_gene_expr_recon_loss: 17132366.0729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42903765.7917; train_optim_loss: 42903765.7917; val_kl_reg_loss: 17856.0294; val_edge_recon_loss: 26105540.9091; val_gene_expr_recon_loss: 17190905.4545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43314302.7273; val_optim_loss: 43314302.7273
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9814; val_auprc_score: 0.9709; val_best_acc_score: 0.9569; val_best_f1_score: 0.9579; train_kl_reg_loss: 18725.8709; train_edge_recon_loss: 25756811.1042; train_gene_expr_recon_loss: 16950401.3177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42725938.3333; train_optim_loss: 42725938.3333; val_kl_reg_loss: 19280.7210; val_edge_recon_loss: 26077569.5455; val_gene_expr_recon_loss: 17080726.0455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43177575.8182; val_optim_loss: 43177575.8182
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9813; val_auprc_score: 0.9717; val_best_acc_score: 0.9571; val_best_f1_score: 0.9583; train_kl_reg_loss: 18944.8641; train_edge_recon_loss: 25729416.0104; train_gene_expr_recon_loss: 16842046.0208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42590406.9792; train_optim_loss: 42590406.9792; val_kl_reg_loss: 17430.9941; val_edge_recon_loss: 26071681.4545; val_gene_expr_recon_loss: 17221720.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43310832.1818; val_optim_loss: 43310832.1818
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9812; val_auprc_score: 0.9711; val_best_acc_score: 0.9560; val_best_f1_score: 0.9572; train_kl_reg_loss: 18780.3981; train_edge_recon_loss: 25745351.5625; train_gene_expr_recon_loss: 16691508.5156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42455640.4375; train_optim_loss: 42455640.4375; val_kl_reg_loss: 17868.2082; val_edge_recon_loss: 26067841.8182; val_gene_expr_recon_loss: 16904352.0455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42990062.3636; val_optim_loss: 42990062.3636
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9814; val_auprc_score: 0.9724; val_best_acc_score: 0.9563; val_best_f1_score: 0.9576; train_kl_reg_loss: 18834.0947; train_edge_recon_loss: 25747936.5521; train_gene_expr_recon_loss: 16609051.0365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42375821.7292; train_optim_loss: 42375821.7292; val_kl_reg_loss: 16902.4132; val_edge_recon_loss: 26054679.7273; val_gene_expr_recon_loss: 16950470.6364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43022052.5455; val_optim_loss: 43022052.5455
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9812; val_auprc_score: 0.9713; val_best_acc_score: 0.9566; val_best_f1_score: 0.9578; train_kl_reg_loss: 18912.4058; train_edge_recon_loss: 25729973.7500; train_gene_expr_recon_loss: 16488403.2396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42237289.3542; train_optim_loss: 42237289.3542; val_kl_reg_loss: 18075.1550; val_edge_recon_loss: 26065860.0909; val_gene_expr_recon_loss: 16769768.3182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42853704.0000; val_optim_loss: 42853704.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9806; val_auprc_score: 0.9711; val_best_acc_score: 0.9558; val_best_f1_score: 0.9571; train_kl_reg_loss: 18879.9529; train_edge_recon_loss: 25735762.8125; train_gene_expr_recon_loss: 16406342.0260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42160984.8958; train_optim_loss: 42160984.8958; val_kl_reg_loss: 18581.2832; val_edge_recon_loss: 26100697.4545; val_gene_expr_recon_loss: 16679693.5455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42798972.0000; val_optim_loss: 42798972.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9813; val_auprc_score: 0.9710; val_best_acc_score: 0.9579; val_best_f1_score: 0.9590; train_kl_reg_loss: 18916.2711; train_edge_recon_loss: 25742246.8021; train_gene_expr_recon_loss: 16354205.0573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42115368.1458; train_optim_loss: 42115368.1458; val_kl_reg_loss: 18048.9832; val_edge_recon_loss: 26012435.5455; val_gene_expr_recon_loss: 16689328.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42719812.1818; val_optim_loss: 42719812.1818
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9796; val_auprc_score: 0.9675; val_best_acc_score: 0.9555; val_best_f1_score: 0.9568; train_kl_reg_loss: 18943.2256; train_edge_recon_loss: 25708979.2292; train_gene_expr_recon_loss: 16278743.5573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42006666.0417; train_optim_loss: 42006666.0417; val_kl_reg_loss: 18900.2183; val_edge_recon_loss: 26116262.5455; val_gene_expr_recon_loss: 16687827.6818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42822990.1818; val_optim_loss: 42822990.1818
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9803; val_auprc_score: 0.9690; val_best_acc_score: 0.9579; val_best_f1_score: 0.9591; train_kl_reg_loss: 18917.4904; train_edge_recon_loss: 25717790.3333; train_gene_expr_recon_loss: 16230245.2917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41966953.1042; train_optim_loss: 41966953.1042; val_kl_reg_loss: 17575.7724; val_edge_recon_loss: 26047121.5455; val_gene_expr_recon_loss: 16692184.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42756881.2727; val_optim_loss: 42756881.2727
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9817; val_auprc_score: 0.9718; val_best_acc_score: 0.9576; val_best_f1_score: 0.9587; train_kl_reg_loss: 19232.0665; train_edge_recon_loss: 25705708.4583; train_gene_expr_recon_loss: 16174438.5990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41899379.2083; train_optim_loss: 41899379.2083; val_kl_reg_loss: 19276.7233; val_edge_recon_loss: 26042924.0000; val_gene_expr_recon_loss: 16621916.3182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42684116.9091; val_optim_loss: 42684116.9091
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9821; val_auprc_score: 0.9737; val_best_acc_score: 0.9575; val_best_f1_score: 0.9584; train_kl_reg_loss: 19116.5110; train_edge_recon_loss: 25701971.1146; train_gene_expr_recon_loss: 16132131.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41853218.8542; train_optim_loss: 41853218.8542; val_kl_reg_loss: 17778.4031; val_edge_recon_loss: 26028279.0000; val_gene_expr_recon_loss: 16494454.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42540511.8182; val_optim_loss: 42540511.8182
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9818; val_auprc_score: 0.9729; val_best_acc_score: 0.9576; val_best_f1_score: 0.9587; train_kl_reg_loss: 19223.0016; train_edge_recon_loss: 25694865.6250; train_gene_expr_recon_loss: 16095593.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41809682.4792; train_optim_loss: 41809682.4792; val_kl_reg_loss: 18372.1462; val_edge_recon_loss: 26035899.1818; val_gene_expr_recon_loss: 16677032.1364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42731303.2727; val_optim_loss: 42731303.2727
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9815; val_auprc_score: 0.9720; val_best_acc_score: 0.9582; val_best_f1_score: 0.9594; train_kl_reg_loss: 19232.5490; train_edge_recon_loss: 25687485.1562; train_gene_expr_recon_loss: 16046754.2552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41753472.0833; train_optim_loss: 41753472.0833; val_kl_reg_loss: 18848.2500; val_edge_recon_loss: 26028046.7273; val_gene_expr_recon_loss: 16489949.8636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42536844.7273; val_optim_loss: 42536844.7273
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9813; val_auprc_score: 0.9715; val_best_acc_score: 0.9572; val_best_f1_score: 0.9584; train_kl_reg_loss: 19251.8741; train_edge_recon_loss: 25688236.9375; train_gene_expr_recon_loss: 16021986.3958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41729475.0625; train_optim_loss: 41729475.0625; val_kl_reg_loss: 19215.1967; val_edge_recon_loss: 26040536.6364; val_gene_expr_recon_loss: 16506382.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42566134.1818; val_optim_loss: 42566134.1818
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9810; val_auprc_score: 0.9703; val_best_acc_score: 0.9571; val_best_f1_score: 0.9583; train_kl_reg_loss: 19274.2726; train_edge_recon_loss: 25689477.4479; train_gene_expr_recon_loss: 15984300.0677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41693051.7292; train_optim_loss: 41693051.7292; val_kl_reg_loss: 18790.2673; val_edge_recon_loss: 25975907.0000; val_gene_expr_recon_loss: 16471775.5455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42466472.5455; val_optim_loss: 42466472.5455
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9819; val_auprc_score: 0.9733; val_best_acc_score: 0.9575; val_best_f1_score: 0.9587; train_kl_reg_loss: 19298.3111; train_edge_recon_loss: 25672780.9688; train_gene_expr_recon_loss: 15962477.2552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41654556.6042; train_optim_loss: 41654556.6042; val_kl_reg_loss: 18923.2381; val_edge_recon_loss: 26047054.3636; val_gene_expr_recon_loss: 16525629.2273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42591607.0909; val_optim_loss: 42591607.0909
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9811; val_auprc_score: 0.9715; val_best_acc_score: 0.9581; val_best_f1_score: 0.9592; train_kl_reg_loss: 19329.6708; train_edge_recon_loss: 25687460.0312; train_gene_expr_recon_loss: 15957188.2865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41663977.9375; train_optim_loss: 41663977.9375; val_kl_reg_loss: 18132.0186; val_edge_recon_loss: 26024884.8182; val_gene_expr_recon_loss: 16458367.3636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42501384.3636; val_optim_loss: 42501384.3636
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9813; val_auprc_score: 0.9710; val_best_acc_score: 0.9576; val_best_f1_score: 0.9588; train_kl_reg_loss: 19442.7173; train_edge_recon_loss: 25681402.3125; train_gene_expr_recon_loss: 15922197.7760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41623042.7708; train_optim_loss: 41623042.7708; val_kl_reg_loss: 19019.1112; val_edge_recon_loss: 26002752.7273; val_gene_expr_recon_loss: 16453113.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42474884.7273; val_optim_loss: 42474884.7273
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9809; val_auprc_score: 0.9704; val_best_acc_score: 0.9571; val_best_f1_score: 0.9584; train_kl_reg_loss: 19455.8184; train_edge_recon_loss: 25667907.9583; train_gene_expr_recon_loss: 15896992.3542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41584356.1458; train_optim_loss: 41584356.1458; val_kl_reg_loss: 18658.7221; val_edge_recon_loss: 26026010.6364; val_gene_expr_recon_loss: 16429442.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42474111.8182; val_optim_loss: 42474111.8182

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9812; val_auprc_score: 0.9713; val_best_acc_score: 0.9582; val_best_f1_score: 0.9595; train_kl_reg_loss: 19892.7014; train_edge_recon_loss: 25657525.0312; train_gene_expr_recon_loss: 15656197.7604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41333615.5417; train_optim_loss: 41333615.5417; val_kl_reg_loss: 19543.2566; val_edge_recon_loss: 25947778.2727; val_gene_expr_recon_loss: 16285835.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42253157.2727; val_optim_loss: 42253157.2727
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9812; val_auprc_score: 0.9705; val_best_acc_score: 0.9584; val_best_f1_score: 0.9597; train_kl_reg_loss: 19763.5034; train_edge_recon_loss: 25659177.9896; train_gene_expr_recon_loss: 15629465.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41308407.0208; train_optim_loss: 41308407.0208; val_kl_reg_loss: 19223.4052; val_edge_recon_loss: 25909333.4545; val_gene_expr_recon_loss: 16330821.1364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42259378.0000; val_optim_loss: 42259378.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9812; val_auprc_score: 0.9707; val_best_acc_score: 0.9585; val_best_f1_score: 0.9596; train_kl_reg_loss: 19596.1006; train_edge_recon_loss: 25637187.7083; train_gene_expr_recon_loss: 15614934.8542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41271718.6042; train_optim_loss: 41271718.6042; val_kl_reg_loss: 19179.3923; val_edge_recon_loss: 25930719.6364; val_gene_expr_recon_loss: 16337030.1818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42286929.0909; val_optim_loss: 42286929.0909
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9812; val_auprc_score: 0.9707; val_best_acc_score: 0.9587; val_best_f1_score: 0.9599; train_kl_reg_loss: 19558.1387; train_edge_recon_loss: 25632632.8646; train_gene_expr_recon_loss: 15624609.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41276800.2292; train_optim_loss: 41276800.2292; val_kl_reg_loss: 19172.9566; val_edge_recon_loss: 25877814.1818; val_gene_expr_recon_loss: 16291376.4545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42188363.2727; val_optim_loss: 42188363.2727
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9817; val_auprc_score: 0.9711; val_best_acc_score: 0.9599; val_best_f1_score: 0.9609; train_kl_reg_loss: 19580.3910; train_edge_recon_loss: 25612257.1667; train_gene_expr_recon_loss: 15615203.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41247040.5000; train_optim_loss: 41247040.5000; val_kl_reg_loss: 19187.4276; val_edge_recon_loss: 25871651.7273; val_gene_expr_recon_loss: 16280718.3182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42171557.6364; val_optim_loss: 42171557.6364
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9807; val_auprc_score: 0.9701; val_best_acc_score: 0.9578; val_best_f1_score: 0.9590; train_kl_reg_loss: 19628.1765; train_edge_recon_loss: 25623457.1146; train_gene_expr_recon_loss: 15604139.2396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41247224.5417; train_optim_loss: 41247224.5417; val_kl_reg_loss: 19266.9036; val_edge_recon_loss: 25929340.7273; val_gene_expr_recon_loss: 16286962.2273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42235569.8182; val_optim_loss: 42235569.8182
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9810; val_auprc_score: 0.9707; val_best_acc_score: 0.9587; val_best_f1_score: 0.9599; train_kl_reg_loss: 19635.3801; train_edge_recon_loss: 25633296.7708; train_gene_expr_recon_loss: 15597872.0573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41250804.2917; train_optim_loss: 41250804.2917; val_kl_reg_loss: 19231.8699; val_edge_recon_loss: 25880608.4545; val_gene_expr_recon_loss: 16318799.6364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42218640.0000; val_optim_loss: 42218640.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9822; val_auprc_score: 0.9728; val_best_acc_score: 0.9593; val_best_f1_score: 0.9605; train_kl_reg_loss: 19692.0177; train_edge_recon_loss: 25648551.7500; train_gene_expr_recon_loss: 15592781.6823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41261025.4167; train_optim_loss: 41261025.4167; val_kl_reg_loss: 19301.0109; val_edge_recon_loss: 25882936.8182; val_gene_expr_recon_loss: 16300787.8636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42203025.4545; val_optim_loss: 42203025.4545
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9809; val_auprc_score: 0.9693; val_best_acc_score: 0.9587; val_best_f1_score: 0.9598; train_kl_reg_loss: 19691.2145; train_edge_recon_loss: 25628779.4896; train_gene_expr_recon_loss: 15590878.7344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41239349.4167; train_optim_loss: 41239349.4167; val_kl_reg_loss: 19312.2115; val_edge_recon_loss: 25874479.1818; val_gene_expr_recon_loss: 16308961.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42202752.0000; val_optim_loss: 42202752.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9818; val_auprc_score: 0.9713; val_best_acc_score: 0.9593; val_best_f1_score: 0.9604; train_kl_reg_loss: 19759.4117; train_edge_recon_loss: 25620053.7083; train_gene_expr_recon_loss: 15559051.5052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41198864.5208; train_optim_loss: 41198864.5208; val_kl_reg_loss: 19359.1167; val_edge_recon_loss: 25877493.6364; val_gene_expr_recon_loss: 16303660.5455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42200513.6364; val_optim_loss: 42200513.6364
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9814; val_auprc_score: 0.9707; val_best_acc_score: 0.9585; val_best_f1_score: 0.9597; train_kl_reg_loss: 19808.9120; train_edge_recon_loss: 25626601.7604; train_gene_expr_recon_loss: 15565878.4427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41212289.1250; train_optim_loss: 41212289.1250; val_kl_reg_loss: 19387.5725; val_edge_recon_loss: 25873936.6364; val_gene_expr_recon_loss: 16281928.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42175253.0909; val_optim_loss: 42175253.0909
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9824; val_auprc_score: 0.9731; val_best_acc_score: 0.9596; val_best_f1_score: 0.9606; train_kl_reg_loss: 19811.3154; train_edge_recon_loss: 25626812.8125; train_gene_expr_recon_loss: 15544847.6354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41191471.6250; train_optim_loss: 41191471.6250; val_kl_reg_loss: 19389.0684; val_edge_recon_loss: 25858705.3636; val_gene_expr_recon_loss: 16305655.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42183749.4545; val_optim_loss: 42183749.4545
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9819; val_auprc_score: 0.9724; val_best_acc_score: 0.9591; val_best_f1_score: 0.9601; train_kl_reg_loss: 19815.0852; train_edge_recon_loss: 25622987.3646; train_gene_expr_recon_loss: 15555249.5469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41198051.9375; train_optim_loss: 41198051.9375; val_kl_reg_loss: 19404.9713; val_edge_recon_loss: 25891410.2727; val_gene_expr_recon_loss: 16284016.9545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42194831.8182; val_optim_loss: 42194831.8182

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 45 min 16 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9810
Val AUPRC score: 0.9703
Val best accuracy score: 0.9584
Val best F1 score: 0.9596
Val gene expr MSE score: 0.4976

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
