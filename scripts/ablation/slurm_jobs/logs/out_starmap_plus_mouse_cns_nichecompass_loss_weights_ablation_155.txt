None
Run timestamp: 15072023_093453_155.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_155']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9823; val_auprc_score: 0.9753; val_best_acc_score: 0.9488; val_best_f1_score: 0.9501; train_kl_reg_loss: 23665.8465; train_edge_recon_loss: 26439695.3088; train_gene_expr_recon_loss: 1365982.0648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27829343.2353; train_optim_loss: 27829343.2353; val_kl_reg_loss: 21550.1570; val_edge_recon_loss: 25962080.2623; val_gene_expr_recon_loss: 1237670.6311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27221301.2459; val_optim_loss: 27221301.2459
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9842; val_auprc_score: 0.9774; val_best_acc_score: 0.9529; val_best_f1_score: 0.9540; train_kl_reg_loss: 21307.3893; train_edge_recon_loss: 25788561.9596; train_gene_expr_recon_loss: 1190338.3922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27000207.7426; train_optim_loss: 27000207.7426; val_kl_reg_loss: 21004.4790; val_edge_recon_loss: 25750825.5410; val_gene_expr_recon_loss: 1164847.8463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26936677.9344; val_optim_loss: 26936677.9344
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9853; val_auprc_score: 0.9788; val_best_acc_score: 0.9591; val_best_f1_score: 0.9602; train_kl_reg_loss: 20816.9419; train_edge_recon_loss: 25689325.1250; train_gene_expr_recon_loss: 1138425.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26848568.0110; train_optim_loss: 26848568.0110; val_kl_reg_loss: 20513.7345; val_edge_recon_loss: 25725288.9836; val_gene_expr_recon_loss: 1125961.4467; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26871764.1967; val_optim_loss: 26871764.1967
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9878; val_auprc_score: 0.9820; val_best_acc_score: 0.9635; val_best_f1_score: 0.9643; train_kl_reg_loss: 20135.6845; train_edge_recon_loss: 25648643.7206; train_gene_expr_recon_loss: 1109741.3403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26778520.6949; train_optim_loss: 26778520.6949; val_kl_reg_loss: 19141.8547; val_edge_recon_loss: 25658855.1475; val_gene_expr_recon_loss: 1103960.5963; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26781957.7049; val_optim_loss: 26781957.7049
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9896; val_auprc_score: 0.9848; val_best_acc_score: 0.9663; val_best_f1_score: 0.9670; train_kl_reg_loss: 19724.4578; train_edge_recon_loss: 25594424.5919; train_gene_expr_recon_loss: 1091220.1940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26705369.3088; train_optim_loss: 26705369.3088; val_kl_reg_loss: 19810.1136; val_edge_recon_loss: 25622422.5902; val_gene_expr_recon_loss: 1089323.0850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26731555.8689; val_optim_loss: 26731555.8689
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9900; val_auprc_score: 0.9849; val_best_acc_score: 0.9688; val_best_f1_score: 0.9693; train_kl_reg_loss: 19657.6104; train_edge_recon_loss: 25557917.3272; train_gene_expr_recon_loss: 1076370.2577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26653945.1618; train_optim_loss: 26653945.1618; val_kl_reg_loss: 19225.0982; val_edge_recon_loss: 25570357.2459; val_gene_expr_recon_loss: 1078236.5748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26667819.0492; val_optim_loss: 26667819.0492
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9915; val_auprc_score: 0.9875; val_best_acc_score: 0.9714; val_best_f1_score: 0.9718; train_kl_reg_loss: 19443.0715; train_edge_recon_loss: 25538933.6360; train_gene_expr_recon_loss: 1067241.4127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26625618.0662; train_optim_loss: 26625618.0662; val_kl_reg_loss: 19024.2930; val_edge_recon_loss: 25555020.3607; val_gene_expr_recon_loss: 1069380.2090; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26643425.0820; val_optim_loss: 26643425.0820
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9925; val_auprc_score: 0.9890; val_best_acc_score: 0.9734; val_best_f1_score: 0.9738; train_kl_reg_loss: 19373.5111; train_edge_recon_loss: 25518487.3051; train_gene_expr_recon_loss: 1059403.7431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26597264.5257; train_optim_loss: 26597264.5257; val_kl_reg_loss: 19197.8841; val_edge_recon_loss: 25535049.6721; val_gene_expr_recon_loss: 1063046.8238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26617294.3279; val_optim_loss: 26617294.3279
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9929; val_auprc_score: 0.9895; val_best_acc_score: 0.9749; val_best_f1_score: 0.9752; train_kl_reg_loss: 19553.5664; train_edge_recon_loss: 25509112.5074; train_gene_expr_recon_loss: 1053557.0263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26582223.0919; train_optim_loss: 26582223.0919; val_kl_reg_loss: 18757.3322; val_edge_recon_loss: 25549123.8361; val_gene_expr_recon_loss: 1058303.9734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26626185.1803; val_optim_loss: 26626185.1803
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9929; val_auprc_score: 0.9891; val_best_acc_score: 0.9751; val_best_f1_score: 0.9755; train_kl_reg_loss: 19182.8286; train_edge_recon_loss: 25494453.4485; train_gene_expr_recon_loss: 1048718.3542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26562354.5993; train_optim_loss: 26562354.5993; val_kl_reg_loss: 18922.2511; val_edge_recon_loss: 25536124.4262; val_gene_expr_recon_loss: 1052789.3453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26607836.0328; val_optim_loss: 26607836.0328
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9936; val_auprc_score: 0.9907; val_best_acc_score: 0.9767; val_best_f1_score: 0.9771; train_kl_reg_loss: 19142.9774; train_edge_recon_loss: 25480412.2941; train_gene_expr_recon_loss: 1044273.4463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26543828.7684; train_optim_loss: 26543828.7684; val_kl_reg_loss: 18776.2015; val_edge_recon_loss: 25516824.6885; val_gene_expr_recon_loss: 1051281.5533; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26586882.6885; val_optim_loss: 26586882.6885
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9939; val_auprc_score: 0.9907; val_best_acc_score: 0.9782; val_best_f1_score: 0.9785; train_kl_reg_loss: 18963.9697; train_edge_recon_loss: 25476471.1912; train_gene_expr_recon_loss: 1040354.8671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26535789.9779; train_optim_loss: 26535789.9779; val_kl_reg_loss: 18643.0654; val_edge_recon_loss: 25491643.9016; val_gene_expr_recon_loss: 1045681.1650; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26555968.1639; val_optim_loss: 26555968.1639
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9941; val_auprc_score: 0.9914; val_best_acc_score: 0.9779; val_best_f1_score: 0.9782; train_kl_reg_loss: 18982.5929; train_edge_recon_loss: 25457715.5993; train_gene_expr_recon_loss: 1037632.3254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26514330.4596; train_optim_loss: 26514330.4596; val_kl_reg_loss: 18718.8321; val_edge_recon_loss: 25496335.6066; val_gene_expr_recon_loss: 1042472.4416; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26557526.9836; val_optim_loss: 26557526.9836
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9945; val_auprc_score: 0.9919; val_best_acc_score: 0.9801; val_best_f1_score: 0.9804; train_kl_reg_loss: 18789.0781; train_edge_recon_loss: 25459699.8971; train_gene_expr_recon_loss: 1033052.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26511541.5993; train_optim_loss: 26511541.5993; val_kl_reg_loss: 18573.1026; val_edge_recon_loss: 25477971.2131; val_gene_expr_recon_loss: 1037592.3617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26534136.6885; val_optim_loss: 26534136.6885
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9950; val_auprc_score: 0.9925; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 18743.7902; train_edge_recon_loss: 25445166.2647; train_gene_expr_recon_loss: 1030485.6047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26494395.6507; train_optim_loss: 26494395.6507; val_kl_reg_loss: 18386.8374; val_edge_recon_loss: 25477784.5902; val_gene_expr_recon_loss: 1036607.2111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26532778.7541; val_optim_loss: 26532778.7541
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9955; val_auprc_score: 0.9934; val_best_acc_score: 0.9816; val_best_f1_score: 0.9818; train_kl_reg_loss: 18425.6726; train_edge_recon_loss: 25436681.1324; train_gene_expr_recon_loss: 1029190.0191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26484296.8346; train_optim_loss: 26484296.8346; val_kl_reg_loss: 18024.3840; val_edge_recon_loss: 25447784.2295; val_gene_expr_recon_loss: 1032784.7275; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26498593.2459; val_optim_loss: 26498593.2459
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9950; val_auprc_score: 0.9922; val_best_acc_score: 0.9813; val_best_f1_score: 0.9816; train_kl_reg_loss: 18347.5141; train_edge_recon_loss: 25433963.1654; train_gene_expr_recon_loss: 1026324.4652; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26478635.1875; train_optim_loss: 26478635.1875; val_kl_reg_loss: 18066.1083; val_edge_recon_loss: 25467465.5410; val_gene_expr_recon_loss: 1034361.3924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26519892.8852; val_optim_loss: 26519892.8852
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9957; val_auprc_score: 0.9936; val_best_acc_score: 0.9824; val_best_f1_score: 0.9826; train_kl_reg_loss: 18224.4006; train_edge_recon_loss: 25431534.5993; train_gene_expr_recon_loss: 1023930.5125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26473689.4963; train_optim_loss: 26473689.4963; val_kl_reg_loss: 17555.1155; val_edge_recon_loss: 25442726.8852; val_gene_expr_recon_loss: 1028344.8852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26488626.9836; val_optim_loss: 26488626.9836
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9957; val_auprc_score: 0.9934; val_best_acc_score: 0.9832; val_best_f1_score: 0.9834; train_kl_reg_loss: 18135.0918; train_edge_recon_loss: 25414384.0919; train_gene_expr_recon_loss: 1022028.9597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26454548.1654; train_optim_loss: 26454548.1654; val_kl_reg_loss: 18031.1344; val_edge_recon_loss: 25448549.6721; val_gene_expr_recon_loss: 1024700.4385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26491281.3443; val_optim_loss: 26491281.3443
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9956; val_auprc_score: 0.9932; val_best_acc_score: 0.9833; val_best_f1_score: 0.9835; train_kl_reg_loss: 18076.5806; train_edge_recon_loss: 25415607.5368; train_gene_expr_recon_loss: 1019265.3965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26452949.5772; train_optim_loss: 26452949.5772; val_kl_reg_loss: 18145.2196; val_edge_recon_loss: 25447661.6393; val_gene_expr_recon_loss: 1021228.5881; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26487035.6393; val_optim_loss: 26487035.6393
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9955; val_auprc_score: 0.9929; val_best_acc_score: 0.9837; val_best_f1_score: 0.9839; train_kl_reg_loss: 18000.5453; train_edge_recon_loss: 25413041.8309; train_gene_expr_recon_loss: 1017511.7963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26448554.1140; train_optim_loss: 26448554.1140; val_kl_reg_loss: 17031.8056; val_edge_recon_loss: 25450300.1311; val_gene_expr_recon_loss: 1027217.6158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26494549.5738; val_optim_loss: 26494549.5738
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9964; val_auprc_score: 0.9947; val_best_acc_score: 0.9844; val_best_f1_score: 0.9845; train_kl_reg_loss: 17720.8378; train_edge_recon_loss: 25396747.8897; train_gene_expr_recon_loss: 1013481.7847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26427950.4926; train_optim_loss: 26427950.4926; val_kl_reg_loss: 17564.0232; val_edge_recon_loss: 25430370.3279; val_gene_expr_recon_loss: 1024258.9160; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26472193.3443; val_optim_loss: 26472193.3443
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9963; val_auprc_score: 0.9942; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 17732.8863; train_edge_recon_loss: 25399052.9779; train_gene_expr_recon_loss: 1009947.5457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26426733.3971; train_optim_loss: 26426733.3971; val_kl_reg_loss: 17438.1415; val_edge_recon_loss: 25423692.1639; val_gene_expr_recon_loss: 1018188.8289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26459319.1475; val_optim_loss: 26459319.1475
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9961; val_auprc_score: 0.9939; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 17607.6960; train_edge_recon_loss: 25390512.7132; train_gene_expr_recon_loss: 1004303.0591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26412423.4559; train_optim_loss: 26412423.4559; val_kl_reg_loss: 17718.7563; val_edge_recon_loss: 25387542.2295; val_gene_expr_recon_loss: 1011356.3494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26416617.2787; val_optim_loss: 26416617.2787
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9964; val_auprc_score: 0.9943; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 17530.3697; train_edge_recon_loss: 25391964.6176; train_gene_expr_recon_loss: 1002923.7116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26412418.6801; train_optim_loss: 26412418.6801; val_kl_reg_loss: 17066.9156; val_edge_recon_loss: 25393342.6230; val_gene_expr_recon_loss: 1022970.0727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26433379.6393; val_optim_loss: 26433379.6393
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9965; val_auprc_score: 0.9949; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 17409.2416; train_edge_recon_loss: 25389630.9044; train_gene_expr_recon_loss: 997862.2539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26404902.3897; train_optim_loss: 26404902.3897; val_kl_reg_loss: 16924.4345; val_edge_recon_loss: 25421301.3443; val_gene_expr_recon_loss: 981747.5041; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26419973.1803; val_optim_loss: 26419973.1803
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9963; val_auprc_score: 0.9943; val_best_acc_score: 0.9859; val_best_f1_score: 0.9861; train_kl_reg_loss: 17371.4520; train_edge_recon_loss: 25393425.2537; train_gene_expr_recon_loss: 990073.7555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26400870.4816; train_optim_loss: 26400870.4816; val_kl_reg_loss: 16894.9850; val_edge_recon_loss: 25417760.0000; val_gene_expr_recon_loss: 995086.1281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26429741.1148; val_optim_loss: 26429741.1148
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9966; val_auprc_score: 0.9949; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 17263.6594; train_edge_recon_loss: 25381873.7353; train_gene_expr_recon_loss: 980537.6239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26379674.9816; train_optim_loss: 26379674.9816; val_kl_reg_loss: 16953.2403; val_edge_recon_loss: 25404160.5246; val_gene_expr_recon_loss: 975332.0523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26396445.9344; val_optim_loss: 26396445.9344
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9968; val_auprc_score: 0.9951; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 17281.3768; train_edge_recon_loss: 25375863.0809; train_gene_expr_recon_loss: 970050.4318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26363194.9265; train_optim_loss: 26363194.9265; val_kl_reg_loss: 16816.0217; val_edge_recon_loss: 25432557.5082; val_gene_expr_recon_loss: 968995.9559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26418369.3115; val_optim_loss: 26418369.3115
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9971; val_auprc_score: 0.9957; val_best_acc_score: 0.9874; val_best_f1_score: 0.9875; train_kl_reg_loss: 17125.0105; train_edge_recon_loss: 25368501.1801; train_gene_expr_recon_loss: 946881.4359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26332507.5699; train_optim_loss: 26332507.5699; val_kl_reg_loss: 16572.5399; val_edge_recon_loss: 25387469.1803; val_gene_expr_recon_loss: 980954.9631; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26384996.5574; val_optim_loss: 26384996.5574
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9968; val_auprc_score: 0.9949; val_best_acc_score: 0.9880; val_best_f1_score: 0.9880; train_kl_reg_loss: 17235.3074; train_edge_recon_loss: 25367971.9926; train_gene_expr_recon_loss: 933699.1229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26318906.4301; train_optim_loss: 26318906.4301; val_kl_reg_loss: 16932.0735; val_edge_recon_loss: 25396884.5902; val_gene_expr_recon_loss: 968733.2910; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26382550.0656; val_optim_loss: 26382550.0656
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9969; val_auprc_score: 0.9949; val_best_acc_score: 0.9881; val_best_f1_score: 0.9881; train_kl_reg_loss: 17248.5816; train_edge_recon_loss: 25375897.1985; train_gene_expr_recon_loss: 921129.1313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26314274.8566; train_optim_loss: 26314274.8566; val_kl_reg_loss: 17063.2575; val_edge_recon_loss: 25376393.0492; val_gene_expr_recon_loss: 891381.3258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26284837.7705; val_optim_loss: 26284837.7705
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9971; val_auprc_score: 0.9955; val_best_acc_score: 0.9884; val_best_f1_score: 0.9884; train_kl_reg_loss: 17119.4703; train_edge_recon_loss: 25364901.3897; train_gene_expr_recon_loss: 908679.8141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26290700.6838; train_optim_loss: 26290700.6838; val_kl_reg_loss: 16888.5035; val_edge_recon_loss: 25386896.2295; val_gene_expr_recon_loss: 988344.9119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26392129.6721; val_optim_loss: 26392129.6721
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9969; val_auprc_score: 0.9955; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 17113.1205; train_edge_recon_loss: 25363175.6397; train_gene_expr_recon_loss: 889286.0970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26269574.8125; train_optim_loss: 26269574.8125; val_kl_reg_loss: 16730.5314; val_edge_recon_loss: 25394747.1148; val_gene_expr_recon_loss: 930818.6342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26342296.0656; val_optim_loss: 26342296.0656
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9968; val_auprc_score: 0.9950; val_best_acc_score: 0.9877; val_best_f1_score: 0.9878; train_kl_reg_loss: 17149.3915; train_edge_recon_loss: 25354652.7500; train_gene_expr_recon_loss: 881014.3521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26252816.4853; train_optim_loss: 26252816.4853; val_kl_reg_loss: 16453.6749; val_edge_recon_loss: 25398406.0328; val_gene_expr_recon_loss: 847669.1189; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26262528.8197; val_optim_loss: 26262528.8197
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9967; val_auprc_score: 0.9948; val_best_acc_score: 0.9872; val_best_f1_score: 0.9873; train_kl_reg_loss: 17015.4613; train_edge_recon_loss: 25367855.8382; train_gene_expr_recon_loss: 861683.8134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26246555.0919; train_optim_loss: 26246555.0919; val_kl_reg_loss: 16676.0384; val_edge_recon_loss: 25397659.9344; val_gene_expr_recon_loss: 850966.8330; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26265302.6885; val_optim_loss: 26265302.6885
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9970; val_auprc_score: 0.9953; val_best_acc_score: 0.9883; val_best_f1_score: 0.9884; train_kl_reg_loss: 17057.1728; train_edge_recon_loss: 25360360.4559; train_gene_expr_recon_loss: 839977.1633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26217394.7868; train_optim_loss: 26217394.7868; val_kl_reg_loss: 16647.2585; val_edge_recon_loss: 25365602.3607; val_gene_expr_recon_loss: 869090.1783; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26251339.6066; val_optim_loss: 26251339.6066
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9972; val_auprc_score: 0.9958; val_best_acc_score: 0.9881; val_best_f1_score: 0.9882; train_kl_reg_loss: 17039.6134; train_edge_recon_loss: 25361308.1728; train_gene_expr_recon_loss: 834232.6915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26212580.4522; train_optim_loss: 26212580.4522; val_kl_reg_loss: 16342.9025; val_edge_recon_loss: 25374637.8689; val_gene_expr_recon_loss: 827156.1527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26218136.9836; val_optim_loss: 26218136.9836
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9975; val_auprc_score: 0.9962; val_best_acc_score: 0.9888; val_best_f1_score: 0.9889; train_kl_reg_loss: 17084.0495; train_edge_recon_loss: 25360519.3897; train_gene_expr_recon_loss: 827147.1945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26204750.6360; train_optim_loss: 26204750.6360; val_kl_reg_loss: 16714.7272; val_edge_recon_loss: 25379879.7705; val_gene_expr_recon_loss: 827453.6557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26224048.2951; val_optim_loss: 26224048.2951
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9971; val_auprc_score: 0.9956; val_best_acc_score: 0.9886; val_best_f1_score: 0.9887; train_kl_reg_loss: 16946.4178; train_edge_recon_loss: 25360526.1507; train_gene_expr_recon_loss: 820724.4137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26198196.9081; train_optim_loss: 26198196.9081; val_kl_reg_loss: 16957.0560; val_edge_recon_loss: 25380049.3443; val_gene_expr_recon_loss: 836103.1414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26233109.4098; val_optim_loss: 26233109.4098
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9970; val_auprc_score: 0.9955; val_best_acc_score: 0.9887; val_best_f1_score: 0.9888; train_kl_reg_loss: 16926.0253; train_edge_recon_loss: 25357066.1360; train_gene_expr_recon_loss: 820891.3162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26194883.4853; train_optim_loss: 26194883.4853; val_kl_reg_loss: 16871.4217; val_edge_recon_loss: 25363695.6721; val_gene_expr_recon_loss: 826080.4477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26206647.8361; val_optim_loss: 26206647.8361
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9967; val_auprc_score: 0.9949; val_best_acc_score: 0.9881; val_best_f1_score: 0.9881; train_kl_reg_loss: 16809.7402; train_edge_recon_loss: 25351557.2096; train_gene_expr_recon_loss: 818774.4669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26187141.4191; train_optim_loss: 26187141.4191; val_kl_reg_loss: 16721.4190; val_edge_recon_loss: 25401464.9180; val_gene_expr_recon_loss: 835895.5205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26254081.7377; val_optim_loss: 26254081.7377
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9972; val_auprc_score: 0.9956; val_best_acc_score: 0.9891; val_best_f1_score: 0.9892; train_kl_reg_loss: 16810.2575; train_edge_recon_loss: 25344991.5588; train_gene_expr_recon_loss: 819177.6892; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26180979.4963; train_optim_loss: 26180979.4963; val_kl_reg_loss: 16562.9162; val_edge_recon_loss: 25370694.3607; val_gene_expr_recon_loss: 757356.1947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26144613.5410; val_optim_loss: 26144613.5410
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9974; val_auprc_score: 0.9961; val_best_acc_score: 0.9895; val_best_f1_score: 0.9896; train_kl_reg_loss: 16860.7785; train_edge_recon_loss: 25348076.7831; train_gene_expr_recon_loss: 814701.3019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26179638.8676; train_optim_loss: 26179638.8676; val_kl_reg_loss: 16734.9174; val_edge_recon_loss: 25350111.1475; val_gene_expr_recon_loss: 833739.5727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26200585.6721; val_optim_loss: 26200585.6721
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9975; val_auprc_score: 0.9960; val_best_acc_score: 0.9895; val_best_f1_score: 0.9895; train_kl_reg_loss: 16777.1841; train_edge_recon_loss: 25345435.4926; train_gene_expr_recon_loss: 819618.8227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26181831.4963; train_optim_loss: 26181831.4963; val_kl_reg_loss: 16334.3067; val_edge_recon_loss: 25357733.6066; val_gene_expr_recon_loss: 794817.6445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26168885.6066; val_optim_loss: 26168885.6066
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9973; val_auprc_score: 0.9958; val_best_acc_score: 0.9891; val_best_f1_score: 0.9892; train_kl_reg_loss: 16759.0335; train_edge_recon_loss: 25338787.8051; train_gene_expr_recon_loss: 811447.4368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26166994.2721; train_optim_loss: 26166994.2721; val_kl_reg_loss: 16524.2466; val_edge_recon_loss: 25366161.5738; val_gene_expr_recon_loss: 835446.8996; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26218132.6230; val_optim_loss: 26218132.6230
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9974; val_auprc_score: 0.9962; val_best_acc_score: 0.9892; val_best_f1_score: 0.9893; train_kl_reg_loss: 16787.0133; train_edge_recon_loss: 25344140.5515; train_gene_expr_recon_loss: 812930.2946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26173857.8713; train_optim_loss: 26173857.8713; val_kl_reg_loss: 16697.2017; val_edge_recon_loss: 25367601.8033; val_gene_expr_recon_loss: 825749.8607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26210049.0164; val_optim_loss: 26210049.0164

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9973; val_auprc_score: 0.9958; val_best_acc_score: 0.9895; val_best_f1_score: 0.9895; train_kl_reg_loss: 17033.1586; train_edge_recon_loss: 25339096.8860; train_gene_expr_recon_loss: 810038.1778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26166168.2206; train_optim_loss: 26166168.2206; val_kl_reg_loss: 16895.2791; val_edge_recon_loss: 25370840.9508; val_gene_expr_recon_loss: 824819.1424; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26212555.4426; val_optim_loss: 26212555.4426
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9977; val_auprc_score: 0.9964; val_best_acc_score: 0.9896; val_best_f1_score: 0.9897; train_kl_reg_loss: 17135.4362; train_edge_recon_loss: 25337167.2941; train_gene_expr_recon_loss: 810154.6897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26164457.4669; train_optim_loss: 26164457.4669; val_kl_reg_loss: 16949.9325; val_edge_recon_loss: 25358794.8852; val_gene_expr_recon_loss: 823211.5041; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26198956.2951; val_optim_loss: 26198956.2951
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9974; val_auprc_score: 0.9957; val_best_acc_score: 0.9895; val_best_f1_score: 0.9895; train_kl_reg_loss: 17181.1571; train_edge_recon_loss: 25337863.1949; train_gene_expr_recon_loss: 809540.2170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26164584.5919; train_optim_loss: 26164584.5919; val_kl_reg_loss: 17008.3489; val_edge_recon_loss: 25376836.4262; val_gene_expr_recon_loss: 823154.3842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26216999.2131; val_optim_loss: 26216999.2131
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9974; val_auprc_score: 0.9958; val_best_acc_score: 0.9898; val_best_f1_score: 0.9899; train_kl_reg_loss: 17165.9199; train_edge_recon_loss: 25337516.6397; train_gene_expr_recon_loss: 809395.0981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26164077.6066; train_optim_loss: 26164077.6066; val_kl_reg_loss: 16995.9257; val_edge_recon_loss: 25351531.1475; val_gene_expr_recon_loss: 822661.7193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26191188.7541; val_optim_loss: 26191188.7541

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 295 min 28 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
Val AUROC score: 0.9975
Val AUPRC score: 0.9964
Val best accuracy score: 0.9892
Val best F1 score: 0.9893
Val gene expr MSE score: 0.6570

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
