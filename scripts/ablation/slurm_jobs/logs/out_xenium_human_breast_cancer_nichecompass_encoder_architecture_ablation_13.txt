None
Run timestamp: 26072023_043754_13.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '2', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '3000.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '128', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_13']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 2, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 128
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9513; val_auprc_score: 0.9390; val_best_acc_score: 0.8949; val_best_f1_score: 0.9008; train_kl_reg_loss: 25380.6842; train_edge_recon_loss: 26632224.5088; train_gene_expr_recon_loss: 844791.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27502396.8096; train_optim_loss: 27502396.8096; val_kl_reg_loss: 23119.8728; val_edge_recon_loss: 26487826.9439; val_gene_expr_recon_loss: 770413.7789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27281360.6535; val_optim_loss: 27281360.6535
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9591; val_auprc_score: 0.9482; val_best_acc_score: 0.9050; val_best_f1_score: 0.9088; train_kl_reg_loss: 22633.0134; train_edge_recon_loss: 26072862.4713; train_gene_expr_recon_loss: 754355.7340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26849851.1882; train_optim_loss: 26849851.1882; val_kl_reg_loss: 20827.1878; val_edge_recon_loss: 26387589.3201; val_gene_expr_recon_loss: 758346.1267; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27166762.6997; val_optim_loss: 27166762.6997
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9687; val_auprc_score: 0.9601; val_best_acc_score: 0.9205; val_best_f1_score: 0.9239; train_kl_reg_loss: 20845.7230; train_edge_recon_loss: 25968660.5750; train_gene_expr_recon_loss: 731279.7896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26720786.0787; train_optim_loss: 26720786.0787; val_kl_reg_loss: 20615.7876; val_edge_recon_loss: 26318168.5809; val_gene_expr_recon_loss: 723684.0784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27062468.4092; val_optim_loss: 27062468.4092
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9718; val_auprc_score: 0.9638; val_best_acc_score: 0.9256; val_best_f1_score: 0.9283; train_kl_reg_loss: 19472.8754; train_edge_recon_loss: 25850877.2824; train_gene_expr_recon_loss: 718584.2783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26588934.4309; train_optim_loss: 26588934.4309; val_kl_reg_loss: 19504.7657; val_edge_recon_loss: 26216427.5116; val_gene_expr_recon_loss: 714227.8692; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26950160.1254; val_optim_loss: 26950160.1254
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9762; val_auprc_score: 0.9694; val_best_acc_score: 0.9314; val_best_f1_score: 0.9334; train_kl_reg_loss: 18241.3488; train_edge_recon_loss: 25809750.2566; train_gene_expr_recon_loss: 712438.9302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26540430.5191; train_optim_loss: 26540430.5191; val_kl_reg_loss: 17219.0404; val_edge_recon_loss: 26222281.6568; val_gene_expr_recon_loss: 708018.3063; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26947519.0033; val_optim_loss: 26947519.0033
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9748; val_auprc_score: 0.9662; val_best_acc_score: 0.9338; val_best_f1_score: 0.9357; train_kl_reg_loss: 17439.7137; train_edge_recon_loss: 25770339.1088; train_gene_expr_recon_loss: 705601.5852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26493380.3926; train_optim_loss: 26493380.3926; val_kl_reg_loss: 18299.7242; val_edge_recon_loss: 26208887.8614; val_gene_expr_recon_loss: 705755.4332; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26932943.0099; val_optim_loss: 26932943.0099
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9784; val_auprc_score: 0.9722; val_best_acc_score: 0.9373; val_best_f1_score: 0.9390; train_kl_reg_loss: 16496.2550; train_edge_recon_loss: 25746185.2963; train_gene_expr_recon_loss: 702188.3488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26464869.8882; train_optim_loss: 26464869.8882; val_kl_reg_loss: 16316.7133; val_edge_recon_loss: 26179931.1881; val_gene_expr_recon_loss: 697633.8230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26893881.6766; val_optim_loss: 26893881.6766
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9805; val_auprc_score: 0.9745; val_best_acc_score: 0.9420; val_best_f1_score: 0.9434; train_kl_reg_loss: 16008.1594; train_edge_recon_loss: 25709360.3066; train_gene_expr_recon_loss: 697855.2324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26423223.7140; train_optim_loss: 26423223.7140; val_kl_reg_loss: 15994.7057; val_edge_recon_loss: 26159500.0858; val_gene_expr_recon_loss: 697392.3218; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26872887.1023; val_optim_loss: 26872887.1023
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9824; val_auprc_score: 0.9782; val_best_acc_score: 0.9425; val_best_f1_score: 0.9441; train_kl_reg_loss: 15421.8929; train_edge_recon_loss: 25698554.3691; train_gene_expr_recon_loss: 695845.3290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26409821.5934; train_optim_loss: 26409821.5934; val_kl_reg_loss: 15030.1056; val_edge_recon_loss: 26181388.6733; val_gene_expr_recon_loss: 696359.3727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26892778.1518; val_optim_loss: 26892778.1518
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9833; val_auprc_score: 0.9783; val_best_acc_score: 0.9461; val_best_f1_score: 0.9473; train_kl_reg_loss: 15199.4844; train_edge_recon_loss: 25694274.5037; train_gene_expr_recon_loss: 692601.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26402075.1390; train_optim_loss: 26402075.1390; val_kl_reg_loss: 15430.2298; val_edge_recon_loss: 26114263.0693; val_gene_expr_recon_loss: 688525.7102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26818219.0759; val_optim_loss: 26818219.0759
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9841; val_auprc_score: 0.9795; val_best_acc_score: 0.9475; val_best_f1_score: 0.9487; train_kl_reg_loss: 14868.2447; train_edge_recon_loss: 25676798.2390; train_gene_expr_recon_loss: 689501.7380; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26381168.2051; train_optim_loss: 26381168.2051; val_kl_reg_loss: 14534.3127; val_edge_recon_loss: 26079194.8251; val_gene_expr_recon_loss: 686054.9420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26779784.1122; val_optim_loss: 26779784.1122
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9848; val_auprc_score: 0.9812; val_best_acc_score: 0.9466; val_best_f1_score: 0.9479; train_kl_reg_loss: 14740.1110; train_edge_recon_loss: 25653967.5772; train_gene_expr_recon_loss: 686373.4148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26355081.0824; train_optim_loss: 26355081.0824; val_kl_reg_loss: 14395.7419; val_edge_recon_loss: 26126898.5017; val_gene_expr_recon_loss: 684646.4055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26825940.6337; val_optim_loss: 26825940.6337
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9858; val_auprc_score: 0.9820; val_best_acc_score: 0.9504; val_best_f1_score: 0.9516; train_kl_reg_loss: 14679.1993; train_edge_recon_loss: 25657397.4809; train_gene_expr_recon_loss: 685460.6647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26357537.3434; train_optim_loss: 26357537.3434; val_kl_reg_loss: 14610.6569; val_edge_recon_loss: 26061490.9835; val_gene_expr_recon_loss: 687781.2438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26763882.9373; val_optim_loss: 26763882.9373
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9865; val_auprc_score: 0.9830; val_best_acc_score: 0.9520; val_best_f1_score: 0.9530; train_kl_reg_loss: 14702.8835; train_edge_recon_loss: 25630996.4441; train_gene_expr_recon_loss: 683986.7849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26329686.1022; train_optim_loss: 26329686.1022; val_kl_reg_loss: 14604.2229; val_edge_recon_loss: 26037661.3729; val_gene_expr_recon_loss: 683540.8051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26735806.4884; val_optim_loss: 26735806.4884
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9870; val_auprc_score: 0.9839; val_best_acc_score: 0.9519; val_best_f1_score: 0.9528; train_kl_reg_loss: 14493.5922; train_edge_recon_loss: 25626235.6801; train_gene_expr_recon_loss: 682035.0756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26322764.3507; train_optim_loss: 26322764.3507; val_kl_reg_loss: 14593.0928; val_edge_recon_loss: 26087649.1089; val_gene_expr_recon_loss: 682897.4105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26785139.5974; val_optim_loss: 26785139.5974
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9869; val_auprc_score: 0.9832; val_best_acc_score: 0.9529; val_best_f1_score: 0.9540; train_kl_reg_loss: 14706.5654; train_edge_recon_loss: 25611649.5838; train_gene_expr_recon_loss: 681331.5236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26307687.6691; train_optim_loss: 26307687.6691; val_kl_reg_loss: 15112.0538; val_edge_recon_loss: 26068070.2244; val_gene_expr_recon_loss: 680452.5530; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26763634.9307; val_optim_loss: 26763634.9307
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9881; val_auprc_score: 0.9842; val_best_acc_score: 0.9557; val_best_f1_score: 0.9564; train_kl_reg_loss: 14753.8340; train_edge_recon_loss: 25604549.9551; train_gene_expr_recon_loss: 679917.5142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26299221.2963; train_optim_loss: 26299221.2963; val_kl_reg_loss: 14736.6562; val_edge_recon_loss: 26039009.0165; val_gene_expr_recon_loss: 679668.8484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26733414.4686; val_optim_loss: 26733414.4686
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9884; val_auprc_score: 0.9856; val_best_acc_score: 0.9570; val_best_f1_score: 0.9577; train_kl_reg_loss: 14677.1415; train_edge_recon_loss: 25607781.9779; train_gene_expr_recon_loss: 679579.0943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26302038.2478; train_optim_loss: 26302038.2478; val_kl_reg_loss: 14753.5489; val_edge_recon_loss: 26019835.0825; val_gene_expr_recon_loss: 677645.7384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26712234.4026; val_optim_loss: 26712234.4026
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9892; val_auprc_score: 0.9863; val_best_acc_score: 0.9572; val_best_f1_score: 0.9579; train_kl_reg_loss: 14759.1367; train_edge_recon_loss: 25587465.1213; train_gene_expr_recon_loss: 678588.9819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26280813.2294; train_optim_loss: 26280813.2294; val_kl_reg_loss: 14418.8465; val_edge_recon_loss: 26016304.3630; val_gene_expr_recon_loss: 681858.7273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26712582.0528; val_optim_loss: 26712582.0528
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9878; val_auprc_score: 0.9847; val_best_acc_score: 0.9558; val_best_f1_score: 0.9564; train_kl_reg_loss: 14701.1994; train_edge_recon_loss: 25587690.4037; train_gene_expr_recon_loss: 678584.5687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26280976.1662; train_optim_loss: 26280976.1662; val_kl_reg_loss: 15542.1841; val_edge_recon_loss: 26006504.1914; val_gene_expr_recon_loss: 680060.3092; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26702106.7195; val_optim_loss: 26702106.7195
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9894; val_auprc_score: 0.9865; val_best_acc_score: 0.9586; val_best_f1_score: 0.9592; train_kl_reg_loss: 14966.3456; train_edge_recon_loss: 25570548.0125; train_gene_expr_recon_loss: 676537.7749; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26262052.1412; train_optim_loss: 26262052.1412; val_kl_reg_loss: 14269.9272; val_edge_recon_loss: 25999751.2343; val_gene_expr_recon_loss: 675786.9150; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26689808.1122; val_optim_loss: 26689808.1122
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9891; val_auprc_score: 0.9859; val_best_acc_score: 0.9593; val_best_f1_score: 0.9599; train_kl_reg_loss: 14831.6331; train_edge_recon_loss: 25573390.0897; train_gene_expr_recon_loss: 675552.8668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26263774.5684; train_optim_loss: 26263774.5684; val_kl_reg_loss: 15319.7502; val_edge_recon_loss: 25949753.1749; val_gene_expr_recon_loss: 674930.5289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26640003.4917; val_optim_loss: 26640003.4917
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9889; val_auprc_score: 0.9860; val_best_acc_score: 0.9586; val_best_f1_score: 0.9593; train_kl_reg_loss: 14789.1038; train_edge_recon_loss: 25557852.1956; train_gene_expr_recon_loss: 675673.6977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26248315.0051; train_optim_loss: 26248315.0051; val_kl_reg_loss: 14407.0755; val_edge_recon_loss: 26015272.5611; val_gene_expr_recon_loss: 672456.6196; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26702136.2838; val_optim_loss: 26702136.2838
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9894; val_auprc_score: 0.9867; val_best_acc_score: 0.9595; val_best_f1_score: 0.9601; train_kl_reg_loss: 14940.0470; train_edge_recon_loss: 25560361.4324; train_gene_expr_recon_loss: 674316.2489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26249617.7243; train_optim_loss: 26249617.7243; val_kl_reg_loss: 14591.2013; val_edge_recon_loss: 25952696.1914; val_gene_expr_recon_loss: 674882.2764; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26642169.6370; val_optim_loss: 26642169.6370
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9895; val_auprc_score: 0.9867; val_best_acc_score: 0.9598; val_best_f1_score: 0.9605; train_kl_reg_loss: 14842.9347; train_edge_recon_loss: 25553398.2691; train_gene_expr_recon_loss: 674556.7333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26242797.9147; train_optim_loss: 26242797.9147; val_kl_reg_loss: 14707.3503; val_edge_recon_loss: 25960610.7327; val_gene_expr_recon_loss: 672281.6306; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26647599.6832; val_optim_loss: 26647599.6832
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9901; val_auprc_score: 0.9874; val_best_acc_score: 0.9607; val_best_f1_score: 0.9613; train_kl_reg_loss: 14934.4939; train_edge_recon_loss: 25554238.1331; train_gene_expr_recon_loss: 673510.6038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26242683.2360; train_optim_loss: 26242683.2360; val_kl_reg_loss: 14976.5943; val_edge_recon_loss: 25995486.3960; val_gene_expr_recon_loss: 673678.0897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26684141.0825; val_optim_loss: 26684141.0825

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9908; val_auprc_score: 0.9879; val_best_acc_score: 0.9644; val_best_f1_score: 0.9649; train_kl_reg_loss: 15157.9123; train_edge_recon_loss: 25511014.5103; train_gene_expr_recon_loss: 665181.6945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26191354.1316; train_optim_loss: 26191354.1316; val_kl_reg_loss: 15340.4927; val_edge_recon_loss: 25890422.7063; val_gene_expr_recon_loss: 665426.7603; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26571189.9274; val_optim_loss: 26571189.9274
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9911; val_auprc_score: 0.9885; val_best_acc_score: 0.9641; val_best_f1_score: 0.9647; train_kl_reg_loss: 15473.1618; train_edge_recon_loss: 25498359.1640; train_gene_expr_recon_loss: 662506.0977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26176338.4221; train_optim_loss: 26176338.4221; val_kl_reg_loss: 15671.4947; val_edge_recon_loss: 25912711.2673; val_gene_expr_recon_loss: 662966.6246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26591349.3861; val_optim_loss: 26591349.3861
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9912; val_auprc_score: 0.9885; val_best_acc_score: 0.9649; val_best_f1_score: 0.9655; train_kl_reg_loss: 15592.6459; train_edge_recon_loss: 25502397.7228; train_gene_expr_recon_loss: 661715.9557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26179706.3338; train_optim_loss: 26179706.3338; val_kl_reg_loss: 15667.3405; val_edge_recon_loss: 25877145.5116; val_gene_expr_recon_loss: 663562.2496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26556375.1947; val_optim_loss: 26556375.1947
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9910; val_auprc_score: 0.9883; val_best_acc_score: 0.9646; val_best_f1_score: 0.9651; train_kl_reg_loss: 15633.4338; train_edge_recon_loss: 25509569.6787; train_gene_expr_recon_loss: 661397.0348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26186600.1294; train_optim_loss: 26186600.1294; val_kl_reg_loss: 15638.3130; val_edge_recon_loss: 25898910.1452; val_gene_expr_recon_loss: 662444.3280; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26576992.7657; val_optim_loss: 26576992.7657
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9910; val_auprc_score: 0.9885; val_best_acc_score: 0.9640; val_best_f1_score: 0.9646; train_kl_reg_loss: 15676.7991; train_edge_recon_loss: 25496817.4221; train_gene_expr_recon_loss: 660970.8798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26173465.0838; train_optim_loss: 26173465.0838; val_kl_reg_loss: 15764.7766; val_edge_recon_loss: 25878055.6964; val_gene_expr_recon_loss: 662547.7345; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26556368.2244; val_optim_loss: 26556368.2244
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9914; val_auprc_score: 0.9890; val_best_acc_score: 0.9658; val_best_f1_score: 0.9663; train_kl_reg_loss: 15684.2858; train_edge_recon_loss: 25487076.6779; train_gene_expr_recon_loss: 660843.0305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26163603.9956; train_optim_loss: 26163603.9956; val_kl_reg_loss: 15666.6087; val_edge_recon_loss: 25862404.9241; val_gene_expr_recon_loss: 661659.4119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26539730.8845; val_optim_loss: 26539730.8845
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9913; val_auprc_score: 0.9888; val_best_acc_score: 0.9648; val_best_f1_score: 0.9653; train_kl_reg_loss: 15599.4668; train_edge_recon_loss: 25506406.6051; train_gene_expr_recon_loss: 660567.0362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26182573.0801; train_optim_loss: 26182573.0801; val_kl_reg_loss: 15723.4758; val_edge_recon_loss: 25885923.4257; val_gene_expr_recon_loss: 661661.9678; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26563308.9307; val_optim_loss: 26563308.9307
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9915; val_auprc_score: 0.9891; val_best_acc_score: 0.9655; val_best_f1_score: 0.9660; train_kl_reg_loss: 15696.8309; train_edge_recon_loss: 25494418.0125; train_gene_expr_recon_loss: 659839.3386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26169954.1993; train_optim_loss: 26169954.1993; val_kl_reg_loss: 15800.5423; val_edge_recon_loss: 25862282.4290; val_gene_expr_recon_loss: 661677.9620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26539761.0033; val_optim_loss: 26539761.0033
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9917; val_auprc_score: 0.9889; val_best_acc_score: 0.9649; val_best_f1_score: 0.9654; train_kl_reg_loss: 15705.0340; train_edge_recon_loss: 25484021.8713; train_gene_expr_recon_loss: 660207.4648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26159934.3926; train_optim_loss: 26159934.3926; val_kl_reg_loss: 15609.0622; val_edge_recon_loss: 25885767.1947; val_gene_expr_recon_loss: 660711.5229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26562087.8482; val_optim_loss: 26562087.8482
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9915; val_auprc_score: 0.9889; val_best_acc_score: 0.9655; val_best_f1_score: 0.9661; train_kl_reg_loss: 15566.7135; train_edge_recon_loss: 25487897.9309; train_gene_expr_recon_loss: 659454.8738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26162919.5132; train_optim_loss: 26162919.5132; val_kl_reg_loss: 15800.4558; val_edge_recon_loss: 25870620.5479; val_gene_expr_recon_loss: 660539.6227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26546960.6007; val_optim_loss: 26546960.6007

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9914; val_auprc_score: 0.9887; val_best_acc_score: 0.9664; val_best_f1_score: 0.9669; train_kl_reg_loss: 15736.3537; train_edge_recon_loss: 25494136.5368; train_gene_expr_recon_loss: 658127.1327; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26168000.0419; train_optim_loss: 26168000.0419; val_kl_reg_loss: 15760.4436; val_edge_recon_loss: 25858814.9835; val_gene_expr_recon_loss: 660168.7696; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26534744.2310; val_optim_loss: 26534744.2310
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9915; val_auprc_score: 0.9887; val_best_acc_score: 0.9658; val_best_f1_score: 0.9664; train_kl_reg_loss: 15716.4148; train_edge_recon_loss: 25489808.0118; train_gene_expr_recon_loss: 658414.7478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26163939.1816; train_optim_loss: 26163939.1816; val_kl_reg_loss: 15759.9328; val_edge_recon_loss: 25844305.1089; val_gene_expr_recon_loss: 658177.4757; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26518242.5083; val_optim_loss: 26518242.5083
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9914; val_auprc_score: 0.9887; val_best_acc_score: 0.9661; val_best_f1_score: 0.9666; train_kl_reg_loss: 15693.4783; train_edge_recon_loss: 25493304.2890; train_gene_expr_recon_loss: 658171.2378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26167169.0243; train_optim_loss: 26167169.0243; val_kl_reg_loss: 15714.2243; val_edge_recon_loss: 25866178.3234; val_gene_expr_recon_loss: 659380.9849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26541273.5446; val_optim_loss: 26541273.5446
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9919; val_auprc_score: 0.9896; val_best_acc_score: 0.9662; val_best_f1_score: 0.9668; train_kl_reg_loss: 15659.6454; train_edge_recon_loss: 25484295.7419; train_gene_expr_recon_loss: 658043.2605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26157998.6559; train_optim_loss: 26157998.6559; val_kl_reg_loss: 15699.4558; val_edge_recon_loss: 25855089.0363; val_gene_expr_recon_loss: 659426.2958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26530214.7855; val_optim_loss: 26530214.7855
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9921; val_auprc_score: 0.9898; val_best_acc_score: 0.9666; val_best_f1_score: 0.9671; train_kl_reg_loss: 15681.5473; train_edge_recon_loss: 25484988.3971; train_gene_expr_recon_loss: 658309.8288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26158979.7934; train_optim_loss: 26158979.7934; val_kl_reg_loss: 15719.6533; val_edge_recon_loss: 25839824.2310; val_gene_expr_recon_loss: 660032.2968; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26515576.1188; val_optim_loss: 26515576.1188
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9918; val_auprc_score: 0.9895; val_best_acc_score: 0.9663; val_best_f1_score: 0.9669; train_kl_reg_loss: 15668.8132; train_edge_recon_loss: 25478392.5654; train_gene_expr_recon_loss: 658207.8751; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26152269.2537; train_optim_loss: 26152269.2537; val_kl_reg_loss: 15744.4035; val_edge_recon_loss: 25850152.6469; val_gene_expr_recon_loss: 660310.7616; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26526207.8020; val_optim_loss: 26526207.8020
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9920; val_auprc_score: 0.9897; val_best_acc_score: 0.9662; val_best_f1_score: 0.9667; train_kl_reg_loss: 15681.4081; train_edge_recon_loss: 25498775.9757; train_gene_expr_recon_loss: 658454.9186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26172912.2662; train_optim_loss: 26172912.2662; val_kl_reg_loss: 15718.5845; val_edge_recon_loss: 25857339.4851; val_gene_expr_recon_loss: 659164.3075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26532222.2706; val_optim_loss: 26532222.2706
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9921; val_auprc_score: 0.9899; val_best_acc_score: 0.9669; val_best_f1_score: 0.9674; train_kl_reg_loss: 15647.3711; train_edge_recon_loss: 25482665.1537; train_gene_expr_recon_loss: 658448.8581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26156761.3581; train_optim_loss: 26156761.3581; val_kl_reg_loss: 15693.9323; val_edge_recon_loss: 25843971.1815; val_gene_expr_recon_loss: 659077.8878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26518742.9769; val_optim_loss: 26518742.9769
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9922; val_auprc_score: 0.9899; val_best_acc_score: 0.9668; val_best_f1_score: 0.9674; train_kl_reg_loss: 15648.2325; train_edge_recon_loss: 25485006.0176; train_gene_expr_recon_loss: 658033.2736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26158687.5074; train_optim_loss: 26158687.5074; val_kl_reg_loss: 15671.3011; val_edge_recon_loss: 25841406.8911; val_gene_expr_recon_loss: 660031.6419; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26517109.8218; val_optim_loss: 26517109.8218

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9919; val_auprc_score: 0.9894; val_best_acc_score: 0.9663; val_best_f1_score: 0.9669; train_kl_reg_loss: 15633.6841; train_edge_recon_loss: 25487943.6603; train_gene_expr_recon_loss: 658153.1747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26161730.5118; train_optim_loss: 26161730.5118; val_kl_reg_loss: 15691.6907; val_edge_recon_loss: 25832244.8317; val_gene_expr_recon_loss: 659731.8111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26507668.3960; val_optim_loss: 26507668.3960
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9916; val_auprc_score: 0.9891; val_best_acc_score: 0.9657; val_best_f1_score: 0.9662; train_kl_reg_loss: 15635.6777; train_edge_recon_loss: 25481312.4154; train_gene_expr_recon_loss: 657919.7695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26154867.8691; train_optim_loss: 26154867.8691; val_kl_reg_loss: 15683.1147; val_edge_recon_loss: 25866963.8152; val_gene_expr_recon_loss: 659258.0639; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26541905.0891; val_optim_loss: 26541905.0891
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9918; val_auprc_score: 0.9894; val_best_acc_score: 0.9668; val_best_f1_score: 0.9673; train_kl_reg_loss: 15641.0782; train_edge_recon_loss: 25479485.4691; train_gene_expr_recon_loss: 657786.8041; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26152913.3603; train_optim_loss: 26152913.3603; val_kl_reg_loss: 15694.7068; val_edge_recon_loss: 25855441.0825; val_gene_expr_recon_loss: 660139.7446; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26531275.5512; val_optim_loss: 26531275.5512
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9910; val_auprc_score: 0.9879; val_best_acc_score: 0.9652; val_best_f1_score: 0.9658; train_kl_reg_loss: 15641.0597; train_edge_recon_loss: 25473670.7221; train_gene_expr_recon_loss: 658064.4304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26147376.2059; train_optim_loss: 26147376.2059; val_kl_reg_loss: 15681.7637; val_edge_recon_loss: 25883678.2970; val_gene_expr_recon_loss: 658233.3441; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26557593.3201; val_optim_loss: 26557593.3201
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9919; val_auprc_score: 0.9894; val_best_acc_score: 0.9664; val_best_f1_score: 0.9668; train_kl_reg_loss: 15644.0216; train_edge_recon_loss: 25482282.5654; train_gene_expr_recon_loss: 657972.5060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26155899.0868; train_optim_loss: 26155899.0868; val_kl_reg_loss: 15681.8161; val_edge_recon_loss: 25853092.6073; val_gene_expr_recon_loss: 659374.5058; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26528148.9307; val_optim_loss: 26528148.9307

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9919; val_auprc_score: 0.9895; val_best_acc_score: 0.9670; val_best_f1_score: 0.9674; train_kl_reg_loss: 15637.2113; train_edge_recon_loss: 25480045.1625; train_gene_expr_recon_loss: 657996.2388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26153678.6147; train_optim_loss: 26153678.6147; val_kl_reg_loss: 15683.8308; val_edge_recon_loss: 25845997.6304; val_gene_expr_recon_loss: 659665.6099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26521347.0231; val_optim_loss: 26521347.0231
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9920; val_auprc_score: 0.9896; val_best_acc_score: 0.9674; val_best_f1_score: 0.9678; train_kl_reg_loss: 15646.0097; train_edge_recon_loss: 25491831.9007; train_gene_expr_recon_loss: 658063.1453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26165541.0750; train_optim_loss: 26165541.0750; val_kl_reg_loss: 15673.1291; val_edge_recon_loss: 25819981.6106; val_gene_expr_recon_loss: 658354.9449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26494009.7294; val_optim_loss: 26494009.7294
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9921; val_auprc_score: 0.9900; val_best_acc_score: 0.9666; val_best_f1_score: 0.9671; train_kl_reg_loss: 15642.1029; train_edge_recon_loss: 25490291.6294; train_gene_expr_recon_loss: 657830.1619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26163763.8735; train_optim_loss: 26163763.8735; val_kl_reg_loss: 15697.1011; val_edge_recon_loss: 25836272.3498; val_gene_expr_recon_loss: 659507.4736; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26511476.9967; val_optim_loss: 26511476.9967
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9921; val_auprc_score: 0.9900; val_best_acc_score: 0.9668; val_best_f1_score: 0.9673; train_kl_reg_loss: 15643.2878; train_edge_recon_loss: 25477788.3250; train_gene_expr_recon_loss: 658034.6042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26151466.2331; train_optim_loss: 26151466.2331; val_kl_reg_loss: 15680.1360; val_edge_recon_loss: 25839243.5182; val_gene_expr_recon_loss: 659496.8005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26514420.4818; val_optim_loss: 26514420.4818
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9913; val_auprc_score: 0.9887; val_best_acc_score: 0.9653; val_best_f1_score: 0.9659; train_kl_reg_loss: 15641.2541; train_edge_recon_loss: 25485731.8684; train_gene_expr_recon_loss: 658074.9650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26159448.0882; train_optim_loss: 26159448.0882; val_kl_reg_loss: 15685.8176; val_edge_recon_loss: 25884406.2706; val_gene_expr_recon_loss: 659366.3907; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26559458.4884; val_optim_loss: 26559458.4884
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9914; val_auprc_score: 0.9890; val_best_acc_score: 0.9662; val_best_f1_score: 0.9666; train_kl_reg_loss: 15642.8764; train_edge_recon_loss: 25482971.6875; train_gene_expr_recon_loss: 658057.3565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26156671.9279; train_optim_loss: 26156671.9279; val_kl_reg_loss: 15686.7592; val_edge_recon_loss: 25868576.4290; val_gene_expr_recon_loss: 659417.8175; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26543681.0627; val_optim_loss: 26543681.0627

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000004e-08.

Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9916; val_auprc_score: 0.9889; val_best_acc_score: 0.9669; val_best_f1_score: 0.9673; train_kl_reg_loss: 15640.1069; train_edge_recon_loss: 25492687.2926; train_gene_expr_recon_loss: 658067.0086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26166394.4324; train_optim_loss: 26166394.4324; val_kl_reg_loss: 15682.0834; val_edge_recon_loss: 25852858.6733; val_gene_expr_recon_loss: 659943.8892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26528484.6073; val_optim_loss: 26528484.6073
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9919; val_auprc_score: 0.9893; val_best_acc_score: 0.9667; val_best_f1_score: 0.9671; train_kl_reg_loss: 15642.4905; train_edge_recon_loss: 25479681.6507; train_gene_expr_recon_loss: 657908.9530; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26153233.1103; train_optim_loss: 26153233.1103; val_kl_reg_loss: 15694.2022; val_edge_recon_loss: 25853196.5677; val_gene_expr_recon_loss: 660326.0070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26529216.7789; val_optim_loss: 26529216.7789
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9920; val_auprc_score: 0.9894; val_best_acc_score: 0.9676; val_best_f1_score: 0.9680; train_kl_reg_loss: 15643.8107; train_edge_recon_loss: 25485960.0537; train_gene_expr_recon_loss: 658059.3018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26159663.1868; train_optim_loss: 26159663.1868; val_kl_reg_loss: 15678.4021; val_edge_recon_loss: 25828019.8350; val_gene_expr_recon_loss: 659301.5443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26502999.7756; val_optim_loss: 26502999.7756
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9914; val_auprc_score: 0.9888; val_best_acc_score: 0.9652; val_best_f1_score: 0.9657; train_kl_reg_loss: 15640.4801; train_edge_recon_loss: 25494885.0324; train_gene_expr_recon_loss: 657630.1045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26168155.6029; train_optim_loss: 26168155.6029; val_kl_reg_loss: 15682.3136; val_edge_recon_loss: 25858266.7327; val_gene_expr_recon_loss: 659558.0017; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26533506.9967; val_optim_loss: 26533506.9967

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 464 min 28 sec.
Using best model state, which was in epoch 52.

--- MODEL EVALUATION ---
Val AUROC score: 0.9918
Val AUPRC score: 0.9892
Val best accuracy score: 0.9665
Val best F1 score: 0.9670
Val gene expr MSE score: 1.5889

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
