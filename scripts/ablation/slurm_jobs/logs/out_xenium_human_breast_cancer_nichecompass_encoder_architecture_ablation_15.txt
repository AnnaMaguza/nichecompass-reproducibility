None
Run timestamp: 26072023_043939_15.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '2', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '3000.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '128', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_15']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 2, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 128
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9852; val_auprc_score: 0.9833; val_best_acc_score: 0.9429; val_best_f1_score: 0.9440; train_kl_reg_loss: 17236.6219; train_edge_recon_loss: 26179623.3719; train_gene_expr_recon_loss: 829559.3243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27026419.3254; train_optim_loss: 27026419.3254; val_kl_reg_loss: 15985.5995; val_edge_recon_loss: 25964707.2269; val_gene_expr_recon_loss: 775651.3469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26756344.1227; val_optim_loss: 26756344.1227
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9912; val_auprc_score: 0.9904; val_best_acc_score: 0.9562; val_best_f1_score: 0.9567; train_kl_reg_loss: 15832.2097; train_edge_recon_loss: 25777348.2341; train_gene_expr_recon_loss: 753826.5731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26547007.0046; train_optim_loss: 26547007.0046; val_kl_reg_loss: 14721.9219; val_edge_recon_loss: 25839971.6644; val_gene_expr_recon_loss: 741386.9811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26596080.5602; val_optim_loss: 26596080.5602
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9932; val_auprc_score: 0.9920; val_best_acc_score: 0.9641; val_best_f1_score: 0.9646; train_kl_reg_loss: 14483.7549; train_edge_recon_loss: 25675325.3004; train_gene_expr_recon_loss: 734790.5483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26424599.6057; train_optim_loss: 26424599.6057; val_kl_reg_loss: 14266.3409; val_edge_recon_loss: 25795804.7315; val_gene_expr_recon_loss: 718931.7820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26529002.8796; val_optim_loss: 26529002.8796
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9950; val_auprc_score: 0.9942; val_best_acc_score: 0.9706; val_best_f1_score: 0.9710; train_kl_reg_loss: 13761.7379; train_edge_recon_loss: 25606129.2598; train_gene_expr_recon_loss: 702765.2047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26322656.1955; train_optim_loss: 26322656.1955; val_kl_reg_loss: 13431.7982; val_edge_recon_loss: 25673516.5417; val_gene_expr_recon_loss: 712793.0898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26399741.4282; val_optim_loss: 26399741.4282
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9959; val_auprc_score: 0.9953; val_best_acc_score: 0.9737; val_best_f1_score: 0.9739; train_kl_reg_loss: 13574.5400; train_edge_recon_loss: 25565285.4519; train_gene_expr_recon_loss: 647364.1023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26226224.0648; train_optim_loss: 26226224.0648; val_kl_reg_loss: 13872.4174; val_edge_recon_loss: 25657921.8889; val_gene_expr_recon_loss: 636138.2535; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26307932.5278; val_optim_loss: 26307932.5278
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9965; val_auprc_score: 0.9960; val_best_acc_score: 0.9760; val_best_f1_score: 0.9762; train_kl_reg_loss: 13512.3014; train_edge_recon_loss: 25537029.0522; train_gene_expr_recon_loss: 636011.1744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26186552.5301; train_optim_loss: 26186552.5301; val_kl_reg_loss: 12846.5215; val_edge_recon_loss: 25642225.4444; val_gene_expr_recon_loss: 630648.4791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26285720.5046; val_optim_loss: 26285720.5046
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9964; val_auprc_score: 0.9958; val_best_acc_score: 0.9765; val_best_f1_score: 0.9767; train_kl_reg_loss: 13566.1972; train_edge_recon_loss: 25524084.3475; train_gene_expr_recon_loss: 628965.6231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26166616.1553; train_optim_loss: 26166616.1553; val_kl_reg_loss: 13104.9449; val_edge_recon_loss: 25628942.9792; val_gene_expr_recon_loss: 639845.1608; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26281893.1227; val_optim_loss: 26281893.1227
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9968; val_auprc_score: 0.9962; val_best_acc_score: 0.9765; val_best_f1_score: 0.9767; train_kl_reg_loss: 13619.9574; train_edge_recon_loss: 25505857.4617; train_gene_expr_recon_loss: 622761.0774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26142238.4992; train_optim_loss: 26142238.4992; val_kl_reg_loss: 13744.1405; val_edge_recon_loss: 25606818.9560; val_gene_expr_recon_loss: 660558.1749; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26281121.2731; val_optim_loss: 26281121.2731
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9969; val_auprc_score: 0.9965; val_best_acc_score: 0.9774; val_best_f1_score: 0.9776; train_kl_reg_loss: 13597.4764; train_edge_recon_loss: 25497551.0851; train_gene_expr_recon_loss: 619489.7697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26130638.3408; train_optim_loss: 26130638.3408; val_kl_reg_loss: 13615.8795; val_edge_recon_loss: 25590279.4213; val_gene_expr_recon_loss: 618898.6573; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26222793.9815; val_optim_loss: 26222793.9815
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9968; val_auprc_score: 0.9963; val_best_acc_score: 0.9782; val_best_f1_score: 0.9784; train_kl_reg_loss: 13661.5034; train_edge_recon_loss: 25484425.8925; train_gene_expr_recon_loss: 617940.5849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26116027.9694; train_optim_loss: 26116027.9694; val_kl_reg_loss: 13619.0631; val_edge_recon_loss: 25587014.7106; val_gene_expr_recon_loss: 615500.4845; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26216134.2338; val_optim_loss: 26216134.2338
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9968; val_auprc_score: 0.9963; val_best_acc_score: 0.9786; val_best_f1_score: 0.9788; train_kl_reg_loss: 13585.3123; train_edge_recon_loss: 25473537.9100; train_gene_expr_recon_loss: 616288.7769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26103411.9892; train_optim_loss: 26103411.9892; val_kl_reg_loss: 13862.7178; val_edge_recon_loss: 25566077.1019; val_gene_expr_recon_loss: 614348.9691; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26194288.7963; val_optim_loss: 26194288.7963
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9971; val_auprc_score: 0.9964; val_best_acc_score: 0.9799; val_best_f1_score: 0.9801; train_kl_reg_loss: 13607.3743; train_edge_recon_loss: 25468066.9133; train_gene_expr_recon_loss: 612762.9663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26094437.2621; train_optim_loss: 26094437.2621; val_kl_reg_loss: 13227.2284; val_edge_recon_loss: 25575639.7361; val_gene_expr_recon_loss: 612206.4600; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26201073.4005; val_optim_loss: 26201073.4005
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9971; val_auprc_score: 0.9965; val_best_acc_score: 0.9794; val_best_f1_score: 0.9795; train_kl_reg_loss: 13781.5299; train_edge_recon_loss: 25461470.4524; train_gene_expr_recon_loss: 611850.3390; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26087102.3158; train_optim_loss: 26087102.3158; val_kl_reg_loss: 13729.5737; val_edge_recon_loss: 25538154.8125; val_gene_expr_recon_loss: 611149.7267; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26163034.1435; val_optim_loss: 26163034.1435
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 13816.1730; train_edge_recon_loss: 25459286.1798; train_gene_expr_recon_loss: 610815.9998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26083918.3516; train_optim_loss: 26083918.3516; val_kl_reg_loss: 13861.5380; val_edge_recon_loss: 25568534.9421; val_gene_expr_recon_loss: 610659.5295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26193056.0347; val_optim_loss: 26193056.0347
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 13843.6553; train_edge_recon_loss: 25446375.0869; train_gene_expr_recon_loss: 609784.2678; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26070002.9974; train_optim_loss: 26070002.9974; val_kl_reg_loss: 14000.1346; val_edge_recon_loss: 25542045.3194; val_gene_expr_recon_loss: 611324.0164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26167369.4537; val_optim_loss: 26167369.4537
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9972; val_auprc_score: 0.9965; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 13817.4503; train_edge_recon_loss: 25445480.3933; train_gene_expr_recon_loss: 608787.8089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26068085.6674; train_optim_loss: 26068085.6674; val_kl_reg_loss: 13888.9210; val_edge_recon_loss: 25528595.4005; val_gene_expr_recon_loss: 605721.6443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26148205.9491; val_optim_loss: 26148205.9491
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9972; val_auprc_score: 0.9968; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 13867.2261; train_edge_recon_loss: 25440185.3428; train_gene_expr_recon_loss: 605021.1658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26059073.7382; train_optim_loss: 26059073.7382; val_kl_reg_loss: 14255.4490; val_edge_recon_loss: 25534902.8449; val_gene_expr_recon_loss: 609988.0585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26159146.3704; val_optim_loss: 26159146.3704
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9970; val_auprc_score: 0.9963; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 13892.6578; train_edge_recon_loss: 25444892.6119; train_gene_expr_recon_loss: 605569.4739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26064354.7472; train_optim_loss: 26064354.7472; val_kl_reg_loss: 14169.8002; val_edge_recon_loss: 25530077.2500; val_gene_expr_recon_loss: 605637.0586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26149884.0926; val_optim_loss: 26149884.0926
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9974; val_auprc_score: 0.9969; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 13835.7976; train_edge_recon_loss: 25433875.4162; train_gene_expr_recon_loss: 604978.0166; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26052689.2346; train_optim_loss: 26052689.2346; val_kl_reg_loss: 14048.9565; val_edge_recon_loss: 25532946.4213; val_gene_expr_recon_loss: 606667.6770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26153663.0556; val_optim_loss: 26153663.0556
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9974; val_auprc_score: 0.9969; val_best_acc_score: 0.9818; val_best_f1_score: 0.9819; train_kl_reg_loss: 13776.2015; train_edge_recon_loss: 25430492.2418; train_gene_expr_recon_loss: 603337.7755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26047606.2323; train_optim_loss: 26047606.2323; val_kl_reg_loss: 13787.9652; val_edge_recon_loss: 25514955.8819; val_gene_expr_recon_loss: 603420.0326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26132163.8866; val_optim_loss: 26132163.8866
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9975; val_auprc_score: 0.9971; val_best_acc_score: 0.9821; val_best_f1_score: 0.9822; train_kl_reg_loss: 13845.0966; train_edge_recon_loss: 25429974.9501; train_gene_expr_recon_loss: 602136.1286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26045956.1800; train_optim_loss: 26045956.1800; val_kl_reg_loss: 13598.5081; val_edge_recon_loss: 25507158.7685; val_gene_expr_recon_loss: 607491.9559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26128249.2245; val_optim_loss: 26128249.2245
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9975; val_auprc_score: 0.9971; val_best_acc_score: 0.9818; val_best_f1_score: 0.9819; train_kl_reg_loss: 13936.7663; train_edge_recon_loss: 25419846.6875; train_gene_expr_recon_loss: 602150.7484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26035934.2112; train_optim_loss: 26035934.2112; val_kl_reg_loss: 14124.4049; val_edge_recon_loss: 25522337.8657; val_gene_expr_recon_loss: 602619.5397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26139081.8032; val_optim_loss: 26139081.8032
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9976; val_auprc_score: 0.9971; val_best_acc_score: 0.9815; val_best_f1_score: 0.9817; train_kl_reg_loss: 13890.7814; train_edge_recon_loss: 25419827.7482; train_gene_expr_recon_loss: 602230.1984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26035948.7310; train_optim_loss: 26035948.7310; val_kl_reg_loss: 13804.1623; val_edge_recon_loss: 25505387.2569; val_gene_expr_recon_loss: 601084.9128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26120276.3403; val_optim_loss: 26120276.3403
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9974; val_auprc_score: 0.9969; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 13928.4352; train_edge_recon_loss: 25414328.9982; train_gene_expr_recon_loss: 601963.7260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26030221.1692; train_optim_loss: 26030221.1692; val_kl_reg_loss: 14149.2555; val_edge_recon_loss: 25509487.3426; val_gene_expr_recon_loss: 602281.0844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26125917.6713; val_optim_loss: 26125917.6713
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9975; val_auprc_score: 0.9969; val_best_acc_score: 0.9827; val_best_f1_score: 0.9828; train_kl_reg_loss: 13911.0375; train_edge_recon_loss: 25416848.9133; train_gene_expr_recon_loss: 601093.9497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26031853.8825; train_optim_loss: 26031853.8825; val_kl_reg_loss: 13963.9287; val_edge_recon_loss: 25491673.7222; val_gene_expr_recon_loss: 602186.8202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26107824.4352; val_optim_loss: 26107824.4352
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9977; val_auprc_score: 0.9970; val_best_acc_score: 0.9829; val_best_f1_score: 0.9830; train_kl_reg_loss: 13964.0244; train_edge_recon_loss: 25411077.8256; train_gene_expr_recon_loss: 601136.3210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26026178.1651; train_optim_loss: 26026178.1651; val_kl_reg_loss: 13998.4965; val_edge_recon_loss: 25508961.1157; val_gene_expr_recon_loss: 603091.6691; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26126051.3009; val_optim_loss: 26126051.3009
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9976; val_auprc_score: 0.9971; val_best_acc_score: 0.9829; val_best_f1_score: 0.9831; train_kl_reg_loss: 13780.9512; train_edge_recon_loss: 25408740.3179; train_gene_expr_recon_loss: 600573.1633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26023094.4380; train_optim_loss: 26023094.4380; val_kl_reg_loss: 14152.4667; val_edge_recon_loss: 25488599.3958; val_gene_expr_recon_loss: 617546.0753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26120297.8912; val_optim_loss: 26120297.8912
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9976; val_auprc_score: 0.9970; val_best_acc_score: 0.9819; val_best_f1_score: 0.9821; train_kl_reg_loss: 19449.5490; train_edge_recon_loss: 25401538.2212; train_gene_expr_recon_loss: 601372.5053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26022360.2865; train_optim_loss: 26022360.2865; val_kl_reg_loss: 13845.7700; val_edge_recon_loss: 25479390.9051; val_gene_expr_recon_loss: 603485.8666; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26096722.5347; val_optim_loss: 26096722.5347
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9836; val_best_f1_score: 0.9838; train_kl_reg_loss: 14878.5584; train_edge_recon_loss: 25407210.5934; train_gene_expr_recon_loss: 600908.0590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26022997.2171; train_optim_loss: 26022997.2171; val_kl_reg_loss: 14137.6008; val_edge_recon_loss: 25482126.3727; val_gene_expr_recon_loss: 600250.9302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26096514.9097; val_optim_loss: 26096514.9097
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9975; val_auprc_score: 0.9969; val_best_acc_score: 0.9830; val_best_f1_score: 0.9832; train_kl_reg_loss: 13941.8123; train_edge_recon_loss: 25406373.8382; train_gene_expr_recon_loss: 600542.8625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26020858.5278; train_optim_loss: 26020858.5278; val_kl_reg_loss: 13622.8510; val_edge_recon_loss: 25479046.5556; val_gene_expr_recon_loss: 600725.2631; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26093394.6597; val_optim_loss: 26093394.6597
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9977; val_auprc_score: 0.9971; val_best_acc_score: 0.9832; val_best_f1_score: 0.9834; train_kl_reg_loss: 13913.0714; train_edge_recon_loss: 25406744.4303; train_gene_expr_recon_loss: 600577.6727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26021235.1574; train_optim_loss: 26021235.1574; val_kl_reg_loss: 13723.8633; val_edge_recon_loss: 25474153.2477; val_gene_expr_recon_loss: 599766.2072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26087643.3079; val_optim_loss: 26087643.3079
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9977; val_auprc_score: 0.9971; val_best_acc_score: 0.9831; val_best_f1_score: 0.9832; train_kl_reg_loss: 14051.2985; train_edge_recon_loss: 25398347.9717; train_gene_expr_recon_loss: 600079.9801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26012479.2572; train_optim_loss: 26012479.2572; val_kl_reg_loss: 14666.2024; val_edge_recon_loss: 25480238.5810; val_gene_expr_recon_loss: 601739.3912; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26096644.2176; val_optim_loss: 26096644.2176
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9830; val_best_f1_score: 0.9831; train_kl_reg_loss: 14063.7193; train_edge_recon_loss: 25398719.2240; train_gene_expr_recon_loss: 600416.7668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26013199.7160; train_optim_loss: 26013199.7160; val_kl_reg_loss: 13831.3843; val_edge_recon_loss: 25477833.1921; val_gene_expr_recon_loss: 605412.5743; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26097077.1713; val_optim_loss: 26097077.1713
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9833; val_best_f1_score: 0.9834; train_kl_reg_loss: 13937.5467; train_edge_recon_loss: 25391178.6829; train_gene_expr_recon_loss: 600408.2214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26005524.4509; train_optim_loss: 26005524.4509; val_kl_reg_loss: 13886.2332; val_edge_recon_loss: 25490838.6412; val_gene_expr_recon_loss: 600401.2948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26105126.1852; val_optim_loss: 26105126.1852
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9978; val_auprc_score: 0.9974; val_best_acc_score: 0.9834; val_best_f1_score: 0.9835; train_kl_reg_loss: 13900.5950; train_edge_recon_loss: 25393322.4005; train_gene_expr_recon_loss: 600032.7480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26007255.7487; train_optim_loss: 26007255.7487; val_kl_reg_loss: 13687.9703; val_edge_recon_loss: 25455455.3542; val_gene_expr_recon_loss: 599540.0830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26068683.3565; val_optim_loss: 26068683.3565
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9977; val_auprc_score: 0.9973; val_best_acc_score: 0.9831; val_best_f1_score: 0.9832; train_kl_reg_loss: 17323.8212; train_edge_recon_loss: 25389558.3894; train_gene_expr_recon_loss: 599458.7769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26006340.9889; train_optim_loss: 26006340.9889; val_kl_reg_loss: 14206.9607; val_edge_recon_loss: 25478947.7708; val_gene_expr_recon_loss: 604580.6844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26097735.4213; val_optim_loss: 26097735.4213
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9978; val_auprc_score: 0.9973; val_best_acc_score: 0.9836; val_best_f1_score: 0.9837; train_kl_reg_loss: 14015.1819; train_edge_recon_loss: 25387764.8665; train_gene_expr_recon_loss: 598832.4838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26000612.5337; train_optim_loss: 26000612.5337; val_kl_reg_loss: 14804.4615; val_edge_recon_loss: 25473947.0116; val_gene_expr_recon_loss: 603199.0036; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26091950.5231; val_optim_loss: 26091950.5231
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9976; val_auprc_score: 0.9971; val_best_acc_score: 0.9829; val_best_f1_score: 0.9830; train_kl_reg_loss: 14020.5142; train_edge_recon_loss: 25386921.1831; train_gene_expr_recon_loss: 599327.4825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26000269.1710; train_optim_loss: 26000269.1710; val_kl_reg_loss: 13804.5403; val_edge_recon_loss: 25464020.1991; val_gene_expr_recon_loss: 600384.1961; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26078208.9375; val_optim_loss: 26078208.9375
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9836; val_best_f1_score: 0.9837; train_kl_reg_loss: 14045.9672; train_edge_recon_loss: 25386219.8477; train_gene_expr_recon_loss: 599541.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25999806.9925; train_optim_loss: 25999806.9925; val_kl_reg_loss: 14030.2826; val_edge_recon_loss: 25468056.5162; val_gene_expr_recon_loss: 598167.7789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26080254.5926; val_optim_loss: 26080254.5926

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9852; val_best_f1_score: 0.9853; train_kl_reg_loss: 14322.1042; train_edge_recon_loss: 25361041.1286; train_gene_expr_recon_loss: 588185.1753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25963548.4020; train_optim_loss: 25963548.4020; val_kl_reg_loss: 14410.9817; val_edge_recon_loss: 25419112.5556; val_gene_expr_recon_loss: 589529.6759; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26023053.1852; val_optim_loss: 26023053.1852
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9977; val_auprc_score: 0.9971; val_best_acc_score: 0.9848; val_best_f1_score: 0.9849; train_kl_reg_loss: 14600.8811; train_edge_recon_loss: 25353686.1548; train_gene_expr_recon_loss: 586873.8081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25955160.8359; train_optim_loss: 25955160.8359; val_kl_reg_loss: 14759.1925; val_edge_recon_loss: 25422549.2708; val_gene_expr_recon_loss: 589012.5182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26026320.9861; val_optim_loss: 26026320.9861
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9978; val_auprc_score: 0.9973; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 38793.9611; train_edge_recon_loss: 25354967.8223; train_gene_expr_recon_loss: 586315.3075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25980077.0898; train_optim_loss: 25980077.0898; val_kl_reg_loss: 14669.2791; val_edge_recon_loss: 25428024.3079; val_gene_expr_recon_loss: 587931.1940; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26030624.7731; val_optim_loss: 26030624.7731
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9850; val_best_f1_score: 0.9851; train_kl_reg_loss: 14724.7178; train_edge_recon_loss: 25353941.1332; train_gene_expr_recon_loss: 586034.6251; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25954700.5028; train_optim_loss: 25954700.5028; val_kl_reg_loss: 14723.9586; val_edge_recon_loss: 25419266.0139; val_gene_expr_recon_loss: 587796.3975; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26021786.3866; val_optim_loss: 26021786.3866
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9852; val_best_f1_score: 0.9853; train_kl_reg_loss: 14830.0721; train_edge_recon_loss: 25345050.9221; train_gene_expr_recon_loss: 585594.0050; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25945475.0159; train_optim_loss: 25945475.0159; val_kl_reg_loss: 14866.3675; val_edge_recon_loss: 25410668.8912; val_gene_expr_recon_loss: 587900.7882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26013436.0926; val_optim_loss: 26013436.0926
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9980; val_auprc_score: 0.9976; val_best_acc_score: 0.9854; val_best_f1_score: 0.9855; train_kl_reg_loss: 14866.9201; train_edge_recon_loss: 25344918.8886; train_gene_expr_recon_loss: 585394.3075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25945180.1008; train_optim_loss: 25945180.1008; val_kl_reg_loss: 14992.7492; val_edge_recon_loss: 25416819.6736; val_gene_expr_recon_loss: 587813.1144; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26019625.4884; val_optim_loss: 26019625.4884
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 14889.5212; train_edge_recon_loss: 25346408.6124; train_gene_expr_recon_loss: 585302.8293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25946600.9568; train_optim_loss: 25946600.9568; val_kl_reg_loss: 14664.3991; val_edge_recon_loss: 25426571.6667; val_gene_expr_recon_loss: 587641.4073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26028877.4537; val_optim_loss: 26028877.4537
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9980; val_auprc_score: 0.9977; val_best_acc_score: 0.9854; val_best_f1_score: 0.9854; train_kl_reg_loss: 14746.3283; train_edge_recon_loss: 25344449.4884; train_gene_expr_recon_loss: 584951.6852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25944147.5190; train_optim_loss: 25944147.5190; val_kl_reg_loss: 14855.6355; val_edge_recon_loss: 25406499.4051; val_gene_expr_recon_loss: 587391.2168; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26008746.3102; val_optim_loss: 26008746.3102
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 70142.9643; train_edge_recon_loss: 25344418.4794; train_gene_expr_recon_loss: 585018.9917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25999580.4308; train_optim_loss: 25999580.4308; val_kl_reg_loss: 15150.8000; val_edge_recon_loss: 25416561.2245; val_gene_expr_recon_loss: 585864.6252; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26017576.6852; val_optim_loss: 26017576.6852
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9981; val_auprc_score: 0.9976; val_best_acc_score: 0.9862; val_best_f1_score: 0.9863; train_kl_reg_loss: 14978.9905; train_edge_recon_loss: 25348083.5080; train_gene_expr_recon_loss: 584495.3220; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25947557.8104; train_optim_loss: 25947557.8104; val_kl_reg_loss: 14771.8720; val_edge_recon_loss: 25393680.3889; val_gene_expr_recon_loss: 585396.7791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25993849.0440; val_optim_loss: 25993849.0440
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 14808.6472; train_edge_recon_loss: 25340028.1497; train_gene_expr_recon_loss: 584516.3081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25939353.1145; train_optim_loss: 25939353.1145; val_kl_reg_loss: 14790.2703; val_edge_recon_loss: 25410580.1921; val_gene_expr_recon_loss: 586572.3521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26011942.7708; val_optim_loss: 26011942.7708
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9981; val_auprc_score: 0.9976; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 14845.3681; train_edge_recon_loss: 25343479.2171; train_gene_expr_recon_loss: 584679.6623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25943004.2495; train_optim_loss: 25943004.2495; val_kl_reg_loss: 14934.4188; val_edge_recon_loss: 25394094.2407; val_gene_expr_recon_loss: 586941.8879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25995970.5278; val_optim_loss: 25995970.5278
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9980; val_auprc_score: 0.9977; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 972658905282.2924; train_edge_recon_loss: 25342053.9360; train_gene_expr_recon_loss: 584330.0209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 972684828365.6401; train_optim_loss: 972684828365.6401; val_kl_reg_loss: 14903.4645; val_edge_recon_loss: 25410537.5671; val_gene_expr_recon_loss: 585178.5450; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26010619.5810; val_optim_loss: 26010619.5810
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9980; val_auprc_score: 0.9976; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 9317411262776.4727; train_edge_recon_loss: 25344662.5926; train_gene_expr_recon_loss: 584590.8975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9317437188662.0020; train_optim_loss: 9317437188662.0020; val_kl_reg_loss: 15031.9155; val_edge_recon_loss: 25404880.5579; val_gene_expr_recon_loss: 586941.3138; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26006853.7546; val_optim_loss: 26006853.7546

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 14999.5203; train_edge_recon_loss: 25343241.4668; train_gene_expr_recon_loss: 583524.2738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25941765.2621; train_optim_loss: 25941765.2621; val_kl_reg_loss: 15031.8087; val_edge_recon_loss: 25396724.4329; val_gene_expr_recon_loss: 586059.4349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25997815.7176; val_optim_loss: 25997815.7176
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9980; val_auprc_score: 0.9973; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 15020.4259; train_edge_recon_loss: 25343234.7788; train_gene_expr_recon_loss: 583606.3133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25941861.5265; train_optim_loss: 25941861.5265; val_kl_reg_loss: 15025.0279; val_edge_recon_loss: 25390590.4051; val_gene_expr_recon_loss: 585780.9878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25991396.3912; val_optim_loss: 25991396.3912
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9980; val_auprc_score: 0.9975; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 15027.3061; train_edge_recon_loss: 25340482.2564; train_gene_expr_recon_loss: 583677.1771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25939186.7567; train_optim_loss: 25939186.7567; val_kl_reg_loss: 15046.0411; val_edge_recon_loss: 25402208.9097; val_gene_expr_recon_loss: 585017.8924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26002272.8634; val_optim_loss: 26002272.8634
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9980; val_auprc_score: 0.9976; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 15038.7488; train_edge_recon_loss: 25341901.0242; train_gene_expr_recon_loss: 583417.7876; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25940357.5697; train_optim_loss: 25940357.5697; val_kl_reg_loss: 15063.6485; val_edge_recon_loss: 25394710.4745; val_gene_expr_recon_loss: 586433.9704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25996208.0903; val_optim_loss: 25996208.0903
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9980; val_auprc_score: 0.9976; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 15044.8041; train_edge_recon_loss: 25343446.1448; train_gene_expr_recon_loss: 583430.5153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25941921.4542; train_optim_loss: 25941921.4542; val_kl_reg_loss: 15075.1090; val_edge_recon_loss: 25400383.7199; val_gene_expr_recon_loss: 585772.5632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26001231.4120; val_optim_loss: 26001231.4120
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 15021.2572; train_edge_recon_loss: 25341102.6160; train_gene_expr_recon_loss: 583495.8178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25939619.6811; train_optim_loss: 25939619.6811; val_kl_reg_loss: 15005.9105; val_edge_recon_loss: 25401623.0995; val_gene_expr_recon_loss: 585505.4683; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26002134.5069; val_optim_loss: 26002134.5069

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 14970.5914; train_edge_recon_loss: 25337110.2238; train_gene_expr_recon_loss: 583182.3037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25935263.1047; train_optim_loss: 25935263.1047; val_kl_reg_loss: 14965.8849; val_edge_recon_loss: 25390277.7130; val_gene_expr_recon_loss: 584667.7093; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25989911.2963; val_optim_loss: 25989911.2963
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9980; val_auprc_score: 0.9975; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 328701.0820; train_edge_recon_loss: 25341455.1523; train_gene_expr_recon_loss: 583104.1981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26253260.4411; train_optim_loss: 26253260.4411; val_kl_reg_loss: 14959.6083; val_edge_recon_loss: 25395446.5625; val_gene_expr_recon_loss: 585631.1087; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25996037.3032; val_optim_loss: 25996037.3032
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9980; val_auprc_score: 0.9975; val_best_acc_score: 0.9854; val_best_f1_score: 0.9855; train_kl_reg_loss: 20558.1438; train_edge_recon_loss: 25339517.3027; train_gene_expr_recon_loss: 583320.3253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25943395.7708; train_optim_loss: 25943395.7708; val_kl_reg_loss: 14968.1031; val_edge_recon_loss: 25414676.6250; val_gene_expr_recon_loss: 585059.3597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26014704.0694; val_optim_loss: 26014704.0694
Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9980; val_auprc_score: 0.9976; val_best_acc_score: 0.9862; val_best_f1_score: 0.9863; train_kl_reg_loss: 14953.8623; train_edge_recon_loss: 25340467.3789; train_gene_expr_recon_loss: 583017.9687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25938439.2199; train_optim_loss: 25938439.2199; val_kl_reg_loss: 14973.5087; val_edge_recon_loss: 25395903.0301; val_gene_expr_recon_loss: 585460.9406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25996337.4653; val_optim_loss: 25996337.4653
Epoch 64/100 |████████████--------| 64.0% val_auroc_score: 0.9981; val_auprc_score: 0.9978; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 14939.0825; train_edge_recon_loss: 25343897.0198; train_gene_expr_recon_loss: 583211.1300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25942047.2436; train_optim_loss: 25942047.2436; val_kl_reg_loss: 14947.4284; val_edge_recon_loss: 25396328.0185; val_gene_expr_recon_loss: 585111.0894; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25996386.5370; val_optim_loss: 25996386.5370

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 65/100 |█████████████-------| 65.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 14925.7670; train_edge_recon_loss: 25335444.2989; train_gene_expr_recon_loss: 583019.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25933389.6114; train_optim_loss: 25933389.6114; val_kl_reg_loss: 14954.8818; val_edge_recon_loss: 25413638.8542; val_gene_expr_recon_loss: 584706.2595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26013299.9861; val_optim_loss: 26013299.9861
Epoch 66/100 |█████████████-------| 66.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 14929.2402; train_edge_recon_loss: 25340097.6013; train_gene_expr_recon_loss: 583096.9729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25938123.8256; train_optim_loss: 25938123.8256; val_kl_reg_loss: 14956.3051; val_edge_recon_loss: 25412339.7153; val_gene_expr_recon_loss: 585181.5302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26012477.5417; val_optim_loss: 26012477.5417
Epoch 67/100 |█████████████-------| 67.0% val_auroc_score: 0.9980; val_auprc_score: 0.9975; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 18956.5692; train_edge_recon_loss: 25340045.1854; train_gene_expr_recon_loss: 583114.9739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25942116.7341; train_optim_loss: 25942116.7341; val_kl_reg_loss: 14941.5380; val_edge_recon_loss: 25401007.6551; val_gene_expr_recon_loss: 585522.3322; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26001471.5764; val_optim_loss: 26001471.5764
Epoch 68/100 |█████████████-------| 68.0% val_auroc_score: 0.9981; val_auprc_score: 0.9976; val_best_acc_score: 0.9863; val_best_f1_score: 0.9863; train_kl_reg_loss: 6466475223294788608.0000; train_edge_recon_loss: 25334913.6893; train_gene_expr_recon_loss: 582980.5858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6466475223320704000.0000; train_optim_loss: 6466475223320704000.0000; val_kl_reg_loss: 14950.2994; val_edge_recon_loss: 25391192.9282; val_gene_expr_recon_loss: 585554.4639; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25991697.6273; val_optim_loss: 25991697.6273

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2214 min 0 sec.
Using best model state, which was in epoch 60.

--- MODEL EVALUATION ---
Val AUROC score: 0.9981
Val AUPRC score: 0.9976
Val best accuracy score: 0.9857
Val best F1 score: 0.9858
Val gene expr MSE score: 1.7473

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
