None
Run timestamp: 16072023_061455_2004.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_2004']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9146; val_auprc_score: 0.8921; val_best_acc_score: 0.8446; val_best_f1_score: 0.8553; train_kl_reg_loss: 49451.1875; train_edge_recon_loss: 2900288.8794; train_gene_expr_recon_loss: 7422391.1368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10372131.2147; train_optim_loss: 10372131.2147; val_kl_reg_loss: 47845.4278; val_edge_recon_loss: 2792637.6546; val_gene_expr_recon_loss: 6876792.0197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9717275.0526; val_optim_loss: 9717275.0526
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9294; val_auprc_score: 0.9103; val_best_acc_score: 0.8637; val_best_f1_score: 0.8725; train_kl_reg_loss: 45384.1469; train_edge_recon_loss: 2718099.9419; train_gene_expr_recon_loss: 6688486.4316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9451970.4985; train_optim_loss: 9451970.4985; val_kl_reg_loss: 39707.9349; val_edge_recon_loss: 2748234.9112; val_gene_expr_recon_loss: 6583312.9342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9371255.7500; val_optim_loss: 9371255.7500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9398; val_auprc_score: 0.9236; val_best_acc_score: 0.8772; val_best_f1_score: 0.8851; train_kl_reg_loss: 39016.3119; train_edge_recon_loss: 2686590.8779; train_gene_expr_recon_loss: 6439501.1647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9165108.3794; train_optim_loss: 9165108.3794; val_kl_reg_loss: 36759.3886; val_edge_recon_loss: 2726298.0789; val_gene_expr_recon_loss: 6367932.4013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9130989.8421; val_optim_loss: 9130989.8421
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9432; val_auprc_score: 0.9288; val_best_acc_score: 0.8811; val_best_f1_score: 0.8881; train_kl_reg_loss: 36422.8172; train_edge_recon_loss: 2675424.0103; train_gene_expr_recon_loss: 6276125.6507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8987972.4706; train_optim_loss: 8987972.4706; val_kl_reg_loss: 34430.8291; val_edge_recon_loss: 2719093.5921; val_gene_expr_recon_loss: 6256988.1447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9010512.5921; val_optim_loss: 9010512.5921
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9452; val_auprc_score: 0.9304; val_best_acc_score: 0.8832; val_best_f1_score: 0.8906; train_kl_reg_loss: 34814.4119; train_edge_recon_loss: 2668414.9540; train_gene_expr_recon_loss: 6178812.6559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8882042.0206; train_optim_loss: 8882042.0206; val_kl_reg_loss: 33478.1696; val_edge_recon_loss: 2714508.4605; val_gene_expr_recon_loss: 6166647.3026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8914633.9408; val_optim_loss: 8914633.9408
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9486; val_auprc_score: 0.9354; val_best_acc_score: 0.8870; val_best_f1_score: 0.8940; train_kl_reg_loss: 33672.4178; train_edge_recon_loss: 2664088.6415; train_gene_expr_recon_loss: 6106094.4309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8803855.4809; train_optim_loss: 8803855.4809; val_kl_reg_loss: 32235.1010; val_edge_recon_loss: 2708120.5625; val_gene_expr_recon_loss: 6120920.6908; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8861276.3421; val_optim_loss: 8861276.3421
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9491; val_auprc_score: 0.9362; val_best_acc_score: 0.8872; val_best_f1_score: 0.8944; train_kl_reg_loss: 32671.9553; train_edge_recon_loss: 2659834.5460; train_gene_expr_recon_loss: 6063862.8309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8756369.3397; train_optim_loss: 8756369.3397; val_kl_reg_loss: 31997.6183; val_edge_recon_loss: 2709936.3092; val_gene_expr_recon_loss: 6106041.8947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8847975.7895; val_optim_loss: 8847975.7895
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9518; val_auprc_score: 0.9396; val_best_acc_score: 0.8895; val_best_f1_score: 0.8960; train_kl_reg_loss: 32149.9065; train_edge_recon_loss: 2658209.9699; train_gene_expr_recon_loss: 6037713.0412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8728072.9265; train_optim_loss: 8728072.9265; val_kl_reg_loss: 31452.8744; val_edge_recon_loss: 2706084.6809; val_gene_expr_recon_loss: 6066097.0526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8803634.6579; val_optim_loss: 8803634.6579
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9524; val_auprc_score: 0.9406; val_best_acc_score: 0.8906; val_best_f1_score: 0.8968; train_kl_reg_loss: 31591.4569; train_edge_recon_loss: 2656880.8772; train_gene_expr_recon_loss: 6011666.9419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8700139.2625; train_optim_loss: 8700139.2625; val_kl_reg_loss: 30353.5839; val_edge_recon_loss: 2710967.7171; val_gene_expr_recon_loss: 6038452.8618; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8779774.1711; val_optim_loss: 8779774.1711
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9551; val_auprc_score: 0.9431; val_best_acc_score: 0.8960; val_best_f1_score: 0.9010; train_kl_reg_loss: 30953.6533; train_edge_recon_loss: 2653892.1261; train_gene_expr_recon_loss: 5997884.5603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8682730.3368; train_optim_loss: 8682730.3368; val_kl_reg_loss: 30171.4165; val_edge_recon_loss: 2697198.1447; val_gene_expr_recon_loss: 6039281.0592; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8766650.6316; val_optim_loss: 8766650.6316
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9540; val_auprc_score: 0.9429; val_best_acc_score: 0.8919; val_best_f1_score: 0.8976; train_kl_reg_loss: 30608.6706; train_edge_recon_loss: 2654873.0305; train_gene_expr_recon_loss: 5982530.1456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8668011.8338; train_optim_loss: 8668011.8338; val_kl_reg_loss: 29897.4461; val_edge_recon_loss: 2706238.3158; val_gene_expr_recon_loss: 6022816.4408; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8758952.2237; val_optim_loss: 8758952.2237
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9554; val_auprc_score: 0.9437; val_best_acc_score: 0.8950; val_best_f1_score: 0.9011; train_kl_reg_loss: 30150.7417; train_edge_recon_loss: 2651086.0908; train_gene_expr_recon_loss: 5973041.1309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8654277.9750; train_optim_loss: 8654277.9750; val_kl_reg_loss: 29616.9498; val_edge_recon_loss: 2698636.2533; val_gene_expr_recon_loss: 6010581.5855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8738834.8289; val_optim_loss: 8738834.8289
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9578; val_auprc_score: 0.9478; val_best_acc_score: 0.8982; val_best_f1_score: 0.9026; train_kl_reg_loss: 29840.0400; train_edge_recon_loss: 2650446.7449; train_gene_expr_recon_loss: 5963990.0890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8644276.8846; train_optim_loss: 8644276.8846; val_kl_reg_loss: 28922.9168; val_edge_recon_loss: 2694823.5132; val_gene_expr_recon_loss: 6014332.1974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8738078.6316; val_optim_loss: 8738078.6316
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9579; val_auprc_score: 0.9481; val_best_acc_score: 0.8985; val_best_f1_score: 0.9030; train_kl_reg_loss: 29637.3153; train_edge_recon_loss: 2647378.7662; train_gene_expr_recon_loss: 5955209.7316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8632225.8235; train_optim_loss: 8632225.8235; val_kl_reg_loss: 28749.7239; val_edge_recon_loss: 2698422.4309; val_gene_expr_recon_loss: 6009155.6184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8736327.8026; val_optim_loss: 8736327.8026
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9576; val_auprc_score: 0.9471; val_best_acc_score: 0.8987; val_best_f1_score: 0.9032; train_kl_reg_loss: 29470.5335; train_edge_recon_loss: 2646033.3169; train_gene_expr_recon_loss: 5946408.6838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8621912.5456; train_optim_loss: 8621912.5456; val_kl_reg_loss: 28669.2286; val_edge_recon_loss: 2697373.0658; val_gene_expr_recon_loss: 6028216.5789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8754258.8684; val_optim_loss: 8754258.8684
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9586; val_auprc_score: 0.9493; val_best_acc_score: 0.8994; val_best_f1_score: 0.9041; train_kl_reg_loss: 29043.5032; train_edge_recon_loss: 2646912.6257; train_gene_expr_recon_loss: 5944384.6265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8620340.7368; train_optim_loss: 8620340.7368; val_kl_reg_loss: 28148.2359; val_edge_recon_loss: 2696148.2829; val_gene_expr_recon_loss: 6023178.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8747475.0132; val_optim_loss: 8747475.0132
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9592; val_auprc_score: 0.9498; val_best_acc_score: 0.8997; val_best_f1_score: 0.9047; train_kl_reg_loss: 28718.6392; train_edge_recon_loss: 2645947.0037; train_gene_expr_recon_loss: 5939044.6779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8613710.3279; train_optim_loss: 8613710.3279; val_kl_reg_loss: 28223.2761; val_edge_recon_loss: 2694711.3059; val_gene_expr_recon_loss: 6008377.7829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8731312.3947; val_optim_loss: 8731312.3947
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9595; val_auprc_score: 0.9504; val_best_acc_score: 0.8997; val_best_f1_score: 0.9047; train_kl_reg_loss: 28378.3365; train_edge_recon_loss: 2644394.6471; train_gene_expr_recon_loss: 5934753.6176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8607526.5963; train_optim_loss: 8607526.5963; val_kl_reg_loss: 27578.8635; val_edge_recon_loss: 2699546.3849; val_gene_expr_recon_loss: 6006758.3618; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8733883.6053; val_optim_loss: 8733883.6053
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9607; val_auprc_score: 0.9521; val_best_acc_score: 0.9022; val_best_f1_score: 0.9068; train_kl_reg_loss: 28130.3741; train_edge_recon_loss: 2642617.4449; train_gene_expr_recon_loss: 5930608.4103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8601356.2066; train_optim_loss: 8601356.2066; val_kl_reg_loss: 27440.9388; val_edge_recon_loss: 2696459.8717; val_gene_expr_recon_loss: 5990147.5263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8714048.3684; val_optim_loss: 8714048.3684
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9624; val_auprc_score: 0.9536; val_best_acc_score: 0.9039; val_best_f1_score: 0.9077; train_kl_reg_loss: 27936.3596; train_edge_recon_loss: 2643311.5978; train_gene_expr_recon_loss: 5929062.7074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8600310.6382; train_optim_loss: 8600310.6382; val_kl_reg_loss: 26646.7148; val_edge_recon_loss: 2694723.2862; val_gene_expr_recon_loss: 5997159.2368; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8718529.2500; val_optim_loss: 8718529.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9628; val_auprc_score: 0.9547; val_best_acc_score: 0.9044; val_best_f1_score: 0.9085; train_kl_reg_loss: 27690.8863; train_edge_recon_loss: 2642079.0107; train_gene_expr_recon_loss: 5924096.2235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8593866.1066; train_optim_loss: 8593866.1066; val_kl_reg_loss: 26658.6612; val_edge_recon_loss: 2696163.6316; val_gene_expr_recon_loss: 6005769.4605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8728591.7697; val_optim_loss: 8728591.7697
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9625; val_auprc_score: 0.9530; val_best_acc_score: 0.9055; val_best_f1_score: 0.9091; train_kl_reg_loss: 27565.7377; train_edge_recon_loss: 2640237.4779; train_gene_expr_recon_loss: 5920612.6779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8588415.9110; train_optim_loss: 8588415.9110; val_kl_reg_loss: 26873.6427; val_edge_recon_loss: 2689321.2928; val_gene_expr_recon_loss: 5997644.2105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8713839.1908; val_optim_loss: 8713839.1908
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9633; val_auprc_score: 0.9551; val_best_acc_score: 0.9054; val_best_f1_score: 0.9096; train_kl_reg_loss: 27273.3384; train_edge_recon_loss: 2641324.2180; train_gene_expr_recon_loss: 5920333.2265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8588930.7831; train_optim_loss: 8588930.7831; val_kl_reg_loss: 26379.1647; val_edge_recon_loss: 2696058.3092; val_gene_expr_recon_loss: 5981320.4803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8703757.9211; val_optim_loss: 8703757.9211
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9645; val_auprc_score: 0.9566; val_best_acc_score: 0.9069; val_best_f1_score: 0.9104; train_kl_reg_loss: 27261.6536; train_edge_recon_loss: 2639194.0085; train_gene_expr_recon_loss: 5916003.8691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8582459.5338; train_optim_loss: 8582459.5338; val_kl_reg_loss: 26524.1772; val_edge_recon_loss: 2695154.9539; val_gene_expr_recon_loss: 5975556.8224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8697235.9605; val_optim_loss: 8697235.9605
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9652; val_auprc_score: 0.9567; val_best_acc_score: 0.9093; val_best_f1_score: 0.9123; train_kl_reg_loss: 27077.1938; train_edge_recon_loss: 2637233.9430; train_gene_expr_recon_loss: 5917377.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8581688.3860; train_optim_loss: 8581688.3860; val_kl_reg_loss: 26370.8906; val_edge_recon_loss: 2690874.8191; val_gene_expr_recon_loss: 5980671.2434; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8697916.9737; val_optim_loss: 8697916.9737
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9648; val_auprc_score: 0.9556; val_best_acc_score: 0.9095; val_best_f1_score: 0.9125; train_kl_reg_loss: 26975.5086; train_edge_recon_loss: 2637173.5761; train_gene_expr_recon_loss: 5913719.7051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8577868.7978; train_optim_loss: 8577868.7978; val_kl_reg_loss: 25964.7914; val_edge_recon_loss: 2692532.2566; val_gene_expr_recon_loss: 5985884.9013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8704381.9211; val_optim_loss: 8704381.9211
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9652; val_auprc_score: 0.9572; val_best_acc_score: 0.9094; val_best_f1_score: 0.9131; train_kl_reg_loss: 26854.4608; train_edge_recon_loss: 2635820.0331; train_gene_expr_recon_loss: 5913857.5331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8576532.0243; train_optim_loss: 8576532.0243; val_kl_reg_loss: 25929.0159; val_edge_recon_loss: 2690743.4211; val_gene_expr_recon_loss: 5984172.5724; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8700845.0263; val_optim_loss: 8700845.0263
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9663; val_auprc_score: 0.9583; val_best_acc_score: 0.9116; val_best_f1_score: 0.9152; train_kl_reg_loss: 26708.0006; train_edge_recon_loss: 2635054.2276; train_gene_expr_recon_loss: 5911292.7169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8573054.9404; train_optim_loss: 8573054.9404; val_kl_reg_loss: 25847.1230; val_edge_recon_loss: 2689747.1250; val_gene_expr_recon_loss: 5991775.8816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8707370.0921; val_optim_loss: 8707370.0921

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9671; val_auprc_score: 0.9602; val_best_acc_score: 0.9111; val_best_f1_score: 0.9146; train_kl_reg_loss: 26767.7373; train_edge_recon_loss: 2632313.0912; train_gene_expr_recon_loss: 5870493.9309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8529574.7574; train_optim_loss: 8529574.7574; val_kl_reg_loss: 26303.2944; val_edge_recon_loss: 2686581.6053; val_gene_expr_recon_loss: 5946627.8947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8659512.7697; val_optim_loss: 8659512.7697
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9660; val_auprc_score: 0.9587; val_best_acc_score: 0.9100; val_best_f1_score: 0.9137; train_kl_reg_loss: 27026.0498; train_edge_recon_loss: 2633112.1835; train_gene_expr_recon_loss: 5871908.3441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8532046.5728; train_optim_loss: 8532046.5728; val_kl_reg_loss: 26414.4688; val_edge_recon_loss: 2688058.8158; val_gene_expr_recon_loss: 5952768.8355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8667242.0395; val_optim_loss: 8667242.0395
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9671; val_auprc_score: 0.9602; val_best_acc_score: 0.9118; val_best_f1_score: 0.9153; train_kl_reg_loss: 27191.0512; train_edge_recon_loss: 2633268.1974; train_gene_expr_recon_loss: 5868166.9147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8528626.1625; train_optim_loss: 8528626.1625; val_kl_reg_loss: 26584.3659; val_edge_recon_loss: 2684233.5987; val_gene_expr_recon_loss: 5961871.6118; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8672689.5658; val_optim_loss: 8672689.5658
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9671; val_auprc_score: 0.9600; val_best_acc_score: 0.9113; val_best_f1_score: 0.9147; train_kl_reg_loss: 27336.3466; train_edge_recon_loss: 2631596.6070; train_gene_expr_recon_loss: 5867272.5331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8526205.4838; train_optim_loss: 8526205.4838; val_kl_reg_loss: 26707.0706; val_edge_recon_loss: 2683791.2368; val_gene_expr_recon_loss: 5957712.7105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8668210.9934; val_optim_loss: 8668210.9934
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9661; val_auprc_score: 0.9590; val_best_acc_score: 0.9106; val_best_f1_score: 0.9139; train_kl_reg_loss: 27408.5216; train_edge_recon_loss: 2633642.8548; train_gene_expr_recon_loss: 5869989.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8531041.1831; train_optim_loss: 8531041.1831; val_kl_reg_loss: 26885.2359; val_edge_recon_loss: 2685769.3684; val_gene_expr_recon_loss: 5945194.4934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8657849.1316; val_optim_loss: 8657849.1316
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9672; val_auprc_score: 0.9605; val_best_acc_score: 0.9115; val_best_f1_score: 0.9147; train_kl_reg_loss: 27397.2498; train_edge_recon_loss: 2632854.5382; train_gene_expr_recon_loss: 5864035.0037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8524286.8118; train_optim_loss: 8524286.8118; val_kl_reg_loss: 26743.1339; val_edge_recon_loss: 2686353.1118; val_gene_expr_recon_loss: 5950140.9276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8663237.1316; val_optim_loss: 8663237.1316
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9664; val_auprc_score: 0.9591; val_best_acc_score: 0.9112; val_best_f1_score: 0.9144; train_kl_reg_loss: 27318.7521; train_edge_recon_loss: 2632966.2335; train_gene_expr_recon_loss: 5867015.5338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8527300.5184; train_optim_loss: 8527300.5184; val_kl_reg_loss: 26656.2146; val_edge_recon_loss: 2687891.3355; val_gene_expr_recon_loss: 5947760.4539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8662308.0066; val_optim_loss: 8662308.0066
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9668; val_auprc_score: 0.9597; val_best_acc_score: 0.9114; val_best_f1_score: 0.9144; train_kl_reg_loss: 27343.2472; train_edge_recon_loss: 2632461.8110; train_gene_expr_recon_loss: 5865388.7265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8525193.7684; train_optim_loss: 8525193.7684; val_kl_reg_loss: 26603.8958; val_edge_recon_loss: 2683945.6908; val_gene_expr_recon_loss: 5938105.0132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8648654.5921; val_optim_loss: 8648654.5921
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9672; val_auprc_score: 0.9600; val_best_acc_score: 0.9122; val_best_f1_score: 0.9153; train_kl_reg_loss: 27265.7835; train_edge_recon_loss: 2632389.1011; train_gene_expr_recon_loss: 5867505.2382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8527160.1110; train_optim_loss: 8527160.1110; val_kl_reg_loss: 26522.3659; val_edge_recon_loss: 2684445.2500; val_gene_expr_recon_loss: 5950483.5526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8661451.1842; val_optim_loss: 8661451.1842
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9666; val_auprc_score: 0.9589; val_best_acc_score: 0.9093; val_best_f1_score: 0.9131; train_kl_reg_loss: 27380.7224; train_edge_recon_loss: 2629004.9956; train_gene_expr_recon_loss: 5865754.4912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8522140.1993; train_optim_loss: 8522140.1993; val_kl_reg_loss: 26697.7363; val_edge_recon_loss: 2688128.0822; val_gene_expr_recon_loss: 5954944.7039; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8669770.5000; val_optim_loss: 8669770.5000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9675; val_auprc_score: 0.9604; val_best_acc_score: 0.9122; val_best_f1_score: 0.9152; train_kl_reg_loss: 27378.1155; train_edge_recon_loss: 2630596.7070; train_gene_expr_recon_loss: 5865674.0963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8523648.9191; train_optim_loss: 8523648.9191; val_kl_reg_loss: 26682.1600; val_edge_recon_loss: 2686338.0000; val_gene_expr_recon_loss: 5960673.4013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8673693.5461; val_optim_loss: 8673693.5461
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9666; val_auprc_score: 0.9593; val_best_acc_score: 0.9108; val_best_f1_score: 0.9139; train_kl_reg_loss: 27247.0225; train_edge_recon_loss: 2631286.9761; train_gene_expr_recon_loss: 5867442.6243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8525976.6404; train_optim_loss: 8525976.6404; val_kl_reg_loss: 26415.0254; val_edge_recon_loss: 2690209.8355; val_gene_expr_recon_loss: 5938282.4474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8654907.3092; val_optim_loss: 8654907.3092

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9668; val_auprc_score: 0.9595; val_best_acc_score: 0.9116; val_best_f1_score: 0.9151; train_kl_reg_loss: 27135.3881; train_edge_recon_loss: 2632395.0335; train_gene_expr_recon_loss: 5860312.3779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8519842.8022; train_optim_loss: 8519842.8022; val_kl_reg_loss: 26473.0875; val_edge_recon_loss: 2686085.0000; val_gene_expr_recon_loss: 5937429.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8649987.5395; val_optim_loss: 8649987.5395
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9670; val_auprc_score: 0.9600; val_best_acc_score: 0.9111; val_best_f1_score: 0.9143; train_kl_reg_loss: 27199.9570; train_edge_recon_loss: 2630318.4665; train_gene_expr_recon_loss: 5861072.1426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8518590.5618; train_optim_loss: 8518590.5618; val_kl_reg_loss: 26482.1550; val_edge_recon_loss: 2689046.6184; val_gene_expr_recon_loss: 5931525.9474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8647054.6316; val_optim_loss: 8647054.6316
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9672; val_auprc_score: 0.9605; val_best_acc_score: 0.9115; val_best_f1_score: 0.9150; train_kl_reg_loss: 27241.2965; train_edge_recon_loss: 2630439.0265; train_gene_expr_recon_loss: 5862536.9419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8520217.2816; train_optim_loss: 8520217.2816; val_kl_reg_loss: 26550.3108; val_edge_recon_loss: 2685820.4572; val_gene_expr_recon_loss: 5944395.6447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8656766.4605; val_optim_loss: 8656766.4605
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9672; val_auprc_score: 0.9592; val_best_acc_score: 0.9113; val_best_f1_score: 0.9148; train_kl_reg_loss: 27234.4320; train_edge_recon_loss: 2631475.4640; train_gene_expr_recon_loss: 5862100.7471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8520810.6404; train_optim_loss: 8520810.6404; val_kl_reg_loss: 26514.3633; val_edge_recon_loss: 2689167.8816; val_gene_expr_recon_loss: 5942216.3882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8657898.6447; val_optim_loss: 8657898.6447
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9674; val_auprc_score: 0.9598; val_best_acc_score: 0.9129; val_best_f1_score: 0.9159; train_kl_reg_loss: 27240.0744; train_edge_recon_loss: 2631388.3290; train_gene_expr_recon_loss: 5859809.6463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8518438.0478; train_optim_loss: 8518438.0478; val_kl_reg_loss: 26529.2210; val_edge_recon_loss: 2682445.8553; val_gene_expr_recon_loss: 5935908.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8644883.3158; val_optim_loss: 8644883.3158
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9676; val_auprc_score: 0.9603; val_best_acc_score: 0.9128; val_best_f1_score: 0.9161; train_kl_reg_loss: 27268.2820; train_edge_recon_loss: 2630765.1015; train_gene_expr_recon_loss: 5856769.9309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8514803.3250; train_optim_loss: 8514803.3250; val_kl_reg_loss: 26612.4672; val_edge_recon_loss: 2685993.9243; val_gene_expr_recon_loss: 5942775.4671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8655381.8289; val_optim_loss: 8655381.8289
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9672; val_auprc_score: 0.9596; val_best_acc_score: 0.9120; val_best_f1_score: 0.9153; train_kl_reg_loss: 27280.3376; train_edge_recon_loss: 2629806.3320; train_gene_expr_recon_loss: 5860051.7449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8517138.4199; train_optim_loss: 8517138.4199; val_kl_reg_loss: 26554.8699; val_edge_recon_loss: 2685888.3947; val_gene_expr_recon_loss: 5941300.0461; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8653743.3026; val_optim_loss: 8653743.3026
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9661; val_auprc_score: 0.9586; val_best_acc_score: 0.9107; val_best_f1_score: 0.9146; train_kl_reg_loss: 27280.3774; train_edge_recon_loss: 2630260.1404; train_gene_expr_recon_loss: 5858942.6074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8516483.1257; train_optim_loss: 8516483.1257; val_kl_reg_loss: 26623.6655; val_edge_recon_loss: 2686193.0658; val_gene_expr_recon_loss: 5944100.5855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8656917.2895; val_optim_loss: 8656917.2895
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9673; val_auprc_score: 0.9600; val_best_acc_score: 0.9128; val_best_f1_score: 0.9161; train_kl_reg_loss: 27287.7221; train_edge_recon_loss: 2632189.0632; train_gene_expr_recon_loss: 5863085.7647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8522562.5478; train_optim_loss: 8522562.5478; val_kl_reg_loss: 26590.4015; val_edge_recon_loss: 2682024.0526; val_gene_expr_recon_loss: 5959975.2434; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8668589.7697; val_optim_loss: 8668589.7697

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9669; val_auprc_score: 0.9589; val_best_acc_score: 0.9119; val_best_f1_score: 0.9154; train_kl_reg_loss: 27279.4692; train_edge_recon_loss: 2631320.8581; train_gene_expr_recon_loss: 5856675.4493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8515275.7868; train_optim_loss: 8515275.7868; val_kl_reg_loss: 26585.3333; val_edge_recon_loss: 2685579.6974; val_gene_expr_recon_loss: 5944693.0526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8656858.0658; val_optim_loss: 8656858.0658
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9678; val_auprc_score: 0.9610; val_best_acc_score: 0.9130; val_best_f1_score: 0.9159; train_kl_reg_loss: 27294.1078; train_edge_recon_loss: 2631306.2739; train_gene_expr_recon_loss: 5860777.7654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8519378.1331; train_optim_loss: 8519378.1331; val_kl_reg_loss: 26591.0469; val_edge_recon_loss: 2680670.6151; val_gene_expr_recon_loss: 5948985.5724; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8656247.2368; val_optim_loss: 8656247.2368
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9669; val_auprc_score: 0.9597; val_best_acc_score: 0.9115; val_best_f1_score: 0.9145; train_kl_reg_loss: 27298.6255; train_edge_recon_loss: 2632553.4062; train_gene_expr_recon_loss: 5859449.7588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8519301.7956; train_optim_loss: 8519301.7956; val_kl_reg_loss: 26614.9577; val_edge_recon_loss: 2688874.2697; val_gene_expr_recon_loss: 5947693.8158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8663183.0066; val_optim_loss: 8663183.0066
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9671; val_auprc_score: 0.9595; val_best_acc_score: 0.9118; val_best_f1_score: 0.9150; train_kl_reg_loss: 27304.1644; train_edge_recon_loss: 2629737.8335; train_gene_expr_recon_loss: 5859404.7235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8516446.6846; train_optim_loss: 8516446.6846; val_kl_reg_loss: 26579.9970; val_edge_recon_loss: 2687553.4539; val_gene_expr_recon_loss: 5943547.8947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8657681.2632; val_optim_loss: 8657681.2632

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 92 min 48 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
Val AUROC score: 0.9664
Val AUPRC score: 0.9592
Val best accuracy score: 0.9102
Val best F1 score: 0.9135
Val gene expr MSE score: 1.3967

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
