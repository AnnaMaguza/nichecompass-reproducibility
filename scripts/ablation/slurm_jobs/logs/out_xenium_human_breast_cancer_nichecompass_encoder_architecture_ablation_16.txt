None
Run timestamp: 26072023_043951_16.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '2', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '3000.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '128', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_16']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 2, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 128
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9897; val_auprc_score: 0.9888; val_best_acc_score: 0.9500; val_best_f1_score: 0.9509; train_kl_reg_loss: 17111.8908; train_edge_recon_loss: 26108342.6926; train_gene_expr_recon_loss: 825496.0418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26950950.6340; train_optim_loss: 26950950.6340; val_kl_reg_loss: 15915.3376; val_edge_recon_loss: 25897276.2426; val_gene_expr_recon_loss: 785284.6042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26698476.1780; val_optim_loss: 26698476.1780
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9921; val_auprc_score: 0.9916; val_best_acc_score: 0.9562; val_best_f1_score: 0.9568; train_kl_reg_loss: 16330.4103; train_edge_recon_loss: 25753671.4139; train_gene_expr_recon_loss: 758853.7150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26528855.5429; train_optim_loss: 26528855.5429; val_kl_reg_loss: 17329.5251; val_edge_recon_loss: 25836665.1501; val_gene_expr_recon_loss: 749413.0420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26603407.7173; val_optim_loss: 26603407.7173
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9944; val_auprc_score: 0.9937; val_best_acc_score: 0.9647; val_best_f1_score: 0.9651; train_kl_reg_loss: 16326.8089; train_edge_recon_loss: 25681544.0353; train_gene_expr_recon_loss: 743416.7187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26441287.5530; train_optim_loss: 26441287.5530; val_kl_reg_loss: 15038.0079; val_edge_recon_loss: 25745977.4171; val_gene_expr_recon_loss: 735150.0533; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26496165.4729; val_optim_loss: 26496165.4729
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9958; val_auprc_score: 0.9953; val_best_acc_score: 0.9704; val_best_f1_score: 0.9706; train_kl_reg_loss: 14849.0288; train_edge_recon_loss: 25631079.1194; train_gene_expr_recon_loss: 733847.9569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26379776.1079; train_optim_loss: 26379776.1079; val_kl_reg_loss: 14096.2144; val_edge_recon_loss: 25690364.6579; val_gene_expr_recon_loss: 730872.2426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26435333.0890; val_optim_loss: 26435333.0890
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9965; val_auprc_score: 0.9960; val_best_acc_score: 0.9745; val_best_f1_score: 0.9747; train_kl_reg_loss: 13994.7933; train_edge_recon_loss: 25572207.4892; train_gene_expr_recon_loss: 726567.4339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26312769.7135; train_optim_loss: 26312769.7135; val_kl_reg_loss: 14484.4909; val_edge_recon_loss: 25647406.6422; val_gene_expr_recon_loss: 720670.8317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26382561.9843; val_optim_loss: 26382561.9843
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9966; val_auprc_score: 0.9961; val_best_acc_score: 0.9752; val_best_f1_score: 0.9754; train_kl_reg_loss: 13711.6348; train_edge_recon_loss: 25545265.6564; train_gene_expr_recon_loss: 723188.0259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26282165.3212; train_optim_loss: 26282165.3212; val_kl_reg_loss: 13362.8768; val_edge_recon_loss: 25636888.7452; val_gene_expr_recon_loss: 719067.5435; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26369319.1309; val_optim_loss: 26369319.1309
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9971; val_auprc_score: 0.9967; val_best_acc_score: 0.9772; val_best_f1_score: 0.9774; train_kl_reg_loss: 13671.0381; train_edge_recon_loss: 25526519.5474; train_gene_expr_recon_loss: 718956.2690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26259146.8565; train_optim_loss: 26259146.8565; val_kl_reg_loss: 13387.5913; val_edge_recon_loss: 25607172.5497; val_gene_expr_recon_loss: 714342.3531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26334902.5183; val_optim_loss: 26334902.5183
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9970; val_auprc_score: 0.9967; val_best_acc_score: 0.9774; val_best_f1_score: 0.9776; train_kl_reg_loss: 13676.8677; train_edge_recon_loss: 25500568.7721; train_gene_expr_recon_loss: 715645.8535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26229891.5002; train_optim_loss: 26229891.5002; val_kl_reg_loss: 13640.0562; val_edge_recon_loss: 25595649.8517; val_gene_expr_recon_loss: 712752.6364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26322042.5567; val_optim_loss: 26322042.5567
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9972; val_auprc_score: 0.9969; val_best_acc_score: 0.9779; val_best_f1_score: 0.9781; train_kl_reg_loss: 13461.7475; train_edge_recon_loss: 25489780.1203; train_gene_expr_recon_loss: 714074.9307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26217316.7995; train_optim_loss: 26217316.7995; val_kl_reg_loss: 13679.1297; val_edge_recon_loss: 25574896.2880; val_gene_expr_recon_loss: 712069.7781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26300645.1815; val_optim_loss: 26300645.1815
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9976; val_auprc_score: 0.9973; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 13539.4245; train_edge_recon_loss: 25480796.9190; train_gene_expr_recon_loss: 711263.3222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26205599.6547; train_optim_loss: 26205599.6547; val_kl_reg_loss: 13883.2798; val_edge_recon_loss: 25558655.0244; val_gene_expr_recon_loss: 709422.4716; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26281960.7801; val_optim_loss: 26281960.7801
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9976; val_auprc_score: 0.9971; val_best_acc_score: 0.9807; val_best_f1_score: 0.9808; train_kl_reg_loss: 13473.8157; train_edge_recon_loss: 25465021.1794; train_gene_expr_recon_loss: 709209.5692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26187704.5671; train_optim_loss: 26187704.5671; val_kl_reg_loss: 13772.9487; val_edge_recon_loss: 25530617.2129; val_gene_expr_recon_loss: 704710.2003; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26249100.3682; val_optim_loss: 26249100.3682
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9975; val_auprc_score: 0.9969; val_best_acc_score: 0.9810; val_best_f1_score: 0.9811; train_kl_reg_loss: 13486.4024; train_edge_recon_loss: 25455492.6022; train_gene_expr_recon_loss: 708026.5485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26177005.5573; train_optim_loss: 26177005.5573; val_kl_reg_loss: 13360.1015; val_edge_recon_loss: 25535010.4677; val_gene_expr_recon_loss: 710685.1508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26259055.7103; val_optim_loss: 26259055.7103
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9977; val_auprc_score: 0.9973; val_best_acc_score: 0.9824; val_best_f1_score: 0.9826; train_kl_reg_loss: 13384.5773; train_edge_recon_loss: 25443910.6131; train_gene_expr_recon_loss: 706282.2107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26163577.4122; train_optim_loss: 26163577.4122; val_kl_reg_loss: 13600.8719; val_edge_recon_loss: 25519032.4433; val_gene_expr_recon_loss: 704197.1662; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26236830.4520; val_optim_loss: 26236830.4520
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9981; val_auprc_score: 0.9978; val_best_acc_score: 0.9834; val_best_f1_score: 0.9835; train_kl_reg_loss: 13494.4725; train_edge_recon_loss: 25438905.7581; train_gene_expr_recon_loss: 705024.5445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26157424.7541; train_optim_loss: 26157424.7541; val_kl_reg_loss: 13360.5064; val_edge_recon_loss: 25510998.2880; val_gene_expr_recon_loss: 702654.7645; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26227013.5358; val_optim_loss: 26227013.5358
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9829; val_best_f1_score: 0.9830; train_kl_reg_loss: 13412.3327; train_edge_recon_loss: 25432586.4039; train_gene_expr_recon_loss: 704821.9238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26150820.6552; train_optim_loss: 26150820.6552; val_kl_reg_loss: 13862.1221; val_edge_recon_loss: 25497457.8831; val_gene_expr_recon_loss: 702091.5946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26213411.5969; val_optim_loss: 26213411.5969
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9833; val_best_f1_score: 0.9834; train_kl_reg_loss: 13550.8697; train_edge_recon_loss: 25429367.8062; train_gene_expr_recon_loss: 703140.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26146059.2698; train_optim_loss: 26146059.2698; val_kl_reg_loss: 13488.4990; val_edge_recon_loss: 25505074.5742; val_gene_expr_recon_loss: 702843.3132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26221406.4241; val_optim_loss: 26221406.4241
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9980; val_auprc_score: 0.9977; val_best_acc_score: 0.9838; val_best_f1_score: 0.9839; train_kl_reg_loss: 13474.4720; train_edge_recon_loss: 25424366.6746; train_gene_expr_recon_loss: 702832.9980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26140674.1393; train_optim_loss: 26140674.1393; val_kl_reg_loss: 13586.9772; val_edge_recon_loss: 25500906.8639; val_gene_expr_recon_loss: 701276.0901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26215769.9354; val_optim_loss: 26215769.9354
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9838; val_best_f1_score: 0.9838; train_kl_reg_loss: 13507.8940; train_edge_recon_loss: 25416164.1003; train_gene_expr_recon_loss: 702464.2987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26132136.3021; train_optim_loss: 26132136.3021; val_kl_reg_loss: 13287.0570; val_edge_recon_loss: 25495157.3944; val_gene_expr_recon_loss: 698638.6424; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26207083.0419; val_optim_loss: 26207083.0419
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9982; val_auprc_score: 0.9979; val_best_acc_score: 0.9844; val_best_f1_score: 0.9845; train_kl_reg_loss: 13437.2649; train_edge_recon_loss: 25416298.6167; train_gene_expr_recon_loss: 700462.7682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26130198.6437; train_optim_loss: 26130198.6437; val_kl_reg_loss: 13394.5877; val_edge_recon_loss: 25477686.4956; val_gene_expr_recon_loss: 696877.9095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26187958.9529; val_optim_loss: 26187958.9529
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9981; val_auprc_score: 0.9978; val_best_acc_score: 0.9836; val_best_f1_score: 0.9837; train_kl_reg_loss: 13563.0544; train_edge_recon_loss: 25408449.5590; train_gene_expr_recon_loss: 701403.8967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26123416.5155; train_optim_loss: 26123416.5155; val_kl_reg_loss: 13322.2207; val_edge_recon_loss: 25467060.1518; val_gene_expr_recon_loss: 698585.6375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26178967.9983; val_optim_loss: 26178967.9983
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9980; val_auprc_score: 0.9975; val_best_acc_score: 0.9840; val_best_f1_score: 0.9841; train_kl_reg_loss: 13540.7608; train_edge_recon_loss: 25406541.2960; train_gene_expr_recon_loss: 700487.2431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26120569.2946; train_optim_loss: 26120569.2946; val_kl_reg_loss: 13160.2797; val_edge_recon_loss: 25497247.4712; val_gene_expr_recon_loss: 698596.2687; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26209004.0297; val_optim_loss: 26209004.0297
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9980; val_auprc_score: 0.9975; val_best_acc_score: 0.9840; val_best_f1_score: 0.9841; train_kl_reg_loss: 13558.2655; train_edge_recon_loss: 25403161.3220; train_gene_expr_recon_loss: 699453.3514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26116172.9479; train_optim_loss: 26116172.9479; val_kl_reg_loss: 13283.2221; val_edge_recon_loss: 25469623.6422; val_gene_expr_recon_loss: 696824.5249; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26179731.3735; val_optim_loss: 26179731.3735
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9842; val_best_f1_score: 0.9843; train_kl_reg_loss: 13604.8820; train_edge_recon_loss: 25399080.7116; train_gene_expr_recon_loss: 699038.2127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26111723.7955; train_optim_loss: 26111723.7955; val_kl_reg_loss: 13651.2500; val_edge_recon_loss: 25461025.3892; val_gene_expr_recon_loss: 699946.8587; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26174623.5026; val_optim_loss: 26174623.5026
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 13663.2378; train_edge_recon_loss: 25400691.6504; train_gene_expr_recon_loss: 698531.2702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26112886.1626; train_optim_loss: 26112886.1626; val_kl_reg_loss: 13518.1249; val_edge_recon_loss: 25440901.1379; val_gene_expr_recon_loss: 695111.4467; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26149530.6998; val_optim_loss: 26149530.6998
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9980; val_auprc_score: 0.9977; val_best_acc_score: 0.9842; val_best_f1_score: 0.9843; train_kl_reg_loss: 13517.0262; train_edge_recon_loss: 25397111.8999; train_gene_expr_recon_loss: 698840.3280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26109469.2449; train_optim_loss: 26109469.2449; val_kl_reg_loss: 13456.7494; val_edge_recon_loss: 25458629.0471; val_gene_expr_recon_loss: 696353.8864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26168439.7033; val_optim_loss: 26168439.7033
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9982; val_auprc_score: 0.9979; val_best_acc_score: 0.9843; val_best_f1_score: 0.9844; train_kl_reg_loss: 13563.6709; train_edge_recon_loss: 25394887.8877; train_gene_expr_recon_loss: 697705.5876; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26106157.1454; train_optim_loss: 26106157.1454; val_kl_reg_loss: 13546.0642; val_edge_recon_loss: 25465783.1640; val_gene_expr_recon_loss: 697312.9581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26176642.1553; val_optim_loss: 26176642.1553
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9839; val_best_f1_score: 0.9840; train_kl_reg_loss: 177067.2415; train_edge_recon_loss: 25395351.0773; train_gene_expr_recon_loss: 699402.6334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26271820.9448; train_optim_loss: 26271820.9448; val_kl_reg_loss: 14081.3208; val_edge_recon_loss: 25468864.3752; val_gene_expr_recon_loss: 698843.9555; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26181789.6230; val_optim_loss: 26181789.6230
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9836; val_best_f1_score: 0.9837; train_kl_reg_loss: 4055988.2145; train_edge_recon_loss: 25417198.1360; train_gene_expr_recon_loss: 704634.4502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30177820.9716; train_optim_loss: 30177820.9716; val_kl_reg_loss: 14067.6022; val_edge_recon_loss: 25469985.4555; val_gene_expr_recon_loss: 699911.3856; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26183964.4031; val_optim_loss: 26183964.4031

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9852; val_best_f1_score: 0.9852; train_kl_reg_loss: 14284.0091; train_edge_recon_loss: 25379959.5951; train_gene_expr_recon_loss: 688869.1848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26083112.7976; train_optim_loss: 26083112.7976; val_kl_reg_loss: 14420.4835; val_edge_recon_loss: 25439687.5201; val_gene_expr_recon_loss: 686072.1688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26140180.1815; val_optim_loss: 26140180.1815
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 14517.6543; train_edge_recon_loss: 25368060.8889; train_gene_expr_recon_loss: 684983.3833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26067561.9224; train_optim_loss: 26067561.9224; val_kl_reg_loss: 14694.4877; val_edge_recon_loss: 25423883.1117; val_gene_expr_recon_loss: 683907.9800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26122485.5620; val_optim_loss: 26122485.5620
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 14704.5837; train_edge_recon_loss: 25365763.8871; train_gene_expr_recon_loss: 683141.7450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26063610.2117; train_optim_loss: 26063610.2117; val_kl_reg_loss: 14734.2308; val_edge_recon_loss: 25407558.4904; val_gene_expr_recon_loss: 680970.3449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26103263.0873; val_optim_loss: 26103263.0873
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 14703.2859; train_edge_recon_loss: 25360559.9554; train_gene_expr_recon_loss: 682322.4763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26057585.7121; train_optim_loss: 26057585.7121; val_kl_reg_loss: 14722.6514; val_edge_recon_loss: 25414265.3997; val_gene_expr_recon_loss: 680417.9613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26109406.0122; val_optim_loss: 26109406.0122
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9862; val_best_f1_score: 0.9863; train_kl_reg_loss: 14771.3473; train_edge_recon_loss: 25357957.6118; train_gene_expr_recon_loss: 681907.1470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26054636.1154; train_optim_loss: 26054636.1154; val_kl_reg_loss: 14893.8166; val_edge_recon_loss: 25410307.7452; val_gene_expr_recon_loss: 680902.7158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26106104.2862; val_optim_loss: 26106104.2862
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9861; val_best_f1_score: 0.9861; train_kl_reg_loss: 14826.4236; train_edge_recon_loss: 25353572.6829; train_gene_expr_recon_loss: 681523.0474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26049922.1674; train_optim_loss: 26049922.1674; val_kl_reg_loss: 14829.7141; val_edge_recon_loss: 25412265.5567; val_gene_expr_recon_loss: 680571.2269; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26107666.5236; val_optim_loss: 26107666.5236
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 14796.1228; train_edge_recon_loss: 25357442.5712; train_gene_expr_recon_loss: 681109.9287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26053348.6117; train_optim_loss: 26053348.6117; val_kl_reg_loss: 14784.7859; val_edge_recon_loss: 25410999.0017; val_gene_expr_recon_loss: 680422.3537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26106206.1728; val_optim_loss: 26106206.1728

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9862; val_best_f1_score: 0.9863; train_kl_reg_loss: 14786.9734; train_edge_recon_loss: 25351325.1084; train_gene_expr_recon_loss: 679638.3686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26045750.4516; train_optim_loss: 26045750.4516; val_kl_reg_loss: 14815.5774; val_edge_recon_loss: 25408330.5428; val_gene_expr_recon_loss: 677958.4384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26101104.5550; val_optim_loss: 26101104.5550
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9984; val_auprc_score: 0.9981; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 14835.9010; train_edge_recon_loss: 25351915.0637; train_gene_expr_recon_loss: 679509.3382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26046260.3011; train_optim_loss: 26046260.3011; val_kl_reg_loss: 14868.3220; val_edge_recon_loss: 25398675.7068; val_gene_expr_recon_loss: 680301.3127; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26093845.3525; val_optim_loss: 26093845.3525
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 14862.4372; train_edge_recon_loss: 25351682.6976; train_gene_expr_recon_loss: 679288.4225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26045833.5437; train_optim_loss: 26045833.5437; val_kl_reg_loss: 14889.1700; val_edge_recon_loss: 25396015.4939; val_gene_expr_recon_loss: 679090.7294; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26089995.3787; val_optim_loss: 26089995.3787
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9984; val_auprc_score: 0.9981; val_best_acc_score: 0.9865; val_best_f1_score: 0.9866; train_kl_reg_loss: 14865.5066; train_edge_recon_loss: 25350740.4385; train_gene_expr_recon_loss: 679855.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26045461.9011; train_optim_loss: 26045461.9011; val_kl_reg_loss: 14914.2995; val_edge_recon_loss: 25411364.1431; val_gene_expr_recon_loss: 679326.6062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26105605.0227; val_optim_loss: 26105605.0227
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9868; val_best_f1_score: 0.9869; train_kl_reg_loss: 14873.7947; train_edge_recon_loss: 25351053.8147; train_gene_expr_recon_loss: 679359.1917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26045286.7954; train_optim_loss: 26045286.7954; val_kl_reg_loss: 14903.4037; val_edge_recon_loss: 25398487.9372; val_gene_expr_recon_loss: 679781.8637; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26093173.2042; val_optim_loss: 26093173.2042
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9984; val_auprc_score: 0.9979; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 14904.2624; train_edge_recon_loss: 25355237.4845; train_gene_expr_recon_loss: 679201.7815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26049343.5367; train_optim_loss: 26049343.5367; val_kl_reg_loss: 14940.6568; val_edge_recon_loss: 25408395.0942; val_gene_expr_recon_loss: 678527.4185; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26101863.1710; val_optim_loss: 26101863.1710
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9984; val_auprc_score: 0.9979; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 14915.8372; train_edge_recon_loss: 25349296.9299; train_gene_expr_recon_loss: 678926.0128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26043138.7731; train_optim_loss: 26043138.7731; val_kl_reg_loss: 14947.5527; val_edge_recon_loss: 25410372.0087; val_gene_expr_recon_loss: 679101.9978; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26104421.5881; val_optim_loss: 26104421.5881

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9985; val_auprc_score: 0.9980; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 14921.7706; train_edge_recon_loss: 25350317.6704; train_gene_expr_recon_loss: 679117.4450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26044356.9025; train_optim_loss: 26044356.9025; val_kl_reg_loss: 14945.9609; val_edge_recon_loss: 25389639.9634; val_gene_expr_recon_loss: 678040.2792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26082626.2234; val_optim_loss: 26082626.2234
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9868; val_best_f1_score: 0.9869; train_kl_reg_loss: 19824.9480; train_edge_recon_loss: 25345760.7586; train_gene_expr_recon_loss: 678864.7392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26044450.4580; train_optim_loss: 26044450.4580; val_kl_reg_loss: 14929.4094; val_edge_recon_loss: 25399421.7888; val_gene_expr_recon_loss: 678699.9650; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26093051.1396; val_optim_loss: 26093051.1396
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9985; val_auprc_score: 0.9980; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 14911.4744; train_edge_recon_loss: 25347851.7076; train_gene_expr_recon_loss: 678921.5986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26041684.7863; train_optim_loss: 26041684.7863; val_kl_reg_loss: 14921.3085; val_edge_recon_loss: 25391486.3508; val_gene_expr_recon_loss: 678827.8371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26085235.5096; val_optim_loss: 26085235.5096
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 14913.4101; train_edge_recon_loss: 25349903.7290; train_gene_expr_recon_loss: 678864.0866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26043681.2182; train_optim_loss: 26043681.2182; val_kl_reg_loss: 14937.4316; val_edge_recon_loss: 25410880.1850; val_gene_expr_recon_loss: 677648.4319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26103466.0070; val_optim_loss: 26103466.0070
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9984; val_auprc_score: 0.9981; val_best_acc_score: 0.9866; val_best_f1_score: 0.9867; train_kl_reg_loss: 14904.1825; train_edge_recon_loss: 25351409.4254; train_gene_expr_recon_loss: 679216.7547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26045530.3674; train_optim_loss: 26045530.3674; val_kl_reg_loss: 14930.7566; val_edge_recon_loss: 25404339.4520; val_gene_expr_recon_loss: 677438.4720; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26096708.6824; val_optim_loss: 26096708.6824

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 14907.9472; train_edge_recon_loss: 25351287.8260; train_gene_expr_recon_loss: 679065.3369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26045261.1029; train_optim_loss: 26045261.1029; val_kl_reg_loss: 14918.2805; val_edge_recon_loss: 25410331.6928; val_gene_expr_recon_loss: 677767.9045; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26103017.9319; val_optim_loss: 26103017.9319
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9985; val_auprc_score: 0.9982; val_best_acc_score: 0.9868; val_best_f1_score: 0.9869; train_kl_reg_loss: 14908.6825; train_edge_recon_loss: 25348124.6288; train_gene_expr_recon_loss: 679038.4041; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26042071.7140; train_optim_loss: 26042071.7140; val_kl_reg_loss: 14937.2499; val_edge_recon_loss: 25396822.7696; val_gene_expr_recon_loss: 678696.5277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26090456.5724; val_optim_loss: 26090456.5724
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9868; val_best_f1_score: 0.9868; train_kl_reg_loss: 14907.2651; train_edge_recon_loss: 25346995.3586; train_gene_expr_recon_loss: 678838.1536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26040740.7751; train_optim_loss: 26040740.7751; val_kl_reg_loss: 14928.6517; val_edge_recon_loss: 25394498.7836; val_gene_expr_recon_loss: 678386.2661; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26087813.6911; val_optim_loss: 26087813.6911
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9984; val_auprc_score: 0.9979; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 14898.0125; train_edge_recon_loss: 25350262.4815; train_gene_expr_recon_loss: 678750.0813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26043910.5791; train_optim_loss: 26043910.5791; val_kl_reg_loss: 14926.6951; val_edge_recon_loss: 25410293.2129; val_gene_expr_recon_loss: 678294.1006; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26103514.0297; val_optim_loss: 26103514.0297

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2333 min 43 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
Val AUROC score: 0.9984
Val AUPRC score: 0.9980
Val best accuracy score: 0.9866
Val best F1 score: 0.9866
Val gene expr MSE score: 1.7877

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
