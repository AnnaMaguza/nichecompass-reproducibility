None
Run timestamp: 15072023_083145_151.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_151']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9736; val_auprc_score: 0.9681; val_best_acc_score: 0.9223; val_best_f1_score: 0.9239; train_kl_reg_loss: 105270.2521; train_edge_recon_loss: 3040662.7684; train_gene_expr_recon_loss: 11145541.6553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14291474.6673; train_optim_loss: 14291474.6673; val_kl_reg_loss: 96306.6341; val_edge_recon_loss: 2770851.0369; val_gene_expr_recon_loss: 10388526.8525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13255684.5246; val_optim_loss: 13255684.5246
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9853; val_auprc_score: 0.9810; val_best_acc_score: 0.9507; val_best_f1_score: 0.9518; train_kl_reg_loss: 90320.5043; train_edge_recon_loss: 2715034.0000; train_gene_expr_recon_loss: 10225629.2408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13030983.7463; train_optim_loss: 13030983.7463; val_kl_reg_loss: 82484.5275; val_edge_recon_loss: 2697143.3770; val_gene_expr_recon_loss: 10081004.5410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12860632.4918; val_optim_loss: 12860632.4918
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9873; val_auprc_score: 0.9835; val_best_acc_score: 0.9548; val_best_f1_score: 0.9557; train_kl_reg_loss: 77219.8782; train_edge_recon_loss: 2676453.1756; train_gene_expr_recon_loss: 9984121.5331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12737794.6158; train_optim_loss: 12737794.6158; val_kl_reg_loss: 71555.2038; val_edge_recon_loss: 2671597.0943; val_gene_expr_recon_loss: 9915788.4918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12658940.8525; val_optim_loss: 12658940.8525
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9893; val_auprc_score: 0.9864; val_best_acc_score: 0.9581; val_best_f1_score: 0.9589; train_kl_reg_loss: 68442.2940; train_edge_recon_loss: 2659121.3580; train_gene_expr_recon_loss: 9822286.8805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12549850.5331; train_optim_loss: 12549850.5331; val_kl_reg_loss: 63660.6552; val_edge_recon_loss: 2656632.4426; val_gene_expr_recon_loss: 9806652.3115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12526945.3934; val_optim_loss: 12526945.3934
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9896; val_auprc_score: 0.9870; val_best_acc_score: 0.9590; val_best_f1_score: 0.9598; train_kl_reg_loss: 61951.8076; train_edge_recon_loss: 2649183.5933; train_gene_expr_recon_loss: 9703762.1893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12414897.5680; train_optim_loss: 12414897.5680; val_kl_reg_loss: 58768.0430; val_edge_recon_loss: 2650057.0123; val_gene_expr_recon_loss: 9677059.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12385883.9836; val_optim_loss: 12385883.9836
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9903; val_auprc_score: 0.9882; val_best_acc_score: 0.9595; val_best_f1_score: 0.9602; train_kl_reg_loss: 57477.5905; train_edge_recon_loss: 2641833.3824; train_gene_expr_recon_loss: 9615122.8805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12314433.8732; train_optim_loss: 12314433.8732; val_kl_reg_loss: 55007.3436; val_edge_recon_loss: 2647266.5984; val_gene_expr_recon_loss: 9634472.7049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12336746.6230; val_optim_loss: 12336746.6230
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9906; val_auprc_score: 0.9886; val_best_acc_score: 0.9603; val_best_f1_score: 0.9610; train_kl_reg_loss: 54289.7561; train_edge_recon_loss: 2634670.2344; train_gene_expr_recon_loss: 9544232.1893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12233192.1875; train_optim_loss: 12233192.1875; val_kl_reg_loss: 52224.1233; val_edge_recon_loss: 2640840.4713; val_gene_expr_recon_loss: 9606112.3443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12299176.9672; val_optim_loss: 12299176.9672
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9911; val_auprc_score: 0.9889; val_best_acc_score: 0.9613; val_best_f1_score: 0.9621; train_kl_reg_loss: 51911.2757; train_edge_recon_loss: 2630275.0896; train_gene_expr_recon_loss: 9479771.2362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12161957.5809; train_optim_loss: 12161957.5809; val_kl_reg_loss: 50314.3952; val_edge_recon_loss: 2632311.0410; val_gene_expr_recon_loss: 9560350.5902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12242976.0328; val_optim_loss: 12242976.0328
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9913; val_auprc_score: 0.9896; val_best_acc_score: 0.9615; val_best_f1_score: 0.9624; train_kl_reg_loss: 49948.4294; train_edge_recon_loss: 2627311.5556; train_gene_expr_recon_loss: 9436487.6517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12113747.6618; train_optim_loss: 12113747.6618; val_kl_reg_loss: 49364.9800; val_edge_recon_loss: 2630948.9631; val_gene_expr_recon_loss: 9584058.6066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12264372.5246; val_optim_loss: 12264372.5246
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9914; val_auprc_score: 0.9897; val_best_acc_score: 0.9622; val_best_f1_score: 0.9630; train_kl_reg_loss: 48471.8647; train_edge_recon_loss: 2624011.5000; train_gene_expr_recon_loss: 9382252.9825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12054736.3254; train_optim_loss: 12054736.3254; val_kl_reg_loss: 47414.1263; val_edge_recon_loss: 2630120.7131; val_gene_expr_recon_loss: 9535841.6066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12213376.5082; val_optim_loss: 12213376.5082
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9915; val_auprc_score: 0.9897; val_best_acc_score: 0.9621; val_best_f1_score: 0.9629; train_kl_reg_loss: 47148.0793; train_edge_recon_loss: 2620924.6742; train_gene_expr_recon_loss: 9355995.4246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12024068.1783; train_optim_loss: 12024068.1783; val_kl_reg_loss: 46063.5813; val_edge_recon_loss: 2628217.2254; val_gene_expr_recon_loss: 9513376.5902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12187657.4918; val_optim_loss: 12187657.4918
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9916; val_auprc_score: 0.9899; val_best_acc_score: 0.9620; val_best_f1_score: 0.9627; train_kl_reg_loss: 46022.9737; train_edge_recon_loss: 2619573.4439; train_gene_expr_recon_loss: 9320267.7629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11985864.1765; train_optim_loss: 11985864.1765; val_kl_reg_loss: 45730.4832; val_edge_recon_loss: 2625109.7459; val_gene_expr_recon_loss: 9509342.5574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12180182.7705; val_optim_loss: 12180182.7705
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9920; val_auprc_score: 0.9904; val_best_acc_score: 0.9626; val_best_f1_score: 0.9634; train_kl_reg_loss: 45101.8091; train_edge_recon_loss: 2617546.6245; train_gene_expr_recon_loss: 9290264.2445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11952912.6746; train_optim_loss: 11952912.6746; val_kl_reg_loss: 44395.1882; val_edge_recon_loss: 2626367.9631; val_gene_expr_recon_loss: 9506343.4918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12177106.6557; val_optim_loss: 12177106.6557
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9918; val_auprc_score: 0.9902; val_best_acc_score: 0.9626; val_best_f1_score: 0.9634; train_kl_reg_loss: 44291.2504; train_edge_recon_loss: 2615558.8672; train_gene_expr_recon_loss: 9260336.2371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11920186.3621; train_optim_loss: 11920186.3621; val_kl_reg_loss: 43408.5800; val_edge_recon_loss: 2620450.9918; val_gene_expr_recon_loss: 9504843.8525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12168703.4426; val_optim_loss: 12168703.4426
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9923; val_auprc_score: 0.9908; val_best_acc_score: 0.9637; val_best_f1_score: 0.9644; train_kl_reg_loss: 43598.5844; train_edge_recon_loss: 2614852.1291; train_gene_expr_recon_loss: 9241227.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11899678.3585; train_optim_loss: 11899678.3585; val_kl_reg_loss: 43069.9855; val_edge_recon_loss: 2620926.9139; val_gene_expr_recon_loss: 9508035.2131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12172032.0656; val_optim_loss: 12172032.0656
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9922; val_auprc_score: 0.9906; val_best_acc_score: 0.9647; val_best_f1_score: 0.9654; train_kl_reg_loss: 42901.8998; train_edge_recon_loss: 2612822.6337; train_gene_expr_recon_loss: 9223957.4173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11879681.9246; train_optim_loss: 11879681.9246; val_kl_reg_loss: 42046.4150; val_edge_recon_loss: 2619369.4467; val_gene_expr_recon_loss: 9511485.3115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12172901.1803; val_optim_loss: 12172901.1803
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9920; val_auprc_score: 0.9904; val_best_acc_score: 0.9634; val_best_f1_score: 0.9642; train_kl_reg_loss: 42396.6151; train_edge_recon_loss: 2611070.0501; train_gene_expr_recon_loss: 9199853.8474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11853320.5441; train_optim_loss: 11853320.5441; val_kl_reg_loss: 41768.6926; val_edge_recon_loss: 2620769.7951; val_gene_expr_recon_loss: 9522437.3279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12184975.8033; val_optim_loss: 12184975.8033
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9923; val_auprc_score: 0.9907; val_best_acc_score: 0.9640; val_best_f1_score: 0.9647; train_kl_reg_loss: 41893.9724; train_edge_recon_loss: 2611325.8828; train_gene_expr_recon_loss: 9178293.3860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11831513.2298; train_optim_loss: 11831513.2298; val_kl_reg_loss: 41366.9990; val_edge_recon_loss: 2617038.8525; val_gene_expr_recon_loss: 9539176.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12197581.8689; val_optim_loss: 12197581.8689

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9927; val_auprc_score: 0.9909; val_best_acc_score: 0.9659; val_best_f1_score: 0.9665; train_kl_reg_loss: 42888.4007; train_edge_recon_loss: 2608638.2904; train_gene_expr_recon_loss: 9108404.6783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11759931.3915; train_optim_loss: 11759931.3915; val_kl_reg_loss: 42473.9568; val_edge_recon_loss: 2607543.4795; val_gene_expr_recon_loss: 9473575.4426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12123592.9344; val_optim_loss: 12123592.9344
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9922; val_auprc_score: 0.9905; val_best_acc_score: 0.9640; val_best_f1_score: 0.9647; train_kl_reg_loss: 43054.3693; train_edge_recon_loss: 2606842.6498; train_gene_expr_recon_loss: 9096629.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11746526.3346; train_optim_loss: 11746526.3346; val_kl_reg_loss: 42414.5724; val_edge_recon_loss: 2613037.9631; val_gene_expr_recon_loss: 9504174.1148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12159626.6557; val_optim_loss: 12159626.6557
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9923; val_auprc_score: 0.9906; val_best_acc_score: 0.9646; val_best_f1_score: 0.9652; train_kl_reg_loss: 43133.8305; train_edge_recon_loss: 2606468.5106; train_gene_expr_recon_loss: 9083818.5744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11733420.9210; train_optim_loss: 11733420.9210; val_kl_reg_loss: 42548.6691; val_edge_recon_loss: 2612342.6475; val_gene_expr_recon_loss: 9480300.4098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12135191.7049; val_optim_loss: 12135191.7049
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9927; val_auprc_score: 0.9914; val_best_acc_score: 0.9653; val_best_f1_score: 0.9659; train_kl_reg_loss: 43108.0672; train_edge_recon_loss: 2606256.3079; train_gene_expr_recon_loss: 9080968.3585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11730332.7243; train_optim_loss: 11730332.7243; val_kl_reg_loss: 42554.8528; val_edge_recon_loss: 2609341.9877; val_gene_expr_recon_loss: 9482105.3770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12134002.1967; val_optim_loss: 12134002.1967
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9921; val_auprc_score: 0.9904; val_best_acc_score: 0.9648; val_best_f1_score: 0.9655; train_kl_reg_loss: 43011.8804; train_edge_recon_loss: 2606033.7220; train_gene_expr_recon_loss: 9081126.6204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11730172.2335; train_optim_loss: 11730172.2335; val_kl_reg_loss: 42510.0357; val_edge_recon_loss: 2615327.4959; val_gene_expr_recon_loss: 9481762.2623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12139599.7705; val_optim_loss: 12139599.7705

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9928; val_auprc_score: 0.9915; val_best_acc_score: 0.9658; val_best_f1_score: 0.9664; train_kl_reg_loss: 43035.2916; train_edge_recon_loss: 2605471.3497; train_gene_expr_recon_loss: 9068379.9697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11716886.6085; train_optim_loss: 11716886.6085; val_kl_reg_loss: 42500.8145; val_edge_recon_loss: 2608467.9631; val_gene_expr_recon_loss: 9486374.2951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12137343.0984; val_optim_loss: 12137343.0984
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9923; val_auprc_score: 0.9909; val_best_acc_score: 0.9646; val_best_f1_score: 0.9653; train_kl_reg_loss: 43072.1620; train_edge_recon_loss: 2605260.1958; train_gene_expr_recon_loss: 9077538.2335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11725870.6011; train_optim_loss: 11725870.6011; val_kl_reg_loss: 42583.6899; val_edge_recon_loss: 2613677.4713; val_gene_expr_recon_loss: 9474013.4590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12130274.6230; val_optim_loss: 12130274.6230
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9925; val_auprc_score: 0.9910; val_best_acc_score: 0.9646; val_best_f1_score: 0.9652; train_kl_reg_loss: 43096.6997; train_edge_recon_loss: 2605964.0846; train_gene_expr_recon_loss: 9069462.2785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11718523.0717; train_optim_loss: 11718523.0717; val_kl_reg_loss: 42562.0590; val_edge_recon_loss: 2615545.8607; val_gene_expr_recon_loss: 9505725.2295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12163833.2295; val_optim_loss: 12163833.2295
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9925; val_auprc_score: 0.9910; val_best_acc_score: 0.9650; val_best_f1_score: 0.9656; train_kl_reg_loss: 43089.0678; train_edge_recon_loss: 2605796.0193; train_gene_expr_recon_loss: 9077010.7537; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11725895.8603; train_optim_loss: 11725895.8603; val_kl_reg_loss: 42542.8286; val_edge_recon_loss: 2611827.0246; val_gene_expr_recon_loss: 9487550.1803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12141920.0656; val_optim_loss: 12141920.0656

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 141 min 36 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9926
Val AUPRC score: 0.9911
Val best accuracy score: 0.9652
Val best F1 score: 0.9658
Val gene expr MSE score: 0.6259

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
