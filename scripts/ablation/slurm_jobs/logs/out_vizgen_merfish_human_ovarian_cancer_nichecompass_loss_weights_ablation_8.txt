Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9952; val_auprc_score: 0.9954; val_best_acc_score: 0.9689; val_best_f1_score: 0.9688; train_kl_reg_loss: 135.5627; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13796.3014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13931.8641; train_optim_loss: 13931.8641; val_kl_reg_loss: 134.7618; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13733.9055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13868.6673; val_optim_loss: 13868.6673
None
Run timestamp: 04072023_220514_8.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_8']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1931624
Number of validation edges: 214624
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9640; val_auprc_score: 0.9690; val_best_acc_score: 0.8953; val_best_f1_score: 0.8959; train_kl_reg_loss: 827.5149; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 14352.0984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15179.6133; train_optim_loss: 15179.6133; val_kl_reg_loss: 670.7798; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13283.6219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13954.4017; val_optim_loss: 13954.4017
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9952; val_auprc_score: 0.9955; val_best_acc_score: 0.9688; val_best_f1_score: 0.9688; train_kl_reg_loss: 135.9609; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13792.5630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13928.5239; train_optim_loss: 13928.5239; val_kl_reg_loss: 135.6180; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13743.9840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13879.6021; val_optim_loss: 13879.6021
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9627; val_auprc_score: 0.9681; val_best_acc_score: 0.8949; val_best_f1_score: 0.8940; train_kl_reg_loss: 619.0735; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13380.1918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13999.2653; train_optim_loss: 13999.2653; val_kl_reg_loss: 586.8710; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13092.9199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13679.7909; val_optim_loss: 13679.7909
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9953; val_auprc_score: 0.9956; val_best_acc_score: 0.9694; val_best_f1_score: 0.9694; train_kl_reg_loss: 136.0245; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13789.3964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13925.4208; train_optim_loss: 13925.4208; val_kl_reg_loss: 136.5304; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13761.7429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13898.2733; val_optim_loss: 13898.2733
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9657; val_auprc_score: 0.9706; val_best_acc_score: 0.9020; val_best_f1_score: 0.8990; train_kl_reg_loss: 585.9939; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13260.4630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13846.4569; train_optim_loss: 13846.4569; val_kl_reg_loss: 549.2667; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13052.9485; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13602.2153; val_optim_loss: 13602.2153
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9657; val_auprc_score: 0.9705; val_best_acc_score: 0.8996; val_best_f1_score: 0.8985; train_kl_reg_loss: 578.3341; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13150.8654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13729.1995; train_optim_loss: 13729.1995; val_kl_reg_loss: 560.6532; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12945.1476; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13505.8008; val_optim_loss: 13505.8008
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9955; val_auprc_score: 0.9957; val_best_acc_score: 0.9699; val_best_f1_score: 0.9699; train_kl_reg_loss: 136.2019; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13784.7077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13920.9095; train_optim_loss: 13920.9095; val_kl_reg_loss: 136.3943; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13743.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13880.0897; val_optim_loss: 13880.0897
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9668; val_auprc_score: 0.9715; val_best_acc_score: 0.9025; val_best_f1_score: 0.9007; train_kl_reg_loss: 576.6449; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12645.8704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13222.5153; train_optim_loss: 13222.5153; val_kl_reg_loss: 555.9885; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11878.8426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12434.8310; val_optim_loss: 12434.8310
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9955; val_auprc_score: 0.9957; val_best_acc_score: 0.9697; val_best_f1_score: 0.9697; train_kl_reg_loss: 136.4888; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13786.2113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13922.7001; train_optim_loss: 13922.7001; val_kl_reg_loss: 136.3175; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13722.8284; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13859.1458; val_optim_loss: 13859.1458
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9698; val_auprc_score: 0.9741; val_best_acc_score: 0.9084; val_best_f1_score: 0.9060; train_kl_reg_loss: 575.4495; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 11626.4953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12201.9449; train_optim_loss: 12201.9449; val_kl_reg_loss: 581.1813; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10959.6507; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11540.8320; val_optim_loss: 11540.8320
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9684; val_auprc_score: 0.9729; val_best_acc_score: 0.9060; val_best_f1_score: 0.9026; train_kl_reg_loss: 573.1045; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 11133.3836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11706.4882; train_optim_loss: 11706.4882; val_kl_reg_loss: 550.5510; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10994.9916; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11545.5426; val_optim_loss: 11545.5426
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9955; val_auprc_score: 0.9957; val_best_acc_score: 0.9701; val_best_f1_score: 0.9701; train_kl_reg_loss: 136.6678; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13786.9501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13923.6180; train_optim_loss: 13923.6180; val_kl_reg_loss: 136.8686; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13720.9871; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13857.8557; val_optim_loss: 13857.8557
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9702; val_auprc_score: 0.9745; val_best_acc_score: 0.9087; val_best_f1_score: 0.9077; train_kl_reg_loss: 570.9530; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 11074.9199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11645.8728; train_optim_loss: 11645.8728; val_kl_reg_loss: 589.6347; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10930.0110; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11519.6458; val_optim_loss: 11519.6458
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9955; val_auprc_score: 0.9958; val_best_acc_score: 0.9699; val_best_f1_score: 0.9699; train_kl_reg_loss: 136.7511; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13783.5858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13920.3369; train_optim_loss: 13920.3369; val_kl_reg_loss: 136.5074; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13762.9298; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13899.4373; val_optim_loss: 13899.4373
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9702; val_auprc_score: 0.9745; val_best_acc_score: 0.9085; val_best_f1_score: 0.9076; train_kl_reg_loss: 571.0166; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 11050.3534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11621.3699; train_optim_loss: 11621.3699; val_kl_reg_loss: 582.5259; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10919.3637; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11501.8896; val_optim_loss: 11501.8896
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9695; val_auprc_score: 0.9738; val_best_acc_score: 0.9080; val_best_f1_score: 0.9057; train_kl_reg_loss: 571.1858; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 11043.5333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11614.7191; train_optim_loss: 11614.7191; val_kl_reg_loss: 566.9692; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10913.2467; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11480.2159; val_optim_loss: 11480.2159
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9956; val_auprc_score: 0.9958; val_best_acc_score: 0.9704; val_best_f1_score: 0.9703; train_kl_reg_loss: 137.0573; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13784.5731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13921.6304; train_optim_loss: 13921.6304; val_kl_reg_loss: 135.9591; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13786.1586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13922.1178; val_optim_loss: 13922.1178
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9708; val_auprc_score: 0.9749; val_best_acc_score: 0.9100; val_best_f1_score: 0.9076; train_kl_reg_loss: 571.0828; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 11029.0389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11600.1217; train_optim_loss: 11600.1217; val_kl_reg_loss: 569.2664; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10917.7213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11486.9878; val_optim_loss: 11486.9878
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9956; val_auprc_score: 0.9960; val_best_acc_score: 0.9710; val_best_f1_score: 0.9709; train_kl_reg_loss: 137.1839; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13779.3598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13916.5437; train_optim_loss: 13916.5437; val_kl_reg_loss: 136.7318; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13780.9883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13917.7202; val_optim_loss: 13917.7202
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9702; val_auprc_score: 0.9744; val_best_acc_score: 0.9087; val_best_f1_score: 0.9057; train_kl_reg_loss: 571.0140; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 11024.2804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11595.2943; train_optim_loss: 11595.2943; val_kl_reg_loss: 545.2931; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10923.0432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11468.3362; val_optim_loss: 11468.3362
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9703; val_auprc_score: 0.9746; val_best_acc_score: 0.9098; val_best_f1_score: 0.9070; train_kl_reg_loss: 571.1424; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 11022.3650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11593.5074; train_optim_loss: 11593.5074; val_kl_reg_loss: 584.5488; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10911.2675; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11495.8162; val_optim_loss: 11495.8162
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9956; val_auprc_score: 0.9958; val_best_acc_score: 0.9704; val_best_f1_score: 0.9704; train_kl_reg_loss: 137.4778; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13779.4381; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13916.9159; train_optim_loss: 13916.9159; val_kl_reg_loss: 136.8921; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13789.6509; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13926.5430; val_optim_loss: 13926.5430
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9712; val_auprc_score: 0.9752; val_best_acc_score: 0.9099; val_best_f1_score: 0.9089; train_kl_reg_loss: 571.2512; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 11019.5601; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11590.8113; train_optim_loss: 11590.8113; val_kl_reg_loss: 559.5389; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10920.3584; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11479.8973; val_optim_loss: 11479.8973
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9696; val_auprc_score: 0.9741; val_best_acc_score: 0.9084; val_best_f1_score: 0.9056; train_kl_reg_loss: 571.2838; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 11015.6415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11586.9253; train_optim_loss: 11586.9253; val_kl_reg_loss: 574.4860; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10914.7631; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11489.2490; val_optim_loss: 11489.2490

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9956; val_auprc_score: 0.9957; val_best_acc_score: 0.9705; val_best_f1_score: 0.9704; train_kl_reg_loss: 137.1732; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13762.9994; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13900.1726; train_optim_loss: 13900.1726; val_kl_reg_loss: 136.1935; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13744.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13880.4513; val_optim_loss: 13880.4513
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9709; val_auprc_score: 0.9751; val_best_acc_score: 0.9105; val_best_f1_score: 0.9079; train_kl_reg_loss: 571.5606; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 11007.0618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11578.6223; train_optim_loss: 11578.6223; val_kl_reg_loss: 566.0066; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10907.2318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11473.2384; val_optim_loss: 11473.2384
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9956; val_auprc_score: 0.9960; val_best_acc_score: 0.9707; val_best_f1_score: 0.9707; train_kl_reg_loss: 136.7770; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13751.0380; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13887.8149; train_optim_loss: 13887.8149; val_kl_reg_loss: 135.8498; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13727.8554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13863.7052; val_optim_loss: 13863.7052

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9727; val_auprc_score: 0.9767; val_best_acc_score: 0.9144; val_best_f1_score: 0.9124; train_kl_reg_loss: 570.2001; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10933.0711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11503.2712; train_optim_loss: 11503.2712; val_kl_reg_loss: 562.4990; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10867.1258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11429.6248; val_optim_loss: 11429.6248
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9735; val_auprc_score: 0.9773; val_best_acc_score: 0.9163; val_best_f1_score: 0.9142; train_kl_reg_loss: 570.0740; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10915.7584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11485.8325; train_optim_loss: 11485.8325; val_kl_reg_loss: 563.2690; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10888.4157; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11451.6847; val_optim_loss: 11451.6847
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9956; val_auprc_score: 0.9958; val_best_acc_score: 0.9709; val_best_f1_score: 0.9708; train_kl_reg_loss: 136.4014; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13745.0146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13881.4160; train_optim_loss: 13881.4160; val_kl_reg_loss: 135.3675; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13743.5750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13878.9424; val_optim_loss: 13878.9424
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9730; val_auprc_score: 0.9771; val_best_acc_score: 0.9152; val_best_f1_score: 0.9131; train_kl_reg_loss: 570.5065; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10912.1853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11482.6917; train_optim_loss: 11482.6917; val_kl_reg_loss: 564.2011; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10905.1665; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11469.3676; val_optim_loss: 11469.3676
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9957; val_auprc_score: 0.9959; val_best_acc_score: 0.9708; val_best_f1_score: 0.9707; train_kl_reg_loss: 136.1259; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13742.4560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13878.5819; train_optim_loss: 13878.5819; val_kl_reg_loss: 135.8300; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13697.5863; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13833.4163; val_optim_loss: 13833.4163
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9738; val_auprc_score: 0.9776; val_best_acc_score: 0.9164; val_best_f1_score: 0.9142; train_kl_reg_loss: 570.6927; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10913.4953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11484.1881; train_optim_loss: 11484.1881; val_kl_reg_loss: 563.0910; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10875.0916; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11438.1826; val_optim_loss: 11438.1826
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9734; val_auprc_score: 0.9774; val_best_acc_score: 0.9161; val_best_f1_score: 0.9140; train_kl_reg_loss: 571.2009; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10906.7021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11477.9031; train_optim_loss: 11477.9031; val_kl_reg_loss: 568.9828; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10870.5065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11439.4893; val_optim_loss: 11439.4893
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9956; val_auprc_score: 0.9958; val_best_acc_score: 0.9708; val_best_f1_score: 0.9707; train_kl_reg_loss: 136.1477; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13739.2787; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13875.4264; train_optim_loss: 13875.4264; val_kl_reg_loss: 135.2886; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13741.5746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13876.8632; val_optim_loss: 13876.8632

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9739; val_auprc_score: 0.9778; val_best_acc_score: 0.9171; val_best_f1_score: 0.9148; train_kl_reg_loss: 571.5149; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10899.8762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11471.3910; train_optim_loss: 11471.3910; val_kl_reg_loss: 566.9290; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10887.9423; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11454.8712; val_optim_loss: 11454.8712
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9738; val_auprc_score: 0.9776; val_best_acc_score: 0.9167; val_best_f1_score: 0.9144; train_kl_reg_loss: 571.2992; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10897.5611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11468.8603; train_optim_loss: 11468.8603; val_kl_reg_loss: 568.7099; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10885.3748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11454.0847; val_optim_loss: 11454.0847
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9956; val_auprc_score: 0.9959; val_best_acc_score: 0.9707; val_best_f1_score: 0.9707; train_kl_reg_loss: 136.0655; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13728.6745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13864.7400; train_optim_loss: 13864.7400; val_kl_reg_loss: 135.1142; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13764.2104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13899.3246; val_optim_loss: 13899.3246
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9739; val_auprc_score: 0.9778; val_best_acc_score: 0.9173; val_best_f1_score: 0.9149; train_kl_reg_loss: 571.2870; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10898.0807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11469.3678; train_optim_loss: 11469.3678; val_kl_reg_loss: 567.4609; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10879.7515; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11447.2125; val_optim_loss: 11447.2125
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9957; val_auprc_score: 0.9959; val_best_acc_score: 0.9713; val_best_f1_score: 0.9712; train_kl_reg_loss: 136.0792; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13709.4753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13845.5545; train_optim_loss: 13845.5545; val_kl_reg_loss: 135.3396; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13747.1810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13882.5206; val_optim_loss: 13882.5206
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9735; val_auprc_score: 0.9776; val_best_acc_score: 0.9162; val_best_f1_score: 0.9139; train_kl_reg_loss: 571.5810; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10897.6736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11469.2546; train_optim_loss: 11469.2546; val_kl_reg_loss: 567.9878; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10859.3941; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11427.3819; val_optim_loss: 11427.3819
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9956; val_auprc_score: 0.9958; val_best_acc_score: 0.9709; val_best_f1_score: 0.9708; train_kl_reg_loss: 136.1250; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13721.4063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13857.5313; train_optim_loss: 13857.5313; val_kl_reg_loss: 135.9051; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13710.3738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13846.2789; val_optim_loss: 13846.2789
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9739; val_auprc_score: 0.9778; val_best_acc_score: 0.9171; val_best_f1_score: 0.9147; train_kl_reg_loss: 571.4492; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10899.9447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11471.3939; train_optim_loss: 11471.3939; val_kl_reg_loss: 568.6434; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10905.0516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11473.6950; val_optim_loss: 11473.6950
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9737; val_auprc_score: 0.9776; val_best_acc_score: 0.9165; val_best_f1_score: 0.9142; train_kl_reg_loss: 571.3264; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10900.1498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11471.4763; train_optim_loss: 11471.4763; val_kl_reg_loss: 568.7581; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10871.9687; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11440.7267; val_optim_loss: 11440.7267

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9956; val_auprc_score: 0.9959; val_best_acc_score: 0.9711; val_best_f1_score: 0.9710; train_kl_reg_loss: 136.2168; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13728.8602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13865.0770; train_optim_loss: 13865.0770; val_kl_reg_loss: 135.4070; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13732.8583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13868.2653; val_optim_loss: 13868.2653
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9736; val_auprc_score: 0.9775; val_best_acc_score: 0.9165; val_best_f1_score: 0.9142; train_kl_reg_loss: 571.5184; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10900.8198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11472.3382; train_optim_loss: 11472.3382; val_kl_reg_loss: 569.5135; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10881.1320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11450.6455; val_optim_loss: 11450.6455
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9957; val_auprc_score: 0.9961; val_best_acc_score: 0.9711; val_best_f1_score: 0.9710; train_kl_reg_loss: 136.1240; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13725.5532; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13861.6772; train_optim_loss: 13861.6772; val_kl_reg_loss: 135.3516; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13737.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13872.3749; val_optim_loss: 13872.3749
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9741; val_auprc_score: 0.9779; val_best_acc_score: 0.9174; val_best_f1_score: 0.9150; train_kl_reg_loss: 571.3963; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10900.5750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11471.9713; train_optim_loss: 11471.9713; val_kl_reg_loss: 569.2758; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10873.8075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11443.0833; val_optim_loss: 11443.0833
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9957; val_auprc_score: 0.9960; val_best_acc_score: 0.9712; val_best_f1_score: 0.9711; train_kl_reg_loss: 136.0907; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13724.8956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13860.9863; train_optim_loss: 13860.9863; val_kl_reg_loss: 135.3165; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13704.7560; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13840.0725; val_optim_loss: 13840.0725

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9740; val_auprc_score: 0.9779; val_best_acc_score: 0.9172; val_best_f1_score: 0.9148; train_kl_reg_loss: 571.8941; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10905.8151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11477.7092; train_optim_loss: 11477.7092; val_kl_reg_loss: 568.5697; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10873.5016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11442.0713; val_optim_loss: 11442.0713
