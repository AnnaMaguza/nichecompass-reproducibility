None
Run timestamp: 14072023_170127_8.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_8']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1931624
Number of validation edges: 214624
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9841; val_auprc_score: 0.9839; val_best_acc_score: 0.9348; val_best_f1_score: 0.9350; train_kl_reg_loss: 79413.6801; train_edge_recon_loss: 2833165.7432; train_gene_expr_recon_loss: 13659593.2499; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16572172.6682; train_optim_loss: 16572172.6682; val_kl_reg_loss: 59445.5268; val_edge_recon_loss: 2704431.0512; val_gene_expr_recon_loss: 12963387.4643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15727264.0214; val_optim_loss: 15727264.0214
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9901; val_auprc_score: 0.9900; val_best_acc_score: 0.9495; val_best_f1_score: 0.9496; train_kl_reg_loss: 52117.7232; train_edge_recon_loss: 2674483.0769; train_gene_expr_recon_loss: 12862914.9123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15589515.7138; train_optim_loss: 15589515.7138; val_kl_reg_loss: 46267.4275; val_edge_recon_loss: 2672670.7750; val_gene_expr_recon_loss: 12762861.5238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15481799.7048; val_optim_loss: 15481799.7048
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9923; val_auprc_score: 0.9921; val_best_acc_score: 0.9564; val_best_f1_score: 0.9565; train_kl_reg_loss: 43446.6438; train_edge_recon_loss: 2653060.9209; train_gene_expr_recon_loss: 12741562.0946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15438069.6658; train_optim_loss: 15438069.6658; val_kl_reg_loss: 41421.1413; val_edge_recon_loss: 2657010.9244; val_gene_expr_recon_loss: 12690839.7548; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15389271.8262; val_optim_loss: 15389271.8262
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9939; val_auprc_score: 0.9936; val_best_acc_score: 0.9620; val_best_f1_score: 0.9621; train_kl_reg_loss: 39595.8023; train_edge_recon_loss: 2643936.8571; train_gene_expr_recon_loss: 12684928.8251; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15368461.4821; train_optim_loss: 15368461.4821; val_kl_reg_loss: 37784.3978; val_edge_recon_loss: 2649488.5780; val_gene_expr_recon_loss: 12669874.9548; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15357147.9143; val_optim_loss: 15357147.9143
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9945; val_auprc_score: 0.9942; val_best_acc_score: 0.9644; val_best_f1_score: 0.9644; train_kl_reg_loss: 37262.2405; train_edge_recon_loss: 2637916.2741; train_gene_expr_recon_loss: 12648090.9125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15323269.4227; train_optim_loss: 15323269.4227; val_kl_reg_loss: 36034.7009; val_edge_recon_loss: 2642433.6815; val_gene_expr_recon_loss: 12645774.9143; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15324243.3119; val_optim_loss: 15324243.3119
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9947; val_auprc_score: 0.9945; val_best_acc_score: 0.9650; val_best_f1_score: 0.9650; train_kl_reg_loss: 35836.7280; train_edge_recon_loss: 2634294.9710; train_gene_expr_recon_loss: 12621411.9086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15291543.6003; train_optim_loss: 15291543.6003; val_kl_reg_loss: 34914.1162; val_edge_recon_loss: 2640445.8506; val_gene_expr_recon_loss: 12631571.2929; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15306931.2595; val_optim_loss: 15306931.2595
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9951; val_auprc_score: 0.9949; val_best_acc_score: 0.9667; val_best_f1_score: 0.9669; train_kl_reg_loss: 34829.4838; train_edge_recon_loss: 2630528.3710; train_gene_expr_recon_loss: 12599781.0093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15265138.8683; train_optim_loss: 15265138.8683; val_kl_reg_loss: 35017.5220; val_edge_recon_loss: 2639464.5113; val_gene_expr_recon_loss: 12614472.4548; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15288954.4905; val_optim_loss: 15288954.4905
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9954; val_auprc_score: 0.9952; val_best_acc_score: 0.9682; val_best_f1_score: 0.9684; train_kl_reg_loss: 34175.9594; train_edge_recon_loss: 2628163.6226; train_gene_expr_recon_loss: 12584687.9112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15247027.4890; train_optim_loss: 15247027.4890; val_kl_reg_loss: 34088.6649; val_edge_recon_loss: 2637234.5274; val_gene_expr_recon_loss: 12599052.0786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15270375.2810; val_optim_loss: 15270375.2810
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9957; val_auprc_score: 0.9955; val_best_acc_score: 0.9693; val_best_f1_score: 0.9695; train_kl_reg_loss: 33603.6676; train_edge_recon_loss: 2625779.1236; train_gene_expr_recon_loss: 12569954.5796; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15229337.3684; train_optim_loss: 15229337.3684; val_kl_reg_loss: 33190.4949; val_edge_recon_loss: 2631793.0821; val_gene_expr_recon_loss: 12598356.9690; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15263340.5452; val_optim_loss: 15263340.5452
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9957; val_auprc_score: 0.9955; val_best_acc_score: 0.9693; val_best_f1_score: 0.9694; train_kl_reg_loss: 33271.2032; train_edge_recon_loss: 2623318.4569; train_gene_expr_recon_loss: 12558780.3461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15215370.0103; train_optim_loss: 15215370.0103; val_kl_reg_loss: 33144.8923; val_edge_recon_loss: 2632070.5655; val_gene_expr_recon_loss: 12588125.0857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15253340.5500; val_optim_loss: 15253340.5500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9960; val_auprc_score: 0.9957; val_best_acc_score: 0.9706; val_best_f1_score: 0.9708; train_kl_reg_loss: 32873.8405; train_edge_recon_loss: 2622388.1129; train_gene_expr_recon_loss: 12549554.2444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15204816.1969; train_optim_loss: 15204816.1969; val_kl_reg_loss: 32536.5432; val_edge_recon_loss: 2631868.5482; val_gene_expr_recon_loss: 12586636.7095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15251041.7952; val_optim_loss: 15251041.7952
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9959; val_auprc_score: 0.9957; val_best_acc_score: 0.9702; val_best_f1_score: 0.9703; train_kl_reg_loss: 32599.9224; train_edge_recon_loss: 2620365.5447; train_gene_expr_recon_loss: 12541743.4946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15194708.9616; train_optim_loss: 15194708.9616; val_kl_reg_loss: 31609.4591; val_edge_recon_loss: 2627846.2851; val_gene_expr_recon_loss: 12591022.3810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15250478.1405; val_optim_loss: 15250478.1405
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9963; val_auprc_score: 0.9959; val_best_acc_score: 0.9712; val_best_f1_score: 0.9713; train_kl_reg_loss: 32292.7840; train_edge_recon_loss: 2619991.8811; train_gene_expr_recon_loss: 12535496.9597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15187781.6255; train_optim_loss: 15187781.6255; val_kl_reg_loss: 31737.3809; val_edge_recon_loss: 2628060.5411; val_gene_expr_recon_loss: 12593968.3810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15253766.3238; val_optim_loss: 15253766.3238
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9964; val_auprc_score: 0.9962; val_best_acc_score: 0.9722; val_best_f1_score: 0.9723; train_kl_reg_loss: 32119.3428; train_edge_recon_loss: 2618373.2617; train_gene_expr_recon_loss: 12529523.5457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15180016.1540; train_optim_loss: 15180016.1540; val_kl_reg_loss: 31782.7470; val_edge_recon_loss: 2627650.9315; val_gene_expr_recon_loss: 12589206.0976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15248639.7857; val_optim_loss: 15248639.7857
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9964; val_auprc_score: 0.9961; val_best_acc_score: 0.9722; val_best_f1_score: 0.9723; train_kl_reg_loss: 31910.0262; train_edge_recon_loss: 2618126.8487; train_gene_expr_recon_loss: 12524900.5735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15174937.4508; train_optim_loss: 15174937.4508; val_kl_reg_loss: 31180.0153; val_edge_recon_loss: 2625670.7280; val_gene_expr_recon_loss: 12585267.9881; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15242118.7262; val_optim_loss: 15242118.7262
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9964; val_auprc_score: 0.9961; val_best_acc_score: 0.9718; val_best_f1_score: 0.9719; train_kl_reg_loss: 31755.0339; train_edge_recon_loss: 2617049.0777; train_gene_expr_recon_loss: 12520078.4302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15168882.5428; train_optim_loss: 15168882.5428; val_kl_reg_loss: 31577.2906; val_edge_recon_loss: 2625310.4482; val_gene_expr_recon_loss: 12586893.0881; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15243780.8167; val_optim_loss: 15243780.8167
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9965; val_auprc_score: 0.9963; val_best_acc_score: 0.9727; val_best_f1_score: 0.9728; train_kl_reg_loss: 31602.4339; train_edge_recon_loss: 2616729.1071; train_gene_expr_recon_loss: 12515860.4678; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15164192.0093; train_optim_loss: 15164192.0093; val_kl_reg_loss: 31509.0827; val_edge_recon_loss: 2624381.2554; val_gene_expr_recon_loss: 12589544.4476; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15245434.7833; val_optim_loss: 15245434.7833
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9967; val_auprc_score: 0.9964; val_best_acc_score: 0.9737; val_best_f1_score: 0.9738; train_kl_reg_loss: 31439.9868; train_edge_recon_loss: 2616178.3072; train_gene_expr_recon_loss: 12512886.3300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15160504.6319; train_optim_loss: 15160504.6319; val_kl_reg_loss: 31600.0048; val_edge_recon_loss: 2624282.5452; val_gene_expr_recon_loss: 12582882.3905; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15238764.9190; val_optim_loss: 15238764.9190
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9966; val_auprc_score: 0.9963; val_best_acc_score: 0.9730; val_best_f1_score: 0.9731; train_kl_reg_loss: 31368.3127; train_edge_recon_loss: 2615283.5545; train_gene_expr_recon_loss: 12509352.6981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15156004.5714; train_optim_loss: 15156004.5714; val_kl_reg_loss: 30555.0808; val_edge_recon_loss: 2624493.5613; val_gene_expr_recon_loss: 12581575.0500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15236623.6976; val_optim_loss: 15236623.6976
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9966; val_auprc_score: 0.9963; val_best_acc_score: 0.9730; val_best_f1_score: 0.9731; train_kl_reg_loss: 31167.7956; train_edge_recon_loss: 2615475.2539; train_gene_expr_recon_loss: 12505954.4196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15152597.4681; train_optim_loss: 15152597.4681; val_kl_reg_loss: 31396.8923; val_edge_recon_loss: 2626421.7595; val_gene_expr_recon_loss: 12590838.5952; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15248657.2571; val_optim_loss: 15248657.2571
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9968; val_auprc_score: 0.9966; val_best_acc_score: 0.9738; val_best_f1_score: 0.9739; train_kl_reg_loss: 31099.8707; train_edge_recon_loss: 2614565.3656; train_gene_expr_recon_loss: 12503613.1805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15149278.4058; train_optim_loss: 15149278.4058; val_kl_reg_loss: 31114.6278; val_edge_recon_loss: 2625848.3214; val_gene_expr_recon_loss: 12580721.0048; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15237683.9500; val_optim_loss: 15237683.9500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9968; val_auprc_score: 0.9966; val_best_acc_score: 0.9740; val_best_f1_score: 0.9741; train_kl_reg_loss: 30955.6967; train_edge_recon_loss: 2614623.1780; train_gene_expr_recon_loss: 12501210.3098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15146789.1808; train_optim_loss: 15146789.1808; val_kl_reg_loss: 31276.3073; val_edge_recon_loss: 2624713.2607; val_gene_expr_recon_loss: 12593737.9405; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15249727.4929; val_optim_loss: 15249727.4929
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9967; val_auprc_score: 0.9965; val_best_acc_score: 0.9737; val_best_f1_score: 0.9738; train_kl_reg_loss: 30908.7478; train_edge_recon_loss: 2612936.7999; train_gene_expr_recon_loss: 12497859.6205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15141705.1654; train_optim_loss: 15141705.1654; val_kl_reg_loss: 30934.7804; val_edge_recon_loss: 2623631.9530; val_gene_expr_recon_loss: 12595579.0476; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15250145.7786; val_optim_loss: 15250145.7786

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9969; val_auprc_score: 0.9966; val_best_acc_score: 0.9745; val_best_f1_score: 0.9745; train_kl_reg_loss: 33492.1921; train_edge_recon_loss: 2611530.4318; train_gene_expr_recon_loss: 12410949.3316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15055971.9616; train_optim_loss: 15055971.9616; val_kl_reg_loss: 33250.1066; val_edge_recon_loss: 2622323.0315; val_gene_expr_recon_loss: 12528836.4429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15184409.6024; val_optim_loss: 15184409.6024
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9968; val_auprc_score: 0.9966; val_best_acc_score: 0.9743; val_best_f1_score: 0.9744; train_kl_reg_loss: 34207.9117; train_edge_recon_loss: 2609696.1474; train_gene_expr_recon_loss: 12400168.2287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15044072.2971; train_optim_loss: 15044072.2971; val_kl_reg_loss: 33786.2206; val_edge_recon_loss: 2620452.9036; val_gene_expr_recon_loss: 12527681.6119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15181920.7452; val_optim_loss: 15181920.7452
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9970; val_auprc_score: 0.9968; val_best_acc_score: 0.9752; val_best_f1_score: 0.9752; train_kl_reg_loss: 34309.8127; train_edge_recon_loss: 2610169.9998; train_gene_expr_recon_loss: 12396158.2454; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15040638.0580; train_optim_loss: 15040638.0580; val_kl_reg_loss: 33805.9280; val_edge_recon_loss: 2618764.2625; val_gene_expr_recon_loss: 12530293.3119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15182863.5048; val_optim_loss: 15182863.5048
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9969; val_auprc_score: 0.9966; val_best_acc_score: 0.9748; val_best_f1_score: 0.9748; train_kl_reg_loss: 34378.7662; train_edge_recon_loss: 2609756.5135; train_gene_expr_recon_loss: 12393239.7869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15037375.0636; train_optim_loss: 15037375.0636; val_kl_reg_loss: 34035.5648; val_edge_recon_loss: 2619038.7637; val_gene_expr_recon_loss: 12527376.9762; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15180451.3500; val_optim_loss: 15180451.3500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9970; val_auprc_score: 0.9967; val_best_acc_score: 0.9752; val_best_f1_score: 0.9752; train_kl_reg_loss: 34362.2256; train_edge_recon_loss: 2609976.8180; train_gene_expr_recon_loss: 12391101.8243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15035440.8672; train_optim_loss: 15035440.8672; val_kl_reg_loss: 34081.1390; val_edge_recon_loss: 2620999.3143; val_gene_expr_recon_loss: 12528860.2762; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15183940.7381; val_optim_loss: 15183940.7381
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9971; val_auprc_score: 0.9969; val_best_acc_score: 0.9752; val_best_f1_score: 0.9753; train_kl_reg_loss: 34324.0141; train_edge_recon_loss: 2609386.7582; train_gene_expr_recon_loss: 12388952.1153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15032662.8871; train_optim_loss: 15032662.8871; val_kl_reg_loss: 33703.9121; val_edge_recon_loss: 2619623.5625; val_gene_expr_recon_loss: 12526263.5881; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15179591.0738; val_optim_loss: 15179591.0738
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9969; val_auprc_score: 0.9966; val_best_acc_score: 0.9751; val_best_f1_score: 0.9751; train_kl_reg_loss: 34258.6717; train_edge_recon_loss: 2609079.0813; train_gene_expr_recon_loss: 12386982.6311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15030320.3856; train_optim_loss: 15030320.3856; val_kl_reg_loss: 33724.1547; val_edge_recon_loss: 2619759.5196; val_gene_expr_recon_loss: 12524762.8381; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15178246.5452; val_optim_loss: 15178246.5452
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9969; val_auprc_score: 0.9966; val_best_acc_score: 0.9753; val_best_f1_score: 0.9754; train_kl_reg_loss: 34172.9774; train_edge_recon_loss: 2609480.1488; train_gene_expr_recon_loss: 12385146.0472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15028799.1757; train_optim_loss: 15028799.1757; val_kl_reg_loss: 33843.2658; val_edge_recon_loss: 2620279.2280; val_gene_expr_recon_loss: 12525888.4738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15180010.9667; val_optim_loss: 15180010.9667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9970; val_auprc_score: 0.9968; val_best_acc_score: 0.9752; val_best_f1_score: 0.9753; train_kl_reg_loss: 34123.9012; train_edge_recon_loss: 2608865.9778; train_gene_expr_recon_loss: 12384236.8540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15027226.7323; train_optim_loss: 15027226.7323; val_kl_reg_loss: 33657.7903; val_edge_recon_loss: 2620436.5708; val_gene_expr_recon_loss: 12522867.3286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15176961.6857; val_optim_loss: 15176961.6857
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9971; val_auprc_score: 0.9969; val_best_acc_score: 0.9755; val_best_f1_score: 0.9755; train_kl_reg_loss: 34070.9182; train_edge_recon_loss: 2608981.9809; train_gene_expr_recon_loss: 12381658.2640; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15024711.1667; train_optim_loss: 15024711.1667; val_kl_reg_loss: 33403.8370; val_edge_recon_loss: 2619014.3071; val_gene_expr_recon_loss: 12526656.4595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15179074.6048; val_optim_loss: 15179074.6048
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9970; val_auprc_score: 0.9968; val_best_acc_score: 0.9754; val_best_f1_score: 0.9755; train_kl_reg_loss: 33970.7186; train_edge_recon_loss: 2609482.1657; train_gene_expr_recon_loss: 12380778.7000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15024231.5884; train_optim_loss: 15024231.5884; val_kl_reg_loss: 33183.0759; val_edge_recon_loss: 2619521.1851; val_gene_expr_recon_loss: 12524310.4119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15177014.6667; val_optim_loss: 15177014.6667
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9971; val_auprc_score: 0.9969; val_best_acc_score: 0.9757; val_best_f1_score: 0.9757; train_kl_reg_loss: 33906.4293; train_edge_recon_loss: 2608447.1470; train_gene_expr_recon_loss: 12379564.4630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15021918.0374; train_optim_loss: 15021918.0374; val_kl_reg_loss: 33425.7881; val_edge_recon_loss: 2618717.6333; val_gene_expr_recon_loss: 12522301.4143; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15174444.8167; val_optim_loss: 15174444.8167
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9970; val_auprc_score: 0.9968; val_best_acc_score: 0.9754; val_best_f1_score: 0.9754; train_kl_reg_loss: 33852.5655; train_edge_recon_loss: 2609140.1122; train_gene_expr_recon_loss: 12378499.0808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15021491.7665; train_optim_loss: 15021491.7665; val_kl_reg_loss: 33295.0701; val_edge_recon_loss: 2619264.9107; val_gene_expr_recon_loss: 12521949.0286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15174509.0095; val_optim_loss: 15174509.0095
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9971; val_auprc_score: 0.9969; val_best_acc_score: 0.9757; val_best_f1_score: 0.9757; train_kl_reg_loss: 33785.2657; train_edge_recon_loss: 2608784.0936; train_gene_expr_recon_loss: 12376973.5680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15019542.9250; train_optim_loss: 15019542.9250; val_kl_reg_loss: 33407.7727; val_edge_recon_loss: 2619551.3274; val_gene_expr_recon_loss: 12525895.5524; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15178854.6333; val_optim_loss: 15178854.6333
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9973; val_auprc_score: 0.9971; val_best_acc_score: 0.9765; val_best_f1_score: 0.9765; train_kl_reg_loss: 33720.6727; train_edge_recon_loss: 2608246.6698; train_gene_expr_recon_loss: 12376248.2282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15018215.5656; train_optim_loss: 15018215.5656; val_kl_reg_loss: 33015.9740; val_edge_recon_loss: 2617850.2798; val_gene_expr_recon_loss: 12524040.3524; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15174906.6071; val_optim_loss: 15174906.6071
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9970; val_auprc_score: 0.9968; val_best_acc_score: 0.9754; val_best_f1_score: 0.9755; train_kl_reg_loss: 33583.7137; train_edge_recon_loss: 2609050.0354; train_gene_expr_recon_loss: 12374608.4135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15017242.1588; train_optim_loss: 15017242.1588; val_kl_reg_loss: 33220.8688; val_edge_recon_loss: 2620512.7571; val_gene_expr_recon_loss: 12525386.0738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15179119.7095; val_optim_loss: 15179119.7095

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9972; val_auprc_score: 0.9971; val_best_acc_score: 0.9760; val_best_f1_score: 0.9760; train_kl_reg_loss: 33808.7611; train_edge_recon_loss: 2608559.5154; train_gene_expr_recon_loss: 12361866.4386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15004234.7090; train_optim_loss: 15004234.7090; val_kl_reg_loss: 33546.7727; val_edge_recon_loss: 2617380.8911; val_gene_expr_recon_loss: 12513408.6857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15164336.3429; val_optim_loss: 15164336.3429
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9972; val_auprc_score: 0.9969; val_best_acc_score: 0.9762; val_best_f1_score: 0.9763; train_kl_reg_loss: 33927.9929; train_edge_recon_loss: 2608390.2516; train_gene_expr_recon_loss: 12360960.7437; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15003278.9761; train_optim_loss: 15003278.9761; val_kl_reg_loss: 33544.7495; val_edge_recon_loss: 2617751.6018; val_gene_expr_recon_loss: 12516275.0143; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15167571.3667; val_optim_loss: 15167571.3667
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9971; val_auprc_score: 0.9969; val_best_acc_score: 0.9758; val_best_f1_score: 0.9759; train_kl_reg_loss: 33959.6218; train_edge_recon_loss: 2608111.0364; train_gene_expr_recon_loss: 12360112.4416; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15002183.0888; train_optim_loss: 15002183.0888; val_kl_reg_loss: 33479.8998; val_edge_recon_loss: 2617925.9952; val_gene_expr_recon_loss: 12512643.8714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15164049.7524; val_optim_loss: 15164049.7524
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9970; val_auprc_score: 0.9968; val_best_acc_score: 0.9756; val_best_f1_score: 0.9756; train_kl_reg_loss: 33963.0019; train_edge_recon_loss: 2608886.4704; train_gene_expr_recon_loss: 12359446.4212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15002295.8892; train_optim_loss: 15002295.8892; val_kl_reg_loss: 33586.4853; val_edge_recon_loss: 2617799.5310; val_gene_expr_recon_loss: 12513332.8405; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15164718.8548; val_optim_loss: 15164718.8548
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9971; val_auprc_score: 0.9969; val_best_acc_score: 0.9758; val_best_f1_score: 0.9759; train_kl_reg_loss: 33975.6322; train_edge_recon_loss: 2608334.2756; train_gene_expr_recon_loss: 12359925.0779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15002234.9785; train_optim_loss: 15002234.9785; val_kl_reg_loss: 33581.3806; val_edge_recon_loss: 2617274.4119; val_gene_expr_recon_loss: 12511589.8976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15162445.6881; val_optim_loss: 15162445.6881
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9972; val_auprc_score: 0.9970; val_best_acc_score: 0.9760; val_best_f1_score: 0.9761; train_kl_reg_loss: 33974.8752; train_edge_recon_loss: 2608780.2452; train_gene_expr_recon_loss: 12359502.4519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15002257.5720; train_optim_loss: 15002257.5720; val_kl_reg_loss: 33502.8315; val_edge_recon_loss: 2617213.0583; val_gene_expr_recon_loss: 12514785.3786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15165501.2405; val_optim_loss: 15165501.2405
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9971; val_auprc_score: 0.9969; val_best_acc_score: 0.9758; val_best_f1_score: 0.9759; train_kl_reg_loss: 33956.7997; train_edge_recon_loss: 2608634.3163; train_gene_expr_recon_loss: 12359535.7768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15002126.8929; train_optim_loss: 15002126.8929; val_kl_reg_loss: 33574.3805; val_edge_recon_loss: 2618353.1756; val_gene_expr_recon_loss: 12512755.4571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15164682.9976; val_optim_loss: 15164682.9976
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9972; val_auprc_score: 0.9970; val_best_acc_score: 0.9758; val_best_f1_score: 0.9758; train_kl_reg_loss: 33976.5464; train_edge_recon_loss: 2608721.2260; train_gene_expr_recon_loss: 12359630.0808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15002327.8471; train_optim_loss: 15002327.8471; val_kl_reg_loss: 33506.7944; val_edge_recon_loss: 2618426.3417; val_gene_expr_recon_loss: 12514026.6690; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15165959.8286; val_optim_loss: 15165959.8286
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9973; val_auprc_score: 0.9971; val_best_acc_score: 0.9760; val_best_f1_score: 0.9762; train_kl_reg_loss: 33954.5797; train_edge_recon_loss: 2608459.4718; train_gene_expr_recon_loss: 12358887.2001; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15001301.2515; train_optim_loss: 15001301.2515; val_kl_reg_loss: 33559.4224; val_edge_recon_loss: 2617044.1768; val_gene_expr_recon_loss: 12512881.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15163485.0167; val_optim_loss: 15163485.0167

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9971; val_auprc_score: 0.9969; val_best_acc_score: 0.9760; val_best_f1_score: 0.9760; train_kl_reg_loss: 33964.1687; train_edge_recon_loss: 2608147.9842; train_gene_expr_recon_loss: 12357807.2953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14999919.4498; train_optim_loss: 14999919.4498; val_kl_reg_loss: 33571.3081; val_edge_recon_loss: 2618510.6196; val_gene_expr_recon_loss: 12511698.6048; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15163780.4976; val_optim_loss: 15163780.4976
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9972; val_auprc_score: 0.9970; val_best_acc_score: 0.9758; val_best_f1_score: 0.9758; train_kl_reg_loss: 33982.0150; train_edge_recon_loss: 2607957.1565; train_gene_expr_recon_loss: 12356923.4805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14998862.6385; train_optim_loss: 14998862.6385; val_kl_reg_loss: 33566.9102; val_edge_recon_loss: 2617759.5393; val_gene_expr_recon_loss: 12512701.9476; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15164028.4048; val_optim_loss: 15164028.4048
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9972; val_auprc_score: 0.9968; val_best_acc_score: 0.9759; val_best_f1_score: 0.9760; train_kl_reg_loss: 33983.4507; train_edge_recon_loss: 2608126.7887; train_gene_expr_recon_loss: 12357674.1206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14999784.3570; train_optim_loss: 14999784.3570; val_kl_reg_loss: 33606.4930; val_edge_recon_loss: 2617003.7054; val_gene_expr_recon_loss: 12513174.0143; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15163784.2095; val_optim_loss: 15163784.2095
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9972; val_auprc_score: 0.9970; val_best_acc_score: 0.9759; val_best_f1_score: 0.9761; train_kl_reg_loss: 34001.6761; train_edge_recon_loss: 2608858.5153; train_gene_expr_recon_loss: 12357888.5863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15000748.7792; train_optim_loss: 15000748.7792; val_kl_reg_loss: 33593.2888; val_edge_recon_loss: 2617472.2220; val_gene_expr_recon_loss: 12515621.2357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15166686.7786; val_optim_loss: 15166686.7786

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1789 min 8 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
Val AUROC score: 0.9972
Val AUPRC score: 0.9970
Val best accuracy score: 0.9758
Val best F1 score: 0.9759
Val gene expr MSE score: 8.0538

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
