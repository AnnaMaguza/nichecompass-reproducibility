None
Run timestamp: 03072023_191830_8.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_8']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1931624
Number of validation edges: 214624
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9607; val_auprc_score: 0.9663; val_best_acc_score: 0.8936; val_best_f1_score: 0.8878; train_kl_reg_loss: 854.5304; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 14785.0394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15639.5698; train_optim_loss: 15639.5698; val_kl_reg_loss: 738.5898; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13513.7503; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14252.3402; val_optim_loss: 14252.3402
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9658; val_auprc_score: 0.9707; val_best_acc_score: 0.9025; val_best_f1_score: 0.9003; train_kl_reg_loss: 676.8181; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13554.4348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14231.2530; train_optim_loss: 14231.2530; val_kl_reg_loss: 639.2788; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13169.1474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13808.4262; val_optim_loss: 13808.4262
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9643; val_auprc_score: 0.9697; val_best_acc_score: 0.8990; val_best_f1_score: 0.8958; train_kl_reg_loss: 625.7295; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13339.3081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13965.0376; train_optim_loss: 13965.0376; val_kl_reg_loss: 600.8028; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13062.1040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13662.9069; val_optim_loss: 13662.9069
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9666; val_auprc_score: 0.9717; val_best_acc_score: 0.9042; val_best_f1_score: 0.9022; train_kl_reg_loss: 601.5010; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13250.0672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13851.5682; train_optim_loss: 13851.5682; val_kl_reg_loss: 588.3185; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13027.7018; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13616.0202; val_optim_loss: 13616.0202
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9667; val_auprc_score: 0.9716; val_best_acc_score: 0.9040; val_best_f1_score: 0.9006; train_kl_reg_loss: 589.9176; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13204.3509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13794.2685; train_optim_loss: 13794.2685; val_kl_reg_loss: 587.7946; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13003.1342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13590.9288; val_optim_loss: 13590.9288
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9698; val_auprc_score: 0.9744; val_best_acc_score: 0.9086; val_best_f1_score: 0.9077; train_kl_reg_loss: 585.7415; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13176.3821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13762.1236; train_optim_loss: 13762.1236; val_kl_reg_loss: 570.2114; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12983.0757; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13553.2872; val_optim_loss: 13553.2872
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9711; val_auprc_score: 0.9754; val_best_acc_score: 0.9116; val_best_f1_score: 0.9100; train_kl_reg_loss: 582.9454; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13157.1252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13740.0706; train_optim_loss: 13740.0706; val_kl_reg_loss: 589.2599; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12962.1015; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13551.3614; val_optim_loss: 13551.3614
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9712; val_auprc_score: 0.9754; val_best_acc_score: 0.9120; val_best_f1_score: 0.9092; train_kl_reg_loss: 580.4476; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13143.6292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13724.0768; train_optim_loss: 13724.0768; val_kl_reg_loss: 576.2633; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12960.3886; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13536.6518; val_optim_loss: 13536.6518
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9715; val_auprc_score: 0.9758; val_best_acc_score: 0.9126; val_best_f1_score: 0.9097; train_kl_reg_loss: 580.0013; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13130.2649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13710.2662; train_optim_loss: 13710.2662; val_kl_reg_loss: 577.4914; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12953.7680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13531.2594; val_optim_loss: 13531.2594
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9733; val_auprc_score: 0.9773; val_best_acc_score: 0.9155; val_best_f1_score: 0.9146; train_kl_reg_loss: 579.5025; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13122.5141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13702.0166; train_optim_loss: 13702.0166; val_kl_reg_loss: 555.4221; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12967.6688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13523.0909; val_optim_loss: 13523.0909
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9737; val_auprc_score: 0.9777; val_best_acc_score: 0.9167; val_best_f1_score: 0.9155; train_kl_reg_loss: 579.6982; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13116.3834; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13696.0816; train_optim_loss: 13696.0816; val_kl_reg_loss: 574.8208; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12949.8468; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13524.6676; val_optim_loss: 13524.6676
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9722; val_auprc_score: 0.9763; val_best_acc_score: 0.9141; val_best_f1_score: 0.9120; train_kl_reg_loss: 579.4366; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13109.8774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13689.3140; train_optim_loss: 13689.3140; val_kl_reg_loss: 555.4374; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12954.0372; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13509.4745; val_optim_loss: 13509.4745
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9755; val_auprc_score: 0.9791; val_best_acc_score: 0.9205; val_best_f1_score: 0.9186; train_kl_reg_loss: 579.6736; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13105.2192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13684.8928; train_optim_loss: 13684.8928; val_kl_reg_loss: 588.9901; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12940.6008; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13529.5909; val_optim_loss: 13529.5909
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9740; val_auprc_score: 0.9778; val_best_acc_score: 0.9172; val_best_f1_score: 0.9143; train_kl_reg_loss: 579.6150; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13101.2090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13680.8240; train_optim_loss: 13680.8240; val_kl_reg_loss: 571.7482; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12940.2879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13512.0361; val_optim_loss: 13512.0361
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9736; val_auprc_score: 0.9775; val_best_acc_score: 0.9163; val_best_f1_score: 0.9133; train_kl_reg_loss: 579.7338; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13097.8206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13677.5544; train_optim_loss: 13677.5544; val_kl_reg_loss: 560.1530; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12951.7417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13511.8947; val_optim_loss: 13511.8947
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9750; val_auprc_score: 0.9787; val_best_acc_score: 0.9196; val_best_f1_score: 0.9171; train_kl_reg_loss: 579.5120; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13094.0678; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13673.5799; train_optim_loss: 13673.5799; val_kl_reg_loss: 591.4531; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12940.9275; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13532.3806; val_optim_loss: 13532.3806

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9766; val_auprc_score: 0.9801; val_best_acc_score: 0.9232; val_best_f1_score: 0.9216; train_kl_reg_loss: 578.6947; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13030.7171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13609.4119; train_optim_loss: 13609.4119; val_kl_reg_loss: 572.0224; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12916.2365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13488.2590; val_optim_loss: 13488.2590
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9771; val_auprc_score: 0.9805; val_best_acc_score: 0.9247; val_best_f1_score: 0.9226; train_kl_reg_loss: 578.1780; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13016.5360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13594.7140; train_optim_loss: 13594.7140; val_kl_reg_loss: 569.3640; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12914.7312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13484.0952; val_optim_loss: 13484.0952
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9768; val_auprc_score: 0.9803; val_best_acc_score: 0.9236; val_best_f1_score: 0.9219; train_kl_reg_loss: 578.4288; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13012.8100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13591.2388; train_optim_loss: 13591.2388; val_kl_reg_loss: 575.6915; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12911.2153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13486.9068; val_optim_loss: 13486.9068
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9775; val_auprc_score: 0.9808; val_best_acc_score: 0.9253; val_best_f1_score: 0.9231; train_kl_reg_loss: 578.7218; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13009.6359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13588.3576; train_optim_loss: 13588.3576; val_kl_reg_loss: 569.6959; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12918.1941; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13487.8899; val_optim_loss: 13487.8899
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9769; val_auprc_score: 0.9803; val_best_acc_score: 0.9242; val_best_f1_score: 0.9221; train_kl_reg_loss: 578.8750; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13007.9307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13586.8057; train_optim_loss: 13586.8057; val_kl_reg_loss: 576.3204; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12906.9526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13483.2730; val_optim_loss: 13483.2730
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9769; val_auprc_score: 0.9803; val_best_acc_score: 0.9238; val_best_f1_score: 0.9218; train_kl_reg_loss: 579.2777; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13005.2341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13584.5118; train_optim_loss: 13584.5118; val_kl_reg_loss: 576.4247; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12903.4918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13479.9165; val_optim_loss: 13479.9165
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9772; val_auprc_score: 0.9805; val_best_acc_score: 0.9246; val_best_f1_score: 0.9227; train_kl_reg_loss: 579.5162; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13004.1009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13583.6170; train_optim_loss: 13583.6170; val_kl_reg_loss: 577.7391; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12907.3224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13485.0615; val_optim_loss: 13485.0615
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9770; val_auprc_score: 0.9804; val_best_acc_score: 0.9245; val_best_f1_score: 0.9226; train_kl_reg_loss: 579.6153; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13003.6383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13583.2536; train_optim_loss: 13583.2536; val_kl_reg_loss: 578.2563; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12910.2817; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13488.5381; val_optim_loss: 13488.5381
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9770; val_auprc_score: 0.9805; val_best_acc_score: 0.9247; val_best_f1_score: 0.9228; train_kl_reg_loss: 579.7588; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13001.3281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13581.0869; train_optim_loss: 13581.0869; val_kl_reg_loss: 579.7525; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12899.2361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13478.9886; val_optim_loss: 13478.9886
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9771; val_auprc_score: 0.9806; val_best_acc_score: 0.9249; val_best_f1_score: 0.9227; train_kl_reg_loss: 579.8866; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13001.4492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13581.3358; train_optim_loss: 13581.3358; val_kl_reg_loss: 574.6884; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12899.4891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13474.1775; val_optim_loss: 13474.1775
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9771; val_auprc_score: 0.9807; val_best_acc_score: 0.9247; val_best_f1_score: 0.9225; train_kl_reg_loss: 580.1992; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12999.7073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13579.9064; train_optim_loss: 13579.9064; val_kl_reg_loss: 574.5293; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12904.7868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13479.3161; val_optim_loss: 13479.3161
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9769; val_auprc_score: 0.9805; val_best_acc_score: 0.9242; val_best_f1_score: 0.9220; train_kl_reg_loss: 580.3232; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12999.2288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13579.5520; train_optim_loss: 13579.5520; val_kl_reg_loss: 575.8093; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12900.7336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13476.5429; val_optim_loss: 13476.5429
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9774; val_auprc_score: 0.9808; val_best_acc_score: 0.9250; val_best_f1_score: 0.9227; train_kl_reg_loss: 580.5262; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12998.2478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13578.7739; train_optim_loss: 13578.7739; val_kl_reg_loss: 576.1230; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12908.6703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13484.7932; val_optim_loss: 13484.7932
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9773; val_auprc_score: 0.9808; val_best_acc_score: 0.9246; val_best_f1_score: 0.9221; train_kl_reg_loss: 580.6815; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12996.8304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13577.5119; train_optim_loss: 13577.5119; val_kl_reg_loss: 574.2957; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12903.4797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13477.7754; val_optim_loss: 13477.7754

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9775; val_auprc_score: 0.9809; val_best_acc_score: 0.9252; val_best_f1_score: 0.9228; train_kl_reg_loss: 580.7991; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12990.8910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13571.6900; train_optim_loss: 13571.6900; val_kl_reg_loss: 574.9399; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12907.9170; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13482.8569; val_optim_loss: 13482.8569
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9775; val_auprc_score: 0.9809; val_best_acc_score: 0.9253; val_best_f1_score: 0.9228; train_kl_reg_loss: 580.8049; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12989.7180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13570.5230; train_optim_loss: 13570.5230; val_kl_reg_loss: 576.0716; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12900.9626; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13477.0342; val_optim_loss: 13477.0342
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9775; val_auprc_score: 0.9810; val_best_acc_score: 0.9254; val_best_f1_score: 0.9229; train_kl_reg_loss: 580.6016; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12987.7874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13568.3890; train_optim_loss: 13568.3890; val_kl_reg_loss: 576.7748; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12899.2289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13476.0037; val_optim_loss: 13476.0037
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9777; val_auprc_score: 0.9811; val_best_acc_score: 0.9253; val_best_f1_score: 0.9229; train_kl_reg_loss: 580.7308; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12986.6545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13567.3853; train_optim_loss: 13567.3853; val_kl_reg_loss: 577.1476; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12901.2713; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13478.4189; val_optim_loss: 13478.4189

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 787 min 8 sec.
Using best model state, which was in epoch 26.

--- MODEL EVALUATION ---
Val AUROC score: 0.9773
Val AUPRC score: 0.9808
Val best accuracy score: 0.9249
Val best F1 score: 0.9227
Val gene expr MSE score: 8.5927

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
