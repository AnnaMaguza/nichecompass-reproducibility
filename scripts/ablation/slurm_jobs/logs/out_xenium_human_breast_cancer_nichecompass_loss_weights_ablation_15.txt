None
Run timestamp: 14072023_053436_15.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_15']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9612; val_auprc_score: 0.9529; val_best_acc_score: 0.9010; val_best_f1_score: 0.9061; train_kl_reg_loss: 72391.4232; train_edge_recon_loss: 26898493.1924; train_gene_expr_recon_loss: 7381215.4956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34352100.1286; train_optim_loss: 34352100.1286; val_kl_reg_loss: 65160.6166; val_edge_recon_loss: 26540787.2222; val_gene_expr_recon_loss: 6862873.8657; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33468821.7500; val_optim_loss: 33468821.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9783; val_auprc_score: 0.9746; val_best_acc_score: 0.9285; val_best_f1_score: 0.9307; train_kl_reg_loss: 56357.4324; train_edge_recon_loss: 26316417.3447; train_gene_expr_recon_loss: 6714980.1427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33087754.9537; train_optim_loss: 33087754.9537; val_kl_reg_loss: 45879.4923; val_edge_recon_loss: 26348508.0648; val_gene_expr_recon_loss: 6649935.3634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33044322.8889; val_optim_loss: 33044322.8889
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9842; val_auprc_score: 0.9809; val_best_acc_score: 0.9423; val_best_f1_score: 0.9437; train_kl_reg_loss: 45408.3572; train_edge_recon_loss: 26113389.2963; train_gene_expr_recon_loss: 6576487.0036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32735284.6461; train_optim_loss: 32735284.6461; val_kl_reg_loss: 43557.8011; val_edge_recon_loss: 26177603.6204; val_gene_expr_recon_loss: 6565277.9537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32786439.3981; val_optim_loss: 32786439.3981
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9860; val_auprc_score: 0.9830; val_best_acc_score: 0.9463; val_best_f1_score: 0.9476; train_kl_reg_loss: 43013.6222; train_edge_recon_loss: 26036825.5072; train_gene_expr_recon_loss: 6521313.8621; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32601152.9784; train_optim_loss: 32601152.9784; val_kl_reg_loss: 41976.8889; val_edge_recon_loss: 26139940.7500; val_gene_expr_recon_loss: 6536768.9306; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32718686.5741; val_optim_loss: 32718686.5741
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9875; val_auprc_score: 0.9850; val_best_acc_score: 0.9503; val_best_f1_score: 0.9513; train_kl_reg_loss: 41792.7376; train_edge_recon_loss: 25999463.6286; train_gene_expr_recon_loss: 6483457.5478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32524713.9156; train_optim_loss: 32524713.9156; val_kl_reg_loss: 41231.4654; val_edge_recon_loss: 26094419.5185; val_gene_expr_recon_loss: 6500059.5093; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32635710.4537; val_optim_loss: 32635710.4537
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9887; val_auprc_score: 0.9864; val_best_acc_score: 0.9547; val_best_f1_score: 0.9554; train_kl_reg_loss: 39819.2204; train_edge_recon_loss: 25958653.9928; train_gene_expr_recon_loss: 6463350.7533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32461824.0082; train_optim_loss: 32461824.0082; val_kl_reg_loss: 37735.8294; val_edge_recon_loss: 26075260.4259; val_gene_expr_recon_loss: 6485987.1597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32598983.3981; val_optim_loss: 32598983.3981
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9891; val_auprc_score: 0.9868; val_best_acc_score: 0.9556; val_best_f1_score: 0.9564; train_kl_reg_loss: 38384.6277; train_edge_recon_loss: 25931711.7695; train_gene_expr_recon_loss: 6446074.3886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32416170.7870; train_optim_loss: 32416170.7870; val_kl_reg_loss: 38010.2714; val_edge_recon_loss: 26045058.9722; val_gene_expr_recon_loss: 6477975.6181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32561044.7500; val_optim_loss: 32561044.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9891; val_auprc_score: 0.9866; val_best_acc_score: 0.9563; val_best_f1_score: 0.9571; train_kl_reg_loss: 37535.4351; train_edge_recon_loss: 25895680.7284; train_gene_expr_recon_loss: 6431145.6258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32364361.7716; train_optim_loss: 32364361.7716; val_kl_reg_loss: 37196.9328; val_edge_recon_loss: 26026980.8796; val_gene_expr_recon_loss: 6473139.4838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32537317.3056; val_optim_loss: 32537317.3056
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9899; val_auprc_score: 0.9874; val_best_acc_score: 0.9585; val_best_f1_score: 0.9593; train_kl_reg_loss: 37205.4188; train_edge_recon_loss: 25881568.3837; train_gene_expr_recon_loss: 6422482.2294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32341256.0576; train_optim_loss: 32341256.0576; val_kl_reg_loss: 37176.9417; val_edge_recon_loss: 25993570.6574; val_gene_expr_recon_loss: 6459394.1319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32490141.7407; val_optim_loss: 32490141.7407
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9898; val_auprc_score: 0.9876; val_best_acc_score: 0.9582; val_best_f1_score: 0.9588; train_kl_reg_loss: 36818.2150; train_edge_recon_loss: 25870893.1553; train_gene_expr_recon_loss: 6413060.1124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32320771.4383; train_optim_loss: 32320771.4383; val_kl_reg_loss: 36626.6414; val_edge_recon_loss: 25979196.7778; val_gene_expr_recon_loss: 6447276.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32463099.4537; val_optim_loss: 32463099.4537
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9909; val_auprc_score: 0.9888; val_best_acc_score: 0.9617; val_best_f1_score: 0.9624; train_kl_reg_loss: 36187.0614; train_edge_recon_loss: 25860235.9218; train_gene_expr_recon_loss: 6407974.5504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32304397.5103; train_optim_loss: 32304397.5103; val_kl_reg_loss: 35031.1199; val_edge_recon_loss: 25953443.5648; val_gene_expr_recon_loss: 6453971.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32442446.0741; val_optim_loss: 32442446.0741
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9911; val_auprc_score: 0.9892; val_best_acc_score: 0.9606; val_best_f1_score: 0.9614; train_kl_reg_loss: 35902.8696; train_edge_recon_loss: 25841842.6996; train_gene_expr_recon_loss: 6395908.2840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32273653.8673; train_optim_loss: 32273653.8673; val_kl_reg_loss: 34729.1585; val_edge_recon_loss: 25954512.4722; val_gene_expr_recon_loss: 6444417.0139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32433658.5185; val_optim_loss: 32433658.5185
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9916; val_auprc_score: 0.9899; val_best_acc_score: 0.9627; val_best_f1_score: 0.9634; train_kl_reg_loss: 35295.5089; train_edge_recon_loss: 25836619.2469; train_gene_expr_recon_loss: 6398111.6548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32270026.4218; train_optim_loss: 32270026.4218; val_kl_reg_loss: 34634.3823; val_edge_recon_loss: 25947928.8241; val_gene_expr_recon_loss: 6443730.3634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32426293.5370; val_optim_loss: 32426293.5370
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9915; val_auprc_score: 0.9896; val_best_acc_score: 0.9628; val_best_f1_score: 0.9633; train_kl_reg_loss: 35092.1605; train_edge_recon_loss: 25829623.8539; train_gene_expr_recon_loss: 6390650.9887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32255367.0350; train_optim_loss: 32255367.0350; val_kl_reg_loss: 33675.5721; val_edge_recon_loss: 25948558.2407; val_gene_expr_recon_loss: 6446568.4005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32428802.1481; val_optim_loss: 32428802.1481
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9920; val_auprc_score: 0.9901; val_best_acc_score: 0.9643; val_best_f1_score: 0.9648; train_kl_reg_loss: 34785.2172; train_edge_recon_loss: 25816277.9424; train_gene_expr_recon_loss: 6388597.9344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32239661.1121; train_optim_loss: 32239661.1121; val_kl_reg_loss: 33897.6094; val_edge_recon_loss: 25930391.8519; val_gene_expr_recon_loss: 6434442.1296; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32398731.6574; val_optim_loss: 32398731.6574
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9922; val_auprc_score: 0.9904; val_best_acc_score: 0.9653; val_best_f1_score: 0.9659; train_kl_reg_loss: 34763.7852; train_edge_recon_loss: 25810688.0216; train_gene_expr_recon_loss: 6380801.9007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32226253.7500; train_optim_loss: 32226253.7500; val_kl_reg_loss: 34181.8055; val_edge_recon_loss: 25901254.2037; val_gene_expr_recon_loss: 6427488.2593; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32362924.2593; val_optim_loss: 32362924.2593
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9918; val_auprc_score: 0.9897; val_best_acc_score: 0.9647; val_best_f1_score: 0.9652; train_kl_reg_loss: 34569.2495; train_edge_recon_loss: 25803960.7819; train_gene_expr_recon_loss: 6375931.3061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32214461.3632; train_optim_loss: 32214461.3632; val_kl_reg_loss: 33602.2886; val_edge_recon_loss: 25927255.1759; val_gene_expr_recon_loss: 6426562.6736; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32387420.2037; val_optim_loss: 32387420.2037
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9918; val_auprc_score: 0.9898; val_best_acc_score: 0.9646; val_best_f1_score: 0.9651; train_kl_reg_loss: 34158.5322; train_edge_recon_loss: 25802557.2418; train_gene_expr_recon_loss: 6375788.5463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32212504.3302; train_optim_loss: 32212504.3302; val_kl_reg_loss: 34321.3557; val_edge_recon_loss: 25890498.7500; val_gene_expr_recon_loss: 6430354.3565; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32355174.4815; val_optim_loss: 32355174.4815
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9921; val_auprc_score: 0.9901; val_best_acc_score: 0.9651; val_best_f1_score: 0.9656; train_kl_reg_loss: 34190.9414; train_edge_recon_loss: 25796680.1348; train_gene_expr_recon_loss: 6374000.8884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32204871.9712; train_optim_loss: 32204871.9712; val_kl_reg_loss: 33468.3731; val_edge_recon_loss: 25919384.4907; val_gene_expr_recon_loss: 6423969.4792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32376822.3519; val_optim_loss: 32376822.3519
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9922; val_auprc_score: 0.9902; val_best_acc_score: 0.9654; val_best_f1_score: 0.9659; train_kl_reg_loss: 33898.6727; train_edge_recon_loss: 25796351.6255; train_gene_expr_recon_loss: 6373073.9339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32203324.2346; train_optim_loss: 32203324.2346; val_kl_reg_loss: 33393.5745; val_edge_recon_loss: 25935849.8796; val_gene_expr_recon_loss: 6426502.6505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32395746.1019; val_optim_loss: 32395746.1019
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9920; val_auprc_score: 0.9899; val_best_acc_score: 0.9656; val_best_f1_score: 0.9662; train_kl_reg_loss: 33613.8087; train_edge_recon_loss: 25787714.6080; train_gene_expr_recon_loss: 6372152.9020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32193481.3189; train_optim_loss: 32193481.3189; val_kl_reg_loss: 33189.4264; val_edge_recon_loss: 25901896.6481; val_gene_expr_recon_loss: 6424391.1204; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32359477.1574; val_optim_loss: 32359477.1574
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9926; val_auprc_score: 0.9907; val_best_acc_score: 0.9665; val_best_f1_score: 0.9670; train_kl_reg_loss: 33586.1982; train_edge_recon_loss: 25776507.1368; train_gene_expr_recon_loss: 6366256.2868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32176349.6132; train_optim_loss: 32176349.6132; val_kl_reg_loss: 33997.2990; val_edge_recon_loss: 25893005.3611; val_gene_expr_recon_loss: 6438309.1319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32365311.7315; val_optim_loss: 32365311.7315

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9927; val_auprc_score: 0.9909; val_best_acc_score: 0.9678; val_best_f1_score: 0.9682; train_kl_reg_loss: 35206.4221; train_edge_recon_loss: 25765199.5134; train_gene_expr_recon_loss: 6321208.6057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32121614.5360; train_optim_loss: 32121614.5360; val_kl_reg_loss: 34985.3066; val_edge_recon_loss: 25871435.5278; val_gene_expr_recon_loss: 6385881.9606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32292302.7963; val_optim_loss: 32292302.7963
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9930; val_auprc_score: 0.9913; val_best_acc_score: 0.9679; val_best_f1_score: 0.9684; train_kl_reg_loss: 35826.2982; train_edge_recon_loss: 25765192.4393; train_gene_expr_recon_loss: 6314423.5694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32115442.2953; train_optim_loss: 32115442.2953; val_kl_reg_loss: 35499.7770; val_edge_recon_loss: 25871414.8981; val_gene_expr_recon_loss: 6386083.0764; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32292997.5926; val_optim_loss: 32292997.5926
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9926; val_auprc_score: 0.9908; val_best_acc_score: 0.9673; val_best_f1_score: 0.9678; train_kl_reg_loss: 35902.9840; train_edge_recon_loss: 25757956.3673; train_gene_expr_recon_loss: 6313855.3423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32107714.7171; train_optim_loss: 32107714.7171; val_kl_reg_loss: 35479.1341; val_edge_recon_loss: 25881736.6852; val_gene_expr_recon_loss: 6391369.7986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32308585.7130; val_optim_loss: 32308585.7130
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9928; val_auprc_score: 0.9910; val_best_acc_score: 0.9673; val_best_f1_score: 0.9678; train_kl_reg_loss: 36112.0373; train_edge_recon_loss: 25754561.6029; train_gene_expr_recon_loss: 6315091.1209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32105764.7767; train_optim_loss: 32105764.7767; val_kl_reg_loss: 35627.2900; val_edge_recon_loss: 25887281.4630; val_gene_expr_recon_loss: 6379510.7153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32302419.5093; val_optim_loss: 32302419.5093
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9929; val_auprc_score: 0.9912; val_best_acc_score: 0.9676; val_best_f1_score: 0.9680; train_kl_reg_loss: 35918.9970; train_edge_recon_loss: 25754381.3807; train_gene_expr_recon_loss: 6309979.4074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32100279.8004; train_optim_loss: 32100279.8004; val_kl_reg_loss: 35732.5191; val_edge_recon_loss: 25880931.6944; val_gene_expr_recon_loss: 6368926.5069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32285590.7500; val_optim_loss: 32285590.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9931; val_auprc_score: 0.9915; val_best_acc_score: 0.9680; val_best_f1_score: 0.9685; train_kl_reg_loss: 36018.9609; train_edge_recon_loss: 25759291.3632; train_gene_expr_recon_loss: 6312019.1237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32107329.4712; train_optim_loss: 32107329.4712; val_kl_reg_loss: 35461.5865; val_edge_recon_loss: 25869613.8889; val_gene_expr_recon_loss: 6375359.1597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32280434.6296; val_optim_loss: 32280434.6296
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9933; val_auprc_score: 0.9917; val_best_acc_score: 0.9684; val_best_f1_score: 0.9689; train_kl_reg_loss: 35958.2544; train_edge_recon_loss: 25753699.8179; train_gene_expr_recon_loss: 6309419.6880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32099077.8014; train_optim_loss: 32099077.8014; val_kl_reg_loss: 35793.9411; val_edge_recon_loss: 25854972.5463; val_gene_expr_recon_loss: 6373502.7292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32264269.1852; val_optim_loss: 32264269.1852
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9931; val_auprc_score: 0.9914; val_best_acc_score: 0.9682; val_best_f1_score: 0.9687; train_kl_reg_loss: 35978.3558; train_edge_recon_loss: 25750927.7109; train_gene_expr_recon_loss: 6306261.3555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32093167.4249; train_optim_loss: 32093167.4249; val_kl_reg_loss: 35320.0714; val_edge_recon_loss: 25859513.3519; val_gene_expr_recon_loss: 6365320.4306; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32260153.8796; val_optim_loss: 32260153.8796
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9931; val_auprc_score: 0.9915; val_best_acc_score: 0.9680; val_best_f1_score: 0.9684; train_kl_reg_loss: 35664.9510; train_edge_recon_loss: 25758254.0926; train_gene_expr_recon_loss: 6307789.5658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32101708.6173; train_optim_loss: 32101708.6173; val_kl_reg_loss: 35299.7577; val_edge_recon_loss: 25866501.7685; val_gene_expr_recon_loss: 6381433.6829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32283235.3148; val_optim_loss: 32283235.3148
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9931; val_auprc_score: 0.9914; val_best_acc_score: 0.9681; val_best_f1_score: 0.9686; train_kl_reg_loss: 35630.4956; train_edge_recon_loss: 25756854.0432; train_gene_expr_recon_loss: 6308767.8971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32101252.4599; train_optim_loss: 32101252.4599; val_kl_reg_loss: 34971.2994; val_edge_recon_loss: 25888352.6111; val_gene_expr_recon_loss: 6378737.7245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32302061.6667; val_optim_loss: 32302061.6667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9932; val_auprc_score: 0.9916; val_best_acc_score: 0.9684; val_best_f1_score: 0.9688; train_kl_reg_loss: 35665.8183; train_edge_recon_loss: 25755270.6605; train_gene_expr_recon_loss: 6304108.0046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32095044.4907; train_optim_loss: 32095044.4907; val_kl_reg_loss: 35509.0837; val_edge_recon_loss: 25863262.6574; val_gene_expr_recon_loss: 6374899.2546; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32273671.0741; val_optim_loss: 32273671.0741
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9933; val_auprc_score: 0.9917; val_best_acc_score: 0.9687; val_best_f1_score: 0.9692; train_kl_reg_loss: 35510.8586; train_edge_recon_loss: 25742759.3097; train_gene_expr_recon_loss: 6308172.7194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32086442.8714; train_optim_loss: 32086442.8714; val_kl_reg_loss: 35066.6803; val_edge_recon_loss: 25868315.7870; val_gene_expr_recon_loss: 6373616.2801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32276998.7222; val_optim_loss: 32276998.7222

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9932; val_auprc_score: 0.9913; val_best_acc_score: 0.9687; val_best_f1_score: 0.9690; train_kl_reg_loss: 35593.2817; train_edge_recon_loss: 25745714.1224; train_gene_expr_recon_loss: 6297851.4588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32079158.8447; train_optim_loss: 32079158.8447; val_kl_reg_loss: 35112.6592; val_edge_recon_loss: 25866232.7685; val_gene_expr_recon_loss: 6382461.1551; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32283806.5741; val_optim_loss: 32283806.5741
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9932; val_auprc_score: 0.9917; val_best_acc_score: 0.9686; val_best_f1_score: 0.9690; train_kl_reg_loss: 35644.1139; train_edge_recon_loss: 25754238.0741; train_gene_expr_recon_loss: 6297440.7155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32087322.8951; train_optim_loss: 32087322.8951; val_kl_reg_loss: 35134.9329; val_edge_recon_loss: 25862147.7407; val_gene_expr_recon_loss: 6379060.0880; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32276342.7778; val_optim_loss: 32276342.7778
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9933; val_auprc_score: 0.9916; val_best_acc_score: 0.9688; val_best_f1_score: 0.9693; train_kl_reg_loss: 35671.8545; train_edge_recon_loss: 25753441.3107; train_gene_expr_recon_loss: 6299433.0046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32088546.1584; train_optim_loss: 32088546.1584; val_kl_reg_loss: 35171.6008; val_edge_recon_loss: 25854611.7407; val_gene_expr_recon_loss: 6361052.5162; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32250835.7870; val_optim_loss: 32250835.7870
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9931; val_auprc_score: 0.9913; val_best_acc_score: 0.9687; val_best_f1_score: 0.9690; train_kl_reg_loss: 35654.9275; train_edge_recon_loss: 25752418.0216; train_gene_expr_recon_loss: 6299667.3521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32087740.3220; train_optim_loss: 32087740.3220; val_kl_reg_loss: 35194.7941; val_edge_recon_loss: 25866183.5556; val_gene_expr_recon_loss: 6366492.2778; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32267870.6852; val_optim_loss: 32267870.6852
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9934; val_auprc_score: 0.9919; val_best_acc_score: 0.9691; val_best_f1_score: 0.9694; train_kl_reg_loss: 35716.8276; train_edge_recon_loss: 25749040.9805; train_gene_expr_recon_loss: 6300444.6921; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32085202.5031; train_optim_loss: 32085202.5031; val_kl_reg_loss: 35186.2322; val_edge_recon_loss: 25845776.5741; val_gene_expr_recon_loss: 6365892.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32246854.9167; val_optim_loss: 32246854.9167
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9931; val_auprc_score: 0.9914; val_best_acc_score: 0.9687; val_best_f1_score: 0.9690; train_kl_reg_loss: 35751.1926; train_edge_recon_loss: 25748188.9496; train_gene_expr_recon_loss: 6299794.9411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32083735.0947; train_optim_loss: 32083735.0947; val_kl_reg_loss: 35273.0319; val_edge_recon_loss: 25873329.2037; val_gene_expr_recon_loss: 6367021.9352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32275624.1481; val_optim_loss: 32275624.1481
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9933; val_auprc_score: 0.9916; val_best_acc_score: 0.9686; val_best_f1_score: 0.9690; train_kl_reg_loss: 35821.3078; train_edge_recon_loss: 25747518.0648; train_gene_expr_recon_loss: 6300647.8495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32083987.2346; train_optim_loss: 32083987.2346; val_kl_reg_loss: 35399.6485; val_edge_recon_loss: 25864623.9259; val_gene_expr_recon_loss: 6365958.9722; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32265982.5833; val_optim_loss: 32265982.5833
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9935; val_auprc_score: 0.9922; val_best_acc_score: 0.9692; val_best_f1_score: 0.9695; train_kl_reg_loss: 35860.8413; train_edge_recon_loss: 25745782.0720; train_gene_expr_recon_loss: 6297018.9234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32078661.8385; train_optim_loss: 32078661.8385; val_kl_reg_loss: 35244.3378; val_edge_recon_loss: 25853782.5556; val_gene_expr_recon_loss: 6368616.0556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32257642.9907; val_optim_loss: 32257642.9907
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9933; val_auprc_score: 0.9916; val_best_acc_score: 0.9691; val_best_f1_score: 0.9695; train_kl_reg_loss: 35760.7065; train_edge_recon_loss: 25747153.5391; train_gene_expr_recon_loss: 6297914.9048; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32080829.1636; train_optim_loss: 32080829.1636; val_kl_reg_loss: 35295.6856; val_edge_recon_loss: 25842555.2778; val_gene_expr_recon_loss: 6372412.3634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32250263.4074; val_optim_loss: 32250263.4074

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9934; val_auprc_score: 0.9919; val_best_acc_score: 0.9689; val_best_f1_score: 0.9694; train_kl_reg_loss: 35765.2869; train_edge_recon_loss: 25744508.5957; train_gene_expr_recon_loss: 6297104.7567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32077378.6409; train_optim_loss: 32077378.6409; val_kl_reg_loss: 35259.6113; val_edge_recon_loss: 25869905.8519; val_gene_expr_recon_loss: 6370489.9259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32275655.4722; val_optim_loss: 32275655.4722
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9932; val_auprc_score: 0.9916; val_best_acc_score: 0.9684; val_best_f1_score: 0.9689; train_kl_reg_loss: 35769.7510; train_edge_recon_loss: 25749140.0175; train_gene_expr_recon_loss: 6299894.6222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32084804.3724; train_optim_loss: 32084804.3724; val_kl_reg_loss: 35254.8968; val_edge_recon_loss: 25862992.5556; val_gene_expr_recon_loss: 6373315.4444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32271562.8796; val_optim_loss: 32271562.8796
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9932; val_auprc_score: 0.9913; val_best_acc_score: 0.9690; val_best_f1_score: 0.9695; train_kl_reg_loss: 35773.1711; train_edge_recon_loss: 25750365.4866; train_gene_expr_recon_loss: 6298490.4655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32084629.1348; train_optim_loss: 32084629.1348; val_kl_reg_loss: 35259.0899; val_edge_recon_loss: 25832813.4630; val_gene_expr_recon_loss: 6370648.8704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32238721.4167; val_optim_loss: 32238721.4167
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9931; val_auprc_score: 0.9914; val_best_acc_score: 0.9687; val_best_f1_score: 0.9692; train_kl_reg_loss: 35765.0536; train_edge_recon_loss: 25747665.5967; train_gene_expr_recon_loss: 6298717.0175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32082147.6872; train_optim_loss: 32082147.6872; val_kl_reg_loss: 35268.6165; val_edge_recon_loss: 25859892.5093; val_gene_expr_recon_loss: 6370574.4537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32265735.6111; val_optim_loss: 32265735.6111
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9935; val_auprc_score: 0.9920; val_best_acc_score: 0.9692; val_best_f1_score: 0.9697; train_kl_reg_loss: 35773.0136; train_edge_recon_loss: 25755749.9455; train_gene_expr_recon_loss: 6300541.6430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32092064.5885; train_optim_loss: 32092064.5885; val_kl_reg_loss: 35270.9723; val_edge_recon_loss: 25860447.5648; val_gene_expr_recon_loss: 6374031.6389; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32269750.0648; val_optim_loss: 32269750.0648
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9931; val_auprc_score: 0.9913; val_best_acc_score: 0.9689; val_best_f1_score: 0.9693; train_kl_reg_loss: 35767.9503; train_edge_recon_loss: 25755227.4702; train_gene_expr_recon_loss: 6297085.3771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32088080.7623; train_optim_loss: 32088080.7623; val_kl_reg_loss: 35282.5410; val_edge_recon_loss: 25878919.4167; val_gene_expr_recon_loss: 6380574.4468; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32294776.3889; val_optim_loss: 32294776.3889
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9932; val_auprc_score: 0.9916; val_best_acc_score: 0.9687; val_best_f1_score: 0.9691; train_kl_reg_loss: 35758.9318; train_edge_recon_loss: 25752821.1800; train_gene_expr_recon_loss: 6300003.9100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32088584.0494; train_optim_loss: 32088584.0494; val_kl_reg_loss: 35303.2912; val_edge_recon_loss: 25864144.4722; val_gene_expr_recon_loss: 6373794.7778; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32273242.5833; val_optim_loss: 32273242.5833

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9934; val_auprc_score: 0.9917; val_best_acc_score: 0.9689; val_best_f1_score: 0.9693; train_kl_reg_loss: 35752.8853; train_edge_recon_loss: 25747109.5288; train_gene_expr_recon_loss: 6300850.2608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32083712.6646; train_optim_loss: 32083712.6646; val_kl_reg_loss: 35249.4958; val_edge_recon_loss: 25877802.1667; val_gene_expr_recon_loss: 6365475.0764; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32278526.7963; val_optim_loss: 32278526.7963
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9932; val_auprc_score: 0.9913; val_best_acc_score: 0.9689; val_best_f1_score: 0.9692; train_kl_reg_loss: 35761.6046; train_edge_recon_loss: 25745403.4084; train_gene_expr_recon_loss: 6297565.6119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32078730.6183; train_optim_loss: 32078730.6183; val_kl_reg_loss: 35248.0534; val_edge_recon_loss: 25847595.5648; val_gene_expr_recon_loss: 6370585.6227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32253429.2407; val_optim_loss: 32253429.2407
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9933; val_auprc_score: 0.9915; val_best_acc_score: 0.9689; val_best_f1_score: 0.9693; train_kl_reg_loss: 35754.5935; train_edge_recon_loss: 25747465.8025; train_gene_expr_recon_loss: 6298678.8302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32081899.1924; train_optim_loss: 32081899.1924; val_kl_reg_loss: 35251.8191; val_edge_recon_loss: 25853032.4815; val_gene_expr_recon_loss: 6366232.6736; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32254517.0000; val_optim_loss: 32254517.0000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9934; val_auprc_score: 0.9918; val_best_acc_score: 0.9693; val_best_f1_score: 0.9697; train_kl_reg_loss: 35767.8185; train_edge_recon_loss: 25749300.7582; train_gene_expr_recon_loss: 6297519.3884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32082587.9979; train_optim_loss: 32082587.9979; val_kl_reg_loss: 35269.9340; val_edge_recon_loss: 25839185.1296; val_gene_expr_recon_loss: 6370519.6713; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32244974.7593; val_optim_loss: 32244974.7593

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 591 min 3 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
Val AUROC score: 0.9931
Val AUPRC score: 0.9913
Val best accuracy score: 0.9690
Val best F1 score: 0.9694
Val gene expr MSE score: 1.5633

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
