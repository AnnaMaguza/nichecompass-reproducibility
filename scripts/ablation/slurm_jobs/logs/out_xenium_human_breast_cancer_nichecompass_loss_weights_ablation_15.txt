None
Run timestamp: 01072023_200351_15.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_15']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9788; val_auprc_score: 0.9734; val_best_acc_score: 0.9334; val_best_f1_score: 0.9352; train_kl_reg_loss: 2042.2921; train_edge_recon_loss: 27611.2857; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29653.5779; train_optim_loss: 29653.5779; val_kl_reg_loss: 2079.1607; val_edge_recon_loss: 26201.3846; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28280.5454; val_optim_loss: 28280.5454
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9846; val_auprc_score: 0.9804; val_best_acc_score: 0.9465; val_best_f1_score: 0.9475; train_kl_reg_loss: 2130.8869; train_edge_recon_loss: 27211.5377; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29342.4246; train_optim_loss: 29342.4246; val_kl_reg_loss: 2117.4757; val_edge_recon_loss: 26099.3503; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28216.8260; val_optim_loss: 28216.8260
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9880; val_auprc_score: 0.9847; val_best_acc_score: 0.9543; val_best_f1_score: 0.9552; train_kl_reg_loss: 2147.2522; train_edge_recon_loss: 27140.9631; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29288.2153; train_optim_loss: 29288.2153; val_kl_reg_loss: 2168.1533; val_edge_recon_loss: 26015.9652; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28184.1185; val_optim_loss: 28184.1185
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9897; val_auprc_score: 0.9870; val_best_acc_score: 0.9586; val_best_f1_score: 0.9592; train_kl_reg_loss: 2160.3623; train_edge_recon_loss: 27083.0246; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29243.3869; train_optim_loss: 29243.3869; val_kl_reg_loss: 2152.7357; val_edge_recon_loss: 25942.2929; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28095.0286; val_optim_loss: 28095.0286
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9901; val_auprc_score: 0.9873; val_best_acc_score: 0.9597; val_best_f1_score: 0.9604; train_kl_reg_loss: 2166.8295; train_edge_recon_loss: 27049.5624; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29216.3920; train_optim_loss: 29216.3920; val_kl_reg_loss: 2146.8151; val_edge_recon_loss: 25952.9250; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28099.7402; val_optim_loss: 28099.7402
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9904; val_auprc_score: 0.9875; val_best_acc_score: 0.9622; val_best_f1_score: 0.9628; train_kl_reg_loss: 2169.9378; train_edge_recon_loss: 27031.4130; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29201.3508; train_optim_loss: 29201.3508; val_kl_reg_loss: 2177.2587; val_edge_recon_loss: 25949.5744; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28126.8331; val_optim_loss: 28126.8331
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9911; val_auprc_score: 0.9884; val_best_acc_score: 0.9642; val_best_f1_score: 0.9648; train_kl_reg_loss: 2174.5111; train_edge_recon_loss: 27005.7965; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29180.3076; train_optim_loss: 29180.3076; val_kl_reg_loss: 2158.6329; val_edge_recon_loss: 25937.9758; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28096.6086; val_optim_loss: 28096.6086
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9913; val_auprc_score: 0.9885; val_best_acc_score: 0.9646; val_best_f1_score: 0.9652; train_kl_reg_loss: 2176.2382; train_edge_recon_loss: 26989.8461; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29166.0843; train_optim_loss: 29166.0843; val_kl_reg_loss: 2104.7227; val_edge_recon_loss: 25916.8680; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28021.5907; val_optim_loss: 28021.5907
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9918; val_auprc_score: 0.9891; val_best_acc_score: 0.9661; val_best_f1_score: 0.9666; train_kl_reg_loss: 2177.4810; train_edge_recon_loss: 26977.6083; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29155.0893; train_optim_loss: 29155.0893; val_kl_reg_loss: 2223.8173; val_edge_recon_loss: 25908.3609; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28132.1782; val_optim_loss: 28132.1782
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9921; val_auprc_score: 0.9896; val_best_acc_score: 0.9669; val_best_f1_score: 0.9675; train_kl_reg_loss: 2179.4526; train_edge_recon_loss: 26964.2618; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29143.7144; train_optim_loss: 29143.7144; val_kl_reg_loss: 2162.2032; val_edge_recon_loss: 25875.3598; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28037.5631; val_optim_loss: 28037.5631
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9925; val_auprc_score: 0.9900; val_best_acc_score: 0.9680; val_best_f1_score: 0.9685; train_kl_reg_loss: 2179.3083; train_edge_recon_loss: 26963.3252; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29142.6335; train_optim_loss: 29142.6335; val_kl_reg_loss: 2154.1849; val_edge_recon_loss: 25858.5177; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28012.7026; val_optim_loss: 28012.7026
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9931; val_auprc_score: 0.9912; val_best_acc_score: 0.9687; val_best_f1_score: 0.9692; train_kl_reg_loss: 2183.2445; train_edge_recon_loss: 26939.6817; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29122.9262; train_optim_loss: 29122.9262; val_kl_reg_loss: 2184.9237; val_edge_recon_loss: 25874.9268; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28059.8504; val_optim_loss: 28059.8504
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9931; val_auprc_score: 0.9909; val_best_acc_score: 0.9695; val_best_f1_score: 0.9698; train_kl_reg_loss: 2183.1710; train_edge_recon_loss: 26933.5107; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29116.6817; train_optim_loss: 29116.6817; val_kl_reg_loss: 2169.7256; val_edge_recon_loss: 25839.0772; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28008.8028; val_optim_loss: 28008.8028
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9936; val_auprc_score: 0.9916; val_best_acc_score: 0.9712; val_best_f1_score: 0.9716; train_kl_reg_loss: 2184.8300; train_edge_recon_loss: 26920.7468; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29105.5768; train_optim_loss: 29105.5768; val_kl_reg_loss: 2178.0969; val_edge_recon_loss: 25833.9263; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28012.0232; val_optim_loss: 28012.0232
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9933; val_auprc_score: 0.9912; val_best_acc_score: 0.9710; val_best_f1_score: 0.9714; train_kl_reg_loss: 2184.8637; train_edge_recon_loss: 26921.0159; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29105.8795; train_optim_loss: 29105.8795; val_kl_reg_loss: 2221.3784; val_edge_recon_loss: 25844.0618; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28065.4401; val_optim_loss: 28065.4401
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9937; val_auprc_score: 0.9914; val_best_acc_score: 0.9717; val_best_f1_score: 0.9720; train_kl_reg_loss: 2184.3689; train_edge_recon_loss: 26922.3643; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29106.7332; train_optim_loss: 29106.7332; val_kl_reg_loss: 2185.2947; val_edge_recon_loss: 25840.1657; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28025.4605; val_optim_loss: 28025.4605
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9935; val_auprc_score: 0.9914; val_best_acc_score: 0.9712; val_best_f1_score: 0.9716; train_kl_reg_loss: 2186.7582; train_edge_recon_loss: 26910.9334; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29097.6916; train_optim_loss: 29097.6916; val_kl_reg_loss: 2162.0675; val_edge_recon_loss: 25840.6332; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28002.7007; val_optim_loss: 28002.7007
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9939; val_auprc_score: 0.9919; val_best_acc_score: 0.9719; val_best_f1_score: 0.9723; train_kl_reg_loss: 2187.7428; train_edge_recon_loss: 26903.6581; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29091.4009; train_optim_loss: 29091.4009; val_kl_reg_loss: 2165.9268; val_edge_recon_loss: 25823.1457; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27989.0725; val_optim_loss: 27989.0725
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9938; val_auprc_score: 0.9917; val_best_acc_score: 0.9724; val_best_f1_score: 0.9728; train_kl_reg_loss: 2187.8390; train_edge_recon_loss: 26898.1351; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29085.9741; train_optim_loss: 29085.9741; val_kl_reg_loss: 2186.7702; val_edge_recon_loss: 25797.0866; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27983.8568; val_optim_loss: 27983.8568
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9939; val_auprc_score: 0.9920; val_best_acc_score: 0.9716; val_best_f1_score: 0.9719; train_kl_reg_loss: 2187.7635; train_edge_recon_loss: 26896.7986; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29084.5620; train_optim_loss: 29084.5620; val_kl_reg_loss: 2171.2077; val_edge_recon_loss: 25829.6182; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28000.8259; val_optim_loss: 28000.8259
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9944; val_auprc_score: 0.9926; val_best_acc_score: 0.9738; val_best_f1_score: 0.9741; train_kl_reg_loss: 2188.4518; train_edge_recon_loss: 26895.9525; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29084.4044; train_optim_loss: 29084.4044; val_kl_reg_loss: 2180.7146; val_edge_recon_loss: 25795.1736; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27975.8883; val_optim_loss: 27975.8883
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9943; val_auprc_score: 0.9924; val_best_acc_score: 0.9736; val_best_f1_score: 0.9739; train_kl_reg_loss: 2188.4755; train_edge_recon_loss: 26890.7034; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29079.1790; train_optim_loss: 29079.1790; val_kl_reg_loss: 2205.3348; val_edge_recon_loss: 25801.9844; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28007.3192; val_optim_loss: 28007.3192
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9944; val_auprc_score: 0.9927; val_best_acc_score: 0.9733; val_best_f1_score: 0.9736; train_kl_reg_loss: 2191.3591; train_edge_recon_loss: 26875.4313; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29066.7905; train_optim_loss: 29066.7905; val_kl_reg_loss: 2169.9627; val_edge_recon_loss: 25822.9704; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27992.9331; val_optim_loss: 27992.9331
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9937; val_auprc_score: 0.9916; val_best_acc_score: 0.9722; val_best_f1_score: 0.9726; train_kl_reg_loss: 2191.0174; train_edge_recon_loss: 26877.3349; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29068.3522; train_optim_loss: 29068.3522; val_kl_reg_loss: 2180.6690; val_edge_recon_loss: 25812.4801; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27993.1492; val_optim_loss: 27993.1492
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9944; val_auprc_score: 0.9923; val_best_acc_score: 0.9746; val_best_f1_score: 0.9749; train_kl_reg_loss: 2190.5070; train_edge_recon_loss: 26874.8067; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29065.3137; train_optim_loss: 29065.3137; val_kl_reg_loss: 2231.7237; val_edge_recon_loss: 25761.4871; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27993.2108; val_optim_loss: 27993.2108

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9946; val_auprc_score: 0.9928; val_best_acc_score: 0.9754; val_best_f1_score: 0.9757; train_kl_reg_loss: 2188.8249; train_edge_recon_loss: 26845.0632; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29033.8881; train_optim_loss: 29033.8881; val_kl_reg_loss: 2190.4456; val_edge_recon_loss: 25771.5698; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27962.0153; val_optim_loss: 27962.0153
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9947; val_auprc_score: 0.9929; val_best_acc_score: 0.9758; val_best_f1_score: 0.9760; train_kl_reg_loss: 2187.1026; train_edge_recon_loss: 26839.7947; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29026.8973; train_optim_loss: 29026.8973; val_kl_reg_loss: 2187.3527; val_edge_recon_loss: 25758.1560; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27945.5087; val_optim_loss: 27945.5087
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9948; val_auprc_score: 0.9929; val_best_acc_score: 0.9763; val_best_f1_score: 0.9765; train_kl_reg_loss: 2186.5831; train_edge_recon_loss: 26837.0529; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29023.6360; train_optim_loss: 29023.6360; val_kl_reg_loss: 2193.4853; val_edge_recon_loss: 25735.3319; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27928.8171; val_optim_loss: 27928.8171
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9949; val_auprc_score: 0.9932; val_best_acc_score: 0.9762; val_best_f1_score: 0.9765; train_kl_reg_loss: 2186.0440; train_edge_recon_loss: 26840.5782; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29026.6222; train_optim_loss: 29026.6222; val_kl_reg_loss: 2183.1762; val_edge_recon_loss: 25740.2394; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27923.4156; val_optim_loss: 27923.4156
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9950; val_auprc_score: 0.9933; val_best_acc_score: 0.9762; val_best_f1_score: 0.9764; train_kl_reg_loss: 2186.0699; train_edge_recon_loss: 26840.3311; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29026.4010; train_optim_loss: 29026.4010; val_kl_reg_loss: 2189.8732; val_edge_recon_loss: 25746.4922; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27936.3654; val_optim_loss: 27936.3654
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9949; val_auprc_score: 0.9932; val_best_acc_score: 0.9761; val_best_f1_score: 0.9763; train_kl_reg_loss: 2185.5104; train_edge_recon_loss: 26841.6972; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29027.2076; train_optim_loss: 29027.2076; val_kl_reg_loss: 2183.2166; val_edge_recon_loss: 25775.4210; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27958.6376; val_optim_loss: 27958.6376
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9950; val_auprc_score: 0.9930; val_best_acc_score: 0.9762; val_best_f1_score: 0.9765; train_kl_reg_loss: 2184.9783; train_edge_recon_loss: 26836.5411; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29021.5194; train_optim_loss: 29021.5194; val_kl_reg_loss: 2172.4013; val_edge_recon_loss: 25754.0606; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27926.4618; val_optim_loss: 27926.4618
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9949; val_auprc_score: 0.9932; val_best_acc_score: 0.9761; val_best_f1_score: 0.9763; train_kl_reg_loss: 2185.0501; train_edge_recon_loss: 26838.4544; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29023.5045; train_optim_loss: 29023.5045; val_kl_reg_loss: 2184.9122; val_edge_recon_loss: 25758.5748; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27943.4870; val_optim_loss: 27943.4870

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9952; val_auprc_score: 0.9935; val_best_acc_score: 0.9766; val_best_f1_score: 0.9769; train_kl_reg_loss: 2185.1190; train_edge_recon_loss: 26831.2134; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29016.3324; train_optim_loss: 29016.3324; val_kl_reg_loss: 2182.2722; val_edge_recon_loss: 25731.9190; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27914.1912; val_optim_loss: 27914.1912
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9949; val_auprc_score: 0.9930; val_best_acc_score: 0.9761; val_best_f1_score: 0.9764; train_kl_reg_loss: 2185.3864; train_edge_recon_loss: 26833.3495; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29018.7359; train_optim_loss: 29018.7359; val_kl_reg_loss: 2181.9177; val_edge_recon_loss: 25747.5986; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27929.5164; val_optim_loss: 27929.5164
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9951; val_auprc_score: 0.9933; val_best_acc_score: 0.9768; val_best_f1_score: 0.9770; train_kl_reg_loss: 2183.6633; train_edge_recon_loss: 26837.1554; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29020.8188; train_optim_loss: 29020.8188; val_kl_reg_loss: 2181.1185; val_edge_recon_loss: 25732.0848; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27913.2033; val_optim_loss: 27913.2033
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9951; val_auprc_score: 0.9935; val_best_acc_score: 0.9764; val_best_f1_score: 0.9766; train_kl_reg_loss: 2183.3771; train_edge_recon_loss: 26840.2809; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29023.6580; train_optim_loss: 29023.6580; val_kl_reg_loss: 2179.9011; val_edge_recon_loss: 25751.6044; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27931.5054; val_optim_loss: 27931.5054
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9949; val_auprc_score: 0.9931; val_best_acc_score: 0.9763; val_best_f1_score: 0.9765; train_kl_reg_loss: 2185.1754; train_edge_recon_loss: 26832.0580; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29017.2334; train_optim_loss: 29017.2334; val_kl_reg_loss: 2179.8697; val_edge_recon_loss: 25741.5433; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27921.4130; val_optim_loss: 27921.4130
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9951; val_auprc_score: 0.9934; val_best_acc_score: 0.9767; val_best_f1_score: 0.9769; train_kl_reg_loss: 2183.9173; train_edge_recon_loss: 26834.3807; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29018.2979; train_optim_loss: 29018.2979; val_kl_reg_loss: 2178.3293; val_edge_recon_loss: 25717.1630; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27895.4923; val_optim_loss: 27895.4923
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9951; val_auprc_score: 0.9936; val_best_acc_score: 0.9762; val_best_f1_score: 0.9765; train_kl_reg_loss: 2184.6721; train_edge_recon_loss: 26832.6771; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29017.3492; train_optim_loss: 29017.3492; val_kl_reg_loss: 2183.6839; val_edge_recon_loss: 25739.3525; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27923.0365; val_optim_loss: 27923.0365
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9950; val_auprc_score: 0.9932; val_best_acc_score: 0.9768; val_best_f1_score: 0.9770; train_kl_reg_loss: 2184.2835; train_edge_recon_loss: 26835.4061; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29019.6896; train_optim_loss: 29019.6896; val_kl_reg_loss: 2182.5462; val_edge_recon_loss: 25732.7580; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27915.3042; val_optim_loss: 27915.3042
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9949; val_auprc_score: 0.9930; val_best_acc_score: 0.9765; val_best_f1_score: 0.9767; train_kl_reg_loss: 2184.2297; train_edge_recon_loss: 26835.1120; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29019.3417; train_optim_loss: 29019.3417; val_kl_reg_loss: 2183.3989; val_edge_recon_loss: 25736.5992; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27919.9981; val_optim_loss: 27919.9981
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9950; val_auprc_score: 0.9930; val_best_acc_score: 0.9768; val_best_f1_score: 0.9770; train_kl_reg_loss: 2185.2123; train_edge_recon_loss: 26831.1577; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29016.3700; train_optim_loss: 29016.3700; val_kl_reg_loss: 2180.2288; val_edge_recon_loss: 25735.9765; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27916.2052; val_optim_loss: 27916.2052

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9950; val_auprc_score: 0.9929; val_best_acc_score: 0.9769; val_best_f1_score: 0.9771; train_kl_reg_loss: 2184.7767; train_edge_recon_loss: 26826.5769; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29011.3536; train_optim_loss: 29011.3536; val_kl_reg_loss: 2182.8368; val_edge_recon_loss: 25748.0698; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27930.9067; val_optim_loss: 27930.9067
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9950; val_auprc_score: 0.9934; val_best_acc_score: 0.9763; val_best_f1_score: 0.9765; train_kl_reg_loss: 2186.0006; train_edge_recon_loss: 26827.0301; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29013.0307; train_optim_loss: 29013.0307; val_kl_reg_loss: 2183.2638; val_edge_recon_loss: 25749.1177; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27932.3815; val_optim_loss: 27932.3815
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9952; val_auprc_score: 0.9936; val_best_acc_score: 0.9768; val_best_f1_score: 0.9770; train_kl_reg_loss: 2184.9484; train_edge_recon_loss: 26833.0681; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29018.0165; train_optim_loss: 29018.0165; val_kl_reg_loss: 2181.7199; val_edge_recon_loss: 25744.4274; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27926.1472; val_optim_loss: 27926.1472
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9950; val_auprc_score: 0.9932; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 2184.8573; train_edge_recon_loss: 26828.8117; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29013.6690; train_optim_loss: 29013.6690; val_kl_reg_loss: 2181.2806; val_edge_recon_loss: 25724.4696; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27905.7502; val_optim_loss: 27905.7502

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 497 min 30 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
Val AUROC score: 0.9951
Val AUPRC score: 0.9935
Val best accuracy score: 0.9770
Val best F1 score: 0.9772
Val gene expr MSE score: 5.0801

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
