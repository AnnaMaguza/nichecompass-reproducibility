None
Run timestamp: 01072023_064940_15.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_15']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9806; val_auprc_score: 0.9766; val_best_acc_score: 0.9356; val_best_f1_score: 0.9374; train_kl_reg_loss: 2070.0196; train_edge_recon_loss: 27673.0572; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29743.0768; train_optim_loss: 29743.0768; val_kl_reg_loss: 2177.1131; val_edge_recon_loss: 26220.7874; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28397.9005; val_optim_loss: 28397.9005
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9844; val_auprc_score: 0.9805; val_best_acc_score: 0.9445; val_best_f1_score: 0.9456; train_kl_reg_loss: 2165.8359; train_edge_recon_loss: 27262.7814; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29428.6173; train_optim_loss: 29428.6173; val_kl_reg_loss: 2168.8422; val_edge_recon_loss: 26126.9603; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28295.8024; val_optim_loss: 28295.8024
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9878; val_auprc_score: 0.9846; val_best_acc_score: 0.9531; val_best_f1_score: 0.9541; train_kl_reg_loss: 2184.4338; train_edge_recon_loss: 27178.7028; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29363.1365; train_optim_loss: 29363.1365; val_kl_reg_loss: 2167.4576; val_edge_recon_loss: 26031.0073; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28198.4649; val_optim_loss: 28198.4649
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9889; val_auprc_score: 0.9859; val_best_acc_score: 0.9575; val_best_f1_score: 0.9583; train_kl_reg_loss: 2197.9268; train_edge_recon_loss: 27118.8531; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29316.7799; train_optim_loss: 29316.7799; val_kl_reg_loss: 2264.8375; val_edge_recon_loss: 26012.2328; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28277.0704; val_optim_loss: 28277.0704
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9898; val_auprc_score: 0.9866; val_best_acc_score: 0.9607; val_best_f1_score: 0.9613; train_kl_reg_loss: 2204.8067; train_edge_recon_loss: 27096.2075; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29301.0143; train_optim_loss: 29301.0143; val_kl_reg_loss: 2110.8781; val_edge_recon_loss: 25980.5275; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28091.4056; val_optim_loss: 28091.4056
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9911; val_auprc_score: 0.9885; val_best_acc_score: 0.9637; val_best_f1_score: 0.9643; train_kl_reg_loss: 2208.8970; train_edge_recon_loss: 27068.2971; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29277.1941; train_optim_loss: 29277.1941; val_kl_reg_loss: 2165.7333; val_edge_recon_loss: 25925.8421; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28091.5754; val_optim_loss: 28091.5754
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9908; val_auprc_score: 0.9881; val_best_acc_score: 0.9624; val_best_f1_score: 0.9630; train_kl_reg_loss: 2212.3015; train_edge_recon_loss: 27048.8459; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29261.1474; train_optim_loss: 29261.1474; val_kl_reg_loss: 2174.8581; val_edge_recon_loss: 25943.9646; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28118.8227; val_optim_loss: 28118.8227
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9918; val_auprc_score: 0.9893; val_best_acc_score: 0.9655; val_best_f1_score: 0.9661; train_kl_reg_loss: 2213.8456; train_edge_recon_loss: 27036.1875; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29250.0330; train_optim_loss: 29250.0330; val_kl_reg_loss: 2267.7446; val_edge_recon_loss: 25901.5170; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28169.2618; val_optim_loss: 28169.2618
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9916; val_auprc_score: 0.9892; val_best_acc_score: 0.9659; val_best_f1_score: 0.9664; train_kl_reg_loss: 2216.0694; train_edge_recon_loss: 27023.3883; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29239.4577; train_optim_loss: 29239.4577; val_kl_reg_loss: 2208.2394; val_edge_recon_loss: 25918.5259; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28126.7653; val_optim_loss: 28126.7653

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9926; val_auprc_score: 0.9901; val_best_acc_score: 0.9683; val_best_f1_score: 0.9687; train_kl_reg_loss: 2211.9107; train_edge_recon_loss: 26994.8594; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29206.7702; train_optim_loss: 29206.7702; val_kl_reg_loss: 2169.4103; val_edge_recon_loss: 25871.4301; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28040.8403; val_optim_loss: 28040.8403
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9926; val_auprc_score: 0.9902; val_best_acc_score: 0.9686; val_best_f1_score: 0.9690; train_kl_reg_loss: 2213.5404; train_edge_recon_loss: 26975.1501; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29188.6905; train_optim_loss: 29188.6905; val_kl_reg_loss: 2215.6402; val_edge_recon_loss: 25865.3190; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28080.9592; val_optim_loss: 28080.9592
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9928; val_auprc_score: 0.9904; val_best_acc_score: 0.9696; val_best_f1_score: 0.9700; train_kl_reg_loss: 2212.0233; train_edge_recon_loss: 26973.8122; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29185.8355; train_optim_loss: 29185.8355; val_kl_reg_loss: 2186.0002; val_edge_recon_loss: 25846.4431; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28032.4433; val_optim_loss: 28032.4433
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9930; val_auprc_score: 0.9909; val_best_acc_score: 0.9693; val_best_f1_score: 0.9697; train_kl_reg_loss: 2211.6318; train_edge_recon_loss: 26972.2491; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29183.8808; train_optim_loss: 29183.8808; val_kl_reg_loss: 2172.9469; val_edge_recon_loss: 25857.1192; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28030.0662; val_optim_loss: 28030.0662
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9928; val_auprc_score: 0.9905; val_best_acc_score: 0.9690; val_best_f1_score: 0.9694; train_kl_reg_loss: 2211.6156; train_edge_recon_loss: 26968.6126; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29180.2282; train_optim_loss: 29180.2282; val_kl_reg_loss: 2183.1807; val_edge_recon_loss: 25847.1760; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28030.3567; val_optim_loss: 28030.3567
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9930; val_auprc_score: 0.9910; val_best_acc_score: 0.9695; val_best_f1_score: 0.9699; train_kl_reg_loss: 2211.2969; train_edge_recon_loss: 26968.2261; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29179.5230; train_optim_loss: 29179.5230; val_kl_reg_loss: 2185.5624; val_edge_recon_loss: 25835.6560; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28021.2184; val_optim_loss: 28021.2184
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9932; val_auprc_score: 0.9908; val_best_acc_score: 0.9701; val_best_f1_score: 0.9705; train_kl_reg_loss: 2210.5597; train_edge_recon_loss: 26972.6749; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29183.2347; train_optim_loss: 29183.2347; val_kl_reg_loss: 2195.9670; val_edge_recon_loss: 25844.1970; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28040.1640; val_optim_loss: 28040.1640
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9931; val_auprc_score: 0.9911; val_best_acc_score: 0.9703; val_best_f1_score: 0.9707; train_kl_reg_loss: 2211.6630; train_edge_recon_loss: 26964.4121; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29176.0752; train_optim_loss: 29176.0752; val_kl_reg_loss: 2195.8148; val_edge_recon_loss: 25836.1224; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28031.9372; val_optim_loss: 28031.9372
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9932; val_auprc_score: 0.9911; val_best_acc_score: 0.9699; val_best_f1_score: 0.9703; train_kl_reg_loss: 2212.6312; train_edge_recon_loss: 26962.2281; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29174.8593; train_optim_loss: 29174.8593; val_kl_reg_loss: 2174.3566; val_edge_recon_loss: 25839.6729; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28014.0296; val_optim_loss: 28014.0296
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9933; val_auprc_score: 0.9912; val_best_acc_score: 0.9701; val_best_f1_score: 0.9705; train_kl_reg_loss: 2210.5037; train_edge_recon_loss: 26966.3987; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29176.9024; train_optim_loss: 29176.9024; val_kl_reg_loss: 2197.2561; val_edge_recon_loss: 25815.6638; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28012.9198; val_optim_loss: 28012.9198
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9933; val_auprc_score: 0.9909; val_best_acc_score: 0.9705; val_best_f1_score: 0.9709; train_kl_reg_loss: 2212.0610; train_edge_recon_loss: 26959.6811; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29171.7421; train_optim_loss: 29171.7421; val_kl_reg_loss: 2200.9912; val_edge_recon_loss: 25837.0034; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28037.9946; val_optim_loss: 28037.9946
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9934; val_auprc_score: 0.9915; val_best_acc_score: 0.9704; val_best_f1_score: 0.9708; train_kl_reg_loss: 2210.5133; train_edge_recon_loss: 26965.6663; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29176.1795; train_optim_loss: 29176.1795; val_kl_reg_loss: 2198.0649; val_edge_recon_loss: 25830.7405; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28028.8054; val_optim_loss: 28028.8054
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9936; val_auprc_score: 0.9915; val_best_acc_score: 0.9709; val_best_f1_score: 0.9713; train_kl_reg_loss: 2211.6654; train_edge_recon_loss: 26955.2986; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29166.9639; train_optim_loss: 29166.9639; val_kl_reg_loss: 2192.3714; val_edge_recon_loss: 25826.5995; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28018.9710; val_optim_loss: 28018.9710
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9934; val_auprc_score: 0.9910; val_best_acc_score: 0.9710; val_best_f1_score: 0.9713; train_kl_reg_loss: 2210.7850; train_edge_recon_loss: 26963.8365; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29174.6215; train_optim_loss: 29174.6215; val_kl_reg_loss: 2183.8653; val_edge_recon_loss: 25829.7174; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28013.5827; val_optim_loss: 28013.5827

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9934; val_auprc_score: 0.9910; val_best_acc_score: 0.9711; val_best_f1_score: 0.9714; train_kl_reg_loss: 2210.7689; train_edge_recon_loss: 26949.2901; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29160.0590; train_optim_loss: 29160.0590; val_kl_reg_loss: 2194.2263; val_edge_recon_loss: 25807.0346; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28001.2608; val_optim_loss: 28001.2608
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9932; val_auprc_score: 0.9908; val_best_acc_score: 0.9707; val_best_f1_score: 0.9711; train_kl_reg_loss: 2210.9353; train_edge_recon_loss: 26950.4148; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29161.3501; train_optim_loss: 29161.3501; val_kl_reg_loss: 2194.5299; val_edge_recon_loss: 25837.3160; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28031.8460; val_optim_loss: 28031.8460
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9934; val_auprc_score: 0.9914; val_best_acc_score: 0.9707; val_best_f1_score: 0.9711; train_kl_reg_loss: 2210.6330; train_edge_recon_loss: 26949.6648; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29160.2978; train_optim_loss: 29160.2978; val_kl_reg_loss: 2197.1202; val_edge_recon_loss: 25825.7248; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28022.8451; val_optim_loss: 28022.8451
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9935; val_auprc_score: 0.9914; val_best_acc_score: 0.9710; val_best_f1_score: 0.9714; train_kl_reg_loss: 2209.1162; train_edge_recon_loss: 26956.8866; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29166.0028; train_optim_loss: 29166.0028; val_kl_reg_loss: 2202.2087; val_edge_recon_loss: 25843.1971; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28045.4057; val_optim_loss: 28045.4057
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9935; val_auprc_score: 0.9915; val_best_acc_score: 0.9711; val_best_f1_score: 0.9715; train_kl_reg_loss: 2211.3738; train_edge_recon_loss: 26948.7410; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29160.1148; train_optim_loss: 29160.1148; val_kl_reg_loss: 2204.0632; val_edge_recon_loss: 25811.1184; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28015.1817; val_optim_loss: 28015.1817

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9936; val_auprc_score: 0.9917; val_best_acc_score: 0.9708; val_best_f1_score: 0.9712; train_kl_reg_loss: 2212.5216; train_edge_recon_loss: 26945.7120; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29158.2336; train_optim_loss: 29158.2336; val_kl_reg_loss: 2198.6328; val_edge_recon_loss: 25836.6287; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28035.2615; val_optim_loss: 28035.2615
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9936; val_auprc_score: 0.9917; val_best_acc_score: 0.9708; val_best_f1_score: 0.9712; train_kl_reg_loss: 2212.0029; train_edge_recon_loss: 26953.1345; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29165.1374; train_optim_loss: 29165.1374; val_kl_reg_loss: 2197.1249; val_edge_recon_loss: 25843.9584; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28041.0834; val_optim_loss: 28041.0834
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9933; val_auprc_score: 0.9912; val_best_acc_score: 0.9704; val_best_f1_score: 0.9709; train_kl_reg_loss: 2211.5025; train_edge_recon_loss: 26948.0976; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29159.6001; train_optim_loss: 29159.6001; val_kl_reg_loss: 2195.5404; val_edge_recon_loss: 25834.2631; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28029.8035; val_optim_loss: 28029.8035
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9933; val_auprc_score: 0.9913; val_best_acc_score: 0.9708; val_best_f1_score: 0.9712; train_kl_reg_loss: 2209.2159; train_edge_recon_loss: 26959.7535; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29168.9695; train_optim_loss: 29168.9695; val_kl_reg_loss: 2193.6976; val_edge_recon_loss: 25841.5021; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28035.1998; val_optim_loss: 28035.1998

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 313 min 45 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9933
Val AUPRC score: 0.9912
Val best accuracy score: 0.9704
Val best F1 score: 0.9708
Val gene expr MSE score: 5.0170

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
