None
Run timestamp: 14072023_224731_146.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_146']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9616; val_auprc_score: 0.9532; val_best_acc_score: 0.9028; val_best_f1_score: 0.9072; train_kl_reg_loss: 18542.6279; train_edge_recon_loss: 2694668.2877; train_gene_expr_recon_loss: 763963.4479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3477174.3674; train_optim_loss: 3477174.3674; val_kl_reg_loss: 15288.7733; val_edge_recon_loss: 2659102.1832; val_gene_expr_recon_loss: 703996.6588; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3378387.6147; val_optim_loss: 3378387.6147
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9761; val_auprc_score: 0.9713; val_best_acc_score: 0.9267; val_best_f1_score: 0.9291; train_kl_reg_loss: 15034.0243; train_edge_recon_loss: 2630880.1141; train_gene_expr_recon_loss: 689891.2629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3335805.3991; train_optim_loss: 3335805.3991; val_kl_reg_loss: 14029.6790; val_edge_recon_loss: 2644619.5514; val_gene_expr_recon_loss: 671618.8960; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3330268.1387; val_optim_loss: 3330268.1387
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9815; val_auprc_score: 0.9778; val_best_acc_score: 0.9378; val_best_f1_score: 0.9395; train_kl_reg_loss: 14164.2019; train_edge_recon_loss: 2617070.7915; train_gene_expr_recon_loss: 668083.1943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3299318.1867; train_optim_loss: 3299318.1867; val_kl_reg_loss: 13832.3075; val_edge_recon_loss: 2630521.2243; val_gene_expr_recon_loss: 656987.3977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3301340.9247; val_optim_loss: 3301340.9247
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9828; val_auprc_score: 0.9789; val_best_acc_score: 0.9406; val_best_f1_score: 0.9421; train_kl_reg_loss: 13664.5557; train_edge_recon_loss: 2610198.2896; train_gene_expr_recon_loss: 657424.5879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3281287.4310; train_optim_loss: 3281287.4310; val_kl_reg_loss: 13138.2923; val_edge_recon_loss: 2629157.2414; val_gene_expr_recon_loss: 648830.0942; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3291125.6267; val_optim_loss: 3291125.6267
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9852; val_auprc_score: 0.9821; val_best_acc_score: 0.9462; val_best_f1_score: 0.9473; train_kl_reg_loss: 13193.7265; train_edge_recon_loss: 2606065.9558; train_gene_expr_recon_loss: 651340.0385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3270599.7238; train_optim_loss: 3270599.7238; val_kl_reg_loss: 13083.4882; val_edge_recon_loss: 2626912.3134; val_gene_expr_recon_loss: 644242.1310; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3284237.9212; val_optim_loss: 3284237.9212
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9857; val_auprc_score: 0.9827; val_best_acc_score: 0.9463; val_best_f1_score: 0.9475; train_kl_reg_loss: 12906.2344; train_edge_recon_loss: 2602643.7403; train_gene_expr_recon_loss: 647604.1624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3263154.1401; train_optim_loss: 3263154.1401; val_kl_reg_loss: 12543.6709; val_edge_recon_loss: 2623499.8545; val_gene_expr_recon_loss: 642931.1973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3278974.7277; val_optim_loss: 3278974.7277
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9865; val_auprc_score: 0.9835; val_best_acc_score: 0.9501; val_best_f1_score: 0.9511; train_kl_reg_loss: 12680.4797; train_edge_recon_loss: 2600232.2424; train_gene_expr_recon_loss: 645036.0207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3257948.7425; train_optim_loss: 3257948.7425; val_kl_reg_loss: 12385.0370; val_edge_recon_loss: 2620516.7466; val_gene_expr_recon_loss: 639607.8634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3272509.6216; val_optim_loss: 3272509.6216
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9867; val_auprc_score: 0.9838; val_best_acc_score: 0.9498; val_best_f1_score: 0.9508; train_kl_reg_loss: 12512.7047; train_edge_recon_loss: 2598133.3435; train_gene_expr_recon_loss: 642636.6851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3253282.7332; train_optim_loss: 3253282.7332; val_kl_reg_loss: 12368.9779; val_edge_recon_loss: 2619429.0137; val_gene_expr_recon_loss: 638172.3245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3269970.3116; val_optim_loss: 3269970.3116
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9876; val_auprc_score: 0.9845; val_best_acc_score: 0.9514; val_best_f1_score: 0.9523; train_kl_reg_loss: 12373.0132; train_edge_recon_loss: 2595392.0990; train_gene_expr_recon_loss: 641265.5683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3249030.6814; train_optim_loss: 3249030.6814; val_kl_reg_loss: 12101.0868; val_edge_recon_loss: 2619474.3048; val_gene_expr_recon_loss: 637632.7320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3269208.1164; val_optim_loss: 3269208.1164
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9876; val_auprc_score: 0.9847; val_best_acc_score: 0.9525; val_best_f1_score: 0.9534; train_kl_reg_loss: 12302.4022; train_edge_recon_loss: 2596274.4845; train_gene_expr_recon_loss: 639765.0021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3248341.8909; train_optim_loss: 3248341.8909; val_kl_reg_loss: 12391.0735; val_edge_recon_loss: 2613477.7757; val_gene_expr_recon_loss: 636450.6430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3262319.4812; val_optim_loss: 3262319.4812
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9875; val_auprc_score: 0.9845; val_best_acc_score: 0.9533; val_best_f1_score: 0.9543; train_kl_reg_loss: 12223.8510; train_edge_recon_loss: 2594607.2076; train_gene_expr_recon_loss: 638483.1546; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3245314.2139; train_optim_loss: 3245314.2139; val_kl_reg_loss: 11791.4661; val_edge_recon_loss: 2616443.9247; val_gene_expr_recon_loss: 636185.3716; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3264420.7688; val_optim_loss: 3264420.7688
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9885; val_auprc_score: 0.9856; val_best_acc_score: 0.9548; val_best_f1_score: 0.9558; train_kl_reg_loss: 12171.5980; train_edge_recon_loss: 2593189.3530; train_gene_expr_recon_loss: 637738.9263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3243099.8748; train_optim_loss: 3243099.8748; val_kl_reg_loss: 11980.5119; val_edge_recon_loss: 2612101.1849; val_gene_expr_recon_loss: 634629.7992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3258711.4760; val_optim_loss: 3258711.4760
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9884; val_auprc_score: 0.9856; val_best_acc_score: 0.9550; val_best_f1_score: 0.9558; train_kl_reg_loss: 12099.2292; train_edge_recon_loss: 2591446.3469; train_gene_expr_recon_loss: 636864.4087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3240409.9885; train_optim_loss: 3240409.9885; val_kl_reg_loss: 11949.9966; val_edge_recon_loss: 2612798.7380; val_gene_expr_recon_loss: 633795.9234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3258544.6627; val_optim_loss: 3258544.6627
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9884; val_auprc_score: 0.9856; val_best_acc_score: 0.9545; val_best_f1_score: 0.9554; train_kl_reg_loss: 12066.9394; train_edge_recon_loss: 2590973.1047; train_gene_expr_recon_loss: 636054.0318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3239094.0774; train_optim_loss: 3239094.0774; val_kl_reg_loss: 11820.9209; val_edge_recon_loss: 2614196.1575; val_gene_expr_recon_loss: 634326.4319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3260343.5223; val_optim_loss: 3260343.5223
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9890; val_auprc_score: 0.9862; val_best_acc_score: 0.9563; val_best_f1_score: 0.9572; train_kl_reg_loss: 11995.6950; train_edge_recon_loss: 2591029.6846; train_gene_expr_recon_loss: 635877.6824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3238903.0596; train_optim_loss: 3238903.0596; val_kl_reg_loss: 11857.3916; val_edge_recon_loss: 2610435.3271; val_gene_expr_recon_loss: 634418.6199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3256711.3493; val_optim_loss: 3256711.3493
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9881; val_auprc_score: 0.9850; val_best_acc_score: 0.9557; val_best_f1_score: 0.9564; train_kl_reg_loss: 11900.7295; train_edge_recon_loss: 2590499.6491; train_gene_expr_recon_loss: 635092.8962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3237493.2735; train_optim_loss: 3237493.2735; val_kl_reg_loss: 11802.6105; val_edge_recon_loss: 2609328.1147; val_gene_expr_recon_loss: 635251.3326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3256382.0634; val_optim_loss: 3256382.0634
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9891; val_auprc_score: 0.9863; val_best_acc_score: 0.9572; val_best_f1_score: 0.9579; train_kl_reg_loss: 11871.5119; train_edge_recon_loss: 2589339.3897; train_gene_expr_recon_loss: 634627.8950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3235838.7970; train_optim_loss: 3235838.7970; val_kl_reg_loss: 11594.8680; val_edge_recon_loss: 2609880.5034; val_gene_expr_recon_loss: 632790.0291; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3254265.3887; val_optim_loss: 3254265.3887
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9891; val_auprc_score: 0.9863; val_best_acc_score: 0.9580; val_best_f1_score: 0.9588; train_kl_reg_loss: 11846.2570; train_edge_recon_loss: 2588268.2842; train_gene_expr_recon_loss: 634212.2769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3234326.8127; train_optim_loss: 3234326.8127; val_kl_reg_loss: 11814.6684; val_edge_recon_loss: 2604977.9486; val_gene_expr_recon_loss: 632309.9422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3249102.5531; val_optim_loss: 3249102.5531
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9892; val_auprc_score: 0.9864; val_best_acc_score: 0.9582; val_best_f1_score: 0.9590; train_kl_reg_loss: 11780.2192; train_edge_recon_loss: 2588411.0619; train_gene_expr_recon_loss: 633765.4796; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3233956.7641; train_optim_loss: 3233956.7641; val_kl_reg_loss: 11468.3645; val_edge_recon_loss: 2610701.2637; val_gene_expr_recon_loss: 631550.0869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3253719.7226; val_optim_loss: 3253719.7226
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9892; val_auprc_score: 0.9862; val_best_acc_score: 0.9576; val_best_f1_score: 0.9585; train_kl_reg_loss: 11772.6769; train_edge_recon_loss: 2588321.6063; train_gene_expr_recon_loss: 633608.8060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3233703.0868; train_optim_loss: 3233703.0868; val_kl_reg_loss: 11444.5159; val_edge_recon_loss: 2607049.8767; val_gene_expr_recon_loss: 632555.6173; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3251050.0120; val_optim_loss: 3251050.0120
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9894; val_auprc_score: 0.9867; val_best_acc_score: 0.9583; val_best_f1_score: 0.9590; train_kl_reg_loss: 11750.2985; train_edge_recon_loss: 2587233.1468; train_gene_expr_recon_loss: 633423.1729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3232406.6198; train_optim_loss: 3232406.6198; val_kl_reg_loss: 11583.2059; val_edge_recon_loss: 2608508.1610; val_gene_expr_recon_loss: 630579.7710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3250671.1455; val_optim_loss: 3250671.1455
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9892; val_auprc_score: 0.9867; val_best_acc_score: 0.9570; val_best_f1_score: 0.9579; train_kl_reg_loss: 11694.8106; train_edge_recon_loss: 2586304.8112; train_gene_expr_recon_loss: 632934.8957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3230934.5197; train_optim_loss: 3230934.5197; val_kl_reg_loss: 11722.7052; val_edge_recon_loss: 2608950.4281; val_gene_expr_recon_loss: 631482.2033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3252155.3219; val_optim_loss: 3252155.3219

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9897; val_auprc_score: 0.9872; val_best_acc_score: 0.9590; val_best_f1_score: 0.9597; train_kl_reg_loss: 11988.4373; train_edge_recon_loss: 2584592.5843; train_gene_expr_recon_loss: 627227.4536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3223808.4792; train_optim_loss: 3223808.4792; val_kl_reg_loss: 11905.8778; val_edge_recon_loss: 2604452.0548; val_gene_expr_recon_loss: 626328.1836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3242686.1113; val_optim_loss: 3242686.1113
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9900; val_auprc_score: 0.9872; val_best_acc_score: 0.9602; val_best_f1_score: 0.9608; train_kl_reg_loss: 12041.0698; train_edge_recon_loss: 2584180.2691; train_gene_expr_recon_loss: 627077.3448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3223298.6852; train_optim_loss: 3223298.6852; val_kl_reg_loss: 11795.1371; val_edge_recon_loss: 2603436.4024; val_gene_expr_recon_loss: 625634.0989; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3240865.6455; val_optim_loss: 3240865.6455
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9904; val_auprc_score: 0.9880; val_best_acc_score: 0.9602; val_best_f1_score: 0.9610; train_kl_reg_loss: 12013.6945; train_edge_recon_loss: 2585025.7972; train_gene_expr_recon_loss: 626510.2818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3223549.7762; train_optim_loss: 3223549.7762; val_kl_reg_loss: 11830.5176; val_edge_recon_loss: 2605394.9572; val_gene_expr_recon_loss: 626056.9114; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3243282.3938; val_optim_loss: 3243282.3938
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9904; val_auprc_score: 0.9881; val_best_acc_score: 0.9602; val_best_f1_score: 0.9608; train_kl_reg_loss: 12043.4404; train_edge_recon_loss: 2584512.5277; train_gene_expr_recon_loss: 626649.4849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3223205.4494; train_optim_loss: 3223205.4494; val_kl_reg_loss: 11880.2707; val_edge_recon_loss: 2602517.2894; val_gene_expr_recon_loss: 627153.2838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3241550.8459; val_optim_loss: 3241550.8459
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9906; val_auprc_score: 0.9883; val_best_acc_score: 0.9606; val_best_f1_score: 0.9613; train_kl_reg_loss: 12032.9464; train_edge_recon_loss: 2584445.8349; train_gene_expr_recon_loss: 626286.6620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3222765.4362; train_optim_loss: 3222765.4362; val_kl_reg_loss: 11880.0718; val_edge_recon_loss: 2602013.5120; val_gene_expr_recon_loss: 625604.9234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3239498.5205; val_optim_loss: 3239498.5205
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9906; val_auprc_score: 0.9884; val_best_acc_score: 0.9606; val_best_f1_score: 0.9613; train_kl_reg_loss: 12041.5722; train_edge_recon_loss: 2584041.3427; train_gene_expr_recon_loss: 626011.5290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3222094.4425; train_optim_loss: 3222094.4425; val_kl_reg_loss: 11857.9571; val_edge_recon_loss: 2604047.7140; val_gene_expr_recon_loss: 625179.9739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3241085.6473; val_optim_loss: 3241085.6473
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9903; val_auprc_score: 0.9880; val_best_acc_score: 0.9606; val_best_f1_score: 0.9613; train_kl_reg_loss: 12027.3967; train_edge_recon_loss: 2584531.1972; train_gene_expr_recon_loss: 626094.5226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3222653.1139; train_optim_loss: 3222653.1139; val_kl_reg_loss: 11874.4320; val_edge_recon_loss: 2604701.4195; val_gene_expr_recon_loss: 624613.2055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3241189.0668; val_optim_loss: 3241189.0668
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9907; val_auprc_score: 0.9883; val_best_acc_score: 0.9610; val_best_f1_score: 0.9616; train_kl_reg_loss: 12023.6265; train_edge_recon_loss: 2583257.7934; train_gene_expr_recon_loss: 625761.8904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3221043.3112; train_optim_loss: 3221043.3112; val_kl_reg_loss: 11813.3759; val_edge_recon_loss: 2604861.4127; val_gene_expr_recon_loss: 625334.8861; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3242009.6575; val_optim_loss: 3242009.6575
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9902; val_auprc_score: 0.9876; val_best_acc_score: 0.9606; val_best_f1_score: 0.9614; train_kl_reg_loss: 12033.2082; train_edge_recon_loss: 2583309.7905; train_gene_expr_recon_loss: 625734.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3221077.1749; train_optim_loss: 3221077.1749; val_kl_reg_loss: 11814.1323; val_edge_recon_loss: 2604190.1370; val_gene_expr_recon_loss: 624833.3412; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3240837.6216; val_optim_loss: 3240837.6216

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9904; val_auprc_score: 0.9878; val_best_acc_score: 0.9603; val_best_f1_score: 0.9611; train_kl_reg_loss: 12031.0058; train_edge_recon_loss: 2583615.0623; train_gene_expr_recon_loss: 624955.0701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3220601.1390; train_optim_loss: 3220601.1390; val_kl_reg_loss: 11844.9106; val_edge_recon_loss: 2601976.3099; val_gene_expr_recon_loss: 624181.4675; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3238002.6712; val_optim_loss: 3238002.6712
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9905; val_auprc_score: 0.9878; val_best_acc_score: 0.9612; val_best_f1_score: 0.9620; train_kl_reg_loss: 12030.6897; train_edge_recon_loss: 2584212.0061; train_gene_expr_recon_loss: 624786.9779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3221029.6697; train_optim_loss: 3221029.6697; val_kl_reg_loss: 11834.4837; val_edge_recon_loss: 2602049.9829; val_gene_expr_recon_loss: 624646.7988; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3238531.2740; val_optim_loss: 3238531.2740
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9904; val_auprc_score: 0.9878; val_best_acc_score: 0.9606; val_best_f1_score: 0.9613; train_kl_reg_loss: 12024.5207; train_edge_recon_loss: 2581995.3352; train_gene_expr_recon_loss: 624854.3415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3218874.1986; train_optim_loss: 3218874.1986; val_kl_reg_loss: 11838.2186; val_edge_recon_loss: 2603296.6267; val_gene_expr_recon_loss: 625361.0565; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3240495.8938; val_optim_loss: 3240495.8938
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9906; val_auprc_score: 0.9882; val_best_acc_score: 0.9603; val_best_f1_score: 0.9611; train_kl_reg_loss: 12030.2193; train_edge_recon_loss: 2583085.6237; train_gene_expr_recon_loss: 624692.4929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3219808.3324; train_optim_loss: 3219808.3324; val_kl_reg_loss: 11848.2960; val_edge_recon_loss: 2606121.1353; val_gene_expr_recon_loss: 624521.8737; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3242491.2979; val_optim_loss: 3242491.2979
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9904; val_auprc_score: 0.9882; val_best_acc_score: 0.9601; val_best_f1_score: 0.9607; train_kl_reg_loss: 12028.6333; train_edge_recon_loss: 2584154.4795; train_gene_expr_recon_loss: 624656.6854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3220839.7995; train_optim_loss: 3220839.7995; val_kl_reg_loss: 11837.2572; val_edge_recon_loss: 2606143.6541; val_gene_expr_recon_loss: 625175.9208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3243156.8373; val_optim_loss: 3243156.8373

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9909; val_auprc_score: 0.9885; val_best_acc_score: 0.9617; val_best_f1_score: 0.9623; train_kl_reg_loss: 12027.0079; train_edge_recon_loss: 2583511.8188; train_gene_expr_recon_loss: 624767.3322; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3220306.1577; train_optim_loss: 3220306.1577; val_kl_reg_loss: 11833.0849; val_edge_recon_loss: 2601288.7928; val_gene_expr_recon_loss: 624440.1254; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237561.9932; val_optim_loss: 3237561.9932
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9908; val_auprc_score: 0.9885; val_best_acc_score: 0.9615; val_best_f1_score: 0.9621; train_kl_reg_loss: 12030.0246; train_edge_recon_loss: 2583000.8358; train_gene_expr_recon_loss: 624703.8811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3219734.7462; train_optim_loss: 3219734.7462; val_kl_reg_loss: 11834.4427; val_edge_recon_loss: 2602429.7243; val_gene_expr_recon_loss: 625800.2110; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3240064.3733; val_optim_loss: 3240064.3733
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9907; val_auprc_score: 0.9884; val_best_acc_score: 0.9613; val_best_f1_score: 0.9619; train_kl_reg_loss: 12028.2386; train_edge_recon_loss: 2583247.3838; train_gene_expr_recon_loss: 624397.3280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3219672.9520; train_optim_loss: 3219672.9520; val_kl_reg_loss: 11834.9789; val_edge_recon_loss: 2602418.4212; val_gene_expr_recon_loss: 624359.1755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3238612.5719; val_optim_loss: 3238612.5719
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9903; val_auprc_score: 0.9877; val_best_acc_score: 0.9603; val_best_f1_score: 0.9609; train_kl_reg_loss: 12031.6924; train_edge_recon_loss: 2583473.6384; train_gene_expr_recon_loss: 624780.1283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3220285.4576; train_optim_loss: 3220285.4576; val_kl_reg_loss: 11840.8639; val_edge_recon_loss: 2606018.7877; val_gene_expr_recon_loss: 624798.3313; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3242657.9829; val_optim_loss: 3242657.9829
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9905; val_auprc_score: 0.9880; val_best_acc_score: 0.9608; val_best_f1_score: 0.9615; train_kl_reg_loss: 12030.9037; train_edge_recon_loss: 2583500.0464; train_gene_expr_recon_loss: 624422.8435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3219953.7924; train_optim_loss: 3219953.7924; val_kl_reg_loss: 11846.5428; val_edge_recon_loss: 2602157.3750; val_gene_expr_recon_loss: 625127.0475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3239130.9812; val_optim_loss: 3239130.9812

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9903; val_auprc_score: 0.9880; val_best_acc_score: 0.9604; val_best_f1_score: 0.9612; train_kl_reg_loss: 12034.6010; train_edge_recon_loss: 2583044.4050; train_gene_expr_recon_loss: 624630.6501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3219709.6569; train_optim_loss: 3219709.6569; val_kl_reg_loss: 11855.8040; val_edge_recon_loss: 2604397.1336; val_gene_expr_recon_loss: 624588.4863; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3240841.4178; val_optim_loss: 3240841.4178
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9906; val_auprc_score: 0.9880; val_best_acc_score: 0.9615; val_best_f1_score: 0.9621; train_kl_reg_loss: 12033.4061; train_edge_recon_loss: 2582576.3589; train_gene_expr_recon_loss: 624601.6204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3219211.3847; train_optim_loss: 3219211.3847; val_kl_reg_loss: 11842.3247; val_edge_recon_loss: 2600476.3853; val_gene_expr_recon_loss: 625554.6755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237873.3784; val_optim_loss: 3237873.3784
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9904; val_auprc_score: 0.9881; val_best_acc_score: 0.9609; val_best_f1_score: 0.9616; train_kl_reg_loss: 12032.6719; train_edge_recon_loss: 2582434.8821; train_gene_expr_recon_loss: 624845.4179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3219312.9698; train_optim_loss: 3219312.9698; val_kl_reg_loss: 11837.4543; val_edge_recon_loss: 2603682.8750; val_gene_expr_recon_loss: 624586.5869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3240106.9161; val_optim_loss: 3240106.9161
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9907; val_auprc_score: 0.9885; val_best_acc_score: 0.9611; val_best_f1_score: 0.9617; train_kl_reg_loss: 12032.2935; train_edge_recon_loss: 2583474.4560; train_gene_expr_recon_loss: 624600.6054; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3220107.3599; train_optim_loss: 3220107.3599; val_kl_reg_loss: 11841.2842; val_edge_recon_loss: 2603282.5616; val_gene_expr_recon_loss: 624688.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3239812.1455; val_optim_loss: 3239812.1455

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 204 min 3 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
Val AUROC score: 0.9906
Val AUPRC score: 0.9883
Val best accuracy score: 0.9606
Val best F1 score: 0.9612
Val gene expr MSE score: 1.5020

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
