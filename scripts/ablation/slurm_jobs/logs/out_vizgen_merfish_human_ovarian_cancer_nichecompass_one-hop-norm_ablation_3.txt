Run timestamp: 27062023_123656_3.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'patient', 'batch', '--cat_covariates_no_edges', 'True', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'encoder', 'gene_expr_decoder', '--cat_covariates_embeds_nums', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 6, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 759633
Number of validation nodes: 84404
Number of training edges: 5242555
Number of validation edges: 582506
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9935; val_auprc_score: 0.9936; val_best_acc_score: 0.9604; val_best_f1_score: 0.9605; train_kl_reg_loss: 4869.2460; train_edge_recon_loss: 125611.9323; train_gene_expr_recon_loss: 142541.1918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273022.3701; train_optim_loss: 273022.3701; val_kl_reg_loss: 4627.9660; val_edge_recon_loss: 123747.9845; val_gene_expr_recon_loss: 136239.8699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264615.8204; val_optim_loss: 264615.8204
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9956; val_auprc_score: 0.9955; val_best_acc_score: 0.9681; val_best_f1_score: 0.9682; train_kl_reg_loss: 4720.7215; train_edge_recon_loss: 123336.8199; train_gene_expr_recon_loss: 136028.1082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264085.6495; train_optim_loss: 264085.6495; val_kl_reg_loss: 4711.3742; val_edge_recon_loss: 122792.3152; val_gene_expr_recon_loss: 135160.2154; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262663.9048; val_optim_loss: 262663.9048
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9959; val_auprc_score: 0.9958; val_best_acc_score: 0.9693; val_best_f1_score: 0.9694; train_kl_reg_loss: 4767.5530; train_edge_recon_loss: 123135.6082; train_gene_expr_recon_loss: 135347.7515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263250.9126; train_optim_loss: 263250.9126; val_kl_reg_loss: 4691.2656; val_edge_recon_loss: 122821.5109; val_gene_expr_recon_loss: 134796.7544; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262309.5319; val_optim_loss: 262309.5319
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9964; val_auprc_score: 0.9963; val_best_acc_score: 0.9722; val_best_f1_score: 0.9722; train_kl_reg_loss: 4807.4149; train_edge_recon_loss: 123024.3791; train_gene_expr_recon_loss: 135005.2626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262837.0567; train_optim_loss: 262837.0567; val_kl_reg_loss: 4721.2208; val_edge_recon_loss: 122989.6043; val_gene_expr_recon_loss: 134423.9992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262134.8236; val_optim_loss: 262134.8236
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9967; val_auprc_score: 0.9966; val_best_acc_score: 0.9728; val_best_f1_score: 0.9729; train_kl_reg_loss: 4837.6077; train_edge_recon_loss: 123042.7689; train_gene_expr_recon_loss: 134736.3480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262616.7246; train_optim_loss: 262616.7246; val_kl_reg_loss: 4796.8708; val_edge_recon_loss: 122933.1619; val_gene_expr_recon_loss: 134259.1604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261989.1928; val_optim_loss: 261989.1928
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9967; val_auprc_score: 0.9966; val_best_acc_score: 0.9730; val_best_f1_score: 0.9731; train_kl_reg_loss: 4861.6070; train_edge_recon_loss: 122908.9395; train_gene_expr_recon_loss: 134603.4882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262374.0347; train_optim_loss: 262374.0347; val_kl_reg_loss: 4860.8409; val_edge_recon_loss: 122690.2866; val_gene_expr_recon_loss: 134017.5175; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261568.6448; val_optim_loss: 261568.6448
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9966; val_auprc_score: 0.9965; val_best_acc_score: 0.9731; val_best_f1_score: 0.9731; train_kl_reg_loss: 4883.5762; train_edge_recon_loss: 122847.7917; train_gene_expr_recon_loss: 134422.1850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262153.5529; train_optim_loss: 262153.5529; val_kl_reg_loss: 4870.3478; val_edge_recon_loss: 122685.0843; val_gene_expr_recon_loss: 134010.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261565.7649; val_optim_loss: 261565.7649
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9967; val_auprc_score: 0.9966; val_best_acc_score: 0.9732; val_best_f1_score: 0.9733; train_kl_reg_loss: 4898.2084; train_edge_recon_loss: 122923.1193; train_gene_expr_recon_loss: 134327.7578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262149.0855; train_optim_loss: 262149.0855; val_kl_reg_loss: 4835.8961; val_edge_recon_loss: 122750.1932; val_gene_expr_recon_loss: 133901.0465; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261487.1352; val_optim_loss: 261487.1352
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9970; val_auprc_score: 0.9969; val_best_acc_score: 0.9750; val_best_f1_score: 0.9750; train_kl_reg_loss: 4909.3132; train_edge_recon_loss: 122805.3226; train_gene_expr_recon_loss: 134253.2820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261967.9181; train_optim_loss: 261967.9181; val_kl_reg_loss: 4825.2279; val_edge_recon_loss: 122876.8170; val_gene_expr_recon_loss: 133862.9292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261564.9742; val_optim_loss: 261564.9742
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9969; val_auprc_score: 0.9967; val_best_acc_score: 0.9741; val_best_f1_score: 0.9743; train_kl_reg_loss: 4921.5028; train_edge_recon_loss: 122830.9000; train_gene_expr_recon_loss: 134183.4061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261935.8090; train_optim_loss: 261935.8090; val_kl_reg_loss: 4839.1494; val_edge_recon_loss: 122387.5435; val_gene_expr_recon_loss: 133754.2383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260980.9307; val_optim_loss: 260980.9307
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9968; val_auprc_score: 0.9966; val_best_acc_score: 0.9738; val_best_f1_score: 0.9739; train_kl_reg_loss: 4929.1239; train_edge_recon_loss: 122942.6484; train_gene_expr_recon_loss: 134103.2392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261975.0114; train_optim_loss: 261975.0114; val_kl_reg_loss: 4891.4142; val_edge_recon_loss: 122861.0747; val_gene_expr_recon_loss: 133622.8945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261375.3841; val_optim_loss: 261375.3841
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9970; val_auprc_score: 0.9969; val_best_acc_score: 0.9750; val_best_f1_score: 0.9751; train_kl_reg_loss: 4936.5807; train_edge_recon_loss: 122822.1596; train_gene_expr_recon_loss: 134082.9644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261841.7046; train_optim_loss: 261841.7046; val_kl_reg_loss: 4894.3670; val_edge_recon_loss: 122936.9941; val_gene_expr_recon_loss: 133649.0024; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261480.3634; val_optim_loss: 261480.3634
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9968; val_auprc_score: 0.9968; val_best_acc_score: 0.9744; val_best_f1_score: 0.9745; train_kl_reg_loss: 4944.1164; train_edge_recon_loss: 122868.1253; train_gene_expr_recon_loss: 134022.3653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261834.6068; train_optim_loss: 261834.6068; val_kl_reg_loss: 4883.2748; val_edge_recon_loss: 122764.6835; val_gene_expr_recon_loss: 133531.3480; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261179.3065; val_optim_loss: 261179.3065

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9974; val_auprc_score: 0.9973; val_best_acc_score: 0.9774; val_best_f1_score: 0.9774; train_kl_reg_loss: 4903.7186; train_edge_recon_loss: 122584.2837; train_gene_expr_recon_loss: 133390.0682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260878.0707; train_optim_loss: 260878.0707; val_kl_reg_loss: 4856.8130; val_edge_recon_loss: 122451.2191; val_gene_expr_recon_loss: 132950.4157; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260258.4478; val_optim_loss: 260258.4478
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9975; val_auprc_score: 0.9974; val_best_acc_score: 0.9773; val_best_f1_score: 0.9773; train_kl_reg_loss: 4897.2887; train_edge_recon_loss: 122680.6995; train_gene_expr_recon_loss: 133295.9478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260873.9358; train_optim_loss: 260873.9358; val_kl_reg_loss: 4879.0409; val_edge_recon_loss: 122623.2515; val_gene_expr_recon_loss: 132942.3629; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260444.6550; val_optim_loss: 260444.6550
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9975; val_auprc_score: 0.9974; val_best_acc_score: 0.9775; val_best_f1_score: 0.9775; train_kl_reg_loss: 4893.3985; train_edge_recon_loss: 122603.4078; train_gene_expr_recon_loss: 133238.6330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260735.4393; train_optim_loss: 260735.4393; val_kl_reg_loss: 4896.0231; val_edge_recon_loss: 122523.8995; val_gene_expr_recon_loss: 132904.3217; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260324.2434; val_optim_loss: 260324.2434
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9976; val_auprc_score: 0.9975; val_best_acc_score: 0.9776; val_best_f1_score: 0.9777; train_kl_reg_loss: 4896.4513; train_edge_recon_loss: 122672.5370; train_gene_expr_recon_loss: 133223.3503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260792.3385; train_optim_loss: 260792.3385; val_kl_reg_loss: 4860.4454; val_edge_recon_loss: 122475.7612; val_gene_expr_recon_loss: 132858.6972; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260194.9038; val_optim_loss: 260194.9038
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9976; val_auprc_score: 0.9975; val_best_acc_score: 0.9779; val_best_f1_score: 0.9779; train_kl_reg_loss: 4895.6431; train_edge_recon_loss: 122616.5115; train_gene_expr_recon_loss: 133184.1822; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260696.3369; train_optim_loss: 260696.3369; val_kl_reg_loss: 4867.2713; val_edge_recon_loss: 122500.2500; val_gene_expr_recon_loss: 132839.5696; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260207.0907; val_optim_loss: 260207.0907
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9975; val_auprc_score: 0.9974; val_best_acc_score: 0.9776; val_best_f1_score: 0.9777; train_kl_reg_loss: 4895.3513; train_edge_recon_loss: 122557.1414; train_gene_expr_recon_loss: 133167.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260619.9887; train_optim_loss: 260619.9887; val_kl_reg_loss: 4894.8015; val_edge_recon_loss: 122414.9362; val_gene_expr_recon_loss: 132858.1329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260167.8702; val_optim_loss: 260167.8702
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9976; val_auprc_score: 0.9975; val_best_acc_score: 0.9781; val_best_f1_score: 0.9782; train_kl_reg_loss: 4897.1048; train_edge_recon_loss: 122485.1288; train_gene_expr_recon_loss: 133133.5075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260515.7411; train_optim_loss: 260515.7411; val_kl_reg_loss: 4869.2399; val_edge_recon_loss: 122338.4695; val_gene_expr_recon_loss: 132916.7197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260124.4289; val_optim_loss: 260124.4289
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9976; val_auprc_score: 0.9975; val_best_acc_score: 0.9782; val_best_f1_score: 0.9783; train_kl_reg_loss: 4900.1480; train_edge_recon_loss: 122483.8066; train_gene_expr_recon_loss: 133134.5700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260518.5248; train_optim_loss: 260518.5248; val_kl_reg_loss: 4853.8938; val_edge_recon_loss: 122187.5623; val_gene_expr_recon_loss: 132834.2279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259875.6837; val_optim_loss: 259875.6837
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9976; val_auprc_score: 0.9975; val_best_acc_score: 0.9780; val_best_f1_score: 0.9780; train_kl_reg_loss: 4902.0827; train_edge_recon_loss: 122507.4100; train_gene_expr_recon_loss: 133111.6703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260521.1632; train_optim_loss: 260521.1632; val_kl_reg_loss: 4863.8810; val_edge_recon_loss: 122374.7828; val_gene_expr_recon_loss: 132856.9123; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260095.5760; val_optim_loss: 260095.5760
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9976; val_auprc_score: 0.9975; val_best_acc_score: 0.9779; val_best_f1_score: 0.9780; train_kl_reg_loss: 4904.9019; train_edge_recon_loss: 122517.0536; train_gene_expr_recon_loss: 133119.4172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260541.3728; train_optim_loss: 260541.3728; val_kl_reg_loss: 4876.0578; val_edge_recon_loss: 122289.8699; val_gene_expr_recon_loss: 132784.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259950.7481; val_optim_loss: 259950.7481
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9976; val_auprc_score: 0.9975; val_best_acc_score: 0.9783; val_best_f1_score: 0.9783; train_kl_reg_loss: 4904.5951; train_edge_recon_loss: 122504.8970; train_gene_expr_recon_loss: 133084.8639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260494.3561; train_optim_loss: 260494.3561; val_kl_reg_loss: 4871.5490; val_edge_recon_loss: 122593.0125; val_gene_expr_recon_loss: 132807.4566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260272.0183; val_optim_loss: 260272.0183

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9977; val_auprc_score: 0.9976; val_best_acc_score: 0.9784; val_best_f1_score: 0.9784; train_kl_reg_loss: 4903.7165; train_edge_recon_loss: 122560.9054; train_gene_expr_recon_loss: 133004.5460; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260469.1678; train_optim_loss: 260469.1678; val_kl_reg_loss: 4865.1060; val_edge_recon_loss: 122328.3459; val_gene_expr_recon_loss: 132688.3168; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259881.7687; val_optim_loss: 259881.7687
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9963; val_auprc_score: 0.9961; val_best_acc_score: 0.9725; val_best_f1_score: 0.9726; train_kl_reg_loss: 5018.2456; train_edge_recon_loss: 123495.2119; train_gene_expr_recon_loss: 132946.0695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261459.5272; train_optim_loss: 261459.5272; val_kl_reg_loss: 4048.8252; val_edge_recon_loss: 124162.5184; val_gene_expr_recon_loss: 132813.8033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261025.1465; val_optim_loss: 261025.1465
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9964; val_auprc_score: 0.9963; val_best_acc_score: 0.9727; val_best_f1_score: 0.9728; train_kl_reg_loss: 4772.0578; train_edge_recon_loss: 123303.3097; train_gene_expr_recon_loss: 132913.2057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260988.5730; train_optim_loss: 260988.5730; val_kl_reg_loss: 4010.1235; val_edge_recon_loss: 123629.9942; val_gene_expr_recon_loss: 132765.1381; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260405.2552; val_optim_loss: 260405.2552

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1263 min 36 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9959
Val AUPRC score: 0.9958
Val best accuracy score: 0.9713
Val best F1 score: 0.9714
Val gene expr MSE score: 9.1099

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
