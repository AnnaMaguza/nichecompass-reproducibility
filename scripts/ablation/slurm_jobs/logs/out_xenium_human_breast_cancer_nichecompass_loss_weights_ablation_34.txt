None
Run timestamp: 02072023_003403_34.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_34']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9718; val_auprc_score: 0.9653; val_best_acc_score: 0.9208; val_best_f1_score: 0.9234; train_kl_reg_loss: 6222.0800; train_edge_recon_loss: 268448.3657; train_gene_expr_recon_loss: 78259.1428; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352929.5883; train_optim_loss: 352929.5883; val_kl_reg_loss: 5871.4463; val_edge_recon_loss: 265251.1508; val_gene_expr_recon_loss: 71729.0742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 342851.6704; val_optim_loss: 342851.6704
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9800; val_auprc_score: 0.9756; val_best_acc_score: 0.9367; val_best_f1_score: 0.9382; train_kl_reg_loss: 5862.9188; train_edge_recon_loss: 263307.6157; train_gene_expr_recon_loss: 69753.1834; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 338923.7174; train_optim_loss: 338923.7174; val_kl_reg_loss: 5698.5045; val_edge_recon_loss: 264238.9176; val_gene_expr_recon_loss: 68002.4962; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 337939.9197; val_optim_loss: 337939.9197
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9846; val_auprc_score: 0.9816; val_best_acc_score: 0.9429; val_best_f1_score: 0.9443; train_kl_reg_loss: 5816.3169; train_edge_recon_loss: 262400.4113; train_gene_expr_recon_loss: 67277.6255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 335494.3530; train_optim_loss: 335494.3530; val_kl_reg_loss: 5681.3492; val_edge_recon_loss: 263528.9130; val_gene_expr_recon_loss: 66367.4904; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335577.7519; val_optim_loss: 335577.7519
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9862; val_auprc_score: 0.9836; val_best_acc_score: 0.9479; val_best_f1_score: 0.9489; train_kl_reg_loss: 5800.2203; train_edge_recon_loss: 261942.8805; train_gene_expr_recon_loss: 66016.8177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333759.9185; train_optim_loss: 333759.9185; val_kl_reg_loss: 5679.5594; val_edge_recon_loss: 262915.1096; val_gene_expr_recon_loss: 65553.1844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334147.8534; val_optim_loss: 334147.8534
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9869; val_auprc_score: 0.9843; val_best_acc_score: 0.9497; val_best_f1_score: 0.9509; train_kl_reg_loss: 5782.3625; train_edge_recon_loss: 261454.8995; train_gene_expr_recon_loss: 65283.4137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332520.6756; train_optim_loss: 332520.6756; val_kl_reg_loss: 5697.5141; val_edge_recon_loss: 262787.8600; val_gene_expr_recon_loss: 64942.7310; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333428.1049; val_optim_loss: 333428.1049
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9881; val_auprc_score: 0.9859; val_best_acc_score: 0.9523; val_best_f1_score: 0.9533; train_kl_reg_loss: 5775.0469; train_edge_recon_loss: 261095.5290; train_gene_expr_recon_loss: 64821.7021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331692.2782; train_optim_loss: 331692.2782; val_kl_reg_loss: 5633.3232; val_edge_recon_loss: 262488.8013; val_gene_expr_recon_loss: 64557.6028; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332679.7271; val_optim_loss: 332679.7271
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9888; val_auprc_score: 0.9863; val_best_acc_score: 0.9549; val_best_f1_score: 0.9558; train_kl_reg_loss: 5768.5213; train_edge_recon_loss: 260954.4501; train_gene_expr_recon_loss: 64541.0461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331264.0179; train_optim_loss: 331264.0179; val_kl_reg_loss: 5665.1859; val_edge_recon_loss: 262177.8557; val_gene_expr_recon_loss: 64190.0643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332033.1070; val_optim_loss: 332033.1070
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9892; val_auprc_score: 0.9870; val_best_acc_score: 0.9557; val_best_f1_score: 0.9566; train_kl_reg_loss: 5763.0333; train_edge_recon_loss: 260745.5364; train_gene_expr_recon_loss: 64309.6773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330818.2469; train_optim_loss: 330818.2469; val_kl_reg_loss: 5655.8723; val_edge_recon_loss: 262325.9064; val_gene_expr_recon_loss: 64133.2935; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332115.0719; val_optim_loss: 332115.0719
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9888; val_auprc_score: 0.9864; val_best_acc_score: 0.9551; val_best_f1_score: 0.9560; train_kl_reg_loss: 5766.5424; train_edge_recon_loss: 260602.3277; train_gene_expr_recon_loss: 64133.1330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330502.0033; train_optim_loss: 330502.0033; val_kl_reg_loss: 5674.8336; val_edge_recon_loss: 261787.3293; val_gene_expr_recon_loss: 64082.6690; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331544.8333; val_optim_loss: 331544.8333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9892; val_auprc_score: 0.9864; val_best_acc_score: 0.9579; val_best_f1_score: 0.9586; train_kl_reg_loss: 5774.8863; train_edge_recon_loss: 260396.7971; train_gene_expr_recon_loss: 63999.3157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330170.9995; train_optim_loss: 330170.9995; val_kl_reg_loss: 5637.2869; val_edge_recon_loss: 261377.2936; val_gene_expr_recon_loss: 63970.4888; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330985.0698; val_optim_loss: 330985.0698
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9895; val_auprc_score: 0.9869; val_best_acc_score: 0.9582; val_best_f1_score: 0.9588; train_kl_reg_loss: 5768.7794; train_edge_recon_loss: 260304.9690; train_gene_expr_recon_loss: 63920.5504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329994.2990; train_optim_loss: 329994.2990; val_kl_reg_loss: 5731.8184; val_edge_recon_loss: 261580.5667; val_gene_expr_recon_loss: 63777.4377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331089.8223; val_optim_loss: 331089.8223
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9900; val_auprc_score: 0.9875; val_best_acc_score: 0.9594; val_best_f1_score: 0.9601; train_kl_reg_loss: 5775.3489; train_edge_recon_loss: 260263.3362; train_gene_expr_recon_loss: 63820.6008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329859.2858; train_optim_loss: 329859.2858; val_kl_reg_loss: 5656.2326; val_edge_recon_loss: 261664.3244; val_gene_expr_recon_loss: 63932.7403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331253.2952; val_optim_loss: 331253.2952
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9900; val_auprc_score: 0.9877; val_best_acc_score: 0.9588; val_best_f1_score: 0.9595; train_kl_reg_loss: 5780.8960; train_edge_recon_loss: 260150.4307; train_gene_expr_recon_loss: 63731.0585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329662.3857; train_optim_loss: 329662.3857; val_kl_reg_loss: 5711.6113; val_edge_recon_loss: 261416.0155; val_gene_expr_recon_loss: 63734.2287; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330861.8542; val_optim_loss: 330861.8542
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9896; val_auprc_score: 0.9869; val_best_acc_score: 0.9588; val_best_f1_score: 0.9595; train_kl_reg_loss: 5783.7220; train_edge_recon_loss: 260068.6481; train_gene_expr_recon_loss: 63644.1289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329496.4990; train_optim_loss: 329496.4990; val_kl_reg_loss: 5637.2298; val_edge_recon_loss: 261257.6839; val_gene_expr_recon_loss: 63654.2679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330549.1815; val_optim_loss: 330549.1815
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9902; val_auprc_score: 0.9880; val_best_acc_score: 0.9595; val_best_f1_score: 0.9603; train_kl_reg_loss: 5785.8743; train_edge_recon_loss: 260052.1834; train_gene_expr_recon_loss: 63609.5962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329447.6544; train_optim_loss: 329447.6544; val_kl_reg_loss: 5653.4039; val_edge_recon_loss: 261480.0341; val_gene_expr_recon_loss: 63593.1960; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330726.6331; val_optim_loss: 330726.6331
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9907; val_auprc_score: 0.9883; val_best_acc_score: 0.9610; val_best_f1_score: 0.9615; train_kl_reg_loss: 5788.0116; train_edge_recon_loss: 259983.1847; train_gene_expr_recon_loss: 63557.6878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329328.8836; train_optim_loss: 329328.8836; val_kl_reg_loss: 5711.4638; val_edge_recon_loss: 260908.5360; val_gene_expr_recon_loss: 63613.1798; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330233.1787; val_optim_loss: 330233.1787
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9909; val_auprc_score: 0.9887; val_best_acc_score: 0.9610; val_best_f1_score: 0.9616; train_kl_reg_loss: 5791.1625; train_edge_recon_loss: 259880.8403; train_gene_expr_recon_loss: 63491.8944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329163.8973; train_optim_loss: 329163.8973; val_kl_reg_loss: 5713.1644; val_edge_recon_loss: 261277.8997; val_gene_expr_recon_loss: 63536.7259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330527.7907; val_optim_loss: 330527.7907
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9911; val_auprc_score: 0.9888; val_best_acc_score: 0.9613; val_best_f1_score: 0.9620; train_kl_reg_loss: 5795.7560; train_edge_recon_loss: 259792.6405; train_gene_expr_recon_loss: 63467.9336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329056.3297; train_optim_loss: 329056.3297; val_kl_reg_loss: 5691.2061; val_edge_recon_loss: 260940.4347; val_gene_expr_recon_loss: 63449.7295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330081.3705; val_optim_loss: 330081.3705
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9911; val_auprc_score: 0.9890; val_best_acc_score: 0.9620; val_best_f1_score: 0.9626; train_kl_reg_loss: 5800.2217; train_edge_recon_loss: 259749.5908; train_gene_expr_recon_loss: 63456.6602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329006.4721; train_optim_loss: 329006.4721; val_kl_reg_loss: 5747.9875; val_edge_recon_loss: 260961.9893; val_gene_expr_recon_loss: 63439.9984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330149.9775; val_optim_loss: 330149.9775
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9912; val_auprc_score: 0.9891; val_best_acc_score: 0.9624; val_best_f1_score: 0.9631; train_kl_reg_loss: 5806.4881; train_edge_recon_loss: 259681.3479; train_gene_expr_recon_loss: 63401.6833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328889.5190; train_optim_loss: 328889.5190; val_kl_reg_loss: 5850.7475; val_edge_recon_loss: 260962.0327; val_gene_expr_recon_loss: 63349.9248; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330162.7059; val_optim_loss: 330162.7059
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9914; val_auprc_score: 0.9892; val_best_acc_score: 0.9629; val_best_f1_score: 0.9635; train_kl_reg_loss: 5804.9182; train_edge_recon_loss: 259738.8349; train_gene_expr_recon_loss: 63355.6412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328899.3945; train_optim_loss: 328899.3945; val_kl_reg_loss: 5775.3598; val_edge_recon_loss: 260687.2213; val_gene_expr_recon_loss: 63401.0648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329863.6464; val_optim_loss: 329863.6464
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9910; val_auprc_score: 0.9884; val_best_acc_score: 0.9628; val_best_f1_score: 0.9634; train_kl_reg_loss: 5812.4533; train_edge_recon_loss: 259589.9853; train_gene_expr_recon_loss: 63311.1349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328713.5732; train_optim_loss: 328713.5732; val_kl_reg_loss: 5684.4035; val_edge_recon_loss: 260944.0131; val_gene_expr_recon_loss: 63323.6882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329952.1053; val_optim_loss: 329952.1053
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9913; val_auprc_score: 0.9892; val_best_acc_score: 0.9632; val_best_f1_score: 0.9638; train_kl_reg_loss: 5814.7284; train_edge_recon_loss: 259581.7035; train_gene_expr_recon_loss: 63278.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328675.4042; train_optim_loss: 328675.4042; val_kl_reg_loss: 5733.8630; val_edge_recon_loss: 260620.4332; val_gene_expr_recon_loss: 63157.5373; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329511.8345; val_optim_loss: 329511.8345
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9915; val_auprc_score: 0.9892; val_best_acc_score: 0.9641; val_best_f1_score: 0.9647; train_kl_reg_loss: 5818.5887; train_edge_recon_loss: 259499.8665; train_gene_expr_recon_loss: 63253.8059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328572.2615; train_optim_loss: 328572.2615; val_kl_reg_loss: 5893.5915; val_edge_recon_loss: 260551.9837; val_gene_expr_recon_loss: 63248.8955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329694.4698; val_optim_loss: 329694.4698
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9906; val_auprc_score: 0.9880; val_best_acc_score: 0.9621; val_best_f1_score: 0.9626; train_kl_reg_loss: 5821.9761; train_edge_recon_loss: 259506.3986; train_gene_expr_recon_loss: 63211.9023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328540.2769; train_optim_loss: 328540.2769; val_kl_reg_loss: 5747.6353; val_edge_recon_loss: 260890.2317; val_gene_expr_recon_loss: 63366.4347; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330004.2999; val_optim_loss: 330004.2999
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9916; val_auprc_score: 0.9893; val_best_acc_score: 0.9648; val_best_f1_score: 0.9654; train_kl_reg_loss: 5825.8912; train_edge_recon_loss: 259410.0768; train_gene_expr_recon_loss: 63217.7122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328453.6795; train_optim_loss: 328453.6795; val_kl_reg_loss: 5685.0441; val_edge_recon_loss: 260446.1050; val_gene_expr_recon_loss: 63383.6031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329514.7521; val_optim_loss: 329514.7521
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9915; val_auprc_score: 0.9891; val_best_acc_score: 0.9644; val_best_f1_score: 0.9649; train_kl_reg_loss: 5821.4900; train_edge_recon_loss: 259461.6545; train_gene_expr_recon_loss: 63161.4389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328444.5833; train_optim_loss: 328444.5833; val_kl_reg_loss: 5693.6996; val_edge_recon_loss: 260228.7866; val_gene_expr_recon_loss: 63284.4573; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329206.9431; val_optim_loss: 329206.9431
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9913; val_auprc_score: 0.9890; val_best_acc_score: 0.9643; val_best_f1_score: 0.9649; train_kl_reg_loss: 5825.3467; train_edge_recon_loss: 259374.5050; train_gene_expr_recon_loss: 63188.0948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328387.9461; train_optim_loss: 328387.9461; val_kl_reg_loss: 5777.0561; val_edge_recon_loss: 260514.5499; val_gene_expr_recon_loss: 63219.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329511.3138; val_optim_loss: 329511.3138
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9912; val_auprc_score: 0.9889; val_best_acc_score: 0.9641; val_best_f1_score: 0.9646; train_kl_reg_loss: 5829.2656; train_edge_recon_loss: 259556.2466; train_gene_expr_recon_loss: 63161.8874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328547.4004; train_optim_loss: 328547.4004; val_kl_reg_loss: 5825.2407; val_edge_recon_loss: 260817.0593; val_gene_expr_recon_loss: 63250.8978; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329893.1982; val_optim_loss: 329893.1982
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9912; val_auprc_score: 0.9889; val_best_acc_score: 0.9635; val_best_f1_score: 0.9641; train_kl_reg_loss: 5832.0732; train_edge_recon_loss: 259410.3955; train_gene_expr_recon_loss: 63118.5359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328361.0045; train_optim_loss: 328361.0045; val_kl_reg_loss: 5723.8396; val_edge_recon_loss: 260492.0384; val_gene_expr_recon_loss: 63186.5432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329402.4223; val_optim_loss: 329402.4223
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9914; val_auprc_score: 0.9891; val_best_acc_score: 0.9640; val_best_f1_score: 0.9646; train_kl_reg_loss: 5833.2374; train_edge_recon_loss: 259337.6679; train_gene_expr_recon_loss: 63084.8609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328255.7662; train_optim_loss: 328255.7662; val_kl_reg_loss: 5741.2661; val_edge_recon_loss: 260417.7900; val_gene_expr_recon_loss: 63190.3793; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329349.4351; val_optim_loss: 329349.4351

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9924; val_auprc_score: 0.9903; val_best_acc_score: 0.9669; val_best_f1_score: 0.9674; train_kl_reg_loss: 5846.3686; train_edge_recon_loss: 259079.3786; train_gene_expr_recon_loss: 62691.6810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327617.4285; train_optim_loss: 327617.4285; val_kl_reg_loss: 5766.7152; val_edge_recon_loss: 260137.0007; val_gene_expr_recon_loss: 62800.3755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328704.0901; val_optim_loss: 328704.0901
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9925; val_auprc_score: 0.9904; val_best_acc_score: 0.9673; val_best_f1_score: 0.9677; train_kl_reg_loss: 5838.1561; train_edge_recon_loss: 259056.0304; train_gene_expr_recon_loss: 62629.1425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327523.3284; train_optim_loss: 327523.3284; val_kl_reg_loss: 5749.5608; val_edge_recon_loss: 260390.3490; val_gene_expr_recon_loss: 62833.4153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328973.3262; val_optim_loss: 328973.3262
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9924; val_auprc_score: 0.9899; val_best_acc_score: 0.9669; val_best_f1_score: 0.9674; train_kl_reg_loss: 5835.2236; train_edge_recon_loss: 259016.4207; train_gene_expr_recon_loss: 62599.7510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327451.3949; train_optim_loss: 327451.3949; val_kl_reg_loss: 5784.4438; val_edge_recon_loss: 260382.7190; val_gene_expr_recon_loss: 62800.9679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328968.1312; val_optim_loss: 328968.1312
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9923; val_auprc_score: 0.9902; val_best_acc_score: 0.9667; val_best_f1_score: 0.9672; train_kl_reg_loss: 5827.7483; train_edge_recon_loss: 259161.5273; train_gene_expr_recon_loss: 62581.6468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327570.9229; train_optim_loss: 327570.9229; val_kl_reg_loss: 5771.8588; val_edge_recon_loss: 260280.7432; val_gene_expr_recon_loss: 62764.1352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328816.7378; val_optim_loss: 328816.7378
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9925; val_auprc_score: 0.9907; val_best_acc_score: 0.9673; val_best_f1_score: 0.9677; train_kl_reg_loss: 5826.2966; train_edge_recon_loss: 259026.5536; train_gene_expr_recon_loss: 62539.0238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327391.8739; train_optim_loss: 327391.8739; val_kl_reg_loss: 5768.0932; val_edge_recon_loss: 260160.7594; val_gene_expr_recon_loss: 62766.9168; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328695.7699; val_optim_loss: 328695.7699
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9925; val_auprc_score: 0.9906; val_best_acc_score: 0.9674; val_best_f1_score: 0.9679; train_kl_reg_loss: 5822.7062; train_edge_recon_loss: 259051.7340; train_gene_expr_recon_loss: 62546.5982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327421.0382; train_optim_loss: 327421.0382; val_kl_reg_loss: 5743.9352; val_edge_recon_loss: 260153.9016; val_gene_expr_recon_loss: 62788.4513; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328686.2883; val_optim_loss: 328686.2883
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9927; val_auprc_score: 0.9908; val_best_acc_score: 0.9679; val_best_f1_score: 0.9684; train_kl_reg_loss: 5822.0249; train_edge_recon_loss: 259057.1362; train_gene_expr_recon_loss: 62556.1515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327435.3129; train_optim_loss: 327435.3129; val_kl_reg_loss: 5769.9184; val_edge_recon_loss: 259949.4729; val_gene_expr_recon_loss: 62727.8736; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328447.2667; val_optim_loss: 328447.2667
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9926; val_auprc_score: 0.9907; val_best_acc_score: 0.9675; val_best_f1_score: 0.9680; train_kl_reg_loss: 5824.9821; train_edge_recon_loss: 258994.8341; train_gene_expr_recon_loss: 62520.4946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327340.3113; train_optim_loss: 327340.3113; val_kl_reg_loss: 5758.9702; val_edge_recon_loss: 260062.6992; val_gene_expr_recon_loss: 62775.0785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328596.7455; val_optim_loss: 328596.7455
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9927; val_auprc_score: 0.9906; val_best_acc_score: 0.9680; val_best_f1_score: 0.9685; train_kl_reg_loss: 5824.9456; train_edge_recon_loss: 258912.4988; train_gene_expr_recon_loss: 62545.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327282.8446; train_optim_loss: 327282.8446; val_kl_reg_loss: 5755.6840; val_edge_recon_loss: 259988.8421; val_gene_expr_recon_loss: 62688.5062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328433.0319; val_optim_loss: 328433.0319
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9925; val_auprc_score: 0.9905; val_best_acc_score: 0.9674; val_best_f1_score: 0.9679; train_kl_reg_loss: 5822.9547; train_edge_recon_loss: 258938.8974; train_gene_expr_recon_loss: 62494.7423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327256.5942; train_optim_loss: 327256.5942; val_kl_reg_loss: 5744.6427; val_edge_recon_loss: 260171.9399; val_gene_expr_recon_loss: 62698.8229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328615.4060; val_optim_loss: 328615.4060
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9927; val_auprc_score: 0.9908; val_best_acc_score: 0.9677; val_best_f1_score: 0.9682; train_kl_reg_loss: 5818.3577; train_edge_recon_loss: 258973.3215; train_gene_expr_recon_loss: 62482.0029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327273.6821; train_optim_loss: 327273.6821; val_kl_reg_loss: 5750.8621; val_edge_recon_loss: 260003.3805; val_gene_expr_recon_loss: 62609.7946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328364.0377; val_optim_loss: 328364.0377
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9925; val_auprc_score: 0.9904; val_best_acc_score: 0.9674; val_best_f1_score: 0.9679; train_kl_reg_loss: 5816.6890; train_edge_recon_loss: 259022.0665; train_gene_expr_recon_loss: 62473.7542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327312.5102; train_optim_loss: 327312.5102; val_kl_reg_loss: 5779.3612; val_edge_recon_loss: 260174.1984; val_gene_expr_recon_loss: 62702.0437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328655.6023; val_optim_loss: 328655.6023
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9927; val_auprc_score: 0.9906; val_best_acc_score: 0.9681; val_best_f1_score: 0.9686; train_kl_reg_loss: 5818.4354; train_edge_recon_loss: 259005.4892; train_gene_expr_recon_loss: 62456.5120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327280.4365; train_optim_loss: 327280.4365; val_kl_reg_loss: 5720.0553; val_edge_recon_loss: 259884.3370; val_gene_expr_recon_loss: 62725.5381; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328329.9294; val_optim_loss: 328329.9294
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9928; val_auprc_score: 0.9909; val_best_acc_score: 0.9684; val_best_f1_score: 0.9689; train_kl_reg_loss: 5816.3971; train_edge_recon_loss: 258864.3028; train_gene_expr_recon_loss: 62463.0482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327143.7484; train_optim_loss: 327143.7484; val_kl_reg_loss: 5738.5035; val_edge_recon_loss: 259980.9187; val_gene_expr_recon_loss: 62571.8816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328291.3033; val_optim_loss: 328291.3033
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9931; val_auprc_score: 0.9912; val_best_acc_score: 0.9683; val_best_f1_score: 0.9688; train_kl_reg_loss: 5817.2661; train_edge_recon_loss: 259038.3617; train_gene_expr_recon_loss: 62454.9032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327310.5311; train_optim_loss: 327310.5311; val_kl_reg_loss: 5752.3292; val_edge_recon_loss: 259909.0004; val_gene_expr_recon_loss: 62636.8027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328298.1312; val_optim_loss: 328298.1312
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9929; val_auprc_score: 0.9911; val_best_acc_score: 0.9682; val_best_f1_score: 0.9687; train_kl_reg_loss: 5818.3887; train_edge_recon_loss: 258874.6961; train_gene_expr_recon_loss: 62419.5850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327112.6699; train_optim_loss: 327112.6699; val_kl_reg_loss: 5732.3331; val_edge_recon_loss: 259926.3254; val_gene_expr_recon_loss: 62557.1497; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328215.8084; val_optim_loss: 328215.8084
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9930; val_auprc_score: 0.9913; val_best_acc_score: 0.9684; val_best_f1_score: 0.9689; train_kl_reg_loss: 5809.1167; train_edge_recon_loss: 259066.4936; train_gene_expr_recon_loss: 62451.7442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327327.3541; train_optim_loss: 327327.3541; val_kl_reg_loss: 5757.2598; val_edge_recon_loss: 259923.1914; val_gene_expr_recon_loss: 62609.6645; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328290.1154; val_optim_loss: 328290.1154
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9927; val_auprc_score: 0.9906; val_best_acc_score: 0.9680; val_best_f1_score: 0.9685; train_kl_reg_loss: 5811.4780; train_edge_recon_loss: 258936.4829; train_gene_expr_recon_loss: 62443.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327191.8397; train_optim_loss: 327191.8397; val_kl_reg_loss: 5762.0972; val_edge_recon_loss: 260141.5307; val_gene_expr_recon_loss: 62681.5102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328585.1370; val_optim_loss: 328585.1370
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9925; val_auprc_score: 0.9903; val_best_acc_score: 0.9674; val_best_f1_score: 0.9679; train_kl_reg_loss: 5812.0024; train_edge_recon_loss: 258998.6220; train_gene_expr_recon_loss: 62447.9151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327258.5394; train_optim_loss: 327258.5394; val_kl_reg_loss: 5729.9500; val_edge_recon_loss: 260011.3538; val_gene_expr_recon_loss: 62588.9987; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328330.3037; val_optim_loss: 328330.3037
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9927; val_auprc_score: 0.9907; val_best_acc_score: 0.9674; val_best_f1_score: 0.9679; train_kl_reg_loss: 5814.3431; train_edge_recon_loss: 258919.6105; train_gene_expr_recon_loss: 62451.1251; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327185.0790; train_optim_loss: 327185.0790; val_kl_reg_loss: 5768.8499; val_edge_recon_loss: 260120.7507; val_gene_expr_recon_loss: 62669.5852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328559.1821; val_optim_loss: 328559.1821

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9926; val_auprc_score: 0.9909; val_best_acc_score: 0.9674; val_best_f1_score: 0.9680; train_kl_reg_loss: 5820.1104; train_edge_recon_loss: 258920.2799; train_gene_expr_recon_loss: 62383.7466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327124.1367; train_optim_loss: 327124.1367; val_kl_reg_loss: 5742.2856; val_edge_recon_loss: 260411.2482; val_gene_expr_recon_loss: 62508.5028; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328662.0375; val_optim_loss: 328662.0375
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9928; val_auprc_score: 0.9910; val_best_acc_score: 0.9688; val_best_f1_score: 0.9693; train_kl_reg_loss: 5816.1655; train_edge_recon_loss: 258872.8808; train_gene_expr_recon_loss: 62384.0901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327073.1366; train_optim_loss: 327073.1366; val_kl_reg_loss: 5749.1634; val_edge_recon_loss: 259912.9963; val_gene_expr_recon_loss: 62626.9307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328289.0890; val_optim_loss: 328289.0890
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9929; val_auprc_score: 0.9911; val_best_acc_score: 0.9686; val_best_f1_score: 0.9691; train_kl_reg_loss: 5814.3548; train_edge_recon_loss: 258896.9007; train_gene_expr_recon_loss: 62392.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327103.4558; train_optim_loss: 327103.4558; val_kl_reg_loss: 5743.3722; val_edge_recon_loss: 260009.5447; val_gene_expr_recon_loss: 62595.8054; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328348.7202; val_optim_loss: 328348.7202
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9927; val_auprc_score: 0.9907; val_best_acc_score: 0.9682; val_best_f1_score: 0.9686; train_kl_reg_loss: 5811.8469; train_edge_recon_loss: 258982.9759; train_gene_expr_recon_loss: 62376.1061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327170.9291; train_optim_loss: 327170.9291; val_kl_reg_loss: 5736.3431; val_edge_recon_loss: 260038.3261; val_gene_expr_recon_loss: 62522.6104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328297.2785; val_optim_loss: 328297.2785

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 276 min 15 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
Val AUROC score: 0.9925
Val AUPRC score: 0.9904
Val best accuracy score: 0.9677
Val best F1 score: 0.9682
Val gene expr MSE score: 1.5512

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
