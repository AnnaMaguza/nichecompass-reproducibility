None
Run timestamp: 01072023_124208_34.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_34']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9741; val_auprc_score: 0.9680; val_best_acc_score: 0.9244; val_best_f1_score: 0.9270; train_kl_reg_loss: 6094.9915; train_edge_recon_loss: 268685.2796; train_gene_expr_recon_loss: 79009.2994; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353789.5704; train_optim_loss: 353789.5704; val_kl_reg_loss: 5734.3004; val_edge_recon_loss: 264785.6511; val_gene_expr_recon_loss: 72908.5034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 343428.4551; val_optim_loss: 343428.4551
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9814; val_auprc_score: 0.9773; val_best_acc_score: 0.9377; val_best_f1_score: 0.9393; train_kl_reg_loss: 5895.7931; train_edge_recon_loss: 263240.1815; train_gene_expr_recon_loss: 70386.3842; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 339522.3592; train_optim_loss: 339522.3592; val_kl_reg_loss: 5698.9893; val_edge_recon_loss: 263900.4425; val_gene_expr_recon_loss: 69178.2162; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 338777.6464; val_optim_loss: 338777.6464
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9849; val_auprc_score: 0.9819; val_best_acc_score: 0.9451; val_best_f1_score: 0.9462; train_kl_reg_loss: 5870.7328; train_edge_recon_loss: 262429.5570; train_gene_expr_recon_loss: 67858.5221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 336158.8125; train_optim_loss: 336158.8125; val_kl_reg_loss: 5775.6545; val_edge_recon_loss: 263498.0538; val_gene_expr_recon_loss: 67304.1439; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 336577.8515; val_optim_loss: 336577.8515
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9869; val_auprc_score: 0.9843; val_best_acc_score: 0.9491; val_best_f1_score: 0.9500; train_kl_reg_loss: 5865.1374; train_edge_recon_loss: 261881.6017; train_gene_expr_recon_loss: 66551.6039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 334298.3432; train_optim_loss: 334298.3432; val_kl_reg_loss: 5724.2647; val_edge_recon_loss: 262956.6009; val_gene_expr_recon_loss: 66516.9385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335197.8044; val_optim_loss: 335197.8044
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9876; val_auprc_score: 0.9851; val_best_acc_score: 0.9516; val_best_f1_score: 0.9525; train_kl_reg_loss: 5870.5031; train_edge_recon_loss: 261466.2520; train_gene_expr_recon_loss: 65809.4745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333146.2297; train_optim_loss: 333146.2297; val_kl_reg_loss: 5891.6148; val_edge_recon_loss: 262728.2351; val_gene_expr_recon_loss: 65879.6949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334499.5452; val_optim_loss: 334499.5452
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9884; val_auprc_score: 0.9859; val_best_acc_score: 0.9538; val_best_f1_score: 0.9547; train_kl_reg_loss: 5867.5056; train_edge_recon_loss: 261154.7325; train_gene_expr_recon_loss: 65376.4612; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332398.6991; train_optim_loss: 332398.6991; val_kl_reg_loss: 5702.3166; val_edge_recon_loss: 262200.1807; val_gene_expr_recon_loss: 65646.8904; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333549.3868; val_optim_loss: 333549.3868
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9889; val_auprc_score: 0.9862; val_best_acc_score: 0.9556; val_best_f1_score: 0.9563; train_kl_reg_loss: 5863.6172; train_edge_recon_loss: 261036.3856; train_gene_expr_recon_loss: 65018.9293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331918.9322; train_optim_loss: 331918.9322; val_kl_reg_loss: 5799.7863; val_edge_recon_loss: 261899.6333; val_gene_expr_recon_loss: 65428.3115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333127.7312; val_optim_loss: 333127.7312
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9890; val_auprc_score: 0.9864; val_best_acc_score: 0.9573; val_best_f1_score: 0.9579; train_kl_reg_loss: 5869.6438; train_edge_recon_loss: 260680.3875; train_gene_expr_recon_loss: 64837.6367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331387.6675; train_optim_loss: 331387.6675; val_kl_reg_loss: 5856.8612; val_edge_recon_loss: 261676.2589; val_gene_expr_recon_loss: 65144.4459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332677.5664; val_optim_loss: 332677.5664
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9892; val_auprc_score: 0.9865; val_best_acc_score: 0.9572; val_best_f1_score: 0.9580; train_kl_reg_loss: 5871.0972; train_edge_recon_loss: 260655.3343; train_gene_expr_recon_loss: 64657.8792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331184.3110; train_optim_loss: 331184.3110; val_kl_reg_loss: 5708.3617; val_edge_recon_loss: 261542.5215; val_gene_expr_recon_loss: 65123.4415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332374.3253; val_optim_loss: 332374.3253
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9898; val_auprc_score: 0.9876; val_best_acc_score: 0.9582; val_best_f1_score: 0.9590; train_kl_reg_loss: 5875.0114; train_edge_recon_loss: 260473.5603; train_gene_expr_recon_loss: 64497.8234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330846.3957; train_optim_loss: 330846.3957; val_kl_reg_loss: 5868.9734; val_edge_recon_loss: 261626.8762; val_gene_expr_recon_loss: 64840.8035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332336.6530; val_optim_loss: 332336.6530
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9900; val_auprc_score: 0.9876; val_best_acc_score: 0.9590; val_best_f1_score: 0.9598; train_kl_reg_loss: 5872.0224; train_edge_recon_loss: 260403.5414; train_gene_expr_recon_loss: 64407.5767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330683.1401; train_optim_loss: 330683.1401; val_kl_reg_loss: 5866.1946; val_edge_recon_loss: 261602.8709; val_gene_expr_recon_loss: 64610.9138; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332079.9782; val_optim_loss: 332079.9782
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9904; val_auprc_score: 0.9881; val_best_acc_score: 0.9593; val_best_f1_score: 0.9601; train_kl_reg_loss: 5878.5787; train_edge_recon_loss: 260310.9785; train_gene_expr_recon_loss: 64364.0202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330553.5777; train_optim_loss: 330553.5777; val_kl_reg_loss: 5764.3756; val_edge_recon_loss: 261637.4304; val_gene_expr_recon_loss: 64873.7907; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332275.5961; val_optim_loss: 332275.5961
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9904; val_auprc_score: 0.9881; val_best_acc_score: 0.9601; val_best_f1_score: 0.9607; train_kl_reg_loss: 5881.1837; train_edge_recon_loss: 260306.8296; train_gene_expr_recon_loss: 64261.3177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330449.3307; train_optim_loss: 330449.3307; val_kl_reg_loss: 5637.4909; val_edge_recon_loss: 260915.2802; val_gene_expr_recon_loss: 64716.7417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331269.5124; val_optim_loss: 331269.5124
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9905; val_auprc_score: 0.9883; val_best_acc_score: 0.9602; val_best_f1_score: 0.9608; train_kl_reg_loss: 5884.7475; train_edge_recon_loss: 260149.4290; train_gene_expr_recon_loss: 64176.5897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330210.7659; train_optim_loss: 330210.7659; val_kl_reg_loss: 5905.3594; val_edge_recon_loss: 261266.6167; val_gene_expr_recon_loss: 64746.1132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331918.0901; val_optim_loss: 331918.0901
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9901; val_auprc_score: 0.9876; val_best_acc_score: 0.9605; val_best_f1_score: 0.9612; train_kl_reg_loss: 5897.9004; train_edge_recon_loss: 260049.9655; train_gene_expr_recon_loss: 64093.3501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330041.2156; train_optim_loss: 330041.2156; val_kl_reg_loss: 5839.7976; val_edge_recon_loss: 261119.7145; val_gene_expr_recon_loss: 64570.6232; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331530.1346; val_optim_loss: 331530.1346
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9905; val_auprc_score: 0.9883; val_best_acc_score: 0.9600; val_best_f1_score: 0.9606; train_kl_reg_loss: 5897.4011; train_edge_recon_loss: 259953.3456; train_gene_expr_recon_loss: 64093.1511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329943.8978; train_optim_loss: 329943.8978; val_kl_reg_loss: 5841.5455; val_edge_recon_loss: 261329.6446; val_gene_expr_recon_loss: 64584.7621; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331755.9531; val_optim_loss: 331755.9531
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9906; val_auprc_score: 0.9882; val_best_acc_score: 0.9615; val_best_f1_score: 0.9621; train_kl_reg_loss: 5901.6354; train_edge_recon_loss: 259885.4048; train_gene_expr_recon_loss: 64011.3118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329798.3522; train_optim_loss: 329798.3522; val_kl_reg_loss: 5750.0178; val_edge_recon_loss: 261048.7733; val_gene_expr_recon_loss: 64398.8171; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331197.6085; val_optim_loss: 331197.6085
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9908; val_auprc_score: 0.9885; val_best_acc_score: 0.9620; val_best_f1_score: 0.9626; train_kl_reg_loss: 5899.7324; train_edge_recon_loss: 259928.7415; train_gene_expr_recon_loss: 63972.6763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329801.1502; train_optim_loss: 329801.1502; val_kl_reg_loss: 5845.5131; val_edge_recon_loss: 260970.6079; val_gene_expr_recon_loss: 64382.6451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331198.7663; val_optim_loss: 331198.7663
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9908; val_auprc_score: 0.9885; val_best_acc_score: 0.9615; val_best_f1_score: 0.9620; train_kl_reg_loss: 5910.6454; train_edge_recon_loss: 259757.9643; train_gene_expr_recon_loss: 63919.3081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329587.9177; train_optim_loss: 329587.9177; val_kl_reg_loss: 5865.0359; val_edge_recon_loss: 261016.5747; val_gene_expr_recon_loss: 64360.2076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331241.8198; val_optim_loss: 331241.8198
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9908; val_auprc_score: 0.9884; val_best_acc_score: 0.9620; val_best_f1_score: 0.9626; train_kl_reg_loss: 5911.6959; train_edge_recon_loss: 259814.5459; train_gene_expr_recon_loss: 63898.4240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329624.6656; train_optim_loss: 329624.6656; val_kl_reg_loss: 5777.8161; val_edge_recon_loss: 261188.4120; val_gene_expr_recon_loss: 64412.0943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331378.3213; val_optim_loss: 331378.3213
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9914; val_auprc_score: 0.9891; val_best_acc_score: 0.9636; val_best_f1_score: 0.9641; train_kl_reg_loss: 5913.1827; train_edge_recon_loss: 259743.3641; train_gene_expr_recon_loss: 63820.3484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329476.8952; train_optim_loss: 329476.8952; val_kl_reg_loss: 5880.4321; val_edge_recon_loss: 260704.0432; val_gene_expr_recon_loss: 64304.2414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330888.7168; val_optim_loss: 330888.7168
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9914; val_auprc_score: 0.9891; val_best_acc_score: 0.9637; val_best_f1_score: 0.9642; train_kl_reg_loss: 5915.0094; train_edge_recon_loss: 259669.9345; train_gene_expr_recon_loss: 63786.1016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329371.0459; train_optim_loss: 329371.0459; val_kl_reg_loss: 5746.0346; val_edge_recon_loss: 260963.8438; val_gene_expr_recon_loss: 64358.3866; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331068.2646; val_optim_loss: 331068.2646
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9916; val_auprc_score: 0.9893; val_best_acc_score: 0.9647; val_best_f1_score: 0.9652; train_kl_reg_loss: 5920.2412; train_edge_recon_loss: 259595.9758; train_gene_expr_recon_loss: 63806.4931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329322.7098; train_optim_loss: 329322.7098; val_kl_reg_loss: 5965.0109; val_edge_recon_loss: 260488.7249; val_gene_expr_recon_loss: 64326.8833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330780.6203; val_optim_loss: 330780.6203
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9915; val_auprc_score: 0.9893; val_best_acc_score: 0.9634; val_best_f1_score: 0.9639; train_kl_reg_loss: 5922.9810; train_edge_recon_loss: 259566.2930; train_gene_expr_recon_loss: 63756.1201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329245.3943; train_optim_loss: 329245.3943; val_kl_reg_loss: 5663.7369; val_edge_recon_loss: 261043.6773; val_gene_expr_recon_loss: 64355.9199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331063.3343; val_optim_loss: 331063.3343
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9918; val_auprc_score: 0.9898; val_best_acc_score: 0.9642; val_best_f1_score: 0.9648; train_kl_reg_loss: 5925.9290; train_edge_recon_loss: 259525.0922; train_gene_expr_recon_loss: 63726.6446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329177.6654; train_optim_loss: 329177.6654; val_kl_reg_loss: 5755.2261; val_edge_recon_loss: 260667.4312; val_gene_expr_recon_loss: 64443.7668; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330866.4232; val_optim_loss: 330866.4232
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9922; val_auprc_score: 0.9902; val_best_acc_score: 0.9646; val_best_f1_score: 0.9652; train_kl_reg_loss: 5930.2016; train_edge_recon_loss: 259442.3419; train_gene_expr_recon_loss: 63701.5795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329074.1234; train_optim_loss: 329074.1234; val_kl_reg_loss: 5996.7594; val_edge_recon_loss: 260556.1379; val_gene_expr_recon_loss: 64173.3973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330726.2939; val_optim_loss: 330726.2939
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9918; val_auprc_score: 0.9897; val_best_acc_score: 0.9638; val_best_f1_score: 0.9645; train_kl_reg_loss: 5928.6631; train_edge_recon_loss: 259481.9109; train_gene_expr_recon_loss: 63695.9824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329106.5562; train_optim_loss: 329106.5562; val_kl_reg_loss: 5826.8488; val_edge_recon_loss: 260521.3414; val_gene_expr_recon_loss: 64359.4044; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330707.5950; val_optim_loss: 330707.5950
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9912; val_auprc_score: 0.9885; val_best_acc_score: 0.9640; val_best_f1_score: 0.9645; train_kl_reg_loss: 5928.9641; train_edge_recon_loss: 259470.8298; train_gene_expr_recon_loss: 63707.2476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329107.0418; train_optim_loss: 329107.0418; val_kl_reg_loss: 5799.8970; val_edge_recon_loss: 260817.0881; val_gene_expr_recon_loss: 64364.3904; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330981.3756; val_optim_loss: 330981.3756
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9915; val_auprc_score: 0.9893; val_best_acc_score: 0.9644; val_best_f1_score: 0.9650; train_kl_reg_loss: 5933.8869; train_edge_recon_loss: 259391.3578; train_gene_expr_recon_loss: 63650.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328975.9700; train_optim_loss: 328975.9700; val_kl_reg_loss: 5768.9494; val_edge_recon_loss: 260351.4052; val_gene_expr_recon_loss: 64195.2696; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330315.6229; val_optim_loss: 330315.6229
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9923; val_auprc_score: 0.9903; val_best_acc_score: 0.9660; val_best_f1_score: 0.9665; train_kl_reg_loss: 5927.7873; train_edge_recon_loss: 259504.5807; train_gene_expr_recon_loss: 63647.3782; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329079.7467; train_optim_loss: 329079.7467; val_kl_reg_loss: 5812.4425; val_edge_recon_loss: 260512.8948; val_gene_expr_recon_loss: 64207.5612; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330532.8970; val_optim_loss: 330532.8970
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9919; val_auprc_score: 0.9898; val_best_acc_score: 0.9664; val_best_f1_score: 0.9669; train_kl_reg_loss: 5931.0722; train_edge_recon_loss: 259362.4672; train_gene_expr_recon_loss: 63626.5285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328920.0680; train_optim_loss: 328920.0680; val_kl_reg_loss: 5877.3963; val_edge_recon_loss: 260448.9020; val_gene_expr_recon_loss: 64282.2896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330608.5871; val_optim_loss: 330608.5871
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9919; val_auprc_score: 0.9895; val_best_acc_score: 0.9653; val_best_f1_score: 0.9658; train_kl_reg_loss: 5932.8480; train_edge_recon_loss: 259364.7703; train_gene_expr_recon_loss: 63623.3517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328920.9695; train_optim_loss: 328920.9695; val_kl_reg_loss: 5873.5727; val_edge_recon_loss: 260219.7410; val_gene_expr_recon_loss: 64115.0688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330208.3823; val_optim_loss: 330208.3823
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9924; val_auprc_score: 0.9904; val_best_acc_score: 0.9665; val_best_f1_score: 0.9669; train_kl_reg_loss: 5938.7247; train_edge_recon_loss: 259319.9597; train_gene_expr_recon_loss: 63603.2107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328861.8945; train_optim_loss: 328861.8945; val_kl_reg_loss: 5882.0332; val_edge_recon_loss: 260606.8257; val_gene_expr_recon_loss: 64260.3974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330749.2575; val_optim_loss: 330749.2575
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9921; val_auprc_score: 0.9897; val_best_acc_score: 0.9667; val_best_f1_score: 0.9672; train_kl_reg_loss: 5936.3411; train_edge_recon_loss: 259284.9048; train_gene_expr_recon_loss: 63599.0545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328820.3009; train_optim_loss: 328820.3009; val_kl_reg_loss: 5910.8643; val_edge_recon_loss: 260257.1550; val_gene_expr_recon_loss: 64195.1129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330363.1306; val_optim_loss: 330363.1306
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9921; val_auprc_score: 0.9894; val_best_acc_score: 0.9664; val_best_f1_score: 0.9669; train_kl_reg_loss: 5941.9008; train_edge_recon_loss: 259232.1124; train_gene_expr_recon_loss: 63552.5851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328726.5989; train_optim_loss: 328726.5989; val_kl_reg_loss: 5896.8683; val_edge_recon_loss: 260145.2228; val_gene_expr_recon_loss: 64047.1960; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330089.2879; val_optim_loss: 330089.2879
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9922; val_auprc_score: 0.9900; val_best_acc_score: 0.9667; val_best_f1_score: 0.9672; train_kl_reg_loss: 5939.3987; train_edge_recon_loss: 259179.9279; train_gene_expr_recon_loss: 63571.7043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328691.0307; train_optim_loss: 328691.0307; val_kl_reg_loss: 5863.1965; val_edge_recon_loss: 260165.6545; val_gene_expr_recon_loss: 64106.7751; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330135.6267; val_optim_loss: 330135.6267
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9918; val_auprc_score: 0.9896; val_best_acc_score: 0.9653; val_best_f1_score: 0.9659; train_kl_reg_loss: 5943.0452; train_edge_recon_loss: 259304.4912; train_gene_expr_recon_loss: 63555.3577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328802.8938; train_optim_loss: 328802.8938; val_kl_reg_loss: 5759.2556; val_edge_recon_loss: 260369.9201; val_gene_expr_recon_loss: 64154.9312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330284.1049; val_optim_loss: 330284.1049
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9922; val_auprc_score: 0.9902; val_best_acc_score: 0.9668; val_best_f1_score: 0.9673; train_kl_reg_loss: 5945.8775; train_edge_recon_loss: 259201.0819; train_gene_expr_recon_loss: 63539.8341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328686.7932; train_optim_loss: 328686.7932; val_kl_reg_loss: 5900.0334; val_edge_recon_loss: 260367.1292; val_gene_expr_recon_loss: 64257.8732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330525.0345; val_optim_loss: 330525.0345
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9923; val_auprc_score: 0.9904; val_best_acc_score: 0.9666; val_best_f1_score: 0.9671; train_kl_reg_loss: 5943.2613; train_edge_recon_loss: 259223.9138; train_gene_expr_recon_loss: 63524.2463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328691.4213; train_optim_loss: 328691.4213; val_kl_reg_loss: 5838.0899; val_edge_recon_loss: 260429.1895; val_gene_expr_recon_loss: 64360.0281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330627.3071; val_optim_loss: 330627.3071

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9927; val_auprc_score: 0.9906; val_best_acc_score: 0.9681; val_best_f1_score: 0.9685; train_kl_reg_loss: 5968.7598; train_edge_recon_loss: 258988.7158; train_gene_expr_recon_loss: 63029.5285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327987.0039; train_optim_loss: 327987.0039; val_kl_reg_loss: 5886.7904; val_edge_recon_loss: 260010.0986; val_gene_expr_recon_loss: 63728.1804; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329625.0698; val_optim_loss: 329625.0698
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9927; val_auprc_score: 0.9906; val_best_acc_score: 0.9687; val_best_f1_score: 0.9692; train_kl_reg_loss: 5963.4244; train_edge_recon_loss: 258923.6014; train_gene_expr_recon_loss: 62984.1176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327871.1433; train_optim_loss: 327871.1433; val_kl_reg_loss: 5903.0445; val_edge_recon_loss: 259750.8217; val_gene_expr_recon_loss: 63729.1523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329383.0186; val_optim_loss: 329383.0186
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9928; val_auprc_score: 0.9909; val_best_acc_score: 0.9687; val_best_f1_score: 0.9692; train_kl_reg_loss: 5956.0499; train_edge_recon_loss: 258955.5533; train_gene_expr_recon_loss: 62922.8294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327834.4318; train_optim_loss: 327834.4318; val_kl_reg_loss: 5904.8733; val_edge_recon_loss: 260025.6651; val_gene_expr_recon_loss: 63707.8375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329638.3744; val_optim_loss: 329638.3744
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9929; val_auprc_score: 0.9911; val_best_acc_score: 0.9686; val_best_f1_score: 0.9690; train_kl_reg_loss: 5954.5550; train_edge_recon_loss: 258940.8286; train_gene_expr_recon_loss: 62926.0766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327821.4595; train_optim_loss: 327821.4595; val_kl_reg_loss: 5876.4804; val_edge_recon_loss: 259794.3767; val_gene_expr_recon_loss: 63612.6239; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329283.4810; val_optim_loss: 329283.4810
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9924; val_auprc_score: 0.9900; val_best_acc_score: 0.9678; val_best_f1_score: 0.9684; train_kl_reg_loss: 5954.3628; train_edge_recon_loss: 258854.2960; train_gene_expr_recon_loss: 62882.1951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327690.8538; train_optim_loss: 327690.8538; val_kl_reg_loss: 5917.7013; val_edge_recon_loss: 260158.0178; val_gene_expr_recon_loss: 63532.5177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329608.2352; val_optim_loss: 329608.2352
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9931; val_auprc_score: 0.9913; val_best_acc_score: 0.9689; val_best_f1_score: 0.9693; train_kl_reg_loss: 5950.2612; train_edge_recon_loss: 258857.9630; train_gene_expr_recon_loss: 62908.6063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327716.8303; train_optim_loss: 327716.8303; val_kl_reg_loss: 5899.7777; val_edge_recon_loss: 259518.8413; val_gene_expr_recon_loss: 63564.4147; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328983.0347; val_optim_loss: 328983.0347
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9926; val_auprc_score: 0.9907; val_best_acc_score: 0.9680; val_best_f1_score: 0.9685; train_kl_reg_loss: 5949.5296; train_edge_recon_loss: 258947.2994; train_gene_expr_recon_loss: 62905.4350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327802.2639; train_optim_loss: 327802.2639; val_kl_reg_loss: 5900.5428; val_edge_recon_loss: 260267.2227; val_gene_expr_recon_loss: 63538.8604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329706.6254; val_optim_loss: 329706.6254
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9930; val_auprc_score: 0.9911; val_best_acc_score: 0.9691; val_best_f1_score: 0.9695; train_kl_reg_loss: 5946.8527; train_edge_recon_loss: 258951.1402; train_gene_expr_recon_loss: 62883.3210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327781.3137; train_optim_loss: 327781.3137; val_kl_reg_loss: 5877.0230; val_edge_recon_loss: 259888.2559; val_gene_expr_recon_loss: 63618.2527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329383.5317; val_optim_loss: 329383.5317
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9927; val_auprc_score: 0.9907; val_best_acc_score: 0.9683; val_best_f1_score: 0.9689; train_kl_reg_loss: 5950.2939; train_edge_recon_loss: 258843.6501; train_gene_expr_recon_loss: 62887.3423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327681.2869; train_optim_loss: 327681.2869; val_kl_reg_loss: 5888.4732; val_edge_recon_loss: 259844.8489; val_gene_expr_recon_loss: 63605.4206; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329338.7434; val_optim_loss: 329338.7434
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9929; val_auprc_score: 0.9910; val_best_acc_score: 0.9689; val_best_f1_score: 0.9694; train_kl_reg_loss: 5943.7948; train_edge_recon_loss: 258900.5244; train_gene_expr_recon_loss: 62887.8412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327732.1602; train_optim_loss: 327732.1602; val_kl_reg_loss: 5887.3313; val_edge_recon_loss: 260047.5098; val_gene_expr_recon_loss: 63570.6141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329505.4540; val_optim_loss: 329505.4540

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9926; val_auprc_score: 0.9905; val_best_acc_score: 0.9685; val_best_f1_score: 0.9690; train_kl_reg_loss: 5949.1457; train_edge_recon_loss: 258771.3584; train_gene_expr_recon_loss: 62811.5709; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327532.0752; train_optim_loss: 327532.0752; val_kl_reg_loss: 5896.1152; val_edge_recon_loss: 260070.8856; val_gene_expr_recon_loss: 63536.4819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329503.4824; val_optim_loss: 329503.4824
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9930; val_auprc_score: 0.9912; val_best_acc_score: 0.9693; val_best_f1_score: 0.9697; train_kl_reg_loss: 5946.8030; train_edge_recon_loss: 258834.8592; train_gene_expr_recon_loss: 62803.8969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327585.5591; train_optim_loss: 327585.5591; val_kl_reg_loss: 5886.1293; val_edge_recon_loss: 259843.4119; val_gene_expr_recon_loss: 63487.0572; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329216.5980; val_optim_loss: 329216.5980
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9931; val_auprc_score: 0.9914; val_best_acc_score: 0.9691; val_best_f1_score: 0.9695; train_kl_reg_loss: 5949.2462; train_edge_recon_loss: 258881.3165; train_gene_expr_recon_loss: 62809.1964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327639.7587; train_optim_loss: 327639.7587; val_kl_reg_loss: 5898.7543; val_edge_recon_loss: 259843.7661; val_gene_expr_recon_loss: 63445.8387; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329188.3581; val_optim_loss: 329188.3581
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9927; val_auprc_score: 0.9905; val_best_acc_score: 0.9687; val_best_f1_score: 0.9690; train_kl_reg_loss: 5951.6380; train_edge_recon_loss: 258742.5299; train_gene_expr_recon_loss: 62811.5879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327505.7556; train_optim_loss: 327505.7556; val_kl_reg_loss: 5894.6403; val_edge_recon_loss: 259969.4728; val_gene_expr_recon_loss: 63508.3729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329372.4859; val_optim_loss: 329372.4859

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 279 min 41 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
Val AUROC score: 0.9930
Val AUPRC score: 0.9910
Val best accuracy score: 0.9686
Val best F1 score: 0.9689
Val gene expr MSE score: 1.5670

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
