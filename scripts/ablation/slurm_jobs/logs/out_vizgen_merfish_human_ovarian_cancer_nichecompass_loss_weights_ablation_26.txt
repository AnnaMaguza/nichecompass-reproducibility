None
Run timestamp: 05072023_065932_26.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_26']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9879; val_auprc_score: 0.9868; val_best_acc_score: 0.9451; val_best_f1_score: 0.9454; train_kl_reg_loss: 5586.3284; train_edge_recon_loss: 264343.3038; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269929.6323; train_optim_loss: 269929.6323; val_kl_reg_loss: 5587.5555; val_edge_recon_loss: 261493.8323; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267081.3883; val_optim_loss: 267081.3883
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9906; val_auprc_score: 0.9897; val_best_acc_score: 0.9542; val_best_f1_score: 0.9544; train_kl_reg_loss: 5538.2034; train_edge_recon_loss: 260698.6089; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266236.8125; train_optim_loss: 266236.8125; val_kl_reg_loss: 5394.4574; val_edge_recon_loss: 260839.2936; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 266233.7505; val_optim_loss: 266233.7505
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9919; val_auprc_score: 0.9907; val_best_acc_score: 0.9586; val_best_f1_score: 0.9588; train_kl_reg_loss: 5523.8362; train_edge_recon_loss: 260049.6035; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265573.4395; train_optim_loss: 265573.4395; val_kl_reg_loss: 5501.6272; val_edge_recon_loss: 260782.0057; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 266283.6339; val_optim_loss: 266283.6339
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9935; val_auprc_score: 0.9925; val_best_acc_score: 0.9634; val_best_f1_score: 0.9637; train_kl_reg_loss: 5522.3453; train_edge_recon_loss: 259591.8930; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265114.2385; train_optim_loss: 265114.2385; val_kl_reg_loss: 5552.7856; val_edge_recon_loss: 260277.4688; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265830.2543; val_optim_loss: 265830.2543
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9941; val_auprc_score: 0.9934; val_best_acc_score: 0.9651; val_best_f1_score: 0.9653; train_kl_reg_loss: 5522.1937; train_edge_recon_loss: 259389.4196; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264911.6134; train_optim_loss: 264911.6134; val_kl_reg_loss: 5478.0053; val_edge_recon_loss: 259909.6271; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265387.6325; val_optim_loss: 265387.6325
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9943; val_auprc_score: 0.9933; val_best_acc_score: 0.9668; val_best_f1_score: 0.9670; train_kl_reg_loss: 5526.2893; train_edge_recon_loss: 259171.3604; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264697.6495; train_optim_loss: 264697.6495; val_kl_reg_loss: 5714.8936; val_edge_recon_loss: 259581.3112; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265296.2050; val_optim_loss: 265296.2050
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9941; val_auprc_score: 0.9932; val_best_acc_score: 0.9662; val_best_f1_score: 0.9663; train_kl_reg_loss: 5524.6098; train_edge_recon_loss: 259075.3585; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264599.9683; train_optim_loss: 264599.9683; val_kl_reg_loss: 5481.5793; val_edge_recon_loss: 259520.9788; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265002.5581; val_optim_loss: 265002.5581
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9949; val_auprc_score: 0.9942; val_best_acc_score: 0.9691; val_best_f1_score: 0.9692; train_kl_reg_loss: 5527.2909; train_edge_recon_loss: 258910.2048; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264437.4956; train_optim_loss: 264437.4956; val_kl_reg_loss: 5573.4308; val_edge_recon_loss: 259537.7760; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265111.2063; val_optim_loss: 265111.2063
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9956; val_auprc_score: 0.9949; val_best_acc_score: 0.9712; val_best_f1_score: 0.9714; train_kl_reg_loss: 5525.5703; train_edge_recon_loss: 258884.1480; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264409.7184; train_optim_loss: 264409.7184; val_kl_reg_loss: 5420.0139; val_edge_recon_loss: 259494.5811; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264914.5954; val_optim_loss: 264914.5954
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9951; val_auprc_score: 0.9943; val_best_acc_score: 0.9697; val_best_f1_score: 0.9699; train_kl_reg_loss: 5524.8261; train_edge_recon_loss: 258752.4532; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264277.2794; train_optim_loss: 264277.2794; val_kl_reg_loss: 5495.2818; val_edge_recon_loss: 259416.8114; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264912.0924; val_optim_loss: 264912.0924
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9956; val_auprc_score: 0.9949; val_best_acc_score: 0.9714; val_best_f1_score: 0.9715; train_kl_reg_loss: 5522.2940; train_edge_recon_loss: 258654.3147; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264176.6087; train_optim_loss: 264176.6087; val_kl_reg_loss: 5379.4133; val_edge_recon_loss: 259040.0756; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264419.4887; val_optim_loss: 264419.4887
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9955; val_auprc_score: 0.9947; val_best_acc_score: 0.9717; val_best_f1_score: 0.9719; train_kl_reg_loss: 5523.0131; train_edge_recon_loss: 258602.1260; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264125.1392; train_optim_loss: 264125.1392; val_kl_reg_loss: 5385.3054; val_edge_recon_loss: 258892.0290; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264277.3347; val_optim_loss: 264277.3347
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9961; val_auprc_score: 0.9956; val_best_acc_score: 0.9732; val_best_f1_score: 0.9733; train_kl_reg_loss: 5520.7750; train_edge_recon_loss: 258585.8388; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264106.6139; train_optim_loss: 264106.6139; val_kl_reg_loss: 5532.5358; val_edge_recon_loss: 258798.6586; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264331.1940; val_optim_loss: 264331.1940
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9961; val_auprc_score: 0.9953; val_best_acc_score: 0.9744; val_best_f1_score: 0.9745; train_kl_reg_loss: 5525.0799; train_edge_recon_loss: 258419.9854; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263945.0653; train_optim_loss: 263945.0653; val_kl_reg_loss: 5489.6129; val_edge_recon_loss: 258676.0800; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264165.6934; val_optim_loss: 264165.6934
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9963; val_auprc_score: 0.9958; val_best_acc_score: 0.9740; val_best_f1_score: 0.9741; train_kl_reg_loss: 5525.7551; train_edge_recon_loss: 258291.5309; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263817.2859; train_optim_loss: 263817.2859; val_kl_reg_loss: 5469.2625; val_edge_recon_loss: 258765.3191; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264234.5811; val_optim_loss: 264234.5811
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9961; val_auprc_score: 0.9954; val_best_acc_score: 0.9739; val_best_f1_score: 0.9740; train_kl_reg_loss: 5524.0900; train_edge_recon_loss: 258356.4111; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263880.5015; train_optim_loss: 263880.5015; val_kl_reg_loss: 5293.9211; val_edge_recon_loss: 258806.7856; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264100.7063; val_optim_loss: 264100.7063
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9962; val_auprc_score: 0.9953; val_best_acc_score: 0.9747; val_best_f1_score: 0.9748; train_kl_reg_loss: 5524.3487; train_edge_recon_loss: 258249.5792; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263773.9280; train_optim_loss: 263773.9280; val_kl_reg_loss: 5437.2706; val_edge_recon_loss: 258673.0312; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264110.3021; val_optim_loss: 264110.3021
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9960; val_auprc_score: 0.9952; val_best_acc_score: 0.9749; val_best_f1_score: 0.9749; train_kl_reg_loss: 5525.0291; train_edge_recon_loss: 258272.2090; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263797.2380; train_optim_loss: 263797.2380; val_kl_reg_loss: 5290.4633; val_edge_recon_loss: 258518.4525; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263808.9156; val_optim_loss: 263808.9156
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9965; val_auprc_score: 0.9959; val_best_acc_score: 0.9758; val_best_f1_score: 0.9759; train_kl_reg_loss: 5524.2700; train_edge_recon_loss: 258198.1365; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263722.4067; train_optim_loss: 263722.4067; val_kl_reg_loss: 5394.5904; val_edge_recon_loss: 258416.2829; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263810.8738; val_optim_loss: 263810.8738
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9966; val_auprc_score: 0.9960; val_best_acc_score: 0.9751; val_best_f1_score: 0.9752; train_kl_reg_loss: 5523.1324; train_edge_recon_loss: 258162.1884; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263685.3210; train_optim_loss: 263685.3210; val_kl_reg_loss: 5406.3531; val_edge_recon_loss: 258480.7766; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263887.1302; val_optim_loss: 263887.1302
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9965; val_auprc_score: 0.9959; val_best_acc_score: 0.9751; val_best_f1_score: 0.9752; train_kl_reg_loss: 5523.4134; train_edge_recon_loss: 258061.1099; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263584.5235; train_optim_loss: 263584.5235; val_kl_reg_loss: 5604.1605; val_edge_recon_loss: 258394.4682; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263998.6291; val_optim_loss: 263998.6291
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9964; val_auprc_score: 0.9958; val_best_acc_score: 0.9747; val_best_f1_score: 0.9748; train_kl_reg_loss: 5520.9781; train_edge_recon_loss: 258095.3516; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263616.3300; train_optim_loss: 263616.3300; val_kl_reg_loss: 5317.9595; val_edge_recon_loss: 258483.7400; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263801.6998; val_optim_loss: 263801.6998
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9966; val_auprc_score: 0.9959; val_best_acc_score: 0.9767; val_best_f1_score: 0.9768; train_kl_reg_loss: 5522.4702; train_edge_recon_loss: 258007.4458; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263529.9162; train_optim_loss: 263529.9162; val_kl_reg_loss: 5489.0591; val_edge_recon_loss: 258236.8721; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263725.9313; val_optim_loss: 263725.9313
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9965; val_auprc_score: 0.9956; val_best_acc_score: 0.9765; val_best_f1_score: 0.9766; train_kl_reg_loss: 5524.4369; train_edge_recon_loss: 257940.9589; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263465.3958; train_optim_loss: 263465.3958; val_kl_reg_loss: 5523.4791; val_edge_recon_loss: 258149.3725; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263672.8514; val_optim_loss: 263672.8514
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9968; val_auprc_score: 0.9962; val_best_acc_score: 0.9772; val_best_f1_score: 0.9773; train_kl_reg_loss: 5523.0465; train_edge_recon_loss: 257936.7454; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263459.7918; train_optim_loss: 263459.7918; val_kl_reg_loss: 5372.4718; val_edge_recon_loss: 257980.9986; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263353.4701; val_optim_loss: 263353.4701
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9968; val_auprc_score: 0.9961; val_best_acc_score: 0.9776; val_best_f1_score: 0.9777; train_kl_reg_loss: 5525.2113; train_edge_recon_loss: 257927.5451; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263452.7565; train_optim_loss: 263452.7565; val_kl_reg_loss: 5497.1175; val_edge_recon_loss: 258193.9126; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263691.0304; val_optim_loss: 263691.0304
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9968; val_auprc_score: 0.9962; val_best_acc_score: 0.9773; val_best_f1_score: 0.9774; train_kl_reg_loss: 5525.8646; train_edge_recon_loss: 257902.0182; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263427.8823; train_optim_loss: 263427.8823; val_kl_reg_loss: 5468.1345; val_edge_recon_loss: 258094.5420; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263562.6775; val_optim_loss: 263562.6775
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9969; val_auprc_score: 0.9964; val_best_acc_score: 0.9770; val_best_f1_score: 0.9771; train_kl_reg_loss: 5527.1406; train_edge_recon_loss: 257771.8972; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263299.0378; train_optim_loss: 263299.0378; val_kl_reg_loss: 5441.9753; val_edge_recon_loss: 257960.4701; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263402.4449; val_optim_loss: 263402.4449
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9968; val_auprc_score: 0.9963; val_best_acc_score: 0.9780; val_best_f1_score: 0.9781; train_kl_reg_loss: 5527.7348; train_edge_recon_loss: 257796.9778; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263324.7128; train_optim_loss: 263324.7128; val_kl_reg_loss: 5485.2893; val_edge_recon_loss: 257982.8900; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263468.1799; val_optim_loss: 263468.1799

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9972; val_auprc_score: 0.9967; val_best_acc_score: 0.9793; val_best_f1_score: 0.9794; train_kl_reg_loss: 5505.3350; train_edge_recon_loss: 257521.2885; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263026.6239; train_optim_loss: 263026.6239; val_kl_reg_loss: 5489.1733; val_edge_recon_loss: 257526.1036; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263015.2776; val_optim_loss: 263015.2776
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9973; val_auprc_score: 0.9967; val_best_acc_score: 0.9795; val_best_f1_score: 0.9795; train_kl_reg_loss: 5499.7245; train_edge_recon_loss: 257407.0834; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262906.8079; train_optim_loss: 262906.8079; val_kl_reg_loss: 5484.5505; val_edge_recon_loss: 257446.2436; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262930.7949; val_optim_loss: 262930.7949
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9974; val_auprc_score: 0.9969; val_best_acc_score: 0.9802; val_best_f1_score: 0.9802; train_kl_reg_loss: 5497.9236; train_edge_recon_loss: 257370.6643; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262868.5880; train_optim_loss: 262868.5880; val_kl_reg_loss: 5457.5249; val_edge_recon_loss: 257477.8649; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262935.3898; val_optim_loss: 262935.3898
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9973; val_auprc_score: 0.9968; val_best_acc_score: 0.9796; val_best_f1_score: 0.9797; train_kl_reg_loss: 5496.3781; train_edge_recon_loss: 257363.2678; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262859.6460; train_optim_loss: 262859.6460; val_kl_reg_loss: 5481.4702; val_edge_recon_loss: 257514.2641; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262995.7344; val_optim_loss: 262995.7344
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9974; val_auprc_score: 0.9970; val_best_acc_score: 0.9801; val_best_f1_score: 0.9801; train_kl_reg_loss: 5492.0346; train_edge_recon_loss: 257411.8606; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262903.8951; train_optim_loss: 262903.8951; val_kl_reg_loss: 5420.4516; val_edge_recon_loss: 257352.4933; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262772.9453; val_optim_loss: 262772.9453
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9975; val_auprc_score: 0.9969; val_best_acc_score: 0.9804; val_best_f1_score: 0.9805; train_kl_reg_loss: 5485.9118; train_edge_recon_loss: 257420.8137; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262906.7256; train_optim_loss: 262906.7256; val_kl_reg_loss: 5508.4730; val_edge_recon_loss: 257350.8634; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262859.3369; val_optim_loss: 262859.3369
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9976; val_auprc_score: 0.9971; val_best_acc_score: 0.9807; val_best_f1_score: 0.9808; train_kl_reg_loss: 5489.8847; train_edge_recon_loss: 257330.3036; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262820.1883; train_optim_loss: 262820.1883; val_kl_reg_loss: 5492.1885; val_edge_recon_loss: 257467.4782; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262959.6667; val_optim_loss: 262959.6667
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9975; val_auprc_score: 0.9971; val_best_acc_score: 0.9803; val_best_f1_score: 0.9803; train_kl_reg_loss: 5485.8341; train_edge_recon_loss: 257348.1015; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262833.9359; train_optim_loss: 262833.9359; val_kl_reg_loss: 5467.8682; val_edge_recon_loss: 257359.0766; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262826.9456; val_optim_loss: 262826.9456
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9974; val_auprc_score: 0.9969; val_best_acc_score: 0.9802; val_best_f1_score: 0.9803; train_kl_reg_loss: 5484.8396; train_edge_recon_loss: 257332.5356; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262817.3753; train_optim_loss: 262817.3753; val_kl_reg_loss: 5480.8395; val_edge_recon_loss: 257528.3866; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263009.2256; val_optim_loss: 263009.2256

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9975; val_auprc_score: 0.9970; val_best_acc_score: 0.9806; val_best_f1_score: 0.9807; train_kl_reg_loss: 5486.3068; train_edge_recon_loss: 257310.8749; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262797.1815; train_optim_loss: 262797.1815; val_kl_reg_loss: 5462.5824; val_edge_recon_loss: 257320.1243; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262782.7058; val_optim_loss: 262782.7058
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9976; val_auprc_score: 0.9970; val_best_acc_score: 0.9808; val_best_f1_score: 0.9809; train_kl_reg_loss: 5486.8064; train_edge_recon_loss: 257284.0517; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262770.8582; train_optim_loss: 262770.8582; val_kl_reg_loss: 5482.9236; val_edge_recon_loss: 257204.5189; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262687.4418; val_optim_loss: 262687.4418
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9975; val_auprc_score: 0.9969; val_best_acc_score: 0.9802; val_best_f1_score: 0.9803; train_kl_reg_loss: 5484.3768; train_edge_recon_loss: 257303.9381; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262788.3148; train_optim_loss: 262788.3148; val_kl_reg_loss: 5449.5323; val_edge_recon_loss: 257418.8804; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262868.4129; val_optim_loss: 262868.4129
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9974; val_auprc_score: 0.9968; val_best_acc_score: 0.9802; val_best_f1_score: 0.9803; train_kl_reg_loss: 5483.0504; train_edge_recon_loss: 257327.7551; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262810.8057; train_optim_loss: 262810.8057; val_kl_reg_loss: 5455.3978; val_edge_recon_loss: 257455.7535; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262911.1521; val_optim_loss: 262911.1521
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9974; val_auprc_score: 0.9968; val_best_acc_score: 0.9806; val_best_f1_score: 0.9807; train_kl_reg_loss: 5485.3231; train_edge_recon_loss: 257282.7913; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262768.1144; train_optim_loss: 262768.1144; val_kl_reg_loss: 5440.1117; val_edge_recon_loss: 257362.2659; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262802.3773; val_optim_loss: 262802.3773
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9976; val_auprc_score: 0.9969; val_best_acc_score: 0.9808; val_best_f1_score: 0.9808; train_kl_reg_loss: 5483.2650; train_edge_recon_loss: 257313.7071; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262796.9720; train_optim_loss: 262796.9720; val_kl_reg_loss: 5450.3533; val_edge_recon_loss: 257362.1327; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262812.4868; val_optim_loss: 262812.4868

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9975; val_auprc_score: 0.9968; val_best_acc_score: 0.9808; val_best_f1_score: 0.9809; train_kl_reg_loss: 5480.6476; train_edge_recon_loss: 257322.5249; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262803.1726; train_optim_loss: 262803.1726; val_kl_reg_loss: 5454.8986; val_edge_recon_loss: 257318.4062; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262773.3055; val_optim_loss: 262773.3055
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9975; val_auprc_score: 0.9970; val_best_acc_score: 0.9804; val_best_f1_score: 0.9804; train_kl_reg_loss: 5482.6777; train_edge_recon_loss: 257277.8429; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262760.5207; train_optim_loss: 262760.5207; val_kl_reg_loss: 5456.6353; val_edge_recon_loss: 257291.5458; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262748.1812; val_optim_loss: 262748.1812
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9975; val_auprc_score: 0.9969; val_best_acc_score: 0.9801; val_best_f1_score: 0.9802; train_kl_reg_loss: 5482.9855; train_edge_recon_loss: 257271.8647; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262754.8501; train_optim_loss: 262754.8501; val_kl_reg_loss: 5453.0716; val_edge_recon_loss: 257440.7340; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262893.8062; val_optim_loss: 262893.8062
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9975; val_auprc_score: 0.9969; val_best_acc_score: 0.9809; val_best_f1_score: 0.9810; train_kl_reg_loss: 5482.6305; train_edge_recon_loss: 257265.2481; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262747.8783; train_optim_loss: 262747.8783; val_kl_reg_loss: 5455.2862; val_edge_recon_loss: 257351.4526; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262806.7388; val_optim_loss: 262806.7388

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 406 min 51 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
Val AUROC score: 0.9975
Val AUPRC score: 0.9968
Val best accuracy score: 0.9806
Val best F1 score: 0.9807
Val gene expr MSE score: 14.3419

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
