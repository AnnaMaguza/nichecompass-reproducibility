None
Run timestamp: 06072023_052827_26.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_26']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9868; val_auprc_score: 0.9857; val_best_acc_score: 0.9436; val_best_f1_score: 0.9440; train_kl_reg_loss: 5540.5210; train_edge_recon_loss: 264151.7005; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269692.2216; train_optim_loss: 269692.2216; val_kl_reg_loss: 5424.9621; val_edge_recon_loss: 261861.4575; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267286.4188; val_optim_loss: 267286.4188
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9906; val_auprc_score: 0.9898; val_best_acc_score: 0.9537; val_best_f1_score: 0.9539; train_kl_reg_loss: 5504.1057; train_edge_recon_loss: 260529.8915; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266033.9973; train_optim_loss: 266033.9973; val_kl_reg_loss: 5498.7882; val_edge_recon_loss: 260982.9727; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 266481.7605; val_optim_loss: 266481.7605
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9923; val_auprc_score: 0.9912; val_best_acc_score: 0.9594; val_best_f1_score: 0.9597; train_kl_reg_loss: 5483.5404; train_edge_recon_loss: 259974.9392; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265458.4799; train_optim_loss: 265458.4799; val_kl_reg_loss: 5346.9580; val_edge_recon_loss: 260377.6081; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265724.5668; val_optim_loss: 265724.5668
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9931; val_auprc_score: 0.9919; val_best_acc_score: 0.9629; val_best_f1_score: 0.9632; train_kl_reg_loss: 5483.0778; train_edge_recon_loss: 259563.3289; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265046.4064; train_optim_loss: 265046.4064; val_kl_reg_loss: 5324.4684; val_edge_recon_loss: 260050.0694; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265374.5381; val_optim_loss: 265374.5381
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9937; val_auprc_score: 0.9927; val_best_acc_score: 0.9641; val_best_f1_score: 0.9642; train_kl_reg_loss: 5482.3126; train_edge_recon_loss: 259326.4307; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264808.7435; train_optim_loss: 264808.7435; val_kl_reg_loss: 5467.0709; val_edge_recon_loss: 259759.2956; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265226.3659; val_optim_loss: 265226.3659
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9940; val_auprc_score: 0.9931; val_best_acc_score: 0.9656; val_best_f1_score: 0.9658; train_kl_reg_loss: 5480.4312; train_edge_recon_loss: 259146.7100; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264627.1411; train_optim_loss: 264627.1411; val_kl_reg_loss: 5100.0704; val_edge_recon_loss: 260127.2027; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265227.2729; val_optim_loss: 265227.2729
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9944; val_auprc_score: 0.9934; val_best_acc_score: 0.9677; val_best_f1_score: 0.9680; train_kl_reg_loss: 5475.6007; train_edge_recon_loss: 259082.1539; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264557.7545; train_optim_loss: 264557.7545; val_kl_reg_loss: 5429.9818; val_edge_recon_loss: 259804.6858; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265234.6674; val_optim_loss: 265234.6674
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9945; val_auprc_score: 0.9935; val_best_acc_score: 0.9684; val_best_f1_score: 0.9687; train_kl_reg_loss: 5477.4653; train_edge_recon_loss: 258901.3688; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264378.8340; train_optim_loss: 264378.8340; val_kl_reg_loss: 5347.8698; val_edge_recon_loss: 259432.9646; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264780.8342; val_optim_loss: 264780.8342
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9952; val_auprc_score: 0.9945; val_best_acc_score: 0.9696; val_best_f1_score: 0.9698; train_kl_reg_loss: 5475.2011; train_edge_recon_loss: 258850.1722; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264325.3732; train_optim_loss: 264325.3732; val_kl_reg_loss: 5444.3388; val_edge_recon_loss: 259231.6882; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264676.0271; val_optim_loss: 264676.0271
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9950; val_auprc_score: 0.9942; val_best_acc_score: 0.9691; val_best_f1_score: 0.9693; train_kl_reg_loss: 5475.5187; train_edge_recon_loss: 258730.0483; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264205.5667; train_optim_loss: 264205.5667; val_kl_reg_loss: 5347.7691; val_edge_recon_loss: 259484.0923; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264831.8611; val_optim_loss: 264831.8611
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9955; val_auprc_score: 0.9947; val_best_acc_score: 0.9716; val_best_f1_score: 0.9717; train_kl_reg_loss: 5473.3367; train_edge_recon_loss: 258666.3940; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264139.7309; train_optim_loss: 264139.7309; val_kl_reg_loss: 5324.0945; val_edge_recon_loss: 259311.9748; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264636.0692; val_optim_loss: 264636.0692
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9959; val_auprc_score: 0.9952; val_best_acc_score: 0.9730; val_best_f1_score: 0.9732; train_kl_reg_loss: 5474.0085; train_edge_recon_loss: 258609.2853; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264083.2940; train_optim_loss: 264083.2940; val_kl_reg_loss: 5295.0508; val_edge_recon_loss: 259021.5377; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264316.5879; val_optim_loss: 264316.5879
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9958; val_auprc_score: 0.9950; val_best_acc_score: 0.9718; val_best_f1_score: 0.9719; train_kl_reg_loss: 5474.3753; train_edge_recon_loss: 258464.1349; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263938.5102; train_optim_loss: 263938.5102; val_kl_reg_loss: 5433.4020; val_edge_recon_loss: 259078.5750; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264511.9775; val_optim_loss: 264511.9775
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9958; val_auprc_score: 0.9950; val_best_acc_score: 0.9724; val_best_f1_score: 0.9726; train_kl_reg_loss: 5473.2215; train_edge_recon_loss: 258513.0107; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263986.2322; train_optim_loss: 263986.2322; val_kl_reg_loss: 5470.0552; val_edge_recon_loss: 258741.6713; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264211.7270; val_optim_loss: 264211.7270
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9959; val_auprc_score: 0.9952; val_best_acc_score: 0.9734; val_best_f1_score: 0.9736; train_kl_reg_loss: 5472.6585; train_edge_recon_loss: 258406.8763; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263879.5349; train_optim_loss: 263879.5349; val_kl_reg_loss: 5440.4659; val_edge_recon_loss: 258909.2742; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264349.7413; val_optim_loss: 264349.7413
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9960; val_auprc_score: 0.9952; val_best_acc_score: 0.9731; val_best_f1_score: 0.9733; train_kl_reg_loss: 5476.0013; train_edge_recon_loss: 258296.0171; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263772.0186; train_optim_loss: 263772.0186; val_kl_reg_loss: 5464.6926; val_edge_recon_loss: 258675.6112; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264140.3032; val_optim_loss: 264140.3032
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9961; val_auprc_score: 0.9954; val_best_acc_score: 0.9734; val_best_f1_score: 0.9736; train_kl_reg_loss: 5472.4268; train_edge_recon_loss: 258294.7791; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263767.2056; train_optim_loss: 263767.2056; val_kl_reg_loss: 5480.9260; val_edge_recon_loss: 258716.1198; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264197.0453; val_optim_loss: 264197.0453
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9964; val_auprc_score: 0.9957; val_best_acc_score: 0.9754; val_best_f1_score: 0.9755; train_kl_reg_loss: 5473.7883; train_edge_recon_loss: 258179.0177; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263652.8055; train_optim_loss: 263652.8055; val_kl_reg_loss: 5407.6236; val_edge_recon_loss: 258510.9295; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263918.5536; val_optim_loss: 263918.5536
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9965; val_auprc_score: 0.9959; val_best_acc_score: 0.9752; val_best_f1_score: 0.9754; train_kl_reg_loss: 5473.9877; train_edge_recon_loss: 258150.7988; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263624.7864; train_optim_loss: 263624.7864; val_kl_reg_loss: 5362.9631; val_edge_recon_loss: 258377.2950; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263740.2582; val_optim_loss: 263740.2582
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9968; val_auprc_score: 0.9962; val_best_acc_score: 0.9768; val_best_f1_score: 0.9770; train_kl_reg_loss: 5474.8629; train_edge_recon_loss: 258152.3852; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263627.2481; train_optim_loss: 263627.2481; val_kl_reg_loss: 5343.0367; val_edge_recon_loss: 258396.3666; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263739.4036; val_optim_loss: 263739.4036
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9965; val_auprc_score: 0.9959; val_best_acc_score: 0.9764; val_best_f1_score: 0.9766; train_kl_reg_loss: 5473.7960; train_edge_recon_loss: 258108.3409; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263582.1370; train_optim_loss: 263582.1370; val_kl_reg_loss: 5225.6398; val_edge_recon_loss: 258524.3562; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263749.9954; val_optim_loss: 263749.9954
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9970; val_auprc_score: 0.9966; val_best_acc_score: 0.9761; val_best_f1_score: 0.9762; train_kl_reg_loss: 5475.4097; train_edge_recon_loss: 258038.7443; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263514.1539; train_optim_loss: 263514.1539; val_kl_reg_loss: 5631.1468; val_edge_recon_loss: 258338.5743; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263969.7220; val_optim_loss: 263969.7220
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9966; val_auprc_score: 0.9958; val_best_acc_score: 0.9761; val_best_f1_score: 0.9762; train_kl_reg_loss: 5475.0037; train_edge_recon_loss: 257981.2508; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263456.2544; train_optim_loss: 263456.2544; val_kl_reg_loss: 5444.5845; val_edge_recon_loss: 258399.3070; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263843.8917; val_optim_loss: 263843.8917
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9967; val_auprc_score: 0.9962; val_best_acc_score: 0.9764; val_best_f1_score: 0.9765; train_kl_reg_loss: 5477.3189; train_edge_recon_loss: 257921.7783; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263399.0970; train_optim_loss: 263399.0970; val_kl_reg_loss: 5366.9628; val_edge_recon_loss: 258115.6286; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263482.5910; val_optim_loss: 263482.5910
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9965; val_auprc_score: 0.9958; val_best_acc_score: 0.9758; val_best_f1_score: 0.9760; train_kl_reg_loss: 5476.4003; train_edge_recon_loss: 257929.2840; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263405.6844; train_optim_loss: 263405.6844; val_kl_reg_loss: 5418.3550; val_edge_recon_loss: 258129.0736; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263547.4284; val_optim_loss: 263547.4284
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9967; val_auprc_score: 0.9962; val_best_acc_score: 0.9766; val_best_f1_score: 0.9768; train_kl_reg_loss: 5478.4709; train_edge_recon_loss: 257832.4365; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263310.9074; train_optim_loss: 263310.9074; val_kl_reg_loss: 5443.2574; val_edge_recon_loss: 258294.9539; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263738.2115; val_optim_loss: 263738.2115
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9968; val_auprc_score: 0.9962; val_best_acc_score: 0.9767; val_best_f1_score: 0.9769; train_kl_reg_loss: 5477.5138; train_edge_recon_loss: 257887.4924; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263365.0064; train_optim_loss: 263365.0064; val_kl_reg_loss: 5402.9030; val_edge_recon_loss: 258157.0839; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263559.9877; val_optim_loss: 263559.9877
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9968; val_auprc_score: 0.9960; val_best_acc_score: 0.9767; val_best_f1_score: 0.9767; train_kl_reg_loss: 5477.0481; train_edge_recon_loss: 257794.5419; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263271.5898; train_optim_loss: 263271.5898; val_kl_reg_loss: 5254.6381; val_edge_recon_loss: 258084.7064; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263339.3456; val_optim_loss: 263339.3456
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9968; val_auprc_score: 0.9960; val_best_acc_score: 0.9776; val_best_f1_score: 0.9777; train_kl_reg_loss: 5478.9965; train_edge_recon_loss: 257791.5203; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263270.5168; train_optim_loss: 263270.5168; val_kl_reg_loss: 5518.6842; val_edge_recon_loss: 258162.6316; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263681.3162; val_optim_loss: 263681.3162
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9969; val_auprc_score: 0.9961; val_best_acc_score: 0.9779; val_best_f1_score: 0.9780; train_kl_reg_loss: 5478.6365; train_edge_recon_loss: 257763.3600; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263241.9963; train_optim_loss: 263241.9963; val_kl_reg_loss: 5512.4738; val_edge_recon_loss: 258033.8573; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263546.3311; val_optim_loss: 263546.3311
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9966; val_auprc_score: 0.9960; val_best_acc_score: 0.9763; val_best_f1_score: 0.9765; train_kl_reg_loss: 5477.4169; train_edge_recon_loss: 257734.9279; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263212.3446; train_optim_loss: 263212.3446; val_kl_reg_loss: 5461.2206; val_edge_recon_loss: 258086.4584; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263547.6795; val_optim_loss: 263547.6795
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9969; val_auprc_score: 0.9963; val_best_acc_score: 0.9777; val_best_f1_score: 0.9778; train_kl_reg_loss: 5479.4095; train_edge_recon_loss: 257673.5870; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263152.9965; train_optim_loss: 263152.9965; val_kl_reg_loss: 5551.3363; val_edge_recon_loss: 257931.6975; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263483.0330; val_optim_loss: 263483.0330

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9974; val_auprc_score: 0.9968; val_best_acc_score: 0.9800; val_best_f1_score: 0.9801; train_kl_reg_loss: 5460.8881; train_edge_recon_loss: 257382.1540; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262843.0419; train_optim_loss: 262843.0419; val_kl_reg_loss: 5456.0024; val_edge_recon_loss: 257686.9600; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263142.9627; val_optim_loss: 263142.9627
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9975; val_auprc_score: 0.9968; val_best_acc_score: 0.9805; val_best_f1_score: 0.9806; train_kl_reg_loss: 5453.0036; train_edge_recon_loss: 257380.7222; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262833.7256; train_optim_loss: 262833.7256; val_kl_reg_loss: 5444.6446; val_edge_recon_loss: 257418.3995; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262863.0440; val_optim_loss: 262863.0440
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9976; val_auprc_score: 0.9970; val_best_acc_score: 0.9807; val_best_f1_score: 0.9808; train_kl_reg_loss: 5447.7360; train_edge_recon_loss: 257317.7174; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262765.4535; train_optim_loss: 262765.4535; val_kl_reg_loss: 5423.6251; val_edge_recon_loss: 257303.4110; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262727.0365; val_optim_loss: 262727.0365
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9976; val_auprc_score: 0.9971; val_best_acc_score: 0.9809; val_best_f1_score: 0.9810; train_kl_reg_loss: 5445.1618; train_edge_recon_loss: 257361.5333; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262806.6953; train_optim_loss: 262806.6953; val_kl_reg_loss: 5443.2223; val_edge_recon_loss: 257341.6477; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262784.8693; val_optim_loss: 262784.8693
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9975; val_auprc_score: 0.9970; val_best_acc_score: 0.9808; val_best_f1_score: 0.9809; train_kl_reg_loss: 5442.5160; train_edge_recon_loss: 257255.1081; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262697.6242; train_optim_loss: 262697.6242; val_kl_reg_loss: 5421.8640; val_edge_recon_loss: 257393.2720; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262815.1358; val_optim_loss: 262815.1358
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9976; val_auprc_score: 0.9969; val_best_acc_score: 0.9809; val_best_f1_score: 0.9810; train_kl_reg_loss: 5444.6084; train_edge_recon_loss: 257250.0297; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262694.6381; train_optim_loss: 262694.6381; val_kl_reg_loss: 5394.3738; val_edge_recon_loss: 257268.2416; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262662.6146; val_optim_loss: 262662.6146
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9976; val_auprc_score: 0.9971; val_best_acc_score: 0.9815; val_best_f1_score: 0.9816; train_kl_reg_loss: 5441.3184; train_edge_recon_loss: 257236.8438; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262678.1623; train_optim_loss: 262678.1623; val_kl_reg_loss: 5424.4470; val_edge_recon_loss: 257185.0032; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262609.4496; val_optim_loss: 262609.4496
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9977; val_auprc_score: 0.9971; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 5444.1438; train_edge_recon_loss: 257189.6307; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262633.7743; train_optim_loss: 262633.7743; val_kl_reg_loss: 5417.4134; val_edge_recon_loss: 257337.5321; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262754.9459; val_optim_loss: 262754.9459
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9976; val_auprc_score: 0.9970; val_best_acc_score: 0.9810; val_best_f1_score: 0.9811; train_kl_reg_loss: 5440.2503; train_edge_recon_loss: 257300.8939; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262741.1444; train_optim_loss: 262741.1444; val_kl_reg_loss: 5453.5384; val_edge_recon_loss: 257173.5896; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262627.1279; val_optim_loss: 262627.1279
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9977; val_auprc_score: 0.9971; val_best_acc_score: 0.9817; val_best_f1_score: 0.9818; train_kl_reg_loss: 5439.5323; train_edge_recon_loss: 257224.1376; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262663.6697; train_optim_loss: 262663.6697; val_kl_reg_loss: 5399.4060; val_edge_recon_loss: 257171.3131; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262570.7193; val_optim_loss: 262570.7193
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9976; val_auprc_score: 0.9971; val_best_acc_score: 0.9815; val_best_f1_score: 0.9816; train_kl_reg_loss: 5439.1254; train_edge_recon_loss: 257212.9555; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262652.0806; train_optim_loss: 262652.0806; val_kl_reg_loss: 5414.7658; val_edge_recon_loss: 257219.4600; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262634.2257; val_optim_loss: 262634.2257
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9976; val_auprc_score: 0.9970; val_best_acc_score: 0.9810; val_best_f1_score: 0.9811; train_kl_reg_loss: 5437.5951; train_edge_recon_loss: 257316.2117; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262753.8070; train_optim_loss: 262753.8070; val_kl_reg_loss: 5445.5237; val_edge_recon_loss: 257218.2124; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262663.7353; val_optim_loss: 262663.7353
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9976; val_auprc_score: 0.9970; val_best_acc_score: 0.9808; val_best_f1_score: 0.9809; train_kl_reg_loss: 5437.6513; train_edge_recon_loss: 257207.7572; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262645.4083; train_optim_loss: 262645.4083; val_kl_reg_loss: 5428.6850; val_edge_recon_loss: 257292.9871; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262721.6727; val_optim_loss: 262721.6727
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9975; val_auprc_score: 0.9970; val_best_acc_score: 0.9812; val_best_f1_score: 0.9813; train_kl_reg_loss: 5436.7076; train_edge_recon_loss: 257193.1587; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262629.8661; train_optim_loss: 262629.8661; val_kl_reg_loss: 5426.8890; val_edge_recon_loss: 257246.0149; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262672.9042; val_optim_loss: 262672.9042

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9976; val_auprc_score: 0.9970; val_best_acc_score: 0.9816; val_best_f1_score: 0.9817; train_kl_reg_loss: 5440.8772; train_edge_recon_loss: 257143.7649; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262584.6419; train_optim_loss: 262584.6419; val_kl_reg_loss: 5428.0021; val_edge_recon_loss: 257027.9181; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262455.9201; val_optim_loss: 262455.9201
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9976; val_auprc_score: 0.9970; val_best_acc_score: 0.9812; val_best_f1_score: 0.9813; train_kl_reg_loss: 5438.3588; train_edge_recon_loss: 257114.7107; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262553.0695; train_optim_loss: 262553.0695; val_kl_reg_loss: 5416.8678; val_edge_recon_loss: 257445.9066; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262862.7744; val_optim_loss: 262862.7744
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9813; val_best_f1_score: 0.9814; train_kl_reg_loss: 5436.9294; train_edge_recon_loss: 257125.0637; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262561.9931; train_optim_loss: 262561.9931; val_kl_reg_loss: 5411.4588; val_edge_recon_loss: 257327.0720; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262738.5305; val_optim_loss: 262738.5305
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9975; val_auprc_score: 0.9969; val_best_acc_score: 0.9813; val_best_f1_score: 0.9814; train_kl_reg_loss: 5436.9209; train_edge_recon_loss: 257130.9835; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262567.9044; train_optim_loss: 262567.9044; val_kl_reg_loss: 5415.1592; val_edge_recon_loss: 257303.4535; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262718.6130; val_optim_loss: 262718.6130
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9816; val_best_f1_score: 0.9817; train_kl_reg_loss: 5435.0080; train_edge_recon_loss: 257170.4077; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262605.4158; train_optim_loss: 262605.4158; val_kl_reg_loss: 5425.6195; val_edge_recon_loss: 257298.6088; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262724.2276; val_optim_loss: 262724.2276

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9976; val_auprc_score: 0.9970; val_best_acc_score: 0.9816; val_best_f1_score: 0.9817; train_kl_reg_loss: 5439.0189; train_edge_recon_loss: 257101.6033; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262540.6217; train_optim_loss: 262540.6217; val_kl_reg_loss: 5419.6775; val_edge_recon_loss: 257105.4811; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262525.1592; val_optim_loss: 262525.1592
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9976; val_auprc_score: 0.9969; val_best_acc_score: 0.9815; val_best_f1_score: 0.9815; train_kl_reg_loss: 5437.5053; train_edge_recon_loss: 257108.3652; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262545.8705; train_optim_loss: 262545.8705; val_kl_reg_loss: 5415.9506; val_edge_recon_loss: 257225.3027; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262641.2529; val_optim_loss: 262641.2529
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9976; val_auprc_score: 0.9968; val_best_acc_score: 0.9814; val_best_f1_score: 0.9815; train_kl_reg_loss: 5437.0020; train_edge_recon_loss: 257126.5668; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262563.5689; train_optim_loss: 262563.5689; val_kl_reg_loss: 5418.1662; val_edge_recon_loss: 257296.4956; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262714.6615; val_optim_loss: 262714.6615
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9976; val_auprc_score: 0.9972; val_best_acc_score: 0.9813; val_best_f1_score: 0.9814; train_kl_reg_loss: 5436.8155; train_edge_recon_loss: 257094.2843; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262531.0995; train_optim_loss: 262531.0995; val_kl_reg_loss: 5419.5243; val_edge_recon_loss: 257242.5803; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262662.1045; val_optim_loss: 262662.1045

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 468 min 7 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
Val AUROC score: 0.9976
Val AUPRC score: 0.9969
Val best accuracy score: 0.9813
Val best F1 score: 0.9814
Val gene expr MSE score: 14.2686

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
