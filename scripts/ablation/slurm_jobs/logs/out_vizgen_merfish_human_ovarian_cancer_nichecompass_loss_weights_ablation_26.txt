None
Run timestamp: 04072023_133336_26.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_26']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9875; val_auprc_score: 0.9864; val_best_acc_score: 0.9450; val_best_f1_score: 0.9450; train_kl_reg_loss: 6405.1785; train_edge_recon_loss: 264818.2228; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271223.4012; train_optim_loss: 271223.4012; val_kl_reg_loss: 6230.2992; val_edge_recon_loss: 262031.8176; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268262.1161; val_optim_loss: 268262.1161
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9902; val_auprc_score: 0.9895; val_best_acc_score: 0.9515; val_best_f1_score: 0.9515; train_kl_reg_loss: 6384.6094; train_edge_recon_loss: 260941.4176; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 267326.0266; train_optim_loss: 267326.0266; val_kl_reg_loss: 6252.8156; val_edge_recon_loss: 260927.4663; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267180.2824; val_optim_loss: 267180.2824
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9920; val_auprc_score: 0.9911; val_best_acc_score: 0.9590; val_best_f1_score: 0.9591; train_kl_reg_loss: 6369.3847; train_edge_recon_loss: 260386.3438; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266755.7280; train_optim_loss: 266755.7280; val_kl_reg_loss: 6233.9137; val_edge_recon_loss: 260779.1398; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267013.0537; val_optim_loss: 267013.0537
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9934; val_auprc_score: 0.9926; val_best_acc_score: 0.9629; val_best_f1_score: 0.9631; train_kl_reg_loss: 6373.5389; train_edge_recon_loss: 260007.0330; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266380.5716; train_optim_loss: 266380.5716; val_kl_reg_loss: 6357.3715; val_edge_recon_loss: 260329.4753; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 266686.8451; val_optim_loss: 266686.8451
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9939; val_auprc_score: 0.9932; val_best_acc_score: 0.9650; val_best_f1_score: 0.9651; train_kl_reg_loss: 6380.9407; train_edge_recon_loss: 259694.9562; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266075.8971; train_optim_loss: 266075.8971; val_kl_reg_loss: 6365.3608; val_edge_recon_loss: 259877.4445; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 266242.8046; val_optim_loss: 266242.8046
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9943; val_auprc_score: 0.9935; val_best_acc_score: 0.9660; val_best_f1_score: 0.9662; train_kl_reg_loss: 6381.0846; train_edge_recon_loss: 259469.4626; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265850.5474; train_optim_loss: 265850.5474; val_kl_reg_loss: 6384.1996; val_edge_recon_loss: 259799.9936; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 266184.1923; val_optim_loss: 266184.1923
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9947; val_auprc_score: 0.9940; val_best_acc_score: 0.9674; val_best_f1_score: 0.9675; train_kl_reg_loss: 6384.1048; train_edge_recon_loss: 259400.1298; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265784.2345; train_optim_loss: 265784.2345; val_kl_reg_loss: 6259.6889; val_edge_recon_loss: 259654.1722; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265913.8619; val_optim_loss: 265913.8619
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9948; val_auprc_score: 0.9941; val_best_acc_score: 0.9680; val_best_f1_score: 0.9681; train_kl_reg_loss: 6381.1748; train_edge_recon_loss: 259268.8233; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265649.9976; train_optim_loss: 265649.9976; val_kl_reg_loss: 6220.2885; val_edge_recon_loss: 259170.6136; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265390.9022; val_optim_loss: 265390.9022
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9952; val_auprc_score: 0.9945; val_best_acc_score: 0.9695; val_best_f1_score: 0.9697; train_kl_reg_loss: 6383.0365; train_edge_recon_loss: 259100.5944; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265483.6313; train_optim_loss: 265483.6313; val_kl_reg_loss: 6489.0789; val_edge_recon_loss: 259496.8715; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265985.9504; val_optim_loss: 265985.9504
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9953; val_auprc_score: 0.9946; val_best_acc_score: 0.9703; val_best_f1_score: 0.9704; train_kl_reg_loss: 6381.8786; train_edge_recon_loss: 259069.9881; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265451.8662; train_optim_loss: 265451.8662; val_kl_reg_loss: 6347.2053; val_edge_recon_loss: 259139.2545; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265486.4598; val_optim_loss: 265486.4598
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9953; val_auprc_score: 0.9948; val_best_acc_score: 0.9702; val_best_f1_score: 0.9703; train_kl_reg_loss: 6377.6907; train_edge_recon_loss: 258994.8734; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265372.5646; train_optim_loss: 265372.5646; val_kl_reg_loss: 6273.8782; val_edge_recon_loss: 259101.9012; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265375.7791; val_optim_loss: 265375.7791
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9958; val_auprc_score: 0.9953; val_best_acc_score: 0.9716; val_best_f1_score: 0.9717; train_kl_reg_loss: 6376.5893; train_edge_recon_loss: 258979.2505; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265355.8398; train_optim_loss: 265355.8398; val_kl_reg_loss: 6106.2765; val_edge_recon_loss: 259037.1240; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265143.4004; val_optim_loss: 265143.4004
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9959; val_auprc_score: 0.9954; val_best_acc_score: 0.9720; val_best_f1_score: 0.9721; train_kl_reg_loss: 6378.3105; train_edge_recon_loss: 258877.8711; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265256.1818; train_optim_loss: 265256.1818; val_kl_reg_loss: 6262.5933; val_edge_recon_loss: 259102.1650; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265364.7581; val_optim_loss: 265364.7581
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9957; val_auprc_score: 0.9949; val_best_acc_score: 0.9724; val_best_f1_score: 0.9726; train_kl_reg_loss: 6376.5228; train_edge_recon_loss: 258753.2004; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265129.7233; train_optim_loss: 265129.7233; val_kl_reg_loss: 6116.6219; val_edge_recon_loss: 259101.1103; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265217.7317; val_optim_loss: 265217.7317
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9960; val_auprc_score: 0.9954; val_best_acc_score: 0.9731; val_best_f1_score: 0.9732; train_kl_reg_loss: 6377.5811; train_edge_recon_loss: 258698.6748; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265076.2559; train_optim_loss: 265076.2559; val_kl_reg_loss: 6404.3890; val_edge_recon_loss: 258770.4957; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265174.8848; val_optim_loss: 265174.8848
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9961; val_auprc_score: 0.9954; val_best_acc_score: 0.9738; val_best_f1_score: 0.9739; train_kl_reg_loss: 6376.7033; train_edge_recon_loss: 258671.8908; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265048.5943; train_optim_loss: 265048.5943; val_kl_reg_loss: 6399.8558; val_edge_recon_loss: 258800.0944; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265199.9500; val_optim_loss: 265199.9500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9965; val_auprc_score: 0.9958; val_best_acc_score: 0.9754; val_best_f1_score: 0.9756; train_kl_reg_loss: 6359.6946; train_edge_recon_loss: 258279.6150; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264639.3098; train_optim_loss: 264639.3098; val_kl_reg_loss: 6292.7373; val_edge_recon_loss: 258443.4193; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264736.1571; val_optim_loss: 264736.1571
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9967; val_auprc_score: 0.9961; val_best_acc_score: 0.9761; val_best_f1_score: 0.9762; train_kl_reg_loss: 6348.7591; train_edge_recon_loss: 258233.1955; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264581.9544; train_optim_loss: 264581.9544; val_kl_reg_loss: 6262.2165; val_edge_recon_loss: 258444.7181; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264706.9345; val_optim_loss: 264706.9345
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9969; val_auprc_score: 0.9965; val_best_acc_score: 0.9765; val_best_f1_score: 0.9765; train_kl_reg_loss: 6341.3721; train_edge_recon_loss: 258212.4471; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264553.8193; train_optim_loss: 264553.8193; val_kl_reg_loss: 6247.6564; val_edge_recon_loss: 258149.0655; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264396.7216; val_optim_loss: 264396.7216
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9968; val_auprc_score: 0.9963; val_best_acc_score: 0.9771; val_best_f1_score: 0.9772; train_kl_reg_loss: 6337.8834; train_edge_recon_loss: 258210.1885; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264548.0719; train_optim_loss: 264548.0719; val_kl_reg_loss: 6265.6219; val_edge_recon_loss: 258324.4056; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264590.0272; val_optim_loss: 264590.0272
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9967; val_auprc_score: 0.9961; val_best_acc_score: 0.9765; val_best_f1_score: 0.9765; train_kl_reg_loss: 6335.1721; train_edge_recon_loss: 258152.1250; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264487.2971; train_optim_loss: 264487.2971; val_kl_reg_loss: 6287.5067; val_edge_recon_loss: 258197.0381; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264484.5442; val_optim_loss: 264484.5442
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9970; val_auprc_score: 0.9965; val_best_acc_score: 0.9770; val_best_f1_score: 0.9771; train_kl_reg_loss: 6334.1214; train_edge_recon_loss: 258138.5445; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264472.6662; train_optim_loss: 264472.6662; val_kl_reg_loss: 6287.3576; val_edge_recon_loss: 258154.9580; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264442.3148; val_optim_loss: 264442.3148
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9968; val_auprc_score: 0.9963; val_best_acc_score: 0.9766; val_best_f1_score: 0.9767; train_kl_reg_loss: 6333.2831; train_edge_recon_loss: 258124.2090; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264457.4917; train_optim_loss: 264457.4917; val_kl_reg_loss: 6239.4350; val_edge_recon_loss: 258085.3395; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264324.7737; val_optim_loss: 264324.7737
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9968; val_auprc_score: 0.9961; val_best_acc_score: 0.9770; val_best_f1_score: 0.9771; train_kl_reg_loss: 6327.7289; train_edge_recon_loss: 258190.9748; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264518.7037; train_optim_loss: 264518.7037; val_kl_reg_loss: 6252.1176; val_edge_recon_loss: 258099.5951; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264351.7119; val_optim_loss: 264351.7119
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9970; val_auprc_score: 0.9965; val_best_acc_score: 0.9777; val_best_f1_score: 0.9777; train_kl_reg_loss: 6326.7315; train_edge_recon_loss: 258177.4004; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264504.1321; train_optim_loss: 264504.1321; val_kl_reg_loss: 6273.7753; val_edge_recon_loss: 257952.9467; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264226.7232; val_optim_loss: 264226.7232
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9969; val_auprc_score: 0.9965; val_best_acc_score: 0.9771; val_best_f1_score: 0.9772; train_kl_reg_loss: 6328.2322; train_edge_recon_loss: 258118.7409; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264446.9730; train_optim_loss: 264446.9730; val_kl_reg_loss: 6325.2714; val_edge_recon_loss: 258037.0831; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264362.3547; val_optim_loss: 264362.3547
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9969; val_auprc_score: 0.9963; val_best_acc_score: 0.9776; val_best_f1_score: 0.9777; train_kl_reg_loss: 6329.5510; train_edge_recon_loss: 258105.6539; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264435.2048; train_optim_loss: 264435.2048; val_kl_reg_loss: 6266.1611; val_edge_recon_loss: 258227.7982; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264493.9594; val_optim_loss: 264493.9594
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9970; val_auprc_score: 0.9963; val_best_acc_score: 0.9778; val_best_f1_score: 0.9779; train_kl_reg_loss: 6326.9338; train_edge_recon_loss: 258119.3511; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264446.2848; train_optim_loss: 264446.2848; val_kl_reg_loss: 6317.1503; val_edge_recon_loss: 257986.1802; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264303.3296; val_optim_loss: 264303.3296
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9970; val_auprc_score: 0.9964; val_best_acc_score: 0.9780; val_best_f1_score: 0.9781; train_kl_reg_loss: 6324.8819; train_edge_recon_loss: 258123.5154; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264448.3973; train_optim_loss: 264448.3973; val_kl_reg_loss: 6265.6520; val_edge_recon_loss: 258268.5583; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264534.2110; val_optim_loss: 264534.2110

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9970; val_auprc_score: 0.9965; val_best_acc_score: 0.9775; val_best_f1_score: 0.9776; train_kl_reg_loss: 6325.2580; train_edge_recon_loss: 258027.7142; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264352.9721; train_optim_loss: 264352.9721; val_kl_reg_loss: 6287.2958; val_edge_recon_loss: 258237.7003; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264524.9963; val_optim_loss: 264524.9963
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9970; val_auprc_score: 0.9964; val_best_acc_score: 0.9773; val_best_f1_score: 0.9774; train_kl_reg_loss: 6323.4952; train_edge_recon_loss: 258045.2302; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264368.7251; train_optim_loss: 264368.7251; val_kl_reg_loss: 6273.9685; val_edge_recon_loss: 258190.3247; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264464.2925; val_optim_loss: 264464.2925
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9971; val_auprc_score: 0.9966; val_best_acc_score: 0.9780; val_best_f1_score: 0.9782; train_kl_reg_loss: 6322.4537; train_edge_recon_loss: 258029.5235; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264351.9771; train_optim_loss: 264351.9771; val_kl_reg_loss: 6291.4612; val_edge_recon_loss: 258058.2742; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264349.7350; val_optim_loss: 264349.7350
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9970; val_auprc_score: 0.9965; val_best_acc_score: 0.9774; val_best_f1_score: 0.9774; train_kl_reg_loss: 6325.3785; train_edge_recon_loss: 258004.5161; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264329.8945; train_optim_loss: 264329.8945; val_kl_reg_loss: 6292.4869; val_edge_recon_loss: 258370.2766; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264662.7639; val_optim_loss: 264662.7639

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 267 min 9 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9971
Val AUPRC score: 0.9967
Val best accuracy score: 0.9775
Val best F1 score: 0.9776
Val gene expr MSE score: 10.6162

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
