None
Run timestamp: 07072023_025520_26.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_26']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9869; val_auprc_score: 0.9859; val_best_acc_score: 0.9432; val_best_f1_score: 0.9436; train_kl_reg_loss: 5572.2477; train_edge_recon_loss: 264299.3852; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269871.6328; train_optim_loss: 269871.6328; val_kl_reg_loss: 5540.5574; val_edge_recon_loss: 262002.1894; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267542.7468; val_optim_loss: 267542.7468
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9902; val_auprc_score: 0.9893; val_best_acc_score: 0.9530; val_best_f1_score: 0.9533; train_kl_reg_loss: 5538.8732; train_edge_recon_loss: 260664.1730; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266203.0463; train_optim_loss: 266203.0463; val_kl_reg_loss: 5580.3011; val_edge_recon_loss: 260761.3225; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 266341.6240; val_optim_loss: 266341.6240
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9922; val_auprc_score: 0.9911; val_best_acc_score: 0.9593; val_best_f1_score: 0.9595; train_kl_reg_loss: 5521.3911; train_edge_recon_loss: 260045.2686; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265566.6594; train_optim_loss: 265566.6594; val_kl_reg_loss: 5616.7173; val_edge_recon_loss: 260477.4035; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 266094.1203; val_optim_loss: 266094.1203
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9934; val_auprc_score: 0.9924; val_best_acc_score: 0.9632; val_best_f1_score: 0.9634; train_kl_reg_loss: 5523.5336; train_edge_recon_loss: 259638.3456; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265161.8792; train_optim_loss: 265161.8792; val_kl_reg_loss: 5265.9173; val_edge_recon_loss: 260172.4372; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265438.3545; val_optim_loss: 265438.3545
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9939; val_auprc_score: 0.9931; val_best_acc_score: 0.9664; val_best_f1_score: 0.9666; train_kl_reg_loss: 5526.6889; train_edge_recon_loss: 259414.5880; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264941.2773; train_optim_loss: 264941.2773; val_kl_reg_loss: 5554.3851; val_edge_recon_loss: 259970.0290; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265524.4136; val_optim_loss: 265524.4136
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9942; val_auprc_score: 0.9935; val_best_acc_score: 0.9659; val_best_f1_score: 0.9660; train_kl_reg_loss: 5530.2640; train_edge_recon_loss: 259180.7437; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264711.0076; train_optim_loss: 264711.0076; val_kl_reg_loss: 5332.7540; val_edge_recon_loss: 259598.7060; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264931.4594; val_optim_loss: 264931.4594
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9943; val_auprc_score: 0.9934; val_best_acc_score: 0.9673; val_best_f1_score: 0.9675; train_kl_reg_loss: 5527.8300; train_edge_recon_loss: 259014.5944; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264542.4246; train_optim_loss: 264542.4246; val_kl_reg_loss: 5490.1564; val_edge_recon_loss: 259570.3923; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265060.5494; val_optim_loss: 265060.5494
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9948; val_auprc_score: 0.9940; val_best_acc_score: 0.9684; val_best_f1_score: 0.9686; train_kl_reg_loss: 5528.1481; train_edge_recon_loss: 258938.0276; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264466.1758; train_optim_loss: 264466.1758; val_kl_reg_loss: 5242.7844; val_edge_recon_loss: 259567.2354; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264810.0213; val_optim_loss: 264810.0213
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9952; val_auprc_score: 0.9943; val_best_acc_score: 0.9712; val_best_f1_score: 0.9714; train_kl_reg_loss: 5523.1295; train_edge_recon_loss: 258863.8870; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264387.0160; train_optim_loss: 264387.0160; val_kl_reg_loss: 5337.0499; val_edge_recon_loss: 259297.6952; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264634.7445; val_optim_loss: 264634.7445
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9954; val_auprc_score: 0.9946; val_best_acc_score: 0.9711; val_best_f1_score: 0.9712; train_kl_reg_loss: 5520.9180; train_edge_recon_loss: 258769.9713; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264290.8888; train_optim_loss: 264290.8888; val_kl_reg_loss: 5524.9771; val_edge_recon_loss: 259291.8448; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264816.8217; val_optim_loss: 264816.8217
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9954; val_auprc_score: 0.9948; val_best_acc_score: 0.9704; val_best_f1_score: 0.9706; train_kl_reg_loss: 5524.0377; train_edge_recon_loss: 258621.7838; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264145.8215; train_optim_loss: 264145.8215; val_kl_reg_loss: 5311.4377; val_edge_recon_loss: 259442.7173; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264754.1554; val_optim_loss: 264754.1554
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9956; val_auprc_score: 0.9950; val_best_acc_score: 0.9715; val_best_f1_score: 0.9717; train_kl_reg_loss: 5522.7710; train_edge_recon_loss: 258660.4871; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264183.2581; train_optim_loss: 264183.2581; val_kl_reg_loss: 5481.5049; val_edge_recon_loss: 259157.2193; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264638.7248; val_optim_loss: 264638.7248
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9957; val_auprc_score: 0.9950; val_best_acc_score: 0.9718; val_best_f1_score: 0.9719; train_kl_reg_loss: 5521.6766; train_edge_recon_loss: 258537.2366; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264058.9136; train_optim_loss: 264058.9136; val_kl_reg_loss: 5506.6322; val_edge_recon_loss: 259082.5871; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264589.2189; val_optim_loss: 264589.2189
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9960; val_auprc_score: 0.9952; val_best_acc_score: 0.9734; val_best_f1_score: 0.9735; train_kl_reg_loss: 5520.5477; train_edge_recon_loss: 258532.2623; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264052.8100; train_optim_loss: 264052.8100; val_kl_reg_loss: 5511.3513; val_edge_recon_loss: 258691.8627; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264203.2127; val_optim_loss: 264203.2127
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9959; val_auprc_score: 0.9952; val_best_acc_score: 0.9731; val_best_f1_score: 0.9732; train_kl_reg_loss: 5523.8936; train_edge_recon_loss: 258365.9501; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263889.8436; train_optim_loss: 263889.8436; val_kl_reg_loss: 5491.0363; val_edge_recon_loss: 258741.7554; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264232.7923; val_optim_loss: 264232.7923
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9961; val_auprc_score: 0.9955; val_best_acc_score: 0.9736; val_best_f1_score: 0.9737; train_kl_reg_loss: 5518.1849; train_edge_recon_loss: 258421.0206; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263939.2053; train_optim_loss: 263939.2053; val_kl_reg_loss: 5497.0167; val_edge_recon_loss: 258722.1950; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264219.2118; val_optim_loss: 264219.2118
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9961; val_auprc_score: 0.9954; val_best_acc_score: 0.9737; val_best_f1_score: 0.9739; train_kl_reg_loss: 5520.4464; train_edge_recon_loss: 258292.3090; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263812.7555; train_optim_loss: 263812.7555; val_kl_reg_loss: 5549.9110; val_edge_recon_loss: 258683.1637; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264233.0745; val_optim_loss: 264233.0745
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9960; val_auprc_score: 0.9954; val_best_acc_score: 0.9731; val_best_f1_score: 0.9733; train_kl_reg_loss: 5520.5142; train_edge_recon_loss: 258283.5005; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263804.0142; train_optim_loss: 263804.0142; val_kl_reg_loss: 5642.5342; val_edge_recon_loss: 258676.0137; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264318.5467; val_optim_loss: 264318.5467

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9967; val_auprc_score: 0.9963; val_best_acc_score: 0.9764; val_best_f1_score: 0.9765; train_kl_reg_loss: 5507.9165; train_edge_recon_loss: 257882.2219; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263390.1382; train_optim_loss: 263390.1382; val_kl_reg_loss: 5406.1176; val_edge_recon_loss: 258125.1758; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263531.2935; val_optim_loss: 263531.2935
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9967; val_auprc_score: 0.9961; val_best_acc_score: 0.9767; val_best_f1_score: 0.9768; train_kl_reg_loss: 5491.5242; train_edge_recon_loss: 257849.0065; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263340.5310; train_optim_loss: 263340.5310; val_kl_reg_loss: 5420.6436; val_edge_recon_loss: 258349.6991; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263770.3438; val_optim_loss: 263770.3438
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9966; val_auprc_score: 0.9960; val_best_acc_score: 0.9773; val_best_f1_score: 0.9774; train_kl_reg_loss: 5488.3808; train_edge_recon_loss: 257813.3300; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263301.7109; train_optim_loss: 263301.7109; val_kl_reg_loss: 5430.7673; val_edge_recon_loss: 257916.5005; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263347.2688; val_optim_loss: 263347.2688
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9968; val_auprc_score: 0.9961; val_best_acc_score: 0.9775; val_best_f1_score: 0.9776; train_kl_reg_loss: 5485.6849; train_edge_recon_loss: 257794.5123; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263280.1970; train_optim_loss: 263280.1970; val_kl_reg_loss: 5449.0021; val_edge_recon_loss: 258079.2642; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263528.2658; val_optim_loss: 263528.2658
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9968; val_auprc_score: 0.9960; val_best_acc_score: 0.9772; val_best_f1_score: 0.9773; train_kl_reg_loss: 5482.0537; train_edge_recon_loss: 257738.1792; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263220.2326; train_optim_loss: 263220.2326; val_kl_reg_loss: 5441.1402; val_edge_recon_loss: 258012.7873; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263453.9269; val_optim_loss: 263453.9269
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9969; val_auprc_score: 0.9963; val_best_acc_score: 0.9774; val_best_f1_score: 0.9775; train_kl_reg_loss: 5482.5798; train_edge_recon_loss: 257715.1861; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263197.7659; train_optim_loss: 263197.7659; val_kl_reg_loss: 5436.7992; val_edge_recon_loss: 258214.2218; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263651.0209; val_optim_loss: 263651.0209
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9968; val_auprc_score: 0.9962; val_best_acc_score: 0.9777; val_best_f1_score: 0.9778; train_kl_reg_loss: 5480.2367; train_edge_recon_loss: 257741.8181; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263222.0547; train_optim_loss: 263222.0547; val_kl_reg_loss: 5446.2916; val_edge_recon_loss: 258201.9847; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263648.2763; val_optim_loss: 263648.2763

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9969; val_auprc_score: 0.9963; val_best_acc_score: 0.9776; val_best_f1_score: 0.9777; train_kl_reg_loss: 5477.4866; train_edge_recon_loss: 257687.6678; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263165.1541; train_optim_loss: 263165.1541; val_kl_reg_loss: 5446.7698; val_edge_recon_loss: 258194.3314; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263641.1011; val_optim_loss: 263641.1011
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9970; val_auprc_score: 0.9966; val_best_acc_score: 0.9780; val_best_f1_score: 0.9781; train_kl_reg_loss: 5475.6600; train_edge_recon_loss: 257756.3196; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263231.9796; train_optim_loss: 263231.9796; val_kl_reg_loss: 5443.2288; val_edge_recon_loss: 258024.1579; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263467.3870; val_optim_loss: 263467.3870
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9971; val_auprc_score: 0.9966; val_best_acc_score: 0.9784; val_best_f1_score: 0.9785; train_kl_reg_loss: 5477.1982; train_edge_recon_loss: 257684.1609; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263161.3597; train_optim_loss: 263161.3597; val_kl_reg_loss: 5445.0313; val_edge_recon_loss: 257845.7617; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263290.7927; val_optim_loss: 263290.7927
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9971; val_auprc_score: 0.9967; val_best_acc_score: 0.9783; val_best_f1_score: 0.9784; train_kl_reg_loss: 5475.8524; train_edge_recon_loss: 257624.1430; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263099.9952; train_optim_loss: 263099.9952; val_kl_reg_loss: 5440.3020; val_edge_recon_loss: 257789.4302; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263229.7317; val_optim_loss: 263229.7317
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9970; val_auprc_score: 0.9963; val_best_acc_score: 0.9778; val_best_f1_score: 0.9779; train_kl_reg_loss: 5474.4388; train_edge_recon_loss: 257771.4536; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263245.8926; train_optim_loss: 263245.8926; val_kl_reg_loss: 5427.6223; val_edge_recon_loss: 258000.0821; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263427.7042; val_optim_loss: 263427.7042
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9971; val_auprc_score: 0.9966; val_best_acc_score: 0.9777; val_best_f1_score: 0.9778; train_kl_reg_loss: 5477.6004; train_edge_recon_loss: 257667.3980; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263144.9983; train_optim_loss: 263144.9983; val_kl_reg_loss: 5434.9941; val_edge_recon_loss: 258110.1517; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263545.1461; val_optim_loss: 263545.1461
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9969; val_auprc_score: 0.9963; val_best_acc_score: 0.9777; val_best_f1_score: 0.9778; train_kl_reg_loss: 5476.5598; train_edge_recon_loss: 257716.6871; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263193.2469; train_optim_loss: 263193.2469; val_kl_reg_loss: 5438.7058; val_edge_recon_loss: 257970.3910; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263409.0966; val_optim_loss: 263409.0966
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9970; val_auprc_score: 0.9965; val_best_acc_score: 0.9780; val_best_f1_score: 0.9781; train_kl_reg_loss: 5476.5326; train_edge_recon_loss: 257678.7005; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263155.2332; train_optim_loss: 263155.2332; val_kl_reg_loss: 5448.9773; val_edge_recon_loss: 257951.6540; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263400.6316; val_optim_loss: 263400.6316

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9971; val_auprc_score: 0.9964; val_best_acc_score: 0.9781; val_best_f1_score: 0.9782; train_kl_reg_loss: 5479.1279; train_edge_recon_loss: 257653.9567; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263133.0845; train_optim_loss: 263133.0845; val_kl_reg_loss: 5442.7756; val_edge_recon_loss: 257988.4369; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263431.2120; val_optim_loss: 263431.2120
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9971; val_auprc_score: 0.9966; val_best_acc_score: 0.9781; val_best_f1_score: 0.9782; train_kl_reg_loss: 5477.7468; train_edge_recon_loss: 257707.9438; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263185.6909; train_optim_loss: 263185.6909; val_kl_reg_loss: 5432.0714; val_edge_recon_loss: 257989.1995; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263421.2711; val_optim_loss: 263421.2711
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9968; val_auprc_score: 0.9962; val_best_acc_score: 0.9776; val_best_f1_score: 0.9776; train_kl_reg_loss: 5476.5724; train_edge_recon_loss: 257643.2176; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263119.7899; train_optim_loss: 263119.7899; val_kl_reg_loss: 5441.6217; val_edge_recon_loss: 258045.5454; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263487.1675; val_optim_loss: 263487.1675
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9969; val_auprc_score: 0.9963; val_best_acc_score: 0.9779; val_best_f1_score: 0.9780; train_kl_reg_loss: 5477.8710; train_edge_recon_loss: 257634.7083; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263112.5787; train_optim_loss: 263112.5787; val_kl_reg_loss: 5439.2626; val_edge_recon_loss: 257984.6352; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263423.8980; val_optim_loss: 263423.8980

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 283 min 5 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
Val AUROC score: 0.9970
Val AUPRC score: 0.9965
Val best accuracy score: 0.9778
Val best F1 score: 0.9779
Val gene expr MSE score: 14.3850

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
