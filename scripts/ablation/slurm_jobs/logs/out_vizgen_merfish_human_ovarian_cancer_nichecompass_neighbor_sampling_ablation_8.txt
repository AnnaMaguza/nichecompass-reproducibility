None
Run timestamp: 04082023_232911_8.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_8']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_hidden: 500, n_latent: 1385, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1385, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 500
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1385, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 500

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9915; val_auprc_score: 0.9914; val_best_acc_score: 0.9542; val_best_f1_score: 0.9544; train_kl_reg_loss: 8037.6248; train_edge_recon_loss: 269884.6872; train_gene_expr_recon_loss: 202767.1552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 480689.4668; train_optim_loss: 480689.4668; val_kl_reg_loss: 7324.0323; val_edge_recon_loss: 265106.4583; val_gene_expr_recon_loss: 185324.1309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 457754.6212; val_optim_loss: 457754.6212
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9940; val_auprc_score: 0.9938; val_best_acc_score: 0.9621; val_best_f1_score: 0.9623; train_kl_reg_loss: 7266.2872; train_edge_recon_loss: 263420.8243; train_gene_expr_recon_loss: 181814.8605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 452501.9721; train_optim_loss: 452501.9721; val_kl_reg_loss: 6862.5342; val_edge_recon_loss: 263320.8665; val_gene_expr_recon_loss: 178545.4993; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 448728.9003; val_optim_loss: 448728.9003
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9948; val_auprc_score: 0.9946; val_best_acc_score: 0.9652; val_best_f1_score: 0.9653; train_kl_reg_loss: 7004.8081; train_edge_recon_loss: 262084.4339; train_gene_expr_recon_loss: 177872.1130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446961.3551; train_optim_loss: 446961.3551; val_kl_reg_loss: 6874.3548; val_edge_recon_loss: 262624.0894; val_gene_expr_recon_loss: 176259.6677; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445758.1126; val_optim_loss: 445758.1126
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9955; val_auprc_score: 0.9952; val_best_acc_score: 0.9686; val_best_f1_score: 0.9686; train_kl_reg_loss: 6897.3145; train_edge_recon_loss: 261421.0121; train_gene_expr_recon_loss: 176554.1170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444872.4437; train_optim_loss: 444872.4437; val_kl_reg_loss: 6615.8177; val_edge_recon_loss: 262111.5932; val_gene_expr_recon_loss: 175668.3035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444395.7143; val_optim_loss: 444395.7143
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9958; val_auprc_score: 0.9956; val_best_acc_score: 0.9692; val_best_f1_score: 0.9694; train_kl_reg_loss: 6854.8848; train_edge_recon_loss: 261040.5570; train_gene_expr_recon_loss: 175938.2478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443833.6896; train_optim_loss: 443833.6896; val_kl_reg_loss: 6863.7240; val_edge_recon_loss: 261611.0963; val_gene_expr_recon_loss: 175129.9073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443604.7276; val_optim_loss: 443604.7276
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9963; val_auprc_score: 0.9958; val_best_acc_score: 0.9716; val_best_f1_score: 0.9716; train_kl_reg_loss: 6829.0589; train_edge_recon_loss: 260737.3690; train_gene_expr_recon_loss: 175580.9357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443147.3628; train_optim_loss: 443147.3628; val_kl_reg_loss: 6739.9615; val_edge_recon_loss: 261341.4023; val_gene_expr_recon_loss: 174694.6412; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442776.0052; val_optim_loss: 442776.0052
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9964; val_auprc_score: 0.9961; val_best_acc_score: 0.9719; val_best_f1_score: 0.9720; train_kl_reg_loss: 6825.2453; train_edge_recon_loss: 260470.8802; train_gene_expr_recon_loss: 175314.6504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 442610.7759; train_optim_loss: 442610.7759; val_kl_reg_loss: 6842.4293; val_edge_recon_loss: 260988.8539; val_gene_expr_recon_loss: 174686.5939; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442517.8770; val_optim_loss: 442517.8770
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9964; val_auprc_score: 0.9961; val_best_acc_score: 0.9719; val_best_f1_score: 0.9720; train_kl_reg_loss: 6818.6942; train_edge_recon_loss: 260335.6678; train_gene_expr_recon_loss: 175176.3484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 442330.7100; train_optim_loss: 442330.7100; val_kl_reg_loss: 6790.7581; val_edge_recon_loss: 260985.6358; val_gene_expr_recon_loss: 174436.5232; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442212.9170; val_optim_loss: 442212.9170
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9965; val_auprc_score: 0.9962; val_best_acc_score: 0.9731; val_best_f1_score: 0.9732; train_kl_reg_loss: 6815.6882; train_edge_recon_loss: 260170.9404; train_gene_expr_recon_loss: 174958.0423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441944.6707; train_optim_loss: 441944.6707; val_kl_reg_loss: 6786.4381; val_edge_recon_loss: 260925.9566; val_gene_expr_recon_loss: 174165.1189; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441877.5129; val_optim_loss: 441877.5129
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9966; val_auprc_score: 0.9963; val_best_acc_score: 0.9735; val_best_f1_score: 0.9736; train_kl_reg_loss: 6811.8751; train_edge_recon_loss: 260046.5206; train_gene_expr_recon_loss: 174844.6247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441703.0206; train_optim_loss: 441703.0206; val_kl_reg_loss: 6650.0915; val_edge_recon_loss: 260703.3445; val_gene_expr_recon_loss: 174309.0836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441662.5184; val_optim_loss: 441662.5184
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9966; val_auprc_score: 0.9963; val_best_acc_score: 0.9731; val_best_f1_score: 0.9733; train_kl_reg_loss: 6813.4764; train_edge_recon_loss: 259942.8352; train_gene_expr_recon_loss: 174773.0466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441529.3583; train_optim_loss: 441529.3583; val_kl_reg_loss: 6849.8151; val_edge_recon_loss: 260945.6950; val_gene_expr_recon_loss: 174213.2903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442008.8006; val_optim_loss: 442008.8006
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9969; val_auprc_score: 0.9965; val_best_acc_score: 0.9752; val_best_f1_score: 0.9753; train_kl_reg_loss: 6815.0306; train_edge_recon_loss: 259868.8477; train_gene_expr_recon_loss: 174737.4873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441421.3656; train_optim_loss: 441421.3656; val_kl_reg_loss: 6628.6386; val_edge_recon_loss: 260406.4705; val_gene_expr_recon_loss: 174087.6268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441122.7359; val_optim_loss: 441122.7359
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9967; val_auprc_score: 0.9964; val_best_acc_score: 0.9739; val_best_f1_score: 0.9740; train_kl_reg_loss: 6813.9460; train_edge_recon_loss: 259815.9637; train_gene_expr_recon_loss: 174558.2196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441188.1296; train_optim_loss: 441188.1296; val_kl_reg_loss: 6814.4664; val_edge_recon_loss: 260454.5455; val_gene_expr_recon_loss: 174205.7680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441474.7790; val_optim_loss: 441474.7790
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9969; val_auprc_score: 0.9966; val_best_acc_score: 0.9749; val_best_f1_score: 0.9750; train_kl_reg_loss: 6811.6814; train_edge_recon_loss: 259707.9441; train_gene_expr_recon_loss: 174656.9117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441176.5372; train_optim_loss: 441176.5372; val_kl_reg_loss: 6809.0354; val_edge_recon_loss: 260353.3182; val_gene_expr_recon_loss: 173707.8368; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440870.1898; val_optim_loss: 440870.1898
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9970; val_auprc_score: 0.9966; val_best_acc_score: 0.9758; val_best_f1_score: 0.9759; train_kl_reg_loss: 6809.4883; train_edge_recon_loss: 259717.6464; train_gene_expr_recon_loss: 174556.4982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441083.6327; train_optim_loss: 441083.6327; val_kl_reg_loss: 6763.9840; val_edge_recon_loss: 260298.6858; val_gene_expr_recon_loss: 173683.7979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440746.4678; val_optim_loss: 440746.4678
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9970; val_auprc_score: 0.9968; val_best_acc_score: 0.9762; val_best_f1_score: 0.9763; train_kl_reg_loss: 6810.4665; train_edge_recon_loss: 259558.8873; train_gene_expr_recon_loss: 174623.7790; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440993.1328; train_optim_loss: 440993.1328; val_kl_reg_loss: 6766.1861; val_edge_recon_loss: 260439.4359; val_gene_expr_recon_loss: 174959.3493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442164.9706; val_optim_loss: 442164.9706
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9971; val_auprc_score: 0.9970; val_best_acc_score: 0.9759; val_best_f1_score: 0.9760; train_kl_reg_loss: 6811.7499; train_edge_recon_loss: 259524.0458; train_gene_expr_recon_loss: 175040.0105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441375.8061; train_optim_loss: 441375.8061; val_kl_reg_loss: 6768.1517; val_edge_recon_loss: 260464.0491; val_gene_expr_recon_loss: 172822.4063; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440054.6064; val_optim_loss: 440054.6064
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9970; val_auprc_score: 0.9967; val_best_acc_score: 0.9759; val_best_f1_score: 0.9760; train_kl_reg_loss: 6810.7104; train_edge_recon_loss: 259475.2688; train_gene_expr_recon_loss: 175631.0773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441917.0565; train_optim_loss: 441917.0565; val_kl_reg_loss: 6705.8884; val_edge_recon_loss: 260473.1602; val_gene_expr_recon_loss: 182080.7876; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 449259.8362; val_optim_loss: 449259.8362
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9971; val_auprc_score: 0.9968; val_best_acc_score: 0.9759; val_best_f1_score: 0.9760; train_kl_reg_loss: 6808.8110; train_edge_recon_loss: 259435.5765; train_gene_expr_recon_loss: 175850.2291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 442094.6164; train_optim_loss: 442094.6164; val_kl_reg_loss: 6726.3795; val_edge_recon_loss: 260163.0739; val_gene_expr_recon_loss: 183710.1461; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 450599.5993; val_optim_loss: 450599.5993
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9971; val_auprc_score: 0.9969; val_best_acc_score: 0.9761; val_best_f1_score: 0.9762; train_kl_reg_loss: 6806.4159; train_edge_recon_loss: 259388.6667; train_gene_expr_recon_loss: 175876.9101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 442071.9923; train_optim_loss: 442071.9923; val_kl_reg_loss: 6820.4710; val_edge_recon_loss: 260219.3185; val_gene_expr_recon_loss: 191452.7371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 458492.5260; val_optim_loss: 458492.5260
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9971; val_auprc_score: 0.9969; val_best_acc_score: 0.9764; val_best_f1_score: 0.9765; train_kl_reg_loss: 6803.4569; train_edge_recon_loss: 259398.5617; train_gene_expr_recon_loss: 174970.7655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441172.7842; train_optim_loss: 441172.7842; val_kl_reg_loss: 6806.5814; val_edge_recon_loss: 259916.7826; val_gene_expr_recon_loss: 175861.4221; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442584.7870; val_optim_loss: 442584.7870

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9973; val_auprc_score: 0.9971; val_best_acc_score: 0.9775; val_best_f1_score: 0.9776; train_kl_reg_loss: 6841.6094; train_edge_recon_loss: 258979.9794; train_gene_expr_recon_loss: 172089.8579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437911.4465; train_optim_loss: 437911.4465; val_kl_reg_loss: 6788.6358; val_edge_recon_loss: 259798.5023; val_gene_expr_recon_loss: 174622.4920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441209.6296; val_optim_loss: 441209.6296
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9975; val_auprc_score: 0.9973; val_best_acc_score: 0.9782; val_best_f1_score: 0.9783; train_kl_reg_loss: 6827.9340; train_edge_recon_loss: 258986.0859; train_gene_expr_recon_loss: 173271.2768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 439085.2966; train_optim_loss: 439085.2966; val_kl_reg_loss: 6789.4577; val_edge_recon_loss: 259689.4382; val_gene_expr_recon_loss: 159501.7942; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 425980.6905; val_optim_loss: 425980.6905
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9976; val_auprc_score: 0.9975; val_best_acc_score: 0.9789; val_best_f1_score: 0.9789; train_kl_reg_loss: 6820.7282; train_edge_recon_loss: 258962.8019; train_gene_expr_recon_loss: 166241.1669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432024.6969; train_optim_loss: 432024.6969; val_kl_reg_loss: 6787.3248; val_edge_recon_loss: 259601.4217; val_gene_expr_recon_loss: 158947.8150; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 425336.5618; val_optim_loss: 425336.5618
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9975; val_auprc_score: 0.9973; val_best_acc_score: 0.9782; val_best_f1_score: 0.9783; train_kl_reg_loss: 6814.2779; train_edge_recon_loss: 258925.8131; train_gene_expr_recon_loss: 166087.9030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431827.9939; train_optim_loss: 431827.9939; val_kl_reg_loss: 6784.3102; val_edge_recon_loss: 259634.6582; val_gene_expr_recon_loss: 190943.3795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 457362.3485; val_optim_loss: 457362.3485
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9974; val_auprc_score: 0.9971; val_best_acc_score: 0.9785; val_best_f1_score: 0.9786; train_kl_reg_loss: 6814.2386; train_edge_recon_loss: 258968.5400; train_gene_expr_recon_loss: 184261.7924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 450044.5710; train_optim_loss: 450044.5710; val_kl_reg_loss: 6744.8680; val_edge_recon_loss: 259728.9259; val_gene_expr_recon_loss: 142774.1292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 409247.9238; val_optim_loss: 409247.9238
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9976; val_auprc_score: 0.9974; val_best_acc_score: 0.9788; val_best_f1_score: 0.9789; train_kl_reg_loss: 6805.4072; train_edge_recon_loss: 259014.7185; train_gene_expr_recon_loss: 170510.5305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436330.6564; train_optim_loss: 436330.6564; val_kl_reg_loss: 6759.7760; val_edge_recon_loss: 259528.4369; val_gene_expr_recon_loss: 169155.6965; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435443.9098; val_optim_loss: 435443.9098
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9976; val_auprc_score: 0.9973; val_best_acc_score: 0.9790; val_best_f1_score: 0.9791; train_kl_reg_loss: 6804.2121; train_edge_recon_loss: 258922.1643; train_gene_expr_recon_loss: 173823.3225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 439549.6987; train_optim_loss: 439549.6987; val_kl_reg_loss: 6756.8868; val_edge_recon_loss: 259596.3383; val_gene_expr_recon_loss: 126874.3889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 393227.6134; val_optim_loss: 393227.6134
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9975; val_auprc_score: 0.9974; val_best_acc_score: 0.9784; val_best_f1_score: 0.9784; train_kl_reg_loss: 6807.6080; train_edge_recon_loss: 258902.2729; train_gene_expr_recon_loss: 147184.7260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 412894.6072; train_optim_loss: 412894.6072; val_kl_reg_loss: 6792.7312; val_edge_recon_loss: 259703.5945; val_gene_expr_recon_loss: 176462.2164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442958.5431; val_optim_loss: 442958.5431
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9976; val_auprc_score: 0.9973; val_best_acc_score: 0.9791; val_best_f1_score: 0.9792; train_kl_reg_loss: 6806.5870; train_edge_recon_loss: 258857.5160; train_gene_expr_recon_loss: 160678.1325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 426342.2349; train_optim_loss: 426342.2349; val_kl_reg_loss: 6764.6996; val_edge_recon_loss: 259594.0810; val_gene_expr_recon_loss: 185488.3582; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 451847.1393; val_optim_loss: 451847.1393
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9976; val_auprc_score: 0.9974; val_best_acc_score: 0.9788; val_best_f1_score: 0.9789; train_kl_reg_loss: 6799.1380; train_edge_recon_loss: 258929.8957; train_gene_expr_recon_loss: 166379.5372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432108.5709; train_optim_loss: 432108.5709; val_kl_reg_loss: 6772.3311; val_edge_recon_loss: 259518.1256; val_gene_expr_recon_loss: 165310.4718; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431600.9289; val_optim_loss: 431600.9289
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9976; val_auprc_score: 0.9974; val_best_acc_score: 0.9787; val_best_f1_score: 0.9787; train_kl_reg_loss: 6800.2962; train_edge_recon_loss: 258839.4162; train_gene_expr_recon_loss: 156455.7443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 422095.4566; train_optim_loss: 422095.4566; val_kl_reg_loss: 6761.2492; val_edge_recon_loss: 259621.2653; val_gene_expr_recon_loss: 168873.3736; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435255.8883; val_optim_loss: 435255.8883

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9977; val_auprc_score: 0.9975; val_best_acc_score: 0.9791; val_best_f1_score: 0.9792; train_kl_reg_loss: 6798.1272; train_edge_recon_loss: 258803.2440; train_gene_expr_recon_loss: 162238.8647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427840.2359; train_optim_loss: 427840.2359; val_kl_reg_loss: 6768.4872; val_edge_recon_loss: 259562.8134; val_gene_expr_recon_loss: 164463.8639; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 430795.1655; val_optim_loss: 430795.1655
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9975; val_auprc_score: 0.9973; val_best_acc_score: 0.9789; val_best_f1_score: 0.9790; train_kl_reg_loss: 6797.5477; train_edge_recon_loss: 258825.8784; train_gene_expr_recon_loss: 156793.7683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 422417.1942; train_optim_loss: 422417.1942; val_kl_reg_loss: 6765.3568; val_edge_recon_loss: 259519.0166; val_gene_expr_recon_loss: 183197.4181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 449481.7914; val_optim_loss: 449481.7914
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9977; val_auprc_score: 0.9975; val_best_acc_score: 0.9795; val_best_f1_score: 0.9796; train_kl_reg_loss: 6799.2631; train_edge_recon_loss: 258822.8533; train_gene_expr_recon_loss: 178061.4816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443683.5978; train_optim_loss: 443683.5978; val_kl_reg_loss: 6765.8227; val_edge_recon_loss: 259425.3240; val_gene_expr_recon_loss: 150965.3110; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 417156.4572; val_optim_loss: 417156.4572
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9976; val_auprc_score: 0.9973; val_best_acc_score: 0.9792; val_best_f1_score: 0.9793; train_kl_reg_loss: 6796.5901; train_edge_recon_loss: 258895.0557; train_gene_expr_recon_loss: 154543.6305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 420235.2765; train_optim_loss: 420235.2765; val_kl_reg_loss: 6758.4816; val_edge_recon_loss: 259471.0202; val_gene_expr_recon_loss: 176044.8829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442274.3844; val_optim_loss: 442274.3844

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 273 min 32 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
val AUROC score: 0.9976
val AUPRC score: 0.9973
val best accuracy score: 0.9792
val best F1 score: 0.9793
val target rna MSE score: 3.9912
val source rna MSE score: 0.4800

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
