None
Run timestamp: 02072023_042616_2002.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_2002']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9816; val_auprc_score: 0.9775; val_best_acc_score: 0.9394; val_best_f1_score: 0.9410; train_kl_reg_loss: 5198.5529; train_edge_recon_loss: 264892.4090; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270090.9620; train_optim_loss: 270090.9620; val_kl_reg_loss: 5211.6026; val_edge_recon_loss: 261318.3940; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 266529.9967; val_optim_loss: 266529.9967
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9866; val_auprc_score: 0.9833; val_best_acc_score: 0.9507; val_best_f1_score: 0.9518; train_kl_reg_loss: 5244.3647; train_edge_recon_loss: 260928.8551; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266173.2197; train_optim_loss: 266173.2197; val_kl_reg_loss: 5192.8415; val_edge_recon_loss: 260485.7198; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265678.5604; val_optim_loss: 265678.5604
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9892; val_auprc_score: 0.9863; val_best_acc_score: 0.9567; val_best_f1_score: 0.9574; train_kl_reg_loss: 5244.0700; train_edge_recon_loss: 260138.4770; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265382.5469; train_optim_loss: 265382.5469; val_kl_reg_loss: 5251.7967; val_edge_recon_loss: 259557.6066; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264809.4024; val_optim_loss: 264809.4024
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9899; val_auprc_score: 0.9872; val_best_acc_score: 0.9597; val_best_f1_score: 0.9604; train_kl_reg_loss: 5240.8109; train_edge_recon_loss: 259772.3044; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265013.1150; train_optim_loss: 265013.1150; val_kl_reg_loss: 5282.4690; val_edge_recon_loss: 259708.0909; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264990.5600; val_optim_loss: 264990.5600
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9904; val_auprc_score: 0.9879; val_best_acc_score: 0.9609; val_best_f1_score: 0.9615; train_kl_reg_loss: 5244.2612; train_edge_recon_loss: 259419.1248; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264663.3857; train_optim_loss: 264663.3857; val_kl_reg_loss: 5072.1307; val_edge_recon_loss: 259055.9226; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264128.0535; val_optim_loss: 264128.0535
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9911; val_auprc_score: 0.9886; val_best_acc_score: 0.9634; val_best_f1_score: 0.9641; train_kl_reg_loss: 5252.6498; train_edge_recon_loss: 259125.1931; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264377.8427; train_optim_loss: 264377.8427; val_kl_reg_loss: 5453.5156; val_edge_recon_loss: 259035.3621; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264488.8780; val_optim_loss: 264488.8780
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9923; val_auprc_score: 0.9902; val_best_acc_score: 0.9668; val_best_f1_score: 0.9672; train_kl_reg_loss: 5255.3880; train_edge_recon_loss: 258957.3191; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264212.7070; train_optim_loss: 264212.7070; val_kl_reg_loss: 5267.7882; val_edge_recon_loss: 258440.8976; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263708.6857; val_optim_loss: 263708.6857
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9923; val_auprc_score: 0.9901; val_best_acc_score: 0.9671; val_best_f1_score: 0.9676; train_kl_reg_loss: 5258.1956; train_edge_recon_loss: 258831.1787; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264089.3743; train_optim_loss: 264089.3743; val_kl_reg_loss: 5216.7561; val_edge_recon_loss: 258484.9434; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263701.6993; val_optim_loss: 263701.6993
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9929; val_auprc_score: 0.9906; val_best_acc_score: 0.9687; val_best_f1_score: 0.9692; train_kl_reg_loss: 5261.5124; train_edge_recon_loss: 258599.2570; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263860.7692; train_optim_loss: 263860.7692; val_kl_reg_loss: 5273.6742; val_edge_recon_loss: 258422.4993; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263696.1734; val_optim_loss: 263696.1734
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9929; val_auprc_score: 0.9908; val_best_acc_score: 0.9686; val_best_f1_score: 0.9691; train_kl_reg_loss: 5258.5394; train_edge_recon_loss: 258582.1247; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263840.6640; train_optim_loss: 263840.6640; val_kl_reg_loss: 5153.1560; val_edge_recon_loss: 258376.4400; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263529.5954; val_optim_loss: 263529.5954
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9927; val_auprc_score: 0.9903; val_best_acc_score: 0.9690; val_best_f1_score: 0.9694; train_kl_reg_loss: 5262.1384; train_edge_recon_loss: 258442.9769; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263705.1154; train_optim_loss: 263705.1154; val_kl_reg_loss: 5225.5619; val_edge_recon_loss: 257945.1717; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263170.7342; val_optim_loss: 263170.7342
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9932; val_auprc_score: 0.9910; val_best_acc_score: 0.9700; val_best_f1_score: 0.9705; train_kl_reg_loss: 5263.2341; train_edge_recon_loss: 258307.3132; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263570.5472; train_optim_loss: 263570.5472; val_kl_reg_loss: 5413.7894; val_edge_recon_loss: 258030.4346; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263444.2253; val_optim_loss: 263444.2253
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9928; val_auprc_score: 0.9905; val_best_acc_score: 0.9700; val_best_f1_score: 0.9705; train_kl_reg_loss: 5264.4528; train_edge_recon_loss: 258235.8621; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263500.3151; train_optim_loss: 263500.3151; val_kl_reg_loss: 5223.3550; val_edge_recon_loss: 257956.6408; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263179.9950; val_optim_loss: 263179.9950
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9936; val_auprc_score: 0.9915; val_best_acc_score: 0.9723; val_best_f1_score: 0.9727; train_kl_reg_loss: 5263.6027; train_edge_recon_loss: 258121.2716; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263384.8745; train_optim_loss: 263384.8745; val_kl_reg_loss: 5143.3343; val_edge_recon_loss: 257708.1913; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262851.5252; val_optim_loss: 262851.5252
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9939; val_auprc_score: 0.9919; val_best_acc_score: 0.9732; val_best_f1_score: 0.9736; train_kl_reg_loss: 5264.1424; train_edge_recon_loss: 258058.5741; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263322.7162; train_optim_loss: 263322.7162; val_kl_reg_loss: 5160.4955; val_edge_recon_loss: 257601.7663; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262762.2615; val_optim_loss: 262762.2615
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9931; val_auprc_score: 0.9906; val_best_acc_score: 0.9719; val_best_f1_score: 0.9723; train_kl_reg_loss: 5261.5386; train_edge_recon_loss: 258040.9567; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263302.4952; train_optim_loss: 263302.4952; val_kl_reg_loss: 5426.7026; val_edge_recon_loss: 257699.6588; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263126.3617; val_optim_loss: 263126.3617
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9936; val_auprc_score: 0.9911; val_best_acc_score: 0.9735; val_best_f1_score: 0.9739; train_kl_reg_loss: 5262.5578; train_edge_recon_loss: 257984.0355; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263246.5933; train_optim_loss: 263246.5933; val_kl_reg_loss: 5171.4805; val_edge_recon_loss: 257935.1899; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263106.6706; val_optim_loss: 263106.6706
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9939; val_auprc_score: 0.9919; val_best_acc_score: 0.9739; val_best_f1_score: 0.9743; train_kl_reg_loss: 5262.7983; train_edge_recon_loss: 257855.5359; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263118.3341; train_optim_loss: 263118.3341; val_kl_reg_loss: 5195.7134; val_edge_recon_loss: 257641.1565; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262836.8700; val_optim_loss: 262836.8700
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9938; val_auprc_score: 0.9917; val_best_acc_score: 0.9738; val_best_f1_score: 0.9741; train_kl_reg_loss: 5262.6124; train_edge_recon_loss: 257880.3117; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263142.9242; train_optim_loss: 263142.9242; val_kl_reg_loss: 5389.3003; val_edge_recon_loss: 257638.8950; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263028.1951; val_optim_loss: 263028.1951

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9943; val_auprc_score: 0.9921; val_best_acc_score: 0.9753; val_best_f1_score: 0.9756; train_kl_reg_loss: 5247.8862; train_edge_recon_loss: 257543.4434; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262791.3295; train_optim_loss: 262791.3295; val_kl_reg_loss: 5233.3848; val_edge_recon_loss: 257234.7804; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262468.1655; val_optim_loss: 262468.1655
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9946; val_auprc_score: 0.9926; val_best_acc_score: 0.9755; val_best_f1_score: 0.9758; train_kl_reg_loss: 5241.6201; train_edge_recon_loss: 257553.7888; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262795.4094; train_optim_loss: 262795.4094; val_kl_reg_loss: 5203.0732; val_edge_recon_loss: 257228.5966; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262431.6695; val_optim_loss: 262431.6695
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9944; val_auprc_score: 0.9924; val_best_acc_score: 0.9755; val_best_f1_score: 0.9758; train_kl_reg_loss: 5238.4049; train_edge_recon_loss: 257469.4682; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262707.8732; train_optim_loss: 262707.8732; val_kl_reg_loss: 5206.7434; val_edge_recon_loss: 257144.1423; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262350.8850; val_optim_loss: 262350.8850
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9944; val_auprc_score: 0.9923; val_best_acc_score: 0.9754; val_best_f1_score: 0.9757; train_kl_reg_loss: 5238.9048; train_edge_recon_loss: 257523.2784; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262762.1833; train_optim_loss: 262762.1833; val_kl_reg_loss: 5207.6418; val_edge_recon_loss: 257141.2203; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262348.8615; val_optim_loss: 262348.8615
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9949; val_auprc_score: 0.9931; val_best_acc_score: 0.9767; val_best_f1_score: 0.9769; train_kl_reg_loss: 5234.3676; train_edge_recon_loss: 257480.6297; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262714.9974; train_optim_loss: 262714.9974; val_kl_reg_loss: 5227.7147; val_edge_recon_loss: 256793.8544; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262021.5690; val_optim_loss: 262021.5690
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9944; val_auprc_score: 0.9922; val_best_acc_score: 0.9760; val_best_f1_score: 0.9763; train_kl_reg_loss: 5236.4059; train_edge_recon_loss: 257486.8944; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262723.3002; train_optim_loss: 262723.3002; val_kl_reg_loss: 5191.0154; val_edge_recon_loss: 256997.6291; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262188.6453; val_optim_loss: 262188.6453
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9944; val_auprc_score: 0.9923; val_best_acc_score: 0.9759; val_best_f1_score: 0.9762; train_kl_reg_loss: 5236.6154; train_edge_recon_loss: 257375.7450; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262612.3605; train_optim_loss: 262612.3605; val_kl_reg_loss: 5231.6545; val_edge_recon_loss: 257095.7023; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262327.3579; val_optim_loss: 262327.3579
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9946; val_auprc_score: 0.9927; val_best_acc_score: 0.9766; val_best_f1_score: 0.9769; train_kl_reg_loss: 5236.2775; train_edge_recon_loss: 257372.8910; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262609.1684; train_optim_loss: 262609.1684; val_kl_reg_loss: 5171.8632; val_edge_recon_loss: 257042.6971; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262214.5607; val_optim_loss: 262214.5607
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9947; val_auprc_score: 0.9928; val_best_acc_score: 0.9761; val_best_f1_score: 0.9763; train_kl_reg_loss: 5232.4867; train_edge_recon_loss: 257500.4189; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262732.9057; train_optim_loss: 262732.9057; val_kl_reg_loss: 5208.9748; val_edge_recon_loss: 257073.8514; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262282.8260; val_optim_loss: 262282.8260

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9949; val_auprc_score: 0.9929; val_best_acc_score: 0.9766; val_best_f1_score: 0.9769; train_kl_reg_loss: 5239.0617; train_edge_recon_loss: 257339.4274; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262578.4892; train_optim_loss: 262578.4892; val_kl_reg_loss: 5206.4548; val_edge_recon_loss: 256878.9787; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262085.4337; val_optim_loss: 262085.4337
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9947; val_auprc_score: 0.9929; val_best_acc_score: 0.9762; val_best_f1_score: 0.9765; train_kl_reg_loss: 5233.8111; train_edge_recon_loss: 257382.9492; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262616.7603; train_optim_loss: 262616.7603; val_kl_reg_loss: 5211.3900; val_edge_recon_loss: 257037.3710; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262248.7614; val_optim_loss: 262248.7614
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9948; val_auprc_score: 0.9931; val_best_acc_score: 0.9764; val_best_f1_score: 0.9767; train_kl_reg_loss: 5236.1086; train_edge_recon_loss: 257341.1106; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262577.2190; train_optim_loss: 262577.2190; val_kl_reg_loss: 5206.9665; val_edge_recon_loss: 256901.6919; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262108.6591; val_optim_loss: 262108.6591
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9949; val_auprc_score: 0.9932; val_best_acc_score: 0.9766; val_best_f1_score: 0.9769; train_kl_reg_loss: 5232.2604; train_edge_recon_loss: 257401.7162; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262633.9767; train_optim_loss: 262633.9767; val_kl_reg_loss: 5211.7640; val_edge_recon_loss: 256804.8918; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262016.6557; val_optim_loss: 262016.6557
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9946; val_auprc_score: 0.9925; val_best_acc_score: 0.9768; val_best_f1_score: 0.9771; train_kl_reg_loss: 5233.6802; train_edge_recon_loss: 257404.0751; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262637.7552; train_optim_loss: 262637.7552; val_kl_reg_loss: 5211.1374; val_edge_recon_loss: 256977.2920; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262188.4290; val_optim_loss: 262188.4290
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9948; val_auprc_score: 0.9930; val_best_acc_score: 0.9764; val_best_f1_score: 0.9767; train_kl_reg_loss: 5232.8918; train_edge_recon_loss: 257410.7601; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262643.6520; train_optim_loss: 262643.6520; val_kl_reg_loss: 5208.4222; val_edge_recon_loss: 256886.0723; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262094.4946; val_optim_loss: 262094.4946
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9946; val_auprc_score: 0.9927; val_best_acc_score: 0.9762; val_best_f1_score: 0.9765; train_kl_reg_loss: 5230.8147; train_edge_recon_loss: 257413.6471; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262644.4616; train_optim_loss: 262644.4616; val_kl_reg_loss: 5196.1723; val_edge_recon_loss: 257099.2894; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262295.4609; val_optim_loss: 262295.4609
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9948; val_auprc_score: 0.9927; val_best_acc_score: 0.9764; val_best_f1_score: 0.9767; train_kl_reg_loss: 5232.3135; train_edge_recon_loss: 257359.3895; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262591.7030; train_optim_loss: 262591.7030; val_kl_reg_loss: 5207.5598; val_edge_recon_loss: 257044.1947; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262251.7548; val_optim_loss: 262251.7548

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9948; val_auprc_score: 0.9928; val_best_acc_score: 0.9766; val_best_f1_score: 0.9769; train_kl_reg_loss: 5232.4506; train_edge_recon_loss: 257358.1782; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262590.6286; train_optim_loss: 262590.6286; val_kl_reg_loss: 5204.5504; val_edge_recon_loss: 257026.4613; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262231.0123; val_optim_loss: 262231.0123
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9946; val_auprc_score: 0.9924; val_best_acc_score: 0.9765; val_best_f1_score: 0.9767; train_kl_reg_loss: 5233.6737; train_edge_recon_loss: 257334.7246; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262568.3981; train_optim_loss: 262568.3981; val_kl_reg_loss: 5204.9596; val_edge_recon_loss: 257017.4018; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262222.3614; val_optim_loss: 262222.3614
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9947; val_auprc_score: 0.9927; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 5231.3504; train_edge_recon_loss: 257331.8307; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262563.1811; train_optim_loss: 262563.1811; val_kl_reg_loss: 5204.2291; val_edge_recon_loss: 256902.4562; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262106.6850; val_optim_loss: 262106.6850
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9948; val_auprc_score: 0.9929; val_best_acc_score: 0.9762; val_best_f1_score: 0.9764; train_kl_reg_loss: 5233.1675; train_edge_recon_loss: 257365.6123; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262598.7800; train_optim_loss: 262598.7800; val_kl_reg_loss: 5202.1585; val_edge_recon_loss: 257088.9552; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262291.1142; val_optim_loss: 262291.1142

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 435 min 25 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
Val AUROC score: 0.9948
Val AUPRC score: 0.9930
Val best accuracy score: 0.9766
Val best F1 score: 0.9769
Val gene expr MSE score: 5.0440

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
