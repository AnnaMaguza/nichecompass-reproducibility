
Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9961; val_auprc_score: 0.9957; val_best_acc_score: 0.9720; val_best_f1_score: 0.9723; train_kl_reg_loss: 3005.8090; train_edge_recon_loss: 27263.0676; train_gene_expr_recon_loss: 64350.2648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94619.1413; train_optim_loss: 94619.1413; val_kl_reg_loss: 2984.4344; val_edge_recon_loss: 26517.7215; val_gene_expr_recon_loss: 64665.5101; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94167.6662; val_optim_loss: 94167.6662
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9961; val_auprc_score: 0.9957; val_best_acc_score: 0.9725; val_best_f1_score: 0.9727; train_kl_reg_loss: 3007.1525; train_edge_recon_loss: 27261.3407; train_gene_expr_recon_loss: 64355.8286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94624.3218; train_optim_loss: 94624.3218; val_kl_reg_loss: 2985.9993; val_edge_recon_loss: 26503.7338; val_gene_expr_recon_loss: 64763.3303; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94253.0633; val_optim_loss: 94253.0633
None
Run timestamp: 01072023_221617_24.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_24']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9813; val_auprc_score: 0.9784; val_best_acc_score: 0.9337; val_best_f1_score: 0.9352; train_kl_reg_loss: 3195.0691; train_edge_recon_loss: 29109.0696; train_gene_expr_recon_loss: 71892.3232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 104196.4620; train_optim_loss: 104196.4620; val_kl_reg_loss: 3038.9188; val_edge_recon_loss: 27790.8862; val_gene_expr_recon_loss: 67439.3220; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 98269.1270; val_optim_loss: 98269.1270
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9883; val_auprc_score: 0.9868; val_best_acc_score: 0.9483; val_best_f1_score: 0.9493; train_kl_reg_loss: 2933.0704; train_edge_recon_loss: 28057.3825; train_gene_expr_recon_loss: 66712.8792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 97703.3323; train_optim_loss: 97703.3323; val_kl_reg_loss: 2881.8074; val_edge_recon_loss: 27275.6751; val_gene_expr_recon_loss: 65848.2549; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 96005.7373; val_optim_loss: 96005.7373
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9961; val_auprc_score: 0.9956; val_best_acc_score: 0.9722; val_best_f1_score: 0.9724; train_kl_reg_loss: 3007.9049; train_edge_recon_loss: 27263.7098; train_gene_expr_recon_loss: 64358.4615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94630.0761; train_optim_loss: 94630.0761; val_kl_reg_loss: 2985.0983; val_edge_recon_loss: 26515.4966; val_gene_expr_recon_loss: 64770.1588; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94270.7536; val_optim_loss: 94270.7536
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9906; val_auprc_score: 0.9894; val_best_acc_score: 0.9546; val_best_f1_score: 0.9553; train_kl_reg_loss: 2917.8953; train_edge_recon_loss: 27768.9452; train_gene_expr_recon_loss: 65778.7573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 96465.5977; train_optim_loss: 96465.5977; val_kl_reg_loss: 2890.4359; val_edge_recon_loss: 26999.8368; val_gene_expr_recon_loss: 65290.7909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 95181.0638; val_optim_loss: 95181.0638
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9962; val_auprc_score: 0.9957; val_best_acc_score: 0.9727; val_best_f1_score: 0.9729; train_kl_reg_loss: 3007.6408; train_edge_recon_loss: 27263.3825; train_gene_expr_recon_loss: 64348.2811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94619.3044; train_optim_loss: 94619.3044; val_kl_reg_loss: 2985.9490; val_edge_recon_loss: 26496.8308; val_gene_expr_recon_loss: 64698.5460; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94181.3257; val_optim_loss: 94181.3257
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9925; val_auprc_score: 0.9914; val_best_acc_score: 0.9603; val_best_f1_score: 0.9607; train_kl_reg_loss: 2915.6353; train_edge_recon_loss: 27639.6396; train_gene_expr_recon_loss: 65356.4198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 95911.6948; train_optim_loss: 95911.6948; val_kl_reg_loss: 2833.8871; val_edge_recon_loss: 26916.8379; val_gene_expr_recon_loss: 65175.6161; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94926.3412; val_optim_loss: 94926.3412
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9935; val_auprc_score: 0.9928; val_best_acc_score: 0.9632; val_best_f1_score: 0.9635; train_kl_reg_loss: 2919.9821; train_edge_recon_loss: 27555.3627; train_gene_expr_recon_loss: 65165.8898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 95641.2346; train_optim_loss: 95641.2346; val_kl_reg_loss: 2903.9510; val_edge_recon_loss: 26839.5770; val_gene_expr_recon_loss: 64803.7534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94547.2815; val_optim_loss: 94547.2815
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9961; val_auprc_score: 0.9956; val_best_acc_score: 0.9720; val_best_f1_score: 0.9722; train_kl_reg_loss: 3007.3480; train_edge_recon_loss: 27267.0159; train_gene_expr_recon_loss: 64311.7970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94586.1608; train_optim_loss: 94586.1608; val_kl_reg_loss: 2985.7514; val_edge_recon_loss: 26526.8336; val_gene_expr_recon_loss: 64756.8193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94269.4042; val_optim_loss: 94269.4042
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9936; val_auprc_score: 0.9928; val_best_acc_score: 0.9638; val_best_f1_score: 0.9642; train_kl_reg_loss: 2926.7530; train_edge_recon_loss: 27488.6022; train_gene_expr_recon_loss: 65043.2791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 95458.6344; train_optim_loss: 95458.6344; val_kl_reg_loss: 2944.3601; val_edge_recon_loss: 26732.9292; val_gene_expr_recon_loss: 64865.0521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94542.3413; val_optim_loss: 94542.3413

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9960; val_auprc_score: 0.9955; val_best_acc_score: 0.9720; val_best_f1_score: 0.9722; train_kl_reg_loss: 3008.0081; train_edge_recon_loss: 27256.5256; train_gene_expr_recon_loss: 64352.8339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94617.3675; train_optim_loss: 94617.3675; val_kl_reg_loss: 2985.7163; val_edge_recon_loss: 26500.6907; val_gene_expr_recon_loss: 64717.2715; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94203.6786; val_optim_loss: 94203.6786
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9936; val_auprc_score: 0.9927; val_best_acc_score: 0.9638; val_best_f1_score: 0.9641; train_kl_reg_loss: 2931.4954; train_edge_recon_loss: 27455.8026; train_gene_expr_recon_loss: 64920.1490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 95307.4469; train_optim_loss: 95307.4469; val_kl_reg_loss: 3042.4371; val_edge_recon_loss: 26735.7150; val_gene_expr_recon_loss: 64762.9206; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94541.0726; val_optim_loss: 94541.0726
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9945; val_auprc_score: 0.9938; val_best_acc_score: 0.9664; val_best_f1_score: 0.9669; train_kl_reg_loss: 2937.8917; train_edge_recon_loss: 27422.9110; train_gene_expr_recon_loss: 64844.8025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 95205.6054; train_optim_loss: 95205.6054; val_kl_reg_loss: 2944.7528; val_edge_recon_loss: 26742.7393; val_gene_expr_recon_loss: 64872.1152; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94559.6074; val_optim_loss: 94559.6074
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9960; val_auprc_score: 0.9955; val_best_acc_score: 0.9721; val_best_f1_score: 0.9723; train_kl_reg_loss: 3007.9608; train_edge_recon_loss: 27258.2905; train_gene_expr_recon_loss: 64349.5827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94615.8341; train_optim_loss: 94615.8341; val_kl_reg_loss: 2986.1866; val_edge_recon_loss: 26518.6278; val_gene_expr_recon_loss: 64806.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94311.3478; val_optim_loss: 94311.3478
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9946; val_auprc_score: 0.9939; val_best_acc_score: 0.9676; val_best_f1_score: 0.9680; train_kl_reg_loss: 2942.3472; train_edge_recon_loss: 27397.5368; train_gene_expr_recon_loss: 64720.2124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 95060.0965; train_optim_loss: 95060.0965; val_kl_reg_loss: 2906.3744; val_edge_recon_loss: 26708.1468; val_gene_expr_recon_loss: 64689.9399; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94304.4613; val_optim_loss: 94304.4613
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9961; val_auprc_score: 0.9956; val_best_acc_score: 0.9723; val_best_f1_score: 0.9725; train_kl_reg_loss: 3008.3334; train_edge_recon_loss: 27259.9015; train_gene_expr_recon_loss: 64346.1810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94614.4159; train_optim_loss: 94614.4159; val_kl_reg_loss: 2986.3190; val_edge_recon_loss: 26497.9146; val_gene_expr_recon_loss: 64605.2862; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94089.5201; val_optim_loss: 94089.5201
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9952; val_auprc_score: 0.9946; val_best_acc_score: 0.9691; val_best_f1_score: 0.9695; train_kl_reg_loss: 2946.6291; train_edge_recon_loss: 27374.8550; train_gene_expr_recon_loss: 64695.1352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 95016.6194; train_optim_loss: 95016.6194; val_kl_reg_loss: 2925.4044; val_edge_recon_loss: 26668.9939; val_gene_expr_recon_loss: 64587.6841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94182.0826; val_optim_loss: 94182.0826
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9960; val_auprc_score: 0.9955; val_best_acc_score: 0.9724; val_best_f1_score: 0.9726; train_kl_reg_loss: 3008.2012; train_edge_recon_loss: 27261.4012; train_gene_expr_recon_loss: 64348.1807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94617.7831; train_optim_loss: 94617.7831; val_kl_reg_loss: 2986.5459; val_edge_recon_loss: 26500.5144; val_gene_expr_recon_loss: 64727.8229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94214.8829; val_optim_loss: 94214.8829
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9950; val_auprc_score: 0.9943; val_best_acc_score: 0.9689; val_best_f1_score: 0.9693; train_kl_reg_loss: 2950.5040; train_edge_recon_loss: 27363.4012; train_gene_expr_recon_loss: 64600.5099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94914.4152; train_optim_loss: 94914.4152; val_kl_reg_loss: 2993.6780; val_edge_recon_loss: 26682.7513; val_gene_expr_recon_loss: 64660.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94336.5934; val_optim_loss: 94336.5934
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9949; val_auprc_score: 0.9943; val_best_acc_score: 0.9683; val_best_f1_score: 0.9687; train_kl_reg_loss: 2954.9744; train_edge_recon_loss: 27344.0317; train_gene_expr_recon_loss: 64611.7646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94910.7707; train_optim_loss: 94910.7707; val_kl_reg_loss: 2993.4685; val_edge_recon_loss: 26677.4614; val_gene_expr_recon_loss: 64644.8228; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94315.7527; val_optim_loss: 94315.7527
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9960; val_auprc_score: 0.9956; val_best_acc_score: 0.9719; val_best_f1_score: 0.9721; train_kl_reg_loss: 3008.0110; train_edge_recon_loss: 27265.6396; train_gene_expr_recon_loss: 64367.3941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94641.0447; train_optim_loss: 94641.0447; val_kl_reg_loss: 2986.1070; val_edge_recon_loss: 26533.0297; val_gene_expr_recon_loss: 64747.1934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94266.3300; val_optim_loss: 94266.3300
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9957; val_auprc_score: 0.9952; val_best_acc_score: 0.9709; val_best_f1_score: 0.9712; train_kl_reg_loss: 2958.7523; train_edge_recon_loss: 27335.5651; train_gene_expr_recon_loss: 64553.4861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94847.8034; train_optim_loss: 94847.8034; val_kl_reg_loss: 2942.2923; val_edge_recon_loss: 26637.1567; val_gene_expr_recon_loss: 64697.6739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94277.1230; val_optim_loss: 94277.1230
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9961; val_auprc_score: 0.9957; val_best_acc_score: 0.9726; val_best_f1_score: 0.9728; train_kl_reg_loss: 3007.8341; train_edge_recon_loss: 27259.3109; train_gene_expr_recon_loss: 64341.3700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94608.5150; train_optim_loss: 94608.5150; val_kl_reg_loss: 2986.4377; val_edge_recon_loss: 26498.0271; val_gene_expr_recon_loss: 64704.8513; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94189.3164; val_optim_loss: 94189.3164
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9954; val_auprc_score: 0.9948; val_best_acc_score: 0.9704; val_best_f1_score: 0.9707; train_kl_reg_loss: 2961.9514; train_edge_recon_loss: 27323.4825; train_gene_expr_recon_loss: 64504.9407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94790.3746; train_optim_loss: 94790.3746; val_kl_reg_loss: 2948.5641; val_edge_recon_loss: 26614.7654; val_gene_expr_recon_loss: 64614.6445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94177.9738; val_optim_loss: 94177.9738
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9960; val_auprc_score: 0.9956; val_best_acc_score: 0.9722; val_best_f1_score: 0.9724; train_kl_reg_loss: 3008.0039; train_edge_recon_loss: 27260.9086; train_gene_expr_recon_loss: 64347.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94616.5686; train_optim_loss: 94616.5686; val_kl_reg_loss: 2985.1308; val_edge_recon_loss: 26518.1414; val_gene_expr_recon_loss: 64660.0395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94163.3117; val_optim_loss: 94163.3117
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9954; val_auprc_score: 0.9948; val_best_acc_score: 0.9707; val_best_f1_score: 0.9710; train_kl_reg_loss: 2964.2302; train_edge_recon_loss: 27307.3905; train_gene_expr_recon_loss: 64493.8080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94765.4286; train_optim_loss: 94765.4286; val_kl_reg_loss: 2966.7748; val_edge_recon_loss: 26573.1960; val_gene_expr_recon_loss: 64521.0533; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94061.0244; val_optim_loss: 94061.0244
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9950; val_auprc_score: 0.9943; val_best_acc_score: 0.9697; val_best_f1_score: 0.9700; train_kl_reg_loss: 2966.4190; train_edge_recon_loss: 27307.7756; train_gene_expr_recon_loss: 64460.2343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94734.4290; train_optim_loss: 94734.4290; val_kl_reg_loss: 2977.2074; val_edge_recon_loss: 26607.2544; val_gene_expr_recon_loss: 64521.1913; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94105.6531; val_optim_loss: 94105.6531

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000004e-08.

Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9961; val_auprc_score: 0.9956; val_best_acc_score: 0.9726; val_best_f1_score: 0.9728; train_kl_reg_loss: 3007.8703; train_edge_recon_loss: 27262.3907; train_gene_expr_recon_loss: 64346.0634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94616.3244; train_optim_loss: 94616.3244; val_kl_reg_loss: 2985.8247; val_edge_recon_loss: 26495.1667; val_gene_expr_recon_loss: 64717.1591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94198.1505; val_optim_loss: 94198.1505
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9958; val_auprc_score: 0.9952; val_best_acc_score: 0.9722; val_best_f1_score: 0.9724; train_kl_reg_loss: 2969.2870; train_edge_recon_loss: 27294.4256; train_gene_expr_recon_loss: 64384.5396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94648.2522; train_optim_loss: 94648.2522; val_kl_reg_loss: 2943.3332; val_edge_recon_loss: 26608.8455; val_gene_expr_recon_loss: 64563.8830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94116.0619; val_optim_loss: 94116.0619
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9961; val_auprc_score: 0.9957; val_best_acc_score: 0.9720; val_best_f1_score: 0.9723; train_kl_reg_loss: 3007.7401; train_edge_recon_loss: 27263.5979; train_gene_expr_recon_loss: 64327.9273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94599.2653; train_optim_loss: 94599.2653; val_kl_reg_loss: 2985.9075; val_edge_recon_loss: 26497.6705; val_gene_expr_recon_loss: 64678.7099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94162.2880; val_optim_loss: 94162.2880
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9952; val_auprc_score: 0.9946; val_best_acc_score: 0.9699; val_best_f1_score: 0.9702; train_kl_reg_loss: 2972.2897; train_edge_recon_loss: 27291.2038; train_gene_expr_recon_loss: 64393.7233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94657.2168; train_optim_loss: 94657.2168; val_kl_reg_loss: 2986.7807; val_edge_recon_loss: 26592.3606; val_gene_expr_recon_loss: 64469.7860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94048.9273; val_optim_loss: 94048.9273
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9958; val_auprc_score: 0.9952; val_best_acc_score: 0.9719; val_best_f1_score: 0.9722; train_kl_reg_loss: 2974.4095; train_edge_recon_loss: 27280.0549; train_gene_expr_recon_loss: 64365.1450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94619.6095; train_optim_loss: 94619.6095; val_kl_reg_loss: 2922.5662; val_edge_recon_loss: 26599.4778; val_gene_expr_recon_loss: 64549.1229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94071.1672; val_optim_loss: 94071.1672
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9960; val_auprc_score: 0.9956; val_best_acc_score: 0.9720; val_best_f1_score: 0.9723; train_kl_reg_loss: 3007.8705; train_edge_recon_loss: 27263.1622; train_gene_expr_recon_loss: 64354.3481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94625.3808; train_optim_loss: 94625.3808; val_kl_reg_loss: 2985.7473; val_edge_recon_loss: 26504.8527; val_gene_expr_recon_loss: 64714.3129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94204.9130; val_optim_loss: 94204.9130
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9956; val_auprc_score: 0.9950; val_best_acc_score: 0.9711; val_best_f1_score: 0.9714; train_kl_reg_loss: 2975.0301; train_edge_recon_loss: 27278.8083; train_gene_expr_recon_loss: 64343.4260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94597.2645; train_optim_loss: 94597.2645; val_kl_reg_loss: 2910.4996; val_edge_recon_loss: 26582.5991; val_gene_expr_recon_loss: 64579.5601; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94072.6591; val_optim_loss: 94072.6591
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9961; val_auprc_score: 0.9957; val_best_acc_score: 0.9724; val_best_f1_score: 0.9726; train_kl_reg_loss: 3008.0804; train_edge_recon_loss: 27264.6791; train_gene_expr_recon_loss: 64389.2938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94662.0534; train_optim_loss: 94662.0534; val_kl_reg_loss: 2986.6615; val_edge_recon_loss: 26481.7813; val_gene_expr_recon_loss: 64744.2263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94212.6690; val_optim_loss: 94212.6690
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9955; val_auprc_score: 0.9950; val_best_acc_score: 0.9711; val_best_f1_score: 0.9714; train_kl_reg_loss: 2977.2878; train_edge_recon_loss: 27275.6300; train_gene_expr_recon_loss: 64337.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94590.7270; train_optim_loss: 94590.7270; val_kl_reg_loss: 2980.3836; val_edge_recon_loss: 26558.8269; val_gene_expr_recon_loss: 64584.2715; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94123.4823; val_optim_loss: 94123.4823

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1134 min 2 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
Val AUROC score: 0.9959
Val AUPRC score: 0.9953
Val best accuracy score: 0.9721
Val best F1 score: 0.9723
Val gene expr MSE score: 1.6161

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9951; val_auprc_score: 0.9944; val_best_acc_score: 0.9697; val_best_f1_score: 0.9700; train_kl_reg_loss: 2978.0778; train_edge_recon_loss: 27275.3086; train_gene_expr_recon_loss: 64336.4797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94589.8661; train_optim_loss: 94589.8661; val_kl_reg_loss: 2961.6904; val_edge_recon_loss: 26562.1717; val_gene_expr_recon_loss: 64630.1434; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94154.0056; val_optim_loss: 94154.0056

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9960; val_auprc_score: 0.9953; val_best_acc_score: 0.9724; val_best_f1_score: 0.9726; train_kl_reg_loss: 2989.7860; train_edge_recon_loss: 27230.1874; train_gene_expr_recon_loss: 63965.8646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94185.8380; train_optim_loss: 94185.8380; val_kl_reg_loss: 2978.8472; val_edge_recon_loss: 26494.7501; val_gene_expr_recon_loss: 64322.2603; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93795.8575; val_optim_loss: 93795.8575
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9959; val_auprc_score: 0.9954; val_best_acc_score: 0.9726; val_best_f1_score: 0.9728; train_kl_reg_loss: 2985.0241; train_edge_recon_loss: 27226.5332; train_gene_expr_recon_loss: 63900.4301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94111.9874; train_optim_loss: 94111.9874; val_kl_reg_loss: 2963.1258; val_edge_recon_loss: 26520.3847; val_gene_expr_recon_loss: 64222.3067; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93705.8173; val_optim_loss: 93705.8173
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9961; val_auprc_score: 0.9956; val_best_acc_score: 0.9728; val_best_f1_score: 0.9730; train_kl_reg_loss: 2982.0757; train_edge_recon_loss: 27231.1899; train_gene_expr_recon_loss: 63870.3352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94083.6009; train_optim_loss: 94083.6009; val_kl_reg_loss: 2965.3725; val_edge_recon_loss: 26531.2614; val_gene_expr_recon_loss: 64196.8450; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93693.4792; val_optim_loss: 93693.4792
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9962; val_auprc_score: 0.9957; val_best_acc_score: 0.9728; val_best_f1_score: 0.9730; train_kl_reg_loss: 2981.6473; train_edge_recon_loss: 27232.9551; train_gene_expr_recon_loss: 63861.6511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94076.2533; train_optim_loss: 94076.2533; val_kl_reg_loss: 2968.0362; val_edge_recon_loss: 26502.4324; val_gene_expr_recon_loss: 64372.4441; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93842.9126; val_optim_loss: 93842.9126
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9962; val_auprc_score: 0.9956; val_best_acc_score: 0.9731; val_best_f1_score: 0.9733; train_kl_reg_loss: 2980.7261; train_edge_recon_loss: 27229.8661; train_gene_expr_recon_loss: 63862.6123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94073.2045; train_optim_loss: 94073.2045; val_kl_reg_loss: 2935.0942; val_edge_recon_loss: 26526.0368; val_gene_expr_recon_loss: 64150.6019; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93611.7330; val_optim_loss: 93611.7330
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9962; val_auprc_score: 0.9957; val_best_acc_score: 0.9732; val_best_f1_score: 0.9734; train_kl_reg_loss: 2979.1224; train_edge_recon_loss: 27235.1905; train_gene_expr_recon_loss: 63831.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94046.2851; train_optim_loss: 94046.2851; val_kl_reg_loss: 2970.0643; val_edge_recon_loss: 26519.2911; val_gene_expr_recon_loss: 64224.1108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93713.4661; val_optim_loss: 93713.4661
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9962; val_auprc_score: 0.9957; val_best_acc_score: 0.9732; val_best_f1_score: 0.9734; train_kl_reg_loss: 2979.7061; train_edge_recon_loss: 27229.0891; train_gene_expr_recon_loss: 63828.0062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94036.8013; train_optim_loss: 94036.8013; val_kl_reg_loss: 2966.4948; val_edge_recon_loss: 26509.2351; val_gene_expr_recon_loss: 64301.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93777.1437; val_optim_loss: 93777.1437
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9962; val_auprc_score: 0.9958; val_best_acc_score: 0.9735; val_best_f1_score: 0.9736; train_kl_reg_loss: 2980.3467; train_edge_recon_loss: 27223.0382; train_gene_expr_recon_loss: 63837.4130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94040.7979; train_optim_loss: 94040.7979; val_kl_reg_loss: 2974.2005; val_edge_recon_loss: 26521.1036; val_gene_expr_recon_loss: 64237.2082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93732.5123; val_optim_loss: 93732.5123
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9963; val_auprc_score: 0.9959; val_best_acc_score: 0.9733; val_best_f1_score: 0.9735; train_kl_reg_loss: 2979.5734; train_edge_recon_loss: 27234.8425; train_gene_expr_recon_loss: 63829.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94044.2340; train_optim_loss: 94044.2340; val_kl_reg_loss: 2961.8718; val_edge_recon_loss: 26526.2752; val_gene_expr_recon_loss: 64230.7993; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93718.9465; val_optim_loss: 93718.9465

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9963; val_auprc_score: 0.9959; val_best_acc_score: 0.9733; val_best_f1_score: 0.9735; train_kl_reg_loss: 2982.4146; train_edge_recon_loss: 27219.7891; train_gene_expr_recon_loss: 63773.2580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93975.4616; train_optim_loss: 93975.4616; val_kl_reg_loss: 2962.0369; val_edge_recon_loss: 26497.8507; val_gene_expr_recon_loss: 64245.5044; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93705.3918; val_optim_loss: 93705.3918
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9963; val_auprc_score: 0.9956; val_best_acc_score: 0.9736; val_best_f1_score: 0.9737; train_kl_reg_loss: 2981.5941; train_edge_recon_loss: 27216.9159; train_gene_expr_recon_loss: 63751.2335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93949.7437; train_optim_loss: 93949.7437; val_kl_reg_loss: 2962.6626; val_edge_recon_loss: 26500.7901; val_gene_expr_recon_loss: 64078.0310; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93541.4839; val_optim_loss: 93541.4839
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9963; val_auprc_score: 0.9958; val_best_acc_score: 0.9736; val_best_f1_score: 0.9738; train_kl_reg_loss: 2981.8381; train_edge_recon_loss: 27223.3946; train_gene_expr_recon_loss: 63757.6930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93962.9257; train_optim_loss: 93962.9257; val_kl_reg_loss: 2965.5946; val_edge_recon_loss: 26501.3128; val_gene_expr_recon_loss: 64254.7951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93721.7027; val_optim_loss: 93721.7027
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9964; val_auprc_score: 0.9960; val_best_acc_score: 0.9740; val_best_f1_score: 0.9742; train_kl_reg_loss: 2979.7299; train_edge_recon_loss: 27227.0451; train_gene_expr_recon_loss: 63746.5359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93953.3110; train_optim_loss: 93953.3110; val_kl_reg_loss: 2961.9971; val_edge_recon_loss: 26500.9194; val_gene_expr_recon_loss: 64170.0591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93632.9756; val_optim_loss: 93632.9756
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9964; val_auprc_score: 0.9960; val_best_acc_score: 0.9737; val_best_f1_score: 0.9738; train_kl_reg_loss: 2981.8008; train_edge_recon_loss: 27220.8207; train_gene_expr_recon_loss: 63787.2899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93989.9112; train_optim_loss: 93989.9112; val_kl_reg_loss: 2961.5679; val_edge_recon_loss: 26490.3700; val_gene_expr_recon_loss: 64265.9588; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93717.8967; val_optim_loss: 93717.8967
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9965; val_auprc_score: 0.9962; val_best_acc_score: 0.9737; val_best_f1_score: 0.9739; train_kl_reg_loss: 2978.5316; train_edge_recon_loss: 27233.4498; train_gene_expr_recon_loss: 63766.4362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93978.4175; train_optim_loss: 93978.4175; val_kl_reg_loss: 2957.9500; val_edge_recon_loss: 26510.6689; val_gene_expr_recon_loss: 64187.1969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93655.8160; val_optim_loss: 93655.8160

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9962; val_auprc_score: 0.9957; val_best_acc_score: 0.9736; val_best_f1_score: 0.9737; train_kl_reg_loss: 2977.9427; train_edge_recon_loss: 27229.7842; train_gene_expr_recon_loss: 63767.0090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93974.7358; train_optim_loss: 93974.7358; val_kl_reg_loss: 2959.3230; val_edge_recon_loss: 26512.0783; val_gene_expr_recon_loss: 64146.3132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93617.7146; val_optim_loss: 93617.7146
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9964; val_auprc_score: 0.9958; val_best_acc_score: 0.9734; val_best_f1_score: 0.9736; train_kl_reg_loss: 2979.3362; train_edge_recon_loss: 27224.3341; train_gene_expr_recon_loss: 63759.9450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93963.6153; train_optim_loss: 93963.6153; val_kl_reg_loss: 2961.3228; val_edge_recon_loss: 26506.9409; val_gene_expr_recon_loss: 64193.6907; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93661.9543; val_optim_loss: 93661.9543
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9963; val_auprc_score: 0.9959; val_best_acc_score: 0.9733; val_best_f1_score: 0.9735; train_kl_reg_loss: 2979.3335; train_edge_recon_loss: 27226.8158; train_gene_expr_recon_loss: 63752.5272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93958.6765; train_optim_loss: 93958.6765; val_kl_reg_loss: 2960.6930; val_edge_recon_loss: 26527.4495; val_gene_expr_recon_loss: 64070.9613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93559.1039; val_optim_loss: 93559.1039
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9964; val_auprc_score: 0.9958; val_best_acc_score: 0.9738; val_best_f1_score: 0.9740; train_kl_reg_loss: 2979.4714; train_edge_recon_loss: 27223.6458; train_gene_expr_recon_loss: 63738.1495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93941.2668; train_optim_loss: 93941.2668; val_kl_reg_loss: 2961.6943; val_edge_recon_loss: 26501.6349; val_gene_expr_recon_loss: 64310.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93774.0089; val_optim_loss: 93774.0089

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 788 min 1 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
Val AUROC score: 0.9965
Val AUPRC score: 0.9961
Val best accuracy score: 0.9737
Val best F1 score: 0.9738
Val gene expr MSE score: 1.5924

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
