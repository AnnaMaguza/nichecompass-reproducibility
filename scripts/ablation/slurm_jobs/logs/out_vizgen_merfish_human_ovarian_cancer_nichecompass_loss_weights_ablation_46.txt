None
Run timestamp: 17072023_204801_46.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_46']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9878; val_auprc_score: 0.9866; val_best_acc_score: 0.9458; val_best_f1_score: 0.9462; train_kl_reg_loss: 15846.4190; train_edge_recon_loss: 26323548.6562; train_gene_expr_recon_loss: 2178434.6685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28517829.7520; train_optim_loss: 28517829.7520; val_kl_reg_loss: 15788.7539; val_edge_recon_loss: 26154290.2629; val_gene_expr_recon_loss: 2084970.3134; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28255049.4085; val_optim_loss: 28255049.4085
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9901; val_auprc_score: 0.9890; val_best_acc_score: 0.9523; val_best_f1_score: 0.9525; train_kl_reg_loss: 16111.7218; train_edge_recon_loss: 25923001.9414; train_gene_expr_recon_loss: 2061334.9328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28000448.5997; train_optim_loss: 28000448.5997; val_kl_reg_loss: 16503.9128; val_edge_recon_loss: 26109352.8826; val_gene_expr_recon_loss: 2044389.3903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28170246.2066; val_optim_loss: 28170246.2066
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9926; val_auprc_score: 0.9914; val_best_acc_score: 0.9604; val_best_f1_score: 0.9607; train_kl_reg_loss: 16522.3190; train_edge_recon_loss: 25853442.0335; train_gene_expr_recon_loss: 2037136.9975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27907101.3480; train_optim_loss: 27907101.3480; val_kl_reg_loss: 15844.1890; val_edge_recon_loss: 26037464.4131; val_gene_expr_recon_loss: 2031978.8063; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28085287.4836; val_optim_loss: 28085287.4836
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9940; val_auprc_score: 0.9932; val_best_acc_score: 0.9650; val_best_f1_score: 0.9652; train_kl_reg_loss: 16616.8842; train_edge_recon_loss: 25817362.5222; train_gene_expr_recon_loss: 2029605.2362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27863584.6656; train_optim_loss: 27863584.6656; val_kl_reg_loss: 17107.5640; val_edge_recon_loss: 25974793.6244; val_gene_expr_recon_loss: 2028625.5270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28020526.6761; val_optim_loss: 28020526.6761
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9943; val_auprc_score: 0.9934; val_best_acc_score: 0.9668; val_best_f1_score: 0.9669; train_kl_reg_loss: 16632.9585; train_edge_recon_loss: 25799286.7096; train_gene_expr_recon_loss: 2025369.4583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27841289.0759; train_optim_loss: 27841289.0759; val_kl_reg_loss: 16245.3312; val_edge_recon_loss: 25989295.3052; val_gene_expr_recon_loss: 2027497.5217; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28033038.1878; val_optim_loss: 28033038.1878
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9944; val_auprc_score: 0.9936; val_best_acc_score: 0.9659; val_best_f1_score: 0.9660; train_kl_reg_loss: 16627.9658; train_edge_recon_loss: 25774124.7828; train_gene_expr_recon_loss: 2023324.2986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27814077.0330; train_optim_loss: 27814077.0330; val_kl_reg_loss: 16347.4265; val_edge_recon_loss: 25979440.9859; val_gene_expr_recon_loss: 2025197.2441; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28020985.7089; val_optim_loss: 28020985.7089
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9947; val_auprc_score: 0.9940; val_best_acc_score: 0.9677; val_best_f1_score: 0.9679; train_kl_reg_loss: 16548.1481; train_edge_recon_loss: 25755063.0581; train_gene_expr_recon_loss: 2022161.4794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27793772.6834; train_optim_loss: 27793772.6834; val_kl_reg_loss: 15991.0355; val_edge_recon_loss: 25959965.1080; val_gene_expr_recon_loss: 2026998.1543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28002954.3756; val_optim_loss: 28002954.3756
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9948; val_auprc_score: 0.9940; val_best_acc_score: 0.9691; val_best_f1_score: 0.9694; train_kl_reg_loss: 16474.2280; train_edge_recon_loss: 25747553.1826; train_gene_expr_recon_loss: 2021168.0088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27785195.4265; train_optim_loss: 27785195.4265; val_kl_reg_loss: 16079.7485; val_edge_recon_loss: 25929857.6056; val_gene_expr_recon_loss: 2027415.7465; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27973353.1174; val_optim_loss: 27973353.1174
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9953; val_auprc_score: 0.9945; val_best_acc_score: 0.9705; val_best_f1_score: 0.9706; train_kl_reg_loss: 16475.3757; train_edge_recon_loss: 25733877.5217; train_gene_expr_recon_loss: 2020487.4287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27770840.3056; train_optim_loss: 27770840.3056; val_kl_reg_loss: 16124.9174; val_edge_recon_loss: 25918972.3944; val_gene_expr_recon_loss: 2022172.6350; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27957269.9155; val_optim_loss: 27957269.9155
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9950; val_auprc_score: 0.9943; val_best_acc_score: 0.9696; val_best_f1_score: 0.9697; train_kl_reg_loss: 16399.3501; train_edge_recon_loss: 25727695.4474; train_gene_expr_recon_loss: 2019988.3324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27764083.1272; train_optim_loss: 27764083.1272; val_kl_reg_loss: 16358.4495; val_edge_recon_loss: 25909055.6620; val_gene_expr_recon_loss: 2024215.5440; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27949629.6432; val_optim_loss: 27949629.6432
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9957; val_auprc_score: 0.9949; val_best_acc_score: 0.9720; val_best_f1_score: 0.9721; train_kl_reg_loss: 16364.1224; train_edge_recon_loss: 25716505.3773; train_gene_expr_recon_loss: 2019567.7149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27752437.2140; train_optim_loss: 27752437.2140; val_kl_reg_loss: 16804.0016; val_edge_recon_loss: 25903910.0376; val_gene_expr_recon_loss: 2021125.5117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27941839.5493; val_optim_loss: 27941839.5493
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9958; val_auprc_score: 0.9950; val_best_acc_score: 0.9732; val_best_f1_score: 0.9734; train_kl_reg_loss: 16316.7268; train_edge_recon_loss: 25714078.2449; train_gene_expr_recon_loss: 2018826.3019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27749221.2936; train_optim_loss: 27749221.2936; val_kl_reg_loss: 16122.4617; val_edge_recon_loss: 25851394.4883; val_gene_expr_recon_loss: 2022411.7277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27889928.7418; val_optim_loss: 27889928.7418
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9958; val_auprc_score: 0.9953; val_best_acc_score: 0.9726; val_best_f1_score: 0.9727; train_kl_reg_loss: 16272.8117; train_edge_recon_loss: 25709482.5463; train_gene_expr_recon_loss: 2018131.5597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27743886.9273; train_optim_loss: 27743886.9273; val_kl_reg_loss: 16280.2768; val_edge_recon_loss: 25889478.1972; val_gene_expr_recon_loss: 2019644.1872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27925402.7230; val_optim_loss: 27925402.7230
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9958; val_auprc_score: 0.9951; val_best_acc_score: 0.9729; val_best_f1_score: 0.9731; train_kl_reg_loss: 16255.3137; train_edge_recon_loss: 25699164.2868; train_gene_expr_recon_loss: 2018425.6077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27733845.2067; train_optim_loss: 27733845.2067; val_kl_reg_loss: 16471.1827; val_edge_recon_loss: 25888346.6573; val_gene_expr_recon_loss: 2023752.5945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27928570.5446; val_optim_loss: 27928570.5446
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9962; val_auprc_score: 0.9956; val_best_acc_score: 0.9743; val_best_f1_score: 0.9744; train_kl_reg_loss: 16153.1977; train_edge_recon_loss: 25690609.2695; train_gene_expr_recon_loss: 2017415.3290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27724177.8022; train_optim_loss: 27724177.8022; val_kl_reg_loss: 16176.7919; val_edge_recon_loss: 25857049.9061; val_gene_expr_recon_loss: 2019086.3087; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27892312.9484; val_optim_loss: 27892312.9484
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9959; val_auprc_score: 0.9950; val_best_acc_score: 0.9738; val_best_f1_score: 0.9740; train_kl_reg_loss: 16155.4715; train_edge_recon_loss: 25682154.4301; train_gene_expr_recon_loss: 2017505.9324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27715815.8148; train_optim_loss: 27715815.8148; val_kl_reg_loss: 15635.6473; val_edge_recon_loss: 25823134.9296; val_gene_expr_recon_loss: 2019128.6174; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27857899.1268; val_optim_loss: 27857899.1268
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9962; val_auprc_score: 0.9954; val_best_acc_score: 0.9751; val_best_f1_score: 0.9753; train_kl_reg_loss: 16090.0876; train_edge_recon_loss: 25676537.2015; train_gene_expr_recon_loss: 2016475.6158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27709102.9367; train_optim_loss: 27709102.9367; val_kl_reg_loss: 15647.6682; val_edge_recon_loss: 25860811.8498; val_gene_expr_recon_loss: 2016279.0957; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27892738.5164; val_optim_loss: 27892738.5164
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9963; val_auprc_score: 0.9956; val_best_acc_score: 0.9754; val_best_f1_score: 0.9755; train_kl_reg_loss: 16065.3253; train_edge_recon_loss: 25672190.6164; train_gene_expr_recon_loss: 2016451.7060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27704707.6546; train_optim_loss: 27704707.6546; val_kl_reg_loss: 16242.3812; val_edge_recon_loss: 25828488.6009; val_gene_expr_recon_loss: 2022037.2441; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27866768.3099; val_optim_loss: 27866768.3099
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9964; val_auprc_score: 0.9958; val_best_acc_score: 0.9758; val_best_f1_score: 0.9760; train_kl_reg_loss: 16015.3292; train_edge_recon_loss: 25670769.5563; train_gene_expr_recon_loss: 2016398.1970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27703183.0382; train_optim_loss: 27703183.0382; val_kl_reg_loss: 15630.5131; val_edge_recon_loss: 25838504.0188; val_gene_expr_recon_loss: 2019549.3826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27873683.8122; val_optim_loss: 27873683.8122
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9962; val_auprc_score: 0.9955; val_best_acc_score: 0.9740; val_best_f1_score: 0.9741; train_kl_reg_loss: 16018.7998; train_edge_recon_loss: 25663576.4626; train_gene_expr_recon_loss: 2016409.9737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27696005.2287; train_optim_loss: 27696005.2287; val_kl_reg_loss: 15813.3292; val_edge_recon_loss: 25838635.2582; val_gene_expr_recon_loss: 2019992.3175; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27874440.8920; val_optim_loss: 27874440.8920

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9968; val_auprc_score: 0.9962; val_best_acc_score: 0.9778; val_best_f1_score: 0.9779; train_kl_reg_loss: 16154.1789; train_edge_recon_loss: 25630399.7593; train_gene_expr_recon_loss: 1994910.4575; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27641464.4197; train_optim_loss: 27641464.4197; val_kl_reg_loss: 16220.6523; val_edge_recon_loss: 25776298.9108; val_gene_expr_recon_loss: 1997678.4525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27790198.0188; val_optim_loss: 27790198.0188
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9968; val_auprc_score: 0.9960; val_best_acc_score: 0.9780; val_best_f1_score: 0.9781; train_kl_reg_loss: 16189.2646; train_edge_recon_loss: 25617997.1251; train_gene_expr_recon_loss: 1993355.6206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27627542.0429; train_optim_loss: 27627542.0429; val_kl_reg_loss: 16229.9058; val_edge_recon_loss: 25783792.9765; val_gene_expr_recon_loss: 1998966.1238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27798988.9390; val_optim_loss: 27798988.9390
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9968; val_auprc_score: 0.9962; val_best_acc_score: 0.9776; val_best_f1_score: 0.9777; train_kl_reg_loss: 16115.3562; train_edge_recon_loss: 25615610.6175; train_gene_expr_recon_loss: 1992954.7404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27624680.7211; train_optim_loss: 27624680.7211; val_kl_reg_loss: 16190.5487; val_edge_recon_loss: 25774696.0469; val_gene_expr_recon_loss: 1997948.8515; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27788835.3803; val_optim_loss: 27788835.3803
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9969; val_auprc_score: 0.9961; val_best_acc_score: 0.9780; val_best_f1_score: 0.9781; train_kl_reg_loss: 16059.0179; train_edge_recon_loss: 25611721.7865; train_gene_expr_recon_loss: 1992614.5068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27620395.3281; train_optim_loss: 27620395.3281; val_kl_reg_loss: 15928.9950; val_edge_recon_loss: 25771806.9953; val_gene_expr_recon_loss: 1995607.0387; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27783342.9671; val_optim_loss: 27783342.9671
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9969; val_auprc_score: 0.9963; val_best_acc_score: 0.9781; val_best_f1_score: 0.9782; train_kl_reg_loss: 15933.8819; train_edge_recon_loss: 25612620.8676; train_gene_expr_recon_loss: 1992209.8529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27620764.6081; train_optim_loss: 27620764.6081; val_kl_reg_loss: 15889.7874; val_edge_recon_loss: 25769065.4742; val_gene_expr_recon_loss: 1997716.3826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27782671.6150; val_optim_loss: 27782671.6150
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9970; val_auprc_score: 0.9965; val_best_acc_score: 0.9786; val_best_f1_score: 0.9787; train_kl_reg_loss: 15958.4533; train_edge_recon_loss: 25605395.7143; train_gene_expr_recon_loss: 1991578.4657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27612932.6520; train_optim_loss: 27612932.6520; val_kl_reg_loss: 15979.5636; val_edge_recon_loss: 25762858.7230; val_gene_expr_recon_loss: 1996947.2465; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27775785.4742; val_optim_loss: 27775785.4742
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9971; val_auprc_score: 0.9966; val_best_acc_score: 0.9788; val_best_f1_score: 0.9789; train_kl_reg_loss: 15949.1484; train_edge_recon_loss: 25605208.3203; train_gene_expr_recon_loss: 1991449.3733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27612606.8100; train_optim_loss: 27612606.8100; val_kl_reg_loss: 15771.8981; val_edge_recon_loss: 25759804.9577; val_gene_expr_recon_loss: 1996743.9208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27772320.7230; val_optim_loss: 27772320.7230
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9969; val_auprc_score: 0.9963; val_best_acc_score: 0.9787; val_best_f1_score: 0.9788; train_kl_reg_loss: 15911.1786; train_edge_recon_loss: 25611169.3030; train_gene_expr_recon_loss: 1990999.9314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27618080.4165; train_optim_loss: 27618080.4165; val_kl_reg_loss: 15854.8701; val_edge_recon_loss: 25762565.6056; val_gene_expr_recon_loss: 1997586.0147; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27776006.4883; val_optim_loss: 27776006.4883
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9969; val_auprc_score: 0.9961; val_best_acc_score: 0.9787; val_best_f1_score: 0.9789; train_kl_reg_loss: 15877.4972; train_edge_recon_loss: 25604173.7875; train_gene_expr_recon_loss: 1991393.1366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27611444.4228; train_optim_loss: 27611444.4228; val_kl_reg_loss: 15891.0181; val_edge_recon_loss: 25766861.8404; val_gene_expr_recon_loss: 1997666.2306; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27780419.1080; val_optim_loss: 27780419.1080
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9971; val_auprc_score: 0.9963; val_best_acc_score: 0.9791; val_best_f1_score: 0.9792; train_kl_reg_loss: 15879.4746; train_edge_recon_loss: 25606804.4113; train_gene_expr_recon_loss: 1991869.2800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27614553.1460; train_optim_loss: 27614553.1460; val_kl_reg_loss: 15700.8332; val_edge_recon_loss: 25745215.2958; val_gene_expr_recon_loss: 1995721.0892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27756637.2582; val_optim_loss: 27756637.2582
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9792; val_best_f1_score: 0.9793; train_kl_reg_loss: 15916.4481; train_edge_recon_loss: 25600650.2773; train_gene_expr_recon_loss: 1991377.5655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27607944.2972; train_optim_loss: 27607944.2972; val_kl_reg_loss: 15732.2632; val_edge_recon_loss: 25731138.6948; val_gene_expr_recon_loss: 1996206.0522; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27743077.0423; val_optim_loss: 27743077.0423
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9970; val_auprc_score: 0.9962; val_best_acc_score: 0.9788; val_best_f1_score: 0.9790; train_kl_reg_loss: 15880.9905; train_edge_recon_loss: 25600833.7771; train_gene_expr_recon_loss: 1991665.7955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27608380.5484; train_optim_loss: 27608380.5484; val_kl_reg_loss: 15798.3217; val_edge_recon_loss: 25762673.1174; val_gene_expr_recon_loss: 1995158.3768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27773629.7653; val_optim_loss: 27773629.7653
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9972; val_auprc_score: 0.9964; val_best_acc_score: 0.9798; val_best_f1_score: 0.9799; train_kl_reg_loss: 15876.5289; train_edge_recon_loss: 25599362.1057; train_gene_expr_recon_loss: 1991140.2634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27606378.9053; train_optim_loss: 27606378.9053; val_kl_reg_loss: 15788.8797; val_edge_recon_loss: 25725391.9061; val_gene_expr_recon_loss: 1996212.5241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27737393.3239; val_optim_loss: 27737393.3239
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9790; val_best_f1_score: 0.9790; train_kl_reg_loss: 15887.4647; train_edge_recon_loss: 25592440.6845; train_gene_expr_recon_loss: 1991173.1016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27599501.2705; train_optim_loss: 27599501.2705; val_kl_reg_loss: 15716.2504; val_edge_recon_loss: 25751557.0610; val_gene_expr_recon_loss: 1994865.8357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27762139.1643; val_optim_loss: 27762139.1643
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9971; val_auprc_score: 0.9965; val_best_acc_score: 0.9788; val_best_f1_score: 0.9789; train_kl_reg_loss: 15864.6800; train_edge_recon_loss: 25600607.1575; train_gene_expr_recon_loss: 1991229.5137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27607701.3585; train_optim_loss: 27607701.3585; val_kl_reg_loss: 15766.1527; val_edge_recon_loss: 25762307.3897; val_gene_expr_recon_loss: 1994093.4689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27772166.9859; val_optim_loss: 27772166.9859
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9971; val_auprc_score: 0.9965; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 15895.2787; train_edge_recon_loss: 25600963.8378; train_gene_expr_recon_loss: 1990238.9142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27607098.0555; train_optim_loss: 27607098.0555; val_kl_reg_loss: 15752.4054; val_edge_recon_loss: 25755857.4930; val_gene_expr_recon_loss: 1996461.9120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27768071.7653; val_optim_loss: 27768071.7653
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9971; val_auprc_score: 0.9966; val_best_acc_score: 0.9790; val_best_f1_score: 0.9790; train_kl_reg_loss: 15899.0331; train_edge_recon_loss: 25602741.8273; train_gene_expr_recon_loss: 1990594.3357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27609235.1952; train_optim_loss: 27609235.1952; val_kl_reg_loss: 15825.6765; val_edge_recon_loss: 25747938.2254; val_gene_expr_recon_loss: 1995954.7876; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27759718.7042; val_optim_loss: 27759718.7042

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9972; val_auprc_score: 0.9967; val_best_acc_score: 0.9799; val_best_f1_score: 0.9800; train_kl_reg_loss: 15929.2232; train_edge_recon_loss: 25589131.8901; train_gene_expr_recon_loss: 1987924.5109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27592985.5918; train_optim_loss: 27592985.5918; val_kl_reg_loss: 15816.3965; val_edge_recon_loss: 25733477.5305; val_gene_expr_recon_loss: 1993650.4161; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27742944.3380; val_optim_loss: 27742944.3380
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9974; val_auprc_score: 0.9968; val_best_acc_score: 0.9801; val_best_f1_score: 0.9802; train_kl_reg_loss: 15972.3303; train_edge_recon_loss: 25597116.4689; train_gene_expr_recon_loss: 1987902.6748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27600991.4914; train_optim_loss: 27600991.4914; val_kl_reg_loss: 15845.1104; val_edge_recon_loss: 25721032.9765; val_gene_expr_recon_loss: 1993504.9090; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27730383.0235; val_optim_loss: 27730383.0235
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9972; val_auprc_score: 0.9965; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 15967.8138; train_edge_recon_loss: 25600205.2308; train_gene_expr_recon_loss: 1988016.9685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27604189.9979; train_optim_loss: 27604189.9979; val_kl_reg_loss: 15829.4596; val_edge_recon_loss: 25739753.6620; val_gene_expr_recon_loss: 1992785.1825; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27748368.3192; val_optim_loss: 27748368.3192
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9971; val_auprc_score: 0.9964; val_best_acc_score: 0.9799; val_best_f1_score: 0.9801; train_kl_reg_loss: 15940.2145; train_edge_recon_loss: 25597303.4139; train_gene_expr_recon_loss: 1987422.9645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27600666.5819; train_optim_loss: 27600666.5819; val_kl_reg_loss: 15798.1407; val_edge_recon_loss: 25736764.2629; val_gene_expr_recon_loss: 1994599.2705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27747161.5869; val_optim_loss: 27747161.5869
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9973; val_auprc_score: 0.9966; val_best_acc_score: 0.9801; val_best_f1_score: 0.9802; train_kl_reg_loss: 15935.3788; train_edge_recon_loss: 25589295.0780; train_gene_expr_recon_loss: 1987609.1949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27592839.6609; train_optim_loss: 27592839.6609; val_kl_reg_loss: 15803.5019; val_edge_recon_loss: 25718154.6948; val_gene_expr_recon_loss: 1993542.4818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27727500.6667; val_optim_loss: 27727500.6667
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9972; val_auprc_score: 0.9967; val_best_acc_score: 0.9797; val_best_f1_score: 0.9798; train_kl_reg_loss: 15922.3940; train_edge_recon_loss: 25591623.7101; train_gene_expr_recon_loss: 1987518.1471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27595064.2480; train_optim_loss: 27595064.2480; val_kl_reg_loss: 15786.9081; val_edge_recon_loss: 25732238.3380; val_gene_expr_recon_loss: 1993767.0716; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27741792.2066; val_optim_loss: 27741792.2066
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9973; val_auprc_score: 0.9966; val_best_acc_score: 0.9802; val_best_f1_score: 0.9803; train_kl_reg_loss: 15927.2581; train_edge_recon_loss: 25588937.2046; train_gene_expr_recon_loss: 1987620.4262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27592484.8540; train_optim_loss: 27592484.8540; val_kl_reg_loss: 15826.1471; val_edge_recon_loss: 25725421.4272; val_gene_expr_recon_loss: 1992366.3703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27733613.8779; val_optim_loss: 27733613.8779
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9971; val_auprc_score: 0.9966; val_best_acc_score: 0.9794; val_best_f1_score: 0.9795; train_kl_reg_loss: 15914.3643; train_edge_recon_loss: 25587848.3380; train_gene_expr_recon_loss: 1988287.8252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27592050.5097; train_optim_loss: 27592050.5097; val_kl_reg_loss: 15824.6675; val_edge_recon_loss: 25737007.6432; val_gene_expr_recon_loss: 1994229.1790; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27747061.5305; val_optim_loss: 27747061.5305
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9971; val_auprc_score: 0.9963; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 15920.6603; train_edge_recon_loss: 25591272.1528; train_gene_expr_recon_loss: 1987623.8617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27594816.6457; train_optim_loss: 27594816.6457; val_kl_reg_loss: 15820.6153; val_edge_recon_loss: 25736549.8685; val_gene_expr_recon_loss: 1994947.0851; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27747317.4836; val_optim_loss: 27747317.4836

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9972; val_auprc_score: 0.9964; val_best_acc_score: 0.9796; val_best_f1_score: 0.9797; train_kl_reg_loss: 15937.3909; train_edge_recon_loss: 25590841.0445; train_gene_expr_recon_loss: 1987395.6396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27594174.0785; train_optim_loss: 27594174.0785; val_kl_reg_loss: 15820.0115; val_edge_recon_loss: 25727373.7371; val_gene_expr_recon_loss: 1994678.7459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27737872.4413; val_optim_loss: 27737872.4413
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9971; val_auprc_score: 0.9963; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 15925.6577; train_edge_recon_loss: 25590174.1183; train_gene_expr_recon_loss: 1987379.2679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27593479.0340; train_optim_loss: 27593479.0340; val_kl_reg_loss: 15810.0024; val_edge_recon_loss: 25750637.0892; val_gene_expr_recon_loss: 1993573.9038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27760021.0047; val_optim_loss: 27760021.0047
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9973; val_auprc_score: 0.9967; val_best_acc_score: 0.9799; val_best_f1_score: 0.9800; train_kl_reg_loss: 15917.1679; train_edge_recon_loss: 25590430.5495; train_gene_expr_recon_loss: 1987679.1740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27594026.8854; train_optim_loss: 27594026.8854; val_kl_reg_loss: 15803.4760; val_edge_recon_loss: 25749299.8122; val_gene_expr_recon_loss: 1993360.1027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27758463.3615; val_optim_loss: 27758463.3615
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9798; val_best_f1_score: 0.9799; train_kl_reg_loss: 15915.4622; train_edge_recon_loss: 25590914.9775; train_gene_expr_recon_loss: 1988024.6396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27594855.1136; train_optim_loss: 27594855.1136; val_kl_reg_loss: 15803.3491; val_edge_recon_loss: 25745492.6009; val_gene_expr_recon_loss: 1992112.8644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27753408.8075; val_optim_loss: 27753408.8075

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 471 min 3 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
Val AUROC score: 0.9970
Val AUPRC score: 0.9963
Val best accuracy score: 0.9795
Val best F1 score: 0.9796
Val gene expr MSE score: 8.2101

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
