None
Run timestamp: 24072023_201415_17.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '24', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_17']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 1094923
Number of validation edges: 121658
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9848; val_auprc_score: 0.9808; val_best_acc_score: 0.9475; val_best_f1_score: 0.9488; train_kl_reg_loss: 96836.6944; train_edge_recon_loss: 26394626.6910; train_gene_expr_recon_loss: 11232188.7475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37723652.1197; train_optim_loss: 37723652.1197; val_kl_reg_loss: 94211.0088; val_edge_recon_loss: 26050603.4118; val_gene_expr_recon_loss: 10390511.1681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36535325.6807; val_optim_loss: 36535325.6807
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9896; val_auprc_score: 0.9868; val_best_acc_score: 0.9603; val_best_f1_score: 0.9611; train_kl_reg_loss: 81920.0253; train_edge_recon_loss: 25883342.2235; train_gene_expr_recon_loss: 10235309.4451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36200571.7027; train_optim_loss: 36200571.7027; val_kl_reg_loss: 74296.7003; val_edge_recon_loss: 25817813.7143; val_gene_expr_recon_loss: 10069754.4055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35961864.8067; val_optim_loss: 35961864.8067
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9913; val_auprc_score: 0.9888; val_best_acc_score: 0.9654; val_best_f1_score: 0.9661; train_kl_reg_loss: 70036.6673; train_edge_recon_loss: 25751541.8943; train_gene_expr_recon_loss: 10021066.3319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35842644.9163; train_optim_loss: 35842644.9163; val_kl_reg_loss: 66475.6170; val_edge_recon_loss: 25752669.0504; val_gene_expr_recon_loss: 9945479.0882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35764623.6639; val_optim_loss: 35764623.6639
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9926; val_auprc_score: 0.9907; val_best_acc_score: 0.9683; val_best_f1_score: 0.9688; train_kl_reg_loss: 63558.5544; train_edge_recon_loss: 25687692.1664; train_gene_expr_recon_loss: 9924935.9899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35676186.7349; train_optim_loss: 35676186.7349; val_kl_reg_loss: 60737.4758; val_edge_recon_loss: 25705921.5210; val_gene_expr_recon_loss: 9878318.3508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35644977.3782; val_optim_loss: 35644977.3782
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9941; val_auprc_score: 0.9925; val_best_acc_score: 0.9727; val_best_f1_score: 0.9732; train_kl_reg_loss: 58733.6779; train_edge_recon_loss: 25653822.6059; train_gene_expr_recon_loss: 9856940.6510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35569496.9556; train_optim_loss: 35569496.9556; val_kl_reg_loss: 56666.5148; val_edge_recon_loss: 25655775.4034; val_gene_expr_recon_loss: 9835449.7542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35547891.6723; val_optim_loss: 35547891.6723
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9941; val_auprc_score: 0.9922; val_best_acc_score: 0.9747; val_best_f1_score: 0.9751; train_kl_reg_loss: 55722.1669; train_edge_recon_loss: 25615271.5998; train_gene_expr_recon_loss: 9809748.7302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35480742.4675; train_optim_loss: 35480742.4675; val_kl_reg_loss: 55464.2161; val_edge_recon_loss: 25654299.5714; val_gene_expr_recon_loss: 9778857.7248; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35488621.3697; val_optim_loss: 35488621.3697
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9947; val_auprc_score: 0.9931; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 53343.7425; train_edge_recon_loss: 25598030.0664; train_gene_expr_recon_loss: 9776258.8630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35427632.6358; train_optim_loss: 35427632.6358; val_kl_reg_loss: 52577.5775; val_edge_recon_loss: 25606889.9496; val_gene_expr_recon_loss: 9783186.1197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35442653.7311; val_optim_loss: 35442653.7311
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9952; val_auprc_score: 0.9937; val_best_acc_score: 0.9771; val_best_f1_score: 0.9774; train_kl_reg_loss: 52318.4768; train_edge_recon_loss: 25575027.7055; train_gene_expr_recon_loss: 9740460.1052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35367806.3273; train_optim_loss: 35367806.3273; val_kl_reg_loss: 51229.3133; val_edge_recon_loss: 25599890.8487; val_gene_expr_recon_loss: 9767921.7458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35419042.0756; val_optim_loss: 35419042.0756
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9952; val_auprc_score: 0.9937; val_best_acc_score: 0.9782; val_best_f1_score: 0.9785; train_kl_reg_loss: 51078.9672; train_edge_recon_loss: 25561111.7317; train_gene_expr_recon_loss: 9718984.7410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35331175.4437; train_optim_loss: 35331175.4437; val_kl_reg_loss: 50714.8669; val_edge_recon_loss: 25588258.9076; val_gene_expr_recon_loss: 9746862.1134; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35385835.9160; val_optim_loss: 35385835.9160
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9957; val_auprc_score: 0.9946; val_best_acc_score: 0.9793; val_best_f1_score: 0.9796; train_kl_reg_loss: 50244.9088; train_edge_recon_loss: 25549926.1739; train_gene_expr_recon_loss: 9696994.1197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35297165.2426; train_optim_loss: 35297165.2426; val_kl_reg_loss: 50542.7700; val_edge_recon_loss: 25553311.7311; val_gene_expr_recon_loss: 9751780.8361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35355635.2605; val_optim_loss: 35355635.2605
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9956; val_auprc_score: 0.9940; val_best_acc_score: 0.9791; val_best_f1_score: 0.9794; train_kl_reg_loss: 49463.9216; train_edge_recon_loss: 25547837.4970; train_gene_expr_recon_loss: 9678105.9446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35275407.4324; train_optim_loss: 35275407.4324; val_kl_reg_loss: 47932.8622; val_edge_recon_loss: 25602462.8487; val_gene_expr_recon_loss: 9729953.0294; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35380348.6387; val_optim_loss: 35380348.6387
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9958; val_auprc_score: 0.9944; val_best_acc_score: 0.9801; val_best_f1_score: 0.9804; train_kl_reg_loss: 48715.9543; train_edge_recon_loss: 25539474.1590; train_gene_expr_recon_loss: 9663593.5388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35251783.6737; train_optim_loss: 35251783.6737; val_kl_reg_loss: 48394.7338; val_edge_recon_loss: 25560587.2101; val_gene_expr_recon_loss: 9732468.1597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35341450.0168; val_optim_loss: 35341450.0168
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9961; val_auprc_score: 0.9950; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 48429.3290; train_edge_recon_loss: 25530851.2267; train_gene_expr_recon_loss: 9644636.2279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35223916.8172; train_optim_loss: 35223916.8172; val_kl_reg_loss: 47856.9033; val_edge_recon_loss: 25543960.4034; val_gene_expr_recon_loss: 9709914.3950; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35301731.6303; val_optim_loss: 35301731.6303
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9961; val_auprc_score: 0.9949; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 48158.4624; train_edge_recon_loss: 25526916.8153; train_gene_expr_recon_loss: 9632471.4123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35207546.6685; train_optim_loss: 35207546.6685; val_kl_reg_loss: 48214.5269; val_edge_recon_loss: 25553697.3950; val_gene_expr_recon_loss: 9709627.3214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35311539.3109; val_optim_loss: 35311539.3109
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9964; val_auprc_score: 0.9951; val_best_acc_score: 0.9816; val_best_f1_score: 0.9817; train_kl_reg_loss: 47713.5886; train_edge_recon_loss: 25529180.4367; train_gene_expr_recon_loss: 9627842.2356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35204736.2683; train_optim_loss: 35204736.2683; val_kl_reg_loss: 47422.0134; val_edge_recon_loss: 25547079.3950; val_gene_expr_recon_loss: 9726917.8151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35321419.1765; val_optim_loss: 35321419.1765
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9966; val_auprc_score: 0.9956; val_best_acc_score: 0.9825; val_best_f1_score: 0.9827; train_kl_reg_loss: 47274.6031; train_edge_recon_loss: 25520737.7101; train_gene_expr_recon_loss: 9609950.9273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35177963.2623; train_optim_loss: 35177963.2623; val_kl_reg_loss: 47002.5842; val_edge_recon_loss: 25526463.9832; val_gene_expr_recon_loss: 9718134.1092; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35291600.7395; val_optim_loss: 35291600.7395
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9966; val_auprc_score: 0.9955; val_best_acc_score: 0.9825; val_best_f1_score: 0.9827; train_kl_reg_loss: 47233.4409; train_edge_recon_loss: 25515108.1234; train_gene_expr_recon_loss: 9602763.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35165104.6433; train_optim_loss: 35165104.6433; val_kl_reg_loss: 47242.8553; val_edge_recon_loss: 25521843.6134; val_gene_expr_recon_loss: 9705764.1765; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35274850.5378; val_optim_loss: 35274850.5378
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9969; val_auprc_score: 0.9960; val_best_acc_score: 0.9832; val_best_f1_score: 0.9834; train_kl_reg_loss: 47141.7489; train_edge_recon_loss: 25508999.2398; train_gene_expr_recon_loss: 9593011.0591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35149152.0683; train_optim_loss: 35149152.0683; val_kl_reg_loss: 46219.2727; val_edge_recon_loss: 25543793.8824; val_gene_expr_recon_loss: 9697031.1849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35287044.4370; val_optim_loss: 35287044.4370
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9971; val_auprc_score: 0.9962; val_best_acc_score: 0.9837; val_best_f1_score: 0.9838; train_kl_reg_loss: 47056.8725; train_edge_recon_loss: 25504794.4095; train_gene_expr_recon_loss: 9585230.5365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35137081.7849; train_optim_loss: 35137081.7849; val_kl_reg_loss: 46478.3933; val_edge_recon_loss: 25519179.5462; val_gene_expr_recon_loss: 9712869.5042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35278527.3782; val_optim_loss: 35278527.3782
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9967; val_auprc_score: 0.9956; val_best_acc_score: 0.9836; val_best_f1_score: 0.9838; train_kl_reg_loss: 46878.0646; train_edge_recon_loss: 25498960.3226; train_gene_expr_recon_loss: 9578936.2045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35124774.5694; train_optim_loss: 35124774.5694; val_kl_reg_loss: 46677.5402; val_edge_recon_loss: 25526422.2185; val_gene_expr_recon_loss: 9721626.9622; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35294726.8403; val_optim_loss: 35294726.8403
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9969; val_auprc_score: 0.9961; val_best_acc_score: 0.9839; val_best_f1_score: 0.9840; train_kl_reg_loss: 46833.4040; train_edge_recon_loss: 25499358.4890; train_gene_expr_recon_loss: 9574641.5327; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35120833.4072; train_optim_loss: 35120833.4072; val_kl_reg_loss: 46328.5266; val_edge_recon_loss: 25531330.5462; val_gene_expr_recon_loss: 9692008.5924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35269667.6975; val_optim_loss: 35269667.6975
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9972; val_auprc_score: 0.9964; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 46496.3894; train_edge_recon_loss: 25493054.7415; train_gene_expr_recon_loss: 9569833.2705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35109384.3787; train_optim_loss: 35109384.3787; val_kl_reg_loss: 45376.5926; val_edge_recon_loss: 25514765.7395; val_gene_expr_recon_loss: 9704159.2794; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35264301.4706; val_optim_loss: 35264301.4706
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9971; val_auprc_score: 0.9962; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 46574.2894; train_edge_recon_loss: 25490917.1538; train_gene_expr_recon_loss: 9560127.9324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35097619.3876; train_optim_loss: 35097619.3876; val_kl_reg_loss: 44910.5442; val_edge_recon_loss: 25499135.0504; val_gene_expr_recon_loss: 9712881.6387; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35256927.1597; val_optim_loss: 35256927.1597
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9974; val_auprc_score: 0.9966; val_best_acc_score: 0.9847; val_best_f1_score: 0.9848; train_kl_reg_loss: 46685.7001; train_edge_recon_loss: 25477283.4970; train_gene_expr_recon_loss: 9555024.6110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35078993.8074; train_optim_loss: 35078993.8074; val_kl_reg_loss: 45575.5856; val_edge_recon_loss: 25516744.2185; val_gene_expr_recon_loss: 9689843.2962; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35252163.1597; val_optim_loss: 35252163.1597
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9972; val_auprc_score: 0.9962; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 46426.6702; train_edge_recon_loss: 25482261.5044; train_gene_expr_recon_loss: 9550056.0823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35078744.2347; train_optim_loss: 35078744.2347; val_kl_reg_loss: 46398.9279; val_edge_recon_loss: 25515839.8403; val_gene_expr_recon_loss: 9693693.0420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35255931.7815; val_optim_loss: 35255931.7815
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9973; val_auprc_score: 0.9963; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 46540.6372; train_edge_recon_loss: 25480691.6494; train_gene_expr_recon_loss: 9539077.4208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35066309.7251; train_optim_loss: 35066309.7251; val_kl_reg_loss: 46902.2294; val_edge_recon_loss: 25505353.1176; val_gene_expr_recon_loss: 9705527.8845; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35257783.2017; val_optim_loss: 35257783.2017
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9972; val_auprc_score: 0.9964; val_best_acc_score: 0.9848; val_best_f1_score: 0.9850; train_kl_reg_loss: 46149.3989; train_edge_recon_loss: 25483200.4189; train_gene_expr_recon_loss: 9544346.1475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35073695.9374; train_optim_loss: 35073695.9374; val_kl_reg_loss: 46388.8704; val_edge_recon_loss: 25521429.5294; val_gene_expr_recon_loss: 9700963.7206; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35268782.1176; val_optim_loss: 35268782.1176
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9972; val_auprc_score: 0.9959; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 46382.9602; train_edge_recon_loss: 25478034.9612; train_gene_expr_recon_loss: 9536435.6952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35060853.5970; train_optim_loss: 35060853.5970; val_kl_reg_loss: 45600.2141; val_edge_recon_loss: 25482832.5042; val_gene_expr_recon_loss: 9689106.4916; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35217539.3445; val_optim_loss: 35217539.3445
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9974; val_auprc_score: 0.9965; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 46613.7770; train_edge_recon_loss: 25474767.0566; train_gene_expr_recon_loss: 9529425.6447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35050806.4404; train_optim_loss: 35050806.4404; val_kl_reg_loss: 47209.2461; val_edge_recon_loss: 25501147.6387; val_gene_expr_recon_loss: 9691876.1029; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35240232.9748; val_optim_loss: 35240232.9748
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9973; val_auprc_score: 0.9965; val_best_acc_score: 0.9853; val_best_f1_score: 0.9855; train_kl_reg_loss: 46485.0954; train_edge_recon_loss: 25472798.1786; train_gene_expr_recon_loss: 9527971.7335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35047255.0650; train_optim_loss: 35047255.0650; val_kl_reg_loss: 46384.0795; val_edge_recon_loss: 25504220.8992; val_gene_expr_recon_loss: 9690494.9580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35241099.8739; val_optim_loss: 35241099.8739
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9973; val_auprc_score: 0.9962; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 46408.1480; train_edge_recon_loss: 25470033.0734; train_gene_expr_recon_loss: 9521527.6723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35037968.8789; train_optim_loss: 35037968.8789; val_kl_reg_loss: 47281.2768; val_edge_recon_loss: 25483345.4370; val_gene_expr_recon_loss: 9685135.0567; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35215761.7479; val_optim_loss: 35215761.7479
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9976; val_auprc_score: 0.9969; val_best_acc_score: 0.9865; val_best_f1_score: 0.9866; train_kl_reg_loss: 46401.1254; train_edge_recon_loss: 25468102.5432; train_gene_expr_recon_loss: 9519217.6552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35033721.3633; train_optim_loss: 35033721.3633; val_kl_reg_loss: 46433.9144; val_edge_recon_loss: 25476721.6891; val_gene_expr_recon_loss: 9698324.8403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35221480.5042; val_optim_loss: 35221480.5042
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9974; val_auprc_score: 0.9966; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 46426.1475; train_edge_recon_loss: 25464223.5278; train_gene_expr_recon_loss: 9515893.0647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35026542.7387; train_optim_loss: 35026542.7387; val_kl_reg_loss: 46130.8808; val_edge_recon_loss: 25489013.8067; val_gene_expr_recon_loss: 9681881.0420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35217025.7647; val_optim_loss: 35217025.7647
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9977; val_auprc_score: 0.9970; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 45946.5446; train_edge_recon_loss: 25470110.8901; train_gene_expr_recon_loss: 9517857.7080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35033915.1127; train_optim_loss: 35033915.1127; val_kl_reg_loss: 46317.2025; val_edge_recon_loss: 25467889.9412; val_gene_expr_recon_loss: 9701616.5294; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35215823.6050; val_optim_loss: 35215823.6050
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9976; val_auprc_score: 0.9967; val_best_acc_score: 0.9866; val_best_f1_score: 0.9867; train_kl_reg_loss: 46397.0937; train_edge_recon_loss: 25461244.1590; train_gene_expr_recon_loss: 9508512.5409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35016153.7709; train_optim_loss: 35016153.7709; val_kl_reg_loss: 47377.8882; val_edge_recon_loss: 25483996.3193; val_gene_expr_recon_loss: 9684417.0483; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35215791.3361; val_optim_loss: 35215791.3361

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9977; val_auprc_score: 0.9971; val_best_acc_score: 0.9872; val_best_f1_score: 0.9873; train_kl_reg_loss: 49777.1581; train_edge_recon_loss: 25446169.3483; train_gene_expr_recon_loss: 9411351.4140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34907297.9102; train_optim_loss: 34907297.9102; val_kl_reg_loss: 50778.4474; val_edge_recon_loss: 25469050.9832; val_gene_expr_recon_loss: 9624220.5084; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35144049.9160; val_optim_loss: 35144049.9160
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9976; val_auprc_score: 0.9966; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 51605.4534; train_edge_recon_loss: 25447552.8079; train_gene_expr_recon_loss: 9398273.6587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34897431.9504; train_optim_loss: 34897431.9504; val_kl_reg_loss: 51693.6161; val_edge_recon_loss: 25493120.2773; val_gene_expr_recon_loss: 9615436.3277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35160250.2017; val_optim_loss: 35160250.2017
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9977; val_auprc_score: 0.9969; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 52452.5099; train_edge_recon_loss: 25441704.5002; train_gene_expr_recon_loss: 9387187.2223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34881344.2076; train_optim_loss: 34881344.2076; val_kl_reg_loss: 52234.9117; val_edge_recon_loss: 25458387.8908; val_gene_expr_recon_loss: 9613987.4958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35124610.3866; val_optim_loss: 35124610.3866
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9978; val_auprc_score: 0.9971; val_best_acc_score: 0.9872; val_best_f1_score: 0.9874; train_kl_reg_loss: 52837.0947; train_edge_recon_loss: 25438981.3221; train_gene_expr_recon_loss: 9380453.0220; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34872271.4605; train_optim_loss: 34872271.4605; val_kl_reg_loss: 52377.1090; val_edge_recon_loss: 25457642.5798; val_gene_expr_recon_loss: 9609139.4496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35119159.2017; val_optim_loss: 35119159.2017
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9977; val_auprc_score: 0.9971; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 53134.3929; train_edge_recon_loss: 25444064.5058; train_gene_expr_recon_loss: 9377743.9591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34874942.9051; train_optim_loss: 34874942.9051; val_kl_reg_loss: 52505.1128; val_edge_recon_loss: 25459533.9244; val_gene_expr_recon_loss: 9611430.1282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35123469.0252; val_optim_loss: 35123469.0252
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9977; val_auprc_score: 0.9970; val_best_acc_score: 0.9871; val_best_f1_score: 0.9872; train_kl_reg_loss: 53399.3064; train_edge_recon_loss: 25436985.5933; train_gene_expr_recon_loss: 9371625.5977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34862010.5124; train_optim_loss: 34862010.5124; val_kl_reg_loss: 52631.8554; val_edge_recon_loss: 25462067.6975; val_gene_expr_recon_loss: 9616364.4895; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35131064.0336; val_optim_loss: 35131064.0336
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9979; val_auprc_score: 0.9973; val_best_acc_score: 0.9871; val_best_f1_score: 0.9873; train_kl_reg_loss: 53429.8570; train_edge_recon_loss: 25443319.9000; train_gene_expr_recon_loss: 9371697.1279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34868446.8761; train_optim_loss: 34868446.8761; val_kl_reg_loss: 53025.1204; val_edge_recon_loss: 25474548.4202; val_gene_expr_recon_loss: 9604951.9412; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35132525.4706; val_optim_loss: 35132525.4706
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9979; val_auprc_score: 0.9972; val_best_acc_score: 0.9872; val_best_f1_score: 0.9873; train_kl_reg_loss: 53534.9618; train_edge_recon_loss: 25438988.7246; train_gene_expr_recon_loss: 9364690.3460; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34857213.9897; train_optim_loss: 34857213.9897; val_kl_reg_loss: 52910.6999; val_edge_recon_loss: 25470962.0672; val_gene_expr_recon_loss: 9612140.5777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35136013.3613; val_optim_loss: 35136013.3613

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9976; val_auprc_score: 0.9968; val_best_acc_score: 0.9870; val_best_f1_score: 0.9872; train_kl_reg_loss: 53609.5322; train_edge_recon_loss: 25440715.8373; train_gene_expr_recon_loss: 9352222.1576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34846547.5175; train_optim_loss: 34846547.5175; val_kl_reg_loss: 53313.6351; val_edge_recon_loss: 25474026.5966; val_gene_expr_recon_loss: 9600566.8761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35127907.1261; val_optim_loss: 35127907.1261
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9979; val_auprc_score: 0.9972; val_best_acc_score: 0.9875; val_best_f1_score: 0.9875; train_kl_reg_loss: 53911.2154; train_edge_recon_loss: 25432990.6526; train_gene_expr_recon_loss: 9354862.8953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34841764.7929; train_optim_loss: 34841764.7929; val_kl_reg_loss: 53335.1692; val_edge_recon_loss: 25452729.4538; val_gene_expr_recon_loss: 9600702.2710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35106766.8151; val_optim_loss: 35106766.8151
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9979; val_auprc_score: 0.9971; val_best_acc_score: 0.9874; val_best_f1_score: 0.9875; train_kl_reg_loss: 54032.5933; train_edge_recon_loss: 25437149.3960; train_gene_expr_recon_loss: 9353124.9703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34844307.0014; train_optim_loss: 34844307.0014; val_kl_reg_loss: 53623.3466; val_edge_recon_loss: 25464979.6723; val_gene_expr_recon_loss: 9615249.0777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35133852.1345; val_optim_loss: 35133852.1345
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9978; val_auprc_score: 0.9971; val_best_acc_score: 0.9868; val_best_f1_score: 0.9869; train_kl_reg_loss: 54066.0164; train_edge_recon_loss: 25436540.9219; train_gene_expr_recon_loss: 9352961.5561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34843568.5367; train_optim_loss: 34843568.5367; val_kl_reg_loss: 53680.7834; val_edge_recon_loss: 25470825.8908; val_gene_expr_recon_loss: 9598568.7017; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35123075.2605; val_optim_loss: 35123075.2605
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9978; val_auprc_score: 0.9970; val_best_acc_score: 0.9874; val_best_f1_score: 0.9875; train_kl_reg_loss: 54097.8149; train_edge_recon_loss: 25441151.6774; train_gene_expr_recon_loss: 9350490.6529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34845740.1720; train_optim_loss: 34845740.1720; val_kl_reg_loss: 53585.6267; val_edge_recon_loss: 25462944.6387; val_gene_expr_recon_loss: 9600487.8866; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35117018.1513; val_optim_loss: 35117018.1513
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9979; val_auprc_score: 0.9973; val_best_acc_score: 0.9874; val_best_f1_score: 0.9875; train_kl_reg_loss: 54073.4084; train_edge_recon_loss: 25440217.2342; train_gene_expr_recon_loss: 9354071.5241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34848362.1758; train_optim_loss: 34848362.1758; val_kl_reg_loss: 53502.1009; val_edge_recon_loss: 25459645.1513; val_gene_expr_recon_loss: 9594782.9055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35107930.3193; val_optim_loss: 35107930.3193

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9978; val_auprc_score: 0.9971; val_best_acc_score: 0.9875; val_best_f1_score: 0.9876; train_kl_reg_loss: 54050.5445; train_edge_recon_loss: 25439536.5694; train_gene_expr_recon_loss: 9350814.9151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34844402.0439; train_optim_loss: 34844402.0439; val_kl_reg_loss: 53500.1623; val_edge_recon_loss: 25467369.1176; val_gene_expr_recon_loss: 9590327.3277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35111196.6218; val_optim_loss: 35111196.6218
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9977; val_auprc_score: 0.9968; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 54083.2125; train_edge_recon_loss: 25436793.8476; train_gene_expr_recon_loss: 9350041.8212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34840918.8714; train_optim_loss: 34840918.8714; val_kl_reg_loss: 53592.8178; val_edge_recon_loss: 25467545.1092; val_gene_expr_recon_loss: 9609710.8445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35130848.8151; val_optim_loss: 35130848.8151
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9978; val_auprc_score: 0.9972; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 54051.5519; train_edge_recon_loss: 25441909.1538; train_gene_expr_recon_loss: 9346207.3357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34842167.9860; train_optim_loss: 34842167.9860; val_kl_reg_loss: 53603.5215; val_edge_recon_loss: 25471949.4370; val_gene_expr_recon_loss: 9605250.8277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35130803.9244; val_optim_loss: 35130803.9244
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9978; val_auprc_score: 0.9971; val_best_acc_score: 0.9877; val_best_f1_score: 0.9878; train_kl_reg_loss: 54081.5634; train_edge_recon_loss: 25431996.6975; train_gene_expr_recon_loss: 9348873.0963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34834951.3062; train_optim_loss: 34834951.3062; val_kl_reg_loss: 53696.8458; val_edge_recon_loss: 25451143.6303; val_gene_expr_recon_loss: 9612309.3067; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35117149.7479; val_optim_loss: 35117149.7479

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 520 min 5 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
Val AUROC score: 0.9977
Val AUPRC score: 0.9970
Val best accuracy score: 0.9871
Val best F1 score: 0.9872
Val gene expr MSE score: 0.6390

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
