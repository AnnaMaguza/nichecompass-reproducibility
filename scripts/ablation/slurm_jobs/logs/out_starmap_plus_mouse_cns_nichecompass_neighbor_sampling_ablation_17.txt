None
Run timestamp: 07082023_120831_17.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '24', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_17']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 1094923
Number of validation edges: 121658
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9917; val_auprc_score: 0.9895; val_best_acc_score: 0.9664; val_best_f1_score: 0.9670; train_kl_reg_loss: 7247.4389; train_edge_recon_loss: 263585.0837; train_gene_expr_recon_loss: 199931.3535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 470763.8760; train_optim_loss: 470763.8760; val_kl_reg_loss: 6892.7640; val_edge_recon_loss: 259778.7835; val_gene_expr_recon_loss: 182768.6065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 449440.1541; val_optim_loss: 449440.1541
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9942; val_auprc_score: 0.9924; val_best_acc_score: 0.9741; val_best_f1_score: 0.9744; train_kl_reg_loss: 6797.9254; train_edge_recon_loss: 259508.8318; train_gene_expr_recon_loss: 179893.0939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446199.8513; train_optim_loss: 446199.8513; val_kl_reg_loss: 6752.5366; val_edge_recon_loss: 258222.4343; val_gene_expr_recon_loss: 175919.0223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440893.9936; val_optim_loss: 440893.9936
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9957; val_auprc_score: 0.9944; val_best_acc_score: 0.9781; val_best_f1_score: 0.9783; train_kl_reg_loss: 6624.0624; train_edge_recon_loss: 258547.7229; train_gene_expr_recon_loss: 175710.0308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440881.8161; train_optim_loss: 440881.8161; val_kl_reg_loss: 6581.3067; val_edge_recon_loss: 257462.9205; val_gene_expr_recon_loss: 173318.0566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437362.2843; val_optim_loss: 437362.2843
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9961; val_auprc_score: 0.9951; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 6548.9006; train_edge_recon_loss: 257999.7936; train_gene_expr_recon_loss: 174093.6365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 438642.3307; train_optim_loss: 438642.3307; val_kl_reg_loss: 6497.4874; val_edge_recon_loss: 256894.9450; val_gene_expr_recon_loss: 172621.0633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436013.4962; val_optim_loss: 436013.4962
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9966; val_auprc_score: 0.9957; val_best_acc_score: 0.9821; val_best_f1_score: 0.9822; train_kl_reg_loss: 6519.9327; train_edge_recon_loss: 257541.4725; train_gene_expr_recon_loss: 173306.5787; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437367.9840; train_optim_loss: 437367.9840; val_kl_reg_loss: 6300.2406; val_edge_recon_loss: 256712.1199; val_gene_expr_recon_loss: 172127.9703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435140.3302; val_optim_loss: 435140.3302
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9969; val_auprc_score: 0.9959; val_best_acc_score: 0.9834; val_best_f1_score: 0.9836; train_kl_reg_loss: 6509.4542; train_edge_recon_loss: 257279.6016; train_gene_expr_recon_loss: 172807.0541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436596.1099; train_optim_loss: 436596.1099; val_kl_reg_loss: 6448.0847; val_edge_recon_loss: 256426.2103; val_gene_expr_recon_loss: 171566.6965; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434440.9913; val_optim_loss: 434440.9913
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9972; val_auprc_score: 0.9964; val_best_acc_score: 0.9843; val_best_f1_score: 0.9845; train_kl_reg_loss: 6506.9473; train_edge_recon_loss: 256959.1449; train_gene_expr_recon_loss: 172458.3072; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435924.3997; train_optim_loss: 435924.3997; val_kl_reg_loss: 6470.1383; val_edge_recon_loss: 256108.8722; val_gene_expr_recon_loss: 171287.9461; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433866.9573; val_optim_loss: 433866.9573
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9973; val_auprc_score: 0.9965; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 6502.5197; train_edge_recon_loss: 256826.5834; train_gene_expr_recon_loss: 171995.8317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435324.9346; train_optim_loss: 435324.9346; val_kl_reg_loss: 6508.6650; val_edge_recon_loss: 255899.2961; val_gene_expr_recon_loss: 171064.7664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433472.7286; val_optim_loss: 433472.7286
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9975; val_auprc_score: 0.9968; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 6503.3209; train_edge_recon_loss: 256706.8243; train_gene_expr_recon_loss: 171298.4651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434508.6102; train_optim_loss: 434508.6102; val_kl_reg_loss: 6526.7698; val_edge_recon_loss: 255879.7181; val_gene_expr_recon_loss: 169230.7715; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431637.2600; val_optim_loss: 431637.2600
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9975; val_auprc_score: 0.9967; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 6507.8218; train_edge_recon_loss: 256652.3108; train_gene_expr_recon_loss: 170148.1037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433308.2365; train_optim_loss: 433308.2365; val_kl_reg_loss: 6417.4833; val_edge_recon_loss: 255942.1985; val_gene_expr_recon_loss: 167011.6681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 429371.3502; val_optim_loss: 429371.3502
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9977; val_auprc_score: 0.9970; val_best_acc_score: 0.9865; val_best_f1_score: 0.9866; train_kl_reg_loss: 6511.4136; train_edge_recon_loss: 256527.9877; train_gene_expr_recon_loss: 168856.3980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431895.7995; train_optim_loss: 431895.7995; val_kl_reg_loss: 6471.7450; val_edge_recon_loss: 255748.0945; val_gene_expr_recon_loss: 181460.6058; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443680.4451; val_optim_loss: 443680.4451
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9978; val_auprc_score: 0.9972; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 6521.0293; train_edge_recon_loss: 256346.0524; train_gene_expr_recon_loss: 166894.7771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 429761.8588; train_optim_loss: 429761.8588; val_kl_reg_loss: 6500.8255; val_edge_recon_loss: 255564.4080; val_gene_expr_recon_loss: 200822.9898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 462888.2233; val_optim_loss: 462888.2233
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9979; val_auprc_score: 0.9972; val_best_acc_score: 0.9875; val_best_f1_score: 0.9876; train_kl_reg_loss: 6518.9035; train_edge_recon_loss: 256369.3406; train_gene_expr_recon_loss: 155717.3590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 418605.6033; train_optim_loss: 418605.6033; val_kl_reg_loss: 6472.1548; val_edge_recon_loss: 255422.8041; val_gene_expr_recon_loss: 169248.1661; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431143.1243; val_optim_loss: 431143.1243
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9980; val_auprc_score: 0.9975; val_best_acc_score: 0.9874; val_best_f1_score: 0.9875; train_kl_reg_loss: 6526.6741; train_edge_recon_loss: 256261.9356; train_gene_expr_recon_loss: 131761.6295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 394550.2393; train_optim_loss: 394550.2393; val_kl_reg_loss: 6531.1674; val_edge_recon_loss: 255459.5274; val_gene_expr_recon_loss: 100258.9601; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 362249.6532; val_optim_loss: 362249.6532
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9982; val_auprc_score: 0.9976; val_best_acc_score: 0.9877; val_best_f1_score: 0.9878; train_kl_reg_loss: 6532.0914; train_edge_recon_loss: 256234.7234; train_gene_expr_recon_loss: 105097.6353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367864.4502; train_optim_loss: 367864.4502; val_kl_reg_loss: 6525.8067; val_edge_recon_loss: 255544.0847; val_gene_expr_recon_loss: 106233.7098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368303.6010; val_optim_loss: 368303.6010
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9882; val_best_f1_score: 0.9883; train_kl_reg_loss: 6541.9423; train_edge_recon_loss: 256124.3738; train_gene_expr_recon_loss: 92322.5112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 354988.8275; train_optim_loss: 354988.8275; val_kl_reg_loss: 6556.2521; val_edge_recon_loss: 255354.4961; val_gene_expr_recon_loss: 92488.8666; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 354399.6140; val_optim_loss: 354399.6140
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9982; val_auprc_score: 0.9976; val_best_acc_score: 0.9884; val_best_f1_score: 0.9885; train_kl_reg_loss: 6542.0603; train_edge_recon_loss: 256100.0394; train_gene_expr_recon_loss: 91644.7764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 354286.8764; train_optim_loss: 354286.8764; val_kl_reg_loss: 6511.1156; val_edge_recon_loss: 255311.4301; val_gene_expr_recon_loss: 88466.5874; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 350289.1338; val_optim_loss: 350289.1338
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9882; val_best_f1_score: 0.9883; train_kl_reg_loss: 6546.7722; train_edge_recon_loss: 256015.3059; train_gene_expr_recon_loss: 91010.0144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 353572.0923; train_optim_loss: 353572.0923; val_kl_reg_loss: 6564.2028; val_edge_recon_loss: 255346.7650; val_gene_expr_recon_loss: 92040.2532; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 353951.2202; val_optim_loss: 353951.2202
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9884; val_best_f1_score: 0.9885; train_kl_reg_loss: 6550.3461; train_edge_recon_loss: 255967.4934; train_gene_expr_recon_loss: 90832.2371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 353350.0767; train_optim_loss: 353350.0767; val_kl_reg_loss: 6569.1093; val_edge_recon_loss: 255229.6224; val_gene_expr_recon_loss: 91032.5572; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 352831.2891; val_optim_loss: 352831.2891
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9885; val_best_f1_score: 0.9886; train_kl_reg_loss: 6556.1705; train_edge_recon_loss: 255971.3674; train_gene_expr_recon_loss: 90591.8577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 353119.3953; train_optim_loss: 353119.3953; val_kl_reg_loss: 6567.4137; val_edge_recon_loss: 255304.5446; val_gene_expr_recon_loss: 90176.8809; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 352048.8388; val_optim_loss: 352048.8388
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9982; val_auprc_score: 0.9976; val_best_acc_score: 0.9886; val_best_f1_score: 0.9887; train_kl_reg_loss: 6557.8677; train_edge_recon_loss: 255942.9767; train_gene_expr_recon_loss: 90626.6051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 353127.4503; train_optim_loss: 353127.4503; val_kl_reg_loss: 6517.6056; val_edge_recon_loss: 255153.6568; val_gene_expr_recon_loss: 91661.3973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 353332.6601; val_optim_loss: 353332.6601

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9985; val_auprc_score: 0.9979; val_best_acc_score: 0.9892; val_best_f1_score: 0.9892; train_kl_reg_loss: 6593.4440; train_edge_recon_loss: 255789.8866; train_gene_expr_recon_loss: 90253.6554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 352636.9863; train_optim_loss: 352636.9863; val_kl_reg_loss: 6575.7088; val_edge_recon_loss: 254951.3209; val_gene_expr_recon_loss: 90068.7875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 351595.8168; val_optim_loss: 351595.8168
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9984; val_auprc_score: 0.9977; val_best_acc_score: 0.9891; val_best_f1_score: 0.9892; train_kl_reg_loss: 6589.1202; train_edge_recon_loss: 255761.4666; train_gene_expr_recon_loss: 90166.1494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 352516.7364; train_optim_loss: 352516.7364; val_kl_reg_loss: 6571.0381; val_edge_recon_loss: 254910.8222; val_gene_expr_recon_loss: 89961.5694; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 351443.4300; val_optim_loss: 351443.4300
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9985; val_auprc_score: 0.9980; val_best_acc_score: 0.9894; val_best_f1_score: 0.9894; train_kl_reg_loss: 6587.0987; train_edge_recon_loss: 255748.7016; train_gene_expr_recon_loss: 89877.4010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 352213.2012; train_optim_loss: 352213.2012; val_kl_reg_loss: 6565.3080; val_edge_recon_loss: 255040.1459; val_gene_expr_recon_loss: 89989.7047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 351595.1582; val_optim_loss: 351595.1582
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9897; val_best_f1_score: 0.9898; train_kl_reg_loss: 6583.6667; train_edge_recon_loss: 255762.4400; train_gene_expr_recon_loss: 89838.8789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 352184.9855; train_optim_loss: 352184.9855; val_kl_reg_loss: 6579.5326; val_edge_recon_loss: 255050.0595; val_gene_expr_recon_loss: 90274.0640; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 351903.6559; val_optim_loss: 351903.6559

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 140 min 51 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
val AUROC score: 0.9981
val AUPRC score: 0.9973
val best accuracy score: 0.9883
val best F1 score: 0.9884
val target rna MSE score: 0.5673
val source rna MSE score: 0.0779

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
