None
Run timestamp: 01072023_155436_36.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_36']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9881; val_auprc_score: 0.9841; val_best_acc_score: 0.9588; val_best_f1_score: 0.9598; train_kl_reg_loss: 7613.1372; train_edge_recon_loss: 265992.3553; train_gene_expr_recon_loss: 122373.4055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395978.8977; train_optim_loss: 395978.8977; val_kl_reg_loss: 7277.3641; val_edge_recon_loss: 260010.2922; val_gene_expr_recon_loss: 111401.6431; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 378689.3000; val_optim_loss: 378689.3000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9913; val_auprc_score: 0.9883; val_best_acc_score: 0.9672; val_best_f1_score: 0.9678; train_kl_reg_loss: 7155.9191; train_edge_recon_loss: 260283.7234; train_gene_expr_recon_loss: 108849.8891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376289.5315; train_optim_loss: 376289.5315; val_kl_reg_loss: 7040.1154; val_edge_recon_loss: 258789.8359; val_gene_expr_recon_loss: 105966.3631; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371796.3141; val_optim_loss: 371796.3141
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9931; val_auprc_score: 0.9906; val_best_acc_score: 0.9713; val_best_f1_score: 0.9718; train_kl_reg_loss: 6915.5908; train_edge_recon_loss: 259621.5141; train_gene_expr_recon_loss: 104912.8732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371449.9779; train_optim_loss: 371449.9779; val_kl_reg_loss: 6669.1235; val_edge_recon_loss: 258556.2049; val_gene_expr_recon_loss: 103026.9304; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368252.2590; val_optim_loss: 368252.2590
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9940; val_auprc_score: 0.9920; val_best_acc_score: 0.9741; val_best_f1_score: 0.9745; train_kl_reg_loss: 6771.0747; train_edge_recon_loss: 259050.3369; train_gene_expr_recon_loss: 102648.5170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368469.9284; train_optim_loss: 368469.9284; val_kl_reg_loss: 6629.2100; val_edge_recon_loss: 257987.4937; val_gene_expr_recon_loss: 101722.3711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366339.0742; val_optim_loss: 366339.0742
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9952; val_auprc_score: 0.9936; val_best_acc_score: 0.9775; val_best_f1_score: 0.9778; train_kl_reg_loss: 6671.6965; train_edge_recon_loss: 258595.1608; train_gene_expr_recon_loss: 101122.0564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366388.9135; train_optim_loss: 366388.9135; val_kl_reg_loss: 6537.8865; val_edge_recon_loss: 257531.2553; val_gene_expr_recon_loss: 100522.4986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364591.6414; val_optim_loss: 364591.6414
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9957; val_auprc_score: 0.9943; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 6598.9224; train_edge_recon_loss: 258253.9827; train_gene_expr_recon_loss: 100080.6230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364933.5283; train_optim_loss: 364933.5283; val_kl_reg_loss: 6427.5826; val_edge_recon_loss: 257308.8881; val_gene_expr_recon_loss: 99893.1702; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363629.6430; val_optim_loss: 363629.6430
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9960; val_auprc_score: 0.9947; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 6541.0976; train_edge_recon_loss: 258009.1557; train_gene_expr_recon_loss: 99440.7816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363991.0344; train_optim_loss: 363991.0344; val_kl_reg_loss: 6484.4023; val_edge_recon_loss: 257089.2643; val_gene_expr_recon_loss: 99403.8780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362977.5477; val_optim_loss: 362977.5477
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9964; val_auprc_score: 0.9951; val_best_acc_score: 0.9817; val_best_f1_score: 0.9819; train_kl_reg_loss: 6498.7796; train_edge_recon_loss: 257725.4329; train_gene_expr_recon_loss: 98980.2668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363204.4804; train_optim_loss: 363204.4804; val_kl_reg_loss: 6340.5977; val_edge_recon_loss: 256864.1514; val_gene_expr_recon_loss: 99042.2811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362247.0312; val_optim_loss: 362247.0312
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9967; val_auprc_score: 0.9956; val_best_acc_score: 0.9827; val_best_f1_score: 0.9829; train_kl_reg_loss: 6463.5987; train_edge_recon_loss: 257487.7492; train_gene_expr_recon_loss: 98391.8572; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362343.2058; train_optim_loss: 362343.2058; val_kl_reg_loss: 6455.0290; val_edge_recon_loss: 256501.8736; val_gene_expr_recon_loss: 98512.8090; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361469.7109; val_optim_loss: 361469.7109
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9970; val_auprc_score: 0.9960; val_best_acc_score: 0.9839; val_best_f1_score: 0.9840; train_kl_reg_loss: 6436.6753; train_edge_recon_loss: 257320.8776; train_gene_expr_recon_loss: 98121.1373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361878.6902; train_optim_loss: 361878.6902; val_kl_reg_loss: 6394.7040; val_edge_recon_loss: 256381.2912; val_gene_expr_recon_loss: 98393.6918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361169.6883; val_optim_loss: 361169.6883
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9972; val_auprc_score: 0.9964; val_best_acc_score: 0.9847; val_best_f1_score: 0.9848; train_kl_reg_loss: 6421.2338; train_edge_recon_loss: 257110.5715; train_gene_expr_recon_loss: 97713.1027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361244.9081; train_optim_loss: 361244.9081; val_kl_reg_loss: 6454.4373; val_edge_recon_loss: 256231.3840; val_gene_expr_recon_loss: 98116.0920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360801.9141; val_optim_loss: 360801.9141
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9970; val_auprc_score: 0.9956; val_best_acc_score: 0.9845; val_best_f1_score: 0.9847; train_kl_reg_loss: 6410.9473; train_edge_recon_loss: 257078.1211; train_gene_expr_recon_loss: 97443.2472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360932.3158; train_optim_loss: 360932.3158; val_kl_reg_loss: 6352.8346; val_edge_recon_loss: 256105.8908; val_gene_expr_recon_loss: 98340.4661; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360799.1910; val_optim_loss: 360799.1910
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9972; val_auprc_score: 0.9962; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 6405.4027; train_edge_recon_loss: 256878.0227; train_gene_expr_recon_loss: 97115.0038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360398.4286; train_optim_loss: 360398.4286; val_kl_reg_loss: 6332.5918; val_edge_recon_loss: 256024.0436; val_gene_expr_recon_loss: 98356.5163; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360713.1496; val_optim_loss: 360713.1496
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9974; val_auprc_score: 0.9967; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 6402.4455; train_edge_recon_loss: 256787.9869; train_gene_expr_recon_loss: 96974.7729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360165.2050; train_optim_loss: 360165.2050; val_kl_reg_loss: 6337.4366; val_edge_recon_loss: 256102.9891; val_gene_expr_recon_loss: 98042.8946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360483.3211; val_optim_loss: 360483.3211
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9976; val_auprc_score: 0.9967; val_best_acc_score: 0.9859; val_best_f1_score: 0.9859; train_kl_reg_loss: 6404.6617; train_edge_recon_loss: 256647.1739; train_gene_expr_recon_loss: 96900.4341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359952.2691; train_optim_loss: 359952.2691; val_kl_reg_loss: 6334.9414; val_edge_recon_loss: 256016.7623; val_gene_expr_recon_loss: 98014.9882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360366.6926; val_optim_loss: 360366.6926
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9977; val_auprc_score: 0.9970; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 6405.2551; train_edge_recon_loss: 256593.8634; train_gene_expr_recon_loss: 96652.2387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359651.3570; train_optim_loss: 359651.3570; val_kl_reg_loss: 6356.4620; val_edge_recon_loss: 255724.4713; val_gene_expr_recon_loss: 98127.7397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360208.6730; val_optim_loss: 360208.6730
