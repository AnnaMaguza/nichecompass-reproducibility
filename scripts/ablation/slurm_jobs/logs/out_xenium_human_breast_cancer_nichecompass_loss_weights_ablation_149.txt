None
Run timestamp: 15072023_002341_149.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_149']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9172; val_auprc_score: 0.8967; val_best_acc_score: 0.8475; val_best_f1_score: 0.8579; train_kl_reg_loss: 49917.3064; train_edge_recon_loss: 2892454.3588; train_gene_expr_recon_loss: 7445016.5654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10387388.2324; train_optim_loss: 10387388.2324; val_kl_reg_loss: 48009.5602; val_edge_recon_loss: 2787619.2862; val_gene_expr_recon_loss: 6891572.2434; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9727201.1184; val_optim_loss: 9727201.1184
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9339; val_auprc_score: 0.9170; val_best_acc_score: 0.8674; val_best_f1_score: 0.8764; train_kl_reg_loss: 45141.1222; train_edge_recon_loss: 2712944.5449; train_gene_expr_recon_loss: 6713347.9228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9471433.6044; train_optim_loss: 9471433.6044; val_kl_reg_loss: 40037.5612; val_edge_recon_loss: 2740419.9605; val_gene_expr_recon_loss: 6558861.8618; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9339319.3750; val_optim_loss: 9339319.3750
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9408; val_auprc_score: 0.9245; val_best_acc_score: 0.8775; val_best_f1_score: 0.8854; train_kl_reg_loss: 38703.8863; train_edge_recon_loss: 2683102.3059; train_gene_expr_recon_loss: 6456719.5934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9178525.7838; train_optim_loss: 9178525.7838; val_kl_reg_loss: 36353.0659; val_edge_recon_loss: 2728745.7171; val_gene_expr_recon_loss: 6357062.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9122160.8816; val_optim_loss: 9122160.8816
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9449; val_auprc_score: 0.9304; val_best_acc_score: 0.8828; val_best_f1_score: 0.8902; train_kl_reg_loss: 35825.2498; train_edge_recon_loss: 2674381.7978; train_gene_expr_recon_loss: 6288847.2125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8999054.2647; train_optim_loss: 8999054.2647; val_kl_reg_loss: 33998.1766; val_edge_recon_loss: 2715777.1711; val_gene_expr_recon_loss: 6244235.7895; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8994011.1316; val_optim_loss: 8994011.1316
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9468; val_auprc_score: 0.9327; val_best_acc_score: 0.8870; val_best_f1_score: 0.8934; train_kl_reg_loss: 34132.4509; train_edge_recon_loss: 2667660.1699; train_gene_expr_recon_loss: 6188502.3853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8890295.0000; train_optim_loss: 8890295.0000; val_kl_reg_loss: 32768.7781; val_edge_recon_loss: 2712270.1645; val_gene_expr_recon_loss: 6165814.5395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8910853.5132; val_optim_loss: 8910853.5132
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9507; val_auprc_score: 0.9385; val_best_acc_score: 0.8907; val_best_f1_score: 0.8964; train_kl_reg_loss: 33195.4047; train_edge_recon_loss: 2659965.9937; train_gene_expr_recon_loss: 6117286.8419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8810448.2581; train_optim_loss: 8810448.2581; val_kl_reg_loss: 31795.2352; val_edge_recon_loss: 2703655.7664; val_gene_expr_recon_loss: 6098840.9868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8834291.9868; val_optim_loss: 8834291.9868
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9518; val_auprc_score: 0.9395; val_best_acc_score: 0.8923; val_best_f1_score: 0.8981; train_kl_reg_loss: 32424.5534; train_edge_recon_loss: 2659565.1585; train_gene_expr_recon_loss: 6072181.1471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8764170.8574; train_optim_loss: 8764170.8574; val_kl_reg_loss: 31483.4480; val_edge_recon_loss: 2704334.3947; val_gene_expr_recon_loss: 6078162.3289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8813980.1842; val_optim_loss: 8813980.1842
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9543; val_auprc_score: 0.9431; val_best_acc_score: 0.8949; val_best_f1_score: 0.9004; train_kl_reg_loss: 31781.3128; train_edge_recon_loss: 2656428.3581; train_gene_expr_recon_loss: 6039952.2684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8728161.9588; train_optim_loss: 8728161.9588; val_kl_reg_loss: 30731.4721; val_edge_recon_loss: 2701231.8454; val_gene_expr_recon_loss: 6074858.1645; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8806821.4605; val_optim_loss: 8806821.4605
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9550; val_auprc_score: 0.9440; val_best_acc_score: 0.8944; val_best_f1_score: 0.8999; train_kl_reg_loss: 31446.6150; train_edge_recon_loss: 2655044.7158; train_gene_expr_recon_loss: 6014691.9706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8701183.2926; train_optim_loss: 8701183.2926; val_kl_reg_loss: 29962.2678; val_edge_recon_loss: 2702851.3421; val_gene_expr_recon_loss: 6036512.0329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8769325.6184; val_optim_loss: 8769325.6184
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9550; val_auprc_score: 0.9436; val_best_acc_score: 0.8952; val_best_f1_score: 0.9000; train_kl_reg_loss: 30948.2862; train_edge_recon_loss: 2654413.4853; train_gene_expr_recon_loss: 6000745.5581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8686107.3081; train_optim_loss: 8686107.3081; val_kl_reg_loss: 30276.3038; val_edge_recon_loss: 2702438.5888; val_gene_expr_recon_loss: 6009870.9868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8742585.8684; val_optim_loss: 8742585.8684
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9567; val_auprc_score: 0.9464; val_best_acc_score: 0.8975; val_best_f1_score: 0.9020; train_kl_reg_loss: 30476.2040; train_edge_recon_loss: 2652127.1022; train_gene_expr_recon_loss: 5985927.0301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8668530.3228; train_optim_loss: 8668530.3228; val_kl_reg_loss: 29692.2302; val_edge_recon_loss: 2701478.5362; val_gene_expr_recon_loss: 6007371.7303; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8738542.4539; val_optim_loss: 8738542.4539
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9586; val_auprc_score: 0.9489; val_best_acc_score: 0.8988; val_best_f1_score: 0.9031; train_kl_reg_loss: 30227.9160; train_edge_recon_loss: 2651117.9404; train_gene_expr_recon_loss: 5973509.0110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8654854.8588; train_optim_loss: 8654854.8588; val_kl_reg_loss: 29095.5065; val_edge_recon_loss: 2698676.3388; val_gene_expr_recon_loss: 5994128.4145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8721900.1974; val_optim_loss: 8721900.1974
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9589; val_auprc_score: 0.9489; val_best_acc_score: 0.9012; val_best_f1_score: 0.9052; train_kl_reg_loss: 29855.8566; train_edge_recon_loss: 2648480.9015; train_gene_expr_recon_loss: 5968619.2721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8646956.0221; train_optim_loss: 8646956.0221; val_kl_reg_loss: 29180.4483; val_edge_recon_loss: 2695625.0230; val_gene_expr_recon_loss: 6003083.6974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8727889.1974; val_optim_loss: 8727889.1974
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9591; val_auprc_score: 0.9489; val_best_acc_score: 0.9025; val_best_f1_score: 0.9061; train_kl_reg_loss: 29584.6468; train_edge_recon_loss: 2646603.1287; train_gene_expr_recon_loss: 5956875.1103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8633062.8890; train_optim_loss: 8633062.8890; val_kl_reg_loss: 28432.3237; val_edge_recon_loss: 2694943.4276; val_gene_expr_recon_loss: 5979897.6118; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8703273.3553; val_optim_loss: 8703273.3553
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9594; val_auprc_score: 0.9500; val_best_acc_score: 0.9012; val_best_f1_score: 0.9054; train_kl_reg_loss: 29193.5327; train_edge_recon_loss: 2646954.4585; train_gene_expr_recon_loss: 5951164.4676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8627312.4706; train_optim_loss: 8627312.4706; val_kl_reg_loss: 28419.6960; val_edge_recon_loss: 2699622.5658; val_gene_expr_recon_loss: 5961864.3355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8689906.5789; val_optim_loss: 8689906.5789
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9603; val_auprc_score: 0.9508; val_best_acc_score: 0.9033; val_best_f1_score: 0.9069; train_kl_reg_loss: 29088.8251; train_edge_recon_loss: 2645613.3507; train_gene_expr_recon_loss: 5947287.0985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8621989.2882; train_optim_loss: 8621989.2882; val_kl_reg_loss: 28348.7782; val_edge_recon_loss: 2696670.0132; val_gene_expr_recon_loss: 5984176.9934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8709195.7895; val_optim_loss: 8709195.7895
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9625; val_auprc_score: 0.9539; val_best_acc_score: 0.9053; val_best_f1_score: 0.9093; train_kl_reg_loss: 28626.5339; train_edge_recon_loss: 2644688.4037; train_gene_expr_recon_loss: 5942360.1699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8615675.0978; train_optim_loss: 8615675.0978; val_kl_reg_loss: 27301.4025; val_edge_recon_loss: 2691418.0822; val_gene_expr_recon_loss: 5961782.0789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8680501.5987; val_optim_loss: 8680501.5987
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9614; val_auprc_score: 0.9524; val_best_acc_score: 0.9045; val_best_f1_score: 0.9084; train_kl_reg_loss: 28333.0640; train_edge_recon_loss: 2642114.6581; train_gene_expr_recon_loss: 5936897.7382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8607345.4566; train_optim_loss: 8607345.4566; val_kl_reg_loss: 27850.2935; val_edge_recon_loss: 2696027.6316; val_gene_expr_recon_loss: 5949674.6908; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8673552.6250; val_optim_loss: 8673552.6250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9636; val_auprc_score: 0.9547; val_best_acc_score: 0.9073; val_best_f1_score: 0.9109; train_kl_reg_loss: 28218.2929; train_edge_recon_loss: 2641415.7978; train_gene_expr_recon_loss: 5932523.9735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8602158.0522; train_optim_loss: 8602158.0522; val_kl_reg_loss: 27317.4315; val_edge_recon_loss: 2691065.5757; val_gene_expr_recon_loss: 5973439.7566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8691822.7632; val_optim_loss: 8691822.7632
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9644; val_auprc_score: 0.9565; val_best_acc_score: 0.9074; val_best_f1_score: 0.9111; train_kl_reg_loss: 27923.5796; train_edge_recon_loss: 2640322.7265; train_gene_expr_recon_loss: 5930976.7985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8599223.1103; train_optim_loss: 8599223.1103; val_kl_reg_loss: 27543.7357; val_edge_recon_loss: 2684355.8914; val_gene_expr_recon_loss: 5992977.4737; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8704877.0526; val_optim_loss: 8704877.0526
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9634; val_auprc_score: 0.9549; val_best_acc_score: 0.9084; val_best_f1_score: 0.9119; train_kl_reg_loss: 27821.5842; train_edge_recon_loss: 2639931.9772; train_gene_expr_recon_loss: 5927236.0676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8594989.6125; train_optim_loss: 8594989.6125; val_kl_reg_loss: 26922.1298; val_edge_recon_loss: 2691566.8914; val_gene_expr_recon_loss: 5973562.9934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8692052.0132; val_optim_loss: 8692052.0132
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9635; val_auprc_score: 0.9552; val_best_acc_score: 0.9082; val_best_f1_score: 0.9118; train_kl_reg_loss: 27622.5768; train_edge_recon_loss: 2638799.7173; train_gene_expr_recon_loss: 5927465.9463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8593888.2434; train_optim_loss: 8593888.2434; val_kl_reg_loss: 27374.6484; val_edge_recon_loss: 2691815.3355; val_gene_expr_recon_loss: 5962590.8816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8681780.8618; val_optim_loss: 8681780.8618

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9637; val_auprc_score: 0.9555; val_best_acc_score: 0.9086; val_best_f1_score: 0.9123; train_kl_reg_loss: 28009.6251; train_edge_recon_loss: 2638045.8228; train_gene_expr_recon_loss: 5888078.6860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8554134.1279; train_optim_loss: 8554134.1279; val_kl_reg_loss: 27268.1675; val_edge_recon_loss: 2692693.8421; val_gene_expr_recon_loss: 5929069.1184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8649031.1382; val_optim_loss: 8649031.1382
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9642; val_auprc_score: 0.9562; val_best_acc_score: 0.9085; val_best_f1_score: 0.9121; train_kl_reg_loss: 28149.7756; train_edge_recon_loss: 2635872.0118; train_gene_expr_recon_loss: 5884830.2963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8548852.0765; train_optim_loss: 8548852.0765; val_kl_reg_loss: 27577.3917; val_edge_recon_loss: 2688073.1645; val_gene_expr_recon_loss: 5928086.2303; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8643736.8289; val_optim_loss: 8643736.8289
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9653; val_auprc_score: 0.9569; val_best_acc_score: 0.9112; val_best_f1_score: 0.9144; train_kl_reg_loss: 28397.9276; train_edge_recon_loss: 2636706.4864; train_gene_expr_recon_loss: 5886666.2919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8551770.6890; train_optim_loss: 8551770.6890; val_kl_reg_loss: 27517.6943; val_edge_recon_loss: 2682328.2763; val_gene_expr_recon_loss: 5936464.9145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8646310.9211; val_optim_loss: 8646310.9211
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9647; val_auprc_score: 0.9565; val_best_acc_score: 0.9099; val_best_f1_score: 0.9133; train_kl_reg_loss: 28450.0951; train_edge_recon_loss: 2635609.8309; train_gene_expr_recon_loss: 5883146.4831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8547206.4096; train_optim_loss: 8547206.4096; val_kl_reg_loss: 27696.7871; val_edge_recon_loss: 2688050.3487; val_gene_expr_recon_loss: 5925576.2171; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8641323.3487; val_optim_loss: 8641323.3487
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9637; val_auprc_score: 0.9552; val_best_acc_score: 0.9079; val_best_f1_score: 0.9118; train_kl_reg_loss: 28530.4232; train_edge_recon_loss: 2633020.6732; train_gene_expr_recon_loss: 5882218.2184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8543769.3213; train_optim_loss: 8543769.3213; val_kl_reg_loss: 27832.0557; val_edge_recon_loss: 2690260.3125; val_gene_expr_recon_loss: 5915739.9145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8633832.2829; val_optim_loss: 8633832.2829
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9650; val_auprc_score: 0.9573; val_best_acc_score: 0.9092; val_best_f1_score: 0.9127; train_kl_reg_loss: 28453.3472; train_edge_recon_loss: 2636557.2353; train_gene_expr_recon_loss: 5879317.5743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8544328.1419; train_optim_loss: 8544328.1419; val_kl_reg_loss: 27719.4736; val_edge_recon_loss: 2690709.8618; val_gene_expr_recon_loss: 5925149.0855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8643578.3947; val_optim_loss: 8643578.3947
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9657; val_auprc_score: 0.9583; val_best_acc_score: 0.9103; val_best_f1_score: 0.9136; train_kl_reg_loss: 28548.3332; train_edge_recon_loss: 2635989.7283; train_gene_expr_recon_loss: 5881539.0794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8546077.1257; train_optim_loss: 8546077.1257; val_kl_reg_loss: 27748.5628; val_edge_recon_loss: 2686622.7401; val_gene_expr_recon_loss: 5914643.3092; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8629014.6250; val_optim_loss: 8629014.6250
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9652; val_auprc_score: 0.9573; val_best_acc_score: 0.9099; val_best_f1_score: 0.9136; train_kl_reg_loss: 28529.8825; train_edge_recon_loss: 2634067.7169; train_gene_expr_recon_loss: 5882243.8434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8544841.4544; train_optim_loss: 8544841.4544; val_kl_reg_loss: 27721.5918; val_edge_recon_loss: 2685598.9934; val_gene_expr_recon_loss: 5943171.2566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8656491.8487; val_optim_loss: 8656491.8487
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9646; val_auprc_score: 0.9564; val_best_acc_score: 0.9092; val_best_f1_score: 0.9127; train_kl_reg_loss: 28507.2478; train_edge_recon_loss: 2635277.1489; train_gene_expr_recon_loss: 5880626.5493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8544410.9713; train_optim_loss: 8544410.9713; val_kl_reg_loss: 27653.4059; val_edge_recon_loss: 2690147.0099; val_gene_expr_recon_loss: 5928067.0724; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8645867.5263; val_optim_loss: 8645867.5263
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9662; val_auprc_score: 0.9587; val_best_acc_score: 0.9106; val_best_f1_score: 0.9138; train_kl_reg_loss: 28459.2869; train_edge_recon_loss: 2633305.6724; train_gene_expr_recon_loss: 5880465.9926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8542230.9721; train_optim_loss: 8542230.9721; val_kl_reg_loss: 27577.6259; val_edge_recon_loss: 2684023.7763; val_gene_expr_recon_loss: 5923115.9276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8634717.3026; val_optim_loss: 8634717.3026
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9661; val_auprc_score: 0.9585; val_best_acc_score: 0.9115; val_best_f1_score: 0.9147; train_kl_reg_loss: 28427.9633; train_edge_recon_loss: 2636213.9125; train_gene_expr_recon_loss: 5877927.5331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8542569.4169; train_optim_loss: 8542569.4169; val_kl_reg_loss: 27640.6188; val_edge_recon_loss: 2683895.9474; val_gene_expr_recon_loss: 5924796.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8636332.6579; val_optim_loss: 8636332.6579

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9655; val_auprc_score: 0.9574; val_best_acc_score: 0.9105; val_best_f1_score: 0.9142; train_kl_reg_loss: 28369.1032; train_edge_recon_loss: 2633717.8713; train_gene_expr_recon_loss: 5871442.5728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8533529.5456; train_optim_loss: 8533529.5456; val_kl_reg_loss: 27666.9753; val_edge_recon_loss: 2685754.7895; val_gene_expr_recon_loss: 5925994.8684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8639416.6447; val_optim_loss: 8639416.6447
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9647; val_auprc_score: 0.9562; val_best_acc_score: 0.9093; val_best_f1_score: 0.9128; train_kl_reg_loss: 28373.6644; train_edge_recon_loss: 2634458.0827; train_gene_expr_recon_loss: 5872730.2154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8535561.9544; train_optim_loss: 8535561.9544; val_kl_reg_loss: 27634.3924; val_edge_recon_loss: 2687322.7895; val_gene_expr_recon_loss: 5912637.1974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8627594.3750; val_optim_loss: 8627594.3750
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9661; val_auprc_score: 0.9583; val_best_acc_score: 0.9115; val_best_f1_score: 0.9150; train_kl_reg_loss: 28385.2276; train_edge_recon_loss: 2635085.6691; train_gene_expr_recon_loss: 5871780.9993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8535251.8963; train_optim_loss: 8535251.8963; val_kl_reg_loss: 27635.0351; val_edge_recon_loss: 2682149.2237; val_gene_expr_recon_loss: 5921041.5789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8630825.8289; val_optim_loss: 8630825.8289
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9656; val_auprc_score: 0.9580; val_best_acc_score: 0.9097; val_best_f1_score: 0.9133; train_kl_reg_loss: 28377.5165; train_edge_recon_loss: 2635741.9184; train_gene_expr_recon_loss: 5875932.8897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8540052.3301; train_optim_loss: 8540052.3301; val_kl_reg_loss: 27637.2361; val_edge_recon_loss: 2686264.2928; val_gene_expr_recon_loss: 5916901.1908; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8630802.7105; val_optim_loss: 8630802.7105
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9655; val_auprc_score: 0.9576; val_best_acc_score: 0.9101; val_best_f1_score: 0.9136; train_kl_reg_loss: 28391.1435; train_edge_recon_loss: 2635542.6368; train_gene_expr_recon_loss: 5868598.9846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8532532.7772; train_optim_loss: 8532532.7772; val_kl_reg_loss: 27637.3992; val_edge_recon_loss: 2686222.0822; val_gene_expr_recon_loss: 5907714.9079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8621574.3882; val_optim_loss: 8621574.3882
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9651; val_auprc_score: 0.9574; val_best_acc_score: 0.9098; val_best_f1_score: 0.9134; train_kl_reg_loss: 28406.5912; train_edge_recon_loss: 2634003.7500; train_gene_expr_recon_loss: 5873629.7728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8536040.0882; train_optim_loss: 8536040.0882; val_kl_reg_loss: 27691.9921; val_edge_recon_loss: 2687366.5197; val_gene_expr_recon_loss: 5919016.8421; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8634075.3158; val_optim_loss: 8634075.3158
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9644; val_auprc_score: 0.9564; val_best_acc_score: 0.9086; val_best_f1_score: 0.9123; train_kl_reg_loss: 28441.5803; train_edge_recon_loss: 2634496.7989; train_gene_expr_recon_loss: 5872095.3691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8535033.7434; train_optim_loss: 8535033.7434; val_kl_reg_loss: 27670.9078; val_edge_recon_loss: 2688486.2730; val_gene_expr_recon_loss: 5928802.7303; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8644959.9474; val_optim_loss: 8644959.9474
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9649; val_auprc_score: 0.9572; val_best_acc_score: 0.9088; val_best_f1_score: 0.9123; train_kl_reg_loss: 28427.6693; train_edge_recon_loss: 2632719.9937; train_gene_expr_recon_loss: 5872410.2691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8533557.9397; train_optim_loss: 8533557.9397; val_kl_reg_loss: 27706.4671; val_edge_recon_loss: 2688062.2434; val_gene_expr_recon_loss: 5922452.2829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8638220.9803; val_optim_loss: 8638220.9803
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9649; val_auprc_score: 0.9566; val_best_acc_score: 0.9099; val_best_f1_score: 0.9133; train_kl_reg_loss: 28408.4345; train_edge_recon_loss: 2635940.5529; train_gene_expr_recon_loss: 5871694.7838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8536043.7926; train_optim_loss: 8536043.7926; val_kl_reg_loss: 27682.8706; val_edge_recon_loss: 2687727.2138; val_gene_expr_recon_loss: 5926536.0658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8641946.1316; val_optim_loss: 8641946.1316

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9645; val_auprc_score: 0.9566; val_best_acc_score: 0.9075; val_best_f1_score: 0.9112; train_kl_reg_loss: 28421.2623; train_edge_recon_loss: 2635443.3798; train_gene_expr_recon_loss: 5872305.6022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8536170.2515; train_optim_loss: 8536170.2515; val_kl_reg_loss: 27679.7190; val_edge_recon_loss: 2698791.2796; val_gene_expr_recon_loss: 5919609.7632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8646080.7763; val_optim_loss: 8646080.7763
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9643; val_auprc_score: 0.9557; val_best_acc_score: 0.9087; val_best_f1_score: 0.9122; train_kl_reg_loss: 28420.3249; train_edge_recon_loss: 2633284.5846; train_gene_expr_recon_loss: 5872701.9574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8534406.8743; train_optim_loss: 8534406.8743; val_kl_reg_loss: 27692.1336; val_edge_recon_loss: 2688241.3059; val_gene_expr_recon_loss: 5913041.0395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8628974.4605; val_optim_loss: 8628974.4605
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9657; val_auprc_score: 0.9579; val_best_acc_score: 0.9108; val_best_f1_score: 0.9141; train_kl_reg_loss: 28425.7093; train_edge_recon_loss: 2635286.9952; train_gene_expr_recon_loss: 5871676.2949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8535388.9949; train_optim_loss: 8535388.9949; val_kl_reg_loss: 27689.4829; val_edge_recon_loss: 2683367.7303; val_gene_expr_recon_loss: 5923891.3421; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8634948.6184; val_optim_loss: 8634948.6184
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9655; val_auprc_score: 0.9579; val_best_acc_score: 0.9102; val_best_f1_score: 0.9136; train_kl_reg_loss: 28434.8115; train_edge_recon_loss: 2633928.7886; train_gene_expr_recon_loss: 5871964.3743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8534327.9779; train_optim_loss: 8534327.9779; val_kl_reg_loss: 27681.2195; val_edge_recon_loss: 2685211.2237; val_gene_expr_recon_loss: 5917404.4408; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8630296.8947; val_optim_loss: 8630296.8947

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 79 min 23 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9656
Val AUPRC score: 0.9573
Val best accuracy score: 0.9109
Val best F1 score: 0.9144
Val gene expr MSE score: 1.3642

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
