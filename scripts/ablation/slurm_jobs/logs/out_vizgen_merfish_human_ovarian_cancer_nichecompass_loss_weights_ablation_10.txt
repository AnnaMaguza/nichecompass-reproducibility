None
Run timestamp: 03072023_201452_10.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_10']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9469; val_auprc_score: 0.9544; val_best_acc_score: 0.8723; val_best_f1_score: 0.8664; train_kl_reg_loss: 5170.6868; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 143759.8896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 148930.5764; train_optim_loss: 148930.5764; val_kl_reg_loss: 3459.0723; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 133239.6849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136698.7566; val_optim_loss: 136698.7566
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9560; val_auprc_score: 0.9628; val_best_acc_score: 0.8868; val_best_f1_score: 0.8840; train_kl_reg_loss: 3081.4387; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 131611.2842; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134692.7229; train_optim_loss: 134692.7229; val_kl_reg_loss: 2783.3934; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 128908.0718; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131691.4653; val_optim_loss: 131691.4653
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9617; val_auprc_score: 0.9678; val_best_acc_score: 0.8925; val_best_f1_score: 0.8920; train_kl_reg_loss: 2632.7365; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 128531.5536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131164.2900; train_optim_loss: 131164.2900; val_kl_reg_loss: 2482.7256; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126813.9526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129296.6780; val_optim_loss: 129296.6780
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9646; val_auprc_score: 0.9705; val_best_acc_score: 0.9029; val_best_f1_score: 0.8989; train_kl_reg_loss: 2437.0531; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126899.2359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129336.2890; train_optim_loss: 129336.2890; val_kl_reg_loss: 2350.4523; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125764.7401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128115.1925; val_optim_loss: 128115.1925
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9666; val_auprc_score: 0.9720; val_best_acc_score: 0.9049; val_best_f1_score: 0.9035; train_kl_reg_loss: 2336.8247; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125934.1841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128271.0088; train_optim_loss: 128271.0088; val_kl_reg_loss: 2271.9314; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125147.0041; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127418.9359; val_optim_loss: 127418.9359
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9683; val_auprc_score: 0.9737; val_best_acc_score: 0.9095; val_best_f1_score: 0.9053; train_kl_reg_loss: 2282.9280; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125344.4494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127627.3775; train_optim_loss: 127627.3775; val_kl_reg_loss: 2235.6818; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124647.7099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126883.3915; val_optim_loss: 126883.3915
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9693; val_auprc_score: 0.9744; val_best_acc_score: 0.9112; val_best_f1_score: 0.9094; train_kl_reg_loss: 2250.3378; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125002.7902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127253.1279; train_optim_loss: 127253.1279; val_kl_reg_loss: 2186.8162; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124295.6949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126482.5110; val_optim_loss: 126482.5110
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9694; val_auprc_score: 0.9745; val_best_acc_score: 0.9112; val_best_f1_score: 0.9075; train_kl_reg_loss: 2234.6571; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124570.6666; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126805.3238; train_optim_loss: 126805.3238; val_kl_reg_loss: 2186.1777; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123984.9259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126171.1038; val_optim_loss: 126171.1038
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9720; val_auprc_score: 0.9766; val_best_acc_score: 0.9157; val_best_f1_score: 0.9141; train_kl_reg_loss: 2226.9701; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124329.3288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126556.2989; train_optim_loss: 126556.2989; val_kl_reg_loss: 2184.6647; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123769.9982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125954.6629; val_optim_loss: 125954.6629
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9720; val_auprc_score: 0.9765; val_best_acc_score: 0.9156; val_best_f1_score: 0.9121; train_kl_reg_loss: 2222.4326; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124068.7277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126291.1603; train_optim_loss: 126291.1603; val_kl_reg_loss: 2135.6655; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123677.5120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125813.1772; val_optim_loss: 125813.1772
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9734; val_auprc_score: 0.9776; val_best_acc_score: 0.9165; val_best_f1_score: 0.9160; train_kl_reg_loss: 2219.2277; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123911.7421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126130.9699; train_optim_loss: 126130.9699; val_kl_reg_loss: 2163.7823; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123510.4847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125674.2669; val_optim_loss: 125674.2669
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9733; val_auprc_score: 0.9777; val_best_acc_score: 0.9177; val_best_f1_score: 0.9161; train_kl_reg_loss: 2216.4488; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123759.0993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125975.5481; train_optim_loss: 125975.5481; val_kl_reg_loss: 2186.9386; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123477.1847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125664.1232; val_optim_loss: 125664.1232
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9735; val_auprc_score: 0.9778; val_best_acc_score: 0.9188; val_best_f1_score: 0.9161; train_kl_reg_loss: 2213.3657; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123679.3725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125892.7382; train_optim_loss: 125892.7382; val_kl_reg_loss: 2167.8737; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123306.6521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125474.5260; val_optim_loss: 125474.5260
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9741; val_auprc_score: 0.9783; val_best_acc_score: 0.9177; val_best_f1_score: 0.9165; train_kl_reg_loss: 2212.3923; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123507.2859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125719.6783; train_optim_loss: 125719.6783; val_kl_reg_loss: 2187.5676; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123286.9636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125474.5311; val_optim_loss: 125474.5311
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9737; val_auprc_score: 0.9781; val_best_acc_score: 0.9184; val_best_f1_score: 0.9174; train_kl_reg_loss: 2210.1303; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123407.3991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125617.5294; train_optim_loss: 125617.5294; val_kl_reg_loss: 2207.0131; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123096.4829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125303.4958; val_optim_loss: 125303.4958
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9744; val_auprc_score: 0.9787; val_best_acc_score: 0.9210; val_best_f1_score: 0.9187; train_kl_reg_loss: 2209.2826; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123341.0809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125550.3634; train_optim_loss: 125550.3634; val_kl_reg_loss: 2183.0468; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123035.5123; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125218.5588; val_optim_loss: 125218.5588
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9758; val_auprc_score: 0.9798; val_best_acc_score: 0.9221; val_best_f1_score: 0.9201; train_kl_reg_loss: 2209.1385; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123235.1606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125444.2990; train_optim_loss: 125444.2990; val_kl_reg_loss: 2157.7439; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122958.3045; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125116.0483; val_optim_loss: 125116.0483
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9758; val_auprc_score: 0.9797; val_best_acc_score: 0.9219; val_best_f1_score: 0.9212; train_kl_reg_loss: 2207.5850; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123132.5670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125340.1520; train_optim_loss: 125340.1520; val_kl_reg_loss: 2160.2934; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123147.4347; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125307.7281; val_optim_loss: 125307.7281
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9755; val_auprc_score: 0.9795; val_best_acc_score: 0.9225; val_best_f1_score: 0.9206; train_kl_reg_loss: 2209.1124; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123101.2632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125310.3755; train_optim_loss: 125310.3755; val_kl_reg_loss: 2157.5420; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122926.5062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125084.0480; val_optim_loss: 125084.0480
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9767; val_auprc_score: 0.9804; val_best_acc_score: 0.9248; val_best_f1_score: 0.9219; train_kl_reg_loss: 2209.2999; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123037.3311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125246.6309; train_optim_loss: 125246.6309; val_kl_reg_loss: 2149.3215; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122745.7923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124895.1138; val_optim_loss: 124895.1138
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9769; val_auprc_score: 0.9807; val_best_acc_score: 0.9245; val_best_f1_score: 0.9218; train_kl_reg_loss: 2208.9274; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 122962.4781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125171.4055; train_optim_loss: 125171.4055; val_kl_reg_loss: 2184.0774; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123113.7658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125297.8429; val_optim_loss: 125297.8429
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9774; val_auprc_score: 0.9811; val_best_acc_score: 0.9253; val_best_f1_score: 0.9245; train_kl_reg_loss: 2209.5517; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 122918.3112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125127.8629; train_optim_loss: 125127.8629; val_kl_reg_loss: 2179.6918; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122843.4026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125023.0942; val_optim_loss: 125023.0942
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9771; val_auprc_score: 0.9807; val_best_acc_score: 0.9252; val_best_f1_score: 0.9241; train_kl_reg_loss: 2207.8294; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 122834.1044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125041.9339; train_optim_loss: 125041.9339; val_kl_reg_loss: 2158.4195; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122770.6513; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124929.0705; val_optim_loss: 124929.0705
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9773; val_auprc_score: 0.9812; val_best_acc_score: 0.9265; val_best_f1_score: 0.9247; train_kl_reg_loss: 2207.7630; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 122818.6995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125026.4624; train_optim_loss: 125026.4624; val_kl_reg_loss: 2171.4495; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122703.4255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124874.8749; val_optim_loss: 124874.8749
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9779; val_auprc_score: 0.9816; val_best_acc_score: 0.9278; val_best_f1_score: 0.9260; train_kl_reg_loss: 2207.2777; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 122742.7474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124950.0251; train_optim_loss: 124950.0251; val_kl_reg_loss: 2202.6544; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122689.0494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124891.7033; val_optim_loss: 124891.7033
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9780; val_auprc_score: 0.9817; val_best_acc_score: 0.9265; val_best_f1_score: 0.9256; train_kl_reg_loss: 2208.4700; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 122755.2514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124963.7214; train_optim_loss: 124963.7214; val_kl_reg_loss: 2150.1296; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122562.9008; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124713.0305; val_optim_loss: 124713.0305
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9779; val_auprc_score: 0.9815; val_best_acc_score: 0.9263; val_best_f1_score: 0.9251; train_kl_reg_loss: 2208.3832; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 122714.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124923.1769; train_optim_loss: 124923.1769; val_kl_reg_loss: 2203.9552; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122661.4994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124865.4548; val_optim_loss: 124865.4548
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9785; val_auprc_score: 0.9821; val_best_acc_score: 0.9288; val_best_f1_score: 0.9275; train_kl_reg_loss: 2208.1297; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 122649.1934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124857.3231; train_optim_loss: 124857.3231; val_kl_reg_loss: 2179.7939; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122531.2605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124711.0545; val_optim_loss: 124711.0545
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9784; val_auprc_score: 0.9818; val_best_acc_score: 0.9286; val_best_f1_score: 0.9271; train_kl_reg_loss: 2207.5334; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 122626.4666; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124834.0000; train_optim_loss: 124834.0000; val_kl_reg_loss: 2204.2427; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122601.1495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124805.3919; val_optim_loss: 124805.3919
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9789; val_auprc_score: 0.9823; val_best_acc_score: 0.9294; val_best_f1_score: 0.9274; train_kl_reg_loss: 2206.6944; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 122635.0388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124841.7334; train_optim_loss: 124841.7334; val_kl_reg_loss: 2161.1332; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122643.2388; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124804.3723; val_optim_loss: 124804.3723
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9793; val_auprc_score: 0.9826; val_best_acc_score: 0.9300; val_best_f1_score: 0.9279; train_kl_reg_loss: 2206.9784; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 122560.6255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124767.6040; train_optim_loss: 124767.6040; val_kl_reg_loss: 2167.5049; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122572.7872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124740.2921; val_optim_loss: 124740.2921
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9789; val_auprc_score: 0.9824; val_best_acc_score: 0.9295; val_best_f1_score: 0.9280; train_kl_reg_loss: 2206.0146; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 122552.3664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124758.3809; train_optim_loss: 124758.3809; val_kl_reg_loss: 2198.5893; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122610.3992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124808.9880; val_optim_loss: 124808.9880

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9804; val_auprc_score: 0.9836; val_best_acc_score: 0.9332; val_best_f1_score: 0.9316; train_kl_reg_loss: 2157.2318; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121848.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124005.3234; train_optim_loss: 124005.3234; val_kl_reg_loss: 2123.0402; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122082.4115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124205.4516; val_optim_loss: 124205.4516
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9803; val_auprc_score: 0.9835; val_best_acc_score: 0.9327; val_best_f1_score: 0.9308; train_kl_reg_loss: 2148.8640; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121726.2610; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123875.1250; train_optim_loss: 123875.1250; val_kl_reg_loss: 2111.9825; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 121979.9708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124091.9537; val_optim_loss: 124091.9537
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9810; val_auprc_score: 0.9842; val_best_acc_score: 0.9339; val_best_f1_score: 0.9317; train_kl_reg_loss: 2147.7164; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121698.9550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123846.6713; train_optim_loss: 123846.6713; val_kl_reg_loss: 2116.1959; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122025.7548; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124141.9507; val_optim_loss: 124141.9507
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9802; val_auprc_score: 0.9835; val_best_acc_score: 0.9324; val_best_f1_score: 0.9304; train_kl_reg_loss: 2148.0543; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121682.3622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123830.4164; train_optim_loss: 123830.4164; val_kl_reg_loss: 2128.1600; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122013.4171; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124141.5770; val_optim_loss: 124141.5770
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9808; val_auprc_score: 0.9841; val_best_acc_score: 0.9328; val_best_f1_score: 0.9319; train_kl_reg_loss: 2146.2036; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121670.4699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123816.6736; train_optim_loss: 123816.6736; val_kl_reg_loss: 2105.5419; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 121872.3527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123977.8940; val_optim_loss: 123977.8940
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9805; val_auprc_score: 0.9837; val_best_acc_score: 0.9326; val_best_f1_score: 0.9307; train_kl_reg_loss: 2146.0604; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121697.8429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123843.9032; train_optim_loss: 123843.9032; val_kl_reg_loss: 2129.3306; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122034.9712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124164.3020; val_optim_loss: 124164.3020
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9804; val_auprc_score: 0.9836; val_best_acc_score: 0.9319; val_best_f1_score: 0.9314; train_kl_reg_loss: 2146.0092; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121679.0627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123825.0720; train_optim_loss: 123825.0720; val_kl_reg_loss: 2116.9761; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 121899.3264; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124016.3028; val_optim_loss: 124016.3028
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9806; val_auprc_score: 0.9838; val_best_acc_score: 0.9318; val_best_f1_score: 0.9314; train_kl_reg_loss: 2145.4425; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121659.7763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123805.2187; train_optim_loss: 123805.2187; val_kl_reg_loss: 2120.2717; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 121837.6428; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123957.9148; val_optim_loss: 123957.9148
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9805; val_auprc_score: 0.9838; val_best_acc_score: 0.9322; val_best_f1_score: 0.9316; train_kl_reg_loss: 2144.5321; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121684.6851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123829.2173; train_optim_loss: 123829.2173; val_kl_reg_loss: 2119.2096; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 121912.4947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124031.7045; val_optim_loss: 124031.7045
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9808; val_auprc_score: 0.9841; val_best_acc_score: 0.9333; val_best_f1_score: 0.9326; train_kl_reg_loss: 2144.9367; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121629.2362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123774.1730; train_optim_loss: 123774.1730; val_kl_reg_loss: 2113.9401; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 121948.6955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124062.6355; val_optim_loss: 124062.6355
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9808; val_auprc_score: 0.9840; val_best_acc_score: 0.9334; val_best_f1_score: 0.9327; train_kl_reg_loss: 2144.6658; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121574.5189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123719.1845; train_optim_loss: 123719.1845; val_kl_reg_loss: 2113.3538; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 121946.6349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124059.9888; val_optim_loss: 124059.9888
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9810; val_auprc_score: 0.9842; val_best_acc_score: 0.9344; val_best_f1_score: 0.9335; train_kl_reg_loss: 2144.2520; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121604.6410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123748.8930; train_optim_loss: 123748.8930; val_kl_reg_loss: 2115.9754; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 121770.3494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123886.3243; val_optim_loss: 123886.3243
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9808; val_auprc_score: 0.9840; val_best_acc_score: 0.9334; val_best_f1_score: 0.9326; train_kl_reg_loss: 2143.6764; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121594.0885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123737.7649; train_optim_loss: 123737.7649; val_kl_reg_loss: 2122.1441; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 121957.6765; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124079.8208; val_optim_loss: 124079.8208
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9810; val_auprc_score: 0.9842; val_best_acc_score: 0.9341; val_best_f1_score: 0.9332; train_kl_reg_loss: 2143.8864; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121592.6609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123736.5475; train_optim_loss: 123736.5475; val_kl_reg_loss: 2115.7776; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 121853.0056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123968.7829; val_optim_loss: 123968.7829
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9811; val_auprc_score: 0.9842; val_best_acc_score: 0.9339; val_best_f1_score: 0.9330; train_kl_reg_loss: 2143.8016; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121569.0946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123712.8962; train_optim_loss: 123712.8962; val_kl_reg_loss: 2119.0783; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 121864.5915; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123983.6699; val_optim_loss: 123983.6699
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9810; val_auprc_score: 0.9841; val_best_acc_score: 0.9345; val_best_f1_score: 0.9336; train_kl_reg_loss: 2142.7820; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121595.0964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123737.8783; train_optim_loss: 123737.8783; val_kl_reg_loss: 2117.8204; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 121961.8417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124079.6619; val_optim_loss: 124079.6619

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9807; val_auprc_score: 0.9838; val_best_acc_score: 0.9334; val_best_f1_score: 0.9324; train_kl_reg_loss: 2138.8604; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121461.7528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123600.6132; train_optim_loss: 123600.6132; val_kl_reg_loss: 2114.2725; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 121782.3381; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123896.6109; val_optim_loss: 123896.6109
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9809; val_auprc_score: 0.9842; val_best_acc_score: 0.9342; val_best_f1_score: 0.9331; train_kl_reg_loss: 2138.5096; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121467.6557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123606.1653; train_optim_loss: 123606.1653; val_kl_reg_loss: 2112.2953; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 121993.9827; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124106.2777; val_optim_loss: 124106.2777
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9809; val_auprc_score: 0.9841; val_best_acc_score: 0.9339; val_best_f1_score: 0.9327; train_kl_reg_loss: 2138.3083; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121516.8725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123655.1808; train_optim_loss: 123655.1808; val_kl_reg_loss: 2111.2726; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 121869.8919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123981.1649; val_optim_loss: 123981.1649
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9810; val_auprc_score: 0.9841; val_best_acc_score: 0.9345; val_best_f1_score: 0.9333; train_kl_reg_loss: 2139.4451; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121481.9791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123621.4243; train_optim_loss: 123621.4243; val_kl_reg_loss: 2112.8326; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 121908.4630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124021.2954; val_optim_loss: 124021.2954

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 265 min 12 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
Val AUROC score: 0.9811
Val AUPRC score: 0.9842
Val best accuracy score: 0.9345
Val best F1 score: 0.9336
Val gene expr MSE score: 8.2522

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
