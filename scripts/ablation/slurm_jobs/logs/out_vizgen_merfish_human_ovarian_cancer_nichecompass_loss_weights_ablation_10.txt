None
Run timestamp: 06072023_201921_10.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_10']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9522; val_auprc_score: 0.9595; val_best_acc_score: 0.8793; val_best_f1_score: 0.8777; train_kl_reg_loss: 3985.3164; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 138656.7534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142642.0697; train_optim_loss: 142642.0697; val_kl_reg_loss: 2743.8797; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 130359.0044; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133102.8842; val_optim_loss: 133102.8842
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9615; val_auprc_score: 0.9678; val_best_acc_score: 0.8955; val_best_f1_score: 0.8936; train_kl_reg_loss: 2506.4476; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 128581.4971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131087.9446; train_optim_loss: 131087.9446; val_kl_reg_loss: 2360.4862; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126795.6613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129156.1479; val_optim_loss: 129156.1479
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9652; val_auprc_score: 0.9711; val_best_acc_score: 0.9018; val_best_f1_score: 0.8998; train_kl_reg_loss: 2280.7689; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126551.1879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128831.9567; train_optim_loss: 128831.9567; val_kl_reg_loss: 2239.8363; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125983.9942; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128223.8305; val_optim_loss: 128223.8305
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9681; val_auprc_score: 0.9734; val_best_acc_score: 0.9064; val_best_f1_score: 0.9056; train_kl_reg_loss: 2209.5436; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125621.2760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127830.8197; train_optim_loss: 127830.8197; val_kl_reg_loss: 2153.5324; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125214.7701; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127368.3023; val_optim_loss: 127368.3023
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9702; val_auprc_score: 0.9753; val_best_acc_score: 0.9125; val_best_f1_score: 0.9087; train_kl_reg_loss: 2187.6206; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125122.3421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127309.9627; train_optim_loss: 127309.9627; val_kl_reg_loss: 2191.2089; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124744.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126935.2870; val_optim_loss: 126935.2870
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9720; val_auprc_score: 0.9767; val_best_acc_score: 0.9168; val_best_f1_score: 0.9154; train_kl_reg_loss: 2180.3719; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124730.9908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126911.3628; train_optim_loss: 126911.3628; val_kl_reg_loss: 2160.3815; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124685.5873; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126845.9689; val_optim_loss: 126845.9689
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9733; val_auprc_score: 0.9778; val_best_acc_score: 0.9186; val_best_f1_score: 0.9174; train_kl_reg_loss: 2181.1629; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124471.3516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126652.5145; train_optim_loss: 126652.5145; val_kl_reg_loss: 2145.8444; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124263.1610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126409.0053; val_optim_loss: 126409.0053
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9742; val_auprc_score: 0.9785; val_best_acc_score: 0.9213; val_best_f1_score: 0.9188; train_kl_reg_loss: 2182.0784; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124200.8008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126382.8792; train_optim_loss: 126382.8792; val_kl_reg_loss: 2149.3709; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124203.0961; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126352.4671; val_optim_loss: 126352.4671
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9757; val_auprc_score: 0.9797; val_best_acc_score: 0.9237; val_best_f1_score: 0.9223; train_kl_reg_loss: 2182.3288; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124046.1419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126228.4707; train_optim_loss: 126228.4707; val_kl_reg_loss: 2124.0346; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124031.5435; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126155.5783; val_optim_loss: 126155.5783
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9754; val_auprc_score: 0.9794; val_best_acc_score: 0.9238; val_best_f1_score: 0.9216; train_kl_reg_loss: 2180.3511; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123903.0323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126083.3834; train_optim_loss: 126083.3834; val_kl_reg_loss: 2161.6150; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123835.0813; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125996.6963; val_optim_loss: 125996.6963
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9765; val_auprc_score: 0.9804; val_best_acc_score: 0.9246; val_best_f1_score: 0.9235; train_kl_reg_loss: 2180.4136; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123755.4706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125935.8842; train_optim_loss: 125935.8842; val_kl_reg_loss: 2124.2786; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123868.6651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125992.9436; val_optim_loss: 125992.9436
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9774; val_auprc_score: 0.9812; val_best_acc_score: 0.9278; val_best_f1_score: 0.9260; train_kl_reg_loss: 2186.8952; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123679.0059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125865.9010; train_optim_loss: 125865.9010; val_kl_reg_loss: 2135.8405; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123821.1187; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125956.9590; val_optim_loss: 125956.9590
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9785; val_auprc_score: 0.9822; val_best_acc_score: 0.9280; val_best_f1_score: 0.9274; train_kl_reg_loss: 2179.3980; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123564.5054; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125743.9034; train_optim_loss: 125743.9034; val_kl_reg_loss: 2104.8063; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124013.8671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126118.6736; val_optim_loss: 126118.6736
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9791; val_auprc_score: 0.9824; val_best_acc_score: 0.9296; val_best_f1_score: 0.9290; train_kl_reg_loss: 2178.5618; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123500.3290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125678.8908; train_optim_loss: 125678.8908; val_kl_reg_loss: 2128.5596; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123797.0142; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125925.5741; val_optim_loss: 125925.5741
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9791; val_auprc_score: 0.9825; val_best_acc_score: 0.9309; val_best_f1_score: 0.9289; train_kl_reg_loss: 2177.9049; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123407.5684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125585.4734; train_optim_loss: 125585.4734; val_kl_reg_loss: 2143.6173; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123834.4254; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125978.0424; val_optim_loss: 125978.0424
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9787; val_auprc_score: 0.9823; val_best_acc_score: 0.9285; val_best_f1_score: 0.9277; train_kl_reg_loss: 2176.8611; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123345.4209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125522.2820; train_optim_loss: 125522.2820; val_kl_reg_loss: 2137.9568; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123674.7209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125812.6778; val_optim_loss: 125812.6778
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9788; val_auprc_score: 0.9823; val_best_acc_score: 0.9291; val_best_f1_score: 0.9280; train_kl_reg_loss: 2176.3937; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123304.3983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125480.7919; train_optim_loss: 125480.7919; val_kl_reg_loss: 2186.2994; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123652.3713; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125838.6707; val_optim_loss: 125838.6707
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9805; val_auprc_score: 0.9838; val_best_acc_score: 0.9342; val_best_f1_score: 0.9328; train_kl_reg_loss: 2177.1175; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123249.4032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125426.5207; train_optim_loss: 125426.5207; val_kl_reg_loss: 2152.4615; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123677.7234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125830.1852; val_optim_loss: 125830.1852
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9790; val_auprc_score: 0.9826; val_best_acc_score: 0.9309; val_best_f1_score: 0.9298; train_kl_reg_loss: 2175.8557; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123169.6396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125345.4954; train_optim_loss: 125345.4954; val_kl_reg_loss: 2135.5007; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123471.8298; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125607.3303; val_optim_loss: 125607.3303
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9792; val_auprc_score: 0.9828; val_best_acc_score: 0.9308; val_best_f1_score: 0.9288; train_kl_reg_loss: 2175.5116; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123172.7875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125348.2990; train_optim_loss: 125348.2990; val_kl_reg_loss: 2144.8337; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123560.1856; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125705.0198; val_optim_loss: 125705.0198
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9803; val_auprc_score: 0.9837; val_best_acc_score: 0.9325; val_best_f1_score: 0.9308; train_kl_reg_loss: 2177.4954; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123127.0183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125304.5137; train_optim_loss: 125304.5137; val_kl_reg_loss: 2164.1272; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123483.7845; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125647.9118; val_optim_loss: 125647.9118
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9799; val_auprc_score: 0.9834; val_best_acc_score: 0.9322; val_best_f1_score: 0.9301; train_kl_reg_loss: 2174.0232; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123054.9114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125228.9348; train_optim_loss: 125228.9348; val_kl_reg_loss: 2140.7317; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123685.6136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125826.3452; val_optim_loss: 125826.3452
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9801; val_auprc_score: 0.9834; val_best_acc_score: 0.9327; val_best_f1_score: 0.9320; train_kl_reg_loss: 2172.8219; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123037.9340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125210.7559; train_optim_loss: 125210.7559; val_kl_reg_loss: 2151.6230; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123573.8777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125725.5005; val_optim_loss: 125725.5005

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9822; val_auprc_score: 0.9853; val_best_acc_score: 0.9381; val_best_f1_score: 0.9372; train_kl_reg_loss: 2112.1856; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 122058.2057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124170.3913; train_optim_loss: 124170.3913; val_kl_reg_loss: 2096.0165; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122862.2417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124958.2584; val_optim_loss: 124958.2584
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9821; val_auprc_score: 0.9852; val_best_acc_score: 0.9382; val_best_f1_score: 0.9369; train_kl_reg_loss: 2100.2818; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121909.7495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124010.0313; train_optim_loss: 124010.0313; val_kl_reg_loss: 2093.4000; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122727.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124820.8141; val_optim_loss: 124820.8141
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9823; val_auprc_score: 0.9851; val_best_acc_score: 0.9380; val_best_f1_score: 0.9363; train_kl_reg_loss: 2099.6808; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121861.0133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123960.6941; train_optim_loss: 123960.6941; val_kl_reg_loss: 2084.7675; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122598.7137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124683.4814; val_optim_loss: 124683.4814
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9828; val_auprc_score: 0.9858; val_best_acc_score: 0.9385; val_best_f1_score: 0.9373; train_kl_reg_loss: 2100.2099; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121813.6658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123913.8757; train_optim_loss: 123913.8757; val_kl_reg_loss: 2069.8644; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122586.5054; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124656.3699; val_optim_loss: 124656.3699
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9831; val_auprc_score: 0.9859; val_best_acc_score: 0.9389; val_best_f1_score: 0.9383; train_kl_reg_loss: 2097.9527; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121787.9660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123885.9187; train_optim_loss: 123885.9187; val_kl_reg_loss: 2073.5066; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122639.5320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124713.0387; val_optim_loss: 124713.0387
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9828; val_auprc_score: 0.9858; val_best_acc_score: 0.9380; val_best_f1_score: 0.9377; train_kl_reg_loss: 2099.2182; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121793.5928; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123892.8111; train_optim_loss: 123892.8111; val_kl_reg_loss: 2066.1655; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122674.0360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124740.2014; val_optim_loss: 124740.2014
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9830; val_auprc_score: 0.9859; val_best_acc_score: 0.9394; val_best_f1_score: 0.9388; train_kl_reg_loss: 2098.1665; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121784.4330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123882.5995; train_optim_loss: 123882.5995; val_kl_reg_loss: 2075.0472; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122595.8859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124670.9329; val_optim_loss: 124670.9329
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9829; val_auprc_score: 0.9859; val_best_acc_score: 0.9398; val_best_f1_score: 0.9390; train_kl_reg_loss: 2097.8747; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121734.6636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123832.5384; train_optim_loss: 123832.5384; val_kl_reg_loss: 2062.6769; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122588.3231; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124650.9999; val_optim_loss: 124650.9999
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9829; val_auprc_score: 0.9859; val_best_acc_score: 0.9395; val_best_f1_score: 0.9388; train_kl_reg_loss: 2096.7684; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121754.5668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123851.3352; train_optim_loss: 123851.3352; val_kl_reg_loss: 2063.2895; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122583.8951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124647.1849; val_optim_loss: 124647.1849
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9832; val_auprc_score: 0.9859; val_best_acc_score: 0.9402; val_best_f1_score: 0.9394; train_kl_reg_loss: 2096.5942; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121721.2401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123817.8344; train_optim_loss: 123817.8344; val_kl_reg_loss: 2065.8962; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122585.9208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124651.8169; val_optim_loss: 124651.8169
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9831; val_auprc_score: 0.9860; val_best_acc_score: 0.9402; val_best_f1_score: 0.9393; train_kl_reg_loss: 2095.5362; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121705.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123800.8242; train_optim_loss: 123800.8242; val_kl_reg_loss: 2068.3706; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122795.0537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124863.4241; val_optim_loss: 124863.4241
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9826; val_auprc_score: 0.9854; val_best_acc_score: 0.9390; val_best_f1_score: 0.9384; train_kl_reg_loss: 2095.1289; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121703.3279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123798.4568; train_optim_loss: 123798.4568; val_kl_reg_loss: 2073.7084; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122627.5090; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124701.2174; val_optim_loss: 124701.2174
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9832; val_auprc_score: 0.9860; val_best_acc_score: 0.9403; val_best_f1_score: 0.9394; train_kl_reg_loss: 2095.2121; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121661.6034; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123756.8155; train_optim_loss: 123756.8155; val_kl_reg_loss: 2075.3487; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122550.8001; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124626.1491; val_optim_loss: 124626.1491
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9830; val_auprc_score: 0.9858; val_best_acc_score: 0.9396; val_best_f1_score: 0.9389; train_kl_reg_loss: 2094.9471; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121685.0395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123779.9866; train_optim_loss: 123779.9866; val_kl_reg_loss: 2074.6682; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122586.1110; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124660.7793; val_optim_loss: 124660.7793
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9832; val_auprc_score: 0.9859; val_best_acc_score: 0.9405; val_best_f1_score: 0.9395; train_kl_reg_loss: 2095.2571; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121651.6625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123746.9196; train_optim_loss: 123746.9196; val_kl_reg_loss: 2062.5073; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122491.9427; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124554.4501; val_optim_loss: 124554.4501
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9829; val_auprc_score: 0.9858; val_best_acc_score: 0.9399; val_best_f1_score: 0.9391; train_kl_reg_loss: 2094.8777; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121619.9597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123714.8374; train_optim_loss: 123714.8374; val_kl_reg_loss: 2081.7044; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122566.2983; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124648.0026; val_optim_loss: 124648.0026
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9828; val_auprc_score: 0.9857; val_best_acc_score: 0.9394; val_best_f1_score: 0.9384; train_kl_reg_loss: 2093.5827; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121608.5091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123702.0917; train_optim_loss: 123702.0917; val_kl_reg_loss: 2074.5273; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122486.8728; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124561.4002; val_optim_loss: 124561.4002
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9830; val_auprc_score: 0.9858; val_best_acc_score: 0.9399; val_best_f1_score: 0.9388; train_kl_reg_loss: 2093.0544; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121616.5900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123709.6444; train_optim_loss: 123709.6444; val_kl_reg_loss: 2067.2868; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122524.8811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124592.1679; val_optim_loss: 124592.1679
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9830; val_auprc_score: 0.9858; val_best_acc_score: 0.9399; val_best_f1_score: 0.9389; train_kl_reg_loss: 2093.1164; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121621.8950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123715.0114; train_optim_loss: 123715.0114; val_kl_reg_loss: 2070.7708; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122500.3580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124571.1289; val_optim_loss: 124571.1289

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9832; val_auprc_score: 0.9861; val_best_acc_score: 0.9402; val_best_f1_score: 0.9389; train_kl_reg_loss: 2088.1811; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121539.3443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123627.5253; train_optim_loss: 123627.5253; val_kl_reg_loss: 2064.3408; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122363.4131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124427.7536; val_optim_loss: 124427.7536
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9831; val_auprc_score: 0.9860; val_best_acc_score: 0.9396; val_best_f1_score: 0.9385; train_kl_reg_loss: 2087.9318; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121465.6425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123553.5741; train_optim_loss: 123553.5741; val_kl_reg_loss: 2069.5775; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122405.9834; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124475.5609; val_optim_loss: 124475.5609
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9832; val_auprc_score: 0.9861; val_best_acc_score: 0.9406; val_best_f1_score: 0.9393; train_kl_reg_loss: 2087.1862; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121439.1023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123526.2884; train_optim_loss: 123526.2884; val_kl_reg_loss: 2064.3105; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122429.0197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124493.3302; val_optim_loss: 124493.3302
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9834; val_auprc_score: 0.9862; val_best_acc_score: 0.9408; val_best_f1_score: 0.9394; train_kl_reg_loss: 2087.5562; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121459.9434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123547.4996; train_optim_loss: 123547.4996; val_kl_reg_loss: 2060.5138; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122430.7145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124491.2285; val_optim_loss: 124491.2285
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9834; val_auprc_score: 0.9862; val_best_acc_score: 0.9405; val_best_f1_score: 0.9392; train_kl_reg_loss: 2087.8206; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121405.1833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123493.0038; train_optim_loss: 123493.0038; val_kl_reg_loss: 2064.8201; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122422.7087; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124487.5290; val_optim_loss: 124487.5290

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9832; val_auprc_score: 0.9861; val_best_acc_score: 0.9402; val_best_f1_score: 0.9388; train_kl_reg_loss: 2088.1855; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121435.2638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123523.4492; train_optim_loss: 123523.4492; val_kl_reg_loss: 2064.8744; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122251.2847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124316.1593; val_optim_loss: 124316.1593
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9831; val_auprc_score: 0.9859; val_best_acc_score: 0.9398; val_best_f1_score: 0.9385; train_kl_reg_loss: 2088.0085; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121428.1791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123516.1876; train_optim_loss: 123516.1876; val_kl_reg_loss: 2064.7700; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122462.8905; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124527.6606; val_optim_loss: 124527.6606
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9833; val_auprc_score: 0.9860; val_best_acc_score: 0.9406; val_best_f1_score: 0.9392; train_kl_reg_loss: 2087.6485; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121421.5425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123509.1910; train_optim_loss: 123509.1910; val_kl_reg_loss: 2065.8152; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122424.1403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124489.9553; val_optim_loss: 124489.9553
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9830; val_auprc_score: 0.9859; val_best_acc_score: 0.9398; val_best_f1_score: 0.9385; train_kl_reg_loss: 2088.3496; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121444.2032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123532.5528; train_optim_loss: 123532.5528; val_kl_reg_loss: 2065.5371; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122484.6014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124550.1385; val_optim_loss: 124550.1385
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9834; val_auprc_score: 0.9861; val_best_acc_score: 0.9410; val_best_f1_score: 0.9396; train_kl_reg_loss: 2087.3056; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121426.2683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123513.5739; train_optim_loss: 123513.5739; val_kl_reg_loss: 2064.2484; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122417.7241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124481.9725; val_optim_loss: 124481.9725

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9832; val_auprc_score: 0.9860; val_best_acc_score: 0.9403; val_best_f1_score: 0.9389; train_kl_reg_loss: 2087.1854; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121431.0120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123518.1974; train_optim_loss: 123518.1974; val_kl_reg_loss: 2064.0109; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122278.1645; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124342.1753; val_optim_loss: 124342.1753
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9833; val_auprc_score: 0.9862; val_best_acc_score: 0.9404; val_best_f1_score: 0.9391; train_kl_reg_loss: 2087.3871; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121431.0233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123518.4104; train_optim_loss: 123518.4104; val_kl_reg_loss: 2064.7001; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122459.5102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124524.2103; val_optim_loss: 124524.2103
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9833; val_auprc_score: 0.9862; val_best_acc_score: 0.9408; val_best_f1_score: 0.9394; train_kl_reg_loss: 2087.6586; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121458.5147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123546.1733; train_optim_loss: 123546.1733; val_kl_reg_loss: 2064.6267; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122370.0940; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124434.7207; val_optim_loss: 124434.7207
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9834; val_auprc_score: 0.9862; val_best_acc_score: 0.9407; val_best_f1_score: 0.9393; train_kl_reg_loss: 2087.3630; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121422.8999; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123510.2628; train_optim_loss: 123510.2628; val_kl_reg_loss: 2064.8869; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122492.2726; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124557.1593; val_optim_loss: 124557.1593

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 476 min 39 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
Val AUROC score: 0.9832
Val AUPRC score: 0.9860
Val best accuracy score: 0.9401
Val best F1 score: 0.9388
Val gene expr MSE score: 8.4380

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
