None
Run timestamp: 04072023_222018_10.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_10']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9551; val_auprc_score: 0.9617; val_best_acc_score: 0.8848; val_best_f1_score: 0.8828; train_kl_reg_loss: 3988.8210; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 139780.7719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143769.5930; train_optim_loss: 143769.5930; val_kl_reg_loss: 2663.3630; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 130620.0336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133283.3968; val_optim_loss: 133283.3968
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9631; val_auprc_score: 0.9689; val_best_acc_score: 0.8983; val_best_f1_score: 0.8958; train_kl_reg_loss: 2512.1299; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 128925.0829; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131437.2127; train_optim_loss: 131437.2127; val_kl_reg_loss: 2295.5111; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 127081.9130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129377.4241; val_optim_loss: 129377.4241
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9648; val_auprc_score: 0.9707; val_best_acc_score: 0.9024; val_best_f1_score: 0.9005; train_kl_reg_loss: 2280.2835; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126614.7658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128895.0492; train_optim_loss: 128895.0492; val_kl_reg_loss: 2083.9374; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125834.5741; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127918.5120; val_optim_loss: 127918.5120
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9685; val_auprc_score: 0.9737; val_best_acc_score: 0.9077; val_best_f1_score: 0.9069; train_kl_reg_loss: 2207.4544; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125683.4108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127890.8652; train_optim_loss: 127890.8652; val_kl_reg_loss: 2132.2384; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125151.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127284.0824; val_optim_loss: 127284.0824
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9695; val_auprc_score: 0.9747; val_best_acc_score: 0.9112; val_best_f1_score: 0.9070; train_kl_reg_loss: 2181.2806; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125132.2138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127313.4943; train_optim_loss: 127313.4943; val_kl_reg_loss: 2096.0760; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124748.9299; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126845.0058; val_optim_loss: 126845.0058
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9710; val_auprc_score: 0.9759; val_best_acc_score: 0.9145; val_best_f1_score: 0.9123; train_kl_reg_loss: 2173.0554; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124747.9809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126921.0363; train_optim_loss: 126921.0363; val_kl_reg_loss: 2101.1974; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124325.3443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126426.5416; val_optim_loss: 126426.5416
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9730; val_auprc_score: 0.9774; val_best_acc_score: 0.9173; val_best_f1_score: 0.9163; train_kl_reg_loss: 2169.3982; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124445.5422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126614.9404; train_optim_loss: 126614.9404; val_kl_reg_loss: 2134.3761; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124222.8308; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126357.2072; val_optim_loss: 126357.2072
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9728; val_auprc_score: 0.9772; val_best_acc_score: 0.9180; val_best_f1_score: 0.9153; train_kl_reg_loss: 2169.5667; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124211.1361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126380.7028; train_optim_loss: 126380.7028; val_kl_reg_loss: 2153.3157; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124135.3223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126288.6382; val_optim_loss: 126288.6382
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9760; val_auprc_score: 0.9799; val_best_acc_score: 0.9241; val_best_f1_score: 0.9223; train_kl_reg_loss: 2171.0326; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124016.8427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126187.8753; train_optim_loss: 126187.8753; val_kl_reg_loss: 2047.9103; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124217.2168; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126265.1269; val_optim_loss: 126265.1269
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9751; val_auprc_score: 0.9793; val_best_acc_score: 0.9232; val_best_f1_score: 0.9210; train_kl_reg_loss: 2173.3195; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123842.3372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126015.6566; train_optim_loss: 126015.6566; val_kl_reg_loss: 2122.4275; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123941.8228; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126064.2504; val_optim_loss: 126064.2504
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9758; val_auprc_score: 0.9799; val_best_acc_score: 0.9239; val_best_f1_score: 0.9229; train_kl_reg_loss: 2175.2686; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123768.4339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125943.7026; train_optim_loss: 125943.7026; val_kl_reg_loss: 2099.6238; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123936.4553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126036.0790; val_optim_loss: 126036.0790
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9764; val_auprc_score: 0.9803; val_best_acc_score: 0.9251; val_best_f1_score: 0.9232; train_kl_reg_loss: 2177.0565; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123628.5540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125805.6106; train_optim_loss: 125805.6106; val_kl_reg_loss: 2143.9948; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123678.1227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125822.1174; val_optim_loss: 125822.1174
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9773; val_auprc_score: 0.9812; val_best_acc_score: 0.9270; val_best_f1_score: 0.9245; train_kl_reg_loss: 2177.6615; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123541.8406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125719.5022; train_optim_loss: 125719.5022; val_kl_reg_loss: 2156.3949; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123866.0080; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126022.4031; val_optim_loss: 126022.4031
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9776; val_auprc_score: 0.9814; val_best_acc_score: 0.9261; val_best_f1_score: 0.9257; train_kl_reg_loss: 2187.0146; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123504.1078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125691.1225; train_optim_loss: 125691.1225; val_kl_reg_loss: 2162.9338; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123755.5451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125918.4788; val_optim_loss: 125918.4788
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9779; val_auprc_score: 0.9815; val_best_acc_score: 0.9288; val_best_f1_score: 0.9272; train_kl_reg_loss: 2179.5998; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123373.1147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125552.7144; train_optim_loss: 125552.7144; val_kl_reg_loss: 2152.7675; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123572.5155; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125725.2830; val_optim_loss: 125725.2830
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9787; val_auprc_score: 0.9821; val_best_acc_score: 0.9285; val_best_f1_score: 0.9275; train_kl_reg_loss: 2180.8590; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123331.7965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125512.6555; train_optim_loss: 125512.6555; val_kl_reg_loss: 2101.1265; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123665.0474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125766.1737; val_optim_loss: 125766.1737
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9788; val_auprc_score: 0.9823; val_best_acc_score: 0.9290; val_best_f1_score: 0.9286; train_kl_reg_loss: 2180.2974; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123286.5026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125466.8000; train_optim_loss: 125466.8000; val_kl_reg_loss: 2157.8382; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123472.5832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125630.4215; val_optim_loss: 125630.4215
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9773; val_auprc_score: 0.9811; val_best_acc_score: 0.9259; val_best_f1_score: 0.9253; train_kl_reg_loss: 2181.7917; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123191.3711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125373.1628; train_optim_loss: 125373.1628; val_kl_reg_loss: 2190.8964; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123630.9598; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125821.8562; val_optim_loss: 125821.8562
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9782; val_auprc_score: 0.9819; val_best_acc_score: 0.9289; val_best_f1_score: 0.9277; train_kl_reg_loss: 2180.3780; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123163.8730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125344.2508; train_optim_loss: 125344.2508; val_kl_reg_loss: 2180.4768; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123561.8569; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125742.3338; val_optim_loss: 125742.3338
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9803; val_auprc_score: 0.9835; val_best_acc_score: 0.9325; val_best_f1_score: 0.9304; train_kl_reg_loss: 2182.8422; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123141.0633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125323.9055; train_optim_loss: 125323.9055; val_kl_reg_loss: 2116.5869; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123404.4462; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125521.0332; val_optim_loss: 125521.0332
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9799; val_auprc_score: 0.9833; val_best_acc_score: 0.9320; val_best_f1_score: 0.9299; train_kl_reg_loss: 2181.5108; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123061.8734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125243.3842; train_optim_loss: 125243.3842; val_kl_reg_loss: 2154.0164; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123262.3221; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125416.3386; val_optim_loss: 125416.3386
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9800; val_auprc_score: 0.9833; val_best_acc_score: 0.9318; val_best_f1_score: 0.9312; train_kl_reg_loss: 2180.3071; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123072.2077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125252.5148; train_optim_loss: 125252.5148; val_kl_reg_loss: 2170.6093; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123424.1303; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125594.7397; val_optim_loss: 125594.7397
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9795; val_auprc_score: 0.9829; val_best_acc_score: 0.9313; val_best_f1_score: 0.9304; train_kl_reg_loss: 2179.1346; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123015.2362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125194.3708; train_optim_loss: 125194.3708; val_kl_reg_loss: 2159.9149; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123325.0228; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125484.9377; val_optim_loss: 125484.9377
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9797; val_auprc_score: 0.9831; val_best_acc_score: 0.9320; val_best_f1_score: 0.9306; train_kl_reg_loss: 2178.6641; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 122952.7680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125131.4321; train_optim_loss: 125131.4321; val_kl_reg_loss: 2129.6382; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123576.6992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125706.3371; val_optim_loss: 125706.3371
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9795; val_auprc_score: 0.9830; val_best_acc_score: 0.9316; val_best_f1_score: 0.9303; train_kl_reg_loss: 2178.6291; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 122912.8350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125091.4641; train_optim_loss: 125091.4641; val_kl_reg_loss: 2157.2336; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123430.7346; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125587.9681; val_optim_loss: 125587.9681

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9823; val_auprc_score: 0.9852; val_best_acc_score: 0.9382; val_best_f1_score: 0.9367; train_kl_reg_loss: 2119.4969; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121941.8763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124061.3732; train_optim_loss: 124061.3732; val_kl_reg_loss: 2080.8561; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122565.5943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124646.4503; val_optim_loss: 124646.4503
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9821; val_auprc_score: 0.9850; val_best_acc_score: 0.9375; val_best_f1_score: 0.9356; train_kl_reg_loss: 2108.5400; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121808.0918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123916.6317; train_optim_loss: 123916.6317; val_kl_reg_loss: 2081.1190; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122563.3824; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124644.5014; val_optim_loss: 124644.5014
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9829; val_auprc_score: 0.9859; val_best_acc_score: 0.9383; val_best_f1_score: 0.9378; train_kl_reg_loss: 2107.3728; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121764.8635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123872.2363; train_optim_loss: 123872.2363; val_kl_reg_loss: 2074.5810; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122506.6922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124581.2732; val_optim_loss: 124581.2732
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9825; val_auprc_score: 0.9854; val_best_acc_score: 0.9371; val_best_f1_score: 0.9367; train_kl_reg_loss: 2106.8616; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121703.9985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123810.8600; train_optim_loss: 123810.8600; val_kl_reg_loss: 2083.4434; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122608.6829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124692.1263; val_optim_loss: 124692.1263
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9827; val_auprc_score: 0.9855; val_best_acc_score: 0.9381; val_best_f1_score: 0.9374; train_kl_reg_loss: 2106.8388; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121743.7852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123850.6240; train_optim_loss: 123850.6240; val_kl_reg_loss: 2087.2006; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122499.9550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124587.1554; val_optim_loss: 124587.1554
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9830; val_auprc_score: 0.9857; val_best_acc_score: 0.9386; val_best_f1_score: 0.9379; train_kl_reg_loss: 2105.4450; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121642.4577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123747.9027; train_optim_loss: 123747.9027; val_kl_reg_loss: 2091.1705; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122430.0606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124521.2313; val_optim_loss: 124521.2313
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9828; val_auprc_score: 0.9857; val_best_acc_score: 0.9383; val_best_f1_score: 0.9373; train_kl_reg_loss: 2105.3460; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121658.2384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123763.5844; train_optim_loss: 123763.5844; val_kl_reg_loss: 2083.5670; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122359.4975; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124443.0643; val_optim_loss: 124443.0643
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9829; val_auprc_score: 0.9858; val_best_acc_score: 0.9393; val_best_f1_score: 0.9382; train_kl_reg_loss: 2104.6997; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121671.8770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123776.5766; train_optim_loss: 123776.5766; val_kl_reg_loss: 2076.5574; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122416.0527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124492.6100; val_optim_loss: 124492.6100
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9829; val_auprc_score: 0.9858; val_best_acc_score: 0.9384; val_best_f1_score: 0.9374; train_kl_reg_loss: 2103.3657; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121637.0254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123740.3911; train_optim_loss: 123740.3911; val_kl_reg_loss: 2082.2479; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122397.7346; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124479.9824; val_optim_loss: 124479.9824
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9824; val_auprc_score: 0.9854; val_best_acc_score: 0.9372; val_best_f1_score: 0.9363; train_kl_reg_loss: 2103.1190; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121602.1099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123705.2289; train_optim_loss: 123705.2289; val_kl_reg_loss: 2084.1694; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122377.7260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124461.8955; val_optim_loss: 124461.8955
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9831; val_auprc_score: 0.9858; val_best_acc_score: 0.9391; val_best_f1_score: 0.9379; train_kl_reg_loss: 2102.6797; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121635.8554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123738.5351; train_optim_loss: 123738.5351; val_kl_reg_loss: 2073.3005; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122373.4671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124446.7676; val_optim_loss: 124446.7676

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9830; val_auprc_score: 0.9858; val_best_acc_score: 0.9390; val_best_f1_score: 0.9377; train_kl_reg_loss: 2098.5836; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121538.7195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123637.3032; train_optim_loss: 123637.3032; val_kl_reg_loss: 2075.1935; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122303.5356; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124378.7288; val_optim_loss: 124378.7288
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9831; val_auprc_score: 0.9859; val_best_acc_score: 0.9394; val_best_f1_score: 0.9380; train_kl_reg_loss: 2098.5150; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121456.8154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123555.3304; train_optim_loss: 123555.3304; val_kl_reg_loss: 2073.9799; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122235.4151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124309.3951; val_optim_loss: 124309.3951
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9831; val_auprc_score: 0.9859; val_best_acc_score: 0.9394; val_best_f1_score: 0.9381; train_kl_reg_loss: 2099.0523; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121478.2465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123577.2988; train_optim_loss: 123577.2988; val_kl_reg_loss: 2077.2543; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122209.2773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124286.5318; val_optim_loss: 124286.5318
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9829; val_auprc_score: 0.9858; val_best_acc_score: 0.9393; val_best_f1_score: 0.9379; train_kl_reg_loss: 2099.1124; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121450.8780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123549.9904; train_optim_loss: 123549.9904; val_kl_reg_loss: 2073.8601; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122319.7419; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124393.6021; val_optim_loss: 124393.6021
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9830; val_auprc_score: 0.9858; val_best_acc_score: 0.9394; val_best_f1_score: 0.9379; train_kl_reg_loss: 2098.0515; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121458.5016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123556.5531; train_optim_loss: 123556.5531; val_kl_reg_loss: 2075.8557; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122362.4178; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124438.2737; val_optim_loss: 124438.2737
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9830; val_auprc_score: 0.9858; val_best_acc_score: 0.9395; val_best_f1_score: 0.9380; train_kl_reg_loss: 2098.9100; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121469.7759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123568.6859; train_optim_loss: 123568.6859; val_kl_reg_loss: 2073.4746; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122238.7822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124312.2568; val_optim_loss: 124312.2568
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9832; val_auprc_score: 0.9859; val_best_acc_score: 0.9398; val_best_f1_score: 0.9383; train_kl_reg_loss: 2098.0642; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121412.2203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123510.2845; train_optim_loss: 123510.2845; val_kl_reg_loss: 2071.9718; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122212.6568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124284.6287; val_optim_loss: 124284.6287
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9832; val_auprc_score: 0.9861; val_best_acc_score: 0.9396; val_best_f1_score: 0.9381; train_kl_reg_loss: 2098.1817; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121415.6905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123513.8721; train_optim_loss: 123513.8721; val_kl_reg_loss: 2077.8567; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122259.5587; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124337.4155; val_optim_loss: 124337.4155
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9831; val_auprc_score: 0.9858; val_best_acc_score: 0.9396; val_best_f1_score: 0.9381; train_kl_reg_loss: 2099.2823; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121472.1238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123571.4062; train_optim_loss: 123571.4062; val_kl_reg_loss: 2078.0323; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122205.3374; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124283.3694; val_optim_loss: 124283.3694
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9832; val_auprc_score: 0.9860; val_best_acc_score: 0.9397; val_best_f1_score: 0.9382; train_kl_reg_loss: 2098.5499; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121456.7750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123555.3248; train_optim_loss: 123555.3248; val_kl_reg_loss: 2077.6402; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122352.6493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124430.2895; val_optim_loss: 124430.2895
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9833; val_auprc_score: 0.9861; val_best_acc_score: 0.9399; val_best_f1_score: 0.9383; train_kl_reg_loss: 2098.2887; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121433.9234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123532.2121; train_optim_loss: 123532.2121; val_kl_reg_loss: 2073.2307; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122372.3445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124445.5752; val_optim_loss: 124445.5752
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9831; val_auprc_score: 0.9859; val_best_acc_score: 0.9396; val_best_f1_score: 0.9380; train_kl_reg_loss: 2098.7459; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121519.3632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123618.1091; train_optim_loss: 123618.1091; val_kl_reg_loss: 2074.3999; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122136.0869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124210.4866; val_optim_loss: 124210.4866
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9832; val_auprc_score: 0.9860; val_best_acc_score: 0.9392; val_best_f1_score: 0.9377; train_kl_reg_loss: 2098.3121; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121447.8508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123546.1629; train_optim_loss: 123546.1629; val_kl_reg_loss: 2073.4438; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122244.8990; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124318.3428; val_optim_loss: 124318.3428
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9831; val_auprc_score: 0.9858; val_best_acc_score: 0.9392; val_best_f1_score: 0.9377; train_kl_reg_loss: 2098.1399; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121467.4340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123565.5740; train_optim_loss: 123565.5740; val_kl_reg_loss: 2076.0950; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122214.4616; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124290.5560; val_optim_loss: 124290.5560
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9832; val_auprc_score: 0.9858; val_best_acc_score: 0.9392; val_best_f1_score: 0.9377; train_kl_reg_loss: 2098.7393; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121416.8311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123515.5704; train_optim_loss: 123515.5704; val_kl_reg_loss: 2074.1100; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122174.4437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124248.5536; val_optim_loss: 124248.5536
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9831; val_auprc_score: 0.9860; val_best_acc_score: 0.9395; val_best_f1_score: 0.9380; train_kl_reg_loss: 2098.3398; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121443.9216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123542.2614; train_optim_loss: 123542.2614; val_kl_reg_loss: 2074.5224; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122225.3119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124299.8343; val_optim_loss: 124299.8343

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9833; val_auprc_score: 0.9861; val_best_acc_score: 0.9396; val_best_f1_score: 0.9380; train_kl_reg_loss: 2097.0297; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121462.8759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123559.9057; train_optim_loss: 123559.9057; val_kl_reg_loss: 2073.4480; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122154.6997; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124228.1477; val_optim_loss: 124228.1477
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9832; val_auprc_score: 0.9860; val_best_acc_score: 0.9395; val_best_f1_score: 0.9379; train_kl_reg_loss: 2097.5033; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121409.8899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123507.3932; train_optim_loss: 123507.3932; val_kl_reg_loss: 2073.8124; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122145.8915; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124219.7042; val_optim_loss: 124219.7042
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9831; val_auprc_score: 0.9859; val_best_acc_score: 0.9390; val_best_f1_score: 0.9375; train_kl_reg_loss: 2097.7800; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121428.0055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123525.7856; train_optim_loss: 123525.7856; val_kl_reg_loss: 2073.7165; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122176.3367; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124250.0531; val_optim_loss: 124250.0531
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9832; val_auprc_score: 0.9859; val_best_acc_score: 0.9396; val_best_f1_score: 0.9379; train_kl_reg_loss: 2097.3730; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121408.1288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123505.5019; train_optim_loss: 123505.5019; val_kl_reg_loss: 2072.8703; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122233.6752; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124306.5458; val_optim_loss: 124306.5458

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 499 min 23 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
Val AUROC score: 0.9833
Val AUPRC score: 0.9861
Val best accuracy score: 0.9400
Val best F1 score: 0.9384
Val gene expr MSE score: 8.2780

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
