None
Run timestamp: 04072023_092738_10.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_10']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9863; val_auprc_score: 0.9879; val_best_acc_score: 0.9433; val_best_f1_score: 0.9426; train_kl_reg_loss: 2721.8852; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 216115.9042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 218837.7894; train_optim_loss: 218837.7894; val_kl_reg_loss: 2938.0238; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 205665.8148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208603.8384; val_optim_loss: 208603.8384
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9906; val_auprc_score: 0.9919; val_best_acc_score: 0.9560; val_best_f1_score: 0.9556; train_kl_reg_loss: 3061.5605; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 203139.8147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206201.3751; train_optim_loss: 206201.3751; val_kl_reg_loss: 3101.0850; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 199573.4866; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202674.5712; val_optim_loss: 202674.5712
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9929; val_auprc_score: 0.9939; val_best_acc_score: 0.9647; val_best_f1_score: 0.9643; train_kl_reg_loss: 3178.7812; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 199259.6512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202438.4324; train_optim_loss: 202438.4324; val_kl_reg_loss: 3126.3107; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 197128.6362; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200254.9471; val_optim_loss: 200254.9471
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9942; val_auprc_score: 0.9950; val_best_acc_score: 0.9687; val_best_f1_score: 0.9683; train_kl_reg_loss: 3208.0869; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 197546.3852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200754.4720; train_optim_loss: 200754.4720; val_kl_reg_loss: 3078.3131; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 196378.2180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 199456.5310; val_optim_loss: 199456.5310
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9941; val_auprc_score: 0.9950; val_best_acc_score: 0.9688; val_best_f1_score: 0.9685; train_kl_reg_loss: 3202.9579; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 196705.5651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199908.5231; train_optim_loss: 199908.5231; val_kl_reg_loss: 3242.7948; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 195556.0834; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198798.8782; val_optim_loss: 198798.8782
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9945; val_auprc_score: 0.9953; val_best_acc_score: 0.9709; val_best_f1_score: 0.9707; train_kl_reg_loss: 3189.4089; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 196077.8257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199267.2345; train_optim_loss: 199267.2345; val_kl_reg_loss: 3172.6611; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 195245.8960; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198418.5577; val_optim_loss: 198418.5577
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9945; val_auprc_score: 0.9954; val_best_acc_score: 0.9694; val_best_f1_score: 0.9692; train_kl_reg_loss: 3171.5763; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 195707.3772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198878.9535; train_optim_loss: 198878.9535; val_kl_reg_loss: 3078.5050; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 194876.2021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197954.7068; val_optim_loss: 197954.7068
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9944; val_auprc_score: 0.9952; val_best_acc_score: 0.9697; val_best_f1_score: 0.9696; train_kl_reg_loss: 3154.9692; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 195421.8908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198576.8600; train_optim_loss: 198576.8600; val_kl_reg_loss: 3202.1884; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 194808.0118; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198010.2006; val_optim_loss: 198010.2006
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9945; val_auprc_score: 0.9953; val_best_acc_score: 0.9702; val_best_f1_score: 0.9701; train_kl_reg_loss: 3135.1456; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 195277.0088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198412.1545; train_optim_loss: 198412.1545; val_kl_reg_loss: 2991.1859; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 194573.0392; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197564.2251; val_optim_loss: 197564.2251
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9946; val_auprc_score: 0.9954; val_best_acc_score: 0.9707; val_best_f1_score: 0.9704; train_kl_reg_loss: 3122.1388; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 195037.5880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198159.7267; train_optim_loss: 198159.7267; val_kl_reg_loss: 3074.9519; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 194361.1251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197436.0767; val_optim_loss: 197436.0767
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9945; val_auprc_score: 0.9954; val_best_acc_score: 0.9702; val_best_f1_score: 0.9698; train_kl_reg_loss: 3113.5941; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 194911.3581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198024.9523; train_optim_loss: 198024.9523; val_kl_reg_loss: 3034.8632; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 194315.5881; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197350.4514; val_optim_loss: 197350.4514
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9949; val_auprc_score: 0.9957; val_best_acc_score: 0.9716; val_best_f1_score: 0.9715; train_kl_reg_loss: 3109.0465; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 194864.7280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197973.7745; train_optim_loss: 197973.7745; val_kl_reg_loss: 3053.8066; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 194543.9008; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197597.7074; val_optim_loss: 197597.7074
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9946; val_auprc_score: 0.9955; val_best_acc_score: 0.9706; val_best_f1_score: 0.9702; train_kl_reg_loss: 3100.6391; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 194711.3872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197812.0262; train_optim_loss: 197812.0262; val_kl_reg_loss: 3083.8518; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 194258.5592; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197342.4112; val_optim_loss: 197342.4112
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9948; val_auprc_score: 0.9956; val_best_acc_score: 0.9713; val_best_f1_score: 0.9712; train_kl_reg_loss: 3091.1475; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 194657.2490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197748.3966; train_optim_loss: 197748.3966; val_kl_reg_loss: 2991.1780; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 194059.0096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197050.1877; val_optim_loss: 197050.1877
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9949; val_auprc_score: 0.9957; val_best_acc_score: 0.9719; val_best_f1_score: 0.9718; train_kl_reg_loss: 3083.6788; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 194669.0763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197752.7550; train_optim_loss: 197752.7550; val_kl_reg_loss: 3001.4271; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 194276.3198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197277.7471; val_optim_loss: 197277.7471
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9944; val_auprc_score: 0.9953; val_best_acc_score: 0.9700; val_best_f1_score: 0.9696; train_kl_reg_loss: 3083.0165; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 194606.1883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197689.2047; train_optim_loss: 197689.2047; val_kl_reg_loss: 3051.0980; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 194288.8959; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197339.9936; val_optim_loss: 197339.9936
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9949; val_auprc_score: 0.9958; val_best_acc_score: 0.9726; val_best_f1_score: 0.9724; train_kl_reg_loss: 3074.2230; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 194483.7269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197557.9498; train_optim_loss: 197557.9498; val_kl_reg_loss: 3039.2581; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 194311.5065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197350.7645; val_optim_loss: 197350.7645
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9949; val_auprc_score: 0.9957; val_best_acc_score: 0.9716; val_best_f1_score: 0.9715; train_kl_reg_loss: 3071.6296; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 194433.3865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197505.0161; train_optim_loss: 197505.0161; val_kl_reg_loss: 2987.5113; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 194253.0070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197240.5180; val_optim_loss: 197240.5180

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9959; val_auprc_score: 0.9965; val_best_acc_score: 0.9756; val_best_f1_score: 0.9754; train_kl_reg_loss: 2477.2121; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 192871.3225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195348.5345; train_optim_loss: 195348.5345; val_kl_reg_loss: 2051.1095; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192765.6653; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194816.7755; val_optim_loss: 194816.7755
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9959; val_auprc_score: 0.9965; val_best_acc_score: 0.9758; val_best_f1_score: 0.9756; train_kl_reg_loss: 1889.9638; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 192365.7790; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194255.7429; train_optim_loss: 194255.7429; val_kl_reg_loss: 1753.0022; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192874.2974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194627.2998; val_optim_loss: 194627.2998
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9960; val_auprc_score: 0.9965; val_best_acc_score: 0.9762; val_best_f1_score: 0.9760; train_kl_reg_loss: 1711.4066; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 192148.9604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193860.3668; train_optim_loss: 193860.3668; val_kl_reg_loss: 1652.9860; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192802.7057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194455.6916; val_optim_loss: 194455.6916
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9962; val_auprc_score: 0.9968; val_best_acc_score: 0.9768; val_best_f1_score: 0.9767; train_kl_reg_loss: 1644.3525; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191977.8566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193622.2090; train_optim_loss: 193622.2090; val_kl_reg_loss: 1601.8942; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192651.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194252.9412; val_optim_loss: 194252.9412
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9963; val_auprc_score: 0.9970; val_best_acc_score: 0.9774; val_best_f1_score: 0.9772; train_kl_reg_loss: 1613.2439; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191977.4985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193590.7425; train_optim_loss: 193590.7425; val_kl_reg_loss: 1595.8512; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192804.3974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194400.2483; val_optim_loss: 194400.2483
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9962; val_auprc_score: 0.9966; val_best_acc_score: 0.9775; val_best_f1_score: 0.9773; train_kl_reg_loss: 1597.9934; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191903.3379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193501.3314; train_optim_loss: 193501.3314; val_kl_reg_loss: 1567.4920; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192616.5129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194184.0044; val_optim_loss: 194184.0044
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9964; val_auprc_score: 0.9967; val_best_acc_score: 0.9779; val_best_f1_score: 0.9777; train_kl_reg_loss: 1588.0752; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191889.0165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193477.0917; train_optim_loss: 193477.0917; val_kl_reg_loss: 1568.2451; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192816.6060; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194384.8511; val_optim_loss: 194384.8511
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9964; val_auprc_score: 0.9968; val_best_acc_score: 0.9775; val_best_f1_score: 0.9775; train_kl_reg_loss: 1581.4757; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191824.3677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193405.8435; train_optim_loss: 193405.8435; val_kl_reg_loss: 1547.7333; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192618.9828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194166.7163; val_optim_loss: 194166.7163
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9965; val_auprc_score: 0.9970; val_best_acc_score: 0.9780; val_best_f1_score: 0.9779; train_kl_reg_loss: 1576.9328; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191857.8742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193434.8070; train_optim_loss: 193434.8070; val_kl_reg_loss: 1555.6346; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192566.1824; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194121.8165; val_optim_loss: 194121.8165
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9964; val_auprc_score: 0.9969; val_best_acc_score: 0.9780; val_best_f1_score: 0.9779; train_kl_reg_loss: 1571.6309; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191804.0773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193375.7082; train_optim_loss: 193375.7082; val_kl_reg_loss: 1554.1765; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192634.0646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194188.2414; val_optim_loss: 194188.2414
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9964; val_auprc_score: 0.9969; val_best_acc_score: 0.9778; val_best_f1_score: 0.9777; train_kl_reg_loss: 1569.7467; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191813.4736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193383.2202; train_optim_loss: 193383.2202; val_kl_reg_loss: 1552.7710; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192556.7644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194109.5351; val_optim_loss: 194109.5351
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9965; val_auprc_score: 0.9970; val_best_acc_score: 0.9784; val_best_f1_score: 0.9783; train_kl_reg_loss: 1566.3366; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191803.6947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193370.0314; train_optim_loss: 193370.0314; val_kl_reg_loss: 1539.9540; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192674.7096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194214.6636; val_optim_loss: 194214.6636
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9965; val_auprc_score: 0.9970; val_best_acc_score: 0.9784; val_best_f1_score: 0.9783; train_kl_reg_loss: 1563.0667; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191735.6438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193298.7107; train_optim_loss: 193298.7107; val_kl_reg_loss: 1545.0725; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192767.4714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194312.5436; val_optim_loss: 194312.5436
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9966; val_auprc_score: 0.9971; val_best_acc_score: 0.9789; val_best_f1_score: 0.9787; train_kl_reg_loss: 1559.7071; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191788.5356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193348.2428; train_optim_loss: 193348.2428; val_kl_reg_loss: 1530.8195; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192520.7327; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194051.5518; val_optim_loss: 194051.5518
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9967; val_auprc_score: 0.9972; val_best_acc_score: 0.9791; val_best_f1_score: 0.9789; train_kl_reg_loss: 1556.5811; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191735.8303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193292.4112; train_optim_loss: 193292.4112; val_kl_reg_loss: 1533.5105; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192607.5373; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194141.0484; val_optim_loss: 194141.0484
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9965; val_auprc_score: 0.9971; val_best_acc_score: 0.9789; val_best_f1_score: 0.9787; train_kl_reg_loss: 1556.2987; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191765.3625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193321.6612; train_optim_loss: 193321.6612; val_kl_reg_loss: 1542.7650; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192496.4590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194039.2232; val_optim_loss: 194039.2232
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9965; val_auprc_score: 0.9971; val_best_acc_score: 0.9786; val_best_f1_score: 0.9784; train_kl_reg_loss: 1551.8388; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191727.9369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193279.7757; train_optim_loss: 193279.7757; val_kl_reg_loss: 1536.3355; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192758.5172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194294.8527; val_optim_loss: 194294.8527
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9967; val_auprc_score: 0.9973; val_best_acc_score: 0.9793; val_best_f1_score: 0.9791; train_kl_reg_loss: 1549.5112; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191710.2695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193259.7808; train_optim_loss: 193259.7808; val_kl_reg_loss: 1526.9129; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192403.7803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193930.6926; val_optim_loss: 193930.6926
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9967; val_auprc_score: 0.9972; val_best_acc_score: 0.9794; val_best_f1_score: 0.9792; train_kl_reg_loss: 1546.7931; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191700.4581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193247.2513; train_optim_loss: 193247.2513; val_kl_reg_loss: 1534.2215; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192567.9561; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194102.1777; val_optim_loss: 194102.1777
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9967; val_auprc_score: 0.9972; val_best_acc_score: 0.9791; val_best_f1_score: 0.9789; train_kl_reg_loss: 1545.3602; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191685.3075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193230.6678; train_optim_loss: 193230.6678; val_kl_reg_loss: 1525.6733; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192534.1598; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194059.8330; val_optim_loss: 194059.8330
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9967; val_auprc_score: 0.9972; val_best_acc_score: 0.9791; val_best_f1_score: 0.9790; train_kl_reg_loss: 1543.4530; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191676.3086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193219.7617; train_optim_loss: 193219.7617; val_kl_reg_loss: 1525.8912; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192547.1249; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194073.0167; val_optim_loss: 194073.0167
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9966; val_auprc_score: 0.9972; val_best_acc_score: 0.9790; val_best_f1_score: 0.9788; train_kl_reg_loss: 1539.9760; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191603.7937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193143.7697; train_optim_loss: 193143.7697; val_kl_reg_loss: 1518.9915; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192594.3443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194113.3358; val_optim_loss: 194113.3358

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9967; val_auprc_score: 0.9971; val_best_acc_score: 0.9794; val_best_f1_score: 0.9793; train_kl_reg_loss: 1515.2825; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191444.0272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192959.3096; train_optim_loss: 192959.3096; val_kl_reg_loss: 1489.5541; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192411.3809; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193900.9350; val_optim_loss: 193900.9350
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9968; val_auprc_score: 0.9973; val_best_acc_score: 0.9795; val_best_f1_score: 0.9794; train_kl_reg_loss: 1502.5580; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191362.4967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192865.0548; train_optim_loss: 192865.0548; val_kl_reg_loss: 1484.2174; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192461.7059; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193945.9230; val_optim_loss: 193945.9230
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9967; val_auprc_score: 0.9971; val_best_acc_score: 0.9795; val_best_f1_score: 0.9794; train_kl_reg_loss: 1495.2834; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191336.9735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192832.2570; train_optim_loss: 192832.2570; val_kl_reg_loss: 1476.3998; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192327.9878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193804.3878; val_optim_loss: 193804.3878
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9967; val_auprc_score: 0.9973; val_best_acc_score: 0.9794; val_best_f1_score: 0.9793; train_kl_reg_loss: 1491.0652; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191321.2056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192812.2710; train_optim_loss: 192812.2710; val_kl_reg_loss: 1476.5780; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192375.6754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193852.2533; val_optim_loss: 193852.2533
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9968; val_auprc_score: 0.9974; val_best_acc_score: 0.9798; val_best_f1_score: 0.9796; train_kl_reg_loss: 1489.4867; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191340.1188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192829.6056; train_optim_loss: 192829.6056; val_kl_reg_loss: 1470.0663; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192519.8429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193989.9095; val_optim_loss: 193989.9095
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9968; val_auprc_score: 0.9973; val_best_acc_score: 0.9794; val_best_f1_score: 0.9793; train_kl_reg_loss: 1486.8282; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191239.1722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192726.0004; train_optim_loss: 192726.0004; val_kl_reg_loss: 1471.8233; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192415.2060; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193887.0294; val_optim_loss: 193887.0294
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9967; val_auprc_score: 0.9972; val_best_acc_score: 0.9796; val_best_f1_score: 0.9795; train_kl_reg_loss: 1484.5265; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191261.4058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192745.9322; train_optim_loss: 192745.9322; val_kl_reg_loss: 1468.8887; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192291.0912; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193759.9800; val_optim_loss: 193759.9800
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9968; val_auprc_score: 0.9973; val_best_acc_score: 0.9795; val_best_f1_score: 0.9794; train_kl_reg_loss: 1484.1468; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191284.3281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192768.4748; train_optim_loss: 192768.4748; val_kl_reg_loss: 1471.6990; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192409.3557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193881.0549; val_optim_loss: 193881.0549
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9967; val_auprc_score: 0.9973; val_best_acc_score: 0.9795; val_best_f1_score: 0.9794; train_kl_reg_loss: 1483.1467; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191265.4568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192748.6035; train_optim_loss: 192748.6035; val_kl_reg_loss: 1466.6683; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192538.0253; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194004.6932; val_optim_loss: 194004.6932
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9968; val_auprc_score: 0.9972; val_best_acc_score: 0.9797; val_best_f1_score: 0.9796; train_kl_reg_loss: 1482.2343; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191240.0514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192722.2858; train_optim_loss: 192722.2858; val_kl_reg_loss: 1464.7605; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192373.0436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193837.8043; val_optim_loss: 193837.8043
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9967; val_auprc_score: 0.9973; val_best_acc_score: 0.9794; val_best_f1_score: 0.9793; train_kl_reg_loss: 1481.3691; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191247.1271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192728.4961; train_optim_loss: 192728.4961; val_kl_reg_loss: 1466.2337; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192403.9689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193870.2023; val_optim_loss: 193870.2023

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9967; val_auprc_score: 0.9973; val_best_acc_score: 0.9797; val_best_f1_score: 0.9795; train_kl_reg_loss: 1481.0625; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191174.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192655.9843; train_optim_loss: 192655.9843; val_kl_reg_loss: 1465.6428; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192401.2462; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193866.8890; val_optim_loss: 193866.8890
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9967; val_auprc_score: 0.9971; val_best_acc_score: 0.9799; val_best_f1_score: 0.9797; train_kl_reg_loss: 1480.2832; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191211.8198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192692.1031; train_optim_loss: 192692.1031; val_kl_reg_loss: 1464.5464; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192641.8491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194106.3955; val_optim_loss: 194106.3955
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9967; val_auprc_score: 0.9971; val_best_acc_score: 0.9792; val_best_f1_score: 0.9790; train_kl_reg_loss: 1479.1371; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191189.9436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192669.0806; train_optim_loss: 192669.0806; val_kl_reg_loss: 1463.3876; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192443.0550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193906.4429; val_optim_loss: 193906.4429
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9967; val_auprc_score: 0.9973; val_best_acc_score: 0.9795; val_best_f1_score: 0.9794; train_kl_reg_loss: 1479.0596; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191237.2552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192716.3147; train_optim_loss: 192716.3147; val_kl_reg_loss: 1463.9673; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 192457.4836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193921.4509; val_optim_loss: 193921.4509

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 527 min 2 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
Val AUROC score: 0.9967
Val AUPRC score: 0.9972
Val best accuracy score: 0.9797
Val best F1 score: 0.9795
Val gene expr MSE score: 7.9610

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
