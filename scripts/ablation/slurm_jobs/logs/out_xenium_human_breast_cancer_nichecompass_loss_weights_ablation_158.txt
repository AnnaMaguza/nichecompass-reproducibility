None
Run timestamp: 15072023_034940_158.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_158']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9463; val_auprc_score: 0.9295; val_best_acc_score: 0.8873; val_best_f1_score: 0.8944; train_kl_reg_loss: 56532.2416; train_edge_recon_loss: 27095123.2630; train_gene_expr_recon_loss: 7586771.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34738427.0153; train_optim_loss: 34738427.0153; val_kl_reg_loss: 54123.8322; val_edge_recon_loss: 26701683.5753; val_gene_expr_recon_loss: 6991013.8699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33746821.2603; val_optim_loss: 33746821.2603
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9637; val_auprc_score: 0.9559; val_best_acc_score: 0.9057; val_best_f1_score: 0.9100; train_kl_reg_loss: 51909.3219; train_edge_recon_loss: 26404585.1391; train_gene_expr_recon_loss: 6834137.5214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33290631.9587; train_optim_loss: 33290631.9587; val_kl_reg_loss: 44956.6266; val_edge_recon_loss: 26519598.8219; val_gene_expr_recon_loss: 6714005.2842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33278560.7945; val_optim_loss: 33278560.7945
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9731; val_auprc_score: 0.9672; val_best_acc_score: 0.9214; val_best_f1_score: 0.9240; train_kl_reg_loss: 43044.8756; train_edge_recon_loss: 26272079.1957; train_gene_expr_recon_loss: 6635167.5313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32950291.6239; train_optim_loss: 32950291.6239; val_kl_reg_loss: 37997.4501; val_edge_recon_loss: 26430820.1781; val_gene_expr_recon_loss: 6574529.2021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33043346.8630; val_optim_loss: 33043346.8630
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9780; val_auprc_score: 0.9732; val_best_acc_score: 0.9306; val_best_f1_score: 0.9327; train_kl_reg_loss: 37983.0731; train_edge_recon_loss: 26148878.8486; train_gene_expr_recon_loss: 6544527.7416; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32731389.6697; train_optim_loss: 32731389.6697; val_kl_reg_loss: 35901.0520; val_edge_recon_loss: 26344442.2329; val_gene_expr_recon_loss: 6518813.6747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32899157.0000; val_optim_loss: 32899157.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9797; val_auprc_score: 0.9756; val_best_acc_score: 0.9341; val_best_f1_score: 0.9363; train_kl_reg_loss: 36172.6993; train_edge_recon_loss: 26090123.7401; train_gene_expr_recon_loss: 6486328.0593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32612624.5642; train_optim_loss: 32612624.5642; val_kl_reg_loss: 35398.6438; val_edge_recon_loss: 26322730.1370; val_gene_expr_recon_loss: 6466894.2842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32825023.1370; val_optim_loss: 32825023.1370
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9808; val_auprc_score: 0.9766; val_best_acc_score: 0.9368; val_best_f1_score: 0.9385; train_kl_reg_loss: 35210.3788; train_edge_recon_loss: 26056702.8547; train_gene_expr_recon_loss: 6447090.6418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32539003.8761; train_optim_loss: 32539003.8761; val_kl_reg_loss: 33579.9980; val_edge_recon_loss: 26269185.0411; val_gene_expr_recon_loss: 6441492.7055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32744257.6438; val_optim_loss: 32744257.6438
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9831; val_auprc_score: 0.9796; val_best_acc_score: 0.9410; val_best_f1_score: 0.9423; train_kl_reg_loss: 34256.4245; train_edge_recon_loss: 26025109.4694; train_gene_expr_recon_loss: 6423365.4450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32482731.3043; train_optim_loss: 32482731.3043; val_kl_reg_loss: 32612.2247; val_edge_recon_loss: 26218226.6575; val_gene_expr_recon_loss: 6411565.1610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32662404.0685; val_optim_loss: 32662404.0685
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9835; val_auprc_score: 0.9797; val_best_acc_score: 0.9426; val_best_f1_score: 0.9441; train_kl_reg_loss: 33442.8176; train_edge_recon_loss: 26011316.6361; train_gene_expr_recon_loss: 6400353.9855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32445113.4572; train_optim_loss: 32445113.4572; val_kl_reg_loss: 32052.6445; val_edge_recon_loss: 26202439.3151; val_gene_expr_recon_loss: 6412213.0240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32646704.9589; val_optim_loss: 32646704.9589
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9834; val_auprc_score: 0.9794; val_best_acc_score: 0.9429; val_best_f1_score: 0.9442; train_kl_reg_loss: 32574.3055; train_edge_recon_loss: 25980188.5107; train_gene_expr_recon_loss: 6387759.5654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32400522.3563; train_optim_loss: 32400522.3563; val_kl_reg_loss: 31192.5049; val_edge_recon_loss: 26235699.5479; val_gene_expr_recon_loss: 6386656.1678; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32653548.3699; val_optim_loss: 32653548.3699
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9843; val_auprc_score: 0.9809; val_best_acc_score: 0.9443; val_best_f1_score: 0.9456; train_kl_reg_loss: 32481.8131; train_edge_recon_loss: 25967874.6544; train_gene_expr_recon_loss: 6371423.0719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32371779.5734; train_optim_loss: 32371779.5734; val_kl_reg_loss: 31389.5245; val_edge_recon_loss: 26170281.2603; val_gene_expr_recon_loss: 6382943.5890; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32584614.2466; val_optim_loss: 32584614.2466
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9852; val_auprc_score: 0.9821; val_best_acc_score: 0.9461; val_best_f1_score: 0.9474; train_kl_reg_loss: 32193.1714; train_edge_recon_loss: 25950957.7355; train_gene_expr_recon_loss: 6360740.9285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32343891.8058; train_optim_loss: 32343891.8058; val_kl_reg_loss: 30962.6578; val_edge_recon_loss: 26162245.5479; val_gene_expr_recon_loss: 6363514.8699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32556723.1096; val_optim_loss: 32556723.1096
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9847; val_auprc_score: 0.9812; val_best_acc_score: 0.9465; val_best_f1_score: 0.9477; train_kl_reg_loss: 31882.3778; train_edge_recon_loss: 25949608.1774; train_gene_expr_recon_loss: 6351954.3230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32333444.8807; train_optim_loss: 32333444.8807; val_kl_reg_loss: 31676.7910; val_edge_recon_loss: 26160539.7534; val_gene_expr_recon_loss: 6361096.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32553312.9589; val_optim_loss: 32553312.9589
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9853; val_auprc_score: 0.9815; val_best_acc_score: 0.9485; val_best_f1_score: 0.9496; train_kl_reg_loss: 31551.7634; train_edge_recon_loss: 25941715.0122; train_gene_expr_recon_loss: 6345679.1369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32318945.9159; train_optim_loss: 32318945.9159; val_kl_reg_loss: 30987.2464; val_edge_recon_loss: 26128518.9589; val_gene_expr_recon_loss: 6377347.8048; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32536853.8904; val_optim_loss: 32536853.8904
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9857; val_auprc_score: 0.9823; val_best_acc_score: 0.9489; val_best_f1_score: 0.9501; train_kl_reg_loss: 31366.9133; train_edge_recon_loss: 25929007.5703; train_gene_expr_recon_loss: 6333230.0642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32293604.5719; train_optim_loss: 32293604.5719; val_kl_reg_loss: 31082.1166; val_edge_recon_loss: 26127072.4384; val_gene_expr_recon_loss: 6349574.6712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32507729.2192; val_optim_loss: 32507729.2192
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9864; val_auprc_score: 0.9830; val_best_acc_score: 0.9501; val_best_f1_score: 0.9513; train_kl_reg_loss: 31309.5394; train_edge_recon_loss: 25917025.1560; train_gene_expr_recon_loss: 6328283.4488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32276618.1560; train_optim_loss: 32276618.1560; val_kl_reg_loss: 30278.1932; val_edge_recon_loss: 26111536.2877; val_gene_expr_recon_loss: 6351862.7363; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32493677.2329; val_optim_loss: 32493677.2329
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9864; val_auprc_score: 0.9829; val_best_acc_score: 0.9504; val_best_f1_score: 0.9515; train_kl_reg_loss: 31137.4859; train_edge_recon_loss: 25915397.1208; train_gene_expr_recon_loss: 6321985.1816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32268519.8211; train_optim_loss: 32268519.8211; val_kl_reg_loss: 30706.6907; val_edge_recon_loss: 26122444.3836; val_gene_expr_recon_loss: 6345858.5856; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32499009.6986; val_optim_loss: 32499009.6986
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9870; val_auprc_score: 0.9838; val_best_acc_score: 0.9522; val_best_f1_score: 0.9532; train_kl_reg_loss: 31082.1287; train_edge_recon_loss: 25902923.1147; train_gene_expr_recon_loss: 6313638.8073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32247644.0673; train_optim_loss: 32247644.0673; val_kl_reg_loss: 31092.7237; val_edge_recon_loss: 26070454.3699; val_gene_expr_recon_loss: 6338591.6507; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32440138.6301; val_optim_loss: 32440138.6301
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9877; val_auprc_score: 0.9846; val_best_acc_score: 0.9537; val_best_f1_score: 0.9547; train_kl_reg_loss: 30923.5582; train_edge_recon_loss: 25897128.2844; train_gene_expr_recon_loss: 6311413.8406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32239465.6820; train_optim_loss: 32239465.6820; val_kl_reg_loss: 30000.0644; val_edge_recon_loss: 26111364.5342; val_gene_expr_recon_loss: 6333295.8116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32474660.4932; val_optim_loss: 32474660.4932
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9872; val_auprc_score: 0.9838; val_best_acc_score: 0.9532; val_best_f1_score: 0.9543; train_kl_reg_loss: 30684.8863; train_edge_recon_loss: 25888456.7706; train_gene_expr_recon_loss: 6307068.1934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32226209.8639; train_optim_loss: 32226209.8639; val_kl_reg_loss: 30020.8740; val_edge_recon_loss: 26054436.3151; val_gene_expr_recon_loss: 6321782.8699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32406240.0411; val_optim_loss: 32406240.0411
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9875; val_auprc_score: 0.9845; val_best_acc_score: 0.9529; val_best_f1_score: 0.9538; train_kl_reg_loss: 30592.1490; train_edge_recon_loss: 25877556.3502; train_gene_expr_recon_loss: 6304854.6177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32213003.1147; train_optim_loss: 32213003.1147; val_kl_reg_loss: 29606.4218; val_edge_recon_loss: 26087776.6301; val_gene_expr_recon_loss: 6322834.0890; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32440217.2329; val_optim_loss: 32440217.2329
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9874; val_auprc_score: 0.9843; val_best_acc_score: 0.9529; val_best_f1_score: 0.9539; train_kl_reg_loss: 30456.4567; train_edge_recon_loss: 25877518.7309; train_gene_expr_recon_loss: 6302179.1135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32210154.3410; train_optim_loss: 32210154.3410; val_kl_reg_loss: 29922.1867; val_edge_recon_loss: 26098321.5479; val_gene_expr_recon_loss: 6317438.6747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32445682.3425; val_optim_loss: 32445682.3425
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9883; val_auprc_score: 0.9853; val_best_acc_score: 0.9551; val_best_f1_score: 0.9559; train_kl_reg_loss: 30123.2101; train_edge_recon_loss: 25879660.1789; train_gene_expr_recon_loss: 6299817.2599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32209600.6391; train_optim_loss: 32209600.6391; val_kl_reg_loss: 29979.8398; val_edge_recon_loss: 26093110.5753; val_gene_expr_recon_loss: 6331088.4623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32454178.7397; val_optim_loss: 32454178.7397
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9884; val_auprc_score: 0.9855; val_best_acc_score: 0.9558; val_best_f1_score: 0.9566; train_kl_reg_loss: 30661.6378; train_edge_recon_loss: 25865571.4633; train_gene_expr_recon_loss: 6294641.0688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32190874.2171; train_optim_loss: 32190874.2171; val_kl_reg_loss: 29460.2425; val_edge_recon_loss: 26061308.2740; val_gene_expr_recon_loss: 6308935.4281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32399704.0411; val_optim_loss: 32399704.0411
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9877; val_auprc_score: 0.9845; val_best_acc_score: 0.9535; val_best_f1_score: 0.9544; train_kl_reg_loss: 30306.8184; train_edge_recon_loss: 25869204.7523; train_gene_expr_recon_loss: 6296272.5841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32195784.1070; train_optim_loss: 32195784.1070; val_kl_reg_loss: 29202.3452; val_edge_recon_loss: 26105143.0685; val_gene_expr_recon_loss: 6317933.5548; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32452278.8630; val_optim_loss: 32452278.8630
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9878; val_auprc_score: 0.9845; val_best_acc_score: 0.9551; val_best_f1_score: 0.9559; train_kl_reg_loss: 30231.1404; train_edge_recon_loss: 25857632.3073; train_gene_expr_recon_loss: 6288897.9182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32176761.3731; train_optim_loss: 32176761.3731; val_kl_reg_loss: 29892.0633; val_edge_recon_loss: 26095069.0274; val_gene_expr_recon_loss: 6324605.6199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32449566.8356; val_optim_loss: 32449566.8356
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9885; val_auprc_score: 0.9852; val_best_acc_score: 0.9566; val_best_f1_score: 0.9575; train_kl_reg_loss: 29959.4014; train_edge_recon_loss: 25857130.4801; train_gene_expr_recon_loss: 6286946.6950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32174036.5550; train_optim_loss: 32174036.5550; val_kl_reg_loss: 28859.7425; val_edge_recon_loss: 26025652.1644; val_gene_expr_recon_loss: 6323994.5240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32378506.4110; val_optim_loss: 32378506.4110
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9878; val_auprc_score: 0.9845; val_best_acc_score: 0.9552; val_best_f1_score: 0.9561; train_kl_reg_loss: 29925.4617; train_edge_recon_loss: 25842718.6040; train_gene_expr_recon_loss: 6288026.6177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32160670.7110; train_optim_loss: 32160670.7110; val_kl_reg_loss: 30229.9775; val_edge_recon_loss: 26052892.3014; val_gene_expr_recon_loss: 6310094.4486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32393216.6986; val_optim_loss: 32393216.6986
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9886; val_auprc_score: 0.9858; val_best_acc_score: 0.9561; val_best_f1_score: 0.9570; train_kl_reg_loss: 29853.7179; train_edge_recon_loss: 25847998.5168; train_gene_expr_recon_loss: 6282390.6120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32160242.8578; train_optim_loss: 32160242.8578; val_kl_reg_loss: 29715.6190; val_edge_recon_loss: 26041997.5205; val_gene_expr_recon_loss: 6326587.5103; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32398300.6986; val_optim_loss: 32398300.6986
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9883; val_auprc_score: 0.9854; val_best_acc_score: 0.9555; val_best_f1_score: 0.9564; train_kl_reg_loss: 29863.3137; train_edge_recon_loss: 25844205.8761; train_gene_expr_recon_loss: 6283208.4541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32157277.6193; train_optim_loss: 32157277.6193; val_kl_reg_loss: 28913.0598; val_edge_recon_loss: 26090624.9178; val_gene_expr_recon_loss: 6318610.7295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32438148.8630; val_optim_loss: 32438148.8630
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9890; val_auprc_score: 0.9862; val_best_acc_score: 0.9570; val_best_f1_score: 0.9577; train_kl_reg_loss: 29751.5023; train_edge_recon_loss: 25846530.3425; train_gene_expr_recon_loss: 6282543.1365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32158824.9771; train_optim_loss: 32158824.9771; val_kl_reg_loss: 29034.3746; val_edge_recon_loss: 26047858.1233; val_gene_expr_recon_loss: 6304651.9075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32381544.4384; val_optim_loss: 32381544.4384

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9889; val_auprc_score: 0.9860; val_best_acc_score: 0.9570; val_best_f1_score: 0.9578; train_kl_reg_loss: 30919.7655; train_edge_recon_loss: 25830193.9419; train_gene_expr_recon_loss: 6224872.2018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32085985.8960; train_optim_loss: 32085985.8960; val_kl_reg_loss: 30831.4911; val_edge_recon_loss: 26033073.5479; val_gene_expr_recon_loss: 6266845.8493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32330750.9863; val_optim_loss: 32330750.9863
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9888; val_auprc_score: 0.9859; val_best_acc_score: 0.9573; val_best_f1_score: 0.9580; train_kl_reg_loss: 31700.9136; train_edge_recon_loss: 25827425.8976; train_gene_expr_recon_loss: 6221105.6541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32080232.4190; train_optim_loss: 32080232.4190; val_kl_reg_loss: 31211.2286; val_edge_recon_loss: 26041909.7945; val_gene_expr_recon_loss: 6255540.8904; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32328661.9726; val_optim_loss: 32328661.9726
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9893; val_auprc_score: 0.9864; val_best_acc_score: 0.9576; val_best_f1_score: 0.9584; train_kl_reg_loss: 32062.8028; train_edge_recon_loss: 25817832.4281; train_gene_expr_recon_loss: 6217072.3257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32066967.5413; train_optim_loss: 32066967.5413; val_kl_reg_loss: 31373.1746; val_edge_recon_loss: 26030360.0548; val_gene_expr_recon_loss: 6257058.4897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32318791.6438; val_optim_loss: 32318791.6438
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9890; val_auprc_score: 0.9860; val_best_acc_score: 0.9573; val_best_f1_score: 0.9580; train_kl_reg_loss: 32199.0446; train_edge_recon_loss: 25834687.2431; train_gene_expr_recon_loss: 6215970.0979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32082856.4037; train_optim_loss: 32082856.4037; val_kl_reg_loss: 31661.7407; val_edge_recon_loss: 26036222.7123; val_gene_expr_recon_loss: 6253584.2226; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32321468.6164; val_optim_loss: 32321468.6164
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9890; val_auprc_score: 0.9860; val_best_acc_score: 0.9577; val_best_f1_score: 0.9584; train_kl_reg_loss: 32294.0386; train_edge_recon_loss: 25825504.7202; train_gene_expr_recon_loss: 6214821.6372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32072620.3318; train_optim_loss: 32072620.3318; val_kl_reg_loss: 31526.8673; val_edge_recon_loss: 26041592.0411; val_gene_expr_recon_loss: 6246520.4075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32319639.2603; val_optim_loss: 32319639.2603
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9890; val_auprc_score: 0.9862; val_best_acc_score: 0.9575; val_best_f1_score: 0.9583; train_kl_reg_loss: 32405.0094; train_edge_recon_loss: 25823235.3838; train_gene_expr_recon_loss: 6214580.6093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32070220.9924; train_optim_loss: 32070220.9924; val_kl_reg_loss: 31709.8425; val_edge_recon_loss: 26037762.8767; val_gene_expr_recon_loss: 6256089.5993; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32325562.3014; val_optim_loss: 32325562.3014
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9893; val_auprc_score: 0.9866; val_best_acc_score: 0.9582; val_best_f1_score: 0.9589; train_kl_reg_loss: 32616.3318; train_edge_recon_loss: 25816291.0107; train_gene_expr_recon_loss: 6214159.4683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32063066.8349; train_optim_loss: 32063066.8349; val_kl_reg_loss: 31964.2647; val_edge_recon_loss: 26014531.1918; val_gene_expr_recon_loss: 6263680.3801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32310175.9589; val_optim_loss: 32310175.9589
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9892; val_auprc_score: 0.9864; val_best_acc_score: 0.9583; val_best_f1_score: 0.9590; train_kl_reg_loss: 32579.0053; train_edge_recon_loss: 25820644.7492; train_gene_expr_recon_loss: 6212206.7733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32065430.5306; train_optim_loss: 32065430.5306; val_kl_reg_loss: 31827.2528; val_edge_recon_loss: 26028092.6712; val_gene_expr_recon_loss: 6253968.2911; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32313888.2329; val_optim_loss: 32313888.2329
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9892; val_auprc_score: 0.9862; val_best_acc_score: 0.9582; val_best_f1_score: 0.9589; train_kl_reg_loss: 32413.8588; train_edge_recon_loss: 25829419.9618; train_gene_expr_recon_loss: 6211408.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32073241.9251; train_optim_loss: 32073241.9251; val_kl_reg_loss: 31535.8345; val_edge_recon_loss: 26036675.3151; val_gene_expr_recon_loss: 6256598.6610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32324809.9041; val_optim_loss: 32324809.9041
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9888; val_auprc_score: 0.9858; val_best_acc_score: 0.9578; val_best_f1_score: 0.9586; train_kl_reg_loss: 32671.1985; train_edge_recon_loss: 25817447.2003; train_gene_expr_recon_loss: 6211987.2844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32062105.6957; train_optim_loss: 32062105.6957; val_kl_reg_loss: 32116.1167; val_edge_recon_loss: 26013336.9041; val_gene_expr_recon_loss: 6259568.8390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32305021.8493; val_optim_loss: 32305021.8493
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9894; val_auprc_score: 0.9867; val_best_acc_score: 0.9580; val_best_f1_score: 0.9587; train_kl_reg_loss: 32592.5830; train_edge_recon_loss: 25821192.7339; train_gene_expr_recon_loss: 6211450.6204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32065235.9220; train_optim_loss: 32065235.9220; val_kl_reg_loss: 31658.7059; val_edge_recon_loss: 26029838.3425; val_gene_expr_recon_loss: 6250378.0788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32311875.1096; val_optim_loss: 32311875.1096
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9895; val_auprc_score: 0.9869; val_best_acc_score: 0.9584; val_best_f1_score: 0.9592; train_kl_reg_loss: 32669.7139; train_edge_recon_loss: 25811983.1667; train_gene_expr_recon_loss: 6208748.1407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32053401.0260; train_optim_loss: 32053401.0260; val_kl_reg_loss: 32057.5146; val_edge_recon_loss: 26002738.6986; val_gene_expr_recon_loss: 6246844.9384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32281641.1644; val_optim_loss: 32281641.1644
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9894; val_auprc_score: 0.9868; val_best_acc_score: 0.9582; val_best_f1_score: 0.9589; train_kl_reg_loss: 32712.8177; train_edge_recon_loss: 25813067.2875; train_gene_expr_recon_loss: 6209760.6361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32055540.7248; train_optim_loss: 32055540.7248; val_kl_reg_loss: 32196.9252; val_edge_recon_loss: 26031870.8082; val_gene_expr_recon_loss: 6244925.1062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32308992.8493; val_optim_loss: 32308992.8493
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9891; val_auprc_score: 0.9863; val_best_acc_score: 0.9577; val_best_f1_score: 0.9585; train_kl_reg_loss: 32712.6334; train_edge_recon_loss: 25819568.5994; train_gene_expr_recon_loss: 6209530.0638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32061811.3043; train_optim_loss: 32061811.3043; val_kl_reg_loss: 31883.6995; val_edge_recon_loss: 26035784.5342; val_gene_expr_recon_loss: 6250752.8973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32318421.1233; val_optim_loss: 32318421.1233
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9893; val_auprc_score: 0.9865; val_best_acc_score: 0.9587; val_best_f1_score: 0.9594; train_kl_reg_loss: 32691.5923; train_edge_recon_loss: 25814180.2171; train_gene_expr_recon_loss: 6211600.6797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32058472.4358; train_optim_loss: 32058472.4358; val_kl_reg_loss: 32162.6253; val_edge_recon_loss: 26005232.1507; val_gene_expr_recon_loss: 6237968.3801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32275363.0822; val_optim_loss: 32275363.0822
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9891; val_auprc_score: 0.9861; val_best_acc_score: 0.9582; val_best_f1_score: 0.9589; train_kl_reg_loss: 32652.1789; train_edge_recon_loss: 25813672.4862; train_gene_expr_recon_loss: 6205284.6109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32051609.2798; train_optim_loss: 32051609.2798; val_kl_reg_loss: 31914.8804; val_edge_recon_loss: 26033244.3836; val_gene_expr_recon_loss: 6261352.6438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32326511.9589; val_optim_loss: 32326511.9589
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9893; val_auprc_score: 0.9862; val_best_acc_score: 0.9580; val_best_f1_score: 0.9588; train_kl_reg_loss: 32665.1104; train_edge_recon_loss: 25821147.7554; train_gene_expr_recon_loss: 6207375.7378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32061188.6116; train_optim_loss: 32061188.6116; val_kl_reg_loss: 32107.0659; val_edge_recon_loss: 26008190.3425; val_gene_expr_recon_loss: 6248309.3048; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32288606.8082; val_optim_loss: 32288606.8082
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9897; val_auprc_score: 0.9871; val_best_acc_score: 0.9592; val_best_f1_score: 0.9599; train_kl_reg_loss: 32687.9610; train_edge_recon_loss: 25814224.9740; train_gene_expr_recon_loss: 6209009.8800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32055922.8471; train_optim_loss: 32055922.8471; val_kl_reg_loss: 32023.9207; val_edge_recon_loss: 26014040.8630; val_gene_expr_recon_loss: 6250582.8596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32296647.6438; val_optim_loss: 32296647.6438
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9890; val_auprc_score: 0.9860; val_best_acc_score: 0.9584; val_best_f1_score: 0.9591; train_kl_reg_loss: 32483.7575; train_edge_recon_loss: 25818335.4128; train_gene_expr_recon_loss: 6207068.5248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32057887.7125; train_optim_loss: 32057887.7125; val_kl_reg_loss: 31799.2660; val_edge_recon_loss: 26038242.7671; val_gene_expr_recon_loss: 6251635.2363; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32321677.4110; val_optim_loss: 32321677.4110

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9892; val_auprc_score: 0.9863; val_best_acc_score: 0.9580; val_best_f1_score: 0.9587; train_kl_reg_loss: 32527.6433; train_edge_recon_loss: 25815765.3578; train_gene_expr_recon_loss: 6199709.0019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32048001.9847; train_optim_loss: 32048001.9847; val_kl_reg_loss: 31762.1282; val_edge_recon_loss: 26046146.6849; val_gene_expr_recon_loss: 6238193.7158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32316102.5890; val_optim_loss: 32316102.5890
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9892; val_auprc_score: 0.9866; val_best_acc_score: 0.9584; val_best_f1_score: 0.9591; train_kl_reg_loss: 32595.9116; train_edge_recon_loss: 25815331.0887; train_gene_expr_recon_loss: 6199300.6965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32047227.7125; train_optim_loss: 32047227.7125; val_kl_reg_loss: 31891.7272; val_edge_recon_loss: 26024412.3699; val_gene_expr_recon_loss: 6243917.0137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32300221.0548; val_optim_loss: 32300221.0548
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9893; val_auprc_score: 0.9865; val_best_acc_score: 0.9582; val_best_f1_score: 0.9589; train_kl_reg_loss: 32608.6234; train_edge_recon_loss: 25818355.2905; train_gene_expr_recon_loss: 6198553.9148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32049517.8502; train_optim_loss: 32049517.8502; val_kl_reg_loss: 31910.7356; val_edge_recon_loss: 26042719.1096; val_gene_expr_recon_loss: 6237737.2397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32312367.0822; val_optim_loss: 32312367.0822
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9896; val_auprc_score: 0.9867; val_best_acc_score: 0.9589; val_best_f1_score: 0.9596; train_kl_reg_loss: 32635.8468; train_edge_recon_loss: 25813974.3119; train_gene_expr_recon_loss: 6201283.4228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32047893.6024; train_optim_loss: 32047893.6024; val_kl_reg_loss: 31886.0422; val_edge_recon_loss: 26004941.1233; val_gene_expr_recon_loss: 6241728.5068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32278555.6849; val_optim_loss: 32278555.6849

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 270 min 13 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
Val AUROC score: 0.9894
Val AUPRC score: 0.9867
Val best accuracy score: 0.9586
Val best F1 score: 0.9593
Val gene expr MSE score: 1.4832

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
