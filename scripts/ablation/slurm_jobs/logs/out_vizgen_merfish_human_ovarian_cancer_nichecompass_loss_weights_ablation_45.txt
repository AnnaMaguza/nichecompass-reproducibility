None
Run timestamp: 17072023_203751_45.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_45']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9732; val_auprc_score: 0.9707; val_best_acc_score: 0.9172; val_best_f1_score: 0.9184; train_kl_reg_loss: 16837.8144; train_edge_recon_loss: 26567180.7739; train_gene_expr_recon_loss: 2205388.3756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28789406.9919; train_optim_loss: 28789406.9919; val_kl_reg_loss: 16496.0261; val_edge_recon_loss: 26559970.7636; val_gene_expr_recon_loss: 2099122.3057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28675589.0545; val_optim_loss: 28675589.0545
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9767; val_auprc_score: 0.9742; val_best_acc_score: 0.9256; val_best_f1_score: 0.9264; train_kl_reg_loss: 16242.1226; train_edge_recon_loss: 26023612.4236; train_gene_expr_recon_loss: 2070014.9403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28109869.4725; train_optim_loss: 28109869.4725; val_kl_reg_loss: 15720.7705; val_edge_recon_loss: 26474763.8727; val_gene_expr_recon_loss: 2037165.7693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28527650.4000; val_optim_loss: 28527650.4000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9791; val_auprc_score: 0.9760; val_best_acc_score: 0.9303; val_best_f1_score: 0.9312; train_kl_reg_loss: 16291.1632; train_edge_recon_loss: 25960192.4033; train_gene_expr_recon_loss: 2025790.9076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28002274.4460; train_optim_loss: 28002274.4460; val_kl_reg_loss: 15998.3457; val_edge_recon_loss: 26478424.9091; val_gene_expr_recon_loss: 2016356.3580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28510779.6727; val_optim_loss: 28510779.6727
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9820; val_auprc_score: 0.9792; val_best_acc_score: 0.9359; val_best_f1_score: 0.9365; train_kl_reg_loss: 16500.6421; train_edge_recon_loss: 25923475.9695; train_gene_expr_recon_loss: 2005341.6992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27945318.2953; train_optim_loss: 27945318.2953; val_kl_reg_loss: 16245.6368; val_edge_recon_loss: 26364147.4364; val_gene_expr_recon_loss: 1993253.4580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28373646.6182; val_optim_loss: 28373646.6182
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9827; val_auprc_score: 0.9802; val_best_acc_score: 0.9374; val_best_f1_score: 0.9381; train_kl_reg_loss: 16557.1676; train_edge_recon_loss: 25893548.5397; train_gene_expr_recon_loss: 1994790.2441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27904895.9511; train_optim_loss: 27904895.9511; val_kl_reg_loss: 16595.1421; val_edge_recon_loss: 26368031.5636; val_gene_expr_recon_loss: 1987283.5091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28371910.3273; val_optim_loss: 28371910.3273
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9837; val_auprc_score: 0.9816; val_best_acc_score: 0.9397; val_best_f1_score: 0.9404; train_kl_reg_loss: 16521.1620; train_edge_recon_loss: 25871278.9002; train_gene_expr_recon_loss: 1986157.2686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27873957.4012; train_optim_loss: 27873957.4012; val_kl_reg_loss: 16307.0698; val_edge_recon_loss: 26376109.7091; val_gene_expr_recon_loss: 1981544.9773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28373961.7455; val_optim_loss: 28373961.7455
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9846; val_auprc_score: 0.9823; val_best_acc_score: 0.9416; val_best_f1_score: 0.9421; train_kl_reg_loss: 16471.6306; train_edge_recon_loss: 25854026.3870; train_gene_expr_recon_loss: 1982855.2371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27853353.2811; train_optim_loss: 27853353.2811; val_kl_reg_loss: 16174.4707; val_edge_recon_loss: 26328837.2364; val_gene_expr_recon_loss: 1978216.5034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28323228.2364; val_optim_loss: 28323228.2364
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9857; val_auprc_score: 0.9838; val_best_acc_score: 0.9441; val_best_f1_score: 0.9446; train_kl_reg_loss: 16338.4862; train_edge_recon_loss: 25851980.1853; train_gene_expr_recon_loss: 1979375.6752; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27847694.3544; train_optim_loss: 27847694.3544; val_kl_reg_loss: 15682.9381; val_edge_recon_loss: 26321857.5636; val_gene_expr_recon_loss: 1976774.8057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28314315.3818; val_optim_loss: 28314315.3818
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9865; val_auprc_score: 0.9847; val_best_acc_score: 0.9462; val_best_f1_score: 0.9468; train_kl_reg_loss: 16330.2184; train_edge_recon_loss: 25837570.0692; train_gene_expr_recon_loss: 1978345.1053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27832245.3809; train_optim_loss: 27832245.3809; val_kl_reg_loss: 16193.6297; val_edge_recon_loss: 26319503.5636; val_gene_expr_recon_loss: 1989569.5057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28325266.7273; val_optim_loss: 28325266.7273
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9872; val_auprc_score: 0.9852; val_best_acc_score: 0.9485; val_best_f1_score: 0.9489; train_kl_reg_loss: 16186.9458; train_edge_recon_loss: 25826877.3218; train_gene_expr_recon_loss: 1977361.7663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27820426.0448; train_optim_loss: 27820426.0448; val_kl_reg_loss: 16245.1526; val_edge_recon_loss: 26326179.1091; val_gene_expr_recon_loss: 1977088.7795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28319513.0909; val_optim_loss: 28319513.0909
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9877; val_auprc_score: 0.9855; val_best_acc_score: 0.9491; val_best_f1_score: 0.9497; train_kl_reg_loss: 16205.8217; train_edge_recon_loss: 25802311.5092; train_gene_expr_recon_loss: 1974645.7158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27793163.0265; train_optim_loss: 27793163.0265; val_kl_reg_loss: 16009.2910; val_edge_recon_loss: 26311394.6727; val_gene_expr_recon_loss: 1972464.8102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28299868.6364; val_optim_loss: 28299868.6364
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9879; val_auprc_score: 0.9861; val_best_acc_score: 0.9494; val_best_f1_score: 0.9499; train_kl_reg_loss: 16110.7233; train_edge_recon_loss: 25802788.9532; train_gene_expr_recon_loss: 1973405.7513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27792305.4399; train_optim_loss: 27792305.4399; val_kl_reg_loss: 16102.6287; val_edge_recon_loss: 26294025.3818; val_gene_expr_recon_loss: 1970552.6341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28280680.7091; val_optim_loss: 28280680.7091
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9882; val_auprc_score: 0.9861; val_best_acc_score: 0.9509; val_best_f1_score: 0.9513; train_kl_reg_loss: 16036.3786; train_edge_recon_loss: 25799655.7556; train_gene_expr_recon_loss: 1972929.7772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27788621.9206; train_optim_loss: 27788621.9206; val_kl_reg_loss: 15364.4488; val_edge_recon_loss: 26269603.0727; val_gene_expr_recon_loss: 1971096.3602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28256063.9273; val_optim_loss: 28256063.9273
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9883; val_auprc_score: 0.9869; val_best_acc_score: 0.9501; val_best_f1_score: 0.9505; train_kl_reg_loss: 16044.8595; train_edge_recon_loss: 25793170.1303; train_gene_expr_recon_loss: 1971832.9701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27781047.9959; train_optim_loss: 27781047.9959; val_kl_reg_loss: 15554.6637; val_edge_recon_loss: 26266558.9818; val_gene_expr_recon_loss: 1970714.3614; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28252827.8182; val_optim_loss: 28252827.8182
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9891; val_auprc_score: 0.9877; val_best_acc_score: 0.9523; val_best_f1_score: 0.9527; train_kl_reg_loss: 15984.0268; train_edge_recon_loss: 25790059.6884; train_gene_expr_recon_loss: 1970602.6866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27776646.4277; train_optim_loss: 27776646.4277; val_kl_reg_loss: 15768.4016; val_edge_recon_loss: 26241690.6364; val_gene_expr_recon_loss: 1975294.9773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28232753.9273; val_optim_loss: 28232753.9273
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9885; val_auprc_score: 0.9867; val_best_acc_score: 0.9520; val_best_f1_score: 0.9523; train_kl_reg_loss: 15918.1071; train_edge_recon_loss: 25794262.3992; train_gene_expr_recon_loss: 1970339.5813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27780520.0916; train_optim_loss: 27780520.0916; val_kl_reg_loss: 15308.2201; val_edge_recon_loss: 26289407.5636; val_gene_expr_recon_loss: 1970329.4011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28275045.2727; val_optim_loss: 28275045.2727
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9893; val_auprc_score: 0.9880; val_best_acc_score: 0.9526; val_best_f1_score: 0.9529; train_kl_reg_loss: 15936.4769; train_edge_recon_loss: 25781382.8941; train_gene_expr_recon_loss: 1968969.1384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27766288.4786; train_optim_loss: 27766288.4786; val_kl_reg_loss: 15173.0536; val_edge_recon_loss: 26253237.6727; val_gene_expr_recon_loss: 1969079.5648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28237490.2545; val_optim_loss: 28237490.2545
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9892; val_auprc_score: 0.9876; val_best_acc_score: 0.9533; val_best_f1_score: 0.9538; train_kl_reg_loss: 15851.3108; train_edge_recon_loss: 25775937.3075; train_gene_expr_recon_loss: 1969028.4282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27760817.0265; train_optim_loss: 27760817.0265; val_kl_reg_loss: 16141.8051; val_edge_recon_loss: 26256076.3091; val_gene_expr_recon_loss: 1968059.3420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28240277.5818; val_optim_loss: 28240277.5818
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9891; val_auprc_score: 0.9877; val_best_acc_score: 0.9530; val_best_f1_score: 0.9534; train_kl_reg_loss: 15900.5894; train_edge_recon_loss: 25779898.1202; train_gene_expr_recon_loss: 1967311.8478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27763110.6069; train_optim_loss: 27763110.6069; val_kl_reg_loss: 15888.9162; val_edge_recon_loss: 26257782.5636; val_gene_expr_recon_loss: 1965399.9511; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28239071.4000; val_optim_loss: 28239071.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9903; val_auprc_score: 0.9887; val_best_acc_score: 0.9553; val_best_f1_score: 0.9557; train_kl_reg_loss: 16419.9886; train_edge_recon_loss: 25740888.9735; train_gene_expr_recon_loss: 1940627.9285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27697936.8982; train_optim_loss: 27697936.8982; val_kl_reg_loss: 16410.4234; val_edge_recon_loss: 26211354.8000; val_gene_expr_recon_loss: 1939502.7841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28167268.0909; val_optim_loss: 28167268.0909
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9904; val_auprc_score: 0.9890; val_best_acc_score: 0.9563; val_best_f1_score: 0.9567; train_kl_reg_loss: 16433.2274; train_edge_recon_loss: 25733123.4175; train_gene_expr_recon_loss: 1937506.3541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27687062.9633; train_optim_loss: 27687062.9633; val_kl_reg_loss: 16007.7914; val_edge_recon_loss: 26197046.6545; val_gene_expr_recon_loss: 1936540.8932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28149595.3818; val_optim_loss: 28149595.3818
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9906; val_auprc_score: 0.9890; val_best_acc_score: 0.9573; val_best_f1_score: 0.9577; train_kl_reg_loss: 16322.7650; train_edge_recon_loss: 25733666.9959; train_gene_expr_recon_loss: 1934936.7490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27684926.5173; train_optim_loss: 27684926.5173; val_kl_reg_loss: 15889.7866; val_edge_recon_loss: 26192624.6545; val_gene_expr_recon_loss: 1934591.7511; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28143106.1818; val_optim_loss: 28143106.1818
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9907; val_auprc_score: 0.9890; val_best_acc_score: 0.9575; val_best_f1_score: 0.9577; train_kl_reg_loss: 16272.9558; train_edge_recon_loss: 25726279.8289; train_gene_expr_recon_loss: 1934112.2858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27676665.1018; train_optim_loss: 27676665.1018; val_kl_reg_loss: 15930.7759; val_edge_recon_loss: 26207270.8545; val_gene_expr_recon_loss: 1932853.1977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28156054.8182; val_optim_loss: 28156054.8182
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9907; val_auprc_score: 0.9892; val_best_acc_score: 0.9571; val_best_f1_score: 0.9573; train_kl_reg_loss: 16186.2684; train_edge_recon_loss: 25729475.0631; train_gene_expr_recon_loss: 1933401.8100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27679063.1018; train_optim_loss: 27679063.1018; val_kl_reg_loss: 15786.7195; val_edge_recon_loss: 26208296.4364; val_gene_expr_recon_loss: 1934720.6909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28158803.8727; val_optim_loss: 28158803.8727
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9909; val_auprc_score: 0.9895; val_best_acc_score: 0.9571; val_best_f1_score: 0.9574; train_kl_reg_loss: 16154.2615; train_edge_recon_loss: 25726324.0143; train_gene_expr_recon_loss: 1932242.6626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27674720.9002; train_optim_loss: 27674720.9002; val_kl_reg_loss: 15826.2587; val_edge_recon_loss: 26201585.4364; val_gene_expr_recon_loss: 1930882.6886; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28148294.4182; val_optim_loss: 28148294.4182
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9910; val_auprc_score: 0.9892; val_best_acc_score: 0.9582; val_best_f1_score: 0.9584; train_kl_reg_loss: 16132.9821; train_edge_recon_loss: 25725642.4745; train_gene_expr_recon_loss: 1931672.7837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27673448.2444; train_optim_loss: 27673448.2444; val_kl_reg_loss: 15773.6113; val_edge_recon_loss: 26211491.0909; val_gene_expr_recon_loss: 1931537.5943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28158802.3091; val_optim_loss: 28158802.3091

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9911; val_auprc_score: 0.9898; val_best_acc_score: 0.9580; val_best_f1_score: 0.9585; train_kl_reg_loss: 16214.8199; train_edge_recon_loss: 25716025.6986; train_gene_expr_recon_loss: 1927728.1315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27659968.6640; train_optim_loss: 27659968.6640; val_kl_reg_loss: 15904.2486; val_edge_recon_loss: 26172851.1455; val_gene_expr_recon_loss: 1927874.0102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28116629.3273; val_optim_loss: 28116629.3273
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9908; val_auprc_score: 0.9894; val_best_acc_score: 0.9575; val_best_f1_score: 0.9580; train_kl_reg_loss: 16206.8438; train_edge_recon_loss: 25719828.3605; train_gene_expr_recon_loss: 1927484.6171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27663519.8758; train_optim_loss: 27663519.8758; val_kl_reg_loss: 15918.2479; val_edge_recon_loss: 26181181.1455; val_gene_expr_recon_loss: 1929529.9818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28126629.3636; val_optim_loss: 28126629.3636
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9907; val_auprc_score: 0.9890; val_best_acc_score: 0.9575; val_best_f1_score: 0.9579; train_kl_reg_loss: 16227.5211; train_edge_recon_loss: 25719444.1487; train_gene_expr_recon_loss: 1927784.7303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27663456.3931; train_optim_loss: 27663456.3931; val_kl_reg_loss: 15968.3282; val_edge_recon_loss: 26187344.6182; val_gene_expr_recon_loss: 1928885.9739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28132198.8545; val_optim_loss: 28132198.8545
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9910; val_auprc_score: 0.9893; val_best_acc_score: 0.9584; val_best_f1_score: 0.9587; train_kl_reg_loss: 16251.6979; train_edge_recon_loss: 25722485.0957; train_gene_expr_recon_loss: 1927363.8638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27666100.6497; train_optim_loss: 27666100.6497; val_kl_reg_loss: 15918.0429; val_edge_recon_loss: 26178924.1273; val_gene_expr_recon_loss: 1926268.5068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28121110.7091; val_optim_loss: 28121110.7091
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9911; val_auprc_score: 0.9894; val_best_acc_score: 0.9582; val_best_f1_score: 0.9588; train_kl_reg_loss: 16229.4832; train_edge_recon_loss: 25724869.7312; train_gene_expr_recon_loss: 1926951.8380; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27668051.0509; train_optim_loss: 27668051.0509; val_kl_reg_loss: 15930.8603; val_edge_recon_loss: 26180768.4182; val_gene_expr_recon_loss: 1928277.3989; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28124976.5455; val_optim_loss: 28124976.5455

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9908; val_auprc_score: 0.9892; val_best_acc_score: 0.9578; val_best_f1_score: 0.9582; train_kl_reg_loss: 16219.0226; train_edge_recon_loss: 25715075.8473; train_gene_expr_recon_loss: 1926497.3493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27657792.2953; train_optim_loss: 27657792.2953; val_kl_reg_loss: 15918.9742; val_edge_recon_loss: 26179235.5818; val_gene_expr_recon_loss: 1927835.8648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28122990.4545; val_optim_loss: 28122990.4545
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9909; val_auprc_score: 0.9894; val_best_acc_score: 0.9577; val_best_f1_score: 0.9582; train_kl_reg_loss: 16218.7614; train_edge_recon_loss: 25715808.0285; train_gene_expr_recon_loss: 1926771.1233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27658797.9267; train_optim_loss: 27658797.9267; val_kl_reg_loss: 15924.1387; val_edge_recon_loss: 26181978.1455; val_gene_expr_recon_loss: 1927027.2273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28124929.5091; val_optim_loss: 28124929.5091
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9914; val_auprc_score: 0.9899; val_best_acc_score: 0.9589; val_best_f1_score: 0.9591; train_kl_reg_loss: 16226.8463; train_edge_recon_loss: 25730380.7760; train_gene_expr_recon_loss: 1926546.4003; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27673154.0122; train_optim_loss: 27673154.0122; val_kl_reg_loss: 15931.5632; val_edge_recon_loss: 26149362.0545; val_gene_expr_recon_loss: 1925989.9477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28091283.4909; val_optim_loss: 28091283.4909
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9911; val_auprc_score: 0.9896; val_best_acc_score: 0.9585; val_best_f1_score: 0.9587; train_kl_reg_loss: 16229.4079; train_edge_recon_loss: 25722331.0998; train_gene_expr_recon_loss: 1926620.4577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27665180.9674; train_optim_loss: 27665180.9674; val_kl_reg_loss: 15951.0602; val_edge_recon_loss: 26174440.1818; val_gene_expr_recon_loss: 1926168.8795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28116560.0545; val_optim_loss: 28116560.0545
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9912; val_auprc_score: 0.9897; val_best_acc_score: 0.9586; val_best_f1_score: 0.9589; train_kl_reg_loss: 16235.6329; train_edge_recon_loss: 25722095.9267; train_gene_expr_recon_loss: 1926312.3229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27664643.8798; train_optim_loss: 27664643.8798; val_kl_reg_loss: 15944.9905; val_edge_recon_loss: 26162986.7636; val_gene_expr_recon_loss: 1927964.5364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28106896.2000; val_optim_loss: 28106896.2000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9908; val_auprc_score: 0.9890; val_best_acc_score: 0.9579; val_best_f1_score: 0.9582; train_kl_reg_loss: 16237.3301; train_edge_recon_loss: 25717947.9572; train_gene_expr_recon_loss: 1926302.3910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27660487.6640; train_optim_loss: 27660487.6640; val_kl_reg_loss: 15945.2993; val_edge_recon_loss: 26186914.4545; val_gene_expr_recon_loss: 1929861.0784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28132720.8000; val_optim_loss: 28132720.8000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9911; val_auprc_score: 0.9895; val_best_acc_score: 0.9585; val_best_f1_score: 0.9587; train_kl_reg_loss: 16222.6809; train_edge_recon_loss: 25720902.8045; train_gene_expr_recon_loss: 1926311.0479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27663436.5214; train_optim_loss: 27663436.5214; val_kl_reg_loss: 15939.5106; val_edge_recon_loss: 26167848.4727; val_gene_expr_recon_loss: 1927288.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28111076.8909; val_optim_loss: 28111076.8909

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9909; val_auprc_score: 0.9894; val_best_acc_score: 0.9586; val_best_f1_score: 0.9588; train_kl_reg_loss: 16228.1713; train_edge_recon_loss: 25717861.6721; train_gene_expr_recon_loss: 1926664.1081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27660753.9532; train_optim_loss: 27660753.9532; val_kl_reg_loss: 15931.1258; val_edge_recon_loss: 26160934.0727; val_gene_expr_recon_loss: 1927646.5750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28104511.8182; val_optim_loss: 28104511.8182
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9906; val_auprc_score: 0.9885; val_best_acc_score: 0.9575; val_best_f1_score: 0.9578; train_kl_reg_loss: 16226.2143; train_edge_recon_loss: 25720902.5519; train_gene_expr_recon_loss: 1926400.9297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27663529.6660; train_optim_loss: 27663529.6660; val_kl_reg_loss: 15931.0875; val_edge_recon_loss: 26206694.1636; val_gene_expr_recon_loss: 1928567.0034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28151192.2182; val_optim_loss: 28151192.2182
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9914; val_auprc_score: 0.9901; val_best_acc_score: 0.9588; val_best_f1_score: 0.9591; train_kl_reg_loss: 16226.3344; train_edge_recon_loss: 25721159.3035; train_gene_expr_recon_loss: 1925884.8012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27663270.4684; train_optim_loss: 27663270.4684; val_kl_reg_loss: 15936.3136; val_edge_recon_loss: 26165203.5273; val_gene_expr_recon_loss: 1928881.0125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28110020.8545; val_optim_loss: 28110020.8545
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9908; val_auprc_score: 0.9893; val_best_acc_score: 0.9575; val_best_f1_score: 0.9580; train_kl_reg_loss: 16226.9907; train_edge_recon_loss: 25718214.3320; train_gene_expr_recon_loss: 1926836.7627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27661278.1202; train_optim_loss: 27661278.1202; val_kl_reg_loss: 15935.4300; val_edge_recon_loss: 26198659.4909; val_gene_expr_recon_loss: 1927698.0864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28142293.0364; val_optim_loss: 28142293.0364

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 123 min 1 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
Val AUROC score: 0.9906
Val AUPRC score: 0.9890
Val best accuracy score: 0.9578
Val best F1 score: 0.9580
Val gene expr MSE score: 8.2227

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
