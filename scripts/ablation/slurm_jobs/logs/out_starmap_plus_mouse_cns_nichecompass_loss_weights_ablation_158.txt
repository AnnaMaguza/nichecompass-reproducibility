None
Run timestamp: 15072023_110313_158.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_158']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9769; val_auprc_score: 0.9692; val_best_acc_score: 0.9349; val_best_f1_score: 0.9368; train_kl_reg_loss: 87813.4815; train_edge_recon_loss: 27383875.3967; train_gene_expr_recon_loss: 12102933.9810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39574622.8804; train_optim_loss: 39574622.8804; val_kl_reg_loss: 97021.6572; val_edge_recon_loss: 26340771.9512; val_gene_expr_recon_loss: 10964940.2439; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37402733.7561; val_optim_loss: 37402733.7561
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9802; val_auprc_score: 0.9731; val_best_acc_score: 0.9439; val_best_f1_score: 0.9454; train_kl_reg_loss: 112215.3588; train_edge_recon_loss: 26126448.5598; train_gene_expr_recon_loss: 10722532.3478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36961196.2609; train_optim_loss: 36961196.2609; val_kl_reg_loss: 111727.6233; val_edge_recon_loss: 26136318.4390; val_gene_expr_recon_loss: 10508614.3902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36756660.4878; val_optim_loss: 36756660.4878
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9810; val_auprc_score: 0.9743; val_best_acc_score: 0.9457; val_best_f1_score: 0.9472; train_kl_reg_loss: 109047.9868; train_edge_recon_loss: 25997255.8967; train_gene_expr_recon_loss: 10386983.2935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36493287.1413; train_optim_loss: 36493287.1413; val_kl_reg_loss: 103399.8190; val_edge_recon_loss: 26100691.3171; val_gene_expr_recon_loss: 10264035.5610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36468126.9268; val_optim_loss: 36468126.9268
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9833; val_auprc_score: 0.9776; val_best_acc_score: 0.9490; val_best_f1_score: 0.9503; train_kl_reg_loss: 101004.7485; train_edge_recon_loss: 25935382.6413; train_gene_expr_recon_loss: 10185124.0299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36221511.3370; train_optim_loss: 36221511.3370; val_kl_reg_loss: 95207.4731; val_edge_recon_loss: 26074869.0244; val_gene_expr_recon_loss: 10082087.2195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36252164.0976; val_optim_loss: 36252164.0976
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9842; val_auprc_score: 0.9788; val_best_acc_score: 0.9518; val_best_f1_score: 0.9529; train_kl_reg_loss: 92914.6790; train_edge_recon_loss: 25906235.7228; train_gene_expr_recon_loss: 10040741.6902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36039892.1413; train_optim_loss: 36039892.1413; val_kl_reg_loss: 87376.0941; val_edge_recon_loss: 26002229.2683; val_gene_expr_recon_loss: 9993615.8780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36083221.0732; val_optim_loss: 36083221.0732
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9853; val_auprc_score: 0.9800; val_best_acc_score: 0.9570; val_best_f1_score: 0.9581; train_kl_reg_loss: 86175.5004; train_edge_recon_loss: 25857035.0924; train_gene_expr_recon_loss: 9926420.2283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35869630.7826; train_optim_loss: 35869630.7826; val_kl_reg_loss: 82256.4003; val_edge_recon_loss: 25937513.8049; val_gene_expr_recon_loss: 9897864.1951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35917634.2439; val_optim_loss: 35917634.2439
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9860; val_auprc_score: 0.9807; val_best_acc_score: 0.9581; val_best_f1_score: 0.9591; train_kl_reg_loss: 81938.9338; train_edge_recon_loss: 25809959.2283; train_gene_expr_recon_loss: 9841051.1141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35732949.2500; train_optim_loss: 35732949.2500; val_kl_reg_loss: 80029.6446; val_edge_recon_loss: 25850460.8293; val_gene_expr_recon_loss: 9821189.1463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35751679.7073; val_optim_loss: 35751679.7073
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9872; val_auprc_score: 0.9821; val_best_acc_score: 0.9608; val_best_f1_score: 0.9617; train_kl_reg_loss: 79291.3908; train_edge_recon_loss: 25768102.0978; train_gene_expr_recon_loss: 9766267.9022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35613661.3478; train_optim_loss: 35613661.3478; val_kl_reg_loss: 77252.3098; val_edge_recon_loss: 25844791.3171; val_gene_expr_recon_loss: 9756423.8293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35678467.6098; val_optim_loss: 35678467.6098
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9873; val_auprc_score: 0.9829; val_best_acc_score: 0.9611; val_best_f1_score: 0.9620; train_kl_reg_loss: 77426.8877; train_edge_recon_loss: 25744800.4565; train_gene_expr_recon_loss: 9705648.7147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35527876.0435; train_optim_loss: 35527876.0435; val_kl_reg_loss: 74930.9676; val_edge_recon_loss: 25815690.7317; val_gene_expr_recon_loss: 9705403.7073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35596025.2683; val_optim_loss: 35596025.2683
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9884; val_auprc_score: 0.9848; val_best_acc_score: 0.9616; val_best_f1_score: 0.9625; train_kl_reg_loss: 74136.4022; train_edge_recon_loss: 25724190.2283; train_gene_expr_recon_loss: 9655705.8832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35454032.5000; train_optim_loss: 35454032.5000; val_kl_reg_loss: 70992.0293; val_edge_recon_loss: 25829887.9512; val_gene_expr_recon_loss: 9703294.3415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35604174.2439; val_optim_loss: 35604174.2439
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9876; val_auprc_score: 0.9831; val_best_acc_score: 0.9620; val_best_f1_score: 0.9630; train_kl_reg_loss: 71999.9714; train_edge_recon_loss: 25706136.8152; train_gene_expr_recon_loss: 9610703.9212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35388840.8370; train_optim_loss: 35388840.8370; val_kl_reg_loss: 68546.7929; val_edge_recon_loss: 25799770.9756; val_gene_expr_recon_loss: 9623856.3659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35492174.0488; val_optim_loss: 35492174.0488
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9891; val_auprc_score: 0.9855; val_best_acc_score: 0.9633; val_best_f1_score: 0.9641; train_kl_reg_loss: 69745.2103; train_edge_recon_loss: 25704410.2011; train_gene_expr_recon_loss: 9572591.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35346746.6196; train_optim_loss: 35346746.6196; val_kl_reg_loss: 68158.3714; val_edge_recon_loss: 25776419.1707; val_gene_expr_recon_loss: 9657213.9512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35501791.3171; val_optim_loss: 35501791.3171
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9889; val_auprc_score: 0.9848; val_best_acc_score: 0.9653; val_best_f1_score: 0.9661; train_kl_reg_loss: 68373.9359; train_edge_recon_loss: 25669833.6413; train_gene_expr_recon_loss: 9543014.3071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35281221.9022; train_optim_loss: 35281221.9022; val_kl_reg_loss: 65738.8637; val_edge_recon_loss: 25738842.6829; val_gene_expr_recon_loss: 9613917.2927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35418498.6341; val_optim_loss: 35418498.6341
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9894; val_auprc_score: 0.9856; val_best_acc_score: 0.9653; val_best_f1_score: 0.9661; train_kl_reg_loss: 66231.3867; train_edge_recon_loss: 25672270.0272; train_gene_expr_recon_loss: 9504121.8261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35242623.2174; train_optim_loss: 35242623.2174; val_kl_reg_loss: 63054.1574; val_edge_recon_loss: 25759873.5122; val_gene_expr_recon_loss: 9599491.0976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35422418.6341; val_optim_loss: 35422418.6341
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9896; val_auprc_score: 0.9862; val_best_acc_score: 0.9655; val_best_f1_score: 0.9661; train_kl_reg_loss: 65564.9198; train_edge_recon_loss: 25655229.1739; train_gene_expr_recon_loss: 9481125.7908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35201919.9674; train_optim_loss: 35201919.9674; val_kl_reg_loss: 63114.4587; val_edge_recon_loss: 25744748.8293; val_gene_expr_recon_loss: 9586678.0732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35394541.4634; val_optim_loss: 35394541.4634
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9894; val_auprc_score: 0.9857; val_best_acc_score: 0.9655; val_best_f1_score: 0.9662; train_kl_reg_loss: 64073.7599; train_edge_recon_loss: 25651402.3424; train_gene_expr_recon_loss: 9456178.3723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35171654.4783; train_optim_loss: 35171654.4783; val_kl_reg_loss: 62752.7215; val_edge_recon_loss: 25728960.3415; val_gene_expr_recon_loss: 9543231.3171; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35334944.1951; val_optim_loss: 35334944.1951
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9904; val_auprc_score: 0.9874; val_best_acc_score: 0.9677; val_best_f1_score: 0.9683; train_kl_reg_loss: 62804.6571; train_edge_recon_loss: 25640286.6304; train_gene_expr_recon_loss: 9418120.0598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35121211.1413; train_optim_loss: 35121211.1413; val_kl_reg_loss: 60138.6766; val_edge_recon_loss: 25697269.2195; val_gene_expr_recon_loss: 9539716.6585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35297124.4878; val_optim_loss: 35297124.4878
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9910; val_auprc_score: 0.9882; val_best_acc_score: 0.9697; val_best_f1_score: 0.9703; train_kl_reg_loss: 61743.0193; train_edge_recon_loss: 25638348.6304; train_gene_expr_recon_loss: 9396780.2636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35096871.8261; train_optim_loss: 35096871.8261; val_kl_reg_loss: 60341.3242; val_edge_recon_loss: 25657533.9512; val_gene_expr_recon_loss: 9559178.4146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35277053.6585; val_optim_loss: 35277053.6585
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9908; val_auprc_score: 0.9878; val_best_acc_score: 0.9677; val_best_f1_score: 0.9683; train_kl_reg_loss: 60994.3748; train_edge_recon_loss: 25641969.1141; train_gene_expr_recon_loss: 9377075.1929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35080038.7826; train_optim_loss: 35080038.7826; val_kl_reg_loss: 60607.9767; val_edge_recon_loss: 25709534.5366; val_gene_expr_recon_loss: 9548721.3902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35318863.9024; val_optim_loss: 35318863.9024
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9914; val_auprc_score: 0.9883; val_best_acc_score: 0.9697; val_best_f1_score: 0.9702; train_kl_reg_loss: 59926.3243; train_edge_recon_loss: 25626651.7337; train_gene_expr_recon_loss: 9345778.4674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35032356.4674; train_optim_loss: 35032356.4674; val_kl_reg_loss: 59240.5580; val_edge_recon_loss: 25677143.3171; val_gene_expr_recon_loss: 9519131.7561; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35255515.4146; val_optim_loss: 35255515.4146
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9912; val_auprc_score: 0.9882; val_best_acc_score: 0.9703; val_best_f1_score: 0.9708; train_kl_reg_loss: 59613.5604; train_edge_recon_loss: 25604787.1196; train_gene_expr_recon_loss: 9329460.2038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34993860.9783; train_optim_loss: 34993860.9783; val_kl_reg_loss: 58205.0609; val_edge_recon_loss: 25677411.1220; val_gene_expr_recon_loss: 9509985.5854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35245601.6585; val_optim_loss: 35245601.6585
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9911; val_auprc_score: 0.9879; val_best_acc_score: 0.9692; val_best_f1_score: 0.9697; train_kl_reg_loss: 58810.6671; train_edge_recon_loss: 25608016.3967; train_gene_expr_recon_loss: 9308901.9321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34975728.9348; train_optim_loss: 34975728.9348; val_kl_reg_loss: 58771.2480; val_edge_recon_loss: 25700699.1220; val_gene_expr_recon_loss: 9529569.1463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35289039.6098; val_optim_loss: 35289039.6098
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9911; val_auprc_score: 0.9878; val_best_acc_score: 0.9701; val_best_f1_score: 0.9706; train_kl_reg_loss: 58602.1583; train_edge_recon_loss: 25598390.6087; train_gene_expr_recon_loss: 9287477.9239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34944470.7500; train_optim_loss: 34944470.7500; val_kl_reg_loss: 57703.4909; val_edge_recon_loss: 25677685.8049; val_gene_expr_recon_loss: 9530297.9268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35265687.6098; val_optim_loss: 35265687.6098
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9914; val_auprc_score: 0.9885; val_best_acc_score: 0.9705; val_best_f1_score: 0.9711; train_kl_reg_loss: 58032.0832; train_edge_recon_loss: 25593472.0707; train_gene_expr_recon_loss: 9271007.0326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34922511.2391; train_optim_loss: 34922511.2391; val_kl_reg_loss: 57407.8367; val_edge_recon_loss: 25645901.1707; val_gene_expr_recon_loss: 9504697.9024; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35208006.9268; val_optim_loss: 35208006.9268
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9918; val_auprc_score: 0.9892; val_best_acc_score: 0.9709; val_best_f1_score: 0.9714; train_kl_reg_loss: 57194.0273; train_edge_recon_loss: 25604048.0217; train_gene_expr_recon_loss: 9252175.3397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34913417.3696; train_optim_loss: 34913417.3696; val_kl_reg_loss: 56327.1945; val_edge_recon_loss: 25676041.0244; val_gene_expr_recon_loss: 9506893.9268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35239262.0488; val_optim_loss: 35239262.0488
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9915; val_auprc_score: 0.9884; val_best_acc_score: 0.9711; val_best_f1_score: 0.9716; train_kl_reg_loss: 57091.7695; train_edge_recon_loss: 25595021.8315; train_gene_expr_recon_loss: 9240064.0190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34892177.6522; train_optim_loss: 34892177.6522; val_kl_reg_loss: 55577.0377; val_edge_recon_loss: 25681528.5854; val_gene_expr_recon_loss: 9509524.4390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35246629.8537; val_optim_loss: 35246629.8537
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9923; val_auprc_score: 0.9898; val_best_acc_score: 0.9716; val_best_f1_score: 0.9722; train_kl_reg_loss: 56938.6308; train_edge_recon_loss: 25594483.3641; train_gene_expr_recon_loss: 9220836.1495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34872258.2391; train_optim_loss: 34872258.2391; val_kl_reg_loss: 55195.3591; val_edge_recon_loss: 25641870.0000; val_gene_expr_recon_loss: 9501842.0488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35198907.3171; val_optim_loss: 35198907.3171
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9920; val_auprc_score: 0.9894; val_best_acc_score: 0.9714; val_best_f1_score: 0.9719; train_kl_reg_loss: 56294.9298; train_edge_recon_loss: 25590548.2663; train_gene_expr_recon_loss: 9208349.6440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34855192.8370; train_optim_loss: 34855192.8370; val_kl_reg_loss: 55185.7977; val_edge_recon_loss: 25690814.0488; val_gene_expr_recon_loss: 9522012.8049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35268012.8780; val_optim_loss: 35268012.8780
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9916; val_auprc_score: 0.9885; val_best_acc_score: 0.9721; val_best_f1_score: 0.9726; train_kl_reg_loss: 56172.9270; train_edge_recon_loss: 25586976.5761; train_gene_expr_recon_loss: 9192998.2418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34836147.7717; train_optim_loss: 34836147.7717; val_kl_reg_loss: 56164.0436; val_edge_recon_loss: 25670441.7561; val_gene_expr_recon_loss: 9507857.2195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35234462.9268; val_optim_loss: 35234462.9268
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9921; val_auprc_score: 0.9891; val_best_acc_score: 0.9724; val_best_f1_score: 0.9729; train_kl_reg_loss: 55668.7970; train_edge_recon_loss: 25584770.2554; train_gene_expr_recon_loss: 9179652.6087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34820091.6522; train_optim_loss: 34820091.6522; val_kl_reg_loss: 54598.8109; val_edge_recon_loss: 25641769.0732; val_gene_expr_recon_loss: 9534129.4878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35230497.6585; val_optim_loss: 35230497.6585
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9914; val_auprc_score: 0.9882; val_best_acc_score: 0.9716; val_best_f1_score: 0.9721; train_kl_reg_loss: 55689.8228; train_edge_recon_loss: 25587216.5543; train_gene_expr_recon_loss: 9166091.2826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34808997.6957; train_optim_loss: 34808997.6957; val_kl_reg_loss: 55857.7349; val_edge_recon_loss: 25673850.0488; val_gene_expr_recon_loss: 9540889.5366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35270596.6829; val_optim_loss: 35270596.6829

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9921; val_auprc_score: 0.9891; val_best_acc_score: 0.9727; val_best_f1_score: 0.9731; train_kl_reg_loss: 57928.6986; train_edge_recon_loss: 25571272.6902; train_gene_expr_recon_loss: 9085281.2391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34714482.6196; train_optim_loss: 34714482.6196; val_kl_reg_loss: 57505.5094; val_edge_recon_loss: 25646998.1463; val_gene_expr_recon_loss: 9488205.1707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35192708.9756; val_optim_loss: 35192708.9756
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9920; val_auprc_score: 0.9889; val_best_acc_score: 0.9730; val_best_f1_score: 0.9735; train_kl_reg_loss: 58952.4908; train_edge_recon_loss: 25571334.4022; train_gene_expr_recon_loss: 9074750.7432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34705037.6630; train_optim_loss: 34705037.6630; val_kl_reg_loss: 58105.9283; val_edge_recon_loss: 25618297.9512; val_gene_expr_recon_loss: 9489466.4146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35165869.8537; val_optim_loss: 35165869.8537
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9923; val_auprc_score: 0.9896; val_best_acc_score: 0.9725; val_best_f1_score: 0.9729; train_kl_reg_loss: 59249.6661; train_edge_recon_loss: 25555944.6522; train_gene_expr_recon_loss: 9068788.0489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34683982.2826; train_optim_loss: 34683982.2826; val_kl_reg_loss: 58338.2749; val_edge_recon_loss: 25648051.4634; val_gene_expr_recon_loss: 9461191.9024; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35167581.2683; val_optim_loss: 35167581.2683
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9916; val_auprc_score: 0.9888; val_best_acc_score: 0.9713; val_best_f1_score: 0.9719; train_kl_reg_loss: 59548.8561; train_edge_recon_loss: 25568769.5707; train_gene_expr_recon_loss: 9067291.7106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34695610.1957; train_optim_loss: 34695610.1957; val_kl_reg_loss: 58889.2008; val_edge_recon_loss: 25672216.9268; val_gene_expr_recon_loss: 9483660.3902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35214766.3415; val_optim_loss: 35214766.3415
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9923; val_auprc_score: 0.9899; val_best_acc_score: 0.9729; val_best_f1_score: 0.9733; train_kl_reg_loss: 59881.3827; train_edge_recon_loss: 25566937.5217; train_gene_expr_recon_loss: 9064240.5978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34691059.4891; train_optim_loss: 34691059.4891; val_kl_reg_loss: 58673.6052; val_edge_recon_loss: 25649610.1463; val_gene_expr_recon_loss: 9485137.5366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35193421.0732; val_optim_loss: 35193421.0732
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9919; val_auprc_score: 0.9891; val_best_acc_score: 0.9722; val_best_f1_score: 0.9727; train_kl_reg_loss: 60070.0851; train_edge_recon_loss: 25551337.7283; train_gene_expr_recon_loss: 9063110.6033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34674518.4239; train_optim_loss: 34674518.4239; val_kl_reg_loss: 59303.0812; val_edge_recon_loss: 25646376.8293; val_gene_expr_recon_loss: 9486889.6829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35192569.6585; val_optim_loss: 35192569.6585

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9920; val_auprc_score: 0.9894; val_best_acc_score: 0.9721; val_best_f1_score: 0.9725; train_kl_reg_loss: 60394.7929; train_edge_recon_loss: 25552142.0815; train_gene_expr_recon_loss: 9054890.3709; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34667427.2717; train_optim_loss: 34667427.2717; val_kl_reg_loss: 59356.4820; val_edge_recon_loss: 25671616.0976; val_gene_expr_recon_loss: 9483738.6829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35214711.0244; val_optim_loss: 35214711.0244
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9916; val_auprc_score: 0.9887; val_best_acc_score: 0.9719; val_best_f1_score: 0.9725; train_kl_reg_loss: 60354.6046; train_edge_recon_loss: 25563487.7065; train_gene_expr_recon_loss: 9046188.1413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34670030.5761; train_optim_loss: 34670030.5761; val_kl_reg_loss: 59308.5263; val_edge_recon_loss: 25651243.1220; val_gene_expr_recon_loss: 9457002.0244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35167553.5610; val_optim_loss: 35167553.5610
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9918; val_auprc_score: 0.9885; val_best_acc_score: 0.9722; val_best_f1_score: 0.9728; train_kl_reg_loss: 60368.9081; train_edge_recon_loss: 25561679.8261; train_gene_expr_recon_loss: 9047043.0054; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34669091.6630; train_optim_loss: 34669091.6630; val_kl_reg_loss: 59337.7016; val_edge_recon_loss: 25656990.9268; val_gene_expr_recon_loss: 9492710.9512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35209039.5122; val_optim_loss: 35209039.5122
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9916; val_auprc_score: 0.9884; val_best_acc_score: 0.9717; val_best_f1_score: 0.9723; train_kl_reg_loss: 60390.8660; train_edge_recon_loss: 25568786.8587; train_gene_expr_recon_loss: 9050764.0679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34679941.7500; train_optim_loss: 34679941.7500; val_kl_reg_loss: 59271.1257; val_edge_recon_loss: 25662350.9756; val_gene_expr_recon_loss: 9473341.8537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35194964.0000; val_optim_loss: 35194964.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 114 min 5 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
Val AUROC score: 0.9920
Val AUPRC score: 0.9888
Val best accuracy score: 0.9726
Val best F1 score: 0.9730
Val gene expr MSE score: 0.6335

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
