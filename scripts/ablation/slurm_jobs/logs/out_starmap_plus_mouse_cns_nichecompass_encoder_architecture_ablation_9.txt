None
Run timestamp: 20072023_111648_9.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '2', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '30000.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_9']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 2, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9698; val_auprc_score: 0.9611; val_best_acc_score: 0.9214; val_best_f1_score: 0.9243; train_kl_reg_loss: 109325.2872; train_edge_recon_loss: 27067011.1097; train_gene_expr_recon_loss: 11728807.4569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38905143.7755; train_optim_loss: 38905143.7755; val_kl_reg_loss: 118474.9483; val_edge_recon_loss: 26288168.5349; val_gene_expr_recon_loss: 10699637.4419; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37106280.6977; val_optim_loss: 37106280.6977
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9792; val_auprc_score: 0.9725; val_best_acc_score: 0.9413; val_best_f1_score: 0.9427; train_kl_reg_loss: 101697.4631; train_edge_recon_loss: 26040263.7520; train_gene_expr_recon_loss: 10479086.8068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36621048.0731; train_optim_loss: 36621048.0731; val_kl_reg_loss: 93161.9819; val_edge_recon_loss: 26162923.6977; val_gene_expr_recon_loss: 10342974.1047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36599059.6279; val_optim_loss: 36599059.6279
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9828; val_auprc_score: 0.9776; val_best_acc_score: 0.9477; val_best_f1_score: 0.9488; train_kl_reg_loss: 87546.9921; train_edge_recon_loss: 25866940.5901; train_gene_expr_recon_loss: 10193308.6410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36147796.2507; train_optim_loss: 36147796.2507; val_kl_reg_loss: 80172.9667; val_edge_recon_loss: 26067137.9302; val_gene_expr_recon_loss: 10116151.3837; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36263462.0465; val_optim_loss: 36263462.0465
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9848; val_auprc_score: 0.9802; val_best_acc_score: 0.9529; val_best_f1_score: 0.9542; train_kl_reg_loss: 77539.1011; train_edge_recon_loss: 25769805.6580; train_gene_expr_recon_loss: 10025400.4778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35872745.2950; train_optim_loss: 35872745.2950; val_kl_reg_loss: 70565.0740; val_edge_recon_loss: 25979793.5814; val_gene_expr_recon_loss: 9993395.0349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36043753.8140; val_optim_loss: 36043753.8140
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9862; val_auprc_score: 0.9824; val_best_acc_score: 0.9543; val_best_f1_score: 0.9552; train_kl_reg_loss: 70014.3412; train_edge_recon_loss: 25705314.8433; train_gene_expr_recon_loss: 9913811.4935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35689140.7154; train_optim_loss: 35689140.7154; val_kl_reg_loss: 67349.6668; val_edge_recon_loss: 25851111.3721; val_gene_expr_recon_loss: 9904951.7791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35823412.9767; val_optim_loss: 35823412.9767
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9867; val_auprc_score: 0.9828; val_best_acc_score: 0.9562; val_best_f1_score: 0.9570; train_kl_reg_loss: 65776.1172; train_edge_recon_loss: 25656089.4073; train_gene_expr_recon_loss: 9817770.0013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35539635.4935; train_optim_loss: 35539635.4935; val_kl_reg_loss: 64873.7307; val_edge_recon_loss: 25881845.6744; val_gene_expr_recon_loss: 9822293.1977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35769012.7442; val_optim_loss: 35769012.7442
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9879; val_auprc_score: 0.9840; val_best_acc_score: 0.9595; val_best_f1_score: 0.9602; train_kl_reg_loss: 62716.5633; train_edge_recon_loss: 25625758.6031; train_gene_expr_recon_loss: 9737088.1031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35425563.2898; train_optim_loss: 35425563.2898; val_kl_reg_loss: 60649.7448; val_edge_recon_loss: 25819319.0465; val_gene_expr_recon_loss: 9785134.8605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35665103.7674; val_optim_loss: 35665103.7674
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9886; val_auprc_score: 0.9850; val_best_acc_score: 0.9629; val_best_f1_score: 0.9637; train_kl_reg_loss: 59111.2392; train_edge_recon_loss: 25624782.4804; train_gene_expr_recon_loss: 9673073.1110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35356966.8407; train_optim_loss: 35356966.8407; val_kl_reg_loss: 56602.0932; val_edge_recon_loss: 25704030.6279; val_gene_expr_recon_loss: 9724060.7326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35484693.4419; val_optim_loss: 35484693.4419
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9882; val_auprc_score: 0.9850; val_best_acc_score: 0.9611; val_best_f1_score: 0.9619; train_kl_reg_loss: 54006.8408; train_edge_recon_loss: 25617235.9843; train_gene_expr_recon_loss: 9710590.8708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35381833.6867; train_optim_loss: 35381833.6867; val_kl_reg_loss: 51194.9843; val_edge_recon_loss: 25789096.8837; val_gene_expr_recon_loss: 9719979.5233; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35560271.6279; val_optim_loss: 35560271.6279
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9895; val_auprc_score: 0.9866; val_best_acc_score: 0.9624; val_best_f1_score: 0.9632; train_kl_reg_loss: 53610.5315; train_edge_recon_loss: 25593643.6527; train_gene_expr_recon_loss: 9591118.8003; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35238372.9347; train_optim_loss: 35238372.9347; val_kl_reg_loss: 50121.9810; val_edge_recon_loss: 25733840.1628; val_gene_expr_recon_loss: 9650789.0698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35434751.0698; val_optim_loss: 35434751.0698
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9898; val_auprc_score: 0.9871; val_best_acc_score: 0.9640; val_best_f1_score: 0.9647; train_kl_reg_loss: 52462.4473; train_edge_recon_loss: 25562352.1358; train_gene_expr_recon_loss: 9538532.4582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35153346.9661; train_optim_loss: 35153346.9661; val_kl_reg_loss: 49466.6194; val_edge_recon_loss: 25796733.9767; val_gene_expr_recon_loss: 9587081.1628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35433281.7674; val_optim_loss: 35433281.7674
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9900; val_auprc_score: 0.9869; val_best_acc_score: 0.9661; val_best_f1_score: 0.9666; train_kl_reg_loss: 51824.2851; train_edge_recon_loss: 25567602.8042; train_gene_expr_recon_loss: 9488095.5366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35107522.6423; train_optim_loss: 35107522.6423; val_kl_reg_loss: 51367.8195; val_edge_recon_loss: 25696609.3488; val_gene_expr_recon_loss: 9560469.9651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35308447.3488; val_optim_loss: 35308447.3488
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9908; val_auprc_score: 0.9885; val_best_acc_score: 0.9662; val_best_f1_score: 0.9668; train_kl_reg_loss: 50785.8293; train_edge_recon_loss: 25548539.1384; train_gene_expr_recon_loss: 9455987.1305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35055312.0836; train_optim_loss: 35055312.0836; val_kl_reg_loss: 50473.5322; val_edge_recon_loss: 25702842.2558; val_gene_expr_recon_loss: 9554358.4419; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35307674.0465; val_optim_loss: 35307674.0465
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9889; val_auprc_score: 0.9858; val_best_acc_score: 0.9653; val_best_f1_score: 0.9660; train_kl_reg_loss: 50800.2466; train_edge_recon_loss: 25525293.2219; train_gene_expr_recon_loss: 9413904.9269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34989998.3812; train_optim_loss: 34989998.3812; val_kl_reg_loss: 48541.9745; val_edge_recon_loss: 25718851.2326; val_gene_expr_recon_loss: 9521468.8488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35288862.1395; val_optim_loss: 35288862.1395
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9915; val_auprc_score: 0.9897; val_best_acc_score: 0.9669; val_best_f1_score: 0.9676; train_kl_reg_loss: 49831.8409; train_edge_recon_loss: 25550646.7232; train_gene_expr_recon_loss: 9381803.0261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34982281.6658; train_optim_loss: 34982281.6658; val_kl_reg_loss: 47201.5760; val_edge_recon_loss: 25701017.6047; val_gene_expr_recon_loss: 9508274.6279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35256493.6279; val_optim_loss: 35256493.6279
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9912; val_auprc_score: 0.9891; val_best_acc_score: 0.9690; val_best_f1_score: 0.9696; train_kl_reg_loss: 49140.4625; train_edge_recon_loss: 25532607.3055; train_gene_expr_recon_loss: 9344771.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34926519.6449; train_optim_loss: 34926519.6449; val_kl_reg_loss: 49495.7969; val_edge_recon_loss: 25650273.6977; val_gene_expr_recon_loss: 9490663.5465; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35190432.9070; val_optim_loss: 35190432.9070
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9903; val_auprc_score: 0.9874; val_best_acc_score: 0.9687; val_best_f1_score: 0.9691; train_kl_reg_loss: 49607.2760; train_edge_recon_loss: 25513581.9608; train_gene_expr_recon_loss: 9325805.2807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34888994.5744; train_optim_loss: 34888994.5744; val_kl_reg_loss: 48097.0853; val_edge_recon_loss: 25684774.6279; val_gene_expr_recon_loss: 9476078.4302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35208950.0930; val_optim_loss: 35208950.0930
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9901; val_auprc_score: 0.9878; val_best_acc_score: 0.9650; val_best_f1_score: 0.9657; train_kl_reg_loss: 49354.0916; train_edge_recon_loss: 25510110.6841; train_gene_expr_recon_loss: 9289579.2833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34849044.1384; train_optim_loss: 34849044.1384; val_kl_reg_loss: 46837.9289; val_edge_recon_loss: 25738391.4186; val_gene_expr_recon_loss: 9485719.8605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35270949.2558; val_optim_loss: 35270949.2558
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9908; val_auprc_score: 0.9882; val_best_acc_score: 0.9675; val_best_f1_score: 0.9681; train_kl_reg_loss: 48874.6778; train_edge_recon_loss: 25505347.3185; train_gene_expr_recon_loss: 9265560.3127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34819782.3029; train_optim_loss: 34819782.3029; val_kl_reg_loss: 46956.0982; val_edge_recon_loss: 25699601.9767; val_gene_expr_recon_loss: 9462990.8605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35209549.0233; val_optim_loss: 35209549.0233
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9905; val_auprc_score: 0.9883; val_best_acc_score: 0.9668; val_best_f1_score: 0.9674; train_kl_reg_loss: 48807.1792; train_edge_recon_loss: 25509736.2167; train_gene_expr_recon_loss: 9235445.6292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34793988.9504; train_optim_loss: 34793988.9504; val_kl_reg_loss: 47837.3626; val_edge_recon_loss: 25718981.2326; val_gene_expr_recon_loss: 9435850.8605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35202669.3953; val_optim_loss: 35202669.3953

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9913; val_auprc_score: 0.9896; val_best_acc_score: 0.9680; val_best_f1_score: 0.9686; train_kl_reg_loss: 52175.6660; train_edge_recon_loss: 25473787.6684; train_gene_expr_recon_loss: 9127813.7278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34653777.1462; train_optim_loss: 34653777.1462; val_kl_reg_loss: 51924.2421; val_edge_recon_loss: 25703624.4186; val_gene_expr_recon_loss: 9343254.0465; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35098802.8372; val_optim_loss: 35098802.8372
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9909; val_auprc_score: 0.9890; val_best_acc_score: 0.9680; val_best_f1_score: 0.9687; train_kl_reg_loss: 54097.1746; train_edge_recon_loss: 25486525.0444; train_gene_expr_recon_loss: 9114936.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34655558.4439; train_optim_loss: 34655558.4439; val_kl_reg_loss: 52220.0261; val_edge_recon_loss: 25730031.4884; val_gene_expr_recon_loss: 9315558.1628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35097809.6279; val_optim_loss: 35097809.6279
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9916; val_auprc_score: 0.9893; val_best_acc_score: 0.9689; val_best_f1_score: 0.9694; train_kl_reg_loss: 55028.8117; train_edge_recon_loss: 25459057.9112; train_gene_expr_recon_loss: 9098766.3388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34612853.0131; train_optim_loss: 34612853.0131; val_kl_reg_loss: 53367.2629; val_edge_recon_loss: 25613931.6512; val_gene_expr_recon_loss: 9289792.8372; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34957091.4884; val_optim_loss: 34957091.4884
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9914; val_auprc_score: 0.9892; val_best_acc_score: 0.9692; val_best_f1_score: 0.9698; train_kl_reg_loss: 55103.1733; train_edge_recon_loss: 25482397.8016; train_gene_expr_recon_loss: 9088081.3570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34625582.2872; train_optim_loss: 34625582.2872; val_kl_reg_loss: 54217.6960; val_edge_recon_loss: 25650666.5581; val_gene_expr_recon_loss: 9317916.9767; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35022801.2558; val_optim_loss: 35022801.2558
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9919; val_auprc_score: 0.9901; val_best_acc_score: 0.9697; val_best_f1_score: 0.9703; train_kl_reg_loss: 55595.8596; train_edge_recon_loss: 25474038.1070; train_gene_expr_recon_loss: 9088297.4099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34617931.3290; train_optim_loss: 34617931.3290; val_kl_reg_loss: 53903.8097; val_edge_recon_loss: 25609095.0930; val_gene_expr_recon_loss: 9297812.2558; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34960811.0698; val_optim_loss: 34960811.0698
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9917; val_auprc_score: 0.9900; val_best_acc_score: 0.9694; val_best_f1_score: 0.9699; train_kl_reg_loss: 55578.0501; train_edge_recon_loss: 25466936.5796; train_gene_expr_recon_loss: 9075650.0326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34598164.6658; train_optim_loss: 34598164.6658; val_kl_reg_loss: 52712.6835; val_edge_recon_loss: 25645562.3721; val_gene_expr_recon_loss: 9311390.3488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35009665.5814; val_optim_loss: 35009665.5814
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9917; val_auprc_score: 0.9898; val_best_acc_score: 0.9694; val_best_f1_score: 0.9699; train_kl_reg_loss: 55452.7390; train_edge_recon_loss: 25466647.4883; train_gene_expr_recon_loss: 9073378.2389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34595478.4204; train_optim_loss: 34595478.4204; val_kl_reg_loss: 54622.7307; val_edge_recon_loss: 25629395.8140; val_gene_expr_recon_loss: 9306337.8140; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34990356.6512; val_optim_loss: 34990356.6512

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9912; val_auprc_score: 0.9893; val_best_acc_score: 0.9688; val_best_f1_score: 0.9693; train_kl_reg_loss: 56323.6810; train_edge_recon_loss: 25478984.8512; train_gene_expr_recon_loss: 9063165.1345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34598473.6162; train_optim_loss: 34598473.6162; val_kl_reg_loss: 54854.9452; val_edge_recon_loss: 25699234.4651; val_gene_expr_recon_loss: 9298999.3023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35053088.8372; val_optim_loss: 35053088.8372
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9918; val_auprc_score: 0.9902; val_best_acc_score: 0.9691; val_best_f1_score: 0.9696; train_kl_reg_loss: 56164.6594; train_edge_recon_loss: 25486768.0627; train_gene_expr_recon_loss: 9059155.1416; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34602087.7546; train_optim_loss: 34602087.7546; val_kl_reg_loss: 54422.7872; val_edge_recon_loss: 25681092.4884; val_gene_expr_recon_loss: 9288319.4477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35023834.7907; val_optim_loss: 35023834.7907
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9919; val_auprc_score: 0.9901; val_best_acc_score: 0.9695; val_best_f1_score: 0.9700; train_kl_reg_loss: 56124.4040; train_edge_recon_loss: 25473656.6319; train_gene_expr_recon_loss: 9055210.2559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34584991.3211; train_optim_loss: 34584991.3211; val_kl_reg_loss: 54405.9100; val_edge_recon_loss: 25640718.4186; val_gene_expr_recon_loss: 9272963.0930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34968087.4884; val_optim_loss: 34968087.4884
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9913; val_auprc_score: 0.9896; val_best_acc_score: 0.9687; val_best_f1_score: 0.9692; train_kl_reg_loss: 56016.8229; train_edge_recon_loss: 25453436.1488; train_gene_expr_recon_loss: 9056082.4151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34565535.3655; train_optim_loss: 34565535.3655; val_kl_reg_loss: 54624.6203; val_edge_recon_loss: 25661698.2558; val_gene_expr_recon_loss: 9322107.9302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35038430.8372; val_optim_loss: 35038430.8372

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 46 min 59 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
Val AUROC score: 0.9913
Val AUPRC score: 0.9892
Val best accuracy score: 0.9692
Val best F1 score: 0.9698
Val gene expr MSE score: 0.5809

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
