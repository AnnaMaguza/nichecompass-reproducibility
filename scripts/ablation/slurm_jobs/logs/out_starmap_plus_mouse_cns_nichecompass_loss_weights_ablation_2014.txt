None
Run timestamp: 16072023_230118_2014.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_2014']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9810; val_auprc_score: 0.9747; val_best_acc_score: 0.9413; val_best_f1_score: 0.9429; train_kl_reg_loss: 87536.5272; train_edge_recon_loss: 26964541.0404; train_gene_expr_recon_loss: 11824183.0496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38876260.6912; train_optim_loss: 38876260.6912; val_kl_reg_loss: 102139.1455; val_edge_recon_loss: 26234206.8852; val_gene_expr_recon_loss: 10852713.3443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37189059.0820; val_optim_loss: 37189059.0820
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9840; val_auprc_score: 0.9782; val_best_acc_score: 0.9499; val_best_f1_score: 0.9511; train_kl_reg_loss: 103077.1192; train_edge_recon_loss: 26047304.4412; train_gene_expr_recon_loss: 10579317.0864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36729698.6029; train_optim_loss: 36729698.6029; val_kl_reg_loss: 97309.7929; val_edge_recon_loss: 26050058.2951; val_gene_expr_recon_loss: 10465615.5082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36612983.6066; val_optim_loss: 36612983.6066
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9859; val_auprc_score: 0.9812; val_best_acc_score: 0.9536; val_best_f1_score: 0.9547; train_kl_reg_loss: 93121.4590; train_edge_recon_loss: 25910093.5625; train_gene_expr_recon_loss: 10273368.3952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36276583.4853; train_optim_loss: 36276583.4853; val_kl_reg_loss: 86544.9284; val_edge_recon_loss: 25967804.3607; val_gene_expr_recon_loss: 10231758.1311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36286107.2787; val_optim_loss: 36286107.2787
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9877; val_auprc_score: 0.9836; val_best_acc_score: 0.9589; val_best_f1_score: 0.9598; train_kl_reg_loss: 86326.8619; train_edge_recon_loss: 25822389.4816; train_gene_expr_recon_loss: 10078592.0165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35987308.3824; train_optim_loss: 35987308.3824; val_kl_reg_loss: 83653.8457; val_edge_recon_loss: 25845756.2295; val_gene_expr_recon_loss: 10078979.0656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36008389.0492; val_optim_loss: 36008389.0492
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9884; val_auprc_score: 0.9847; val_best_acc_score: 0.9602; val_best_f1_score: 0.9611; train_kl_reg_loss: 81452.5721; train_edge_recon_loss: 25788549.5037; train_gene_expr_recon_loss: 9963517.5368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35833519.6324; train_optim_loss: 35833519.6324; val_kl_reg_loss: 77574.3303; val_edge_recon_loss: 25825040.5902; val_gene_expr_recon_loss: 9988848.1803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35891462.8197; val_optim_loss: 35891462.8197
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9896; val_auprc_score: 0.9859; val_best_acc_score: 0.9627; val_best_f1_score: 0.9633; train_kl_reg_loss: 75838.2989; train_edge_recon_loss: 25751027.0588; train_gene_expr_recon_loss: 9872547.4044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35699412.6471; train_optim_loss: 35699412.6471; val_kl_reg_loss: 71882.4744; val_edge_recon_loss: 25790126.5902; val_gene_expr_recon_loss: 9926594.8197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35788603.7377; val_optim_loss: 35788603.7377
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9903; val_auprc_score: 0.9867; val_best_acc_score: 0.9648; val_best_f1_score: 0.9655; train_kl_reg_loss: 71205.8852; train_edge_recon_loss: 25720271.5441; train_gene_expr_recon_loss: 9807470.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35598947.9926; train_optim_loss: 35598947.9926; val_kl_reg_loss: 68499.6488; val_edge_recon_loss: 25772108.7869; val_gene_expr_recon_loss: 9884915.2787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35725523.8033; val_optim_loss: 35725523.8033
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9911; val_auprc_score: 0.9885; val_best_acc_score: 0.9672; val_best_f1_score: 0.9677; train_kl_reg_loss: 66710.5409; train_edge_recon_loss: 25701763.7022; train_gene_expr_recon_loss: 9743689.6627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35512163.9044; train_optim_loss: 35512163.9044; val_kl_reg_loss: 63715.7435; val_edge_recon_loss: 25756401.6393; val_gene_expr_recon_loss: 9848582.9344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35668700.3934; val_optim_loss: 35668700.3934
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9916; val_auprc_score: 0.9888; val_best_acc_score: 0.9693; val_best_f1_score: 0.9698; train_kl_reg_loss: 63963.9524; train_edge_recon_loss: 25677697.9338; train_gene_expr_recon_loss: 9711718.2096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35453380.1029; train_optim_loss: 35453380.1029; val_kl_reg_loss: 58081.7854; val_edge_recon_loss: 25726465.7705; val_gene_expr_recon_loss: 9843220.0328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35627767.5410; val_optim_loss: 35627767.5410
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9917; val_auprc_score: 0.9887; val_best_acc_score: 0.9698; val_best_f1_score: 0.9703; train_kl_reg_loss: 61094.9222; train_edge_recon_loss: 25663814.2574; train_gene_expr_recon_loss: 9677294.9779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35402204.1618; train_optim_loss: 35402204.1618; val_kl_reg_loss: 61420.2073; val_edge_recon_loss: 25667806.0656; val_gene_expr_recon_loss: 9795027.2951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35524253.7705; val_optim_loss: 35524253.7705
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9919; val_auprc_score: 0.9892; val_best_acc_score: 0.9691; val_best_f1_score: 0.9697; train_kl_reg_loss: 59809.3569; train_edge_recon_loss: 25633671.8566; train_gene_expr_recon_loss: 9637946.2298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35331427.4853; train_optim_loss: 35331427.4853; val_kl_reg_loss: 59094.4136; val_edge_recon_loss: 25697226.9836; val_gene_expr_recon_loss: 9774207.9016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35530529.3115; val_optim_loss: 35530529.3115
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9927; val_auprc_score: 0.9904; val_best_acc_score: 0.9716; val_best_f1_score: 0.9720; train_kl_reg_loss: 58263.3103; train_edge_recon_loss: 25633914.6618; train_gene_expr_recon_loss: 9604751.2114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35296929.2868; train_optim_loss: 35296929.2868; val_kl_reg_loss: 56990.5951; val_edge_recon_loss: 25672636.4918; val_gene_expr_recon_loss: 9751902.1803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35481529.4426; val_optim_loss: 35481529.4426
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9932; val_auprc_score: 0.9906; val_best_acc_score: 0.9736; val_best_f1_score: 0.9739; train_kl_reg_loss: 56415.0531; train_edge_recon_loss: 25616156.0772; train_gene_expr_recon_loss: 9569579.8355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35242151.0184; train_optim_loss: 35242151.0184; val_kl_reg_loss: 55053.5214; val_edge_recon_loss: 25655868.0656; val_gene_expr_recon_loss: 9727770.8361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35438692.2623; val_optim_loss: 35438692.2623
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9932; val_auprc_score: 0.9909; val_best_acc_score: 0.9734; val_best_f1_score: 0.9738; train_kl_reg_loss: 55006.9406; train_edge_recon_loss: 25616457.0294; train_gene_expr_recon_loss: 9553012.3254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35224476.2500; train_optim_loss: 35224476.2500; val_kl_reg_loss: 54135.9861; val_edge_recon_loss: 25650188.0984; val_gene_expr_recon_loss: 9735352.6885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35439676.9836; val_optim_loss: 35439676.9836
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9932; val_auprc_score: 0.9907; val_best_acc_score: 0.9744; val_best_f1_score: 0.9749; train_kl_reg_loss: 54344.4955; train_edge_recon_loss: 25591514.2794; train_gene_expr_recon_loss: 9530929.5496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35176788.3235; train_optim_loss: 35176788.3235; val_kl_reg_loss: 52332.3032; val_edge_recon_loss: 25650498.6230; val_gene_expr_recon_loss: 9722128.8033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35424959.8689; val_optim_loss: 35424959.8689
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9934; val_auprc_score: 0.9910; val_best_acc_score: 0.9745; val_best_f1_score: 0.9749; train_kl_reg_loss: 53266.3691; train_edge_recon_loss: 25581793.8529; train_gene_expr_recon_loss: 9506914.2316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35141974.4853; train_optim_loss: 35141974.4853; val_kl_reg_loss: 51923.2436; val_edge_recon_loss: 25627694.6885; val_gene_expr_recon_loss: 9728381.7869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35407999.7377; val_optim_loss: 35407999.7377
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9935; val_auprc_score: 0.9910; val_best_acc_score: 0.9755; val_best_f1_score: 0.9758; train_kl_reg_loss: 52296.1632; train_edge_recon_loss: 25582125.0294; train_gene_expr_recon_loss: 9485457.2555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35119878.4559; train_optim_loss: 35119878.4559; val_kl_reg_loss: 51210.0181; val_edge_recon_loss: 25613608.5574; val_gene_expr_recon_loss: 9706939.5410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35371758.1639; val_optim_loss: 35371758.1639
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9937; val_auprc_score: 0.9912; val_best_acc_score: 0.9751; val_best_f1_score: 0.9756; train_kl_reg_loss: 52104.9530; train_edge_recon_loss: 25579141.1838; train_gene_expr_recon_loss: 9456424.0211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35087670.1434; train_optim_loss: 35087670.1434; val_kl_reg_loss: 50616.1615; val_edge_recon_loss: 25620350.6230; val_gene_expr_recon_loss: 9703430.5902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35374397.1148; val_optim_loss: 35374397.1148
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9941; val_auprc_score: 0.9923; val_best_acc_score: 0.9760; val_best_f1_score: 0.9763; train_kl_reg_loss: 51284.6769; train_edge_recon_loss: 25559199.5257; train_gene_expr_recon_loss: 9445419.7261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35055903.8750; train_optim_loss: 35055903.8750; val_kl_reg_loss: 50177.6435; val_edge_recon_loss: 25625429.4098; val_gene_expr_recon_loss: 9719024.4918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35394631.4754; val_optim_loss: 35394631.4754
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9940; val_auprc_score: 0.9919; val_best_acc_score: 0.9763; val_best_f1_score: 0.9766; train_kl_reg_loss: 50742.7752; train_edge_recon_loss: 25559496.6618; train_gene_expr_recon_loss: 9431321.3897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35041560.8235; train_optim_loss: 35041560.8235; val_kl_reg_loss: 49331.4618; val_edge_recon_loss: 25592055.5738; val_gene_expr_recon_loss: 9700147.4754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35341534.6230; val_optim_loss: 35341534.6230
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9941; val_auprc_score: 0.9920; val_best_acc_score: 0.9772; val_best_f1_score: 0.9776; train_kl_reg_loss: 50291.7707; train_edge_recon_loss: 25556679.5478; train_gene_expr_recon_loss: 9411927.7004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35018898.9338; train_optim_loss: 35018898.9338; val_kl_reg_loss: 50052.6810; val_edge_recon_loss: 25609656.5574; val_gene_expr_recon_loss: 9707358.8033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35367068.0000; val_optim_loss: 35367068.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9948; val_auprc_score: 0.9931; val_best_acc_score: 0.9781; val_best_f1_score: 0.9784; train_kl_reg_loss: 49676.1956; train_edge_recon_loss: 25552787.2353; train_gene_expr_recon_loss: 9395563.2206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34998026.6471; train_optim_loss: 34998026.6471; val_kl_reg_loss: 49129.6799; val_edge_recon_loss: 25596025.3115; val_gene_expr_recon_loss: 9715589.1639; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35360744.5246; val_optim_loss: 35360744.5246
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9947; val_auprc_score: 0.9930; val_best_acc_score: 0.9778; val_best_f1_score: 0.9781; train_kl_reg_loss: 49423.0374; train_edge_recon_loss: 25553659.9301; train_gene_expr_recon_loss: 9370929.1415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34974012.1250; train_optim_loss: 34974012.1250; val_kl_reg_loss: 48798.0267; val_edge_recon_loss: 25593861.3770; val_gene_expr_recon_loss: 9731283.5246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35373942.9508; val_optim_loss: 35373942.9508
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9947; val_auprc_score: 0.9930; val_best_acc_score: 0.9775; val_best_f1_score: 0.9778; train_kl_reg_loss: 48625.1477; train_edge_recon_loss: 25546396.1691; train_gene_expr_recon_loss: 9368935.0110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34963956.3824; train_optim_loss: 34963956.3824; val_kl_reg_loss: 47385.7216; val_edge_recon_loss: 25597065.2787; val_gene_expr_recon_loss: 9733340.3934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35377791.3443; val_optim_loss: 35377791.3443

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9945; val_auprc_score: 0.9925; val_best_acc_score: 0.9782; val_best_f1_score: 0.9786; train_kl_reg_loss: 50498.2841; train_edge_recon_loss: 25545473.5110; train_gene_expr_recon_loss: 9274726.7987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34870698.6765; train_optim_loss: 34870698.6765; val_kl_reg_loss: 51585.8060; val_edge_recon_loss: 25576277.5082; val_gene_expr_recon_loss: 9671450.3934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35299313.7705; val_optim_loss: 35299313.7705
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9949; val_auprc_score: 0.9933; val_best_acc_score: 0.9787; val_best_f1_score: 0.9790; train_kl_reg_loss: 52831.8111; train_edge_recon_loss: 25534859.4375; train_gene_expr_recon_loss: 9268302.2849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34855993.5588; train_optim_loss: 34855993.5588; val_kl_reg_loss: 52512.5984; val_edge_recon_loss: 25559679.3443; val_gene_expr_recon_loss: 9677008.2131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35289199.9344; val_optim_loss: 35289199.9344
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9943; val_auprc_score: 0.9924; val_best_acc_score: 0.9776; val_best_f1_score: 0.9779; train_kl_reg_loss: 53583.6070; train_edge_recon_loss: 25528139.8713; train_gene_expr_recon_loss: 9260047.4127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34841770.8971; train_optim_loss: 34841770.8971; val_kl_reg_loss: 53208.3699; val_edge_recon_loss: 25570473.8361; val_gene_expr_recon_loss: 9685217.2295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35308899.8033; val_optim_loss: 35308899.8033
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9948; val_auprc_score: 0.9932; val_best_acc_score: 0.9784; val_best_f1_score: 0.9787; train_kl_reg_loss: 53940.1101; train_edge_recon_loss: 25525638.4706; train_gene_expr_recon_loss: 9264583.5331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34844162.0515; train_optim_loss: 34844162.0515; val_kl_reg_loss: 53553.7437; val_edge_recon_loss: 25572756.8525; val_gene_expr_recon_loss: 9701015.0328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35327325.5738; val_optim_loss: 35327325.5738
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9947; val_auprc_score: 0.9931; val_best_acc_score: 0.9783; val_best_f1_score: 0.9786; train_kl_reg_loss: 54317.0056; train_edge_recon_loss: 25525938.1875; train_gene_expr_recon_loss: 9254788.4173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34835043.5882; train_optim_loss: 34835043.5882; val_kl_reg_loss: 54154.5096; val_edge_recon_loss: 25575864.3279; val_gene_expr_recon_loss: 9698878.2951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35328896.6557; val_optim_loss: 35328896.6557
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9943; val_auprc_score: 0.9923; val_best_acc_score: 0.9779; val_best_f1_score: 0.9782; train_kl_reg_loss: 54590.2436; train_edge_recon_loss: 25527932.9743; train_gene_expr_recon_loss: 9245231.4688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34827754.7206; train_optim_loss: 34827754.7206; val_kl_reg_loss: 53749.9342; val_edge_recon_loss: 25572542.7869; val_gene_expr_recon_loss: 9694406.6557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35320699.5410; val_optim_loss: 35320699.5410

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9948; val_auprc_score: 0.9931; val_best_acc_score: 0.9782; val_best_f1_score: 0.9785; train_kl_reg_loss: 54415.5903; train_edge_recon_loss: 25527901.6765; train_gene_expr_recon_loss: 9236697.4871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34819014.8162; train_optim_loss: 34819014.8162; val_kl_reg_loss: 53929.2042; val_edge_recon_loss: 25568463.6393; val_gene_expr_recon_loss: 9658993.1967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35281385.9016; val_optim_loss: 35281385.9016
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9946; val_auprc_score: 0.9928; val_best_acc_score: 0.9777; val_best_f1_score: 0.9780; train_kl_reg_loss: 54612.3702; train_edge_recon_loss: 25528850.6875; train_gene_expr_recon_loss: 9242682.8704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34826145.9559; train_optim_loss: 34826145.9559; val_kl_reg_loss: 54065.1064; val_edge_recon_loss: 25587714.5902; val_gene_expr_recon_loss: 9684001.3607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35325780.9836; val_optim_loss: 35325780.9836
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9948; val_auprc_score: 0.9931; val_best_acc_score: 0.9783; val_best_f1_score: 0.9786; train_kl_reg_loss: 54741.5715; train_edge_recon_loss: 25521817.1434; train_gene_expr_recon_loss: 9236977.2748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34813536.0110; train_optim_loss: 34813536.0110; val_kl_reg_loss: 54275.7427; val_edge_recon_loss: 25551478.8852; val_gene_expr_recon_loss: 9674857.0164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35280611.6721; val_optim_loss: 35280611.6721
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9947; val_auprc_score: 0.9928; val_best_acc_score: 0.9789; val_best_f1_score: 0.9791; train_kl_reg_loss: 54913.1404; train_edge_recon_loss: 25524810.5809; train_gene_expr_recon_loss: 9241773.0092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34821496.8015; train_optim_loss: 34821496.8015; val_kl_reg_loss: 54297.1821; val_edge_recon_loss: 25560870.2623; val_gene_expr_recon_loss: 9674505.5902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35289673.0492; val_optim_loss: 35289673.0492
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9947; val_auprc_score: 0.9931; val_best_acc_score: 0.9778; val_best_f1_score: 0.9781; train_kl_reg_loss: 54920.5094; train_edge_recon_loss: 25525657.7978; train_gene_expr_recon_loss: 9243605.5386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34824183.8456; train_optim_loss: 34824183.8456; val_kl_reg_loss: 54248.7945; val_edge_recon_loss: 25582407.5082; val_gene_expr_recon_loss: 9679713.4590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35316369.7705; val_optim_loss: 35316369.7705
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9948; val_auprc_score: 0.9930; val_best_acc_score: 0.9785; val_best_f1_score: 0.9788; train_kl_reg_loss: 54927.5029; train_edge_recon_loss: 25534285.8125; train_gene_expr_recon_loss: 9245214.8336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34834428.1029; train_optim_loss: 34834428.1029; val_kl_reg_loss: 54340.4606; val_edge_recon_loss: 25579700.6885; val_gene_expr_recon_loss: 9678875.4590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35312916.8525; val_optim_loss: 35312916.8525
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9947; val_auprc_score: 0.9930; val_best_acc_score: 0.9775; val_best_f1_score: 0.9778; train_kl_reg_loss: 54992.2021; train_edge_recon_loss: 25526259.9338; train_gene_expr_recon_loss: 9229799.9513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34811052.0441; train_optim_loss: 34811052.0441; val_kl_reg_loss: 54465.6810; val_edge_recon_loss: 25604419.9672; val_gene_expr_recon_loss: 9704000.2459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35362885.9672; val_optim_loss: 35362885.9672

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9946; val_auprc_score: 0.9927; val_best_acc_score: 0.9784; val_best_f1_score: 0.9787; train_kl_reg_loss: 55086.6421; train_edge_recon_loss: 25525066.5221; train_gene_expr_recon_loss: 9228093.9393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34808247.1618; train_optim_loss: 34808247.1618; val_kl_reg_loss: 54525.4699; val_edge_recon_loss: 25574014.2623; val_gene_expr_recon_loss: 9686933.7377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35315472.9180; val_optim_loss: 35315472.9180
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9946; val_auprc_score: 0.9927; val_best_acc_score: 0.9779; val_best_f1_score: 0.9782; train_kl_reg_loss: 55073.0285; train_edge_recon_loss: 25527585.5772; train_gene_expr_recon_loss: 9240819.7619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34823478.3897; train_optim_loss: 34823478.3897; val_kl_reg_loss: 54532.0987; val_edge_recon_loss: 25567508.7541; val_gene_expr_recon_loss: 9697347.0164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35319387.8689; val_optim_loss: 35319387.8689
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9947; val_auprc_score: 0.9929; val_best_acc_score: 0.9781; val_best_f1_score: 0.9784; train_kl_reg_loss: 55097.4201; train_edge_recon_loss: 25527977.5515; train_gene_expr_recon_loss: 9241174.5414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34824249.4779; train_optim_loss: 34824249.4779; val_kl_reg_loss: 54570.0934; val_edge_recon_loss: 25579482.5902; val_gene_expr_recon_loss: 9676389.5246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35310442.2951; val_optim_loss: 35310442.2951
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9948; val_auprc_score: 0.9932; val_best_acc_score: 0.9781; val_best_f1_score: 0.9784; train_kl_reg_loss: 55090.1630; train_edge_recon_loss: 25524002.1581; train_gene_expr_recon_loss: 9231373.3272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34810465.7941; train_optim_loss: 34810465.7941; val_kl_reg_loss: 54492.1089; val_edge_recon_loss: 25577880.8525; val_gene_expr_recon_loss: 9664074.7869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35296447.6721; val_optim_loss: 35296447.6721

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 225 min 50 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
Val AUROC score: 0.9946
Val AUPRC score: 0.9924
Val best accuracy score: 0.9785
Val best F1 score: 0.9788
Val gene expr MSE score: 0.6223

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
