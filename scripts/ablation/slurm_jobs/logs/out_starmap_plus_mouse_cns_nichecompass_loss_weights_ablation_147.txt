None
Run timestamp: 15072023_072409_147.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_147']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9831; val_auprc_score: 0.9776; val_best_acc_score: 0.9459; val_best_f1_score: 0.9473; train_kl_reg_loss: 29397.0411; train_edge_recon_loss: 2680973.2803; train_gene_expr_recon_loss: 1201568.1160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3911938.4380; train_optim_loss: 3911938.4380; val_kl_reg_loss: 27760.5582; val_edge_recon_loss: 2613917.0451; val_gene_expr_recon_loss: 1102221.5615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3743899.1639; val_optim_loss: 3743899.1639
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9876; val_auprc_score: 0.9836; val_best_acc_score: 0.9572; val_best_f1_score: 0.9582; train_kl_reg_loss: 25992.5974; train_edge_recon_loss: 2601111.7771; train_gene_expr_recon_loss: 1073790.7911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3700895.1673; train_optim_loss: 3700895.1673; val_kl_reg_loss: 24017.3304; val_edge_recon_loss: 2597077.5615; val_gene_expr_recon_loss: 1054391.0307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3675485.9262; val_optim_loss: 3675485.9262
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9889; val_auprc_score: 0.9853; val_best_acc_score: 0.9603; val_best_f1_score: 0.9612; train_kl_reg_loss: 23733.2462; train_edge_recon_loss: 2589592.9766; train_gene_expr_recon_loss: 1037325.9856; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3650652.1999; train_optim_loss: 3650652.1999; val_kl_reg_loss: 22566.6686; val_edge_recon_loss: 2591564.5328; val_gene_expr_recon_loss: 1027782.0994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3641913.2828; val_optim_loss: 3641913.2828
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9902; val_auprc_score: 0.9871; val_best_acc_score: 0.9634; val_best_f1_score: 0.9641; train_kl_reg_loss: 22113.5769; train_edge_recon_loss: 2582751.2831; train_gene_expr_recon_loss: 1016233.8516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3621098.7123; train_optim_loss: 3621098.7123; val_kl_reg_loss: 21083.7467; val_edge_recon_loss: 2586783.0082; val_gene_expr_recon_loss: 1009958.5318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3617825.2664; val_optim_loss: 3617825.2664
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9922; val_auprc_score: 0.9899; val_best_acc_score: 0.9680; val_best_f1_score: 0.9685; train_kl_reg_loss: 20788.9520; train_edge_recon_loss: 2578189.4021; train_gene_expr_recon_loss: 1003065.4557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3602043.8148; train_optim_loss: 3602043.8148; val_kl_reg_loss: 19940.0450; val_edge_recon_loss: 2581644.5123; val_gene_expr_recon_loss: 1002580.9754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3604165.5164; val_optim_loss: 3604165.5164
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9926; val_auprc_score: 0.9903; val_best_acc_score: 0.9698; val_best_f1_score: 0.9704; train_kl_reg_loss: 19850.3212; train_edge_recon_loss: 2573603.4426; train_gene_expr_recon_loss: 992197.4870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3585651.2486; train_optim_loss: 3585651.2486; val_kl_reg_loss: 19203.0639; val_edge_recon_loss: 2575621.7377; val_gene_expr_recon_loss: 993515.7254; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3588340.5205; val_optim_loss: 3588340.5205
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9930; val_auprc_score: 0.9908; val_best_acc_score: 0.9715; val_best_f1_score: 0.9720; train_kl_reg_loss: 19049.3699; train_edge_recon_loss: 2571530.5584; train_gene_expr_recon_loss: 985021.3821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3575601.3033; train_optim_loss: 3575601.3033; val_kl_reg_loss: 18577.5805; val_edge_recon_loss: 2575648.9631; val_gene_expr_recon_loss: 985923.8914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3580150.4467; val_optim_loss: 3580150.4467
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9937; val_auprc_score: 0.9919; val_best_acc_score: 0.9736; val_best_f1_score: 0.9740; train_kl_reg_loss: 18420.3920; train_edge_recon_loss: 2568716.6976; train_gene_expr_recon_loss: 978759.0934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3565896.1889; train_optim_loss: 3565896.1889; val_kl_reg_loss: 17764.5965; val_edge_recon_loss: 2574453.0451; val_gene_expr_recon_loss: 985206.4057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3577424.0492; val_optim_loss: 3577424.0492
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9942; val_auprc_score: 0.9925; val_best_acc_score: 0.9756; val_best_f1_score: 0.9759; train_kl_reg_loss: 17918.8384; train_edge_recon_loss: 2567316.1650; train_gene_expr_recon_loss: 973064.0750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3558299.0804; train_optim_loss: 3558299.0804; val_kl_reg_loss: 17536.8895; val_edge_recon_loss: 2570305.2623; val_gene_expr_recon_loss: 979973.6619; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3567815.8238; val_optim_loss: 3567815.8238
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9945; val_auprc_score: 0.9929; val_best_acc_score: 0.9754; val_best_f1_score: 0.9758; train_kl_reg_loss: 17466.9225; train_edge_recon_loss: 2566083.0832; train_gene_expr_recon_loss: 970714.6796; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3554264.6866; train_optim_loss: 3554264.6866; val_kl_reg_loss: 16992.7094; val_edge_recon_loss: 2571509.6721; val_gene_expr_recon_loss: 978391.1076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3566893.4754; val_optim_loss: 3566893.4754
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9949; val_auprc_score: 0.9934; val_best_acc_score: 0.9766; val_best_f1_score: 0.9769; train_kl_reg_loss: 17092.1390; train_edge_recon_loss: 2564185.3415; train_gene_expr_recon_loss: 965911.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3547188.6801; train_optim_loss: 3547188.6801; val_kl_reg_loss: 16497.3479; val_edge_recon_loss: 2568563.0533; val_gene_expr_recon_loss: 975489.7602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3560550.1803; val_optim_loss: 3560550.1803
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9953; val_auprc_score: 0.9941; val_best_acc_score: 0.9769; val_best_f1_score: 0.9771; train_kl_reg_loss: 16728.3056; train_edge_recon_loss: 2563456.3028; train_gene_expr_recon_loss: 963714.8514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3543899.4655; train_optim_loss: 3543899.4655; val_kl_reg_loss: 16099.5124; val_edge_recon_loss: 2568537.6148; val_gene_expr_recon_loss: 976215.7623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3560852.8852; val_optim_loss: 3560852.8852
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9954; val_auprc_score: 0.9940; val_best_acc_score: 0.9783; val_best_f1_score: 0.9787; train_kl_reg_loss: 16379.2921; train_edge_recon_loss: 2562222.0970; train_gene_expr_recon_loss: 961060.8146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3539662.1976; train_optim_loss: 3539662.1976; val_kl_reg_loss: 16229.1660; val_edge_recon_loss: 2563903.4098; val_gene_expr_recon_loss: 973695.1803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3553827.7664; val_optim_loss: 3553827.7664
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9954; val_auprc_score: 0.9939; val_best_acc_score: 0.9788; val_best_f1_score: 0.9791; train_kl_reg_loss: 16178.0536; train_edge_recon_loss: 2561264.1811; train_gene_expr_recon_loss: 957387.0842; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3534829.3272; train_optim_loss: 3534829.3272; val_kl_reg_loss: 16037.2050; val_edge_recon_loss: 2563078.6803; val_gene_expr_recon_loss: 973087.2592; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3552203.1557; val_optim_loss: 3552203.1557
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9954; val_auprc_score: 0.9939; val_best_acc_score: 0.9794; val_best_f1_score: 0.9797; train_kl_reg_loss: 15951.0295; train_edge_recon_loss: 2560246.4058; train_gene_expr_recon_loss: 955054.7297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3531252.1664; train_optim_loss: 3531252.1664; val_kl_reg_loss: 15599.6641; val_edge_recon_loss: 2563489.6189; val_gene_expr_recon_loss: 971371.2100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3550460.4959; val_optim_loss: 3550460.4959
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9957; val_auprc_score: 0.9943; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 15779.6765; train_edge_recon_loss: 2558524.5620; train_gene_expr_recon_loss: 953279.3840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3527583.6209; train_optim_loss: 3527583.6209; val_kl_reg_loss: 15634.8887; val_edge_recon_loss: 2563279.8197; val_gene_expr_recon_loss: 971725.9600; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3550640.6680; val_optim_loss: 3550640.6680
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9959; val_auprc_score: 0.9944; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 15603.1678; train_edge_recon_loss: 2558654.6296; train_gene_expr_recon_loss: 951143.9229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3525401.7266; train_optim_loss: 3525401.7266; val_kl_reg_loss: 15179.8998; val_edge_recon_loss: 2560445.8566; val_gene_expr_recon_loss: 972851.2234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3548476.9754; val_optim_loss: 3548476.9754
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9957; val_auprc_score: 0.9945; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 15479.4341; train_edge_recon_loss: 2558024.2197; train_gene_expr_recon_loss: 949094.6384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3522598.2840; train_optim_loss: 3522598.2840; val_kl_reg_loss: 15242.8284; val_edge_recon_loss: 2561037.5246; val_gene_expr_recon_loss: 974855.3422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3551135.6926; val_optim_loss: 3551135.6926
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9960; val_auprc_score: 0.9946; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 15380.2161; train_edge_recon_loss: 2556384.1507; train_gene_expr_recon_loss: 945997.4677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3517761.8336; train_optim_loss: 3517761.8336; val_kl_reg_loss: 15259.0109; val_edge_recon_loss: 2561632.6803; val_gene_expr_recon_loss: 967785.1762; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3544676.8689; val_optim_loss: 3544676.8689
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9963; val_auprc_score: 0.9950; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 15273.4876; train_edge_recon_loss: 2556838.4131; train_gene_expr_recon_loss: 944676.2904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3516788.1916; train_optim_loss: 3516788.1916; val_kl_reg_loss: 15079.6573; val_edge_recon_loss: 2561873.1639; val_gene_expr_recon_loss: 973109.0297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3550061.8320; val_optim_loss: 3550061.8320
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9961; val_auprc_score: 0.9946; val_best_acc_score: 0.9821; val_best_f1_score: 0.9823; train_kl_reg_loss: 15184.1666; train_edge_recon_loss: 2555909.2059; train_gene_expr_recon_loss: 942862.4956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3513955.8695; train_optim_loss: 3513955.8695; val_kl_reg_loss: 15194.0614; val_edge_recon_loss: 2558295.3566; val_gene_expr_recon_loss: 965455.3576; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3538944.7664; val_optim_loss: 3538944.7664
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9967; val_auprc_score: 0.9956; val_best_acc_score: 0.9826; val_best_f1_score: 0.9828; train_kl_reg_loss: 15118.0810; train_edge_recon_loss: 2554647.1420; train_gene_expr_recon_loss: 940773.5227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3510538.7381; train_optim_loss: 3510538.7381; val_kl_reg_loss: 15009.5535; val_edge_recon_loss: 2559902.0205; val_gene_expr_recon_loss: 969687.3361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3544598.9221; val_optim_loss: 3544598.9221
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9965; val_auprc_score: 0.9955; val_best_acc_score: 0.9817; val_best_f1_score: 0.9819; train_kl_reg_loss: 15005.7026; train_edge_recon_loss: 2555268.5216; train_gene_expr_recon_loss: 938595.1237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3508869.3506; train_optim_loss: 3508869.3506; val_kl_reg_loss: 14786.3195; val_edge_recon_loss: 2560741.7254; val_gene_expr_recon_loss: 973316.0830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3548844.1107; val_optim_loss: 3548844.1107
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9964; val_auprc_score: 0.9953; val_best_acc_score: 0.9831; val_best_f1_score: 0.9833; train_kl_reg_loss: 14941.3445; train_edge_recon_loss: 2554327.1512; train_gene_expr_recon_loss: 933305.2649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3502573.7615; train_optim_loss: 3502573.7615; val_kl_reg_loss: 14678.4374; val_edge_recon_loss: 2557862.6311; val_gene_expr_recon_loss: 957810.4826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3530351.5246; val_optim_loss: 3530351.5246
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9966; val_auprc_score: 0.9951; val_best_acc_score: 0.9834; val_best_f1_score: 0.9836; train_kl_reg_loss: 14914.3326; train_edge_recon_loss: 2554042.1080; train_gene_expr_recon_loss: 927745.7945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3496702.2390; train_optim_loss: 3496702.2390; val_kl_reg_loss: 15056.8931; val_edge_recon_loss: 2555509.2541; val_gene_expr_recon_loss: 967577.0113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3538143.1475; val_optim_loss: 3538143.1475
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9968; val_auprc_score: 0.9957; val_best_acc_score: 0.9834; val_best_f1_score: 0.9836; train_kl_reg_loss: 14875.0198; train_edge_recon_loss: 2553917.6829; train_gene_expr_recon_loss: 920692.9948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3489485.6976; train_optim_loss: 3489485.6976; val_kl_reg_loss: 14955.6991; val_edge_recon_loss: 2558209.1475; val_gene_expr_recon_loss: 942818.5686; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3515983.4098; val_optim_loss: 3515983.4098
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9965; val_auprc_score: 0.9955; val_best_acc_score: 0.9822; val_best_f1_score: 0.9824; train_kl_reg_loss: 14844.8099; train_edge_recon_loss: 2553995.6650; train_gene_expr_recon_loss: 913219.2463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3482059.7252; train_optim_loss: 3482059.7252; val_kl_reg_loss: 14700.5906; val_edge_recon_loss: 2558984.0000; val_gene_expr_recon_loss: 937172.5861; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3510857.1844; val_optim_loss: 3510857.1844
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9967; val_auprc_score: 0.9959; val_best_acc_score: 0.9834; val_best_f1_score: 0.9836; train_kl_reg_loss: 14779.6283; train_edge_recon_loss: 2553373.6388; train_gene_expr_recon_loss: 902939.5570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3471092.8235; train_optim_loss: 3471092.8235; val_kl_reg_loss: 14625.4841; val_edge_recon_loss: 2555385.0205; val_gene_expr_recon_loss: 944666.4652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3514676.9713; val_optim_loss: 3514676.9713
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9968; val_auprc_score: 0.9960; val_best_acc_score: 0.9835; val_best_f1_score: 0.9836; train_kl_reg_loss: 14718.0237; train_edge_recon_loss: 2552895.0018; train_gene_expr_recon_loss: 894954.0796; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3462567.1066; train_optim_loss: 3462567.1066; val_kl_reg_loss: 14572.7177; val_edge_recon_loss: 2557982.3525; val_gene_expr_recon_loss: 993284.0102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3565839.0902; val_optim_loss: 3565839.0902
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9970; val_auprc_score: 0.9961; val_best_acc_score: 0.9840; val_best_f1_score: 0.9841; train_kl_reg_loss: 14745.4592; train_edge_recon_loss: 2552461.0216; train_gene_expr_recon_loss: 888141.0060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3455347.4807; train_optim_loss: 3455347.4807; val_kl_reg_loss: 14615.5286; val_edge_recon_loss: 2556394.2951; val_gene_expr_recon_loss: 934745.7398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3505755.5615; val_optim_loss: 3505755.5615
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9966; val_auprc_score: 0.9955; val_best_acc_score: 0.9834; val_best_f1_score: 0.9836; train_kl_reg_loss: 14703.1059; train_edge_recon_loss: 2551913.3410; train_gene_expr_recon_loss: 874034.4576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3440650.9058; train_optim_loss: 3440650.9058; val_kl_reg_loss: 14498.2553; val_edge_recon_loss: 2556894.7254; val_gene_expr_recon_loss: 931566.0717; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3502959.0492; val_optim_loss: 3502959.0492
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9971; val_auprc_score: 0.9964; val_best_acc_score: 0.9839; val_best_f1_score: 0.9840; train_kl_reg_loss: 14672.0122; train_edge_recon_loss: 2552287.0960; train_gene_expr_recon_loss: 867776.2964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3434735.4062; train_optim_loss: 3434735.4062; val_kl_reg_loss: 14516.1833; val_edge_recon_loss: 2556528.0984; val_gene_expr_recon_loss: 891916.1414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3462960.4344; val_optim_loss: 3462960.4344
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9969; val_auprc_score: 0.9958; val_best_acc_score: 0.9836; val_best_f1_score: 0.9837; train_kl_reg_loss: 14665.9497; train_edge_recon_loss: 2552453.3157; train_gene_expr_recon_loss: 843844.3215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3410963.5781; train_optim_loss: 3410963.5781; val_kl_reg_loss: 14396.2593; val_edge_recon_loss: 2556303.1148; val_gene_expr_recon_loss: 836144.9406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3406844.3074; val_optim_loss: 3406844.3074
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9970; val_auprc_score: 0.9962; val_best_acc_score: 0.9840; val_best_f1_score: 0.9842; train_kl_reg_loss: 14646.2668; train_edge_recon_loss: 2551641.1912; train_gene_expr_recon_loss: 827374.6965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3393662.1604; train_optim_loss: 3393662.1604; val_kl_reg_loss: 14652.8572; val_edge_recon_loss: 2554245.2336; val_gene_expr_recon_loss: 842423.8699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3411321.9549; val_optim_loss: 3411321.9549
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9970; val_auprc_score: 0.9962; val_best_acc_score: 0.9843; val_best_f1_score: 0.9845; train_kl_reg_loss: 14575.8316; train_edge_recon_loss: 2551226.5354; train_gene_expr_recon_loss: 812168.8818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3377971.2482; train_optim_loss: 3377971.2482; val_kl_reg_loss: 14392.5719; val_edge_recon_loss: 2554755.0451; val_gene_expr_recon_loss: 781641.7695; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3350789.3689; val_optim_loss: 3350789.3689
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9972; val_auprc_score: 0.9963; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 14601.2966; train_edge_recon_loss: 2551229.6687; train_gene_expr_recon_loss: 790867.5770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3356698.5446; train_optim_loss: 3356698.5446; val_kl_reg_loss: 14523.3498; val_edge_recon_loss: 2553369.8893; val_gene_expr_recon_loss: 912992.6291; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3480885.8648; val_optim_loss: 3480885.8648
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9970; val_auprc_score: 0.9961; val_best_acc_score: 0.9848; val_best_f1_score: 0.9849; train_kl_reg_loss: 14589.7299; train_edge_recon_loss: 2551634.7468; train_gene_expr_recon_loss: 785256.9397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3351481.4219; train_optim_loss: 3351481.4219; val_kl_reg_loss: 14511.2914; val_edge_recon_loss: 2555408.3443; val_gene_expr_recon_loss: 873506.2725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3443425.9303; val_optim_loss: 3443425.9303
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9971; val_auprc_score: 0.9962; val_best_acc_score: 0.9843; val_best_f1_score: 0.9845; train_kl_reg_loss: 14561.4186; train_edge_recon_loss: 2550839.8621; train_gene_expr_recon_loss: 776974.4770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3342375.7633; train_optim_loss: 3342375.7633; val_kl_reg_loss: 14329.9703; val_edge_recon_loss: 2553976.6189; val_gene_expr_recon_loss: 799917.1609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3368223.7500; val_optim_loss: 3368223.7500
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9970; val_auprc_score: 0.9961; val_best_acc_score: 0.9847; val_best_f1_score: 0.9849; train_kl_reg_loss: 14573.6055; train_edge_recon_loss: 2550875.4807; train_gene_expr_recon_loss: 773833.2223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3339282.3088; train_optim_loss: 3339282.3088; val_kl_reg_loss: 14435.1428; val_edge_recon_loss: 2553369.8648; val_gene_expr_recon_loss: 896303.5861; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3464108.5984; val_optim_loss: 3464108.5984

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9970; val_auprc_score: 0.9958; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 14835.4996; train_edge_recon_loss: 2550444.6176; train_gene_expr_recon_loss: 768288.4158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3333568.5267; train_optim_loss: 3333568.5267; val_kl_reg_loss: 14824.7074; val_edge_recon_loss: 2555179.0123; val_gene_expr_recon_loss: 781284.2459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3351287.9713; val_optim_loss: 3351287.9713
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9970; val_auprc_score: 0.9961; val_best_acc_score: 0.9847; val_best_f1_score: 0.9849; train_kl_reg_loss: 15025.0115; train_edge_recon_loss: 2548979.1604; train_gene_expr_recon_loss: 713230.6288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3277234.7973; train_optim_loss: 3277234.7973; val_kl_reg_loss: 14941.2139; val_edge_recon_loss: 2552583.7828; val_gene_expr_recon_loss: 845615.2807; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3413140.2500; val_optim_loss: 3413140.2500
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9971; val_auprc_score: 0.9958; val_best_acc_score: 0.9852; val_best_f1_score: 0.9854; train_kl_reg_loss: 15060.0311; train_edge_recon_loss: 2549383.0478; train_gene_expr_recon_loss: 739217.9130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3303660.9963; train_optim_loss: 3303660.9963; val_kl_reg_loss: 14909.6036; val_edge_recon_loss: 2552464.5123; val_gene_expr_recon_loss: 836533.6496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3403907.7459; val_optim_loss: 3403907.7459
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9971; val_auprc_score: 0.9963; val_best_acc_score: 0.9848; val_best_f1_score: 0.9849; train_kl_reg_loss: 15040.6142; train_edge_recon_loss: 2549155.9637; train_gene_expr_recon_loss: 761986.4389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3326183.0110; train_optim_loss: 3326183.0110; val_kl_reg_loss: 14930.3828; val_edge_recon_loss: 2552823.1721; val_gene_expr_recon_loss: 855786.9088; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3423540.4795; val_optim_loss: 3423540.4795

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 242 min 55 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9971
Val AUPRC score: 0.9964
Val best accuracy score: 0.9845
Val best F1 score: 0.9846
Val gene expr MSE score: 0.6350

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
