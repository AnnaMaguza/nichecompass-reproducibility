None
Run timestamp: 14072023_090156_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9400; val_auprc_score: 0.9338; val_best_acc_score: 0.8610; val_best_f1_score: 0.8636; train_kl_reg_loss: 78787.9093; train_edge_recon_loss: 3192494.1067; train_gene_expr_recon_loss: 11510553.1957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14781835.2011; train_optim_loss: 14781835.2011; val_kl_reg_loss: 96923.1989; val_edge_recon_loss: 2859908.8720; val_gene_expr_recon_loss: 10380782.1707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13337614.2927; val_optim_loss: 13337614.2927
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9784; val_auprc_score: 0.9715; val_best_acc_score: 0.9374; val_best_f1_score: 0.9389; train_kl_reg_loss: 88252.3834; train_edge_recon_loss: 2775851.7711; train_gene_expr_recon_loss: 10269932.4158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13134036.5625; train_optim_loss: 13134036.5625; val_kl_reg_loss: 81308.3081; val_edge_recon_loss: 2725930.7927; val_gene_expr_recon_loss: 10015281.9512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12822521.1463; val_optim_loss: 12822521.1463
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9810; val_auprc_score: 0.9748; val_best_acc_score: 0.9445; val_best_f1_score: 0.9460; train_kl_reg_loss: 81167.0693; train_edge_recon_loss: 2694725.6535; train_gene_expr_recon_loss: 9981488.9565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12757381.6685; train_optim_loss: 12757381.6685; val_kl_reg_loss: 75408.9522; val_edge_recon_loss: 2696623.2500; val_gene_expr_recon_loss: 9823522.0244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12595554.1951; val_optim_loss: 12595554.1951
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9838; val_auprc_score: 0.9787; val_best_acc_score: 0.9482; val_best_f1_score: 0.9496; train_kl_reg_loss: 73966.2770; train_edge_recon_loss: 2675983.0258; train_gene_expr_recon_loss: 9803546.6223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12553495.9185; train_optim_loss: 12553495.9185; val_kl_reg_loss: 68482.7407; val_edge_recon_loss: 2678097.0244; val_gene_expr_recon_loss: 9645023.8780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12391603.6829; val_optim_loss: 12391603.6829
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9842; val_auprc_score: 0.9790; val_best_acc_score: 0.9497; val_best_f1_score: 0.9511; train_kl_reg_loss: 67606.6091; train_edge_recon_loss: 2664988.7262; train_gene_expr_recon_loss: 9671638.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12404234.0625; train_optim_loss: 12404234.0625; val_kl_reg_loss: 63183.9032; val_edge_recon_loss: 2670082.8841; val_gene_expr_recon_loss: 9559216.8537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12292483.5366; val_optim_loss: 12292483.5366
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9846; val_auprc_score: 0.9802; val_best_acc_score: 0.9500; val_best_f1_score: 0.9511; train_kl_reg_loss: 62805.3840; train_edge_recon_loss: 2655493.8010; train_gene_expr_recon_loss: 9547109.3478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12265408.5353; train_optim_loss: 12265408.5353; val_kl_reg_loss: 59835.8290; val_edge_recon_loss: 2667541.2744; val_gene_expr_recon_loss: 9466929.9024; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12194307.0488; val_optim_loss: 12194307.0488
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9856; val_auprc_score: 0.9814; val_best_acc_score: 0.9522; val_best_f1_score: 0.9531; train_kl_reg_loss: 58945.5000; train_edge_recon_loss: 2649820.7609; train_gene_expr_recon_loss: 9471527.4837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12180293.7255; train_optim_loss: 12180293.7255; val_kl_reg_loss: 55626.4354; val_edge_recon_loss: 2657335.4329; val_gene_expr_recon_loss: 9393189.2927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12106151.1220; val_optim_loss: 12106151.1220
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9855; val_auprc_score: 0.9812; val_best_acc_score: 0.9531; val_best_f1_score: 0.9540; train_kl_reg_loss: 55880.4199; train_edge_recon_loss: 2646937.7201; train_gene_expr_recon_loss: 9389363.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12092182.0217; train_optim_loss: 12092182.0217; val_kl_reg_loss: 53305.0656; val_edge_recon_loss: 2653443.0244; val_gene_expr_recon_loss: 9328053.9756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12034802.0976; val_optim_loss: 12034802.0976
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9866; val_auprc_score: 0.9828; val_best_acc_score: 0.9551; val_best_f1_score: 0.9561; train_kl_reg_loss: 53549.5706; train_edge_recon_loss: 2640520.8431; train_gene_expr_recon_loss: 9320733.4973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12014803.8995; train_optim_loss: 12014803.8995; val_kl_reg_loss: 51352.0759; val_edge_recon_loss: 2646323.6098; val_gene_expr_recon_loss: 9270990.7561; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11968666.4878; val_optim_loss: 11968666.4878
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9871; val_auprc_score: 0.9833; val_best_acc_score: 0.9557; val_best_f1_score: 0.9566; train_kl_reg_loss: 51689.1728; train_edge_recon_loss: 2638314.4952; train_gene_expr_recon_loss: 9267204.4484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11957208.1223; train_optim_loss: 11957208.1223; val_kl_reg_loss: 49714.4974; val_edge_recon_loss: 2644853.7317; val_gene_expr_recon_loss: 9248038.5854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11942606.8049; val_optim_loss: 11942606.8049
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9874; val_auprc_score: 0.9836; val_best_acc_score: 0.9566; val_best_f1_score: 0.9575; train_kl_reg_loss: 50184.3814; train_edge_recon_loss: 2634782.1984; train_gene_expr_recon_loss: 9211618.3261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11896584.8641; train_optim_loss: 11896584.8641; val_kl_reg_loss: 48241.8902; val_edge_recon_loss: 2639915.0793; val_gene_expr_recon_loss: 9216635.4390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11904792.3902; val_optim_loss: 11904792.3902
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9874; val_auprc_score: 0.9840; val_best_acc_score: 0.9557; val_best_f1_score: 0.9566; train_kl_reg_loss: 48673.1093; train_edge_recon_loss: 2632168.9130; train_gene_expr_recon_loss: 9167169.7473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11848011.7582; train_optim_loss: 11848011.7582; val_kl_reg_loss: 47101.9979; val_edge_recon_loss: 2643534.3963; val_gene_expr_recon_loss: 9176105.2683; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11866741.6341; val_optim_loss: 11866741.6341
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9879; val_auprc_score: 0.9848; val_best_acc_score: 0.9580; val_best_f1_score: 0.9588; train_kl_reg_loss: 47678.2398; train_edge_recon_loss: 2629500.9463; train_gene_expr_recon_loss: 9129143.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11806322.9783; train_optim_loss: 11806322.9783; val_kl_reg_loss: 46375.2131; val_edge_recon_loss: 2635124.8415; val_gene_expr_recon_loss: 9191561.2195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11873061.3415; val_optim_loss: 11873061.3415
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9877; val_auprc_score: 0.9844; val_best_acc_score: 0.9572; val_best_f1_score: 0.9582; train_kl_reg_loss: 46896.4640; train_edge_recon_loss: 2625834.2276; train_gene_expr_recon_loss: 9090618.6087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11763349.3179; train_optim_loss: 11763349.3179; val_kl_reg_loss: 45955.1200; val_edge_recon_loss: 2641682.1890; val_gene_expr_recon_loss: 9160080.7561; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11847718.0488; val_optim_loss: 11847718.0488
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9879; val_auprc_score: 0.9845; val_best_acc_score: 0.9577; val_best_f1_score: 0.9586; train_kl_reg_loss: 46060.8520; train_edge_recon_loss: 2624236.1726; train_gene_expr_recon_loss: 9065047.2038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11735344.2228; train_optim_loss: 11735344.2228; val_kl_reg_loss: 44410.5916; val_edge_recon_loss: 2637576.3171; val_gene_expr_recon_loss: 9147741.1463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11829728.1220; val_optim_loss: 11829728.1220
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9881; val_auprc_score: 0.9846; val_best_acc_score: 0.9582; val_best_f1_score: 0.9592; train_kl_reg_loss: 45435.0758; train_edge_recon_loss: 2622518.4314; train_gene_expr_recon_loss: 9039302.7120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11707256.2255; train_optim_loss: 11707256.2255; val_kl_reg_loss: 43981.9740; val_edge_recon_loss: 2636897.3780; val_gene_expr_recon_loss: 9126413.9268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11807293.1951; val_optim_loss: 11807293.1951
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9890; val_auprc_score: 0.9860; val_best_acc_score: 0.9609; val_best_f1_score: 0.9618; train_kl_reg_loss: 44811.0845; train_edge_recon_loss: 2620180.9470; train_gene_expr_recon_loss: 9010430.8668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11675422.8886; train_optim_loss: 11675422.8886; val_kl_reg_loss: 43610.8056; val_edge_recon_loss: 2633571.7988; val_gene_expr_recon_loss: 9131842.5366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11809025.2195; val_optim_loss: 11809025.2195
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9889; val_auprc_score: 0.9860; val_best_acc_score: 0.9608; val_best_f1_score: 0.9615; train_kl_reg_loss: 44379.7192; train_edge_recon_loss: 2618711.2147; train_gene_expr_recon_loss: 8987304.8016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11650395.7636; train_optim_loss: 11650395.7636; val_kl_reg_loss: 43637.6482; val_edge_recon_loss: 2628437.7378; val_gene_expr_recon_loss: 9148223.8537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11820299.1707; val_optim_loss: 11820299.1707
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9889; val_auprc_score: 0.9861; val_best_acc_score: 0.9605; val_best_f1_score: 0.9613; train_kl_reg_loss: 43970.7930; train_edge_recon_loss: 2616923.0652; train_gene_expr_recon_loss: 8973740.4361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11634634.2554; train_optim_loss: 11634634.2554; val_kl_reg_loss: 42882.7335; val_edge_recon_loss: 2628088.3232; val_gene_expr_recon_loss: 9121807.3171; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11792778.3415; val_optim_loss: 11792778.3415
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9888; val_auprc_score: 0.9859; val_best_acc_score: 0.9597; val_best_f1_score: 0.9606; train_kl_reg_loss: 43488.4692; train_edge_recon_loss: 2616817.1182; train_gene_expr_recon_loss: 8944952.5707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11605258.1576; train_optim_loss: 11605258.1576; val_kl_reg_loss: 42305.5582; val_edge_recon_loss: 2633230.3293; val_gene_expr_recon_loss: 9117175.2683; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11792711.0976; val_optim_loss: 11792711.0976
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9888; val_auprc_score: 0.9852; val_best_acc_score: 0.9617; val_best_f1_score: 0.9625; train_kl_reg_loss: 43257.3925; train_edge_recon_loss: 2615131.3635; train_gene_expr_recon_loss: 8925269.8940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11583658.6386; train_optim_loss: 11583658.6386; val_kl_reg_loss: 42514.1957; val_edge_recon_loss: 2624608.0244; val_gene_expr_recon_loss: 9105464.0488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11772586.3415; val_optim_loss: 11772586.3415
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9892; val_auprc_score: 0.9862; val_best_acc_score: 0.9610; val_best_f1_score: 0.9619; train_kl_reg_loss: 42894.1786; train_edge_recon_loss: 2614160.5020; train_gene_expr_recon_loss: 8901798.7649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11558853.4429; train_optim_loss: 11558853.4429; val_kl_reg_loss: 41610.6297; val_edge_recon_loss: 2629489.9878; val_gene_expr_recon_loss: 9110329.9756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11781430.6341; val_optim_loss: 11781430.6341
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9890; val_auprc_score: 0.9863; val_best_acc_score: 0.9603; val_best_f1_score: 0.9613; train_kl_reg_loss: 42592.3162; train_edge_recon_loss: 2614264.0863; train_gene_expr_recon_loss: 8885851.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11542707.4891; train_optim_loss: 11542707.4891; val_kl_reg_loss: 41607.1670; val_edge_recon_loss: 2627716.6646; val_gene_expr_recon_loss: 9108665.5122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11777989.3659; val_optim_loss: 11777989.3659
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9894; val_auprc_score: 0.9867; val_best_acc_score: 0.9624; val_best_f1_score: 0.9632; train_kl_reg_loss: 42355.7292; train_edge_recon_loss: 2612257.8295; train_gene_expr_recon_loss: 8878498.6182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11533112.1576; train_optim_loss: 11533112.1576; val_kl_reg_loss: 41250.4905; val_edge_recon_loss: 2622227.8598; val_gene_expr_recon_loss: 9107946.7805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11771425.1707; val_optim_loss: 11771425.1707
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9892; val_auprc_score: 0.9867; val_best_acc_score: 0.9611; val_best_f1_score: 0.9619; train_kl_reg_loss: 41959.8379; train_edge_recon_loss: 2612269.4823; train_gene_expr_recon_loss: 8860251.9253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11514481.2364; train_optim_loss: 11514481.2364; val_kl_reg_loss: 41257.3482; val_edge_recon_loss: 2625824.3963; val_gene_expr_recon_loss: 9112631.9756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11779713.7073; val_optim_loss: 11779713.7073
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9894; val_auprc_score: 0.9867; val_best_acc_score: 0.9619; val_best_f1_score: 0.9627; train_kl_reg_loss: 41863.2118; train_edge_recon_loss: 2610725.5115; train_gene_expr_recon_loss: 8848146.6793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11500735.4076; train_optim_loss: 11500735.4076; val_kl_reg_loss: 41337.1259; val_edge_recon_loss: 2620181.2683; val_gene_expr_recon_loss: 9127725.9268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11789244.3171; val_optim_loss: 11789244.3171
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9892; val_auprc_score: 0.9863; val_best_acc_score: 0.9607; val_best_f1_score: 0.9616; train_kl_reg_loss: 41555.1658; train_edge_recon_loss: 2611137.2031; train_gene_expr_recon_loss: 8834817.6508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11487510.0353; train_optim_loss: 11487510.0353; val_kl_reg_loss: 41007.0634; val_edge_recon_loss: 2626217.3232; val_gene_expr_recon_loss: 9132958.8780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11800183.2683; val_optim_loss: 11800183.2683
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9898; val_auprc_score: 0.9876; val_best_acc_score: 0.9620; val_best_f1_score: 0.9626; train_kl_reg_loss: 41393.9121; train_edge_recon_loss: 2608840.5591; train_gene_expr_recon_loss: 8824374.6168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11474609.0870; train_optim_loss: 11474609.0870; val_kl_reg_loss: 40303.9409; val_edge_recon_loss: 2621049.6524; val_gene_expr_recon_loss: 9129889.4390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11791242.9756; val_optim_loss: 11791242.9756

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9896; val_auprc_score: 0.9870; val_best_acc_score: 0.9621; val_best_f1_score: 0.9629; train_kl_reg_loss: 41891.6274; train_edge_recon_loss: 2608006.5666; train_gene_expr_recon_loss: 8748110.8098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11398009.0163; train_optim_loss: 11398009.0163; val_kl_reg_loss: 40977.7949; val_edge_recon_loss: 2618551.2805; val_gene_expr_recon_loss: 9095388.1220; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11754917.1220; val_optim_loss: 11754917.1220
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9897; val_auprc_score: 0.9872; val_best_acc_score: 0.9627; val_best_f1_score: 0.9635; train_kl_reg_loss: 42028.7228; train_edge_recon_loss: 2606806.7704; train_gene_expr_recon_loss: 8745635.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11394471.1902; train_optim_loss: 11394471.1902; val_kl_reg_loss: 40927.4053; val_edge_recon_loss: 2617539.7317; val_gene_expr_recon_loss: 9101734.7073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11760201.8049; val_optim_loss: 11760201.8049
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9894; val_auprc_score: 0.9867; val_best_acc_score: 0.9613; val_best_f1_score: 0.9621; train_kl_reg_loss: 42030.9593; train_edge_recon_loss: 2605990.7283; train_gene_expr_recon_loss: 8737123.4266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11385145.1304; train_optim_loss: 11385145.1304; val_kl_reg_loss: 41065.5772; val_edge_recon_loss: 2626061.7134; val_gene_expr_recon_loss: 9091582.5122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11758709.7805; val_optim_loss: 11758709.7805
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9893; val_auprc_score: 0.9868; val_best_acc_score: 0.9614; val_best_f1_score: 0.9623; train_kl_reg_loss: 42027.5716; train_edge_recon_loss: 2607094.4844; train_gene_expr_recon_loss: 8739310.3940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11388432.4457; train_optim_loss: 11388432.4457; val_kl_reg_loss: 40997.1261; val_edge_recon_loss: 2620195.8720; val_gene_expr_recon_loss: 9109541.1951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11770734.2683; val_optim_loss: 11770734.2683
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9892; val_auprc_score: 0.9861; val_best_acc_score: 0.9611; val_best_f1_score: 0.9620; train_kl_reg_loss: 41981.2747; train_edge_recon_loss: 2606507.1549; train_gene_expr_recon_loss: 8739152.7269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11387641.1495; train_optim_loss: 11387641.1495; val_kl_reg_loss: 40934.7136; val_edge_recon_loss: 2622348.5549; val_gene_expr_recon_loss: 9114745.2439; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11778028.4634; val_optim_loss: 11778028.4634

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9897; val_auprc_score: 0.9870; val_best_acc_score: 0.9628; val_best_f1_score: 0.9636; train_kl_reg_loss: 42001.7499; train_edge_recon_loss: 2606351.9552; train_gene_expr_recon_loss: 8729268.7283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11377622.4538; train_optim_loss: 11377622.4538; val_kl_reg_loss: 40989.8045; val_edge_recon_loss: 2616401.6098; val_gene_expr_recon_loss: 9082892.7317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11740284.2195; val_optim_loss: 11740284.2195
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9899; val_auprc_score: 0.9872; val_best_acc_score: 0.9624; val_best_f1_score: 0.9631; train_kl_reg_loss: 42037.1363; train_edge_recon_loss: 2606816.5109; train_gene_expr_recon_loss: 8726761.5584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11375615.2228; train_optim_loss: 11375615.2228; val_kl_reg_loss: 41095.8938; val_edge_recon_loss: 2619221.5915; val_gene_expr_recon_loss: 9110331.3171; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11770648.8049; val_optim_loss: 11770648.8049
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9894; val_auprc_score: 0.9867; val_best_acc_score: 0.9621; val_best_f1_score: 0.9629; train_kl_reg_loss: 42062.0587; train_edge_recon_loss: 2604526.4830; train_gene_expr_recon_loss: 8731923.8818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11378512.4130; train_optim_loss: 11378512.4130; val_kl_reg_loss: 41025.3853; val_edge_recon_loss: 2618238.0000; val_gene_expr_recon_loss: 9093753.5366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11753016.9268; val_optim_loss: 11753016.9268
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9890; val_auprc_score: 0.9858; val_best_acc_score: 0.9618; val_best_f1_score: 0.9626; train_kl_reg_loss: 42041.4528; train_edge_recon_loss: 2605694.8037; train_gene_expr_recon_loss: 8731690.2255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11379426.4837; train_optim_loss: 11379426.4837; val_kl_reg_loss: 41049.0241; val_edge_recon_loss: 2619652.8537; val_gene_expr_recon_loss: 9120299.1463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11781001.1220; val_optim_loss: 11781001.1220
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9893; val_auprc_score: 0.9864; val_best_acc_score: 0.9617; val_best_f1_score: 0.9626; train_kl_reg_loss: 42039.9732; train_edge_recon_loss: 2606039.2398; train_gene_expr_recon_loss: 8726629.6481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11374708.8750; train_optim_loss: 11374708.8750; val_kl_reg_loss: 40979.5999; val_edge_recon_loss: 2617932.0061; val_gene_expr_recon_loss: 9096392.0244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11755303.7073; val_optim_loss: 11755303.7073

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9892; val_auprc_score: 0.9864; val_best_acc_score: 0.9620; val_best_f1_score: 0.9628; train_kl_reg_loss: 42034.7549; train_edge_recon_loss: 2606069.1196; train_gene_expr_recon_loss: 8733917.5435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11382021.4130; train_optim_loss: 11382021.4130; val_kl_reg_loss: 40990.5079; val_edge_recon_loss: 2621674.0366; val_gene_expr_recon_loss: 9100593.1463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11763257.6098; val_optim_loss: 11763257.6098
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9899; val_auprc_score: 0.9871; val_best_acc_score: 0.9625; val_best_f1_score: 0.9633; train_kl_reg_loss: 42024.1438; train_edge_recon_loss: 2606966.6549; train_gene_expr_recon_loss: 8730564.8207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11379555.6304; train_optim_loss: 11379555.6304; val_kl_reg_loss: 41042.9886; val_edge_recon_loss: 2619985.1098; val_gene_expr_recon_loss: 9093783.6585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11754811.7561; val_optim_loss: 11754811.7561
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9897; val_auprc_score: 0.9873; val_best_acc_score: 0.9619; val_best_f1_score: 0.9627; train_kl_reg_loss: 42018.6503; train_edge_recon_loss: 2605070.0476; train_gene_expr_recon_loss: 8729720.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11376809.1033; train_optim_loss: 11376809.1033; val_kl_reg_loss: 41053.9247; val_edge_recon_loss: 2622538.9512; val_gene_expr_recon_loss: 9091023.8049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11754616.6341; val_optim_loss: 11754616.6341
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9895; val_auprc_score: 0.9866; val_best_acc_score: 0.9621; val_best_f1_score: 0.9629; train_kl_reg_loss: 42030.2346; train_edge_recon_loss: 2605817.1230; train_gene_expr_recon_loss: 8724818.0136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11372665.3723; train_optim_loss: 11372665.3723; val_kl_reg_loss: 40989.4628; val_edge_recon_loss: 2619700.5732; val_gene_expr_recon_loss: 9102455.3902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11763145.4878; val_optim_loss: 11763145.4878

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 114 min 47 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
Val AUROC score: 0.9896
Val AUPRC score: 0.9867
Val best accuracy score: 0.9626
Val best F1 score: 0.9633
Val gene expr MSE score: 0.6253

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
