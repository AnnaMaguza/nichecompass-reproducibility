None
Run timestamp: 03082023_172544_4.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '128', '--node_batch_size', 'None', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 10, n_fc_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1385, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 500
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1385, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 500

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1931624
Number of validation edges: 214624
Edge batch size: 128
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9952; val_auprc_score: 0.9948; val_best_acc_score: 0.9670; val_best_f1_score: 0.9671; train_kl_reg_loss: 7070.9525; train_edge_recon_loss: 265251.5369; train_gene_expr_recon_loss: 183591.0395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 455913.5290; train_optim_loss: 455913.5290; val_kl_reg_loss: 6660.1770; val_edge_recon_loss: 261337.4030; val_gene_expr_recon_loss: 176028.1830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444025.7630; val_optim_loss: 444025.7630
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9964; val_auprc_score: 0.9960; val_best_acc_score: 0.9730; val_best_f1_score: 0.9730; train_kl_reg_loss: 6620.1840; train_edge_recon_loss: 261100.1710; train_gene_expr_recon_loss: 176013.0826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443733.4377; train_optim_loss: 443733.4377; val_kl_reg_loss: 6372.7079; val_edge_recon_loss: 260473.0198; val_gene_expr_recon_loss: 175996.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442841.8211; val_optim_loss: 442841.8211
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9971; val_auprc_score: 0.9969; val_best_acc_score: 0.9757; val_best_f1_score: 0.9759; train_kl_reg_loss: 6585.0620; train_edge_recon_loss: 260309.2881; train_gene_expr_recon_loss: 176023.6883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 442918.0384; train_optim_loss: 442918.0384; val_kl_reg_loss: 6538.4236; val_edge_recon_loss: 259798.6240; val_gene_expr_recon_loss: 263816.2334; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 530153.2808; val_optim_loss: 530153.2808
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9971; val_auprc_score: 0.9968; val_best_acc_score: 0.9773; val_best_f1_score: 0.9774; train_kl_reg_loss: 6581.0846; train_edge_recon_loss: 259814.0010; train_gene_expr_recon_loss: 141341.7160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 407736.8018; train_optim_loss: 407736.8018; val_kl_reg_loss: 6571.8941; val_edge_recon_loss: 259536.8869; val_gene_expr_recon_loss: 166566.4485; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432675.2294; val_optim_loss: 432675.2294
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9971; val_auprc_score: 0.9967; val_best_acc_score: 0.9770; val_best_f1_score: 0.9771; train_kl_reg_loss: 6587.9987; train_edge_recon_loss: 259491.4163; train_gene_expr_recon_loss: 160421.4599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 426500.8749; train_optim_loss: 426500.8749; val_kl_reg_loss: 6525.8269; val_edge_recon_loss: 259399.1508; val_gene_expr_recon_loss: 168573.5815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434498.5593; val_optim_loss: 434498.5593
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9974; val_auprc_score: 0.9971; val_best_acc_score: 0.9786; val_best_f1_score: 0.9787; train_kl_reg_loss: 6587.3026; train_edge_recon_loss: 259253.3990; train_gene_expr_recon_loss: 168858.5629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434699.2643; train_optim_loss: 434699.2643; val_kl_reg_loss: 6544.8981; val_edge_recon_loss: 259104.0521; val_gene_expr_recon_loss: 168826.4164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434475.3671; val_optim_loss: 434475.3671
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9803; val_best_f1_score: 0.9804; train_kl_reg_loss: 6589.4337; train_edge_recon_loss: 259073.8704; train_gene_expr_recon_loss: 168615.4328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434278.7367; train_optim_loss: 434278.7367; val_kl_reg_loss: 6517.0894; val_edge_recon_loss: 258602.0241; val_gene_expr_recon_loss: 169253.5526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434372.6659; val_optim_loss: 434372.6659
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9810; val_best_f1_score: 0.9811; train_kl_reg_loss: 6592.3771; train_edge_recon_loss: 258938.1740; train_gene_expr_recon_loss: 168315.3393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433845.8902; train_optim_loss: 433845.8902; val_kl_reg_loss: 6588.6994; val_edge_recon_loss: 258706.7220; val_gene_expr_recon_loss: 168107.0528; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433402.4749; val_optim_loss: 433402.4749

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9982; val_auprc_score: 0.9979; val_best_acc_score: 0.9833; val_best_f1_score: 0.9833; train_kl_reg_loss: 6643.1842; train_edge_recon_loss: 258421.6456; train_gene_expr_recon_loss: 167322.4870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432387.3166; train_optim_loss: 432387.3166; val_kl_reg_loss: 6613.0183; val_edge_recon_loss: 258178.7194; val_gene_expr_recon_loss: 167356.5373; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432148.2747; val_optim_loss: 432148.2747
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9837; val_best_f1_score: 0.9837; train_kl_reg_loss: 6614.6526; train_edge_recon_loss: 258380.6569; train_gene_expr_recon_loss: 167214.3010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432209.6107; train_optim_loss: 432209.6107; val_kl_reg_loss: 6581.6464; val_edge_recon_loss: 258172.4895; val_gene_expr_recon_loss: 167303.9732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432058.1088; val_optim_loss: 432058.1088
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9983; val_auprc_score: 0.9982; val_best_acc_score: 0.9837; val_best_f1_score: 0.9838; train_kl_reg_loss: 6604.2049; train_edge_recon_loss: 258352.4917; train_gene_expr_recon_loss: 167134.7851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432091.4817; train_optim_loss: 432091.4817; val_kl_reg_loss: 6569.7564; val_edge_recon_loss: 258098.5759; val_gene_expr_recon_loss: 167334.3904; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432002.7225; val_optim_loss: 432002.7225
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9984; val_auprc_score: 0.9981; val_best_acc_score: 0.9841; val_best_f1_score: 0.9841; train_kl_reg_loss: 6597.3989; train_edge_recon_loss: 258282.2302; train_gene_expr_recon_loss: 167076.7027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431956.3318; train_optim_loss: 431956.3318; val_kl_reg_loss: 6585.3196; val_edge_recon_loss: 258061.3421; val_gene_expr_recon_loss: 167007.4033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431654.0646; val_optim_loss: 431654.0646
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9984; val_auprc_score: 0.9981; val_best_acc_score: 0.9842; val_best_f1_score: 0.9842; train_kl_reg_loss: 6591.2175; train_edge_recon_loss: 258230.0422; train_gene_expr_recon_loss: 167024.8954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431846.1551; train_optim_loss: 431846.1551; val_kl_reg_loss: 6581.0969; val_edge_recon_loss: 257992.0770; val_gene_expr_recon_loss: 167334.1155; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431907.2894; val_optim_loss: 431907.2894
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9985; val_auprc_score: 0.9983; val_best_acc_score: 0.9847; val_best_f1_score: 0.9848; train_kl_reg_loss: 6582.5705; train_edge_recon_loss: 258228.9573; train_gene_expr_recon_loss: 167027.8503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431839.3780; train_optim_loss: 431839.3780; val_kl_reg_loss: 6557.4416; val_edge_recon_loss: 257687.8796; val_gene_expr_recon_loss: 167104.5048; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431349.8262; val_optim_loss: 431349.8262
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 6578.0949; train_edge_recon_loss: 258242.8446; train_gene_expr_recon_loss: 167019.6186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431840.5580; train_optim_loss: 431840.5580; val_kl_reg_loss: 6580.9560; val_edge_recon_loss: 257958.4989; val_gene_expr_recon_loss: 167259.0636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431798.5181; val_optim_loss: 431798.5181
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9985; val_auprc_score: 0.9982; val_best_acc_score: 0.9848; val_best_f1_score: 0.9849; train_kl_reg_loss: 6573.2429; train_edge_recon_loss: 258240.7043; train_gene_expr_recon_loss: 167013.7772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431827.7244; train_optim_loss: 431827.7244; val_kl_reg_loss: 6580.2055; val_edge_recon_loss: 258094.7036; val_gene_expr_recon_loss: 167355.2690; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432030.1783; val_optim_loss: 432030.1783
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9986; val_auprc_score: 0.9984; val_best_acc_score: 0.9850; val_best_f1_score: 0.9851; train_kl_reg_loss: 6573.2904; train_edge_recon_loss: 258174.3797; train_gene_expr_recon_loss: 166878.0858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431625.7561; train_optim_loss: 431625.7561; val_kl_reg_loss: 6547.7765; val_edge_recon_loss: 257800.5907; val_gene_expr_recon_loss: 167230.8429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431579.2096; val_optim_loss: 431579.2096
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9985; val_auprc_score: 0.9983; val_best_acc_score: 0.9851; val_best_f1_score: 0.9851; train_kl_reg_loss: 6568.3610; train_edge_recon_loss: 258187.6111; train_gene_expr_recon_loss: 166971.0385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431727.0107; train_optim_loss: 431727.0107; val_kl_reg_loss: 6511.4458; val_edge_recon_loss: 257797.5548; val_gene_expr_recon_loss: 167144.6150; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431453.6152; val_optim_loss: 431453.6152

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9985; val_auprc_score: 0.9983; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 6576.3337; train_edge_recon_loss: 258131.2666; train_gene_expr_recon_loss: 166873.5565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431581.1568; train_optim_loss: 431581.1568; val_kl_reg_loss: 6555.5417; val_edge_recon_loss: 257783.2036; val_gene_expr_recon_loss: 166942.0315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431280.7768; val_optim_loss: 431280.7768
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9985; val_auprc_score: 0.9982; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 6574.9571; train_edge_recon_loss: 258135.7690; train_gene_expr_recon_loss: 166897.9146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431608.6406; train_optim_loss: 431608.6406; val_kl_reg_loss: 6557.4637; val_edge_recon_loss: 257803.1316; val_gene_expr_recon_loss: 167206.6587; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431567.2541; val_optim_loss: 431567.2541
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9985; val_auprc_score: 0.9982; val_best_acc_score: 0.9853; val_best_f1_score: 0.9853; train_kl_reg_loss: 6575.3832; train_edge_recon_loss: 258093.8374; train_gene_expr_recon_loss: 166844.7073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431513.9279; train_optim_loss: 431513.9279; val_kl_reg_loss: 6548.8540; val_edge_recon_loss: 257891.1078; val_gene_expr_recon_loss: 167075.2599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431515.2217; val_optim_loss: 431515.2217
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9986; val_auprc_score: 0.9983; val_best_acc_score: 0.9852; val_best_f1_score: 0.9852; train_kl_reg_loss: 6573.2360; train_edge_recon_loss: 258131.1172; train_gene_expr_recon_loss: 166828.6696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431533.0227; train_optim_loss: 431533.0227; val_kl_reg_loss: 6549.2561; val_edge_recon_loss: 257823.7975; val_gene_expr_recon_loss: 167146.6759; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431519.7288; val_optim_loss: 431519.7288
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9986; val_auprc_score: 0.9984; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 6573.4535; train_edge_recon_loss: 258110.4097; train_gene_expr_recon_loss: 166810.3001; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431494.1633; train_optim_loss: 431494.1633; val_kl_reg_loss: 6545.9923; val_edge_recon_loss: 257811.4904; val_gene_expr_recon_loss: 167281.8544; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431639.3373; val_optim_loss: 431639.3373

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9985; val_auprc_score: 0.9983; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 6573.5626; train_edge_recon_loss: 258118.9203; train_gene_expr_recon_loss: 166895.0516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431587.5346; train_optim_loss: 431587.5346; val_kl_reg_loss: 6550.2993; val_edge_recon_loss: 257773.2834; val_gene_expr_recon_loss: 167069.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431393.2155; val_optim_loss: 431393.2155
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9985; val_auprc_score: 0.9983; val_best_acc_score: 0.9850; val_best_f1_score: 0.9851; train_kl_reg_loss: 6574.3785; train_edge_recon_loss: 258113.1511; train_gene_expr_recon_loss: 166750.8703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431438.3998; train_optim_loss: 431438.3998; val_kl_reg_loss: 6550.1973; val_edge_recon_loss: 257883.0472; val_gene_expr_recon_loss: 166940.7566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431374.0012; val_optim_loss: 431374.0012
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9986; val_auprc_score: 0.9983; val_best_acc_score: 0.9855; val_best_f1_score: 0.9855; train_kl_reg_loss: 6575.3015; train_edge_recon_loss: 258120.8707; train_gene_expr_recon_loss: 166816.6405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431512.8128; train_optim_loss: 431512.8128; val_kl_reg_loss: 6553.3973; val_edge_recon_loss: 257762.6464; val_gene_expr_recon_loss: 167116.3850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431432.4285; val_optim_loss: 431432.4285
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9985; val_auprc_score: 0.9982; val_best_acc_score: 0.9854; val_best_f1_score: 0.9855; train_kl_reg_loss: 6574.6670; train_edge_recon_loss: 258102.6253; train_gene_expr_recon_loss: 166841.6573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431518.9493; train_optim_loss: 431518.9493; val_kl_reg_loss: 6548.1970; val_edge_recon_loss: 257746.4145; val_gene_expr_recon_loss: 167066.4138; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431361.0254; val_optim_loss: 431361.0254

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1043 min 8 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
val AUROC score: 0.9985
val AUPRC score: 0.9981
val best accuracy score: 0.9850
val best F1 score: 0.9851
val target rna MSE score: 4.0129
val source rna MSE score: 0.2427

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
