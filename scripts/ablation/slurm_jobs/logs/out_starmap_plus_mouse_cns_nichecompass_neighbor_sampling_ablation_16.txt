None
Run timestamp: 07082023_120821_16.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '24', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '2', '--timestamp_suffix', '_16']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 1094923
Number of validation edges: 121658
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9888; val_auprc_score: 0.9860; val_best_acc_score: 0.9582; val_best_f1_score: 0.9590; train_kl_reg_loss: 7200.5533; train_edge_recon_loss: 264248.8663; train_gene_expr_recon_loss: 195183.8998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 466633.3196; train_optim_loss: 466633.3196; val_kl_reg_loss: 6811.9678; val_edge_recon_loss: 261090.4303; val_gene_expr_recon_loss: 179475.3433; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 447377.7407; val_optim_loss: 447377.7407
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9913; val_auprc_score: 0.9892; val_best_acc_score: 0.9643; val_best_f1_score: 0.9649; train_kl_reg_loss: 6840.4539; train_edge_recon_loss: 260112.7380; train_gene_expr_recon_loss: 176381.6392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443334.8318; train_optim_loss: 443334.8318; val_kl_reg_loss: 6663.0689; val_edge_recon_loss: 260011.7317; val_gene_expr_recon_loss: 172633.4178; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 439308.2180; val_optim_loss: 439308.2180
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9928; val_auprc_score: 0.9912; val_best_acc_score: 0.9681; val_best_f1_score: 0.9686; train_kl_reg_loss: 6740.9243; train_edge_recon_loss: 259381.0946; train_gene_expr_recon_loss: 171854.5408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437976.5598; train_optim_loss: 437976.5598; val_kl_reg_loss: 6628.8705; val_edge_recon_loss: 259474.8323; val_gene_expr_recon_loss: 169547.3344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435651.0369; val_optim_loss: 435651.0369
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9931; val_auprc_score: 0.9915; val_best_acc_score: 0.9685; val_best_f1_score: 0.9691; train_kl_reg_loss: 6736.1054; train_edge_recon_loss: 258875.0268; train_gene_expr_recon_loss: 169593.9553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435205.0878; train_optim_loss: 435205.0878; val_kl_reg_loss: 6653.1624; val_edge_recon_loss: 259213.9025; val_gene_expr_recon_loss: 168054.8778; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433921.9428; val_optim_loss: 433921.9428
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9939; val_auprc_score: 0.9926; val_best_acc_score: 0.9705; val_best_f1_score: 0.9710; train_kl_reg_loss: 6742.3113; train_edge_recon_loss: 258607.8919; train_gene_expr_recon_loss: 168418.5040; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433768.7074; train_optim_loss: 433768.7074; val_kl_reg_loss: 6490.3503; val_edge_recon_loss: 258901.5987; val_gene_expr_recon_loss: 167339.3701; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432731.3191; val_optim_loss: 432731.3191
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9945; val_auprc_score: 0.9932; val_best_acc_score: 0.9725; val_best_f1_score: 0.9729; train_kl_reg_loss: 6757.4243; train_edge_recon_loss: 258456.9972; train_gene_expr_recon_loss: 167671.7230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432886.1445; train_optim_loss: 432886.1445; val_kl_reg_loss: 6611.4390; val_edge_recon_loss: 258634.0642; val_gene_expr_recon_loss: 166501.7977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431747.3007; val_optim_loss: 431747.3007
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9951; val_auprc_score: 0.9941; val_best_acc_score: 0.9737; val_best_f1_score: 0.9740; train_kl_reg_loss: 6773.6667; train_edge_recon_loss: 258241.6059; train_gene_expr_recon_loss: 167009.6650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432024.9374; train_optim_loss: 432024.9374; val_kl_reg_loss: 6717.7637; val_edge_recon_loss: 258424.3409; val_gene_expr_recon_loss: 166341.0274; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431483.1310; val_optim_loss: 431483.1310
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9954; val_auprc_score: 0.9946; val_best_acc_score: 0.9745; val_best_f1_score: 0.9749; train_kl_reg_loss: 6784.3477; train_edge_recon_loss: 258127.8198; train_gene_expr_recon_loss: 166480.4686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431392.6359; train_optim_loss: 431392.6359; val_kl_reg_loss: 6757.4873; val_edge_recon_loss: 258429.9043; val_gene_expr_recon_loss: 166104.9209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431292.3132; val_optim_loss: 431292.3132
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9956; val_auprc_score: 0.9946; val_best_acc_score: 0.9749; val_best_f1_score: 0.9752; train_kl_reg_loss: 6793.9251; train_edge_recon_loss: 257986.5484; train_gene_expr_recon_loss: 165945.2803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430725.7539; train_optim_loss: 430725.7539; val_kl_reg_loss: 6650.2363; val_edge_recon_loss: 258534.4148; val_gene_expr_recon_loss: 165158.2078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 430342.8579; val_optim_loss: 430342.8579
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9956; val_auprc_score: 0.9944; val_best_acc_score: 0.9761; val_best_f1_score: 0.9764; train_kl_reg_loss: 6805.2626; train_edge_recon_loss: 257837.3574; train_gene_expr_recon_loss: 164633.8929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 429276.5130; train_optim_loss: 429276.5130; val_kl_reg_loss: 6762.3982; val_edge_recon_loss: 258213.8100; val_gene_expr_recon_loss: 167532.4247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432508.6325; val_optim_loss: 432508.6325
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9959; val_auprc_score: 0.9950; val_best_acc_score: 0.9770; val_best_f1_score: 0.9773; train_kl_reg_loss: 6818.1213; train_edge_recon_loss: 257765.5638; train_gene_expr_recon_loss: 162479.3032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427062.9882; train_optim_loss: 427062.9882; val_kl_reg_loss: 6809.9917; val_edge_recon_loss: 257938.8668; val_gene_expr_recon_loss: 163305.8764; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 428054.7367; val_optim_loss: 428054.7367
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9961; val_auprc_score: 0.9951; val_best_acc_score: 0.9776; val_best_f1_score: 0.9779; train_kl_reg_loss: 6822.1952; train_edge_recon_loss: 257692.7881; train_gene_expr_recon_loss: 161925.3262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 426440.3094; train_optim_loss: 426440.3094; val_kl_reg_loss: 6746.0607; val_edge_recon_loss: 257918.3546; val_gene_expr_recon_loss: 158964.1360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 423628.5523; val_optim_loss: 423628.5523
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9960; val_auprc_score: 0.9951; val_best_acc_score: 0.9776; val_best_f1_score: 0.9778; train_kl_reg_loss: 6827.1655; train_edge_recon_loss: 257639.0056; train_gene_expr_recon_loss: 160356.4553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 424822.6265; train_optim_loss: 424822.6265; val_kl_reg_loss: 6697.2839; val_edge_recon_loss: 257925.0151; val_gene_expr_recon_loss: 143848.1397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 408470.4395; val_optim_loss: 408470.4395
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9962; val_auprc_score: 0.9953; val_best_acc_score: 0.9783; val_best_f1_score: 0.9785; train_kl_reg_loss: 6836.1287; train_edge_recon_loss: 257495.4915; train_gene_expr_recon_loss: 151193.4140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 415525.0343; train_optim_loss: 415525.0343; val_kl_reg_loss: 6752.5363; val_edge_recon_loss: 257818.4188; val_gene_expr_recon_loss: 122513.5955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 387084.5524; val_optim_loss: 387084.5524
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9964; val_auprc_score: 0.9956; val_best_acc_score: 0.9789; val_best_f1_score: 0.9791; train_kl_reg_loss: 6839.8223; train_edge_recon_loss: 257471.4255; train_gene_expr_recon_loss: 129946.8838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 394258.1318; train_optim_loss: 394258.1318; val_kl_reg_loss: 6688.3635; val_edge_recon_loss: 257704.0668; val_gene_expr_recon_loss: 128459.3625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 392851.7940; val_optim_loss: 392851.7940
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9962; val_auprc_score: 0.9952; val_best_acc_score: 0.9783; val_best_f1_score: 0.9786; train_kl_reg_loss: 6846.9128; train_edge_recon_loss: 257389.0183; train_gene_expr_recon_loss: 113321.8864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 377557.8174; train_optim_loss: 377557.8174; val_kl_reg_loss: 6756.1139; val_edge_recon_loss: 257756.2983; val_gene_expr_recon_loss: 117048.3701; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 381560.7822; val_optim_loss: 381560.7822
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 6848.4348; train_edge_recon_loss: 257351.5490; train_gene_expr_recon_loss: 103782.5216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367982.5059; train_optim_loss: 367982.5059; val_kl_reg_loss: 6708.9571; val_edge_recon_loss: 257464.3787; val_gene_expr_recon_loss: 104401.3277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368574.6631; val_optim_loss: 368574.6631
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9963; val_auprc_score: 0.9954; val_best_acc_score: 0.9790; val_best_f1_score: 0.9793; train_kl_reg_loss: 6855.2666; train_edge_recon_loss: 257186.8873; train_gene_expr_recon_loss: 100427.8802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364470.0342; train_optim_loss: 364470.0342; val_kl_reg_loss: 6697.2734; val_edge_recon_loss: 257683.6996; val_gene_expr_recon_loss: 99007.5523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 363388.5260; val_optim_loss: 363388.5260
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9965; val_auprc_score: 0.9957; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 6855.3284; train_edge_recon_loss: 257255.6211; train_gene_expr_recon_loss: 99428.8841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363539.8332; train_optim_loss: 363539.8332; val_kl_reg_loss: 6832.8263; val_edge_recon_loss: 257497.4477; val_gene_expr_recon_loss: 86353.4580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 350683.7329; val_optim_loss: 350683.7329
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9965; val_auprc_score: 0.9954; val_best_acc_score: 0.9797; val_best_f1_score: 0.9799; train_kl_reg_loss: 6861.4800; train_edge_recon_loss: 257205.8874; train_gene_expr_recon_loss: 99078.9127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363146.2799; train_optim_loss: 363146.2799; val_kl_reg_loss: 6758.6907; val_edge_recon_loss: 257522.5020; val_gene_expr_recon_loss: 100027.0439; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 364308.2377; val_optim_loss: 364308.2377
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9968; val_auprc_score: 0.9958; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 6863.8699; train_edge_recon_loss: 257164.4391; train_gene_expr_recon_loss: 98772.9627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362801.2714; train_optim_loss: 362801.2714; val_kl_reg_loss: 6859.0490; val_edge_recon_loss: 257136.0354; val_gene_expr_recon_loss: 95471.1858; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 359466.2692; val_optim_loss: 359466.2692
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9965; val_auprc_score: 0.9957; val_best_acc_score: 0.9800; val_best_f1_score: 0.9803; train_kl_reg_loss: 6866.4235; train_edge_recon_loss: 257031.0484; train_gene_expr_recon_loss: 97650.7662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 361548.2382; train_optim_loss: 361548.2382; val_kl_reg_loss: 6610.0081; val_edge_recon_loss: 257418.3446; val_gene_expr_recon_loss: 95176.4152; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 359204.7675; val_optim_loss: 359204.7675
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9966; val_auprc_score: 0.9956; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 6867.6044; train_edge_recon_loss: 257026.5693; train_gene_expr_recon_loss: 98381.1344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362275.3079; train_optim_loss: 362275.3079; val_kl_reg_loss: 6740.1809; val_edge_recon_loss: 257229.5012; val_gene_expr_recon_loss: 102704.0428; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366673.7240; val_optim_loss: 366673.7240

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9970; val_auprc_score: 0.9961; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 6816.0830; train_edge_recon_loss: 256812.9098; train_gene_expr_recon_loss: 95939.3009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 359568.2938; train_optim_loss: 359568.2938; val_kl_reg_loss: 6682.9100; val_edge_recon_loss: 257162.5344; val_gene_expr_recon_loss: 95844.3156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 359689.7600; val_optim_loss: 359689.7600
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9971; val_auprc_score: 0.9966; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 6805.6543; train_edge_recon_loss: 256798.2261; train_gene_expr_recon_loss: 96784.1160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 360387.9965; train_optim_loss: 360387.9965; val_kl_reg_loss: 6761.7505; val_edge_recon_loss: 257101.1671; val_gene_expr_recon_loss: 101718.9561; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 365581.8743; val_optim_loss: 365581.8743
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9970; val_auprc_score: 0.9962; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 6809.8239; train_edge_recon_loss: 256767.2495; train_gene_expr_recon_loss: 96774.5544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 360351.6269; train_optim_loss: 360351.6269; val_kl_reg_loss: 6714.9003; val_edge_recon_loss: 257105.4399; val_gene_expr_recon_loss: 102056.5891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 365876.9299; val_optim_loss: 365876.9299
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9971; val_auprc_score: 0.9964; val_best_acc_score: 0.9815; val_best_f1_score: 0.9817; train_kl_reg_loss: 6809.2034; train_edge_recon_loss: 256775.6670; train_gene_expr_recon_loss: 96047.5036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 359632.3740; train_optim_loss: 359632.3740; val_kl_reg_loss: 6777.5359; val_edge_recon_loss: 257070.4552; val_gene_expr_recon_loss: 91685.2748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 355533.2644; val_optim_loss: 355533.2644

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 90 min 29 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
val AUROC score: 0.9964
val AUPRC score: 0.9955
val best accuracy score: 0.9794
val best F1 score: 0.9796
val target rna MSE score: 0.6098
val source rna MSE score: 0.1371

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
