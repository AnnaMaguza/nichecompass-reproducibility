None
Run timestamp: 01072023_114524_29.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_29']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9468; val_auprc_score: 0.9295; val_best_acc_score: 0.8877; val_best_f1_score: 0.8940; train_kl_reg_loss: 5298.4071; train_edge_recon_loss: 269140.9048; train_gene_expr_recon_loss: 9313.0335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 283752.3453; train_optim_loss: 283752.3453; val_kl_reg_loss: 5067.6944; val_edge_recon_loss: 267508.5794; val_gene_expr_recon_loss: 8424.4417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281000.7196; val_optim_loss: 281000.7196
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9612; val_auprc_score: 0.9492; val_best_acc_score: 0.9076; val_best_f1_score: 0.9114; train_kl_reg_loss: 5261.6592; train_edge_recon_loss: 262811.5266; train_gene_expr_recon_loss: 8157.7368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276230.9223; train_optim_loss: 276230.9223; val_kl_reg_loss: 5095.7673; val_edge_recon_loss: 265893.4424; val_gene_expr_recon_loss: 7869.7432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278858.9527; val_optim_loss: 278858.9527
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9640; val_auprc_score: 0.9522; val_best_acc_score: 0.9138; val_best_f1_score: 0.9170; train_kl_reg_loss: 5277.5188; train_edge_recon_loss: 261998.6974; train_gene_expr_recon_loss: 7778.0147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 275054.2307; train_optim_loss: 275054.2307; val_kl_reg_loss: 5143.4773; val_edge_recon_loss: 266081.3538; val_gene_expr_recon_loss: 7580.8255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278805.6567; val_optim_loss: 278805.6567
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9670; val_auprc_score: 0.9566; val_best_acc_score: 0.9170; val_best_f1_score: 0.9198; train_kl_reg_loss: 5280.5142; train_edge_recon_loss: 261732.9892; train_gene_expr_recon_loss: 7551.7230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274565.2264; train_optim_loss: 274565.2264; val_kl_reg_loss: 5110.5116; val_edge_recon_loss: 265634.3697; val_gene_expr_recon_loss: 7475.9467; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278220.8294; val_optim_loss: 278220.8294
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9685; val_auprc_score: 0.9586; val_best_acc_score: 0.9200; val_best_f1_score: 0.9230; train_kl_reg_loss: 5291.0561; train_edge_recon_loss: 261265.7091; train_gene_expr_recon_loss: 7413.2170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273969.9821; train_optim_loss: 273969.9821; val_kl_reg_loss: 5172.6082; val_edge_recon_loss: 265130.0012; val_gene_expr_recon_loss: 7271.4429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277574.0547; val_optim_loss: 277574.0547
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9702; val_auprc_score: 0.9616; val_best_acc_score: 0.9215; val_best_f1_score: 0.9244; train_kl_reg_loss: 5297.3513; train_edge_recon_loss: 261229.4724; train_gene_expr_recon_loss: 7305.7559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273832.5789; train_optim_loss: 273832.5789; val_kl_reg_loss: 5040.0854; val_edge_recon_loss: 264988.5210; val_gene_expr_recon_loss: 7181.8137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277210.4178; val_optim_loss: 277210.4178
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9726; val_auprc_score: 0.9641; val_best_acc_score: 0.9253; val_best_f1_score: 0.9277; train_kl_reg_loss: 5295.4072; train_edge_recon_loss: 260854.0190; train_gene_expr_recon_loss: 7230.2973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273379.7233; train_optim_loss: 273379.7233; val_kl_reg_loss: 5100.7361; val_edge_recon_loss: 264578.5818; val_gene_expr_recon_loss: 7134.0660; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276813.3865; val_optim_loss: 276813.3865
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9742; val_auprc_score: 0.9662; val_best_acc_score: 0.9292; val_best_f1_score: 0.9312; train_kl_reg_loss: 5294.4517; train_edge_recon_loss: 260876.2446; train_gene_expr_recon_loss: 7167.0168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273337.7123; train_optim_loss: 273337.7123; val_kl_reg_loss: 5271.6347; val_edge_recon_loss: 264598.0701; val_gene_expr_recon_loss: 7057.7038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276927.4083; val_optim_loss: 276927.4083
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9746; val_auprc_score: 0.9670; val_best_acc_score: 0.9291; val_best_f1_score: 0.9312; train_kl_reg_loss: 5305.0208; train_edge_recon_loss: 260692.3496; train_gene_expr_recon_loss: 7121.9248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273119.2948; train_optim_loss: 273119.2948; val_kl_reg_loss: 5114.8579; val_edge_recon_loss: 264440.3351; val_gene_expr_recon_loss: 6982.5151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276537.7105; val_optim_loss: 276537.7105
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9730; val_auprc_score: 0.9645; val_best_acc_score: 0.9285; val_best_f1_score: 0.9306; train_kl_reg_loss: 5306.3231; train_edge_recon_loss: 260726.0078; train_gene_expr_recon_loss: 7081.5076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273113.8380; train_optim_loss: 273113.8380; val_kl_reg_loss: 5065.9097; val_edge_recon_loss: 265132.1120; val_gene_expr_recon_loss: 6991.1532; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277189.1731; val_optim_loss: 277189.1731
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9759; val_auprc_score: 0.9685; val_best_acc_score: 0.9317; val_best_f1_score: 0.9339; train_kl_reg_loss: 5315.9089; train_edge_recon_loss: 260500.8136; train_gene_expr_recon_loss: 7051.8697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272868.5911; train_optim_loss: 272868.5911; val_kl_reg_loss: 5278.3969; val_edge_recon_loss: 264032.0880; val_gene_expr_recon_loss: 6944.1594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276254.6439; val_optim_loss: 276254.6439
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9770; val_auprc_score: 0.9700; val_best_acc_score: 0.9334; val_best_f1_score: 0.9353; train_kl_reg_loss: 5325.0840; train_edge_recon_loss: 260518.9117; train_gene_expr_recon_loss: 7021.6084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272865.6045; train_optim_loss: 272865.6045; val_kl_reg_loss: 5205.6358; val_edge_recon_loss: 263838.4807; val_gene_expr_recon_loss: 6902.7125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275946.8289; val_optim_loss: 275946.8289
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9781; val_auprc_score: 0.9715; val_best_acc_score: 0.9332; val_best_f1_score: 0.9350; train_kl_reg_loss: 5328.6456; train_edge_recon_loss: 260514.0332; train_gene_expr_recon_loss: 6997.9115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272840.5900; train_optim_loss: 272840.5900; val_kl_reg_loss: 5107.9515; val_edge_recon_loss: 264244.1213; val_gene_expr_recon_loss: 6895.2465; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276247.3195; val_optim_loss: 276247.3195
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9775; val_auprc_score: 0.9704; val_best_acc_score: 0.9347; val_best_f1_score: 0.9361; train_kl_reg_loss: 5335.8457; train_edge_recon_loss: 260113.4400; train_gene_expr_recon_loss: 6977.0072; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272426.2936; train_optim_loss: 272426.2936; val_kl_reg_loss: 5119.9982; val_edge_recon_loss: 264241.3238; val_gene_expr_recon_loss: 6889.2942; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276250.6143; val_optim_loss: 276250.6143
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9795; val_auprc_score: 0.9738; val_best_acc_score: 0.9380; val_best_f1_score: 0.9393; train_kl_reg_loss: 5336.3441; train_edge_recon_loss: 260306.1402; train_gene_expr_recon_loss: 6959.0060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272601.4907; train_optim_loss: 272601.4907; val_kl_reg_loss: 5372.9700; val_edge_recon_loss: 264092.6600; val_gene_expr_recon_loss: 6849.2004; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276314.8294; val_optim_loss: 276314.8294
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9791; val_auprc_score: 0.9729; val_best_acc_score: 0.9364; val_best_f1_score: 0.9381; train_kl_reg_loss: 5345.6179; train_edge_recon_loss: 260169.8046; train_gene_expr_recon_loss: 6938.0753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272453.4977; train_optim_loss: 272453.4977; val_kl_reg_loss: 5140.6254; val_edge_recon_loss: 264156.2294; val_gene_expr_recon_loss: 6846.0719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276142.9280; val_optim_loss: 276142.9280

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9793; val_auprc_score: 0.9729; val_best_acc_score: 0.9382; val_best_f1_score: 0.9398; train_kl_reg_loss: 5325.7605; train_edge_recon_loss: 259941.5349; train_gene_expr_recon_loss: 6903.5664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272170.8609; train_optim_loss: 272170.8609; val_kl_reg_loss: 5218.4515; val_edge_recon_loss: 263847.3512; val_gene_expr_recon_loss: 6808.2816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275874.0831; val_optim_loss: 275874.0831
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9799; val_auprc_score: 0.9735; val_best_acc_score: 0.9389; val_best_f1_score: 0.9401; train_kl_reg_loss: 5323.1407; train_edge_recon_loss: 259914.2159; train_gene_expr_recon_loss: 6891.8270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272129.1841; train_optim_loss: 272129.1841; val_kl_reg_loss: 5242.8255; val_edge_recon_loss: 263922.2138; val_gene_expr_recon_loss: 6795.3175; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275960.3569; val_optim_loss: 275960.3569
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9803; val_auprc_score: 0.9741; val_best_acc_score: 0.9398; val_best_f1_score: 0.9413; train_kl_reg_loss: 5320.9843; train_edge_recon_loss: 259882.7773; train_gene_expr_recon_loss: 6885.6726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272089.4349; train_optim_loss: 272089.4349; val_kl_reg_loss: 5235.0208; val_edge_recon_loss: 263520.7270; val_gene_expr_recon_loss: 6800.6293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275556.3742; val_optim_loss: 275556.3742
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9812; val_auprc_score: 0.9757; val_best_acc_score: 0.9401; val_best_f1_score: 0.9415; train_kl_reg_loss: 5319.4541; train_edge_recon_loss: 259728.8319; train_gene_expr_recon_loss: 6876.7305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271925.0164; train_optim_loss: 271925.0164; val_kl_reg_loss: 5209.1046; val_edge_recon_loss: 263651.2741; val_gene_expr_recon_loss: 6806.2843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275666.6600; val_optim_loss: 275666.6600
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9806; val_auprc_score: 0.9748; val_best_acc_score: 0.9402; val_best_f1_score: 0.9415; train_kl_reg_loss: 5317.6203; train_edge_recon_loss: 259821.8663; train_gene_expr_recon_loss: 6874.4274; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272013.9146; train_optim_loss: 272013.9146; val_kl_reg_loss: 5228.7208; val_edge_recon_loss: 263482.0345; val_gene_expr_recon_loss: 6788.3251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275499.0810; val_optim_loss: 275499.0810
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9809; val_auprc_score: 0.9750; val_best_acc_score: 0.9402; val_best_f1_score: 0.9415; train_kl_reg_loss: 5317.7444; train_edge_recon_loss: 259866.7388; train_gene_expr_recon_loss: 6870.9923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272055.4754; train_optim_loss: 272055.4754; val_kl_reg_loss: 5192.3292; val_edge_recon_loss: 263555.4936; val_gene_expr_recon_loss: 6790.2863; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275538.1106; val_optim_loss: 275538.1106
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9804; val_auprc_score: 0.9739; val_best_acc_score: 0.9398; val_best_f1_score: 0.9414; train_kl_reg_loss: 5320.7792; train_edge_recon_loss: 259756.0108; train_gene_expr_recon_loss: 6873.3289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271950.1196; train_optim_loss: 271950.1196; val_kl_reg_loss: 5241.8167; val_edge_recon_loss: 263409.6914; val_gene_expr_recon_loss: 6778.4357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275429.9437; val_optim_loss: 275429.9437
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9811; val_auprc_score: 0.9756; val_best_acc_score: 0.9400; val_best_f1_score: 0.9415; train_kl_reg_loss: 5319.4698; train_edge_recon_loss: 259721.3408; train_gene_expr_recon_loss: 6865.0677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271905.8780; train_optim_loss: 271905.8780; val_kl_reg_loss: 5207.6209; val_edge_recon_loss: 263200.5874; val_gene_expr_recon_loss: 6781.8386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275190.0498; val_optim_loss: 275190.0498
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9809; val_auprc_score: 0.9748; val_best_acc_score: 0.9414; val_best_f1_score: 0.9428; train_kl_reg_loss: 5322.7347; train_edge_recon_loss: 259654.5367; train_gene_expr_recon_loss: 6862.0010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271839.2727; train_optim_loss: 271839.2727; val_kl_reg_loss: 5201.5202; val_edge_recon_loss: 263215.6908; val_gene_expr_recon_loss: 6791.3079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275208.5181; val_optim_loss: 275208.5181
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9812; val_auprc_score: 0.9762; val_best_acc_score: 0.9406; val_best_f1_score: 0.9421; train_kl_reg_loss: 5319.5238; train_edge_recon_loss: 259715.2953; train_gene_expr_recon_loss: 6856.3776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271891.1968; train_optim_loss: 271891.1968; val_kl_reg_loss: 5265.7324; val_edge_recon_loss: 263399.6026; val_gene_expr_recon_loss: 6775.5376; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275440.8738; val_optim_loss: 275440.8738
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9808; val_auprc_score: 0.9752; val_best_acc_score: 0.9404; val_best_f1_score: 0.9417; train_kl_reg_loss: 5315.9417; train_edge_recon_loss: 259705.6285; train_gene_expr_recon_loss: 6856.0632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271877.6341; train_optim_loss: 271877.6341; val_kl_reg_loss: 5188.6217; val_edge_recon_loss: 263544.1861; val_gene_expr_recon_loss: 6762.2306; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275495.0370; val_optim_loss: 275495.0370
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9809; val_auprc_score: 0.9750; val_best_acc_score: 0.9409; val_best_f1_score: 0.9421; train_kl_reg_loss: 5317.2364; train_edge_recon_loss: 259741.8345; train_gene_expr_recon_loss: 6858.6419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271917.7128; train_optim_loss: 271917.7128; val_kl_reg_loss: 5232.4533; val_edge_recon_loss: 263416.2749; val_gene_expr_recon_loss: 6767.0911; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275415.8195; val_optim_loss: 275415.8195

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9815; val_auprc_score: 0.9758; val_best_acc_score: 0.9412; val_best_f1_score: 0.9425; train_kl_reg_loss: 5323.0227; train_edge_recon_loss: 259633.6683; train_gene_expr_recon_loss: 6850.1249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271806.8150; train_optim_loss: 271806.8150; val_kl_reg_loss: 5232.0492; val_edge_recon_loss: 263426.6308; val_gene_expr_recon_loss: 6759.4344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275418.1123; val_optim_loss: 275418.1123
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9813; val_auprc_score: 0.9758; val_best_acc_score: 0.9409; val_best_f1_score: 0.9424; train_kl_reg_loss: 5323.7789; train_edge_recon_loss: 259622.5365; train_gene_expr_recon_loss: 6848.8752; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271795.1891; train_optim_loss: 271795.1891; val_kl_reg_loss: 5229.1885; val_edge_recon_loss: 263337.1297; val_gene_expr_recon_loss: 6754.6148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275320.9317; val_optim_loss: 275320.9317
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9818; val_auprc_score: 0.9763; val_best_acc_score: 0.9420; val_best_f1_score: 0.9430; train_kl_reg_loss: 5322.9482; train_edge_recon_loss: 259567.2778; train_gene_expr_recon_loss: 6849.7809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271740.0072; train_optim_loss: 271740.0072; val_kl_reg_loss: 5222.8081; val_edge_recon_loss: 263404.6007; val_gene_expr_recon_loss: 6759.8342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275387.2422; val_optim_loss: 275387.2422
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9807; val_auprc_score: 0.9744; val_best_acc_score: 0.9412; val_best_f1_score: 0.9427; train_kl_reg_loss: 5314.1902; train_edge_recon_loss: 259856.5169; train_gene_expr_recon_loss: 6847.1780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272017.8846; train_optim_loss: 272017.8846; val_kl_reg_loss: 5210.5665; val_edge_recon_loss: 263572.9920; val_gene_expr_recon_loss: 6759.8751; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275543.4322; val_optim_loss: 275543.4322

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 39 min 19 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9808
Val AUPRC score: 0.9752
Val best accuracy score: 0.9411
Val best F1 score: 0.9426
Val gene expr MSE score: 1.8772

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
