None
Run timestamp: 24072023_201311_10.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '2', '--timestamp_suffix', '_10']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9797; val_auprc_score: 0.9734; val_best_acc_score: 0.9398; val_best_f1_score: 0.9414; train_kl_reg_loss: 81296.7526; train_edge_recon_loss: 26841314.3143; train_gene_expr_recon_loss: 11642664.6620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38565275.7441; train_optim_loss: 38565275.7441; val_kl_reg_loss: 94223.8854; val_edge_recon_loss: 26217710.4250; val_gene_expr_recon_loss: 10632321.2125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36944255.6500; val_optim_loss: 36944255.6500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9818; val_auprc_score: 0.9770; val_best_acc_score: 0.9421; val_best_f1_score: 0.9438; train_kl_reg_loss: 95484.8741; train_edge_recon_loss: 26013224.1140; train_gene_expr_recon_loss: 10353330.3505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36462039.2935; train_optim_loss: 36462039.2935; val_kl_reg_loss: 89927.3119; val_edge_recon_loss: 26106264.6750; val_gene_expr_recon_loss: 10141652.5750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36337844.7000; val_optim_loss: 36337844.7000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9847; val_auprc_score: 0.9810; val_best_acc_score: 0.9496; val_best_f1_score: 0.9509; train_kl_reg_loss: 85696.2779; train_edge_recon_loss: 25927450.1836; train_gene_expr_recon_loss: 9974736.9583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35987883.4103; train_optim_loss: 35987883.4103; val_kl_reg_loss: 79599.3973; val_edge_recon_loss: 25998463.2750; val_gene_expr_recon_loss: 9835689.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35913752.4000; val_optim_loss: 35913752.4000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9864; val_auprc_score: 0.9827; val_best_acc_score: 0.9530; val_best_f1_score: 0.9543; train_kl_reg_loss: 78157.0415; train_edge_recon_loss: 25843616.6843; train_gene_expr_recon_loss: 9724604.7733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35646378.4478; train_optim_loss: 35646378.4478; val_kl_reg_loss: 73467.4557; val_edge_recon_loss: 25947327.9250; val_gene_expr_recon_loss: 9633298.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35654093.7500; val_optim_loss: 35654093.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9863; val_auprc_score: 0.9827; val_best_acc_score: 0.9543; val_best_f1_score: 0.9555; train_kl_reg_loss: 74938.7459; train_edge_recon_loss: 25817273.0821; train_gene_expr_recon_loss: 9587953.8957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35480165.6745; train_optim_loss: 35480165.6745; val_kl_reg_loss: 72691.6465; val_edge_recon_loss: 25909487.4250; val_gene_expr_recon_loss: 9520639.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35502818.8500; val_optim_loss: 35502818.8500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9871; val_auprc_score: 0.9837; val_best_acc_score: 0.9557; val_best_f1_score: 0.9569; train_kl_reg_loss: 72661.9633; train_edge_recon_loss: 25781959.5967; train_gene_expr_recon_loss: 9455859.5480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35310480.9624; train_optim_loss: 35310480.9624; val_kl_reg_loss: 70436.9409; val_edge_recon_loss: 25886275.3250; val_gene_expr_recon_loss: 9419867.3875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35376579.5000; val_optim_loss: 35376579.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9882; val_auprc_score: 0.9854; val_best_acc_score: 0.9569; val_best_f1_score: 0.9580; train_kl_reg_loss: 71466.9902; train_edge_recon_loss: 25755892.3060; train_gene_expr_recon_loss: 9340280.3630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35167639.6940; train_optim_loss: 35167639.6940; val_kl_reg_loss: 68240.1222; val_edge_recon_loss: 25853589.5000; val_gene_expr_recon_loss: 9353677.2250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35275506.7500; val_optim_loss: 35275506.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9883; val_auprc_score: 0.9855; val_best_acc_score: 0.9580; val_best_f1_score: 0.9590; train_kl_reg_loss: 70123.5817; train_edge_recon_loss: 25747235.4075; train_gene_expr_recon_loss: 9277100.3004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35094459.2712; train_optim_loss: 35094459.2712; val_kl_reg_loss: 67247.7445; val_edge_recon_loss: 25862424.8250; val_gene_expr_recon_loss: 9282011.1312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35211683.8000; val_optim_loss: 35211683.8000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9879; val_auprc_score: 0.9848; val_best_acc_score: 0.9583; val_best_f1_score: 0.9592; train_kl_reg_loss: 68808.5364; train_edge_recon_loss: 25709178.2865; train_gene_expr_recon_loss: 9206873.2608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34984860.0890; train_optim_loss: 34984860.0890; val_kl_reg_loss: 66634.2270; val_edge_recon_loss: 25828982.9000; val_gene_expr_recon_loss: 9218939.9125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35114556.9500; val_optim_loss: 35114556.9500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9896; val_auprc_score: 0.9872; val_best_acc_score: 0.9609; val_best_f1_score: 0.9617; train_kl_reg_loss: 67424.1363; train_edge_recon_loss: 25702098.9875; train_gene_expr_recon_loss: 9137476.0834; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34906999.1655; train_optim_loss: 34906999.1655; val_kl_reg_loss: 65770.1485; val_edge_recon_loss: 25799376.5000; val_gene_expr_recon_loss: 9179849.4875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35044996.3000; val_optim_loss: 35044996.3000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9893; val_auprc_score: 0.9869; val_best_acc_score: 0.9608; val_best_f1_score: 0.9617; train_kl_reg_loss: 67399.9932; train_edge_recon_loss: 25689112.9986; train_gene_expr_recon_loss: 9084861.5007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34841374.4367; train_optim_loss: 34841374.4367; val_kl_reg_loss: 66221.4166; val_edge_recon_loss: 25800097.8250; val_gene_expr_recon_loss: 9131488.7625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34997807.9500; val_optim_loss: 34997807.9500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9897; val_auprc_score: 0.9873; val_best_acc_score: 0.9615; val_best_f1_score: 0.9624; train_kl_reg_loss: 66717.2398; train_edge_recon_loss: 25677725.8554; train_gene_expr_recon_loss: 9040438.3456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34784881.4965; train_optim_loss: 34784881.4965; val_kl_reg_loss: 66164.2631; val_edge_recon_loss: 25788985.7250; val_gene_expr_recon_loss: 9115357.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34970507.8500; val_optim_loss: 34970507.8500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9895; val_auprc_score: 0.9868; val_best_acc_score: 0.9614; val_best_f1_score: 0.9622; train_kl_reg_loss: 66540.2539; train_edge_recon_loss: 25667005.0459; train_gene_expr_recon_loss: 8988885.4186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34722430.7316; train_optim_loss: 34722430.7316; val_kl_reg_loss: 66392.9131; val_edge_recon_loss: 25770622.9250; val_gene_expr_recon_loss: 9087329.6813; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34924345.3000; val_optim_loss: 34924345.3000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9895; val_auprc_score: 0.9869; val_best_acc_score: 0.9619; val_best_f1_score: 0.9629; train_kl_reg_loss: 66011.8150; train_edge_recon_loss: 25651857.3018; train_gene_expr_recon_loss: 8970673.3289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34688542.4228; train_optim_loss: 34688542.4228; val_kl_reg_loss: 63850.1558; val_edge_recon_loss: 25778828.7000; val_gene_expr_recon_loss: 9031627.5125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34874306.2000; val_optim_loss: 34874306.2000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9901; val_auprc_score: 0.9876; val_best_acc_score: 0.9622; val_best_f1_score: 0.9631; train_kl_reg_loss: 65941.2097; train_edge_recon_loss: 25658812.3561; train_gene_expr_recon_loss: 8930136.8880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34654890.3477; train_optim_loss: 34654890.3477; val_kl_reg_loss: 65102.4357; val_edge_recon_loss: 25764826.9250; val_gene_expr_recon_loss: 9024740.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34854669.8000; val_optim_loss: 34854669.8000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9903; val_auprc_score: 0.9878; val_best_acc_score: 0.9637; val_best_f1_score: 0.9644; train_kl_reg_loss: 65624.2616; train_edge_recon_loss: 25638400.1892; train_gene_expr_recon_loss: 8911367.4687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34615391.9666; train_optim_loss: 34615391.9666; val_kl_reg_loss: 64480.9000; val_edge_recon_loss: 25761839.1750; val_gene_expr_recon_loss: 8989805.9313; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34816125.8000; val_optim_loss: 34816125.8000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9905; val_auprc_score: 0.9881; val_best_acc_score: 0.9632; val_best_f1_score: 0.9640; train_kl_reg_loss: 65345.9922; train_edge_recon_loss: 25642216.8428; train_gene_expr_recon_loss: 8879824.7246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34587387.5716; train_optim_loss: 34587387.5716; val_kl_reg_loss: 65244.5139; val_edge_recon_loss: 25744160.4000; val_gene_expr_recon_loss: 8953963.8812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34763368.8000; val_optim_loss: 34763368.8000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9903; val_auprc_score: 0.9876; val_best_acc_score: 0.9629; val_best_f1_score: 0.9637; train_kl_reg_loss: 65296.2547; train_edge_recon_loss: 25645647.2211; train_gene_expr_recon_loss: 8857892.8769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34568836.3060; train_optim_loss: 34568836.3060; val_kl_reg_loss: 63109.6992; val_edge_recon_loss: 25777696.5500; val_gene_expr_recon_loss: 8966941.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34807747.7000; val_optim_loss: 34807747.7000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9905; val_auprc_score: 0.9880; val_best_acc_score: 0.9630; val_best_f1_score: 0.9638; train_kl_reg_loss: 64922.9652; train_edge_recon_loss: 25630158.0111; train_gene_expr_recon_loss: 8842470.1092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34537551.0737; train_optim_loss: 34537551.0737; val_kl_reg_loss: 63955.1280; val_edge_recon_loss: 25762601.1250; val_gene_expr_recon_loss: 8933053.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34759609.8000; val_optim_loss: 34759609.8000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9908; val_auprc_score: 0.9885; val_best_acc_score: 0.9655; val_best_f1_score: 0.9662; train_kl_reg_loss: 65087.5721; train_edge_recon_loss: 25634562.6259; train_gene_expr_recon_loss: 8826060.2656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34525710.5925; train_optim_loss: 34525710.5925; val_kl_reg_loss: 63557.4666; val_edge_recon_loss: 25750085.9750; val_gene_expr_recon_loss: 8913491.9437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34727135.4000; val_optim_loss: 34727135.4000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9906; val_auprc_score: 0.9878; val_best_acc_score: 0.9648; val_best_f1_score: 0.9655; train_kl_reg_loss: 64615.2132; train_edge_recon_loss: 25624339.6384; train_gene_expr_recon_loss: 8805514.9645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34494469.8220; train_optim_loss: 34494469.8220; val_kl_reg_loss: 63362.6544; val_edge_recon_loss: 25755169.7750; val_gene_expr_recon_loss: 8931265.0750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34749797.6000; val_optim_loss: 34749797.6000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9915; val_auprc_score: 0.9892; val_best_acc_score: 0.9664; val_best_f1_score: 0.9671; train_kl_reg_loss: 65090.4759; train_edge_recon_loss: 25620834.1530; train_gene_expr_recon_loss: 8786905.1078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34472829.6745; train_optim_loss: 34472829.6745; val_kl_reg_loss: 63882.2593; val_edge_recon_loss: 25732492.8750; val_gene_expr_recon_loss: 8952935.0375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34749310.2500; val_optim_loss: 34749310.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9911; val_auprc_score: 0.9887; val_best_acc_score: 0.9663; val_best_f1_score: 0.9670; train_kl_reg_loss: 64613.4290; train_edge_recon_loss: 25624802.2643; train_gene_expr_recon_loss: 8801898.8011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34491314.4673; train_optim_loss: 34491314.4673; val_kl_reg_loss: 64048.6212; val_edge_recon_loss: 25739150.0500; val_gene_expr_recon_loss: 8890811.8812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34694010.5000; val_optim_loss: 34694010.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9918; val_auprc_score: 0.9895; val_best_acc_score: 0.9674; val_best_f1_score: 0.9680; train_kl_reg_loss: 64092.2682; train_edge_recon_loss: 25611191.5967; train_gene_expr_recon_loss: 8776588.6745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34451872.4784; train_optim_loss: 34451872.4784; val_kl_reg_loss: 63229.0459; val_edge_recon_loss: 25734211.1750; val_gene_expr_recon_loss: 8886236.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34683677.2000; val_optim_loss: 34683677.2000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9921; val_auprc_score: 0.9902; val_best_acc_score: 0.9679; val_best_f1_score: 0.9684; train_kl_reg_loss: 64538.5729; train_edge_recon_loss: 25598899.1794; train_gene_expr_recon_loss: 8754594.7204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34418032.5174; train_optim_loss: 34418032.5174; val_kl_reg_loss: 63140.3262; val_edge_recon_loss: 25709757.2000; val_gene_expr_recon_loss: 8849920.2438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34622817.8000; val_optim_loss: 34622817.8000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9918; val_auprc_score: 0.9896; val_best_acc_score: 0.9683; val_best_f1_score: 0.9689; train_kl_reg_loss: 64528.8686; train_edge_recon_loss: 25604268.7955; train_gene_expr_recon_loss: 8746320.0445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34415117.7330; train_optim_loss: 34415117.7330; val_kl_reg_loss: 63667.7520; val_edge_recon_loss: 25704810.6250; val_gene_expr_recon_loss: 8880533.3187; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34649011.7000; val_optim_loss: 34649011.7000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9922; val_auprc_score: 0.9902; val_best_acc_score: 0.9688; val_best_f1_score: 0.9694; train_kl_reg_loss: 64191.0960; train_edge_recon_loss: 25593295.3630; train_gene_expr_recon_loss: 8737629.2928; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34395115.7969; train_optim_loss: 34395115.7969; val_kl_reg_loss: 64056.3175; val_edge_recon_loss: 25689279.8750; val_gene_expr_recon_loss: 8840749.6312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34594085.7000; val_optim_loss: 34594085.7000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9922; val_auprc_score: 0.9900; val_best_acc_score: 0.9692; val_best_f1_score: 0.9697; train_kl_reg_loss: 64599.1620; train_edge_recon_loss: 25599920.2921; train_gene_expr_recon_loss: 8721673.8435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34386193.3741; train_optim_loss: 34386193.3741; val_kl_reg_loss: 64197.7085; val_edge_recon_loss: 25699628.7250; val_gene_expr_recon_loss: 8878011.6625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34641838.1000; val_optim_loss: 34641838.1000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9924; val_auprc_score: 0.9903; val_best_acc_score: 0.9701; val_best_f1_score: 0.9706; train_kl_reg_loss: 64745.8669; train_edge_recon_loss: 25601460.3004; train_gene_expr_recon_loss: 8742334.7364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34408540.8957; train_optim_loss: 34408540.8957; val_kl_reg_loss: 62887.7693; val_edge_recon_loss: 25687903.1500; val_gene_expr_recon_loss: 8859311.8187; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34610102.9500; val_optim_loss: 34610102.9500
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9924; val_auprc_score: 0.9903; val_best_acc_score: 0.9693; val_best_f1_score: 0.9698; train_kl_reg_loss: 63737.9005; train_edge_recon_loss: 25599486.1808; train_gene_expr_recon_loss: 8717215.8025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34380439.9249; train_optim_loss: 34380439.9249; val_kl_reg_loss: 62472.9690; val_edge_recon_loss: 25709830.6750; val_gene_expr_recon_loss: 8864274.5062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34636578.2000; val_optim_loss: 34636578.2000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9923; val_auprc_score: 0.9899; val_best_acc_score: 0.9705; val_best_f1_score: 0.9711; train_kl_reg_loss: 63717.3280; train_edge_recon_loss: 25598849.7135; train_gene_expr_recon_loss: 8706268.4611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34368835.4937; train_optim_loss: 34368835.4937; val_kl_reg_loss: 61905.8912; val_edge_recon_loss: 25700914.1750; val_gene_expr_recon_loss: 8859391.5437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34622211.5500; val_optim_loss: 34622211.5500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9926; val_auprc_score: 0.9905; val_best_acc_score: 0.9704; val_best_f1_score: 0.9709; train_kl_reg_loss: 64517.5140; train_edge_recon_loss: 25579224.1335; train_gene_expr_recon_loss: 8605286.5675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34249028.2476; train_optim_loss: 34249028.2476; val_kl_reg_loss: 64131.4333; val_edge_recon_loss: 25672628.0500; val_gene_expr_recon_loss: 8722909.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34459668.7000; val_optim_loss: 34459668.7000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9924; val_auprc_score: 0.9903; val_best_acc_score: 0.9705; val_best_f1_score: 0.9710; train_kl_reg_loss: 65840.8422; train_edge_recon_loss: 25566413.8220; train_gene_expr_recon_loss: 8589433.7531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34221688.3672; train_optim_loss: 34221688.3672; val_kl_reg_loss: 65066.5834; val_edge_recon_loss: 25669347.3750; val_gene_expr_recon_loss: 8746369.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34480783.2500; val_optim_loss: 34480783.2500
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9927; val_auprc_score: 0.9909; val_best_acc_score: 0.9706; val_best_f1_score: 0.9711; train_kl_reg_loss: 66061.8985; train_edge_recon_loss: 25564213.4298; train_gene_expr_recon_loss: 8581292.8227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34211568.0751; train_optim_loss: 34211568.0751; val_kl_reg_loss: 64749.5325; val_edge_recon_loss: 25671912.8000; val_gene_expr_recon_loss: 8731289.1937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34467951.4000; val_optim_loss: 34467951.4000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9928; val_auprc_score: 0.9909; val_best_acc_score: 0.9708; val_best_f1_score: 0.9713; train_kl_reg_loss: 66056.4146; train_edge_recon_loss: 25580718.0612; train_gene_expr_recon_loss: 8570337.3741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34217111.8025; train_optim_loss: 34217111.8025; val_kl_reg_loss: 64772.6710; val_edge_recon_loss: 25668951.8250; val_gene_expr_recon_loss: 8735174.9875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34468899.4000; val_optim_loss: 34468899.4000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9926; val_auprc_score: 0.9905; val_best_acc_score: 0.9703; val_best_f1_score: 0.9707; train_kl_reg_loss: 66140.8685; train_edge_recon_loss: 25575583.2851; train_gene_expr_recon_loss: 8564123.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34205847.5994; train_optim_loss: 34205847.5994; val_kl_reg_loss: 64920.5149; val_edge_recon_loss: 25683469.3750; val_gene_expr_recon_loss: 8730470.8625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34478860.7500; val_optim_loss: 34478860.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9925; val_auprc_score: 0.9905; val_best_acc_score: 0.9704; val_best_f1_score: 0.9709; train_kl_reg_loss: 66292.4958; train_edge_recon_loss: 25558784.4896; train_gene_expr_recon_loss: 8554943.2809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34180020.2420; train_optim_loss: 34180020.2420; val_kl_reg_loss: 65042.9841; val_edge_recon_loss: 25703375.6500; val_gene_expr_recon_loss: 8702483.2312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34470901.9500; val_optim_loss: 34470901.9500
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9925; val_auprc_score: 0.9906; val_best_acc_score: 0.9705; val_best_f1_score: 0.9710; train_kl_reg_loss: 66455.7009; train_edge_recon_loss: 25574205.3908; train_gene_expr_recon_loss: 8549576.3199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34190237.3408; train_optim_loss: 34190237.3408; val_kl_reg_loss: 65270.3550; val_edge_recon_loss: 25668672.7250; val_gene_expr_recon_loss: 8693119.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34427062.8750; val_optim_loss: 34427062.8750
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9927; val_auprc_score: 0.9905; val_best_acc_score: 0.9709; val_best_f1_score: 0.9713; train_kl_reg_loss: 66503.8275; train_edge_recon_loss: 25571612.0640; train_gene_expr_recon_loss: 8559956.8561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34198072.6871; train_optim_loss: 34198072.6871; val_kl_reg_loss: 65209.9008; val_edge_recon_loss: 25657187.9000; val_gene_expr_recon_loss: 8710789.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34433187.2500; val_optim_loss: 34433187.2500
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9927; val_auprc_score: 0.9906; val_best_acc_score: 0.9707; val_best_f1_score: 0.9712; train_kl_reg_loss: 66496.7893; train_edge_recon_loss: 25572293.7163; train_gene_expr_recon_loss: 8552527.2531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34191317.6217; train_optim_loss: 34191317.6217; val_kl_reg_loss: 65073.7935; val_edge_recon_loss: 25682253.6000; val_gene_expr_recon_loss: 8701829.4187; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34449156.7500; val_optim_loss: 34449156.7500
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9923; val_auprc_score: 0.9900; val_best_acc_score: 0.9697; val_best_f1_score: 0.9702; train_kl_reg_loss: 66543.6631; train_edge_recon_loss: 25569850.9096; train_gene_expr_recon_loss: 8544226.3950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34180620.9875; train_optim_loss: 34180620.9875; val_kl_reg_loss: 65500.6079; val_edge_recon_loss: 25705959.0000; val_gene_expr_recon_loss: 8703729.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34475188.4000; val_optim_loss: 34475188.4000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9927; val_auprc_score: 0.9904; val_best_acc_score: 0.9710; val_best_f1_score: 0.9715; train_kl_reg_loss: 66467.2690; train_edge_recon_loss: 25572234.3894; train_gene_expr_recon_loss: 8547265.3860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34185967.0709; train_optim_loss: 34185967.0709; val_kl_reg_loss: 65174.0862; val_edge_recon_loss: 25681692.9750; val_gene_expr_recon_loss: 8715615.6062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34462482.7000; val_optim_loss: 34462482.7000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9927; val_auprc_score: 0.9910; val_best_acc_score: 0.9709; val_best_f1_score: 0.9713; train_kl_reg_loss: 66523.3757; train_edge_recon_loss: 25570216.8651; train_gene_expr_recon_loss: 8552639.9868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34189380.1474; train_optim_loss: 34189380.1474; val_kl_reg_loss: 65205.0647; val_edge_recon_loss: 25664581.6750; val_gene_expr_recon_loss: 8727721.6312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34457508.4500; val_optim_loss: 34457508.4500
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9925; val_auprc_score: 0.9905; val_best_acc_score: 0.9706; val_best_f1_score: 0.9710; train_kl_reg_loss: 66549.4522; train_edge_recon_loss: 25570900.2392; train_gene_expr_recon_loss: 8546478.4013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34183928.1530; train_optim_loss: 34183928.1530; val_kl_reg_loss: 65157.3597; val_edge_recon_loss: 25684027.7500; val_gene_expr_recon_loss: 8699615.5813; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34448800.6750; val_optim_loss: 34448800.6750
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9926; val_auprc_score: 0.9905; val_best_acc_score: 0.9707; val_best_f1_score: 0.9713; train_kl_reg_loss: 66457.1477; train_edge_recon_loss: 25566086.4868; train_gene_expr_recon_loss: 8541217.4492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34173761.0821; train_optim_loss: 34173761.0821; val_kl_reg_loss: 65330.8806; val_edge_recon_loss: 25665700.0500; val_gene_expr_recon_loss: 8716908.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34447938.9250; val_optim_loss: 34447938.9250
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9926; val_auprc_score: 0.9907; val_best_acc_score: 0.9704; val_best_f1_score: 0.9709; train_kl_reg_loss: 66513.9842; train_edge_recon_loss: 25574362.9402; train_gene_expr_recon_loss: 8547499.3241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34188376.1836; train_optim_loss: 34188376.1836; val_kl_reg_loss: 65017.1196; val_edge_recon_loss: 25670966.1750; val_gene_expr_recon_loss: 8672325.0437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34408308.2500; val_optim_loss: 34408308.2500
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9928; val_auprc_score: 0.9909; val_best_acc_score: 0.9711; val_best_f1_score: 0.9716; train_kl_reg_loss: 66603.1998; train_edge_recon_loss: 25575502.7427; train_gene_expr_recon_loss: 8551228.8018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34193334.8401; train_optim_loss: 34193334.8401; val_kl_reg_loss: 65088.5725; val_edge_recon_loss: 25655112.5750; val_gene_expr_recon_loss: 8701267.2375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34421468.1250; val_optim_loss: 34421468.1250
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9926; val_auprc_score: 0.9904; val_best_acc_score: 0.9708; val_best_f1_score: 0.9713; train_kl_reg_loss: 66502.4770; train_edge_recon_loss: 25563680.0723; train_gene_expr_recon_loss: 8550661.0619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34180843.6328; train_optim_loss: 34180843.6328; val_kl_reg_loss: 65192.3502; val_edge_recon_loss: 25669265.9250; val_gene_expr_recon_loss: 8724860.7875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34459319.1000; val_optim_loss: 34459319.1000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9925; val_auprc_score: 0.9905; val_best_acc_score: 0.9706; val_best_f1_score: 0.9711; train_kl_reg_loss: 66479.2528; train_edge_recon_loss: 25561250.2058; train_gene_expr_recon_loss: 8546041.7531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34173771.2796; train_optim_loss: 34173771.2796; val_kl_reg_loss: 65016.1866; val_edge_recon_loss: 25676050.3500; val_gene_expr_recon_loss: 8677521.5250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34418588.0750; val_optim_loss: 34418588.0750
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9925; val_auprc_score: 0.9905; val_best_acc_score: 0.9704; val_best_f1_score: 0.9710; train_kl_reg_loss: 66536.5097; train_edge_recon_loss: 25567656.6871; train_gene_expr_recon_loss: 8551596.6426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34185789.8359; train_optim_loss: 34185789.8359; val_kl_reg_loss: 65098.0471; val_edge_recon_loss: 25687879.8500; val_gene_expr_recon_loss: 8707776.0188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34460753.8250; val_optim_loss: 34460753.8250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9926; val_auprc_score: 0.9906; val_best_acc_score: 0.9709; val_best_f1_score: 0.9714; train_kl_reg_loss: 66570.6447; train_edge_recon_loss: 25572021.3630; train_gene_expr_recon_loss: 8550275.7344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34188867.7302; train_optim_loss: 34188867.7302; val_kl_reg_loss: 65342.5713; val_edge_recon_loss: 25677577.3750; val_gene_expr_recon_loss: 8697494.4250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34440414.1000; val_optim_loss: 34440414.1000
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9926; val_auprc_score: 0.9907; val_best_acc_score: 0.9709; val_best_f1_score: 0.9714; train_kl_reg_loss: 66476.6006; train_edge_recon_loss: 25566341.4075; train_gene_expr_recon_loss: 8539802.3129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34172620.3032; train_optim_loss: 34172620.3032; val_kl_reg_loss: 65362.4669; val_edge_recon_loss: 25667103.8250; val_gene_expr_recon_loss: 8702046.7562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34434513.0000; val_optim_loss: 34434513.0000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9926; val_auprc_score: 0.9908; val_best_acc_score: 0.9704; val_best_f1_score: 0.9708; train_kl_reg_loss: 66628.1522; train_edge_recon_loss: 25561155.4854; train_gene_expr_recon_loss: 8559921.9708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34187705.6134; train_optim_loss: 34187705.6134; val_kl_reg_loss: 65356.5273; val_edge_recon_loss: 25685483.7750; val_gene_expr_recon_loss: 8707355.8938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34458195.9500; val_optim_loss: 34458195.9500
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9923; val_auprc_score: 0.9902; val_best_acc_score: 0.9700; val_best_f1_score: 0.9706; train_kl_reg_loss: 66522.8358; train_edge_recon_loss: 25557610.5229; train_gene_expr_recon_loss: 8543290.7184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34167424.0862; train_optim_loss: 34167424.0862; val_kl_reg_loss: 65358.3010; val_edge_recon_loss: 25703138.7500; val_gene_expr_recon_loss: 8707629.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34476126.7250; val_optim_loss: 34476126.7250

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 122 min 6 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
Val AUROC score: 0.9928
Val AUPRC score: 0.9907
Val best accuracy score: 0.9709
Val best F1 score: 0.9715
Val gene expr MSE score: 0.6674

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
