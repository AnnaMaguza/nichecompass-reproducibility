None
Run timestamp: 28072023_145913_62.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_62']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9553; val_auprc_score: 0.9497; val_best_acc_score: 0.8889; val_best_f1_score: 0.8910; train_kl_reg_loss: 2310.4621; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 122741.3865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 125051.8485; train_optim_loss: 125051.8485; val_kl_reg_loss: 1761.3411; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 112398.1481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 114159.4890; val_optim_loss: 114159.4890
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9620; val_auprc_score: 0.9584; val_best_acc_score: 0.8974; val_best_f1_score: 0.8983; train_kl_reg_loss: 1617.1670; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 110040.9570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 111658.1240; train_optim_loss: 111658.1240; val_kl_reg_loss: 1508.3697; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 107035.6570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 108544.0266; val_optim_loss: 108544.0266
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9681; val_auprc_score: 0.9650; val_best_acc_score: 0.9074; val_best_f1_score: 0.9087; train_kl_reg_loss: 1474.1636; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 106459.3287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 107933.4924; train_optim_loss: 107933.4924; val_kl_reg_loss: 1416.0702; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 104581.4130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105997.4834; val_optim_loss: 105997.4834
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9684; val_auprc_score: 0.9654; val_best_acc_score: 0.9080; val_best_f1_score: 0.9091; train_kl_reg_loss: 1415.2252; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 104777.1711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 106192.3963; train_optim_loss: 106192.3963; val_kl_reg_loss: 1387.0197; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103674.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105061.8868; val_optim_loss: 105061.8868
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9692; val_auprc_score: 0.9664; val_best_acc_score: 0.9088; val_best_f1_score: 0.9104; train_kl_reg_loss: 1383.5476; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103924.4201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105307.9678; train_optim_loss: 105307.9678; val_kl_reg_loss: 1365.6337; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 102942.5342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104308.1676; val_optim_loss: 104308.1676
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9689; val_auprc_score: 0.9655; val_best_acc_score: 0.9087; val_best_f1_score: 0.9110; train_kl_reg_loss: 1367.6192; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103403.0809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104770.7000; train_optim_loss: 104770.7000; val_kl_reg_loss: 1342.0349; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 102606.5682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 103948.6033; val_optim_loss: 103948.6033
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9691; val_auprc_score: 0.9659; val_best_acc_score: 0.9093; val_best_f1_score: 0.9111; train_kl_reg_loss: 1357.5339; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103080.4186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104437.9526; train_optim_loss: 104437.9526; val_kl_reg_loss: 1333.9553; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 102490.3123; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 103824.2676; val_optim_loss: 103824.2676
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9692; val_auprc_score: 0.9660; val_best_acc_score: 0.9098; val_best_f1_score: 0.9110; train_kl_reg_loss: 1348.4796; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102840.5278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104189.0074; train_optim_loss: 104189.0074; val_kl_reg_loss: 1322.6071; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 102476.1052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 103798.7123; val_optim_loss: 103798.7123
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9704; val_auprc_score: 0.9677; val_best_acc_score: 0.9109; val_best_f1_score: 0.9128; train_kl_reg_loss: 1344.0566; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102680.4739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104024.5305; train_optim_loss: 104024.5305; val_kl_reg_loss: 1316.7300; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 102082.8770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 103399.6069; val_optim_loss: 103399.6069
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9699; val_auprc_score: 0.9672; val_best_acc_score: 0.9103; val_best_f1_score: 0.9118; train_kl_reg_loss: 1340.8341; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102561.4317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 103902.2658; train_optim_loss: 103902.2658; val_kl_reg_loss: 1314.0863; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 102088.5302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 103402.6168; val_optim_loss: 103402.6168
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9705; val_auprc_score: 0.9676; val_best_acc_score: 0.9111; val_best_f1_score: 0.9134; train_kl_reg_loss: 1338.3609; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102477.9899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 103816.3508; train_optim_loss: 103816.3508; val_kl_reg_loss: 1314.3671; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 102096.8531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 103411.2201; val_optim_loss: 103411.2201
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9724; val_auprc_score: 0.9698; val_best_acc_score: 0.9145; val_best_f1_score: 0.9165; train_kl_reg_loss: 1335.9628; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102452.4560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 103788.4189; train_optim_loss: 103788.4189; val_kl_reg_loss: 1313.5884; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 102064.4423; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 103378.0307; val_optim_loss: 103378.0307
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9688; val_auprc_score: 0.9652; val_best_acc_score: 0.9086; val_best_f1_score: 0.9106; train_kl_reg_loss: 1333.3228; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102343.1763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 103676.4991; train_optim_loss: 103676.4991; val_kl_reg_loss: 1310.1819; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 102018.1434; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 103328.3254; val_optim_loss: 103328.3254
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9703; val_auprc_score: 0.9674; val_best_acc_score: 0.9111; val_best_f1_score: 0.9129; train_kl_reg_loss: 1330.8373; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102343.7335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 103674.5708; train_optim_loss: 103674.5708; val_kl_reg_loss: 1333.3188; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 101955.0588; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 103288.3774; val_optim_loss: 103288.3774
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9723; val_auprc_score: 0.9699; val_best_acc_score: 0.9141; val_best_f1_score: 0.9161; train_kl_reg_loss: 1328.7992; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102306.7184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 103635.5176; train_optim_loss: 103635.5176; val_kl_reg_loss: 1321.4020; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 101958.7167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 103280.1185; val_optim_loss: 103280.1185
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9724; val_auprc_score: 0.9699; val_best_acc_score: 0.9144; val_best_f1_score: 0.9162; train_kl_reg_loss: 1327.0291; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102224.6768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 103551.7059; train_optim_loss: 103551.7059; val_kl_reg_loss: 1322.8084; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 101973.4232; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 103296.2314; val_optim_loss: 103296.2314
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9719; val_auprc_score: 0.9692; val_best_acc_score: 0.9132; val_best_f1_score: 0.9156; train_kl_reg_loss: 1325.9798; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102188.2331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 103514.2129; train_optim_loss: 103514.2129; val_kl_reg_loss: 1309.5199; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 101886.0233; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 103195.5429; val_optim_loss: 103195.5429
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9743; val_auprc_score: 0.9720; val_best_acc_score: 0.9174; val_best_f1_score: 0.9193; train_kl_reg_loss: 1324.1334; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102143.7735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 103467.9068; train_optim_loss: 103467.9068; val_kl_reg_loss: 1292.5667; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 101734.4365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 103027.0037; val_optim_loss: 103027.0037
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9728; val_auprc_score: 0.9704; val_best_acc_score: 0.9159; val_best_f1_score: 0.9176; train_kl_reg_loss: 1323.5542; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102129.3718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 103452.9260; train_optim_loss: 103452.9260; val_kl_reg_loss: 1280.6706; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 101797.8761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 103078.5467; val_optim_loss: 103078.5467
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9721; val_auprc_score: 0.9694; val_best_acc_score: 0.9139; val_best_f1_score: 0.9158; train_kl_reg_loss: 1323.1491; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102162.2738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 103485.4230; train_optim_loss: 103485.4230; val_kl_reg_loss: 1301.3912; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 101863.7163; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 103165.1074; val_optim_loss: 103165.1074
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9732; val_auprc_score: 0.9706; val_best_acc_score: 0.9158; val_best_f1_score: 0.9175; train_kl_reg_loss: 1320.8704; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102102.4610; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 103423.3312; train_optim_loss: 103423.3312; val_kl_reg_loss: 1281.4992; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 101891.3245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 103172.8235; val_optim_loss: 103172.8235
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9711; val_auprc_score: 0.9684; val_best_acc_score: 0.9128; val_best_f1_score: 0.9144; train_kl_reg_loss: 1318.3756; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102081.0075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 103399.3831; train_optim_loss: 103399.3831; val_kl_reg_loss: 1307.4879; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 101766.1991; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 103073.6866; val_optim_loss: 103073.6866

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9744; val_auprc_score: 0.9725; val_best_acc_score: 0.9175; val_best_f1_score: 0.9192; train_kl_reg_loss: 1286.2482; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 101648.1491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 102934.3974; train_optim_loss: 102934.3974; val_kl_reg_loss: 1257.6841; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 101502.1049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 102759.7888; val_optim_loss: 102759.7888
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9730; val_auprc_score: 0.9706; val_best_acc_score: 0.9150; val_best_f1_score: 0.9168; train_kl_reg_loss: 1281.3209; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 101631.7891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 102913.1101; train_optim_loss: 102913.1101; val_kl_reg_loss: 1263.5465; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 101391.8944; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 102655.4407; val_optim_loss: 102655.4407
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9737; val_auprc_score: 0.9715; val_best_acc_score: 0.9158; val_best_f1_score: 0.9176; train_kl_reg_loss: 1280.0878; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 101585.5202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 102865.6081; train_optim_loss: 102865.6081; val_kl_reg_loss: 1264.2155; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 101502.6860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 102766.9015; val_optim_loss: 102766.9015
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9747; val_auprc_score: 0.9727; val_best_acc_score: 0.9182; val_best_f1_score: 0.9196; train_kl_reg_loss: 1279.9524; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 101566.0595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 102846.0121; train_optim_loss: 102846.0121; val_kl_reg_loss: 1261.0068; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 101494.5265; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 102755.5331; val_optim_loss: 102755.5331
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9733; val_auprc_score: 0.9711; val_best_acc_score: 0.9158; val_best_f1_score: 0.9175; train_kl_reg_loss: 1279.9726; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 101557.8740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 102837.8465; train_optim_loss: 102837.8465; val_kl_reg_loss: 1261.0237; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 101507.1637; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 102768.1874; val_optim_loss: 102768.1874
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9739; val_auprc_score: 0.9718; val_best_acc_score: 0.9160; val_best_f1_score: 0.9179; train_kl_reg_loss: 1279.8638; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 101562.4957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 102842.3594; train_optim_loss: 102842.3594; val_kl_reg_loss: 1260.7690; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 101519.4193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 102780.1880; val_optim_loss: 102780.1880

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9732; val_auprc_score: 0.9710; val_best_acc_score: 0.9152; val_best_f1_score: 0.9168; train_kl_reg_loss: 1275.9894; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 101535.6322; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 102811.6216; train_optim_loss: 102811.6216; val_kl_reg_loss: 1260.3830; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 101564.0606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 102824.4439; val_optim_loss: 102824.4439
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9737; val_auprc_score: 0.9713; val_best_acc_score: 0.9170; val_best_f1_score: 0.9184; train_kl_reg_loss: 1276.1588; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 101446.7288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 102722.8876; train_optim_loss: 102722.8876; val_kl_reg_loss: 1257.6890; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 101184.4278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 102442.1169; val_optim_loss: 102442.1169
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9744; val_auprc_score: 0.9723; val_best_acc_score: 0.9176; val_best_f1_score: 0.9189; train_kl_reg_loss: 1275.7110; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 101533.9981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 102809.7091; train_optim_loss: 102809.7091; val_kl_reg_loss: 1259.4375; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 101417.5900; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 102677.0277; val_optim_loss: 102677.0277
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9741; val_auprc_score: 0.9718; val_best_acc_score: 0.9174; val_best_f1_score: 0.9187; train_kl_reg_loss: 1276.1285; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 101467.7516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 102743.8800; train_optim_loss: 102743.8800; val_kl_reg_loss: 1258.5643; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 101317.6150; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 102576.1793; val_optim_loss: 102576.1793
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9739; val_auprc_score: 0.9717; val_best_acc_score: 0.9165; val_best_f1_score: 0.9181; train_kl_reg_loss: 1275.3715; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 101517.4573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 102792.8288; train_optim_loss: 102792.8288; val_kl_reg_loss: 1258.5484; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 101446.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 102704.7049; val_optim_loss: 102704.7049
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9739; val_auprc_score: 0.9717; val_best_acc_score: 0.9170; val_best_f1_score: 0.9183; train_kl_reg_loss: 1276.2150; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 101485.8632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 102762.0781; train_optim_loss: 102762.0781; val_kl_reg_loss: 1258.8268; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 101387.3779; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 102646.2048; val_optim_loss: 102646.2048

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9740; val_auprc_score: 0.9718; val_best_acc_score: 0.9167; val_best_f1_score: 0.9182; train_kl_reg_loss: 1276.2400; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 101488.4754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 102764.7153; train_optim_loss: 102764.7153; val_kl_reg_loss: 1259.0521; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 101325.6959; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 102584.7481; val_optim_loss: 102584.7481
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9735; val_auprc_score: 0.9713; val_best_acc_score: 0.9160; val_best_f1_score: 0.9177; train_kl_reg_loss: 1275.9398; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 101485.7241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 102761.6637; train_optim_loss: 102761.6637; val_kl_reg_loss: 1259.3797; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 101466.4777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 102725.8573; val_optim_loss: 102725.8573
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9734; val_auprc_score: 0.9709; val_best_acc_score: 0.9160; val_best_f1_score: 0.9175; train_kl_reg_loss: 1275.8284; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 101498.7548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 102774.5833; train_optim_loss: 102774.5833; val_kl_reg_loss: 1258.2686; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 101401.2441; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 102659.5127; val_optim_loss: 102659.5127
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9737; val_auprc_score: 0.9713; val_best_acc_score: 0.9170; val_best_f1_score: 0.9183; train_kl_reg_loss: 1275.5133; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 101469.3938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 102744.9071; train_optim_loss: 102744.9071; val_kl_reg_loss: 1258.6403; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 101378.8554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 102637.4957; val_optim_loss: 102637.4957

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 185 min 19 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
val AUROC score: 0.9735
val AUPRC score: 0.9712
val best accuracy score: 0.9156
val best F1 score: 0.9172
val target rna MSE score: 1.4111
val source rna MSE score: 0.1683

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
