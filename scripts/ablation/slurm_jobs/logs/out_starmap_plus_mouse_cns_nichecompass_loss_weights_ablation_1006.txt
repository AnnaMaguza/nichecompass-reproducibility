None
Run timestamp: 16072023_163317_1006.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_1006']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1818, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1818, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9893; val_auprc_score: 0.9854; val_best_acc_score: 0.9631; val_best_f1_score: 0.9638; train_kl_reg_loss: 11189.3170; train_edge_recon_loss: 2770269.5620; train_gene_expr_recon_loss: 20609104.6287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23390563.5588; train_optim_loss: 23390563.5588; val_kl_reg_loss: 13333.2872; val_edge_recon_loss: 2670743.5164; val_gene_expr_recon_loss: 19741403.8689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22425480.6557; val_optim_loss: 22425480.6557
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9906; val_auprc_score: 0.9865; val_best_acc_score: 0.9671; val_best_f1_score: 0.9676; train_kl_reg_loss: 13836.8666; train_edge_recon_loss: 2638897.9040; train_gene_expr_recon_loss: 19470818.5184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22123553.3088; train_optim_loss: 22123553.3088; val_kl_reg_loss: 15189.3604; val_edge_recon_loss: 2636386.9918; val_gene_expr_recon_loss: 19086203.8689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21737780.2623; val_optim_loss: 21737780.2623
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9915; val_auprc_score: 0.9884; val_best_acc_score: 0.9676; val_best_f1_score: 0.9681; train_kl_reg_loss: 15009.4437; train_edge_recon_loss: 2624471.2987; train_gene_expr_recon_loss: 18913336.5772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21552817.3088; train_optim_loss: 21552817.3088; val_kl_reg_loss: 15402.7689; val_edge_recon_loss: 2632753.8934; val_gene_expr_recon_loss: 18663185.3115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21311342.0328; val_optim_loss: 21311342.0328
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9920; val_auprc_score: 0.9892; val_best_acc_score: 0.9670; val_best_f1_score: 0.9675; train_kl_reg_loss: 15632.1788; train_edge_recon_loss: 2620021.2670; train_gene_expr_recon_loss: 18508027.9963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21143681.4449; train_optim_loss: 21143681.4449; val_kl_reg_loss: 15798.0653; val_edge_recon_loss: 2636328.3811; val_gene_expr_recon_loss: 18301396.9508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20953523.3443; val_optim_loss: 20953523.3443
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9913; val_auprc_score: 0.9881; val_best_acc_score: 0.9665; val_best_f1_score: 0.9670; train_kl_reg_loss: 15890.7046; train_edge_recon_loss: 2616564.0133; train_gene_expr_recon_loss: 18186584.2904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20819039.0515; train_optim_loss: 20819039.0515; val_kl_reg_loss: 16500.2516; val_edge_recon_loss: 2634386.5123; val_gene_expr_recon_loss: 18084981.8689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20735868.6557; val_optim_loss: 20735868.6557
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9910; val_auprc_score: 0.9878; val_best_acc_score: 0.9648; val_best_f1_score: 0.9654; train_kl_reg_loss: 16080.2598; train_edge_recon_loss: 2614737.0335; train_gene_expr_recon_loss: 17942164.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20572982.2610; train_optim_loss: 20572982.2610; val_kl_reg_loss: 15722.1516; val_edge_recon_loss: 2633954.7049; val_gene_expr_recon_loss: 18003357.4098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20653034.3279; val_optim_loss: 20653034.3279
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9906; val_auprc_score: 0.9871; val_best_acc_score: 0.9640; val_best_f1_score: 0.9647; train_kl_reg_loss: 16227.5653; train_edge_recon_loss: 2612066.3984; train_gene_expr_recon_loss: 17758920.5441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20387214.4926; train_optim_loss: 20387214.4926; val_kl_reg_loss: 16585.4678; val_edge_recon_loss: 2628096.3893; val_gene_expr_recon_loss: 17826392.2623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20471074.1639; val_optim_loss: 20471074.1639
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9901; val_auprc_score: 0.9862; val_best_acc_score: 0.9639; val_best_f1_score: 0.9646; train_kl_reg_loss: 16428.6534; train_edge_recon_loss: 2610089.0345; train_gene_expr_recon_loss: 17620947.8603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20247465.5478; train_optim_loss: 20247465.5478; val_kl_reg_loss: 17014.9574; val_edge_recon_loss: 2625214.4754; val_gene_expr_recon_loss: 17711374.9508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20353604.4590; val_optim_loss: 20353604.4590
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9906; val_auprc_score: 0.9869; val_best_acc_score: 0.9649; val_best_f1_score: 0.9656; train_kl_reg_loss: 16615.7359; train_edge_recon_loss: 2608155.0873; train_gene_expr_recon_loss: 17507821.9945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20132592.8640; train_optim_loss: 20132592.8640; val_kl_reg_loss: 17240.8798; val_edge_recon_loss: 2621637.9098; val_gene_expr_recon_loss: 17642089.7869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20280968.4918; val_optim_loss: 20280968.4918
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9901; val_auprc_score: 0.9861; val_best_acc_score: 0.9643; val_best_f1_score: 0.9651; train_kl_reg_loss: 16745.8097; train_edge_recon_loss: 2606013.7252; train_gene_expr_recon_loss: 17426515.1710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20049274.7169; train_optim_loss: 20049274.7169; val_kl_reg_loss: 16757.4589; val_edge_recon_loss: 2620967.5123; val_gene_expr_recon_loss: 17624809.9508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20262534.9180; val_optim_loss: 20262534.9180
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9908; val_auprc_score: 0.9873; val_best_acc_score: 0.9654; val_best_f1_score: 0.9661; train_kl_reg_loss: 16928.8951; train_edge_recon_loss: 2606239.5312; train_gene_expr_recon_loss: 17373469.3033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19996637.7537; train_optim_loss: 19996637.7537; val_kl_reg_loss: 17176.1831; val_edge_recon_loss: 2615141.9713; val_gene_expr_recon_loss: 17604151.6885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20236469.8033; val_optim_loss: 20236469.8033
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9909; val_auprc_score: 0.9878; val_best_acc_score: 0.9653; val_best_f1_score: 0.9660; train_kl_reg_loss: 16993.2591; train_edge_recon_loss: 2603846.1530; train_gene_expr_recon_loss: 17322157.6599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19942997.0478; train_optim_loss: 19942997.0478; val_kl_reg_loss: 17484.8320; val_edge_recon_loss: 2618123.0902; val_gene_expr_recon_loss: 17556523.6393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20192131.6393; val_optim_loss: 20192131.6393
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9908; val_auprc_score: 0.9874; val_best_acc_score: 0.9649; val_best_f1_score: 0.9656; train_kl_reg_loss: 17108.4771; train_edge_recon_loss: 2602777.1250; train_gene_expr_recon_loss: 17251215.0478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19871100.6397; train_optim_loss: 19871100.6397; val_kl_reg_loss: 17054.0734; val_edge_recon_loss: 2616023.8156; val_gene_expr_recon_loss: 17534567.8525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20167645.7049; val_optim_loss: 20167645.7049
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9906; val_auprc_score: 0.9869; val_best_acc_score: 0.9653; val_best_f1_score: 0.9660; train_kl_reg_loss: 17141.1040; train_edge_recon_loss: 2602131.4816; train_gene_expr_recon_loss: 17239601.5643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19858874.1471; train_optim_loss: 19858874.1471; val_kl_reg_loss: 17168.1106; val_edge_recon_loss: 2618388.3893; val_gene_expr_recon_loss: 17610637.4262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20246193.8689; val_optim_loss: 20246193.8689
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9906; val_auprc_score: 0.9873; val_best_acc_score: 0.9647; val_best_f1_score: 0.9655; train_kl_reg_loss: 17214.6738; train_edge_recon_loss: 2600925.7698; train_gene_expr_recon_loss: 17199013.1140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19817153.6029; train_optim_loss: 19817153.6029; val_kl_reg_loss: 17240.9684; val_edge_recon_loss: 2617752.2787; val_gene_expr_recon_loss: 17583445.4754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20218438.8852; val_optim_loss: 20218438.8852
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9913; val_auprc_score: 0.9884; val_best_acc_score: 0.9658; val_best_f1_score: 0.9665; train_kl_reg_loss: 17249.0295; train_edge_recon_loss: 2601033.1103; train_gene_expr_recon_loss: 17179750.7647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19798032.8897; train_optim_loss: 19798032.8897; val_kl_reg_loss: 17275.2839; val_edge_recon_loss: 2614991.1680; val_gene_expr_recon_loss: 17626169.6885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20258436.1639; val_optim_loss: 20258436.1639
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9911; val_auprc_score: 0.9881; val_best_acc_score: 0.9654; val_best_f1_score: 0.9661; train_kl_reg_loss: 17307.3419; train_edge_recon_loss: 2600057.8456; train_gene_expr_recon_loss: 17159335.0184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19776700.2316; train_optim_loss: 19776700.2316; val_kl_reg_loss: 17421.3156; val_edge_recon_loss: 2613849.0574; val_gene_expr_recon_loss: 17579578.7213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20210849.1475; val_optim_loss: 20210849.1475

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9905; val_auprc_score: 0.9872; val_best_acc_score: 0.9650; val_best_f1_score: 0.9657; train_kl_reg_loss: 18267.3529; train_edge_recon_loss: 2592545.5400; train_gene_expr_recon_loss: 16953474.2096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19564287.0515; train_optim_loss: 19564287.0515; val_kl_reg_loss: 17759.7917; val_edge_recon_loss: 2603953.8361; val_gene_expr_recon_loss: 17443493.0820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20065206.8525; val_optim_loss: 20065206.8525
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9907; val_auprc_score: 0.9878; val_best_acc_score: 0.9647; val_best_f1_score: 0.9653; train_kl_reg_loss: 17511.5534; train_edge_recon_loss: 2591040.5712; train_gene_expr_recon_loss: 16912525.8364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19521077.9890; train_optim_loss: 19521077.9890; val_kl_reg_loss: 17113.2202; val_edge_recon_loss: 2606603.9918; val_gene_expr_recon_loss: 17482017.4918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20105734.7541; val_optim_loss: 20105734.7541
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9903; val_auprc_score: 0.9872; val_best_acc_score: 0.9646; val_best_f1_score: 0.9653; train_kl_reg_loss: 17183.2866; train_edge_recon_loss: 2588648.1585; train_gene_expr_recon_loss: 16894203.7004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19500035.1213; train_optim_loss: 19500035.1213; val_kl_reg_loss: 16993.5581; val_edge_recon_loss: 2601940.4180; val_gene_expr_recon_loss: 17501011.6230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20119945.6721; val_optim_loss: 20119945.6721
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9906; val_auprc_score: 0.9876; val_best_acc_score: 0.9646; val_best_f1_score: 0.9652; train_kl_reg_loss: 17108.0431; train_edge_recon_loss: 2588237.3552; train_gene_expr_recon_loss: 16878588.8235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19483934.2298; train_optim_loss: 19483934.2298; val_kl_reg_loss: 16939.5031; val_edge_recon_loss: 2598308.3402; val_gene_expr_recon_loss: 17490533.1803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20105781.0164; val_optim_loss: 20105781.0164
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9904; val_auprc_score: 0.9871; val_best_acc_score: 0.9642; val_best_f1_score: 0.9649; train_kl_reg_loss: 17086.8293; train_edge_recon_loss: 2586955.7358; train_gene_expr_recon_loss: 16873085.6783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19477128.2224; train_optim_loss: 19477128.2224; val_kl_reg_loss: 16945.3459; val_edge_recon_loss: 2601036.6066; val_gene_expr_recon_loss: 17471918.5082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20089900.3607; val_optim_loss: 20089900.3607

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9904; val_auprc_score: 0.9874; val_best_acc_score: 0.9641; val_best_f1_score: 0.9649; train_kl_reg_loss: 17192.3846; train_edge_recon_loss: 2585964.2923; train_gene_expr_recon_loss: 16853354.1526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19456510.8493; train_optim_loss: 19456510.8493; val_kl_reg_loss: 17047.0970; val_edge_recon_loss: 2601184.7459; val_gene_expr_recon_loss: 17473771.4426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20092003.3770; val_optim_loss: 20092003.3770
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9904; val_auprc_score: 0.9872; val_best_acc_score: 0.9643; val_best_f1_score: 0.9650; train_kl_reg_loss: 17229.4542; train_edge_recon_loss: 2586765.4164; train_gene_expr_recon_loss: 16849525.5165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19453520.3676; train_optim_loss: 19453520.3676; val_kl_reg_loss: 17058.3640; val_edge_recon_loss: 2598182.7746; val_gene_expr_recon_loss: 17460639.4426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20075880.7541; val_optim_loss: 20075880.7541
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9911; val_auprc_score: 0.9881; val_best_acc_score: 0.9647; val_best_f1_score: 0.9654; train_kl_reg_loss: 17224.5295; train_edge_recon_loss: 2586415.6057; train_gene_expr_recon_loss: 16833434.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19437074.6103; train_optim_loss: 19437074.6103; val_kl_reg_loss: 17045.2494; val_edge_recon_loss: 2596692.8770; val_gene_expr_recon_loss: 17486190.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20099928.1311; val_optim_loss: 20099928.1311
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9897; val_auprc_score: 0.9863; val_best_acc_score: 0.9630; val_best_f1_score: 0.9637; train_kl_reg_loss: 17217.1137; train_edge_recon_loss: 2586059.8093; train_gene_expr_recon_loss: 16833651.6820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19436928.5956; train_optim_loss: 19436928.5956; val_kl_reg_loss: 17010.8741; val_edge_recon_loss: 2603129.1762; val_gene_expr_recon_loss: 17465802.9016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20085942.9180; val_optim_loss: 20085942.9180

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 155 min 13 sec.
Using best model state, which was in epoch 18.

--- MODEL EVALUATION ---
Val AUROC score: 0.9909
Val AUPRC score: 0.9881
Val best accuracy score: 0.9646
Val best F1 score: 0.9652
Val gene expr MSE score: 0.4702

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
