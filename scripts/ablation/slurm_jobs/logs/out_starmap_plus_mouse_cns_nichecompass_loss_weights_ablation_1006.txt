None
Run timestamp: 02072023_163503_1006.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_1006']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9873; val_auprc_score: 0.9823; val_best_acc_score: 0.9599; val_best_f1_score: 0.9608; train_kl_reg_loss: 2312.1194; train_edge_recon_loss: 27937.7883; train_gene_expr_recon_loss: 12964.0087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43213.9163; train_optim_loss: 43213.9163; val_kl_reg_loss: 2478.5647; val_edge_recon_loss: 26181.9171; val_gene_expr_recon_loss: 11705.5217; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40366.0034; val_optim_loss: 40366.0034
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9903; val_auprc_score: 0.9871; val_best_acc_score: 0.9653; val_best_f1_score: 0.9659; train_kl_reg_loss: 2495.1282; train_edge_recon_loss: 27237.0710; train_gene_expr_recon_loss: 11386.1426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41118.3417; train_optim_loss: 41118.3417; val_kl_reg_loss: 2508.6551; val_edge_recon_loss: 26114.7043; val_gene_expr_recon_loss: 11058.3452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39681.7045; val_optim_loss: 39681.7045
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9913; val_auprc_score: 0.9881; val_best_acc_score: 0.9687; val_best_f1_score: 0.9692; train_kl_reg_loss: 2508.7229; train_edge_recon_loss: 27180.8660; train_gene_expr_recon_loss: 10927.2442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40616.8330; train_optim_loss: 40616.8330; val_kl_reg_loss: 2428.3390; val_edge_recon_loss: 26036.3381; val_gene_expr_recon_loss: 10741.3456; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39206.0229; val_optim_loss: 39206.0229
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9923; val_auprc_score: 0.9899; val_best_acc_score: 0.9714; val_best_f1_score: 0.9718; train_kl_reg_loss: 2525.0907; train_edge_recon_loss: 27121.3335; train_gene_expr_recon_loss: 10650.1956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40296.6199; train_optim_loss: 40296.6199; val_kl_reg_loss: 2510.4054; val_edge_recon_loss: 25977.7656; val_gene_expr_recon_loss: 10519.4067; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39007.5776; val_optim_loss: 39007.5776
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9930; val_auprc_score: 0.9905; val_best_acc_score: 0.9731; val_best_f1_score: 0.9735; train_kl_reg_loss: 2539.2733; train_edge_recon_loss: 27077.3735; train_gene_expr_recon_loss: 10478.3609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40095.0077; train_optim_loss: 40095.0077; val_kl_reg_loss: 2530.6886; val_edge_recon_loss: 25984.4596; val_gene_expr_recon_loss: 10343.4516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38858.5999; val_optim_loss: 38858.5999
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9937; val_auprc_score: 0.9917; val_best_acc_score: 0.9743; val_best_f1_score: 0.9746; train_kl_reg_loss: 2549.3673; train_edge_recon_loss: 27051.3955; train_gene_expr_recon_loss: 10339.0224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39939.7852; train_optim_loss: 39939.7852; val_kl_reg_loss: 2492.1543; val_edge_recon_loss: 25944.9337; val_gene_expr_recon_loss: 10243.8186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38680.9065; val_optim_loss: 38680.9065
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9947; val_auprc_score: 0.9929; val_best_acc_score: 0.9760; val_best_f1_score: 0.9764; train_kl_reg_loss: 2560.6321; train_edge_recon_loss: 27023.8592; train_gene_expr_recon_loss: 10239.5967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39824.0880; train_optim_loss: 39824.0880; val_kl_reg_loss: 2551.4764; val_edge_recon_loss: 25882.9211; val_gene_expr_recon_loss: 10144.1100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38578.5076; val_optim_loss: 38578.5076
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9949; val_auprc_score: 0.9932; val_best_acc_score: 0.9770; val_best_f1_score: 0.9773; train_kl_reg_loss: 2572.1034; train_edge_recon_loss: 26985.8156; train_gene_expr_recon_loss: 10165.7668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39723.6858; train_optim_loss: 39723.6858; val_kl_reg_loss: 2601.6872; val_edge_recon_loss: 25898.5702; val_gene_expr_recon_loss: 10098.0452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38598.3027; val_optim_loss: 38598.3027
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9950; val_auprc_score: 0.9936; val_best_acc_score: 0.9776; val_best_f1_score: 0.9778; train_kl_reg_loss: 2581.9879; train_edge_recon_loss: 26962.3117; train_gene_expr_recon_loss: 10107.9434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39652.2430; train_optim_loss: 39652.2430; val_kl_reg_loss: 2595.0574; val_edge_recon_loss: 25865.2855; val_gene_expr_recon_loss: 10057.2900; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38517.6328; val_optim_loss: 38517.6328
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9959; val_auprc_score: 0.9948; val_best_acc_score: 0.9792; val_best_f1_score: 0.9795; train_kl_reg_loss: 2589.6425; train_edge_recon_loss: 26944.7836; train_gene_expr_recon_loss: 10060.9050; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39595.3312; train_optim_loss: 39595.3312; val_kl_reg_loss: 2565.3858; val_edge_recon_loss: 25825.0876; val_gene_expr_recon_loss: 10027.6209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38418.0944; val_optim_loss: 38418.0944
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9957; val_auprc_score: 0.9945; val_best_acc_score: 0.9791; val_best_f1_score: 0.9793; train_kl_reg_loss: 2597.2029; train_edge_recon_loss: 26929.7355; train_gene_expr_recon_loss: 10019.7900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39546.7283; train_optim_loss: 39546.7283; val_kl_reg_loss: 2623.1773; val_edge_recon_loss: 25830.2513; val_gene_expr_recon_loss: 9975.7264; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38429.1554; val_optim_loss: 38429.1554
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9962; val_auprc_score: 0.9950; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 2605.0242; train_edge_recon_loss: 26910.6227; train_gene_expr_recon_loss: 9986.0296; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39501.6764; train_optim_loss: 39501.6764; val_kl_reg_loss: 2581.8737; val_edge_recon_loss: 25827.4387; val_gene_expr_recon_loss: 9975.7534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38385.0656; val_optim_loss: 38385.0656
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9964; val_auprc_score: 0.9955; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 2611.8456; train_edge_recon_loss: 26892.2024; train_gene_expr_recon_loss: 9968.3906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39472.4388; train_optim_loss: 39472.4388; val_kl_reg_loss: 2578.2549; val_edge_recon_loss: 25797.5540; val_gene_expr_recon_loss: 9972.2272; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38348.0362; val_optim_loss: 38348.0362
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9962; val_auprc_score: 0.9951; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 2616.6606; train_edge_recon_loss: 26888.5252; train_gene_expr_recon_loss: 9943.1441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39448.3299; train_optim_loss: 39448.3299; val_kl_reg_loss: 2636.7446; val_edge_recon_loss: 25796.5086; val_gene_expr_recon_loss: 9965.2627; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38398.5159; val_optim_loss: 38398.5159
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9967; val_auprc_score: 0.9959; val_best_acc_score: 0.9819; val_best_f1_score: 0.9821; train_kl_reg_loss: 2623.5432; train_edge_recon_loss: 26869.7313; train_gene_expr_recon_loss: 9919.0423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39412.3167; train_optim_loss: 39412.3167; val_kl_reg_loss: 2599.7943; val_edge_recon_loss: 25754.1468; val_gene_expr_recon_loss: 9942.6703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38296.6112; val_optim_loss: 38296.6112
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9969; val_auprc_score: 0.9960; val_best_acc_score: 0.9824; val_best_f1_score: 0.9826; train_kl_reg_loss: 2629.0599; train_edge_recon_loss: 26859.0770; train_gene_expr_recon_loss: 9906.3354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39394.4723; train_optim_loss: 39394.4723; val_kl_reg_loss: 2638.4021; val_edge_recon_loss: 25752.2356; val_gene_expr_recon_loss: 9921.3673; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38312.0049; val_optim_loss: 38312.0049
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9971; val_auprc_score: 0.9964; val_best_acc_score: 0.9833; val_best_f1_score: 0.9835; train_kl_reg_loss: 2632.2868; train_edge_recon_loss: 26861.2511; train_gene_expr_recon_loss: 9892.5529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39386.0909; train_optim_loss: 39386.0909; val_kl_reg_loss: 2637.5637; val_edge_recon_loss: 25734.1304; val_gene_expr_recon_loss: 9905.9012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38277.5952; val_optim_loss: 38277.5952
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9971; val_auprc_score: 0.9963; val_best_acc_score: 0.9823; val_best_f1_score: 0.9825; train_kl_reg_loss: 2637.3400; train_edge_recon_loss: 26848.1265; train_gene_expr_recon_loss: 9873.6883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39359.1548; train_optim_loss: 39359.1548; val_kl_reg_loss: 2674.0223; val_edge_recon_loss: 25734.9161; val_gene_expr_recon_loss: 9910.6114; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38319.5498; val_optim_loss: 38319.5498
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9975; val_auprc_score: 0.9970; val_best_acc_score: 0.9843; val_best_f1_score: 0.9844; train_kl_reg_loss: 2643.6647; train_edge_recon_loss: 26832.0298; train_gene_expr_recon_loss: 9871.3925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39347.0870; train_optim_loss: 39347.0870; val_kl_reg_loss: 2652.4522; val_edge_recon_loss: 25701.8959; val_gene_expr_recon_loss: 9930.1408; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38284.4889; val_optim_loss: 38284.4889
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9975; val_auprc_score: 0.9967; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 2644.7224; train_edge_recon_loss: 26839.9609; train_gene_expr_recon_loss: 9848.7445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39333.4278; train_optim_loss: 39333.4278; val_kl_reg_loss: 2621.0321; val_edge_recon_loss: 25718.7845; val_gene_expr_recon_loss: 9906.2591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38246.0758; val_optim_loss: 38246.0758
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9975; val_auprc_score: 0.9970; val_best_acc_score: 0.9852; val_best_f1_score: 0.9853; train_kl_reg_loss: 2650.4637; train_edge_recon_loss: 26825.8172; train_gene_expr_recon_loss: 9839.7272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39316.0081; train_optim_loss: 39316.0081; val_kl_reg_loss: 2626.2464; val_edge_recon_loss: 25700.2984; val_gene_expr_recon_loss: 9928.3789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38254.9238; val_optim_loss: 38254.9238
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9974; val_auprc_score: 0.9965; val_best_acc_score: 0.9839; val_best_f1_score: 0.9841; train_kl_reg_loss: 2653.5787; train_edge_recon_loss: 26822.1041; train_gene_expr_recon_loss: 9835.1505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39310.8333; train_optim_loss: 39310.8333; val_kl_reg_loss: 2657.6861; val_edge_recon_loss: 25729.7563; val_gene_expr_recon_loss: 9915.1383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38302.5808; val_optim_loss: 38302.5808
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9976; val_auprc_score: 0.9968; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 2657.4648; train_edge_recon_loss: 26816.5209; train_gene_expr_recon_loss: 9821.1474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39295.1331; train_optim_loss: 39295.1331; val_kl_reg_loss: 2707.0555; val_edge_recon_loss: 25715.0141; val_gene_expr_recon_loss: 9887.0390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38309.1086; val_optim_loss: 38309.1086
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9974; val_auprc_score: 0.9966; val_best_acc_score: 0.9848; val_best_f1_score: 0.9849; train_kl_reg_loss: 2661.3129; train_edge_recon_loss: 26808.0916; train_gene_expr_recon_loss: 9808.4166; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39277.8209; train_optim_loss: 39277.8209; val_kl_reg_loss: 2667.7680; val_edge_recon_loss: 25708.2175; val_gene_expr_recon_loss: 9896.8170; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38272.8028; val_optim_loss: 38272.8028

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9979; val_auprc_score: 0.9973; val_best_acc_score: 0.9862; val_best_f1_score: 0.9863; train_kl_reg_loss: 2658.7667; train_edge_recon_loss: 26796.5717; train_gene_expr_recon_loss: 9764.7554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39220.0939; train_optim_loss: 39220.0939; val_kl_reg_loss: 2662.5037; val_edge_recon_loss: 25688.7431; val_gene_expr_recon_loss: 9877.5534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38228.7999; val_optim_loss: 38228.7999
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9978; val_auprc_score: 0.9972; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 2658.7696; train_edge_recon_loss: 26788.9362; train_gene_expr_recon_loss: 9759.1373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39206.8430; train_optim_loss: 39206.8430; val_kl_reg_loss: 2664.1535; val_edge_recon_loss: 25699.2931; val_gene_expr_recon_loss: 9894.6174; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38258.0637; val_optim_loss: 38258.0637
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9856; val_best_f1_score: 0.9858; train_kl_reg_loss: 2656.8221; train_edge_recon_loss: 26797.2911; train_gene_expr_recon_loss: 9751.9201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39206.0333; train_optim_loss: 39206.0333; val_kl_reg_loss: 2665.4313; val_edge_recon_loss: 25678.3992; val_gene_expr_recon_loss: 9898.6903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38242.5210; val_optim_loss: 38242.5210
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9856; val_best_f1_score: 0.9858; train_kl_reg_loss: 2659.0488; train_edge_recon_loss: 26783.8245; train_gene_expr_recon_loss: 9742.6385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39185.5118; train_optim_loss: 39185.5118; val_kl_reg_loss: 2669.1355; val_edge_recon_loss: 25701.9184; val_gene_expr_recon_loss: 9870.7382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38241.7921; val_optim_loss: 38241.7921
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9977; val_auprc_score: 0.9971; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 2659.7541; train_edge_recon_loss: 26778.6300; train_gene_expr_recon_loss: 9747.6984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39186.0826; train_optim_loss: 39186.0826; val_kl_reg_loss: 2667.0571; val_edge_recon_loss: 25698.3063; val_gene_expr_recon_loss: 9886.8113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38252.1748; val_optim_loss: 38252.1748

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9980; val_auprc_score: 0.9974; val_best_acc_score: 0.9861; val_best_f1_score: 0.9863; train_kl_reg_loss: 2658.7830; train_edge_recon_loss: 26786.1152; train_gene_expr_recon_loss: 9734.5229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39179.4212; train_optim_loss: 39179.4212; val_kl_reg_loss: 2663.3251; val_edge_recon_loss: 25684.3982; val_gene_expr_recon_loss: 9871.8134; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38219.5364; val_optim_loss: 38219.5364
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9980; val_auprc_score: 0.9973; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 2659.2266; train_edge_recon_loss: 26781.7472; train_gene_expr_recon_loss: 9732.5204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39173.4942; train_optim_loss: 39173.4942; val_kl_reg_loss: 2664.3429; val_edge_recon_loss: 25647.8447; val_gene_expr_recon_loss: 9890.0373; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38202.2248; val_optim_loss: 38202.2248
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9979; val_auprc_score: 0.9973; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 2658.6097; train_edge_recon_loss: 26785.8814; train_gene_expr_recon_loss: 9734.8106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39179.3017; train_optim_loss: 39179.3017; val_kl_reg_loss: 2665.4089; val_edge_recon_loss: 25708.3304; val_gene_expr_recon_loss: 9879.7447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38253.4837; val_optim_loss: 38253.4837
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9978; val_auprc_score: 0.9971; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 2658.1778; train_edge_recon_loss: 26787.8731; train_gene_expr_recon_loss: 9736.4263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39182.4771; train_optim_loss: 39182.4771; val_kl_reg_loss: 2664.6187; val_edge_recon_loss: 25690.0116; val_gene_expr_recon_loss: 9894.0750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38248.7052; val_optim_loss: 38248.7052
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 2659.4655; train_edge_recon_loss: 26781.2211; train_gene_expr_recon_loss: 9742.6397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39183.3262; train_optim_loss: 39183.3262; val_kl_reg_loss: 2664.8478; val_edge_recon_loss: 25679.6745; val_gene_expr_recon_loss: 9853.0280; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38197.5501; val_optim_loss: 38197.5501
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 2660.2203; train_edge_recon_loss: 26773.7790; train_gene_expr_recon_loss: 9741.7746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39175.7740; train_optim_loss: 39175.7740; val_kl_reg_loss: 2664.5145; val_edge_recon_loss: 25680.4702; val_gene_expr_recon_loss: 9875.4312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38220.4160; val_optim_loss: 38220.4160
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9981; val_auprc_score: 0.9973; val_best_acc_score: 0.9862; val_best_f1_score: 0.9863; train_kl_reg_loss: 2659.2141; train_edge_recon_loss: 26779.4204; train_gene_expr_recon_loss: 9737.6204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39176.2549; train_optim_loss: 39176.2549; val_kl_reg_loss: 2662.9429; val_edge_recon_loss: 25689.7887; val_gene_expr_recon_loss: 9886.0151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38238.7468; val_optim_loss: 38238.7468
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9979; val_auprc_score: 0.9971; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 2658.7500; train_edge_recon_loss: 26784.4773; train_gene_expr_recon_loss: 9743.4185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39186.6458; train_optim_loss: 39186.6458; val_kl_reg_loss: 2664.0024; val_edge_recon_loss: 25669.0130; val_gene_expr_recon_loss: 9891.8248; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38224.8405; val_optim_loss: 38224.8405
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9978; val_auprc_score: 0.9972; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 2659.1277; train_edge_recon_loss: 26778.7988; train_gene_expr_recon_loss: 9734.0497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39171.9762; train_optim_loss: 39171.9762; val_kl_reg_loss: 2663.3662; val_edge_recon_loss: 25684.9832; val_gene_expr_recon_loss: 9880.9071; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38229.2564; val_optim_loss: 38229.2564

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9977; val_auprc_score: 0.9966; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 2658.2587; train_edge_recon_loss: 26782.9000; train_gene_expr_recon_loss: 9727.7490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39168.9076; train_optim_loss: 39168.9076; val_kl_reg_loss: 2664.2346; val_edge_recon_loss: 25694.0629; val_gene_expr_recon_loss: 9885.5057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38243.8033; val_optim_loss: 38243.8033
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9865; val_best_f1_score: 0.9866; train_kl_reg_loss: 2658.4616; train_edge_recon_loss: 26780.4081; train_gene_expr_recon_loss: 9739.7189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39178.5887; train_optim_loss: 39178.5887; val_kl_reg_loss: 2664.9873; val_edge_recon_loss: 25651.0440; val_gene_expr_recon_loss: 9874.0926; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38190.1238; val_optim_loss: 38190.1238
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 2659.0084; train_edge_recon_loss: 26779.1122; train_gene_expr_recon_loss: 9739.7979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39177.9184; train_optim_loss: 39177.9184; val_kl_reg_loss: 2665.4927; val_edge_recon_loss: 25680.1017; val_gene_expr_recon_loss: 9876.6287; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38222.2234; val_optim_loss: 38222.2234
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9978; val_auprc_score: 0.9972; val_best_acc_score: 0.9857; val_best_f1_score: 0.9859; train_kl_reg_loss: 2658.9709; train_edge_recon_loss: 26780.2228; train_gene_expr_recon_loss: 9735.9645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39175.1581; train_optim_loss: 39175.1581; val_kl_reg_loss: 2665.3896; val_edge_recon_loss: 25712.2671; val_gene_expr_recon_loss: 9892.6536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38270.3103; val_optim_loss: 38270.3103
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9980; val_auprc_score: 0.9974; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 2659.1506; train_edge_recon_loss: 26784.3345; train_gene_expr_recon_loss: 9732.7370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39176.2221; train_optim_loss: 39176.2221; val_kl_reg_loss: 2664.4667; val_edge_recon_loss: 25688.9232; val_gene_expr_recon_loss: 9900.8041; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38254.1936; val_optim_loss: 38254.1936
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9980; val_auprc_score: 0.9976; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 2658.7789; train_edge_recon_loss: 26777.9673; train_gene_expr_recon_loss: 9729.7820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39166.5282; train_optim_loss: 39166.5282; val_kl_reg_loss: 2666.0988; val_edge_recon_loss: 25694.3231; val_gene_expr_recon_loss: 9898.8360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38259.2579; val_optim_loss: 38259.2579

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9978; val_auprc_score: 0.9971; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 2659.4203; train_edge_recon_loss: 26779.5459; train_gene_expr_recon_loss: 9730.4363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39169.4025; train_optim_loss: 39169.4025; val_kl_reg_loss: 2665.8992; val_edge_recon_loss: 25684.9499; val_gene_expr_recon_loss: 9902.1676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38253.0165; val_optim_loss: 38253.0165
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9980; val_auprc_score: 0.9972; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 2659.4448; train_edge_recon_loss: 26777.4233; train_gene_expr_recon_loss: 9734.0842; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39170.9522; train_optim_loss: 39170.9522; val_kl_reg_loss: 2665.2760; val_edge_recon_loss: 25684.3781; val_gene_expr_recon_loss: 9889.9823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38239.6365; val_optim_loss: 38239.6365
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9979; val_auprc_score: 0.9972; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 2659.2011; train_edge_recon_loss: 26783.8111; train_gene_expr_recon_loss: 9734.8450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39177.8572; train_optim_loss: 39177.8572; val_kl_reg_loss: 2665.5054; val_edge_recon_loss: 25673.2788; val_gene_expr_recon_loss: 9880.8455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38219.6299; val_optim_loss: 38219.6299
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9976; val_auprc_score: 0.9968; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 2658.9455; train_edge_recon_loss: 26781.8368; train_gene_expr_recon_loss: 9731.9027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39172.6850; train_optim_loss: 39172.6850; val_kl_reg_loss: 2665.3263; val_edge_recon_loss: 25690.9257; val_gene_expr_recon_loss: 9892.8676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38249.1194; val_optim_loss: 38249.1194

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 273 min 39 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
Val AUROC score: 0.9977
Val AUPRC score: 0.9972
Val best accuracy score: 0.9854
Val best F1 score: 0.9855
Val gene expr MSE score: 0.6488

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
