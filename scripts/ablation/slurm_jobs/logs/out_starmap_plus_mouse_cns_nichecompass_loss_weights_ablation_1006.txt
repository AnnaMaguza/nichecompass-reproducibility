None
Run timestamp: 03072023_171838_1006.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_1006']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9858; val_auprc_score: 0.9835; val_best_acc_score: 0.9472; val_best_f1_score: 0.9483; train_kl_reg_loss: 4991.0505; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 112893.5124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117884.5630; train_optim_loss: 117884.5630; val_kl_reg_loss: 3799.8920; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 104768.1023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 108567.9945; val_optim_loss: 108567.9945
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9889; val_auprc_score: 0.9875; val_best_acc_score: 0.9536; val_best_f1_score: 0.9535; train_kl_reg_loss: 3334.8420; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102848.2003; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 106183.0423; train_optim_loss: 106183.0423; val_kl_reg_loss: 2991.9997; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 101356.1215; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 104348.1213; val_optim_loss: 104348.1213
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9903; val_auprc_score: 0.9892; val_best_acc_score: 0.9578; val_best_f1_score: 0.9581; train_kl_reg_loss: 2798.7683; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 100212.6533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 103011.4216; train_optim_loss: 103011.4216; val_kl_reg_loss: 2587.7512; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 99239.9743; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 101827.7249; val_optim_loss: 101827.7249
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9914; val_auprc_score: 0.9905; val_best_acc_score: 0.9603; val_best_f1_score: 0.9609; train_kl_reg_loss: 2544.4567; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 98453.3849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 100997.8417; train_optim_loss: 100997.8417; val_kl_reg_loss: 2415.7555; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 98132.4064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 100548.1615; val_optim_loss: 100548.1615
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9918; val_auprc_score: 0.9909; val_best_acc_score: 0.9618; val_best_f1_score: 0.9619; train_kl_reg_loss: 2399.4845; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 97291.5705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 99691.0550; train_optim_loss: 99691.0550; val_kl_reg_loss: 2310.8060; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 97614.3286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 99925.1342; val_optim_loss: 99925.1342
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9930; val_auprc_score: 0.9924; val_best_acc_score: 0.9639; val_best_f1_score: 0.9642; train_kl_reg_loss: 2308.9705; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 96405.5028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 98714.4734; train_optim_loss: 98714.4734; val_kl_reg_loss: 2226.6503; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 96870.1440; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 99096.7942; val_optim_loss: 99096.7942
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9932; val_auprc_score: 0.9927; val_best_acc_score: 0.9648; val_best_f1_score: 0.9648; train_kl_reg_loss: 2257.6985; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 95709.7086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 97967.4071; train_optim_loss: 97967.4071; val_kl_reg_loss: 2164.0766; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 96224.1242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 98388.2009; val_optim_loss: 98388.2009
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9938; val_auprc_score: 0.9934; val_best_acc_score: 0.9665; val_best_f1_score: 0.9667; train_kl_reg_loss: 2225.9229; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 95232.2507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 97458.1734; train_optim_loss: 97458.1734; val_kl_reg_loss: 2208.3615; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 96248.9887; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 98457.3502; val_optim_loss: 98457.3502
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9942; val_auprc_score: 0.9935; val_best_acc_score: 0.9678; val_best_f1_score: 0.9677; train_kl_reg_loss: 2206.3136; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 94748.5081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 96954.8215; train_optim_loss: 96954.8215; val_kl_reg_loss: 2167.0605; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 96027.2788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 98194.3397; val_optim_loss: 98194.3397
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9945; val_auprc_score: 0.9941; val_best_acc_score: 0.9690; val_best_f1_score: 0.9691; train_kl_reg_loss: 2201.4164; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 94409.3656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 96610.7819; train_optim_loss: 96610.7819; val_kl_reg_loss: 2175.3084; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 95979.0410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 98154.3495; val_optim_loss: 98154.3495
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9947; val_auprc_score: 0.9941; val_best_acc_score: 0.9686; val_best_f1_score: 0.9685; train_kl_reg_loss: 2200.8154; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 94144.0615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 96344.8767; train_optim_loss: 96344.8767; val_kl_reg_loss: 2182.4622; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 95682.6758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 97865.1381; val_optim_loss: 97865.1381
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9952; val_auprc_score: 0.9949; val_best_acc_score: 0.9718; val_best_f1_score: 0.9719; train_kl_reg_loss: 2204.0452; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 93695.2198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 95899.2651; train_optim_loss: 95899.2651; val_kl_reg_loss: 2179.1562; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 96012.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 98191.5654; val_optim_loss: 98191.5654
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9953; val_auprc_score: 0.9951; val_best_acc_score: 0.9713; val_best_f1_score: 0.9712; train_kl_reg_loss: 2207.7793; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 93574.4032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 95782.1825; train_optim_loss: 95782.1825; val_kl_reg_loss: 2200.3271; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 95910.6408; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 98110.9670; val_optim_loss: 98110.9670
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9952; val_auprc_score: 0.9951; val_best_acc_score: 0.9722; val_best_f1_score: 0.9723; train_kl_reg_loss: 2218.4025; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 93234.3993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 95452.8019; train_optim_loss: 95452.8019; val_kl_reg_loss: 2203.3021; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 95634.2711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 97837.5731; val_optim_loss: 97837.5731
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9955; val_auprc_score: 0.9953; val_best_acc_score: 0.9716; val_best_f1_score: 0.9715; train_kl_reg_loss: 2225.5458; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 93068.3994; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 95293.9451; train_optim_loss: 95293.9451; val_kl_reg_loss: 2176.8070; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 95767.7723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 97944.5795; val_optim_loss: 97944.5795
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9959; val_auprc_score: 0.9957; val_best_acc_score: 0.9727; val_best_f1_score: 0.9728; train_kl_reg_loss: 2233.4041; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 92883.7257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 95117.1299; train_optim_loss: 95117.1299; val_kl_reg_loss: 2228.2366; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 95735.1614; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 97963.3975; val_optim_loss: 97963.3975
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9957; val_auprc_score: 0.9952; val_best_acc_score: 0.9727; val_best_f1_score: 0.9726; train_kl_reg_loss: 2245.7671; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 92653.5293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94899.2964; train_optim_loss: 94899.2964; val_kl_reg_loss: 2242.0731; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 95681.1177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 97923.1912; val_optim_loss: 97923.1912
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9959; val_auprc_score: 0.9955; val_best_acc_score: 0.9733; val_best_f1_score: 0.9735; train_kl_reg_loss: 2252.7998; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 92597.4602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94850.2600; train_optim_loss: 94850.2600; val_kl_reg_loss: 2230.9723; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 95821.2764; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 98052.2486; val_optim_loss: 98052.2486

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9961; val_auprc_score: 0.9960; val_best_acc_score: 0.9737; val_best_f1_score: 0.9736; train_kl_reg_loss: 2220.9683; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 91714.0330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93935.0013; train_optim_loss: 93935.0013; val_kl_reg_loss: 2185.0029; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 95560.7214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 97745.7246; val_optim_loss: 97745.7246
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9960; val_auprc_score: 0.9957; val_best_acc_score: 0.9736; val_best_f1_score: 0.9738; train_kl_reg_loss: 2219.5639; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 91740.0496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93959.6134; train_optim_loss: 93959.6134; val_kl_reg_loss: 2185.4470; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 95521.4440; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 97706.8908; val_optim_loss: 97706.8908
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9961; val_auprc_score: 0.9960; val_best_acc_score: 0.9744; val_best_f1_score: 0.9746; train_kl_reg_loss: 2218.8234; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 91605.1501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93823.9735; train_optim_loss: 93823.9735; val_kl_reg_loss: 2196.3915; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 95560.5403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 97756.9325; val_optim_loss: 97756.9325
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9961; val_auprc_score: 0.9958; val_best_acc_score: 0.9739; val_best_f1_score: 0.9741; train_kl_reg_loss: 2221.0073; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 91543.5074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93764.5146; train_optim_loss: 93764.5146; val_kl_reg_loss: 2191.7466; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 95821.2540; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 98013.0006; val_optim_loss: 98013.0006
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9961; val_auprc_score: 0.9959; val_best_acc_score: 0.9742; val_best_f1_score: 0.9743; train_kl_reg_loss: 2222.9981; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 91577.4036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93800.4018; train_optim_loss: 93800.4018; val_kl_reg_loss: 2201.3959; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 95757.4808; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 97958.8767; val_optim_loss: 97958.8767
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9961; val_auprc_score: 0.9958; val_best_acc_score: 0.9745; val_best_f1_score: 0.9745; train_kl_reg_loss: 2224.4253; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 91545.8786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93770.3039; train_optim_loss: 93770.3039; val_kl_reg_loss: 2203.8563; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 95630.4310; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 97834.2873; val_optim_loss: 97834.2873

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9961; val_auprc_score: 0.9957; val_best_acc_score: 0.9745; val_best_f1_score: 0.9745; train_kl_reg_loss: 2223.4197; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 91447.9806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93671.4002; train_optim_loss: 93671.4002; val_kl_reg_loss: 2194.6952; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 95616.1368; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 97810.8321; val_optim_loss: 97810.8321
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9959; val_auprc_score: 0.9957; val_best_acc_score: 0.9742; val_best_f1_score: 0.9742; train_kl_reg_loss: 2221.3788; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 91507.9419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93729.3207; train_optim_loss: 93729.3207; val_kl_reg_loss: 2192.1511; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 95455.1760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 97647.3272; val_optim_loss: 97647.3272
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9961; val_auprc_score: 0.9958; val_best_acc_score: 0.9746; val_best_f1_score: 0.9746; train_kl_reg_loss: 2220.5134; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 91472.4861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93692.9995; train_optim_loss: 93692.9995; val_kl_reg_loss: 2193.0156; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 95614.1824; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 97807.1977; val_optim_loss: 97807.1977
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9962; val_auprc_score: 0.9961; val_best_acc_score: 0.9747; val_best_f1_score: 0.9747; train_kl_reg_loss: 2218.9717; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 91465.4152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93684.3869; train_optim_loss: 93684.3869; val_kl_reg_loss: 2192.9443; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 95721.3436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 97914.2882; val_optim_loss: 97914.2882
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9963; val_auprc_score: 0.9963; val_best_acc_score: 0.9747; val_best_f1_score: 0.9747; train_kl_reg_loss: 2219.5069; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 91387.6049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93607.1117; train_optim_loss: 93607.1117; val_kl_reg_loss: 2190.8690; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 95606.7724; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 97797.6413; val_optim_loss: 97797.6413
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9961; val_auprc_score: 0.9958; val_best_acc_score: 0.9744; val_best_f1_score: 0.9745; train_kl_reg_loss: 2219.1723; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 91394.5942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93613.7663; train_optim_loss: 93613.7663; val_kl_reg_loss: 2192.8575; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 95510.2194; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 97703.0771; val_optim_loss: 97703.0771

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9961; val_auprc_score: 0.9959; val_best_acc_score: 0.9741; val_best_f1_score: 0.9741; train_kl_reg_loss: 2220.3738; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 91463.5364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93683.9103; train_optim_loss: 93683.9103; val_kl_reg_loss: 2193.6093; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 95588.0676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 97781.6770; val_optim_loss: 97781.6770
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9963; val_auprc_score: 0.9962; val_best_acc_score: 0.9749; val_best_f1_score: 0.9749; train_kl_reg_loss: 2220.4730; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 91419.4432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93639.9162; train_optim_loss: 93639.9162; val_kl_reg_loss: 2194.8988; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 95620.6195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 97815.5184; val_optim_loss: 97815.5184
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9962; val_auprc_score: 0.9959; val_best_acc_score: 0.9749; val_best_f1_score: 0.9749; train_kl_reg_loss: 2220.5675; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 91413.5961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93634.1635; train_optim_loss: 93634.1635; val_kl_reg_loss: 2192.9839; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 95619.7919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 97812.7755; val_optim_loss: 97812.7755
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9963; val_auprc_score: 0.9961; val_best_acc_score: 0.9753; val_best_f1_score: 0.9753; train_kl_reg_loss: 2220.2415; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 91454.8865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93675.1280; train_optim_loss: 93675.1280; val_kl_reg_loss: 2192.3979; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 95519.8692; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 97712.2673; val_optim_loss: 97712.2673

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 193 min 29 sec.
Using best model state, which was in epoch 26.

--- MODEL EVALUATION ---
Val AUROC score: 0.9961
Val AUPRC score: 0.9960
Val best accuracy score: 0.9742
Val best F1 score: 0.9742
Val gene expr MSE score: 0.6246

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
