None
Run timestamp: 03082023_032409_7.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '128', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_7']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 128
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9842; val_auprc_score: 0.9806; val_best_acc_score: 0.9425; val_best_f1_score: 0.9439; train_kl_reg_loss: 6043.0085; train_edge_recon_loss: 265921.0510; train_gene_expr_recon_loss: 109818.7927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 381782.8523; train_optim_loss: 381782.8523; val_kl_reg_loss: 6417.6708; val_edge_recon_loss: 264377.8066; val_gene_expr_recon_loss: 94581.9710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 365377.4490; val_optim_loss: 365377.4490
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9867; val_auprc_score: 0.9840; val_best_acc_score: 0.9484; val_best_f1_score: 0.9494; train_kl_reg_loss: 6473.7921; train_edge_recon_loss: 262461.0841; train_gene_expr_recon_loss: 91440.8421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 360375.7180; train_optim_loss: 360375.7180; val_kl_reg_loss: 6590.8152; val_edge_recon_loss: 262782.4518; val_gene_expr_recon_loss: 89442.4428; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 358815.7103; val_optim_loss: 358815.7103
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9881; val_auprc_score: 0.9854; val_best_acc_score: 0.9524; val_best_f1_score: 0.9531; train_kl_reg_loss: 6549.2803; train_edge_recon_loss: 261842.4144; train_gene_expr_recon_loss: 88960.9974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 357352.6920; train_optim_loss: 357352.6920; val_kl_reg_loss: 6595.5125; val_edge_recon_loss: 262339.4130; val_gene_expr_recon_loss: 88295.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 357230.3832; val_optim_loss: 357230.3832
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9893; val_auprc_score: 0.9870; val_best_acc_score: 0.9556; val_best_f1_score: 0.9563; train_kl_reg_loss: 6552.6678; train_edge_recon_loss: 261364.8329; train_gene_expr_recon_loss: 88084.6409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 356002.1414; train_optim_loss: 356002.1414; val_kl_reg_loss: 6595.0867; val_edge_recon_loss: 262197.4769; val_gene_expr_recon_loss: 87525.8173; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 356318.3796; val_optim_loss: 356318.3796
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9901; val_auprc_score: 0.9879; val_best_acc_score: 0.9576; val_best_f1_score: 0.9582; train_kl_reg_loss: 6551.3731; train_edge_recon_loss: 261130.3238; train_gene_expr_recon_loss: 87571.3383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 355253.0354; train_optim_loss: 355253.0354; val_kl_reg_loss: 6622.6524; val_edge_recon_loss: 262230.8858; val_gene_expr_recon_loss: 87348.5768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 356202.1147; val_optim_loss: 356202.1147
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9902; val_auprc_score: 0.9880; val_best_acc_score: 0.9579; val_best_f1_score: 0.9586; train_kl_reg_loss: 6546.9369; train_edge_recon_loss: 260986.8838; train_gene_expr_recon_loss: 87306.3571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 354840.1780; train_optim_loss: 354840.1780; val_kl_reg_loss: 6587.9582; val_edge_recon_loss: 261620.2215; val_gene_expr_recon_loss: 87538.5629; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 355746.7425; val_optim_loss: 355746.7425
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9892; val_auprc_score: 0.9864; val_best_acc_score: 0.9576; val_best_f1_score: 0.9582; train_kl_reg_loss: 6543.6937; train_edge_recon_loss: 260863.9654; train_gene_expr_recon_loss: 86978.1098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 354385.7689; train_optim_loss: 354385.7689; val_kl_reg_loss: 6501.0151; val_edge_recon_loss: 261969.7912; val_gene_expr_recon_loss: 87651.9079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 356122.7137; val_optim_loss: 356122.7137
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9901; val_auprc_score: 0.9877; val_best_acc_score: 0.9587; val_best_f1_score: 0.9593; train_kl_reg_loss: 6547.5849; train_edge_recon_loss: 260652.6046; train_gene_expr_recon_loss: 86710.4862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 353910.6757; train_optim_loss: 353910.6757; val_kl_reg_loss: 6635.2781; val_edge_recon_loss: 261673.3425; val_gene_expr_recon_loss: 86548.1319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 354856.7524; val_optim_loss: 354856.7524
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9898; val_auprc_score: 0.9871; val_best_acc_score: 0.9587; val_best_f1_score: 0.9593; train_kl_reg_loss: 6536.6629; train_edge_recon_loss: 260631.5243; train_gene_expr_recon_loss: 86464.1632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 353632.3505; train_optim_loss: 353632.3505; val_kl_reg_loss: 6646.2038; val_edge_recon_loss: 261372.2348; val_gene_expr_recon_loss: 86458.3260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 354476.7638; val_optim_loss: 354476.7638
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9895; val_auprc_score: 0.9867; val_best_acc_score: 0.9580; val_best_f1_score: 0.9588; train_kl_reg_loss: 6540.3630; train_edge_recon_loss: 260545.8412; train_gene_expr_recon_loss: 86359.0309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 353445.2352; train_optim_loss: 353445.2352; val_kl_reg_loss: 6507.0231; val_edge_recon_loss: 261266.7813; val_gene_expr_recon_loss: 85924.8482; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 353698.6520; val_optim_loss: 353698.6520
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9911; val_auprc_score: 0.9891; val_best_acc_score: 0.9611; val_best_f1_score: 0.9617; train_kl_reg_loss: 6536.7235; train_edge_recon_loss: 260469.8291; train_gene_expr_recon_loss: 86194.4614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 353201.0141; train_optim_loss: 353201.0141; val_kl_reg_loss: 6484.1981; val_edge_recon_loss: 261167.7367; val_gene_expr_recon_loss: 86320.7677; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 353972.7020; val_optim_loss: 353972.7020
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9916; val_auprc_score: 0.9897; val_best_acc_score: 0.9625; val_best_f1_score: 0.9631; train_kl_reg_loss: 6538.2476; train_edge_recon_loss: 260420.5387; train_gene_expr_recon_loss: 85949.0110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 352907.7973; train_optim_loss: 352907.7973; val_kl_reg_loss: 6549.8215; val_edge_recon_loss: 261111.0078; val_gene_expr_recon_loss: 85770.2946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 353431.1238; val_optim_loss: 353431.1238
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9909; val_auprc_score: 0.9886; val_best_acc_score: 0.9609; val_best_f1_score: 0.9615; train_kl_reg_loss: 6535.4403; train_edge_recon_loss: 260314.5933; train_gene_expr_recon_loss: 85833.0975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 352683.1308; train_optim_loss: 352683.1308; val_kl_reg_loss: 6656.8538; val_edge_recon_loss: 260991.4284; val_gene_expr_recon_loss: 85658.9647; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 353307.2469; val_optim_loss: 353307.2469
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9908; val_auprc_score: 0.9886; val_best_acc_score: 0.9607; val_best_f1_score: 0.9614; train_kl_reg_loss: 6534.4070; train_edge_recon_loss: 260228.8560; train_gene_expr_recon_loss: 85738.2331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 352501.4960; train_optim_loss: 352501.4960; val_kl_reg_loss: 6597.3527; val_edge_recon_loss: 260959.1784; val_gene_expr_recon_loss: 86138.1204; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 353694.6519; val_optim_loss: 353694.6519
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9913; val_auprc_score: 0.9892; val_best_acc_score: 0.9625; val_best_f1_score: 0.9630; train_kl_reg_loss: 6535.6251; train_edge_recon_loss: 260330.2450; train_gene_expr_recon_loss: 85622.7489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 352488.6189; train_optim_loss: 352488.6189; val_kl_reg_loss: 6622.1451; val_edge_recon_loss: 261076.6745; val_gene_expr_recon_loss: 85089.7271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 352788.5464; val_optim_loss: 352788.5464
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9909; val_auprc_score: 0.9888; val_best_acc_score: 0.9611; val_best_f1_score: 0.9617; train_kl_reg_loss: 6537.1306; train_edge_recon_loss: 260200.4600; train_gene_expr_recon_loss: 85552.6114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 352290.2021; train_optim_loss: 352290.2021; val_kl_reg_loss: 6559.4472; val_edge_recon_loss: 261052.1227; val_gene_expr_recon_loss: 85075.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 352686.9447; val_optim_loss: 352686.9447
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9911; val_auprc_score: 0.9889; val_best_acc_score: 0.9612; val_best_f1_score: 0.9618; train_kl_reg_loss: 6535.6067; train_edge_recon_loss: 260227.5868; train_gene_expr_recon_loss: 85555.6590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 352318.8524; train_optim_loss: 352318.8524; val_kl_reg_loss: 6505.0255; val_edge_recon_loss: 261300.0142; val_gene_expr_recon_loss: 85244.5381; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 353049.5779; val_optim_loss: 353049.5779
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9913; val_auprc_score: 0.9891; val_best_acc_score: 0.9623; val_best_f1_score: 0.9630; train_kl_reg_loss: 6528.0333; train_edge_recon_loss: 260127.0849; train_gene_expr_recon_loss: 85184.4080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 351839.5259; train_optim_loss: 351839.5259; val_kl_reg_loss: 6494.0359; val_edge_recon_loss: 260793.9815; val_gene_expr_recon_loss: 85165.2405; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 352453.2579; val_optim_loss: 352453.2579
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9910; val_auprc_score: 0.9887; val_best_acc_score: 0.9620; val_best_f1_score: 0.9626; train_kl_reg_loss: 6541.8646; train_edge_recon_loss: 260185.4326; train_gene_expr_recon_loss: 85603.6174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 352330.9146; train_optim_loss: 352330.9146; val_kl_reg_loss: 6591.9757; val_edge_recon_loss: 260967.6572; val_gene_expr_recon_loss: 88776.5995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 356336.2318; val_optim_loss: 356336.2318
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9913; val_auprc_score: 0.9891; val_best_acc_score: 0.9621; val_best_f1_score: 0.9628; train_kl_reg_loss: 6553.2399; train_edge_recon_loss: 260124.3717; train_gene_expr_recon_loss: 85486.8718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 352164.4837; train_optim_loss: 352164.4837; val_kl_reg_loss: 6543.3132; val_edge_recon_loss: 260788.0787; val_gene_expr_recon_loss: 85812.9776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 353144.3699; val_optim_loss: 353144.3699
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9919; val_auprc_score: 0.9901; val_best_acc_score: 0.9633; val_best_f1_score: 0.9639; train_kl_reg_loss: 6553.5425; train_edge_recon_loss: 260121.3784; train_gene_expr_recon_loss: 85370.4200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 352045.3412; train_optim_loss: 352045.3412; val_kl_reg_loss: 6425.4445; val_edge_recon_loss: 260913.6734; val_gene_expr_recon_loss: 85363.9032; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 352703.0211; val_optim_loss: 352703.0211
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9913; val_auprc_score: 0.9888; val_best_acc_score: 0.9629; val_best_f1_score: 0.9634; train_kl_reg_loss: 6539.9196; train_edge_recon_loss: 260053.1454; train_gene_expr_recon_loss: 84934.3086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 351527.3735; train_optim_loss: 351527.3735; val_kl_reg_loss: 6646.2404; val_edge_recon_loss: 260641.9855; val_gene_expr_recon_loss: 85947.0896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 353235.3159; val_optim_loss: 353235.3159

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9923; val_auprc_score: 0.9902; val_best_acc_score: 0.9658; val_best_f1_score: 0.9663; train_kl_reg_loss: 6511.4354; train_edge_recon_loss: 259513.2988; train_gene_expr_recon_loss: 82671.7904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348696.5246; train_optim_loss: 348696.5246; val_kl_reg_loss: 6519.0877; val_edge_recon_loss: 260163.8616; val_gene_expr_recon_loss: 82699.3436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 349382.2924; val_optim_loss: 349382.2924
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9923; val_auprc_score: 0.9901; val_best_acc_score: 0.9659; val_best_f1_score: 0.9664; train_kl_reg_loss: 6479.7861; train_edge_recon_loss: 259385.7654; train_gene_expr_recon_loss: 82379.6323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348245.1838; train_optim_loss: 348245.1838; val_kl_reg_loss: 6802.8993; val_edge_recon_loss: 260242.1013; val_gene_expr_recon_loss: 82843.1931; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 349888.1943; val_optim_loss: 349888.1943
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9924; val_auprc_score: 0.9902; val_best_acc_score: 0.9658; val_best_f1_score: 0.9663; train_kl_reg_loss: 6465.0554; train_edge_recon_loss: 259303.8215; train_gene_expr_recon_loss: 82300.8649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348069.7420; train_optim_loss: 348069.7420; val_kl_reg_loss: 6484.3039; val_edge_recon_loss: 259989.8144; val_gene_expr_recon_loss: 82452.4992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348926.6179; val_optim_loss: 348926.6179
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9925; val_auprc_score: 0.9906; val_best_acc_score: 0.9664; val_best_f1_score: 0.9669; train_kl_reg_loss: 6453.2943; train_edge_recon_loss: 259373.6923; train_gene_expr_recon_loss: 82257.0808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348084.0677; train_optim_loss: 348084.0677; val_kl_reg_loss: 6442.2342; val_edge_recon_loss: 260049.8624; val_gene_expr_recon_loss: 82318.4435; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348810.5399; val_optim_loss: 348810.5399
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9924; val_auprc_score: 0.9902; val_best_acc_score: 0.9659; val_best_f1_score: 0.9663; train_kl_reg_loss: 6448.3000; train_edge_recon_loss: 259271.6437; train_gene_expr_recon_loss: 82212.2555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347932.1990; train_optim_loss: 347932.1990; val_kl_reg_loss: 6434.9750; val_edge_recon_loss: 260051.3379; val_gene_expr_recon_loss: 82428.5944; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348914.9067; val_optim_loss: 348914.9067
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9924; val_auprc_score: 0.9905; val_best_acc_score: 0.9657; val_best_f1_score: 0.9662; train_kl_reg_loss: 6436.5145; train_edge_recon_loss: 259291.3819; train_gene_expr_recon_loss: 82180.5817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347908.4782; train_optim_loss: 347908.4782; val_kl_reg_loss: 6405.3557; val_edge_recon_loss: 260196.4650; val_gene_expr_recon_loss: 82293.7044; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348895.5244; val_optim_loss: 348895.5244
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9923; val_auprc_score: 0.9904; val_best_acc_score: 0.9664; val_best_f1_score: 0.9668; train_kl_reg_loss: 6431.8905; train_edge_recon_loss: 259285.1952; train_gene_expr_recon_loss: 82164.7328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347881.8187; train_optim_loss: 347881.8187; val_kl_reg_loss: 6435.3706; val_edge_recon_loss: 259973.7932; val_gene_expr_recon_loss: 82319.2533; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348728.4177; val_optim_loss: 348728.4177
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9926; val_auprc_score: 0.9908; val_best_acc_score: 0.9667; val_best_f1_score: 0.9672; train_kl_reg_loss: 6426.6807; train_edge_recon_loss: 259222.3690; train_gene_expr_recon_loss: 82132.5684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347781.6181; train_optim_loss: 347781.6181; val_kl_reg_loss: 6440.4304; val_edge_recon_loss: 259959.1341; val_gene_expr_recon_loss: 82321.1773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348720.7412; val_optim_loss: 348720.7412
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9928; val_auprc_score: 0.9908; val_best_acc_score: 0.9672; val_best_f1_score: 0.9676; train_kl_reg_loss: 6422.0970; train_edge_recon_loss: 259193.1247; train_gene_expr_recon_loss: 82078.1593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347693.3812; train_optim_loss: 347693.3812; val_kl_reg_loss: 6440.2658; val_edge_recon_loss: 259869.0544; val_gene_expr_recon_loss: 82279.6792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348588.9994; val_optim_loss: 348588.9994
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9925; val_auprc_score: 0.9905; val_best_acc_score: 0.9668; val_best_f1_score: 0.9673; train_kl_reg_loss: 6415.7753; train_edge_recon_loss: 259206.9534; train_gene_expr_recon_loss: 82076.0498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347698.7788; train_optim_loss: 347698.7788; val_kl_reg_loss: 6418.9909; val_edge_recon_loss: 259950.1575; val_gene_expr_recon_loss: 82210.2940; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348579.4421; val_optim_loss: 348579.4421
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9929; val_auprc_score: 0.9910; val_best_acc_score: 0.9676; val_best_f1_score: 0.9680; train_kl_reg_loss: 6413.2975; train_edge_recon_loss: 259194.7203; train_gene_expr_recon_loss: 82059.5092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347667.5268; train_optim_loss: 347667.5268; val_kl_reg_loss: 6425.2636; val_edge_recon_loss: 259667.3501; val_gene_expr_recon_loss: 82269.0730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348361.6874; val_optim_loss: 348361.6874
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9928; val_auprc_score: 0.9910; val_best_acc_score: 0.9669; val_best_f1_score: 0.9674; train_kl_reg_loss: 6414.6679; train_edge_recon_loss: 259085.3605; train_gene_expr_recon_loss: 82050.5365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347550.5648; train_optim_loss: 347550.5648; val_kl_reg_loss: 6430.5838; val_edge_recon_loss: 259789.0443; val_gene_expr_recon_loss: 82305.7735; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348525.4014; val_optim_loss: 348525.4014
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9928; val_auprc_score: 0.9909; val_best_acc_score: 0.9669; val_best_f1_score: 0.9674; train_kl_reg_loss: 6412.5857; train_edge_recon_loss: 259133.0845; train_gene_expr_recon_loss: 81996.9790; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347542.6492; train_optim_loss: 347542.6492; val_kl_reg_loss: 6379.2627; val_edge_recon_loss: 259862.6792; val_gene_expr_recon_loss: 82227.1118; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348469.0539; val_optim_loss: 348469.0539
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9929; val_auprc_score: 0.9910; val_best_acc_score: 0.9674; val_best_f1_score: 0.9678; train_kl_reg_loss: 6405.6350; train_edge_recon_loss: 259121.7879; train_gene_expr_recon_loss: 81960.7646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347488.1876; train_optim_loss: 347488.1876; val_kl_reg_loss: 6546.7092; val_edge_recon_loss: 259816.7797; val_gene_expr_recon_loss: 82203.4564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348566.9453; val_optim_loss: 348566.9453
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9930; val_auprc_score: 0.9913; val_best_acc_score: 0.9675; val_best_f1_score: 0.9680; train_kl_reg_loss: 6402.4707; train_edge_recon_loss: 259077.3138; train_gene_expr_recon_loss: 81941.1830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347420.9675; train_optim_loss: 347420.9675; val_kl_reg_loss: 6419.9888; val_edge_recon_loss: 259816.4289; val_gene_expr_recon_loss: 82134.3028; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348370.7210; val_optim_loss: 348370.7210

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9927; val_auprc_score: 0.9907; val_best_acc_score: 0.9673; val_best_f1_score: 0.9677; train_kl_reg_loss: 6400.1519; train_edge_recon_loss: 259100.3334; train_gene_expr_recon_loss: 81744.9218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347245.4073; train_optim_loss: 347245.4073; val_kl_reg_loss: 6415.3737; val_edge_recon_loss: 259962.3350; val_gene_expr_recon_loss: 81938.3807; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348316.0889; val_optim_loss: 348316.0889
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9928; val_auprc_score: 0.9911; val_best_acc_score: 0.9671; val_best_f1_score: 0.9676; train_kl_reg_loss: 6398.1663; train_edge_recon_loss: 259095.6492; train_gene_expr_recon_loss: 81697.4765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347191.2919; train_optim_loss: 347191.2919; val_kl_reg_loss: 6385.7877; val_edge_recon_loss: 259806.2657; val_gene_expr_recon_loss: 82020.4293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348212.4833; val_optim_loss: 348212.4833
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9930; val_auprc_score: 0.9911; val_best_acc_score: 0.9677; val_best_f1_score: 0.9682; train_kl_reg_loss: 6396.7074; train_edge_recon_loss: 259040.0320; train_gene_expr_recon_loss: 81750.2952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347187.0345; train_optim_loss: 347187.0345; val_kl_reg_loss: 6399.9070; val_edge_recon_loss: 259610.5388; val_gene_expr_recon_loss: 81949.7712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 347960.2166; val_optim_loss: 347960.2166
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9933; val_auprc_score: 0.9917; val_best_acc_score: 0.9681; val_best_f1_score: 0.9684; train_kl_reg_loss: 6393.0847; train_edge_recon_loss: 259009.4304; train_gene_expr_recon_loss: 81688.6152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347091.1306; train_optim_loss: 347091.1306; val_kl_reg_loss: 6387.7143; val_edge_recon_loss: 259530.6628; val_gene_expr_recon_loss: 81917.9307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 347836.3082; val_optim_loss: 347836.3082
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9929; val_auprc_score: 0.9912; val_best_acc_score: 0.9676; val_best_f1_score: 0.9680; train_kl_reg_loss: 6394.4784; train_edge_recon_loss: 259000.0669; train_gene_expr_recon_loss: 81743.3024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347137.8475; train_optim_loss: 347137.8475; val_kl_reg_loss: 6404.6332; val_edge_recon_loss: 259852.2515; val_gene_expr_recon_loss: 82003.2859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348260.1704; val_optim_loss: 348260.1704
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9925; val_auprc_score: 0.9905; val_best_acc_score: 0.9667; val_best_f1_score: 0.9672; train_kl_reg_loss: 6396.1607; train_edge_recon_loss: 259029.7150; train_gene_expr_recon_loss: 81737.2666; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347163.1422; train_optim_loss: 347163.1422; val_kl_reg_loss: 6404.6595; val_edge_recon_loss: 259850.5949; val_gene_expr_recon_loss: 81928.8634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348184.1186; val_optim_loss: 348184.1186
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9930; val_auprc_score: 0.9912; val_best_acc_score: 0.9682; val_best_f1_score: 0.9687; train_kl_reg_loss: 6395.1587; train_edge_recon_loss: 258990.8440; train_gene_expr_recon_loss: 81645.5358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347031.5385; train_optim_loss: 347031.5385; val_kl_reg_loss: 6401.2719; val_edge_recon_loss: 259660.4184; val_gene_expr_recon_loss: 82020.2391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348081.9290; val_optim_loss: 348081.9290
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9929; val_auprc_score: 0.9910; val_best_acc_score: 0.9677; val_best_f1_score: 0.9682; train_kl_reg_loss: 6392.5593; train_edge_recon_loss: 259016.7285; train_gene_expr_recon_loss: 81687.8922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347097.1799; train_optim_loss: 347097.1799; val_kl_reg_loss: 6400.4346; val_edge_recon_loss: 259665.6962; val_gene_expr_recon_loss: 81947.0176; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348013.1478; val_optim_loss: 348013.1478

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9927; val_auprc_score: 0.9907; val_best_acc_score: 0.9677; val_best_f1_score: 0.9682; train_kl_reg_loss: 6396.1835; train_edge_recon_loss: 258986.7347; train_gene_expr_recon_loss: 81639.9364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347022.8547; train_optim_loss: 347022.8547; val_kl_reg_loss: 6395.3876; val_edge_recon_loss: 259530.1946; val_gene_expr_recon_loss: 81878.7861; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 347804.3683; val_optim_loss: 347804.3683
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9927; val_auprc_score: 0.9909; val_best_acc_score: 0.9671; val_best_f1_score: 0.9677; train_kl_reg_loss: 6393.8616; train_edge_recon_loss: 259011.2046; train_gene_expr_recon_loss: 81673.8097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347078.8760; train_optim_loss: 347078.8760; val_kl_reg_loss: 6399.6860; val_edge_recon_loss: 259811.2225; val_gene_expr_recon_loss: 81913.4876; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348124.3966; val_optim_loss: 348124.3966
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9929; val_auprc_score: 0.9910; val_best_acc_score: 0.9679; val_best_f1_score: 0.9684; train_kl_reg_loss: 6393.3978; train_edge_recon_loss: 259062.1507; train_gene_expr_recon_loss: 81684.1059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347139.6545; train_optim_loss: 347139.6545; val_kl_reg_loss: 6393.8528; val_edge_recon_loss: 259536.4468; val_gene_expr_recon_loss: 81894.6777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 347824.9774; val_optim_loss: 347824.9774
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9930; val_auprc_score: 0.9911; val_best_acc_score: 0.9681; val_best_f1_score: 0.9686; train_kl_reg_loss: 6394.0874; train_edge_recon_loss: 259003.9452; train_gene_expr_recon_loss: 81679.2326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347077.2653; train_optim_loss: 347077.2653; val_kl_reg_loss: 6398.1945; val_edge_recon_loss: 259509.3848; val_gene_expr_recon_loss: 82036.5436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 347944.1226; val_optim_loss: 347944.1226
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9930; val_auprc_score: 0.9912; val_best_acc_score: 0.9673; val_best_f1_score: 0.9678; train_kl_reg_loss: 6392.1430; train_edge_recon_loss: 259064.3351; train_gene_expr_recon_loss: 81695.0620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347151.5398; train_optim_loss: 347151.5398; val_kl_reg_loss: 6402.3706; val_edge_recon_loss: 259777.3853; val_gene_expr_recon_loss: 81967.1961; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348146.9512; val_optim_loss: 348146.9512

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9927; val_auprc_score: 0.9906; val_best_acc_score: 0.9676; val_best_f1_score: 0.9681; train_kl_reg_loss: 6395.3285; train_edge_recon_loss: 259068.5753; train_gene_expr_recon_loss: 81665.4327; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347129.3364; train_optim_loss: 347129.3364; val_kl_reg_loss: 6396.6601; val_edge_recon_loss: 259757.1790; val_gene_expr_recon_loss: 81901.1457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348054.9847; val_optim_loss: 348054.9847
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9927; val_auprc_score: 0.9907; val_best_acc_score: 0.9668; val_best_f1_score: 0.9673; train_kl_reg_loss: 6393.2732; train_edge_recon_loss: 258938.0645; train_gene_expr_recon_loss: 81658.7903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 346990.1280; train_optim_loss: 346990.1280; val_kl_reg_loss: 6396.5383; val_edge_recon_loss: 260051.7667; val_gene_expr_recon_loss: 81904.6736; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348352.9784; val_optim_loss: 348352.9784
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9932; val_auprc_score: 0.9915; val_best_acc_score: 0.9678; val_best_f1_score: 0.9682; train_kl_reg_loss: 6393.3717; train_edge_recon_loss: 259042.8056; train_gene_expr_recon_loss: 81628.5164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347064.6935; train_optim_loss: 347064.6935; val_kl_reg_loss: 6394.6693; val_edge_recon_loss: 259401.0120; val_gene_expr_recon_loss: 81861.8529; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 347657.5339; val_optim_loss: 347657.5339
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9928; val_auprc_score: 0.9909; val_best_acc_score: 0.9671; val_best_f1_score: 0.9676; train_kl_reg_loss: 6393.7593; train_edge_recon_loss: 259000.2233; train_gene_expr_recon_loss: 81680.8417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347074.8245; train_optim_loss: 347074.8245; val_kl_reg_loss: 6397.3727; val_edge_recon_loss: 259842.6849; val_gene_expr_recon_loss: 81973.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348213.0572; val_optim_loss: 348213.0572
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9927; val_auprc_score: 0.9905; val_best_acc_score: 0.9672; val_best_f1_score: 0.9677; train_kl_reg_loss: 6392.9658; train_edge_recon_loss: 259081.3575; train_gene_expr_recon_loss: 81680.5414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347154.8647; train_optim_loss: 347154.8647; val_kl_reg_loss: 6396.3590; val_edge_recon_loss: 259986.5707; val_gene_expr_recon_loss: 82013.4811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348396.4111; val_optim_loss: 348396.4111
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9928; val_auprc_score: 0.9908; val_best_acc_score: 0.9672; val_best_f1_score: 0.9677; train_kl_reg_loss: 6393.7047; train_edge_recon_loss: 258916.2899; train_gene_expr_recon_loss: 81680.3020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 346990.2967; train_optim_loss: 346990.2967; val_kl_reg_loss: 6399.1601; val_edge_recon_loss: 259667.6112; val_gene_expr_recon_loss: 81945.9783; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348012.7486; val_optim_loss: 348012.7486
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9927; val_auprc_score: 0.9906; val_best_acc_score: 0.9676; val_best_f1_score: 0.9680; train_kl_reg_loss: 6393.0978; train_edge_recon_loss: 259028.1143; train_gene_expr_recon_loss: 81659.9551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347081.1674; train_optim_loss: 347081.1674; val_kl_reg_loss: 6397.5204; val_edge_recon_loss: 259722.7688; val_gene_expr_recon_loss: 82037.5238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348157.8127; val_optim_loss: 348157.8127

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000004e-08.

Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9930; val_auprc_score: 0.9910; val_best_acc_score: 0.9680; val_best_f1_score: 0.9684; train_kl_reg_loss: 6394.2504; train_edge_recon_loss: 259012.1548; train_gene_expr_recon_loss: 81692.6529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347099.0582; train_optim_loss: 347099.0582; val_kl_reg_loss: 6398.4260; val_edge_recon_loss: 259611.2559; val_gene_expr_recon_loss: 81979.6382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 347989.3202; val_optim_loss: 347989.3202
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9929; val_auprc_score: 0.9909; val_best_acc_score: 0.9677; val_best_f1_score: 0.9682; train_kl_reg_loss: 6394.5378; train_edge_recon_loss: 259021.3872; train_gene_expr_recon_loss: 81699.3466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347115.2714; train_optim_loss: 347115.2714; val_kl_reg_loss: 6395.8312; val_edge_recon_loss: 259664.8530; val_gene_expr_recon_loss: 81954.5521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348015.2364; val_optim_loss: 348015.2364
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9930; val_auprc_score: 0.9912; val_best_acc_score: 0.9675; val_best_f1_score: 0.9679; train_kl_reg_loss: 6392.8943; train_edge_recon_loss: 258949.7849; train_gene_expr_recon_loss: 81667.7656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347010.4447; train_optim_loss: 347010.4447; val_kl_reg_loss: 6395.5779; val_edge_recon_loss: 259817.9190; val_gene_expr_recon_loss: 81955.7478; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348169.2450; val_optim_loss: 348169.2450
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9928; val_auprc_score: 0.9909; val_best_acc_score: 0.9673; val_best_f1_score: 0.9678; train_kl_reg_loss: 6393.6953; train_edge_recon_loss: 259000.2122; train_gene_expr_recon_loss: 81696.9757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347090.8832; train_optim_loss: 347090.8832; val_kl_reg_loss: 6397.2331; val_edge_recon_loss: 259710.2842; val_gene_expr_recon_loss: 81996.4898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348104.0068; val_optim_loss: 348104.0068

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1872 min 8 sec.
Using best model state, which was in epoch 53.

--- MODEL EVALUATION ---
val AUROC score: 0.9929
val AUPRC score: 0.9910
val best accuracy score: 0.9682
val best F1 score: 0.9685
val target rna MSE score: 0.2449
val source rna MSE score: 0.1730

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
