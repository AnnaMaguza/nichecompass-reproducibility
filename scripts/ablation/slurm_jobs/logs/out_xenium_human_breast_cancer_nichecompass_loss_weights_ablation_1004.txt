None
Run timestamp: 15072023_200430_1004.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_1004']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9415; val_auprc_score: 0.9254; val_best_acc_score: 0.8808; val_best_f1_score: 0.8879; train_kl_reg_loss: 12614.1860; train_edge_recon_loss: 2766340.4412; train_gene_expr_recon_loss: 13136589.6118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15915544.2309; train_optim_loss: 15915544.2309; val_kl_reg_loss: 14630.3163; val_edge_recon_loss: 2736856.1184; val_gene_expr_recon_loss: 12445390.6579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15196877.1447; val_optim_loss: 15196877.1447
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9497; val_auprc_score: 0.9361; val_best_acc_score: 0.8906; val_best_f1_score: 0.8968; train_kl_reg_loss: 14888.9394; train_edge_recon_loss: 2667561.0577; train_gene_expr_recon_loss: 12203157.7147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14885607.7059; train_optim_loss: 14885607.7059; val_kl_reg_loss: 14177.9968; val_edge_recon_loss: 2727094.1447; val_gene_expr_recon_loss: 11962482.9211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14703755.0789; val_optim_loss: 14703755.0789
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9527; val_auprc_score: 0.9396; val_best_acc_score: 0.8951; val_best_f1_score: 0.9003; train_kl_reg_loss: 14538.4794; train_edge_recon_loss: 2656443.0533; train_gene_expr_recon_loss: 11814638.9544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14485620.4824; train_optim_loss: 14485620.4824; val_kl_reg_loss: 14637.3014; val_edge_recon_loss: 2724536.6875; val_gene_expr_recon_loss: 11720102.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14459276.4868; val_optim_loss: 14459276.4868
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9563; val_auprc_score: 0.9447; val_best_acc_score: 0.8985; val_best_f1_score: 0.9033; train_kl_reg_loss: 14647.3320; train_edge_recon_loss: 2649982.2452; train_gene_expr_recon_loss: 11603301.4382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14267931.0059; train_optim_loss: 14267931.0059; val_kl_reg_loss: 14567.7293; val_edge_recon_loss: 2717088.9737; val_gene_expr_recon_loss: 11513419.7632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14245076.4474; val_optim_loss: 14245076.4474
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9547; val_auprc_score: 0.9430; val_best_acc_score: 0.8965; val_best_f1_score: 0.9016; train_kl_reg_loss: 14578.9778; train_edge_recon_loss: 2646120.5324; train_gene_expr_recon_loss: 11476636.0735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14137335.5882; train_optim_loss: 14137335.5882; val_kl_reg_loss: 14313.4606; val_edge_recon_loss: 2715843.3586; val_gene_expr_recon_loss: 11435683.4474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14165840.3158; val_optim_loss: 14165840.3158
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9556; val_auprc_score: 0.9440; val_best_acc_score: 0.8981; val_best_f1_score: 0.9027; train_kl_reg_loss: 14610.3075; train_edge_recon_loss: 2643128.1669; train_gene_expr_recon_loss: 11398091.3382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14055829.7926; train_optim_loss: 14055829.7926; val_kl_reg_loss: 14248.7179; val_edge_recon_loss: 2705882.7928; val_gene_expr_recon_loss: 11359060.2632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14079191.7895; val_optim_loss: 14079191.7895
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9540; val_auprc_score: 0.9415; val_best_acc_score: 0.8958; val_best_f1_score: 0.9011; train_kl_reg_loss: 14651.0710; train_edge_recon_loss: 2639803.4243; train_gene_expr_recon_loss: 11347913.7118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14002368.1926; train_optim_loss: 14002368.1926; val_kl_reg_loss: 14200.7993; val_edge_recon_loss: 2705500.8257; val_gene_expr_recon_loss: 11350502.8158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14070204.4079; val_optim_loss: 14070204.4079
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9559; val_auprc_score: 0.9438; val_best_acc_score: 0.8983; val_best_f1_score: 0.9032; train_kl_reg_loss: 14680.0544; train_edge_recon_loss: 2640016.7125; train_gene_expr_recon_loss: 11313332.7882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13968029.5515; train_optim_loss: 13968029.5515; val_kl_reg_loss: 14253.3903; val_edge_recon_loss: 2702505.4967; val_gene_expr_recon_loss: 11303959.2632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14020718.1053; val_optim_loss: 14020718.1053
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9567; val_auprc_score: 0.9456; val_best_acc_score: 0.8992; val_best_f1_score: 0.9041; train_kl_reg_loss: 14707.2826; train_edge_recon_loss: 2637586.2511; train_gene_expr_recon_loss: 11290806.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13943100.2206; train_optim_loss: 13943100.2206; val_kl_reg_loss: 14772.7971; val_edge_recon_loss: 2698459.3421; val_gene_expr_recon_loss: 11286132.3684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13999364.5000; val_optim_loss: 13999364.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9577; val_auprc_score: 0.9467; val_best_acc_score: 0.9007; val_best_f1_score: 0.9052; train_kl_reg_loss: 14720.9684; train_edge_recon_loss: 2635589.9581; train_gene_expr_recon_loss: 11266241.2676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13916552.1868; train_optim_loss: 13916552.1868; val_kl_reg_loss: 14283.4754; val_edge_recon_loss: 2703669.3783; val_gene_expr_recon_loss: 11300591.7105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14018544.5263; val_optim_loss: 14018544.5263
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9562; val_auprc_score: 0.9440; val_best_acc_score: 0.8998; val_best_f1_score: 0.9042; train_kl_reg_loss: 14717.9630; train_edge_recon_loss: 2634146.2783; train_gene_expr_recon_loss: 11255056.5779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13903920.8029; train_optim_loss: 13903920.8029; val_kl_reg_loss: 14479.0897; val_edge_recon_loss: 2696022.2961; val_gene_expr_recon_loss: 11249582.2895; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13960083.6316; val_optim_loss: 13960083.6316
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9569; val_auprc_score: 0.9450; val_best_acc_score: 0.9008; val_best_f1_score: 0.9055; train_kl_reg_loss: 14740.3309; train_edge_recon_loss: 2634349.5610; train_gene_expr_recon_loss: 11246262.5132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13895352.3897; train_optim_loss: 13895352.3897; val_kl_reg_loss: 14622.9388; val_edge_recon_loss: 2694828.3026; val_gene_expr_recon_loss: 11246010.1974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13955461.3553; val_optim_loss: 13955461.3553
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9575; val_auprc_score: 0.9454; val_best_acc_score: 0.9027; val_best_f1_score: 0.9072; train_kl_reg_loss: 14755.5098; train_edge_recon_loss: 2632401.6581; train_gene_expr_recon_loss: 11234847.6765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13882004.8529; train_optim_loss: 13882004.8529; val_kl_reg_loss: 14500.3987; val_edge_recon_loss: 2695154.2993; val_gene_expr_recon_loss: 11237434.3026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13947088.9474; val_optim_loss: 13947088.9474
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9576; val_auprc_score: 0.9456; val_best_acc_score: 0.9040; val_best_f1_score: 0.9081; train_kl_reg_loss: 14754.2900; train_edge_recon_loss: 2630473.6349; train_gene_expr_recon_loss: 11230118.5647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13875346.5000; train_optim_loss: 13875346.5000; val_kl_reg_loss: 14311.6998; val_edge_recon_loss: 2688689.9868; val_gene_expr_recon_loss: 11243397.8947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13946399.5526; val_optim_loss: 13946399.5526
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9575; val_auprc_score: 0.9458; val_best_acc_score: 0.9022; val_best_f1_score: 0.9068; train_kl_reg_loss: 14729.3667; train_edge_recon_loss: 2630699.6011; train_gene_expr_recon_loss: 11226142.5147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13871571.4676; train_optim_loss: 13871571.4676; val_kl_reg_loss: 14376.2718; val_edge_recon_loss: 2698615.7796; val_gene_expr_recon_loss: 11241089.5658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13954081.6053; val_optim_loss: 13954081.6053
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9602; val_auprc_score: 0.9486; val_best_acc_score: 0.9067; val_best_f1_score: 0.9108; train_kl_reg_loss: 14728.7232; train_edge_recon_loss: 2630043.8265; train_gene_expr_recon_loss: 11223893.4824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13868666.0279; train_optim_loss: 13868666.0279; val_kl_reg_loss: 14467.2376; val_edge_recon_loss: 2691820.0921; val_gene_expr_recon_loss: 11228225.8289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13934513.1579; val_optim_loss: 13934513.1579
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9583; val_auprc_score: 0.9462; val_best_acc_score: 0.9040; val_best_f1_score: 0.9084; train_kl_reg_loss: 14721.1518; train_edge_recon_loss: 2629182.5923; train_gene_expr_recon_loss: 11216722.8765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13860626.6250; train_optim_loss: 13860626.6250; val_kl_reg_loss: 14045.4768; val_edge_recon_loss: 2689653.9605; val_gene_expr_recon_loss: 11305498.9868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14009198.3553; val_optim_loss: 14009198.3553
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9600; val_auprc_score: 0.9479; val_best_acc_score: 0.9076; val_best_f1_score: 0.9115; train_kl_reg_loss: 14711.2491; train_edge_recon_loss: 2626710.6551; train_gene_expr_recon_loss: 11212261.1971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13853683.1118; train_optim_loss: 13853683.1118; val_kl_reg_loss: 14639.4138; val_edge_recon_loss: 2688216.8388; val_gene_expr_recon_loss: 11221008.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13923864.7500; val_optim_loss: 13923864.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9630; val_auprc_score: 0.9530; val_best_acc_score: 0.9090; val_best_f1_score: 0.9125; train_kl_reg_loss: 14724.6216; train_edge_recon_loss: 2627351.4926; train_gene_expr_recon_loss: 11212723.3132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13854799.4353; train_optim_loss: 13854799.4353; val_kl_reg_loss: 14408.1137; val_edge_recon_loss: 2685224.8224; val_gene_expr_recon_loss: 11233180.0263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13932812.9474; val_optim_loss: 13932812.9474
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9592; val_auprc_score: 0.9472; val_best_acc_score: 0.9055; val_best_f1_score: 0.9103; train_kl_reg_loss: 14702.6841; train_edge_recon_loss: 2626781.7199; train_gene_expr_recon_loss: 11214210.6162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13855695.0279; train_optim_loss: 13855695.0279; val_kl_reg_loss: 14416.7770; val_edge_recon_loss: 2690252.0428; val_gene_expr_recon_loss: 11235532.0789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13940200.9211; val_optim_loss: 13940200.9211
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9618; val_auprc_score: 0.9519; val_best_acc_score: 0.9082; val_best_f1_score: 0.9121; train_kl_reg_loss: 14707.6268; train_edge_recon_loss: 2623779.2603; train_gene_expr_recon_loss: 11208925.7750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13847412.6500; train_optim_loss: 13847412.6500; val_kl_reg_loss: 14580.6893; val_edge_recon_loss: 2687713.2796; val_gene_expr_recon_loss: 11242347.5132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13944641.4474; val_optim_loss: 13944641.4474
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9615; val_auprc_score: 0.9500; val_best_acc_score: 0.9091; val_best_f1_score: 0.9131; train_kl_reg_loss: 14682.2867; train_edge_recon_loss: 2626019.9654; train_gene_expr_recon_loss: 11208791.0941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13849493.3294; train_optim_loss: 13849493.3294; val_kl_reg_loss: 14470.0796; val_edge_recon_loss: 2687179.3882; val_gene_expr_recon_loss: 11216372.4605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13918021.8947; val_optim_loss: 13918021.8947
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9614; val_auprc_score: 0.9512; val_best_acc_score: 0.9077; val_best_f1_score: 0.9121; train_kl_reg_loss: 14684.7501; train_edge_recon_loss: 2624136.7437; train_gene_expr_recon_loss: 11201201.5676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13840023.0662; train_optim_loss: 13840023.0662; val_kl_reg_loss: 14237.8194; val_edge_recon_loss: 2687692.2171; val_gene_expr_recon_loss: 11201100.0526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13903030.0526; val_optim_loss: 13903030.0526
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9628; val_auprc_score: 0.9520; val_best_acc_score: 0.9103; val_best_f1_score: 0.9142; train_kl_reg_loss: 14650.0083; train_edge_recon_loss: 2623945.5860; train_gene_expr_recon_loss: 11203018.9279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13841614.5162; train_optim_loss: 13841614.5162; val_kl_reg_loss: 14384.4302; val_edge_recon_loss: 2682426.4112; val_gene_expr_recon_loss: 11231553.5526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13928364.3421; val_optim_loss: 13928364.3421
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9635; val_auprc_score: 0.9539; val_best_acc_score: 0.9097; val_best_f1_score: 0.9138; train_kl_reg_loss: 14639.0331; train_edge_recon_loss: 2625043.5533; train_gene_expr_recon_loss: 11202490.2618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13842172.8294; train_optim_loss: 13842172.8294; val_kl_reg_loss: 14240.0185; val_edge_recon_loss: 2685920.7862; val_gene_expr_recon_loss: 11227475.3684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13927636.1184; val_optim_loss: 13927636.1184
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9628; val_auprc_score: 0.9524; val_best_acc_score: 0.9103; val_best_f1_score: 0.9142; train_kl_reg_loss: 14619.7648; train_edge_recon_loss: 2622060.8868; train_gene_expr_recon_loss: 11196365.4882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13833046.1368; train_optim_loss: 13833046.1368; val_kl_reg_loss: 14242.5594; val_edge_recon_loss: 2688961.8191; val_gene_expr_recon_loss: 11207290.7237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13910495.1053; val_optim_loss: 13910495.1053
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9631; val_auprc_score: 0.9528; val_best_acc_score: 0.9110; val_best_f1_score: 0.9148; train_kl_reg_loss: 14609.8412; train_edge_recon_loss: 2623430.2092; train_gene_expr_recon_loss: 11196925.3309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13834965.3838; train_optim_loss: 13834965.3838; val_kl_reg_loss: 14138.1644; val_edge_recon_loss: 2681745.6875; val_gene_expr_recon_loss: 11225195.2632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13921079.1184; val_optim_loss: 13921079.1184

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9621; val_auprc_score: 0.9515; val_best_acc_score: 0.9100; val_best_f1_score: 0.9139; train_kl_reg_loss: 14968.9374; train_edge_recon_loss: 2617365.7287; train_gene_expr_recon_loss: 11126335.9985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13758670.6574; train_optim_loss: 13758670.6574; val_kl_reg_loss: 14529.1836; val_edge_recon_loss: 2678447.7007; val_gene_expr_recon_loss: 11160687.5526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13853664.4211; val_optim_loss: 13853664.4211
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9619; val_auprc_score: 0.9509; val_best_acc_score: 0.9095; val_best_f1_score: 0.9133; train_kl_reg_loss: 14635.6249; train_edge_recon_loss: 2616051.2662; train_gene_expr_recon_loss: 11113074.8809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13743761.7809; train_optim_loss: 13743761.7809; val_kl_reg_loss: 14191.8862; val_edge_recon_loss: 2675988.5658; val_gene_expr_recon_loss: 11148159.2237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13838339.7105; val_optim_loss: 13838339.7105
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9638; val_auprc_score: 0.9544; val_best_acc_score: 0.9108; val_best_f1_score: 0.9147; train_kl_reg_loss: 14427.9894; train_edge_recon_loss: 2615818.1518; train_gene_expr_recon_loss: 11114341.0044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13744587.1676; train_optim_loss: 13744587.1676; val_kl_reg_loss: 14115.6108; val_edge_recon_loss: 2674617.9836; val_gene_expr_recon_loss: 11171724.0263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13860457.6316; val_optim_loss: 13860457.6316
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9633; val_auprc_score: 0.9530; val_best_acc_score: 0.9117; val_best_f1_score: 0.9152; train_kl_reg_loss: 14358.4250; train_edge_recon_loss: 2614196.6614; train_gene_expr_recon_loss: 11116283.1044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13744838.2191; train_optim_loss: 13744838.2191; val_kl_reg_loss: 14083.1415; val_edge_recon_loss: 2670782.9737; val_gene_expr_recon_loss: 11158187.4342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13843053.5000; val_optim_loss: 13843053.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9637; val_auprc_score: 0.9543; val_best_acc_score: 0.9111; val_best_f1_score: 0.9144; train_kl_reg_loss: 14329.9408; train_edge_recon_loss: 2614417.2816; train_gene_expr_recon_loss: 11114079.0294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13742826.2559; train_optim_loss: 13742826.2559; val_kl_reg_loss: 14093.9440; val_edge_recon_loss: 2675106.1118; val_gene_expr_recon_loss: 11167203.2895; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13856403.3289; val_optim_loss: 13856403.3289
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9643; val_auprc_score: 0.9541; val_best_acc_score: 0.9124; val_best_f1_score: 0.9159; train_kl_reg_loss: 14314.7335; train_edge_recon_loss: 2614998.6158; train_gene_expr_recon_loss: 11114892.2132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13744205.5603; train_optim_loss: 13744205.5603; val_kl_reg_loss: 14022.5407; val_edge_recon_loss: 2674229.5691; val_gene_expr_recon_loss: 11157711.0921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13845963.2105; val_optim_loss: 13845963.2105

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9637; val_auprc_score: 0.9545; val_best_acc_score: 0.9105; val_best_f1_score: 0.9142; train_kl_reg_loss: 14351.9756; train_edge_recon_loss: 2613928.6250; train_gene_expr_recon_loss: 11101049.9456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13729330.5294; train_optim_loss: 13729330.5294; val_kl_reg_loss: 14085.5097; val_edge_recon_loss: 2676131.0132; val_gene_expr_recon_loss: 11163689.0921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13853905.6447; val_optim_loss: 13853905.6447
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9636; val_auprc_score: 0.9532; val_best_acc_score: 0.9120; val_best_f1_score: 0.9155; train_kl_reg_loss: 14385.8292; train_edge_recon_loss: 2613375.4886; train_gene_expr_recon_loss: 11097334.5971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13725095.9029; train_optim_loss: 13725095.9029; val_kl_reg_loss: 14103.9516; val_edge_recon_loss: 2671976.8421; val_gene_expr_recon_loss: 11151436.0263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13837516.8684; val_optim_loss: 13837516.8684
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9631; val_auprc_score: 0.9533; val_best_acc_score: 0.9103; val_best_f1_score: 0.9139; train_kl_reg_loss: 14396.9509; train_edge_recon_loss: 2614740.8254; train_gene_expr_recon_loss: 11098725.5706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13727863.3529; train_optim_loss: 13727863.3529; val_kl_reg_loss: 14100.4504; val_edge_recon_loss: 2671866.0789; val_gene_expr_recon_loss: 11123135.5921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13809102.1447; val_optim_loss: 13809102.1447
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9639; val_auprc_score: 0.9541; val_best_acc_score: 0.9115; val_best_f1_score: 0.9150; train_kl_reg_loss: 14392.0341; train_edge_recon_loss: 2613882.9735; train_gene_expr_recon_loss: 11098439.5221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13726714.5338; train_optim_loss: 13726714.5338; val_kl_reg_loss: 14119.3070; val_edge_recon_loss: 2671807.0428; val_gene_expr_recon_loss: 11148146.9868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13834073.3553; val_optim_loss: 13834073.3553
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9633; val_auprc_score: 0.9534; val_best_acc_score: 0.9109; val_best_f1_score: 0.9145; train_kl_reg_loss: 14388.1429; train_edge_recon_loss: 2613858.3007; train_gene_expr_recon_loss: 11096116.7074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13724363.1603; train_optim_loss: 13724363.1603; val_kl_reg_loss: 14094.9047; val_edge_recon_loss: 2677618.8651; val_gene_expr_recon_loss: 11122890.8684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13814604.6184; val_optim_loss: 13814604.6184
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9643; val_auprc_score: 0.9551; val_best_acc_score: 0.9113; val_best_f1_score: 0.9148; train_kl_reg_loss: 14384.8740; train_edge_recon_loss: 2612891.3868; train_gene_expr_recon_loss: 11102826.6044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13730102.8632; train_optim_loss: 13730102.8632; val_kl_reg_loss: 14097.0935; val_edge_recon_loss: 2673599.2895; val_gene_expr_recon_loss: 11135750.1053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13823446.5000; val_optim_loss: 13823446.5000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9638; val_auprc_score: 0.9539; val_best_acc_score: 0.9113; val_best_f1_score: 0.9149; train_kl_reg_loss: 14372.6370; train_edge_recon_loss: 2613668.8537; train_gene_expr_recon_loss: 11097475.2971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13725516.7971; train_optim_loss: 13725516.7971; val_kl_reg_loss: 14089.6784; val_edge_recon_loss: 2671924.3618; val_gene_expr_recon_loss: 11150835.9474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13836849.9342; val_optim_loss: 13836849.9342

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9634; val_auprc_score: 0.9533; val_best_acc_score: 0.9113; val_best_f1_score: 0.9149; train_kl_reg_loss: 14379.4284; train_edge_recon_loss: 2613824.3239; train_gene_expr_recon_loss: 11098614.4074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13726818.1500; train_optim_loss: 13726818.1500; val_kl_reg_loss: 14081.4228; val_edge_recon_loss: 2674323.6118; val_gene_expr_recon_loss: 11115881.6842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13804286.7763; val_optim_loss: 13804286.7763
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9633; val_auprc_score: 0.9537; val_best_acc_score: 0.9109; val_best_f1_score: 0.9146; train_kl_reg_loss: 14375.8085; train_edge_recon_loss: 2612216.1945; train_gene_expr_recon_loss: 11094597.0559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13721189.0750; train_optim_loss: 13721189.0750; val_kl_reg_loss: 14085.4035; val_edge_recon_loss: 2672536.4178; val_gene_expr_recon_loss: 11141989.5263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13828611.3947; val_optim_loss: 13828611.3947
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9638; val_auprc_score: 0.9537; val_best_acc_score: 0.9117; val_best_f1_score: 0.9152; train_kl_reg_loss: 14377.1589; train_edge_recon_loss: 2613726.2213; train_gene_expr_recon_loss: 11095034.5059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13723137.8721; train_optim_loss: 13723137.8721; val_kl_reg_loss: 14085.9959; val_edge_recon_loss: 2670187.2434; val_gene_expr_recon_loss: 11154542.0789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13838815.3421; val_optim_loss: 13838815.3421
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9626; val_auprc_score: 0.9516; val_best_acc_score: 0.9101; val_best_f1_score: 0.9138; train_kl_reg_loss: 14377.0566; train_edge_recon_loss: 2613681.4809; train_gene_expr_recon_loss: 11098526.5515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13726585.1162; train_optim_loss: 13726585.1162; val_kl_reg_loss: 14085.6006; val_edge_recon_loss: 2673941.6776; val_gene_expr_recon_loss: 11159898.1184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13847925.3421; val_optim_loss: 13847925.3421
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9629; val_auprc_score: 0.9528; val_best_acc_score: 0.9099; val_best_f1_score: 0.9137; train_kl_reg_loss: 14375.2095; train_edge_recon_loss: 2614075.5835; train_gene_expr_recon_loss: 11091493.6265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13719944.3794; train_optim_loss: 13719944.3794; val_kl_reg_loss: 14085.3429; val_edge_recon_loss: 2676743.4539; val_gene_expr_recon_loss: 11129604.8289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13820433.6447; val_optim_loss: 13820433.6447

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9639; val_auprc_score: 0.9540; val_best_acc_score: 0.9126; val_best_f1_score: 0.9160; train_kl_reg_loss: 14377.3987; train_edge_recon_loss: 2612965.1176; train_gene_expr_recon_loss: 11090865.1529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13718207.6529; train_optim_loss: 13718207.6529; val_kl_reg_loss: 14085.6480; val_edge_recon_loss: 2670928.6217; val_gene_expr_recon_loss: 11162007.0263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13847021.2763; val_optim_loss: 13847021.2763
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9634; val_auprc_score: 0.9539; val_best_acc_score: 0.9102; val_best_f1_score: 0.9139; train_kl_reg_loss: 14375.5207; train_edge_recon_loss: 2613978.3235; train_gene_expr_recon_loss: 11093401.5412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13721755.3985; train_optim_loss: 13721755.3985; val_kl_reg_loss: 14084.4998; val_edge_recon_loss: 2675675.6875; val_gene_expr_recon_loss: 11158846.1974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13848606.3816; val_optim_loss: 13848606.3816
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9635; val_auprc_score: 0.9538; val_best_acc_score: 0.9101; val_best_f1_score: 0.9138; train_kl_reg_loss: 14375.8935; train_edge_recon_loss: 2612611.1695; train_gene_expr_recon_loss: 11092140.3926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13719127.4368; train_optim_loss: 13719127.4368; val_kl_reg_loss: 14082.5532; val_edge_recon_loss: 2678478.0329; val_gene_expr_recon_loss: 11138378.6711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13830939.2368; val_optim_loss: 13830939.2368
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9642; val_auprc_score: 0.9541; val_best_acc_score: 0.9114; val_best_f1_score: 0.9150; train_kl_reg_loss: 14375.4246; train_edge_recon_loss: 2613231.5739; train_gene_expr_recon_loss: 11096116.8721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13723723.8706; train_optim_loss: 13723723.8706; val_kl_reg_loss: 14079.8756; val_edge_recon_loss: 2670422.9539; val_gene_expr_recon_loss: 11133319.0789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13817821.9342; val_optim_loss: 13817821.9342

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 99 min 24 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
Val AUROC score: 0.9643
Val AUPRC score: 0.9548
Val best accuracy score: 0.9116
Val best F1 score: 0.9152
Val gene expr MSE score: 2.6104

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
