None
Run timestamp: 04072023_153607_31.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_31']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9917; val_auprc_score: 0.9912; val_best_acc_score: 0.9550; val_best_f1_score: 0.9552; train_kl_reg_loss: 6471.5451; train_edge_recon_loss: 264080.9538; train_gene_expr_recon_loss: 22001.5784; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 292554.0775; train_optim_loss: 292554.0775; val_kl_reg_loss: 6542.8091; val_edge_recon_loss: 261049.1053; val_gene_expr_recon_loss: 21278.7589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 288870.6737; val_optim_loss: 288870.6737
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9948; val_auprc_score: 0.9945; val_best_acc_score: 0.9662; val_best_f1_score: 0.9662; train_kl_reg_loss: 6512.5804; train_edge_recon_loss: 260439.3347; train_gene_expr_recon_loss: 20876.6035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 287828.5186; train_optim_loss: 287828.5186; val_kl_reg_loss: 6371.9244; val_edge_recon_loss: 259811.6334; val_gene_expr_recon_loss: 20713.5259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 286897.0844; val_optim_loss: 286897.0844
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9957; val_auprc_score: 0.9952; val_best_acc_score: 0.9703; val_best_f1_score: 0.9704; train_kl_reg_loss: 6500.4080; train_edge_recon_loss: 259668.0827; train_gene_expr_recon_loss: 20682.8690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 286851.3595; train_optim_loss: 286851.3595; val_kl_reg_loss: 6356.8860; val_edge_recon_loss: 259024.2353; val_gene_expr_recon_loss: 20504.9328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 285886.0536; val_optim_loss: 285886.0536
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9963; val_auprc_score: 0.9958; val_best_acc_score: 0.9733; val_best_f1_score: 0.9735; train_kl_reg_loss: 6484.2866; train_edge_recon_loss: 259386.8445; train_gene_expr_recon_loss: 20594.6325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 286465.7636; train_optim_loss: 286465.7636; val_kl_reg_loss: 6649.9995; val_edge_recon_loss: 259026.5868; val_gene_expr_recon_loss: 20510.8959; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 286187.4825; val_optim_loss: 286187.4825
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9967; val_auprc_score: 0.9962; val_best_acc_score: 0.9747; val_best_f1_score: 0.9748; train_kl_reg_loss: 6476.8987; train_edge_recon_loss: 259161.3667; train_gene_expr_recon_loss: 20552.3345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 286190.5997; train_optim_loss: 286190.5997; val_kl_reg_loss: 6433.0469; val_edge_recon_loss: 258681.6971; val_gene_expr_recon_loss: 20485.3701; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 285600.1140; val_optim_loss: 285600.1140
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9969; val_auprc_score: 0.9964; val_best_acc_score: 0.9755; val_best_f1_score: 0.9757; train_kl_reg_loss: 6468.0587; train_edge_recon_loss: 258992.5938; train_gene_expr_recon_loss: 20532.7472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 285993.3997; train_optim_loss: 285993.3997; val_kl_reg_loss: 6430.9588; val_edge_recon_loss: 258528.9976; val_gene_expr_recon_loss: 20450.8915; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 285410.8499; val_optim_loss: 285410.8499
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9973; val_auprc_score: 0.9970; val_best_acc_score: 0.9783; val_best_f1_score: 0.9784; train_kl_reg_loss: 6471.9571; train_edge_recon_loss: 258771.5620; train_gene_expr_recon_loss: 20500.2131; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 285743.7323; train_optim_loss: 285743.7323; val_kl_reg_loss: 6600.2237; val_edge_recon_loss: 258588.3879; val_gene_expr_recon_loss: 20435.1772; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 285623.7892; val_optim_loss: 285623.7892
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9974; val_auprc_score: 0.9971; val_best_acc_score: 0.9784; val_best_f1_score: 0.9785; train_kl_reg_loss: 6467.7251; train_edge_recon_loss: 258738.4426; train_gene_expr_recon_loss: 20479.1082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 285685.2764; train_optim_loss: 285685.2764; val_kl_reg_loss: 6361.4263; val_edge_recon_loss: 258184.5734; val_gene_expr_recon_loss: 20646.9459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 285192.9457; val_optim_loss: 285192.9457
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9976; val_auprc_score: 0.9972; val_best_acc_score: 0.9797; val_best_f1_score: 0.9797; train_kl_reg_loss: 6469.1392; train_edge_recon_loss: 258545.9482; train_gene_expr_recon_loss: 20501.7334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 285516.8209; train_optim_loss: 285516.8209; val_kl_reg_loss: 6305.0686; val_edge_recon_loss: 257890.3171; val_gene_expr_recon_loss: 19610.7539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 283806.1406; val_optim_loss: 283806.1406
