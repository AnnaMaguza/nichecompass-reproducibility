None
Run timestamp: 05072023_100348_31.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_31']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9929; val_auprc_score: 0.9923; val_best_acc_score: 0.9595; val_best_f1_score: 0.9598; train_kl_reg_loss: 5620.9476; train_edge_recon_loss: 263702.3982; train_gene_expr_recon_loss: 16627.5167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 285950.8626; train_optim_loss: 285950.8626; val_kl_reg_loss: 5711.7833; val_edge_recon_loss: 260823.2846; val_gene_expr_recon_loss: 15020.4042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281555.4714; val_optim_loss: 281555.4714
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9946; val_auprc_score: 0.9940; val_best_acc_score: 0.9669; val_best_f1_score: 0.9671; train_kl_reg_loss: 5667.0754; train_edge_recon_loss: 260417.3262; train_gene_expr_recon_loss: 14686.4626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280770.8644; train_optim_loss: 280770.8644; val_kl_reg_loss: 5629.1359; val_edge_recon_loss: 260195.9954; val_gene_expr_recon_loss: 14250.1710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280075.3026; val_optim_loss: 280075.3026
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9956; val_auprc_score: 0.9951; val_best_acc_score: 0.9699; val_best_f1_score: 0.9701; train_kl_reg_loss: 5718.4635; train_edge_recon_loss: 259753.5263; train_gene_expr_recon_loss: 14154.0831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279626.0734; train_optim_loss: 279626.0734; val_kl_reg_loss: 5673.6065; val_edge_recon_loss: 259418.6282; val_gene_expr_recon_loss: 13894.0260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278986.2600; val_optim_loss: 278986.2600
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9961; val_auprc_score: 0.9958; val_best_acc_score: 0.9716; val_best_f1_score: 0.9717; train_kl_reg_loss: 5759.3208; train_edge_recon_loss: 259328.0670; train_gene_expr_recon_loss: 13889.1513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278976.5398; train_optim_loss: 278976.5398; val_kl_reg_loss: 5606.2722; val_edge_recon_loss: 259231.5039; val_gene_expr_recon_loss: 13703.2392; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278541.0158; val_optim_loss: 278541.0158
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9968; val_auprc_score: 0.9965; val_best_acc_score: 0.9757; val_best_f1_score: 0.9758; train_kl_reg_loss: 5783.0846; train_edge_recon_loss: 259054.8103; train_gene_expr_recon_loss: 13733.8975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278571.7925; train_optim_loss: 278571.7925; val_kl_reg_loss: 5795.1906; val_edge_recon_loss: 258641.1996; val_gene_expr_recon_loss: 13514.3543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277950.7442; val_optim_loss: 277950.7442
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9969; val_auprc_score: 0.9965; val_best_acc_score: 0.9761; val_best_f1_score: 0.9762; train_kl_reg_loss: 5801.9482; train_edge_recon_loss: 258811.0518; train_gene_expr_recon_loss: 13645.5013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278258.5011; train_optim_loss: 278258.5011; val_kl_reg_loss: 5746.8731; val_edge_recon_loss: 258470.6910; val_gene_expr_recon_loss: 13335.3693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277552.9324; val_optim_loss: 277552.9324
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9971; val_auprc_score: 0.9966; val_best_acc_score: 0.9770; val_best_f1_score: 0.9770; train_kl_reg_loss: 5813.8373; train_edge_recon_loss: 258687.0895; train_gene_expr_recon_loss: 13437.8340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277938.7608; train_optim_loss: 277938.7608; val_kl_reg_loss: 5663.1752; val_edge_recon_loss: 258507.0874; val_gene_expr_recon_loss: 13658.4086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277828.6707; val_optim_loss: 277828.6707
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9781; val_best_f1_score: 0.9782; train_kl_reg_loss: 5824.8100; train_edge_recon_loss: 258432.2930; train_gene_expr_recon_loss: 12987.8816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277244.9847; train_optim_loss: 277244.9847; val_kl_reg_loss: 5910.7912; val_edge_recon_loss: 258344.9958; val_gene_expr_recon_loss: 12486.8607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276742.6474; val_optim_loss: 276742.6474
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9975; val_auprc_score: 0.9971; val_best_acc_score: 0.9787; val_best_f1_score: 0.9787; train_kl_reg_loss: 5831.4771; train_edge_recon_loss: 258372.0595; train_gene_expr_recon_loss: 12293.3450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276496.8817; train_optim_loss: 276496.8817; val_kl_reg_loss: 5710.0991; val_edge_recon_loss: 258251.1531; val_gene_expr_recon_loss: 12205.7557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276167.0078; val_optim_loss: 276167.0078
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9976; val_auprc_score: 0.9972; val_best_acc_score: 0.9801; val_best_f1_score: 0.9801; train_kl_reg_loss: 5834.2262; train_edge_recon_loss: 258272.0602; train_gene_expr_recon_loss: 11631.2139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 275737.4995; train_optim_loss: 275737.4995; val_kl_reg_loss: 5845.1570; val_edge_recon_loss: 258022.9702; val_gene_expr_recon_loss: 11574.9081; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275443.0350; val_optim_loss: 275443.0350
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9980; val_auprc_score: 0.9977; val_best_acc_score: 0.9819; val_best_f1_score: 0.9820; train_kl_reg_loss: 5841.2230; train_edge_recon_loss: 258144.4155; train_gene_expr_recon_loss: 11370.9102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 275356.5490; train_optim_loss: 275356.5490; val_kl_reg_loss: 5914.8914; val_edge_recon_loss: 257836.6823; val_gene_expr_recon_loss: 11334.3547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275085.9292; val_optim_loss: 275085.9292
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9979; val_auprc_score: 0.9976; val_best_acc_score: 0.9820; val_best_f1_score: 0.9821; train_kl_reg_loss: 5842.8217; train_edge_recon_loss: 258030.6518; train_gene_expr_recon_loss: 11319.7053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 275193.1786; train_optim_loss: 275193.1786; val_kl_reg_loss: 5833.8332; val_edge_recon_loss: 257752.1912; val_gene_expr_recon_loss: 11253.7854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274839.8099; val_optim_loss: 274839.8099
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9819; val_best_f1_score: 0.9820; train_kl_reg_loss: 5844.0004; train_edge_recon_loss: 257932.6768; train_gene_expr_recon_loss: 11283.2319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 275059.9093; train_optim_loss: 275059.9093; val_kl_reg_loss: 5794.3149; val_edge_recon_loss: 257722.2497; val_gene_expr_recon_loss: 11193.5621; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274710.1272; val_optim_loss: 274710.1272
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9825; val_best_f1_score: 0.9826; train_kl_reg_loss: 5847.2716; train_edge_recon_loss: 257930.5809; train_gene_expr_recon_loss: 11266.4069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 275044.2592; train_optim_loss: 275044.2592; val_kl_reg_loss: 5754.0241; val_edge_recon_loss: 257508.7809; val_gene_expr_recon_loss: 11177.6261; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274440.4316; val_optim_loss: 274440.4316
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9980; val_auprc_score: 0.9975; val_best_acc_score: 0.9826; val_best_f1_score: 0.9827; train_kl_reg_loss: 5850.8466; train_edge_recon_loss: 257864.9820; train_gene_expr_recon_loss: 11253.5137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274969.3420; train_optim_loss: 274969.3420; val_kl_reg_loss: 5849.2023; val_edge_recon_loss: 257747.6485; val_gene_expr_recon_loss: 11168.6228; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274765.4730; val_optim_loss: 274765.4730
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9834; val_best_f1_score: 0.9834; train_kl_reg_loss: 5852.6295; train_edge_recon_loss: 257795.8894; train_gene_expr_recon_loss: 11252.4244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274900.9431; train_optim_loss: 274900.9431; val_kl_reg_loss: 5740.7448; val_edge_recon_loss: 257424.4427; val_gene_expr_recon_loss: 11163.3989; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274328.5873; val_optim_loss: 274328.5873
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9981; val_auprc_score: 0.9978; val_best_acc_score: 0.9836; val_best_f1_score: 0.9836; train_kl_reg_loss: 5854.6207; train_edge_recon_loss: 257714.1973; train_gene_expr_recon_loss: 11240.4958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274809.3138; train_optim_loss: 274809.3138; val_kl_reg_loss: 5908.8111; val_edge_recon_loss: 257380.7274; val_gene_expr_recon_loss: 11170.3874; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274459.9267; val_optim_loss: 274459.9267
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9982; val_auprc_score: 0.9978; val_best_acc_score: 0.9836; val_best_f1_score: 0.9837; train_kl_reg_loss: 5858.6815; train_edge_recon_loss: 257646.0963; train_gene_expr_recon_loss: 11238.0732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274742.8509; train_optim_loss: 274742.8509; val_kl_reg_loss: 5907.8350; val_edge_recon_loss: 257428.2167; val_gene_expr_recon_loss: 11143.3538; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274479.4048; val_optim_loss: 274479.4048
