None
Run timestamp: 14072023_110345_12.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_12']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9836; val_auprc_score: 0.9771; val_best_acc_score: 0.9502; val_best_f1_score: 0.9514; train_kl_reg_loss: 22285.5133; train_edge_recon_loss: 26285554.5341; train_gene_expr_recon_loss: 1328172.9004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27636012.8734; train_optim_loss: 27636012.8734; val_kl_reg_loss: 20598.0672; val_edge_recon_loss: 25863062.0250; val_gene_expr_recon_loss: 1190189.1469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27073849.2500; val_optim_loss: 27073849.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9874; val_auprc_score: 0.9823; val_best_acc_score: 0.9585; val_best_f1_score: 0.9593; train_kl_reg_loss: 20688.6638; train_edge_recon_loss: 25756937.6996; train_gene_expr_recon_loss: 1151240.2215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26928866.5841; train_optim_loss: 26928866.5841; val_kl_reg_loss: 19831.1387; val_edge_recon_loss: 25729412.4500; val_gene_expr_recon_loss: 1117531.9391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26866775.4000; val_optim_loss: 26866775.4000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9891; val_auprc_score: 0.9844; val_best_acc_score: 0.9646; val_best_f1_score: 0.9653; train_kl_reg_loss: 20096.6811; train_edge_recon_loss: 25666729.8081; train_gene_expr_recon_loss: 1104040.4588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26790866.9124; train_optim_loss: 26790866.9124; val_kl_reg_loss: 18731.2369; val_edge_recon_loss: 25645009.1750; val_gene_expr_recon_loss: 1090665.3648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26754405.8000; val_optim_loss: 26754405.8000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9919; val_auprc_score: 0.9891; val_best_acc_score: 0.9683; val_best_f1_score: 0.9688; train_kl_reg_loss: 19381.5620; train_edge_recon_loss: 25593618.4367; train_gene_expr_recon_loss: 1079447.1472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26692447.1516; train_optim_loss: 26692447.1516; val_kl_reg_loss: 18673.4224; val_edge_recon_loss: 25587362.0500; val_gene_expr_recon_loss: 1064394.1648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26670429.6250; val_optim_loss: 26670429.6250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9917; val_auprc_score: 0.9879; val_best_acc_score: 0.9719; val_best_f1_score: 0.9723; train_kl_reg_loss: 19535.0138; train_edge_recon_loss: 25553703.5494; train_gene_expr_recon_loss: 1060540.0316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26633778.5841; train_optim_loss: 26633778.5841; val_kl_reg_loss: 19405.9375; val_edge_recon_loss: 25583692.0500; val_gene_expr_recon_loss: 1046907.8625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26650005.8000; val_optim_loss: 26650005.8000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9933; val_auprc_score: 0.9902; val_best_acc_score: 0.9753; val_best_f1_score: 0.9757; train_kl_reg_loss: 19552.4549; train_edge_recon_loss: 25525175.2128; train_gene_expr_recon_loss: 1048878.5359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26593606.1892; train_optim_loss: 26593606.1892; val_kl_reg_loss: 19065.1770; val_edge_recon_loss: 25538603.5000; val_gene_expr_recon_loss: 1038924.6766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26596593.2250; val_optim_loss: 26596593.2250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9937; val_auprc_score: 0.9906; val_best_acc_score: 0.9773; val_best_f1_score: 0.9776; train_kl_reg_loss: 19167.5754; train_edge_recon_loss: 25506562.6203; train_gene_expr_recon_loss: 1040888.5861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26566618.7872; train_optim_loss: 26566618.7872; val_kl_reg_loss: 18314.6570; val_edge_recon_loss: 25522547.3750; val_gene_expr_recon_loss: 1031280.4953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26572142.5000; val_optim_loss: 26572142.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9940; val_auprc_score: 0.9911; val_best_acc_score: 0.9772; val_best_f1_score: 0.9775; train_kl_reg_loss: 18793.1867; train_edge_recon_loss: 25483404.8317; train_gene_expr_recon_loss: 1034912.3745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26537110.3700; train_optim_loss: 26537110.3700; val_kl_reg_loss: 18583.0948; val_edge_recon_loss: 25528596.4750; val_gene_expr_recon_loss: 1026793.5914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26573973.2250; val_optim_loss: 26573973.2250
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9949; val_auprc_score: 0.9925; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 18660.7581; train_edge_recon_loss: 25471607.6606; train_gene_expr_recon_loss: 1029372.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26519641.3435; train_optim_loss: 26519641.3435; val_kl_reg_loss: 18214.0736; val_edge_recon_loss: 25496176.6500; val_gene_expr_recon_loss: 1023060.2562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26537450.8500; val_optim_loss: 26537450.8500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9952; val_auprc_score: 0.9930; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 18559.6354; train_edge_recon_loss: 25459002.8122; train_gene_expr_recon_loss: 1025479.7442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26503042.2281; train_optim_loss: 26503042.2281; val_kl_reg_loss: 18731.6497; val_edge_recon_loss: 25465897.3750; val_gene_expr_recon_loss: 1019845.9227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26504475.0500; val_optim_loss: 26504475.0500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9949; val_auprc_score: 0.9922; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 18390.6919; train_edge_recon_loss: 25449973.4659; train_gene_expr_recon_loss: 1020623.9564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26488988.1168; train_optim_loss: 26488988.1168; val_kl_reg_loss: 18300.8600; val_edge_recon_loss: 25467401.0000; val_gene_expr_recon_loss: 1019500.4617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26505202.2250; val_optim_loss: 26505202.2250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9956; val_auprc_score: 0.9931; val_best_acc_score: 0.9830; val_best_f1_score: 0.9832; train_kl_reg_loss: 18310.4961; train_edge_recon_loss: 25433519.8164; train_gene_expr_recon_loss: 1017467.6439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26469297.9277; train_optim_loss: 26469297.9277; val_kl_reg_loss: 17802.6964; val_edge_recon_loss: 25473706.7000; val_gene_expr_recon_loss: 1015323.5906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26506832.8750; val_optim_loss: 26506832.8750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9957; val_auprc_score: 0.9933; val_best_acc_score: 0.9840; val_best_f1_score: 0.9841; train_kl_reg_loss: 18032.2906; train_edge_recon_loss: 25425997.0960; train_gene_expr_recon_loss: 1014007.3099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26458036.6370; train_optim_loss: 26458036.6370; val_kl_reg_loss: 18312.0820; val_edge_recon_loss: 25454624.6750; val_gene_expr_recon_loss: 1010731.1742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26483667.7750; val_optim_loss: 26483667.7750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9958; val_auprc_score: 0.9934; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 17875.5448; train_edge_recon_loss: 25408235.6050; train_gene_expr_recon_loss: 1011173.9491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26437285.1210; train_optim_loss: 26437285.1210; val_kl_reg_loss: 17433.9532; val_edge_recon_loss: 25431291.3250; val_gene_expr_recon_loss: 1007221.2930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26455946.5500; val_optim_loss: 26455946.5500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9962; val_auprc_score: 0.9940; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 17731.5236; train_edge_recon_loss: 25406822.0862; train_gene_expr_recon_loss: 1009079.7342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26433633.3519; train_optim_loss: 26433633.3519; val_kl_reg_loss: 17653.4431; val_edge_recon_loss: 25429996.1250; val_gene_expr_recon_loss: 1006115.1383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26453764.6250; val_optim_loss: 26453764.6250
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9968; val_auprc_score: 0.9952; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 17647.8037; train_edge_recon_loss: 25405241.8581; train_gene_expr_recon_loss: 1007160.9927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26430050.6843; train_optim_loss: 26430050.6843; val_kl_reg_loss: 17414.6442; val_edge_recon_loss: 25417208.0750; val_gene_expr_recon_loss: 1004344.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26438966.8500; val_optim_loss: 26438966.8500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9964; val_auprc_score: 0.9941; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 17688.0455; train_edge_recon_loss: 25396994.7065; train_gene_expr_recon_loss: 1003913.5628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26418596.2809; train_optim_loss: 26418596.2809; val_kl_reg_loss: 17257.0782; val_edge_recon_loss: 25416352.9500; val_gene_expr_recon_loss: 1001100.1422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26434710.2000; val_optim_loss: 26434710.2000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9967; val_auprc_score: 0.9950; val_best_acc_score: 0.9866; val_best_f1_score: 0.9867; train_kl_reg_loss: 17531.7972; train_edge_recon_loss: 25391460.4200; train_gene_expr_recon_loss: 1002234.5077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26411226.7038; train_optim_loss: 26411226.7038; val_kl_reg_loss: 17220.3696; val_edge_recon_loss: 25412683.2500; val_gene_expr_recon_loss: 1001715.9266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26431619.6250; val_optim_loss: 26431619.6250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9967; val_auprc_score: 0.9951; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 17509.4948; train_edge_recon_loss: 25383179.6968; train_gene_expr_recon_loss: 999837.3868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26400526.5535; train_optim_loss: 26400526.5535; val_kl_reg_loss: 17358.8900; val_edge_recon_loss: 25413105.7250; val_gene_expr_recon_loss: 998997.2063; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26429461.7750; val_optim_loss: 26429461.7750
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9971; val_auprc_score: 0.9957; val_best_acc_score: 0.9875; val_best_f1_score: 0.9876; train_kl_reg_loss: 17203.1335; train_edge_recon_loss: 25388014.2643; train_gene_expr_recon_loss: 999049.1392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26404266.5174; train_optim_loss: 26404266.5174; val_kl_reg_loss: 16626.6663; val_edge_recon_loss: 25407604.3750; val_gene_expr_recon_loss: 996700.3422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26420931.2000; val_optim_loss: 26420931.2000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9969; val_auprc_score: 0.9953; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 17154.2081; train_edge_recon_loss: 25382518.6954; train_gene_expr_recon_loss: 997499.0087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26397171.8943; train_optim_loss: 26397171.8943; val_kl_reg_loss: 16890.9734; val_edge_recon_loss: 25399363.1250; val_gene_expr_recon_loss: 996798.1039; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26413052.3000; val_optim_loss: 26413052.3000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9970; val_auprc_score: 0.9952; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 17039.0397; train_edge_recon_loss: 25377619.0682; train_gene_expr_recon_loss: 995547.8009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26390205.9277; train_optim_loss: 26390205.9277; val_kl_reg_loss: 16919.0090; val_edge_recon_loss: 25411196.2500; val_gene_expr_recon_loss: 994498.7281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26422613.9250; val_optim_loss: 26422613.9250
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9970; val_auprc_score: 0.9955; val_best_acc_score: 0.9880; val_best_f1_score: 0.9881; train_kl_reg_loss: 17220.0086; train_edge_recon_loss: 25379824.0529; train_gene_expr_recon_loss: 994080.6462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26391124.6759; train_optim_loss: 26391124.6759; val_kl_reg_loss: 17253.2113; val_edge_recon_loss: 25400223.7500; val_gene_expr_recon_loss: 990813.5992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26408290.6750; val_optim_loss: 26408290.6750
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9972; val_auprc_score: 0.9958; val_best_acc_score: 0.9885; val_best_f1_score: 0.9886; train_kl_reg_loss: 17068.8273; train_edge_recon_loss: 25366759.3324; train_gene_expr_recon_loss: 992616.3675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26376444.5146; train_optim_loss: 26376444.5146; val_kl_reg_loss: 16822.2712; val_edge_recon_loss: 25383408.2250; val_gene_expr_recon_loss: 991194.5820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26391424.8250; val_optim_loss: 26391424.8250
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9974; val_auprc_score: 0.9961; val_best_acc_score: 0.9893; val_best_f1_score: 0.9893; train_kl_reg_loss: 16977.8792; train_edge_recon_loss: 25370066.8651; train_gene_expr_recon_loss: 991319.6841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26378364.4451; train_optim_loss: 26378364.4451; val_kl_reg_loss: 16573.3310; val_edge_recon_loss: 25371288.9000; val_gene_expr_recon_loss: 989451.6813; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26377313.8000; val_optim_loss: 26377313.8000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9974; val_auprc_score: 0.9958; val_best_acc_score: 0.9888; val_best_f1_score: 0.9889; train_kl_reg_loss: 16956.9806; train_edge_recon_loss: 25369159.5661; train_gene_expr_recon_loss: 989990.4189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26376106.8873; train_optim_loss: 26376106.8873; val_kl_reg_loss: 16669.2465; val_edge_recon_loss: 25385578.4500; val_gene_expr_recon_loss: 990825.3227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26393072.8750; val_optim_loss: 26393072.8750
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9973; val_auprc_score: 0.9958; val_best_acc_score: 0.9895; val_best_f1_score: 0.9895; train_kl_reg_loss: 16861.4880; train_edge_recon_loss: 25362998.6537; train_gene_expr_recon_loss: 989165.6876; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26369025.8665; train_optim_loss: 26369025.8665; val_kl_reg_loss: 16629.0506; val_edge_recon_loss: 25373979.3750; val_gene_expr_recon_loss: 990248.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26380856.7500; val_optim_loss: 26380856.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9973; val_auprc_score: 0.9957; val_best_acc_score: 0.9895; val_best_f1_score: 0.9896; train_kl_reg_loss: 16840.6744; train_edge_recon_loss: 25357668.6982; train_gene_expr_recon_loss: 987999.2297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26362508.6147; train_optim_loss: 26362508.6147; val_kl_reg_loss: 16560.2921; val_edge_recon_loss: 25353936.7500; val_gene_expr_recon_loss: 988140.9250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26358637.8000; val_optim_loss: 26358637.8000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9972; val_auprc_score: 0.9954; val_best_acc_score: 0.9892; val_best_f1_score: 0.9893; train_kl_reg_loss: 16851.7629; train_edge_recon_loss: 25351885.0153; train_gene_expr_recon_loss: 986242.0888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26354978.8846; train_optim_loss: 26354978.8846; val_kl_reg_loss: 16868.9843; val_edge_recon_loss: 25374769.6750; val_gene_expr_recon_loss: 987413.4273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26379052.1250; val_optim_loss: 26379052.1250
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9975; val_auprc_score: 0.9964; val_best_acc_score: 0.9894; val_best_f1_score: 0.9894; train_kl_reg_loss: 16834.6819; train_edge_recon_loss: 25349388.4200; train_gene_expr_recon_loss: 985992.1678; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26352215.3157; train_optim_loss: 26352215.3157; val_kl_reg_loss: 16618.3583; val_edge_recon_loss: 25364718.0500; val_gene_expr_recon_loss: 986521.6297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26367858.0000; val_optim_loss: 26367858.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9976; val_auprc_score: 0.9963; val_best_acc_score: 0.9899; val_best_f1_score: 0.9899; train_kl_reg_loss: 16840.1718; train_edge_recon_loss: 25350074.6092; train_gene_expr_recon_loss: 984764.2610; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26351679.0793; train_optim_loss: 26351679.0793; val_kl_reg_loss: 16676.6249; val_edge_recon_loss: 25363720.5000; val_gene_expr_recon_loss: 986449.4445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26366846.5500; val_optim_loss: 26366846.5500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9978; val_auprc_score: 0.9966; val_best_acc_score: 0.9899; val_best_f1_score: 0.9900; train_kl_reg_loss: 16698.1224; train_edge_recon_loss: 25350000.2337; train_gene_expr_recon_loss: 984394.4773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26351092.8428; train_optim_loss: 26351092.8428; val_kl_reg_loss: 16426.7962; val_edge_recon_loss: 25352770.7000; val_gene_expr_recon_loss: 983019.6680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26352217.1750; val_optim_loss: 26352217.1750
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9973; val_auprc_score: 0.9959; val_best_acc_score: 0.9891; val_best_f1_score: 0.9892; train_kl_reg_loss: 16771.6145; train_edge_recon_loss: 25339509.6356; train_gene_expr_recon_loss: 983034.0949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26339315.3185; train_optim_loss: 26339315.3185; val_kl_reg_loss: 16870.2989; val_edge_recon_loss: 25393980.5750; val_gene_expr_recon_loss: 983339.9656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26394190.8000; val_optim_loss: 26394190.8000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9976; val_auprc_score: 0.9962; val_best_acc_score: 0.9904; val_best_f1_score: 0.9904; train_kl_reg_loss: 16618.4169; train_edge_recon_loss: 25344656.9402; train_gene_expr_recon_loss: 981843.5462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26343118.8734; train_optim_loss: 26343118.8734; val_kl_reg_loss: 16438.7381; val_edge_recon_loss: 25344062.6000; val_gene_expr_recon_loss: 982141.8664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26342643.3500; val_optim_loss: 26342643.3500
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9976; val_auprc_score: 0.9963; val_best_acc_score: 0.9897; val_best_f1_score: 0.9898; train_kl_reg_loss: 16653.7307; train_edge_recon_loss: 25342029.0236; train_gene_expr_recon_loss: 981746.6193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26340429.3713; train_optim_loss: 26340429.3713; val_kl_reg_loss: 16548.1217; val_edge_recon_loss: 25353636.2000; val_gene_expr_recon_loss: 983709.5633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26353893.8250; val_optim_loss: 26353893.8250
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9977; val_auprc_score: 0.9964; val_best_acc_score: 0.9900; val_best_f1_score: 0.9901; train_kl_reg_loss: 16487.8370; train_edge_recon_loss: 25344960.1947; train_gene_expr_recon_loss: 980838.2882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26342286.3255; train_optim_loss: 26342286.3255; val_kl_reg_loss: 16302.9094; val_edge_recon_loss: 25361812.7500; val_gene_expr_recon_loss: 982384.5102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26360500.1750; val_optim_loss: 26360500.1750
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9979; val_auprc_score: 0.9968; val_best_acc_score: 0.9907; val_best_f1_score: 0.9907; train_kl_reg_loss: 16506.2414; train_edge_recon_loss: 25342565.5939; train_gene_expr_recon_loss: 978859.1134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26337930.9235; train_optim_loss: 26337930.9235; val_kl_reg_loss: 16241.3724; val_edge_recon_loss: 25344218.4000; val_gene_expr_recon_loss: 980575.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26341035.7750; val_optim_loss: 26341035.7750
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9976; val_auprc_score: 0.9959; val_best_acc_score: 0.9905; val_best_f1_score: 0.9905; train_kl_reg_loss: 16424.9612; train_edge_recon_loss: 25336566.8122; train_gene_expr_recon_loss: 978289.6370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26331281.3992; train_optim_loss: 26331281.3992; val_kl_reg_loss: 16488.7083; val_edge_recon_loss: 25346255.0750; val_gene_expr_recon_loss: 981367.7352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26344111.5000; val_optim_loss: 26344111.5000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9979; val_auprc_score: 0.9966; val_best_acc_score: 0.9909; val_best_f1_score: 0.9910; train_kl_reg_loss: 16515.9694; train_edge_recon_loss: 25337473.8971; train_gene_expr_recon_loss: 978453.6729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26332443.5494; train_optim_loss: 26332443.5494; val_kl_reg_loss: 16679.6634; val_edge_recon_loss: 25341302.8250; val_gene_expr_recon_loss: 983115.1781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26341097.8250; val_optim_loss: 26341097.8250
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9978; val_auprc_score: 0.9966; val_best_acc_score: 0.9911; val_best_f1_score: 0.9911; train_kl_reg_loss: 16498.8569; train_edge_recon_loss: 25334409.6328; train_gene_expr_recon_loss: 977668.9199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26328577.3908; train_optim_loss: 26328577.3908; val_kl_reg_loss: 16484.6018; val_edge_recon_loss: 25343610.2250; val_gene_expr_recon_loss: 982126.5953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26342221.4250; val_optim_loss: 26342221.4250
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9978; val_auprc_score: 0.9968; val_best_acc_score: 0.9908; val_best_f1_score: 0.9908; train_kl_reg_loss: 16483.5969; train_edge_recon_loss: 25337135.8359; train_gene_expr_recon_loss: 976791.6290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26330411.1266; train_optim_loss: 26330411.1266; val_kl_reg_loss: 16300.4098; val_edge_recon_loss: 25331280.1250; val_gene_expr_recon_loss: 981693.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26329274.1750; val_optim_loss: 26329274.1750
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9977; val_auprc_score: 0.9961; val_best_acc_score: 0.9907; val_best_f1_score: 0.9908; train_kl_reg_loss: 16397.0350; train_edge_recon_loss: 25331822.2531; train_gene_expr_recon_loss: 976497.5482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26324716.8707; train_optim_loss: 26324716.8707; val_kl_reg_loss: 16444.8913; val_edge_recon_loss: 25345140.1250; val_gene_expr_recon_loss: 980292.4258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26341877.4500; val_optim_loss: 26341877.4500
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9979; val_auprc_score: 0.9967; val_best_acc_score: 0.9911; val_best_f1_score: 0.9912; train_kl_reg_loss: 16416.6295; train_edge_recon_loss: 25331033.9694; train_gene_expr_recon_loss: 975689.5014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26323140.1474; train_optim_loss: 26323140.1474; val_kl_reg_loss: 16166.0843; val_edge_recon_loss: 25352345.6250; val_gene_expr_recon_loss: 979544.0266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26348055.6250; val_optim_loss: 26348055.6250
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9978; val_auprc_score: 0.9964; val_best_acc_score: 0.9911; val_best_f1_score: 0.9912; train_kl_reg_loss: 16379.8736; train_edge_recon_loss: 25332859.3352; train_gene_expr_recon_loss: 975108.5792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26324347.7858; train_optim_loss: 26324347.7858; val_kl_reg_loss: 16134.8515; val_edge_recon_loss: 25326514.3750; val_gene_expr_recon_loss: 979190.0414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26321839.4250; val_optim_loss: 26321839.4250
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9980; val_auprc_score: 0.9968; val_best_acc_score: 0.9915; val_best_f1_score: 0.9915; train_kl_reg_loss: 16337.0457; train_edge_recon_loss: 25329937.7274; train_gene_expr_recon_loss: 975112.9319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26321387.6801; train_optim_loss: 26321387.6801; val_kl_reg_loss: 16097.5339; val_edge_recon_loss: 25339469.5000; val_gene_expr_recon_loss: 983291.5164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26338858.4250; val_optim_loss: 26338858.4250
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9981; val_auprc_score: 0.9972; val_best_acc_score: 0.9909; val_best_f1_score: 0.9910; train_kl_reg_loss: 16246.1802; train_edge_recon_loss: 25331061.7552; train_gene_expr_recon_loss: 974058.5710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26321366.4868; train_optim_loss: 26321366.4868; val_kl_reg_loss: 16089.7556; val_edge_recon_loss: 25347096.2000; val_gene_expr_recon_loss: 979486.2977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26342672.3000; val_optim_loss: 26342672.3000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9982; val_auprc_score: 0.9968; val_best_acc_score: 0.9916; val_best_f1_score: 0.9916; train_kl_reg_loss: 16372.8059; train_edge_recon_loss: 25322326.6398; train_gene_expr_recon_loss: 973875.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26312574.4757; train_optim_loss: 26312574.4757; val_kl_reg_loss: 16208.4021; val_edge_recon_loss: 25326483.8500; val_gene_expr_recon_loss: 978798.4602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26321490.8500; val_optim_loss: 26321490.8500
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9981; val_auprc_score: 0.9969; val_best_acc_score: 0.9919; val_best_f1_score: 0.9919; train_kl_reg_loss: 16335.2363; train_edge_recon_loss: 25321940.9152; train_gene_expr_recon_loss: 973703.0655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26311979.1878; train_optim_loss: 26311979.1878; val_kl_reg_loss: 16173.9962; val_edge_recon_loss: 25336230.2750; val_gene_expr_recon_loss: 977115.8109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26329520.2500; val_optim_loss: 26329520.2500
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9980; val_auprc_score: 0.9970; val_best_acc_score: 0.9909; val_best_f1_score: 0.9909; train_kl_reg_loss: 16351.9565; train_edge_recon_loss: 25325112.7566; train_gene_expr_recon_loss: 971994.7532; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26313459.4910; train_optim_loss: 26313459.4910; val_kl_reg_loss: 16272.5862; val_edge_recon_loss: 25349617.1750; val_gene_expr_recon_loss: 977877.4977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26343767.2750; val_optim_loss: 26343767.2750
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9981; val_auprc_score: 0.9969; val_best_acc_score: 0.9914; val_best_f1_score: 0.9915; train_kl_reg_loss: 16359.6109; train_edge_recon_loss: 25320084.6704; train_gene_expr_recon_loss: 972420.8771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26308865.1266; train_optim_loss: 26308865.1266; val_kl_reg_loss: 16154.9528; val_edge_recon_loss: 25333645.5750; val_gene_expr_recon_loss: 978933.6898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26328734.2250; val_optim_loss: 26328734.2250
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9982; val_auprc_score: 0.9973; val_best_acc_score: 0.9917; val_best_f1_score: 0.9918; train_kl_reg_loss: 16121.0082; train_edge_recon_loss: 25322850.5480; train_gene_expr_recon_loss: 972479.7495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26311451.3352; train_optim_loss: 26311451.3352; val_kl_reg_loss: 15768.9100; val_edge_recon_loss: 25334383.8750; val_gene_expr_recon_loss: 976519.3883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26326672.1500; val_optim_loss: 26326672.1500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9982; val_auprc_score: 0.9971; val_best_acc_score: 0.9920; val_best_f1_score: 0.9921; train_kl_reg_loss: 16164.7053; train_edge_recon_loss: 25319922.0640; train_gene_expr_recon_loss: 967006.6652; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26303093.4659; train_optim_loss: 26303093.4659; val_kl_reg_loss: 16201.2560; val_edge_recon_loss: 25334353.3000; val_gene_expr_recon_loss: 975439.8820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26325994.4750; val_optim_loss: 26325994.4750
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9981; val_auprc_score: 0.9970; val_best_acc_score: 0.9917; val_best_f1_score: 0.9918; train_kl_reg_loss: 16363.1014; train_edge_recon_loss: 25315634.1558; train_gene_expr_recon_loss: 965523.5774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26297520.8790; train_optim_loss: 26297520.8790; val_kl_reg_loss: 16288.2834; val_edge_recon_loss: 25331130.3000; val_gene_expr_recon_loss: 975957.5148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26323376.0750; val_optim_loss: 26323376.0750
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9983; val_auprc_score: 0.9975; val_best_acc_score: 0.9919; val_best_f1_score: 0.9920; train_kl_reg_loss: 16450.1473; train_edge_recon_loss: 25310860.7510; train_gene_expr_recon_loss: 966134.6811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26293445.5299; train_optim_loss: 26293445.5299; val_kl_reg_loss: 16329.3901; val_edge_recon_loss: 25334229.5250; val_gene_expr_recon_loss: 974433.8078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26324992.7000; val_optim_loss: 26324992.7000
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9982; val_auprc_score: 0.9974; val_best_acc_score: 0.9919; val_best_f1_score: 0.9920; train_kl_reg_loss: 16494.8453; train_edge_recon_loss: 25313202.7371; train_gene_expr_recon_loss: 965081.1776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26294778.8011; train_optim_loss: 26294778.8011; val_kl_reg_loss: 16382.5005; val_edge_recon_loss: 25329265.9250; val_gene_expr_recon_loss: 977516.0523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26323164.4500; val_optim_loss: 26323164.4500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 496 min 14 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
Val AUROC score: 0.9981
Val AUPRC score: 0.9970
Val best accuracy score: 0.9911
Val best F1 score: 0.9911
Val gene expr MSE score: 0.6301

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
