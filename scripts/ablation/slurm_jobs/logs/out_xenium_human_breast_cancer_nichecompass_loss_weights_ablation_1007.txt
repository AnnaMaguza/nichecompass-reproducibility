None
Run timestamp: 15072023_213016_1007.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_1007']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9815; val_auprc_score: 0.9787; val_best_acc_score: 0.9351; val_best_f1_score: 0.9368; train_kl_reg_loss: 12042.4240; train_edge_recon_loss: 2701623.4755; train_gene_expr_recon_loss: 13003136.3704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15716802.2661; train_optim_loss: 15716802.2661; val_kl_reg_loss: 13310.8672; val_edge_recon_loss: 2662479.1115; val_gene_expr_recon_loss: 12464574.2474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15140364.2160; val_optim_loss: 15140364.2160
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9865; val_auprc_score: 0.9849; val_best_acc_score: 0.9438; val_best_f1_score: 0.9451; train_kl_reg_loss: 14169.0301; train_edge_recon_loss: 2638031.3163; train_gene_expr_recon_loss: 12293673.2223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14945873.5625; train_optim_loss: 14945873.5625; val_kl_reg_loss: 14381.8329; val_edge_recon_loss: 2641151.9878; val_gene_expr_recon_loss: 12243726.3937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14899260.2125; val_optim_loss: 14899260.2125
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9878; val_auprc_score: 0.9864; val_best_acc_score: 0.9462; val_best_f1_score: 0.9474; train_kl_reg_loss: 14801.1872; train_edge_recon_loss: 2627387.3478; train_gene_expr_recon_loss: 12150893.4313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14793081.9608; train_optim_loss: 14793081.9608; val_kl_reg_loss: 14177.7129; val_edge_recon_loss: 2637610.6106; val_gene_expr_recon_loss: 12146392.4704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14798180.7875; val_optim_loss: 14798180.7875
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9878; val_auprc_score: 0.9860; val_best_acc_score: 0.9472; val_best_f1_score: 0.9483; train_kl_reg_loss: 14997.5391; train_edge_recon_loss: 2621469.4047; train_gene_expr_recon_loss: 12103036.0465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14739503.0023; train_optim_loss: 14739503.0023; val_kl_reg_loss: 15020.8398; val_edge_recon_loss: 2636956.7578; val_gene_expr_recon_loss: 12146249.4843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14798227.0871; val_optim_loss: 14798227.0871
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9888; val_auprc_score: 0.9873; val_best_acc_score: 0.9493; val_best_f1_score: 0.9503; train_kl_reg_loss: 15098.7567; train_edge_recon_loss: 2618456.8244; train_gene_expr_recon_loss: 12082103.8514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14715659.4240; train_optim_loss: 14715659.4240; val_kl_reg_loss: 14994.4185; val_edge_recon_loss: 2631990.6777; val_gene_expr_recon_loss: 12124636.7596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14771621.8746; val_optim_loss: 14771621.8746
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9887; val_auprc_score: 0.9873; val_best_acc_score: 0.9494; val_best_f1_score: 0.9502; train_kl_reg_loss: 15090.2918; train_edge_recon_loss: 2615393.3730; train_gene_expr_recon_loss: 12073093.3305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14703577.0000; train_optim_loss: 14703577.0000; val_kl_reg_loss: 15079.8908; val_edge_recon_loss: 2628860.5375; val_gene_expr_recon_loss: 12101197.7491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14745138.1812; val_optim_loss: 14745138.1812
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9899; val_auprc_score: 0.9884; val_best_acc_score: 0.9523; val_best_f1_score: 0.9530; train_kl_reg_loss: 15103.0595; train_edge_recon_loss: 2613609.7811; train_gene_expr_recon_loss: 12064457.6501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14693170.4911; train_optim_loss: 14693170.4911; val_kl_reg_loss: 15133.6357; val_edge_recon_loss: 2626867.0070; val_gene_expr_recon_loss: 12092235.5296; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14734236.1707; val_optim_loss: 14734236.1707
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9900; val_auprc_score: 0.9885; val_best_acc_score: 0.9540; val_best_f1_score: 0.9547; train_kl_reg_loss: 15053.2256; train_edge_recon_loss: 2612150.0607; train_gene_expr_recon_loss: 12058181.5566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14685384.8320; train_optim_loss: 14685384.8320; val_kl_reg_loss: 14268.1558; val_edge_recon_loss: 2636345.9033; val_gene_expr_recon_loss: 12115640.7108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14766254.7700; val_optim_loss: 14766254.7700
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9898; val_auprc_score: 0.9883; val_best_acc_score: 0.9533; val_best_f1_score: 0.9541; train_kl_reg_loss: 15033.5446; train_edge_recon_loss: 2610118.9677; train_gene_expr_recon_loss: 12052951.2494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14678103.7607; train_optim_loss: 14678103.7607; val_kl_reg_loss: 14779.1199; val_edge_recon_loss: 2623204.9939; val_gene_expr_recon_loss: 12099644.9477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14737629.0592; val_optim_loss: 14737629.0592
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9903; val_auprc_score: 0.9888; val_best_acc_score: 0.9547; val_best_f1_score: 0.9554; train_kl_reg_loss: 14993.2775; train_edge_recon_loss: 2609140.2735; train_gene_expr_recon_loss: 12051089.3076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14675222.8545; train_optim_loss: 14675222.8545; val_kl_reg_loss: 15216.7743; val_edge_recon_loss: 2621752.7378; val_gene_expr_recon_loss: 12092665.0244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14729634.5296; val_optim_loss: 14729634.5296
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9910; val_auprc_score: 0.9896; val_best_acc_score: 0.9571; val_best_f1_score: 0.9577; train_kl_reg_loss: 14958.2962; train_edge_recon_loss: 2608242.6960; train_gene_expr_recon_loss: 12044767.3832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14667968.3747; train_optim_loss: 14667968.3747; val_kl_reg_loss: 14556.1402; val_edge_recon_loss: 2620506.2230; val_gene_expr_recon_loss: 12082604.2265; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14717666.5889; val_optim_loss: 14717666.5889
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9902; val_auprc_score: 0.9886; val_best_acc_score: 0.9558; val_best_f1_score: 0.9567; train_kl_reg_loss: 14901.9087; train_edge_recon_loss: 2607388.3921; train_gene_expr_recon_loss: 12042047.8957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14664338.2060; train_optim_loss: 14664338.2060; val_kl_reg_loss: 14736.7057; val_edge_recon_loss: 2621057.3423; val_gene_expr_recon_loss: 12090217.2125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14726011.2578; val_optim_loss: 14726011.2578
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9918; val_auprc_score: 0.9905; val_best_acc_score: 0.9595; val_best_f1_score: 0.9602; train_kl_reg_loss: 14850.7772; train_edge_recon_loss: 2606082.9040; train_gene_expr_recon_loss: 12036663.2859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14657596.9604; train_optim_loss: 14657596.9604; val_kl_reg_loss: 14880.6698; val_edge_recon_loss: 2619137.8902; val_gene_expr_recon_loss: 12095443.0070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14729461.5889; val_optim_loss: 14729461.5889
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9910; val_auprc_score: 0.9896; val_best_acc_score: 0.9572; val_best_f1_score: 0.9580; train_kl_reg_loss: 14807.6468; train_edge_recon_loss: 2605498.3830; train_gene_expr_recon_loss: 12041117.3340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14661423.3592; train_optim_loss: 14661423.3592; val_kl_reg_loss: 14582.7954; val_edge_recon_loss: 2614476.9599; val_gene_expr_recon_loss: 12073552.2544; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14702612.0418; val_optim_loss: 14702612.0418
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9904; val_auprc_score: 0.9887; val_best_acc_score: 0.9573; val_best_f1_score: 0.9579; train_kl_reg_loss: 14770.8444; train_edge_recon_loss: 2604879.9447; train_gene_expr_recon_loss: 12037561.2211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14657212.0182; train_optim_loss: 14657212.0182; val_kl_reg_loss: 14950.2138; val_edge_recon_loss: 2618781.1324; val_gene_expr_recon_loss: 12069096.4460; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14702827.8014; val_optim_loss: 14702827.8014
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9897; val_auprc_score: 0.9875; val_best_acc_score: 0.9565; val_best_f1_score: 0.9573; train_kl_reg_loss: 14708.4006; train_edge_recon_loss: 2604457.5631; train_gene_expr_recon_loss: 12038339.5209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14657505.4787; train_optim_loss: 14657505.4787; val_kl_reg_loss: 14770.9338; val_edge_recon_loss: 2617085.3493; val_gene_expr_recon_loss: 12087754.0418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14719610.3449; val_optim_loss: 14719610.3449
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9908; val_auprc_score: 0.9891; val_best_acc_score: 0.9578; val_best_f1_score: 0.9586; train_kl_reg_loss: 14697.3302; train_edge_recon_loss: 2603389.5131; train_gene_expr_recon_loss: 12031859.6680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14649946.5000; train_optim_loss: 14649946.5000; val_kl_reg_loss: 14419.6034; val_edge_recon_loss: 2614007.5523; val_gene_expr_recon_loss: 12077249.7735; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14705676.9303; val_optim_loss: 14705676.9303
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9914; val_auprc_score: 0.9899; val_best_acc_score: 0.9596; val_best_f1_score: 0.9601; train_kl_reg_loss: 14649.8001; train_edge_recon_loss: 2603429.5048; train_gene_expr_recon_loss: 12030415.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14648495.2560; train_optim_loss: 14648495.2560; val_kl_reg_loss: 14736.9403; val_edge_recon_loss: 2615754.5941; val_gene_expr_recon_loss: 12079215.3937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14709706.9443; val_optim_loss: 14709706.9443

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9907; val_auprc_score: 0.9890; val_best_acc_score: 0.9582; val_best_f1_score: 0.9588; train_kl_reg_loss: 15847.3031; train_edge_recon_loss: 2595749.8548; train_gene_expr_recon_loss: 11950682.6722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14562279.8324; train_optim_loss: 14562279.8324; val_kl_reg_loss: 15295.6742; val_edge_recon_loss: 2606985.7509; val_gene_expr_recon_loss: 12013351.2962; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14635632.7178; val_optim_loss: 14635632.7178
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9909; val_auprc_score: 0.9893; val_best_acc_score: 0.9587; val_best_f1_score: 0.9594; train_kl_reg_loss: 15099.8300; train_edge_recon_loss: 2593615.5335; train_gene_expr_recon_loss: 11940318.2820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14549033.6447; train_optim_loss: 14549033.6447; val_kl_reg_loss: 14770.8041; val_edge_recon_loss: 2604307.8911; val_gene_expr_recon_loss: 12010759.6481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14629838.3728; val_optim_loss: 14629838.3728
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9912; val_auprc_score: 0.9897; val_best_acc_score: 0.9595; val_best_f1_score: 0.9601; train_kl_reg_loss: 14701.3718; train_edge_recon_loss: 2593658.9119; train_gene_expr_recon_loss: 11941084.1408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14549444.4341; train_optim_loss: 14549444.4341; val_kl_reg_loss: 14575.9799; val_edge_recon_loss: 2601054.3711; val_gene_expr_recon_loss: 12002637.0801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14618267.4390; val_optim_loss: 14618267.4390
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9909; val_auprc_score: 0.9893; val_best_acc_score: 0.9587; val_best_f1_score: 0.9593; train_kl_reg_loss: 14502.7121; train_edge_recon_loss: 2593854.6152; train_gene_expr_recon_loss: 11935506.3262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14543863.6524; train_optim_loss: 14543863.6524; val_kl_reg_loss: 14536.3699; val_edge_recon_loss: 2605038.6280; val_gene_expr_recon_loss: 11999864.0488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14619439.0314; val_optim_loss: 14619439.0314
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9910; val_auprc_score: 0.9893; val_best_acc_score: 0.9588; val_best_f1_score: 0.9595; train_kl_reg_loss: 14369.0239; train_edge_recon_loss: 2592534.7689; train_gene_expr_recon_loss: 11933424.9942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14540328.7828; train_optim_loss: 14540328.7828; val_kl_reg_loss: 14133.6462; val_edge_recon_loss: 2603222.9303; val_gene_expr_recon_loss: 12005152.3972; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14622508.9617; val_optim_loss: 14622508.9617
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9910; val_auprc_score: 0.9895; val_best_acc_score: 0.9590; val_best_f1_score: 0.9598; train_kl_reg_loss: 14271.6660; train_edge_recon_loss: 2592554.8955; train_gene_expr_recon_loss: 11933430.8887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14540257.4480; train_optim_loss: 14540257.4480; val_kl_reg_loss: 14097.4278; val_edge_recon_loss: 2602222.5976; val_gene_expr_recon_loss: 12012572.1986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14628892.2195; val_optim_loss: 14628892.2195
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9913; val_auprc_score: 0.9898; val_best_acc_score: 0.9593; val_best_f1_score: 0.9599; train_kl_reg_loss: 14186.1719; train_edge_recon_loss: 2593021.7604; train_gene_expr_recon_loss: 11929379.8305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14536587.7572; train_optim_loss: 14536587.7572; val_kl_reg_loss: 14074.9421; val_edge_recon_loss: 2601879.8510; val_gene_expr_recon_loss: 11999728.2334; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14615683.0174; val_optim_loss: 14615683.0174
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9910; val_auprc_score: 0.9894; val_best_acc_score: 0.9587; val_best_f1_score: 0.9595; train_kl_reg_loss: 14113.1532; train_edge_recon_loss: 2591902.4295; train_gene_expr_recon_loss: 11931145.9527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14537161.5330; train_optim_loss: 14537161.5330; val_kl_reg_loss: 14093.2548; val_edge_recon_loss: 2602974.7936; val_gene_expr_recon_loss: 11999227.2648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14616295.3206; val_optim_loss: 14616295.3206
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9912; val_auprc_score: 0.9896; val_best_acc_score: 0.9595; val_best_f1_score: 0.9603; train_kl_reg_loss: 14055.3816; train_edge_recon_loss: 2591829.4061; train_gene_expr_recon_loss: 11929162.6986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14535047.4853; train_optim_loss: 14535047.4853; val_kl_reg_loss: 13917.6885; val_edge_recon_loss: 2598920.4007; val_gene_expr_recon_loss: 11983997.3659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14596835.4704; val_optim_loss: 14596835.4704
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9909; val_auprc_score: 0.9893; val_best_acc_score: 0.9588; val_best_f1_score: 0.9596; train_kl_reg_loss: 14005.3072; train_edge_recon_loss: 2592665.5583; train_gene_expr_recon_loss: 11929632.4449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14536303.3018; train_optim_loss: 14536303.3018; val_kl_reg_loss: 13868.3864; val_edge_recon_loss: 2602318.4495; val_gene_expr_recon_loss: 11993072.6167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14609259.4495; val_optim_loss: 14609259.4495
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9912; val_auprc_score: 0.9897; val_best_acc_score: 0.9598; val_best_f1_score: 0.9605; train_kl_reg_loss: 13951.5299; train_edge_recon_loss: 2591191.6454; train_gene_expr_recon_loss: 11925367.2207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14530510.4038; train_optim_loss: 14530510.4038; val_kl_reg_loss: 13890.4105; val_edge_recon_loss: 2599415.2239; val_gene_expr_recon_loss: 12004967.3136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14618272.9617; val_optim_loss: 14618272.9617
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9908; val_auprc_score: 0.9892; val_best_acc_score: 0.9588; val_best_f1_score: 0.9595; train_kl_reg_loss: 13911.3410; train_edge_recon_loss: 2592242.2469; train_gene_expr_recon_loss: 11931165.6951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14537319.2933; train_optim_loss: 14537319.2933; val_kl_reg_loss: 13812.8867; val_edge_recon_loss: 2600090.0357; val_gene_expr_recon_loss: 11992503.5331; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14606406.4495; val_optim_loss: 14606406.4495
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9912; val_auprc_score: 0.9897; val_best_acc_score: 0.9595; val_best_f1_score: 0.9601; train_kl_reg_loss: 13877.0628; train_edge_recon_loss: 2592175.1374; train_gene_expr_recon_loss: 11922953.7754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14529005.9713; train_optim_loss: 14529005.9713; val_kl_reg_loss: 13784.2065; val_edge_recon_loss: 2600626.9111; val_gene_expr_recon_loss: 11990538.4007; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14604949.5017; val_optim_loss: 14604949.5017

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9911; val_auprc_score: 0.9895; val_best_acc_score: 0.9596; val_best_f1_score: 0.9602; train_kl_reg_loss: 14003.6692; train_edge_recon_loss: 2590905.3225; train_gene_expr_recon_loss: 11912921.5888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14517830.5830; train_optim_loss: 14517830.5830; val_kl_reg_loss: 13949.5216; val_edge_recon_loss: 2599852.1411; val_gene_expr_recon_loss: 11989337.2753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14603138.9373; val_optim_loss: 14603138.9373
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9912; val_auprc_score: 0.9895; val_best_acc_score: 0.9598; val_best_f1_score: 0.9604; train_kl_reg_loss: 14066.4097; train_edge_recon_loss: 2590975.3221; train_gene_expr_recon_loss: 11912321.4670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14517363.1998; train_optim_loss: 14517363.1998; val_kl_reg_loss: 13945.5920; val_edge_recon_loss: 2599297.0139; val_gene_expr_recon_loss: 11979932.3066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14593174.9129; val_optim_loss: 14593174.9129
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9912; val_auprc_score: 0.9895; val_best_acc_score: 0.9592; val_best_f1_score: 0.9599; train_kl_reg_loss: 14057.2031; train_edge_recon_loss: 2590776.7453; train_gene_expr_recon_loss: 11912644.0733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14517478.0225; train_optim_loss: 14517478.0225; val_kl_reg_loss: 13919.9870; val_edge_recon_loss: 2602078.8458; val_gene_expr_recon_loss: 11978722.7003; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14594721.5261; val_optim_loss: 14594721.5261
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9911; val_auprc_score: 0.9895; val_best_acc_score: 0.9596; val_best_f1_score: 0.9602; train_kl_reg_loss: 14034.6850; train_edge_recon_loss: 2589802.2722; train_gene_expr_recon_loss: 11912583.0186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14516419.9868; train_optim_loss: 14516419.9868; val_kl_reg_loss: 13892.0987; val_edge_recon_loss: 2598639.6002; val_gene_expr_recon_loss: 11986994.5122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14599526.1951; val_optim_loss: 14599526.1951
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9911; val_auprc_score: 0.9897; val_best_acc_score: 0.9594; val_best_f1_score: 0.9601; train_kl_reg_loss: 14013.8822; train_edge_recon_loss: 2590762.0972; train_gene_expr_recon_loss: 11909462.4244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14514238.4050; train_optim_loss: 14514238.4050; val_kl_reg_loss: 13892.2466; val_edge_recon_loss: 2599944.2178; val_gene_expr_recon_loss: 11986845.2300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14600681.6864; val_optim_loss: 14600681.6864
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9909; val_auprc_score: 0.9892; val_best_acc_score: 0.9590; val_best_f1_score: 0.9596; train_kl_reg_loss: 13994.4574; train_edge_recon_loss: 2589745.1983; train_gene_expr_recon_loss: 11913611.2122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14517350.8798; train_optim_loss: 14517350.8798; val_kl_reg_loss: 13898.1630; val_edge_recon_loss: 2601461.3833; val_gene_expr_recon_loss: 11983590.3206; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14598949.8815; val_optim_loss: 14598949.8815

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9911; val_auprc_score: 0.9894; val_best_acc_score: 0.9592; val_best_f1_score: 0.9599; train_kl_reg_loss: 13987.7836; train_edge_recon_loss: 2590252.7017; train_gene_expr_recon_loss: 11907715.7087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14511956.1939; train_optim_loss: 14511956.1939; val_kl_reg_loss: 13879.8656; val_edge_recon_loss: 2599261.2047; val_gene_expr_recon_loss: 11987100.7282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14600241.7770; val_optim_loss: 14600241.7770
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9910; val_auprc_score: 0.9894; val_best_acc_score: 0.9594; val_best_f1_score: 0.9599; train_kl_reg_loss: 13986.5350; train_edge_recon_loss: 2589447.5826; train_gene_expr_recon_loss: 11909572.4802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14513006.6024; train_optim_loss: 14513006.6024; val_kl_reg_loss: 13884.7153; val_edge_recon_loss: 2600066.3650; val_gene_expr_recon_loss: 11990211.9721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14604163.0767; val_optim_loss: 14604163.0767
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9910; val_auprc_score: 0.9894; val_best_acc_score: 0.9592; val_best_f1_score: 0.9598; train_kl_reg_loss: 13989.0730; train_edge_recon_loss: 2590278.5112; train_gene_expr_recon_loss: 11910583.7983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14514851.3809; train_optim_loss: 14514851.3809; val_kl_reg_loss: 13882.9203; val_edge_recon_loss: 2599477.7003; val_gene_expr_recon_loss: 11984648.7700; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14598009.3449; val_optim_loss: 14598009.3449
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9911; val_auprc_score: 0.9895; val_best_acc_score: 0.9592; val_best_f1_score: 0.9598; train_kl_reg_loss: 13990.4819; train_edge_recon_loss: 2589845.6739; train_gene_expr_recon_loss: 11907735.0749; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14511571.2265; train_optim_loss: 14511571.2265; val_kl_reg_loss: 13886.0368; val_edge_recon_loss: 2601029.5531; val_gene_expr_recon_loss: 11981918.4983; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14596834.1010; val_optim_loss: 14596834.1010

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 962 min 3 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
Val AUROC score: 0.9911
Val AUPRC score: 0.9896
Val best accuracy score: 0.9590
Val best F1 score: 0.9597
Val gene expr MSE score: 2.6278

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
