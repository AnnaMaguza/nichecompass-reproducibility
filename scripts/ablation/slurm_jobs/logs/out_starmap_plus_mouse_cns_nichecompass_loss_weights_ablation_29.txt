None
Run timestamp: 02072023_132447_29.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_29']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9717; val_auprc_score: 0.9561; val_best_acc_score: 0.9335; val_best_f1_score: 0.9358; train_kl_reg_loss: 5929.2144; train_edge_recon_loss: 273763.8901; train_gene_expr_recon_loss: 14868.0497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 294561.1543; train_optim_loss: 294561.1543; val_kl_reg_loss: 5740.7440; val_edge_recon_loss: 262092.7741; val_gene_expr_recon_loss: 13910.6662; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281744.1818; val_optim_loss: 281744.1818
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9730; val_auprc_score: 0.9589; val_best_acc_score: 0.9377; val_best_f1_score: 0.9396; train_kl_reg_loss: 5776.8370; train_edge_recon_loss: 260641.5930; train_gene_expr_recon_loss: 13249.9297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279668.3595; train_optim_loss: 279668.3595; val_kl_reg_loss: 5534.0710; val_edge_recon_loss: 260719.9858; val_gene_expr_recon_loss: 12859.1827; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279113.2386; val_optim_loss: 279113.2386
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9762; val_auprc_score: 0.9621; val_best_acc_score: 0.9443; val_best_f1_score: 0.9460; train_kl_reg_loss: 5676.6090; train_edge_recon_loss: 259185.8166; train_gene_expr_recon_loss: 12550.3496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277412.7741; train_optim_loss: 277412.7741; val_kl_reg_loss: 5458.4884; val_edge_recon_loss: 259974.0000; val_gene_expr_recon_loss: 12409.7864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277842.2756; val_optim_loss: 277842.2756
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9765; val_auprc_score: 0.9621; val_best_acc_score: 0.9489; val_best_f1_score: 0.9502; train_kl_reg_loss: 5637.6622; train_edge_recon_loss: 258819.9995; train_gene_expr_recon_loss: 12166.4767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276624.1388; train_optim_loss: 276624.1388; val_kl_reg_loss: 5556.6706; val_edge_recon_loss: 259623.5213; val_gene_expr_recon_loss: 12095.5559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277275.7514; val_optim_loss: 277275.7514
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9798; val_auprc_score: 0.9677; val_best_acc_score: 0.9528; val_best_f1_score: 0.9542; train_kl_reg_loss: 5627.6296; train_edge_recon_loss: 258126.0465; train_gene_expr_recon_loss: 11894.9491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 275648.6257; train_optim_loss: 275648.6257; val_kl_reg_loss: 5466.1471; val_edge_recon_loss: 258538.3466; val_gene_expr_recon_loss: 11855.1820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275859.6761; val_optim_loss: 275859.6761
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9790; val_auprc_score: 0.9666; val_best_acc_score: 0.9529; val_best_f1_score: 0.9542; train_kl_reg_loss: 5613.2793; train_edge_recon_loss: 257988.8847; train_gene_expr_recon_loss: 11697.7053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 275299.8690; train_optim_loss: 275299.8690; val_kl_reg_loss: 5486.4833; val_edge_recon_loss: 258958.1357; val_gene_expr_recon_loss: 11638.7582; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276083.3764; val_optim_loss: 276083.3764
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9797; val_auprc_score: 0.9684; val_best_acc_score: 0.9544; val_best_f1_score: 0.9558; train_kl_reg_loss: 5614.2172; train_edge_recon_loss: 257532.0090; train_gene_expr_recon_loss: 11547.4270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274693.6540; train_optim_loss: 274693.6540; val_kl_reg_loss: 5450.6860; val_edge_recon_loss: 258622.8963; val_gene_expr_recon_loss: 11600.0759; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275673.6577; val_optim_loss: 275673.6577
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9819; val_auprc_score: 0.9712; val_best_acc_score: 0.9578; val_best_f1_score: 0.9589; train_kl_reg_loss: 5609.9556; train_edge_recon_loss: 257552.3376; train_gene_expr_recon_loss: 11428.1198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274590.4123; train_optim_loss: 274590.4123; val_kl_reg_loss: 5496.5305; val_edge_recon_loss: 257978.5234; val_gene_expr_recon_loss: 11446.8140; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274921.8707; val_optim_loss: 274921.8707
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9820; val_auprc_score: 0.9720; val_best_acc_score: 0.9583; val_best_f1_score: 0.9594; train_kl_reg_loss: 5601.6464; train_edge_recon_loss: 257464.9504; train_gene_expr_recon_loss: 11312.3908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274378.9878; train_optim_loss: 274378.9878; val_kl_reg_loss: 5464.4895; val_edge_recon_loss: 258198.4169; val_gene_expr_recon_loss: 11305.3232; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274968.2315; val_optim_loss: 274968.2315
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9833; val_auprc_score: 0.9739; val_best_acc_score: 0.9597; val_best_f1_score: 0.9609; train_kl_reg_loss: 5599.2995; train_edge_recon_loss: 257470.2952; train_gene_expr_recon_loss: 11228.2378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274297.8327; train_optim_loss: 274297.8327; val_kl_reg_loss: 5527.5108; val_edge_recon_loss: 257887.5795; val_gene_expr_recon_loss: 11268.4317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274683.5199; val_optim_loss: 274683.5199
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9826; val_auprc_score: 0.9721; val_best_acc_score: 0.9592; val_best_f1_score: 0.9601; train_kl_reg_loss: 5602.5620; train_edge_recon_loss: 257025.0114; train_gene_expr_recon_loss: 11137.4729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273765.0457; train_optim_loss: 273765.0457; val_kl_reg_loss: 5355.3502; val_edge_recon_loss: 258178.7152; val_gene_expr_recon_loss: 11155.3529; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274689.4219; val_optim_loss: 274689.4219
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9832; val_auprc_score: 0.9737; val_best_acc_score: 0.9596; val_best_f1_score: 0.9606; train_kl_reg_loss: 5600.2690; train_edge_recon_loss: 257146.6392; train_gene_expr_recon_loss: 11066.5400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273813.4486; train_optim_loss: 273813.4486; val_kl_reg_loss: 5395.5280; val_edge_recon_loss: 258101.6683; val_gene_expr_recon_loss: 11084.3802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274581.5781; val_optim_loss: 274581.5781
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9854; val_auprc_score: 0.9774; val_best_acc_score: 0.9630; val_best_f1_score: 0.9638; train_kl_reg_loss: 5593.6532; train_edge_recon_loss: 257052.3507; train_gene_expr_recon_loss: 11005.2586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273651.2624; train_optim_loss: 273651.2624; val_kl_reg_loss: 5617.8844; val_edge_recon_loss: 257026.2365; val_gene_expr_recon_loss: 11004.8913; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273649.0099; val_optim_loss: 273649.0099
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9850; val_auprc_score: 0.9775; val_best_acc_score: 0.9614; val_best_f1_score: 0.9624; train_kl_reg_loss: 5593.2599; train_edge_recon_loss: 256947.5256; train_gene_expr_recon_loss: 10948.9501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273489.7363; train_optim_loss: 273489.7363; val_kl_reg_loss: 5466.7274; val_edge_recon_loss: 257394.6861; val_gene_expr_recon_loss: 10955.7867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273817.2031; val_optim_loss: 273817.2031
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9855; val_auprc_score: 0.9769; val_best_acc_score: 0.9630; val_best_f1_score: 0.9639; train_kl_reg_loss: 5595.0152; train_edge_recon_loss: 256826.3993; train_gene_expr_recon_loss: 10903.5472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273324.9642; train_optim_loss: 273324.9642; val_kl_reg_loss: 5539.8219; val_edge_recon_loss: 257522.3828; val_gene_expr_recon_loss: 10908.6014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273970.8082; val_optim_loss: 273970.8082
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9848; val_auprc_score: 0.9760; val_best_acc_score: 0.9639; val_best_f1_score: 0.9648; train_kl_reg_loss: 5590.6777; train_edge_recon_loss: 256831.0369; train_gene_expr_recon_loss: 10842.6658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273264.3809; train_optim_loss: 273264.3809; val_kl_reg_loss: 5565.1985; val_edge_recon_loss: 257712.6122; val_gene_expr_recon_loss: 10894.8788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274172.6889; val_optim_loss: 274172.6889
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9850; val_auprc_score: 0.9761; val_best_acc_score: 0.9637; val_best_f1_score: 0.9647; train_kl_reg_loss: 5589.3900; train_edge_recon_loss: 256764.6131; train_gene_expr_recon_loss: 10801.4234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273155.4264; train_optim_loss: 273155.4264; val_kl_reg_loss: 5457.4686; val_edge_recon_loss: 257395.7116; val_gene_expr_recon_loss: 10867.9770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273721.1562; val_optim_loss: 273721.1562

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9861; val_auprc_score: 0.9783; val_best_acc_score: 0.9650; val_best_f1_score: 0.9658; train_kl_reg_loss: 5581.7124; train_edge_recon_loss: 256413.8556; train_gene_expr_recon_loss: 10769.0731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272764.6413; train_optim_loss: 272764.6413; val_kl_reg_loss: 5486.5882; val_edge_recon_loss: 257026.9141; val_gene_expr_recon_loss: 10803.7108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273317.2131; val_optim_loss: 273317.2131
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9861; val_auprc_score: 0.9775; val_best_acc_score: 0.9644; val_best_f1_score: 0.9651; train_kl_reg_loss: 5575.2562; train_edge_recon_loss: 256554.6600; train_gene_expr_recon_loss: 10756.0738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272885.9891; train_optim_loss: 272885.9891; val_kl_reg_loss: 5463.7960; val_edge_recon_loss: 257522.1051; val_gene_expr_recon_loss: 10844.1961; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273830.0966; val_optim_loss: 273830.0966
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9867; val_auprc_score: 0.9792; val_best_acc_score: 0.9650; val_best_f1_score: 0.9658; train_kl_reg_loss: 5571.6586; train_edge_recon_loss: 256655.2030; train_gene_expr_recon_loss: 10756.9240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272983.7856; train_optim_loss: 272983.7856; val_kl_reg_loss: 5486.1933; val_edge_recon_loss: 257366.7621; val_gene_expr_recon_loss: 10776.9042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273629.8622; val_optim_loss: 273629.8622
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9869; val_auprc_score: 0.9800; val_best_acc_score: 0.9650; val_best_f1_score: 0.9658; train_kl_reg_loss: 5572.1170; train_edge_recon_loss: 256545.8526; train_gene_expr_recon_loss: 10744.8070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272862.7752; train_optim_loss: 272862.7752; val_kl_reg_loss: 5467.5381; val_edge_recon_loss: 257172.4972; val_gene_expr_recon_loss: 10786.4233; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273426.4574; val_optim_loss: 273426.4574
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9864; val_auprc_score: 0.9790; val_best_acc_score: 0.9647; val_best_f1_score: 0.9655; train_kl_reg_loss: 5572.0881; train_edge_recon_loss: 256423.0288; train_gene_expr_recon_loss: 10729.5017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272724.6187; train_optim_loss: 272724.6187; val_kl_reg_loss: 5458.7994; val_edge_recon_loss: 257411.3232; val_gene_expr_recon_loss: 10803.7478; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273673.8679; val_optim_loss: 273673.8679

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9869; val_auprc_score: 0.9798; val_best_acc_score: 0.9666; val_best_f1_score: 0.9673; train_kl_reg_loss: 5569.3548; train_edge_recon_loss: 256403.8238; train_gene_expr_recon_loss: 10725.4415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272698.6221; train_optim_loss: 272698.6221; val_kl_reg_loss: 5462.2002; val_edge_recon_loss: 256916.1740; val_gene_expr_recon_loss: 10798.2971; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273176.6705; val_optim_loss: 273176.6705
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9871; val_auprc_score: 0.9798; val_best_acc_score: 0.9655; val_best_f1_score: 0.9663; train_kl_reg_loss: 5564.7801; train_edge_recon_loss: 256635.4301; train_gene_expr_recon_loss: 10727.1589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272927.3704; train_optim_loss: 272927.3704; val_kl_reg_loss: 5457.7900; val_edge_recon_loss: 257033.1385; val_gene_expr_recon_loss: 10800.4926; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273291.4261; val_optim_loss: 273291.4261
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9869; val_auprc_score: 0.9799; val_best_acc_score: 0.9652; val_best_f1_score: 0.9660; train_kl_reg_loss: 5566.1426; train_edge_recon_loss: 256475.3446; train_gene_expr_recon_loss: 10732.1726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272773.6595; train_optim_loss: 272773.6595; val_kl_reg_loss: 5466.6650; val_edge_recon_loss: 257245.0497; val_gene_expr_recon_loss: 10795.8777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273507.5923; val_optim_loss: 273507.5923
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9864; val_auprc_score: 0.9792; val_best_acc_score: 0.9652; val_best_f1_score: 0.9659; train_kl_reg_loss: 5563.4792; train_edge_recon_loss: 256770.5610; train_gene_expr_recon_loss: 10726.2643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273060.3050; train_optim_loss: 273060.3050; val_kl_reg_loss: 5447.6616; val_edge_recon_loss: 257484.0362; val_gene_expr_recon_loss: 10785.9817; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273717.6747; val_optim_loss: 273717.6747
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9864; val_auprc_score: 0.9788; val_best_acc_score: 0.9646; val_best_f1_score: 0.9655; train_kl_reg_loss: 5569.2244; train_edge_recon_loss: 256411.8285; train_gene_expr_recon_loss: 10722.8519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272703.9048; train_optim_loss: 272703.9048; val_kl_reg_loss: 5458.8505; val_edge_recon_loss: 257352.1676; val_gene_expr_recon_loss: 10816.4644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273627.4815; val_optim_loss: 273627.4815

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9869; val_auprc_score: 0.9801; val_best_acc_score: 0.9654; val_best_f1_score: 0.9663; train_kl_reg_loss: 5569.7067; train_edge_recon_loss: 256538.1139; train_gene_expr_recon_loss: 10728.7706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272836.5915; train_optim_loss: 272836.5915; val_kl_reg_loss: 5454.1194; val_edge_recon_loss: 256970.8466; val_gene_expr_recon_loss: 10788.9162; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273213.8835; val_optim_loss: 273213.8835
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9860; val_auprc_score: 0.9780; val_best_acc_score: 0.9644; val_best_f1_score: 0.9651; train_kl_reg_loss: 5568.4584; train_edge_recon_loss: 256424.0645; train_gene_expr_recon_loss: 10720.7097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272713.2331; train_optim_loss: 272713.2331; val_kl_reg_loss: 5453.5675; val_edge_recon_loss: 257311.9347; val_gene_expr_recon_loss: 10765.4079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273530.9091; val_optim_loss: 273530.9091
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9870; val_auprc_score: 0.9794; val_best_acc_score: 0.9673; val_best_f1_score: 0.9680; train_kl_reg_loss: 5568.1614; train_edge_recon_loss: 256462.7441; train_gene_expr_recon_loss: 10722.3926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272753.2985; train_optim_loss: 272753.2985; val_kl_reg_loss: 5451.8592; val_edge_recon_loss: 256694.2287; val_gene_expr_recon_loss: 10795.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272941.5057; val_optim_loss: 272941.5057
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9866; val_auprc_score: 0.9796; val_best_acc_score: 0.9651; val_best_f1_score: 0.9657; train_kl_reg_loss: 5566.4792; train_edge_recon_loss: 256540.6666; train_gene_expr_recon_loss: 10721.3712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272828.5173; train_optim_loss: 272828.5173; val_kl_reg_loss: 5454.1254; val_edge_recon_loss: 257174.6115; val_gene_expr_recon_loss: 10787.9567; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273416.6960; val_optim_loss: 273416.6960
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9875; val_auprc_score: 0.9816; val_best_acc_score: 0.9670; val_best_f1_score: 0.9678; train_kl_reg_loss: 5567.0712; train_edge_recon_loss: 256372.4315; train_gene_expr_recon_loss: 10730.9581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272670.4611; train_optim_loss: 272670.4611; val_kl_reg_loss: 5452.9384; val_edge_recon_loss: 256626.8395; val_gene_expr_recon_loss: 10795.6277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272875.4091; val_optim_loss: 272875.4091
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9864; val_auprc_score: 0.9789; val_best_acc_score: 0.9658; val_best_f1_score: 0.9665; train_kl_reg_loss: 5566.6391; train_edge_recon_loss: 256340.8042; train_gene_expr_recon_loss: 10728.8689; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272636.3118; train_optim_loss: 272636.3118; val_kl_reg_loss: 5453.4967; val_edge_recon_loss: 257050.1328; val_gene_expr_recon_loss: 10796.1344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273299.7614; val_optim_loss: 273299.7614
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9873; val_auprc_score: 0.9804; val_best_acc_score: 0.9664; val_best_f1_score: 0.9671; train_kl_reg_loss: 5566.5548; train_edge_recon_loss: 256541.6370; train_gene_expr_recon_loss: 10719.7280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272827.9199; train_optim_loss: 272827.9199; val_kl_reg_loss: 5454.0977; val_edge_recon_loss: 257055.1875; val_gene_expr_recon_loss: 10782.3590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273291.6477; val_optim_loss: 273291.6477
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9867; val_auprc_score: 0.9794; val_best_acc_score: 0.9657; val_best_f1_score: 0.9665; train_kl_reg_loss: 5567.9901; train_edge_recon_loss: 256355.8181; train_gene_expr_recon_loss: 10719.1341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272642.9412; train_optim_loss: 272642.9412; val_kl_reg_loss: 5453.7294; val_edge_recon_loss: 256994.2628; val_gene_expr_recon_loss: 10779.6679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273227.6577; val_optim_loss: 273227.6577
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9861; val_auprc_score: 0.9785; val_best_acc_score: 0.9649; val_best_f1_score: 0.9656; train_kl_reg_loss: 5568.2128; train_edge_recon_loss: 256476.5790; train_gene_expr_recon_loss: 10717.5028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272762.2944; train_optim_loss: 272762.2944; val_kl_reg_loss: 5454.0570; val_edge_recon_loss: 257384.7152; val_gene_expr_recon_loss: 10784.0293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273622.8011; val_optim_loss: 273622.8011

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9869; val_auprc_score: 0.9800; val_best_acc_score: 0.9655; val_best_f1_score: 0.9662; train_kl_reg_loss: 5567.6881; train_edge_recon_loss: 256639.6119; train_gene_expr_recon_loss: 10730.5081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272937.8086; train_optim_loss: 272937.8086; val_kl_reg_loss: 5454.2172; val_edge_recon_loss: 257097.2784; val_gene_expr_recon_loss: 10807.8759; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273359.3736; val_optim_loss: 273359.3736
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9853; val_auprc_score: 0.9772; val_best_acc_score: 0.9641; val_best_f1_score: 0.9651; train_kl_reg_loss: 5566.9737; train_edge_recon_loss: 256570.1219; train_gene_expr_recon_loss: 10720.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272857.9533; train_optim_loss: 272857.9533; val_kl_reg_loss: 5453.6948; val_edge_recon_loss: 257461.2898; val_gene_expr_recon_loss: 10783.8770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273698.8594; val_optim_loss: 273698.8594
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9869; val_auprc_score: 0.9801; val_best_acc_score: 0.9667; val_best_f1_score: 0.9674; train_kl_reg_loss: 5566.5747; train_edge_recon_loss: 256549.0652; train_gene_expr_recon_loss: 10729.8440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272845.4832; train_optim_loss: 272845.4832; val_kl_reg_loss: 5454.1270; val_edge_recon_loss: 256753.8906; val_gene_expr_recon_loss: 10797.6801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273005.6989; val_optim_loss: 273005.6989
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9872; val_auprc_score: 0.9803; val_best_acc_score: 0.9663; val_best_f1_score: 0.9671; train_kl_reg_loss: 5566.1609; train_edge_recon_loss: 256448.3788; train_gene_expr_recon_loss: 10727.7050; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272742.2459; train_optim_loss: 272742.2459; val_kl_reg_loss: 5452.4151; val_edge_recon_loss: 257015.2010; val_gene_expr_recon_loss: 10784.2428; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273251.8580; val_optim_loss: 273251.8580

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 36 min 11 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
Val AUROC score: 0.9872
Val AUPRC score: 0.9803
Val best accuracy score: 0.9663
Val best F1 score: 0.9670
Val gene expr MSE score: 0.7283

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
