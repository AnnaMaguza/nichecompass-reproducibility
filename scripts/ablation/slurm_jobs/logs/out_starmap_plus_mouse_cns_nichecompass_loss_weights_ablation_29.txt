None
Run timestamp: 30062023_112602_29.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_29']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
heaps
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9694; val_auprc_score: 0.9539; val_best_acc_score: 0.9301; val_best_f1_score: 0.9320; train_kl_reg_loss: 6111.0854; train_edge_recon_loss: 273972.1641; train_gene_expr_recon_loss: 15153.9869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 295237.2370; train_optim_loss: 295237.2370; val_kl_reg_loss: 5835.7174; val_edge_recon_loss: 262945.2422; val_gene_expr_recon_loss: 14116.4199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282897.3778; val_optim_loss: 282897.3778
heaps
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9735; val_auprc_score: 0.9602; val_best_acc_score: 0.9388; val_best_f1_score: 0.9408; train_kl_reg_loss: 5962.7333; train_edge_recon_loss: 260612.5440; train_gene_expr_recon_loss: 13415.1833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279990.4604; train_optim_loss: 279990.4604; val_kl_reg_loss: 5853.8964; val_edge_recon_loss: 260867.1158; val_gene_expr_recon_loss: 13034.3485; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279755.3622; val_optim_loss: 279755.3622
heaps
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9775; val_auprc_score: 0.9661; val_best_acc_score: 0.9457; val_best_f1_score: 0.9473; train_kl_reg_loss: 5867.7108; train_edge_recon_loss: 259440.9737; train_gene_expr_recon_loss: 12676.6406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277985.3260; train_optim_loss: 277985.3260; val_kl_reg_loss: 5656.7122; val_edge_recon_loss: 259998.6619; val_gene_expr_recon_loss: 12427.3350; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278082.7088; val_optim_loss: 278082.7088
heaps
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9777; val_auprc_score: 0.9658; val_best_acc_score: 0.9493; val_best_f1_score: 0.9508; train_kl_reg_loss: 5831.1764; train_edge_recon_loss: 258814.2938; train_gene_expr_recon_loss: 12288.7863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276934.2575; train_optim_loss: 276934.2575; val_kl_reg_loss: 5728.9801; val_edge_recon_loss: 259776.7088; val_gene_expr_recon_loss: 12188.7694; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277694.4574; val_optim_loss: 277694.4574
heaps
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9787; val_auprc_score: 0.9666; val_best_acc_score: 0.9497; val_best_f1_score: 0.9512; train_kl_reg_loss: 5812.2839; train_edge_recon_loss: 258260.5057; train_gene_expr_recon_loss: 12032.2263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276105.0148; train_optim_loss: 276105.0148; val_kl_reg_loss: 5637.0237; val_edge_recon_loss: 259696.2905; val_gene_expr_recon_loss: 11944.3252; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277277.6406; val_optim_loss: 277277.6406
heaps
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9777; val_auprc_score: 0.9634; val_best_acc_score: 0.9513; val_best_f1_score: 0.9528; train_kl_reg_loss: 5789.8231; train_edge_recon_loss: 258230.1195; train_gene_expr_recon_loss: 11839.2371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 275859.1794; train_optim_loss: 275859.1794; val_kl_reg_loss: 5610.5540; val_edge_recon_loss: 259149.9560; val_gene_expr_recon_loss: 11754.0167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276514.5199; val_optim_loss: 276514.5199
heaps
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9813; val_auprc_score: 0.9706; val_best_acc_score: 0.9553; val_best_f1_score: 0.9563; train_kl_reg_loss: 5788.3617; train_edge_recon_loss: 257906.4908; train_gene_expr_recon_loss: 11694.0420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 275388.8932; train_optim_loss: 275388.8932; val_kl_reg_loss: 5704.4215; val_edge_recon_loss: 258966.4893; val_gene_expr_recon_loss: 11626.8302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276297.7401; val_optim_loss: 276297.7401
heaps
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9812; val_auprc_score: 0.9704; val_best_acc_score: 0.9569; val_best_f1_score: 0.9581; train_kl_reg_loss: 5787.3536; train_edge_recon_loss: 257767.7126; train_gene_expr_recon_loss: 11564.4339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 275119.5005; train_optim_loss: 275119.5005; val_kl_reg_loss: 5562.5374; val_edge_recon_loss: 258447.4290; val_gene_expr_recon_loss: 11591.5002; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275601.4673; val_optim_loss: 275601.4673
heaps
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9820; val_auprc_score: 0.9719; val_best_acc_score: 0.9563; val_best_f1_score: 0.9575; train_kl_reg_loss: 5786.6623; train_edge_recon_loss: 257712.3237; train_gene_expr_recon_loss: 11447.1743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274946.1592; train_optim_loss: 274946.1592; val_kl_reg_loss: 5607.6338; val_edge_recon_loss: 258496.3324; val_gene_expr_recon_loss: 11435.7694; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275539.7415; val_optim_loss: 275539.7415
heaps
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9817; val_auprc_score: 0.9722; val_best_acc_score: 0.9564; val_best_f1_score: 0.9577; train_kl_reg_loss: 5774.2427; train_edge_recon_loss: 257397.7005; train_gene_expr_recon_loss: 11355.0489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274526.9919; train_optim_loss: 274526.9919; val_kl_reg_loss: 5673.3180; val_edge_recon_loss: 258299.6172; val_gene_expr_recon_loss: 11356.8897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275329.8224; val_optim_loss: 275329.8224
heaps
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9834; val_auprc_score: 0.9740; val_best_acc_score: 0.9599; val_best_f1_score: 0.9609; train_kl_reg_loss: 5779.5836; train_edge_recon_loss: 257224.6461; train_gene_expr_recon_loss: 11271.7678; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274275.9971; train_optim_loss: 274275.9971; val_kl_reg_loss: 5701.2801; val_edge_recon_loss: 258138.8253; val_gene_expr_recon_loss: 11271.6245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275111.7244; val_optim_loss: 275111.7244
heaps
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9823; val_auprc_score: 0.9721; val_best_acc_score: 0.9594; val_best_f1_score: 0.9604; train_kl_reg_loss: 5780.3817; train_edge_recon_loss: 257136.4825; train_gene_expr_recon_loss: 11209.6145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274126.4785; train_optim_loss: 274126.4785; val_kl_reg_loss: 5832.3504; val_edge_recon_loss: 258221.0142; val_gene_expr_recon_loss: 11218.7071; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275272.0739; val_optim_loss: 275272.0739
heaps
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9841; val_auprc_score: 0.9741; val_best_acc_score: 0.9620; val_best_f1_score: 0.9629; train_kl_reg_loss: 5777.6277; train_edge_recon_loss: 257076.0460; train_gene_expr_recon_loss: 11147.9181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274001.5929; train_optim_loss: 274001.5929; val_kl_reg_loss: 5712.7118; val_edge_recon_loss: 257781.7109; val_gene_expr_recon_loss: 11130.1793; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274624.6023; val_optim_loss: 274624.6023
heaps
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9840; val_auprc_score: 0.9751; val_best_acc_score: 0.9618; val_best_f1_score: 0.9627; train_kl_reg_loss: 5775.3310; train_edge_recon_loss: 256999.6749; train_gene_expr_recon_loss: 11089.3059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273864.3115; train_optim_loss: 273864.3115; val_kl_reg_loss: 5683.1198; val_edge_recon_loss: 257795.5661; val_gene_expr_recon_loss: 11075.2911; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274553.9773; val_optim_loss: 274553.9773
heaps
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9850; val_auprc_score: 0.9761; val_best_acc_score: 0.9634; val_best_f1_score: 0.9642; train_kl_reg_loss: 5775.8241; train_edge_recon_loss: 257060.6723; train_gene_expr_recon_loss: 11040.4639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273876.9606; train_optim_loss: 273876.9606; val_kl_reg_loss: 5657.9861; val_edge_recon_loss: 257638.3082; val_gene_expr_recon_loss: 11025.5549; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274321.8466; val_optim_loss: 274321.8466
heaps
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9862; val_auprc_score: 0.9787; val_best_acc_score: 0.9635; val_best_f1_score: 0.9644; train_kl_reg_loss: 5775.9524; train_edge_recon_loss: 256812.1978; train_gene_expr_recon_loss: 10981.6082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273569.7596; train_optim_loss: 273569.7596; val_kl_reg_loss: 5830.0079; val_edge_recon_loss: 257362.3111; val_gene_expr_recon_loss: 10974.3002; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274166.6193; val_optim_loss: 274166.6193
heaps
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9855; val_auprc_score: 0.9773; val_best_acc_score: 0.9628; val_best_f1_score: 0.9636; train_kl_reg_loss: 5770.0442; train_edge_recon_loss: 256907.7393; train_gene_expr_recon_loss: 10933.1389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273610.9224; train_optim_loss: 273610.9224; val_kl_reg_loss: 5644.7324; val_edge_recon_loss: 257689.7060; val_gene_expr_recon_loss: 10945.1299; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274279.5710; val_optim_loss: 274279.5710
heaps
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9851; val_auprc_score: 0.9769; val_best_acc_score: 0.9636; val_best_f1_score: 0.9645; train_kl_reg_loss: 5779.2888; train_edge_recon_loss: 256859.9801; train_gene_expr_recon_loss: 10900.0801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273539.3496; train_optim_loss: 273539.3496; val_kl_reg_loss: 5505.8386; val_edge_recon_loss: 257802.8771; val_gene_expr_recon_loss: 10860.2452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274168.9616; val_optim_loss: 274168.9616
heaps
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9860; val_auprc_score: 0.9777; val_best_acc_score: 0.9646; val_best_f1_score: 0.9653; train_kl_reg_loss: 5778.2444; train_edge_recon_loss: 256604.9906; train_gene_expr_recon_loss: 10861.5644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273244.7979; train_optim_loss: 273244.7979; val_kl_reg_loss: 5611.0021; val_edge_recon_loss: 257537.7571; val_gene_expr_recon_loss: 10863.0266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274011.7884; val_optim_loss: 274011.7884
heaps
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9873; val_auprc_score: 0.9804; val_best_acc_score: 0.9668; val_best_f1_score: 0.9674; train_kl_reg_loss: 5762.5107; train_edge_recon_loss: 256786.1623; train_gene_expr_recon_loss: 10825.0588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273373.7331; train_optim_loss: 273373.7331; val_kl_reg_loss: 5613.9759; val_edge_recon_loss: 257398.3111; val_gene_expr_recon_loss: 10796.6674; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273808.9574; val_optim_loss: 273808.9574
heaps
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9873; val_auprc_score: 0.9805; val_best_acc_score: 0.9666; val_best_f1_score: 0.9672; train_kl_reg_loss: 5777.3505; train_edge_recon_loss: 256658.7708; train_gene_expr_recon_loss: 10782.9777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273219.0988; train_optim_loss: 273219.0988; val_kl_reg_loss: 5619.4709; val_edge_recon_loss: 257166.3906; val_gene_expr_recon_loss: 10791.0649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273576.9276; val_optim_loss: 273576.9276
heaps
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9872; val_auprc_score: 0.9801; val_best_acc_score: 0.9657; val_best_f1_score: 0.9663; train_kl_reg_loss: 5778.2504; train_edge_recon_loss: 256509.0927; train_gene_expr_recon_loss: 10749.9755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273037.3179; train_optim_loss: 273037.3179; val_kl_reg_loss: 5645.8223; val_edge_recon_loss: 257541.5824; val_gene_expr_recon_loss: 10787.6759; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273975.0824; val_optim_loss: 273975.0824
heaps
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9874; val_auprc_score: 0.9809; val_best_acc_score: 0.9657; val_best_f1_score: 0.9663; train_kl_reg_loss: 5779.6265; train_edge_recon_loss: 256536.4153; train_gene_expr_recon_loss: 10714.9539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273030.9963; train_optim_loss: 273030.9963; val_kl_reg_loss: 5609.5876; val_edge_recon_loss: 257461.9162; val_gene_expr_recon_loss: 10709.6909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273781.1960; val_optim_loss: 273781.1960
heaps
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9877; val_auprc_score: 0.9813; val_best_acc_score: 0.9666; val_best_f1_score: 0.9673; train_kl_reg_loss: 5775.9074; train_edge_recon_loss: 256577.0215; train_gene_expr_recon_loss: 10686.5156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273039.4451; train_optim_loss: 273039.4451; val_kl_reg_loss: 5677.3988; val_edge_recon_loss: 256994.6186; val_gene_expr_recon_loss: 10682.5496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273354.5639; val_optim_loss: 273354.5639
heaps
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9876; val_auprc_score: 0.9798; val_best_acc_score: 0.9667; val_best_f1_score: 0.9673; train_kl_reg_loss: 5782.3263; train_edge_recon_loss: 256406.8339; train_gene_expr_recon_loss: 10659.1366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272848.2965; train_optim_loss: 272848.2965; val_kl_reg_loss: 5640.6871; val_edge_recon_loss: 257246.1697; val_gene_expr_recon_loss: 10665.1579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273552.0142; val_optim_loss: 273552.0142
heaps
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9879; val_auprc_score: 0.9809; val_best_acc_score: 0.9681; val_best_f1_score: 0.9686; train_kl_reg_loss: 5778.2049; train_edge_recon_loss: 256440.6690; train_gene_expr_recon_loss: 10628.5198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272847.3940; train_optim_loss: 272847.3940; val_kl_reg_loss: 5666.0286; val_edge_recon_loss: 257180.6442; val_gene_expr_recon_loss: 10640.3441; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273487.0128; val_optim_loss: 273487.0128
heaps
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9887; val_auprc_score: 0.9817; val_best_acc_score: 0.9687; val_best_f1_score: 0.9692; train_kl_reg_loss: 5774.4612; train_edge_recon_loss: 256464.9795; train_gene_expr_recon_loss: 10596.5010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272835.9424; train_optim_loss: 272835.9424; val_kl_reg_loss: 5605.7960; val_edge_recon_loss: 256742.2081; val_gene_expr_recon_loss: 10626.9452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272974.9517; val_optim_loss: 272974.9517
heaps
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9890; val_auprc_score: 0.9835; val_best_acc_score: 0.9700; val_best_f1_score: 0.9705; train_kl_reg_loss: 5775.8202; train_edge_recon_loss: 256387.5916; train_gene_expr_recon_loss: 10567.0981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272730.5104; train_optim_loss: 272730.5104; val_kl_reg_loss: 5730.2540; val_edge_recon_loss: 256654.6527; val_gene_expr_recon_loss: 10579.6665; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272964.5739; val_optim_loss: 272964.5739
heaps
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9883; val_auprc_score: 0.9825; val_best_acc_score: 0.9686; val_best_f1_score: 0.9692; train_kl_reg_loss: 5782.6963; train_edge_recon_loss: 256286.2266; train_gene_expr_recon_loss: 10546.2698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272615.1921; train_optim_loss: 272615.1921; val_kl_reg_loss: 5670.2262; val_edge_recon_loss: 257024.3807; val_gene_expr_recon_loss: 10583.1936; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273277.8011; val_optim_loss: 273277.8011
heaps
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9886; val_auprc_score: 0.9826; val_best_acc_score: 0.9684; val_best_f1_score: 0.9690; train_kl_reg_loss: 5779.9608; train_edge_recon_loss: 256379.6076; train_gene_expr_recon_loss: 10522.6574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272682.2240; train_optim_loss: 272682.2240; val_kl_reg_loss: 5658.0509; val_edge_recon_loss: 256923.1257; val_gene_expr_recon_loss: 10545.7646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273126.9432; val_optim_loss: 273126.9432
heaps
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9888; val_auprc_score: 0.9828; val_best_acc_score: 0.9686; val_best_f1_score: 0.9691; train_kl_reg_loss: 5777.5033; train_edge_recon_loss: 256258.7878; train_gene_expr_recon_loss: 10508.2125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272544.5044; train_optim_loss: 272544.5044; val_kl_reg_loss: 5656.4196; val_edge_recon_loss: 257134.1584; val_gene_expr_recon_loss: 10537.7301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273328.3068; val_optim_loss: 273328.3068
heaps
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9897; val_auprc_score: 0.9843; val_best_acc_score: 0.9706; val_best_f1_score: 0.9711; train_kl_reg_loss: 5779.2445; train_edge_recon_loss: 256240.4626; train_gene_expr_recon_loss: 10485.1296; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272504.8366; train_optim_loss: 272504.8366; val_kl_reg_loss: 5706.0426; val_edge_recon_loss: 256605.7365; val_gene_expr_recon_loss: 10482.5510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272794.3310; val_optim_loss: 272794.3310
heaps
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9896; val_auprc_score: 0.9840; val_best_acc_score: 0.9700; val_best_f1_score: 0.9704; train_kl_reg_loss: 5773.5607; train_edge_recon_loss: 256172.2016; train_gene_expr_recon_loss: 10469.6890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272415.4505; train_optim_loss: 272415.4505; val_kl_reg_loss: 5741.3327; val_edge_recon_loss: 256790.0597; val_gene_expr_recon_loss: 10462.2356; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272993.6264; val_optim_loss: 272993.6264
heaps
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9903; val_auprc_score: 0.9850; val_best_acc_score: 0.9709; val_best_f1_score: 0.9715; train_kl_reg_loss: 5780.8366; train_edge_recon_loss: 256210.2113; train_gene_expr_recon_loss: 10447.0544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272438.1030; train_optim_loss: 272438.1030; val_kl_reg_loss: 5594.6643; val_edge_recon_loss: 256511.5071; val_gene_expr_recon_loss: 10477.6278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272583.8011; val_optim_loss: 272583.8011
heaps
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9903; val_auprc_score: 0.9851; val_best_acc_score: 0.9710; val_best_f1_score: 0.9715; train_kl_reg_loss: 5774.3815; train_edge_recon_loss: 256175.7198; train_gene_expr_recon_loss: 10430.0096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272380.1095; train_optim_loss: 272380.1095; val_kl_reg_loss: 5739.2877; val_edge_recon_loss: 256387.3317; val_gene_expr_recon_loss: 10431.3133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272557.9361; val_optim_loss: 272557.9361
heaps
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9907; val_auprc_score: 0.9864; val_best_acc_score: 0.9713; val_best_f1_score: 0.9718; train_kl_reg_loss: 5773.9370; train_edge_recon_loss: 256094.9843; train_gene_expr_recon_loss: 10410.5562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272279.4782; train_optim_loss: 272279.4782; val_kl_reg_loss: 5781.9598; val_edge_recon_loss: 256449.1328; val_gene_expr_recon_loss: 10435.6783; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272666.7670; val_optim_loss: 272666.7670
heaps
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9899; val_auprc_score: 0.9842; val_best_acc_score: 0.9701; val_best_f1_score: 0.9706; train_kl_reg_loss: 5773.6452; train_edge_recon_loss: 256091.4174; train_gene_expr_recon_loss: 10390.9010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272255.9645; train_optim_loss: 272255.9645; val_kl_reg_loss: 5662.5594; val_edge_recon_loss: 256788.2053; val_gene_expr_recon_loss: 10436.9582; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272887.7230; val_optim_loss: 272887.7230
heaps
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9900; val_auprc_score: 0.9851; val_best_acc_score: 0.9709; val_best_f1_score: 0.9714; train_kl_reg_loss: 5768.5532; train_edge_recon_loss: 256197.5492; train_gene_expr_recon_loss: 10383.5043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272349.6061; train_optim_loss: 272349.6061; val_kl_reg_loss: 5733.6158; val_edge_recon_loss: 256550.9176; val_gene_expr_recon_loss: 10386.9368; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272671.4702; val_optim_loss: 272671.4702
heaps
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9900; val_auprc_score: 0.9847; val_best_acc_score: 0.9718; val_best_f1_score: 0.9722; train_kl_reg_loss: 5774.0915; train_edge_recon_loss: 256148.8916; train_gene_expr_recon_loss: 10365.8956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272288.8792; train_optim_loss: 272288.8792; val_kl_reg_loss: 5602.2478; val_edge_recon_loss: 256520.9822; val_gene_expr_recon_loss: 10377.7444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272500.9744; val_optim_loss: 272500.9744
heaps
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9910; val_auprc_score: 0.9862; val_best_acc_score: 0.9723; val_best_f1_score: 0.9727; train_kl_reg_loss: 5779.1827; train_edge_recon_loss: 255947.6118; train_gene_expr_recon_loss: 10343.4036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272070.1969; train_optim_loss: 272070.1969; val_kl_reg_loss: 5715.5935; val_edge_recon_loss: 256355.5199; val_gene_expr_recon_loss: 10393.3103; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272464.4219; val_optim_loss: 272464.4219
heaps
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9914; val_auprc_score: 0.9871; val_best_acc_score: 0.9721; val_best_f1_score: 0.9725; train_kl_reg_loss: 5771.0644; train_edge_recon_loss: 256083.8955; train_gene_expr_recon_loss: 10342.9517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272197.9113; train_optim_loss: 272197.9113; val_kl_reg_loss: 5692.3179; val_edge_recon_loss: 256108.3125; val_gene_expr_recon_loss: 10365.2576; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272165.8892; val_optim_loss: 272165.8892
heaps
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9913; val_auprc_score: 0.9867; val_best_acc_score: 0.9735; val_best_f1_score: 0.9740; train_kl_reg_loss: 5778.5782; train_edge_recon_loss: 255980.0885; train_gene_expr_recon_loss: 10313.9868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272072.6532; train_optim_loss: 272072.6532; val_kl_reg_loss: 5747.0528; val_edge_recon_loss: 255864.8906; val_gene_expr_recon_loss: 10331.5373; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271943.4815; val_optim_loss: 271943.4815
heaps
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9913; val_auprc_score: 0.9873; val_best_acc_score: 0.9723; val_best_f1_score: 0.9727; train_kl_reg_loss: 5771.2743; train_edge_recon_loss: 256114.2944; train_gene_expr_recon_loss: 10313.9831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272199.5529; train_optim_loss: 272199.5529; val_kl_reg_loss: 5696.1513; val_edge_recon_loss: 256223.2919; val_gene_expr_recon_loss: 10326.6076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272246.0497; val_optim_loss: 272246.0497
heaps
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9913; val_auprc_score: 0.9865; val_best_acc_score: 0.9736; val_best_f1_score: 0.9740; train_kl_reg_loss: 5770.4941; train_edge_recon_loss: 255910.1720; train_gene_expr_recon_loss: 10287.7187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271968.3857; train_optim_loss: 271968.3857; val_kl_reg_loss: 5748.9834; val_edge_recon_loss: 256253.0923; val_gene_expr_recon_loss: 10323.9354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272326.0128; val_optim_loss: 272326.0128
heaps
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9912; val_auprc_score: 0.9867; val_best_acc_score: 0.9723; val_best_f1_score: 0.9726; train_kl_reg_loss: 5775.5015; train_edge_recon_loss: 255952.8502; train_gene_expr_recon_loss: 10275.7545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272004.1069; train_optim_loss: 272004.1069; val_kl_reg_loss: 5791.5414; val_edge_recon_loss: 256480.5327; val_gene_expr_recon_loss: 10292.0404; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272564.1136; val_optim_loss: 272564.1136
heaps
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9909; val_auprc_score: 0.9866; val_best_acc_score: 0.9712; val_best_f1_score: 0.9716; train_kl_reg_loss: 5769.9082; train_edge_recon_loss: 256001.4394; train_gene_expr_recon_loss: 10270.6435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272041.9910; train_optim_loss: 272041.9910; val_kl_reg_loss: 5571.6371; val_edge_recon_loss: 256522.3196; val_gene_expr_recon_loss: 10303.4273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272397.3807; val_optim_loss: 272397.3807

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

heaps
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9913; val_auprc_score: 0.9864; val_best_acc_score: 0.9729; val_best_f1_score: 0.9733; train_kl_reg_loss: 5756.6813; train_edge_recon_loss: 255860.1554; train_gene_expr_recon_loss: 10250.4035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271867.2417; train_optim_loss: 271867.2417; val_kl_reg_loss: 5667.5979; val_edge_recon_loss: 256152.6278; val_gene_expr_recon_loss: 10271.1925; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272091.4190; val_optim_loss: 272091.4190
heaps
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9907; val_auprc_score: 0.9860; val_best_acc_score: 0.9721; val_best_f1_score: 0.9725; train_kl_reg_loss: 5754.8569; train_edge_recon_loss: 255814.9425; train_gene_expr_recon_loss: 10236.9565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271806.7554; train_optim_loss: 271806.7554; val_kl_reg_loss: 5664.5466; val_edge_recon_loss: 256488.0994; val_gene_expr_recon_loss: 10294.3477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272446.9957; val_optim_loss: 272446.9957
heaps
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9911; val_auprc_score: 0.9863; val_best_acc_score: 0.9731; val_best_f1_score: 0.9735; train_kl_reg_loss: 5755.1921; train_edge_recon_loss: 255659.5111; train_gene_expr_recon_loss: 10231.9348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271646.6390; train_optim_loss: 271646.6390; val_kl_reg_loss: 5671.4855; val_edge_recon_loss: 256197.0824; val_gene_expr_recon_loss: 10252.5427; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272121.1122; val_optim_loss: 272121.1122
heaps
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9918; val_auprc_score: 0.9881; val_best_acc_score: 0.9726; val_best_f1_score: 0.9729; train_kl_reg_loss: 5753.4657; train_edge_recon_loss: 255636.5285; train_gene_expr_recon_loss: 10226.8500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271616.8429; train_optim_loss: 271616.8429; val_kl_reg_loss: 5683.5721; val_edge_recon_loss: 256444.2088; val_gene_expr_recon_loss: 10275.1041; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272402.8849; val_optim_loss: 272402.8849

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 47 min 42 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
Val AUROC score: 0.9905
Val AUPRC score: 0.9856
Val best accuracy score: 0.9711
Val best F1 score: 0.9716
Val gene expr MSE score: 0.6705

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
