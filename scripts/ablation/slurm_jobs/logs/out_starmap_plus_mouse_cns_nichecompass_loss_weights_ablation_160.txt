None
Run timestamp: 15072023_114005_160.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_160']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9819; val_auprc_score: 0.9753; val_best_acc_score: 0.9447; val_best_f1_score: 0.9463; train_kl_reg_loss: 97699.3408; train_edge_recon_loss: 26835395.6412; train_gene_expr_recon_loss: 11665875.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38598970.2364; train_optim_loss: 38598970.2364; val_kl_reg_loss: 112598.5432; val_edge_recon_loss: 26119236.6250; val_gene_expr_recon_loss: 10734958.7375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36966794.0000; val_optim_loss: 36966794.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9852; val_auprc_score: 0.9805; val_best_acc_score: 0.9499; val_best_f1_score: 0.9513; train_kl_reg_loss: 108379.0908; train_edge_recon_loss: 26008510.8011; train_gene_expr_recon_loss: 10471550.3950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36588440.3616; train_optim_loss: 36588440.3616; val_kl_reg_loss: 98548.6507; val_edge_recon_loss: 25983871.8250; val_gene_expr_recon_loss: 10308065.9000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36390486.4000; val_optim_loss: 36390486.4000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9878; val_auprc_score: 0.9843; val_best_acc_score: 0.9573; val_best_f1_score: 0.9582; train_kl_reg_loss: 91965.3741; train_edge_recon_loss: 25905056.2698; train_gene_expr_recon_loss: 10166713.8164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36163735.4437; train_optim_loss: 36163735.4437; val_kl_reg_loss: 86164.1123; val_edge_recon_loss: 25877849.4000; val_gene_expr_recon_loss: 10098199.5750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36062213.1500; val_optim_loss: 36062213.1500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9889; val_auprc_score: 0.9854; val_best_acc_score: 0.9606; val_best_f1_score: 0.9616; train_kl_reg_loss: 84379.7099; train_edge_recon_loss: 25789608.9736; train_gene_expr_recon_loss: 10004740.9305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35878729.6300; train_optim_loss: 35878729.6300; val_kl_reg_loss: 82126.9171; val_edge_recon_loss: 25794164.7000; val_gene_expr_recon_loss: 9973274.1500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35849565.6500; val_optim_loss: 35849565.6500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9902; val_auprc_score: 0.9872; val_best_acc_score: 0.9639; val_best_f1_score: 0.9647; train_kl_reg_loss: 78193.0180; train_edge_recon_loss: 25755019.4159; train_gene_expr_recon_loss: 9901884.1669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35735096.5786; train_optim_loss: 35735096.5786; val_kl_reg_loss: 73501.3569; val_edge_recon_loss: 25764519.4250; val_gene_expr_recon_loss: 9881997.3375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35720018.3500; val_optim_loss: 35720018.3500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9906; val_auprc_score: 0.9876; val_best_acc_score: 0.9653; val_best_f1_score: 0.9659; train_kl_reg_loss: 71795.9798; train_edge_recon_loss: 25718106.7483; train_gene_expr_recon_loss: 9829052.6161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35618955.3992; train_optim_loss: 35618955.3992; val_kl_reg_loss: 69833.4405; val_edge_recon_loss: 25729206.1000; val_gene_expr_recon_loss: 9849515.1000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35648554.6500; val_optim_loss: 35648554.6500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9917; val_auprc_score: 0.9889; val_best_acc_score: 0.9685; val_best_f1_score: 0.9690; train_kl_reg_loss: 67365.5125; train_edge_recon_loss: 25679624.2448; train_gene_expr_recon_loss: 9777665.5313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35524655.2935; train_optim_loss: 35524655.2935; val_kl_reg_loss: 65185.8089; val_edge_recon_loss: 25683137.2500; val_gene_expr_recon_loss: 9798163.4750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35546486.7500; val_optim_loss: 35546486.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9931; val_auprc_score: 0.9911; val_best_acc_score: 0.9724; val_best_f1_score: 0.9728; train_kl_reg_loss: 63634.9975; train_edge_recon_loss: 25653029.2935; train_gene_expr_recon_loss: 9737154.6885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35453818.9652; train_optim_loss: 35453818.9652; val_kl_reg_loss: 61244.8463; val_edge_recon_loss: 25647206.0750; val_gene_expr_recon_loss: 9807805.7000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35516256.5500; val_optim_loss: 35516256.5500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9930; val_auprc_score: 0.9904; val_best_acc_score: 0.9727; val_best_f1_score: 0.9731; train_kl_reg_loss: 60347.0478; train_edge_recon_loss: 25638169.9026; train_gene_expr_recon_loss: 9704670.1307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35403186.9930; train_optim_loss: 35403186.9930; val_kl_reg_loss: 58091.0603; val_edge_recon_loss: 25642670.3500; val_gene_expr_recon_loss: 9776783.4750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35477544.7500; val_optim_loss: 35477544.7500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9923; val_auprc_score: 0.9891; val_best_acc_score: 0.9724; val_best_f1_score: 0.9730; train_kl_reg_loss: 58028.8555; train_edge_recon_loss: 25609015.8999; train_gene_expr_recon_loss: 9674703.5104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35341748.1947; train_optim_loss: 35341748.1947; val_kl_reg_loss: 56982.1958; val_edge_recon_loss: 25646753.9000; val_gene_expr_recon_loss: 9750723.4500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35454459.7500; val_optim_loss: 35454459.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9935; val_auprc_score: 0.9913; val_best_acc_score: 0.9748; val_best_f1_score: 0.9752; train_kl_reg_loss: 55545.1998; train_edge_recon_loss: 25607790.9124; train_gene_expr_recon_loss: 9651818.9805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35315155.0598; train_optim_loss: 35315155.0598; val_kl_reg_loss: 54424.7921; val_edge_recon_loss: 25630175.5750; val_gene_expr_recon_loss: 9733433.0375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35418033.3500; val_optim_loss: 35418033.3500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9940; val_auprc_score: 0.9920; val_best_acc_score: 0.9758; val_best_f1_score: 0.9762; train_kl_reg_loss: 54200.6628; train_edge_recon_loss: 25591006.0612; train_gene_expr_recon_loss: 9632186.4604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35277393.1850; train_optim_loss: 35277393.1850; val_kl_reg_loss: 52377.1785; val_edge_recon_loss: 25608927.6750; val_gene_expr_recon_loss: 9739636.7625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35400941.5500; val_optim_loss: 35400941.5500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9944; val_auprc_score: 0.9926; val_best_acc_score: 0.9768; val_best_f1_score: 0.9771; train_kl_reg_loss: 52822.9682; train_edge_recon_loss: 25562635.5216; train_gene_expr_recon_loss: 9612319.9221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35227778.4145; train_optim_loss: 35227778.4145; val_kl_reg_loss: 50841.6957; val_edge_recon_loss: 25598677.9500; val_gene_expr_recon_loss: 9729848.7125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35379368.3000; val_optim_loss: 35379368.3000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9946; val_auprc_score: 0.9929; val_best_acc_score: 0.9769; val_best_f1_score: 0.9772; train_kl_reg_loss: 51387.1616; train_edge_recon_loss: 25561581.1043; train_gene_expr_recon_loss: 9569230.2378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35182198.5369; train_optim_loss: 35182198.5369; val_kl_reg_loss: 50805.5122; val_edge_recon_loss: 25620680.2000; val_gene_expr_recon_loss: 9763699.0125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35435184.5500; val_optim_loss: 35435184.5500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9949; val_auprc_score: 0.9932; val_best_acc_score: 0.9787; val_best_f1_score: 0.9790; train_kl_reg_loss: 50050.2015; train_edge_recon_loss: 25561583.8081; train_gene_expr_recon_loss: 9557761.2698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35169395.1822; train_optim_loss: 35169395.1822; val_kl_reg_loss: 50255.4721; val_edge_recon_loss: 25579099.1250; val_gene_expr_recon_loss: 9722076.5125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35351431.5500; val_optim_loss: 35351431.5500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9950; val_auprc_score: 0.9936; val_best_acc_score: 0.9790; val_best_f1_score: 0.9792; train_kl_reg_loss: 49194.9927; train_edge_recon_loss: 25557830.3505; train_gene_expr_recon_loss: 9547081.2420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35154106.5814; train_optim_loss: 35154106.5814; val_kl_reg_loss: 48614.6546; val_edge_recon_loss: 25589288.1000; val_gene_expr_recon_loss: 9703011.6375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35340914.4000; val_optim_loss: 35340914.4000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9952; val_auprc_score: 0.9937; val_best_acc_score: 0.9787; val_best_f1_score: 0.9790; train_kl_reg_loss: 48396.3082; train_edge_recon_loss: 25544430.6064; train_gene_expr_recon_loss: 9512583.8248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35105410.7483; train_optim_loss: 35105410.7483; val_kl_reg_loss: 47888.1533; val_edge_recon_loss: 25617105.3750; val_gene_expr_recon_loss: 9726904.1500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35391897.4500; val_optim_loss: 35391897.4500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9955; val_auprc_score: 0.9937; val_best_acc_score: 0.9801; val_best_f1_score: 0.9804; train_kl_reg_loss: 47534.9876; train_edge_recon_loss: 25536189.8414; train_gene_expr_recon_loss: 9498477.5424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35082202.3588; train_optim_loss: 35082202.3588; val_kl_reg_loss: 47567.1162; val_edge_recon_loss: 25573196.2000; val_gene_expr_recon_loss: 9731265.1375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35352028.4500; val_optim_loss: 35352028.4500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9954; val_auprc_score: 0.9938; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 47112.2528; train_edge_recon_loss: 25537000.5118; train_gene_expr_recon_loss: 9486563.9402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35070676.7065; train_optim_loss: 35070676.7065; val_kl_reg_loss: 47048.7867; val_edge_recon_loss: 25548709.1000; val_gene_expr_recon_loss: 9746989.2250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35342747.1500; val_optim_loss: 35342747.1500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9954; val_auprc_score: 0.9938; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 46625.8168; train_edge_recon_loss: 25531167.7552; train_gene_expr_recon_loss: 9479499.6857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35057293.2462; train_optim_loss: 35057293.2462; val_kl_reg_loss: 45467.9568; val_edge_recon_loss: 25567254.6750; val_gene_expr_recon_loss: 9732773.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35345495.6500; val_optim_loss: 35345495.6500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9957; val_auprc_score: 0.9940; val_best_acc_score: 0.9806; val_best_f1_score: 0.9809; train_kl_reg_loss: 49180.8084; train_edge_recon_loss: 25515856.4896; train_gene_expr_recon_loss: 9380903.6620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34945940.9346; train_optim_loss: 34945940.9346; val_kl_reg_loss: 50291.1718; val_edge_recon_loss: 25538873.4250; val_gene_expr_recon_loss: 9680922.5875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35270087.1000; val_optim_loss: 35270087.1000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9957; val_auprc_score: 0.9944; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 51221.9328; train_edge_recon_loss: 25514023.6857; train_gene_expr_recon_loss: 9388929.1196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34954174.7650; train_optim_loss: 34954174.7650; val_kl_reg_loss: 50707.7807; val_edge_recon_loss: 25541839.5500; val_gene_expr_recon_loss: 9680988.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35273535.6000; val_optim_loss: 35273535.6000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9958; val_auprc_score: 0.9944; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 51604.5518; train_edge_recon_loss: 25514094.6565; train_gene_expr_recon_loss: 9368480.3915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34934179.6161; train_optim_loss: 34934179.6161; val_kl_reg_loss: 51209.2146; val_edge_recon_loss: 25536123.3000; val_gene_expr_recon_loss: 9691429.2625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35278761.7500; val_optim_loss: 35278761.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9957; val_auprc_score: 0.9942; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 52160.8488; train_edge_recon_loss: 25510166.9013; train_gene_expr_recon_loss: 9373791.9416; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34936119.6161; train_optim_loss: 34936119.6161; val_kl_reg_loss: 51583.3832; val_edge_recon_loss: 25546703.2750; val_gene_expr_recon_loss: 9682733.1500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35281019.8500; val_optim_loss: 35281019.8500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9959; val_auprc_score: 0.9946; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 52460.1715; train_edge_recon_loss: 25503605.5076; train_gene_expr_recon_loss: 9360366.9972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34916432.6620; train_optim_loss: 34916432.6620; val_kl_reg_loss: 51713.1763; val_edge_recon_loss: 25527543.6750; val_gene_expr_recon_loss: 9697832.3875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35277089.2000; val_optim_loss: 35277089.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9957; val_auprc_score: 0.9943; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 52513.2970; train_edge_recon_loss: 25502615.2462; train_gene_expr_recon_loss: 9361670.4757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34916798.9708; train_optim_loss: 34916798.9708; val_kl_reg_loss: 51956.0993; val_edge_recon_loss: 25540240.5750; val_gene_expr_recon_loss: 9699590.9250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35291787.7000; val_optim_loss: 35291787.7000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9957; val_auprc_score: 0.9942; val_best_acc_score: 0.9807; val_best_f1_score: 0.9810; train_kl_reg_loss: 52666.4127; train_edge_recon_loss: 25509781.7357; train_gene_expr_recon_loss: 9356995.7705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34919443.8554; train_optim_loss: 34919443.8554; val_kl_reg_loss: 52138.4866; val_edge_recon_loss: 25546379.2500; val_gene_expr_recon_loss: 9719699.5500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35318217.3500; val_optim_loss: 35318217.3500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9957; val_auprc_score: 0.9941; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 52689.2269; train_edge_recon_loss: 25515536.8901; train_gene_expr_recon_loss: 9355458.5709; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34923684.6509; train_optim_loss: 34923684.6509; val_kl_reg_loss: 52024.9688; val_edge_recon_loss: 25553705.1250; val_gene_expr_recon_loss: 9694759.5500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35300489.6500; val_optim_loss: 35300489.6500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9958; val_auprc_score: 0.9943; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 52694.2297; train_edge_recon_loss: 25499619.4743; train_gene_expr_recon_loss: 9354741.0967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34907054.8484; train_optim_loss: 34907054.8484; val_kl_reg_loss: 52085.6692; val_edge_recon_loss: 25530801.0500; val_gene_expr_recon_loss: 9719336.3000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35302222.8500; val_optim_loss: 35302222.8500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 260 min 31 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9958
Val AUPRC score: 0.9943
Val best accuracy score: 0.9811
Val best F1 score: 0.9813
Val gene expr MSE score: 0.6294

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
