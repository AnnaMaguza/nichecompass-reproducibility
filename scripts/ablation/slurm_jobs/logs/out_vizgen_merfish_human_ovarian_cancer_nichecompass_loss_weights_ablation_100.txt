None
Run timestamp: 18072023_073134_100.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_100']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1931624
Number of validation edges: 214624
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9921; val_auprc_score: 0.9914; val_best_acc_score: 0.9564; val_best_f1_score: 0.9566; train_kl_reg_loss: 17389.0868; train_edge_recon_loss: 26273909.9920; train_gene_expr_recon_loss: 1592529.9358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27883829.0125; train_optim_loss: 27883829.0125; val_kl_reg_loss: 18605.9613; val_edge_recon_loss: 26097020.6048; val_gene_expr_recon_loss: 1452637.9435; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27568264.5000; val_optim_loss: 27568264.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9942; val_auprc_score: 0.9935; val_best_acc_score: 0.9657; val_best_f1_score: 0.9660; train_kl_reg_loss: 19216.6996; train_edge_recon_loss: 25916607.7567; train_gene_expr_recon_loss: 1406476.4372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27342300.8874; train_optim_loss: 27342300.8874; val_kl_reg_loss: 19213.7684; val_edge_recon_loss: 25945622.9571; val_gene_expr_recon_loss: 1378985.0717; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27343821.8476; val_optim_loss: 27343821.8476
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9959; val_auprc_score: 0.9952; val_best_acc_score: 0.9720; val_best_f1_score: 0.9722; train_kl_reg_loss: 19031.1064; train_edge_recon_loss: 25828751.9931; train_gene_expr_recon_loss: 1369839.1283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27217622.2237; train_optim_loss: 27217622.2237; val_kl_reg_loss: 17875.6064; val_edge_recon_loss: 25879000.3524; val_gene_expr_recon_loss: 1359833.2193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27256709.1905; val_optim_loss: 27256709.1905
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9965; val_auprc_score: 0.9959; val_best_acc_score: 0.9742; val_best_f1_score: 0.9744; train_kl_reg_loss: 18646.3025; train_edge_recon_loss: 25781042.7570; train_gene_expr_recon_loss: 1353615.1570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27153304.2364; train_optim_loss: 27153304.2364; val_kl_reg_loss: 18079.0984; val_edge_recon_loss: 25835259.6190; val_gene_expr_recon_loss: 1349026.8164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27202365.4952; val_optim_loss: 27202365.4952
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9969; val_auprc_score: 0.9964; val_best_acc_score: 0.9760; val_best_f1_score: 0.9761; train_kl_reg_loss: 18045.2913; train_edge_recon_loss: 25755635.3120; train_gene_expr_recon_loss: 1346247.8105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27119928.4177; train_optim_loss: 27119928.4177; val_kl_reg_loss: 17731.3614; val_edge_recon_loss: 25802898.9095; val_gene_expr_recon_loss: 1341458.3107; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27162088.5714; val_optim_loss: 27162088.5714
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9970; val_auprc_score: 0.9965; val_best_acc_score: 0.9773; val_best_f1_score: 0.9774; train_kl_reg_loss: 17737.8792; train_edge_recon_loss: 25719453.9173; train_gene_expr_recon_loss: 1340745.2128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27077937.0135; train_optim_loss: 27077937.0135; val_kl_reg_loss: 17415.1598; val_edge_recon_loss: 25815788.8048; val_gene_expr_recon_loss: 1348411.5301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27181615.5286; val_optim_loss: 27181615.5286
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9973; val_auprc_score: 0.9967; val_best_acc_score: 0.9791; val_best_f1_score: 0.9792; train_kl_reg_loss: 17366.8668; train_edge_recon_loss: 25704888.9981; train_gene_expr_recon_loss: 1344885.9364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27067141.8086; train_optim_loss: 27067141.8086; val_kl_reg_loss: 17563.8031; val_edge_recon_loss: 25754120.3762; val_gene_expr_recon_loss: 1179219.8074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26950904.0714; val_optim_loss: 26950904.0714
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9976; val_auprc_score: 0.9972; val_best_acc_score: 0.9804; val_best_f1_score: 0.9804; train_kl_reg_loss: 17071.2245; train_edge_recon_loss: 25680942.9282; train_gene_expr_recon_loss: 1344650.2278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27042664.3795; train_optim_loss: 27042664.3795; val_kl_reg_loss: 17164.8554; val_edge_recon_loss: 25740943.6524; val_gene_expr_recon_loss: 1577223.9125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27335332.4381; val_optim_loss: 27335332.4381
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9814; val_best_f1_score: 0.9815; train_kl_reg_loss: 16816.1780; train_edge_recon_loss: 25672004.7135; train_gene_expr_recon_loss: 1250790.2665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26939611.1768; train_optim_loss: 26939611.1768; val_kl_reg_loss: 16806.9673; val_edge_recon_loss: 25721879.9619; val_gene_expr_recon_loss: 1049019.8443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26787706.7619; val_optim_loss: 26787706.7619
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9823; val_best_f1_score: 0.9823; train_kl_reg_loss: 16493.3185; train_edge_recon_loss: 25653439.4477; train_gene_expr_recon_loss: 1150066.0486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26819998.8094; train_optim_loss: 26819998.8094; val_kl_reg_loss: 16342.3442; val_edge_recon_loss: 25703803.8190; val_gene_expr_recon_loss: 1105304.1796; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26825450.2714; val_optim_loss: 26825450.2714
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9981; val_auprc_score: 0.9976; val_best_acc_score: 0.9835; val_best_f1_score: 0.9836; train_kl_reg_loss: 16273.9814; train_edge_recon_loss: 25643735.5171; train_gene_expr_recon_loss: 1126808.6635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26786818.1516; train_optim_loss: 26786818.1516; val_kl_reg_loss: 16229.7147; val_edge_recon_loss: 25718776.2143; val_gene_expr_recon_loss: 1122177.2128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26857183.1667; val_optim_loss: 26857183.1667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9980; val_auprc_score: 0.9976; val_best_acc_score: 0.9835; val_best_f1_score: 0.9836; train_kl_reg_loss: 16279.5492; train_edge_recon_loss: 25628529.5940; train_gene_expr_recon_loss: 1118470.2061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26763279.4031; train_optim_loss: 26763279.4031; val_kl_reg_loss: 16117.2653; val_edge_recon_loss: 25682158.2810; val_gene_expr_recon_loss: 1112960.7711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26811236.2762; val_optim_loss: 26811236.2762
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9982; val_auprc_score: 0.9978; val_best_acc_score: 0.9843; val_best_f1_score: 0.9844; train_kl_reg_loss: 16005.3612; train_edge_recon_loss: 25627233.1598; train_gene_expr_recon_loss: 1116275.4010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26759513.9009; train_optim_loss: 26759513.9009; val_kl_reg_loss: 15906.5088; val_edge_recon_loss: 25678925.0238; val_gene_expr_recon_loss: 1113645.6146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26808477.1524; val_optim_loss: 26808477.1524

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9855; val_best_f1_score: 0.9855; train_kl_reg_loss: 16943.5954; train_edge_recon_loss: 25588147.9237; train_gene_expr_recon_loss: 1100702.7215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26705794.2401; train_optim_loss: 26705794.2401; val_kl_reg_loss: 17073.6116; val_edge_recon_loss: 25645378.0810; val_gene_expr_recon_loss: 1100360.8621; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26762812.4333; val_optim_loss: 26762812.4333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9984; val_auprc_score: 0.9979; val_best_acc_score: 0.9857; val_best_f1_score: 0.9857; train_kl_reg_loss: 17028.2074; train_edge_recon_loss: 25580258.9870; train_gene_expr_recon_loss: 1099111.0714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26696398.2428; train_optim_loss: 26696398.2428; val_kl_reg_loss: 16806.1994; val_edge_recon_loss: 25643520.5429; val_gene_expr_recon_loss: 1100394.1878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26760720.9476; val_optim_loss: 26760720.9476
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9984; val_auprc_score: 0.9979; val_best_acc_score: 0.9858; val_best_f1_score: 0.9858; train_kl_reg_loss: 16924.8665; train_edge_recon_loss: 25577220.8577; train_gene_expr_recon_loss: 1099377.3690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26693523.0851; train_optim_loss: 26693523.0851; val_kl_reg_loss: 16831.6946; val_edge_recon_loss: 25633335.6810; val_gene_expr_recon_loss: 1098516.8616; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26748684.2476; val_optim_loss: 26748684.2476
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9860; val_best_f1_score: 0.9860; train_kl_reg_loss: 16879.9193; train_edge_recon_loss: 25578112.2285; train_gene_expr_recon_loss: 1098447.0676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26693439.2393; train_optim_loss: 26693439.2393; val_kl_reg_loss: 16682.5070; val_edge_recon_loss: 25638889.5524; val_gene_expr_recon_loss: 1098425.6814; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26753997.6714; val_optim_loss: 26753997.6714
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9984; val_auprc_score: 0.9979; val_best_acc_score: 0.9862; val_best_f1_score: 0.9862; train_kl_reg_loss: 16846.0417; train_edge_recon_loss: 25573900.6472; train_gene_expr_recon_loss: 1098296.9309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26689043.6035; train_optim_loss: 26689043.6035; val_kl_reg_loss: 16691.7878; val_edge_recon_loss: 25635287.7667; val_gene_expr_recon_loss: 1097893.6647; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26749873.1857; val_optim_loss: 26749873.1857
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9984; val_auprc_score: 0.9979; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 16852.2033; train_edge_recon_loss: 25572873.0506; train_gene_expr_recon_loss: 1098126.1634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26687851.4307; train_optim_loss: 26687851.4307; val_kl_reg_loss: 16769.3680; val_edge_recon_loss: 25640514.3381; val_gene_expr_recon_loss: 1099525.1454; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26756808.8810; val_optim_loss: 26756808.8810
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9864; val_best_f1_score: 0.9864; train_kl_reg_loss: 16773.6992; train_edge_recon_loss: 25571852.1898; train_gene_expr_recon_loss: 1097656.2989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26686282.1808; train_optim_loss: 26686282.1808; val_kl_reg_loss: 16567.3108; val_edge_recon_loss: 25631743.1524; val_gene_expr_recon_loss: 1097384.4488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26745694.9238; val_optim_loss: 26745694.9238
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9985; val_auprc_score: 0.9983; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 16725.2681; train_edge_recon_loss: 25569814.5852; train_gene_expr_recon_loss: 1097845.1318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26684384.9769; train_optim_loss: 26684384.9769; val_kl_reg_loss: 16694.6266; val_edge_recon_loss: 25641270.3381; val_gene_expr_recon_loss: 1099840.2690; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26757805.2381; val_optim_loss: 26757805.2381
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9986; val_auprc_score: 0.9982; val_best_acc_score: 0.9866; val_best_f1_score: 0.9867; train_kl_reg_loss: 16699.6027; train_edge_recon_loss: 25569491.0003; train_gene_expr_recon_loss: 1097149.2545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26683339.8521; train_optim_loss: 26683339.8521; val_kl_reg_loss: 16581.9044; val_edge_recon_loss: 25620435.4429; val_gene_expr_recon_loss: 1096084.2381; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26733101.5857; val_optim_loss: 26733101.5857
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9868; val_best_f1_score: 0.9868; train_kl_reg_loss: 16657.4953; train_edge_recon_loss: 25562870.3000; train_gene_expr_recon_loss: 1097060.6317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26676588.4214; train_optim_loss: 26676588.4214; val_kl_reg_loss: 16458.9903; val_edge_recon_loss: 25630249.2571; val_gene_expr_recon_loss: 1098612.4192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26745320.7095; val_optim_loss: 26745320.7095
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9985; val_auprc_score: 0.9980; val_best_acc_score: 0.9866; val_best_f1_score: 0.9867; train_kl_reg_loss: 16671.3366; train_edge_recon_loss: 25564263.7832; train_gene_expr_recon_loss: 1096930.4363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26677865.5712; train_optim_loss: 26677865.5712; val_kl_reg_loss: 16584.8946; val_edge_recon_loss: 25626397.0762; val_gene_expr_recon_loss: 1097647.8711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26740629.7667; val_optim_loss: 26740629.7667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9985; val_auprc_score: 0.9980; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 16664.1594; train_edge_recon_loss: 25565888.1574; train_gene_expr_recon_loss: 1097235.1978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26679787.4906; train_optim_loss: 26679787.4906; val_kl_reg_loss: 16544.6399; val_edge_recon_loss: 25622346.9095; val_gene_expr_recon_loss: 1098735.8025; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26737627.4048; val_optim_loss: 26737627.4048
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9986; val_auprc_score: 0.9983; val_best_acc_score: 0.9871; val_best_f1_score: 0.9871; train_kl_reg_loss: 16651.2347; train_edge_recon_loss: 25560441.9353; train_gene_expr_recon_loss: 1096991.7908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26674084.9701; train_optim_loss: 26674084.9701; val_kl_reg_loss: 16433.3077; val_edge_recon_loss: 25606409.8190; val_gene_expr_recon_loss: 1096628.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26719472.0571; val_optim_loss: 26719472.0571
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9986; val_auprc_score: 0.9983; val_best_acc_score: 0.9870; val_best_f1_score: 0.9870; train_kl_reg_loss: 16545.4550; train_edge_recon_loss: 25556791.4598; train_gene_expr_recon_loss: 1096240.0608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26669576.9897; train_optim_loss: 26669576.9897; val_kl_reg_loss: 16504.5658; val_edge_recon_loss: 25615145.2143; val_gene_expr_recon_loss: 1099432.7024; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26731082.5000; val_optim_loss: 26731082.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9870; val_best_f1_score: 0.9870; train_kl_reg_loss: 16564.6735; train_edge_recon_loss: 25558636.8010; train_gene_expr_recon_loss: 1096106.7890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26671308.2587; train_optim_loss: 26671308.2587; val_kl_reg_loss: 16499.6213; val_edge_recon_loss: 25627218.1571; val_gene_expr_recon_loss: 1098270.2491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26741988.1524; val_optim_loss: 26741988.1524
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9986; val_auprc_score: 0.9983; val_best_acc_score: 0.9872; val_best_f1_score: 0.9873; train_kl_reg_loss: 16502.1409; train_edge_recon_loss: 25560541.3538; train_gene_expr_recon_loss: 1095945.9676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26672989.4593; train_optim_loss: 26672989.4593; val_kl_reg_loss: 16282.7229; val_edge_recon_loss: 25613446.5524; val_gene_expr_recon_loss: 1097827.6644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26727556.9524; val_optim_loss: 26727556.9524
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9986; val_auprc_score: 0.9982; val_best_acc_score: 0.9871; val_best_f1_score: 0.9871; train_kl_reg_loss: 16454.2965; train_edge_recon_loss: 25557592.9144; train_gene_expr_recon_loss: 1095828.4187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26669875.6411; train_optim_loss: 26669875.6411; val_kl_reg_loss: 16358.0008; val_edge_recon_loss: 25618131.3762; val_gene_expr_recon_loss: 1096588.3810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26731077.8000; val_optim_loss: 26731077.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9986; val_auprc_score: 0.9983; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 16509.5666; train_edge_recon_loss: 25556701.8950; train_gene_expr_recon_loss: 1093683.0910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26666894.5767; train_optim_loss: 26666894.5767; val_kl_reg_loss: 16467.8753; val_edge_recon_loss: 25619656.3048; val_gene_expr_recon_loss: 1095871.7076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26731995.9429; val_optim_loss: 26731995.9429
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9987; val_auprc_score: 0.9984; val_best_acc_score: 0.9874; val_best_f1_score: 0.9875; train_kl_reg_loss: 16584.2317; train_edge_recon_loss: 25552747.8383; train_gene_expr_recon_loss: 1093798.9508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26663131.0278; train_optim_loss: 26663131.0278; val_kl_reg_loss: 16462.1259; val_edge_recon_loss: 25606679.0524; val_gene_expr_recon_loss: 1096224.1232; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26719365.3000; val_optim_loss: 26719365.3000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9987; val_auprc_score: 0.9984; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 16531.5985; train_edge_recon_loss: 25555548.7437; train_gene_expr_recon_loss: 1095536.7836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26667617.1476; train_optim_loss: 26667617.1476; val_kl_reg_loss: 16391.3066; val_edge_recon_loss: 25609480.2619; val_gene_expr_recon_loss: 1095779.6427; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26721651.1810; val_optim_loss: 26721651.1810
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9986; val_auprc_score: 0.9982; val_best_acc_score: 0.9874; val_best_f1_score: 0.9874; train_kl_reg_loss: 16551.6901; train_edge_recon_loss: 25556178.1776; train_gene_expr_recon_loss: 1094244.0311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26666973.8813; train_optim_loss: 26666973.8813; val_kl_reg_loss: 16432.5002; val_edge_recon_loss: 25611623.9952; val_gene_expr_recon_loss: 1098793.8167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26726850.2857; val_optim_loss: 26726850.2857
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9986; val_auprc_score: 0.9981; val_best_acc_score: 0.9871; val_best_f1_score: 0.9872; train_kl_reg_loss: 16551.6975; train_edge_recon_loss: 25548841.8701; train_gene_expr_recon_loss: 1094542.7954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26659936.3838; train_optim_loss: 26659936.3838; val_kl_reg_loss: 16434.3490; val_edge_recon_loss: 25626745.1810; val_gene_expr_recon_loss: 1097042.3597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26740221.8905; val_optim_loss: 26740221.8905
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9986; val_auprc_score: 0.9982; val_best_acc_score: 0.9874; val_best_f1_score: 0.9874; train_kl_reg_loss: 16563.0796; train_edge_recon_loss: 25549951.8823; train_gene_expr_recon_loss: 1095258.6698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26661773.6417; train_optim_loss: 26661773.6417; val_kl_reg_loss: 16454.2828; val_edge_recon_loss: 25601512.3571; val_gene_expr_recon_loss: 1096164.4149; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26714130.9857; val_optim_loss: 26714130.9857
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9986; val_auprc_score: 0.9982; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 16570.1472; train_edge_recon_loss: 25555147.8187; train_gene_expr_recon_loss: 1094730.1141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26666448.1023; train_optim_loss: 26666448.1023; val_kl_reg_loss: 16442.7413; val_edge_recon_loss: 25610674.6571; val_gene_expr_recon_loss: 1097029.1882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26724146.5476; val_optim_loss: 26724146.5476
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9986; val_auprc_score: 0.9982; val_best_acc_score: 0.9874; val_best_f1_score: 0.9875; train_kl_reg_loss: 16552.7617; train_edge_recon_loss: 25552493.5033; train_gene_expr_recon_loss: 1093903.8232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26662950.0864; train_optim_loss: 26662950.0864; val_kl_reg_loss: 16434.7819; val_edge_recon_loss: 25614348.9857; val_gene_expr_recon_loss: 1095154.7211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26725938.5095; val_optim_loss: 26725938.5095
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9986; val_auprc_score: 0.9982; val_best_acc_score: 0.9875; val_best_f1_score: 0.9875; train_kl_reg_loss: 16531.9147; train_edge_recon_loss: 25552350.6361; train_gene_expr_recon_loss: 1093223.1368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26662105.6989; train_optim_loss: 26662105.6989; val_kl_reg_loss: 16390.9968; val_edge_recon_loss: 25605505.1429; val_gene_expr_recon_loss: 1097772.6551; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26719668.7905; val_optim_loss: 26719668.7905
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9986; val_auprc_score: 0.9982; val_best_acc_score: 0.9875; val_best_f1_score: 0.9875; train_kl_reg_loss: 16500.0320; train_edge_recon_loss: 25551887.1635; train_gene_expr_recon_loss: 1094107.6423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26662494.8280; train_optim_loss: 26662494.8280; val_kl_reg_loss: 16397.9336; val_edge_recon_loss: 25616529.8476; val_gene_expr_recon_loss: 1096811.4400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26729739.2190; val_optim_loss: 26729739.2190

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9987; val_auprc_score: 0.9984; val_best_acc_score: 0.9877; val_best_f1_score: 0.9878; train_kl_reg_loss: 16524.3257; train_edge_recon_loss: 25553816.3483; train_gene_expr_recon_loss: 1093377.5940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26663718.2682; train_optim_loss: 26663718.2682; val_kl_reg_loss: 16396.9175; val_edge_recon_loss: 25594653.3714; val_gene_expr_recon_loss: 1093961.8287; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26705012.1238; val_optim_loss: 26705012.1238
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9987; val_auprc_score: 0.9984; val_best_acc_score: 0.9874; val_best_f1_score: 0.9874; train_kl_reg_loss: 16527.3214; train_edge_recon_loss: 25552717.4333; train_gene_expr_recon_loss: 1091637.8842; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26660882.6509; train_optim_loss: 26660882.6509; val_kl_reg_loss: 16400.0144; val_edge_recon_loss: 25604602.9857; val_gene_expr_recon_loss: 1091390.1918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26712393.2095; val_optim_loss: 26712393.2095
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9987; val_auprc_score: 0.9983; val_best_acc_score: 0.9874; val_best_f1_score: 0.9874; train_kl_reg_loss: 16530.9001; train_edge_recon_loss: 25548629.3528; train_gene_expr_recon_loss: 1091602.8860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26656763.1370; train_optim_loss: 26656763.1370; val_kl_reg_loss: 16414.9058; val_edge_recon_loss: 25600905.7333; val_gene_expr_recon_loss: 1092949.3805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26710270.0762; val_optim_loss: 26710270.0762
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9986; val_auprc_score: 0.9982; val_best_acc_score: 0.9871; val_best_f1_score: 0.9872; train_kl_reg_loss: 16533.6158; train_edge_recon_loss: 25552174.8455; train_gene_expr_recon_loss: 1091085.5481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26659794.0111; train_optim_loss: 26659794.0111; val_kl_reg_loss: 16408.8577; val_edge_recon_loss: 25620369.0762; val_gene_expr_recon_loss: 1093357.4015; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26730135.3000; val_optim_loss: 26730135.3000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9986; val_auprc_score: 0.9982; val_best_acc_score: 0.9872; val_best_f1_score: 0.9872; train_kl_reg_loss: 16538.6476; train_edge_recon_loss: 25551997.7445; train_gene_expr_recon_loss: 1091046.6825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26659583.0851; train_optim_loss: 26659583.0851; val_kl_reg_loss: 16417.3316; val_edge_recon_loss: 25615683.5524; val_gene_expr_recon_loss: 1093101.1457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26725202.0333; val_optim_loss: 26725202.0333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9986; val_auprc_score: 0.9981; val_best_acc_score: 0.9875; val_best_f1_score: 0.9875; train_kl_reg_loss: 16538.7748; train_edge_recon_loss: 25554040.1564; train_gene_expr_recon_loss: 1092784.7814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26663363.6941; train_optim_loss: 26663363.6941; val_kl_reg_loss: 16412.1430; val_edge_recon_loss: 25595792.5095; val_gene_expr_recon_loss: 1093969.7048; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26706174.3333; val_optim_loss: 26706174.3333
