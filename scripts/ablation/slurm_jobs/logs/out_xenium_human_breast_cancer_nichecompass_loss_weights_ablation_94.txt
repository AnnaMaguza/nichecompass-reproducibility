None
Run timestamp: 08082023_193801_94.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_94']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9432; val_auprc_score: 0.9289; val_best_acc_score: 0.8788; val_best_f1_score: 0.8856; train_kl_reg_loss: 39532.3161; train_edge_recon_loss: 2832931.1412; train_gene_expr_recon_loss: 12398739.3540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 15271202.7997; train_optim_loss: 15271202.7997; val_kl_reg_loss: 36914.6280; val_edge_recon_loss: 2721029.8527; val_gene_expr_recon_loss: 11403340.2192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 14161284.7192; val_optim_loss: 14161284.7192
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9554; val_auprc_score: 0.9446; val_best_acc_score: 0.8949; val_best_f1_score: 0.9008; train_kl_reg_loss: 33012.1059; train_edge_recon_loss: 2682388.6994; train_gene_expr_recon_loss: 11071494.9656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13786895.7622; train_optim_loss: 13786895.7622; val_kl_reg_loss: 29286.4833; val_edge_recon_loss: 2686135.4623; val_gene_expr_recon_loss: 10807944.5822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13523366.5342; val_optim_loss: 13523366.5342
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9603; val_auprc_score: 0.9513; val_best_acc_score: 0.9012; val_best_f1_score: 0.9060; train_kl_reg_loss: 28102.9160; train_edge_recon_loss: 2662108.6567; train_gene_expr_recon_loss: 10664246.9235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13354458.4885; train_optim_loss: 13354458.4885; val_kl_reg_loss: 26362.5627; val_edge_recon_loss: 2679927.4572; val_gene_expr_recon_loss: 10514607.0205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13220897.0411; val_optim_loss: 13220897.0411
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9656; val_auprc_score: 0.9589; val_best_acc_score: 0.9072; val_best_f1_score: 0.9110; train_kl_reg_loss: 25692.1511; train_edge_recon_loss: 2652392.8524; train_gene_expr_recon_loss: 10463278.0872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13141363.0902; train_optim_loss: 13141363.0902; val_kl_reg_loss: 24438.8431; val_edge_recon_loss: 2669794.6815; val_gene_expr_recon_loss: 10388522.0068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13082755.5342; val_optim_loss: 13082755.5342
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9690; val_auprc_score: 0.9633; val_best_acc_score: 0.9123; val_best_f1_score: 0.9159; train_kl_reg_loss: 23949.1936; train_edge_recon_loss: 2646570.3117; train_gene_expr_recon_loss: 10354194.4786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13024713.9992; train_optim_loss: 13024713.9992; val_kl_reg_loss: 22688.3219; val_edge_recon_loss: 2666574.1233; val_gene_expr_recon_loss: 10322350.0616; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13011612.4795; val_optim_loss: 13011612.4795
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9726; val_auprc_score: 0.9680; val_best_acc_score: 0.9171; val_best_f1_score: 0.9203; train_kl_reg_loss: 22690.2786; train_edge_recon_loss: 2643232.8307; train_gene_expr_recon_loss: 10297019.3073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12962942.4098; train_optim_loss: 12962942.4098; val_kl_reg_loss: 21839.9013; val_edge_recon_loss: 2658584.4178; val_gene_expr_recon_loss: 10278363.9658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12958788.2945; val_optim_loss: 12958788.2945
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9752; val_auprc_score: 0.9710; val_best_acc_score: 0.9220; val_best_f1_score: 0.9246; train_kl_reg_loss: 21904.8184; train_edge_recon_loss: 2637734.8792; train_gene_expr_recon_loss: 10261658.8708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12921298.5604; train_optim_loss: 12921298.5604; val_kl_reg_loss: 21159.3348; val_edge_recon_loss: 2659155.4212; val_gene_expr_recon_loss: 10257630.9863; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12937945.7603; val_optim_loss: 12937945.7603
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9765; val_auprc_score: 0.9727; val_best_acc_score: 0.9235; val_best_f1_score: 0.9261; train_kl_reg_loss: 21319.1589; train_edge_recon_loss: 2633676.5585; train_gene_expr_recon_loss: 10239833.7554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12894829.4664; train_optim_loss: 12894829.4664; val_kl_reg_loss: 20686.5931; val_edge_recon_loss: 2657575.9212; val_gene_expr_recon_loss: 10240540.5411; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12918803.0890; val_optim_loss: 12918803.0890
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9773; val_auprc_score: 0.9729; val_best_acc_score: 0.9276; val_best_f1_score: 0.9297; train_kl_reg_loss: 20961.4209; train_edge_recon_loss: 2631001.1961; train_gene_expr_recon_loss: 10221163.6720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12873126.2699; train_optim_loss: 12873126.2699; val_kl_reg_loss: 20448.6520; val_edge_recon_loss: 2653285.5702; val_gene_expr_recon_loss: 10225097.8082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12898832.0479; val_optim_loss: 12898832.0479
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9784; val_auprc_score: 0.9749; val_best_acc_score: 0.9280; val_best_f1_score: 0.9300; train_kl_reg_loss: 20706.4238; train_edge_recon_loss: 2628766.2796; train_gene_expr_recon_loss: 10211794.8486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12861267.5612; train_optim_loss: 12861267.5612; val_kl_reg_loss: 20323.4632; val_edge_recon_loss: 2653338.5822; val_gene_expr_recon_loss: 10202385.2877; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12876047.3493; val_optim_loss: 12876047.3493
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9795; val_auprc_score: 0.9761; val_best_acc_score: 0.9308; val_best_f1_score: 0.9328; train_kl_reg_loss: 20377.2913; train_edge_recon_loss: 2627977.2202; train_gene_expr_recon_loss: 10206211.1009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12854565.6078; train_optim_loss: 12854565.6078; val_kl_reg_loss: 19933.4882; val_edge_recon_loss: 2648485.6969; val_gene_expr_recon_loss: 10212610.7123; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12881029.8425; val_optim_loss: 12881029.8425
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9804; val_auprc_score: 0.9772; val_best_acc_score: 0.9320; val_best_f1_score: 0.9337; train_kl_reg_loss: 20219.8328; train_edge_recon_loss: 2624055.0854; train_gene_expr_recon_loss: 10196867.6873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12841142.6086; train_optim_loss: 12841142.6086; val_kl_reg_loss: 19694.3113; val_edge_recon_loss: 2649874.8014; val_gene_expr_recon_loss: 10200405.0274; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12869974.1438; val_optim_loss: 12869974.1438
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9807; val_auprc_score: 0.9771; val_best_acc_score: 0.9331; val_best_f1_score: 0.9348; train_kl_reg_loss: 20069.0609; train_edge_recon_loss: 2623010.4792; train_gene_expr_recon_loss: 10191958.1988; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12835037.7347; train_optim_loss: 12835037.7347; val_kl_reg_loss: 19622.4946; val_edge_recon_loss: 2650350.5805; val_gene_expr_recon_loss: 10187825.3767; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12857798.4384; val_optim_loss: 12857798.4384
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9816; val_auprc_score: 0.9781; val_best_acc_score: 0.9355; val_best_f1_score: 0.9372; train_kl_reg_loss: 19899.6318; train_edge_recon_loss: 2623742.9643; train_gene_expr_recon_loss: 10188840.4266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12832483.0199; train_optim_loss: 12832483.0199; val_kl_reg_loss: 19658.1600; val_edge_recon_loss: 2645610.6661; val_gene_expr_recon_loss: 10203983.1781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12869251.9932; val_optim_loss: 12869251.9932
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9826; val_auprc_score: 0.9795; val_best_acc_score: 0.9370; val_best_f1_score: 0.9387; train_kl_reg_loss: 19769.9465; train_edge_recon_loss: 2621154.0566; train_gene_expr_recon_loss: 10185613.5933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12826537.5910; train_optim_loss: 12826537.5910; val_kl_reg_loss: 19302.4928; val_edge_recon_loss: 2644890.7517; val_gene_expr_recon_loss: 10196324.8356; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12860518.1233; val_optim_loss: 12860518.1233
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9826; val_auprc_score: 0.9796; val_best_acc_score: 0.9377; val_best_f1_score: 0.9393; train_kl_reg_loss: 19722.5327; train_edge_recon_loss: 2620740.7796; train_gene_expr_recon_loss: 10176879.3104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12817342.6284; train_optim_loss: 12817342.6284; val_kl_reg_loss: 19210.7897; val_edge_recon_loss: 2645340.9110; val_gene_expr_recon_loss: 10191320.0205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12855871.7534; val_optim_loss: 12855871.7534
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9828; val_auprc_score: 0.9795; val_best_acc_score: 0.9388; val_best_f1_score: 0.9402; train_kl_reg_loss: 19618.1319; train_edge_recon_loss: 2619326.3035; train_gene_expr_recon_loss: 10175501.6086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12814446.0489; train_optim_loss: 12814446.0489; val_kl_reg_loss: 19333.3670; val_edge_recon_loss: 2641079.4623; val_gene_expr_recon_loss: 10198652.4658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12859065.3219; val_optim_loss: 12859065.3219
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9833; val_auprc_score: 0.9803; val_best_acc_score: 0.9398; val_best_f1_score: 0.9411; train_kl_reg_loss: 19596.2614; train_edge_recon_loss: 2617973.0103; train_gene_expr_recon_loss: 10173566.9495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12811136.2294; train_optim_loss: 12811136.2294; val_kl_reg_loss: 18990.7134; val_edge_recon_loss: 2641894.1935; val_gene_expr_recon_loss: 10204188.3493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12865073.2397; val_optim_loss: 12865073.2397
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9840; val_auprc_score: 0.9810; val_best_acc_score: 0.9414; val_best_f1_score: 0.9427; train_kl_reg_loss: 19533.2546; train_edge_recon_loss: 2616654.6844; train_gene_expr_recon_loss: 10168954.5459; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12805142.4977; train_optim_loss: 12805142.4977; val_kl_reg_loss: 19315.2347; val_edge_recon_loss: 2635731.0788; val_gene_expr_recon_loss: 10175961.3356; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12831007.6849; val_optim_loss: 12831007.6849
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9842; val_auprc_score: 0.9814; val_best_acc_score: 0.9413; val_best_f1_score: 0.9428; train_kl_reg_loss: 19459.8037; train_edge_recon_loss: 2617869.8740; train_gene_expr_recon_loss: 10168526.2760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12805855.9442; train_optim_loss: 12805855.9442; val_kl_reg_loss: 18833.9790; val_edge_recon_loss: 2639194.1421; val_gene_expr_recon_loss: 10194038.4041; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12852066.5000; val_optim_loss: 12852066.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9842; val_auprc_score: 0.9815; val_best_acc_score: 0.9405; val_best_f1_score: 0.9420; train_kl_reg_loss: 19434.2612; train_edge_recon_loss: 2615753.9820; train_gene_expr_recon_loss: 10167388.6032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12802576.8341; train_optim_loss: 12802576.8341; val_kl_reg_loss: 19060.9890; val_edge_recon_loss: 2641252.7671; val_gene_expr_recon_loss: 10182953.0342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12843266.7671; val_optim_loss: 12843266.7671
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9839; val_auprc_score: 0.9811; val_best_acc_score: 0.9404; val_best_f1_score: 0.9419; train_kl_reg_loss: 19382.2924; train_edge_recon_loss: 2614902.8729; train_gene_expr_recon_loss: 10167387.5398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12801672.7102; train_optim_loss: 12801672.7102; val_kl_reg_loss: 19029.7710; val_edge_recon_loss: 2639063.8442; val_gene_expr_recon_loss: 10179581.2740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12837674.8425; val_optim_loss: 12837674.8425
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9846; val_auprc_score: 0.9819; val_best_acc_score: 0.9424; val_best_f1_score: 0.9439; train_kl_reg_loss: 19318.5678; train_edge_recon_loss: 2615613.1527; train_gene_expr_recon_loss: 10165549.4801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12800481.1972; train_optim_loss: 12800481.1972; val_kl_reg_loss: 18896.7098; val_edge_recon_loss: 2636995.8236; val_gene_expr_recon_loss: 10183873.5274; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12839766.0479; val_optim_loss: 12839766.0479

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9851; val_auprc_score: 0.9825; val_best_acc_score: 0.9431; val_best_f1_score: 0.9445; train_kl_reg_loss: 19559.8313; train_edge_recon_loss: 2613791.7181; train_gene_expr_recon_loss: 10121795.0191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12755146.5657; train_optim_loss: 12755146.5657; val_kl_reg_loss: 19097.0834; val_edge_recon_loss: 2634899.2637; val_gene_expr_recon_loss: 10160819.6164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12814815.9658; val_optim_loss: 12814815.9658
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9851; val_auprc_score: 0.9823; val_best_acc_score: 0.9430; val_best_f1_score: 0.9443; train_kl_reg_loss: 19517.8363; train_edge_recon_loss: 2612738.3649; train_gene_expr_recon_loss: 10118589.6957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12750845.8945; train_optim_loss: 12750845.8945; val_kl_reg_loss: 19102.0689; val_edge_recon_loss: 2634252.1421; val_gene_expr_recon_loss: 10150163.1986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12803517.3904; val_optim_loss: 12803517.3904
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9844; val_auprc_score: 0.9818; val_best_acc_score: 0.9417; val_best_f1_score: 0.9431; train_kl_reg_loss: 19569.4245; train_edge_recon_loss: 2612364.6481; train_gene_expr_recon_loss: 10116148.9060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12748082.9771; train_optim_loss: 12748082.9771; val_kl_reg_loss: 19279.1029; val_edge_recon_loss: 2638737.2072; val_gene_expr_recon_loss: 10150285.6781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12808301.9726; val_optim_loss: 12808301.9726
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9848; val_auprc_score: 0.9823; val_best_acc_score: 0.9421; val_best_f1_score: 0.9433; train_kl_reg_loss: 19632.7122; train_edge_recon_loss: 2611385.1827; train_gene_expr_recon_loss: 10117684.6881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12748702.5872; train_optim_loss: 12748702.5872; val_kl_reg_loss: 19184.9616; val_edge_recon_loss: 2638636.1045; val_gene_expr_recon_loss: 10136061.1918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12793882.2877; val_optim_loss: 12793882.2877
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9852; val_auprc_score: 0.9828; val_best_acc_score: 0.9435; val_best_f1_score: 0.9448; train_kl_reg_loss: 19619.8023; train_edge_recon_loss: 2613073.9765; train_gene_expr_recon_loss: 10115067.0420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12747760.8318; train_optim_loss: 12747760.8318; val_kl_reg_loss: 19181.1094; val_edge_recon_loss: 2635747.2209; val_gene_expr_recon_loss: 10147513.1164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12802441.4658; val_optim_loss: 12802441.4658
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9849; val_auprc_score: 0.9824; val_best_acc_score: 0.9431; val_best_f1_score: 0.9445; train_kl_reg_loss: 19565.3915; train_edge_recon_loss: 2612451.9549; train_gene_expr_recon_loss: 10110772.5849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12742789.9495; train_optim_loss: 12742789.9495; val_kl_reg_loss: 19225.9746; val_edge_recon_loss: 2638358.6969; val_gene_expr_recon_loss: 10156084.7192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12813669.3767; val_optim_loss: 12813669.3767
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9848; val_auprc_score: 0.9821; val_best_acc_score: 0.9422; val_best_f1_score: 0.9437; train_kl_reg_loss: 19544.5567; train_edge_recon_loss: 2612200.6059; train_gene_expr_recon_loss: 10114952.7018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12746697.8494; train_optim_loss: 12746697.8494; val_kl_reg_loss: 19187.1311; val_edge_recon_loss: 2639953.0360; val_gene_expr_recon_loss: 10155254.2740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12814394.4658; val_optim_loss: 12814394.4658
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9851; val_auprc_score: 0.9825; val_best_acc_score: 0.9431; val_best_f1_score: 0.9445; train_kl_reg_loss: 19539.7864; train_edge_recon_loss: 2612357.1019; train_gene_expr_recon_loss: 10111167.7531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12743064.6491; train_optim_loss: 12743064.6491; val_kl_reg_loss: 19107.3290; val_edge_recon_loss: 2635943.3099; val_gene_expr_recon_loss: 10154414.5753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12809465.1986; val_optim_loss: 12809465.1986

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9843; val_auprc_score: 0.9813; val_best_acc_score: 0.9418; val_best_f1_score: 0.9432; train_kl_reg_loss: 19534.0467; train_edge_recon_loss: 2612148.5935; train_gene_expr_recon_loss: 10108573.0092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12740255.6491; train_optim_loss: 12740255.6491; val_kl_reg_loss: 19174.1322; val_edge_recon_loss: 2637161.2038; val_gene_expr_recon_loss: 10144893.2877; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12801228.6370; val_optim_loss: 12801228.6370
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9849; val_auprc_score: 0.9822; val_best_acc_score: 0.9425; val_best_f1_score: 0.9439; train_kl_reg_loss: 19569.6192; train_edge_recon_loss: 2612069.0201; train_gene_expr_recon_loss: 10110444.9855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12742083.6284; train_optim_loss: 12742083.6284; val_kl_reg_loss: 19164.8161; val_edge_recon_loss: 2639608.2688; val_gene_expr_recon_loss: 10142587.2603; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12801360.3356; val_optim_loss: 12801360.3356
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9849; val_auprc_score: 0.9824; val_best_acc_score: 0.9427; val_best_f1_score: 0.9440; train_kl_reg_loss: 19551.7340; train_edge_recon_loss: 2612450.6821; train_gene_expr_recon_loss: 10106873.7424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12738876.1583; train_optim_loss: 12738876.1583; val_kl_reg_loss: 19162.1093; val_edge_recon_loss: 2635230.2140; val_gene_expr_recon_loss: 10140938.9384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12795331.2260; val_optim_loss: 12795331.2260
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9852; val_auprc_score: 0.9826; val_best_acc_score: 0.9431; val_best_f1_score: 0.9445; train_kl_reg_loss: 19560.2189; train_edge_recon_loss: 2611873.3087; train_gene_expr_recon_loss: 10106435.2943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12737868.8180; train_optim_loss: 12737868.8180; val_kl_reg_loss: 19196.1355; val_edge_recon_loss: 2636176.8801; val_gene_expr_recon_loss: 10158929.6027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12814302.6644; val_optim_loss: 12814302.6644

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 99 min 12 sec.
Using best model state, which was in epoch 27.
