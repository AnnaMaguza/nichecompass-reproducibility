None
Run timestamp: 11082023_103538_94.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_94']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9410; val_auprc_score: 0.9258; val_best_acc_score: 0.8758; val_best_f1_score: 0.8837; train_kl_reg_loss: 40582.1554; train_edge_recon_loss: 2839293.9205; train_gene_expr_recon_loss: 12355875.1315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 15235751.2057; train_optim_loss: 15235751.2057; val_kl_reg_loss: 37426.0413; val_edge_recon_loss: 2721427.0291; val_gene_expr_recon_loss: 11348668.6644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 14107521.7534; val_optim_loss: 14107521.7534
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9542; val_auprc_score: 0.9431; val_best_acc_score: 0.8929; val_best_f1_score: 0.8991; train_kl_reg_loss: 33156.5015; train_edge_recon_loss: 2683556.5520; train_gene_expr_recon_loss: 11043712.4327; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13760425.5015; train_optim_loss: 13760425.5015; val_kl_reg_loss: 29225.9953; val_edge_recon_loss: 2693779.0497; val_gene_expr_recon_loss: 10756025.5274; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13479030.5548; val_optim_loss: 13479030.5548
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9598; val_auprc_score: 0.9508; val_best_acc_score: 0.8998; val_best_f1_score: 0.9049; train_kl_reg_loss: 28422.5891; train_edge_recon_loss: 2661947.1011; train_gene_expr_recon_loss: 10653649.6116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13344019.3035; train_optim_loss: 13344019.3035; val_kl_reg_loss: 26933.9729; val_edge_recon_loss: 2678192.4058; val_gene_expr_recon_loss: 10506981.9247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13212108.3014; val_optim_loss: 13212108.3014
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9624; val_auprc_score: 0.9550; val_best_acc_score: 0.9030; val_best_f1_score: 0.9075; train_kl_reg_loss: 26001.9134; train_edge_recon_loss: 2654014.4725; train_gene_expr_recon_loss: 10460625.1476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13140641.5313; train_optim_loss: 13140641.5313; val_kl_reg_loss: 24723.5273; val_edge_recon_loss: 2672821.7295; val_gene_expr_recon_loss: 10379366.5685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13076911.8493; val_optim_loss: 13076911.8493
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9665; val_auprc_score: 0.9604; val_best_acc_score: 0.9082; val_best_f1_score: 0.9120; train_kl_reg_loss: 24309.2063; train_edge_recon_loss: 2648721.6760; train_gene_expr_recon_loss: 10356029.4197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13029060.2966; train_optim_loss: 13029060.2966; val_kl_reg_loss: 23081.4875; val_edge_recon_loss: 2668305.5908; val_gene_expr_recon_loss: 10280735.9658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12972123.0822; val_optim_loss: 12972123.0822
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9682; val_auprc_score: 0.9623; val_best_acc_score: 0.9111; val_best_f1_score: 0.9146; train_kl_reg_loss: 23072.9658; train_edge_recon_loss: 2645599.8349; train_gene_expr_recon_loss: 10298223.9664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12966896.7706; train_optim_loss: 12966896.7706; val_kl_reg_loss: 22298.5004; val_edge_recon_loss: 2663827.8134; val_gene_expr_recon_loss: 10228386.3904; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12914512.7603; val_optim_loss: 12914512.7603
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9715; val_auprc_score: 0.9666; val_best_acc_score: 0.9157; val_best_f1_score: 0.9186; train_kl_reg_loss: 22100.3080; train_edge_recon_loss: 2641828.4950; train_gene_expr_recon_loss: 10257349.5933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12921278.3869; train_optim_loss: 12921278.3869; val_kl_reg_loss: 20958.7558; val_edge_recon_loss: 2662498.1712; val_gene_expr_recon_loss: 10228069.1918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12911526.1164; val_optim_loss: 12911526.1164
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9741; val_auprc_score: 0.9697; val_best_acc_score: 0.9208; val_best_f1_score: 0.9230; train_kl_reg_loss: 21341.9353; train_edge_recon_loss: 2638053.1474; train_gene_expr_recon_loss: 10238142.6835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12897537.7523; train_optim_loss: 12897537.7523; val_kl_reg_loss: 20262.0989; val_edge_recon_loss: 2655637.0616; val_gene_expr_recon_loss: 10212361.1164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12888260.3014; val_optim_loss: 12888260.3014
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9753; val_auprc_score: 0.9709; val_best_acc_score: 0.9241; val_best_f1_score: 0.9262; train_kl_reg_loss: 20741.4999; train_edge_recon_loss: 2635580.8974; train_gene_expr_recon_loss: 10220526.1154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12876848.5176; train_optim_loss: 12876848.5176; val_kl_reg_loss: 20111.2218; val_edge_recon_loss: 2657459.9795; val_gene_expr_recon_loss: 10202694.8904; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12880266.1096; val_optim_loss: 12880266.1096
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9770; val_auprc_score: 0.9729; val_best_acc_score: 0.9266; val_best_f1_score: 0.9288; train_kl_reg_loss: 20310.5652; train_edge_recon_loss: 2630512.4992; train_gene_expr_recon_loss: 10207739.6751; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12858562.7271; train_optim_loss: 12858562.7271; val_kl_reg_loss: 20177.5091; val_edge_recon_loss: 2658577.8767; val_gene_expr_recon_loss: 10177992.8288; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12856748.1644; val_optim_loss: 12856748.1644
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9792; val_auprc_score: 0.9757; val_best_acc_score: 0.9303; val_best_f1_score: 0.9322; train_kl_reg_loss: 19975.9881; train_edge_recon_loss: 2629087.2049; train_gene_expr_recon_loss: 10193030.8991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12842094.0956; train_optim_loss: 12842094.0956; val_kl_reg_loss: 19742.7557; val_edge_recon_loss: 2653137.3390; val_gene_expr_recon_loss: 10180870.0685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12853750.1986; val_optim_loss: 12853750.1986
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9800; val_auprc_score: 0.9763; val_best_acc_score: 0.9323; val_best_f1_score: 0.9340; train_kl_reg_loss: 19752.5827; train_edge_recon_loss: 2627124.8221; train_gene_expr_recon_loss: 10197713.7278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12844591.1269; train_optim_loss: 12844591.1269; val_kl_reg_loss: 19350.5415; val_edge_recon_loss: 2650291.0274; val_gene_expr_recon_loss: 10168734.6849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12838376.2534; val_optim_loss: 12838376.2534
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9819; val_auprc_score: 0.9790; val_best_acc_score: 0.9347; val_best_f1_score: 0.9363; train_kl_reg_loss: 19696.2034; train_edge_recon_loss: 2623533.7747; train_gene_expr_recon_loss: 10189647.0780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12832877.0520; train_optim_loss: 12832877.0520; val_kl_reg_loss: 19292.8863; val_edge_recon_loss: 2645642.7688; val_gene_expr_recon_loss: 10175897.2397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12840832.9041; val_optim_loss: 12840832.9041
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9825; val_auprc_score: 0.9795; val_best_acc_score: 0.9373; val_best_f1_score: 0.9385; train_kl_reg_loss: 19587.7268; train_edge_recon_loss: 2622750.0201; train_gene_expr_recon_loss: 10186014.1544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12828351.8891; train_optim_loss: 12828351.8891; val_kl_reg_loss: 19140.7102; val_edge_recon_loss: 2646780.5462; val_gene_expr_recon_loss: 10175703.7603; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12841625.0068; val_optim_loss: 12841625.0068
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9824; val_auprc_score: 0.9793; val_best_acc_score: 0.9374; val_best_f1_score: 0.9390; train_kl_reg_loss: 19540.9718; train_edge_recon_loss: 2621890.1904; train_gene_expr_recon_loss: 10181543.7844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12822974.9427; train_optim_loss: 12822974.9427; val_kl_reg_loss: 19148.5986; val_edge_recon_loss: 2644800.8853; val_gene_expr_recon_loss: 10153781.8425; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12817731.3699; val_optim_loss: 12817731.3699
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9825; val_auprc_score: 0.9791; val_best_acc_score: 0.9382; val_best_f1_score: 0.9395; train_kl_reg_loss: 19574.1072; train_edge_recon_loss: 2619755.2769; train_gene_expr_recon_loss: 10178527.8127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12817857.2034; train_optim_loss: 12817857.2034; val_kl_reg_loss: 19427.1730; val_edge_recon_loss: 2641242.8442; val_gene_expr_recon_loss: 10165895.6507; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12826565.7055; val_optim_loss: 12826565.7055
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9835; val_auprc_score: 0.9808; val_best_acc_score: 0.9397; val_best_f1_score: 0.9411; train_kl_reg_loss: 19554.7506; train_edge_recon_loss: 2619014.5044; train_gene_expr_recon_loss: 10175474.0046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12814043.2492; train_optim_loss: 12814043.2492; val_kl_reg_loss: 19138.3709; val_edge_recon_loss: 2640075.2637; val_gene_expr_recon_loss: 10186634.9932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12845848.6096; val_optim_loss: 12845848.6096
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9832; val_auprc_score: 0.9801; val_best_acc_score: 0.9391; val_best_f1_score: 0.9404; train_kl_reg_loss: 19472.4471; train_edge_recon_loss: 2617959.0881; train_gene_expr_recon_loss: 10177761.2370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12815192.7745; train_optim_loss: 12815192.7745; val_kl_reg_loss: 18982.4201; val_edge_recon_loss: 2645175.9726; val_gene_expr_recon_loss: 10174627.1575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12838785.5137; val_optim_loss: 12838785.5137
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9831; val_auprc_score: 0.9800; val_best_acc_score: 0.9395; val_best_f1_score: 0.9407; train_kl_reg_loss: 19395.2838; train_edge_recon_loss: 2616665.9218; train_gene_expr_recon_loss: 10170177.6154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12806238.8157; train_optim_loss: 12806238.8157; val_kl_reg_loss: 18986.8722; val_edge_recon_loss: 2644685.3014; val_gene_expr_recon_loss: 10159895.4315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12823567.6164; val_optim_loss: 12823567.6164

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9846; val_auprc_score: 0.9820; val_best_acc_score: 0.9420; val_best_f1_score: 0.9430; train_kl_reg_loss: 19724.2449; train_edge_recon_loss: 2615667.3354; train_gene_expr_recon_loss: 10128680.7018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12764072.2752; train_optim_loss: 12764072.2752; val_kl_reg_loss: 19229.7421; val_edge_recon_loss: 2635543.3613; val_gene_expr_recon_loss: 10117722.5822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12772495.7329; val_optim_loss: 12772495.7329
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9843; val_auprc_score: 0.9817; val_best_acc_score: 0.9411; val_best_f1_score: 0.9422; train_kl_reg_loss: 19713.9350; train_edge_recon_loss: 2614046.7649; train_gene_expr_recon_loss: 10120227.8586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12753988.5535; train_optim_loss: 12753988.5535; val_kl_reg_loss: 19404.1073; val_edge_recon_loss: 2639758.7757; val_gene_expr_recon_loss: 10127785.6027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12786948.5000; val_optim_loss: 12786948.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9844; val_auprc_score: 0.9819; val_best_acc_score: 0.9406; val_best_f1_score: 0.9421; train_kl_reg_loss: 19780.1028; train_edge_recon_loss: 2614276.8836; train_gene_expr_recon_loss: 10120580.6950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12754637.6934; train_optim_loss: 12754637.6934; val_kl_reg_loss: 19434.8506; val_edge_recon_loss: 2639191.5805; val_gene_expr_recon_loss: 10125892.1370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12784518.5959; val_optim_loss: 12784518.5959
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9844; val_auprc_score: 0.9820; val_best_acc_score: 0.9417; val_best_f1_score: 0.9430; train_kl_reg_loss: 19751.1534; train_edge_recon_loss: 2614543.8599; train_gene_expr_recon_loss: 10121331.4098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12755626.4258; train_optim_loss: 12755626.4258; val_kl_reg_loss: 19342.8863; val_edge_recon_loss: 2637476.9452; val_gene_expr_recon_loss: 10138116.1507; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12794935.9452; val_optim_loss: 12794935.9452
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9844; val_auprc_score: 0.9817; val_best_acc_score: 0.9417; val_best_f1_score: 0.9430; train_kl_reg_loss: 19754.3076; train_edge_recon_loss: 2614879.4083; train_gene_expr_recon_loss: 10115884.2255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12750517.9488; train_optim_loss: 12750517.9488; val_kl_reg_loss: 19346.1189; val_edge_recon_loss: 2638199.8476; val_gene_expr_recon_loss: 10134532.1781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12792078.1438; val_optim_loss: 12792078.1438

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9843; val_auprc_score: 0.9816; val_best_acc_score: 0.9416; val_best_f1_score: 0.9430; train_kl_reg_loss: 19771.3732; train_edge_recon_loss: 2613404.4086; train_gene_expr_recon_loss: 10114942.9870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12748118.7554; train_optim_loss: 12748118.7554; val_kl_reg_loss: 19458.6961; val_edge_recon_loss: 2636908.2175; val_gene_expr_recon_loss: 10109778.5616; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12766145.4521; val_optim_loss: 12766145.4521
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9842; val_auprc_score: 0.9815; val_best_acc_score: 0.9409; val_best_f1_score: 0.9424; train_kl_reg_loss: 19808.9384; train_edge_recon_loss: 2613280.7632; train_gene_expr_recon_loss: 10112541.8517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12745631.5283; train_optim_loss: 12745631.5283; val_kl_reg_loss: 19458.9109; val_edge_recon_loss: 2637214.5000; val_gene_expr_recon_loss: 10130556.8904; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12787230.3082; val_optim_loss: 12787230.3082
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9838; val_auprc_score: 0.9808; val_best_acc_score: 0.9404; val_best_f1_score: 0.9417; train_kl_reg_loss: 19821.0693; train_edge_recon_loss: 2614106.0826; train_gene_expr_recon_loss: 10110868.2683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12744795.4190; train_optim_loss: 12744795.4190; val_kl_reg_loss: 19468.2002; val_edge_recon_loss: 2642304.9589; val_gene_expr_recon_loss: 10127627.1712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12789400.2945; val_optim_loss: 12789400.2945
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9848; val_auprc_score: 0.9823; val_best_acc_score: 0.9424; val_best_f1_score: 0.9437; train_kl_reg_loss: 19824.8618; train_edge_recon_loss: 2613471.0138; train_gene_expr_recon_loss: 10111544.9465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12744840.8196; train_optim_loss: 12744840.8196; val_kl_reg_loss: 19443.4300; val_edge_recon_loss: 2635258.6610; val_gene_expr_recon_loss: 10109597.0068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12764299.0753; val_optim_loss: 12764299.0753
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9844; val_auprc_score: 0.9818; val_best_acc_score: 0.9410; val_best_f1_score: 0.9425; train_kl_reg_loss: 19813.8103; train_edge_recon_loss: 2612311.7173; train_gene_expr_recon_loss: 10111583.8960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12743709.4266; train_optim_loss: 12743709.4266; val_kl_reg_loss: 19468.2002; val_edge_recon_loss: 2640459.4041; val_gene_expr_recon_loss: 10110304.1164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12770231.7123; val_optim_loss: 12770231.7123
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9844; val_auprc_score: 0.9819; val_best_acc_score: 0.9415; val_best_f1_score: 0.9429; train_kl_reg_loss: 19817.2825; train_edge_recon_loss: 2613559.3524; train_gene_expr_recon_loss: 10109325.4205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12742702.0696; train_optim_loss: 12742702.0696; val_kl_reg_loss: 19441.3798; val_edge_recon_loss: 2636684.6661; val_gene_expr_recon_loss: 10116314.8219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12772440.8699; val_optim_loss: 12772440.8699
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9842; val_auprc_score: 0.9814; val_best_acc_score: 0.9410; val_best_f1_score: 0.9423; train_kl_reg_loss: 19822.8007; train_edge_recon_loss: 2612117.7724; train_gene_expr_recon_loss: 10113202.5948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12745143.1797; train_optim_loss: 12745143.1797; val_kl_reg_loss: 19445.4266; val_edge_recon_loss: 2639295.7723; val_gene_expr_recon_loss: 10101523.5205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12760264.7123; val_optim_loss: 12760264.7123
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9845; val_auprc_score: 0.9819; val_best_acc_score: 0.9419; val_best_f1_score: 0.9429; train_kl_reg_loss: 19831.5236; train_edge_recon_loss: 2612002.8138; train_gene_expr_recon_loss: 10116342.8005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12748177.1391; train_optim_loss: 12748177.1391; val_kl_reg_loss: 19492.8060; val_edge_recon_loss: 2637419.6079; val_gene_expr_recon_loss: 10124217.2808; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12781129.7260; val_optim_loss: 12781129.7260
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9844; val_auprc_score: 0.9818; val_best_acc_score: 0.9413; val_best_f1_score: 0.9425; train_kl_reg_loss: 19830.9398; train_edge_recon_loss: 2612905.8775; train_gene_expr_recon_loss: 10110830.8563; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12743567.6728; train_optim_loss: 12743567.6728; val_kl_reg_loss: 19459.4105; val_edge_recon_loss: 2635864.2808; val_gene_expr_recon_loss: 10121620.5205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12776944.2260; val_optim_loss: 12776944.2260
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9846; val_auprc_score: 0.9822; val_best_acc_score: 0.9411; val_best_f1_score: 0.9425; train_kl_reg_loss: 19831.7757; train_edge_recon_loss: 2613289.9641; train_gene_expr_recon_loss: 10110917.1407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12744038.8838; train_optim_loss: 12744038.8838; val_kl_reg_loss: 19462.9764; val_edge_recon_loss: 2638247.0582; val_gene_expr_recon_loss: 10107699.0685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12765409.0685; val_optim_loss: 12765409.0685
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9848; val_auprc_score: 0.9818; val_best_acc_score: 0.9419; val_best_f1_score: 0.9431; train_kl_reg_loss: 19812.6240; train_edge_recon_loss: 2612436.9987; train_gene_expr_recon_loss: 10112158.9442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12744408.5665; train_optim_loss: 12744408.5665; val_kl_reg_loss: 19443.7270; val_edge_recon_loss: 2638451.8322; val_gene_expr_recon_loss: 10113596.8082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12771492.3630; val_optim_loss: 12771492.3630

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9843; val_auprc_score: 0.9816; val_best_acc_score: 0.9413; val_best_f1_score: 0.9427; train_kl_reg_loss: 19816.3274; train_edge_recon_loss: 2613722.8790; train_gene_expr_recon_loss: 10115451.6476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12748990.8448; train_optim_loss: 12748990.8448; val_kl_reg_loss: 19440.8475; val_edge_recon_loss: 2638769.8065; val_gene_expr_recon_loss: 10113307.0411; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12771517.6644; val_optim_loss: 12771517.6644
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9846; val_auprc_score: 0.9821; val_best_acc_score: 0.9414; val_best_f1_score: 0.9428; train_kl_reg_loss: 19815.1107; train_edge_recon_loss: 2612892.6497; train_gene_expr_recon_loss: 10112799.7179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12745507.4709; train_optim_loss: 12745507.4709; val_kl_reg_loss: 19446.8535; val_edge_recon_loss: 2636620.7860; val_gene_expr_recon_loss: 10112474.5342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12768542.1918; val_optim_loss: 12768542.1918
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9845; val_auprc_score: 0.9820; val_best_acc_score: 0.9414; val_best_f1_score: 0.9428; train_kl_reg_loss: 19823.4950; train_edge_recon_loss: 2613052.2385; train_gene_expr_recon_loss: 10111071.9060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12743947.6399; train_optim_loss: 12743947.6399; val_kl_reg_loss: 19469.9192; val_edge_recon_loss: 2640235.5103; val_gene_expr_recon_loss: 10119731.6575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12779437.0822; val_optim_loss: 12779437.0822
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9842; val_auprc_score: 0.9816; val_best_acc_score: 0.9409; val_best_f1_score: 0.9421; train_kl_reg_loss: 19822.5126; train_edge_recon_loss: 2612428.2009; train_gene_expr_recon_loss: 10109060.2829; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12741310.9992; train_optim_loss: 12741310.9992; val_kl_reg_loss: 19463.7161; val_edge_recon_loss: 2640452.8767; val_gene_expr_recon_loss: 10119681.2123; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12779597.8014; val_optim_loss: 12779597.8014

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 110 min 7 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
val AUROC score: 0.9840
val AUPRC score: 0.9813
val best accuracy score: 0.9408
val best F1 score: 0.9420
val target rna MSE score: 1.4011
val source rna MSE score: 0.1640

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
