None
Run timestamp: 14072023_224834_147.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_147']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9741; val_auprc_score: 0.9690; val_best_acc_score: 0.9219; val_best_f1_score: 0.9244; train_kl_reg_loss: 17334.1075; train_edge_recon_loss: 2677861.2269; train_gene_expr_recon_loss: 752974.4758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3448169.8061; train_optim_loss: 3448169.8061; val_kl_reg_loss: 14523.4902; val_edge_recon_loss: 2644848.6481; val_gene_expr_recon_loss: 700470.8293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3359842.9653; val_optim_loss: 3359842.9653
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9849; val_auprc_score: 0.9821; val_best_acc_score: 0.9436; val_best_f1_score: 0.9449; train_kl_reg_loss: 14059.1362; train_edge_recon_loss: 2618535.6035; train_gene_expr_recon_loss: 685522.7430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3318117.4862; train_optim_loss: 3318117.4862; val_kl_reg_loss: 13376.9199; val_edge_recon_loss: 2626208.8912; val_gene_expr_recon_loss: 675688.2535; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3315274.0625; val_optim_loss: 3315274.0625
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9874; val_auprc_score: 0.9849; val_best_acc_score: 0.9495; val_best_f1_score: 0.9506; train_kl_reg_loss: 13333.8749; train_edge_recon_loss: 2607545.5392; train_gene_expr_recon_loss: 669446.4637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3290325.8776; train_optim_loss: 3290325.8776; val_kl_reg_loss: 12751.5875; val_edge_recon_loss: 2616387.5417; val_gene_expr_recon_loss: 666309.0564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3295448.1910; val_optim_loss: 3295448.1910
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9894; val_auprc_score: 0.9870; val_best_acc_score: 0.9557; val_best_f1_score: 0.9566; train_kl_reg_loss: 12642.5065; train_edge_recon_loss: 2601817.0433; train_gene_expr_recon_loss: 662906.6266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3277366.1761; train_optim_loss: 3277366.1761; val_kl_reg_loss: 12160.0315; val_edge_recon_loss: 2608824.0509; val_gene_expr_recon_loss: 661091.6933; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3282075.7743; val_optim_loss: 3282075.7743
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9906; val_auprc_score: 0.9888; val_best_acc_score: 0.9585; val_best_f1_score: 0.9593; train_kl_reg_loss: 12215.6029; train_edge_recon_loss: 2596287.5604; train_gene_expr_recon_loss: 659280.4686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3267783.6341; train_optim_loss: 3267783.6341; val_kl_reg_loss: 11728.1517; val_edge_recon_loss: 2608847.3565; val_gene_expr_recon_loss: 658667.7593; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3279243.2766; val_optim_loss: 3279243.2766
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9907; val_auprc_score: 0.9886; val_best_acc_score: 0.9598; val_best_f1_score: 0.9604; train_kl_reg_loss: 12019.2384; train_edge_recon_loss: 2593219.3184; train_gene_expr_recon_loss: 656952.3842; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3262190.9432; train_optim_loss: 3262190.9432; val_kl_reg_loss: 11770.0583; val_edge_recon_loss: 2606448.2928; val_gene_expr_recon_loss: 657697.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3275915.8056; val_optim_loss: 3275915.8056
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9917; val_auprc_score: 0.9898; val_best_acc_score: 0.9628; val_best_f1_score: 0.9634; train_kl_reg_loss: 11848.7020; train_edge_recon_loss: 2590396.5039; train_gene_expr_recon_loss: 654897.8101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3257143.0117; train_optim_loss: 3257143.0117; val_kl_reg_loss: 11695.1801; val_edge_recon_loss: 2602074.2766; val_gene_expr_recon_loss: 656681.7341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3270451.1887; val_optim_loss: 3270451.1887
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9918; val_auprc_score: 0.9899; val_best_acc_score: 0.9635; val_best_f1_score: 0.9641; train_kl_reg_loss: 11727.7345; train_edge_recon_loss: 2588392.8920; train_gene_expr_recon_loss: 653335.3144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3253455.9345; train_optim_loss: 3253455.9345; val_kl_reg_loss: 11450.0518; val_edge_recon_loss: 2600903.3171; val_gene_expr_recon_loss: 654190.7688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3266544.1424; val_optim_loss: 3266544.1424
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9923; val_auprc_score: 0.9906; val_best_acc_score: 0.9655; val_best_f1_score: 0.9659; train_kl_reg_loss: 11638.1899; train_edge_recon_loss: 2587802.3095; train_gene_expr_recon_loss: 652424.7375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3251865.2359; train_optim_loss: 3251865.2359; val_kl_reg_loss: 11480.5700; val_edge_recon_loss: 2598741.2234; val_gene_expr_recon_loss: 653270.2703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3263492.0660; val_optim_loss: 3263492.0660
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9925; val_auprc_score: 0.9908; val_best_acc_score: 0.9656; val_best_f1_score: 0.9661; train_kl_reg_loss: 11571.3414; train_edge_recon_loss: 2586033.4133; train_gene_expr_recon_loss: 651396.8672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3249001.6241; train_optim_loss: 3249001.6241; val_kl_reg_loss: 11376.4832; val_edge_recon_loss: 2596358.8692; val_gene_expr_recon_loss: 653399.8119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3261135.1771; val_optim_loss: 3261135.1771
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9920; val_auprc_score: 0.9903; val_best_acc_score: 0.9646; val_best_f1_score: 0.9651; train_kl_reg_loss: 11431.7975; train_edge_recon_loss: 2585650.2265; train_gene_expr_recon_loss: 650561.9089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3247643.9326; train_optim_loss: 3247643.9326; val_kl_reg_loss: 11286.6203; val_edge_recon_loss: 2595578.6528; val_gene_expr_recon_loss: 652192.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3259057.3438; val_optim_loss: 3259057.3438
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9926; val_auprc_score: 0.9909; val_best_acc_score: 0.9660; val_best_f1_score: 0.9665; train_kl_reg_loss: 11405.8501; train_edge_recon_loss: 2583422.3444; train_gene_expr_recon_loss: 649930.3767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3244758.5750; train_optim_loss: 3244758.5750; val_kl_reg_loss: 11277.2731; val_edge_recon_loss: 2594631.9155; val_gene_expr_recon_loss: 652191.4005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3258100.5810; val_optim_loss: 3258100.5810
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9925; val_auprc_score: 0.9907; val_best_acc_score: 0.9668; val_best_f1_score: 0.9672; train_kl_reg_loss: 11343.0809; train_edge_recon_loss: 2582731.0548; train_gene_expr_recon_loss: 649354.4677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3243428.6040; train_optim_loss: 3243428.6040; val_kl_reg_loss: 11256.8624; val_edge_recon_loss: 2592156.6921; val_gene_expr_recon_loss: 652192.8215; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3255606.3600; val_optim_loss: 3255606.3600
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9928; val_auprc_score: 0.9910; val_best_acc_score: 0.9677; val_best_f1_score: 0.9681; train_kl_reg_loss: 11319.0507; train_edge_recon_loss: 2581722.6627; train_gene_expr_recon_loss: 649298.1127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3242339.8261; train_optim_loss: 3242339.8261; val_kl_reg_loss: 11097.9935; val_edge_recon_loss: 2593649.0590; val_gene_expr_recon_loss: 652750.6128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3257497.6806; val_optim_loss: 3257497.6806
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9927; val_auprc_score: 0.9909; val_best_acc_score: 0.9676; val_best_f1_score: 0.9680; train_kl_reg_loss: 11242.3910; train_edge_recon_loss: 2580580.3497; train_gene_expr_recon_loss: 648756.8219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3240579.5665; train_optim_loss: 3240579.5665; val_kl_reg_loss: 11074.4787; val_edge_recon_loss: 2593129.9468; val_gene_expr_recon_loss: 651003.5732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3255207.9965; val_optim_loss: 3255207.9965
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9933; val_auprc_score: 0.9918; val_best_acc_score: 0.9686; val_best_f1_score: 0.9690; train_kl_reg_loss: 11222.5166; train_edge_recon_loss: 2580543.9371; train_gene_expr_recon_loss: 648363.1013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3240129.5523; train_optim_loss: 3240129.5523; val_kl_reg_loss: 10933.7514; val_edge_recon_loss: 2590649.2153; val_gene_expr_recon_loss: 650526.6496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3252109.6030; val_optim_loss: 3252109.6030
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9930; val_auprc_score: 0.9913; val_best_acc_score: 0.9680; val_best_f1_score: 0.9684; train_kl_reg_loss: 11152.7583; train_edge_recon_loss: 2580014.0604; train_gene_expr_recon_loss: 648236.6854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3239403.5039; train_optim_loss: 3239403.5039; val_kl_reg_loss: 10967.4653; val_edge_recon_loss: 2593087.9630; val_gene_expr_recon_loss: 650310.2295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3254365.6597; val_optim_loss: 3254365.6597
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9931; val_auprc_score: 0.9913; val_best_acc_score: 0.9686; val_best_f1_score: 0.9690; train_kl_reg_loss: 11125.1943; train_edge_recon_loss: 2578992.9756; train_gene_expr_recon_loss: 647579.8574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3237698.0285; train_optim_loss: 3237698.0285; val_kl_reg_loss: 11194.7720; val_edge_recon_loss: 2590015.4398; val_gene_expr_recon_loss: 650820.0347; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3252030.2500; val_optim_loss: 3252030.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9936; val_auprc_score: 0.9920; val_best_acc_score: 0.9699; val_best_f1_score: 0.9703; train_kl_reg_loss: 11110.8109; train_edge_recon_loss: 2579211.6047; train_gene_expr_recon_loss: 647294.9566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3237617.3697; train_optim_loss: 3237617.3697; val_kl_reg_loss: 11056.3892; val_edge_recon_loss: 2592164.4803; val_gene_expr_recon_loss: 650337.9288; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3253558.7894; val_optim_loss: 3253558.7894
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9935; val_auprc_score: 0.9918; val_best_acc_score: 0.9702; val_best_f1_score: 0.9706; train_kl_reg_loss: 11073.9943; train_edge_recon_loss: 2578212.0323; train_gene_expr_recon_loss: 646689.6688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3235975.6939; train_optim_loss: 3235975.6939; val_kl_reg_loss: 10947.0901; val_edge_recon_loss: 2590500.2419; val_gene_expr_recon_loss: 650853.5995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3252300.9306; val_optim_loss: 3252300.9306
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9938; val_auprc_score: 0.9920; val_best_acc_score: 0.9715; val_best_f1_score: 0.9718; train_kl_reg_loss: 11046.2235; train_edge_recon_loss: 2577529.7361; train_gene_expr_recon_loss: 646766.2880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3235342.2504; train_optim_loss: 3235342.2504; val_kl_reg_loss: 10766.0516; val_edge_recon_loss: 2588890.0463; val_gene_expr_recon_loss: 650793.4384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3250449.5428; val_optim_loss: 3250449.5428
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9939; val_auprc_score: 0.9922; val_best_acc_score: 0.9722; val_best_f1_score: 0.9725; train_kl_reg_loss: 11023.8894; train_edge_recon_loss: 2576558.1831; train_gene_expr_recon_loss: 646787.2974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3234369.3736; train_optim_loss: 3234369.3736; val_kl_reg_loss: 10693.2021; val_edge_recon_loss: 2585778.5694; val_gene_expr_recon_loss: 649501.0822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3245972.8669; val_optim_loss: 3245972.8669
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9939; val_auprc_score: 0.9920; val_best_acc_score: 0.9715; val_best_f1_score: 0.9718; train_kl_reg_loss: 11006.5018; train_edge_recon_loss: 2576736.6953; train_gene_expr_recon_loss: 646456.3921; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3234199.5883; train_optim_loss: 3234199.5883; val_kl_reg_loss: 10992.4590; val_edge_recon_loss: 2588051.9491; val_gene_expr_recon_loss: 650234.8383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3249279.2465; val_optim_loss: 3249279.2465
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9937; val_auprc_score: 0.9920; val_best_acc_score: 0.9711; val_best_f1_score: 0.9714; train_kl_reg_loss: 10993.5818; train_edge_recon_loss: 2576352.6267; train_gene_expr_recon_loss: 646227.4899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3233573.6946; train_optim_loss: 3233573.6946; val_kl_reg_loss: 11083.3748; val_edge_recon_loss: 2586707.2998; val_gene_expr_recon_loss: 649643.1299; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3247433.8044; val_optim_loss: 3247433.8044
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9941; val_auprc_score: 0.9925; val_best_acc_score: 0.9724; val_best_f1_score: 0.9728; train_kl_reg_loss: 10988.8423; train_edge_recon_loss: 2576601.4618; train_gene_expr_recon_loss: 645946.4018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3233536.7073; train_optim_loss: 3233536.7073; val_kl_reg_loss: 10810.6998; val_edge_recon_loss: 2583534.5185; val_gene_expr_recon_loss: 650665.7086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3245010.9271; val_optim_loss: 3245010.9271
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9938; val_auprc_score: 0.9922; val_best_acc_score: 0.9719; val_best_f1_score: 0.9723; train_kl_reg_loss: 10971.6193; train_edge_recon_loss: 2575526.9812; train_gene_expr_recon_loss: 646057.6568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3232556.2595; train_optim_loss: 3232556.2595; val_kl_reg_loss: 10853.5179; val_edge_recon_loss: 2587098.9062; val_gene_expr_recon_loss: 649488.0064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3247440.4340; val_optim_loss: 3247440.4340
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9942; val_auprc_score: 0.9927; val_best_acc_score: 0.9723; val_best_f1_score: 0.9727; train_kl_reg_loss: 10940.3530; train_edge_recon_loss: 2576062.4062; train_gene_expr_recon_loss: 645983.9809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3232986.7401; train_optim_loss: 3232986.7401; val_kl_reg_loss: 10719.7617; val_edge_recon_loss: 2585758.2407; val_gene_expr_recon_loss: 650014.0663; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3246492.0637; val_optim_loss: 3246492.0637
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9945; val_auprc_score: 0.9930; val_best_acc_score: 0.9731; val_best_f1_score: 0.9734; train_kl_reg_loss: 10915.9054; train_edge_recon_loss: 2575538.6097; train_gene_expr_recon_loss: 646045.8218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3232500.3377; train_optim_loss: 3232500.3377; val_kl_reg_loss: 10551.8637; val_edge_recon_loss: 2585635.6887; val_gene_expr_recon_loss: 649620.8368; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3245808.3900; val_optim_loss: 3245808.3900
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9941; val_auprc_score: 0.9923; val_best_acc_score: 0.9728; val_best_f1_score: 0.9731; train_kl_reg_loss: 10930.1403; train_edge_recon_loss: 2574599.9570; train_gene_expr_recon_loss: 645491.7079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3231021.8034; train_optim_loss: 3231021.8034; val_kl_reg_loss: 10832.8774; val_edge_recon_loss: 2585038.9144; val_gene_expr_recon_loss: 649290.8817; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3245162.6725; val_optim_loss: 3245162.6725

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9945; val_auprc_score: 0.9928; val_best_acc_score: 0.9736; val_best_f1_score: 0.9740; train_kl_reg_loss: 11250.1781; train_edge_recon_loss: 2572795.9277; train_gene_expr_recon_loss: 640289.4403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3224335.5458; train_optim_loss: 3224335.5458; val_kl_reg_loss: 11276.7420; val_edge_recon_loss: 2582797.3912; val_gene_expr_recon_loss: 645995.1204; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3240069.2593; val_optim_loss: 3240069.2593
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9943; val_auprc_score: 0.9927; val_best_acc_score: 0.9739; val_best_f1_score: 0.9742; train_kl_reg_loss: 11349.3502; train_edge_recon_loss: 2572613.5976; train_gene_expr_recon_loss: 639822.4267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3223785.3740; train_optim_loss: 3223785.3740; val_kl_reg_loss: 11276.5157; val_edge_recon_loss: 2582021.0799; val_gene_expr_recon_loss: 644448.2063; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237745.8044; val_optim_loss: 3237745.8044
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9946; val_auprc_score: 0.9932; val_best_acc_score: 0.9740; val_best_f1_score: 0.9743; train_kl_reg_loss: 11352.9077; train_edge_recon_loss: 2572745.8552; train_gene_expr_recon_loss: 639229.2638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3223328.0310; train_optim_loss: 3223328.0310; val_kl_reg_loss: 11153.5635; val_edge_recon_loss: 2581597.0208; val_gene_expr_recon_loss: 645584.9742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3238335.5590; val_optim_loss: 3238335.5590
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9943; val_auprc_score: 0.9928; val_best_acc_score: 0.9737; val_best_f1_score: 0.9740; train_kl_reg_loss: 11340.1222; train_edge_recon_loss: 2572411.1802; train_gene_expr_recon_loss: 639124.0436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3222875.3479; train_optim_loss: 3222875.3479; val_kl_reg_loss: 11193.6379; val_edge_recon_loss: 2582806.0127; val_gene_expr_recon_loss: 645011.8976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3239011.5440; val_optim_loss: 3239011.5440
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9948; val_auprc_score: 0.9934; val_best_acc_score: 0.9748; val_best_f1_score: 0.9751; train_kl_reg_loss: 11358.9285; train_edge_recon_loss: 2571523.8902; train_gene_expr_recon_loss: 639099.4944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3221982.3115; train_optim_loss: 3221982.3115; val_kl_reg_loss: 11278.2723; val_edge_recon_loss: 2579945.8380; val_gene_expr_recon_loss: 645027.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3236252.0590; val_optim_loss: 3236252.0590
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9945; val_auprc_score: 0.9929; val_best_acc_score: 0.9747; val_best_f1_score: 0.9750; train_kl_reg_loss: 11328.0956; train_edge_recon_loss: 2572104.5220; train_gene_expr_recon_loss: 638782.1858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3222214.8041; train_optim_loss: 3222214.8041; val_kl_reg_loss: 11227.6696; val_edge_recon_loss: 2580025.4757; val_gene_expr_recon_loss: 644292.4225; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3235545.5637; val_optim_loss: 3235545.5637
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9948; val_auprc_score: 0.9935; val_best_acc_score: 0.9750; val_best_f1_score: 0.9752; train_kl_reg_loss: 11345.2723; train_edge_recon_loss: 2571646.7230; train_gene_expr_recon_loss: 638927.2666; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3221919.2629; train_optim_loss: 3221919.2629; val_kl_reg_loss: 11249.3986; val_edge_recon_loss: 2580774.3391; val_gene_expr_recon_loss: 644902.3440; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3236926.0880; val_optim_loss: 3236926.0880
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9948; val_auprc_score: 0.9935; val_best_acc_score: 0.9747; val_best_f1_score: 0.9750; train_kl_reg_loss: 11337.2817; train_edge_recon_loss: 2571658.2469; train_gene_expr_recon_loss: 638618.9565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3221614.4853; train_optim_loss: 3221614.4853; val_kl_reg_loss: 11205.3469; val_edge_recon_loss: 2579871.5498; val_gene_expr_recon_loss: 642949.6221; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3234026.5208; val_optim_loss: 3234026.5208
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9948; val_auprc_score: 0.9931; val_best_acc_score: 0.9745; val_best_f1_score: 0.9749; train_kl_reg_loss: 11315.3043; train_edge_recon_loss: 2571616.1251; train_gene_expr_recon_loss: 638875.0037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3221806.4367; train_optim_loss: 3221806.4367; val_kl_reg_loss: 11140.6308; val_edge_recon_loss: 2579616.7859; val_gene_expr_recon_loss: 643798.6884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3234556.1123; val_optim_loss: 3234556.1123
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9945; val_auprc_score: 0.9930; val_best_acc_score: 0.9746; val_best_f1_score: 0.9749; train_kl_reg_loss: 11311.5560; train_edge_recon_loss: 2571360.9707; train_gene_expr_recon_loss: 638927.0860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3221599.6093; train_optim_loss: 3221599.6093; val_kl_reg_loss: 11166.5658; val_edge_recon_loss: 2579829.5741; val_gene_expr_recon_loss: 644023.6192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3235019.7616; val_optim_loss: 3235019.7616
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9946; val_auprc_score: 0.9930; val_best_acc_score: 0.9740; val_best_f1_score: 0.9744; train_kl_reg_loss: 11285.2350; train_edge_recon_loss: 2571588.3413; train_gene_expr_recon_loss: 638713.0600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3221586.6355; train_optim_loss: 3221586.6355; val_kl_reg_loss: 11135.0461; val_edge_recon_loss: 2582602.8461; val_gene_expr_recon_loss: 644663.8232; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3238401.7095; val_optim_loss: 3238401.7095
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9946; val_auprc_score: 0.9931; val_best_acc_score: 0.9746; val_best_f1_score: 0.9750; train_kl_reg_loss: 11328.6789; train_edge_recon_loss: 2571575.9203; train_gene_expr_recon_loss: 638554.4415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3221459.0399; train_optim_loss: 3221459.0399; val_kl_reg_loss: 11205.0415; val_edge_recon_loss: 2578480.7407; val_gene_expr_recon_loss: 642742.5845; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3232428.3727; val_optim_loss: 3232428.3727
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9945; val_auprc_score: 0.9930; val_best_acc_score: 0.9745; val_best_f1_score: 0.9748; train_kl_reg_loss: 11310.1516; train_edge_recon_loss: 2571011.9398; train_gene_expr_recon_loss: 638460.3185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3220782.4110; train_optim_loss: 3220782.4110; val_kl_reg_loss: 11135.9808; val_edge_recon_loss: 2582507.0590; val_gene_expr_recon_loss: 644418.5723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3238061.6192; val_optim_loss: 3238061.6192
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9944; val_auprc_score: 0.9929; val_best_acc_score: 0.9743; val_best_f1_score: 0.9747; train_kl_reg_loss: 11296.6393; train_edge_recon_loss: 2571794.5331; train_gene_expr_recon_loss: 638274.2469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3221365.4203; train_optim_loss: 3221365.4203; val_kl_reg_loss: 11114.1501; val_edge_recon_loss: 2582115.0012; val_gene_expr_recon_loss: 644333.8345; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237562.9780; val_optim_loss: 3237562.9780
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9949; val_auprc_score: 0.9935; val_best_acc_score: 0.9749; val_best_f1_score: 0.9753; train_kl_reg_loss: 11283.3445; train_edge_recon_loss: 2571433.5042; train_gene_expr_recon_loss: 638280.2441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3220997.0913; train_optim_loss: 3220997.0913; val_kl_reg_loss: 11107.3913; val_edge_recon_loss: 2580777.8356; val_gene_expr_recon_loss: 644020.4876; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3235905.7153; val_optim_loss: 3235905.7153
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9947; val_auprc_score: 0.9931; val_best_acc_score: 0.9749; val_best_f1_score: 0.9752; train_kl_reg_loss: 11282.0371; train_edge_recon_loss: 2571329.1287; train_gene_expr_recon_loss: 638556.6695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3221167.8362; train_optim_loss: 3221167.8362; val_kl_reg_loss: 11169.7939; val_edge_recon_loss: 2580042.4931; val_gene_expr_recon_loss: 643295.2567; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3234507.5486; val_optim_loss: 3234507.5486

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9947; val_auprc_score: 0.9932; val_best_acc_score: 0.9748; val_best_f1_score: 0.9751; train_kl_reg_loss: 11299.6399; train_edge_recon_loss: 2571321.8565; train_gene_expr_recon_loss: 637660.5192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3220282.0177; train_optim_loss: 3220282.0177; val_kl_reg_loss: 11161.2678; val_edge_recon_loss: 2581891.1007; val_gene_expr_recon_loss: 643721.6453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3236774.0023; val_optim_loss: 3236774.0023
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9947; val_auprc_score: 0.9934; val_best_acc_score: 0.9745; val_best_f1_score: 0.9749; train_kl_reg_loss: 11295.5552; train_edge_recon_loss: 2571051.5891; train_gene_expr_recon_loss: 637713.7047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3220060.8499; train_optim_loss: 3220060.8499; val_kl_reg_loss: 11174.5633; val_edge_recon_loss: 2581580.8866; val_gene_expr_recon_loss: 642739.9444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3235495.3924; val_optim_loss: 3235495.3924
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9947; val_auprc_score: 0.9932; val_best_acc_score: 0.9751; val_best_f1_score: 0.9754; train_kl_reg_loss: 11301.7753; train_edge_recon_loss: 2570935.6624; train_gene_expr_recon_loss: 637484.2593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3219721.6956; train_optim_loss: 3219721.6956; val_kl_reg_loss: 11185.1570; val_edge_recon_loss: 2579043.4074; val_gene_expr_recon_loss: 642912.7810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3233141.3553; val_optim_loss: 3233141.3553
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9948; val_auprc_score: 0.9932; val_best_acc_score: 0.9752; val_best_f1_score: 0.9755; train_kl_reg_loss: 11317.7213; train_edge_recon_loss: 2571281.8246; train_gene_expr_recon_loss: 637058.1586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3219657.7038; train_optim_loss: 3219657.7038; val_kl_reg_loss: 11204.3392; val_edge_recon_loss: 2580183.0081; val_gene_expr_recon_loss: 643057.1962; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3234444.5567; val_optim_loss: 3234444.5567

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 541 min 24 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
Val AUROC score: 0.9945
Val AUPRC score: 0.9928
Val best accuracy score: 0.9748
Val best F1 score: 0.9752
Val gene expr MSE score: 1.5498

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
