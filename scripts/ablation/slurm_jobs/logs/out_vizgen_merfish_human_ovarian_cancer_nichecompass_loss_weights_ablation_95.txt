None
Run timestamp: 18072023_032309_95.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_95']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9781; val_auprc_score: 0.9779; val_best_acc_score: 0.9242; val_best_f1_score: 0.9246; train_kl_reg_loss: 73679.5028; train_edge_recon_loss: 2858190.0912; train_gene_expr_recon_loss: 13785782.2894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16717651.8836; train_optim_loss: 16717651.8836; val_kl_reg_loss: 58129.0660; val_edge_recon_loss: 2722156.2271; val_gene_expr_recon_loss: 13112764.9873; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15893050.2785; val_optim_loss: 15893050.2785
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9869; val_auprc_score: 0.9868; val_best_acc_score: 0.9416; val_best_f1_score: 0.9419; train_kl_reg_loss: 51182.6998; train_edge_recon_loss: 2679012.7791; train_gene_expr_recon_loss: 12901613.6888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15631809.1632; train_optim_loss: 15631809.1632; val_kl_reg_loss: 45309.5390; val_edge_recon_loss: 2679894.7975; val_gene_expr_recon_loss: 12876476.1044; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15601680.4810; val_optim_loss: 15601680.4810
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9901; val_auprc_score: 0.9899; val_best_acc_score: 0.9502; val_best_f1_score: 0.9505; train_kl_reg_loss: 43458.2042; train_edge_recon_loss: 2658597.9155; train_gene_expr_recon_loss: 12744746.7683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15446802.8885; train_optim_loss: 15446802.8885; val_kl_reg_loss: 40953.8865; val_edge_recon_loss: 2665168.5095; val_gene_expr_recon_loss: 12751391.1487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15457513.5443; val_optim_loss: 15457513.5443
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9912; val_auprc_score: 0.9909; val_best_acc_score: 0.9539; val_best_f1_score: 0.9540; train_kl_reg_loss: 40004.1800; train_edge_recon_loss: 2647147.6973; train_gene_expr_recon_loss: 12674009.8977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15361161.7753; train_optim_loss: 15361161.7753; val_kl_reg_loss: 38525.3851; val_edge_recon_loss: 2658151.3995; val_gene_expr_recon_loss: 12712412.9019; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15409089.6741; val_optim_loss: 15409089.6741
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9925; val_auprc_score: 0.9922; val_best_acc_score: 0.9574; val_best_f1_score: 0.9575; train_kl_reg_loss: 38278.5261; train_edge_recon_loss: 2641226.5189; train_gene_expr_recon_loss: 12624305.3695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15303810.4146; train_optim_loss: 15303810.4146; val_kl_reg_loss: 36260.4991; val_edge_recon_loss: 2649321.4984; val_gene_expr_recon_loss: 12681747.4082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15367329.3892; val_optim_loss: 15367329.3892
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9927; val_auprc_score: 0.9924; val_best_acc_score: 0.9579; val_best_f1_score: 0.9580; train_kl_reg_loss: 37219.0791; train_edge_recon_loss: 2636514.4180; train_gene_expr_recon_loss: 12591078.4515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15264811.9413; train_optim_loss: 15264811.9413; val_kl_reg_loss: 36789.3440; val_edge_recon_loss: 2649554.5222; val_gene_expr_recon_loss: 12663875.9652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15350219.8196; val_optim_loss: 15350219.8196
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9931; val_auprc_score: 0.9929; val_best_acc_score: 0.9593; val_best_f1_score: 0.9593; train_kl_reg_loss: 36327.9679; train_edge_recon_loss: 2634153.4666; train_gene_expr_recon_loss: 12565608.6241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15236090.0658; train_optim_loss: 15236090.0658; val_kl_reg_loss: 35374.7168; val_edge_recon_loss: 2645146.8536; val_gene_expr_recon_loss: 12627771.7089; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15308293.3165; val_optim_loss: 15308293.3165
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9934; val_auprc_score: 0.9932; val_best_acc_score: 0.9611; val_best_f1_score: 0.9613; train_kl_reg_loss: 35729.2059; train_edge_recon_loss: 2631439.4260; train_gene_expr_recon_loss: 12546255.3393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15213423.9771; train_optim_loss: 15213423.9771; val_kl_reg_loss: 34676.3073; val_edge_recon_loss: 2645473.3370; val_gene_expr_recon_loss: 12641702.3797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15321852.0253; val_optim_loss: 15321852.0253
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9939; val_auprc_score: 0.9936; val_best_acc_score: 0.9628; val_best_f1_score: 0.9629; train_kl_reg_loss: 35224.5824; train_edge_recon_loss: 2629559.6975; train_gene_expr_recon_loss: 12532470.9831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15197255.2556; train_optim_loss: 15197255.2556; val_kl_reg_loss: 34393.4207; val_edge_recon_loss: 2641420.7579; val_gene_expr_recon_loss: 12638866.4430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15314680.5981; val_optim_loss: 15314680.5981
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9940; val_auprc_score: 0.9937; val_best_acc_score: 0.9628; val_best_f1_score: 0.9629; train_kl_reg_loss: 34739.4159; train_edge_recon_loss: 2627821.5598; train_gene_expr_recon_loss: 12520772.4578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15183333.4476; train_optim_loss: 15183333.4476; val_kl_reg_loss: 34147.9814; val_edge_recon_loss: 2641257.7650; val_gene_expr_recon_loss: 12619432.3766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15294838.1456; val_optim_loss: 15294838.1456
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9943; val_auprc_score: 0.9941; val_best_acc_score: 0.9643; val_best_f1_score: 0.9644; train_kl_reg_loss: 34330.7001; train_edge_recon_loss: 2626112.5375; train_gene_expr_recon_loss: 12516517.7071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15176960.9459; train_optim_loss: 15176960.9459; val_kl_reg_loss: 33322.0245; val_edge_recon_loss: 2635581.4478; val_gene_expr_recon_loss: 12628622.6044; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15297526.0886; val_optim_loss: 15297526.0886
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9946; val_auprc_score: 0.9942; val_best_acc_score: 0.9653; val_best_f1_score: 0.9654; train_kl_reg_loss: 33884.2612; train_edge_recon_loss: 2624319.8616; train_gene_expr_recon_loss: 12506369.2707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15164573.4008; train_optim_loss: 15164573.4008; val_kl_reg_loss: 33100.2989; val_edge_recon_loss: 2639299.4153; val_gene_expr_recon_loss: 12610271.9715; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15282671.6677; val_optim_loss: 15282671.6677
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9945; val_auprc_score: 0.9941; val_best_acc_score: 0.9648; val_best_f1_score: 0.9649; train_kl_reg_loss: 33668.0613; train_edge_recon_loss: 2623477.3215; train_gene_expr_recon_loss: 12498933.9764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15156079.3625; train_optim_loss: 15156079.3625; val_kl_reg_loss: 33677.7074; val_edge_recon_loss: 2636592.8790; val_gene_expr_recon_loss: 12622279.8924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15292550.4494; val_optim_loss: 15292550.4494
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9947; val_auprc_score: 0.9944; val_best_acc_score: 0.9653; val_best_f1_score: 0.9653; train_kl_reg_loss: 33401.1880; train_edge_recon_loss: 2622890.8885; train_gene_expr_recon_loss: 12490490.5601; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15146782.6326; train_optim_loss: 15146782.6326; val_kl_reg_loss: 32815.5744; val_edge_recon_loss: 2634863.2247; val_gene_expr_recon_loss: 12624540.5570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15292219.3449; val_optim_loss: 15292219.3449
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9949; val_auprc_score: 0.9947; val_best_acc_score: 0.9660; val_best_f1_score: 0.9660; train_kl_reg_loss: 33190.2937; train_edge_recon_loss: 2621354.5419; train_gene_expr_recon_loss: 12488118.4451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15142663.2831; train_optim_loss: 15142663.2831; val_kl_reg_loss: 32631.8191; val_edge_recon_loss: 2632691.4375; val_gene_expr_recon_loss: 12616696.7722; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15282020.0601; val_optim_loss: 15282020.0601
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9951; val_auprc_score: 0.9948; val_best_acc_score: 0.9667; val_best_f1_score: 0.9668; train_kl_reg_loss: 33041.6053; train_edge_recon_loss: 2620155.0733; train_gene_expr_recon_loss: 12481119.1378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15134315.8200; train_optim_loss: 15134315.8200; val_kl_reg_loss: 32058.6796; val_edge_recon_loss: 2635538.9201; val_gene_expr_recon_loss: 12619304.5918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15286902.1835; val_optim_loss: 15286902.1835
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9949; val_auprc_score: 0.9947; val_best_acc_score: 0.9664; val_best_f1_score: 0.9664; train_kl_reg_loss: 32859.7000; train_edge_recon_loss: 2620021.4586; train_gene_expr_recon_loss: 12480077.3506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15132958.5042; train_optim_loss: 15132958.5042; val_kl_reg_loss: 32364.3767; val_edge_recon_loss: 2633593.9264; val_gene_expr_recon_loss: 12603056.5601; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15269014.8481; val_optim_loss: 15269014.8481
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9951; val_auprc_score: 0.9948; val_best_acc_score: 0.9666; val_best_f1_score: 0.9666; train_kl_reg_loss: 32750.6160; train_edge_recon_loss: 2619171.4276; train_gene_expr_recon_loss: 12480364.1406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15132286.1835; train_optim_loss: 15132286.1835; val_kl_reg_loss: 31752.1162; val_edge_recon_loss: 2631354.9644; val_gene_expr_recon_loss: 12605211.8165; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15268318.8481; val_optim_loss: 15268318.8481
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9950; val_auprc_score: 0.9947; val_best_acc_score: 0.9666; val_best_f1_score: 0.9668; train_kl_reg_loss: 32583.5586; train_edge_recon_loss: 2618322.6646; train_gene_expr_recon_loss: 12477441.4947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15128347.7243; train_optim_loss: 15128347.7243; val_kl_reg_loss: 31749.1740; val_edge_recon_loss: 2631856.9778; val_gene_expr_recon_loss: 12628844.3323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15292450.4810; val_optim_loss: 15292450.4810
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9951; val_auprc_score: 0.9948; val_best_acc_score: 0.9668; val_best_f1_score: 0.9670; train_kl_reg_loss: 32507.5478; train_edge_recon_loss: 2618587.5216; train_gene_expr_recon_loss: 12468404.1923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15119499.2641; train_optim_loss: 15119499.2641; val_kl_reg_loss: 31676.8315; val_edge_recon_loss: 2631366.8592; val_gene_expr_recon_loss: 12625469.8576; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15288513.5253; val_optim_loss: 15288513.5253
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9952; val_auprc_score: 0.9949; val_best_acc_score: 0.9672; val_best_f1_score: 0.9674; train_kl_reg_loss: 32347.2396; train_edge_recon_loss: 2618551.4360; train_gene_expr_recon_loss: 12466829.3681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15117728.0359; train_optim_loss: 15117728.0359; val_kl_reg_loss: 31340.0564; val_edge_recon_loss: 2631693.2682; val_gene_expr_recon_loss: 12609024.3418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15272057.6456; val_optim_loss: 15272057.6456
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9953; val_auprc_score: 0.9950; val_best_acc_score: 0.9676; val_best_f1_score: 0.9678; train_kl_reg_loss: 32262.2554; train_edge_recon_loss: 2617889.6508; train_gene_expr_recon_loss: 12466796.1579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15116948.0640; train_optim_loss: 15116948.0640; val_kl_reg_loss: 31469.7683; val_edge_recon_loss: 2629019.8149; val_gene_expr_recon_loss: 12599190.6108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15259680.2057; val_optim_loss: 15259680.2057
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9956; val_auprc_score: 0.9954; val_best_acc_score: 0.9688; val_best_f1_score: 0.9688; train_kl_reg_loss: 32145.2489; train_edge_recon_loss: 2617403.9742; train_gene_expr_recon_loss: 12462041.4859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15111590.6976; train_optim_loss: 15111590.6976; val_kl_reg_loss: 32177.6471; val_edge_recon_loss: 2629128.0949; val_gene_expr_recon_loss: 12599573.9968; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15260879.7500; val_optim_loss: 15260879.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9953; val_auprc_score: 0.9949; val_best_acc_score: 0.9674; val_best_f1_score: 0.9674; train_kl_reg_loss: 32044.8589; train_edge_recon_loss: 2615958.0223; train_gene_expr_recon_loss: 12459294.8421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15107297.7233; train_optim_loss: 15107297.7233; val_kl_reg_loss: 31461.5176; val_edge_recon_loss: 2629550.6954; val_gene_expr_recon_loss: 12616247.7468; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15277259.9494; val_optim_loss: 15277259.9494
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9953; val_auprc_score: 0.9949; val_best_acc_score: 0.9683; val_best_f1_score: 0.9684; train_kl_reg_loss: 31953.8402; train_edge_recon_loss: 2616571.4315; train_gene_expr_recon_loss: 12454121.7532; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15102647.0134; train_optim_loss: 15102647.0134; val_kl_reg_loss: 31194.3795; val_edge_recon_loss: 2632099.3188; val_gene_expr_recon_loss: 12601861.7658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15265155.4589; val_optim_loss: 15265155.4589
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9952; val_auprc_score: 0.9949; val_best_acc_score: 0.9672; val_best_f1_score: 0.9673; train_kl_reg_loss: 31844.5311; train_edge_recon_loss: 2615292.5717; train_gene_expr_recon_loss: 12455700.5665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15102837.6695; train_optim_loss: 15102837.6695; val_kl_reg_loss: 32108.0755; val_edge_recon_loss: 2629794.7081; val_gene_expr_recon_loss: 12614820.3829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15276723.1646; val_optim_loss: 15276723.1646

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9956; val_auprc_score: 0.9953; val_best_acc_score: 0.9690; val_best_f1_score: 0.9691; train_kl_reg_loss: 34505.1904; train_edge_recon_loss: 2613239.8956; train_gene_expr_recon_loss: 12352433.7947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15000178.8787; train_optim_loss: 15000178.8787; val_kl_reg_loss: 34340.2505; val_edge_recon_loss: 2625701.7998; val_gene_expr_recon_loss: 12531001.8038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15191043.8639; val_optim_loss: 15191043.8639
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9956; val_auprc_score: 0.9953; val_best_acc_score: 0.9689; val_best_f1_score: 0.9691; train_kl_reg_loss: 34932.2061; train_edge_recon_loss: 2613130.7351; train_gene_expr_recon_loss: 12344429.6505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14992492.5928; train_optim_loss: 14992492.5928; val_kl_reg_loss: 34691.9833; val_edge_recon_loss: 2626687.0427; val_gene_expr_recon_loss: 12519178.2342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15180557.2373; val_optim_loss: 15180557.2373
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9958; val_auprc_score: 0.9956; val_best_acc_score: 0.9695; val_best_f1_score: 0.9695; train_kl_reg_loss: 35091.5701; train_edge_recon_loss: 2611992.1208; train_gene_expr_recon_loss: 12338026.0759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14985109.7662; train_optim_loss: 14985109.7662; val_kl_reg_loss: 34613.2482; val_edge_recon_loss: 2623879.5214; val_gene_expr_recon_loss: 12529083.6646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15187576.4114; val_optim_loss: 15187576.4114
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9959; val_auprc_score: 0.9957; val_best_acc_score: 0.9697; val_best_f1_score: 0.9699; train_kl_reg_loss: 35127.5855; train_edge_recon_loss: 2611766.9030; train_gene_expr_recon_loss: 12338025.8586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14984920.3421; train_optim_loss: 14984920.3421; val_kl_reg_loss: 34608.8591; val_edge_recon_loss: 2626812.5214; val_gene_expr_recon_loss: 12521206.5475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15182627.9051; val_optim_loss: 15182627.9051
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9957; val_auprc_score: 0.9955; val_best_acc_score: 0.9696; val_best_f1_score: 0.9698; train_kl_reg_loss: 35068.9094; train_edge_recon_loss: 2611953.0349; train_gene_expr_recon_loss: 12336416.7992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14983438.7451; train_optim_loss: 14983438.7451; val_kl_reg_loss: 34487.9449; val_edge_recon_loss: 2625950.0538; val_gene_expr_recon_loss: 12513803.9715; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15174241.9778; val_optim_loss: 15174241.9778
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9958; val_auprc_score: 0.9955; val_best_acc_score: 0.9695; val_best_f1_score: 0.9696; train_kl_reg_loss: 34974.1077; train_edge_recon_loss: 2611943.9320; train_gene_expr_recon_loss: 12332342.3020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14979260.3309; train_optim_loss: 14979260.3309; val_kl_reg_loss: 34448.8699; val_edge_recon_loss: 2625259.1796; val_gene_expr_recon_loss: 12506340.7342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15166048.8228; val_optim_loss: 15166048.8228
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9957; val_auprc_score: 0.9954; val_best_acc_score: 0.9692; val_best_f1_score: 0.9693; train_kl_reg_loss: 34907.6172; train_edge_recon_loss: 2611943.4335; train_gene_expr_recon_loss: 12330782.4592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14977633.5098; train_optim_loss: 14977633.5098; val_kl_reg_loss: 34450.5229; val_edge_recon_loss: 2625830.3687; val_gene_expr_recon_loss: 12515779.1487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15176060.0285; val_optim_loss: 15176060.0285
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9958; val_auprc_score: 0.9956; val_best_acc_score: 0.9697; val_best_f1_score: 0.9699; train_kl_reg_loss: 34801.1486; train_edge_recon_loss: 2611727.9356; train_gene_expr_recon_loss: 12328113.1364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14974642.2212; train_optim_loss: 14974642.2212; val_kl_reg_loss: 34486.8419; val_edge_recon_loss: 2625492.6606; val_gene_expr_recon_loss: 12515837.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15175816.4747; val_optim_loss: 15175816.4747
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9958; val_auprc_score: 0.9955; val_best_acc_score: 0.9697; val_best_f1_score: 0.9699; train_kl_reg_loss: 34731.2287; train_edge_recon_loss: 2611526.0315; train_gene_expr_recon_loss: 12329905.4715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14976162.7293; train_optim_loss: 14976162.7293; val_kl_reg_loss: 34000.4551; val_edge_recon_loss: 2626377.3030; val_gene_expr_recon_loss: 12502915.5032; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15163293.2816; val_optim_loss: 15163293.2816
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9959; val_auprc_score: 0.9955; val_best_acc_score: 0.9703; val_best_f1_score: 0.9704; train_kl_reg_loss: 34644.1101; train_edge_recon_loss: 2612467.4306; train_gene_expr_recon_loss: 12323884.8073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14970996.3569; train_optim_loss: 14970996.3569; val_kl_reg_loss: 33990.8814; val_edge_recon_loss: 2625221.4873; val_gene_expr_recon_loss: 12506101.2437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15165313.6044; val_optim_loss: 15165313.6044
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9958; val_auprc_score: 0.9955; val_best_acc_score: 0.9699; val_best_f1_score: 0.9700; train_kl_reg_loss: 34639.2573; train_edge_recon_loss: 2611018.4754; train_gene_expr_recon_loss: 12327100.7335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14972758.4571; train_optim_loss: 14972758.4571; val_kl_reg_loss: 34224.0402; val_edge_recon_loss: 2626746.9517; val_gene_expr_recon_loss: 12511208.5886; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15172179.6108; val_optim_loss: 15172179.6108
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9959; val_auprc_score: 0.9955; val_best_acc_score: 0.9699; val_best_f1_score: 0.9700; train_kl_reg_loss: 34519.6047; train_edge_recon_loss: 2611836.9738; train_gene_expr_recon_loss: 12321822.4008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14968178.9712; train_optim_loss: 14968178.9712; val_kl_reg_loss: 34150.7976; val_edge_recon_loss: 2623557.5293; val_gene_expr_recon_loss: 12494421.9019; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15152130.2120; val_optim_loss: 15152130.2120
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9959; val_auprc_score: 0.9957; val_best_acc_score: 0.9699; val_best_f1_score: 0.9700; train_kl_reg_loss: 34409.4814; train_edge_recon_loss: 2612005.8182; train_gene_expr_recon_loss: 12327185.3833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14973600.6902; train_optim_loss: 14973600.6902; val_kl_reg_loss: 34169.4045; val_edge_recon_loss: 2625651.9066; val_gene_expr_recon_loss: 12514952.2785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15174773.5918; val_optim_loss: 15174773.5918
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9959; val_auprc_score: 0.9956; val_best_acc_score: 0.9702; val_best_f1_score: 0.9704; train_kl_reg_loss: 34384.9258; train_edge_recon_loss: 2611513.9856; train_gene_expr_recon_loss: 12320634.2032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14966533.1153; train_optim_loss: 14966533.1153; val_kl_reg_loss: 34128.2666; val_edge_recon_loss: 2626161.1669; val_gene_expr_recon_loss: 12500898.0981; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15161187.5190; val_optim_loss: 15161187.5190
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9959; val_auprc_score: 0.9957; val_best_acc_score: 0.9703; val_best_f1_score: 0.9704; train_kl_reg_loss: 34285.3738; train_edge_recon_loss: 2611049.6502; train_gene_expr_recon_loss: 12322019.6498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14967354.6832; train_optim_loss: 14967354.6832; val_kl_reg_loss: 33737.0704; val_edge_recon_loss: 2623785.0680; val_gene_expr_recon_loss: 12496956.2310; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15154478.3956; val_optim_loss: 15154478.3956
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9959; val_auprc_score: 0.9957; val_best_acc_score: 0.9704; val_best_f1_score: 0.9705; train_kl_reg_loss: 34177.5502; train_edge_recon_loss: 2611386.0965; train_gene_expr_recon_loss: 12318386.6058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14963950.2570; train_optim_loss: 14963950.2570; val_kl_reg_loss: 33600.8744; val_edge_recon_loss: 2625889.5902; val_gene_expr_recon_loss: 12499645.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15159135.6994; val_optim_loss: 15159135.6994

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9958; val_auprc_score: 0.9956; val_best_acc_score: 0.9700; val_best_f1_score: 0.9702; train_kl_reg_loss: 34357.2364; train_edge_recon_loss: 2610754.1392; train_gene_expr_recon_loss: 12308222.0703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14953333.4427; train_optim_loss: 14953333.4427; val_kl_reg_loss: 33943.9335; val_edge_recon_loss: 2625444.1709; val_gene_expr_recon_loss: 12495361.4810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15154749.5601; val_optim_loss: 15154749.5601
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9959; val_auprc_score: 0.9957; val_best_acc_score: 0.9704; val_best_f1_score: 0.9705; train_kl_reg_loss: 34442.8221; train_edge_recon_loss: 2611046.1677; train_gene_expr_recon_loss: 12305147.6663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14950636.6670; train_optim_loss: 14950636.6670; val_kl_reg_loss: 33944.1042; val_edge_recon_loss: 2625193.5253; val_gene_expr_recon_loss: 12496181.9842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15155319.5949; val_optim_loss: 15155319.5949
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9959; val_auprc_score: 0.9956; val_best_acc_score: 0.9703; val_best_f1_score: 0.9704; train_kl_reg_loss: 34455.6457; train_edge_recon_loss: 2611699.9508; train_gene_expr_recon_loss: 12303126.7317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14949282.3217; train_optim_loss: 14949282.3217; val_kl_reg_loss: 33985.7228; val_edge_recon_loss: 2625989.3544; val_gene_expr_recon_loss: 12494834.7278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15154809.8165; val_optim_loss: 15154809.8165
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9959; val_auprc_score: 0.9956; val_best_acc_score: 0.9702; val_best_f1_score: 0.9703; train_kl_reg_loss: 34477.2788; train_edge_recon_loss: 2610663.0026; train_gene_expr_recon_loss: 12303118.9047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14948259.1987; train_optim_loss: 14948259.1987; val_kl_reg_loss: 33938.7503; val_edge_recon_loss: 2624942.1369; val_gene_expr_recon_loss: 12487559.4652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15146440.3418; val_optim_loss: 15146440.3418
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9959; val_auprc_score: 0.9956; val_best_acc_score: 0.9701; val_best_f1_score: 0.9702; train_kl_reg_loss: 34477.6271; train_edge_recon_loss: 2611433.7874; train_gene_expr_recon_loss: 12302544.1705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14948455.5904; train_optim_loss: 14948455.5904; val_kl_reg_loss: 34021.9978; val_edge_recon_loss: 2624884.4628; val_gene_expr_recon_loss: 12500985.3513; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15159891.8165; val_optim_loss: 15159891.8165
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9959; val_auprc_score: 0.9957; val_best_acc_score: 0.9707; val_best_f1_score: 0.9708; train_kl_reg_loss: 34491.3794; train_edge_recon_loss: 2610826.6635; train_gene_expr_recon_loss: 12298214.9585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14943533.0000; train_optim_loss: 14943533.0000; val_kl_reg_loss: 33981.3589; val_edge_recon_loss: 2623746.7366; val_gene_expr_recon_loss: 12492386.4304; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15150114.5316; val_optim_loss: 15150114.5316
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9959; val_auprc_score: 0.9957; val_best_acc_score: 0.9702; val_best_f1_score: 0.9703; train_kl_reg_loss: 34494.3252; train_edge_recon_loss: 2610819.7177; train_gene_expr_recon_loss: 12298999.3418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14944313.3787; train_optim_loss: 14944313.3787; val_kl_reg_loss: 34011.2811; val_edge_recon_loss: 2626522.6361; val_gene_expr_recon_loss: 12485335.1646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15145869.0823; val_optim_loss: 15145869.0823
