None
Run timestamp: 14082023_220750_12.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_fc_layers_encoder', '1', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_group_lasso', '10.0', '--lambda_l1_masked', '0.0', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_12']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9903; val_auprc_score: 0.9872; val_best_acc_score: 0.9654; val_best_f1_score: 0.9661; train_kl_reg_loss: 7527.2697; train_edge_recon_loss: 263079.1757; train_gene_expr_recon_loss: 198727.2303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3661.8042; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 472995.4798; train_optim_loss: 472995.4798; val_kl_reg_loss: 7166.7279; val_edge_recon_loss: 259359.1808; val_gene_expr_recon_loss: 183705.4454; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4241.9111; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 454473.2609; val_optim_loss: 454473.2609
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9928; val_auprc_score: 0.9907; val_best_acc_score: 0.9702; val_best_f1_score: 0.9707; train_kl_reg_loss: 7075.5464; train_edge_recon_loss: 259338.4914; train_gene_expr_recon_loss: 181572.1466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4324.6099; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 452310.7943; train_optim_loss: 452310.7943; val_kl_reg_loss: 6890.0922; val_edge_recon_loss: 258442.9366; val_gene_expr_recon_loss: 179196.7715; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4282.4287; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 448812.2386; val_optim_loss: 448812.2386
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9948; val_auprc_score: 0.9933; val_best_acc_score: 0.9749; val_best_f1_score: 0.9752; train_kl_reg_loss: 6852.0405; train_edge_recon_loss: 258612.8223; train_gene_expr_recon_loss: 179033.1294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4199.5280; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 448697.5202; train_optim_loss: 448697.5202; val_kl_reg_loss: 6732.4303; val_edge_recon_loss: 257480.0753; val_gene_expr_recon_loss: 177837.8215; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4136.1846; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446186.5143; val_optim_loss: 446186.5143
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9955; val_auprc_score: 0.9942; val_best_acc_score: 0.9771; val_best_f1_score: 0.9774; train_kl_reg_loss: 6762.2376; train_edge_recon_loss: 258126.9338; train_gene_expr_recon_loss: 178410.6754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4080.4842; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 447380.3311; train_optim_loss: 447380.3311; val_kl_reg_loss: 6689.5591; val_edge_recon_loss: 257356.0996; val_gene_expr_recon_loss: 177487.5578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4035.2520; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445568.4664; val_optim_loss: 445568.4664
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9958; val_auprc_score: 0.9946; val_best_acc_score: 0.9789; val_best_f1_score: 0.9791; train_kl_reg_loss: 6703.2715; train_edge_recon_loss: 257854.1700; train_gene_expr_recon_loss: 178239.7307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3998.3729; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446795.5456; train_optim_loss: 446795.5456; val_kl_reg_loss: 6576.6142; val_edge_recon_loss: 256907.2538; val_gene_expr_recon_loss: 177580.3380; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3970.9670; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445035.1746; val_optim_loss: 445035.1746
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9961; val_auprc_score: 0.9948; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 6675.0840; train_edge_recon_loss: 257636.9492; train_gene_expr_recon_loss: 178028.5303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3968.4732; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446309.0368; train_optim_loss: 446309.0368; val_kl_reg_loss: 6559.9777; val_edge_recon_loss: 256794.9052; val_gene_expr_recon_loss: 177469.3057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3973.1543; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444797.3456; val_optim_loss: 444797.3456
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9964; val_auprc_score: 0.9953; val_best_acc_score: 0.9816; val_best_f1_score: 0.9818; train_kl_reg_loss: 6656.7870; train_edge_recon_loss: 257480.0070; train_gene_expr_recon_loss: 177931.0283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3975.5803; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446043.4026; train_optim_loss: 446043.4026; val_kl_reg_loss: 6563.5740; val_edge_recon_loss: 256651.3896; val_gene_expr_recon_loss: 177443.8675; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3981.5996; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444640.4243; val_optim_loss: 444640.4243
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9964; val_auprc_score: 0.9954; val_best_acc_score: 0.9823; val_best_f1_score: 0.9825; train_kl_reg_loss: 6642.3213; train_edge_recon_loss: 257427.5290; train_gene_expr_recon_loss: 177852.0360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3992.2781; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445914.1646; train_optim_loss: 445914.1646; val_kl_reg_loss: 6468.5322; val_edge_recon_loss: 256501.5666; val_gene_expr_recon_loss: 177128.0229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4010.0322; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444108.1538; val_optim_loss: 444108.1538
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9967; val_auprc_score: 0.9959; val_best_acc_score: 0.9823; val_best_f1_score: 0.9825; train_kl_reg_loss: 6641.5380; train_edge_recon_loss: 257280.8447; train_gene_expr_recon_loss: 177898.9197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4008.7191; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445830.0215; train_optim_loss: 445830.0215; val_kl_reg_loss: 6592.6720; val_edge_recon_loss: 256400.9233; val_gene_expr_recon_loss: 177344.4286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4013.6404; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444351.6483; val_optim_loss: 444351.6483
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9970; val_auprc_score: 0.9963; val_best_acc_score: 0.9829; val_best_f1_score: 0.9831; train_kl_reg_loss: 6633.4036; train_edge_recon_loss: 257153.3883; train_gene_expr_recon_loss: 177728.1863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4008.8592; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445523.8370; train_optim_loss: 445523.8370; val_kl_reg_loss: 6593.4662; val_edge_recon_loss: 256480.3025; val_gene_expr_recon_loss: 177660.3303; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4002.4150; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444736.5053; val_optim_loss: 444736.5053
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9968; val_auprc_score: 0.9958; val_best_acc_score: 0.9838; val_best_f1_score: 0.9840; train_kl_reg_loss: 6627.2586; train_edge_recon_loss: 257086.6292; train_gene_expr_recon_loss: 177623.2457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4020.6872; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445357.8207; train_optim_loss: 445357.8207; val_kl_reg_loss: 6592.2484; val_edge_recon_loss: 256324.9565; val_gene_expr_recon_loss: 177111.5138; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4035.2261; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444063.9366; val_optim_loss: 444063.9366
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9971; val_auprc_score: 0.9962; val_best_acc_score: 0.9849; val_best_f1_score: 0.9851; train_kl_reg_loss: 6627.7722; train_edge_recon_loss: 257061.2438; train_gene_expr_recon_loss: 177672.4603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4030.3487; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445391.8252; train_optim_loss: 445391.8252; val_kl_reg_loss: 6562.8023; val_edge_recon_loss: 256134.6793; val_gene_expr_recon_loss: 177457.6708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4031.6885; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444186.8396; val_optim_loss: 444186.8396
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9971; val_auprc_score: 0.9963; val_best_acc_score: 0.9841; val_best_f1_score: 0.9843; train_kl_reg_loss: 6624.4091; train_edge_recon_loss: 256954.0932; train_gene_expr_recon_loss: 177614.8968; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4030.3479; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445223.7469; train_optim_loss: 445223.7469; val_kl_reg_loss: 6594.4769; val_edge_recon_loss: 256070.3076; val_gene_expr_recon_loss: 177346.2727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4033.4470; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444044.4955; val_optim_loss: 444044.4955
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9974; val_auprc_score: 0.9968; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 6624.7777; train_edge_recon_loss: 256951.6508; train_gene_expr_recon_loss: 177350.6779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4037.8711; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444964.9778; train_optim_loss: 444964.9778; val_kl_reg_loss: 6564.8461; val_edge_recon_loss: 256046.9287; val_gene_expr_recon_loss: 176994.1978; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4027.7246; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443633.6916; val_optim_loss: 443633.6916
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9973; val_auprc_score: 0.9962; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 6621.9340; train_edge_recon_loss: 256885.1258; train_gene_expr_recon_loss: 177413.1781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4043.1892; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444963.4268; train_optim_loss: 444963.4268; val_kl_reg_loss: 6609.9260; val_edge_recon_loss: 256094.3011; val_gene_expr_recon_loss: 176560.6378; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4032.2019; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443297.0535; val_optim_loss: 443297.0535
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9973; val_auprc_score: 0.9965; val_best_acc_score: 0.9852; val_best_f1_score: 0.9853; train_kl_reg_loss: 6624.4360; train_edge_recon_loss: 256872.5691; train_gene_expr_recon_loss: 177494.4385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4042.8272; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445034.2708; train_optim_loss: 445034.2708; val_kl_reg_loss: 6574.0177; val_edge_recon_loss: 256123.1521; val_gene_expr_recon_loss: 177056.0699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4066.1099; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443819.3650; val_optim_loss: 443819.3650
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9974; val_auprc_score: 0.9966; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 6626.4218; train_edge_recon_loss: 256839.4032; train_gene_expr_recon_loss: 177368.5605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4046.1255; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444880.5112; train_optim_loss: 444880.5112; val_kl_reg_loss: 6622.9051; val_edge_recon_loss: 256008.6548; val_gene_expr_recon_loss: 176860.1211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4056.6113; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443548.3046; val_optim_loss: 443548.3046
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9974; val_auprc_score: 0.9968; val_best_acc_score: 0.9854; val_best_f1_score: 0.9856; train_kl_reg_loss: 6623.0351; train_edge_recon_loss: 256813.7415; train_gene_expr_recon_loss: 177328.1186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4049.8576; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444814.7529; train_optim_loss: 444814.7529; val_kl_reg_loss: 6585.5081; val_edge_recon_loss: 256174.1789; val_gene_expr_recon_loss: 176941.6417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4045.5796; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443746.9228; val_optim_loss: 443746.9228
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9976; val_auprc_score: 0.9968; val_best_acc_score: 0.9860; val_best_f1_score: 0.9862; train_kl_reg_loss: 6621.5035; train_edge_recon_loss: 256813.8499; train_gene_expr_recon_loss: 177381.2347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4055.6949; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444872.2825; train_optim_loss: 444872.2825; val_kl_reg_loss: 6591.6367; val_edge_recon_loss: 255834.0709; val_gene_expr_recon_loss: 177311.1418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4083.6597; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443820.5056; val_optim_loss: 443820.5056

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9977; val_auprc_score: 0.9969; val_best_acc_score: 0.9857; val_best_f1_score: 0.9859; train_kl_reg_loss: 6596.2832; train_edge_recon_loss: 256635.4321; train_gene_expr_recon_loss: 176998.6615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3879.1926; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444109.5695; train_optim_loss: 444109.5695; val_kl_reg_loss: 6585.3360; val_edge_recon_loss: 255929.8250; val_gene_expr_recon_loss: 176990.8550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3876.7507; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443382.7652; val_optim_loss: 443382.7652
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9977; val_auprc_score: 0.9969; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 6596.0404; train_edge_recon_loss: 256597.3204; train_gene_expr_recon_loss: 176982.2922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3875.0165; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444050.6694; train_optim_loss: 444050.6694; val_kl_reg_loss: 6586.1902; val_edge_recon_loss: 255781.5992; val_gene_expr_recon_loss: 176421.7916; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3876.5132; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442666.0812; val_optim_loss: 442666.0812
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9977; val_auprc_score: 0.9966; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 6589.5635; train_edge_recon_loss: 256595.9612; train_gene_expr_recon_loss: 176913.9770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3878.5982; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443978.1003; train_optim_loss: 443978.1003; val_kl_reg_loss: 6576.6417; val_edge_recon_loss: 255863.7941; val_gene_expr_recon_loss: 176511.5195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3879.0383; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442830.9862; val_optim_loss: 442830.9862
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9978; val_auprc_score: 0.9970; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 6588.7487; train_edge_recon_loss: 256480.5627; train_gene_expr_recon_loss: 176879.1258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3880.0347; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443828.4725; train_optim_loss: 443828.4725; val_kl_reg_loss: 6587.8734; val_edge_recon_loss: 255712.0881; val_gene_expr_recon_loss: 176810.3850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3882.1235; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442992.4717; val_optim_loss: 442992.4717
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9978; val_auprc_score: 0.9971; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 6585.6241; train_edge_recon_loss: 256611.0278; train_gene_expr_recon_loss: 176753.0269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3883.5118; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443833.1903; train_optim_loss: 443833.1903; val_kl_reg_loss: 6590.9071; val_edge_recon_loss: 255785.2699; val_gene_expr_recon_loss: 176560.2588; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3886.4268; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442822.8731; val_optim_loss: 442822.8731
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9978; val_auprc_score: 0.9971; val_best_acc_score: 0.9866; val_best_f1_score: 0.9867; train_kl_reg_loss: 6582.3438; train_edge_recon_loss: 256554.7914; train_gene_expr_recon_loss: 176818.9739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3888.9985; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443845.1070; train_optim_loss: 443845.1070; val_kl_reg_loss: 6571.3303; val_edge_recon_loss: 255513.8487; val_gene_expr_recon_loss: 176753.1946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3891.5845; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442729.9678; val_optim_loss: 442729.9678

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9980; val_auprc_score: 0.9975; val_best_acc_score: 0.9874; val_best_f1_score: 0.9875; train_kl_reg_loss: 6576.8114; train_edge_recon_loss: 256520.1853; train_gene_expr_recon_loss: 176807.7811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3872.6431; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443777.4210; train_optim_loss: 443777.4210; val_kl_reg_loss: 6572.2590; val_edge_recon_loss: 255503.4461; val_gene_expr_recon_loss: 176607.8040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3872.3882; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442555.8849; val_optim_loss: 442555.8849
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9979; val_auprc_score: 0.9971; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 6572.3095; train_edge_recon_loss: 256547.1695; train_gene_expr_recon_loss: 176855.7067; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3872.4766; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443847.6622; train_optim_loss: 443847.6622; val_kl_reg_loss: 6562.4673; val_edge_recon_loss: 255618.1662; val_gene_expr_recon_loss: 176410.6443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3872.4109; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442463.6854; val_optim_loss: 442463.6854
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9978; val_auprc_score: 0.9971; val_best_acc_score: 0.9872; val_best_f1_score: 0.9873; train_kl_reg_loss: 6575.0572; train_edge_recon_loss: 256507.6743; train_gene_expr_recon_loss: 176819.9734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3872.6838; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443775.3888; train_optim_loss: 443775.3888; val_kl_reg_loss: 6567.1180; val_edge_recon_loss: 255597.0444; val_gene_expr_recon_loss: 176380.7485; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3872.8140; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442417.7227; val_optim_loss: 442417.7227
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9978; val_auprc_score: 0.9973; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 6574.6851; train_edge_recon_loss: 256526.5156; train_gene_expr_recon_loss: 176905.9522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3873.0995; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443880.2523; train_optim_loss: 443880.2523; val_kl_reg_loss: 6564.9241; val_edge_recon_loss: 255637.0939; val_gene_expr_recon_loss: 176980.4397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3872.8518; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443055.3012; val_optim_loss: 443055.3012
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9979; val_auprc_score: 0.9972; val_best_acc_score: 0.9872; val_best_f1_score: 0.9873; train_kl_reg_loss: 6574.8375; train_edge_recon_loss: 256531.4254; train_gene_expr_recon_loss: 176769.1632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3873.3603; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443748.7862; train_optim_loss: 443748.7862; val_kl_reg_loss: 6565.0277; val_edge_recon_loss: 255578.0362; val_gene_expr_recon_loss: 176188.5699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3873.3643; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442205.0094; val_optim_loss: 442205.0094
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9978; val_auprc_score: 0.9969; val_best_acc_score: 0.9868; val_best_f1_score: 0.9869; train_kl_reg_loss: 6576.3712; train_edge_recon_loss: 256447.9143; train_gene_expr_recon_loss: 176868.8641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3873.6588; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443766.8089; train_optim_loss: 443766.8089; val_kl_reg_loss: 6553.1626; val_edge_recon_loss: 255797.3413; val_gene_expr_recon_loss: 176054.3734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3873.4690; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442278.3452; val_optim_loss: 442278.3452
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9978; val_auprc_score: 0.9969; val_best_acc_score: 0.9868; val_best_f1_score: 0.9869; train_kl_reg_loss: 6573.8387; train_edge_recon_loss: 256440.8663; train_gene_expr_recon_loss: 176656.1176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3874.0541; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443544.8770; train_optim_loss: 443544.8770; val_kl_reg_loss: 6562.8107; val_edge_recon_loss: 255623.5287; val_gene_expr_recon_loss: 176332.2296; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3874.1785; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442392.7560; val_optim_loss: 442392.7560
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9980; val_auprc_score: 0.9975; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 6574.9345; train_edge_recon_loss: 256540.6298; train_gene_expr_recon_loss: 176773.9226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3874.5110; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443763.9976; train_optim_loss: 443763.9976; val_kl_reg_loss: 6567.8854; val_edge_recon_loss: 255660.1471; val_gene_expr_recon_loss: 176931.0953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3874.8555; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443033.9711; val_optim_loss: 443033.9711
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9978; val_auprc_score: 0.9974; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 6572.7923; train_edge_recon_loss: 256584.5963; train_gene_expr_recon_loss: 176857.2396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3875.0575; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443889.6855; train_optim_loss: 443889.6855; val_kl_reg_loss: 6552.3536; val_edge_recon_loss: 255625.0962; val_gene_expr_recon_loss: 176592.1300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3875.5081; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442645.0795; val_optim_loss: 442645.0795

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9979; val_auprc_score: 0.9973; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 6569.6859; train_edge_recon_loss: 256517.8723; train_gene_expr_recon_loss: 176832.9338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3873.8158; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443794.3079; train_optim_loss: 443794.3079; val_kl_reg_loss: 6560.2475; val_edge_recon_loss: 255519.4838; val_gene_expr_recon_loss: 176517.8459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3873.8025; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442471.3901; val_optim_loss: 442471.3901
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 6572.2872; train_edge_recon_loss: 256574.5808; train_gene_expr_recon_loss: 176699.0095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3873.8172; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443719.6943; train_optim_loss: 443719.6943; val_kl_reg_loss: 6560.1110; val_edge_recon_loss: 255604.8021; val_gene_expr_recon_loss: 176410.2758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3873.8586; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442449.0329; val_optim_loss: 442449.0329
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9978; val_auprc_score: 0.9972; val_best_acc_score: 0.9866; val_best_f1_score: 0.9867; train_kl_reg_loss: 6571.3505; train_edge_recon_loss: 256433.3946; train_gene_expr_recon_loss: 176856.2529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3873.9024; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443734.9010; train_optim_loss: 443734.9010; val_kl_reg_loss: 6562.0560; val_edge_recon_loss: 255559.4176; val_gene_expr_recon_loss: 176394.4533; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3873.9309; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442389.8645; val_optim_loss: 442389.8645
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9979; val_auprc_score: 0.9973; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 6574.1056; train_edge_recon_loss: 256503.4558; train_gene_expr_recon_loss: 176769.4699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3873.9514; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443720.9823; train_optim_loss: 443720.9823; val_kl_reg_loss: 6560.9556; val_edge_recon_loss: 255723.0773; val_gene_expr_recon_loss: 176424.5896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3873.9614; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442582.5906; val_optim_loss: 442582.5906

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 258 min 56 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
val AUROC score: 0.9980
val AUPRC score: 0.9973
val best accuracy score: 0.9868
val best F1 score: 0.9869
val target rna MSE score: 0.6193
val source rna MSE score: 0.0597

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
