None
Run timestamp: 20072023_111643_12.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '2', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '30000.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_12']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 2, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9900; val_auprc_score: 0.9884; val_best_acc_score: 0.9545; val_best_f1_score: 0.9555; train_kl_reg_loss: 102215.6867; train_edge_recon_loss: 26344811.5240; train_gene_expr_recon_loss: 10985467.8681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37432495.0647; train_optim_loss: 37432495.0647; val_kl_reg_loss: 82178.4883; val_edge_recon_loss: 25863294.7125; val_gene_expr_recon_loss: 10290318.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36235791.5625; val_optim_loss: 36235791.5625
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9934; val_auprc_score: 0.9918; val_best_acc_score: 0.9684; val_best_f1_score: 0.9689; train_kl_reg_loss: 68593.5109; train_edge_recon_loss: 25729854.9415; train_gene_expr_recon_loss: 10191384.4661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35989832.9158; train_optim_loss: 35989832.9158; val_kl_reg_loss: 60815.7174; val_edge_recon_loss: 25713357.9750; val_gene_expr_recon_loss: 10036591.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35810765.0000; val_optim_loss: 35810765.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9946; val_auprc_score: 0.9937; val_best_acc_score: 0.9714; val_best_f1_score: 0.9719; train_kl_reg_loss: 56675.0800; train_edge_recon_loss: 25620777.2707; train_gene_expr_recon_loss: 10025880.3020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35703332.6618; train_optim_loss: 35703332.6618; val_kl_reg_loss: 52954.5900; val_edge_recon_loss: 25641313.8750; val_gene_expr_recon_loss: 9962072.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35656340.6437; val_optim_loss: 35656340.6437
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9958; val_auprc_score: 0.9948; val_best_acc_score: 0.9758; val_best_f1_score: 0.9761; train_kl_reg_loss: 49790.3791; train_edge_recon_loss: 25572377.3660; train_gene_expr_recon_loss: 9956012.1150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35578179.8253; train_optim_loss: 35578179.8253; val_kl_reg_loss: 45102.1873; val_edge_recon_loss: 25570760.1938; val_gene_expr_recon_loss: 9908998.6188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35524860.9125; val_optim_loss: 35524860.9125
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9958; val_auprc_score: 0.9946; val_best_acc_score: 0.9775; val_best_f1_score: 0.9777; train_kl_reg_loss: 45297.6268; train_edge_recon_loss: 25544919.1677; train_gene_expr_recon_loss: 9919717.7818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35509934.5804; train_optim_loss: 35509934.5804; val_kl_reg_loss: 43128.7946; val_edge_recon_loss: 25544632.5375; val_gene_expr_recon_loss: 9888060.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35475822.2375; val_optim_loss: 35475822.2375
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9964; val_auprc_score: 0.9958; val_best_acc_score: 0.9791; val_best_f1_score: 0.9794; train_kl_reg_loss: 42478.8263; train_edge_recon_loss: 25523582.8392; train_gene_expr_recon_loss: 9883405.9929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35449467.6743; train_optim_loss: 35449467.6743; val_kl_reg_loss: 40766.2824; val_edge_recon_loss: 25542706.3875; val_gene_expr_recon_loss: 9838692.5297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35422165.2000; val_optim_loss: 35422165.2000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9963; val_auprc_score: 0.9955; val_best_acc_score: 0.9795; val_best_f1_score: 0.9797; train_kl_reg_loss: 40597.3599; train_edge_recon_loss: 25500439.0752; train_gene_expr_recon_loss: 9850132.8981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35391169.3229; train_optim_loss: 35391169.3229; val_kl_reg_loss: 38799.6858; val_edge_recon_loss: 25521576.4375; val_gene_expr_recon_loss: 9805517.1391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35365893.2750; val_optim_loss: 35365893.2750
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9969; val_auprc_score: 0.9962; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 39491.7046; train_edge_recon_loss: 25489622.8817; train_gene_expr_recon_loss: 9823305.9984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35352420.5859; train_optim_loss: 35352420.5859; val_kl_reg_loss: 39787.5321; val_edge_recon_loss: 25526517.8625; val_gene_expr_recon_loss: 9806212.4250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35372517.7938; val_optim_loss: 35372517.7938
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9969; val_auprc_score: 0.9961; val_best_acc_score: 0.9826; val_best_f1_score: 0.9828; train_kl_reg_loss: 38223.6239; train_edge_recon_loss: 25474817.4621; train_gene_expr_recon_loss: 9813342.2975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35326383.3939; train_optim_loss: 35326383.3939; val_kl_reg_loss: 36007.2266; val_edge_recon_loss: 25507131.8875; val_gene_expr_recon_loss: 9807516.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35350655.6125; val_optim_loss: 35350655.6125
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9971; val_auprc_score: 0.9962; val_best_acc_score: 0.9828; val_best_f1_score: 0.9829; train_kl_reg_loss: 37285.8327; train_edge_recon_loss: 25466884.0939; train_gene_expr_recon_loss: 9793145.8492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35297315.7801; train_optim_loss: 35297315.7801; val_kl_reg_loss: 36211.7779; val_edge_recon_loss: 25503998.4688; val_gene_expr_recon_loss: 9789705.7375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35329915.9125; val_optim_loss: 35329915.9125
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9973; val_auprc_score: 0.9965; val_best_acc_score: 0.9838; val_best_f1_score: 0.9839; train_kl_reg_loss: 36397.4003; train_edge_recon_loss: 25461529.6597; train_gene_expr_recon_loss: 9786089.4483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35284016.4697; train_optim_loss: 35284016.4697; val_kl_reg_loss: 37800.7205; val_edge_recon_loss: 25469610.2188; val_gene_expr_recon_loss: 9775645.0750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35283056.0312; val_optim_loss: 35283056.0312
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9974; val_auprc_score: 0.9969; val_best_acc_score: 0.9840; val_best_f1_score: 0.9841; train_kl_reg_loss: 35841.6386; train_edge_recon_loss: 25449229.7272; train_gene_expr_recon_loss: 9769431.2248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35254502.5692; train_optim_loss: 35254502.5692; val_kl_reg_loss: 35587.7604; val_edge_recon_loss: 25492253.1438; val_gene_expr_recon_loss: 9773797.3406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35301638.2375; val_optim_loss: 35301638.2375
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9974; val_auprc_score: 0.9967; val_best_acc_score: 0.9826; val_best_f1_score: 0.9828; train_kl_reg_loss: 35415.3353; train_edge_recon_loss: 25442221.2930; train_gene_expr_recon_loss: 9762734.3833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35240370.9736; train_optim_loss: 35240370.9736; val_kl_reg_loss: 34152.6724; val_edge_recon_loss: 25487142.3438; val_gene_expr_recon_loss: 9759658.2312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35280953.2875; val_optim_loss: 35280953.2875
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9971; val_auprc_score: 0.9965; val_best_acc_score: 0.9834; val_best_f1_score: 0.9836; train_kl_reg_loss: 35145.0782; train_edge_recon_loss: 25438278.4120; train_gene_expr_recon_loss: 9755703.0645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35229126.5303; train_optim_loss: 35229126.5303; val_kl_reg_loss: 35088.1781; val_edge_recon_loss: 25469519.5688; val_gene_expr_recon_loss: 9760634.7875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35265242.5562; val_optim_loss: 35265242.5562
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9973; val_auprc_score: 0.9967; val_best_acc_score: 0.9839; val_best_f1_score: 0.9840; train_kl_reg_loss: 34544.6457; train_edge_recon_loss: 25436083.7745; train_gene_expr_recon_loss: 9746537.8013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35217166.2269; train_optim_loss: 35217166.2269; val_kl_reg_loss: 35004.5775; val_edge_recon_loss: 25471095.6687; val_gene_expr_recon_loss: 9768695.9359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35274796.3750; val_optim_loss: 35274796.3750
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9975; val_auprc_score: 0.9970; val_best_acc_score: 0.9848; val_best_f1_score: 0.9850; train_kl_reg_loss: 34067.8773; train_edge_recon_loss: 25435917.5122; train_gene_expr_recon_loss: 9729471.4640; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35199456.8455; train_optim_loss: 35199456.8455; val_kl_reg_loss: 34701.8840; val_edge_recon_loss: 25436435.5250; val_gene_expr_recon_loss: 9706374.3422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35177511.6125; val_optim_loss: 35177511.6125
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9976; val_auprc_score: 0.9969; val_best_acc_score: 0.9852; val_best_f1_score: 0.9853; train_kl_reg_loss: 34059.8127; train_edge_recon_loss: 25426209.8483; train_gene_expr_recon_loss: 9725741.7317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35186011.3556; train_optim_loss: 35186011.3556; val_kl_reg_loss: 33527.0859; val_edge_recon_loss: 25419946.2437; val_gene_expr_recon_loss: 9751831.4203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35205304.7687; val_optim_loss: 35205304.7687
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9977; val_auprc_score: 0.9971; val_best_acc_score: 0.9850; val_best_f1_score: 0.9851; train_kl_reg_loss: 33653.9239; train_edge_recon_loss: 25429371.8448; train_gene_expr_recon_loss: 9719069.6338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35182095.3709; train_optim_loss: 35182095.3709; val_kl_reg_loss: 32120.2176; val_edge_recon_loss: 25476934.3313; val_gene_expr_recon_loss: 9731471.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35240526.3188; val_optim_loss: 35240526.3188
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9972; val_auprc_score: 0.9964; val_best_acc_score: 0.9847; val_best_f1_score: 0.9849; train_kl_reg_loss: 33324.2649; train_edge_recon_loss: 25426995.5887; train_gene_expr_recon_loss: 9713590.2029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35173910.0939; train_optim_loss: 35173910.0939; val_kl_reg_loss: 32803.5666; val_edge_recon_loss: 25444757.9000; val_gene_expr_recon_loss: 9758615.0375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35236176.6625; val_optim_loss: 35236176.6625
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9981; val_auprc_score: 0.9978; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 33195.4297; train_edge_recon_loss: 25415203.7975; train_gene_expr_recon_loss: 9703988.7015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35152387.8907; train_optim_loss: 35152387.8907; val_kl_reg_loss: 32766.9077; val_edge_recon_loss: 25454074.2000; val_gene_expr_recon_loss: 9736105.2016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35222946.2500; val_optim_loss: 35222946.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9978; val_auprc_score: 0.9971; val_best_acc_score: 0.9866; val_best_f1_score: 0.9867; train_kl_reg_loss: 37358.2341; train_edge_recon_loss: 25406874.9506; train_gene_expr_recon_loss: 9624688.5990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35068921.7857; train_optim_loss: 35068921.7857; val_kl_reg_loss: 39523.2433; val_edge_recon_loss: 25436413.7937; val_gene_expr_recon_loss: 9669799.3797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35145736.4500; val_optim_loss: 35145736.4500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 40725.2687; train_edge_recon_loss: 25393511.3438; train_gene_expr_recon_loss: 9610829.9071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35045066.4753; train_optim_loss: 35045066.4753; val_kl_reg_loss: 40885.5982; val_edge_recon_loss: 25426153.6500; val_gene_expr_recon_loss: 9655950.8234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35122990.0625; val_optim_loss: 35122990.0625
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 41624.7810; train_edge_recon_loss: 25393756.6374; train_gene_expr_recon_loss: 9600637.0621; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35036018.4871; train_optim_loss: 35036018.4871; val_kl_reg_loss: 41989.5789; val_edge_recon_loss: 25422034.4375; val_gene_expr_recon_loss: 9658766.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35122790.1812; val_optim_loss: 35122790.1812
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9981; val_auprc_score: 0.9978; val_best_acc_score: 0.9871; val_best_f1_score: 0.9872; train_kl_reg_loss: 42241.0767; train_edge_recon_loss: 25388166.5525; train_gene_expr_recon_loss: 9593699.7524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35024107.4259; train_optim_loss: 35024107.4259; val_kl_reg_loss: 42049.8570; val_edge_recon_loss: 25415887.4438; val_gene_expr_recon_loss: 9661959.5141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35119896.6812; val_optim_loss: 35119896.6812
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9982; val_auprc_score: 0.9978; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 42733.9055; train_edge_recon_loss: 25386994.0619; train_gene_expr_recon_loss: 9590930.1729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35020658.1559; train_optim_loss: 35020658.1559; val_kl_reg_loss: 42475.6725; val_edge_recon_loss: 25391677.6313; val_gene_expr_recon_loss: 9661598.2078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35095751.4750; val_optim_loss: 35095751.4750
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 42956.9328; train_edge_recon_loss: 25384990.8239; train_gene_expr_recon_loss: 9587206.9772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35015154.7126; train_optim_loss: 35015154.7126; val_kl_reg_loss: 42539.2617; val_edge_recon_loss: 25409586.5562; val_gene_expr_recon_loss: 9640573.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35092699.5562; val_optim_loss: 35092699.5562
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9983; val_auprc_score: 0.9978; val_best_acc_score: 0.9878; val_best_f1_score: 0.9878; train_kl_reg_loss: 43150.0026; train_edge_recon_loss: 25388871.2665; train_gene_expr_recon_loss: 9578678.9783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35010700.2978; train_optim_loss: 35010700.2978; val_kl_reg_loss: 42970.8901; val_edge_recon_loss: 25398336.5875; val_gene_expr_recon_loss: 9639535.0250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35080842.5000; val_optim_loss: 35080842.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9874; val_best_f1_score: 0.9875; train_kl_reg_loss: 43314.2399; train_edge_recon_loss: 25385678.7453; train_gene_expr_recon_loss: 9580496.5221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35009489.5212; train_optim_loss: 35009489.5212; val_kl_reg_loss: 43433.7248; val_edge_recon_loss: 25398285.1625; val_gene_expr_recon_loss: 9657394.4469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35099113.4375; val_optim_loss: 35099113.4375
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9982; val_auprc_score: 0.9978; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 43540.1638; train_edge_recon_loss: 25384485.1921; train_gene_expr_recon_loss: 9574159.6404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35002184.9701; train_optim_loss: 35002184.9701; val_kl_reg_loss: 43174.0101; val_edge_recon_loss: 25399071.8188; val_gene_expr_recon_loss: 9647247.7797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35089493.6375; val_optim_loss: 35089493.6375
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9984; val_auprc_score: 0.9981; val_best_acc_score: 0.9880; val_best_f1_score: 0.9881; train_kl_reg_loss: 43575.4333; train_edge_recon_loss: 25381907.9402; train_gene_expr_recon_loss: 9576086.5689; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35001569.9492; train_optim_loss: 35001569.9492; val_kl_reg_loss: 43245.7799; val_edge_recon_loss: 25411889.1062; val_gene_expr_recon_loss: 9633010.8391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35088145.8000; val_optim_loss: 35088145.8000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 43769.6991; train_edge_recon_loss: 25382873.6938; train_gene_expr_recon_loss: 9574095.7049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35000739.1308; train_optim_loss: 35000739.1308; val_kl_reg_loss: 42405.5512; val_edge_recon_loss: 25416580.3625; val_gene_expr_recon_loss: 9646917.0500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35105902.8625; val_optim_loss: 35105902.8625

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9983; val_auprc_score: 0.9976; val_best_acc_score: 0.9882; val_best_f1_score: 0.9883; train_kl_reg_loss: 43563.2108; train_edge_recon_loss: 25380116.3507; train_gene_expr_recon_loss: 9568350.5411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34992030.0765; train_optim_loss: 34992030.0765; val_kl_reg_loss: 43251.0667; val_edge_recon_loss: 25392082.7875; val_gene_expr_recon_loss: 9624162.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35059496.6688; val_optim_loss: 35059496.6688
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9984; val_auprc_score: 0.9979; val_best_acc_score: 0.9881; val_best_f1_score: 0.9882; train_kl_reg_loss: 43976.4944; train_edge_recon_loss: 25374858.6381; train_gene_expr_recon_loss: 9568919.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34987755.0480; train_optim_loss: 34987755.0480; val_kl_reg_loss: 43545.8163; val_edge_recon_loss: 25404611.2937; val_gene_expr_recon_loss: 9654342.4797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35102499.5187; val_optim_loss: 35102499.5187
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9983; val_auprc_score: 0.9978; val_best_acc_score: 0.9884; val_best_f1_score: 0.9884; train_kl_reg_loss: 44232.2940; train_edge_recon_loss: 25381792.0717; train_gene_expr_recon_loss: 9559453.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34985478.3479; train_optim_loss: 34985478.3479; val_kl_reg_loss: 43981.8989; val_edge_recon_loss: 25401813.4875; val_gene_expr_recon_loss: 9659841.8625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35105637.3250; val_optim_loss: 35105637.3250
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9882; val_best_f1_score: 0.9883; train_kl_reg_loss: 44477.4493; train_edge_recon_loss: 25377654.6792; train_gene_expr_recon_loss: 9564904.8422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34987036.9743; train_optim_loss: 34987036.9743; val_kl_reg_loss: 44044.7087; val_edge_recon_loss: 25388572.4125; val_gene_expr_recon_loss: 9653912.7531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35086529.9000; val_optim_loss: 35086529.9000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9983; val_auprc_score: 0.9977; val_best_acc_score: 0.9882; val_best_f1_score: 0.9883; train_kl_reg_loss: 44604.4373; train_edge_recon_loss: 25377448.6221; train_gene_expr_recon_loss: 9556773.2684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34978826.3013; train_optim_loss: 34978826.3013; val_kl_reg_loss: 44229.0094; val_edge_recon_loss: 25389088.6438; val_gene_expr_recon_loss: 9629684.1609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35063001.8563; val_optim_loss: 35063001.8563

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9880; val_best_f1_score: 0.9881; train_kl_reg_loss: 44710.5035; train_edge_recon_loss: 25383369.6402; train_gene_expr_recon_loss: 9555193.4654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34983273.5602; train_optim_loss: 34983273.5602; val_kl_reg_loss: 44155.9138; val_edge_recon_loss: 25401354.6313; val_gene_expr_recon_loss: 9604406.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35049916.5375; val_optim_loss: 35049916.5375
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9882; val_best_f1_score: 0.9883; train_kl_reg_loss: 44722.6901; train_edge_recon_loss: 25382748.0731; train_gene_expr_recon_loss: 9558527.6668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34985998.4426; train_optim_loss: 34985998.4426; val_kl_reg_loss: 44235.6376; val_edge_recon_loss: 25402875.1250; val_gene_expr_recon_loss: 9634326.0266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35081436.7812; val_optim_loss: 35081436.7812
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9983; val_auprc_score: 0.9978; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 44717.9849; train_edge_recon_loss: 25380074.9965; train_gene_expr_recon_loss: 9556820.3467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34981613.3410; train_optim_loss: 34981613.3410; val_kl_reg_loss: 44214.3889; val_edge_recon_loss: 25412146.6812; val_gene_expr_recon_loss: 9654514.7125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35110875.6812; val_optim_loss: 35110875.6812
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9877; val_best_f1_score: 0.9878; train_kl_reg_loss: 44715.6891; train_edge_recon_loss: 25377927.8344; train_gene_expr_recon_loss: 9554757.2712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34977400.7850; train_optim_loss: 34977400.7850; val_kl_reg_loss: 44091.2316; val_edge_recon_loss: 25417661.6125; val_gene_expr_recon_loss: 9619337.9828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35081090.8687; val_optim_loss: 35081090.8687
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9984; val_auprc_score: 0.9979; val_best_acc_score: 0.9884; val_best_f1_score: 0.9884; train_kl_reg_loss: 44707.2392; train_edge_recon_loss: 25378169.4962; train_gene_expr_recon_loss: 9557778.6249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34980655.3452; train_optim_loss: 34980655.3452; val_kl_reg_loss: 44251.3322; val_edge_recon_loss: 25392744.2500; val_gene_expr_recon_loss: 9607113.2250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35044108.8813; val_optim_loss: 35044108.8813
