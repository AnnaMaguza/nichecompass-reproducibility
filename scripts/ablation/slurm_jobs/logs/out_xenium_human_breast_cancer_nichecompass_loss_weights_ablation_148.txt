None
Run timestamp: 14072023_231204_148.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_148']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9822; val_auprc_score: 0.9788; val_best_acc_score: 0.9374; val_best_f1_score: 0.9391; train_kl_reg_loss: 16411.4507; train_edge_recon_loss: 2666614.8189; train_gene_expr_recon_loss: 748701.7690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3431728.0407; train_optim_loss: 3431728.0407; val_kl_reg_loss: 14019.0099; val_edge_recon_loss: 2640464.2753; val_gene_expr_recon_loss: 699267.6115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3353750.9190; val_optim_loss: 3353750.9190
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9889; val_auprc_score: 0.9870; val_best_acc_score: 0.9523; val_best_f1_score: 0.9531; train_kl_reg_loss: 13678.2898; train_edge_recon_loss: 2612928.5182; train_gene_expr_recon_loss: 685461.6620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3312068.4707; train_optim_loss: 3312068.4707; val_kl_reg_loss: 12890.3058; val_edge_recon_loss: 2621777.1490; val_gene_expr_recon_loss: 678771.6601; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3313439.1167; val_optim_loss: 3313439.1167
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9908; val_auprc_score: 0.9890; val_best_acc_score: 0.9591; val_best_f1_score: 0.9598; train_kl_reg_loss: 12694.9619; train_edge_recon_loss: 2601233.3487; train_gene_expr_recon_loss: 672689.5349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3286617.8426; train_optim_loss: 3286617.8426; val_kl_reg_loss: 12333.9933; val_edge_recon_loss: 2606936.9956; val_gene_expr_recon_loss: 670665.7343; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3289936.7282; val_optim_loss: 3289936.7282
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9924; val_auprc_score: 0.9909; val_best_acc_score: 0.9638; val_best_f1_score: 0.9643; train_kl_reg_loss: 12100.3352; train_edge_recon_loss: 2593610.4006; train_gene_expr_recon_loss: 667656.0122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3273366.7467; train_optim_loss: 3273366.7467; val_kl_reg_loss: 11595.0613; val_edge_recon_loss: 2601428.2395; val_gene_expr_recon_loss: 668973.5899; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3281996.8990; val_optim_loss: 3281996.8990
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9924; val_auprc_score: 0.9907; val_best_acc_score: 0.9648; val_best_f1_score: 0.9653; train_kl_reg_loss: 11798.4787; train_edge_recon_loss: 2589518.7906; train_gene_expr_recon_loss: 664635.0195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3265952.2880; train_optim_loss: 3265952.2880; val_kl_reg_loss: 11638.7717; val_edge_recon_loss: 2599560.5906; val_gene_expr_recon_loss: 664903.7008; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3276103.0697; val_optim_loss: 3276103.0697
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9930; val_auprc_score: 0.9915; val_best_acc_score: 0.9660; val_best_f1_score: 0.9665; train_kl_reg_loss: 11588.7626; train_edge_recon_loss: 2587533.4850; train_gene_expr_recon_loss: 662685.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3261807.7487; train_optim_loss: 3261807.7487; val_kl_reg_loss: 11421.7267; val_edge_recon_loss: 2597721.8127; val_gene_expr_recon_loss: 666777.0098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3275920.5427; val_optim_loss: 3275920.5427
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9935; val_auprc_score: 0.9921; val_best_acc_score: 0.9680; val_best_f1_score: 0.9685; train_kl_reg_loss: 11403.3534; train_edge_recon_loss: 2584651.9788; train_gene_expr_recon_loss: 661205.2139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3257260.5435; train_optim_loss: 3257260.5435; val_kl_reg_loss: 11308.7419; val_edge_recon_loss: 2595884.5444; val_gene_expr_recon_loss: 664330.5070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3271523.7909; val_optim_loss: 3271523.7909
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9934; val_auprc_score: 0.9920; val_best_acc_score: 0.9676; val_best_f1_score: 0.9679; train_kl_reg_loss: 11240.8282; train_edge_recon_loss: 2582868.7497; train_gene_expr_recon_loss: 660240.6978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3254350.2718; train_optim_loss: 3254350.2718; val_kl_reg_loss: 11111.8684; val_edge_recon_loss: 2590524.9922; val_gene_expr_recon_loss: 662010.9913; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3263647.8554; val_optim_loss: 3263647.8554
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9934; val_auprc_score: 0.9918; val_best_acc_score: 0.9683; val_best_f1_score: 0.9688; train_kl_reg_loss: 11124.5911; train_edge_recon_loss: 2580958.8530; train_gene_expr_recon_loss: 659154.1816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3251237.6258; train_optim_loss: 3251237.6258; val_kl_reg_loss: 11090.0778; val_edge_recon_loss: 2590368.5453; val_gene_expr_recon_loss: 660765.0096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3262223.6350; val_optim_loss: 3262223.6350
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9941; val_auprc_score: 0.9926; val_best_acc_score: 0.9708; val_best_f1_score: 0.9713; train_kl_reg_loss: 11038.3156; train_edge_recon_loss: 2579954.2520; train_gene_expr_recon_loss: 658798.9533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3249791.5248; train_optim_loss: 3249791.5248; val_kl_reg_loss: 10867.3332; val_edge_recon_loss: 2589051.8807; val_gene_expr_recon_loss: 661344.8558; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3261264.0697; val_optim_loss: 3261264.0697
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9943; val_auprc_score: 0.9931; val_best_acc_score: 0.9720; val_best_f1_score: 0.9723; train_kl_reg_loss: 10957.6640; train_edge_recon_loss: 2578817.7158; train_gene_expr_recon_loss: 658065.7665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3247841.1471; train_optim_loss: 3247841.1471; val_kl_reg_loss: 10699.2467; val_edge_recon_loss: 2586302.0375; val_gene_expr_recon_loss: 661713.6409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3258714.9233; val_optim_loss: 3258714.9233
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9944; val_auprc_score: 0.9930; val_best_acc_score: 0.9723; val_best_f1_score: 0.9727; train_kl_reg_loss: 10886.4616; train_edge_recon_loss: 2577834.7424; train_gene_expr_recon_loss: 657442.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3246163.6637; train_optim_loss: 3246163.6637; val_kl_reg_loss: 10771.0828; val_edge_recon_loss: 2583715.9199; val_gene_expr_recon_loss: 659945.8314; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3254432.8345; val_optim_loss: 3254432.8345
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9945; val_auprc_score: 0.9932; val_best_acc_score: 0.9724; val_best_f1_score: 0.9728; train_kl_reg_loss: 10824.5215; train_edge_recon_loss: 2576877.1888; train_gene_expr_recon_loss: 657076.1955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3244777.9056; train_optim_loss: 3244777.9056; val_kl_reg_loss: 10821.3201; val_edge_recon_loss: 2588063.1481; val_gene_expr_recon_loss: 659839.0340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3258723.5096; val_optim_loss: 3258723.5096
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9948; val_auprc_score: 0.9934; val_best_acc_score: 0.9738; val_best_f1_score: 0.9741; train_kl_reg_loss: 10764.2279; train_edge_recon_loss: 2576420.6392; train_gene_expr_recon_loss: 657043.6938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3244228.5593; train_optim_loss: 3244228.5593; val_kl_reg_loss: 10936.9681; val_edge_recon_loss: 2586027.7422; val_gene_expr_recon_loss: 659876.0168; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3256840.7308; val_optim_loss: 3256840.7308
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9951; val_auprc_score: 0.9940; val_best_acc_score: 0.9745; val_best_f1_score: 0.9748; train_kl_reg_loss: 10754.3819; train_edge_recon_loss: 2575878.9522; train_gene_expr_recon_loss: 656649.2553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3243282.5856; train_optim_loss: 3243282.5856; val_kl_reg_loss: 10630.0141; val_edge_recon_loss: 2582112.4747; val_gene_expr_recon_loss: 659785.5126; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3252527.9956; val_optim_loss: 3252527.9956
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9947; val_auprc_score: 0.9932; val_best_acc_score: 0.9743; val_best_f1_score: 0.9747; train_kl_reg_loss: 10701.1601; train_edge_recon_loss: 2574269.3295; train_gene_expr_recon_loss: 656005.2197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3240975.7098; train_optim_loss: 3240975.7098; val_kl_reg_loss: 10540.0861; val_edge_recon_loss: 2582319.8641; val_gene_expr_recon_loss: 661166.0264; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3254025.9887; val_optim_loss: 3254025.9887
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9952; val_auprc_score: 0.9939; val_best_acc_score: 0.9757; val_best_f1_score: 0.9760; train_kl_reg_loss: 10675.6087; train_edge_recon_loss: 2573959.0054; train_gene_expr_recon_loss: 655971.7853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3240606.3982; train_optim_loss: 3240606.3982; val_kl_reg_loss: 10584.1082; val_edge_recon_loss: 2583243.0958; val_gene_expr_recon_loss: 658862.8704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3252690.0767; val_optim_loss: 3252690.0767
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9954; val_auprc_score: 0.9943; val_best_acc_score: 0.9760; val_best_f1_score: 0.9762; train_kl_reg_loss: 10668.6559; train_edge_recon_loss: 2573871.9751; train_gene_expr_recon_loss: 655628.1014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3240168.7313; train_optim_loss: 3240168.7313; val_kl_reg_loss: 10595.0616; val_edge_recon_loss: 2578979.3249; val_gene_expr_recon_loss: 658740.1971; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3248314.5828; val_optim_loss: 3248314.5828
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9949; val_auprc_score: 0.9936; val_best_acc_score: 0.9749; val_best_f1_score: 0.9752; train_kl_reg_loss: 10623.4852; train_edge_recon_loss: 2572367.1458; train_gene_expr_recon_loss: 655230.0659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3238220.6973; train_optim_loss: 3238220.6973; val_kl_reg_loss: 10641.0457; val_edge_recon_loss: 2581291.8127; val_gene_expr_recon_loss: 661879.7027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3253812.5601; val_optim_loss: 3253812.5601
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9956; val_auprc_score: 0.9942; val_best_acc_score: 0.9774; val_best_f1_score: 0.9776; train_kl_reg_loss: 10610.8765; train_edge_recon_loss: 2572305.1036; train_gene_expr_recon_loss: 655032.3245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3237948.3018; train_optim_loss: 3237948.3018; val_kl_reg_loss: 10615.1640; val_edge_recon_loss: 2575369.0505; val_gene_expr_recon_loss: 659731.4392; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3245715.6577; val_optim_loss: 3245715.6577
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9951; val_auprc_score: 0.9938; val_best_acc_score: 0.9764; val_best_f1_score: 0.9767; train_kl_reg_loss: 10598.0613; train_edge_recon_loss: 2571315.0262; train_gene_expr_recon_loss: 654856.9152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236770.0052; train_optim_loss: 3236770.0052; val_kl_reg_loss: 10406.5720; val_edge_recon_loss: 2575797.4721; val_gene_expr_recon_loss: 659902.6202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3246106.6568; val_optim_loss: 3246106.6568
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9953; val_auprc_score: 0.9941; val_best_acc_score: 0.9761; val_best_f1_score: 0.9764; train_kl_reg_loss: 10599.9480; train_edge_recon_loss: 2571232.0010; train_gene_expr_recon_loss: 654876.1332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236708.0867; train_optim_loss: 3236708.0867; val_kl_reg_loss: 10547.5025; val_edge_recon_loss: 2578700.7683; val_gene_expr_recon_loss: 659843.8306; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3249092.1054; val_optim_loss: 3249092.1054
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9952; val_auprc_score: 0.9938; val_best_acc_score: 0.9765; val_best_f1_score: 0.9767; train_kl_reg_loss: 10563.1436; train_edge_recon_loss: 2570432.7304; train_gene_expr_recon_loss: 655070.8317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236066.7051; train_optim_loss: 3236066.7051; val_kl_reg_loss: 10647.6202; val_edge_recon_loss: 2578984.8815; val_gene_expr_recon_loss: 659293.9710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3248926.4713; val_optim_loss: 3248926.4713
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9951; val_auprc_score: 0.9936; val_best_acc_score: 0.9765; val_best_f1_score: 0.9769; train_kl_reg_loss: 10553.3696; train_edge_recon_loss: 2570530.9997; train_gene_expr_recon_loss: 654703.8916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3235788.2634; train_optim_loss: 3235788.2634; val_kl_reg_loss: 10529.7336; val_edge_recon_loss: 2577035.7326; val_gene_expr_recon_loss: 659180.0577; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3246745.5209; val_optim_loss: 3246745.5209

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9955; val_auprc_score: 0.9942; val_best_acc_score: 0.9777; val_best_f1_score: 0.9779; train_kl_reg_loss: 10968.0011; train_edge_recon_loss: 2568736.6500; train_gene_expr_recon_loss: 649395.1605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3229099.8117; train_optim_loss: 3229099.8117; val_kl_reg_loss: 10948.4655; val_edge_recon_loss: 2574028.7892; val_gene_expr_recon_loss: 654245.5233; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3239222.7709; val_optim_loss: 3239222.7709
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9956; val_auprc_score: 0.9944; val_best_acc_score: 0.9778; val_best_f1_score: 0.9780; train_kl_reg_loss: 11038.1611; train_edge_recon_loss: 2567561.6249; train_gene_expr_recon_loss: 648613.8607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3227213.6445; train_optim_loss: 3227213.6445; val_kl_reg_loss: 10969.0351; val_edge_recon_loss: 2572387.3676; val_gene_expr_recon_loss: 653742.3308; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237098.7204; val_optim_loss: 3237098.7204
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9956; val_auprc_score: 0.9943; val_best_acc_score: 0.9780; val_best_f1_score: 0.9783; train_kl_reg_loss: 11038.0321; train_edge_recon_loss: 2567749.1980; train_gene_expr_recon_loss: 648300.2563; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3227087.4880; train_optim_loss: 3227087.4880; val_kl_reg_loss: 10993.0131; val_edge_recon_loss: 2571664.4774; val_gene_expr_recon_loss: 654119.3848; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3236776.8702; val_optim_loss: 3236776.8702
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9957; val_auprc_score: 0.9945; val_best_acc_score: 0.9781; val_best_f1_score: 0.9784; train_kl_reg_loss: 11051.3480; train_edge_recon_loss: 2567681.7341; train_gene_expr_recon_loss: 648258.0818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3226991.1648; train_optim_loss: 3226991.1648; val_kl_reg_loss: 10936.5017; val_edge_recon_loss: 2574583.8223; val_gene_expr_recon_loss: 654886.1429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3240406.4547; val_optim_loss: 3240406.4547
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9957; val_auprc_score: 0.9946; val_best_acc_score: 0.9777; val_best_f1_score: 0.9779; train_kl_reg_loss: 11034.8420; train_edge_recon_loss: 2567150.9471; train_gene_expr_recon_loss: 647896.6365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3226082.4226; train_optim_loss: 3226082.4226; val_kl_reg_loss: 11015.2813; val_edge_recon_loss: 2573394.4425; val_gene_expr_recon_loss: 654606.7271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3239016.4477; val_optim_loss: 3239016.4477
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9957; val_auprc_score: 0.9945; val_best_acc_score: 0.9783; val_best_f1_score: 0.9785; train_kl_reg_loss: 11028.5192; train_edge_recon_loss: 2567585.4579; train_gene_expr_recon_loss: 647931.9961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3226545.9729; train_optim_loss: 3226545.9729; val_kl_reg_loss: 10984.7532; val_edge_recon_loss: 2573646.2108; val_gene_expr_recon_loss: 653309.4037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237940.3615; val_optim_loss: 3237940.3615
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9957; val_auprc_score: 0.9945; val_best_acc_score: 0.9783; val_best_f1_score: 0.9785; train_kl_reg_loss: 11019.6439; train_edge_recon_loss: 2567436.1474; train_gene_expr_recon_loss: 648028.8543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3226484.6443; train_optim_loss: 3226484.6443; val_kl_reg_loss: 11024.8205; val_edge_recon_loss: 2572287.4939; val_gene_expr_recon_loss: 654155.2295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237467.5470; val_optim_loss: 3237467.5470

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9958; val_auprc_score: 0.9948; val_best_acc_score: 0.9782; val_best_f1_score: 0.9784; train_kl_reg_loss: 11064.6286; train_edge_recon_loss: 2566695.0606; train_gene_expr_recon_loss: 647231.8145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3224991.5035; train_optim_loss: 3224991.5035; val_kl_reg_loss: 11000.1308; val_edge_recon_loss: 2572677.5627; val_gene_expr_recon_loss: 653973.4111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237651.1054; val_optim_loss: 3237651.1054
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9959; val_auprc_score: 0.9946; val_best_acc_score: 0.9788; val_best_f1_score: 0.9790; train_kl_reg_loss: 11073.9929; train_edge_recon_loss: 2566662.4526; train_gene_expr_recon_loss: 647224.2470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3224960.6955; train_optim_loss: 3224960.6955; val_kl_reg_loss: 11021.1942; val_edge_recon_loss: 2569960.9660; val_gene_expr_recon_loss: 654019.0030; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3235001.1655; val_optim_loss: 3235001.1655
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9958; val_auprc_score: 0.9946; val_best_acc_score: 0.9784; val_best_f1_score: 0.9786; train_kl_reg_loss: 11080.3537; train_edge_recon_loss: 2566868.0810; train_gene_expr_recon_loss: 647077.8946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3225026.3301; train_optim_loss: 3225026.3301; val_kl_reg_loss: 11008.9711; val_edge_recon_loss: 2573502.9321; val_gene_expr_recon_loss: 653919.2415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3238431.1429; val_optim_loss: 3238431.1429
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9958; val_auprc_score: 0.9946; val_best_acc_score: 0.9783; val_best_f1_score: 0.9786; train_kl_reg_loss: 11085.3689; train_edge_recon_loss: 2566853.3258; train_gene_expr_recon_loss: 647308.8868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3225247.5792; train_optim_loss: 3225247.5792; val_kl_reg_loss: 11021.8652; val_edge_recon_loss: 2572815.9103; val_gene_expr_recon_loss: 654205.0995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3238042.8737; val_optim_loss: 3238042.8737
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9956; val_auprc_score: 0.9943; val_best_acc_score: 0.9782; val_best_f1_score: 0.9785; train_kl_reg_loss: 11089.5410; train_edge_recon_loss: 2566880.5937; train_gene_expr_recon_loss: 646972.7294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3224942.8629; train_optim_loss: 3224942.8629; val_kl_reg_loss: 11022.7617; val_edge_recon_loss: 2574269.1411; val_gene_expr_recon_loss: 652669.9044; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237961.8162; val_optim_loss: 3237961.8162
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9958; val_auprc_score: 0.9947; val_best_acc_score: 0.9782; val_best_f1_score: 0.9784; train_kl_reg_loss: 11093.5021; train_edge_recon_loss: 2566794.0446; train_gene_expr_recon_loss: 646867.3559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3224754.9044; train_optim_loss: 3224754.9044; val_kl_reg_loss: 11031.7370; val_edge_recon_loss: 2573357.6124; val_gene_expr_recon_loss: 654391.6017; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3238780.9373; val_optim_loss: 3238780.9373

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9958; val_auprc_score: 0.9947; val_best_acc_score: 0.9784; val_best_f1_score: 0.9786; train_kl_reg_loss: 11094.5587; train_edge_recon_loss: 2567451.7254; train_gene_expr_recon_loss: 646835.0322; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3225381.3146; train_optim_loss: 3225381.3146; val_kl_reg_loss: 11023.0008; val_edge_recon_loss: 2571505.3214; val_gene_expr_recon_loss: 652588.9895; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3235117.3179; val_optim_loss: 3235117.3179
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9957; val_auprc_score: 0.9946; val_best_acc_score: 0.9786; val_best_f1_score: 0.9789; train_kl_reg_loss: 11091.8289; train_edge_recon_loss: 2567375.6503; train_gene_expr_recon_loss: 647270.7825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3225738.2624; train_optim_loss: 3225738.2624; val_kl_reg_loss: 11025.0937; val_edge_recon_loss: 2572811.6568; val_gene_expr_recon_loss: 653799.4410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237636.1873; val_optim_loss: 3237636.1873
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9958; val_auprc_score: 0.9946; val_best_acc_score: 0.9787; val_best_f1_score: 0.9789; train_kl_reg_loss: 11089.8053; train_edge_recon_loss: 2566722.8622; train_gene_expr_recon_loss: 646956.7193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3224769.3901; train_optim_loss: 3224769.3901; val_kl_reg_loss: 11018.7490; val_edge_recon_loss: 2572952.5096; val_gene_expr_recon_loss: 652454.8500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3236426.0967; val_optim_loss: 3236426.0967
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9958; val_auprc_score: 0.9945; val_best_acc_score: 0.9785; val_best_f1_score: 0.9787; train_kl_reg_loss: 11093.7399; train_edge_recon_loss: 2566597.6342; train_gene_expr_recon_loss: 647230.3127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3224921.6860; train_optim_loss: 3224921.6860; val_kl_reg_loss: 11021.9362; val_edge_recon_loss: 2572740.3362; val_gene_expr_recon_loss: 653662.7676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237425.0488; val_optim_loss: 3237425.0488

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 819 min 37 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
Val AUROC score: 0.9957
Val AUPRC score: 0.9946
Val best accuracy score: 0.9780
Val best F1 score: 0.9783
Val gene expr MSE score: 1.6371

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
