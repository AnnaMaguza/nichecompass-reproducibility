None
Run timestamp: 08082023_193802_93.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_93']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9125; val_auprc_score: 0.8905; val_best_acc_score: 0.8409; val_best_f1_score: 0.8506; train_kl_reg_loss: 35948.6591; train_edge_recon_loss: 2914420.5364; train_gene_expr_recon_loss: 12938835.5059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 15889204.7162; train_optim_loss: 15889204.7162; val_kl_reg_loss: 36502.9390; val_edge_recon_loss: 2792813.0757; val_gene_expr_recon_loss: 11881462.2763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 14710778.3289; val_optim_loss: 14710778.3289
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9290; val_auprc_score: 0.9069; val_best_acc_score: 0.8660; val_best_f1_score: 0.8747; train_kl_reg_loss: 35934.1448; train_edge_recon_loss: 2707614.4162; train_gene_expr_recon_loss: 11507491.3809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 14251039.9544; train_optim_loss: 14251039.9544; val_kl_reg_loss: 32739.4268; val_edge_recon_loss: 2736899.4441; val_gene_expr_recon_loss: 11198349.6447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13967988.4868; val_optim_loss: 13967988.4868
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9349; val_auprc_score: 0.9153; val_best_acc_score: 0.8723; val_best_f1_score: 0.8813; train_kl_reg_loss: 31598.4936; train_edge_recon_loss: 2679136.8570; train_gene_expr_recon_loss: 10984156.3294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13694891.6794; train_optim_loss: 13694891.6794; val_kl_reg_loss: 29220.6041; val_edge_recon_loss: 2725575.5066; val_gene_expr_recon_loss: 10792381.4211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13547177.5658; val_optim_loss: 13547177.5658
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9412; val_auprc_score: 0.9247; val_best_acc_score: 0.8802; val_best_f1_score: 0.8881; train_kl_reg_loss: 29003.7881; train_edge_recon_loss: 2667329.8934; train_gene_expr_recon_loss: 10651806.6147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13348140.3088; train_optim_loss: 13348140.3088; val_kl_reg_loss: 26913.5071; val_edge_recon_loss: 2712823.3816; val_gene_expr_recon_loss: 10536715.3553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13276452.1974; val_optim_loss: 13276452.1974
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9432; val_auprc_score: 0.9276; val_best_acc_score: 0.8823; val_best_f1_score: 0.8903; train_kl_reg_loss: 27342.8391; train_edge_recon_loss: 2661628.8702; train_gene_expr_recon_loss: 10431709.6397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13120681.3485; train_optim_loss: 13120681.3485; val_kl_reg_loss: 26107.9501; val_edge_recon_loss: 2710088.5724; val_gene_expr_recon_loss: 10361226.2763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13097422.7500; val_optim_loss: 13097422.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9452; val_auprc_score: 0.9298; val_best_acc_score: 0.8850; val_best_f1_score: 0.8921; train_kl_reg_loss: 26338.0995; train_edge_recon_loss: 2654764.1757; train_gene_expr_recon_loss: 10287871.8853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12968974.1824; train_optim_loss: 12968974.1824; val_kl_reg_loss: 25090.4173; val_edge_recon_loss: 2705554.5658; val_gene_expr_recon_loss: 10249909.5395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12980554.4605; val_optim_loss: 12980554.4605
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9466; val_auprc_score: 0.9325; val_best_acc_score: 0.8861; val_best_f1_score: 0.8926; train_kl_reg_loss: 25542.8277; train_edge_recon_loss: 2651886.1309; train_gene_expr_recon_loss: 10185724.6824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12863153.6559; train_optim_loss: 12863153.6559; val_kl_reg_loss: 24543.5421; val_edge_recon_loss: 2703673.2533; val_gene_expr_recon_loss: 10163185.5263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12891402.3026; val_optim_loss: 12891402.3026
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9488; val_auprc_score: 0.9355; val_best_acc_score: 0.8890; val_best_f1_score: 0.8954; train_kl_reg_loss: 24801.7322; train_edge_recon_loss: 2652159.9015; train_gene_expr_recon_loss: 10119394.5515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12796356.1765; train_optim_loss: 12796356.1765; val_kl_reg_loss: 24126.7066; val_edge_recon_loss: 2697384.9934; val_gene_expr_recon_loss: 10122834.2368; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12844345.9211; val_optim_loss: 12844345.9211
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9510; val_auprc_score: 0.9383; val_best_acc_score: 0.8900; val_best_f1_score: 0.8962; train_kl_reg_loss: 24410.2326; train_edge_recon_loss: 2645535.5724; train_gene_expr_recon_loss: 10078017.6441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12747963.4574; train_optim_loss: 12747963.4574; val_kl_reg_loss: 23146.1341; val_edge_recon_loss: 2700867.0230; val_gene_expr_recon_loss: 10055808.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12779821.6711; val_optim_loss: 12779821.6711
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9505; val_auprc_score: 0.9382; val_best_acc_score: 0.8904; val_best_f1_score: 0.8965; train_kl_reg_loss: 23829.6769; train_edge_recon_loss: 2647582.5419; train_gene_expr_recon_loss: 10033293.3176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12704705.5221; train_optim_loss: 12704705.5221; val_kl_reg_loss: 22954.0517; val_edge_recon_loss: 2701128.9441; val_gene_expr_recon_loss: 10035845.9474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12759928.9868; val_optim_loss: 12759928.9868
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9529; val_auprc_score: 0.9407; val_best_acc_score: 0.8924; val_best_f1_score: 0.8983; train_kl_reg_loss: 23413.2037; train_edge_recon_loss: 2642637.9562; train_gene_expr_recon_loss: 10013690.0779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12679741.2279; train_optim_loss: 12679741.2279; val_kl_reg_loss: 22900.2557; val_edge_recon_loss: 2696365.2533; val_gene_expr_recon_loss: 10027594.1316; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12746859.6579; val_optim_loss: 12746859.6579
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9549; val_auprc_score: 0.9441; val_best_acc_score: 0.8947; val_best_f1_score: 0.9003; train_kl_reg_loss: 23077.6183; train_edge_recon_loss: 2643276.7324; train_gene_expr_recon_loss: 9993819.9765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12660174.3265; train_optim_loss: 12660174.3265; val_kl_reg_loss: 22416.4399; val_edge_recon_loss: 2690575.0954; val_gene_expr_recon_loss: 9992702.4342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12705693.9605; val_optim_loss: 12705693.9605
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9560; val_auprc_score: 0.9450; val_best_acc_score: 0.8974; val_best_f1_score: 0.9025; train_kl_reg_loss: 22786.8862; train_edge_recon_loss: 2642985.8507; train_gene_expr_recon_loss: 9977135.9897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12642908.7279; train_optim_loss: 12642908.7279; val_kl_reg_loss: 22342.8827; val_edge_recon_loss: 2687733.8092; val_gene_expr_recon_loss: 9992148.8421; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12702225.5395; val_optim_loss: 12702225.5395
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9571; val_auprc_score: 0.9472; val_best_acc_score: 0.8960; val_best_f1_score: 0.9015; train_kl_reg_loss: 22454.3777; train_edge_recon_loss: 2639785.3055; train_gene_expr_recon_loss: 9964139.9676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12626379.6574; train_optim_loss: 12626379.6574; val_kl_reg_loss: 21662.0991; val_edge_recon_loss: 2689049.1053; val_gene_expr_recon_loss: 9976431.2368; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12687142.4474; val_optim_loss: 12687142.4474
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9582; val_auprc_score: 0.9488; val_best_acc_score: 0.8974; val_best_f1_score: 0.9020; train_kl_reg_loss: 22175.7843; train_edge_recon_loss: 2639465.7062; train_gene_expr_recon_loss: 9953952.3529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12615593.8500; train_optim_loss: 12615593.8500; val_kl_reg_loss: 21300.2873; val_edge_recon_loss: 2692844.7862; val_gene_expr_recon_loss: 9979481.9079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12693626.9868; val_optim_loss: 12693626.9868
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9591; val_auprc_score: 0.9498; val_best_acc_score: 0.8992; val_best_f1_score: 0.9041; train_kl_reg_loss: 21844.5303; train_edge_recon_loss: 2638852.5853; train_gene_expr_recon_loss: 9948962.7529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12609659.8721; train_optim_loss: 12609659.8721; val_kl_reg_loss: 21443.6521; val_edge_recon_loss: 2690919.8553; val_gene_expr_recon_loss: 9972030.2368; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12684393.7500; val_optim_loss: 12684393.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9600; val_auprc_score: 0.9506; val_best_acc_score: 0.9008; val_best_f1_score: 0.9059; train_kl_reg_loss: 21740.0270; train_edge_recon_loss: 2638131.1978; train_gene_expr_recon_loss: 9942659.4397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12602530.6544; train_optim_loss: 12602530.6544; val_kl_reg_loss: 21291.8493; val_edge_recon_loss: 2687435.9901; val_gene_expr_recon_loss: 9979729.1711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12688457.0132; val_optim_loss: 12688457.0132
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9613; val_auprc_score: 0.9523; val_best_acc_score: 0.9041; val_best_f1_score: 0.9090; train_kl_reg_loss: 21497.0679; train_edge_recon_loss: 2636396.7246; train_gene_expr_recon_loss: 9936287.1015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12594180.8838; train_optim_loss: 12594180.8838; val_kl_reg_loss: 20828.3168; val_edge_recon_loss: 2684550.2434; val_gene_expr_recon_loss: 9946860.6184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12652239.2105; val_optim_loss: 12652239.2105
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9610; val_auprc_score: 0.9516; val_best_acc_score: 0.9026; val_best_f1_score: 0.9074; train_kl_reg_loss: 21409.0644; train_edge_recon_loss: 2634812.4978; train_gene_expr_recon_loss: 9930769.2147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12586990.7926; train_optim_loss: 12586990.7926; val_kl_reg_loss: 20570.5984; val_edge_recon_loss: 2689630.5592; val_gene_expr_recon_loss: 9960733.7632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12670934.8947; val_optim_loss: 12670934.8947
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9615; val_auprc_score: 0.9531; val_best_acc_score: 0.9036; val_best_f1_score: 0.9081; train_kl_reg_loss: 21270.0381; train_edge_recon_loss: 2634746.5544; train_gene_expr_recon_loss: 9929098.1588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12585114.7588; train_optim_loss: 12585114.7588; val_kl_reg_loss: 20322.8093; val_edge_recon_loss: 2693010.2632; val_gene_expr_recon_loss: 9958042.2763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12671375.3158; val_optim_loss: 12671375.3158
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9625; val_auprc_score: 0.9540; val_best_acc_score: 0.9051; val_best_f1_score: 0.9095; train_kl_reg_loss: 21138.1069; train_edge_recon_loss: 2632493.9963; train_gene_expr_recon_loss: 9922993.3000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12576625.4074; train_optim_loss: 12576625.4074; val_kl_reg_loss: 20376.5093; val_edge_recon_loss: 2688840.2632; val_gene_expr_recon_loss: 9954341.4342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12663558.2500; val_optim_loss: 12663558.2500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9623; val_auprc_score: 0.9536; val_best_acc_score: 0.9053; val_best_f1_score: 0.9098; train_kl_reg_loss: 21076.8416; train_edge_recon_loss: 2630521.6154; train_gene_expr_recon_loss: 9919356.6647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12570955.1000; train_optim_loss: 12570955.1000; val_kl_reg_loss: 20788.1408; val_edge_recon_loss: 2686153.6020; val_gene_expr_recon_loss: 9960651.0658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12667592.8158; val_optim_loss: 12667592.8158

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9630; val_auprc_score: 0.9547; val_best_acc_score: 0.9055; val_best_f1_score: 0.9097; train_kl_reg_loss: 21103.8135; train_edge_recon_loss: 2631012.6478; train_gene_expr_recon_loss: 9884176.7029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12536293.1706; train_optim_loss: 12536293.1706; val_kl_reg_loss: 20548.1707; val_edge_recon_loss: 2688441.0296; val_gene_expr_recon_loss: 9925723.3816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12634712.5658; val_optim_loss: 12634712.5658
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9626; val_auprc_score: 0.9537; val_best_acc_score: 0.9061; val_best_f1_score: 0.9102; train_kl_reg_loss: 21006.7517; train_edge_recon_loss: 2628972.1324; train_gene_expr_recon_loss: 9876403.1676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12526382.0691; train_optim_loss: 12526382.0691; val_kl_reg_loss: 20491.9457; val_edge_recon_loss: 2686762.4901; val_gene_expr_recon_loss: 9901647.3684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12608901.8816; val_optim_loss: 12608901.8816
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9633; val_auprc_score: 0.9547; val_best_acc_score: 0.9074; val_best_f1_score: 0.9112; train_kl_reg_loss: 21023.1409; train_edge_recon_loss: 2626936.6386; train_gene_expr_recon_loss: 9880560.7559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12528520.5471; train_optim_loss: 12528520.5471; val_kl_reg_loss: 20486.5114; val_edge_recon_loss: 2687121.1546; val_gene_expr_recon_loss: 9909679.1842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12617286.8421; val_optim_loss: 12617286.8421
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9636; val_auprc_score: 0.9557; val_best_acc_score: 0.9072; val_best_f1_score: 0.9109; train_kl_reg_loss: 21039.5302; train_edge_recon_loss: 2629550.7033; train_gene_expr_recon_loss: 9877942.1515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12528532.4000; train_optim_loss: 12528532.4000; val_kl_reg_loss: 20578.4607; val_edge_recon_loss: 2685424.0395; val_gene_expr_recon_loss: 9902341.9737; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12608344.4737; val_optim_loss: 12608344.4737
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9645; val_auprc_score: 0.9570; val_best_acc_score: 0.9086; val_best_f1_score: 0.9123; train_kl_reg_loss: 21066.8452; train_edge_recon_loss: 2629263.2846; train_gene_expr_recon_loss: 9880935.8868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12531266.0294; train_optim_loss: 12531266.0294; val_kl_reg_loss: 20431.4378; val_edge_recon_loss: 2680398.1941; val_gene_expr_recon_loss: 9902308.3026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12603137.9211; val_optim_loss: 12603137.9211
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9640; val_auprc_score: 0.9568; val_best_acc_score: 0.9069; val_best_f1_score: 0.9109; train_kl_reg_loss: 20975.5976; train_edge_recon_loss: 2628454.3680; train_gene_expr_recon_loss: 9880060.5853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12529490.5397; train_optim_loss: 12529490.5397; val_kl_reg_loss: 20447.0404; val_edge_recon_loss: 2687779.5888; val_gene_expr_recon_loss: 9920285.1316; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12628511.7763; val_optim_loss: 12628511.7763
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9650; val_auprc_score: 0.9577; val_best_acc_score: 0.9084; val_best_f1_score: 0.9122; train_kl_reg_loss: 21063.6143; train_edge_recon_loss: 2627639.1199; train_gene_expr_recon_loss: 9879064.0912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12527766.8309; train_optim_loss: 12527766.8309; val_kl_reg_loss: 20481.7795; val_edge_recon_loss: 2682748.4112; val_gene_expr_recon_loss: 9914509.7105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12617739.8947; val_optim_loss: 12617739.8947
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9635; val_auprc_score: 0.9555; val_best_acc_score: 0.9071; val_best_f1_score: 0.9114; train_kl_reg_loss: 21049.7252; train_edge_recon_loss: 2627283.1158; train_gene_expr_recon_loss: 9874096.7471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12522429.5765; train_optim_loss: 12522429.5765; val_kl_reg_loss: 20478.4988; val_edge_recon_loss: 2682670.0362; val_gene_expr_recon_loss: 9913916.4342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12617064.9737; val_optim_loss: 12617064.9737
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9644; val_auprc_score: 0.9562; val_best_acc_score: 0.9085; val_best_f1_score: 0.9126; train_kl_reg_loss: 20996.1429; train_edge_recon_loss: 2628275.7283; train_gene_expr_recon_loss: 9874826.5838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12524098.4618; train_optim_loss: 12524098.4618; val_kl_reg_loss: 20516.8411; val_edge_recon_loss: 2682199.4441; val_gene_expr_recon_loss: 9903290.4868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12606006.7105; val_optim_loss: 12606006.7105

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9634; val_auprc_score: 0.9547; val_best_acc_score: 0.9072; val_best_f1_score: 0.9108; train_kl_reg_loss: 21014.3974; train_edge_recon_loss: 2629026.8221; train_gene_expr_recon_loss: 9874040.5765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12524081.7897; train_optim_loss: 12524081.7897; val_kl_reg_loss: 20491.4117; val_edge_recon_loss: 2683587.0757; val_gene_expr_recon_loss: 9905154.0789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12609232.5789; val_optim_loss: 12609232.5789
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9639; val_auprc_score: 0.9552; val_best_acc_score: 0.9083; val_best_f1_score: 0.9118; train_kl_reg_loss: 20999.7844; train_edge_recon_loss: 2628244.0151; train_gene_expr_recon_loss: 9868132.7338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12517376.5338; train_optim_loss: 12517376.5338; val_kl_reg_loss: 20491.6496; val_edge_recon_loss: 2683442.7270; val_gene_expr_recon_loss: 9905381.8553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12609316.2763; val_optim_loss: 12609316.2763
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9638; val_auprc_score: 0.9552; val_best_acc_score: 0.9081; val_best_f1_score: 0.9119; train_kl_reg_loss: 21018.3463; train_edge_recon_loss: 2626793.9710; train_gene_expr_recon_loss: 9869516.8853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12517329.1794; train_optim_loss: 12517329.1794; val_kl_reg_loss: 20513.1243; val_edge_recon_loss: 2685258.3289; val_gene_expr_recon_loss: 9927000.6184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12632772.1184; val_optim_loss: 12632772.1184
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9641; val_auprc_score: 0.9558; val_best_acc_score: 0.9080; val_best_f1_score: 0.9119; train_kl_reg_loss: 21006.9811; train_edge_recon_loss: 2627645.1026; train_gene_expr_recon_loss: 9867062.3971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12515714.4794; train_optim_loss: 12515714.4794; val_kl_reg_loss: 20478.7075; val_edge_recon_loss: 2682513.0493; val_gene_expr_recon_loss: 9916524.2237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12619515.8947; val_optim_loss: 12619515.8947

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 35 min 18 sec.
Using best model state, which was in epoch 27.
