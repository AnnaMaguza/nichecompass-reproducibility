None
Run timestamp: 11082023_103538_93.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_93']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9126; val_auprc_score: 0.8889; val_best_acc_score: 0.8425; val_best_f1_score: 0.8527; train_kl_reg_loss: 35289.7265; train_edge_recon_loss: 2926076.9482; train_gene_expr_recon_loss: 12860089.6074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 15821456.2691; train_optim_loss: 15821456.2691; val_kl_reg_loss: 37928.7242; val_edge_recon_loss: 2787862.6711; val_gene_expr_recon_loss: 11805418.7763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 14631210.1447; val_optim_loss: 14631210.1447
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9270; val_auprc_score: 0.9055; val_best_acc_score: 0.8622; val_best_f1_score: 0.8711; train_kl_reg_loss: 37456.3879; train_edge_recon_loss: 2710696.6529; train_gene_expr_recon_loss: 11423286.7250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 14171439.7647; train_optim_loss: 14171439.7647; val_kl_reg_loss: 34184.4604; val_edge_recon_loss: 2735758.7730; val_gene_expr_recon_loss: 11143030.4868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13912973.7368; val_optim_loss: 13912973.7368
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9317; val_auprc_score: 0.9118; val_best_acc_score: 0.8675; val_best_f1_score: 0.8769; train_kl_reg_loss: 32614.2174; train_edge_recon_loss: 2686282.3585; train_gene_expr_recon_loss: 10925722.4426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13644619.0015; train_optim_loss: 13644619.0015; val_kl_reg_loss: 29763.4545; val_edge_recon_loss: 2730421.9145; val_gene_expr_recon_loss: 10775657.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13535842.3947; val_optim_loss: 13535842.3947
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9394; val_auprc_score: 0.9225; val_best_acc_score: 0.8765; val_best_f1_score: 0.8842; train_kl_reg_loss: 29116.4102; train_edge_recon_loss: 2674737.2551; train_gene_expr_recon_loss: 10610928.1088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13314781.7588; train_optim_loss: 13314781.7588; val_kl_reg_loss: 27065.8118; val_edge_recon_loss: 2717050.7566; val_gene_expr_recon_loss: 10524900.6974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13269017.2632; val_optim_loss: 13269017.2632
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9417; val_auprc_score: 0.9250; val_best_acc_score: 0.8805; val_best_f1_score: 0.8884; train_kl_reg_loss: 27344.7953; train_edge_recon_loss: 2664166.2026; train_gene_expr_recon_loss: 10405681.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13097192.5088; train_optim_loss: 13097192.5088; val_kl_reg_loss: 26274.4501; val_edge_recon_loss: 2710956.8224; val_gene_expr_recon_loss: 10373361.8158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13110593.1053; val_optim_loss: 13110593.1053
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9439; val_auprc_score: 0.9279; val_best_acc_score: 0.8831; val_best_f1_score: 0.8901; train_kl_reg_loss: 26383.7826; train_edge_recon_loss: 2659769.3136; train_gene_expr_recon_loss: 10271899.0397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12958052.1206; train_optim_loss: 12958052.1206; val_kl_reg_loss: 25135.5047; val_edge_recon_loss: 2710752.2270; val_gene_expr_recon_loss: 10237895.1842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12973782.8684; val_optim_loss: 12973782.8684
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9458; val_auprc_score: 0.9300; val_best_acc_score: 0.8859; val_best_f1_score: 0.8929; train_kl_reg_loss: 25636.9017; train_edge_recon_loss: 2655404.3618; train_gene_expr_recon_loss: 10176376.9221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12857418.1662; train_optim_loss: 12857418.1662; val_kl_reg_loss: 25032.2753; val_edge_recon_loss: 2701102.6250; val_gene_expr_recon_loss: 10185809.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12911944.1447; val_optim_loss: 12911944.1447
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9473; val_auprc_score: 0.9340; val_best_acc_score: 0.8861; val_best_f1_score: 0.8924; train_kl_reg_loss: 25113.3106; train_edge_recon_loss: 2651648.1669; train_gene_expr_recon_loss: 10106543.9735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12783305.4765; train_optim_loss: 12783305.4765; val_kl_reg_loss: 24111.9992; val_edge_recon_loss: 2703910.9474; val_gene_expr_recon_loss: 10118146.5132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12846169.4474; val_optim_loss: 12846169.4474
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9495; val_auprc_score: 0.9362; val_best_acc_score: 0.8883; val_best_f1_score: 0.8945; train_kl_reg_loss: 24461.5864; train_edge_recon_loss: 2649307.2842; train_gene_expr_recon_loss: 10064823.4735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12738592.3235; train_optim_loss: 12738592.3235; val_kl_reg_loss: 23594.9482; val_edge_recon_loss: 2703822.4474; val_gene_expr_recon_loss: 10083310.5658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12810727.9605; val_optim_loss: 12810727.9605
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9533; val_auprc_score: 0.9421; val_best_acc_score: 0.8909; val_best_f1_score: 0.8966; train_kl_reg_loss: 23827.2050; train_edge_recon_loss: 2649846.6945; train_gene_expr_recon_loss: 10029833.0059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12703506.9015; train_optim_loss: 12703506.9015; val_kl_reg_loss: 23062.0675; val_edge_recon_loss: 2692992.1349; val_gene_expr_recon_loss: 10073155.9737; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12789210.1447; val_optim_loss: 12789210.1447
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9533; val_auprc_score: 0.9420; val_best_acc_score: 0.8922; val_best_f1_score: 0.8979; train_kl_reg_loss: 23454.3427; train_edge_recon_loss: 2645548.3956; train_gene_expr_recon_loss: 10005860.5647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12674863.3309; train_optim_loss: 12674863.3309; val_kl_reg_loss: 22652.5385; val_edge_recon_loss: 2698647.8355; val_gene_expr_recon_loss: 10051058.3553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12772358.7368; val_optim_loss: 12772358.7368
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9549; val_auprc_score: 0.9448; val_best_acc_score: 0.8935; val_best_f1_score: 0.8993; train_kl_reg_loss: 23055.9868; train_edge_recon_loss: 2645672.7364; train_gene_expr_recon_loss: 9994836.8824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12663565.6265; train_optim_loss: 12663565.6265; val_kl_reg_loss: 22270.9409; val_edge_recon_loss: 2695999.9934; val_gene_expr_recon_loss: 10024601.0263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12742871.8816; val_optim_loss: 12742871.8816
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9573; val_auprc_score: 0.9469; val_best_acc_score: 0.8977; val_best_f1_score: 0.9027; train_kl_reg_loss: 22752.0567; train_edge_recon_loss: 2643158.1551; train_gene_expr_recon_loss: 9976769.0309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12642679.2368; train_optim_loss: 12642679.2368; val_kl_reg_loss: 21912.1432; val_edge_recon_loss: 2687453.5987; val_gene_expr_recon_loss: 10029867.6711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12739233.4079; val_optim_loss: 12739233.4079
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9563; val_auprc_score: 0.9448; val_best_acc_score: 0.8973; val_best_f1_score: 0.9020; train_kl_reg_loss: 22527.4739; train_edge_recon_loss: 2640315.9555; train_gene_expr_recon_loss: 9961506.5176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12624349.9529; train_optim_loss: 12624349.9529; val_kl_reg_loss: 21572.2102; val_edge_recon_loss: 2693633.5921; val_gene_expr_recon_loss: 9999930.4737; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12715136.2500; val_optim_loss: 12715136.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9600; val_auprc_score: 0.9506; val_best_acc_score: 0.9013; val_best_f1_score: 0.9056; train_kl_reg_loss: 22150.0267; train_edge_recon_loss: 2639549.8062; train_gene_expr_recon_loss: 9956166.9809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12617866.8059; train_optim_loss: 12617866.8059; val_kl_reg_loss: 21250.2436; val_edge_recon_loss: 2685940.6809; val_gene_expr_recon_loss: 10006513.9079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12713704.8026; val_optim_loss: 12713704.8026
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9585; val_auprc_score: 0.9484; val_best_acc_score: 0.8990; val_best_f1_score: 0.9036; train_kl_reg_loss: 21892.3228; train_edge_recon_loss: 2638835.2165; train_gene_expr_recon_loss: 9946833.0118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12607560.5691; train_optim_loss: 12607560.5691; val_kl_reg_loss: 21289.1021; val_edge_recon_loss: 2690702.5921; val_gene_expr_recon_loss: 10023444.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12735436.2105; val_optim_loss: 12735436.2105
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9604; val_auprc_score: 0.9512; val_best_acc_score: 0.9012; val_best_f1_score: 0.9057; train_kl_reg_loss: 21745.7395; train_edge_recon_loss: 2634343.6015; train_gene_expr_recon_loss: 9934289.6132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12590378.9500; train_optim_loss: 12590378.9500; val_kl_reg_loss: 21201.2397; val_edge_recon_loss: 2689067.2204; val_gene_expr_recon_loss: 9975991.4605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12686259.9605; val_optim_loss: 12686259.9605
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9610; val_auprc_score: 0.9511; val_best_acc_score: 0.9049; val_best_f1_score: 0.9087; train_kl_reg_loss: 21638.6027; train_edge_recon_loss: 2637318.2184; train_gene_expr_recon_loss: 9933428.9294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12592385.7471; train_optim_loss: 12592385.7471; val_kl_reg_loss: 20981.2392; val_edge_recon_loss: 2685336.5197; val_gene_expr_recon_loss: 9999358.5263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12705676.2895; val_optim_loss: 12705676.2895
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9619; val_auprc_score: 0.9526; val_best_acc_score: 0.9038; val_best_f1_score: 0.9080; train_kl_reg_loss: 21377.7554; train_edge_recon_loss: 2634545.8276; train_gene_expr_recon_loss: 9929060.7279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12584984.2912; train_optim_loss: 12584984.2912; val_kl_reg_loss: 20780.5359; val_edge_recon_loss: 2688312.3618; val_gene_expr_recon_loss: 9982016.6053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12691109.4737; val_optim_loss: 12691109.4737
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9629; val_auprc_score: 0.9545; val_best_acc_score: 0.9053; val_best_f1_score: 0.9095; train_kl_reg_loss: 21324.6299; train_edge_recon_loss: 2633644.1860; train_gene_expr_recon_loss: 9929663.8059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12584632.6324; train_optim_loss: 12584632.6324; val_kl_reg_loss: 20689.4848; val_edge_recon_loss: 2684106.9342; val_gene_expr_recon_loss: 9995717.3421; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12700513.7763; val_optim_loss: 12700513.7763
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9631; val_auprc_score: 0.9544; val_best_acc_score: 0.9063; val_best_f1_score: 0.9102; train_kl_reg_loss: 21164.6061; train_edge_recon_loss: 2631988.3706; train_gene_expr_recon_loss: 9922978.4647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12576131.4574; train_optim_loss: 12576131.4574; val_kl_reg_loss: 20807.9868; val_edge_recon_loss: 2688658.6414; val_gene_expr_recon_loss: 9984860.1711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12694326.8684; val_optim_loss: 12694326.8684

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9629; val_auprc_score: 0.9541; val_best_acc_score: 0.9066; val_best_f1_score: 0.9101; train_kl_reg_loss: 21242.8046; train_edge_recon_loss: 2629341.6143; train_gene_expr_recon_loss: 9878992.4044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12529576.8103; train_optim_loss: 12529576.8103; val_kl_reg_loss: 20585.1464; val_edge_recon_loss: 2686304.8158; val_gene_expr_recon_loss: 9959121.9474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12666011.8289; val_optim_loss: 12666011.8289
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9643; val_auprc_score: 0.9560; val_best_acc_score: 0.9082; val_best_f1_score: 0.9119; train_kl_reg_loss: 21131.4414; train_edge_recon_loss: 2630728.0588; train_gene_expr_recon_loss: 9876377.1647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12528236.6618; train_optim_loss: 12528236.6618; val_kl_reg_loss: 20526.7345; val_edge_recon_loss: 2681960.2895; val_gene_expr_recon_loss: 9951465.6579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12653952.6316; val_optim_loss: 12653952.6316
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9631; val_auprc_score: 0.9545; val_best_acc_score: 0.9077; val_best_f1_score: 0.9111; train_kl_reg_loss: 21143.3451; train_edge_recon_loss: 2629851.6717; train_gene_expr_recon_loss: 9873098.3338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12524093.3515; train_optim_loss: 12524093.3515; val_kl_reg_loss: 20511.3933; val_edge_recon_loss: 2684248.5822; val_gene_expr_recon_loss: 9934142.1579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12638902.1711; val_optim_loss: 12638902.1711
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9646; val_auprc_score: 0.9567; val_best_acc_score: 0.9079; val_best_f1_score: 0.9119; train_kl_reg_loss: 21152.6217; train_edge_recon_loss: 2629122.5691; train_gene_expr_recon_loss: 9877353.8853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12527629.0559; train_optim_loss: 12527629.0559; val_kl_reg_loss: 20588.1149; val_edge_recon_loss: 2682746.1842; val_gene_expr_recon_loss: 9952414.5263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12655748.7763; val_optim_loss: 12655748.7763
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9631; val_auprc_score: 0.9547; val_best_acc_score: 0.9068; val_best_f1_score: 0.9106; train_kl_reg_loss: 21130.7030; train_edge_recon_loss: 2629638.4224; train_gene_expr_recon_loss: 9876935.2426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12527704.3515; train_optim_loss: 12527704.3515; val_kl_reg_loss: 20612.3588; val_edge_recon_loss: 2687213.3717; val_gene_expr_recon_loss: 9928054.7237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12635880.4211; val_optim_loss: 12635880.4211
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9638; val_auprc_score: 0.9551; val_best_acc_score: 0.9076; val_best_f1_score: 0.9114; train_kl_reg_loss: 21170.3871; train_edge_recon_loss: 2628755.0272; train_gene_expr_recon_loss: 9871000.1544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12520925.5706; train_optim_loss: 12520925.5706; val_kl_reg_loss: 20630.7942; val_edge_recon_loss: 2680009.5954; val_gene_expr_recon_loss: 9929508.2895; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12630148.6316; val_optim_loss: 12630148.6316
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9631; val_auprc_score: 0.9541; val_best_acc_score: 0.9068; val_best_f1_score: 0.9107; train_kl_reg_loss: 21216.8604; train_edge_recon_loss: 2627677.8507; train_gene_expr_recon_loss: 9874597.6015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12523492.3250; train_optim_loss: 12523492.3250; val_kl_reg_loss: 20548.3782; val_edge_recon_loss: 2685253.7862; val_gene_expr_recon_loss: 9947935.3026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12653737.4211; val_optim_loss: 12653737.4211
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9644; val_auprc_score: 0.9565; val_best_acc_score: 0.9078; val_best_f1_score: 0.9119; train_kl_reg_loss: 21152.7988; train_edge_recon_loss: 2629845.9912; train_gene_expr_recon_loss: 9873629.3029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12524628.0926; train_optim_loss: 12524628.0926; val_kl_reg_loss: 20604.6109; val_edge_recon_loss: 2684432.9145; val_gene_expr_recon_loss: 9939951.6711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12644989.1974; val_optim_loss: 12644989.1974
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9645; val_auprc_score: 0.9565; val_best_acc_score: 0.9084; val_best_f1_score: 0.9120; train_kl_reg_loss: 21066.3895; train_edge_recon_loss: 2631386.0110; train_gene_expr_recon_loss: 9876848.2941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12529300.7000; train_optim_loss: 12529300.7000; val_kl_reg_loss: 20425.6443; val_edge_recon_loss: 2682235.0757; val_gene_expr_recon_loss: 9941305.5132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12643966.1842; val_optim_loss: 12643966.1842
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9636; val_auprc_score: 0.9545; val_best_acc_score: 0.9081; val_best_f1_score: 0.9121; train_kl_reg_loss: 21052.0784; train_edge_recon_loss: 2630027.6566; train_gene_expr_recon_loss: 9869640.0882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12520719.8118; train_optim_loss: 12520719.8118; val_kl_reg_loss: 20414.2711; val_edge_recon_loss: 2685560.9572; val_gene_expr_recon_loss: 9947041.3421; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12653016.5789; val_optim_loss: 12653016.5789

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9637; val_auprc_score: 0.9554; val_best_acc_score: 0.9076; val_best_f1_score: 0.9116; train_kl_reg_loss: 20982.0743; train_edge_recon_loss: 2629775.9794; train_gene_expr_recon_loss: 9869697.7015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12520455.7456; train_optim_loss: 12520455.7456; val_kl_reg_loss: 20424.9165; val_edge_recon_loss: 2683399.7007; val_gene_expr_recon_loss: 9925115.8816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12628940.4868; val_optim_loss: 12628940.4868
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9649; val_auprc_score: 0.9566; val_best_acc_score: 0.9097; val_best_f1_score: 0.9135; train_kl_reg_loss: 21020.5551; train_edge_recon_loss: 2627112.4419; train_gene_expr_recon_loss: 9867844.4176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12515977.4500; train_optim_loss: 12515977.4500; val_kl_reg_loss: 20444.0384; val_edge_recon_loss: 2684435.9836; val_gene_expr_recon_loss: 9937515.4079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12642395.3816; val_optim_loss: 12642395.3816
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9640; val_auprc_score: 0.9559; val_best_acc_score: 0.9072; val_best_f1_score: 0.9110; train_kl_reg_loss: 21030.9106; train_edge_recon_loss: 2628208.2121; train_gene_expr_recon_loss: 9868364.4353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12517603.5515; train_optim_loss: 12517603.5515; val_kl_reg_loss: 20463.2140; val_edge_recon_loss: 2685025.6480; val_gene_expr_recon_loss: 9955753.7237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12661242.5789; val_optim_loss: 12661242.5789
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9638; val_auprc_score: 0.9553; val_best_acc_score: 0.9082; val_best_f1_score: 0.9118; train_kl_reg_loss: 21013.1893; train_edge_recon_loss: 2627868.4838; train_gene_expr_recon_loss: 9869263.7809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12518145.4574; train_optim_loss: 12518145.4574; val_kl_reg_loss: 20449.3710; val_edge_recon_loss: 2687087.7961; val_gene_expr_recon_loss: 9934955.8026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12642493.0132; val_optim_loss: 12642493.0132
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9642; val_auprc_score: 0.9563; val_best_acc_score: 0.9079; val_best_f1_score: 0.9118; train_kl_reg_loss: 21016.4563; train_edge_recon_loss: 2627455.8132; train_gene_expr_recon_loss: 9866036.0059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12514508.2721; train_optim_loss: 12514508.2721; val_kl_reg_loss: 20463.5896; val_edge_recon_loss: 2686315.2895; val_gene_expr_recon_loss: 9934642.4868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12641421.3553; val_optim_loss: 12641421.3553

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9645; val_auprc_score: 0.9558; val_best_acc_score: 0.9085; val_best_f1_score: 0.9121; train_kl_reg_loss: 21026.1420; train_edge_recon_loss: 2628283.9522; train_gene_expr_recon_loss: 9867247.0971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12516557.1956; train_optim_loss: 12516557.1956; val_kl_reg_loss: 20467.4686; val_edge_recon_loss: 2683621.5329; val_gene_expr_recon_loss: 9949008.5921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12653097.5658; val_optim_loss: 12653097.5658
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9651; val_auprc_score: 0.9571; val_best_acc_score: 0.9103; val_best_f1_score: 0.9139; train_kl_reg_loss: 21033.0723; train_edge_recon_loss: 2626940.1717; train_gene_expr_recon_loss: 9868068.8618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12516042.1044; train_optim_loss: 12516042.1044; val_kl_reg_loss: 20454.0226; val_edge_recon_loss: 2677397.5789; val_gene_expr_recon_loss: 9942931.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12640782.7895; val_optim_loss: 12640782.7895
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9645; val_auprc_score: 0.9569; val_best_acc_score: 0.9075; val_best_f1_score: 0.9113; train_kl_reg_loss: 21027.9883; train_edge_recon_loss: 2627787.1287; train_gene_expr_recon_loss: 9865820.4721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12514635.5721; train_optim_loss: 12514635.5721; val_kl_reg_loss: 20467.3696; val_edge_recon_loss: 2687307.1941; val_gene_expr_recon_loss: 9947594.1579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12655368.6579; val_optim_loss: 12655368.6579
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9644; val_auprc_score: 0.9557; val_best_acc_score: 0.9094; val_best_f1_score: 0.9129; train_kl_reg_loss: 21028.6694; train_edge_recon_loss: 2626912.8235; train_gene_expr_recon_loss: 9864728.9176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12512670.4118; train_optim_loss: 12512670.4118; val_kl_reg_loss: 20464.3914; val_edge_recon_loss: 2682664.5592; val_gene_expr_recon_loss: 9931943.8026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12635072.7105; val_optim_loss: 12635072.7105

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 39 min 32 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
val AUROC score: 0.9652
val AUPRC score: 0.9572
val best accuracy score: 0.9092
val best F1 score: 0.9128
val target rna MSE score: 1.4923
val source rna MSE score: 0.2613

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
