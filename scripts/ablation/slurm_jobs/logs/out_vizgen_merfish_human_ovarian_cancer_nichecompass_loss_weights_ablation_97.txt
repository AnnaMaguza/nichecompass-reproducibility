None
Run timestamp: 18072023_045446_97.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_97']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9701; val_auprc_score: 0.9676; val_best_acc_score: 0.9129; val_best_f1_score: 0.9142; train_kl_reg_loss: 16981.3415; train_edge_recon_loss: 26635165.9430; train_gene_expr_recon_loss: 1704627.7361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28356775.0183; train_optim_loss: 28356775.0183; val_kl_reg_loss: 17914.8039; val_edge_recon_loss: 26604557.5455; val_gene_expr_recon_loss: 1530731.9739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28153204.2545; val_optim_loss: 28153204.2545
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9741; val_auprc_score: 0.9708; val_best_acc_score: 0.9208; val_best_f1_score: 0.9218; train_kl_reg_loss: 19764.2436; train_edge_recon_loss: 26082438.8147; train_gene_expr_recon_loss: 1473114.4780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27575317.5336; train_optim_loss: 27575317.5336; val_kl_reg_loss: 20660.5828; val_edge_recon_loss: 26497614.4364; val_gene_expr_recon_loss: 1426986.2807; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27945261.3273; val_optim_loss: 27945261.3273
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9771; val_auprc_score: 0.9741; val_best_acc_score: 0.9263; val_best_f1_score: 0.9273; train_kl_reg_loss: 21677.0389; train_edge_recon_loss: 26015842.1955; train_gene_expr_recon_loss: 1403854.4857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27441373.7393; train_optim_loss: 27441373.7393; val_kl_reg_loss: 21556.2895; val_edge_recon_loss: 26471650.1455; val_gene_expr_recon_loss: 1376985.7114; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27870192.1091; val_optim_loss: 27870192.1091
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9794; val_auprc_score: 0.9769; val_best_acc_score: 0.9300; val_best_f1_score: 0.9307; train_kl_reg_loss: 23063.7804; train_edge_recon_loss: 25973917.9532; train_gene_expr_recon_loss: 1364468.8882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27361450.6395; train_optim_loss: 27361450.6395; val_kl_reg_loss: 22969.3700; val_edge_recon_loss: 26422055.5818; val_gene_expr_recon_loss: 1347729.6966; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27792754.7273; val_optim_loss: 27792754.7273
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9806; val_auprc_score: 0.9779; val_best_acc_score: 0.9343; val_best_f1_score: 0.9350; train_kl_reg_loss: 23620.9096; train_edge_recon_loss: 25953489.2709; train_gene_expr_recon_loss: 1342704.1558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27319814.2790; train_optim_loss: 27319814.2790; val_kl_reg_loss: 23538.0982; val_edge_recon_loss: 26380825.5455; val_gene_expr_recon_loss: 1330736.8693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27735100.3273; val_optim_loss: 27735100.3273
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9817; val_auprc_score: 0.9788; val_best_acc_score: 0.9363; val_best_f1_score: 0.9371; train_kl_reg_loss: 24192.3858; train_edge_recon_loss: 25942352.3462; train_gene_expr_recon_loss: 1326947.7338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27293492.4644; train_optim_loss: 27293492.4644; val_kl_reg_loss: 23337.1739; val_edge_recon_loss: 26395183.8909; val_gene_expr_recon_loss: 1320113.4341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27738634.4727; val_optim_loss: 27738634.4727
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9830; val_auprc_score: 0.9804; val_best_acc_score: 0.9382; val_best_f1_score: 0.9389; train_kl_reg_loss: 24206.2336; train_edge_recon_loss: 25902490.6253; train_gene_expr_recon_loss: 1316287.6293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27242984.4582; train_optim_loss: 27242984.4582; val_kl_reg_loss: 23471.2452; val_edge_recon_loss: 26343897.3818; val_gene_expr_recon_loss: 1312148.3886; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27679517.1091; val_optim_loss: 27679517.1091
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9826; val_auprc_score: 0.9801; val_best_acc_score: 0.9384; val_best_f1_score: 0.9391; train_kl_reg_loss: 25194.8255; train_edge_recon_loss: 25881365.9226; train_gene_expr_recon_loss: 1306310.0642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27212870.8534; train_optim_loss: 27212870.8534; val_kl_reg_loss: 25777.8376; val_edge_recon_loss: 26326417.7818; val_gene_expr_recon_loss: 1298810.3784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27651006.0000; val_optim_loss: 27651006.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9834; val_auprc_score: 0.9811; val_best_acc_score: 0.9389; val_best_f1_score: 0.9398; train_kl_reg_loss: 24909.5236; train_edge_recon_loss: 25881589.3401; train_gene_expr_recon_loss: 1299723.1403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27206222.0326; train_optim_loss: 27206222.0326; val_kl_reg_loss: 24301.5667; val_edge_recon_loss: 26359659.2909; val_gene_expr_recon_loss: 1293110.2693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27677071.1273; val_optim_loss: 27677071.1273
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9850; val_auprc_score: 0.9828; val_best_acc_score: 0.9431; val_best_f1_score: 0.9439; train_kl_reg_loss: 25139.3477; train_edge_recon_loss: 25877863.2912; train_gene_expr_recon_loss: 1292300.2634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27195302.9206; train_optim_loss: 27195302.9206; val_kl_reg_loss: 24603.8130; val_edge_recon_loss: 26281514.4000; val_gene_expr_recon_loss: 1289687.5443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27595805.6364; val_optim_loss: 27595805.6364
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9847; val_auprc_score: 0.9820; val_best_acc_score: 0.9424; val_best_f1_score: 0.9433; train_kl_reg_loss: 24657.9070; train_edge_recon_loss: 25862427.1365; train_gene_expr_recon_loss: 1289845.1824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27176930.1853; train_optim_loss: 27176930.1853; val_kl_reg_loss: 24185.4954; val_edge_recon_loss: 26326270.1636; val_gene_expr_recon_loss: 1284258.4420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27634714.2000; val_optim_loss: 27634714.2000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9856; val_auprc_score: 0.9835; val_best_acc_score: 0.9444; val_best_f1_score: 0.9450; train_kl_reg_loss: 24920.7084; train_edge_recon_loss: 25853324.8717; train_gene_expr_recon_loss: 1284521.5410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27162767.1507; train_optim_loss: 27162767.1507; val_kl_reg_loss: 23698.9226; val_edge_recon_loss: 26337344.1455; val_gene_expr_recon_loss: 1282597.0739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27643640.1273; val_optim_loss: 27643640.1273
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9863; val_auprc_score: 0.9845; val_best_acc_score: 0.9457; val_best_f1_score: 0.9464; train_kl_reg_loss: 24812.4779; train_edge_recon_loss: 25841101.5214; train_gene_expr_recon_loss: 1281116.4160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27147030.4175; train_optim_loss: 27147030.4175; val_kl_reg_loss: 24251.6821; val_edge_recon_loss: 26271922.9273; val_gene_expr_recon_loss: 1279378.9818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27575553.7455; val_optim_loss: 27575553.7455
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9858; val_auprc_score: 0.9838; val_best_acc_score: 0.9441; val_best_f1_score: 0.9447; train_kl_reg_loss: 24738.1529; train_edge_recon_loss: 25824975.4257; train_gene_expr_recon_loss: 1278981.9857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27128695.5234; train_optim_loss: 27128695.5234; val_kl_reg_loss: 23439.2697; val_edge_recon_loss: 26335192.9091; val_gene_expr_recon_loss: 1291706.5205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27650338.8000; val_optim_loss: 27650338.8000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9865; val_auprc_score: 0.9843; val_best_acc_score: 0.9470; val_best_f1_score: 0.9478; train_kl_reg_loss: 24672.5202; train_edge_recon_loss: 25832605.3279; train_gene_expr_recon_loss: 1275826.9268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27133104.7332; train_optim_loss: 27133104.7332; val_kl_reg_loss: 23548.8911; val_edge_recon_loss: 26287408.6909; val_gene_expr_recon_loss: 1275531.7955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27586489.4000; val_optim_loss: 27586489.4000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9870; val_auprc_score: 0.9852; val_best_acc_score: 0.9475; val_best_f1_score: 0.9482; train_kl_reg_loss: 24545.0641; train_edge_recon_loss: 25820055.0876; train_gene_expr_recon_loss: 1275142.3023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27119742.4094; train_optim_loss: 27119742.4094; val_kl_reg_loss: 23660.9916; val_edge_recon_loss: 26290695.7818; val_gene_expr_recon_loss: 1282306.7886; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27596663.5636; val_optim_loss: 27596663.5636
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9881; val_auprc_score: 0.9863; val_best_acc_score: 0.9502; val_best_f1_score: 0.9507; train_kl_reg_loss: 24060.0984; train_edge_recon_loss: 25813182.8350; train_gene_expr_recon_loss: 1271936.7104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27109179.6151; train_optim_loss: 27109179.6151; val_kl_reg_loss: 23397.7619; val_edge_recon_loss: 26257601.8182; val_gene_expr_recon_loss: 1270376.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27551376.4000; val_optim_loss: 27551376.4000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9883; val_auprc_score: 0.9867; val_best_acc_score: 0.9504; val_best_f1_score: 0.9509; train_kl_reg_loss: 24022.2013; train_edge_recon_loss: 25806758.9369; train_gene_expr_recon_loss: 1271593.5752; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27102374.7128; train_optim_loss: 27102374.7128; val_kl_reg_loss: 23928.3956; val_edge_recon_loss: 26242736.7273; val_gene_expr_recon_loss: 1268593.9955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27535259.0909; val_optim_loss: 27535259.0909
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9881; val_auprc_score: 0.9862; val_best_acc_score: 0.9508; val_best_f1_score: 0.9513; train_kl_reg_loss: 24082.4638; train_edge_recon_loss: 25799196.0061; train_gene_expr_recon_loss: 1269302.0165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27092580.4949; train_optim_loss: 27092580.4949; val_kl_reg_loss: 23803.9191; val_edge_recon_loss: 26290297.7091; val_gene_expr_recon_loss: 1265986.6136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27580088.1818; val_optim_loss: 27580088.1818
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9886; val_auprc_score: 0.9865; val_best_acc_score: 0.9531; val_best_f1_score: 0.9535; train_kl_reg_loss: 24041.1420; train_edge_recon_loss: 25800933.8248; train_gene_expr_recon_loss: 1267235.0825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27092210.0468; train_optim_loss: 27092210.0468; val_kl_reg_loss: 23660.5777; val_edge_recon_loss: 26258027.8545; val_gene_expr_recon_loss: 1264540.2818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27546228.7091; val_optim_loss: 27546228.7091
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9885; val_auprc_score: 0.9867; val_best_acc_score: 0.9525; val_best_f1_score: 0.9533; train_kl_reg_loss: 24139.8503; train_edge_recon_loss: 25787385.4542; train_gene_expr_recon_loss: 1266288.7547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27077814.0713; train_optim_loss: 27077814.0713; val_kl_reg_loss: 23545.9914; val_edge_recon_loss: 26239807.0182; val_gene_expr_recon_loss: 1266494.8250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27529847.9091; val_optim_loss: 27529847.9091
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9882; val_auprc_score: 0.9860; val_best_acc_score: 0.9514; val_best_f1_score: 0.9518; train_kl_reg_loss: 24146.3674; train_edge_recon_loss: 25780553.7210; train_gene_expr_recon_loss: 1265444.8541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27070144.9593; train_optim_loss: 27070144.9593; val_kl_reg_loss: 23151.3578; val_edge_recon_loss: 26250530.3091; val_gene_expr_recon_loss: 1264606.7477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27538288.4364; val_optim_loss: 27538288.4364
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9886; val_auprc_score: 0.9867; val_best_acc_score: 0.9525; val_best_f1_score: 0.9531; train_kl_reg_loss: 23617.9554; train_edge_recon_loss: 25787077.0611; train_gene_expr_recon_loss: 1265952.1534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27076647.1609; train_optim_loss: 27076647.1609; val_kl_reg_loss: 23291.4482; val_edge_recon_loss: 26227937.3636; val_gene_expr_recon_loss: 1262917.5375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27514146.2545; val_optim_loss: 27514146.2545
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9893; val_auprc_score: 0.9875; val_best_acc_score: 0.9537; val_best_f1_score: 0.9542; train_kl_reg_loss: 23967.8866; train_edge_recon_loss: 25778229.6314; train_gene_expr_recon_loss: 1263609.0516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27065806.5560; train_optim_loss: 27065806.5560; val_kl_reg_loss: 22906.9357; val_edge_recon_loss: 26219344.7636; val_gene_expr_recon_loss: 1263710.1955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27505961.9636; val_optim_loss: 27505961.9636
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9885; val_auprc_score: 0.9868; val_best_acc_score: 0.9513; val_best_f1_score: 0.9519; train_kl_reg_loss: 23867.8517; train_edge_recon_loss: 25777822.5438; train_gene_expr_recon_loss: 1262020.3321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27063710.7352; train_optim_loss: 27063710.7352; val_kl_reg_loss: 23625.4373; val_edge_recon_loss: 26274533.4364; val_gene_expr_recon_loss: 1261078.4352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27559237.3091; val_optim_loss: 27559237.3091
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9887; val_auprc_score: 0.9867; val_best_acc_score: 0.9532; val_best_f1_score: 0.9536; train_kl_reg_loss: 23799.9119; train_edge_recon_loss: 25766021.6090; train_gene_expr_recon_loss: 1262882.6746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27052704.1955; train_optim_loss: 27052704.1955; val_kl_reg_loss: 23842.1345; val_edge_recon_loss: 26259652.6909; val_gene_expr_recon_loss: 1261647.6523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27545142.3818; val_optim_loss: 27545142.3818
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9889; val_auprc_score: 0.9868; val_best_acc_score: 0.9535; val_best_f1_score: 0.9538; train_kl_reg_loss: 23614.0709; train_edge_recon_loss: 25775658.2383; train_gene_expr_recon_loss: 1261128.5076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27060400.8289; train_optim_loss: 27060400.8289; val_kl_reg_loss: 23149.8307; val_edge_recon_loss: 26246468.1091; val_gene_expr_recon_loss: 1261680.4477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27531298.4000; val_optim_loss: 27531298.4000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9893; val_auprc_score: 0.9875; val_best_acc_score: 0.9545; val_best_f1_score: 0.9550; train_kl_reg_loss: 23585.2201; train_edge_recon_loss: 25767254.2424; train_gene_expr_recon_loss: 1260240.5005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27051079.9674; train_optim_loss: 27051079.9674; val_kl_reg_loss: 22404.4174; val_edge_recon_loss: 26224694.0545; val_gene_expr_recon_loss: 1259720.9864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27506819.4364; val_optim_loss: 27506819.4364

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9897; val_auprc_score: 0.9875; val_best_acc_score: 0.9561; val_best_f1_score: 0.9565; train_kl_reg_loss: 23684.9282; train_edge_recon_loss: 25747248.0672; train_gene_expr_recon_loss: 1247540.2832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27018473.3157; train_optim_loss: 27018473.3157; val_kl_reg_loss: 23493.8102; val_edge_recon_loss: 26208993.5455; val_gene_expr_recon_loss: 1246647.2966; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27479134.7636; val_optim_loss: 27479134.7636
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9901; val_auprc_score: 0.9883; val_best_acc_score: 0.9559; val_best_f1_score: 0.9563; train_kl_reg_loss: 24368.8088; train_edge_recon_loss: 25738222.7373; train_gene_expr_recon_loss: 1245177.7911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27007769.3075; train_optim_loss: 27007769.3075; val_kl_reg_loss: 23863.1309; val_edge_recon_loss: 26210410.7091; val_gene_expr_recon_loss: 1245615.2250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27479889.0727; val_optim_loss: 27479889.0727
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9908; val_auprc_score: 0.9892; val_best_acc_score: 0.9580; val_best_f1_score: 0.9583; train_kl_reg_loss: 24532.5449; train_edge_recon_loss: 25740683.8941; train_gene_expr_recon_loss: 1244811.4479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27010027.8819; train_optim_loss: 27010027.8819; val_kl_reg_loss: 23839.9915; val_edge_recon_loss: 26171076.8545; val_gene_expr_recon_loss: 1244386.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27439302.9818; val_optim_loss: 27439302.9818
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9904; val_auprc_score: 0.9884; val_best_acc_score: 0.9569; val_best_f1_score: 0.9573; train_kl_reg_loss: 24609.3555; train_edge_recon_loss: 25738331.1039; train_gene_expr_recon_loss: 1244077.7653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27007018.2383; train_optim_loss: 27007018.2383; val_kl_reg_loss: 24031.7767; val_edge_recon_loss: 26202132.7636; val_gene_expr_recon_loss: 1245731.5455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27471896.0000; val_optim_loss: 27471896.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9904; val_auprc_score: 0.9887; val_best_acc_score: 0.9570; val_best_f1_score: 0.9574; train_kl_reg_loss: 24788.7694; train_edge_recon_loss: 25736372.5010; train_gene_expr_recon_loss: 1243313.4936; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27004474.7576; train_optim_loss: 27004474.7576; val_kl_reg_loss: 24076.9191; val_edge_recon_loss: 26185831.7091; val_gene_expr_recon_loss: 1243081.6432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27452990.3455; val_optim_loss: 27452990.3455
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9902; val_auprc_score: 0.9882; val_best_acc_score: 0.9568; val_best_f1_score: 0.9573; train_kl_reg_loss: 24648.6311; train_edge_recon_loss: 25733807.0265; train_gene_expr_recon_loss: 1242791.2309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27001246.9165; train_optim_loss: 27001246.9165; val_kl_reg_loss: 23963.2417; val_edge_recon_loss: 26179654.8545; val_gene_expr_recon_loss: 1244154.4136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27447772.4727; val_optim_loss: 27447772.4727
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9904; val_auprc_score: 0.9885; val_best_acc_score: 0.9579; val_best_f1_score: 0.9582; train_kl_reg_loss: 24360.3996; train_edge_recon_loss: 25733398.7210; train_gene_expr_recon_loss: 1242419.4868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27000178.6436; train_optim_loss: 27000178.6436; val_kl_reg_loss: 23656.0735; val_edge_recon_loss: 26183997.6727; val_gene_expr_recon_loss: 1243685.4023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27451339.0727; val_optim_loss: 27451339.0727

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9907; val_auprc_score: 0.9886; val_best_acc_score: 0.9579; val_best_f1_score: 0.9584; train_kl_reg_loss: 24330.7728; train_edge_recon_loss: 25734196.2851; train_gene_expr_recon_loss: 1241426.6613; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26999953.7006; train_optim_loss: 26999953.7006; val_kl_reg_loss: 23639.9213; val_edge_recon_loss: 26185811.7273; val_gene_expr_recon_loss: 1242890.9557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27452342.5273; val_optim_loss: 27452342.5273
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9909; val_auprc_score: 0.9891; val_best_acc_score: 0.9578; val_best_f1_score: 0.9583; train_kl_reg_loss: 24343.8857; train_edge_recon_loss: 25736778.7149; train_gene_expr_recon_loss: 1240873.9076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27001996.5092; train_optim_loss: 27001996.5092; val_kl_reg_loss: 23691.2420; val_edge_recon_loss: 26172418.5091; val_gene_expr_recon_loss: 1241985.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27438095.2000; val_optim_loss: 27438095.2000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9908; val_auprc_score: 0.9892; val_best_acc_score: 0.9578; val_best_f1_score: 0.9583; train_kl_reg_loss: 24333.9800; train_edge_recon_loss: 25735610.6904; train_gene_expr_recon_loss: 1240333.6242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27000278.2811; train_optim_loss: 27000278.2811; val_kl_reg_loss: 23699.1340; val_edge_recon_loss: 26182946.4182; val_gene_expr_recon_loss: 1243654.8920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27450300.4909; val_optim_loss: 27450300.4909
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9904; val_auprc_score: 0.9885; val_best_acc_score: 0.9574; val_best_f1_score: 0.9577; train_kl_reg_loss: 24351.9141; train_edge_recon_loss: 25728079.4297; train_gene_expr_recon_loss: 1240798.5109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26993229.8880; train_optim_loss: 26993229.8880; val_kl_reg_loss: 23732.5639; val_edge_recon_loss: 26215585.4727; val_gene_expr_recon_loss: 1243144.7136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27482462.7273; val_optim_loss: 27482462.7273
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9904; val_auprc_score: 0.9885; val_best_acc_score: 0.9575; val_best_f1_score: 0.9581; train_kl_reg_loss: 24317.7739; train_edge_recon_loss: 25734893.7047; train_gene_expr_recon_loss: 1240590.1053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26999801.5784; train_optim_loss: 26999801.5784; val_kl_reg_loss: 23633.5535; val_edge_recon_loss: 26180367.4364; val_gene_expr_recon_loss: 1242458.8580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27446459.8909; val_optim_loss: 27446459.8909
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9907; val_auprc_score: 0.9892; val_best_acc_score: 0.9579; val_best_f1_score: 0.9582; train_kl_reg_loss: 24354.6694; train_edge_recon_loss: 25734221.6436; train_gene_expr_recon_loss: 1240636.0425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26999212.3951; train_optim_loss: 26999212.3951; val_kl_reg_loss: 23703.0570; val_edge_recon_loss: 26176410.4000; val_gene_expr_recon_loss: 1240377.6534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27440491.1273; val_optim_loss: 27440491.1273

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9905; val_auprc_score: 0.9886; val_best_acc_score: 0.9574; val_best_f1_score: 0.9579; train_kl_reg_loss: 24339.0149; train_edge_recon_loss: 25726517.4644; train_gene_expr_recon_loss: 1240216.7746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26991073.2525; train_optim_loss: 26991073.2525; val_kl_reg_loss: 23699.9217; val_edge_recon_loss: 26196986.2545; val_gene_expr_recon_loss: 1241994.7091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27462680.9091; val_optim_loss: 27462680.9091
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9905; val_auprc_score: 0.9886; val_best_acc_score: 0.9583; val_best_f1_score: 0.9588; train_kl_reg_loss: 24346.9960; train_edge_recon_loss: 25730912.0448; train_gene_expr_recon_loss: 1240219.9449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26995479.0041; train_optim_loss: 26995479.0041; val_kl_reg_loss: 23719.6496; val_edge_recon_loss: 26153760.4364; val_gene_expr_recon_loss: 1240777.1511; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27418257.2364; val_optim_loss: 27418257.2364
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9906; val_auprc_score: 0.9887; val_best_acc_score: 0.9584; val_best_f1_score: 0.9588; train_kl_reg_loss: 24341.0722; train_edge_recon_loss: 25731201.8391; train_gene_expr_recon_loss: 1240404.4397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26995947.3747; train_optim_loss: 26995947.3747; val_kl_reg_loss: 23665.2318; val_edge_recon_loss: 26172745.4727; val_gene_expr_recon_loss: 1241828.4318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27438239.1636; val_optim_loss: 27438239.1636
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9905; val_auprc_score: 0.9885; val_best_acc_score: 0.9575; val_best_f1_score: 0.9578; train_kl_reg_loss: 24339.8285; train_edge_recon_loss: 25729059.6741; train_gene_expr_recon_loss: 1240066.0053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26993465.5051; train_optim_loss: 26993465.5051; val_kl_reg_loss: 23663.8893; val_edge_recon_loss: 26181312.1818; val_gene_expr_recon_loss: 1242220.9432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27447196.8727; val_optim_loss: 27447196.8727
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9905; val_auprc_score: 0.9887; val_best_acc_score: 0.9580; val_best_f1_score: 0.9584; train_kl_reg_loss: 24330.2494; train_edge_recon_loss: 25735588.0041; train_gene_expr_recon_loss: 1240204.7834; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27000123.0143; train_optim_loss: 27000123.0143; val_kl_reg_loss: 23705.8948; val_edge_recon_loss: 26191656.3818; val_gene_expr_recon_loss: 1242738.6852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27458100.9818; val_optim_loss: 27458100.9818
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9908; val_auprc_score: 0.9891; val_best_acc_score: 0.9580; val_best_f1_score: 0.9585; train_kl_reg_loss: 24347.2044; train_edge_recon_loss: 25736409.9328; train_gene_expr_recon_loss: 1240464.3224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27001221.4073; train_optim_loss: 27001221.4073; val_kl_reg_loss: 23695.1681; val_edge_recon_loss: 26181138.4727; val_gene_expr_recon_loss: 1241339.3511; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27446173.0182; val_optim_loss: 27446173.0182

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9906; val_auprc_score: 0.9888; val_best_acc_score: 0.9583; val_best_f1_score: 0.9586; train_kl_reg_loss: 24347.1095; train_edge_recon_loss: 25728243.7373; train_gene_expr_recon_loss: 1240359.2165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26992950.0591; train_optim_loss: 26992950.0591; val_kl_reg_loss: 23645.6553; val_edge_recon_loss: 26188038.2182; val_gene_expr_recon_loss: 1242140.2102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27453824.0182; val_optim_loss: 27453824.0182
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9906; val_auprc_score: 0.9890; val_best_acc_score: 0.9578; val_best_f1_score: 0.9583; train_kl_reg_loss: 24335.3686; train_edge_recon_loss: 25719550.1670; train_gene_expr_recon_loss: 1240524.9456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26984410.4929; train_optim_loss: 26984410.4929; val_kl_reg_loss: 23690.1918; val_edge_recon_loss: 26208043.1818; val_gene_expr_recon_loss: 1239426.0841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27471159.4182; val_optim_loss: 27471159.4182
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9910; val_auprc_score: 0.9890; val_best_acc_score: 0.9586; val_best_f1_score: 0.9590; train_kl_reg_loss: 24346.4450; train_edge_recon_loss: 25735739.6069; train_gene_expr_recon_loss: 1240251.6051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27000337.6904; train_optim_loss: 27000337.6904; val_kl_reg_loss: 23694.9359; val_edge_recon_loss: 26170410.2545; val_gene_expr_recon_loss: 1242078.7705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27436184.0182; val_optim_loss: 27436184.0182
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9907; val_auprc_score: 0.9891; val_best_acc_score: 0.9575; val_best_f1_score: 0.9580; train_kl_reg_loss: 24343.3057; train_edge_recon_loss: 25724968.9409; train_gene_expr_recon_loss: 1240341.9255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26989654.1405; train_optim_loss: 26989654.1405; val_kl_reg_loss: 23719.2641; val_edge_recon_loss: 26191207.9273; val_gene_expr_recon_loss: 1241319.3830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27456246.6182; val_optim_loss: 27456246.6182

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 143 min 20 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
Val AUROC score: 0.9908
Val AUPRC score: 0.9894
Val best accuracy score: 0.9578
Val best F1 score: 0.9581
Val gene expr MSE score: 8.6659

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
