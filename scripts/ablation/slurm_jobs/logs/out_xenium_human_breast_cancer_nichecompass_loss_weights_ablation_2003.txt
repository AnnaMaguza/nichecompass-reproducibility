None
Run timestamp: 16072023_061455_2003.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_2003']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9819; val_auprc_score: 0.9789; val_best_acc_score: 0.9357; val_best_f1_score: 0.9375; train_kl_reg_loss: 17055.8242; train_edge_recon_loss: 2669105.6454; train_gene_expr_recon_loss: 746077.6564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3432239.1269; train_optim_loss: 3432239.1269; val_kl_reg_loss: 14274.2377; val_edge_recon_loss: 2639105.2317; val_gene_expr_recon_loss: 696953.2036; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3350332.6768; val_optim_loss: 3350332.6768
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9883; val_auprc_score: 0.9864; val_best_acc_score: 0.9501; val_best_f1_score: 0.9509; train_kl_reg_loss: 13870.8193; train_edge_recon_loss: 2613425.8360; train_gene_expr_recon_loss: 684943.6022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3312240.2586; train_optim_loss: 3312240.2586; val_kl_reg_loss: 13405.1614; val_edge_recon_loss: 2616084.1908; val_gene_expr_recon_loss: 677285.0653; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3306774.4207; val_optim_loss: 3306774.4207
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9910; val_auprc_score: 0.9892; val_best_acc_score: 0.9594; val_best_f1_score: 0.9601; train_kl_reg_loss: 12808.6448; train_edge_recon_loss: 2601606.9197; train_gene_expr_recon_loss: 673146.7439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3287562.3082; train_optim_loss: 3287562.3082; val_kl_reg_loss: 12185.2511; val_edge_recon_loss: 2609408.3188; val_gene_expr_recon_loss: 668293.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3289887.4451; val_optim_loss: 3289887.4451
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9921; val_auprc_score: 0.9904; val_best_acc_score: 0.9634; val_best_f1_score: 0.9640; train_kl_reg_loss: 12210.3329; train_edge_recon_loss: 2593983.3392; train_gene_expr_recon_loss: 668122.9741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3274316.6431; train_optim_loss: 3274316.6431; val_kl_reg_loss: 11986.5170; val_edge_recon_loss: 2599800.4721; val_gene_expr_recon_loss: 665292.9808; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3277079.9704; val_optim_loss: 3277079.9704
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9922; val_auprc_score: 0.9907; val_best_acc_score: 0.9634; val_best_f1_score: 0.9639; train_kl_reg_loss: 11853.4179; train_edge_recon_loss: 2589250.1849; train_gene_expr_recon_loss: 665115.6680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3266219.2707; train_optim_loss: 3266219.2707; val_kl_reg_loss: 11908.1782; val_edge_recon_loss: 2598594.5479; val_gene_expr_recon_loss: 664497.9085; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3275000.6359; val_optim_loss: 3275000.6359
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9927; val_auprc_score: 0.9911; val_best_acc_score: 0.9654; val_best_f1_score: 0.9660; train_kl_reg_loss: 11643.1538; train_edge_recon_loss: 2587124.9436; train_gene_expr_recon_loss: 662864.6795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3261632.7753; train_optim_loss: 3261632.7753; val_kl_reg_loss: 11658.3101; val_edge_recon_loss: 2595023.0340; val_gene_expr_recon_loss: 663740.9033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3270422.2491; val_optim_loss: 3270422.2491
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9932; val_auprc_score: 0.9917; val_best_acc_score: 0.9676; val_best_f1_score: 0.9681; train_kl_reg_loss: 11439.9002; train_edge_recon_loss: 2584593.6705; train_gene_expr_recon_loss: 661634.7092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3257668.2820; train_optim_loss: 3257668.2820; val_kl_reg_loss: 11531.9174; val_edge_recon_loss: 2591445.3066; val_gene_expr_recon_loss: 661235.2661; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3264212.5026; val_optim_loss: 3264212.5026
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9933; val_auprc_score: 0.9917; val_best_acc_score: 0.9682; val_best_f1_score: 0.9686; train_kl_reg_loss: 11275.1932; train_edge_recon_loss: 2583394.1229; train_gene_expr_recon_loss: 660634.3722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3255303.6889; train_optim_loss: 3255303.6889; val_kl_reg_loss: 11089.3326; val_edge_recon_loss: 2595572.0348; val_gene_expr_recon_loss: 661074.8068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3267736.1768; val_optim_loss: 3267736.1768
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9942; val_auprc_score: 0.9928; val_best_acc_score: 0.9705; val_best_f1_score: 0.9709; train_kl_reg_loss: 11174.2445; train_edge_recon_loss: 2581863.0760; train_gene_expr_recon_loss: 659713.7678; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3252751.0873; train_optim_loss: 3252751.0873; val_kl_reg_loss: 11237.7713; val_edge_recon_loss: 2592510.0192; val_gene_expr_recon_loss: 659165.2099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3262913.0017; val_optim_loss: 3262913.0017
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9941; val_auprc_score: 0.9928; val_best_acc_score: 0.9710; val_best_f1_score: 0.9713; train_kl_reg_loss: 11047.8004; train_edge_recon_loss: 2580325.7848; train_gene_expr_recon_loss: 659218.7958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3250592.3813; train_optim_loss: 3250592.3813; val_kl_reg_loss: 10775.8759; val_edge_recon_loss: 2587188.2047; val_gene_expr_recon_loss: 660655.9956; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3258620.0732; val_optim_loss: 3258620.0732
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9945; val_auprc_score: 0.9932; val_best_acc_score: 0.9728; val_best_f1_score: 0.9731; train_kl_reg_loss: 10984.5211; train_edge_recon_loss: 2579356.7407; train_gene_expr_recon_loss: 658691.4809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3249032.7426; train_optim_loss: 3249032.7426; val_kl_reg_loss: 10951.6702; val_edge_recon_loss: 2586450.3563; val_gene_expr_recon_loss: 658681.4101; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3256083.4399; val_optim_loss: 3256083.4399
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9942; val_auprc_score: 0.9929; val_best_acc_score: 0.9715; val_best_f1_score: 0.9718; train_kl_reg_loss: 10918.0585; train_edge_recon_loss: 2577751.2676; train_gene_expr_recon_loss: 658125.9251; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3246795.2524; train_optim_loss: 3246795.2524; val_kl_reg_loss: 10775.9508; val_edge_recon_loss: 2585381.1394; val_gene_expr_recon_loss: 659241.8689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3255398.9625; val_optim_loss: 3255398.9625
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9947; val_auprc_score: 0.9935; val_best_acc_score: 0.9735; val_best_f1_score: 0.9738; train_kl_reg_loss: 10848.2125; train_edge_recon_loss: 2576933.9991; train_gene_expr_recon_loss: 657637.9383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3245420.1477; train_optim_loss: 3245420.1477; val_kl_reg_loss: 10876.3475; val_edge_recon_loss: 2587791.6237; val_gene_expr_recon_loss: 659439.5076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3258107.4730; val_optim_loss: 3258107.4730
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9946; val_auprc_score: 0.9933; val_best_acc_score: 0.9731; val_best_f1_score: 0.9734; train_kl_reg_loss: 10794.7627; train_edge_recon_loss: 2575911.3615; train_gene_expr_recon_loss: 657445.3421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3244151.4669; train_optim_loss: 3244151.4669; val_kl_reg_loss: 10650.9000; val_edge_recon_loss: 2589758.7012; val_gene_expr_recon_loss: 660375.1348; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3260784.7509; val_optim_loss: 3260784.7509
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9949; val_auprc_score: 0.9935; val_best_acc_score: 0.9740; val_best_f1_score: 0.9743; train_kl_reg_loss: 10780.1077; train_edge_recon_loss: 2575865.5515; train_gene_expr_recon_loss: 656772.3093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3243417.9699; train_optim_loss: 3243417.9699; val_kl_reg_loss: 10785.1039; val_edge_recon_loss: 2583767.2709; val_gene_expr_recon_loss: 659796.2770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3254348.6429; val_optim_loss: 3254348.6429
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9949; val_auprc_score: 0.9935; val_best_acc_score: 0.9742; val_best_f1_score: 0.9745; train_kl_reg_loss: 10734.2752; train_edge_recon_loss: 2574691.1275; train_gene_expr_recon_loss: 656508.4920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3241933.8964; train_optim_loss: 3241933.8964; val_kl_reg_loss: 11062.0668; val_edge_recon_loss: 2582955.4843; val_gene_expr_recon_loss: 658112.2742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3252129.8293; val_optim_loss: 3252129.8293
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9947; val_auprc_score: 0.9933; val_best_acc_score: 0.9737; val_best_f1_score: 0.9740; train_kl_reg_loss: 10704.2092; train_edge_recon_loss: 2574181.1215; train_gene_expr_recon_loss: 656101.6460; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3240986.9715; train_optim_loss: 3240986.9715; val_kl_reg_loss: 10588.2607; val_edge_recon_loss: 2582228.9408; val_gene_expr_recon_loss: 658085.6098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3250902.7962; val_optim_loss: 3250902.7962
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9952; val_auprc_score: 0.9939; val_best_acc_score: 0.9757; val_best_f1_score: 0.9760; train_kl_reg_loss: 10686.8447; train_edge_recon_loss: 2573559.6939; train_gene_expr_recon_loss: 656303.4210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3240549.9593; train_optim_loss: 3240549.9593; val_kl_reg_loss: 10762.0245; val_edge_recon_loss: 2580376.6681; val_gene_expr_recon_loss: 658329.3517; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3249468.0418; val_optim_loss: 3249468.0418
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9950; val_auprc_score: 0.9938; val_best_acc_score: 0.9754; val_best_f1_score: 0.9757; train_kl_reg_loss: 10661.6181; train_edge_recon_loss: 2572688.0673; train_gene_expr_recon_loss: 655513.6577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3238863.3426; train_optim_loss: 3238863.3426; val_kl_reg_loss: 10747.0059; val_edge_recon_loss: 2580052.2726; val_gene_expr_recon_loss: 657294.5494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3248093.8127; val_optim_loss: 3248093.8127
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9954; val_auprc_score: 0.9942; val_best_acc_score: 0.9762; val_best_f1_score: 0.9765; train_kl_reg_loss: 10625.1444; train_edge_recon_loss: 2572302.3669; train_gene_expr_recon_loss: 655333.2389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3238260.7489; train_optim_loss: 3238260.7489; val_kl_reg_loss: 10455.5202; val_edge_recon_loss: 2579760.9051; val_gene_expr_recon_loss: 657006.8334; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3247223.2639; val_optim_loss: 3247223.2639
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9951; val_auprc_score: 0.9939; val_best_acc_score: 0.9760; val_best_f1_score: 0.9763; train_kl_reg_loss: 10614.0172; train_edge_recon_loss: 2571495.3912; train_gene_expr_recon_loss: 655521.5055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3237630.9124; train_optim_loss: 3237630.9124; val_kl_reg_loss: 10674.0636; val_edge_recon_loss: 2578348.1733; val_gene_expr_recon_loss: 657395.6004; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3246417.8458; val_optim_loss: 3246417.8458
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9953; val_auprc_score: 0.9939; val_best_acc_score: 0.9768; val_best_f1_score: 0.9770; train_kl_reg_loss: 10600.7232; train_edge_recon_loss: 2571646.9045; train_gene_expr_recon_loss: 655391.9492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3237639.5790; train_optim_loss: 3237639.5790; val_kl_reg_loss: 10630.1944; val_edge_recon_loss: 2579186.2152; val_gene_expr_recon_loss: 658108.5723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3247924.9904; val_optim_loss: 3247924.9904
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9948; val_auprc_score: 0.9934; val_best_acc_score: 0.9757; val_best_f1_score: 0.9760; train_kl_reg_loss: 10588.5516; train_edge_recon_loss: 2571034.0724; train_gene_expr_recon_loss: 655015.0913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236637.7145; train_optim_loss: 3236637.7145; val_kl_reg_loss: 10560.5517; val_edge_recon_loss: 2578595.3397; val_gene_expr_recon_loss: 657087.5658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3246243.4617; val_optim_loss: 3246243.4617
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9949; val_auprc_score: 0.9935; val_best_acc_score: 0.9751; val_best_f1_score: 0.9755; train_kl_reg_loss: 10583.3146; train_edge_recon_loss: 2570752.3671; train_gene_expr_recon_loss: 655036.5654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236372.2471; train_optim_loss: 3236372.2471; val_kl_reg_loss: 10667.2301; val_edge_recon_loss: 2579129.6394; val_gene_expr_recon_loss: 659327.8404; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3249124.7030; val_optim_loss: 3249124.7030
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9956; val_auprc_score: 0.9943; val_best_acc_score: 0.9771; val_best_f1_score: 0.9774; train_kl_reg_loss: 10590.2061; train_edge_recon_loss: 2569800.8700; train_gene_expr_recon_loss: 654592.2582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3234983.3343; train_optim_loss: 3234983.3343; val_kl_reg_loss: 10406.2934; val_edge_recon_loss: 2577276.8711; val_gene_expr_recon_loss: 657013.4558; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3244696.6193; val_optim_loss: 3244696.6193
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9955; val_auprc_score: 0.9941; val_best_acc_score: 0.9771; val_best_f1_score: 0.9774; train_kl_reg_loss: 10561.2214; train_edge_recon_loss: 2569360.7640; train_gene_expr_recon_loss: 654730.5210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3234652.5058; train_optim_loss: 3234652.5058; val_kl_reg_loss: 10258.9273; val_edge_recon_loss: 2575438.1010; val_gene_expr_recon_loss: 658361.7263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3244058.7657; val_optim_loss: 3244058.7657
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9953; val_auprc_score: 0.9939; val_best_acc_score: 0.9766; val_best_f1_score: 0.9768; train_kl_reg_loss: 10546.5272; train_edge_recon_loss: 2569044.5672; train_gene_expr_recon_loss: 654285.4672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3233876.5589; train_optim_loss: 3233876.5589; val_kl_reg_loss: 10342.6115; val_edge_recon_loss: 2575731.2657; val_gene_expr_recon_loss: 657660.2933; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3243734.1742; val_optim_loss: 3243734.1742
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9953; val_auprc_score: 0.9938; val_best_acc_score: 0.9774; val_best_f1_score: 0.9777; train_kl_reg_loss: 10533.2156; train_edge_recon_loss: 2569118.6742; train_gene_expr_recon_loss: 654588.7592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3234240.6507; train_optim_loss: 3234240.6507; val_kl_reg_loss: 10558.3798; val_edge_recon_loss: 2574911.2334; val_gene_expr_recon_loss: 657148.7030; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3242618.3179; val_optim_loss: 3242618.3179
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9953; val_auprc_score: 0.9939; val_best_acc_score: 0.9775; val_best_f1_score: 0.9778; train_kl_reg_loss: 10521.2192; train_edge_recon_loss: 2568888.5785; train_gene_expr_recon_loss: 654051.9007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3233461.7002; train_optim_loss: 3233461.7002; val_kl_reg_loss: 10377.2191; val_edge_recon_loss: 2573403.5575; val_gene_expr_recon_loss: 657445.0608; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3241225.8380; val_optim_loss: 3241225.8380
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9954; val_auprc_score: 0.9942; val_best_acc_score: 0.9770; val_best_f1_score: 0.9773; train_kl_reg_loss: 10532.4463; train_edge_recon_loss: 2568424.2865; train_gene_expr_recon_loss: 654126.4623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3233083.1978; train_optim_loss: 3233083.1978; val_kl_reg_loss: 10675.9590; val_edge_recon_loss: 2575307.8580; val_gene_expr_recon_loss: 658088.0956; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3244071.9111; val_optim_loss: 3244071.9111
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9954; val_auprc_score: 0.9941; val_best_acc_score: 0.9779; val_best_f1_score: 0.9781; train_kl_reg_loss: 10517.6207; train_edge_recon_loss: 2568044.6077; train_gene_expr_recon_loss: 653943.5593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3232505.7890; train_optim_loss: 3232505.7890; val_kl_reg_loss: 10410.8969; val_edge_recon_loss: 2574885.7814; val_gene_expr_recon_loss: 657058.9423; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3242355.6272; val_optim_loss: 3242355.6272
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9955; val_auprc_score: 0.9941; val_best_acc_score: 0.9783; val_best_f1_score: 0.9785; train_kl_reg_loss: 10498.9007; train_edge_recon_loss: 2567302.8346; train_gene_expr_recon_loss: 654233.1310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3232034.8671; train_optim_loss: 3232034.8671; val_kl_reg_loss: 10578.4723; val_edge_recon_loss: 2571699.9155; val_gene_expr_recon_loss: 656708.1050; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3238986.4956; val_optim_loss: 3238986.4956
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9954; val_auprc_score: 0.9940; val_best_acc_score: 0.9777; val_best_f1_score: 0.9780; train_kl_reg_loss: 10476.0324; train_edge_recon_loss: 2567477.6945; train_gene_expr_recon_loss: 654029.1048; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3231982.8284; train_optim_loss: 3231982.8284; val_kl_reg_loss: 10483.5321; val_edge_recon_loss: 2571672.1803; val_gene_expr_recon_loss: 657297.4018; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3239453.1193; val_optim_loss: 3239453.1193
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9955; val_auprc_score: 0.9941; val_best_acc_score: 0.9786; val_best_f1_score: 0.9788; train_kl_reg_loss: 10457.7260; train_edge_recon_loss: 2567611.9243; train_gene_expr_recon_loss: 653942.2431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3232011.8914; train_optim_loss: 3232011.8914; val_kl_reg_loss: 10384.3649; val_edge_recon_loss: 2574306.6664; val_gene_expr_recon_loss: 657495.6437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3242186.6786; val_optim_loss: 3242186.6786
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9949; val_auprc_score: 0.9934; val_best_acc_score: 0.9769; val_best_f1_score: 0.9771; train_kl_reg_loss: 10463.9884; train_edge_recon_loss: 2567128.2796; train_gene_expr_recon_loss: 654004.2663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3231596.5362; train_optim_loss: 3231596.5362; val_kl_reg_loss: 10542.0017; val_edge_recon_loss: 2573044.9042; val_gene_expr_recon_loss: 656738.0880; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3240325.0035; val_optim_loss: 3240325.0035
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9951; val_auprc_score: 0.9935; val_best_acc_score: 0.9775; val_best_f1_score: 0.9778; train_kl_reg_loss: 10473.1120; train_edge_recon_loss: 2566075.2651; train_gene_expr_recon_loss: 654014.8545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3230563.2321; train_optim_loss: 3230563.2321; val_kl_reg_loss: 10431.4362; val_edge_recon_loss: 2575314.7857; val_gene_expr_recon_loss: 657367.0059; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3243113.2204; val_optim_loss: 3243113.2204

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9955; val_auprc_score: 0.9942; val_best_acc_score: 0.9784; val_best_f1_score: 0.9787; train_kl_reg_loss: 10839.1395; train_edge_recon_loss: 2564601.7658; train_gene_expr_recon_loss: 648582.8593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3224023.7619; train_optim_loss: 3224023.7619; val_kl_reg_loss: 10851.3911; val_edge_recon_loss: 2570818.3153; val_gene_expr_recon_loss: 652589.1993; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3234258.8990; val_optim_loss: 3234258.8990
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9957; val_auprc_score: 0.9943; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 10913.9016; train_edge_recon_loss: 2564329.3446; train_gene_expr_recon_loss: 648101.1332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3223344.3800; train_optim_loss: 3223344.3800; val_kl_reg_loss: 10819.7905; val_edge_recon_loss: 2569640.6585; val_gene_expr_recon_loss: 653136.7202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3233597.1699; val_optim_loss: 3233597.1699
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9958; val_auprc_score: 0.9946; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 10903.2141; train_edge_recon_loss: 2564449.9608; train_gene_expr_recon_loss: 647310.6813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3222663.8553; train_optim_loss: 3222663.8553; val_kl_reg_loss: 10859.0877; val_edge_recon_loss: 2569500.6751; val_gene_expr_recon_loss: 652648.2681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3233008.0314; val_optim_loss: 3233008.0314
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9957; val_auprc_score: 0.9944; val_best_acc_score: 0.9791; val_best_f1_score: 0.9793; train_kl_reg_loss: 10906.9759; train_edge_recon_loss: 2564034.4572; train_gene_expr_recon_loss: 647301.8452; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3222243.2755; train_optim_loss: 3222243.2755; val_kl_reg_loss: 10897.7368; val_edge_recon_loss: 2569724.4486; val_gene_expr_recon_loss: 651792.0751; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3232414.2587; val_optim_loss: 3232414.2587
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9959; val_auprc_score: 0.9946; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 10921.3755; train_edge_recon_loss: 2563965.5865; train_gene_expr_recon_loss: 647192.8167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3222079.7771; train_optim_loss: 3222079.7771; val_kl_reg_loss: 10839.5138; val_edge_recon_loss: 2568131.8380; val_gene_expr_recon_loss: 652674.7885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3231646.1394; val_optim_loss: 3231646.1394
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9958; val_auprc_score: 0.9945; val_best_acc_score: 0.9790; val_best_f1_score: 0.9792; train_kl_reg_loss: 10924.1825; train_edge_recon_loss: 2563912.8098; train_gene_expr_recon_loss: 647224.7503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3222061.7410; train_optim_loss: 3222061.7410; val_kl_reg_loss: 10868.2097; val_edge_recon_loss: 2570808.7012; val_gene_expr_recon_loss: 652295.3500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3233972.2639; val_optim_loss: 3233972.2639
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9960; val_auprc_score: 0.9949; val_best_acc_score: 0.9799; val_best_f1_score: 0.9801; train_kl_reg_loss: 10903.5486; train_edge_recon_loss: 2564261.8475; train_gene_expr_recon_loss: 647432.9317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3222598.3294; train_optim_loss: 3222598.3294; val_kl_reg_loss: 10822.0875; val_edge_recon_loss: 2568356.0575; val_gene_expr_recon_loss: 652153.1553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3231331.2997; val_optim_loss: 3231331.2997
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9957; val_auprc_score: 0.9944; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 10896.3477; train_edge_recon_loss: 2563833.0899; train_gene_expr_recon_loss: 647290.2073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3222019.6462; train_optim_loss: 3222019.6462; val_kl_reg_loss: 10792.8600; val_edge_recon_loss: 2569029.5218; val_gene_expr_recon_loss: 651563.8386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3231386.2247; val_optim_loss: 3231386.2247
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9960; val_auprc_score: 0.9947; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 10880.5867; train_edge_recon_loss: 2563773.4320; train_gene_expr_recon_loss: 647173.9639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3221827.9837; train_optim_loss: 3221827.9837; val_kl_reg_loss: 10764.9290; val_edge_recon_loss: 2566929.4242; val_gene_expr_recon_loss: 651691.7779; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3229386.1307; val_optim_loss: 3229386.1307
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9958; val_auprc_score: 0.9946; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 10902.3020; train_edge_recon_loss: 2564140.7086; train_gene_expr_recon_loss: 646773.7046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3221816.7154; train_optim_loss: 3221816.7154; val_kl_reg_loss: 10831.1399; val_edge_recon_loss: 2571086.8981; val_gene_expr_recon_loss: 652283.1801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3234201.2143; val_optim_loss: 3234201.2143
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9958; val_auprc_score: 0.9945; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 10894.6969; train_edge_recon_loss: 2563956.7723; train_gene_expr_recon_loss: 646906.0259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3221757.4972; train_optim_loss: 3221757.4972; val_kl_reg_loss: 10826.9005; val_edge_recon_loss: 2569075.3240; val_gene_expr_recon_loss: 652159.7232; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3232061.9477; val_optim_loss: 3232061.9477
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9959; val_auprc_score: 0.9945; val_best_acc_score: 0.9795; val_best_f1_score: 0.9798; train_kl_reg_loss: 10880.9316; train_edge_recon_loss: 2564339.5380; train_gene_expr_recon_loss: 647164.6749; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3222385.1421; train_optim_loss: 3222385.1421; val_kl_reg_loss: 10814.3873; val_edge_recon_loss: 2568953.2726; val_gene_expr_recon_loss: 652105.7742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3231873.4364; val_optim_loss: 3231873.4364
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9960; val_auprc_score: 0.9947; val_best_acc_score: 0.9795; val_best_f1_score: 0.9797; train_kl_reg_loss: 10883.8092; train_edge_recon_loss: 2563227.2799; train_gene_expr_recon_loss: 647028.5098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3221139.5960; train_optim_loss: 3221139.5960; val_kl_reg_loss: 10788.3738; val_edge_recon_loss: 2568038.9051; val_gene_expr_recon_loss: 652635.5784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3231462.8554; val_optim_loss: 3231462.8554

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9960; val_auprc_score: 0.9947; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 10901.8996; train_edge_recon_loss: 2563792.9267; train_gene_expr_recon_loss: 646313.2012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3221008.0251; train_optim_loss: 3221008.0251; val_kl_reg_loss: 10818.4213; val_edge_recon_loss: 2567025.7021; val_gene_expr_recon_loss: 651854.9153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3229699.0296; val_optim_loss: 3229699.0296
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9961; val_auprc_score: 0.9949; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 10923.5993; train_edge_recon_loss: 2562981.9166; train_gene_expr_recon_loss: 646160.6135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3220066.1304; train_optim_loss: 3220066.1304; val_kl_reg_loss: 10861.8746; val_edge_recon_loss: 2568197.6611; val_gene_expr_recon_loss: 650822.9702; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3229882.4983; val_optim_loss: 3229882.4983
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9959; val_auprc_score: 0.9945; val_best_acc_score: 0.9797; val_best_f1_score: 0.9800; train_kl_reg_loss: 10920.5495; train_edge_recon_loss: 2563313.5608; train_gene_expr_recon_loss: 645755.7679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3219989.8816; train_optim_loss: 3219989.8816; val_kl_reg_loss: 10841.0288; val_edge_recon_loss: 2568574.6664; val_gene_expr_recon_loss: 650830.5939; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3230246.2814; val_optim_loss: 3230246.2814
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9960; val_auprc_score: 0.9949; val_best_acc_score: 0.9797; val_best_f1_score: 0.9798; train_kl_reg_loss: 10917.0764; train_edge_recon_loss: 2563665.3283; train_gene_expr_recon_loss: 646079.3431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3220661.7508; train_optim_loss: 3220661.7508; val_kl_reg_loss: 10844.0115; val_edge_recon_loss: 2568009.2430; val_gene_expr_recon_loss: 651116.2324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3229969.4922; val_optim_loss: 3229969.4922

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1033 min 51 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
Val AUROC score: 0.9959
Val AUPRC score: 0.9947
Val best accuracy score: 0.9796
Val best F1 score: 0.9799
Val gene expr MSE score: 1.5713

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
