None
Run timestamp: 30062023_121738_35.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_35']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
heaps
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9869; val_auprc_score: 0.9819; val_best_acc_score: 0.9570; val_best_f1_score: 0.9580; train_kl_reg_loss: 7636.7559; train_edge_recon_loss: 267855.6893; train_gene_expr_recon_loss: 124623.6958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 400116.1411; train_optim_loss: 400116.1411; val_kl_reg_loss: 7461.2659; val_edge_recon_loss: 260427.5018; val_gene_expr_recon_loss: 112878.0257; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380766.7935; val_optim_loss: 380766.7935
heaps
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9891; val_auprc_score: 0.9851; val_best_acc_score: 0.9630; val_best_f1_score: 0.9638; train_kl_reg_loss: 7303.2159; train_edge_recon_loss: 260852.1030; train_gene_expr_recon_loss: 110199.9331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 378355.2529; train_optim_loss: 378355.2529; val_kl_reg_loss: 6954.9258; val_edge_recon_loss: 259537.9565; val_gene_expr_recon_loss: 107451.7175; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373944.5989; val_optim_loss: 373944.5989
heaps
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9909; val_auprc_score: 0.9876; val_best_acc_score: 0.9665; val_best_f1_score: 0.9672; train_kl_reg_loss: 7023.1098; train_edge_recon_loss: 260004.1353; train_gene_expr_recon_loss: 106147.3879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373174.6330; train_optim_loss: 373174.6330; val_kl_reg_loss: 6888.5249; val_edge_recon_loss: 259264.0973; val_gene_expr_recon_loss: 104548.9264; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370701.5476; val_optim_loss: 370701.5476
heaps
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9925; val_auprc_score: 0.9899; val_best_acc_score: 0.9698; val_best_f1_score: 0.9703; train_kl_reg_loss: 6890.0997; train_edge_recon_loss: 259595.3056; train_gene_expr_recon_loss: 103606.0385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370091.4440; train_optim_loss: 370091.4440; val_kl_reg_loss: 6820.3731; val_edge_recon_loss: 258417.9216; val_gene_expr_recon_loss: 102483.7130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367722.0087; val_optim_loss: 367722.0087
heaps
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9930; val_auprc_score: 0.9907; val_best_acc_score: 0.9712; val_best_f1_score: 0.9717; train_kl_reg_loss: 6787.6759; train_edge_recon_loss: 259185.1192; train_gene_expr_recon_loss: 101889.2248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367862.0207; train_optim_loss: 367862.0207; val_kl_reg_loss: 6694.3350; val_edge_recon_loss: 258213.0978; val_gene_expr_recon_loss: 101265.7874; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366173.2188; val_optim_loss: 366173.2188
heaps
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9938; val_auprc_score: 0.9919; val_best_acc_score: 0.9744; val_best_f1_score: 0.9748; train_kl_reg_loss: 6708.7133; train_edge_recon_loss: 258821.6394; train_gene_expr_recon_loss: 100761.6022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366291.9553; train_optim_loss: 366291.9553; val_kl_reg_loss: 6658.5044; val_edge_recon_loss: 258182.8755; val_gene_expr_recon_loss: 100332.3613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365173.7403; val_optim_loss: 365173.7403
heaps
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9944; val_auprc_score: 0.9927; val_best_acc_score: 0.9752; val_best_f1_score: 0.9756; train_kl_reg_loss: 6644.4041; train_edge_recon_loss: 258627.1782; train_gene_expr_recon_loss: 99737.0006; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365008.5830; train_optim_loss: 365008.5830; val_kl_reg_loss: 6468.0884; val_edge_recon_loss: 257763.2976; val_gene_expr_recon_loss: 99656.9209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363888.3058; val_optim_loss: 363888.3058
heaps
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9948; val_auprc_score: 0.9934; val_best_acc_score: 0.9758; val_best_f1_score: 0.9761; train_kl_reg_loss: 6603.4321; train_edge_recon_loss: 258288.5205; train_gene_expr_recon_loss: 99163.9306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364055.8835; train_optim_loss: 364055.8835; val_kl_reg_loss: 6512.2657; val_edge_recon_loss: 257817.8599; val_gene_expr_recon_loss: 99261.6387; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363591.7633; val_optim_loss: 363591.7633
heaps
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9952; val_auprc_score: 0.9938; val_best_acc_score: 0.9773; val_best_f1_score: 0.9776; train_kl_reg_loss: 6561.3523; train_edge_recon_loss: 258123.8243; train_gene_expr_recon_loss: 98607.2535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363292.4296; train_optim_loss: 363292.4296; val_kl_reg_loss: 6351.7099; val_edge_recon_loss: 257493.1066; val_gene_expr_recon_loss: 98959.3089; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362804.1270; val_optim_loss: 362804.1270
heaps
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9955; val_auprc_score: 0.9939; val_best_acc_score: 0.9790; val_best_f1_score: 0.9793; train_kl_reg_loss: 6533.9789; train_edge_recon_loss: 257959.2966; train_gene_expr_recon_loss: 98040.6936; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362533.9694; train_optim_loss: 362533.9694; val_kl_reg_loss: 6525.7494; val_edge_recon_loss: 257354.3596; val_gene_expr_recon_loss: 98429.4649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362309.5738; val_optim_loss: 362309.5738
heaps
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9961; val_auprc_score: 0.9946; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 6515.2568; train_edge_recon_loss: 257679.4305; train_gene_expr_recon_loss: 97641.5094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361836.1961; train_optim_loss: 361836.1961; val_kl_reg_loss: 6435.5121; val_edge_recon_loss: 257058.2446; val_gene_expr_recon_loss: 98159.3467; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361653.1055; val_optim_loss: 361653.1055
heaps
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9961; val_auprc_score: 0.9948; val_best_acc_score: 0.9808; val_best_f1_score: 0.9811; train_kl_reg_loss: 6493.7463; train_edge_recon_loss: 257508.4416; train_gene_expr_recon_loss: 97378.8847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361381.0726; train_optim_loss: 361381.0726; val_kl_reg_loss: 6417.9222; val_edge_recon_loss: 256769.0645; val_gene_expr_recon_loss: 98064.9607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361251.9467; val_optim_loss: 361251.9467
heaps
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9963; val_auprc_score: 0.9952; val_best_acc_score: 0.9813; val_best_f1_score: 0.9815; train_kl_reg_loss: 6484.2957; train_edge_recon_loss: 257402.9034; train_gene_expr_recon_loss: 97085.2356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360972.4337; train_optim_loss: 360972.4337; val_kl_reg_loss: 6434.9004; val_edge_recon_loss: 256641.2812; val_gene_expr_recon_loss: 98308.7189; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361384.8975; val_optim_loss: 361384.8975
heaps
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9965; val_auprc_score: 0.9955; val_best_acc_score: 0.9818; val_best_f1_score: 0.9820; train_kl_reg_loss: 6478.7195; train_edge_recon_loss: 257315.7383; train_gene_expr_recon_loss: 96813.9254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360608.3837; train_optim_loss: 360608.3837; val_kl_reg_loss: 6441.6955; val_edge_recon_loss: 256479.7349; val_gene_expr_recon_loss: 98011.4282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360932.8622; val_optim_loss: 360932.8622
heaps
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9964; val_auprc_score: 0.9954; val_best_acc_score: 0.9823; val_best_f1_score: 0.9825; train_kl_reg_loss: 6471.1908; train_edge_recon_loss: 257113.2914; train_gene_expr_recon_loss: 96628.8432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360213.3254; train_optim_loss: 360213.3254; val_kl_reg_loss: 6471.9587; val_edge_recon_loss: 256749.0074; val_gene_expr_recon_loss: 97924.4753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361145.4416; val_optim_loss: 361145.4416
heaps
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9968; val_auprc_score: 0.9958; val_best_acc_score: 0.9827; val_best_f1_score: 0.9828; train_kl_reg_loss: 6468.5100; train_edge_recon_loss: 257098.9079; train_gene_expr_recon_loss: 96447.5479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360014.9652; train_optim_loss: 360014.9652; val_kl_reg_loss: 6460.2961; val_edge_recon_loss: 256508.5054; val_gene_expr_recon_loss: 97701.0822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360669.8842; val_optim_loss: 360669.8842
heaps
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9968; val_auprc_score: 0.9959; val_best_acc_score: 0.9832; val_best_f1_score: 0.9833; train_kl_reg_loss: 6471.0121; train_edge_recon_loss: 256957.6647; train_gene_expr_recon_loss: 96221.5119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359650.1881; train_optim_loss: 359650.1881; val_kl_reg_loss: 6388.4248; val_edge_recon_loss: 256575.6598; val_gene_expr_recon_loss: 97650.1592; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360614.2439; val_optim_loss: 360614.2439
heaps
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9967; val_auprc_score: 0.9953; val_best_acc_score: 0.9829; val_best_f1_score: 0.9830; train_kl_reg_loss: 6471.6493; train_edge_recon_loss: 256916.3602; train_gene_expr_recon_loss: 96077.2425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359465.2513; train_optim_loss: 359465.2513; val_kl_reg_loss: 6441.9482; val_edge_recon_loss: 256502.2664; val_gene_expr_recon_loss: 97436.2090; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360380.4237; val_optim_loss: 360380.4237
heaps
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9972; val_auprc_score: 0.9961; val_best_acc_score: 0.9843; val_best_f1_score: 0.9844; train_kl_reg_loss: 6475.0256; train_edge_recon_loss: 256882.2404; train_gene_expr_recon_loss: 95825.5987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359182.8648; train_optim_loss: 359182.8648; val_kl_reg_loss: 6411.4231; val_edge_recon_loss: 256223.8563; val_gene_expr_recon_loss: 97778.2915; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360413.5727; val_optim_loss: 360413.5727
heaps
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9970; val_auprc_score: 0.9961; val_best_acc_score: 0.9838; val_best_f1_score: 0.9840; train_kl_reg_loss: 6478.2140; train_edge_recon_loss: 256780.2339; train_gene_expr_recon_loss: 95684.2384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358942.6861; train_optim_loss: 358942.6861; val_kl_reg_loss: 6416.1713; val_edge_recon_loss: 256210.9985; val_gene_expr_recon_loss: 97820.1122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360447.2818; val_optim_loss: 360447.2818
heaps
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9968; val_auprc_score: 0.9958; val_best_acc_score: 0.9843; val_best_f1_score: 0.9845; train_kl_reg_loss: 6486.5095; train_edge_recon_loss: 256734.8091; train_gene_expr_recon_loss: 95508.8258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358730.1437; train_optim_loss: 358730.1437; val_kl_reg_loss: 6434.7476; val_edge_recon_loss: 256490.5576; val_gene_expr_recon_loss: 97600.5840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360525.8904; val_optim_loss: 360525.8904
heaps
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9972; val_auprc_score: 0.9961; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 6486.8811; train_edge_recon_loss: 256721.4661; train_gene_expr_recon_loss: 95409.0666; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358617.4143; train_optim_loss: 358617.4143; val_kl_reg_loss: 6435.9820; val_edge_recon_loss: 256231.9442; val_gene_expr_recon_loss: 97711.5756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360379.5010; val_optim_loss: 360379.5010
heaps
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9974; val_auprc_score: 0.9968; val_best_acc_score: 0.9845; val_best_f1_score: 0.9847; train_kl_reg_loss: 6495.2071; train_edge_recon_loss: 256607.0569; train_gene_expr_recon_loss: 95253.1271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358355.3909; train_optim_loss: 358355.3909; val_kl_reg_loss: 6419.6118; val_edge_recon_loss: 256089.4629; val_gene_expr_recon_loss: 97590.4433; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360099.5200; val_optim_loss: 360099.5200
heaps
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9973; val_auprc_score: 0.9966; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 6498.9682; train_edge_recon_loss: 256583.8222; train_gene_expr_recon_loss: 95120.6491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358203.4396; train_optim_loss: 358203.4396; val_kl_reg_loss: 6513.6968; val_edge_recon_loss: 255944.3847; val_gene_expr_recon_loss: 97833.9339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360292.0149; val_optim_loss: 360292.0149
heaps
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9973; val_auprc_score: 0.9962; val_best_acc_score: 0.9846; val_best_f1_score: 0.9847; train_kl_reg_loss: 6507.1051; train_edge_recon_loss: 256619.4408; train_gene_expr_recon_loss: 94924.0190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358050.5654; train_optim_loss: 358050.5654; val_kl_reg_loss: 6458.5601; val_edge_recon_loss: 256164.9314; val_gene_expr_recon_loss: 97626.0342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360249.5287; val_optim_loss: 360249.5287
heaps
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9974; val_auprc_score: 0.9963; val_best_acc_score: 0.9853; val_best_f1_score: 0.9855; train_kl_reg_loss: 6515.8211; train_edge_recon_loss: 256531.2050; train_gene_expr_recon_loss: 94845.4857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357892.5116; train_optim_loss: 357892.5116; val_kl_reg_loss: 6507.8982; val_edge_recon_loss: 256043.2561; val_gene_expr_recon_loss: 97781.8016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360332.9570; val_optim_loss: 360332.9570
heaps
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9972; val_auprc_score: 0.9964; val_best_acc_score: 0.9850; val_best_f1_score: 0.9851; train_kl_reg_loss: 6524.2454; train_edge_recon_loss: 256538.9722; train_gene_expr_recon_loss: 94745.3079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357808.5249; train_optim_loss: 357808.5249; val_kl_reg_loss: 6543.4705; val_edge_recon_loss: 255917.4721; val_gene_expr_recon_loss: 97563.1625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360024.1071; val_optim_loss: 360024.1071
heaps
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9974; val_auprc_score: 0.9964; val_best_acc_score: 0.9848; val_best_f1_score: 0.9850; train_kl_reg_loss: 6536.6530; train_edge_recon_loss: 256396.2257; train_gene_expr_recon_loss: 94659.6384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357592.5159; train_optim_loss: 357592.5159; val_kl_reg_loss: 6512.9742; val_edge_recon_loss: 255965.1537; val_gene_expr_recon_loss: 97880.4452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360358.5717; val_optim_loss: 360358.5717
heaps
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9977; val_auprc_score: 0.9971; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 6548.9658; train_edge_recon_loss: 256320.3580; train_gene_expr_recon_loss: 94468.4403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357337.7642; train_optim_loss: 357337.7642; val_kl_reg_loss: 6512.6822; val_edge_recon_loss: 255685.8891; val_gene_expr_recon_loss: 97641.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359840.3934; val_optim_loss: 359840.3934
heaps
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9976; val_auprc_score: 0.9968; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 6551.3088; train_edge_recon_loss: 256391.0122; train_gene_expr_recon_loss: 94387.6020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357329.9224; train_optim_loss: 357329.9224; val_kl_reg_loss: 6480.6661; val_edge_recon_loss: 256020.0807; val_gene_expr_recon_loss: 97656.8202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360157.5702; val_optim_loss: 360157.5702
heaps
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9976; val_auprc_score: 0.9970; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 6560.5097; train_edge_recon_loss: 256313.1298; train_gene_expr_recon_loss: 94247.4209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357121.0596; train_optim_loss: 357121.0596; val_kl_reg_loss: 6524.1805; val_edge_recon_loss: 255662.1673; val_gene_expr_recon_loss: 97720.9699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359907.3197; val_optim_loss: 359907.3197
heaps
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9975; val_auprc_score: 0.9967; val_best_acc_score: 0.9856; val_best_f1_score: 0.9858; train_kl_reg_loss: 6564.0317; train_edge_recon_loss: 256418.5304; train_gene_expr_recon_loss: 94111.2534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357093.8150; train_optim_loss: 357093.8150; val_kl_reg_loss: 6494.8708; val_edge_recon_loss: 256049.3540; val_gene_expr_recon_loss: 97677.8225; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360222.0476; val_optim_loss: 360222.0476
heaps
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9977; val_auprc_score: 0.9971; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 6575.1796; train_edge_recon_loss: 256341.9065; train_gene_expr_recon_loss: 94130.1853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357047.2713; train_optim_loss: 357047.2713; val_kl_reg_loss: 6543.0764; val_edge_recon_loss: 255616.2236; val_gene_expr_recon_loss: 97676.9483; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359836.2480; val_optim_loss: 359836.2480
heaps
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9977; val_auprc_score: 0.9970; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 6583.5656; train_edge_recon_loss: 256276.4498; train_gene_expr_recon_loss: 94031.1014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356891.1162; train_optim_loss: 356891.1162; val_kl_reg_loss: 6550.8676; val_edge_recon_loss: 255790.2039; val_gene_expr_recon_loss: 97582.9883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359924.0594; val_optim_loss: 359924.0594
heaps
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9977; val_auprc_score: 0.9971; val_best_acc_score: 0.9860; val_best_f1_score: 0.9862; train_kl_reg_loss: 6593.8769; train_edge_recon_loss: 256193.5760; train_gene_expr_recon_loss: 93891.7842; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356679.2366; train_optim_loss: 356679.2366; val_kl_reg_loss: 6550.6318; val_edge_recon_loss: 255958.8404; val_gene_expr_recon_loss: 97977.6045; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360487.0763; val_optim_loss: 360487.0763
heaps
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9976; val_auprc_score: 0.9969; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 6604.9449; train_edge_recon_loss: 256117.9835; train_gene_expr_recon_loss: 93807.6198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356530.5489; train_optim_loss: 356530.5489; val_kl_reg_loss: 6543.1293; val_edge_recon_loss: 255844.3261; val_gene_expr_recon_loss: 98183.6107; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360571.0640; val_optim_loss: 360571.0640
heaps
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9978; val_auprc_score: 0.9972; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 6612.5646; train_edge_recon_loss: 256182.1957; train_gene_expr_recon_loss: 93698.5897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356493.3501; train_optim_loss: 356493.3501; val_kl_reg_loss: 6509.7762; val_edge_recon_loss: 255790.1465; val_gene_expr_recon_loss: 98042.0980; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360342.0225; val_optim_loss: 360342.0225

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

heaps
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9978; val_auprc_score: 0.9971; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 6647.8015; train_edge_recon_loss: 256068.3199; train_gene_expr_recon_loss: 92929.2481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355645.3692; train_optim_loss: 355645.3692; val_kl_reg_loss: 6617.3109; val_edge_recon_loss: 255616.6524; val_gene_expr_recon_loss: 97604.7163; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359838.6788; val_optim_loss: 359838.6788
heaps
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9979; val_auprc_score: 0.9972; val_best_acc_score: 0.9871; val_best_f1_score: 0.9871; train_kl_reg_loss: 6640.5508; train_edge_recon_loss: 255990.8102; train_gene_expr_recon_loss: 92755.7306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355387.0913; train_optim_loss: 355387.0913; val_kl_reg_loss: 6597.7758; val_edge_recon_loss: 255591.4980; val_gene_expr_recon_loss: 97684.1204; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359873.3940; val_optim_loss: 359873.3940
heaps
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9980; val_auprc_score: 0.9976; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 6631.9363; train_edge_recon_loss: 256136.1025; train_gene_expr_recon_loss: 92709.3830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355477.4220; train_optim_loss: 355477.4220; val_kl_reg_loss: 6602.9486; val_edge_recon_loss: 255513.3005; val_gene_expr_recon_loss: 97805.1593; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359921.4068; val_optim_loss: 359921.4068
heaps
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 6635.4566; train_edge_recon_loss: 256070.0494; train_gene_expr_recon_loss: 92588.5320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355294.0379; train_optim_loss: 355294.0379; val_kl_reg_loss: 6595.4467; val_edge_recon_loss: 255647.9385; val_gene_expr_recon_loss: 98011.6140; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360255.0010; val_optim_loss: 360255.0010

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 228 min 36 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
Val AUROC score: 0.9976
Val AUPRC score: 0.9970
Val best accuracy score: 0.9859
Val best F1 score: 0.9860
Val gene expr MSE score: 0.6455

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
