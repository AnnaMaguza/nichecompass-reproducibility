None
Run timestamp: 29072023_022846_70.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_70']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1385, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 500
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1385, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 500

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9898; val_auprc_score: 0.9898; val_best_acc_score: 0.9493; val_best_f1_score: 0.9495; train_kl_reg_loss: 2461.7568; train_edge_recon_loss: 28256.2051; train_gene_expr_recon_loss: 21071.0328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51788.9947; train_optim_loss: 51788.9947; val_kl_reg_loss: 2562.9065; val_edge_recon_loss: 26929.9323; val_gene_expr_recon_loss: 18940.3526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48433.1915; val_optim_loss: 48433.1915
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9930; val_auprc_score: 0.9929; val_best_acc_score: 0.9592; val_best_f1_score: 0.9592; train_kl_reg_loss: 2650.6977; train_edge_recon_loss: 27589.7578; train_gene_expr_recon_loss: 18544.4070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48784.8626; train_optim_loss: 48784.8626; val_kl_reg_loss: 2678.8935; val_edge_recon_loss: 26695.5416; val_gene_expr_recon_loss: 17917.2374; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47291.6725; val_optim_loss: 47291.6725
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9945; val_auprc_score: 0.9944; val_best_acc_score: 0.9639; val_best_f1_score: 0.9640; train_kl_reg_loss: 2710.2417; train_edge_recon_loss: 27416.6360; train_gene_expr_recon_loss: 17919.8576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48046.7353; train_optim_loss: 48046.7353; val_kl_reg_loss: 2706.3837; val_edge_recon_loss: 26536.7026; val_gene_expr_recon_loss: 17605.3895; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46848.4758; val_optim_loss: 46848.4758
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9951; val_auprc_score: 0.9951; val_best_acc_score: 0.9672; val_best_f1_score: 0.9673; train_kl_reg_loss: 2744.4206; train_edge_recon_loss: 27339.1376; train_gene_expr_recon_loss: 17681.4467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47765.0049; train_optim_loss: 47765.0049; val_kl_reg_loss: 2746.4196; val_edge_recon_loss: 26428.2684; val_gene_expr_recon_loss: 17435.6034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46610.2914; val_optim_loss: 46610.2914
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9953; val_auprc_score: 0.9950; val_best_acc_score: 0.9673; val_best_f1_score: 0.9673; train_kl_reg_loss: 2767.4462; train_edge_recon_loss: 27287.1475; train_gene_expr_recon_loss: 17552.4436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47607.0373; train_optim_loss: 47607.0373; val_kl_reg_loss: 2686.5885; val_edge_recon_loss: 26426.9007; val_gene_expr_recon_loss: 17326.4188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46439.9081; val_optim_loss: 46439.9081
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9954; val_auprc_score: 0.9952; val_best_acc_score: 0.9676; val_best_f1_score: 0.9676; train_kl_reg_loss: 2781.5091; train_edge_recon_loss: 27255.5832; train_gene_expr_recon_loss: 17492.7830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47529.8753; train_optim_loss: 47529.8753; val_kl_reg_loss: 2697.6602; val_edge_recon_loss: 26419.2114; val_gene_expr_recon_loss: 17292.9321; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46409.8036; val_optim_loss: 46409.8036
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9960; val_auprc_score: 0.9959; val_best_acc_score: 0.9706; val_best_f1_score: 0.9706; train_kl_reg_loss: 2789.7812; train_edge_recon_loss: 27227.2537; train_gene_expr_recon_loss: 17454.4696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47471.5044; train_optim_loss: 47471.5044; val_kl_reg_loss: 2758.5029; val_edge_recon_loss: 26363.2733; val_gene_expr_recon_loss: 17275.8574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46397.6337; val_optim_loss: 46397.6337
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9960; val_auprc_score: 0.9958; val_best_acc_score: 0.9706; val_best_f1_score: 0.9707; train_kl_reg_loss: 2792.6886; train_edge_recon_loss: 27212.4637; train_gene_expr_recon_loss: 17421.6964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47426.8487; train_optim_loss: 47426.8487; val_kl_reg_loss: 2768.8703; val_edge_recon_loss: 26346.6735; val_gene_expr_recon_loss: 17251.0506; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46366.5946; val_optim_loss: 46366.5946
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9963; val_auprc_score: 0.9959; val_best_acc_score: 0.9718; val_best_f1_score: 0.9719; train_kl_reg_loss: 2792.9609; train_edge_recon_loss: 27203.8543; train_gene_expr_recon_loss: 17406.5836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47403.3989; train_optim_loss: 47403.3989; val_kl_reg_loss: 2738.2578; val_edge_recon_loss: 26359.7829; val_gene_expr_recon_loss: 17239.9384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46337.9791; val_optim_loss: 46337.9791
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9962; val_auprc_score: 0.9960; val_best_acc_score: 0.9711; val_best_f1_score: 0.9712; train_kl_reg_loss: 2793.7791; train_edge_recon_loss: 27190.1874; train_gene_expr_recon_loss: 17395.9989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47379.9655; train_optim_loss: 47379.9655; val_kl_reg_loss: 2732.2566; val_edge_recon_loss: 26367.4354; val_gene_expr_recon_loss: 17221.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46321.4919; val_optim_loss: 46321.4919
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9960; val_auprc_score: 0.9959; val_best_acc_score: 0.9705; val_best_f1_score: 0.9705; train_kl_reg_loss: 2793.3880; train_edge_recon_loss: 27185.1040; train_gene_expr_recon_loss: 17381.7258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47360.2178; train_optim_loss: 47360.2178; val_kl_reg_loss: 2801.4320; val_edge_recon_loss: 26350.9826; val_gene_expr_recon_loss: 17201.0869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46353.5015; val_optim_loss: 46353.5015
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9964; val_auprc_score: 0.9963; val_best_acc_score: 0.9716; val_best_f1_score: 0.9716; train_kl_reg_loss: 2794.1591; train_edge_recon_loss: 27174.1503; train_gene_expr_recon_loss: 17363.8465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47332.1560; train_optim_loss: 47332.1560; val_kl_reg_loss: 2781.3728; val_edge_recon_loss: 26362.7711; val_gene_expr_recon_loss: 17210.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46354.8470; val_optim_loss: 46354.8470
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9962; val_auprc_score: 0.9960; val_best_acc_score: 0.9712; val_best_f1_score: 0.9712; train_kl_reg_loss: 2793.3518; train_edge_recon_loss: 27169.6449; train_gene_expr_recon_loss: 17359.4017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47322.3984; train_optim_loss: 47322.3984; val_kl_reg_loss: 2775.8341; val_edge_recon_loss: 26351.0247; val_gene_expr_recon_loss: 17176.7618; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46303.6206; val_optim_loss: 46303.6206
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9966; val_auprc_score: 0.9963; val_best_acc_score: 0.9728; val_best_f1_score: 0.9729; train_kl_reg_loss: 2793.0674; train_edge_recon_loss: 27160.4211; train_gene_expr_recon_loss: 17359.0499; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47312.5384; train_optim_loss: 47312.5384; val_kl_reg_loss: 2725.8725; val_edge_recon_loss: 26321.2053; val_gene_expr_recon_loss: 17193.7842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46240.8620; val_optim_loss: 46240.8620
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9966; val_auprc_score: 0.9964; val_best_acc_score: 0.9731; val_best_f1_score: 0.9732; train_kl_reg_loss: 2790.7292; train_edge_recon_loss: 27154.6666; train_gene_expr_recon_loss: 17356.0414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47301.4372; train_optim_loss: 47301.4372; val_kl_reg_loss: 2783.7308; val_edge_recon_loss: 26310.1408; val_gene_expr_recon_loss: 17187.8292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46281.7007; val_optim_loss: 46281.7007
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9967; val_auprc_score: 0.9965; val_best_acc_score: 0.9737; val_best_f1_score: 0.9737; train_kl_reg_loss: 2787.0423; train_edge_recon_loss: 27156.9839; train_gene_expr_recon_loss: 17346.9187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47290.9448; train_optim_loss: 47290.9448; val_kl_reg_loss: 2709.5137; val_edge_recon_loss: 26304.6082; val_gene_expr_recon_loss: 17190.3796; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46204.5014; val_optim_loss: 46204.5014
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9966; val_auprc_score: 0.9964; val_best_acc_score: 0.9733; val_best_f1_score: 0.9734; train_kl_reg_loss: 2787.1214; train_edge_recon_loss: 27145.8203; train_gene_expr_recon_loss: 17351.4852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47284.4268; train_optim_loss: 47284.4268; val_kl_reg_loss: 2722.3770; val_edge_recon_loss: 26294.8913; val_gene_expr_recon_loss: 17196.6116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46213.8797; val_optim_loss: 46213.8797
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9967; val_auprc_score: 0.9964; val_best_acc_score: 0.9740; val_best_f1_score: 0.9740; train_kl_reg_loss: 2787.8253; train_edge_recon_loss: 27135.8921; train_gene_expr_recon_loss: 17335.8083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47259.5257; train_optim_loss: 47259.5257; val_kl_reg_loss: 2781.1432; val_edge_recon_loss: 26281.7316; val_gene_expr_recon_loss: 17193.9641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46256.8388; val_optim_loss: 46256.8388
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9968; val_auprc_score: 0.9966; val_best_acc_score: 0.9738; val_best_f1_score: 0.9739; train_kl_reg_loss: 2786.3794; train_edge_recon_loss: 27134.7765; train_gene_expr_recon_loss: 17329.4321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47250.5881; train_optim_loss: 47250.5881; val_kl_reg_loss: 2776.0428; val_edge_recon_loss: 26263.4125; val_gene_expr_recon_loss: 17177.6921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46217.1475; val_optim_loss: 46217.1475
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9965; val_auprc_score: 0.9963; val_best_acc_score: 0.9728; val_best_f1_score: 0.9729; train_kl_reg_loss: 2785.6353; train_edge_recon_loss: 27133.6328; train_gene_expr_recon_loss: 17327.0144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47246.2825; train_optim_loss: 47246.2825; val_kl_reg_loss: 2779.7972; val_edge_recon_loss: 26285.2191; val_gene_expr_recon_loss: 17169.6405; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46234.6568; val_optim_loss: 46234.6568

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9972; val_auprc_score: 0.9969; val_best_acc_score: 0.9762; val_best_f1_score: 0.9763; train_kl_reg_loss: 2785.0343; train_edge_recon_loss: 27090.0303; train_gene_expr_recon_loss: 17253.4861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47128.5507; train_optim_loss: 47128.5507; val_kl_reg_loss: 2754.2385; val_edge_recon_loss: 26251.7196; val_gene_expr_recon_loss: 17118.9225; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46124.8807; val_optim_loss: 46124.8807
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9972; val_auprc_score: 0.9968; val_best_acc_score: 0.9762; val_best_f1_score: 0.9762; train_kl_reg_loss: 2781.7972; train_edge_recon_loss: 27088.0701; train_gene_expr_recon_loss: 17238.3735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47108.2408; train_optim_loss: 47108.2408; val_kl_reg_loss: 2770.6919; val_edge_recon_loss: 26250.8415; val_gene_expr_recon_loss: 17105.8131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46127.3466; val_optim_loss: 46127.3466
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9972; val_auprc_score: 0.9971; val_best_acc_score: 0.9765; val_best_f1_score: 0.9765; train_kl_reg_loss: 2781.0340; train_edge_recon_loss: 27086.0898; train_gene_expr_recon_loss: 17223.3875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47090.5113; train_optim_loss: 47090.5113; val_kl_reg_loss: 2746.7897; val_edge_recon_loss: 26239.6218; val_gene_expr_recon_loss: 17114.5528; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46100.9644; val_optim_loss: 46100.9644
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9972; val_auprc_score: 0.9971; val_best_acc_score: 0.9760; val_best_f1_score: 0.9761; train_kl_reg_loss: 2778.6468; train_edge_recon_loss: 27094.1674; train_gene_expr_recon_loss: 17223.8802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47096.6944; train_optim_loss: 47096.6944; val_kl_reg_loss: 2753.3707; val_edge_recon_loss: 26234.1167; val_gene_expr_recon_loss: 17091.4523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46078.9397; val_optim_loss: 46078.9397
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9972; val_auprc_score: 0.9970; val_best_acc_score: 0.9761; val_best_f1_score: 0.9761; train_kl_reg_loss: 2778.9084; train_edge_recon_loss: 27091.8695; train_gene_expr_recon_loss: 17222.8480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47093.6260; train_optim_loss: 47093.6260; val_kl_reg_loss: 2751.2181; val_edge_recon_loss: 26268.6175; val_gene_expr_recon_loss: 17098.8369; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46118.6725; val_optim_loss: 46118.6725
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9973; val_auprc_score: 0.9972; val_best_acc_score: 0.9762; val_best_f1_score: 0.9764; train_kl_reg_loss: 2778.0227; train_edge_recon_loss: 27098.1089; train_gene_expr_recon_loss: 17215.5237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47091.6553; train_optim_loss: 47091.6553; val_kl_reg_loss: 2759.2014; val_edge_recon_loss: 26242.5999; val_gene_expr_recon_loss: 17098.1841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46099.9853; val_optim_loss: 46099.9853
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9973; val_auprc_score: 0.9972; val_best_acc_score: 0.9765; val_best_f1_score: 0.9765; train_kl_reg_loss: 2779.1951; train_edge_recon_loss: 27090.7875; train_gene_expr_recon_loss: 17217.3929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47087.3756; train_optim_loss: 47087.3756; val_kl_reg_loss: 2763.9783; val_edge_recon_loss: 26221.2690; val_gene_expr_recon_loss: 17100.9243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46086.1716; val_optim_loss: 46086.1716
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9974; val_auprc_score: 0.9972; val_best_acc_score: 0.9766; val_best_f1_score: 0.9766; train_kl_reg_loss: 2779.4128; train_edge_recon_loss: 27091.1822; train_gene_expr_recon_loss: 17220.1266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47090.7216; train_optim_loss: 47090.7216; val_kl_reg_loss: 2764.8949; val_edge_recon_loss: 26227.3048; val_gene_expr_recon_loss: 17096.9287; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46089.1285; val_optim_loss: 46089.1285

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9973; val_auprc_score: 0.9970; val_best_acc_score: 0.9765; val_best_f1_score: 0.9765; train_kl_reg_loss: 2779.2856; train_edge_recon_loss: 27083.1977; train_gene_expr_recon_loss: 17206.0720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47068.5552; train_optim_loss: 47068.5552; val_kl_reg_loss: 2763.5215; val_edge_recon_loss: 26239.1104; val_gene_expr_recon_loss: 17065.6497; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46068.2818; val_optim_loss: 46068.2818
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9973; val_auprc_score: 0.9971; val_best_acc_score: 0.9766; val_best_f1_score: 0.9766; train_kl_reg_loss: 2779.9119; train_edge_recon_loss: 27080.2979; train_gene_expr_recon_loss: 17201.1942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47061.4040; train_optim_loss: 47061.4040; val_kl_reg_loss: 2759.3138; val_edge_recon_loss: 26234.6670; val_gene_expr_recon_loss: 17078.8475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46072.8284; val_optim_loss: 46072.8284
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9974; val_auprc_score: 0.9972; val_best_acc_score: 0.9771; val_best_f1_score: 0.9771; train_kl_reg_loss: 2779.4438; train_edge_recon_loss: 27084.9016; train_gene_expr_recon_loss: 17197.3916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47061.7369; train_optim_loss: 47061.7369; val_kl_reg_loss: 2759.5830; val_edge_recon_loss: 26228.8752; val_gene_expr_recon_loss: 17080.3223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46068.7804; val_optim_loss: 46068.7804
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9974; val_auprc_score: 0.9973; val_best_acc_score: 0.9767; val_best_f1_score: 0.9768; train_kl_reg_loss: 2779.4074; train_edge_recon_loss: 27083.4646; train_gene_expr_recon_loss: 17207.5934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47070.4654; train_optim_loss: 47070.4654; val_kl_reg_loss: 2757.6746; val_edge_recon_loss: 26253.8691; val_gene_expr_recon_loss: 17076.9694; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46088.5134; val_optim_loss: 46088.5134
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9973; val_auprc_score: 0.9972; val_best_acc_score: 0.9767; val_best_f1_score: 0.9769; train_kl_reg_loss: 2778.9074; train_edge_recon_loss: 27085.7392; train_gene_expr_recon_loss: 17203.1998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47067.8465; train_optim_loss: 47067.8465; val_kl_reg_loss: 2761.6341; val_edge_recon_loss: 26242.5256; val_gene_expr_recon_loss: 17092.8115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46096.9712; val_optim_loss: 46096.9712

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9973; val_auprc_score: 0.9970; val_best_acc_score: 0.9766; val_best_f1_score: 0.9767; train_kl_reg_loss: 2779.2953; train_edge_recon_loss: 27079.7736; train_gene_expr_recon_loss: 17203.2607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47062.3295; train_optim_loss: 47062.3295; val_kl_reg_loss: 2757.6011; val_edge_recon_loss: 26243.8201; val_gene_expr_recon_loss: 17090.1102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46091.5313; val_optim_loss: 46091.5313
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9974; val_auprc_score: 0.9973; val_best_acc_score: 0.9770; val_best_f1_score: 0.9771; train_kl_reg_loss: 2779.1163; train_edge_recon_loss: 27081.1739; train_gene_expr_recon_loss: 17206.4597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47066.7500; train_optim_loss: 47066.7500; val_kl_reg_loss: 2757.6476; val_edge_recon_loss: 26230.9410; val_gene_expr_recon_loss: 17062.4494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46051.0380; val_optim_loss: 46051.0380
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9973; val_auprc_score: 0.9971; val_best_acc_score: 0.9765; val_best_f1_score: 0.9767; train_kl_reg_loss: 2779.3606; train_edge_recon_loss: 27080.4824; train_gene_expr_recon_loss: 17198.8817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47058.7247; train_optim_loss: 47058.7247; val_kl_reg_loss: 2757.8025; val_edge_recon_loss: 26237.7916; val_gene_expr_recon_loss: 17079.8389; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46075.4329; val_optim_loss: 46075.4329
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9973; val_auprc_score: 0.9972; val_best_acc_score: 0.9769; val_best_f1_score: 0.9770; train_kl_reg_loss: 2778.8383; train_edge_recon_loss: 27084.4534; train_gene_expr_recon_loss: 17200.0719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47063.3636; train_optim_loss: 47063.3636; val_kl_reg_loss: 2756.8675; val_edge_recon_loss: 26249.0263; val_gene_expr_recon_loss: 17072.6036; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46078.4975; val_optim_loss: 46078.4975
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9975; val_auprc_score: 0.9974; val_best_acc_score: 0.9769; val_best_f1_score: 0.9769; train_kl_reg_loss: 2778.4070; train_edge_recon_loss: 27087.4488; train_gene_expr_recon_loss: 17199.6011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47065.4570; train_optim_loss: 47065.4570; val_kl_reg_loss: 2757.2497; val_edge_recon_loss: 26224.8960; val_gene_expr_recon_loss: 17071.6293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46053.7748; val_optim_loss: 46053.7748
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9973; val_auprc_score: 0.9971; val_best_acc_score: 0.9764; val_best_f1_score: 0.9764; train_kl_reg_loss: 2778.9475; train_edge_recon_loss: 27081.7785; train_gene_expr_recon_loss: 17195.8336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47056.5596; train_optim_loss: 47056.5596; val_kl_reg_loss: 2758.6443; val_edge_recon_loss: 26253.5614; val_gene_expr_recon_loss: 17065.2035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46077.4091; val_optim_loss: 46077.4091

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9974; val_auprc_score: 0.9972; val_best_acc_score: 0.9768; val_best_f1_score: 0.9769; train_kl_reg_loss: 2779.8660; train_edge_recon_loss: 27076.9783; train_gene_expr_recon_loss: 17200.7346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47057.5789; train_optim_loss: 47057.5789; val_kl_reg_loss: 2758.4117; val_edge_recon_loss: 26230.9531; val_gene_expr_recon_loss: 17077.5645; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46066.9293; val_optim_loss: 46066.9293
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9973; val_auprc_score: 0.9971; val_best_acc_score: 0.9763; val_best_f1_score: 0.9763; train_kl_reg_loss: 2779.4735; train_edge_recon_loss: 27080.1507; train_gene_expr_recon_loss: 17199.0842; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47058.7084; train_optim_loss: 47058.7084; val_kl_reg_loss: 2758.4604; val_edge_recon_loss: 26250.4494; val_gene_expr_recon_loss: 17082.7533; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46091.6633; val_optim_loss: 46091.6633
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9974; val_auprc_score: 0.9972; val_best_acc_score: 0.9766; val_best_f1_score: 0.9766; train_kl_reg_loss: 2779.3913; train_edge_recon_loss: 27082.4002; train_gene_expr_recon_loss: 17203.1060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47064.8975; train_optim_loss: 47064.8975; val_kl_reg_loss: 2758.5556; val_edge_recon_loss: 26243.8175; val_gene_expr_recon_loss: 17091.9342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46094.3071; val_optim_loss: 46094.3071
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9973; val_auprc_score: 0.9972; val_best_acc_score: 0.9763; val_best_f1_score: 0.9763; train_kl_reg_loss: 2779.3495; train_edge_recon_loss: 27084.4641; train_gene_expr_recon_loss: 17197.1233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47060.9370; train_optim_loss: 47060.9370; val_kl_reg_loss: 2758.1602; val_edge_recon_loss: 26254.7049; val_gene_expr_recon_loss: 17082.4329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46095.2978; val_optim_loss: 46095.2978

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 255 min 3 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
val AUROC score: 0.9974
val AUPRC score: 0.9971
val best accuracy score: 0.9766
val best F1 score: 0.9766
val target rna MSE score: 3.7311
val source rna MSE score: 0.3923

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
