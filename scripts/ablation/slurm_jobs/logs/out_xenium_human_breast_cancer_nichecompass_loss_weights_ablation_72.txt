None
Run timestamp: 28072023_164356_72.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_72']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9878; val_auprc_score: 0.9857; val_best_acc_score: 0.9500; val_best_f1_score: 0.9510; train_kl_reg_loss: 2272.1492; train_edge_recon_loss: 27740.2512; train_gene_expr_recon_loss: 12514.6683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42527.0688; train_optim_loss: 42527.0688; val_kl_reg_loss: 2399.2965; val_edge_recon_loss: 26405.6787; val_gene_expr_recon_loss: 11325.7927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40130.7681; val_optim_loss: 40130.7681
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9916; val_auprc_score: 0.9903; val_best_acc_score: 0.9600; val_best_f1_score: 0.9606; train_kl_reg_loss: 2401.7721; train_edge_recon_loss: 27285.4838; train_gene_expr_recon_loss: 11148.9156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40836.1715; train_optim_loss: 40836.1715; val_kl_reg_loss: 2482.9623; val_edge_recon_loss: 26269.2576; val_gene_expr_recon_loss: 10854.1366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39606.3565; val_optim_loss: 39606.3565
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9937; val_auprc_score: 0.9925; val_best_acc_score: 0.9669; val_best_f1_score: 0.9672; train_kl_reg_loss: 2441.3308; train_edge_recon_loss: 27176.8929; train_gene_expr_recon_loss: 10885.2696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40503.4933; train_optim_loss: 40503.4933; val_kl_reg_loss: 2515.7184; val_edge_recon_loss: 26234.4959; val_gene_expr_recon_loss: 10746.1148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39496.3291; val_optim_loss: 39496.3291
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9939; val_auprc_score: 0.9926; val_best_acc_score: 0.9682; val_best_f1_score: 0.9685; train_kl_reg_loss: 2461.7317; train_edge_recon_loss: 27120.8713; train_gene_expr_recon_loss: 10798.8649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40381.4679; train_optim_loss: 40381.4679; val_kl_reg_loss: 2390.8407; val_edge_recon_loss: 26178.6908; val_gene_expr_recon_loss: 10666.3144; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39235.8459; val_optim_loss: 39235.8459
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9944; val_auprc_score: 0.9933; val_best_acc_score: 0.9698; val_best_f1_score: 0.9701; train_kl_reg_loss: 2474.6281; train_edge_recon_loss: 27090.3812; train_gene_expr_recon_loss: 10755.1028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40320.1121; train_optim_loss: 40320.1121; val_kl_reg_loss: 2318.8965; val_edge_recon_loss: 26153.5613; val_gene_expr_recon_loss: 10658.2364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39130.6941; val_optim_loss: 39130.6941
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9945; val_auprc_score: 0.9935; val_best_acc_score: 0.9697; val_best_f1_score: 0.9701; train_kl_reg_loss: 2482.9617; train_edge_recon_loss: 27068.7685; train_gene_expr_recon_loss: 10731.8979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40283.6281; train_optim_loss: 40283.6281; val_kl_reg_loss: 2583.3594; val_edge_recon_loss: 26075.7361; val_gene_expr_recon_loss: 10639.4185; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39298.5138; val_optim_loss: 39298.5138
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9949; val_auprc_score: 0.9940; val_best_acc_score: 0.9711; val_best_f1_score: 0.9714; train_kl_reg_loss: 2491.0309; train_edge_recon_loss: 27043.0740; train_gene_expr_recon_loss: 10717.8693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40251.9741; train_optim_loss: 40251.9741; val_kl_reg_loss: 2548.1669; val_edge_recon_loss: 26058.2866; val_gene_expr_recon_loss: 10624.3935; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39230.8469; val_optim_loss: 39230.8469
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9953; val_auprc_score: 0.9943; val_best_acc_score: 0.9731; val_best_f1_score: 0.9734; train_kl_reg_loss: 2494.2507; train_edge_recon_loss: 27030.1974; train_gene_expr_recon_loss: 10708.8323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40233.2804; train_optim_loss: 40233.2804; val_kl_reg_loss: 2479.7803; val_edge_recon_loss: 26036.5932; val_gene_expr_recon_loss: 10608.7022; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39125.0757; val_optim_loss: 39125.0757
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9953; val_auprc_score: 0.9942; val_best_acc_score: 0.9728; val_best_f1_score: 0.9730; train_kl_reg_loss: 2495.2163; train_edge_recon_loss: 27025.3939; train_gene_expr_recon_loss: 10704.2151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40224.8253; train_optim_loss: 40224.8253; val_kl_reg_loss: 2508.1741; val_edge_recon_loss: 26067.1321; val_gene_expr_recon_loss: 10618.7528; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39194.0590; val_optim_loss: 39194.0590
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9956; val_auprc_score: 0.9947; val_best_acc_score: 0.9739; val_best_f1_score: 0.9741; train_kl_reg_loss: 2499.3113; train_edge_recon_loss: 27001.5941; train_gene_expr_recon_loss: 10699.8068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40200.7123; train_optim_loss: 40200.7123; val_kl_reg_loss: 2495.6452; val_edge_recon_loss: 26034.9124; val_gene_expr_recon_loss: 10604.1665; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39134.7242; val_optim_loss: 39134.7242
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9960; val_auprc_score: 0.9951; val_best_acc_score: 0.9761; val_best_f1_score: 0.9763; train_kl_reg_loss: 2500.3667; train_edge_recon_loss: 26995.9889; train_gene_expr_recon_loss: 10697.1499; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40193.5055; train_optim_loss: 40193.5055; val_kl_reg_loss: 2509.3218; val_edge_recon_loss: 26003.9821; val_gene_expr_recon_loss: 10593.7678; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39107.0717; val_optim_loss: 39107.0717
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9962; val_auprc_score: 0.9954; val_best_acc_score: 0.9768; val_best_f1_score: 0.9770; train_kl_reg_loss: 2498.8128; train_edge_recon_loss: 26997.5003; train_gene_expr_recon_loss: 10692.6098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40188.9229; train_optim_loss: 40188.9229; val_kl_reg_loss: 2476.7825; val_edge_recon_loss: 26024.8840; val_gene_expr_recon_loss: 10584.0763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39085.7427; val_optim_loss: 39085.7427
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9961; val_auprc_score: 0.9952; val_best_acc_score: 0.9765; val_best_f1_score: 0.9768; train_kl_reg_loss: 2499.8338; train_edge_recon_loss: 26987.1916; train_gene_expr_recon_loss: 10689.1114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40176.1368; train_optim_loss: 40176.1368; val_kl_reg_loss: 2490.1802; val_edge_recon_loss: 25975.7650; val_gene_expr_recon_loss: 10605.4857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39071.4310; val_optim_loss: 39071.4310
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9961; val_auprc_score: 0.9951; val_best_acc_score: 0.9769; val_best_f1_score: 0.9771; train_kl_reg_loss: 2500.9644; train_edge_recon_loss: 26978.1830; train_gene_expr_recon_loss: 10684.3816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40163.5291; train_optim_loss: 40163.5291; val_kl_reg_loss: 2493.2125; val_edge_recon_loss: 25998.5754; val_gene_expr_recon_loss: 10613.2940; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39105.0819; val_optim_loss: 39105.0819
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9964; val_auprc_score: 0.9957; val_best_acc_score: 0.9778; val_best_f1_score: 0.9780; train_kl_reg_loss: 2501.9303; train_edge_recon_loss: 26966.8841; train_gene_expr_recon_loss: 10682.8806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40151.6952; train_optim_loss: 40151.6952; val_kl_reg_loss: 2483.4716; val_edge_recon_loss: 25945.4238; val_gene_expr_recon_loss: 10590.5208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39019.4162; val_optim_loss: 39019.4162
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9964; val_auprc_score: 0.9956; val_best_acc_score: 0.9782; val_best_f1_score: 0.9784; train_kl_reg_loss: 2501.5988; train_edge_recon_loss: 26963.9507; train_gene_expr_recon_loss: 10681.1154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40146.6650; train_optim_loss: 40146.6650; val_kl_reg_loss: 2553.9524; val_edge_recon_loss: 25938.1530; val_gene_expr_recon_loss: 10597.7534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39089.8589; val_optim_loss: 39089.8589
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9965; val_auprc_score: 0.9958; val_best_acc_score: 0.9778; val_best_f1_score: 0.9779; train_kl_reg_loss: 2502.8341; train_edge_recon_loss: 26959.3246; train_gene_expr_recon_loss: 10680.3410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40142.4997; train_optim_loss: 40142.4997; val_kl_reg_loss: 2535.8683; val_edge_recon_loss: 25981.9881; val_gene_expr_recon_loss: 10606.7735; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39124.6300; val_optim_loss: 39124.6300
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9967; val_auprc_score: 0.9959; val_best_acc_score: 0.9781; val_best_f1_score: 0.9783; train_kl_reg_loss: 2504.7086; train_edge_recon_loss: 26951.1975; train_gene_expr_recon_loss: 10677.9958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40133.9019; train_optim_loss: 40133.9019; val_kl_reg_loss: 2474.6733; val_edge_recon_loss: 25977.9099; val_gene_expr_recon_loss: 10592.2704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39044.8536; val_optim_loss: 39044.8536
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9964; val_auprc_score: 0.9958; val_best_acc_score: 0.9776; val_best_f1_score: 0.9779; train_kl_reg_loss: 2503.4814; train_edge_recon_loss: 26951.1593; train_gene_expr_recon_loss: 10674.9213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40129.5621; train_optim_loss: 40129.5621; val_kl_reg_loss: 2539.2517; val_edge_recon_loss: 25953.8214; val_gene_expr_recon_loss: 10591.3742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39084.4474; val_optim_loss: 39084.4474

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9969; val_auprc_score: 0.9961; val_best_acc_score: 0.9796; val_best_f1_score: 0.9797; train_kl_reg_loss: 2503.5840; train_edge_recon_loss: 26919.4560; train_gene_expr_recon_loss: 10644.7585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40067.7985; train_optim_loss: 40067.7985; val_kl_reg_loss: 2501.3596; val_edge_recon_loss: 25894.9054; val_gene_expr_recon_loss: 10568.0459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38964.3109; val_optim_loss: 38964.3109
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9971; val_auprc_score: 0.9966; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 2502.0990; train_edge_recon_loss: 26915.4021; train_gene_expr_recon_loss: 10637.7405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40055.2417; train_optim_loss: 40055.2417; val_kl_reg_loss: 2498.5845; val_edge_recon_loss: 25901.4955; val_gene_expr_recon_loss: 10560.2963; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38960.3763; val_optim_loss: 38960.3763
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9970; val_auprc_score: 0.9964; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 2500.6600; train_edge_recon_loss: 26921.9039; train_gene_expr_recon_loss: 10636.3202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40058.8841; train_optim_loss: 40058.8841; val_kl_reg_loss: 2497.7056; val_edge_recon_loss: 25908.4830; val_gene_expr_recon_loss: 10562.2239; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38968.4125; val_optim_loss: 38968.4125
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9807; val_best_f1_score: 0.9808; train_kl_reg_loss: 2501.0015; train_edge_recon_loss: 26915.4877; train_gene_expr_recon_loss: 10631.4799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40047.9691; train_optim_loss: 40047.9691; val_kl_reg_loss: 2496.4785; val_edge_recon_loss: 25892.8102; val_gene_expr_recon_loss: 10556.5219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38945.8107; val_optim_loss: 38945.8107
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 2501.2290; train_edge_recon_loss: 26915.6456; train_gene_expr_recon_loss: 10634.5853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40051.4598; train_optim_loss: 40051.4598; val_kl_reg_loss: 2486.0305; val_edge_recon_loss: 25885.5097; val_gene_expr_recon_loss: 10546.8942; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38918.4344; val_optim_loss: 38918.4344
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9972; val_auprc_score: 0.9965; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 2502.3368; train_edge_recon_loss: 26909.3040; train_gene_expr_recon_loss: 10632.6719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40044.3127; train_optim_loss: 40044.3127; val_kl_reg_loss: 2498.9985; val_edge_recon_loss: 25904.2822; val_gene_expr_recon_loss: 10554.6429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38957.9236; val_optim_loss: 38957.9236
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9971; val_auprc_score: 0.9965; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 2500.5230; train_edge_recon_loss: 26914.8592; train_gene_expr_recon_loss: 10630.2270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40045.6093; train_optim_loss: 40045.6093; val_kl_reg_loss: 2499.5373; val_edge_recon_loss: 25916.8211; val_gene_expr_recon_loss: 10551.2828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38967.6413; val_optim_loss: 38967.6413
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9971; val_auprc_score: 0.9964; val_best_acc_score: 0.9806; val_best_f1_score: 0.9807; train_kl_reg_loss: 2502.6175; train_edge_recon_loss: 26907.3512; train_gene_expr_recon_loss: 10632.9921; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40042.9608; train_optim_loss: 40042.9608; val_kl_reg_loss: 2498.8318; val_edge_recon_loss: 25885.6250; val_gene_expr_recon_loss: 10562.1751; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38946.6319; val_optim_loss: 38946.6319
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9970; val_auprc_score: 0.9962; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 2502.6937; train_edge_recon_loss: 26907.9608; train_gene_expr_recon_loss: 10631.5846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40042.2391; train_optim_loss: 40042.2391; val_kl_reg_loss: 2485.0401; val_edge_recon_loss: 25885.0763; val_gene_expr_recon_loss: 10550.6340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38920.7504; val_optim_loss: 38920.7504

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9810; val_best_f1_score: 0.9811; train_kl_reg_loss: 2500.6382; train_edge_recon_loss: 26910.6568; train_gene_expr_recon_loss: 10626.6915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40037.9865; train_optim_loss: 40037.9865; val_kl_reg_loss: 2496.9353; val_edge_recon_loss: 25879.6119; val_gene_expr_recon_loss: 10544.1911; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38920.7383; val_optim_loss: 38920.7383
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 2501.2062; train_edge_recon_loss: 26910.0723; train_gene_expr_recon_loss: 10624.9391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40036.2176; train_optim_loss: 40036.2176; val_kl_reg_loss: 2491.4433; val_edge_recon_loss: 25889.1192; val_gene_expr_recon_loss: 10533.1072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38913.6697; val_optim_loss: 38913.6697
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9971; val_auprc_score: 0.9964; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 2501.2433; train_edge_recon_loss: 26906.6890; train_gene_expr_recon_loss: 10625.3481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40033.2804; train_optim_loss: 40033.2804; val_kl_reg_loss: 2489.8888; val_edge_recon_loss: 25875.4921; val_gene_expr_recon_loss: 10545.6519; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38911.0330; val_optim_loss: 38911.0330
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 2501.0775; train_edge_recon_loss: 26907.6257; train_gene_expr_recon_loss: 10627.3288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40036.0320; train_optim_loss: 40036.0320; val_kl_reg_loss: 2494.2989; val_edge_recon_loss: 25876.4157; val_gene_expr_recon_loss: 10550.4778; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38921.1923; val_optim_loss: 38921.1923
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 2503.3501; train_edge_recon_loss: 26899.2637; train_gene_expr_recon_loss: 10627.1625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40029.7763; train_optim_loss: 40029.7763; val_kl_reg_loss: 2494.2061; val_edge_recon_loss: 25900.2742; val_gene_expr_recon_loss: 10548.5681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38943.0486; val_optim_loss: 38943.0486
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9807; val_best_f1_score: 0.9808; train_kl_reg_loss: 2500.2105; train_edge_recon_loss: 26912.2767; train_gene_expr_recon_loss: 10625.5355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40038.0226; train_optim_loss: 40038.0226; val_kl_reg_loss: 2489.0082; val_edge_recon_loss: 25878.1062; val_gene_expr_recon_loss: 10545.3757; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38912.4901; val_optim_loss: 38912.4901
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9971; val_auprc_score: 0.9965; val_best_acc_score: 0.9810; val_best_f1_score: 0.9811; train_kl_reg_loss: 2501.0445; train_edge_recon_loss: 26908.1856; train_gene_expr_recon_loss: 10628.5376; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40037.7678; train_optim_loss: 40037.7678; val_kl_reg_loss: 2493.1978; val_edge_recon_loss: 25888.3927; val_gene_expr_recon_loss: 10551.7095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38933.3000; val_optim_loss: 38933.3000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9973; val_auprc_score: 0.9967; val_best_acc_score: 0.9809; val_best_f1_score: 0.9810; train_kl_reg_loss: 2502.4405; train_edge_recon_loss: 26904.9188; train_gene_expr_recon_loss: 10626.1023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40033.4616; train_optim_loss: 40033.4616; val_kl_reg_loss: 2493.5938; val_edge_recon_loss: 25878.0949; val_gene_expr_recon_loss: 10545.9931; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38917.6819; val_optim_loss: 38917.6819
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 2501.2600; train_edge_recon_loss: 26909.4601; train_gene_expr_recon_loss: 10626.4085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40037.1286; train_optim_loss: 40037.1286; val_kl_reg_loss: 2492.8842; val_edge_recon_loss: 25894.9369; val_gene_expr_recon_loss: 10554.1091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38941.9304; val_optim_loss: 38941.9304
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9972; val_auprc_score: 0.9967; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 2501.1356; train_edge_recon_loss: 26908.0733; train_gene_expr_recon_loss: 10629.0798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40038.2887; train_optim_loss: 40038.2887; val_kl_reg_loss: 2492.6545; val_edge_recon_loss: 25885.9407; val_gene_expr_recon_loss: 10546.8854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38925.4804; val_optim_loss: 38925.4804
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9973; val_auprc_score: 0.9968; val_best_acc_score: 0.9808; val_best_f1_score: 0.9809; train_kl_reg_loss: 2500.6000; train_edge_recon_loss: 26910.2829; train_gene_expr_recon_loss: 10623.3769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40034.2598; train_optim_loss: 40034.2598; val_kl_reg_loss: 2492.4836; val_edge_recon_loss: 25868.9871; val_gene_expr_recon_loss: 10548.5979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38910.0686; val_optim_loss: 38910.0686
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9973; val_auprc_score: 0.9967; val_best_acc_score: 0.9810; val_best_f1_score: 0.9811; train_kl_reg_loss: 2501.6812; train_edge_recon_loss: 26906.8689; train_gene_expr_recon_loss: 10627.7800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40036.3301; train_optim_loss: 40036.3301; val_kl_reg_loss: 2492.8213; val_edge_recon_loss: 25891.4219; val_gene_expr_recon_loss: 10534.5160; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38918.7591; val_optim_loss: 38918.7591
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9971; val_auprc_score: 0.9966; val_best_acc_score: 0.9808; val_best_f1_score: 0.9809; train_kl_reg_loss: 2501.4975; train_edge_recon_loss: 26906.2396; train_gene_expr_recon_loss: 10623.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40030.8517; train_optim_loss: 40030.8517; val_kl_reg_loss: 2492.7305; val_edge_recon_loss: 25896.7990; val_gene_expr_recon_loss: 10549.8950; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38939.4245; val_optim_loss: 38939.4245
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9809; val_best_f1_score: 0.9810; train_kl_reg_loss: 2502.0471; train_edge_recon_loss: 26900.3959; train_gene_expr_recon_loss: 10624.7012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40027.1442; train_optim_loss: 40027.1442; val_kl_reg_loss: 2493.3211; val_edge_recon_loss: 25893.8349; val_gene_expr_recon_loss: 10543.4350; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38930.5909; val_optim_loss: 38930.5909
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9971; val_auprc_score: 0.9964; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 2501.2334; train_edge_recon_loss: 26910.6889; train_gene_expr_recon_loss: 10619.6454; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40031.5678; train_optim_loss: 40031.5678; val_kl_reg_loss: 2492.3866; val_edge_recon_loss: 25900.0094; val_gene_expr_recon_loss: 10543.8305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38936.2266; val_optim_loss: 38936.2266

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9973; val_auprc_score: 0.9968; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 2501.5678; train_edge_recon_loss: 26904.9363; train_gene_expr_recon_loss: 10625.1968; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40031.7009; train_optim_loss: 40031.7009; val_kl_reg_loss: 2492.9563; val_edge_recon_loss: 25875.9649; val_gene_expr_recon_loss: 10546.8790; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38915.8001; val_optim_loss: 38915.8001
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9971; val_auprc_score: 0.9965; val_best_acc_score: 0.9808; val_best_f1_score: 0.9809; train_kl_reg_loss: 2501.5219; train_edge_recon_loss: 26903.7889; train_gene_expr_recon_loss: 10623.8150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40029.1259; train_optim_loss: 40029.1259; val_kl_reg_loss: 2492.7973; val_edge_recon_loss: 25877.6792; val_gene_expr_recon_loss: 10545.5524; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38916.0290; val_optim_loss: 38916.0290
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9971; val_auprc_score: 0.9963; val_best_acc_score: 0.9806; val_best_f1_score: 0.9807; train_kl_reg_loss: 2501.6009; train_edge_recon_loss: 26902.3214; train_gene_expr_recon_loss: 10627.6758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40031.5981; train_optim_loss: 40031.5981; val_kl_reg_loss: 2492.7131; val_edge_recon_loss: 25891.6379; val_gene_expr_recon_loss: 10548.4680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38932.8191; val_optim_loss: 38932.8191
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9973; val_auprc_score: 0.9969; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 2501.7862; train_edge_recon_loss: 26902.2250; train_gene_expr_recon_loss: 10627.2835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40031.2947; train_optim_loss: 40031.2947; val_kl_reg_loss: 2492.8054; val_edge_recon_loss: 25873.7235; val_gene_expr_recon_loss: 10550.0969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38916.6259; val_optim_loss: 38916.6259

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 779 min 15 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
val AUROC score: 0.9971
val AUPRC score: 0.9966
val best accuracy score: 0.9812
val best F1 score: 0.9814
val target rna MSE score: 1.4779
val source rna MSE score: 0.1090

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
