None
Run timestamp: 16072023_144133_1001.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_1001']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1818, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1818, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9837; val_auprc_score: 0.9758; val_best_acc_score: 0.9538; val_best_f1_score: 0.9549; train_kl_reg_loss: 12473.8160; train_edge_recon_loss: 2695429.9762; train_gene_expr_recon_loss: 2091441.7065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4799345.4932; train_optim_loss: 4799345.4932; val_kl_reg_loss: 12964.0688; val_edge_recon_loss: 2604619.1768; val_gene_expr_recon_loss: 2001406.0549; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4618989.2805; val_optim_loss: 4618989.2805
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9860; val_auprc_score: 0.9803; val_best_acc_score: 0.9615; val_best_f1_score: 0.9624; train_kl_reg_loss: 12823.0278; train_edge_recon_loss: 2585811.9130; train_gene_expr_recon_loss: 1973538.9599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4572173.9035; train_optim_loss: 4572173.9035; val_kl_reg_loss: 12659.7946; val_edge_recon_loss: 2593170.5549; val_gene_expr_recon_loss: 1944426.8628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4550257.2439; val_optim_loss: 4550257.2439
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9884; val_auprc_score: 0.9839; val_best_acc_score: 0.9651; val_best_f1_score: 0.9659; train_kl_reg_loss: 12775.2894; train_edge_recon_loss: 2577553.8879; train_gene_expr_recon_loss: 1926444.5329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4516773.6957; train_optim_loss: 4516773.6957; val_kl_reg_loss: 12948.3057; val_edge_recon_loss: 2585318.5366; val_gene_expr_recon_loss: 1906398.4939; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4504665.3293; val_optim_loss: 4504665.3293
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9889; val_auprc_score: 0.9846; val_best_acc_score: 0.9667; val_best_f1_score: 0.9673; train_kl_reg_loss: 12799.9582; train_edge_recon_loss: 2574409.8458; train_gene_expr_recon_loss: 1891216.0954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4478425.9035; train_optim_loss: 4478425.9035; val_kl_reg_loss: 13478.0025; val_edge_recon_loss: 2580419.7561; val_gene_expr_recon_loss: 1873721.9299; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4467619.6220; val_optim_loss: 4467619.6220
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9901; val_auprc_score: 0.9866; val_best_acc_score: 0.9672; val_best_f1_score: 0.9678; train_kl_reg_loss: 13086.2002; train_edge_recon_loss: 2571298.3933; train_gene_expr_recon_loss: 1863068.4457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4447453.0326; train_optim_loss: 4447453.0326; val_kl_reg_loss: 12971.5361; val_edge_recon_loss: 2583153.6585; val_gene_expr_recon_loss: 1849789.1677; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4445914.3659; val_optim_loss: 4445914.3659
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9899; val_auprc_score: 0.9860; val_best_acc_score: 0.9676; val_best_f1_score: 0.9682; train_kl_reg_loss: 13094.9990; train_edge_recon_loss: 2568305.6637; train_gene_expr_recon_loss: 1840251.8808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4421652.5598; train_optim_loss: 4421652.5598; val_kl_reg_loss: 13413.2514; val_edge_recon_loss: 2578315.7805; val_gene_expr_recon_loss: 1823976.0610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4415705.1341; val_optim_loss: 4415705.1341
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9904; val_auprc_score: 0.9872; val_best_acc_score: 0.9679; val_best_f1_score: 0.9685; train_kl_reg_loss: 13110.4936; train_edge_recon_loss: 2567194.5822; train_gene_expr_recon_loss: 1815924.6963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4396229.7704; train_optim_loss: 4396229.7704; val_kl_reg_loss: 13001.9254; val_edge_recon_loss: 2577320.2317; val_gene_expr_recon_loss: 1812017.8171; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4402339.9878; val_optim_loss: 4402339.9878
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9909; val_auprc_score: 0.9877; val_best_acc_score: 0.9695; val_best_f1_score: 0.9700; train_kl_reg_loss: 13147.8709; train_edge_recon_loss: 2566899.6990; train_gene_expr_recon_loss: 1796795.5306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4376843.1033; train_optim_loss: 4376843.1033; val_kl_reg_loss: 14497.6203; val_edge_recon_loss: 2577276.4207; val_gene_expr_recon_loss: 1799947.3841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4391721.4024; val_optim_loss: 4391721.4024
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9910; val_auprc_score: 0.9878; val_best_acc_score: 0.9693; val_best_f1_score: 0.9698; train_kl_reg_loss: 13220.9016; train_edge_recon_loss: 2565223.1535; train_gene_expr_recon_loss: 1777008.4912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4355452.5353; train_optim_loss: 4355452.5353; val_kl_reg_loss: 13948.4473; val_edge_recon_loss: 2580795.2805; val_gene_expr_recon_loss: 1788217.1646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4382960.8537; val_optim_loss: 4382960.8537
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9915; val_auprc_score: 0.9887; val_best_acc_score: 0.9706; val_best_f1_score: 0.9712; train_kl_reg_loss: 13287.7143; train_edge_recon_loss: 2565521.9837; train_gene_expr_recon_loss: 1761877.6919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4340687.3927; train_optim_loss: 4340687.3927; val_kl_reg_loss: 13189.3691; val_edge_recon_loss: 2576127.6037; val_gene_expr_recon_loss: 1773408.9848; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4362725.9512; val_optim_loss: 4362725.9512
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9912; val_auprc_score: 0.9884; val_best_acc_score: 0.9704; val_best_f1_score: 0.9709; train_kl_reg_loss: 13309.3973; train_edge_recon_loss: 2566000.8234; train_gene_expr_recon_loss: 1749140.7031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4328450.9062; train_optim_loss: 4328450.9062; val_kl_reg_loss: 13305.0599; val_edge_recon_loss: 2578269.3780; val_gene_expr_recon_loss: 1762148.2927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4353722.7439; val_optim_loss: 4353722.7439
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9921; val_auprc_score: 0.9898; val_best_acc_score: 0.9718; val_best_f1_score: 0.9723; train_kl_reg_loss: 13377.9988; train_edge_recon_loss: 2565262.2344; train_gene_expr_recon_loss: 1740105.4164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4318745.6386; train_optim_loss: 4318745.6386; val_kl_reg_loss: 13863.1765; val_edge_recon_loss: 2575486.2561; val_gene_expr_recon_loss: 1758581.9848; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4347931.4024; val_optim_loss: 4347931.4024
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9920; val_auprc_score: 0.9894; val_best_acc_score: 0.9722; val_best_f1_score: 0.9728; train_kl_reg_loss: 13499.9422; train_edge_recon_loss: 2564720.0618; train_gene_expr_recon_loss: 1727022.3128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4305242.2982; train_optim_loss: 4305242.2982; val_kl_reg_loss: 13288.8842; val_edge_recon_loss: 2569908.6037; val_gene_expr_recon_loss: 1752404.3537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4335601.8780; val_optim_loss: 4335601.8780
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9917; val_auprc_score: 0.9891; val_best_acc_score: 0.9725; val_best_f1_score: 0.9731; train_kl_reg_loss: 13534.0517; train_edge_recon_loss: 2563305.0564; train_gene_expr_recon_loss: 1721134.2520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4297973.3601; train_optim_loss: 4297973.3601; val_kl_reg_loss: 13354.6289; val_edge_recon_loss: 2573058.9451; val_gene_expr_recon_loss: 1744399.6555; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4330813.2195; val_optim_loss: 4330813.2195
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9912; val_auprc_score: 0.9883; val_best_acc_score: 0.9713; val_best_f1_score: 0.9718; train_kl_reg_loss: 13594.5983; train_edge_recon_loss: 2563881.4980; train_gene_expr_recon_loss: 1714001.4314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4291477.5149; train_optim_loss: 4291477.5149; val_kl_reg_loss: 13397.8456; val_edge_recon_loss: 2574106.1768; val_gene_expr_recon_loss: 1743884.0671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4331388.0976; val_optim_loss: 4331388.0976
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9920; val_auprc_score: 0.9894; val_best_acc_score: 0.9725; val_best_f1_score: 0.9730; train_kl_reg_loss: 13656.6492; train_edge_recon_loss: 2562744.1107; train_gene_expr_recon_loss: 1710086.8040; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4286487.5530; train_optim_loss: 4286487.5530; val_kl_reg_loss: 13728.4707; val_edge_recon_loss: 2572012.6402; val_gene_expr_recon_loss: 1737121.2652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4322862.3537; val_optim_loss: 4322862.3537
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9916; val_auprc_score: 0.9889; val_best_acc_score: 0.9724; val_best_f1_score: 0.9729; train_kl_reg_loss: 13721.1718; train_edge_recon_loss: 2561479.5319; train_gene_expr_recon_loss: 1704605.8448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4279806.5577; train_optim_loss: 4279806.5577; val_kl_reg_loss: 13621.2608; val_edge_recon_loss: 2575534.7134; val_gene_expr_recon_loss: 1739750.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4328906.1951; val_optim_loss: 4328906.1951
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9920; val_auprc_score: 0.9894; val_best_acc_score: 0.9726; val_best_f1_score: 0.9731; train_kl_reg_loss: 13765.5233; train_edge_recon_loss: 2561608.4891; train_gene_expr_recon_loss: 1700617.0122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4275991.0224; train_optim_loss: 4275991.0224; val_kl_reg_loss: 13558.8893; val_edge_recon_loss: 2573216.4878; val_gene_expr_recon_loss: 1731287.1860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4318062.5732; val_optim_loss: 4318062.5732
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9923; val_auprc_score: 0.9899; val_best_acc_score: 0.9730; val_best_f1_score: 0.9735; train_kl_reg_loss: 13813.0255; train_edge_recon_loss: 2562966.3471; train_gene_expr_recon_loss: 1696135.6029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4272914.9851; train_optim_loss: 4272914.9851; val_kl_reg_loss: 13696.2950; val_edge_recon_loss: 2571227.3537; val_gene_expr_recon_loss: 1734172.7012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4319096.3049; val_optim_loss: 4319096.3049
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9919; val_auprc_score: 0.9891; val_best_acc_score: 0.9735; val_best_f1_score: 0.9739; train_kl_reg_loss: 13853.0985; train_edge_recon_loss: 2561655.2615; train_gene_expr_recon_loss: 1693020.7293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4268529.0863; train_optim_loss: 4268529.0863; val_kl_reg_loss: 13613.0742; val_edge_recon_loss: 2572523.7622; val_gene_expr_recon_loss: 1736246.2378; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4322383.0854; val_optim_loss: 4322383.0854
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9925; val_auprc_score: 0.9903; val_best_acc_score: 0.9734; val_best_f1_score: 0.9738; train_kl_reg_loss: 13897.1195; train_edge_recon_loss: 2559916.3043; train_gene_expr_recon_loss: 1690727.5272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4264540.9334; train_optim_loss: 4264540.9334; val_kl_reg_loss: 13791.3510; val_edge_recon_loss: 2572010.0610; val_gene_expr_recon_loss: 1731302.3841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4317103.7927; val_optim_loss: 4317103.7927
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9918; val_auprc_score: 0.9889; val_best_acc_score: 0.9726; val_best_f1_score: 0.9731; train_kl_reg_loss: 13940.0882; train_edge_recon_loss: 2560577.7636; train_gene_expr_recon_loss: 1686728.4762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4261246.3261; train_optim_loss: 4261246.3261; val_kl_reg_loss: 13723.9425; val_edge_recon_loss: 2570578.2622; val_gene_expr_recon_loss: 1732026.4665; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4316328.6707; val_optim_loss: 4316328.6707
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9924; val_auprc_score: 0.9902; val_best_acc_score: 0.9720; val_best_f1_score: 0.9724; train_kl_reg_loss: 13968.4693; train_edge_recon_loss: 2560057.6141; train_gene_expr_recon_loss: 1686134.6056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4260160.6929; train_optim_loss: 4260160.6929; val_kl_reg_loss: 13792.3804; val_edge_recon_loss: 2570888.0976; val_gene_expr_recon_loss: 1735039.6372; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4319720.1220; val_optim_loss: 4319720.1220
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9912; val_auprc_score: 0.9879; val_best_acc_score: 0.9722; val_best_f1_score: 0.9727; train_kl_reg_loss: 13986.0842; train_edge_recon_loss: 2559471.6026; train_gene_expr_recon_loss: 1684734.7123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4258192.4015; train_optim_loss: 4258192.4015; val_kl_reg_loss: 13894.8180; val_edge_recon_loss: 2574577.7500; val_gene_expr_recon_loss: 1730756.7287; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4319229.3293; val_optim_loss: 4319229.3293
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9923; val_auprc_score: 0.9899; val_best_acc_score: 0.9733; val_best_f1_score: 0.9737; train_kl_reg_loss: 14027.1564; train_edge_recon_loss: 2559660.4844; train_gene_expr_recon_loss: 1681634.9433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4255322.5761; train_optim_loss: 4255322.5761; val_kl_reg_loss: 13845.9551; val_edge_recon_loss: 2567730.5854; val_gene_expr_recon_loss: 1732778.8689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4314355.4390; val_optim_loss: 4314355.4390
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9922; val_auprc_score: 0.9898; val_best_acc_score: 0.9729; val_best_f1_score: 0.9734; train_kl_reg_loss: 14036.7930; train_edge_recon_loss: 2560247.9905; train_gene_expr_recon_loss: 1679916.3760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4254201.1610; train_optim_loss: 4254201.1610; val_kl_reg_loss: 13870.0664; val_edge_recon_loss: 2570213.6890; val_gene_expr_recon_loss: 1729820.2530; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4313904.0244; val_optim_loss: 4313904.0244
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9913; val_auprc_score: 0.9879; val_best_acc_score: 0.9716; val_best_f1_score: 0.9722; train_kl_reg_loss: 14086.9597; train_edge_recon_loss: 2559129.0408; train_gene_expr_recon_loss: 1677669.1012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4250885.1026; train_optim_loss: 4250885.1026; val_kl_reg_loss: 13971.6593; val_edge_recon_loss: 2571913.7988; val_gene_expr_recon_loss: 1738117.1951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4324002.6829; val_optim_loss: 4324002.6829
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9922; val_auprc_score: 0.9894; val_best_acc_score: 0.9730; val_best_f1_score: 0.9734; train_kl_reg_loss: 14101.3280; train_edge_recon_loss: 2558642.9443; train_gene_expr_recon_loss: 1677807.3927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4250551.6637; train_optim_loss: 4250551.6637; val_kl_reg_loss: 13883.7082; val_edge_recon_loss: 2569723.3537; val_gene_expr_recon_loss: 1738169.5091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4321776.5732; val_optim_loss: 4321776.5732
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9925; val_auprc_score: 0.9902; val_best_acc_score: 0.9743; val_best_f1_score: 0.9747; train_kl_reg_loss: 14113.8498; train_edge_recon_loss: 2559152.4151; train_gene_expr_recon_loss: 1675509.3050; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4248775.5686; train_optim_loss: 4248775.5686; val_kl_reg_loss: 14010.9099; val_edge_recon_loss: 2566605.6341; val_gene_expr_recon_loss: 1735042.7073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4315659.2317; val_optim_loss: 4315659.2317
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9925; val_auprc_score: 0.9902; val_best_acc_score: 0.9734; val_best_f1_score: 0.9738; train_kl_reg_loss: 14141.5288; train_edge_recon_loss: 2557947.8159; train_gene_expr_recon_loss: 1674504.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4246594.1658; train_optim_loss: 4246594.1658; val_kl_reg_loss: 13886.2084; val_edge_recon_loss: 2568943.3537; val_gene_expr_recon_loss: 1736743.2957; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4319572.8293; val_optim_loss: 4319572.8293

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9920; val_auprc_score: 0.9892; val_best_acc_score: 0.9726; val_best_f1_score: 0.9730; train_kl_reg_loss: 14339.9026; train_edge_recon_loss: 2556755.2446; train_gene_expr_recon_loss: 1650246.2575; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4221341.4117; train_optim_loss: 4221341.4117; val_kl_reg_loss: 14134.9341; val_edge_recon_loss: 2565533.6829; val_gene_expr_recon_loss: 1724645.9360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4304314.5732; val_optim_loss: 4304314.5732
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9921; val_auprc_score: 0.9898; val_best_acc_score: 0.9720; val_best_f1_score: 0.9725; train_kl_reg_loss: 14290.7498; train_edge_recon_loss: 2555752.4246; train_gene_expr_recon_loss: 1646658.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4216701.8213; train_optim_loss: 4216701.8213; val_kl_reg_loss: 14109.7502; val_edge_recon_loss: 2567204.2195; val_gene_expr_recon_loss: 1723445.7134; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4304759.7195; val_optim_loss: 4304759.7195
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9925; val_auprc_score: 0.9900; val_best_acc_score: 0.9735; val_best_f1_score: 0.9739; train_kl_reg_loss: 14306.0317; train_edge_recon_loss: 2555122.3736; train_gene_expr_recon_loss: 1646488.1766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4215916.5781; train_optim_loss: 4215916.5781; val_kl_reg_loss: 14142.8215; val_edge_recon_loss: 2561137.9573; val_gene_expr_recon_loss: 1721348.7104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4296629.4634; val_optim_loss: 4296629.4634
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9916; val_auprc_score: 0.9889; val_best_acc_score: 0.9719; val_best_f1_score: 0.9725; train_kl_reg_loss: 14330.3978; train_edge_recon_loss: 2554362.5673; train_gene_expr_recon_loss: 1645242.3465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4213935.3037; train_optim_loss: 4213935.3037; val_kl_reg_loss: 14192.9458; val_edge_recon_loss: 2565773.2744; val_gene_expr_recon_loss: 1722587.4024; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4302553.6341; val_optim_loss: 4302553.6341
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9923; val_auprc_score: 0.9900; val_best_acc_score: 0.9729; val_best_f1_score: 0.9733; train_kl_reg_loss: 14351.3502; train_edge_recon_loss: 2554365.0312; train_gene_expr_recon_loss: 1644040.4263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4212756.8166; train_optim_loss: 4212756.8166; val_kl_reg_loss: 14213.6223; val_edge_recon_loss: 2563112.2622; val_gene_expr_recon_loss: 1726402.8841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4303728.7683; val_optim_loss: 4303728.7683
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9925; val_auprc_score: 0.9900; val_best_acc_score: 0.9732; val_best_f1_score: 0.9736; train_kl_reg_loss: 14373.1434; train_edge_recon_loss: 2552717.5836; train_gene_expr_recon_loss: 1644408.6770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4211499.4232; train_optim_loss: 4211499.4232; val_kl_reg_loss: 14249.4165; val_edge_recon_loss: 2562319.7378; val_gene_expr_recon_loss: 1723852.3994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4300421.5488; val_optim_loss: 4300421.5488
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9923; val_auprc_score: 0.9898; val_best_acc_score: 0.9727; val_best_f1_score: 0.9732; train_kl_reg_loss: 14390.4313; train_edge_recon_loss: 2554124.5476; train_gene_expr_recon_loss: 1643360.5754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4211875.5401; train_optim_loss: 4211875.5401; val_kl_reg_loss: 14233.8777; val_edge_recon_loss: 2563382.3780; val_gene_expr_recon_loss: 1723352.7591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4300968.9634; val_optim_loss: 4300968.9634

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9923; val_auprc_score: 0.9897; val_best_acc_score: 0.9732; val_best_f1_score: 0.9737; train_kl_reg_loss: 14448.5174; train_edge_recon_loss: 2552935.1535; train_gene_expr_recon_loss: 1638949.3339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4206333.0027; train_optim_loss: 4206333.0027; val_kl_reg_loss: 14279.3055; val_edge_recon_loss: 2563401.5610; val_gene_expr_recon_loss: 1730864.8689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4308545.7195; val_optim_loss: 4308545.7195
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9925; val_auprc_score: 0.9900; val_best_acc_score: 0.9732; val_best_f1_score: 0.9737; train_kl_reg_loss: 14464.4369; train_edge_recon_loss: 2554572.4708; train_gene_expr_recon_loss: 1639770.3794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4208807.2867; train_optim_loss: 4208807.2867; val_kl_reg_loss: 14255.5057; val_edge_recon_loss: 2562122.8902; val_gene_expr_recon_loss: 1722954.1799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4299332.5366; val_optim_loss: 4299332.5366
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9922; val_auprc_score: 0.9896; val_best_acc_score: 0.9735; val_best_f1_score: 0.9738; train_kl_reg_loss: 14451.7694; train_edge_recon_loss: 2554685.1522; train_gene_expr_recon_loss: 1638918.4742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4208055.3899; train_optim_loss: 4208055.3899; val_kl_reg_loss: 14269.4897; val_edge_recon_loss: 2561306.1585; val_gene_expr_recon_loss: 1719391.2652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4294966.9024; val_optim_loss: 4294966.9024
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9921; val_auprc_score: 0.9895; val_best_acc_score: 0.9730; val_best_f1_score: 0.9734; train_kl_reg_loss: 14453.8208; train_edge_recon_loss: 2554314.3886; train_gene_expr_recon_loss: 1638319.9800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4207088.1834; train_optim_loss: 4207088.1834; val_kl_reg_loss: 14260.2293; val_edge_recon_loss: 2563835.9878; val_gene_expr_recon_loss: 1727577.7073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4305673.9390; val_optim_loss: 4305673.9390
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9920; val_auprc_score: 0.9893; val_best_acc_score: 0.9726; val_best_f1_score: 0.9730; train_kl_reg_loss: 14456.0315; train_edge_recon_loss: 2554862.4871; train_gene_expr_recon_loss: 1639294.4310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4208612.9620; train_optim_loss: 4208612.9620; val_kl_reg_loss: 14260.1589; val_edge_recon_loss: 2563750.1707; val_gene_expr_recon_loss: 1723863.5854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4301873.8902; val_optim_loss: 4301873.8902
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9921; val_auprc_score: 0.9895; val_best_acc_score: 0.9730; val_best_f1_score: 0.9735; train_kl_reg_loss: 14451.4506; train_edge_recon_loss: 2553254.7826; train_gene_expr_recon_loss: 1637784.3815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4205490.6189; train_optim_loss: 4205490.6189; val_kl_reg_loss: 14256.1264; val_edge_recon_loss: 2562297.9207; val_gene_expr_recon_loss: 1724730.2470; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4301284.2927; val_optim_loss: 4301284.2927
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9922; val_auprc_score: 0.9898; val_best_acc_score: 0.9732; val_best_f1_score: 0.9736; train_kl_reg_loss: 14449.1247; train_edge_recon_loss: 2553407.8798; train_gene_expr_recon_loss: 1639065.7643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4206922.7636; train_optim_loss: 4206922.7636; val_kl_reg_loss: 14252.2546; val_edge_recon_loss: 2563378.2195; val_gene_expr_recon_loss: 1718609.6463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4296240.1585; val_optim_loss: 4296240.1585

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9923; val_auprc_score: 0.9900; val_best_acc_score: 0.9731; val_best_f1_score: 0.9735; train_kl_reg_loss: 14451.2979; train_edge_recon_loss: 2553571.1087; train_gene_expr_recon_loss: 1637474.0652; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4205496.4558; train_optim_loss: 4205496.4558; val_kl_reg_loss: 14260.4803; val_edge_recon_loss: 2562023.0549; val_gene_expr_recon_loss: 1724749.8537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4301033.4390; val_optim_loss: 4301033.4390
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9918; val_auprc_score: 0.9891; val_best_acc_score: 0.9719; val_best_f1_score: 0.9723; train_kl_reg_loss: 14456.9624; train_edge_recon_loss: 2554056.5469; train_gene_expr_recon_loss: 1637253.6352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4205767.1617; train_optim_loss: 4205767.1617; val_kl_reg_loss: 14263.1963; val_edge_recon_loss: 2566244.2683; val_gene_expr_recon_loss: 1724397.9116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4304905.3537; val_optim_loss: 4304905.3537
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9926; val_auprc_score: 0.9905; val_best_acc_score: 0.9733; val_best_f1_score: 0.9738; train_kl_reg_loss: 14458.4678; train_edge_recon_loss: 2552976.4463; train_gene_expr_recon_loss: 1637621.6882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4205056.5938; train_optim_loss: 4205056.5938; val_kl_reg_loss: 14263.1342; val_edge_recon_loss: 2562981.3171; val_gene_expr_recon_loss: 1722609.8049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4299854.2561; val_optim_loss: 4299854.2561
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9924; val_auprc_score: 0.9901; val_best_acc_score: 0.9727; val_best_f1_score: 0.9732; train_kl_reg_loss: 14461.3082; train_edge_recon_loss: 2553566.4518; train_gene_expr_recon_loss: 1638574.1664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4206601.9334; train_optim_loss: 4206601.9334; val_kl_reg_loss: 14269.3215; val_edge_recon_loss: 2563460.0793; val_gene_expr_recon_loss: 1725434.0915; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4303163.4878; val_optim_loss: 4303163.4878

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 153 min 30 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
Val AUROC score: 0.9920
Val AUPRC score: 0.9894
Val best accuracy score: 0.9734
Val best F1 score: 0.9739
Val gene expr MSE score: 0.4875

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
