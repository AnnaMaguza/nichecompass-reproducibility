None
Run timestamp: 01072023_074237_17.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_17']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9517; val_auprc_score: 0.9364; val_best_acc_score: 0.8936; val_best_f1_score: 0.8987; train_kl_reg_loss: 2115.5140; train_edge_recon_loss: 28204.7748; train_gene_expr_recon_loss: 8367.5553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38687.8440; train_optim_loss: 38687.8440; val_kl_reg_loss: 2273.6532; val_edge_recon_loss: 26950.4767; val_gene_expr_recon_loss: 7475.6505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36699.7806; val_optim_loss: 36699.7806
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9631; val_auprc_score: 0.9527; val_best_acc_score: 0.9079; val_best_f1_score: 0.9113; train_kl_reg_loss: 2297.0485; train_edge_recon_loss: 27521.8825; train_gene_expr_recon_loss: 7365.4583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37184.3893; train_optim_loss: 37184.3893; val_kl_reg_loss: 2312.5549; val_edge_recon_loss: 26893.9445; val_gene_expr_recon_loss: 7068.4860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36274.9853; val_optim_loss: 36274.9853
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9663; val_auprc_score: 0.9565; val_best_acc_score: 0.9149; val_best_f1_score: 0.9178; train_kl_reg_loss: 2336.4432; train_edge_recon_loss: 27422.3587; train_gene_expr_recon_loss: 7082.2263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36841.0282; train_optim_loss: 36841.0282; val_kl_reg_loss: 2248.0955; val_edge_recon_loss: 26880.7393; val_gene_expr_recon_loss: 6833.6810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35962.5157; val_optim_loss: 35962.5157
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9705; val_auprc_score: 0.9630; val_best_acc_score: 0.9206; val_best_f1_score: 0.9233; train_kl_reg_loss: 2359.8242; train_edge_recon_loss: 27386.5595; train_gene_expr_recon_loss: 6904.8935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36651.2773; train_optim_loss: 36651.2773; val_kl_reg_loss: 2239.0516; val_edge_recon_loss: 26840.7410; val_gene_expr_recon_loss: 6720.1411; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35799.9337; val_optim_loss: 35799.9337
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9708; val_auprc_score: 0.9628; val_best_acc_score: 0.9226; val_best_f1_score: 0.9253; train_kl_reg_loss: 2383.2331; train_edge_recon_loss: 27330.5976; train_gene_expr_recon_loss: 6776.3656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36490.1964; train_optim_loss: 36490.1964; val_kl_reg_loss: 2331.4636; val_edge_recon_loss: 26783.5552; val_gene_expr_recon_loss: 6592.5187; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35707.5376; val_optim_loss: 35707.5376
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9719; val_auprc_score: 0.9636; val_best_acc_score: 0.9252; val_best_f1_score: 0.9278; train_kl_reg_loss: 2400.6631; train_edge_recon_loss: 27300.6236; train_gene_expr_recon_loss: 6688.3052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36389.5919; train_optim_loss: 36389.5919; val_kl_reg_loss: 2335.6376; val_edge_recon_loss: 26737.5704; val_gene_expr_recon_loss: 6534.1628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35607.3708; val_optim_loss: 35607.3708
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9722; val_auprc_score: 0.9645; val_best_acc_score: 0.9258; val_best_f1_score: 0.9282; train_kl_reg_loss: 2412.2939; train_edge_recon_loss: 27278.8374; train_gene_expr_recon_loss: 6617.8096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36308.9409; train_optim_loss: 36308.9409; val_kl_reg_loss: 2301.8089; val_edge_recon_loss: 26817.9463; val_gene_expr_recon_loss: 6461.0440; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35580.7992; val_optim_loss: 35580.7992
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9721; val_auprc_score: 0.9636; val_best_acc_score: 0.9261; val_best_f1_score: 0.9284; train_kl_reg_loss: 2417.7941; train_edge_recon_loss: 27281.4925; train_gene_expr_recon_loss: 6567.8887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36267.1752; train_optim_loss: 36267.1752; val_kl_reg_loss: 2294.9031; val_edge_recon_loss: 26763.5290; val_gene_expr_recon_loss: 6421.9233; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35480.3554; val_optim_loss: 35480.3554
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9747; val_auprc_score: 0.9681; val_best_acc_score: 0.9283; val_best_f1_score: 0.9307; train_kl_reg_loss: 2425.1693; train_edge_recon_loss: 27263.8159; train_gene_expr_recon_loss: 6532.1064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36221.0916; train_optim_loss: 36221.0916; val_kl_reg_loss: 2366.0927; val_edge_recon_loss: 26763.5698; val_gene_expr_recon_loss: 6392.7390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35522.4017; val_optim_loss: 35522.4017
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9751; val_auprc_score: 0.9684; val_best_acc_score: 0.9290; val_best_f1_score: 0.9313; train_kl_reg_loss: 2431.2605; train_edge_recon_loss: 27263.0427; train_gene_expr_recon_loss: 6501.6418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36195.9450; train_optim_loss: 36195.9450; val_kl_reg_loss: 2414.7525; val_edge_recon_loss: 26787.4550; val_gene_expr_recon_loss: 6366.0124; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35568.2198; val_optim_loss: 35568.2198
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9749; val_auprc_score: 0.9686; val_best_acc_score: 0.9290; val_best_f1_score: 0.9309; train_kl_reg_loss: 2434.8597; train_edge_recon_loss: 27259.4697; train_gene_expr_recon_loss: 6479.4637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36173.7931; train_optim_loss: 36173.7931; val_kl_reg_loss: 2383.3967; val_edge_recon_loss: 26729.1996; val_gene_expr_recon_loss: 6338.3136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35450.9098; val_optim_loss: 35450.9098
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9764; val_auprc_score: 0.9703; val_best_acc_score: 0.9311; val_best_f1_score: 0.9334; train_kl_reg_loss: 2437.8125; train_edge_recon_loss: 27252.5214; train_gene_expr_recon_loss: 6459.7011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36150.0350; train_optim_loss: 36150.0350; val_kl_reg_loss: 2400.9979; val_edge_recon_loss: 26747.9580; val_gene_expr_recon_loss: 6331.0766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35480.0325; val_optim_loss: 35480.0325
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9753; val_auprc_score: 0.9686; val_best_acc_score: 0.9296; val_best_f1_score: 0.9319; train_kl_reg_loss: 2442.1733; train_edge_recon_loss: 27244.4002; train_gene_expr_recon_loss: 6442.3913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36128.9648; train_optim_loss: 36128.9648; val_kl_reg_loss: 2384.4766; val_edge_recon_loss: 26763.9262; val_gene_expr_recon_loss: 6302.2425; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35450.6455; val_optim_loss: 35450.6455
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9751; val_auprc_score: 0.9687; val_best_acc_score: 0.9283; val_best_f1_score: 0.9305; train_kl_reg_loss: 2445.9341; train_edge_recon_loss: 27238.0407; train_gene_expr_recon_loss: 6430.3144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36114.2892; train_optim_loss: 36114.2892; val_kl_reg_loss: 2406.4404; val_edge_recon_loss: 26750.6926; val_gene_expr_recon_loss: 6305.8897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35463.0226; val_optim_loss: 35463.0226
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9760; val_auprc_score: 0.9699; val_best_acc_score: 0.9304; val_best_f1_score: 0.9324; train_kl_reg_loss: 2452.2919; train_edge_recon_loss: 27211.5377; train_gene_expr_recon_loss: 6416.7194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36080.5490; train_optim_loss: 36080.5490; val_kl_reg_loss: 2375.6147; val_edge_recon_loss: 26736.6651; val_gene_expr_recon_loss: 6298.2628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35410.5426; val_optim_loss: 35410.5426
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9759; val_auprc_score: 0.9692; val_best_acc_score: 0.9321; val_best_f1_score: 0.9339; train_kl_reg_loss: 2451.7817; train_edge_recon_loss: 27221.6617; train_gene_expr_recon_loss: 6404.6899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36078.1333; train_optim_loss: 36078.1333; val_kl_reg_loss: 2435.3007; val_edge_recon_loss: 26661.5018; val_gene_expr_recon_loss: 6266.2066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35363.0091; val_optim_loss: 35363.0091
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9784; val_auprc_score: 0.9732; val_best_acc_score: 0.9347; val_best_f1_score: 0.9364; train_kl_reg_loss: 2455.3635; train_edge_recon_loss: 27202.3775; train_gene_expr_recon_loss: 6399.4683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36057.2093; train_optim_loss: 36057.2093; val_kl_reg_loss: 2441.1398; val_edge_recon_loss: 26713.1253; val_gene_expr_recon_loss: 6275.4845; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35429.7495; val_optim_loss: 35429.7495
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9774; val_auprc_score: 0.9714; val_best_acc_score: 0.9329; val_best_f1_score: 0.9343; train_kl_reg_loss: 2455.4438; train_edge_recon_loss: 27211.1020; train_gene_expr_recon_loss: 6387.8349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36054.3808; train_optim_loss: 36054.3808; val_kl_reg_loss: 2390.6514; val_edge_recon_loss: 26750.2329; val_gene_expr_recon_loss: 6257.8907; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35398.7749; val_optim_loss: 35398.7749
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9779; val_auprc_score: 0.9718; val_best_acc_score: 0.9344; val_best_f1_score: 0.9363; train_kl_reg_loss: 2457.6715; train_edge_recon_loss: 27208.9062; train_gene_expr_recon_loss: 6383.3704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36049.9481; train_optim_loss: 36049.9481; val_kl_reg_loss: 2421.3844; val_edge_recon_loss: 26695.5653; val_gene_expr_recon_loss: 6266.6723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35383.6221; val_optim_loss: 35383.6221
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9779; val_auprc_score: 0.9720; val_best_acc_score: 0.9334; val_best_f1_score: 0.9352; train_kl_reg_loss: 2462.5733; train_edge_recon_loss: 27190.6143; train_gene_expr_recon_loss: 6373.1259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36026.3134; train_optim_loss: 36026.3134; val_kl_reg_loss: 2415.3701; val_edge_recon_loss: 26714.0407; val_gene_expr_recon_loss: 6264.6475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35394.0584; val_optim_loss: 35394.0584

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9785; val_auprc_score: 0.9733; val_best_acc_score: 0.9344; val_best_f1_score: 0.9362; train_kl_reg_loss: 2456.2378; train_edge_recon_loss: 27179.3858; train_gene_expr_recon_loss: 6342.7756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35978.3991; train_optim_loss: 35978.3991; val_kl_reg_loss: 2394.1863; val_edge_recon_loss: 26699.2245; val_gene_expr_recon_loss: 6230.3736; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35323.7844; val_optim_loss: 35323.7844
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9793; val_auprc_score: 0.9737; val_best_acc_score: 0.9366; val_best_f1_score: 0.9379; train_kl_reg_loss: 2451.3868; train_edge_recon_loss: 27185.7999; train_gene_expr_recon_loss: 6335.3800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35972.5669; train_optim_loss: 35972.5669; val_kl_reg_loss: 2408.5455; val_edge_recon_loss: 26664.6481; val_gene_expr_recon_loss: 6222.5607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35295.7543; val_optim_loss: 35295.7543
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9790; val_auprc_score: 0.9738; val_best_acc_score: 0.9351; val_best_f1_score: 0.9369; train_kl_reg_loss: 2456.5604; train_edge_recon_loss: 27167.9169; train_gene_expr_recon_loss: 6335.8850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35960.3623; train_optim_loss: 35960.3623; val_kl_reg_loss: 2405.5635; val_edge_recon_loss: 26703.4989; val_gene_expr_recon_loss: 6226.4564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35335.5189; val_optim_loss: 35335.5189
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9798; val_auprc_score: 0.9746; val_best_acc_score: 0.9368; val_best_f1_score: 0.9384; train_kl_reg_loss: 2455.1025; train_edge_recon_loss: 27172.0855; train_gene_expr_recon_loss: 6332.3697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35959.5577; train_optim_loss: 35959.5577; val_kl_reg_loss: 2408.7159; val_edge_recon_loss: 26659.4509; val_gene_expr_recon_loss: 6222.7618; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35290.9290; val_optim_loss: 35290.9290
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9795; val_auprc_score: 0.9742; val_best_acc_score: 0.9365; val_best_f1_score: 0.9384; train_kl_reg_loss: 2457.1310; train_edge_recon_loss: 27159.7148; train_gene_expr_recon_loss: 6326.7802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35943.6260; train_optim_loss: 35943.6260; val_kl_reg_loss: 2392.7327; val_edge_recon_loss: 26676.8346; val_gene_expr_recon_loss: 6216.0238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35285.5908; val_optim_loss: 35285.5908
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9788; val_auprc_score: 0.9729; val_best_acc_score: 0.9360; val_best_f1_score: 0.9377; train_kl_reg_loss: 2456.7984; train_edge_recon_loss: 27158.1109; train_gene_expr_recon_loss: 6327.8694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35942.7787; train_optim_loss: 35942.7787; val_kl_reg_loss: 2426.7439; val_edge_recon_loss: 26647.4757; val_gene_expr_recon_loss: 6211.5493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35285.7689; val_optim_loss: 35285.7689
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9787; val_auprc_score: 0.9732; val_best_acc_score: 0.9355; val_best_f1_score: 0.9373; train_kl_reg_loss: 2455.8792; train_edge_recon_loss: 27167.6642; train_gene_expr_recon_loss: 6326.0675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35949.6108; train_optim_loss: 35949.6108; val_kl_reg_loss: 2423.4212; val_edge_recon_loss: 26701.0735; val_gene_expr_recon_loss: 6206.3368; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35330.8316; val_optim_loss: 35330.8316
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9799; val_auprc_score: 0.9752; val_best_acc_score: 0.9371; val_best_f1_score: 0.9387; train_kl_reg_loss: 2454.8027; train_edge_recon_loss: 27168.7905; train_gene_expr_recon_loss: 6324.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35948.2598; train_optim_loss: 35948.2598; val_kl_reg_loss: 2400.2203; val_edge_recon_loss: 26655.8106; val_gene_expr_recon_loss: 6208.9537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35264.9844; val_optim_loss: 35264.9844
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9786; val_auprc_score: 0.9730; val_best_acc_score: 0.9355; val_best_f1_score: 0.9373; train_kl_reg_loss: 2458.4198; train_edge_recon_loss: 27159.3537; train_gene_expr_recon_loss: 6321.5110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35939.2844; train_optim_loss: 35939.2844; val_kl_reg_loss: 2418.7075; val_edge_recon_loss: 26633.7917; val_gene_expr_recon_loss: 6215.2363; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35267.7354; val_optim_loss: 35267.7354
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9785; val_auprc_score: 0.9730; val_best_acc_score: 0.9350; val_best_f1_score: 0.9369; train_kl_reg_loss: 2459.2320; train_edge_recon_loss: 27149.1044; train_gene_expr_recon_loss: 6321.5891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35929.9256; train_optim_loss: 35929.9256; val_kl_reg_loss: 2426.2368; val_edge_recon_loss: 26695.9794; val_gene_expr_recon_loss: 6209.3860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35331.6018; val_optim_loss: 35331.6018
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9797; val_auprc_score: 0.9745; val_best_acc_score: 0.9377; val_best_f1_score: 0.9393; train_kl_reg_loss: 2455.9489; train_edge_recon_loss: 27173.8203; train_gene_expr_recon_loss: 6320.5236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35950.2929; train_optim_loss: 35950.2929; val_kl_reg_loss: 2427.7409; val_edge_recon_loss: 26652.3884; val_gene_expr_recon_loss: 6205.5004; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35285.6298; val_optim_loss: 35285.6298
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9791; val_auprc_score: 0.9738; val_best_acc_score: 0.9358; val_best_f1_score: 0.9374; train_kl_reg_loss: 2457.0225; train_edge_recon_loss: 27164.1645; train_gene_expr_recon_loss: 6314.7425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35935.9295; train_optim_loss: 35935.9295; val_kl_reg_loss: 2413.7177; val_edge_recon_loss: 26672.7911; val_gene_expr_recon_loss: 6216.0219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35302.5309; val_optim_loss: 35302.5309

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9792; val_auprc_score: 0.9737; val_best_acc_score: 0.9373; val_best_f1_score: 0.9390; train_kl_reg_loss: 2457.9577; train_edge_recon_loss: 27157.6814; train_gene_expr_recon_loss: 6313.0211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35928.6603; train_optim_loss: 35928.6603; val_kl_reg_loss: 2411.2673; val_edge_recon_loss: 26654.7543; val_gene_expr_recon_loss: 6201.4484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35267.4700; val_optim_loss: 35267.4700
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9794; val_auprc_score: 0.9742; val_best_acc_score: 0.9363; val_best_f1_score: 0.9381; train_kl_reg_loss: 2458.0194; train_edge_recon_loss: 27153.0262; train_gene_expr_recon_loss: 6314.5454; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35925.5910; train_optim_loss: 35925.5910; val_kl_reg_loss: 2415.7024; val_edge_recon_loss: 26692.8828; val_gene_expr_recon_loss: 6219.7630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35328.3484; val_optim_loss: 35328.3484
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9800; val_auprc_score: 0.9748; val_best_acc_score: 0.9372; val_best_f1_score: 0.9388; train_kl_reg_loss: 2458.1184; train_edge_recon_loss: 27153.8789; train_gene_expr_recon_loss: 6312.7869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35924.7842; train_optim_loss: 35924.7842; val_kl_reg_loss: 2400.8554; val_edge_recon_loss: 26622.6601; val_gene_expr_recon_loss: 6216.8242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35240.3397; val_optim_loss: 35240.3397
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9799; val_auprc_score: 0.9749; val_best_acc_score: 0.9373; val_best_f1_score: 0.9388; train_kl_reg_loss: 2455.5596; train_edge_recon_loss: 27161.6682; train_gene_expr_recon_loss: 6312.5663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35929.7942; train_optim_loss: 35929.7942; val_kl_reg_loss: 2406.3648; val_edge_recon_loss: 26657.4264; val_gene_expr_recon_loss: 6198.0631; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35261.8543; val_optim_loss: 35261.8543
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9806; val_auprc_score: 0.9763; val_best_acc_score: 0.9380; val_best_f1_score: 0.9396; train_kl_reg_loss: 2457.3722; train_edge_recon_loss: 27155.4916; train_gene_expr_recon_loss: 6313.4815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35926.3454; train_optim_loss: 35926.3454; val_kl_reg_loss: 2404.9907; val_edge_recon_loss: 26643.1024; val_gene_expr_recon_loss: 6184.6681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35232.7614; val_optim_loss: 35232.7614
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9789; val_auprc_score: 0.9730; val_best_acc_score: 0.9365; val_best_f1_score: 0.9381; train_kl_reg_loss: 2454.4161; train_edge_recon_loss: 27171.8848; train_gene_expr_recon_loss: 6308.8703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35935.1712; train_optim_loss: 35935.1712; val_kl_reg_loss: 2409.2747; val_edge_recon_loss: 26669.2241; val_gene_expr_recon_loss: 6192.1421; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35270.6408; val_optim_loss: 35270.6408
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9796; val_auprc_score: 0.9747; val_best_acc_score: 0.9374; val_best_f1_score: 0.9387; train_kl_reg_loss: 2457.1382; train_edge_recon_loss: 27157.3043; train_gene_expr_recon_loss: 6310.3101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35924.7526; train_optim_loss: 35924.7526; val_kl_reg_loss: 2407.3679; val_edge_recon_loss: 26658.4382; val_gene_expr_recon_loss: 6210.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35275.8684; val_optim_loss: 35275.8684
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9802; val_auprc_score: 0.9755; val_best_acc_score: 0.9372; val_best_f1_score: 0.9385; train_kl_reg_loss: 2457.6586; train_edge_recon_loss: 27154.0934; train_gene_expr_recon_loss: 6310.6415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35922.3935; train_optim_loss: 35922.3935; val_kl_reg_loss: 2408.9937; val_edge_recon_loss: 26636.6576; val_gene_expr_recon_loss: 6194.5056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35240.1571; val_optim_loss: 35240.1571
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9804; val_auprc_score: 0.9756; val_best_acc_score: 0.9374; val_best_f1_score: 0.9390; train_kl_reg_loss: 2455.6874; train_edge_recon_loss: 27160.8449; train_gene_expr_recon_loss: 6309.0714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35925.6037; train_optim_loss: 35925.6037; val_kl_reg_loss: 2402.3699; val_edge_recon_loss: 26685.5036; val_gene_expr_recon_loss: 6185.3786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35273.2520; val_optim_loss: 35273.2520

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9790; val_auprc_score: 0.9734; val_best_acc_score: 0.9363; val_best_f1_score: 0.9378; train_kl_reg_loss: 2454.7276; train_edge_recon_loss: 27158.4187; train_gene_expr_recon_loss: 6312.3692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35925.5155; train_optim_loss: 35925.5155; val_kl_reg_loss: 2406.3808; val_edge_recon_loss: 26675.4350; val_gene_expr_recon_loss: 6209.8025; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35291.6181; val_optim_loss: 35291.6181
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9797; val_auprc_score: 0.9746; val_best_acc_score: 0.9369; val_best_f1_score: 0.9385; train_kl_reg_loss: 2454.9791; train_edge_recon_loss: 27159.3769; train_gene_expr_recon_loss: 6310.6786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35925.0346; train_optim_loss: 35925.0346; val_kl_reg_loss: 2408.0108; val_edge_recon_loss: 26673.3920; val_gene_expr_recon_loss: 6207.2245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35288.6275; val_optim_loss: 35288.6275
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9792; val_auprc_score: 0.9738; val_best_acc_score: 0.9363; val_best_f1_score: 0.9380; train_kl_reg_loss: 2455.8960; train_edge_recon_loss: 27157.8832; train_gene_expr_recon_loss: 6312.7472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35926.5264; train_optim_loss: 35926.5264; val_kl_reg_loss: 2404.9201; val_edge_recon_loss: 26683.6287; val_gene_expr_recon_loss: 6201.9880; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35290.5366; val_optim_loss: 35290.5366
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9792; val_auprc_score: 0.9744; val_best_acc_score: 0.9355; val_best_f1_score: 0.9372; train_kl_reg_loss: 2455.0115; train_edge_recon_loss: 27160.8024; train_gene_expr_recon_loss: 6311.3876; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35927.2015; train_optim_loss: 35927.2015; val_kl_reg_loss: 2404.5379; val_edge_recon_loss: 26695.4820; val_gene_expr_recon_loss: 6197.1349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35297.1549; val_optim_loss: 35297.1549

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 78 min 31 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
Val AUROC score: 0.9791
Val AUPRC score: 0.9738
Val best accuracy score: 0.9356
Val best F1 score: 0.9374
Val gene expr MSE score: 1.5011

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
