None
Run timestamp: 01072023_204411_17.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_17']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9501; val_auprc_score: 0.9348; val_best_acc_score: 0.8905; val_best_f1_score: 0.8958; train_kl_reg_loss: 2098.8507; train_edge_recon_loss: 28186.0386; train_gene_expr_recon_loss: 8420.1329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38705.0224; train_optim_loss: 38705.0224; val_kl_reg_loss: 2170.7130; val_edge_recon_loss: 27028.2535; val_gene_expr_recon_loss: 7457.8967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36656.8632; val_optim_loss: 36656.8632
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9624; val_auprc_score: 0.9529; val_best_acc_score: 0.9058; val_best_f1_score: 0.9093; train_kl_reg_loss: 2261.9714; train_edge_recon_loss: 27470.0575; train_gene_expr_recon_loss: 7310.8664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37042.8952; train_optim_loss: 37042.8952; val_kl_reg_loss: 2156.8304; val_edge_recon_loss: 26891.2516; val_gene_expr_recon_loss: 7058.1652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36106.2473; val_optim_loss: 36106.2473
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9678; val_auprc_score: 0.9586; val_best_acc_score: 0.9165; val_best_f1_score: 0.9193; train_kl_reg_loss: 2293.1211; train_edge_recon_loss: 27396.0111; train_gene_expr_recon_loss: 7021.2452; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36710.3773; train_optim_loss: 36710.3773; val_kl_reg_loss: 2234.0351; val_edge_recon_loss: 26836.6083; val_gene_expr_recon_loss: 6791.5011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35862.1444; val_optim_loss: 35862.1444
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9681; val_auprc_score: 0.9591; val_best_acc_score: 0.9175; val_best_f1_score: 0.9205; train_kl_reg_loss: 2318.4241; train_edge_recon_loss: 27347.4972; train_gene_expr_recon_loss: 6846.3799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36512.3012; train_optim_loss: 36512.3012; val_kl_reg_loss: 2231.0037; val_edge_recon_loss: 26798.3889; val_gene_expr_recon_loss: 6676.0985; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35705.4911; val_optim_loss: 35705.4911
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9697; val_auprc_score: 0.9615; val_best_acc_score: 0.9190; val_best_f1_score: 0.9218; train_kl_reg_loss: 2338.2692; train_edge_recon_loss: 27306.6531; train_gene_expr_recon_loss: 6728.3573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36373.2797; train_optim_loss: 36373.2797; val_kl_reg_loss: 2259.0407; val_edge_recon_loss: 26862.4336; val_gene_expr_recon_loss: 6555.2424; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35676.7164; val_optim_loss: 35676.7164
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9716; val_auprc_score: 0.9634; val_best_acc_score: 0.9233; val_best_f1_score: 0.9261; train_kl_reg_loss: 2356.5438; train_edge_recon_loss: 27272.3647; train_gene_expr_recon_loss: 6642.3441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36271.2526; train_optim_loss: 36271.2526; val_kl_reg_loss: 2305.5340; val_edge_recon_loss: 26805.6611; val_gene_expr_recon_loss: 6494.5443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35605.7393; val_optim_loss: 35605.7393
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9732; val_auprc_score: 0.9661; val_best_acc_score: 0.9248; val_best_f1_score: 0.9272; train_kl_reg_loss: 2368.7668; train_edge_recon_loss: 27259.9450; train_gene_expr_recon_loss: 6577.5530; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36206.2647; train_optim_loss: 36206.2647; val_kl_reg_loss: 2290.4390; val_edge_recon_loss: 26787.0739; val_gene_expr_recon_loss: 6441.1525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35518.6652; val_optim_loss: 35518.6652
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9734; val_auprc_score: 0.9660; val_best_acc_score: 0.9264; val_best_f1_score: 0.9289; train_kl_reg_loss: 2379.3669; train_edge_recon_loss: 27229.2390; train_gene_expr_recon_loss: 6533.7912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36142.3970; train_optim_loss: 36142.3970; val_kl_reg_loss: 2316.7254; val_edge_recon_loss: 26766.9659; val_gene_expr_recon_loss: 6391.5695; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35475.2611; val_optim_loss: 35475.2611
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9718; val_auprc_score: 0.9638; val_best_acc_score: 0.9241; val_best_f1_score: 0.9268; train_kl_reg_loss: 2386.6640; train_edge_recon_loss: 27217.9563; train_gene_expr_recon_loss: 6490.3813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36095.0017; train_optim_loss: 36095.0017; val_kl_reg_loss: 2323.1847; val_edge_recon_loss: 26773.8746; val_gene_expr_recon_loss: 6385.7211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35482.7804; val_optim_loss: 35482.7804
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9745; val_auprc_score: 0.9675; val_best_acc_score: 0.9290; val_best_f1_score: 0.9311; train_kl_reg_loss: 2388.3561; train_edge_recon_loss: 27228.7251; train_gene_expr_recon_loss: 6457.7821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36074.8632; train_optim_loss: 36074.8632; val_kl_reg_loss: 2340.7516; val_edge_recon_loss: 26806.3739; val_gene_expr_recon_loss: 6328.6680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35475.7939; val_optim_loss: 35475.7939
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9741; val_auprc_score: 0.9678; val_best_acc_score: 0.9261; val_best_f1_score: 0.9285; train_kl_reg_loss: 2398.9195; train_edge_recon_loss: 27200.2989; train_gene_expr_recon_loss: 6436.5543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36035.7727; train_optim_loss: 36035.7727; val_kl_reg_loss: 2337.1948; val_edge_recon_loss: 26793.7019; val_gene_expr_recon_loss: 6301.8021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35432.6986; val_optim_loss: 35432.6986
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9755; val_auprc_score: 0.9688; val_best_acc_score: 0.9297; val_best_f1_score: 0.9317; train_kl_reg_loss: 2400.9264; train_edge_recon_loss: 27202.4856; train_gene_expr_recon_loss: 6415.9712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36019.3831; train_optim_loss: 36019.3831; val_kl_reg_loss: 2332.4660; val_edge_recon_loss: 26724.2195; val_gene_expr_recon_loss: 6297.7517; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35354.4376; val_optim_loss: 35354.4376
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9761; val_auprc_score: 0.9693; val_best_acc_score: 0.9311; val_best_f1_score: 0.9333; train_kl_reg_loss: 2409.3817; train_edge_recon_loss: 27175.7732; train_gene_expr_recon_loss: 6398.7106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35983.8653; train_optim_loss: 35983.8653; val_kl_reg_loss: 2358.1893; val_edge_recon_loss: 26745.5906; val_gene_expr_recon_loss: 6280.9982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35384.7781; val_optim_loss: 35384.7781
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9763; val_auprc_score: 0.9696; val_best_acc_score: 0.9315; val_best_f1_score: 0.9336; train_kl_reg_loss: 2410.6707; train_edge_recon_loss: 27188.2964; train_gene_expr_recon_loss: 6384.0670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35983.0341; train_optim_loss: 35983.0341; val_kl_reg_loss: 2317.5367; val_edge_recon_loss: 26714.4465; val_gene_expr_recon_loss: 6264.6084; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35296.5916; val_optim_loss: 35296.5916
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9785; val_auprc_score: 0.9735; val_best_acc_score: 0.9333; val_best_f1_score: 0.9350; train_kl_reg_loss: 2413.8181; train_edge_recon_loss: 27186.9246; train_gene_expr_recon_loss: 6368.1467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35968.8893; train_optim_loss: 35968.8893; val_kl_reg_loss: 2366.9492; val_edge_recon_loss: 26725.7845; val_gene_expr_recon_loss: 6261.0678; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35353.8018; val_optim_loss: 35353.8018
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9771; val_auprc_score: 0.9714; val_best_acc_score: 0.9309; val_best_f1_score: 0.9330; train_kl_reg_loss: 2418.2183; train_edge_recon_loss: 27168.7547; train_gene_expr_recon_loss: 6358.1274; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35945.1003; train_optim_loss: 35945.1003; val_kl_reg_loss: 2345.1497; val_edge_recon_loss: 26762.9920; val_gene_expr_recon_loss: 6240.4992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35348.6408; val_optim_loss: 35348.6408
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9772; val_auprc_score: 0.9709; val_best_acc_score: 0.9316; val_best_f1_score: 0.9337; train_kl_reg_loss: 2420.1657; train_edge_recon_loss: 27177.8515; train_gene_expr_recon_loss: 6351.9471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35949.9643; train_optim_loss: 35949.9643; val_kl_reg_loss: 2373.0032; val_edge_recon_loss: 26729.8679; val_gene_expr_recon_loss: 6219.6565; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35322.5274; val_optim_loss: 35322.5274
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9777; val_auprc_score: 0.9720; val_best_acc_score: 0.9323; val_best_f1_score: 0.9345; train_kl_reg_loss: 2425.7763; train_edge_recon_loss: 27156.7588; train_gene_expr_recon_loss: 6340.0497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35922.5848; train_optim_loss: 35922.5848; val_kl_reg_loss: 2400.0823; val_edge_recon_loss: 26654.5619; val_gene_expr_recon_loss: 6223.3855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35278.0293; val_optim_loss: 35278.0293
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9773; val_auprc_score: 0.9710; val_best_acc_score: 0.9324; val_best_f1_score: 0.9342; train_kl_reg_loss: 2424.3004; train_edge_recon_loss: 27170.3958; train_gene_expr_recon_loss: 6333.9160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35928.6122; train_optim_loss: 35928.6122; val_kl_reg_loss: 2373.1785; val_edge_recon_loss: 26711.5043; val_gene_expr_recon_loss: 6228.3105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35312.9930; val_optim_loss: 35312.9930
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9776; val_auprc_score: 0.9719; val_best_acc_score: 0.9325; val_best_f1_score: 0.9343; train_kl_reg_loss: 2429.8038; train_edge_recon_loss: 27145.3637; train_gene_expr_recon_loss: 6324.7797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35899.9472; train_optim_loss: 35899.9472; val_kl_reg_loss: 2416.1215; val_edge_recon_loss: 26771.2356; val_gene_expr_recon_loss: 6189.3348; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35376.6920; val_optim_loss: 35376.6920
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9791; val_auprc_score: 0.9741; val_best_acc_score: 0.9343; val_best_f1_score: 0.9362; train_kl_reg_loss: 2427.8942; train_edge_recon_loss: 27160.2011; train_gene_expr_recon_loss: 6319.3113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35907.4066; train_optim_loss: 35907.4066; val_kl_reg_loss: 2354.2942; val_edge_recon_loss: 26655.7836; val_gene_expr_recon_loss: 6219.5816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35229.6597; val_optim_loss: 35229.6597
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9784; val_auprc_score: 0.9731; val_best_acc_score: 0.9326; val_best_f1_score: 0.9347; train_kl_reg_loss: 2430.9303; train_edge_recon_loss: 27157.5556; train_gene_expr_recon_loss: 6312.6140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35901.0999; train_optim_loss: 35901.0999; val_kl_reg_loss: 2348.1641; val_edge_recon_loss: 26664.9140; val_gene_expr_recon_loss: 6213.0010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35226.0791; val_optim_loss: 35226.0791
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9788; val_auprc_score: 0.9724; val_best_acc_score: 0.9348; val_best_f1_score: 0.9368; train_kl_reg_loss: 2433.1202; train_edge_recon_loss: 27148.7353; train_gene_expr_recon_loss: 6309.9065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35891.7621; train_optim_loss: 35891.7621; val_kl_reg_loss: 2361.1736; val_edge_recon_loss: 26718.0378; val_gene_expr_recon_loss: 6202.5683; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35281.7796; val_optim_loss: 35281.7796
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9780; val_auprc_score: 0.9722; val_best_acc_score: 0.9333; val_best_f1_score: 0.9352; train_kl_reg_loss: 2435.3261; train_edge_recon_loss: 27155.4585; train_gene_expr_recon_loss: 6305.8619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35896.6465; train_optim_loss: 35896.6465; val_kl_reg_loss: 2399.3600; val_edge_recon_loss: 26702.3851; val_gene_expr_recon_loss: 6212.6849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35314.4301; val_optim_loss: 35314.4301
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9801; val_auprc_score: 0.9751; val_best_acc_score: 0.9373; val_best_f1_score: 0.9385; train_kl_reg_loss: 2436.1057; train_edge_recon_loss: 27157.9974; train_gene_expr_recon_loss: 6300.2733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35894.3765; train_optim_loss: 35894.3765; val_kl_reg_loss: 2451.9689; val_edge_recon_loss: 26707.4094; val_gene_expr_recon_loss: 6184.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35344.1362; val_optim_loss: 35344.1362
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9788; val_auprc_score: 0.9737; val_best_acc_score: 0.9330; val_best_f1_score: 0.9347; train_kl_reg_loss: 2439.9699; train_edge_recon_loss: 27144.9005; train_gene_expr_recon_loss: 6295.0732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35879.9435; train_optim_loss: 35879.9435; val_kl_reg_loss: 2447.7480; val_edge_recon_loss: 26710.2485; val_gene_expr_recon_loss: 6173.2307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35331.2271; val_optim_loss: 35331.2271

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9803; val_auprc_score: 0.9753; val_best_acc_score: 0.9376; val_best_f1_score: 0.9390; train_kl_reg_loss: 2436.0399; train_edge_recon_loss: 27111.9285; train_gene_expr_recon_loss: 6266.2810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35814.2494; train_optim_loss: 35814.2494; val_kl_reg_loss: 2385.8635; val_edge_recon_loss: 26646.9876; val_gene_expr_recon_loss: 6170.0857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35202.9368; val_optim_loss: 35202.9368
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9802; val_auprc_score: 0.9747; val_best_acc_score: 0.9363; val_best_f1_score: 0.9378; train_kl_reg_loss: 2434.2932; train_edge_recon_loss: 27117.0249; train_gene_expr_recon_loss: 6262.2282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35813.5463; train_optim_loss: 35813.5463; val_kl_reg_loss: 2385.8397; val_edge_recon_loss: 26694.2000; val_gene_expr_recon_loss: 6147.7832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35227.8229; val_optim_loss: 35227.8229
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9801; val_auprc_score: 0.9752; val_best_acc_score: 0.9363; val_best_f1_score: 0.9380; train_kl_reg_loss: 2433.7692; train_edge_recon_loss: 27109.4988; train_gene_expr_recon_loss: 6261.2577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35804.5257; train_optim_loss: 35804.5257; val_kl_reg_loss: 2385.9749; val_edge_recon_loss: 26677.0917; val_gene_expr_recon_loss: 6162.0742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35225.1405; val_optim_loss: 35225.1405
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9804; val_auprc_score: 0.9755; val_best_acc_score: 0.9380; val_best_f1_score: 0.9394; train_kl_reg_loss: 2436.1095; train_edge_recon_loss: 27101.3385; train_gene_expr_recon_loss: 6259.3065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35796.7545; train_optim_loss: 35796.7545; val_kl_reg_loss: 2395.6058; val_edge_recon_loss: 26628.9849; val_gene_expr_recon_loss: 6159.0915; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35183.6821; val_optim_loss: 35183.6821
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9796; val_auprc_score: 0.9744; val_best_acc_score: 0.9360; val_best_f1_score: 0.9375; train_kl_reg_loss: 2435.9611; train_edge_recon_loss: 27097.0996; train_gene_expr_recon_loss: 6254.2664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35787.3270; train_optim_loss: 35787.3270; val_kl_reg_loss: 2401.6001; val_edge_recon_loss: 26671.3781; val_gene_expr_recon_loss: 6158.4172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35231.3954; val_optim_loss: 35231.3954
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9805; val_auprc_score: 0.9754; val_best_acc_score: 0.9379; val_best_f1_score: 0.9394; train_kl_reg_loss: 2433.5835; train_edge_recon_loss: 27112.7138; train_gene_expr_recon_loss: 6252.6923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35798.9896; train_optim_loss: 35798.9896; val_kl_reg_loss: 2406.7511; val_edge_recon_loss: 26647.1374; val_gene_expr_recon_loss: 6141.0683; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35194.9568; val_optim_loss: 35194.9568
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9798; val_auprc_score: 0.9745; val_best_acc_score: 0.9365; val_best_f1_score: 0.9382; train_kl_reg_loss: 2437.8516; train_edge_recon_loss: 27092.6175; train_gene_expr_recon_loss: 6255.4508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35785.9199; train_optim_loss: 35785.9199; val_kl_reg_loss: 2383.5938; val_edge_recon_loss: 26680.4171; val_gene_expr_recon_loss: 6150.1661; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35214.1768; val_optim_loss: 35214.1768
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9793; val_auprc_score: 0.9732; val_best_acc_score: 0.9365; val_best_f1_score: 0.9382; train_kl_reg_loss: 2434.3071; train_edge_recon_loss: 27107.8743; train_gene_expr_recon_loss: 6252.7579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35794.9394; train_optim_loss: 35794.9394; val_kl_reg_loss: 2384.1868; val_edge_recon_loss: 26684.4926; val_gene_expr_recon_loss: 6144.0919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35212.7713; val_optim_loss: 35212.7713

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9803; val_auprc_score: 0.9742; val_best_acc_score: 0.9386; val_best_f1_score: 0.9401; train_kl_reg_loss: 2436.9792; train_edge_recon_loss: 27087.3650; train_gene_expr_recon_loss: 6246.5427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35770.8870; train_optim_loss: 35770.8870; val_kl_reg_loss: 2390.5310; val_edge_recon_loss: 26658.8064; val_gene_expr_recon_loss: 6134.6221; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35183.9593; val_optim_loss: 35183.9593
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9796; val_auprc_score: 0.9738; val_best_acc_score: 0.9372; val_best_f1_score: 0.9388; train_kl_reg_loss: 2435.6806; train_edge_recon_loss: 27095.7079; train_gene_expr_recon_loss: 6245.7715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35777.1600; train_optim_loss: 35777.1600; val_kl_reg_loss: 2391.9101; val_edge_recon_loss: 26672.8280; val_gene_expr_recon_loss: 6152.9960; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35217.7343; val_optim_loss: 35217.7343
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9806; val_auprc_score: 0.9753; val_best_acc_score: 0.9378; val_best_f1_score: 0.9395; train_kl_reg_loss: 2436.8960; train_edge_recon_loss: 27092.7255; train_gene_expr_recon_loss: 6247.0827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35776.7043; train_optim_loss: 35776.7043; val_kl_reg_loss: 2389.4366; val_edge_recon_loss: 26625.6119; val_gene_expr_recon_loss: 6143.8843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35158.9328; val_optim_loss: 35158.9328
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9804; val_auprc_score: 0.9752; val_best_acc_score: 0.9375; val_best_f1_score: 0.9386; train_kl_reg_loss: 2433.4678; train_edge_recon_loss: 27110.1765; train_gene_expr_recon_loss: 6244.6987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35788.3429; train_optim_loss: 35788.3429; val_kl_reg_loss: 2388.7561; val_edge_recon_loss: 26681.3215; val_gene_expr_recon_loss: 6142.5952; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35212.6730; val_optim_loss: 35212.6730
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9804; val_auprc_score: 0.9752; val_best_acc_score: 0.9379; val_best_f1_score: 0.9396; train_kl_reg_loss: 2433.8051; train_edge_recon_loss: 27109.7478; train_gene_expr_recon_loss: 6245.7097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35789.2627; train_optim_loss: 35789.2627; val_kl_reg_loss: 2392.6308; val_edge_recon_loss: 26630.4135; val_gene_expr_recon_loss: 6149.1320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35172.1762; val_optim_loss: 35172.1762
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9804; val_auprc_score: 0.9752; val_best_acc_score: 0.9388; val_best_f1_score: 0.9399; train_kl_reg_loss: 2433.7974; train_edge_recon_loss: 27102.6913; train_gene_expr_recon_loss: 6246.6315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35783.1202; train_optim_loss: 35783.1202; val_kl_reg_loss: 2396.0331; val_edge_recon_loss: 26631.6844; val_gene_expr_recon_loss: 6149.3211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35177.0384; val_optim_loss: 35177.0384
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9804; val_auprc_score: 0.9751; val_best_acc_score: 0.9380; val_best_f1_score: 0.9396; train_kl_reg_loss: 2436.8733; train_edge_recon_loss: 27087.6557; train_gene_expr_recon_loss: 6244.4896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35769.0186; train_optim_loss: 35769.0186; val_kl_reg_loss: 2390.4619; val_edge_recon_loss: 26629.6536; val_gene_expr_recon_loss: 6143.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35163.8109; val_optim_loss: 35163.8109

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9807; val_auprc_score: 0.9761; val_best_acc_score: 0.9380; val_best_f1_score: 0.9394; train_kl_reg_loss: 2435.4595; train_edge_recon_loss: 27095.2536; train_gene_expr_recon_loss: 6246.9865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35777.6996; train_optim_loss: 35777.6996; val_kl_reg_loss: 2388.8592; val_edge_recon_loss: 26680.9312; val_gene_expr_recon_loss: 6157.9780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35227.7683; val_optim_loss: 35227.7683
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9800; val_auprc_score: 0.9748; val_best_acc_score: 0.9374; val_best_f1_score: 0.9389; train_kl_reg_loss: 2434.5953; train_edge_recon_loss: 27093.1953; train_gene_expr_recon_loss: 6244.7207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35772.5115; train_optim_loss: 35772.5115; val_kl_reg_loss: 2391.4074; val_edge_recon_loss: 26645.9836; val_gene_expr_recon_loss: 6152.6372; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35190.0283; val_optim_loss: 35190.0283
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9810; val_auprc_score: 0.9760; val_best_acc_score: 0.9374; val_best_f1_score: 0.9392; train_kl_reg_loss: 2435.4596; train_edge_recon_loss: 27093.8047; train_gene_expr_recon_loss: 6245.1887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35774.4531; train_optim_loss: 35774.4531; val_kl_reg_loss: 2389.6664; val_edge_recon_loss: 26633.9150; val_gene_expr_recon_loss: 6155.3436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35178.9252; val_optim_loss: 35178.9252
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9808; val_auprc_score: 0.9759; val_best_acc_score: 0.9386; val_best_f1_score: 0.9401; train_kl_reg_loss: 2434.6229; train_edge_recon_loss: 27095.7537; train_gene_expr_recon_loss: 6248.1235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35778.5001; train_optim_loss: 35778.5001; val_kl_reg_loss: 2390.0385; val_edge_recon_loss: 26617.9238; val_gene_expr_recon_loss: 6141.3666; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35149.3290; val_optim_loss: 35149.3290
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9804; val_auprc_score: 0.9754; val_best_acc_score: 0.9373; val_best_f1_score: 0.9389; train_kl_reg_loss: 2434.2022; train_edge_recon_loss: 27099.0652; train_gene_expr_recon_loss: 6241.7607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35775.0282; train_optim_loss: 35775.0282; val_kl_reg_loss: 2390.7766; val_edge_recon_loss: 26662.8482; val_gene_expr_recon_loss: 6142.4232; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35196.0480; val_optim_loss: 35196.0480
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9814; val_auprc_score: 0.9771; val_best_acc_score: 0.9394; val_best_f1_score: 0.9409; train_kl_reg_loss: 2433.7379; train_edge_recon_loss: 27098.7173; train_gene_expr_recon_loss: 6246.6916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35779.1469; train_optim_loss: 35779.1469; val_kl_reg_loss: 2390.2070; val_edge_recon_loss: 26591.2806; val_gene_expr_recon_loss: 6143.1217; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35124.6096; val_optim_loss: 35124.6096
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9800; val_auprc_score: 0.9751; val_best_acc_score: 0.9366; val_best_f1_score: 0.9383; train_kl_reg_loss: 2433.8666; train_edge_recon_loss: 27094.4448; train_gene_expr_recon_loss: 6242.3600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35770.6713; train_optim_loss: 35770.6713; val_kl_reg_loss: 2389.7364; val_edge_recon_loss: 26665.3792; val_gene_expr_recon_loss: 6150.9509; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35206.0666; val_optim_loss: 35206.0666
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9798; val_auprc_score: 0.9744; val_best_acc_score: 0.9374; val_best_f1_score: 0.9390; train_kl_reg_loss: 2433.8565; train_edge_recon_loss: 27098.5784; train_gene_expr_recon_loss: 6247.9794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35780.4143; train_optim_loss: 35780.4143; val_kl_reg_loss: 2389.8265; val_edge_recon_loss: 26659.9083; val_gene_expr_recon_loss: 6149.6700; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35199.4049; val_optim_loss: 35199.4049
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9810; val_auprc_score: 0.9762; val_best_acc_score: 0.9388; val_best_f1_score: 0.9403; train_kl_reg_loss: 2435.9786; train_edge_recon_loss: 27092.6534; train_gene_expr_recon_loss: 6244.3646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35772.9967; train_optim_loss: 35772.9967; val_kl_reg_loss: 2388.7403; val_edge_recon_loss: 26653.7374; val_gene_expr_recon_loss: 6152.3618; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35194.8394; val_optim_loss: 35194.8394
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9802; val_auprc_score: 0.9750; val_best_acc_score: 0.9380; val_best_f1_score: 0.9396; train_kl_reg_loss: 2435.9201; train_edge_recon_loss: 27087.0097; train_gene_expr_recon_loss: 6243.5645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35766.4944; train_optim_loss: 35766.4944; val_kl_reg_loss: 2390.9751; val_edge_recon_loss: 26638.0524; val_gene_expr_recon_loss: 6155.4286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35184.4561; val_optim_loss: 35184.4561

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9798; val_auprc_score: 0.9743; val_best_acc_score: 0.9370; val_best_f1_score: 0.9387; train_kl_reg_loss: 2435.7375; train_edge_recon_loss: 27093.3112; train_gene_expr_recon_loss: 6244.2693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35773.3180; train_optim_loss: 35773.3180; val_kl_reg_loss: 2392.6628; val_edge_recon_loss: 26697.5174; val_gene_expr_recon_loss: 6151.8589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35242.0389; val_optim_loss: 35242.0389
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9813; val_auprc_score: 0.9770; val_best_acc_score: 0.9393; val_best_f1_score: 0.9408; train_kl_reg_loss: 2435.8952; train_edge_recon_loss: 27097.7223; train_gene_expr_recon_loss: 6246.1327; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35779.7502; train_optim_loss: 35779.7502; val_kl_reg_loss: 2391.5384; val_edge_recon_loss: 26625.0361; val_gene_expr_recon_loss: 6154.0586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35170.6331; val_optim_loss: 35170.6331
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9804; val_auprc_score: 0.9758; val_best_acc_score: 0.9372; val_best_f1_score: 0.9388; train_kl_reg_loss: 2434.9761; train_edge_recon_loss: 27095.6421; train_gene_expr_recon_loss: 6241.4719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35772.0900; train_optim_loss: 35772.0900; val_kl_reg_loss: 2391.2026; val_edge_recon_loss: 26643.2241; val_gene_expr_recon_loss: 6137.4508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35171.8776; val_optim_loss: 35171.8776
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9808; val_auprc_score: 0.9762; val_best_acc_score: 0.9384; val_best_f1_score: 0.9399; train_kl_reg_loss: 2435.2695; train_edge_recon_loss: 27109.5956; train_gene_expr_recon_loss: 6241.5502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35786.4153; train_optim_loss: 35786.4153; val_kl_reg_loss: 2389.1171; val_edge_recon_loss: 26648.9506; val_gene_expr_recon_loss: 6140.9887; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35179.0562; val_optim_loss: 35179.0562

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 94 min 49 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
Val AUROC score: 0.9806
Val AUPRC score: 0.9758
Val best accuracy score: 0.9374
Val best F1 score: 0.9388
Val gene expr MSE score: 1.4763

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
