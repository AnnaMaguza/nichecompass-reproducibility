None
Run timestamp: 30062023_161711_17.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_17']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9529; val_auprc_score: 0.9389; val_best_acc_score: 0.8943; val_best_f1_score: 0.8993; train_kl_reg_loss: 2138.5183; train_edge_recon_loss: 28200.3553; train_gene_expr_recon_loss: 8451.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38790.0643; train_optim_loss: 38790.0643; val_kl_reg_loss: 2227.8738; val_edge_recon_loss: 27022.6379; val_gene_expr_recon_loss: 7482.1270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36732.6386; val_optim_loss: 36732.6386
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9621; val_auprc_score: 0.9515; val_best_acc_score: 0.9079; val_best_f1_score: 0.9115; train_kl_reg_loss: 2310.6251; train_edge_recon_loss: 27492.0632; train_gene_expr_recon_loss: 7377.0659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37179.7542; train_optim_loss: 37179.7542; val_kl_reg_loss: 2290.2685; val_edge_recon_loss: 26874.4586; val_gene_expr_recon_loss: 7087.6934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36252.4202; val_optim_loss: 36252.4202
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9671; val_auprc_score: 0.9580; val_best_acc_score: 0.9159; val_best_f1_score: 0.9186; train_kl_reg_loss: 2340.1290; train_edge_recon_loss: 27423.4024; train_gene_expr_recon_loss: 7083.9898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36847.5213; train_optim_loss: 36847.5213; val_kl_reg_loss: 2328.8018; val_edge_recon_loss: 26889.6808; val_gene_expr_recon_loss: 6844.0929; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36062.5753; val_optim_loss: 36062.5753
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9712; val_auprc_score: 0.9645; val_best_acc_score: 0.9193; val_best_f1_score: 0.9217; train_kl_reg_loss: 2365.2056; train_edge_recon_loss: 27362.7679; train_gene_expr_recon_loss: 6911.2490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36639.2226; train_optim_loss: 36639.2226; val_kl_reg_loss: 2242.8238; val_edge_recon_loss: 26854.9055; val_gene_expr_recon_loss: 6710.4119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35808.1412; val_optim_loss: 35808.1412
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9704; val_auprc_score: 0.9614; val_best_acc_score: 0.9229; val_best_f1_score: 0.9255; train_kl_reg_loss: 2380.9915; train_edge_recon_loss: 27344.5217; train_gene_expr_recon_loss: 6792.6548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36518.1681; train_optim_loss: 36518.1681; val_kl_reg_loss: 2399.7553; val_edge_recon_loss: 26722.2053; val_gene_expr_recon_loss: 6626.2595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35748.2202; val_optim_loss: 35748.2202
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9730; val_auprc_score: 0.9659; val_best_acc_score: 0.9252; val_best_f1_score: 0.9277; train_kl_reg_loss: 2395.7215; train_edge_recon_loss: 27304.1870; train_gene_expr_recon_loss: 6701.5061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36401.4146; train_optim_loss: 36401.4146; val_kl_reg_loss: 2385.7729; val_edge_recon_loss: 26768.2067; val_gene_expr_recon_loss: 6531.5796; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35685.5593; val_optim_loss: 35685.5593
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9732; val_auprc_score: 0.9657; val_best_acc_score: 0.9252; val_best_f1_score: 0.9277; train_kl_reg_loss: 2407.4647; train_edge_recon_loss: 27288.3427; train_gene_expr_recon_loss: 6631.7504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36327.5579; train_optim_loss: 36327.5579; val_kl_reg_loss: 2419.7244; val_edge_recon_loss: 26757.0605; val_gene_expr_recon_loss: 6495.9882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35672.7730; val_optim_loss: 35672.7730
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9729; val_auprc_score: 0.9644; val_best_acc_score: 0.9268; val_best_f1_score: 0.9291; train_kl_reg_loss: 2412.5704; train_edge_recon_loss: 27284.8258; train_gene_expr_recon_loss: 6584.0316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36281.4277; train_optim_loss: 36281.4277; val_kl_reg_loss: 2399.1940; val_edge_recon_loss: 26767.7622; val_gene_expr_recon_loss: 6439.5651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35606.5214; val_optim_loss: 35606.5214
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9778; val_auprc_score: 0.9723; val_best_acc_score: 0.9318; val_best_f1_score: 0.9335; train_kl_reg_loss: 2421.1128; train_edge_recon_loss: 27266.6349; train_gene_expr_recon_loss: 6544.8434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36232.5912; train_optim_loss: 36232.5912; val_kl_reg_loss: 2343.2131; val_edge_recon_loss: 26745.6752; val_gene_expr_recon_loss: 6418.7623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35507.6507; val_optim_loss: 35507.6507
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9750; val_auprc_score: 0.9684; val_best_acc_score: 0.9290; val_best_f1_score: 0.9310; train_kl_reg_loss: 2428.0175; train_edge_recon_loss: 27252.3109; train_gene_expr_recon_loss: 6511.8100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36192.1384; train_optim_loss: 36192.1384; val_kl_reg_loss: 2365.0903; val_edge_recon_loss: 26787.9463; val_gene_expr_recon_loss: 6372.3728; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35525.4093; val_optim_loss: 35525.4093
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9762; val_auprc_score: 0.9698; val_best_acc_score: 0.9309; val_best_f1_score: 0.9329; train_kl_reg_loss: 2432.4607; train_edge_recon_loss: 27253.8132; train_gene_expr_recon_loss: 6484.9754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36171.2493; train_optim_loss: 36171.2493; val_kl_reg_loss: 2332.1139; val_edge_recon_loss: 26749.0467; val_gene_expr_recon_loss: 6340.7628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35421.9234; val_optim_loss: 35421.9234
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9763; val_auprc_score: 0.9701; val_best_acc_score: 0.9315; val_best_f1_score: 0.9332; train_kl_reg_loss: 2438.7061; train_edge_recon_loss: 27233.6770; train_gene_expr_recon_loss: 6465.7424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36138.1255; train_optim_loss: 36138.1255; val_kl_reg_loss: 2428.9886; val_edge_recon_loss: 26780.1629; val_gene_expr_recon_loss: 6340.2688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35549.4205; val_optim_loss: 35549.4205
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9773; val_auprc_score: 0.9716; val_best_acc_score: 0.9308; val_best_f1_score: 0.9327; train_kl_reg_loss: 2442.5266; train_edge_recon_loss: 27230.9888; train_gene_expr_recon_loss: 6444.7510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36118.2664; train_optim_loss: 36118.2664; val_kl_reg_loss: 2419.9864; val_edge_recon_loss: 26759.4396; val_gene_expr_recon_loss: 6329.5719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35508.9977; val_optim_loss: 35508.9977
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9771; val_auprc_score: 0.9712; val_best_acc_score: 0.9322; val_best_f1_score: 0.9341; train_kl_reg_loss: 2444.9084; train_edge_recon_loss: 27235.7480; train_gene_expr_recon_loss: 6435.0663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36115.7227; train_optim_loss: 36115.7227; val_kl_reg_loss: 2363.6736; val_edge_recon_loss: 26709.0495; val_gene_expr_recon_loss: 6311.6916; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35384.4149; val_optim_loss: 35384.4149
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9773; val_auprc_score: 0.9709; val_best_acc_score: 0.9332; val_best_f1_score: 0.9348; train_kl_reg_loss: 2448.3148; train_edge_recon_loss: 27226.4190; train_gene_expr_recon_loss: 6418.9348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36093.6687; train_optim_loss: 36093.6687; val_kl_reg_loss: 2388.9088; val_edge_recon_loss: 26695.8156; val_gene_expr_recon_loss: 6306.3509; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35391.0753; val_optim_loss: 35391.0753
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9772; val_auprc_score: 0.9715; val_best_acc_score: 0.9325; val_best_f1_score: 0.9341; train_kl_reg_loss: 2454.9790; train_edge_recon_loss: 27209.6422; train_gene_expr_recon_loss: 6411.0608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36075.6820; train_optim_loss: 36075.6820; val_kl_reg_loss: 2364.1059; val_edge_recon_loss: 26734.4927; val_gene_expr_recon_loss: 6290.5852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35389.1837; val_optim_loss: 35389.1837
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9773; val_auprc_score: 0.9715; val_best_acc_score: 0.9316; val_best_f1_score: 0.9335; train_kl_reg_loss: 2455.6857; train_edge_recon_loss: 27213.2844; train_gene_expr_recon_loss: 6402.5767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36071.5468; train_optim_loss: 36071.5468; val_kl_reg_loss: 2458.3830; val_edge_recon_loss: 26731.2651; val_gene_expr_recon_loss: 6301.6108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35491.2588; val_optim_loss: 35491.2588
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9777; val_auprc_score: 0.9717; val_best_acc_score: 0.9331; val_best_f1_score: 0.9348; train_kl_reg_loss: 2459.2613; train_edge_recon_loss: 27199.9255; train_gene_expr_recon_loss: 6389.0258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36048.2127; train_optim_loss: 36048.2127; val_kl_reg_loss: 2444.2872; val_edge_recon_loss: 26696.7127; val_gene_expr_recon_loss: 6272.1450; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35413.1449; val_optim_loss: 35413.1449

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9781; val_auprc_score: 0.9727; val_best_acc_score: 0.9339; val_best_f1_score: 0.9356; train_kl_reg_loss: 2454.3293; train_edge_recon_loss: 27176.7931; train_gene_expr_recon_loss: 6360.4648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35991.5871; train_optim_loss: 35991.5871; val_kl_reg_loss: 2413.8529; val_edge_recon_loss: 26703.8869; val_gene_expr_recon_loss: 6256.2452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35373.9852; val_optim_loss: 35373.9852
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9787; val_auprc_score: 0.9732; val_best_acc_score: 0.9345; val_best_f1_score: 0.9363; train_kl_reg_loss: 2454.4555; train_edge_recon_loss: 27172.1512; train_gene_expr_recon_loss: 6351.4508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35978.0576; train_optim_loss: 35978.0576; val_kl_reg_loss: 2407.3556; val_edge_recon_loss: 26659.5416; val_gene_expr_recon_loss: 6238.8960; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35305.7933; val_optim_loss: 35305.7933
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9795; val_auprc_score: 0.9743; val_best_acc_score: 0.9373; val_best_f1_score: 0.9385; train_kl_reg_loss: 2452.6111; train_edge_recon_loss: 27174.9105; train_gene_expr_recon_loss: 6348.7730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35976.2945; train_optim_loss: 35976.2945; val_kl_reg_loss: 2394.6687; val_edge_recon_loss: 26650.2815; val_gene_expr_recon_loss: 6236.0127; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35280.9629; val_optim_loss: 35280.9629
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9795; val_auprc_score: 0.9744; val_best_acc_score: 0.9352; val_best_f1_score: 0.9373; train_kl_reg_loss: 2451.1476; train_edge_recon_loss: 27183.8768; train_gene_expr_recon_loss: 6343.3571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35978.3815; train_optim_loss: 35978.3815; val_kl_reg_loss: 2386.4243; val_edge_recon_loss: 26669.7006; val_gene_expr_recon_loss: 6231.5127; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35287.6375; val_optim_loss: 35287.6375
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9792; val_auprc_score: 0.9742; val_best_acc_score: 0.9360; val_best_f1_score: 0.9374; train_kl_reg_loss: 2453.5805; train_edge_recon_loss: 27167.7915; train_gene_expr_recon_loss: 6345.6042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35966.9763; train_optim_loss: 35966.9763; val_kl_reg_loss: 2387.3389; val_edge_recon_loss: 26690.9701; val_gene_expr_recon_loss: 6252.9316; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35331.2405; val_optim_loss: 35331.2405
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9777; val_auprc_score: 0.9711; val_best_acc_score: 0.9343; val_best_f1_score: 0.9360; train_kl_reg_loss: 2454.7996; train_edge_recon_loss: 27164.0600; train_gene_expr_recon_loss: 6339.4850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35958.3447; train_optim_loss: 35958.3447; val_kl_reg_loss: 2403.4499; val_edge_recon_loss: 26721.2965; val_gene_expr_recon_loss: 6253.4826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35378.2291; val_optim_loss: 35378.2291
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9793; val_auprc_score: 0.9740; val_best_acc_score: 0.9362; val_best_f1_score: 0.9378; train_kl_reg_loss: 2454.0713; train_edge_recon_loss: 27171.5711; train_gene_expr_recon_loss: 6338.9527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35964.5951; train_optim_loss: 35964.5951; val_kl_reg_loss: 2386.2907; val_edge_recon_loss: 26644.9026; val_gene_expr_recon_loss: 6244.6041; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35275.7974; val_optim_loss: 35275.7974
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9795; val_auprc_score: 0.9737; val_best_acc_score: 0.9367; val_best_f1_score: 0.9383; train_kl_reg_loss: 2452.1855; train_edge_recon_loss: 27182.9733; train_gene_expr_recon_loss: 6335.0212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35970.1800; train_optim_loss: 35970.1800; val_kl_reg_loss: 2393.3956; val_edge_recon_loss: 26659.7412; val_gene_expr_recon_loss: 6212.2346; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35265.3715; val_optim_loss: 35265.3715
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9784; val_auprc_score: 0.9729; val_best_acc_score: 0.9348; val_best_f1_score: 0.9366; train_kl_reg_loss: 2454.6027; train_edge_recon_loss: 27170.6496; train_gene_expr_recon_loss: 6334.6818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35959.9341; train_optim_loss: 35959.9341; val_kl_reg_loss: 2444.5765; val_edge_recon_loss: 26698.3882; val_gene_expr_recon_loss: 6229.8723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35372.8370; val_optim_loss: 35372.8370
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9793; val_auprc_score: 0.9737; val_best_acc_score: 0.9367; val_best_f1_score: 0.9383; train_kl_reg_loss: 2452.8386; train_edge_recon_loss: 27173.7689; train_gene_expr_recon_loss: 6332.7472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35959.3548; train_optim_loss: 35959.3548; val_kl_reg_loss: 2403.3885; val_edge_recon_loss: 26661.1752; val_gene_expr_recon_loss: 6236.5133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35301.0770; val_optim_loss: 35301.0770
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9796; val_auprc_score: 0.9741; val_best_acc_score: 0.9356; val_best_f1_score: 0.9375; train_kl_reg_loss: 2454.8495; train_edge_recon_loss: 27168.4134; train_gene_expr_recon_loss: 6330.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35953.8812; train_optim_loss: 35953.8812; val_kl_reg_loss: 2395.3866; val_edge_recon_loss: 26670.2838; val_gene_expr_recon_loss: 6232.4374; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35298.1078; val_optim_loss: 35298.1078
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9792; val_auprc_score: 0.9739; val_best_acc_score: 0.9355; val_best_f1_score: 0.9370; train_kl_reg_loss: 2455.9623; train_edge_recon_loss: 27160.8415; train_gene_expr_recon_loss: 6331.0518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35947.8556; train_optim_loss: 35947.8556; val_kl_reg_loss: 2388.5853; val_edge_recon_loss: 26676.7181; val_gene_expr_recon_loss: 6221.9484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35287.2519; val_optim_loss: 35287.2519

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9794; val_auprc_score: 0.9739; val_best_acc_score: 0.9364; val_best_f1_score: 0.9381; train_kl_reg_loss: 2452.4342; train_edge_recon_loss: 27165.7804; train_gene_expr_recon_loss: 6327.9933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35946.2078; train_optim_loss: 35946.2078; val_kl_reg_loss: 2410.0747; val_edge_recon_loss: 26650.5074; val_gene_expr_recon_loss: 6223.0353; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35283.6171; val_optim_loss: 35283.6171
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9791; val_auprc_score: 0.9734; val_best_acc_score: 0.9360; val_best_f1_score: 0.9376; train_kl_reg_loss: 2456.6785; train_edge_recon_loss: 27157.0668; train_gene_expr_recon_loss: 6328.0513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35941.7966; train_optim_loss: 35941.7966; val_kl_reg_loss: 2402.4760; val_edge_recon_loss: 26684.0124; val_gene_expr_recon_loss: 6221.2446; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35307.7331; val_optim_loss: 35307.7331
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9796; val_auprc_score: 0.9744; val_best_acc_score: 0.9363; val_best_f1_score: 0.9379; train_kl_reg_loss: 2454.8122; train_edge_recon_loss: 27162.6686; train_gene_expr_recon_loss: 6326.1728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35943.6537; train_optim_loss: 35943.6537; val_kl_reg_loss: 2397.0571; val_edge_recon_loss: 26673.3947; val_gene_expr_recon_loss: 6220.5573; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35291.0089; val_optim_loss: 35291.0089
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9801; val_auprc_score: 0.9749; val_best_acc_score: 0.9369; val_best_f1_score: 0.9382; train_kl_reg_loss: 2452.6843; train_edge_recon_loss: 27169.5061; train_gene_expr_recon_loss: 6328.5635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35950.7540; train_optim_loss: 35950.7540; val_kl_reg_loss: 2404.3628; val_edge_recon_loss: 26639.9414; val_gene_expr_recon_loss: 6225.8469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35270.1513; val_optim_loss: 35270.1513

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 47 min 15 sec.
Using best model state, which was in epoch 26.

--- MODEL EVALUATION ---
Val AUROC score: 0.9785
Val AUPRC score: 0.9730
Val best accuracy score: 0.9354
Val best F1 score: 0.9372
Val gene expr MSE score: 1.5145

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
