None
Run timestamp: 26072023_080139_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '30.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9672; val_auprc_score: 0.9526; val_best_acc_score: 0.9248; val_best_f1_score: 0.9276; train_kl_reg_loss: 5878.0420; train_edge_recon_loss: 268812.9879; train_gene_expr_recon_loss: 13960.0298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 288651.0598; train_optim_loss: 288651.0598; val_kl_reg_loss: 5863.1630; val_edge_recon_loss: 262310.7540; val_gene_expr_recon_loss: 12707.3016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280881.2169; val_optim_loss: 280881.2169
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9751; val_auprc_score: 0.9635; val_best_acc_score: 0.9404; val_best_f1_score: 0.9423; train_kl_reg_loss: 5780.5252; train_edge_recon_loss: 259740.4278; train_gene_expr_recon_loss: 12277.5748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277798.5275; train_optim_loss: 277798.5275; val_kl_reg_loss: 5816.6155; val_edge_recon_loss: 260427.3975; val_gene_expr_recon_loss: 11968.1974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278212.2111; val_optim_loss: 278212.2111
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9770; val_auprc_score: 0.9636; val_best_acc_score: 0.9489; val_best_f1_score: 0.9503; train_kl_reg_loss: 5752.3620; train_edge_recon_loss: 258173.7254; train_gene_expr_recon_loss: 11771.1705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 275697.2586; train_optim_loss: 275697.2586; val_kl_reg_loss: 5781.9024; val_edge_recon_loss: 259644.8456; val_gene_expr_recon_loss: 11557.0054; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276983.7536; val_optim_loss: 276983.7536
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9784; val_auprc_score: 0.9648; val_best_acc_score: 0.9511; val_best_f1_score: 0.9525; train_kl_reg_loss: 5738.0541; train_edge_recon_loss: 257800.7819; train_gene_expr_recon_loss: 11450.4400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274989.2760; train_optim_loss: 274989.2760; val_kl_reg_loss: 5731.1198; val_edge_recon_loss: 258647.3828; val_gene_expr_recon_loss: 11297.2669; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275675.7696; val_optim_loss: 275675.7696
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9787; val_auprc_score: 0.9660; val_best_acc_score: 0.9535; val_best_f1_score: 0.9549; train_kl_reg_loss: 5724.3291; train_edge_recon_loss: 257616.2267; train_gene_expr_recon_loss: 11248.5263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274589.0820; train_optim_loss: 274589.0820; val_kl_reg_loss: 5677.1601; val_edge_recon_loss: 258308.0229; val_gene_expr_recon_loss: 11169.0283; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275154.2133; val_optim_loss: 275154.2133
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9840; val_auprc_score: 0.9762; val_best_acc_score: 0.9568; val_best_f1_score: 0.9579; train_kl_reg_loss: 5718.4323; train_edge_recon_loss: 257279.3506; train_gene_expr_recon_loss: 11098.4004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274096.1829; train_optim_loss: 274096.1829; val_kl_reg_loss: 5905.5607; val_edge_recon_loss: 257512.8332; val_gene_expr_recon_loss: 11038.8201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274457.2144; val_optim_loss: 274457.2144
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9825; val_auprc_score: 0.9719; val_best_acc_score: 0.9575; val_best_f1_score: 0.9586; train_kl_reg_loss: 5713.2538; train_edge_recon_loss: 257299.4242; train_gene_expr_recon_loss: 10986.3420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273999.0195; train_optim_loss: 273999.0195; val_kl_reg_loss: 5725.6252; val_edge_recon_loss: 257354.9511; val_gene_expr_recon_loss: 10932.8955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274013.4698; val_optim_loss: 274013.4698
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9818; val_auprc_score: 0.9695; val_best_acc_score: 0.9590; val_best_f1_score: 0.9600; train_kl_reg_loss: 5710.7675; train_edge_recon_loss: 257126.4686; train_gene_expr_recon_loss: 10882.4715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273719.7070; train_optim_loss: 273719.7070; val_kl_reg_loss: 5821.1995; val_edge_recon_loss: 257639.2774; val_gene_expr_recon_loss: 10850.5150; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274310.9916; val_optim_loss: 274310.9916
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9844; val_auprc_score: 0.9754; val_best_acc_score: 0.9615; val_best_f1_score: 0.9625; train_kl_reg_loss: 5700.0739; train_edge_recon_loss: 257056.7299; train_gene_expr_recon_loss: 10789.1552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273545.9598; train_optim_loss: 273545.9598; val_kl_reg_loss: 5775.5260; val_edge_recon_loss: 257344.7751; val_gene_expr_recon_loss: 10720.7805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273841.0810; val_optim_loss: 273841.0810
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9847; val_auprc_score: 0.9762; val_best_acc_score: 0.9601; val_best_f1_score: 0.9609; train_kl_reg_loss: 5709.8590; train_edge_recon_loss: 256674.7526; train_gene_expr_recon_loss: 10716.9990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273101.6113; train_optim_loss: 273101.6113; val_kl_reg_loss: 5702.5920; val_edge_recon_loss: 257525.1781; val_gene_expr_recon_loss: 10679.4758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273907.2449; val_optim_loss: 273907.2449
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9855; val_auprc_score: 0.9776; val_best_acc_score: 0.9634; val_best_f1_score: 0.9641; train_kl_reg_loss: 5705.9373; train_edge_recon_loss: 256574.2156; train_gene_expr_recon_loss: 10646.5561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272926.7095; train_optim_loss: 272926.7095; val_kl_reg_loss: 5807.9161; val_edge_recon_loss: 256839.8572; val_gene_expr_recon_loss: 10578.5164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273226.2892; val_optim_loss: 273226.2892
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9866; val_auprc_score: 0.9790; val_best_acc_score: 0.9652; val_best_f1_score: 0.9659; train_kl_reg_loss: 5704.2869; train_edge_recon_loss: 256659.7449; train_gene_expr_recon_loss: 10592.2004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272956.2319; train_optim_loss: 272956.2319; val_kl_reg_loss: 5781.2711; val_edge_recon_loss: 256232.5592; val_gene_expr_recon_loss: 10570.9633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272584.7936; val_optim_loss: 272584.7936
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9851; val_auprc_score: 0.9766; val_best_acc_score: 0.9620; val_best_f1_score: 0.9630; train_kl_reg_loss: 5712.3237; train_edge_recon_loss: 256486.7567; train_gene_expr_recon_loss: 10545.0224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272744.1023; train_optim_loss: 272744.1023; val_kl_reg_loss: 5618.8447; val_edge_recon_loss: 257954.7753; val_gene_expr_recon_loss: 10493.2560; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274066.8750; val_optim_loss: 274066.8750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9855; val_auprc_score: 0.9772; val_best_acc_score: 0.9634; val_best_f1_score: 0.9642; train_kl_reg_loss: 5715.6722; train_edge_recon_loss: 256374.7587; train_gene_expr_recon_loss: 10495.7384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272586.1687; train_optim_loss: 272586.1687; val_kl_reg_loss: 5775.4256; val_edge_recon_loss: 256918.7253; val_gene_expr_recon_loss: 10487.2556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273181.4062; val_optim_loss: 273181.4062
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9868; val_auprc_score: 0.9793; val_best_acc_score: 0.9640; val_best_f1_score: 0.9649; train_kl_reg_loss: 5712.1592; train_edge_recon_loss: 256387.5981; train_gene_expr_recon_loss: 10457.7263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272557.4841; train_optim_loss: 272557.4841; val_kl_reg_loss: 5824.8784; val_edge_recon_loss: 257261.0707; val_gene_expr_recon_loss: 10384.9569; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273470.9048; val_optim_loss: 273470.9048
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9871; val_auprc_score: 0.9801; val_best_acc_score: 0.9655; val_best_f1_score: 0.9662; train_kl_reg_loss: 5721.4049; train_edge_recon_loss: 256296.4080; train_gene_expr_recon_loss: 10424.4215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272442.2343; train_optim_loss: 272442.2343; val_kl_reg_loss: 5784.0357; val_edge_recon_loss: 256901.9330; val_gene_expr_recon_loss: 10377.7019; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273063.6726; val_optim_loss: 273063.6726

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9876; val_auprc_score: 0.9807; val_best_acc_score: 0.9668; val_best_f1_score: 0.9674; train_kl_reg_loss: 5687.3568; train_edge_recon_loss: 256293.2664; train_gene_expr_recon_loss: 10366.8502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272347.4732; train_optim_loss: 272347.4732; val_kl_reg_loss: 5672.8072; val_edge_recon_loss: 256410.6194; val_gene_expr_recon_loss: 10352.5558; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272435.9797; val_optim_loss: 272435.9797
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9875; val_auprc_score: 0.9810; val_best_acc_score: 0.9658; val_best_f1_score: 0.9665; train_kl_reg_loss: 5680.7647; train_edge_recon_loss: 256010.6905; train_gene_expr_recon_loss: 10358.5153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272049.9703; train_optim_loss: 272049.9703; val_kl_reg_loss: 5718.6587; val_edge_recon_loss: 256407.3481; val_gene_expr_recon_loss: 10341.4859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272467.4909; val_optim_loss: 272467.4909
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9872; val_auprc_score: 0.9802; val_best_acc_score: 0.9668; val_best_f1_score: 0.9675; train_kl_reg_loss: 5675.2772; train_edge_recon_loss: 256154.8942; train_gene_expr_recon_loss: 10342.9826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272173.1545; train_optim_loss: 272173.1545; val_kl_reg_loss: 5719.8676; val_edge_recon_loss: 256284.8821; val_gene_expr_recon_loss: 10307.5433; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272312.2922; val_optim_loss: 272312.2922
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9888; val_auprc_score: 0.9838; val_best_acc_score: 0.9665; val_best_f1_score: 0.9672; train_kl_reg_loss: 5669.5812; train_edge_recon_loss: 256168.2621; train_gene_expr_recon_loss: 10340.7427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272178.5855; train_optim_loss: 272178.5855; val_kl_reg_loss: 5737.5129; val_edge_recon_loss: 256356.4237; val_gene_expr_recon_loss: 10298.4020; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272392.3392; val_optim_loss: 272392.3392
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9894; val_auprc_score: 0.9840; val_best_acc_score: 0.9689; val_best_f1_score: 0.9695; train_kl_reg_loss: 5673.7895; train_edge_recon_loss: 256027.8760; train_gene_expr_recon_loss: 10319.3675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272021.0330; train_optim_loss: 272021.0330; val_kl_reg_loss: 5709.8311; val_edge_recon_loss: 255802.9004; val_gene_expr_recon_loss: 10337.2567; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271849.9875; val_optim_loss: 271849.9875
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9878; val_auprc_score: 0.9804; val_best_acc_score: 0.9667; val_best_f1_score: 0.9673; train_kl_reg_loss: 5670.9404; train_edge_recon_loss: 255931.4912; train_gene_expr_recon_loss: 10309.4377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271911.8694; train_optim_loss: 271911.8694; val_kl_reg_loss: 5702.6385; val_edge_recon_loss: 256565.3737; val_gene_expr_recon_loss: 10308.8420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272576.8547; val_optim_loss: 272576.8547
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9878; val_auprc_score: 0.9821; val_best_acc_score: 0.9668; val_best_f1_score: 0.9675; train_kl_reg_loss: 5668.3215; train_edge_recon_loss: 256035.1085; train_gene_expr_recon_loss: 10309.5567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272012.9865; train_optim_loss: 272012.9865; val_kl_reg_loss: 5711.2726; val_edge_recon_loss: 256763.7845; val_gene_expr_recon_loss: 10310.8178; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272785.8750; val_optim_loss: 272785.8750
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9884; val_auprc_score: 0.9812; val_best_acc_score: 0.9685; val_best_f1_score: 0.9692; train_kl_reg_loss: 5667.6919; train_edge_recon_loss: 255953.1442; train_gene_expr_recon_loss: 10298.1166; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271918.9524; train_optim_loss: 271918.9524; val_kl_reg_loss: 5691.7482; val_edge_recon_loss: 256103.0556; val_gene_expr_recon_loss: 10274.6828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272069.4876; val_optim_loss: 272069.4876
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9883; val_auprc_score: 0.9821; val_best_acc_score: 0.9675; val_best_f1_score: 0.9681; train_kl_reg_loss: 5669.0427; train_edge_recon_loss: 255938.8779; train_gene_expr_recon_loss: 10299.4282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271907.3486; train_optim_loss: 271907.3486; val_kl_reg_loss: 5666.1922; val_edge_recon_loss: 256414.3256; val_gene_expr_recon_loss: 10302.9152; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272383.4342; val_optim_loss: 272383.4342

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9887; val_auprc_score: 0.9820; val_best_acc_score: 0.9695; val_best_f1_score: 0.9701; train_kl_reg_loss: 5665.8289; train_edge_recon_loss: 255856.9860; train_gene_expr_recon_loss: 10287.3183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271810.1335; train_optim_loss: 271810.1335; val_kl_reg_loss: 5696.0985; val_edge_recon_loss: 256025.6922; val_gene_expr_recon_loss: 10279.9984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272001.7885; val_optim_loss: 272001.7885
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9874; val_auprc_score: 0.9800; val_best_acc_score: 0.9660; val_best_f1_score: 0.9668; train_kl_reg_loss: 5663.6910; train_edge_recon_loss: 255751.4345; train_gene_expr_recon_loss: 10289.5214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271704.6472; train_optim_loss: 271704.6472; val_kl_reg_loss: 5708.9166; val_edge_recon_loss: 256779.3358; val_gene_expr_recon_loss: 10287.9989; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272776.2511; val_optim_loss: 272776.2511
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9890; val_auprc_score: 0.9829; val_best_acc_score: 0.9683; val_best_f1_score: 0.9689; train_kl_reg_loss: 5664.9239; train_edge_recon_loss: 255880.4373; train_gene_expr_recon_loss: 10288.0411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271833.4015; train_optim_loss: 271833.4015; val_kl_reg_loss: 5680.5863; val_edge_recon_loss: 256336.6441; val_gene_expr_recon_loss: 10285.4937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272302.7253; val_optim_loss: 272302.7253
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9888; val_auprc_score: 0.9824; val_best_acc_score: 0.9687; val_best_f1_score: 0.9693; train_kl_reg_loss: 5657.6113; train_edge_recon_loss: 255900.5287; train_gene_expr_recon_loss: 10275.5933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271833.7342; train_optim_loss: 271833.7342; val_kl_reg_loss: 5691.7734; val_edge_recon_loss: 256336.2989; val_gene_expr_recon_loss: 10269.0493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272297.1195; val_optim_loss: 272297.1195

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 74 min 35 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9888
Val AUPRC score: 0.9829
Val best accuracy score: 0.9672
Val best F1 score: 0.9678
Val gene expr MSE score: 0.6559

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
