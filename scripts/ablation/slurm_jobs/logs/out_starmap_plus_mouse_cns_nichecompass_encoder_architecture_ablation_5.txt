None
Run timestamp: 05082023_015911_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_fc_layers_encoder', '2', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, n_fc_layers: 2, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9795; val_auprc_score: 0.9709; val_best_acc_score: 0.9466; val_best_f1_score: 0.9478; train_kl_reg_loss: 8041.4713; train_edge_recon_loss: 264480.4802; train_gene_expr_recon_loss: 207173.7138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 479695.6660; train_optim_loss: 479695.6660; val_kl_reg_loss: 7693.3369; val_edge_recon_loss: 264461.5414; val_gene_expr_recon_loss: 190890.9371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 463045.8136; val_optim_loss: 463045.8136
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9835; val_auprc_score: 0.9766; val_best_acc_score: 0.9557; val_best_f1_score: 0.9567; train_kl_reg_loss: 7423.8852; train_edge_recon_loss: 260932.2415; train_gene_expr_recon_loss: 186447.2388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 454803.3650; train_optim_loss: 454803.3650; val_kl_reg_loss: 6985.0862; val_edge_recon_loss: 262870.4742; val_gene_expr_recon_loss: 181820.8503; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 451676.4132; val_optim_loss: 451676.4132
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9841; val_auprc_score: 0.9768; val_best_acc_score: 0.9582; val_best_f1_score: 0.9593; train_kl_reg_loss: 7141.5798; train_edge_recon_loss: 260026.6725; train_gene_expr_recon_loss: 179682.9967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446851.2489; train_optim_loss: 446851.2489; val_kl_reg_loss: 6901.3034; val_edge_recon_loss: 261511.9900; val_gene_expr_recon_loss: 177621.7515; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446035.0440; val_optim_loss: 446035.0440
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9855; val_auprc_score: 0.9804; val_best_acc_score: 0.9599; val_best_f1_score: 0.9609; train_kl_reg_loss: 6971.8129; train_edge_recon_loss: 259471.8062; train_gene_expr_recon_loss: 176220.3185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 442663.9376; train_optim_loss: 442663.9376; val_kl_reg_loss: 6711.7652; val_edge_recon_loss: 261210.3180; val_gene_expr_recon_loss: 174601.8697; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442523.9524; val_optim_loss: 442523.9524
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9862; val_auprc_score: 0.9804; val_best_acc_score: 0.9604; val_best_f1_score: 0.9613; train_kl_reg_loss: 6856.7373; train_edge_recon_loss: 258969.7663; train_gene_expr_recon_loss: 173768.1397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 439594.6430; train_optim_loss: 439594.6430; val_kl_reg_loss: 6797.2470; val_edge_recon_loss: 260605.3332; val_gene_expr_recon_loss: 173068.8358; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440471.4161; val_optim_loss: 440471.4161
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9868; val_auprc_score: 0.9816; val_best_acc_score: 0.9623; val_best_f1_score: 0.9632; train_kl_reg_loss: 6773.1146; train_edge_recon_loss: 258651.7218; train_gene_expr_recon_loss: 172281.7287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437706.5656; train_optim_loss: 437706.5656; val_kl_reg_loss: 6671.3427; val_edge_recon_loss: 260508.9666; val_gene_expr_recon_loss: 172229.1846; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 439409.4927; val_optim_loss: 439409.4927
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9885; val_auprc_score: 0.9842; val_best_acc_score: 0.9661; val_best_f1_score: 0.9668; train_kl_reg_loss: 6702.2185; train_edge_recon_loss: 258376.2680; train_gene_expr_recon_loss: 171370.6475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436449.1342; train_optim_loss: 436449.1342; val_kl_reg_loss: 6604.8277; val_edge_recon_loss: 259843.2992; val_gene_expr_recon_loss: 171527.6097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437975.7366; val_optim_loss: 437975.7366
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9884; val_auprc_score: 0.9840; val_best_acc_score: 0.9651; val_best_f1_score: 0.9658; train_kl_reg_loss: 6579.7162; train_edge_recon_loss: 258040.6735; train_gene_expr_recon_loss: 170500.6230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435121.0125; train_optim_loss: 435121.0125; val_kl_reg_loss: 6632.0018; val_edge_recon_loss: 259351.5652; val_gene_expr_recon_loss: 170973.1330; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436956.6988; val_optim_loss: 436956.6988
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9890; val_auprc_score: 0.9851; val_best_acc_score: 0.9652; val_best_f1_score: 0.9659; train_kl_reg_loss: 6388.0088; train_edge_recon_loss: 257812.8697; train_gene_expr_recon_loss: 169895.3165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434096.1946; train_optim_loss: 434096.1946; val_kl_reg_loss: 6387.3055; val_edge_recon_loss: 259326.2475; val_gene_expr_recon_loss: 170436.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436150.1541; val_optim_loss: 436150.1541
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9888; val_auprc_score: 0.9841; val_best_acc_score: 0.9650; val_best_f1_score: 0.9658; train_kl_reg_loss: 6269.5793; train_edge_recon_loss: 257907.8673; train_gene_expr_recon_loss: 169608.0728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433785.5197; train_optim_loss: 433785.5197; val_kl_reg_loss: 6842.4732; val_edge_recon_loss: 259582.8935; val_gene_expr_recon_loss: 170125.1951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436550.5640; val_optim_loss: 436550.5640
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9896; val_auprc_score: 0.9854; val_best_acc_score: 0.9662; val_best_f1_score: 0.9670; train_kl_reg_loss: 6206.2076; train_edge_recon_loss: 257507.4420; train_gene_expr_recon_loss: 168975.5733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432689.2227; train_optim_loss: 432689.2227; val_kl_reg_loss: 6722.2264; val_edge_recon_loss: 258794.7891; val_gene_expr_recon_loss: 170702.5545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436219.5690; val_optim_loss: 436219.5690
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9894; val_auprc_score: 0.9855; val_best_acc_score: 0.9667; val_best_f1_score: 0.9674; train_kl_reg_loss: 6197.6070; train_edge_recon_loss: 257184.0679; train_gene_expr_recon_loss: 168569.5924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431951.2668; train_optim_loss: 431951.2668; val_kl_reg_loss: 6742.5452; val_edge_recon_loss: 259039.6403; val_gene_expr_recon_loss: 170016.9037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435799.0876; val_optim_loss: 435799.0876
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9896; val_auprc_score: 0.9858; val_best_acc_score: 0.9674; val_best_f1_score: 0.9680; train_kl_reg_loss: 6112.2131; train_edge_recon_loss: 257329.0446; train_gene_expr_recon_loss: 168352.5499; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431793.8081; train_optim_loss: 431793.8081; val_kl_reg_loss: 6426.7666; val_edge_recon_loss: 259160.8107; val_gene_expr_recon_loss: 169113.5082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434701.0879; val_optim_loss: 434701.0879
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9901; val_auprc_score: 0.9865; val_best_acc_score: 0.9683; val_best_f1_score: 0.9689; train_kl_reg_loss: 6081.0933; train_edge_recon_loss: 257185.4135; train_gene_expr_recon_loss: 168039.3447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431305.8514; train_optim_loss: 431305.8514; val_kl_reg_loss: 6522.5291; val_edge_recon_loss: 258792.4368; val_gene_expr_recon_loss: 169653.3766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434968.3445; val_optim_loss: 434968.3445
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9906; val_auprc_score: 0.9873; val_best_acc_score: 0.9695; val_best_f1_score: 0.9701; train_kl_reg_loss: 6039.2830; train_edge_recon_loss: 257051.4767; train_gene_expr_recon_loss: 167709.5287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430800.2888; train_optim_loss: 430800.2888; val_kl_reg_loss: 7211.2514; val_edge_recon_loss: 258333.1995; val_gene_expr_recon_loss: 170714.9121; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436259.3637; val_optim_loss: 436259.3637
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9907; val_auprc_score: 0.9872; val_best_acc_score: 0.9689; val_best_f1_score: 0.9695; train_kl_reg_loss: 6039.2256; train_edge_recon_loss: 256995.4828; train_gene_expr_recon_loss: 167544.9174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430579.6264; train_optim_loss: 430579.6264; val_kl_reg_loss: 6595.4926; val_edge_recon_loss: 258191.6826; val_gene_expr_recon_loss: 169366.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434153.2209; val_optim_loss: 434153.2209
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9913; val_auprc_score: 0.9878; val_best_acc_score: 0.9710; val_best_f1_score: 0.9715; train_kl_reg_loss: 5970.3885; train_edge_recon_loss: 256665.7290; train_gene_expr_recon_loss: 167174.5546; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 429810.6718; train_optim_loss: 429810.6718; val_kl_reg_loss: 6583.1297; val_edge_recon_loss: 258246.3799; val_gene_expr_recon_loss: 169443.9244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434273.4331; val_optim_loss: 434273.4331
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9902; val_auprc_score: 0.9861; val_best_acc_score: 0.9693; val_best_f1_score: 0.9699; train_kl_reg_loss: 5911.1448; train_edge_recon_loss: 256714.1125; train_gene_expr_recon_loss: 166898.7637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 429524.0211; train_optim_loss: 429524.0211; val_kl_reg_loss: 7131.6650; val_edge_recon_loss: 257990.4766; val_gene_expr_recon_loss: 171397.0988; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436519.2420; val_optim_loss: 436519.2420
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9909; val_auprc_score: 0.9874; val_best_acc_score: 0.9708; val_best_f1_score: 0.9713; train_kl_reg_loss: 5930.2846; train_edge_recon_loss: 256702.0381; train_gene_expr_recon_loss: 166905.9670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 429538.2891; train_optim_loss: 429538.2891; val_kl_reg_loss: 7157.9213; val_edge_recon_loss: 257783.6434; val_gene_expr_recon_loss: 171106.9671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436048.5298; val_optim_loss: 436048.5298
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9911; val_auprc_score: 0.9876; val_best_acc_score: 0.9710; val_best_f1_score: 0.9715; train_kl_reg_loss: 5939.4323; train_edge_recon_loss: 256622.9741; train_gene_expr_recon_loss: 166648.2964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 429210.7023; train_optim_loss: 429210.7023; val_kl_reg_loss: 6941.3534; val_edge_recon_loss: 258015.8160; val_gene_expr_recon_loss: 171662.0164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436619.1839; val_optim_loss: 436619.1839

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9918; val_auprc_score: 0.9892; val_best_acc_score: 0.9707; val_best_f1_score: 0.9712; train_kl_reg_loss: 5854.5393; train_edge_recon_loss: 256409.6395; train_gene_expr_recon_loss: 165677.4517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427941.6302; train_optim_loss: 427941.6302; val_kl_reg_loss: 6724.6846; val_edge_recon_loss: 258157.7863; val_gene_expr_recon_loss: 169584.7169; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434467.1879; val_optim_loss: 434467.1879
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9920; val_auprc_score: 0.9895; val_best_acc_score: 0.9717; val_best_f1_score: 0.9722; train_kl_reg_loss: 5862.1704; train_edge_recon_loss: 256182.0646; train_gene_expr_recon_loss: 165563.6743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427607.9085; train_optim_loss: 427607.9085; val_kl_reg_loss: 6674.9807; val_edge_recon_loss: 257707.3864; val_gene_expr_recon_loss: 169436.8232; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433819.1911; val_optim_loss: 433819.1911
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9916; val_auprc_score: 0.9885; val_best_acc_score: 0.9727; val_best_f1_score: 0.9731; train_kl_reg_loss: 5831.1511; train_edge_recon_loss: 256327.2109; train_gene_expr_recon_loss: 165486.0489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427644.4111; train_optim_loss: 427644.4111; val_kl_reg_loss: 7275.5489; val_edge_recon_loss: 257327.3879; val_gene_expr_recon_loss: 170860.4288; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435463.3652; val_optim_loss: 435463.3652
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9920; val_auprc_score: 0.9890; val_best_acc_score: 0.9732; val_best_f1_score: 0.9737; train_kl_reg_loss: 5838.9909; train_edge_recon_loss: 256195.7263; train_gene_expr_recon_loss: 165322.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427357.3052; train_optim_loss: 427357.3052; val_kl_reg_loss: 6635.6277; val_edge_recon_loss: 257267.9112; val_gene_expr_recon_loss: 169550.7264; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433454.2653; val_optim_loss: 433454.2653
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9923; val_auprc_score: 0.9894; val_best_acc_score: 0.9727; val_best_f1_score: 0.9731; train_kl_reg_loss: 5818.1383; train_edge_recon_loss: 256174.6724; train_gene_expr_recon_loss: 165331.5617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427324.3725; train_optim_loss: 427324.3725; val_kl_reg_loss: 6746.7233; val_edge_recon_loss: 257599.7885; val_gene_expr_recon_loss: 169482.1615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433828.6730; val_optim_loss: 433828.6730
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9923; val_auprc_score: 0.9895; val_best_acc_score: 0.9728; val_best_f1_score: 0.9732; train_kl_reg_loss: 5805.0388; train_edge_recon_loss: 256192.4356; train_gene_expr_recon_loss: 165186.6247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427184.0992; train_optim_loss: 427184.0992; val_kl_reg_loss: 6495.2064; val_edge_recon_loss: 257893.7867; val_gene_expr_recon_loss: 169148.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433537.9840; val_optim_loss: 433537.9840
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9919; val_auprc_score: 0.9892; val_best_acc_score: 0.9728; val_best_f1_score: 0.9732; train_kl_reg_loss: 5791.7458; train_edge_recon_loss: 256186.5683; train_gene_expr_recon_loss: 165179.0189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427157.3323; train_optim_loss: 427157.3323; val_kl_reg_loss: 6775.0481; val_edge_recon_loss: 257720.4840; val_gene_expr_recon_loss: 170493.5392; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434989.0709; val_optim_loss: 434989.0709
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9931; val_auprc_score: 0.9910; val_best_acc_score: 0.9737; val_best_f1_score: 0.9741; train_kl_reg_loss: 5815.2798; train_edge_recon_loss: 256131.6235; train_gene_expr_recon_loss: 165067.6197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427014.5229; train_optim_loss: 427014.5229; val_kl_reg_loss: 6492.6045; val_edge_recon_loss: 257415.3465; val_gene_expr_recon_loss: 169234.3921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433142.3419; val_optim_loss: 433142.3419
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9927; val_auprc_score: 0.9904; val_best_acc_score: 0.9737; val_best_f1_score: 0.9741; train_kl_reg_loss: 5783.5772; train_edge_recon_loss: 256054.3646; train_gene_expr_recon_loss: 165024.4829; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 426862.4244; train_optim_loss: 426862.4244; val_kl_reg_loss: 6668.1911; val_edge_recon_loss: 257527.7438; val_gene_expr_recon_loss: 169605.3223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433801.2584; val_optim_loss: 433801.2584
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9925; val_auprc_score: 0.9899; val_best_acc_score: 0.9720; val_best_f1_score: 0.9725; train_kl_reg_loss: 5777.3034; train_edge_recon_loss: 256114.7927; train_gene_expr_recon_loss: 164945.5614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 426837.6576; train_optim_loss: 426837.6576; val_kl_reg_loss: 6775.2892; val_edge_recon_loss: 257370.1030; val_gene_expr_recon_loss: 169724.0133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433869.4077; val_optim_loss: 433869.4077
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9923; val_auprc_score: 0.9887; val_best_acc_score: 0.9739; val_best_f1_score: 0.9743; train_kl_reg_loss: 5800.2108; train_edge_recon_loss: 256043.1623; train_gene_expr_recon_loss: 164843.4301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 426686.8032; train_optim_loss: 426686.8032; val_kl_reg_loss: 6896.2802; val_edge_recon_loss: 257228.8745; val_gene_expr_recon_loss: 170102.9393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434228.0952; val_optim_loss: 434228.0952
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9929; val_auprc_score: 0.9903; val_best_acc_score: 0.9739; val_best_f1_score: 0.9743; train_kl_reg_loss: 5798.0823; train_edge_recon_loss: 256206.8505; train_gene_expr_recon_loss: 165008.7019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427013.6350; train_optim_loss: 427013.6350; val_kl_reg_loss: 6884.4400; val_edge_recon_loss: 257367.9548; val_gene_expr_recon_loss: 170058.1077; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434310.5018; val_optim_loss: 434310.5018

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9922; val_auprc_score: 0.9893; val_best_acc_score: 0.9717; val_best_f1_score: 0.9723; train_kl_reg_loss: 5776.3809; train_edge_recon_loss: 256014.3583; train_gene_expr_recon_loss: 164711.4972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 426502.2368; train_optim_loss: 426502.2368; val_kl_reg_loss: 6779.4989; val_edge_recon_loss: 257872.0102; val_gene_expr_recon_loss: 169943.2137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434594.7227; val_optim_loss: 434594.7227
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9926; val_auprc_score: 0.9898; val_best_acc_score: 0.9739; val_best_f1_score: 0.9743; train_kl_reg_loss: 5770.2490; train_edge_recon_loss: 256115.2247; train_gene_expr_recon_loss: 164701.2272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 426586.7003; train_optim_loss: 426586.7003; val_kl_reg_loss: 6735.6038; val_edge_recon_loss: 257059.8530; val_gene_expr_recon_loss: 169388.5200; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433183.9775; val_optim_loss: 433183.9775
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9925; val_auprc_score: 0.9895; val_best_acc_score: 0.9737; val_best_f1_score: 0.9742; train_kl_reg_loss: 5782.7638; train_edge_recon_loss: 256114.4945; train_gene_expr_recon_loss: 164761.0940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 426658.3527; train_optim_loss: 426658.3527; val_kl_reg_loss: 6860.2262; val_edge_recon_loss: 257297.5109; val_gene_expr_recon_loss: 169435.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433593.3318; val_optim_loss: 433593.3318
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9927; val_auprc_score: 0.9902; val_best_acc_score: 0.9729; val_best_f1_score: 0.9733; train_kl_reg_loss: 5779.9303; train_edge_recon_loss: 256017.3453; train_gene_expr_recon_loss: 164796.6589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 426593.9346; train_optim_loss: 426593.9346; val_kl_reg_loss: 6817.0995; val_edge_recon_loss: 257447.1359; val_gene_expr_recon_loss: 169832.3823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434096.6177; val_optim_loss: 434096.6177

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 45 min 30 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
val AUROC score: 0.9921
val AUPRC score: 0.9893
val best accuracy score: 0.9725
val best F1 score: 0.9730
val target rna MSE score: 0.5671
val source rna MSE score: 0.1069

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
