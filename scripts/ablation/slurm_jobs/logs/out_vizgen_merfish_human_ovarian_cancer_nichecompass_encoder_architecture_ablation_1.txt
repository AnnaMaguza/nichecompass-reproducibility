None
Run timestamp: 05082023_071606_1.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_fc_layers_encoder', '1', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '128', '--n_sampled_neighbors', '4', '--node_batch_size', 'None', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_hidden: 500, n_latent: 1385, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1385, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 500
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1385, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 500

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 128
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9789; val_auprc_score: 0.9778; val_best_acc_score: 0.9270; val_best_f1_score: 0.9280; train_kl_reg_loss: 7608.6595; train_edge_recon_loss: 268573.0104; train_gene_expr_recon_loss: 193770.4152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 469952.0850; train_optim_loss: 469952.0850; val_kl_reg_loss: 7249.4348; val_edge_recon_loss: 268571.1413; val_gene_expr_recon_loss: 178228.5404; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 454049.1168; val_optim_loss: 454049.1168
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9831; val_auprc_score: 0.9824; val_best_acc_score: 0.9359; val_best_f1_score: 0.9360; train_kl_reg_loss: 7181.7319; train_edge_recon_loss: 263499.0648; train_gene_expr_recon_loss: 175142.3895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445823.1858; train_optim_loss: 445823.1858; val_kl_reg_loss: 7064.8126; val_edge_recon_loss: 267284.0686; val_gene_expr_recon_loss: 172903.1143; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 447251.9959; val_optim_loss: 447251.9959
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9843; val_auprc_score: 0.9837; val_best_acc_score: 0.9381; val_best_f1_score: 0.9386; train_kl_reg_loss: 7085.3227; train_edge_recon_loss: 262515.9580; train_gene_expr_recon_loss: 172186.2822; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441787.5629; train_optim_loss: 441787.5629; val_kl_reg_loss: 7040.1785; val_edge_recon_loss: 267359.4499; val_gene_expr_recon_loss: 171272.0040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445671.6324; val_optim_loss: 445671.6324
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9843; val_auprc_score: 0.9833; val_best_acc_score: 0.9389; val_best_f1_score: 0.9391; train_kl_reg_loss: 7056.1575; train_edge_recon_loss: 262208.1786; train_gene_expr_recon_loss: 171095.6287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440359.9648; train_optim_loss: 440359.9648; val_kl_reg_loss: 6913.0341; val_edge_recon_loss: 266693.5178; val_gene_expr_recon_loss: 170533.0780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444139.6302; val_optim_loss: 444139.6302
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9855; val_auprc_score: 0.9844; val_best_acc_score: 0.9413; val_best_f1_score: 0.9418; train_kl_reg_loss: 7043.6808; train_edge_recon_loss: 261865.5139; train_gene_expr_recon_loss: 170568.3234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 439477.5181; train_optim_loss: 439477.5181; val_kl_reg_loss: 6966.5595; val_edge_recon_loss: 266236.8671; val_gene_expr_recon_loss: 170258.0857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443461.5125; val_optim_loss: 443461.5125
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9857; val_auprc_score: 0.9842; val_best_acc_score: 0.9424; val_best_f1_score: 0.9430; train_kl_reg_loss: 7041.2821; train_edge_recon_loss: 261592.8823; train_gene_expr_recon_loss: 170068.2688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 438702.4329; train_optim_loss: 438702.4329; val_kl_reg_loss: 6876.1207; val_edge_recon_loss: 265751.0733; val_gene_expr_recon_loss: 170066.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442693.6523; val_optim_loss: 442693.6523
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9853; val_auprc_score: 0.9842; val_best_acc_score: 0.9408; val_best_f1_score: 0.9412; train_kl_reg_loss: 7029.6102; train_edge_recon_loss: 261530.3311; train_gene_expr_recon_loss: 169842.1554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 438402.0964; train_optim_loss: 438402.0964; val_kl_reg_loss: 6979.5192; val_edge_recon_loss: 266108.6023; val_gene_expr_recon_loss: 169876.5364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442964.6578; val_optim_loss: 442964.6578
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9866; val_auprc_score: 0.9854; val_best_acc_score: 0.9439; val_best_f1_score: 0.9442; train_kl_reg_loss: 7027.0020; train_edge_recon_loss: 261433.1331; train_gene_expr_recon_loss: 169655.8686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 438116.0037; train_optim_loss: 438116.0037; val_kl_reg_loss: 6996.3136; val_edge_recon_loss: 266238.8042; val_gene_expr_recon_loss: 169754.5304; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442989.6474; val_optim_loss: 442989.6474
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9862; val_auprc_score: 0.9852; val_best_acc_score: 0.9434; val_best_f1_score: 0.9439; train_kl_reg_loss: 7027.5846; train_edge_recon_loss: 261244.6381; train_gene_expr_recon_loss: 169488.7221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437760.9449; train_optim_loss: 437760.9449; val_kl_reg_loss: 6937.5366; val_edge_recon_loss: 265644.5963; val_gene_expr_recon_loss: 169818.3887; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442400.5220; val_optim_loss: 442400.5220
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9857; val_auprc_score: 0.9845; val_best_acc_score: 0.9421; val_best_f1_score: 0.9424; train_kl_reg_loss: 7019.9998; train_edge_recon_loss: 261175.3307; train_gene_expr_recon_loss: 169431.0990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437626.4295; train_optim_loss: 437626.4295; val_kl_reg_loss: 6818.2843; val_edge_recon_loss: 265997.7387; val_gene_expr_recon_loss: 169558.4197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442374.4442; val_optim_loss: 442374.4442
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9864; val_auprc_score: 0.9849; val_best_acc_score: 0.9448; val_best_f1_score: 0.9451; train_kl_reg_loss: 7015.7770; train_edge_recon_loss: 261158.1648; train_gene_expr_recon_loss: 169421.9129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437595.8549; train_optim_loss: 437595.8549; val_kl_reg_loss: 6903.6342; val_edge_recon_loss: 265831.3741; val_gene_expr_recon_loss: 169711.5206; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442446.5276; val_optim_loss: 442446.5276
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9867; val_auprc_score: 0.9855; val_best_acc_score: 0.9457; val_best_f1_score: 0.9462; train_kl_reg_loss: 7017.4982; train_edge_recon_loss: 260943.7652; train_gene_expr_recon_loss: 169277.0721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437238.3356; train_optim_loss: 437238.3356; val_kl_reg_loss: 6862.0126; val_edge_recon_loss: 265670.3312; val_gene_expr_recon_loss: 169570.2678; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442102.6121; val_optim_loss: 442102.6121
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9872; val_auprc_score: 0.9859; val_best_acc_score: 0.9462; val_best_f1_score: 0.9469; train_kl_reg_loss: 7015.7297; train_edge_recon_loss: 260863.5895; train_gene_expr_recon_loss: 169167.7468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437047.0662; train_optim_loss: 437047.0662; val_kl_reg_loss: 7009.9189; val_edge_recon_loss: 265448.0748; val_gene_expr_recon_loss: 169127.0369; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441585.0306; val_optim_loss: 441585.0306
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9875; val_auprc_score: 0.9862; val_best_acc_score: 0.9466; val_best_f1_score: 0.9472; train_kl_reg_loss: 7006.0499; train_edge_recon_loss: 260956.8010; train_gene_expr_recon_loss: 169082.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437045.7515; train_optim_loss: 437045.7515; val_kl_reg_loss: 6972.2029; val_edge_recon_loss: 265413.2332; val_gene_expr_recon_loss: 169396.8683; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441782.3048; val_optim_loss: 441782.3048
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9872; val_auprc_score: 0.9858; val_best_acc_score: 0.9467; val_best_f1_score: 0.9470; train_kl_reg_loss: 7010.7346; train_edge_recon_loss: 260837.6999; train_gene_expr_recon_loss: 169067.0212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436915.4557; train_optim_loss: 436915.4557; val_kl_reg_loss: 6900.9227; val_edge_recon_loss: 265689.1236; val_gene_expr_recon_loss: 169577.6164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442167.6627; val_optim_loss: 442167.6627
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9875; val_auprc_score: 0.9864; val_best_acc_score: 0.9470; val_best_f1_score: 0.9476; train_kl_reg_loss: 6996.8626; train_edge_recon_loss: 260867.8839; train_gene_expr_recon_loss: 169058.8465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436923.5930; train_optim_loss: 436923.5930; val_kl_reg_loss: 6889.8278; val_edge_recon_loss: 265675.7289; val_gene_expr_recon_loss: 169341.9920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441907.5488; val_optim_loss: 441907.5488
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9874; val_auprc_score: 0.9859; val_best_acc_score: 0.9465; val_best_f1_score: 0.9469; train_kl_reg_loss: 7009.0845; train_edge_recon_loss: 260742.7474; train_gene_expr_recon_loss: 168968.7052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436720.5371; train_optim_loss: 436720.5371; val_kl_reg_loss: 6919.6414; val_edge_recon_loss: 265522.4147; val_gene_expr_recon_loss: 169177.9881; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441620.0437; val_optim_loss: 441620.0437

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9891; val_auprc_score: 0.9881; val_best_acc_score: 0.9502; val_best_f1_score: 0.9505; train_kl_reg_loss: 7026.8069; train_edge_recon_loss: 260188.6025; train_gene_expr_recon_loss: 167099.2845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434314.6940; train_optim_loss: 434314.6940; val_kl_reg_loss: 6910.6091; val_edge_recon_loss: 264722.7033; val_gene_expr_recon_loss: 167334.5038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438967.8170; val_optim_loss: 438967.8170
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9888; val_auprc_score: 0.9877; val_best_acc_score: 0.9506; val_best_f1_score: 0.9510; train_kl_reg_loss: 7009.4944; train_edge_recon_loss: 260152.3927; train_gene_expr_recon_loss: 166694.8886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433856.7757; train_optim_loss: 433856.7757; val_kl_reg_loss: 6934.3488; val_edge_recon_loss: 264875.7642; val_gene_expr_recon_loss: 167188.8105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438998.9243; val_optim_loss: 438998.9243
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9890; val_auprc_score: 0.9879; val_best_acc_score: 0.9521; val_best_f1_score: 0.9526; train_kl_reg_loss: 6999.2974; train_edge_recon_loss: 260166.8671; train_gene_expr_recon_loss: 166610.1356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433776.3001; train_optim_loss: 433776.3001; val_kl_reg_loss: 6902.8228; val_edge_recon_loss: 265078.8728; val_gene_expr_recon_loss: 167037.9974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 439019.6929; val_optim_loss: 439019.6929
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9894; val_auprc_score: 0.9883; val_best_acc_score: 0.9528; val_best_f1_score: 0.9531; train_kl_reg_loss: 6991.6654; train_edge_recon_loss: 260115.7911; train_gene_expr_recon_loss: 166500.6505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433608.1068; train_optim_loss: 433608.1068; val_kl_reg_loss: 6892.1004; val_edge_recon_loss: 264633.8132; val_gene_expr_recon_loss: 166968.3043; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438494.2177; val_optim_loss: 438494.2177
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9893; val_auprc_score: 0.9883; val_best_acc_score: 0.9516; val_best_f1_score: 0.9520; train_kl_reg_loss: 6979.9221; train_edge_recon_loss: 260117.0674; train_gene_expr_recon_loss: 166458.0895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433555.0789; train_optim_loss: 433555.0789; val_kl_reg_loss: 6908.7281; val_edge_recon_loss: 264794.5369; val_gene_expr_recon_loss: 166841.1212; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438544.3861; val_optim_loss: 438544.3861
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9894; val_auprc_score: 0.9884; val_best_acc_score: 0.9519; val_best_f1_score: 0.9522; train_kl_reg_loss: 6980.5897; train_edge_recon_loss: 260000.3126; train_gene_expr_recon_loss: 166325.1488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433306.0512; train_optim_loss: 433306.0512; val_kl_reg_loss: 6908.0398; val_edge_recon_loss: 264979.4484; val_gene_expr_recon_loss: 166912.3922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438799.8806; val_optim_loss: 438799.8806
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9895; val_auprc_score: 0.9885; val_best_acc_score: 0.9525; val_best_f1_score: 0.9528; train_kl_reg_loss: 6961.4326; train_edge_recon_loss: 260151.6616; train_gene_expr_recon_loss: 166349.7656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433462.8597; train_optim_loss: 433462.8597; val_kl_reg_loss: 6856.7125; val_edge_recon_loss: 264919.9946; val_gene_expr_recon_loss: 166687.2504; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438463.9564; val_optim_loss: 438463.9564
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9898; val_auprc_score: 0.9887; val_best_acc_score: 0.9528; val_best_f1_score: 0.9533; train_kl_reg_loss: 6958.4660; train_edge_recon_loss: 260049.2275; train_gene_expr_recon_loss: 166313.8285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433321.5218; train_optim_loss: 433321.5218; val_kl_reg_loss: 6837.1820; val_edge_recon_loss: 264736.8409; val_gene_expr_recon_loss: 166815.9943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438390.0177; val_optim_loss: 438390.0177
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9899; val_auprc_score: 0.9890; val_best_acc_score: 0.9528; val_best_f1_score: 0.9533; train_kl_reg_loss: 6969.3211; train_edge_recon_loss: 259862.8771; train_gene_expr_recon_loss: 166277.7085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433109.9068; train_optim_loss: 433109.9068; val_kl_reg_loss: 6887.8393; val_edge_recon_loss: 264832.7990; val_gene_expr_recon_loss: 166930.4303; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438651.0684; val_optim_loss: 438651.0684
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9899; val_auprc_score: 0.9889; val_best_acc_score: 0.9531; val_best_f1_score: 0.9536; train_kl_reg_loss: 6956.5376; train_edge_recon_loss: 260118.2215; train_gene_expr_recon_loss: 166314.4351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433389.1941; train_optim_loss: 433389.1941; val_kl_reg_loss: 6847.9842; val_edge_recon_loss: 264728.8444; val_gene_expr_recon_loss: 166896.9635; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438473.7921; val_optim_loss: 438473.7921
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9896; val_auprc_score: 0.9884; val_best_acc_score: 0.9531; val_best_f1_score: 0.9534; train_kl_reg_loss: 6955.3463; train_edge_recon_loss: 259994.8112; train_gene_expr_recon_loss: 166184.4437; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433134.6013; train_optim_loss: 433134.6013; val_kl_reg_loss: 6853.6090; val_edge_recon_loss: 264734.0708; val_gene_expr_recon_loss: 166838.2905; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438425.9707; val_optim_loss: 438425.9707
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9902; val_auprc_score: 0.9892; val_best_acc_score: 0.9544; val_best_f1_score: 0.9548; train_kl_reg_loss: 6945.4148; train_edge_recon_loss: 259967.2045; train_gene_expr_recon_loss: 166257.2334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433169.8526; train_optim_loss: 433169.8526; val_kl_reg_loss: 6866.8428; val_edge_recon_loss: 264583.5329; val_gene_expr_recon_loss: 166600.8599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438051.2356; val_optim_loss: 438051.2356
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9901; val_auprc_score: 0.9887; val_best_acc_score: 0.9549; val_best_f1_score: 0.9553; train_kl_reg_loss: 6949.1812; train_edge_recon_loss: 260004.2345; train_gene_expr_recon_loss: 166230.5327; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433183.9487; train_optim_loss: 433183.9487; val_kl_reg_loss: 6855.4055; val_edge_recon_loss: 264644.2346; val_gene_expr_recon_loss: 166581.8702; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438081.5098; val_optim_loss: 438081.5098
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9904; val_auprc_score: 0.9895; val_best_acc_score: 0.9541; val_best_f1_score: 0.9544; train_kl_reg_loss: 6943.0329; train_edge_recon_loss: 260013.4945; train_gene_expr_recon_loss: 166175.6491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433132.1764; train_optim_loss: 433132.1764; val_kl_reg_loss: 6833.7505; val_edge_recon_loss: 264381.6465; val_gene_expr_recon_loss: 166667.4750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437882.8720; val_optim_loss: 437882.8720
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9898; val_auprc_score: 0.9887; val_best_acc_score: 0.9537; val_best_f1_score: 0.9540; train_kl_reg_loss: 6942.0260; train_edge_recon_loss: 259986.1485; train_gene_expr_recon_loss: 166158.2021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433086.3766; train_optim_loss: 433086.3766; val_kl_reg_loss: 6824.2739; val_edge_recon_loss: 264775.5804; val_gene_expr_recon_loss: 166652.3770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438252.2319; val_optim_loss: 438252.2319
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9900; val_auprc_score: 0.9891; val_best_acc_score: 0.9534; val_best_f1_score: 0.9539; train_kl_reg_loss: 6938.7162; train_edge_recon_loss: 259880.6462; train_gene_expr_recon_loss: 166140.6010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432959.9635; train_optim_loss: 432959.9635; val_kl_reg_loss: 6886.9047; val_edge_recon_loss: 264587.3988; val_gene_expr_recon_loss: 166592.0748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438066.3792; val_optim_loss: 438066.3792
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9902; val_auprc_score: 0.9891; val_best_acc_score: 0.9541; val_best_f1_score: 0.9546; train_kl_reg_loss: 6937.7349; train_edge_recon_loss: 259884.4920; train_gene_expr_recon_loss: 166133.0579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432955.2847; train_optim_loss: 432955.2847; val_kl_reg_loss: 6871.1401; val_edge_recon_loss: 264613.4433; val_gene_expr_recon_loss: 166657.2504; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438141.8338; val_optim_loss: 438141.8338
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9904; val_auprc_score: 0.9894; val_best_acc_score: 0.9545; val_best_f1_score: 0.9550; train_kl_reg_loss: 6933.7021; train_edge_recon_loss: 260027.4712; train_gene_expr_recon_loss: 166050.4144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433011.5877; train_optim_loss: 433011.5877; val_kl_reg_loss: 6866.8377; val_edge_recon_loss: 264569.6792; val_gene_expr_recon_loss: 166811.8110; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438248.3278; val_optim_loss: 438248.3278

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9902; val_auprc_score: 0.9893; val_best_acc_score: 0.9545; val_best_f1_score: 0.9550; train_kl_reg_loss: 6946.7259; train_edge_recon_loss: 259810.2794; train_gene_expr_recon_loss: 165855.3710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432612.3761; train_optim_loss: 432612.3761; val_kl_reg_loss: 6846.7416; val_edge_recon_loss: 264370.4539; val_gene_expr_recon_loss: 166407.4044; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437624.6006; val_optim_loss: 437624.6006
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9903; val_auprc_score: 0.9894; val_best_acc_score: 0.9540; val_best_f1_score: 0.9543; train_kl_reg_loss: 6934.7257; train_edge_recon_loss: 259897.3977; train_gene_expr_recon_loss: 165833.6276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432665.7511; train_optim_loss: 432665.7511; val_kl_reg_loss: 6849.9043; val_edge_recon_loss: 264659.3269; val_gene_expr_recon_loss: 166488.0757; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437997.3064; val_optim_loss: 437997.3064
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9902; val_auprc_score: 0.9892; val_best_acc_score: 0.9546; val_best_f1_score: 0.9551; train_kl_reg_loss: 6934.5040; train_edge_recon_loss: 259767.5460; train_gene_expr_recon_loss: 165775.7869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432477.8369; train_optim_loss: 432477.8369; val_kl_reg_loss: 6860.7548; val_edge_recon_loss: 264218.5631; val_gene_expr_recon_loss: 166326.3564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437405.6750; val_optim_loss: 437405.6750
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9902; val_auprc_score: 0.9893; val_best_acc_score: 0.9542; val_best_f1_score: 0.9547; train_kl_reg_loss: 6930.4180; train_edge_recon_loss: 259828.3582; train_gene_expr_recon_loss: 165817.8063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432576.5824; train_optim_loss: 432576.5824; val_kl_reg_loss: 6849.2655; val_edge_recon_loss: 264459.8868; val_gene_expr_recon_loss: 166415.1308; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437724.2826; val_optim_loss: 437724.2826
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9897; val_auprc_score: 0.9887; val_best_acc_score: 0.9531; val_best_f1_score: 0.9534; train_kl_reg_loss: 6926.0159; train_edge_recon_loss: 259872.8569; train_gene_expr_recon_loss: 165770.7193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432569.5920; train_optim_loss: 432569.5920; val_kl_reg_loss: 6827.3704; val_edge_recon_loss: 264916.6388; val_gene_expr_recon_loss: 166376.6566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438120.6649; val_optim_loss: 438120.6649
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9903; val_auprc_score: 0.9893; val_best_acc_score: 0.9546; val_best_f1_score: 0.9548; train_kl_reg_loss: 6923.3211; train_edge_recon_loss: 259937.0162; train_gene_expr_recon_loss: 165831.0590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432691.3962; train_optim_loss: 432691.3962; val_kl_reg_loss: 6839.4022; val_edge_recon_loss: 264509.2968; val_gene_expr_recon_loss: 166486.1433; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437834.8429; val_optim_loss: 437834.8429
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9900; val_auprc_score: 0.9889; val_best_acc_score: 0.9541; val_best_f1_score: 0.9543; train_kl_reg_loss: 6923.7049; train_edge_recon_loss: 259807.4517; train_gene_expr_recon_loss: 165784.4550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432515.6114; train_optim_loss: 432515.6114; val_kl_reg_loss: 6843.9379; val_edge_recon_loss: 264656.9030; val_gene_expr_recon_loss: 166494.5617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437995.4022; val_optim_loss: 437995.4022

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9897; val_auprc_score: 0.9886; val_best_acc_score: 0.9540; val_best_f1_score: 0.9545; train_kl_reg_loss: 6926.9386; train_edge_recon_loss: 259766.1150; train_gene_expr_recon_loss: 165765.9893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432459.0428; train_optim_loss: 432459.0428; val_kl_reg_loss: 6845.3031; val_edge_recon_loss: 264794.2760; val_gene_expr_recon_loss: 166530.2356; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438169.8143; val_optim_loss: 438169.8143
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9903; val_auprc_score: 0.9893; val_best_acc_score: 0.9548; val_best_f1_score: 0.9553; train_kl_reg_loss: 6925.4898; train_edge_recon_loss: 259840.9762; train_gene_expr_recon_loss: 165753.2675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432519.7336; train_optim_loss: 432519.7336; val_kl_reg_loss: 6842.3957; val_edge_recon_loss: 264325.1161; val_gene_expr_recon_loss: 166448.8503; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437616.3628; val_optim_loss: 437616.3628
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9899; val_auprc_score: 0.9888; val_best_acc_score: 0.9542; val_best_f1_score: 0.9547; train_kl_reg_loss: 6924.2929; train_edge_recon_loss: 259862.5936; train_gene_expr_recon_loss: 165739.3649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432526.2513; train_optim_loss: 432526.2513; val_kl_reg_loss: 6843.8467; val_edge_recon_loss: 264582.5345; val_gene_expr_recon_loss: 166314.4175; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437740.7995; val_optim_loss: 437740.7995
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9904; val_auprc_score: 0.9895; val_best_acc_score: 0.9545; val_best_f1_score: 0.9549; train_kl_reg_loss: 6925.0414; train_edge_recon_loss: 259843.7453; train_gene_expr_recon_loss: 165799.9661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432568.7527; train_optim_loss: 432568.7527; val_kl_reg_loss: 6842.6637; val_edge_recon_loss: 264447.0434; val_gene_expr_recon_loss: 166353.7750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437643.4829; val_optim_loss: 437643.4829

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 328 min 41 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
val AUROC score: 0.9902
val AUPRC score: 0.9890
val best accuracy score: 0.9548
val best F1 score: 0.9552
val target rna MSE score: 3.3919
val source rna MSE score: 0.6372

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
