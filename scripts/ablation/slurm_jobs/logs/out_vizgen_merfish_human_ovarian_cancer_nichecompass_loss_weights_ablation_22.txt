None
Run timestamp: 03072023_071814_22.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_22']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9783; val_auprc_score: 0.9793; val_best_acc_score: 0.9227; val_best_f1_score: 0.9227; train_kl_reg_loss: 5462.1655; train_edge_recon_loss: 32228.2787; train_gene_expr_recon_loss: 144325.4307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182015.8751; train_optim_loss: 182015.8751; val_kl_reg_loss: 4362.2844; val_edge_recon_loss: 30471.5980; val_gene_expr_recon_loss: 133521.3099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168355.1929; val_optim_loss: 168355.1929
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9868; val_auprc_score: 0.9872; val_best_acc_score: 0.9412; val_best_f1_score: 0.9411; train_kl_reg_loss: 4259.0740; train_edge_recon_loss: 29920.2195; train_gene_expr_recon_loss: 131343.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165523.0744; train_optim_loss: 165523.0744; val_kl_reg_loss: 4003.2436; val_edge_recon_loss: 29293.6085; val_gene_expr_recon_loss: 128753.1438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162049.9959; val_optim_loss: 162049.9959
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9889; val_auprc_score: 0.9891; val_best_acc_score: 0.9461; val_best_f1_score: 0.9461; train_kl_reg_loss: 3967.5745; train_edge_recon_loss: 29209.5154; train_gene_expr_recon_loss: 127961.0329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161138.1226; train_optim_loss: 161138.1226; val_kl_reg_loss: 3764.4380; val_edge_recon_loss: 28727.6537; val_gene_expr_recon_loss: 126423.3254; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158915.4176; val_optim_loss: 158915.4176
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9905; val_auprc_score: 0.9907; val_best_acc_score: 0.9505; val_best_f1_score: 0.9506; train_kl_reg_loss: 3839.7451; train_edge_recon_loss: 28816.4141; train_gene_expr_recon_loss: 126182.0119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158838.1711; train_optim_loss: 158838.1711; val_kl_reg_loss: 3788.7696; val_edge_recon_loss: 28468.0083; val_gene_expr_recon_loss: 125090.2304; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157347.0082; val_optim_loss: 157347.0082
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9912; val_auprc_score: 0.9915; val_best_acc_score: 0.9523; val_best_f1_score: 0.9522; train_kl_reg_loss: 3785.0565; train_edge_recon_loss: 28556.8634; train_gene_expr_recon_loss: 125120.4423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157462.3624; train_optim_loss: 157462.3624; val_kl_reg_loss: 3718.2335; val_edge_recon_loss: 28145.8160; val_gene_expr_recon_loss: 124341.8307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156205.8801; val_optim_loss: 156205.8801
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9925; val_auprc_score: 0.9927; val_best_acc_score: 0.9561; val_best_f1_score: 0.9560; train_kl_reg_loss: 3757.8028; train_edge_recon_loss: 28384.4861; train_gene_expr_recon_loss: 124412.0064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 156554.2953; train_optim_loss: 156554.2953; val_kl_reg_loss: 3771.5999; val_edge_recon_loss: 28024.8007; val_gene_expr_recon_loss: 123625.4913; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155421.8922; val_optim_loss: 155421.8922
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9927; val_auprc_score: 0.9930; val_best_acc_score: 0.9571; val_best_f1_score: 0.9570; train_kl_reg_loss: 3747.3112; train_edge_recon_loss: 28244.1084; train_gene_expr_recon_loss: 123870.8310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155862.2505; train_optim_loss: 155862.2505; val_kl_reg_loss: 3716.9049; val_edge_recon_loss: 27937.2395; val_gene_expr_recon_loss: 123221.6490; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154875.7941; val_optim_loss: 154875.7941
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9933; val_auprc_score: 0.9934; val_best_acc_score: 0.9590; val_best_f1_score: 0.9590; train_kl_reg_loss: 3747.3046; train_edge_recon_loss: 28147.2121; train_gene_expr_recon_loss: 123492.5581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155387.0747; train_optim_loss: 155387.0747; val_kl_reg_loss: 3651.3588; val_edge_recon_loss: 27832.3987; val_gene_expr_recon_loss: 123113.0333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154596.7921; val_optim_loss: 154596.7921
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9935; val_auprc_score: 0.9935; val_best_acc_score: 0.9596; val_best_f1_score: 0.9597; train_kl_reg_loss: 3747.6760; train_edge_recon_loss: 28070.8220; train_gene_expr_recon_loss: 123190.9889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155009.4870; train_optim_loss: 155009.4870; val_kl_reg_loss: 3682.6978; val_edge_recon_loss: 27791.4268; val_gene_expr_recon_loss: 122726.6914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154200.8164; val_optim_loss: 154200.8164
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9935; val_auprc_score: 0.9935; val_best_acc_score: 0.9594; val_best_f1_score: 0.9593; train_kl_reg_loss: 3752.0842; train_edge_recon_loss: 28006.2668; train_gene_expr_recon_loss: 122946.7894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154705.1404; train_optim_loss: 154705.1404; val_kl_reg_loss: 3735.1309; val_edge_recon_loss: 27706.4366; val_gene_expr_recon_loss: 122547.3423; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153988.9096; val_optim_loss: 153988.9096
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9934; val_auprc_score: 0.9936; val_best_acc_score: 0.9596; val_best_f1_score: 0.9595; train_kl_reg_loss: 3758.3242; train_edge_recon_loss: 27954.3395; train_gene_expr_recon_loss: 122749.8785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154462.5422; train_optim_loss: 154462.5422; val_kl_reg_loss: 3706.5021; val_edge_recon_loss: 27648.3217; val_gene_expr_recon_loss: 122501.4060; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153856.2303; val_optim_loss: 153856.2303
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9943; val_auprc_score: 0.9941; val_best_acc_score: 0.9626; val_best_f1_score: 0.9625; train_kl_reg_loss: 3765.0711; train_edge_recon_loss: 27911.7122; train_gene_expr_recon_loss: 122559.8867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154236.6700; train_optim_loss: 154236.6700; val_kl_reg_loss: 3678.4173; val_edge_recon_loss: 27623.4162; val_gene_expr_recon_loss: 122356.2242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153658.0575; val_optim_loss: 153658.0575
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9938; val_auprc_score: 0.9939; val_best_acc_score: 0.9612; val_best_f1_score: 0.9611; train_kl_reg_loss: 3768.9473; train_edge_recon_loss: 27883.4390; train_gene_expr_recon_loss: 122379.5756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154031.9620; train_optim_loss: 154031.9620; val_kl_reg_loss: 3750.3801; val_edge_recon_loss: 27579.9291; val_gene_expr_recon_loss: 122267.1603; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153597.4692; val_optim_loss: 153597.4692
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9943; val_auprc_score: 0.9943; val_best_acc_score: 0.9628; val_best_f1_score: 0.9627; train_kl_reg_loss: 3772.9888; train_edge_recon_loss: 27858.0863; train_gene_expr_recon_loss: 122237.0046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153868.0796; train_optim_loss: 153868.0796; val_kl_reg_loss: 3752.0038; val_edge_recon_loss: 27592.6879; val_gene_expr_recon_loss: 122259.5973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153604.2891; val_optim_loss: 153604.2891
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9946; val_auprc_score: 0.9946; val_best_acc_score: 0.9641; val_best_f1_score: 0.9641; train_kl_reg_loss: 3779.6288; train_edge_recon_loss: 27830.4203; train_gene_expr_recon_loss: 122135.8136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153745.8627; train_optim_loss: 153745.8627; val_kl_reg_loss: 3721.7592; val_edge_recon_loss: 27548.3390; val_gene_expr_recon_loss: 122152.2206; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153422.3182; val_optim_loss: 153422.3182
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9946; val_auprc_score: 0.9946; val_best_acc_score: 0.9640; val_best_f1_score: 0.9640; train_kl_reg_loss: 3779.9747; train_edge_recon_loss: 27814.6338; train_gene_expr_recon_loss: 122043.9834; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153638.5920; train_optim_loss: 153638.5920; val_kl_reg_loss: 3718.4755; val_edge_recon_loss: 27555.3252; val_gene_expr_recon_loss: 121890.0418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153163.8429; val_optim_loss: 153163.8429
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9945; val_auprc_score: 0.9946; val_best_acc_score: 0.9635; val_best_f1_score: 0.9635; train_kl_reg_loss: 3786.2087; train_edge_recon_loss: 27791.7827; train_gene_expr_recon_loss: 121894.8479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153472.8393; train_optim_loss: 153472.8393; val_kl_reg_loss: 3711.6882; val_edge_recon_loss: 27541.3196; val_gene_expr_recon_loss: 121862.7663; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153115.7737; val_optim_loss: 153115.7737
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9947; val_auprc_score: 0.9947; val_best_acc_score: 0.9642; val_best_f1_score: 0.9641; train_kl_reg_loss: 3789.3734; train_edge_recon_loss: 27774.4231; train_gene_expr_recon_loss: 121884.5018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153448.2985; train_optim_loss: 153448.2985; val_kl_reg_loss: 3807.9848; val_edge_recon_loss: 27506.5624; val_gene_expr_recon_loss: 121705.7428; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153020.2897; val_optim_loss: 153020.2897
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9947; val_auprc_score: 0.9947; val_best_acc_score: 0.9643; val_best_f1_score: 0.9642; train_kl_reg_loss: 3792.2589; train_edge_recon_loss: 27761.2415; train_gene_expr_recon_loss: 121792.1914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153345.6916; train_optim_loss: 153345.6916; val_kl_reg_loss: 3682.1587; val_edge_recon_loss: 27488.5258; val_gene_expr_recon_loss: 121802.3637; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152973.0483; val_optim_loss: 152973.0483
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9947; val_auprc_score: 0.9948; val_best_acc_score: 0.9644; val_best_f1_score: 0.9644; train_kl_reg_loss: 3793.8844; train_edge_recon_loss: 27751.4368; train_gene_expr_recon_loss: 121733.0291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153278.3504; train_optim_loss: 153278.3504; val_kl_reg_loss: 3763.1307; val_edge_recon_loss: 27456.0333; val_gene_expr_recon_loss: 121591.5725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152810.7366; val_optim_loss: 152810.7366
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9949; val_auprc_score: 0.9950; val_best_acc_score: 0.9654; val_best_f1_score: 0.9652; train_kl_reg_loss: 3793.6290; train_edge_recon_loss: 27747.2794; train_gene_expr_recon_loss: 121678.0548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153218.9637; train_optim_loss: 153218.9637; val_kl_reg_loss: 3765.5919; val_edge_recon_loss: 27466.6010; val_gene_expr_recon_loss: 121665.4611; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152897.6545; val_optim_loss: 152897.6545
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9950; val_auprc_score: 0.9950; val_best_acc_score: 0.9653; val_best_f1_score: 0.9654; train_kl_reg_loss: 3797.8791; train_edge_recon_loss: 27733.9707; train_gene_expr_recon_loss: 121614.8770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153146.7269; train_optim_loss: 153146.7269; val_kl_reg_loss: 3773.7232; val_edge_recon_loss: 27487.8021; val_gene_expr_recon_loss: 121572.2007; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152833.7255; val_optim_loss: 152833.7255
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9949; val_auprc_score: 0.9950; val_best_acc_score: 0.9647; val_best_f1_score: 0.9648; train_kl_reg_loss: 3798.2381; train_edge_recon_loss: 27724.0386; train_gene_expr_recon_loss: 121565.9240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153088.2009; train_optim_loss: 153088.2009; val_kl_reg_loss: 3764.6513; val_edge_recon_loss: 27476.5344; val_gene_expr_recon_loss: 121592.1200; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152833.3064; val_optim_loss: 152833.3064
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9950; val_auprc_score: 0.9950; val_best_acc_score: 0.9652; val_best_f1_score: 0.9652; train_kl_reg_loss: 3799.8370; train_edge_recon_loss: 27707.2918; train_gene_expr_recon_loss: 121496.8336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153003.9623; train_optim_loss: 153003.9623; val_kl_reg_loss: 3725.5885; val_edge_recon_loss: 27476.3070; val_gene_expr_recon_loss: 121870.2051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153072.1006; val_optim_loss: 153072.1006

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9953; val_auprc_score: 0.9952; val_best_acc_score: 0.9659; val_best_f1_score: 0.9659; train_kl_reg_loss: 3786.0522; train_edge_recon_loss: 27635.8534; train_gene_expr_recon_loss: 120876.6175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152298.5232; train_optim_loss: 152298.5232; val_kl_reg_loss: 3718.1935; val_edge_recon_loss: 27423.7566; val_gene_expr_recon_loss: 120993.9836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152135.9336; val_optim_loss: 152135.9336
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9954; val_auprc_score: 0.9954; val_best_acc_score: 0.9667; val_best_f1_score: 0.9667; train_kl_reg_loss: 3777.4837; train_edge_recon_loss: 27650.9124; train_gene_expr_recon_loss: 120816.7389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152245.1347; train_optim_loss: 152245.1347; val_kl_reg_loss: 3722.5471; val_edge_recon_loss: 27426.2242; val_gene_expr_recon_loss: 121030.6970; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152179.4686; val_optim_loss: 152179.4686
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9954; val_auprc_score: 0.9954; val_best_acc_score: 0.9668; val_best_f1_score: 0.9669; train_kl_reg_loss: 3772.4167; train_edge_recon_loss: 27656.4039; train_gene_expr_recon_loss: 120775.0644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152203.8849; train_optim_loss: 152203.8849; val_kl_reg_loss: 3728.5483; val_edge_recon_loss: 27400.8847; val_gene_expr_recon_loss: 121056.4768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152185.9100; val_optim_loss: 152185.9100
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9953; val_auprc_score: 0.9954; val_best_acc_score: 0.9664; val_best_f1_score: 0.9663; train_kl_reg_loss: 3771.0818; train_edge_recon_loss: 27654.1552; train_gene_expr_recon_loss: 120741.5446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152166.7813; train_optim_loss: 152166.7813; val_kl_reg_loss: 3731.2790; val_edge_recon_loss: 27430.6820; val_gene_expr_recon_loss: 120985.1296; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152147.0911; val_optim_loss: 152147.0911
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9954; val_auprc_score: 0.9954; val_best_acc_score: 0.9666; val_best_f1_score: 0.9666; train_kl_reg_loss: 3767.2696; train_edge_recon_loss: 27658.7014; train_gene_expr_recon_loss: 120815.7774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152241.7483; train_optim_loss: 152241.7483; val_kl_reg_loss: 3719.6713; val_edge_recon_loss: 27426.7470; val_gene_expr_recon_loss: 121024.1803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152170.5987; val_optim_loss: 152170.5987

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9953; val_auprc_score: 0.9951; val_best_acc_score: 0.9669; val_best_f1_score: 0.9669; train_kl_reg_loss: 3764.8520; train_edge_recon_loss: 27652.6746; train_gene_expr_recon_loss: 120677.5271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152095.0538; train_optim_loss: 152095.0538; val_kl_reg_loss: 3712.7018; val_edge_recon_loss: 27412.2845; val_gene_expr_recon_loss: 120903.2024; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152028.1888; val_optim_loss: 152028.1888
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9954; val_auprc_score: 0.9955; val_best_acc_score: 0.9669; val_best_f1_score: 0.9669; train_kl_reg_loss: 3765.5212; train_edge_recon_loss: 27643.3510; train_gene_expr_recon_loss: 120635.8087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152044.6809; train_optim_loss: 152044.6809; val_kl_reg_loss: 3716.6938; val_edge_recon_loss: 27418.2758; val_gene_expr_recon_loss: 120899.6858; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152034.6557; val_optim_loss: 152034.6557
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9953; val_auprc_score: 0.9953; val_best_acc_score: 0.9665; val_best_f1_score: 0.9666; train_kl_reg_loss: 3766.3550; train_edge_recon_loss: 27642.1547; train_gene_expr_recon_loss: 120627.2802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152035.7899; train_optim_loss: 152035.7899; val_kl_reg_loss: 3718.3060; val_edge_recon_loss: 27432.3135; val_gene_expr_recon_loss: 120942.1706; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152092.7899; val_optim_loss: 152092.7899
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9954; val_auprc_score: 0.9954; val_best_acc_score: 0.9667; val_best_f1_score: 0.9668; train_kl_reg_loss: 3765.2210; train_edge_recon_loss: 27645.6976; train_gene_expr_recon_loss: 120653.9241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152064.8428; train_optim_loss: 152064.8428; val_kl_reg_loss: 3711.6241; val_edge_recon_loss: 27404.0109; val_gene_expr_recon_loss: 120957.9153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152073.5494; val_optim_loss: 152073.5494
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9953; val_auprc_score: 0.9953; val_best_acc_score: 0.9663; val_best_f1_score: 0.9662; train_kl_reg_loss: 3763.9097; train_edge_recon_loss: 27647.0930; train_gene_expr_recon_loss: 120650.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152061.2166; train_optim_loss: 152061.2166; val_kl_reg_loss: 3710.5191; val_edge_recon_loss: 27415.1859; val_gene_expr_recon_loss: 120853.6015; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 151979.3061; val_optim_loss: 151979.3061
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9954; val_auprc_score: 0.9955; val_best_acc_score: 0.9665; val_best_f1_score: 0.9665; train_kl_reg_loss: 3764.8061; train_edge_recon_loss: 27645.9803; train_gene_expr_recon_loss: 120624.3247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152035.1112; train_optim_loss: 152035.1112; val_kl_reg_loss: 3710.2125; val_edge_recon_loss: 27438.3608; val_gene_expr_recon_loss: 120827.0424; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 151975.6155; val_optim_loss: 151975.6155
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9954; val_auprc_score: 0.9955; val_best_acc_score: 0.9668; val_best_f1_score: 0.9667; train_kl_reg_loss: 3763.9766; train_edge_recon_loss: 27647.5377; train_gene_expr_recon_loss: 120675.6227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152087.1370; train_optim_loss: 152087.1370; val_kl_reg_loss: 3713.7779; val_edge_recon_loss: 27410.6313; val_gene_expr_recon_loss: 120935.1154; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152059.5247; val_optim_loss: 152059.5247
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9954; val_auprc_score: 0.9953; val_best_acc_score: 0.9669; val_best_f1_score: 0.9670; train_kl_reg_loss: 3764.1984; train_edge_recon_loss: 27643.2816; train_gene_expr_recon_loss: 120654.4766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152061.9567; train_optim_loss: 152061.9567; val_kl_reg_loss: 3709.6800; val_edge_recon_loss: 27413.2492; val_gene_expr_recon_loss: 120903.6944; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152026.6238; val_optim_loss: 152026.6238
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9954; val_auprc_score: 0.9955; val_best_acc_score: 0.9671; val_best_f1_score: 0.9671; train_kl_reg_loss: 3762.1429; train_edge_recon_loss: 27652.1417; train_gene_expr_recon_loss: 120650.8950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152065.1797; train_optim_loss: 152065.1797; val_kl_reg_loss: 3711.8397; val_edge_recon_loss: 27413.9598; val_gene_expr_recon_loss: 120849.1067; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 151974.9065; val_optim_loss: 151974.9065
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9954; val_auprc_score: 0.9953; val_best_acc_score: 0.9666; val_best_f1_score: 0.9667; train_kl_reg_loss: 3762.1296; train_edge_recon_loss: 27651.7221; train_gene_expr_recon_loss: 120604.9995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152018.8513; train_optim_loss: 152018.8513; val_kl_reg_loss: 3716.1219; val_edge_recon_loss: 27429.1940; val_gene_expr_recon_loss: 120788.8327; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 151934.1489; val_optim_loss: 151934.1489
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9954; val_auprc_score: 0.9953; val_best_acc_score: 0.9665; val_best_f1_score: 0.9666; train_kl_reg_loss: 3763.3529; train_edge_recon_loss: 27645.2848; train_gene_expr_recon_loss: 120641.5729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152050.2108; train_optim_loss: 152050.2108; val_kl_reg_loss: 3713.1794; val_edge_recon_loss: 27436.0927; val_gene_expr_recon_loss: 120855.1009; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152004.3725; val_optim_loss: 152004.3725
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9954; val_auprc_score: 0.9954; val_best_acc_score: 0.9671; val_best_f1_score: 0.9671; train_kl_reg_loss: 3762.5213; train_edge_recon_loss: 27642.6558; train_gene_expr_recon_loss: 120601.2502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152006.4274; train_optim_loss: 152006.4274; val_kl_reg_loss: 3710.6393; val_edge_recon_loss: 27436.5384; val_gene_expr_recon_loss: 120900.2111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152047.3886; val_optim_loss: 152047.3886
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9954; val_auprc_score: 0.9955; val_best_acc_score: 0.9669; val_best_f1_score: 0.9670; train_kl_reg_loss: 3762.6520; train_edge_recon_loss: 27647.6253; train_gene_expr_recon_loss: 120658.3625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152068.6395; train_optim_loss: 152068.6395; val_kl_reg_loss: 3711.1796; val_edge_recon_loss: 27438.9558; val_gene_expr_recon_loss: 120879.3361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152029.4724; val_optim_loss: 152029.4724
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9954; val_auprc_score: 0.9954; val_best_acc_score: 0.9669; val_best_f1_score: 0.9670; train_kl_reg_loss: 3763.4795; train_edge_recon_loss: 27644.9819; train_gene_expr_recon_loss: 120648.0338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152056.4953; train_optim_loss: 152056.4953; val_kl_reg_loss: 3714.8558; val_edge_recon_loss: 27407.4377; val_gene_expr_recon_loss: 120900.3573; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152022.6510; val_optim_loss: 152022.6510

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9954; val_auprc_score: 0.9953; val_best_acc_score: 0.9672; val_best_f1_score: 0.9673; train_kl_reg_loss: 3764.0971; train_edge_recon_loss: 27644.0910; train_gene_expr_recon_loss: 120576.6796; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 151984.8678; train_optim_loss: 151984.8678; val_kl_reg_loss: 3710.1716; val_edge_recon_loss: 27420.4920; val_gene_expr_recon_loss: 120729.3213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 151859.9850; val_optim_loss: 151859.9850
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9953; val_auprc_score: 0.9954; val_best_acc_score: 0.9664; val_best_f1_score: 0.9664; train_kl_reg_loss: 3762.9422; train_edge_recon_loss: 27640.4818; train_gene_expr_recon_loss: 120610.5412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152013.9650; train_optim_loss: 152013.9650; val_kl_reg_loss: 3709.5001; val_edge_recon_loss: 27443.2769; val_gene_expr_recon_loss: 120941.5360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152094.3126; val_optim_loss: 152094.3126
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9954; val_auprc_score: 0.9954; val_best_acc_score: 0.9668; val_best_f1_score: 0.9669; train_kl_reg_loss: 3762.4842; train_edge_recon_loss: 27638.7314; train_gene_expr_recon_loss: 120616.7487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152017.9644; train_optim_loss: 152017.9644; val_kl_reg_loss: 3711.1538; val_edge_recon_loss: 27433.6814; val_gene_expr_recon_loss: 120849.9907; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 151994.8270; val_optim_loss: 151994.8270
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9954; val_auprc_score: 0.9953; val_best_acc_score: 0.9670; val_best_f1_score: 0.9670; train_kl_reg_loss: 3762.7214; train_edge_recon_loss: 27643.1235; train_gene_expr_recon_loss: 120648.8203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152054.6653; train_optim_loss: 152054.6653; val_kl_reg_loss: 3710.3011; val_edge_recon_loss: 27410.7716; val_gene_expr_recon_loss: 120960.5815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152081.6545; val_optim_loss: 152081.6545
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9955; val_auprc_score: 0.9956; val_best_acc_score: 0.9673; val_best_f1_score: 0.9673; train_kl_reg_loss: 3763.4403; train_edge_recon_loss: 27642.8525; train_gene_expr_recon_loss: 120635.7837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152042.0766; train_optim_loss: 152042.0766; val_kl_reg_loss: 3710.7656; val_edge_recon_loss: 27412.0898; val_gene_expr_recon_loss: 120756.9138; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 151879.7684; val_optim_loss: 151879.7684

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9954; val_auprc_score: 0.9955; val_best_acc_score: 0.9666; val_best_f1_score: 0.9666; train_kl_reg_loss: 3762.5556; train_edge_recon_loss: 27637.4227; train_gene_expr_recon_loss: 120594.5726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 151994.5510; train_optim_loss: 151994.5510; val_kl_reg_loss: 3711.0335; val_edge_recon_loss: 27435.6464; val_gene_expr_recon_loss: 120792.1139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 151938.7938; val_optim_loss: 151938.7938
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9953; val_auprc_score: 0.9954; val_best_acc_score: 0.9663; val_best_f1_score: 0.9664; train_kl_reg_loss: 3763.0064; train_edge_recon_loss: 27642.5130; train_gene_expr_recon_loss: 120580.4210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 151985.9404; train_optim_loss: 151985.9404; val_kl_reg_loss: 3710.7327; val_edge_recon_loss: 27437.7625; val_gene_expr_recon_loss: 120898.0994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152046.5946; val_optim_loss: 152046.5946
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9955; val_auprc_score: 0.9954; val_best_acc_score: 0.9674; val_best_f1_score: 0.9675; train_kl_reg_loss: 3762.4308; train_edge_recon_loss: 27645.4616; train_gene_expr_recon_loss: 120607.7801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152015.6726; train_optim_loss: 152015.6726; val_kl_reg_loss: 3710.3074; val_edge_recon_loss: 27397.6612; val_gene_expr_recon_loss: 120799.3661; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 151907.3346; val_optim_loss: 151907.3346
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9954; val_auprc_score: 0.9955; val_best_acc_score: 0.9666; val_best_f1_score: 0.9666; train_kl_reg_loss: 3762.6281; train_edge_recon_loss: 27645.7844; train_gene_expr_recon_loss: 120607.8416; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152016.2542; train_optim_loss: 152016.2542; val_kl_reg_loss: 3709.6747; val_edge_recon_loss: 27412.7789; val_gene_expr_recon_loss: 120866.7410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 151989.1944; val_optim_loss: 151989.1944

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 354 min 44 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
Val AUROC score: 0.9955
Val AUPRC score: 0.9956
Val best accuracy score: 0.9671
Val best F1 score: 0.9671
Val gene expr MSE score: 8.4375

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
