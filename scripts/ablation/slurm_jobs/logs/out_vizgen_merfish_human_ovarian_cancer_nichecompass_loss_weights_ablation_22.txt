None
Run timestamp: 07072023_010515_22.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_22']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9848; val_auprc_score: 0.9850; val_best_acc_score: 0.9363; val_best_f1_score: 0.9366; train_kl_reg_loss: 4716.6473; train_edge_recon_loss: 31019.9248; train_gene_expr_recon_loss: 141063.1107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176799.6825; train_optim_loss: 176799.6825; val_kl_reg_loss: 3951.8806; val_edge_recon_loss: 29236.2461; val_gene_expr_recon_loss: 131617.4599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164805.5866; val_optim_loss: 164805.5866
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9894; val_auprc_score: 0.9896; val_best_acc_score: 0.9470; val_best_f1_score: 0.9470; train_kl_reg_loss: 3886.8376; train_edge_recon_loss: 28972.7604; train_gene_expr_recon_loss: 129677.9165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162537.5146; train_optim_loss: 162537.5146; val_kl_reg_loss: 3776.6370; val_edge_recon_loss: 28323.7320; val_gene_expr_recon_loss: 127790.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159890.7438; val_optim_loss: 159890.7438
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9911; val_auprc_score: 0.9911; val_best_acc_score: 0.9526; val_best_f1_score: 0.9527; train_kl_reg_loss: 3758.5905; train_edge_recon_loss: 28436.2865; train_gene_expr_recon_loss: 127156.6084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159351.4853; train_optim_loss: 159351.4853; val_kl_reg_loss: 3723.9987; val_edge_recon_loss: 27970.8187; val_gene_expr_recon_loss: 126278.0785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157972.8956; val_optim_loss: 157972.8956
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9919; val_auprc_score: 0.9921; val_best_acc_score: 0.9544; val_best_f1_score: 0.9545; train_kl_reg_loss: 3733.5313; train_edge_recon_loss: 28168.9194; train_gene_expr_recon_loss: 126005.9432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157908.3939; train_optim_loss: 157908.3939; val_kl_reg_loss: 3631.2959; val_edge_recon_loss: 27692.4191; val_gene_expr_recon_loss: 125481.3435; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156805.0582; val_optim_loss: 156805.0582
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9926; val_auprc_score: 0.9928; val_best_acc_score: 0.9566; val_best_f1_score: 0.9567; train_kl_reg_loss: 3739.7982; train_edge_recon_loss: 28014.6441; train_gene_expr_recon_loss: 125316.0567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157070.4991; train_optim_loss: 157070.4991; val_kl_reg_loss: 3696.2309; val_edge_recon_loss: 27622.0655; val_gene_expr_recon_loss: 125151.1380; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156469.4344; val_optim_loss: 156469.4344
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9930; val_auprc_score: 0.9931; val_best_acc_score: 0.9580; val_best_f1_score: 0.9579; train_kl_reg_loss: 3752.3990; train_edge_recon_loss: 27916.1007; train_gene_expr_recon_loss: 124907.2915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 156575.7912; train_optim_loss: 156575.7912; val_kl_reg_loss: 3738.2762; val_edge_recon_loss: 27590.8294; val_gene_expr_recon_loss: 124788.5929; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156117.6984; val_optim_loss: 156117.6984
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9937; val_auprc_score: 0.9938; val_best_acc_score: 0.9603; val_best_f1_score: 0.9604; train_kl_reg_loss: 3766.5604; train_edge_recon_loss: 27852.7520; train_gene_expr_recon_loss: 124608.9941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 156228.3064; train_optim_loss: 156228.3064; val_kl_reg_loss: 3674.6279; val_edge_recon_loss: 27553.6444; val_gene_expr_recon_loss: 124362.7241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155590.9960; val_optim_loss: 155590.9960
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9936; val_auprc_score: 0.9937; val_best_acc_score: 0.9594; val_best_f1_score: 0.9595; train_kl_reg_loss: 3776.1265; train_edge_recon_loss: 27804.8279; train_gene_expr_recon_loss: 124323.6946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155904.6491; train_optim_loss: 155904.6491; val_kl_reg_loss: 3705.7086; val_edge_recon_loss: 27499.4589; val_gene_expr_recon_loss: 124374.7910; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155579.9587; val_optim_loss: 155579.9587
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9938; val_auprc_score: 0.9938; val_best_acc_score: 0.9608; val_best_f1_score: 0.9607; train_kl_reg_loss: 3788.4951; train_edge_recon_loss: 27756.6211; train_gene_expr_recon_loss: 124120.9357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155666.0518; train_optim_loss: 155666.0518; val_kl_reg_loss: 3745.9486; val_edge_recon_loss: 27441.1776; val_gene_expr_recon_loss: 124188.5736; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155375.6999; val_optim_loss: 155375.6999
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9944; val_auprc_score: 0.9945; val_best_acc_score: 0.9628; val_best_f1_score: 0.9628; train_kl_reg_loss: 3792.7282; train_edge_recon_loss: 27736.8087; train_gene_expr_recon_loss: 123949.8265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155479.3634; train_optim_loss: 155479.3634; val_kl_reg_loss: 3764.5273; val_edge_recon_loss: 27485.6164; val_gene_expr_recon_loss: 123955.3406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155205.4844; val_optim_loss: 155205.4844
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9945; val_auprc_score: 0.9946; val_best_acc_score: 0.9632; val_best_f1_score: 0.9632; train_kl_reg_loss: 3800.2922; train_edge_recon_loss: 27708.0003; train_gene_expr_recon_loss: 123866.3137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155374.6061; train_optim_loss: 155374.6061; val_kl_reg_loss: 3730.7630; val_edge_recon_loss: 27454.9453; val_gene_expr_recon_loss: 124047.1631; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155232.8710; val_optim_loss: 155232.8710
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9943; val_auprc_score: 0.9943; val_best_acc_score: 0.9632; val_best_f1_score: 0.9633; train_kl_reg_loss: 3805.3985; train_edge_recon_loss: 27690.0073; train_gene_expr_recon_loss: 123733.0616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155228.4673; train_optim_loss: 155228.4673; val_kl_reg_loss: 3797.0298; val_edge_recon_loss: 27426.7214; val_gene_expr_recon_loss: 124283.3840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155507.1348; val_optim_loss: 155507.1348
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9946; val_auprc_score: 0.9946; val_best_acc_score: 0.9632; val_best_f1_score: 0.9633; train_kl_reg_loss: 3808.0202; train_edge_recon_loss: 27675.4773; train_gene_expr_recon_loss: 123656.0948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155139.5922; train_optim_loss: 155139.5922; val_kl_reg_loss: 3789.6344; val_edge_recon_loss: 27445.9164; val_gene_expr_recon_loss: 123927.3525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155162.9034; val_optim_loss: 155162.9034
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9944; val_auprc_score: 0.9944; val_best_acc_score: 0.9631; val_best_f1_score: 0.9631; train_kl_reg_loss: 3812.6145; train_edge_recon_loss: 27660.8284; train_gene_expr_recon_loss: 123524.6462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154998.0890; train_optim_loss: 154998.0890; val_kl_reg_loss: 3757.3001; val_edge_recon_loss: 27434.9397; val_gene_expr_recon_loss: 124008.7298; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155200.9698; val_optim_loss: 155200.9698
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9946; val_auprc_score: 0.9947; val_best_acc_score: 0.9638; val_best_f1_score: 0.9638; train_kl_reg_loss: 3815.5296; train_edge_recon_loss: 27652.5508; train_gene_expr_recon_loss: 123505.2584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154973.3389; train_optim_loss: 154973.3389; val_kl_reg_loss: 3769.1093; val_edge_recon_loss: 27398.2677; val_gene_expr_recon_loss: 123984.8340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155152.2112; val_optim_loss: 155152.2112
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9950; val_auprc_score: 0.9950; val_best_acc_score: 0.9653; val_best_f1_score: 0.9653; train_kl_reg_loss: 3817.5417; train_edge_recon_loss: 27637.3294; train_gene_expr_recon_loss: 123327.7935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154782.6648; train_optim_loss: 154782.6648; val_kl_reg_loss: 3728.2631; val_edge_recon_loss: 27374.2599; val_gene_expr_recon_loss: 123780.6801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154883.2027; val_optim_loss: 154883.2027
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9948; val_auprc_score: 0.9948; val_best_acc_score: 0.9641; val_best_f1_score: 0.9640; train_kl_reg_loss: 3818.4020; train_edge_recon_loss: 27633.9615; train_gene_expr_recon_loss: 123331.2771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154783.6405; train_optim_loss: 154783.6405; val_kl_reg_loss: 3746.9054; val_edge_recon_loss: 27376.1556; val_gene_expr_recon_loss: 123889.9884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155013.0495; val_optim_loss: 155013.0495
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9949; val_auprc_score: 0.9949; val_best_acc_score: 0.9647; val_best_f1_score: 0.9649; train_kl_reg_loss: 3820.9067; train_edge_recon_loss: 27626.2747; train_gene_expr_recon_loss: 123286.4899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154733.6712; train_optim_loss: 154733.6712; val_kl_reg_loss: 3786.8861; val_edge_recon_loss: 27381.9722; val_gene_expr_recon_loss: 123798.9607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154967.8192; val_optim_loss: 154967.8192
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9950; val_auprc_score: 0.9950; val_best_acc_score: 0.9650; val_best_f1_score: 0.9650; train_kl_reg_loss: 3821.9737; train_edge_recon_loss: 27613.1837; train_gene_expr_recon_loss: 123203.2559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154638.4133; train_optim_loss: 154638.4133; val_kl_reg_loss: 3712.1708; val_edge_recon_loss: 27391.9468; val_gene_expr_recon_loss: 123825.0012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154929.1188; val_optim_loss: 154929.1188
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9947; val_auprc_score: 0.9947; val_best_acc_score: 0.9643; val_best_f1_score: 0.9643; train_kl_reg_loss: 3823.8807; train_edge_recon_loss: 27599.4094; train_gene_expr_recon_loss: 123194.7928; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154618.0830; train_optim_loss: 154618.0830; val_kl_reg_loss: 3785.7062; val_edge_recon_loss: 27326.1114; val_gene_expr_recon_loss: 123761.6115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154873.4287; val_optim_loss: 154873.4287
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9951; val_auprc_score: 0.9952; val_best_acc_score: 0.9654; val_best_f1_score: 0.9655; train_kl_reg_loss: 3822.0184; train_edge_recon_loss: 27604.6448; train_gene_expr_recon_loss: 123130.1972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154556.8603; train_optim_loss: 154556.8603; val_kl_reg_loss: 3762.4248; val_edge_recon_loss: 27357.0892; val_gene_expr_recon_loss: 123781.0410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154900.5550; val_optim_loss: 154900.5550
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9950; val_auprc_score: 0.9949; val_best_acc_score: 0.9655; val_best_f1_score: 0.9655; train_kl_reg_loss: 3825.2815; train_edge_recon_loss: 27586.4408; train_gene_expr_recon_loss: 123082.8871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154494.6095; train_optim_loss: 154494.6095; val_kl_reg_loss: 3722.4333; val_edge_recon_loss: 27398.0345; val_gene_expr_recon_loss: 123684.5765; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154805.0445; val_optim_loss: 154805.0445
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9953; val_auprc_score: 0.9952; val_best_acc_score: 0.9662; val_best_f1_score: 0.9662; train_kl_reg_loss: 3825.7497; train_edge_recon_loss: 27581.9217; train_gene_expr_recon_loss: 123077.4128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154485.0842; train_optim_loss: 154485.0842; val_kl_reg_loss: 3752.5854; val_edge_recon_loss: 27326.9804; val_gene_expr_recon_loss: 123640.0461; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154719.6122; val_optim_loss: 154719.6122
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9952; val_auprc_score: 0.9952; val_best_acc_score: 0.9656; val_best_f1_score: 0.9657; train_kl_reg_loss: 3826.1554; train_edge_recon_loss: 27579.3501; train_gene_expr_recon_loss: 123014.3663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154419.8717; train_optim_loss: 154419.8717; val_kl_reg_loss: 3723.6734; val_edge_recon_loss: 27337.5562; val_gene_expr_recon_loss: 123722.3159; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154783.5453; val_optim_loss: 154783.5453
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9951; val_auprc_score: 0.9951; val_best_acc_score: 0.9653; val_best_f1_score: 0.9654; train_kl_reg_loss: 3824.9621; train_edge_recon_loss: 27575.4540; train_gene_expr_recon_loss: 123012.2272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154412.6433; train_optim_loss: 154412.6433; val_kl_reg_loss: 3737.0901; val_edge_recon_loss: 27373.2091; val_gene_expr_recon_loss: 123511.5939; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154621.8934; val_optim_loss: 154621.8934
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9954; val_auprc_score: 0.9953; val_best_acc_score: 0.9669; val_best_f1_score: 0.9669; train_kl_reg_loss: 3824.2500; train_edge_recon_loss: 27576.2930; train_gene_expr_recon_loss: 123010.0819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154410.6249; train_optim_loss: 154410.6249; val_kl_reg_loss: 3741.1866; val_edge_recon_loss: 27378.2146; val_gene_expr_recon_loss: 123628.8108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154748.2116; val_optim_loss: 154748.2116
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9953; val_auprc_score: 0.9952; val_best_acc_score: 0.9661; val_best_f1_score: 0.9661; train_kl_reg_loss: 3825.7993; train_edge_recon_loss: 27567.3020; train_gene_expr_recon_loss: 122984.3178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154377.4192; train_optim_loss: 154377.4192; val_kl_reg_loss: 3724.1131; val_edge_recon_loss: 27344.9281; val_gene_expr_recon_loss: 123487.9570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154556.9979; val_optim_loss: 154556.9979
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9955; val_auprc_score: 0.9956; val_best_acc_score: 0.9670; val_best_f1_score: 0.9670; train_kl_reg_loss: 3824.9238; train_edge_recon_loss: 27567.5626; train_gene_expr_recon_loss: 122922.9662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154315.4525; train_optim_loss: 154315.4525; val_kl_reg_loss: 3762.1663; val_edge_recon_loss: 27348.6680; val_gene_expr_recon_loss: 123539.1625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154649.9966; val_optim_loss: 154649.9966
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9953; val_auprc_score: 0.9952; val_best_acc_score: 0.9661; val_best_f1_score: 0.9661; train_kl_reg_loss: 3825.9738; train_edge_recon_loss: 27564.5069; train_gene_expr_recon_loss: 122913.3072; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154303.7880; train_optim_loss: 154303.7880; val_kl_reg_loss: 3806.2838; val_edge_recon_loss: 27325.1329; val_gene_expr_recon_loss: 123545.4824; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154676.8986; val_optim_loss: 154676.8986
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9952; val_auprc_score: 0.9953; val_best_acc_score: 0.9659; val_best_f1_score: 0.9660; train_kl_reg_loss: 3825.4267; train_edge_recon_loss: 27558.8302; train_gene_expr_recon_loss: 122877.4698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154261.7265; train_optim_loss: 154261.7265; val_kl_reg_loss: 3792.9296; val_edge_recon_loss: 27304.7326; val_gene_expr_recon_loss: 123601.1247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154698.7872; val_optim_loss: 154698.7872
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9950; val_auprc_score: 0.9950; val_best_acc_score: 0.9648; val_best_f1_score: 0.9648; train_kl_reg_loss: 3824.2012; train_edge_recon_loss: 27562.3427; train_gene_expr_recon_loss: 122872.0314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154258.5753; train_optim_loss: 154258.5753; val_kl_reg_loss: 3711.6987; val_edge_recon_loss: 27337.5362; val_gene_expr_recon_loss: 123736.8454; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154786.0803; val_optim_loss: 154786.0803

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9955; val_auprc_score: 0.9955; val_best_acc_score: 0.9674; val_best_f1_score: 0.9674; train_kl_reg_loss: 3791.0779; train_edge_recon_loss: 27492.6545; train_gene_expr_recon_loss: 121949.0190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153232.7512; train_optim_loss: 153232.7512; val_kl_reg_loss: 3720.7827; val_edge_recon_loss: 27264.1665; val_gene_expr_recon_loss: 122829.3402; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153814.2891; val_optim_loss: 153814.2891
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9957; val_auprc_score: 0.9957; val_best_acc_score: 0.9679; val_best_f1_score: 0.9679; train_kl_reg_loss: 3762.9808; train_edge_recon_loss: 27518.8304; train_gene_expr_recon_loss: 121792.7449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153074.5561; train_optim_loss: 153074.5561; val_kl_reg_loss: 3697.7588; val_edge_recon_loss: 27264.2386; val_gene_expr_recon_loss: 122677.2722; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153639.2702; val_optim_loss: 153639.2702
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9958; val_auprc_score: 0.9958; val_best_acc_score: 0.9689; val_best_f1_score: 0.9689; train_kl_reg_loss: 3755.0105; train_edge_recon_loss: 27529.7793; train_gene_expr_recon_loss: 121726.7701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153011.5599; train_optim_loss: 153011.5599; val_kl_reg_loss: 3711.1200; val_edge_recon_loss: 27294.0887; val_gene_expr_recon_loss: 122547.8340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153553.0425; val_optim_loss: 153553.0425
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9958; val_auprc_score: 0.9959; val_best_acc_score: 0.9685; val_best_f1_score: 0.9685; train_kl_reg_loss: 3748.3864; train_edge_recon_loss: 27536.9767; train_gene_expr_recon_loss: 121687.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152972.7140; train_optim_loss: 152972.7140; val_kl_reg_loss: 3716.0724; val_edge_recon_loss: 27279.4059; val_gene_expr_recon_loss: 122627.9243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153623.4025; val_optim_loss: 153623.4025
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9957; val_auprc_score: 0.9955; val_best_acc_score: 0.9683; val_best_f1_score: 0.9683; train_kl_reg_loss: 3746.6961; train_edge_recon_loss: 27532.1455; train_gene_expr_recon_loss: 121656.7131; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152935.5547; train_optim_loss: 152935.5547; val_kl_reg_loss: 3707.4126; val_edge_recon_loss: 27307.6720; val_gene_expr_recon_loss: 122621.9593; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153637.0437; val_optim_loss: 153637.0437
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9957; val_auprc_score: 0.9955; val_best_acc_score: 0.9684; val_best_f1_score: 0.9684; train_kl_reg_loss: 3742.6473; train_edge_recon_loss: 27540.8790; train_gene_expr_recon_loss: 121610.4328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152893.9590; train_optim_loss: 152893.9590; val_kl_reg_loss: 3716.1523; val_edge_recon_loss: 27292.1210; val_gene_expr_recon_loss: 122664.6160; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153672.8892; val_optim_loss: 153672.8892
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9958; val_auprc_score: 0.9958; val_best_acc_score: 0.9685; val_best_f1_score: 0.9685; train_kl_reg_loss: 3740.6786; train_edge_recon_loss: 27538.4206; train_gene_expr_recon_loss: 121606.0008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152885.1002; train_optim_loss: 152885.1002; val_kl_reg_loss: 3684.0907; val_edge_recon_loss: 27302.2043; val_gene_expr_recon_loss: 122694.0023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153680.2977; val_optim_loss: 153680.2977

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9958; val_auprc_score: 0.9958; val_best_acc_score: 0.9683; val_best_f1_score: 0.9683; train_kl_reg_loss: 3736.6837; train_edge_recon_loss: 27532.0532; train_gene_expr_recon_loss: 121469.7424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152738.4793; train_optim_loss: 152738.4793; val_kl_reg_loss: 3697.7496; val_edge_recon_loss: 27284.7742; val_gene_expr_recon_loss: 122499.9112; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153482.4349; val_optim_loss: 153482.4349
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9959; val_auprc_score: 0.9959; val_best_acc_score: 0.9689; val_best_f1_score: 0.9688; train_kl_reg_loss: 3737.8724; train_edge_recon_loss: 27527.9747; train_gene_expr_recon_loss: 121469.2186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152735.0657; train_optim_loss: 152735.0657; val_kl_reg_loss: 3701.9407; val_edge_recon_loss: 27295.9671; val_gene_expr_recon_loss: 122561.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153559.3534; val_optim_loss: 153559.3534
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9959; val_auprc_score: 0.9959; val_best_acc_score: 0.9686; val_best_f1_score: 0.9686; train_kl_reg_loss: 3735.2784; train_edge_recon_loss: 27533.5660; train_gene_expr_recon_loss: 121442.4606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152711.3049; train_optim_loss: 152711.3049; val_kl_reg_loss: 3689.7291; val_edge_recon_loss: 27293.7289; val_gene_expr_recon_loss: 122531.8838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153515.3418; val_optim_loss: 153515.3418
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9959; val_auprc_score: 0.9960; val_best_acc_score: 0.9691; val_best_f1_score: 0.9690; train_kl_reg_loss: 3736.4913; train_edge_recon_loss: 27530.1431; train_gene_expr_recon_loss: 121487.5124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152754.1467; train_optim_loss: 152754.1467; val_kl_reg_loss: 3696.5640; val_edge_recon_loss: 27273.0571; val_gene_expr_recon_loss: 122455.2647; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153424.8864; val_optim_loss: 153424.8864
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9958; val_auprc_score: 0.9956; val_best_acc_score: 0.9687; val_best_f1_score: 0.9686; train_kl_reg_loss: 3734.5868; train_edge_recon_loss: 27534.3957; train_gene_expr_recon_loss: 121452.5928; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152721.5752; train_optim_loss: 152721.5752; val_kl_reg_loss: 3695.9953; val_edge_recon_loss: 27275.6164; val_gene_expr_recon_loss: 122450.1673; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153421.7787; val_optim_loss: 153421.7787
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9959; val_auprc_score: 0.9959; val_best_acc_score: 0.9688; val_best_f1_score: 0.9687; train_kl_reg_loss: 3735.2210; train_edge_recon_loss: 27529.7940; train_gene_expr_recon_loss: 121437.8371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152702.8522; train_optim_loss: 152702.8522; val_kl_reg_loss: 3692.5318; val_edge_recon_loss: 27289.6119; val_gene_expr_recon_loss: 122439.6828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153421.8263; val_optim_loss: 153421.8263
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9959; val_auprc_score: 0.9958; val_best_acc_score: 0.9690; val_best_f1_score: 0.9689; train_kl_reg_loss: 3734.4077; train_edge_recon_loss: 27529.3707; train_gene_expr_recon_loss: 121474.5215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152738.2998; train_optim_loss: 152738.2998; val_kl_reg_loss: 3692.4140; val_edge_recon_loss: 27296.0107; val_gene_expr_recon_loss: 122467.3172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153455.7424; val_optim_loss: 153455.7424
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9960; val_auprc_score: 0.9961; val_best_acc_score: 0.9690; val_best_f1_score: 0.9689; train_kl_reg_loss: 3732.8044; train_edge_recon_loss: 27535.3161; train_gene_expr_recon_loss: 121469.4210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152737.5414; train_optim_loss: 152737.5414; val_kl_reg_loss: 3690.6509; val_edge_recon_loss: 27293.3100; val_gene_expr_recon_loss: 122504.0919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153488.0521; val_optim_loss: 153488.0521
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9958; val_auprc_score: 0.9959; val_best_acc_score: 0.9686; val_best_f1_score: 0.9685; train_kl_reg_loss: 3734.0395; train_edge_recon_loss: 27530.5168; train_gene_expr_recon_loss: 121425.4562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152690.0124; train_optim_loss: 152690.0124; val_kl_reg_loss: 3692.9329; val_edge_recon_loss: 27304.2983; val_gene_expr_recon_loss: 122499.0170; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153496.2482; val_optim_loss: 153496.2482

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9958; val_auprc_score: 0.9959; val_best_acc_score: 0.9688; val_best_f1_score: 0.9687; train_kl_reg_loss: 3733.3159; train_edge_recon_loss: 27533.3133; train_gene_expr_recon_loss: 121435.0952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152701.7245; train_optim_loss: 152701.7245; val_kl_reg_loss: 3694.2957; val_edge_recon_loss: 27291.8470; val_gene_expr_recon_loss: 122563.7129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153549.8556; val_optim_loss: 153549.8556
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9959; val_auprc_score: 0.9959; val_best_acc_score: 0.9688; val_best_f1_score: 0.9687; train_kl_reg_loss: 3734.3139; train_edge_recon_loss: 27529.7655; train_gene_expr_recon_loss: 121456.3978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152720.4773; train_optim_loss: 152720.4773; val_kl_reg_loss: 3693.1931; val_edge_recon_loss: 27286.6568; val_gene_expr_recon_loss: 122448.2373; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153428.0873; val_optim_loss: 153428.0873
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9959; val_auprc_score: 0.9959; val_best_acc_score: 0.9691; val_best_f1_score: 0.9690; train_kl_reg_loss: 3733.0795; train_edge_recon_loss: 27533.9162; train_gene_expr_recon_loss: 121399.6289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152666.6246; train_optim_loss: 152666.6246; val_kl_reg_loss: 3693.9612; val_edge_recon_loss: 27283.7002; val_gene_expr_recon_loss: 122543.8523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153521.5134; val_optim_loss: 153521.5134
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9958; val_auprc_score: 0.9958; val_best_acc_score: 0.9686; val_best_f1_score: 0.9685; train_kl_reg_loss: 3733.4876; train_edge_recon_loss: 27530.5595; train_gene_expr_recon_loss: 121426.3838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152690.4311; train_optim_loss: 152690.4311; val_kl_reg_loss: 3692.8080; val_edge_recon_loss: 27293.5376; val_gene_expr_recon_loss: 122495.1079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153481.4536; val_optim_loss: 153481.4536

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 426 min 47 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
Val AUROC score: 0.9957
Val AUPRC score: 0.9956
Val best accuracy score: 0.9683
Val best F1 score: 0.9683
Val gene expr MSE score: 8.3478

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
