None
Run timestamp: 05072023_043615_22.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_22']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9849; val_auprc_score: 0.9850; val_best_acc_score: 0.9363; val_best_f1_score: 0.9365; train_kl_reg_loss: 4619.8483; train_edge_recon_loss: 30937.9371; train_gene_expr_recon_loss: 140453.6212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176011.4067; train_optim_loss: 176011.4067; val_kl_reg_loss: 3813.1016; val_edge_recon_loss: 29117.3269; val_gene_expr_recon_loss: 132017.9210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164948.3493; val_optim_loss: 164948.3493
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9888; val_auprc_score: 0.9891; val_best_acc_score: 0.9457; val_best_f1_score: 0.9457; train_kl_reg_loss: 3857.1034; train_edge_recon_loss: 28926.8554; train_gene_expr_recon_loss: 129474.4045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162258.3633; train_optim_loss: 162258.3633; val_kl_reg_loss: 3697.4896; val_edge_recon_loss: 28265.6121; val_gene_expr_recon_loss: 128136.0436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160099.1449; val_optim_loss: 160099.1449
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9910; val_auprc_score: 0.9911; val_best_acc_score: 0.9516; val_best_f1_score: 0.9517; train_kl_reg_loss: 3735.4329; train_edge_recon_loss: 28406.8979; train_gene_expr_recon_loss: 127118.8792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159261.2099; train_optim_loss: 159261.2099; val_kl_reg_loss: 3595.4228; val_edge_recon_loss: 27982.2092; val_gene_expr_recon_loss: 126820.8350; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158398.4669; val_optim_loss: 158398.4669
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9921; val_auprc_score: 0.9921; val_best_acc_score: 0.9554; val_best_f1_score: 0.9553; train_kl_reg_loss: 3722.5963; train_edge_recon_loss: 28148.2672; train_gene_expr_recon_loss: 126023.6770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157894.5406; train_optim_loss: 157894.5406; val_kl_reg_loss: 3662.7838; val_edge_recon_loss: 27773.3881; val_gene_expr_recon_loss: 125994.2872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157430.4589; val_optim_loss: 157430.4589
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9928; val_auprc_score: 0.9928; val_best_acc_score: 0.9571; val_best_f1_score: 0.9572; train_kl_reg_loss: 3725.2695; train_edge_recon_loss: 28000.4058; train_gene_expr_recon_loss: 125310.0977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157035.7731; train_optim_loss: 157035.7731; val_kl_reg_loss: 3717.6659; val_edge_recon_loss: 27610.6483; val_gene_expr_recon_loss: 125543.2762; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156871.5899; val_optim_loss: 156871.5899
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9931; val_auprc_score: 0.9933; val_best_acc_score: 0.9588; val_best_f1_score: 0.9588; train_kl_reg_loss: 3742.4546; train_edge_recon_loss: 27895.5106; train_gene_expr_recon_loss: 124909.3879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 156547.3533; train_optim_loss: 156547.3533; val_kl_reg_loss: 3701.1836; val_edge_recon_loss: 27548.2758; val_gene_expr_recon_loss: 125373.2598; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156622.7197; val_optim_loss: 156622.7197
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9938; val_auprc_score: 0.9938; val_best_acc_score: 0.9608; val_best_f1_score: 0.9609; train_kl_reg_loss: 3755.4221; train_edge_recon_loss: 27842.6202; train_gene_expr_recon_loss: 124550.8192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 156148.8616; train_optim_loss: 156148.8616; val_kl_reg_loss: 3751.9264; val_edge_recon_loss: 27521.9866; val_gene_expr_recon_loss: 124947.1880; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156221.1008; val_optim_loss: 156221.1008
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9941; val_auprc_score: 0.9942; val_best_acc_score: 0.9615; val_best_f1_score: 0.9615; train_kl_reg_loss: 3766.0341; train_edge_recon_loss: 27800.2680; train_gene_expr_recon_loss: 124342.7226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155909.0247; train_optim_loss: 155909.0247; val_kl_reg_loss: 3765.2708; val_edge_recon_loss: 27541.3981; val_gene_expr_recon_loss: 124702.2746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156008.9437; val_optim_loss: 156008.9437
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9942; val_auprc_score: 0.9942; val_best_acc_score: 0.9623; val_best_f1_score: 0.9623; train_kl_reg_loss: 3776.9009; train_edge_recon_loss: 27763.3636; train_gene_expr_recon_loss: 124161.7318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155701.9963; train_optim_loss: 155701.9963; val_kl_reg_loss: 3734.7566; val_edge_recon_loss: 27434.6767; val_gene_expr_recon_loss: 124670.1177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155839.5510; val_optim_loss: 155839.5510
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9944; val_auprc_score: 0.9945; val_best_acc_score: 0.9632; val_best_f1_score: 0.9632; train_kl_reg_loss: 3785.0907; train_edge_recon_loss: 27735.9101; train_gene_expr_recon_loss: 123973.7040; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155494.7046; train_optim_loss: 155494.7046; val_kl_reg_loss: 3725.2233; val_edge_recon_loss: 27476.4228; val_gene_expr_recon_loss: 124661.2041; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155862.8504; val_optim_loss: 155862.8504
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9943; val_auprc_score: 0.9944; val_best_acc_score: 0.9629; val_best_f1_score: 0.9627; train_kl_reg_loss: 3791.1863; train_edge_recon_loss: 27715.1880; train_gene_expr_recon_loss: 123801.7801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155308.1545; train_optim_loss: 155308.1545; val_kl_reg_loss: 3750.1202; val_edge_recon_loss: 27425.6931; val_gene_expr_recon_loss: 124467.6828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155643.4963; val_optim_loss: 155643.4963
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9947; val_auprc_score: 0.9948; val_best_acc_score: 0.9638; val_best_f1_score: 0.9639; train_kl_reg_loss: 3795.4427; train_edge_recon_loss: 27694.5973; train_gene_expr_recon_loss: 123683.3373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155173.3772; train_optim_loss: 155173.3772; val_kl_reg_loss: 3730.4959; val_edge_recon_loss: 27452.4857; val_gene_expr_recon_loss: 124399.3106; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155582.2928; val_optim_loss: 155582.2928
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9946; val_auprc_score: 0.9947; val_best_acc_score: 0.9640; val_best_f1_score: 0.9640; train_kl_reg_loss: 3802.5777; train_edge_recon_loss: 27670.9804; train_gene_expr_recon_loss: 123581.5656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155055.1235; train_optim_loss: 155055.1235; val_kl_reg_loss: 3711.8807; val_edge_recon_loss: 27437.0699; val_gene_expr_recon_loss: 124425.2804; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155574.2310; val_optim_loss: 155574.2310
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9951; val_auprc_score: 0.9952; val_best_acc_score: 0.9651; val_best_f1_score: 0.9651; train_kl_reg_loss: 3803.5712; train_edge_recon_loss: 27663.8331; train_gene_expr_recon_loss: 123496.2021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154963.6064; train_optim_loss: 154963.6064; val_kl_reg_loss: 3805.6411; val_edge_recon_loss: 27388.6106; val_gene_expr_recon_loss: 124437.8382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155632.0902; val_optim_loss: 155632.0902
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9949; val_auprc_score: 0.9949; val_best_acc_score: 0.9644; val_best_f1_score: 0.9644; train_kl_reg_loss: 3805.7197; train_edge_recon_loss: 27653.6268; train_gene_expr_recon_loss: 123416.3141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154875.6605; train_optim_loss: 154875.6605; val_kl_reg_loss: 3761.7378; val_edge_recon_loss: 27373.1853; val_gene_expr_recon_loss: 124156.7556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155291.6785; val_optim_loss: 155291.6785
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9950; val_auprc_score: 0.9951; val_best_acc_score: 0.9651; val_best_f1_score: 0.9650; train_kl_reg_loss: 3809.6824; train_edge_recon_loss: 27638.4126; train_gene_expr_recon_loss: 123324.7046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154772.7993; train_optim_loss: 154772.7993; val_kl_reg_loss: 3810.4467; val_edge_recon_loss: 27413.2360; val_gene_expr_recon_loss: 124167.1498; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155390.8324; val_optim_loss: 155390.8324
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9948; val_auprc_score: 0.9949; val_best_acc_score: 0.9644; val_best_f1_score: 0.9643; train_kl_reg_loss: 3811.3192; train_edge_recon_loss: 27631.0858; train_gene_expr_recon_loss: 123313.9414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154756.3463; train_optim_loss: 154756.3463; val_kl_reg_loss: 3723.0701; val_edge_recon_loss: 27392.4521; val_gene_expr_recon_loss: 124243.1730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155358.6954; val_optim_loss: 155358.6954
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9951; val_auprc_score: 0.9951; val_best_acc_score: 0.9657; val_best_f1_score: 0.9656; train_kl_reg_loss: 3810.1912; train_edge_recon_loss: 27629.5147; train_gene_expr_recon_loss: 123192.8103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154632.5164; train_optim_loss: 154632.5164; val_kl_reg_loss: 3774.5821; val_edge_recon_loss: 27350.2040; val_gene_expr_recon_loss: 124099.2362; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155224.0227; val_optim_loss: 155224.0227
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9953; val_auprc_score: 0.9954; val_best_acc_score: 0.9662; val_best_f1_score: 0.9661; train_kl_reg_loss: 3811.9551; train_edge_recon_loss: 27617.0763; train_gene_expr_recon_loss: 123159.2241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154588.2555; train_optim_loss: 154588.2555; val_kl_reg_loss: 3811.5959; val_edge_recon_loss: 27317.4255; val_gene_expr_recon_loss: 124064.7925; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155193.8136; val_optim_loss: 155193.8136
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9951; val_auprc_score: 0.9952; val_best_acc_score: 0.9656; val_best_f1_score: 0.9655; train_kl_reg_loss: 3813.9683; train_edge_recon_loss: 27603.1382; train_gene_expr_recon_loss: 123136.3968; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154553.5032; train_optim_loss: 154553.5032; val_kl_reg_loss: 3767.5535; val_edge_recon_loss: 27382.3240; val_gene_expr_recon_loss: 124094.4056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155244.2832; val_optim_loss: 155244.2832
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9954; val_auprc_score: 0.9954; val_best_acc_score: 0.9666; val_best_f1_score: 0.9667; train_kl_reg_loss: 3814.6044; train_edge_recon_loss: 27602.4456; train_gene_expr_recon_loss: 123061.9700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154479.0200; train_optim_loss: 154479.0200; val_kl_reg_loss: 3825.1951; val_edge_recon_loss: 27336.8318; val_gene_expr_recon_loss: 123961.4595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155123.4866; val_optim_loss: 155123.4866
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9951; val_auprc_score: 0.9951; val_best_acc_score: 0.9656; val_best_f1_score: 0.9657; train_kl_reg_loss: 3813.5336; train_edge_recon_loss: 27600.3250; train_gene_expr_recon_loss: 123034.3848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154448.2435; train_optim_loss: 154448.2435; val_kl_reg_loss: 3759.2100; val_edge_recon_loss: 27334.6305; val_gene_expr_recon_loss: 124297.1287; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155390.9698; val_optim_loss: 155390.9698
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9951; val_auprc_score: 0.9950; val_best_acc_score: 0.9656; val_best_f1_score: 0.9656; train_kl_reg_loss: 3812.9543; train_edge_recon_loss: 27596.8345; train_gene_expr_recon_loss: 123003.6943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154413.4831; train_optim_loss: 154413.4831; val_kl_reg_loss: 3777.2946; val_edge_recon_loss: 27354.2217; val_gene_expr_recon_loss: 124125.5207; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155257.0370; val_optim_loss: 155257.0370
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9951; val_auprc_score: 0.9952; val_best_acc_score: 0.9659; val_best_f1_score: 0.9660; train_kl_reg_loss: 3815.9900; train_edge_recon_loss: 27583.6078; train_gene_expr_recon_loss: 122998.8287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154398.4267; train_optim_loss: 154398.4267; val_kl_reg_loss: 3740.0049; val_edge_recon_loss: 27380.9905; val_gene_expr_recon_loss: 124147.3706; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155268.3658; val_optim_loss: 155268.3658
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9951; val_auprc_score: 0.9950; val_best_acc_score: 0.9655; val_best_f1_score: 0.9656; train_kl_reg_loss: 3814.2381; train_edge_recon_loss: 27579.1200; train_gene_expr_recon_loss: 122941.2783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154334.6363; train_optim_loss: 154334.6363; val_kl_reg_loss: 3780.2251; val_edge_recon_loss: 27335.7144; val_gene_expr_recon_loss: 124093.1829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155209.1222; val_optim_loss: 155209.1222

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9956; val_auprc_score: 0.9955; val_best_acc_score: 0.9676; val_best_f1_score: 0.9677; train_kl_reg_loss: 3783.0604; train_edge_recon_loss: 27516.1822; train_gene_expr_recon_loss: 122055.9605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153355.2030; train_optim_loss: 153355.2030; val_kl_reg_loss: 3721.8218; val_edge_recon_loss: 27269.7100; val_gene_expr_recon_loss: 123235.0974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154226.6289; val_optim_loss: 154226.6289
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9956; val_auprc_score: 0.9956; val_best_acc_score: 0.9680; val_best_f1_score: 0.9680; train_kl_reg_loss: 3755.4626; train_edge_recon_loss: 27538.3223; train_gene_expr_recon_loss: 121859.6169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153153.4018; train_optim_loss: 153153.4018; val_kl_reg_loss: 3709.9529; val_edge_recon_loss: 27303.9051; val_gene_expr_recon_loss: 123170.4460; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154184.3038; val_optim_loss: 154184.3038
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9957; val_auprc_score: 0.9957; val_best_acc_score: 0.9676; val_best_f1_score: 0.9676; train_kl_reg_loss: 3745.2697; train_edge_recon_loss: 27555.3139; train_gene_expr_recon_loss: 121804.0164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153104.6001; train_optim_loss: 153104.6001; val_kl_reg_loss: 3696.5215; val_edge_recon_loss: 27313.0358; val_gene_expr_recon_loss: 123085.8154; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154095.3727; val_optim_loss: 154095.3727
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9957; val_auprc_score: 0.9958; val_best_acc_score: 0.9681; val_best_f1_score: 0.9681; train_kl_reg_loss: 3740.5944; train_edge_recon_loss: 27557.3190; train_gene_expr_recon_loss: 121777.5286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153075.4419; train_optim_loss: 153075.4419; val_kl_reg_loss: 3695.9812; val_edge_recon_loss: 27314.6579; val_gene_expr_recon_loss: 123071.6587; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154082.2975; val_optim_loss: 154082.2975
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9957; val_auprc_score: 0.9957; val_best_acc_score: 0.9679; val_best_f1_score: 0.9677; train_kl_reg_loss: 3739.8583; train_edge_recon_loss: 27553.7650; train_gene_expr_recon_loss: 121753.7858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153047.4090; train_optim_loss: 153047.4090; val_kl_reg_loss: 3693.8879; val_edge_recon_loss: 27306.0546; val_gene_expr_recon_loss: 122963.4186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153963.3608; val_optim_loss: 153963.3608
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9957; val_auprc_score: 0.9955; val_best_acc_score: 0.9680; val_best_f1_score: 0.9680; train_kl_reg_loss: 3735.5905; train_edge_recon_loss: 27557.9563; train_gene_expr_recon_loss: 121744.3769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153037.9236; train_optim_loss: 153037.9236; val_kl_reg_loss: 3683.4997; val_edge_recon_loss: 27313.4961; val_gene_expr_recon_loss: 123007.7464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154004.7422; val_optim_loss: 154004.7422
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9958; val_auprc_score: 0.9959; val_best_acc_score: 0.9685; val_best_f1_score: 0.9684; train_kl_reg_loss: 3730.9588; train_edge_recon_loss: 27567.6111; train_gene_expr_recon_loss: 121711.0906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153009.6605; train_optim_loss: 153009.6605; val_kl_reg_loss: 3699.2254; val_edge_recon_loss: 27308.2256; val_gene_expr_recon_loss: 123179.3131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154186.7643; val_optim_loss: 154186.7643
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9959; val_auprc_score: 0.9959; val_best_acc_score: 0.9686; val_best_f1_score: 0.9686; train_kl_reg_loss: 3730.3178; train_edge_recon_loss: 27564.6207; train_gene_expr_recon_loss: 121678.0351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152972.9736; train_optim_loss: 152972.9736; val_kl_reg_loss: 3683.0348; val_edge_recon_loss: 27329.6215; val_gene_expr_recon_loss: 122996.2238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154008.8796; val_optim_loss: 154008.8796
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9958; val_auprc_score: 0.9958; val_best_acc_score: 0.9680; val_best_f1_score: 0.9681; train_kl_reg_loss: 3730.7525; train_edge_recon_loss: 27557.1398; train_gene_expr_recon_loss: 121641.3729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152929.2652; train_optim_loss: 152929.2652; val_kl_reg_loss: 3702.2702; val_edge_recon_loss: 27316.5226; val_gene_expr_recon_loss: 123170.7477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154189.5403; val_optim_loss: 154189.5403

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9959; val_auprc_score: 0.9958; val_best_acc_score: 0.9688; val_best_f1_score: 0.9688; train_kl_reg_loss: 3728.3807; train_edge_recon_loss: 27547.4699; train_gene_expr_recon_loss: 121546.0454; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152821.8960; train_optim_loss: 152821.8960; val_kl_reg_loss: 3688.1566; val_edge_recon_loss: 27305.6707; val_gene_expr_recon_loss: 122910.9776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153904.8046; val_optim_loss: 153904.8046
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9959; val_auprc_score: 0.9960; val_best_acc_score: 0.9687; val_best_f1_score: 0.9686; train_kl_reg_loss: 3727.5330; train_edge_recon_loss: 27545.6795; train_gene_expr_recon_loss: 121541.4831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152814.6955; train_optim_loss: 152814.6955; val_kl_reg_loss: 3688.8994; val_edge_recon_loss: 27303.5911; val_gene_expr_recon_loss: 122919.0622; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153911.5527; val_optim_loss: 153911.5527
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9960; val_auprc_score: 0.9961; val_best_acc_score: 0.9689; val_best_f1_score: 0.9689; train_kl_reg_loss: 3727.1476; train_edge_recon_loss: 27548.0038; train_gene_expr_recon_loss: 121534.9180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152810.0694; train_optim_loss: 152810.0694; val_kl_reg_loss: 3680.3522; val_edge_recon_loss: 27300.3695; val_gene_expr_recon_loss: 122836.6511; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153817.3732; val_optim_loss: 153817.3732
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9959; val_auprc_score: 0.9958; val_best_acc_score: 0.9686; val_best_f1_score: 0.9686; train_kl_reg_loss: 3726.5292; train_edge_recon_loss: 27545.0775; train_gene_expr_recon_loss: 121519.4773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152791.0840; train_optim_loss: 152791.0840; val_kl_reg_loss: 3684.8424; val_edge_recon_loss: 27305.7287; val_gene_expr_recon_loss: 122884.0880; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153874.6595; val_optim_loss: 153874.6595
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9960; val_auprc_score: 0.9959; val_best_acc_score: 0.9690; val_best_f1_score: 0.9690; train_kl_reg_loss: 3723.3145; train_edge_recon_loss: 27556.1804; train_gene_expr_recon_loss: 121535.1983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152814.6932; train_optim_loss: 152814.6932; val_kl_reg_loss: 3686.7465; val_edge_recon_loss: 27316.6331; val_gene_expr_recon_loss: 122981.7906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153985.1702; val_optim_loss: 153985.1702
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9958; val_auprc_score: 0.9958; val_best_acc_score: 0.9683; val_best_f1_score: 0.9682; train_kl_reg_loss: 3723.0464; train_edge_recon_loss: 27550.6856; train_gene_expr_recon_loss: 121519.3484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152793.0804; train_optim_loss: 152793.0804; val_kl_reg_loss: 3684.3071; val_edge_recon_loss: 27301.6281; val_gene_expr_recon_loss: 122819.0176; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153804.9526; val_optim_loss: 153804.9526
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9960; val_auprc_score: 0.9959; val_best_acc_score: 0.9687; val_best_f1_score: 0.9687; train_kl_reg_loss: 3723.8046; train_edge_recon_loss: 27555.2125; train_gene_expr_recon_loss: 121492.7705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152771.7876; train_optim_loss: 152771.7876; val_kl_reg_loss: 3679.6019; val_edge_recon_loss: 27316.5414; val_gene_expr_recon_loss: 123053.8415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154049.9844; val_optim_loss: 154049.9844
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9959; val_auprc_score: 0.9960; val_best_acc_score: 0.9685; val_best_f1_score: 0.9684; train_kl_reg_loss: 3723.3358; train_edge_recon_loss: 27551.2146; train_gene_expr_recon_loss: 121496.9974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152771.5476; train_optim_loss: 152771.5476; val_kl_reg_loss: 3682.0087; val_edge_recon_loss: 27291.8862; val_gene_expr_recon_loss: 122824.1901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153798.0844; val_optim_loss: 153798.0844
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9960; val_auprc_score: 0.9960; val_best_acc_score: 0.9689; val_best_f1_score: 0.9688; train_kl_reg_loss: 3721.0323; train_edge_recon_loss: 27560.2854; train_gene_expr_recon_loss: 121493.4801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152774.7977; train_optim_loss: 152774.7977; val_kl_reg_loss: 3685.2174; val_edge_recon_loss: 27311.0164; val_gene_expr_recon_loss: 122799.8711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153796.1054; val_optim_loss: 153796.1054
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9959; val_auprc_score: 0.9960; val_best_acc_score: 0.9686; val_best_f1_score: 0.9686; train_kl_reg_loss: 3722.0104; train_edge_recon_loss: 27549.4872; train_gene_expr_recon_loss: 121509.7330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152781.2307; train_optim_loss: 152781.2307; val_kl_reg_loss: 3683.8078; val_edge_recon_loss: 27313.5156; val_gene_expr_recon_loss: 123004.7814; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154002.1050; val_optim_loss: 154002.1050
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9959; val_auprc_score: 0.9960; val_best_acc_score: 0.9689; val_best_f1_score: 0.9688; train_kl_reg_loss: 3721.2820; train_edge_recon_loss: 27558.3784; train_gene_expr_recon_loss: 121518.5042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152798.1645; train_optim_loss: 152798.1645; val_kl_reg_loss: 3680.9789; val_edge_recon_loss: 27313.3984; val_gene_expr_recon_loss: 122816.1801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153810.5574; val_optim_loss: 153810.5574
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9960; val_auprc_score: 0.9960; val_best_acc_score: 0.9690; val_best_f1_score: 0.9689; train_kl_reg_loss: 3720.0227; train_edge_recon_loss: 27555.2273; train_gene_expr_recon_loss: 121460.6431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152735.8930; train_optim_loss: 152735.8930; val_kl_reg_loss: 3678.9934; val_edge_recon_loss: 27307.6859; val_gene_expr_recon_loss: 123038.5846; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154025.2636; val_optim_loss: 154025.2636
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9960; val_auprc_score: 0.9959; val_best_acc_score: 0.9688; val_best_f1_score: 0.9687; train_kl_reg_loss: 3722.0799; train_edge_recon_loss: 27550.6062; train_gene_expr_recon_loss: 121496.0300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152768.7161; train_optim_loss: 152768.7161; val_kl_reg_loss: 3682.3056; val_edge_recon_loss: 27312.8628; val_gene_expr_recon_loss: 122936.5964; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153931.7650; val_optim_loss: 153931.7650

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9959; val_auprc_score: 0.9959; val_best_acc_score: 0.9691; val_best_f1_score: 0.9690; train_kl_reg_loss: 3722.6417; train_edge_recon_loss: 27553.0812; train_gene_expr_recon_loss: 121478.4209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152754.1437; train_optim_loss: 152754.1437; val_kl_reg_loss: 3680.5207; val_edge_recon_loss: 27298.6992; val_gene_expr_recon_loss: 122863.5822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153842.8025; val_optim_loss: 153842.8025
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9959; val_auprc_score: 0.9958; val_best_acc_score: 0.9689; val_best_f1_score: 0.9688; train_kl_reg_loss: 3721.9819; train_edge_recon_loss: 27549.8524; train_gene_expr_recon_loss: 121464.1510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152735.9854; train_optim_loss: 152735.9854; val_kl_reg_loss: 3682.0650; val_edge_recon_loss: 27304.3368; val_gene_expr_recon_loss: 122874.2467; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153860.6490; val_optim_loss: 153860.6490
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9960; val_auprc_score: 0.9959; val_best_acc_score: 0.9689; val_best_f1_score: 0.9688; train_kl_reg_loss: 3722.2510; train_edge_recon_loss: 27556.2131; train_gene_expr_recon_loss: 121475.1267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152753.5909; train_optim_loss: 152753.5909; val_kl_reg_loss: 3678.9178; val_edge_recon_loss: 27299.6204; val_gene_expr_recon_loss: 122846.4094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153824.9477; val_optim_loss: 153824.9477
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9960; val_auprc_score: 0.9960; val_best_acc_score: 0.9689; val_best_f1_score: 0.9689; train_kl_reg_loss: 3721.1016; train_edge_recon_loss: 27555.5913; train_gene_expr_recon_loss: 121494.3900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152771.0826; train_optim_loss: 152771.0826; val_kl_reg_loss: 3677.4166; val_edge_recon_loss: 27298.2416; val_gene_expr_recon_loss: 122848.8704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153824.5285; val_optim_loss: 153824.5285

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 431 min 27 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
Val AUROC score: 0.9960
Val AUPRC score: 0.9960
Val best accuracy score: 0.9687
Val best F1 score: 0.9687
Val gene expr MSE score: 8.4932

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
