None
Run timestamp: 06072023_215122_14.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_14']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9890; val_auprc_score: 0.9884; val_best_acc_score: 0.9485; val_best_f1_score: 0.9487; train_kl_reg_loss: 2145.4472; train_edge_recon_loss: 27773.6158; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29919.0630; train_optim_loss: 29919.0630; val_kl_reg_loss: 2225.3133; val_edge_recon_loss: 26210.0092; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28435.3224; val_optim_loss: 28435.3224
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9915; val_auprc_score: 0.9907; val_best_acc_score: 0.9555; val_best_f1_score: 0.9556; train_kl_reg_loss: 2258.5069; train_edge_recon_loss: 27287.9377; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29546.4445; train_optim_loss: 29546.4445; val_kl_reg_loss: 2190.6097; val_edge_recon_loss: 26117.8560; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28308.4657; val_optim_loss: 28308.4657
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9926; val_auprc_score: 0.9920; val_best_acc_score: 0.9596; val_best_f1_score: 0.9597; train_kl_reg_loss: 2272.6983; train_edge_recon_loss: 27222.0550; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29494.7533; train_optim_loss: 29494.7533; val_kl_reg_loss: 2215.4139; val_edge_recon_loss: 26091.4010; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28306.8149; val_optim_loss: 28306.8149
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9936; val_auprc_score: 0.9931; val_best_acc_score: 0.9623; val_best_f1_score: 0.9625; train_kl_reg_loss: 2277.7404; train_edge_recon_loss: 27185.6183; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29463.3587; train_optim_loss: 29463.3587; val_kl_reg_loss: 2254.1095; val_edge_recon_loss: 26044.0492; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28298.1587; val_optim_loss: 28298.1587
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9946; val_auprc_score: 0.9941; val_best_acc_score: 0.9662; val_best_f1_score: 0.9663; train_kl_reg_loss: 2283.1365; train_edge_recon_loss: 27155.0528; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29438.1893; train_optim_loss: 29438.1893; val_kl_reg_loss: 2262.9870; val_edge_recon_loss: 26017.5098; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28280.4967; val_optim_loss: 28280.4967
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9942; val_auprc_score: 0.9934; val_best_acc_score: 0.9660; val_best_f1_score: 0.9661; train_kl_reg_loss: 2286.0461; train_edge_recon_loss: 27140.3586; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29426.4047; train_optim_loss: 29426.4047; val_kl_reg_loss: 2352.5395; val_edge_recon_loss: 25983.9747; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28336.5142; val_optim_loss: 28336.5142
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9948; val_auprc_score: 0.9942; val_best_acc_score: 0.9677; val_best_f1_score: 0.9678; train_kl_reg_loss: 2289.4066; train_edge_recon_loss: 27119.6581; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29409.0647; train_optim_loss: 29409.0647; val_kl_reg_loss: 2246.4066; val_edge_recon_loss: 26021.8291; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28268.2357; val_optim_loss: 28268.2357
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9953; val_auprc_score: 0.9946; val_best_acc_score: 0.9705; val_best_f1_score: 0.9706; train_kl_reg_loss: 2289.2470; train_edge_recon_loss: 27114.9419; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29404.1889; train_optim_loss: 29404.1889; val_kl_reg_loss: 2252.7468; val_edge_recon_loss: 25984.2015; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28236.9483; val_optim_loss: 28236.9483
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9952; val_auprc_score: 0.9945; val_best_acc_score: 0.9697; val_best_f1_score: 0.9699; train_kl_reg_loss: 2291.9761; train_edge_recon_loss: 27093.0391; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29385.0153; train_optim_loss: 29385.0153; val_kl_reg_loss: 2304.9170; val_edge_recon_loss: 25960.5163; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28265.4333; val_optim_loss: 28265.4333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9957; val_auprc_score: 0.9950; val_best_acc_score: 0.9719; val_best_f1_score: 0.9719; train_kl_reg_loss: 2291.9097; train_edge_recon_loss: 27085.1309; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29377.0406; train_optim_loss: 29377.0406; val_kl_reg_loss: 2322.2216; val_edge_recon_loss: 25957.4886; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28279.7103; val_optim_loss: 28279.7103
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9956; val_auprc_score: 0.9949; val_best_acc_score: 0.9712; val_best_f1_score: 0.9713; train_kl_reg_loss: 2292.4300; train_edge_recon_loss: 27080.9080; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29373.3380; train_optim_loss: 29373.3380; val_kl_reg_loss: 2287.1665; val_edge_recon_loss: 25955.7182; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28242.8848; val_optim_loss: 28242.8848
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9957; val_auprc_score: 0.9949; val_best_acc_score: 0.9719; val_best_f1_score: 0.9720; train_kl_reg_loss: 2292.8970; train_edge_recon_loss: 27073.5022; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29366.3992; train_optim_loss: 29366.3992; val_kl_reg_loss: 2263.6603; val_edge_recon_loss: 25960.1299; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28223.7902; val_optim_loss: 28223.7902
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9957; val_auprc_score: 0.9950; val_best_acc_score: 0.9721; val_best_f1_score: 0.9722; train_kl_reg_loss: 2294.7327; train_edge_recon_loss: 27063.4368; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29358.1695; train_optim_loss: 29358.1695; val_kl_reg_loss: 2272.9872; val_edge_recon_loss: 25945.9753; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28218.9625; val_optim_loss: 28218.9625
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9957; val_auprc_score: 0.9948; val_best_acc_score: 0.9725; val_best_f1_score: 0.9726; train_kl_reg_loss: 2295.2335; train_edge_recon_loss: 27059.8086; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29355.0421; train_optim_loss: 29355.0421; val_kl_reg_loss: 2294.4062; val_edge_recon_loss: 25966.8875; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28261.2937; val_optim_loss: 28261.2937
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9962; val_auprc_score: 0.9956; val_best_acc_score: 0.9737; val_best_f1_score: 0.9738; train_kl_reg_loss: 2295.5337; train_edge_recon_loss: 27049.3999; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29344.9336; train_optim_loss: 29344.9336; val_kl_reg_loss: 2256.7566; val_edge_recon_loss: 25961.0572; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28217.8139; val_optim_loss: 28217.8139
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9963; val_auprc_score: 0.9957; val_best_acc_score: 0.9746; val_best_f1_score: 0.9747; train_kl_reg_loss: 2295.8633; train_edge_recon_loss: 27048.5427; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29344.4060; train_optim_loss: 29344.4060; val_kl_reg_loss: 2321.1141; val_edge_recon_loss: 25903.7617; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28224.8757; val_optim_loss: 28224.8757
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9963; val_auprc_score: 0.9956; val_best_acc_score: 0.9746; val_best_f1_score: 0.9746; train_kl_reg_loss: 2296.9867; train_edge_recon_loss: 27043.7596; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29340.7462; train_optim_loss: 29340.7462; val_kl_reg_loss: 2291.6144; val_edge_recon_loss: 25897.7071; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28189.3215; val_optim_loss: 28189.3215
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9960; val_auprc_score: 0.9953; val_best_acc_score: 0.9732; val_best_f1_score: 0.9733; train_kl_reg_loss: 2297.1184; train_edge_recon_loss: 27037.3453; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29334.4637; train_optim_loss: 29334.4637; val_kl_reg_loss: 2238.6451; val_edge_recon_loss: 25938.5052; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28177.1502; val_optim_loss: 28177.1502
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9963; val_auprc_score: 0.9955; val_best_acc_score: 0.9754; val_best_f1_score: 0.9755; train_kl_reg_loss: 2298.3265; train_edge_recon_loss: 27032.4857; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29330.8122; train_optim_loss: 29330.8122; val_kl_reg_loss: 2339.5900; val_edge_recon_loss: 25930.8583; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28270.4483; val_optim_loss: 28270.4483
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9965; val_auprc_score: 0.9959; val_best_acc_score: 0.9752; val_best_f1_score: 0.9752; train_kl_reg_loss: 2299.4969; train_edge_recon_loss: 27023.3359; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29322.8328; train_optim_loss: 29322.8328; val_kl_reg_loss: 2300.3489; val_edge_recon_loss: 25900.7256; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28201.0745; val_optim_loss: 28201.0745
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9965; val_auprc_score: 0.9959; val_best_acc_score: 0.9748; val_best_f1_score: 0.9749; train_kl_reg_loss: 2299.2677; train_edge_recon_loss: 27022.6404; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29321.9080; train_optim_loss: 29321.9080; val_kl_reg_loss: 2284.3033; val_edge_recon_loss: 25887.0554; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28171.3587; val_optim_loss: 28171.3587
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9965; val_auprc_score: 0.9958; val_best_acc_score: 0.9757; val_best_f1_score: 0.9759; train_kl_reg_loss: 2299.8292; train_edge_recon_loss: 27016.9950; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29316.8243; train_optim_loss: 29316.8243; val_kl_reg_loss: 2284.3686; val_edge_recon_loss: 25891.9658; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28176.3344; val_optim_loss: 28176.3344
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9967; val_auprc_score: 0.9960; val_best_acc_score: 0.9760; val_best_f1_score: 0.9761; train_kl_reg_loss: 2301.3864; train_edge_recon_loss: 27013.4339; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29314.8204; train_optim_loss: 29314.8204; val_kl_reg_loss: 2266.1946; val_edge_recon_loss: 25886.8767; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28153.0712; val_optim_loss: 28153.0712
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9963; val_auprc_score: 0.9956; val_best_acc_score: 0.9742; val_best_f1_score: 0.9744; train_kl_reg_loss: 2301.6381; train_edge_recon_loss: 27006.0632; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29307.7013; train_optim_loss: 29307.7013; val_kl_reg_loss: 2300.7120; val_edge_recon_loss: 25893.9297; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28194.6417; val_optim_loss: 28194.6417
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9969; val_auprc_score: 0.9964; val_best_acc_score: 0.9769; val_best_f1_score: 0.9770; train_kl_reg_loss: 2301.2820; train_edge_recon_loss: 27006.5585; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29307.8405; train_optim_loss: 29307.8405; val_kl_reg_loss: 2304.2095; val_edge_recon_loss: 25888.8456; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28193.0551; val_optim_loss: 28193.0551
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9969; val_auprc_score: 0.9964; val_best_acc_score: 0.9770; val_best_f1_score: 0.9771; train_kl_reg_loss: 2302.4281; train_edge_recon_loss: 26997.5849; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29300.0131; train_optim_loss: 29300.0131; val_kl_reg_loss: 2301.0105; val_edge_recon_loss: 25882.7650; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28183.7756; val_optim_loss: 28183.7756
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9968; val_auprc_score: 0.9963; val_best_acc_score: 0.9769; val_best_f1_score: 0.9770; train_kl_reg_loss: 2299.8104; train_edge_recon_loss: 27011.1552; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29310.9656; train_optim_loss: 29310.9656; val_kl_reg_loss: 2301.0990; val_edge_recon_loss: 25870.5546; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28171.6536; val_optim_loss: 28171.6536

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9971; val_auprc_score: 0.9965; val_best_acc_score: 0.9784; val_best_f1_score: 0.9785; train_kl_reg_loss: 2297.8153; train_edge_recon_loss: 26965.0427; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29262.8580; train_optim_loss: 29262.8580; val_kl_reg_loss: 2287.9738; val_edge_recon_loss: 25836.9173; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28124.8911; val_optim_loss: 28124.8911
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9973; val_auprc_score: 0.9968; val_best_acc_score: 0.9786; val_best_f1_score: 0.9787; train_kl_reg_loss: 2296.3690; train_edge_recon_loss: 26958.8206; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29255.1896; train_optim_loss: 29255.1896; val_kl_reg_loss: 2293.9183; val_edge_recon_loss: 25842.5362; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28136.4545; val_optim_loss: 28136.4545
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9789; val_best_f1_score: 0.9790; train_kl_reg_loss: 2295.5558; train_edge_recon_loss: 26959.3072; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29254.8630; train_optim_loss: 29254.8630; val_kl_reg_loss: 2282.6494; val_edge_recon_loss: 25832.5127; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28115.1621; val_optim_loss: 28115.1621
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9972; val_auprc_score: 0.9965; val_best_acc_score: 0.9790; val_best_f1_score: 0.9791; train_kl_reg_loss: 2295.0103; train_edge_recon_loss: 26953.0258; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29248.0361; train_optim_loss: 29248.0361; val_kl_reg_loss: 2291.6383; val_edge_recon_loss: 25830.3834; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28122.0218; val_optim_loss: 28122.0218
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9975; val_auprc_score: 0.9969; val_best_acc_score: 0.9801; val_best_f1_score: 0.9802; train_kl_reg_loss: 2294.0152; train_edge_recon_loss: 26955.3562; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29249.3715; train_optim_loss: 29249.3715; val_kl_reg_loss: 2300.2931; val_edge_recon_loss: 25800.4770; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28100.7701; val_optim_loss: 28100.7701
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9972; val_auprc_score: 0.9967; val_best_acc_score: 0.9789; val_best_f1_score: 0.9790; train_kl_reg_loss: 2294.0185; train_edge_recon_loss: 26954.2596; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29248.2781; train_optim_loss: 29248.2781; val_kl_reg_loss: 2285.5220; val_edge_recon_loss: 25830.4078; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28115.9298; val_optim_loss: 28115.9298
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9792; val_best_f1_score: 0.9793; train_kl_reg_loss: 2294.1636; train_edge_recon_loss: 26951.9095; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29246.0731; train_optim_loss: 29246.0731; val_kl_reg_loss: 2292.1118; val_edge_recon_loss: 25831.4166; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28123.5283; val_optim_loss: 28123.5283
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9974; val_auprc_score: 0.9969; val_best_acc_score: 0.9791; val_best_f1_score: 0.9792; train_kl_reg_loss: 2292.9645; train_edge_recon_loss: 26957.5327; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29250.4972; train_optim_loss: 29250.4972; val_kl_reg_loss: 2268.6806; val_edge_recon_loss: 25833.2750; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28101.9555; val_optim_loss: 28101.9555
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9974; val_auprc_score: 0.9967; val_best_acc_score: 0.9800; val_best_f1_score: 0.9801; train_kl_reg_loss: 2292.9858; train_edge_recon_loss: 26951.5674; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29244.5532; train_optim_loss: 29244.5532; val_kl_reg_loss: 2300.0162; val_edge_recon_loss: 25814.3448; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28114.3611; val_optim_loss: 28114.3611

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9796; val_best_f1_score: 0.9797; train_kl_reg_loss: 2293.2967; train_edge_recon_loss: 26950.7635; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29244.0602; train_optim_loss: 29244.0602; val_kl_reg_loss: 2291.0421; val_edge_recon_loss: 25801.1058; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28092.1479; val_optim_loss: 28092.1479
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9973; val_auprc_score: 0.9968; val_best_acc_score: 0.9795; val_best_f1_score: 0.9796; train_kl_reg_loss: 2292.5057; train_edge_recon_loss: 26949.5444; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29242.0501; train_optim_loss: 29242.0501; val_kl_reg_loss: 2283.7805; val_edge_recon_loss: 25817.3393; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28101.1198; val_optim_loss: 28101.1198
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9973; val_auprc_score: 0.9967; val_best_acc_score: 0.9793; val_best_f1_score: 0.9794; train_kl_reg_loss: 2290.5292; train_edge_recon_loss: 26954.8367; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29245.3659; train_optim_loss: 29245.3659; val_kl_reg_loss: 2289.5669; val_edge_recon_loss: 25811.9301; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28101.4970; val_optim_loss: 28101.4970
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9974; val_auprc_score: 0.9967; val_best_acc_score: 0.9797; val_best_f1_score: 0.9798; train_kl_reg_loss: 2292.6098; train_edge_recon_loss: 26945.1163; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29237.7262; train_optim_loss: 29237.7262; val_kl_reg_loss: 2288.4258; val_edge_recon_loss: 25804.2797; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28092.7055; val_optim_loss: 28092.7055
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9975; val_auprc_score: 0.9970; val_best_acc_score: 0.9796; val_best_f1_score: 0.9796; train_kl_reg_loss: 2291.5564; train_edge_recon_loss: 26954.6724; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29246.2288; train_optim_loss: 29246.2288; val_kl_reg_loss: 2282.2773; val_edge_recon_loss: 25826.2840; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28108.5613; val_optim_loss: 28108.5613

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9973; val_auprc_score: 0.9966; val_best_acc_score: 0.9798; val_best_f1_score: 0.9799; train_kl_reg_loss: 2288.5020; train_edge_recon_loss: 26951.8464; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29240.3483; train_optim_loss: 29240.3483; val_kl_reg_loss: 2285.6010; val_edge_recon_loss: 25803.6167; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28089.2177; val_optim_loss: 28089.2177
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9973; val_auprc_score: 0.9967; val_best_acc_score: 0.9795; val_best_f1_score: 0.9796; train_kl_reg_loss: 2290.7846; train_edge_recon_loss: 26951.5033; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29242.2878; train_optim_loss: 29242.2878; val_kl_reg_loss: 2286.8444; val_edge_recon_loss: 25818.6195; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28105.4639; val_optim_loss: 28105.4639
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9974; val_auprc_score: 0.9968; val_best_acc_score: 0.9794; val_best_f1_score: 0.9795; train_kl_reg_loss: 2291.4430; train_edge_recon_loss: 26947.3634; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29238.8063; train_optim_loss: 29238.8063; val_kl_reg_loss: 2286.5427; val_edge_recon_loss: 25818.6242; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28105.1669; val_optim_loss: 28105.1669
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9974; val_auprc_score: 0.9970; val_best_acc_score: 0.9795; val_best_f1_score: 0.9796; train_kl_reg_loss: 2292.0347; train_edge_recon_loss: 26949.1580; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29241.1927; train_optim_loss: 29241.1927; val_kl_reg_loss: 2287.6474; val_edge_recon_loss: 25823.5138; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28111.1612; val_optim_loss: 28111.1612
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9974; val_auprc_score: 0.9967; val_best_acc_score: 0.9794; val_best_f1_score: 0.9795; train_kl_reg_loss: 2292.1477; train_edge_recon_loss: 26945.4075; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29237.5552; train_optim_loss: 29237.5552; val_kl_reg_loss: 2288.4503; val_edge_recon_loss: 25808.3147; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28096.7651; val_optim_loss: 28096.7651

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9973; val_auprc_score: 0.9968; val_best_acc_score: 0.9794; val_best_f1_score: 0.9795; train_kl_reg_loss: 2292.5170; train_edge_recon_loss: 26947.2608; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29239.7778; train_optim_loss: 29239.7778; val_kl_reg_loss: 2288.3633; val_edge_recon_loss: 25818.9887; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28107.3520; val_optim_loss: 28107.3520
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9972; val_auprc_score: 0.9964; val_best_acc_score: 0.9798; val_best_f1_score: 0.9798; train_kl_reg_loss: 2292.3617; train_edge_recon_loss: 26952.5341; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29244.8957; train_optim_loss: 29244.8957; val_kl_reg_loss: 2288.0791; val_edge_recon_loss: 25811.6578; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28099.7369; val_optim_loss: 28099.7369
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9974; val_auprc_score: 0.9968; val_best_acc_score: 0.9795; val_best_f1_score: 0.9796; train_kl_reg_loss: 2292.2441; train_edge_recon_loss: 26952.2077; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29244.4519; train_optim_loss: 29244.4519; val_kl_reg_loss: 2287.6340; val_edge_recon_loss: 25822.3347; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28109.9687; val_optim_loss: 28109.9687
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9974; val_auprc_score: 0.9970; val_best_acc_score: 0.9794; val_best_f1_score: 0.9795; train_kl_reg_loss: 2292.3387; train_edge_recon_loss: 26949.4672; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29241.8059; train_optim_loss: 29241.8059; val_kl_reg_loss: 2288.3999; val_edge_recon_loss: 25825.5129; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28113.9128; val_optim_loss: 28113.9128

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 424 min 12 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
Val AUROC score: 0.9974
Val AUPRC score: 0.9968
Val best accuracy score: 0.9793
Val best F1 score: 0.9794
Val gene expr MSE score: 14.5182

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
