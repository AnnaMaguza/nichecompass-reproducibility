None
Run timestamp: 03072023_205804_14.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_14']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9871; val_auprc_score: 0.9865; val_best_acc_score: 0.9438; val_best_f1_score: 0.9440; train_kl_reg_loss: 2087.0003; train_edge_recon_loss: 27990.4779; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30077.4782; train_optim_loss: 30077.4782; val_kl_reg_loss: 2215.7218; val_edge_recon_loss: 26277.8917; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28493.6136; val_optim_loss: 28493.6136
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9898; val_auprc_score: 0.9894; val_best_acc_score: 0.9507; val_best_f1_score: 0.9507; train_kl_reg_loss: 2245.4072; train_edge_recon_loss: 27325.7150; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29571.1222; train_optim_loss: 29571.1222; val_kl_reg_loss: 2147.9571; val_edge_recon_loss: 26190.1319; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28338.0889; val_optim_loss: 28338.0889
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9915; val_auprc_score: 0.9911; val_best_acc_score: 0.9557; val_best_f1_score: 0.9559; train_kl_reg_loss: 2257.7233; train_edge_recon_loss: 27256.2014; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29513.9248; train_optim_loss: 29513.9248; val_kl_reg_loss: 2243.2362; val_edge_recon_loss: 26128.3279; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28371.5642; val_optim_loss: 28371.5642
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9924; val_auprc_score: 0.9918; val_best_acc_score: 0.9592; val_best_f1_score: 0.9594; train_kl_reg_loss: 2269.1429; train_edge_recon_loss: 27209.6739; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29478.8169; train_optim_loss: 29478.8169; val_kl_reg_loss: 2296.3748; val_edge_recon_loss: 26068.9209; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28365.2957; val_optim_loss: 28365.2957
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9940; val_auprc_score: 0.9934; val_best_acc_score: 0.9649; val_best_f1_score: 0.9652; train_kl_reg_loss: 2273.7040; train_edge_recon_loss: 27184.8220; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29458.5260; train_optim_loss: 29458.5260; val_kl_reg_loss: 2217.3167; val_edge_recon_loss: 26042.1397; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28259.4565; val_optim_loss: 28259.4565
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9941; val_auprc_score: 0.9933; val_best_acc_score: 0.9646; val_best_f1_score: 0.9647; train_kl_reg_loss: 2276.8546; train_edge_recon_loss: 27161.1797; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29438.0344; train_optim_loss: 29438.0344; val_kl_reg_loss: 2231.9145; val_edge_recon_loss: 26057.9453; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28289.8598; val_optim_loss: 28289.8598
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9945; val_auprc_score: 0.9938; val_best_acc_score: 0.9661; val_best_f1_score: 0.9662; train_kl_reg_loss: 2279.8075; train_edge_recon_loss: 27149.2228; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29429.0303; train_optim_loss: 29429.0303; val_kl_reg_loss: 2239.7593; val_edge_recon_loss: 26031.1353; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28270.8946; val_optim_loss: 28270.8946
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9951; val_auprc_score: 0.9945; val_best_acc_score: 0.9687; val_best_f1_score: 0.9688; train_kl_reg_loss: 2283.0415; train_edge_recon_loss: 27131.2828; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29414.3244; train_optim_loss: 29414.3244; val_kl_reg_loss: 2190.7810; val_edge_recon_loss: 26003.8895; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28194.6705; val_optim_loss: 28194.6705
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9952; val_auprc_score: 0.9945; val_best_acc_score: 0.9688; val_best_f1_score: 0.9689; train_kl_reg_loss: 2286.2389; train_edge_recon_loss: 27110.4032; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29396.6421; train_optim_loss: 29396.6421; val_kl_reg_loss: 2216.1284; val_edge_recon_loss: 26026.7135; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28242.8418; val_optim_loss: 28242.8418
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9948; val_auprc_score: 0.9943; val_best_acc_score: 0.9671; val_best_f1_score: 0.9672; train_kl_reg_loss: 2288.3508; train_edge_recon_loss: 27096.8115; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29385.1623; train_optim_loss: 29385.1623; val_kl_reg_loss: 2276.9331; val_edge_recon_loss: 25974.8898; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28251.8229; val_optim_loss: 28251.8229
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9955; val_auprc_score: 0.9949; val_best_acc_score: 0.9704; val_best_f1_score: 0.9705; train_kl_reg_loss: 2288.3494; train_edge_recon_loss: 27092.6538; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29381.0032; train_optim_loss: 29381.0032; val_kl_reg_loss: 2283.7881; val_edge_recon_loss: 25984.0499; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28267.8381; val_optim_loss: 28267.8381
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9952; val_auprc_score: 0.9947; val_best_acc_score: 0.9692; val_best_f1_score: 0.9693; train_kl_reg_loss: 2289.0001; train_edge_recon_loss: 27088.9347; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29377.9348; train_optim_loss: 29377.9348; val_kl_reg_loss: 2262.7130; val_edge_recon_loss: 25952.2940; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28215.0071; val_optim_loss: 28215.0071

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9960; val_auprc_score: 0.9953; val_best_acc_score: 0.9727; val_best_f1_score: 0.9728; train_kl_reg_loss: 2286.3085; train_edge_recon_loss: 27040.7140; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29327.0225; train_optim_loss: 29327.0225; val_kl_reg_loss: 2279.4251; val_edge_recon_loss: 25931.5914; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28211.0165; val_optim_loss: 28211.0165
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9961; val_auprc_score: 0.9956; val_best_acc_score: 0.9729; val_best_f1_score: 0.9730; train_kl_reg_loss: 2284.4846; train_edge_recon_loss: 27047.1522; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29331.6368; train_optim_loss: 29331.6368; val_kl_reg_loss: 2264.5378; val_edge_recon_loss: 25933.3511; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28197.8890; val_optim_loss: 28197.8890
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9962; val_auprc_score: 0.9957; val_best_acc_score: 0.9731; val_best_f1_score: 0.9732; train_kl_reg_loss: 2286.0870; train_edge_recon_loss: 27036.2890; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29322.3760; train_optim_loss: 29322.3760; val_kl_reg_loss: 2257.5345; val_edge_recon_loss: 25930.4561; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28187.9907; val_optim_loss: 28187.9907
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9962; val_auprc_score: 0.9956; val_best_acc_score: 0.9734; val_best_f1_score: 0.9735; train_kl_reg_loss: 2284.8018; train_edge_recon_loss: 27036.8993; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29321.7012; train_optim_loss: 29321.7012; val_kl_reg_loss: 2251.5181; val_edge_recon_loss: 25926.4186; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28177.9368; val_optim_loss: 28177.9368
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9964; val_auprc_score: 0.9958; val_best_acc_score: 0.9737; val_best_f1_score: 0.9738; train_kl_reg_loss: 2283.7527; train_edge_recon_loss: 27035.5796; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29319.3324; train_optim_loss: 29319.3324; val_kl_reg_loss: 2236.9026; val_edge_recon_loss: 25921.3765; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28158.2790; val_optim_loss: 28158.2790
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9963; val_auprc_score: 0.9958; val_best_acc_score: 0.9732; val_best_f1_score: 0.9733; train_kl_reg_loss: 2282.1325; train_edge_recon_loss: 27043.2160; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29325.3486; train_optim_loss: 29325.3486; val_kl_reg_loss: 2277.3225; val_edge_recon_loss: 25927.7343; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28205.0569; val_optim_loss: 28205.0569
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9963; val_auprc_score: 0.9957; val_best_acc_score: 0.9738; val_best_f1_score: 0.9739; train_kl_reg_loss: 2283.2940; train_edge_recon_loss: 27036.4419; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29319.7359; train_optim_loss: 29319.7359; val_kl_reg_loss: 2260.7770; val_edge_recon_loss: 25905.0897; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28165.8667; val_optim_loss: 28165.8667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9963; val_auprc_score: 0.9955; val_best_acc_score: 0.9744; val_best_f1_score: 0.9745; train_kl_reg_loss: 2283.2483; train_edge_recon_loss: 27034.3944; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29317.6427; train_optim_loss: 29317.6427; val_kl_reg_loss: 2281.9038; val_edge_recon_loss: 25911.0620; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28192.9658; val_optim_loss: 28192.9658
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9963; val_auprc_score: 0.9956; val_best_acc_score: 0.9745; val_best_f1_score: 0.9746; train_kl_reg_loss: 2283.3914; train_edge_recon_loss: 27030.3305; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29313.7220; train_optim_loss: 29313.7220; val_kl_reg_loss: 2238.4177; val_edge_recon_loss: 25913.8730; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28152.2907; val_optim_loss: 28152.2907
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9964; val_auprc_score: 0.9959; val_best_acc_score: 0.9742; val_best_f1_score: 0.9743; train_kl_reg_loss: 2282.8880; train_edge_recon_loss: 27031.8610; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29314.7490; train_optim_loss: 29314.7490; val_kl_reg_loss: 2248.8508; val_edge_recon_loss: 25908.3614; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28157.2122; val_optim_loss: 28157.2122
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9964; val_auprc_score: 0.9959; val_best_acc_score: 0.9743; val_best_f1_score: 0.9743; train_kl_reg_loss: 2281.5216; train_edge_recon_loss: 27034.5022; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29316.0239; train_optim_loss: 29316.0239; val_kl_reg_loss: 2271.4344; val_edge_recon_loss: 25917.5338; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28188.9682; val_optim_loss: 28188.9682
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9964; val_auprc_score: 0.9959; val_best_acc_score: 0.9741; val_best_f1_score: 0.9742; train_kl_reg_loss: 2281.2014; train_edge_recon_loss: 27036.7145; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29317.9160; train_optim_loss: 29317.9160; val_kl_reg_loss: 2276.0175; val_edge_recon_loss: 25913.5537; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28189.5711; val_optim_loss: 28189.5711
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9965; val_auprc_score: 0.9961; val_best_acc_score: 0.9743; val_best_f1_score: 0.9745; train_kl_reg_loss: 2282.7137; train_edge_recon_loss: 27025.3912; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29308.1048; train_optim_loss: 29308.1048; val_kl_reg_loss: 2257.1667; val_edge_recon_loss: 25923.6635; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28180.8302; val_optim_loss: 28180.8302

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9965; val_auprc_score: 0.9960; val_best_acc_score: 0.9746; val_best_f1_score: 0.9747; train_kl_reg_loss: 2281.7256; train_edge_recon_loss: 27024.2638; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29305.9894; train_optim_loss: 29305.9894; val_kl_reg_loss: 2270.2791; val_edge_recon_loss: 25908.4829; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28178.7620; val_optim_loss: 28178.7620
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9964; val_auprc_score: 0.9959; val_best_acc_score: 0.9746; val_best_f1_score: 0.9747; train_kl_reg_loss: 2281.7220; train_edge_recon_loss: 27022.9946; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29304.7166; train_optim_loss: 29304.7166; val_kl_reg_loss: 2265.4928; val_edge_recon_loss: 25911.9846; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28177.4774; val_optim_loss: 28177.4774
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9965; val_auprc_score: 0.9961; val_best_acc_score: 0.9746; val_best_f1_score: 0.9747; train_kl_reg_loss: 2281.2289; train_edge_recon_loss: 27025.5678; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29306.7968; train_optim_loss: 29306.7968; val_kl_reg_loss: 2258.1208; val_edge_recon_loss: 25910.0588; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28168.1797; val_optim_loss: 28168.1797
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9962; val_auprc_score: 0.9956; val_best_acc_score: 0.9742; val_best_f1_score: 0.9743; train_kl_reg_loss: 2282.0137; train_edge_recon_loss: 27021.3033; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29303.3170; train_optim_loss: 29303.3170; val_kl_reg_loss: 2260.7777; val_edge_recon_loss: 25895.1708; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28155.9484; val_optim_loss: 28155.9484

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 130 min 55 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9964
Val AUPRC score: 0.9959
Val best accuracy score: 0.9742
Val best F1 score: 0.9743
Val gene expr MSE score: 14.6428

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
