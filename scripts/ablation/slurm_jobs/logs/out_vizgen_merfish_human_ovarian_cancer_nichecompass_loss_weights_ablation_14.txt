None
Run timestamp: 05072023_001358_14.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_14']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9892; val_auprc_score: 0.9885; val_best_acc_score: 0.9491; val_best_f1_score: 0.9494; train_kl_reg_loss: 2144.9994; train_edge_recon_loss: 27775.9361; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29920.9355; train_optim_loss: 29920.9355; val_kl_reg_loss: 2188.1017; val_edge_recon_loss: 26203.3596; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28391.4612; val_optim_loss: 28391.4612
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9916; val_auprc_score: 0.9910; val_best_acc_score: 0.9559; val_best_f1_score: 0.9561; train_kl_reg_loss: 2260.1931; train_edge_recon_loss: 27287.0648; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29547.2579; train_optim_loss: 29547.2579; val_kl_reg_loss: 2273.8545; val_edge_recon_loss: 26121.1712; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28395.0257; val_optim_loss: 28395.0257
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9929; val_auprc_score: 0.9922; val_best_acc_score: 0.9606; val_best_f1_score: 0.9608; train_kl_reg_loss: 2274.6579; train_edge_recon_loss: 27223.5253; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29498.1833; train_optim_loss: 29498.1833; val_kl_reg_loss: 2325.8537; val_edge_recon_loss: 26070.7673; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28396.6210; val_optim_loss: 28396.6210
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9937; val_auprc_score: 0.9932; val_best_acc_score: 0.9636; val_best_f1_score: 0.9637; train_kl_reg_loss: 2279.9582; train_edge_recon_loss: 27186.4606; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29466.4187; train_optim_loss: 29466.4187; val_kl_reg_loss: 2275.5601; val_edge_recon_loss: 26035.9665; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28311.5266; val_optim_loss: 28311.5266
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9944; val_auprc_score: 0.9937; val_best_acc_score: 0.9661; val_best_f1_score: 0.9663; train_kl_reg_loss: 2284.0761; train_edge_recon_loss: 27156.2906; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29440.3666; train_optim_loss: 29440.3666; val_kl_reg_loss: 2312.4374; val_edge_recon_loss: 26026.6732; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28339.1106; val_optim_loss: 28339.1106
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9944; val_auprc_score: 0.9939; val_best_acc_score: 0.9654; val_best_f1_score: 0.9655; train_kl_reg_loss: 2285.9682; train_edge_recon_loss: 27147.4915; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29433.4597; train_optim_loss: 29433.4597; val_kl_reg_loss: 2292.5584; val_edge_recon_loss: 26016.3926; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28308.9510; val_optim_loss: 28308.9510
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9948; val_auprc_score: 0.9938; val_best_acc_score: 0.9693; val_best_f1_score: 0.9695; train_kl_reg_loss: 2288.5885; train_edge_recon_loss: 27124.8798; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29413.4683; train_optim_loss: 29413.4683; val_kl_reg_loss: 2285.6933; val_edge_recon_loss: 26013.7111; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28299.4045; val_optim_loss: 28299.4045
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9952; val_auprc_score: 0.9946; val_best_acc_score: 0.9693; val_best_f1_score: 0.9694; train_kl_reg_loss: 2292.2850; train_edge_recon_loss: 27104.6717; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29396.9567; train_optim_loss: 29396.9567; val_kl_reg_loss: 2360.4917; val_edge_recon_loss: 26018.9047; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28379.3964; val_optim_loss: 28379.3964
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9953; val_auprc_score: 0.9947; val_best_acc_score: 0.9704; val_best_f1_score: 0.9706; train_kl_reg_loss: 2293.6325; train_edge_recon_loss: 27096.3289; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29389.9614; train_optim_loss: 29389.9614; val_kl_reg_loss: 2255.9521; val_edge_recon_loss: 25974.6486; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28230.6006; val_optim_loss: 28230.6006
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9957; val_auprc_score: 0.9951; val_best_acc_score: 0.9709; val_best_f1_score: 0.9710; train_kl_reg_loss: 2294.7690; train_edge_recon_loss: 27081.2819; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29376.0509; train_optim_loss: 29376.0509; val_kl_reg_loss: 2302.1837; val_edge_recon_loss: 25976.7709; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28278.9546; val_optim_loss: 28278.9546
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9960; val_auprc_score: 0.9954; val_best_acc_score: 0.9729; val_best_f1_score: 0.9730; train_kl_reg_loss: 2294.1300; train_edge_recon_loss: 27082.5443; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29376.6743; train_optim_loss: 29376.6743; val_kl_reg_loss: 2262.3235; val_edge_recon_loss: 25951.1381; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28213.4616; val_optim_loss: 28213.4616
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9959; val_auprc_score: 0.9953; val_best_acc_score: 0.9720; val_best_f1_score: 0.9722; train_kl_reg_loss: 2294.9203; train_edge_recon_loss: 27070.9365; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29365.8567; train_optim_loss: 29365.8567; val_kl_reg_loss: 2253.0485; val_edge_recon_loss: 25938.6202; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28191.6687; val_optim_loss: 28191.6687
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9962; val_auprc_score: 0.9956; val_best_acc_score: 0.9742; val_best_f1_score: 0.9743; train_kl_reg_loss: 2296.7448; train_edge_recon_loss: 27056.5495; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29353.2944; train_optim_loss: 29353.2944; val_kl_reg_loss: 2276.5515; val_edge_recon_loss: 25937.0475; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28213.5990; val_optim_loss: 28213.5990
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9962; val_auprc_score: 0.9955; val_best_acc_score: 0.9731; val_best_f1_score: 0.9732; train_kl_reg_loss: 2296.4876; train_edge_recon_loss: 27057.2384; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29353.7260; train_optim_loss: 29353.7260; val_kl_reg_loss: 2306.9829; val_edge_recon_loss: 25932.5605; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28239.5434; val_optim_loss: 28239.5434
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9964; val_auprc_score: 0.9959; val_best_acc_score: 0.9743; val_best_f1_score: 0.9744; train_kl_reg_loss: 2297.6006; train_edge_recon_loss: 27047.8635; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29345.4641; train_optim_loss: 29345.4641; val_kl_reg_loss: 2336.1649; val_edge_recon_loss: 25928.7101; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28264.8750; val_optim_loss: 28264.8750
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9963; val_auprc_score: 0.9958; val_best_acc_score: 0.9742; val_best_f1_score: 0.9742; train_kl_reg_loss: 2298.1792; train_edge_recon_loss: 27044.1362; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29342.3154; train_optim_loss: 29342.3154; val_kl_reg_loss: 2252.9074; val_edge_recon_loss: 25923.8284; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28176.7358; val_optim_loss: 28176.7358
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9965; val_auprc_score: 0.9959; val_best_acc_score: 0.9758; val_best_f1_score: 0.9759; train_kl_reg_loss: 2298.7946; train_edge_recon_loss: 27041.9331; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29340.7276; train_optim_loss: 29340.7276; val_kl_reg_loss: 2310.8751; val_edge_recon_loss: 25915.7428; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28226.6178; val_optim_loss: 28226.6178
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9965; val_auprc_score: 0.9959; val_best_acc_score: 0.9755; val_best_f1_score: 0.9757; train_kl_reg_loss: 2299.2300; train_edge_recon_loss: 27036.4055; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29335.6355; train_optim_loss: 29335.6355; val_kl_reg_loss: 2266.1422; val_edge_recon_loss: 25900.4963; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28166.6385; val_optim_loss: 28166.6385
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9965; val_auprc_score: 0.9960; val_best_acc_score: 0.9754; val_best_f1_score: 0.9755; train_kl_reg_loss: 2299.8293; train_edge_recon_loss: 27027.8240; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29327.6533; train_optim_loss: 29327.6533; val_kl_reg_loss: 2315.8796; val_edge_recon_loss: 25923.7273; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28239.6069; val_optim_loss: 28239.6069
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9967; val_auprc_score: 0.9961; val_best_acc_score: 0.9755; val_best_f1_score: 0.9756; train_kl_reg_loss: 2300.1631; train_edge_recon_loss: 27025.4115; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29325.5747; train_optim_loss: 29325.5747; val_kl_reg_loss: 2307.0084; val_edge_recon_loss: 25915.0247; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28222.0331; val_optim_loss: 28222.0331
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9966; val_auprc_score: 0.9960; val_best_acc_score: 0.9760; val_best_f1_score: 0.9761; train_kl_reg_loss: 2302.0749; train_edge_recon_loss: 27015.2753; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29317.3502; train_optim_loss: 29317.3502; val_kl_reg_loss: 2207.5112; val_edge_recon_loss: 25892.2071; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28099.7182; val_optim_loss: 28099.7182
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9966; val_auprc_score: 0.9961; val_best_acc_score: 0.9753; val_best_f1_score: 0.9754; train_kl_reg_loss: 2300.6418; train_edge_recon_loss: 27020.9615; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29321.6033; train_optim_loss: 29321.6033; val_kl_reg_loss: 2308.9505; val_edge_recon_loss: 25912.1941; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28221.1447; val_optim_loss: 28221.1447
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9967; val_auprc_score: 0.9962; val_best_acc_score: 0.9763; val_best_f1_score: 0.9764; train_kl_reg_loss: 2301.7866; train_edge_recon_loss: 27012.1491; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29313.9356; train_optim_loss: 29313.9356; val_kl_reg_loss: 2337.2921; val_edge_recon_loss: 25891.2308; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28228.5230; val_optim_loss: 28228.5230
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9968; val_auprc_score: 0.9963; val_best_acc_score: 0.9770; val_best_f1_score: 0.9770; train_kl_reg_loss: 2301.7757; train_edge_recon_loss: 27008.6558; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29310.4315; train_optim_loss: 29310.4315; val_kl_reg_loss: 2304.4121; val_edge_recon_loss: 25901.1869; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28205.5991; val_optim_loss: 28205.5991
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9967; val_auprc_score: 0.9960; val_best_acc_score: 0.9762; val_best_f1_score: 0.9763; train_kl_reg_loss: 2301.9262; train_edge_recon_loss: 27009.4719; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29311.3982; train_optim_loss: 29311.3982; val_kl_reg_loss: 2341.9862; val_edge_recon_loss: 25875.1746; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28217.1608; val_optim_loss: 28217.1608

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9972; val_auprc_score: 0.9969; val_best_acc_score: 0.9788; val_best_f1_score: 0.9788; train_kl_reg_loss: 2297.6532; train_edge_recon_loss: 26972.1055; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29269.7588; train_optim_loss: 29269.7588; val_kl_reg_loss: 2287.1489; val_edge_recon_loss: 25839.4335; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28126.5824; val_optim_loss: 28126.5824
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9973; val_auprc_score: 0.9968; val_best_acc_score: 0.9789; val_best_f1_score: 0.9790; train_kl_reg_loss: 2297.0706; train_edge_recon_loss: 26964.5263; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29261.5969; train_optim_loss: 29261.5969; val_kl_reg_loss: 2289.5313; val_edge_recon_loss: 25847.7550; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28137.2862; val_optim_loss: 28137.2862
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9973; val_auprc_score: 0.9967; val_best_acc_score: 0.9791; val_best_f1_score: 0.9791; train_kl_reg_loss: 2296.0773; train_edge_recon_loss: 26960.8330; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29256.9103; train_optim_loss: 29256.9103; val_kl_reg_loss: 2296.3083; val_edge_recon_loss: 25843.4146; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28139.7230; val_optim_loss: 28139.7230
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9973; val_auprc_score: 0.9966; val_best_acc_score: 0.9793; val_best_f1_score: 0.9794; train_kl_reg_loss: 2295.0483; train_edge_recon_loss: 26967.5456; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29262.5939; train_optim_loss: 29262.5939; val_kl_reg_loss: 2290.2488; val_edge_recon_loss: 25836.6994; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28126.9482; val_optim_loss: 28126.9482

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 200 min 13 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9966
Val AUPRC score: 0.9961
Val best accuracy score: 0.9758
Val best F1 score: 0.9759
Val gene expr MSE score: 14.0468

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
