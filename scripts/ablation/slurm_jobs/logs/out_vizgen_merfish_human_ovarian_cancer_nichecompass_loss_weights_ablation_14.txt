None
Run timestamp: 30062023_212447_14.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_14']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9868; val_auprc_score: 0.9859; val_best_acc_score: 0.9436; val_best_f1_score: 0.9439; train_kl_reg_loss: 2097.0867; train_edge_recon_loss: 27953.3215; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30050.4083; train_optim_loss: 30050.4083; val_kl_reg_loss: 2213.4695; val_edge_recon_loss: 26321.5616; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28535.0311; val_optim_loss: 28535.0311
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9897; val_auprc_score: 0.9892; val_best_acc_score: 0.9509; val_best_f1_score: 0.9511; train_kl_reg_loss: 2246.7396; train_edge_recon_loss: 27318.0451; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29564.7847; train_optim_loss: 29564.7847; val_kl_reg_loss: 2222.2372; val_edge_recon_loss: 26183.9338; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28406.1711; val_optim_loss: 28406.1711
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9920; val_auprc_score: 0.9915; val_best_acc_score: 0.9577; val_best_f1_score: 0.9579; train_kl_reg_loss: 2258.0524; train_edge_recon_loss: 27257.1457; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29515.1981; train_optim_loss: 29515.1981; val_kl_reg_loss: 2248.5152; val_edge_recon_loss: 26106.5603; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28355.0754; val_optim_loss: 28355.0754
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9928; val_auprc_score: 0.9922; val_best_acc_score: 0.9599; val_best_f1_score: 0.9600; train_kl_reg_loss: 2268.8609; train_edge_recon_loss: 27209.6118; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29478.4727; train_optim_loss: 29478.4727; val_kl_reg_loss: 2170.7434; val_edge_recon_loss: 26090.9134; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28261.6569; val_optim_loss: 28261.6569
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9936; val_auprc_score: 0.9931; val_best_acc_score: 0.9624; val_best_f1_score: 0.9624; train_kl_reg_loss: 2272.9136; train_edge_recon_loss: 27189.1024; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29462.0159; train_optim_loss: 29462.0159; val_kl_reg_loss: 2232.7844; val_edge_recon_loss: 26078.1328; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28310.9172; val_optim_loss: 28310.9172
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9941; val_auprc_score: 0.9936; val_best_acc_score: 0.9647; val_best_f1_score: 0.9646; train_kl_reg_loss: 2275.7579; train_edge_recon_loss: 27168.3253; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29444.0832; train_optim_loss: 29444.0832; val_kl_reg_loss: 2317.7515; val_edge_recon_loss: 26058.4516; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28376.2031; val_optim_loss: 28376.2031
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9944; val_auprc_score: 0.9938; val_best_acc_score: 0.9660; val_best_f1_score: 0.9661; train_kl_reg_loss: 2280.0691; train_edge_recon_loss: 27141.4741; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29421.5433; train_optim_loss: 29421.5433; val_kl_reg_loss: 2230.0984; val_edge_recon_loss: 26045.4729; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28275.5711; val_optim_loss: 28275.5711
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9951; val_auprc_score: 0.9946; val_best_acc_score: 0.9689; val_best_f1_score: 0.9690; train_kl_reg_loss: 2281.9910; train_edge_recon_loss: 27130.5230; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29412.5141; train_optim_loss: 29412.5141; val_kl_reg_loss: 2259.2640; val_edge_recon_loss: 26013.2240; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28272.4879; val_optim_loss: 28272.4879

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9954; val_auprc_score: 0.9948; val_best_acc_score: 0.9700; val_best_f1_score: 0.9701; train_kl_reg_loss: 2280.5749; train_edge_recon_loss: 27088.6486; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29369.2235; train_optim_loss: 29369.2235; val_kl_reg_loss: 2264.5740; val_edge_recon_loss: 25970.2758; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28234.8498; val_optim_loss: 28234.8498
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9952; val_auprc_score: 0.9945; val_best_acc_score: 0.9696; val_best_f1_score: 0.9697; train_kl_reg_loss: 2282.1508; train_edge_recon_loss: 27074.9041; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29357.0550; train_optim_loss: 29357.0550; val_kl_reg_loss: 2240.7999; val_edge_recon_loss: 25976.1967; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28216.9966; val_optim_loss: 28216.9966
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9953; val_auprc_score: 0.9946; val_best_acc_score: 0.9704; val_best_f1_score: 0.9705; train_kl_reg_loss: 2278.9400; train_edge_recon_loss: 27080.3306; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29359.2706; train_optim_loss: 29359.2706; val_kl_reg_loss: 2250.8329; val_edge_recon_loss: 25967.6212; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28218.4542; val_optim_loss: 28218.4542
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9953; val_auprc_score: 0.9946; val_best_acc_score: 0.9708; val_best_f1_score: 0.9709; train_kl_reg_loss: 2278.3107; train_edge_recon_loss: 27077.2747; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29355.5854; train_optim_loss: 29355.5854; val_kl_reg_loss: 2265.5154; val_edge_recon_loss: 25953.8548; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28219.3702; val_optim_loss: 28219.3702
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9955; val_auprc_score: 0.9949; val_best_acc_score: 0.9711; val_best_f1_score: 0.9712; train_kl_reg_loss: 2278.3357; train_edge_recon_loss: 27077.0387; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29355.3744; train_optim_loss: 29355.3744; val_kl_reg_loss: 2249.4783; val_edge_recon_loss: 25962.7902; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28212.2686; val_optim_loss: 28212.2686
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9956; val_auprc_score: 0.9950; val_best_acc_score: 0.9712; val_best_f1_score: 0.9713; train_kl_reg_loss: 2278.9642; train_edge_recon_loss: 27069.4076; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29348.3718; train_optim_loss: 29348.3718; val_kl_reg_loss: 2248.9621; val_edge_recon_loss: 25971.6725; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28220.6345; val_optim_loss: 28220.6345
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9958; val_auprc_score: 0.9950; val_best_acc_score: 0.9716; val_best_f1_score: 0.9717; train_kl_reg_loss: 2278.8529; train_edge_recon_loss: 27067.1592; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29346.0121; train_optim_loss: 29346.0121; val_kl_reg_loss: 2246.5586; val_edge_recon_loss: 25941.8391; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28188.3975; val_optim_loss: 28188.3975
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9955; val_auprc_score: 0.9949; val_best_acc_score: 0.9711; val_best_f1_score: 0.9712; train_kl_reg_loss: 2278.3660; train_edge_recon_loss: 27070.8587; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29349.2247; train_optim_loss: 29349.2247; val_kl_reg_loss: 2279.4095; val_edge_recon_loss: 25961.4758; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28240.8854; val_optim_loss: 28240.8854
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9957; val_auprc_score: 0.9952; val_best_acc_score: 0.9713; val_best_f1_score: 0.9714; train_kl_reg_loss: 2278.4210; train_edge_recon_loss: 27067.2021; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29345.6231; train_optim_loss: 29345.6231; val_kl_reg_loss: 2240.7540; val_edge_recon_loss: 25963.7667; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28204.5207; val_optim_loss: 28204.5207
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9959; val_auprc_score: 0.9954; val_best_acc_score: 0.9719; val_best_f1_score: 0.9720; train_kl_reg_loss: 2278.9023; train_edge_recon_loss: 27059.1403; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29338.0426; train_optim_loss: 29338.0426; val_kl_reg_loss: 2261.6942; val_edge_recon_loss: 25968.4466; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28230.1406; val_optim_loss: 28230.1406
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9957; val_auprc_score: 0.9950; val_best_acc_score: 0.9721; val_best_f1_score: 0.9722; train_kl_reg_loss: 2278.8343; train_edge_recon_loss: 27061.1091; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29339.9434; train_optim_loss: 29339.9434; val_kl_reg_loss: 2250.6649; val_edge_recon_loss: 25961.0681; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28211.7330; val_optim_loss: 28211.7330

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9958; val_auprc_score: 0.9951; val_best_acc_score: 0.9723; val_best_f1_score: 0.9723; train_kl_reg_loss: 2277.7411; train_edge_recon_loss: 27060.7665; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29338.5076; train_optim_loss: 29338.5076; val_kl_reg_loss: 2250.1163; val_edge_recon_loss: 25944.8715; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28194.9877; val_optim_loss: 28194.9877
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9959; val_auprc_score: 0.9952; val_best_acc_score: 0.9722; val_best_f1_score: 0.9723; train_kl_reg_loss: 2279.8332; train_edge_recon_loss: 27048.5113; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29328.3445; train_optim_loss: 29328.3445; val_kl_reg_loss: 2243.3340; val_edge_recon_loss: 25927.0589; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28170.3929; val_optim_loss: 28170.3929
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9958; val_auprc_score: 0.9954; val_best_acc_score: 0.9722; val_best_f1_score: 0.9723; train_kl_reg_loss: 2279.0067; train_edge_recon_loss: 27047.7823; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29326.7890; train_optim_loss: 29326.7890; val_kl_reg_loss: 2250.7212; val_edge_recon_loss: 25950.6640; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28201.3852; val_optim_loss: 28201.3852
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9959; val_auprc_score: 0.9953; val_best_acc_score: 0.9724; val_best_f1_score: 0.9725; train_kl_reg_loss: 2277.7961; train_edge_recon_loss: 27055.1541; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29332.9502; train_optim_loss: 29332.9502; val_kl_reg_loss: 2252.1074; val_edge_recon_loss: 25949.1078; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28201.2153; val_optim_loss: 28201.2153
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9961; val_auprc_score: 0.9956; val_best_acc_score: 0.9727; val_best_f1_score: 0.9728; train_kl_reg_loss: 2277.9203; train_edge_recon_loss: 27055.3169; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29333.2372; train_optim_loss: 29333.2372; val_kl_reg_loss: 2252.3817; val_edge_recon_loss: 25921.3074; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28173.6891; val_optim_loss: 28173.6891
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9959; val_auprc_score: 0.9953; val_best_acc_score: 0.9723; val_best_f1_score: 0.9724; train_kl_reg_loss: 2277.4470; train_edge_recon_loss: 27055.1849; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29332.6319; train_optim_loss: 29332.6319; val_kl_reg_loss: 2249.4043; val_edge_recon_loss: 25960.2094; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28209.6138; val_optim_loss: 28209.6138

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9958; val_auprc_score: 0.9952; val_best_acc_score: 0.9723; val_best_f1_score: 0.9724; train_kl_reg_loss: 2277.0117; train_edge_recon_loss: 27059.9860; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29336.9977; train_optim_loss: 29336.9977; val_kl_reg_loss: 2255.2963; val_edge_recon_loss: 25943.1214; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28198.4177; val_optim_loss: 28198.4177
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9960; val_auprc_score: 0.9955; val_best_acc_score: 0.9722; val_best_f1_score: 0.9723; train_kl_reg_loss: 2278.7705; train_edge_recon_loss: 27054.5278; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29333.2983; train_optim_loss: 29333.2983; val_kl_reg_loss: 2251.3671; val_edge_recon_loss: 25925.4878; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28176.8547; val_optim_loss: 28176.8547
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9959; val_auprc_score: 0.9953; val_best_acc_score: 0.9723; val_best_f1_score: 0.9724; train_kl_reg_loss: 2277.9397; train_edge_recon_loss: 27056.5971; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29334.5369; train_optim_loss: 29334.5369; val_kl_reg_loss: 2251.6746; val_edge_recon_loss: 25950.3785; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28202.0531; val_optim_loss: 28202.0531
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9960; val_auprc_score: 0.9955; val_best_acc_score: 0.9723; val_best_f1_score: 0.9724; train_kl_reg_loss: 2278.9146; train_edge_recon_loss: 27049.4021; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29328.3167; train_optim_loss: 29328.3167; val_kl_reg_loss: 2254.6671; val_edge_recon_loss: 25960.0129; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28214.6800; val_optim_loss: 28214.6800

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 170 min 46 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9959
Val AUPRC score: 0.9952
Val best accuracy score: 0.9721
Val best F1 score: 0.9722
Val gene expr MSE score: 14.3390

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
