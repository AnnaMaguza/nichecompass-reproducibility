None
Run timestamp: 01072023_182929_10.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_10']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9563; val_auprc_score: 0.9536; val_best_acc_score: 0.8880; val_best_f1_score: 0.8894; train_kl_reg_loss: 2757.8977; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 72234.3943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 74992.2919; train_optim_loss: 74992.2919; val_kl_reg_loss: 2034.0286; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 66732.0229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 68766.0515; val_optim_loss: 68766.0515
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9654; val_auprc_score: 0.9646; val_best_acc_score: 0.9011; val_best_f1_score: 0.9012; train_kl_reg_loss: 1830.2046; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 65835.9291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 67666.1337; train_optim_loss: 67666.1337; val_kl_reg_loss: 1675.0567; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64442.7766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66117.8333; val_optim_loss: 66117.8333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9692; val_auprc_score: 0.9690; val_best_acc_score: 0.9056; val_best_f1_score: 0.9069; train_kl_reg_loss: 1645.5891; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64191.6375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65837.2266; train_optim_loss: 65837.2266; val_kl_reg_loss: 1570.2599; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 63423.8474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 64994.1076; val_optim_loss: 64994.1076
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9697; val_auprc_score: 0.9698; val_best_acc_score: 0.9071; val_best_f1_score: 0.9078; train_kl_reg_loss: 1567.5638; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 63496.0642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65063.6280; train_optim_loss: 65063.6280; val_kl_reg_loss: 1513.7398; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 62867.3152; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 64381.0549; val_optim_loss: 64381.0549
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9715; val_auprc_score: 0.9712; val_best_acc_score: 0.9109; val_best_f1_score: 0.9117; train_kl_reg_loss: 1525.7495; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 63080.8809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 64606.6305; train_optim_loss: 64606.6305; val_kl_reg_loss: 1464.4953; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 62672.3341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 64136.8292; val_optim_loss: 64136.8292
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9725; val_auprc_score: 0.9726; val_best_acc_score: 0.9112; val_best_f1_score: 0.9125; train_kl_reg_loss: 1499.1165; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 62832.2954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 64331.4119; train_optim_loss: 64331.4119; val_kl_reg_loss: 1444.4694; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 62453.3913; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 63897.8606; val_optim_loss: 63897.8606
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9725; val_auprc_score: 0.9726; val_best_acc_score: 0.9135; val_best_f1_score: 0.9136; train_kl_reg_loss: 1481.6398; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 62625.0351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 64106.6749; train_optim_loss: 64106.6749; val_kl_reg_loss: 1436.5390; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 62419.6952; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 63856.2340; val_optim_loss: 63856.2340
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9732; val_auprc_score: 0.9736; val_best_acc_score: 0.9135; val_best_f1_score: 0.9130; train_kl_reg_loss: 1468.4711; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 62471.5812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 63940.0523; train_optim_loss: 63940.0523; val_kl_reg_loss: 1422.5630; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 62445.9038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 63868.4669; val_optim_loss: 63868.4669
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9740; val_auprc_score: 0.9740; val_best_acc_score: 0.9153; val_best_f1_score: 0.9149; train_kl_reg_loss: 1458.7991; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 62360.9565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 63819.7556; train_optim_loss: 63819.7556; val_kl_reg_loss: 1429.0525; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 62158.0903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 63587.1428; val_optim_loss: 63587.1428
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9765; val_auprc_score: 0.9766; val_best_acc_score: 0.9183; val_best_f1_score: 0.9194; train_kl_reg_loss: 1450.7635; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 62312.8361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 63763.5996; train_optim_loss: 63763.5996; val_kl_reg_loss: 1422.1973; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 62086.1082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 63508.3054; val_optim_loss: 63508.3054
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9754; val_auprc_score: 0.9760; val_best_acc_score: 0.9177; val_best_f1_score: 0.9175; train_kl_reg_loss: 1443.4526; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 62239.1638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 63682.6165; train_optim_loss: 63682.6165; val_kl_reg_loss: 1390.7862; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 62100.2380; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 63491.0243; val_optim_loss: 63491.0243
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9777; val_auprc_score: 0.9781; val_best_acc_score: 0.9211; val_best_f1_score: 0.9209; train_kl_reg_loss: 1437.5309; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 62153.5169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 63591.0477; train_optim_loss: 63591.0477; val_kl_reg_loss: 1391.7294; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61934.9171; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 63326.6465; val_optim_loss: 63326.6465
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9758; val_auprc_score: 0.9760; val_best_acc_score: 0.9185; val_best_f1_score: 0.9182; train_kl_reg_loss: 1432.6167; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 62120.1789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 63552.7956; train_optim_loss: 63552.7956; val_kl_reg_loss: 1390.5416; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 62029.5657; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 63420.1073; val_optim_loss: 63420.1073
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9774; val_auprc_score: 0.9778; val_best_acc_score: 0.9200; val_best_f1_score: 0.9199; train_kl_reg_loss: 1426.8875; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 62080.8436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 63507.7311; train_optim_loss: 63507.7311; val_kl_reg_loss: 1401.9505; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61866.5214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 63268.4718; val_optim_loss: 63268.4718
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9784; val_auprc_score: 0.9789; val_best_acc_score: 0.9216; val_best_f1_score: 0.9226; train_kl_reg_loss: 1421.3065; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 62049.6734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 63470.9798; train_optim_loss: 63470.9798; val_kl_reg_loss: 1406.3046; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 62090.1064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 63496.4111; val_optim_loss: 63496.4111
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9771; val_auprc_score: 0.9775; val_best_acc_score: 0.9200; val_best_f1_score: 0.9206; train_kl_reg_loss: 1416.0463; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 62002.6781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 63418.7244; train_optim_loss: 63418.7244; val_kl_reg_loss: 1400.1526; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61947.3155; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 63347.4683; val_optim_loss: 63347.4683
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9765; val_auprc_score: 0.9767; val_best_acc_score: 0.9195; val_best_f1_score: 0.9193; train_kl_reg_loss: 1410.9867; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 61942.5884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 63353.5751; train_optim_loss: 63353.5751; val_kl_reg_loss: 1360.2092; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61927.7606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 63287.9696; val_optim_loss: 63287.9696
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9779; val_auprc_score: 0.9783; val_best_acc_score: 0.9212; val_best_f1_score: 0.9211; train_kl_reg_loss: 1406.9016; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 61944.7338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 63351.6354; train_optim_loss: 63351.6354; val_kl_reg_loss: 1391.5883; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61885.1694; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 63276.7577; val_optim_loss: 63276.7577

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9781; val_auprc_score: 0.9785; val_best_acc_score: 0.9221; val_best_f1_score: 0.9213; train_kl_reg_loss: 1395.0206; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 61558.8025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 62953.8231; train_optim_loss: 62953.8231; val_kl_reg_loss: 1373.4163; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61682.6270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 63056.0432; val_optim_loss: 63056.0432
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9782; val_auprc_score: 0.9786; val_best_acc_score: 0.9216; val_best_f1_score: 0.9224; train_kl_reg_loss: 1390.4200; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 61525.1354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 62915.5553; train_optim_loss: 62915.5553; val_kl_reg_loss: 1371.4604; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61600.9935; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 62972.4538; val_optim_loss: 62972.4538
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9784; val_auprc_score: 0.9789; val_best_acc_score: 0.9215; val_best_f1_score: 0.9225; train_kl_reg_loss: 1389.2386; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 61508.3451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 62897.5837; train_optim_loss: 62897.5837; val_kl_reg_loss: 1369.6900; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61597.7311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 62967.4212; val_optim_loss: 62967.4212
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9788; val_auprc_score: 0.9793; val_best_acc_score: 0.9225; val_best_f1_score: 0.9233; train_kl_reg_loss: 1387.8733; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 61499.1971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 62887.0703; train_optim_loss: 62887.0703; val_kl_reg_loss: 1365.5786; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61616.1404; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 62981.7191; val_optim_loss: 62981.7191
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9787; val_auprc_score: 0.9790; val_best_acc_score: 0.9225; val_best_f1_score: 0.9232; train_kl_reg_loss: 1385.7592; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 61519.9210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 62905.6802; train_optim_loss: 62905.6802; val_kl_reg_loss: 1364.0015; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61544.9202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 62908.9218; val_optim_loss: 62908.9218
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9789; val_auprc_score: 0.9795; val_best_acc_score: 0.9231; val_best_f1_score: 0.9237; train_kl_reg_loss: 1386.2596; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 61462.5222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 62848.7818; train_optim_loss: 62848.7818; val_kl_reg_loss: 1358.0701; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61518.6364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 62876.7065; val_optim_loss: 62876.7065
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9785; val_auprc_score: 0.9790; val_best_acc_score: 0.9227; val_best_f1_score: 0.9233; train_kl_reg_loss: 1384.5049; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 61464.6704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 62849.1754; train_optim_loss: 62849.1754; val_kl_reg_loss: 1368.3279; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61464.7568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 62833.0844; val_optim_loss: 62833.0844
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9782; val_auprc_score: 0.9786; val_best_acc_score: 0.9222; val_best_f1_score: 0.9226; train_kl_reg_loss: 1384.4971; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 61488.0603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 62872.5574; train_optim_loss: 62872.5574; val_kl_reg_loss: 1362.7550; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61590.1809; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 62952.9360; val_optim_loss: 62952.9360
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9790; val_auprc_score: 0.9794; val_best_acc_score: 0.9239; val_best_f1_score: 0.9243; train_kl_reg_loss: 1383.2473; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 61463.2581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 62846.5054; train_optim_loss: 62846.5054; val_kl_reg_loss: 1368.3498; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61620.3710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 62988.7206; val_optim_loss: 62988.7206
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9791; val_auprc_score: 0.9796; val_best_acc_score: 0.9238; val_best_f1_score: 0.9242; train_kl_reg_loss: 1382.9692; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 61442.4952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 62825.4645; train_optim_loss: 62825.4645; val_kl_reg_loss: 1364.4919; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61560.3630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 62924.8550; val_optim_loss: 62924.8550
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9791; val_auprc_score: 0.9793; val_best_acc_score: 0.9246; val_best_f1_score: 0.9249; train_kl_reg_loss: 1381.6540; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 61427.3670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 62809.0210; train_optim_loss: 62809.0210; val_kl_reg_loss: 1357.6138; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61565.0306; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 62922.6444; val_optim_loss: 62922.6444

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9790; val_auprc_score: 0.9795; val_best_acc_score: 0.9236; val_best_f1_score: 0.9239; train_kl_reg_loss: 1380.7642; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 61411.3583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 62792.1224; train_optim_loss: 62792.1224; val_kl_reg_loss: 1359.1232; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61557.1530; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 62916.2761; val_optim_loss: 62916.2761
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9789; val_auprc_score: 0.9793; val_best_acc_score: 0.9240; val_best_f1_score: 0.9242; train_kl_reg_loss: 1380.2209; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 61428.6087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 62808.8296; train_optim_loss: 62808.8296; val_kl_reg_loss: 1360.6747; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61410.4851; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 62771.1597; val_optim_loss: 62771.1597
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9788; val_auprc_score: 0.9793; val_best_acc_score: 0.9232; val_best_f1_score: 0.9235; train_kl_reg_loss: 1380.3236; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 61384.0584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 62764.3820; train_optim_loss: 62764.3820; val_kl_reg_loss: 1360.5944; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61487.6162; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 62848.2104; val_optim_loss: 62848.2104
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9792; val_auprc_score: 0.9797; val_best_acc_score: 0.9241; val_best_f1_score: 0.9243; train_kl_reg_loss: 1380.8499; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 61387.4742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 62768.3241; train_optim_loss: 62768.3241; val_kl_reg_loss: 1361.1749; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61510.9907; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 62872.1657; val_optim_loss: 62872.1657
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9793; val_auprc_score: 0.9799; val_best_acc_score: 0.9244; val_best_f1_score: 0.9246; train_kl_reg_loss: 1380.9159; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 61420.4705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 62801.3864; train_optim_loss: 62801.3864; val_kl_reg_loss: 1361.8328; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61576.2531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 62938.0859; val_optim_loss: 62938.0859
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9790; val_auprc_score: 0.9793; val_best_acc_score: 0.9240; val_best_f1_score: 0.9242; train_kl_reg_loss: 1380.4303; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 61391.6783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 62772.1085; train_optim_loss: 62772.1085; val_kl_reg_loss: 1359.9205; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61486.8435; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 62846.7640; val_optim_loss: 62846.7640

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9795; val_auprc_score: 0.9802; val_best_acc_score: 0.9250; val_best_f1_score: 0.9251; train_kl_reg_loss: 1380.5078; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 61391.8329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 62772.3407; train_optim_loss: 62772.3407; val_kl_reg_loss: 1360.6038; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61595.3994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 62956.0032; val_optim_loss: 62956.0032
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9792; val_auprc_score: 0.9798; val_best_acc_score: 0.9238; val_best_f1_score: 0.9240; train_kl_reg_loss: 1380.5042; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 61390.4564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 62770.9606; train_optim_loss: 62770.9606; val_kl_reg_loss: 1360.3700; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61530.1408; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 62890.5108; val_optim_loss: 62890.5108
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9789; val_auprc_score: 0.9795; val_best_acc_score: 0.9232; val_best_f1_score: 0.9235; train_kl_reg_loss: 1380.3252; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 61398.4711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 62778.7963; train_optim_loss: 62778.7963; val_kl_reg_loss: 1360.2371; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61462.2107; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 62822.4480; val_optim_loss: 62822.4480
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9787; val_auprc_score: 0.9792; val_best_acc_score: 0.9233; val_best_f1_score: 0.9235; train_kl_reg_loss: 1380.2965; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 61395.1307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 62775.4272; train_optim_loss: 62775.4272; val_kl_reg_loss: 1360.3401; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61489.2563; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 62849.5966; val_optim_loss: 62849.5966

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 179 min 4 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9793
Val AUPRC score: 0.9799
Val best accuracy score: 0.9244
Val best F1 score: 0.9246
Val gene expr MSE score: 1.4556

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
