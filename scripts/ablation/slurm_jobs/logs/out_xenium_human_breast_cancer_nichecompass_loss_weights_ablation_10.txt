None
Run timestamp: 28062023_164600_10.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '20', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_10']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1643088
Number of validation edges: 182565
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
heaps
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9811; val_auprc_score: 0.9783; val_best_acc_score: 0.9345; val_best_f1_score: 0.9359; train_kl_reg_loss: 228.6020; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13644.3237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13872.9257; train_optim_loss: 13872.9257; val_kl_reg_loss: 211.3201; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12635.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12846.7498; val_optim_loss: 12846.7498
heaps
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9899; val_auprc_score: 0.9889; val_best_acc_score: 0.9525; val_best_f1_score: 0.9532; train_kl_reg_loss: 189.1517; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12951.5615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13140.7132; train_optim_loss: 13140.7132; val_kl_reg_loss: 183.5250; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12450.0698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12633.5947; val_optim_loss: 12633.5947
heaps
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9914; val_auprc_score: 0.9905; val_best_acc_score: 0.9571; val_best_f1_score: 0.9575; train_kl_reg_loss: 170.5103; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12827.8940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12998.4042; train_optim_loss: 12998.4042; val_kl_reg_loss: 172.2960; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12394.5308; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12566.8268; val_optim_loss: 12566.8268
heaps
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9921; val_auprc_score: 0.9913; val_best_acc_score: 0.9594; val_best_f1_score: 0.9598; train_kl_reg_loss: 162.6842; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12785.1830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12947.8672; train_optim_loss: 12947.8672; val_kl_reg_loss: 155.0817; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12373.4797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12528.5613; val_optim_loss: 12528.5613
heaps
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9929; val_auprc_score: 0.9921; val_best_acc_score: 0.9615; val_best_f1_score: 0.9619; train_kl_reg_loss: 159.5160; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12767.1101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12926.6260; train_optim_loss: 12926.6260; val_kl_reg_loss: 153.2069; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12366.8572; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12520.0641; val_optim_loss: 12520.0641
heaps
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9933; val_auprc_score: 0.9924; val_best_acc_score: 0.9628; val_best_f1_score: 0.9630; train_kl_reg_loss: 158.2183; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12757.1589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12915.3773; train_optim_loss: 12915.3773; val_kl_reg_loss: 162.2525; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12360.1500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12522.4025; val_optim_loss: 12522.4025
heaps
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9941; val_auprc_score: 0.9935; val_best_acc_score: 0.9651; val_best_f1_score: 0.9653; train_kl_reg_loss: 157.9876; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12748.5421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12906.5297; train_optim_loss: 12906.5297; val_kl_reg_loss: 160.2440; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12354.7889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12515.0329; val_optim_loss: 12515.0329
heaps
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9943; val_auprc_score: 0.9937; val_best_acc_score: 0.9656; val_best_f1_score: 0.9658; train_kl_reg_loss: 157.6703; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12742.3180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12899.9882; train_optim_loss: 12899.9882; val_kl_reg_loss: 157.6094; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12357.7789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12515.3884; val_optim_loss: 12515.3884
heaps
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9943; val_auprc_score: 0.9937; val_best_acc_score: 0.9660; val_best_f1_score: 0.9663; train_kl_reg_loss: 158.2451; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12738.3444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12896.5895; train_optim_loss: 12896.5895; val_kl_reg_loss: 158.8521; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12354.3589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12513.2110; val_optim_loss: 12513.2110
heaps
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9941; val_auprc_score: 0.9937; val_best_acc_score: 0.9650; val_best_f1_score: 0.9652; train_kl_reg_loss: 158.0919; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12733.6559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12891.7478; train_optim_loss: 12891.7478; val_kl_reg_loss: 155.0546; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12357.4218; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12512.4765; val_optim_loss: 12512.4765
heaps
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9942; val_auprc_score: 0.9937; val_best_acc_score: 0.9654; val_best_f1_score: 0.9655; train_kl_reg_loss: 158.4018; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12730.8222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12889.2240; train_optim_loss: 12889.2240; val_kl_reg_loss: 160.4019; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12348.2804; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12508.6823; val_optim_loss: 12508.6823
heaps
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9942; val_auprc_score: 0.9939; val_best_acc_score: 0.9655; val_best_f1_score: 0.9655; train_kl_reg_loss: 158.5278; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12729.2818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12887.8096; train_optim_loss: 12887.8096; val_kl_reg_loss: 157.0992; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12348.8865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12505.9857; val_optim_loss: 12505.9857
heaps
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9947; val_auprc_score: 0.9941; val_best_acc_score: 0.9672; val_best_f1_score: 0.9674; train_kl_reg_loss: 158.5358; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12726.3589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12884.8947; train_optim_loss: 12884.8947; val_kl_reg_loss: 155.5727; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12347.8238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12503.3965; val_optim_loss: 12503.3965
heaps
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9945; val_auprc_score: 0.9941; val_best_acc_score: 0.9667; val_best_f1_score: 0.9668; train_kl_reg_loss: 158.6268; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12724.9622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12883.5890; train_optim_loss: 12883.5890; val_kl_reg_loss: 153.2335; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12343.4754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12496.7089; val_optim_loss: 12496.7089
heaps
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9947; val_auprc_score: 0.9942; val_best_acc_score: 0.9675; val_best_f1_score: 0.9677; train_kl_reg_loss: 158.8636; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12723.6396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12882.5033; train_optim_loss: 12882.5033; val_kl_reg_loss: 157.7812; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12342.4899; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12500.2711; val_optim_loss: 12500.2711
heaps
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9949; val_auprc_score: 0.9947; val_best_acc_score: 0.9674; val_best_f1_score: 0.9675; train_kl_reg_loss: 158.8963; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12722.8780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12881.7743; train_optim_loss: 12881.7743; val_kl_reg_loss: 158.4744; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12340.7460; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12499.2203; val_optim_loss: 12499.2203
heaps
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9950; val_auprc_score: 0.9945; val_best_acc_score: 0.9677; val_best_f1_score: 0.9680; train_kl_reg_loss: 159.1026; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12720.6813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12879.7839; train_optim_loss: 12879.7839; val_kl_reg_loss: 164.7864; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12345.4022; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12510.1886; val_optim_loss: 12510.1886
heaps
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9950; val_auprc_score: 0.9947; val_best_acc_score: 0.9687; val_best_f1_score: 0.9688; train_kl_reg_loss: 159.0088; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12719.6163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12878.6252; train_optim_loss: 12878.6252; val_kl_reg_loss: 159.1944; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12343.5816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12502.7760; val_optim_loss: 12502.7760

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

heaps
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9958; val_auprc_score: 0.9955; val_best_acc_score: 0.9715; val_best_f1_score: 0.9716; train_kl_reg_loss: 121.1580; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12471.7039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12592.8619; train_optim_loss: 12592.8619; val_kl_reg_loss: 105.7821; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12310.9340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12416.7161; val_optim_loss: 12416.7161
heaps
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9959; val_auprc_score: 0.9956; val_best_acc_score: 0.9718; val_best_f1_score: 0.9718; train_kl_reg_loss: 104.6090; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12368.0919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12472.7009; train_optim_loss: 12472.7009; val_kl_reg_loss: 103.1259; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12305.0885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12408.2144; val_optim_loss: 12408.2144
heaps
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9960; val_auprc_score: 0.9958; val_best_acc_score: 0.9722; val_best_f1_score: 0.9722; train_kl_reg_loss: 103.4360; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12349.2948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12452.7308; train_optim_loss: 12452.7308; val_kl_reg_loss: 102.5902; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12303.0705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12405.6606; val_optim_loss: 12405.6606
heaps
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9960; val_auprc_score: 0.9958; val_best_acc_score: 0.9719; val_best_f1_score: 0.9719; train_kl_reg_loss: 103.5128; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12342.6914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12446.2043; train_optim_loss: 12446.2043; val_kl_reg_loss: 102.3960; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12302.5736; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12404.9696; val_optim_loss: 12404.9696
heaps
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9961; val_auprc_score: 0.9958; val_best_acc_score: 0.9726; val_best_f1_score: 0.9726; train_kl_reg_loss: 103.4614; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12338.5459; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12442.0073; train_optim_loss: 12442.0073; val_kl_reg_loss: 103.7055; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12298.7316; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12402.4371; val_optim_loss: 12402.4371
heaps
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9961; val_auprc_score: 0.9959; val_best_acc_score: 0.9727; val_best_f1_score: 0.9728; train_kl_reg_loss: 103.6144; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12336.9477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12440.5622; train_optim_loss: 12440.5622; val_kl_reg_loss: 103.4045; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12299.0894; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12402.4939; val_optim_loss: 12402.4939
heaps
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9962; val_auprc_score: 0.9959; val_best_acc_score: 0.9729; val_best_f1_score: 0.9730; train_kl_reg_loss: 103.7272; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12334.5423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12438.2695; train_optim_loss: 12438.2695; val_kl_reg_loss: 103.1004; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12299.6738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12402.7742; val_optim_loss: 12402.7742
heaps
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9961; val_auprc_score: 0.9958; val_best_acc_score: 0.9727; val_best_f1_score: 0.9728; train_kl_reg_loss: 103.7541; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12333.6994; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12437.4535; train_optim_loss: 12437.4535; val_kl_reg_loss: 103.3326; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12296.6401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12399.9726; val_optim_loss: 12399.9726
heaps
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9961; val_auprc_score: 0.9960; val_best_acc_score: 0.9725; val_best_f1_score: 0.9726; train_kl_reg_loss: 104.0408; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12332.7285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12436.7693; train_optim_loss: 12436.7693; val_kl_reg_loss: 103.2014; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12296.3858; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12399.5872; val_optim_loss: 12399.5872
heaps
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9962; val_auprc_score: 0.9960; val_best_acc_score: 0.9731; val_best_f1_score: 0.9732; train_kl_reg_loss: 104.1038; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12332.2224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12436.3262; train_optim_loss: 12436.3262; val_kl_reg_loss: 102.8631; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12297.9501; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12400.8132; val_optim_loss: 12400.8132
heaps
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9963; val_auprc_score: 0.9961; val_best_acc_score: 0.9734; val_best_f1_score: 0.9735; train_kl_reg_loss: 104.1572; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12331.1276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12435.2848; train_optim_loss: 12435.2848; val_kl_reg_loss: 104.0733; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12296.3949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12400.4682; val_optim_loss: 12400.4682
heaps
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9963; val_auprc_score: 0.9961; val_best_acc_score: 0.9733; val_best_f1_score: 0.9734; train_kl_reg_loss: 104.1443; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12329.7944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12433.9388; train_optim_loss: 12433.9388; val_kl_reg_loss: 103.1337; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12294.3570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12397.4907; val_optim_loss: 12397.4907
heaps
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9963; val_auprc_score: 0.9961; val_best_acc_score: 0.9733; val_best_f1_score: 0.9734; train_kl_reg_loss: 104.2963; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12329.2924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12433.5887; train_optim_loss: 12433.5887; val_kl_reg_loss: 104.2981; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12294.5014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12398.7995; val_optim_loss: 12398.7995
heaps
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9963; val_auprc_score: 0.9961; val_best_acc_score: 0.9734; val_best_f1_score: 0.9735; train_kl_reg_loss: 104.3365; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12328.5116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12432.8481; train_optim_loss: 12432.8481; val_kl_reg_loss: 103.6907; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12293.8132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12397.5039; val_optim_loss: 12397.5039
heaps
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9962; val_auprc_score: 0.9960; val_best_acc_score: 0.9731; val_best_f1_score: 0.9732; train_kl_reg_loss: 104.4868; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12328.3107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12432.7976; train_optim_loss: 12432.7976; val_kl_reg_loss: 104.2409; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12296.1055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12400.3464; val_optim_loss: 12400.3464
heaps
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9965; val_auprc_score: 0.9964; val_best_acc_score: 0.9738; val_best_f1_score: 0.9739; train_kl_reg_loss: 104.5903; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12327.2110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12431.8013; train_optim_loss: 12431.8013; val_kl_reg_loss: 104.4583; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12294.6320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12399.0904; val_optim_loss: 12399.0904

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

heaps
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9964; val_auprc_score: 0.9962; val_best_acc_score: 0.9735; val_best_f1_score: 0.9736; train_kl_reg_loss: 104.5966; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12315.8505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12420.4471; train_optim_loss: 12420.4471; val_kl_reg_loss: 103.9415; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12292.5758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12396.5173; val_optim_loss: 12396.5173
heaps
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9963; val_auprc_score: 0.9961; val_best_acc_score: 0.9734; val_best_f1_score: 0.9735; train_kl_reg_loss: 104.3347; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12306.8351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12411.1698; train_optim_loss: 12411.1698; val_kl_reg_loss: 103.8865; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12290.9907; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12394.8771; val_optim_loss: 12394.8771
heaps
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9964; val_auprc_score: 0.9964; val_best_acc_score: 0.9736; val_best_f1_score: 0.9737; train_kl_reg_loss: 104.2215; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12301.6326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12405.8541; train_optim_loss: 12405.8541; val_kl_reg_loss: 103.6785; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12290.5449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12394.2234; val_optim_loss: 12394.2234
heaps
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9963; val_auprc_score: 0.9962; val_best_acc_score: 0.9736; val_best_f1_score: 0.9737; train_kl_reg_loss: 104.0491; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12298.4020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12402.4511; train_optim_loss: 12402.4511; val_kl_reg_loss: 103.6170; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12292.8827; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12396.4997; val_optim_loss: 12396.4997
heaps
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9964; val_auprc_score: 0.9963; val_best_acc_score: 0.9740; val_best_f1_score: 0.9740; train_kl_reg_loss: 104.1455; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12296.4917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12400.6372; train_optim_loss: 12400.6372; val_kl_reg_loss: 103.4655; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12292.2857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12395.7512; val_optim_loss: 12395.7512
heaps
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9964; val_auprc_score: 0.9961; val_best_acc_score: 0.9739; val_best_f1_score: 0.9739; train_kl_reg_loss: 104.0931; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12294.3304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12398.4236; train_optim_loss: 12398.4236; val_kl_reg_loss: 103.7818; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12291.6947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12395.4766; val_optim_loss: 12395.4766
heaps
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9965; val_auprc_score: 0.9963; val_best_acc_score: 0.9740; val_best_f1_score: 0.9740; train_kl_reg_loss: 104.0214; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12293.0456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12397.0670; train_optim_loss: 12397.0670; val_kl_reg_loss: 103.4966; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12291.3816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12394.8782; val_optim_loss: 12394.8782

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

heaps
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9964; val_auprc_score: 0.9963; val_best_acc_score: 0.9740; val_best_f1_score: 0.9741; train_kl_reg_loss: 103.9358; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12291.8534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12395.7893; train_optim_loss: 12395.7893; val_kl_reg_loss: 103.5209; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12289.1141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12392.6350; val_optim_loss: 12392.6350
heaps
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9964; val_auprc_score: 0.9962; val_best_acc_score: 0.9740; val_best_f1_score: 0.9740; train_kl_reg_loss: 103.9673; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12291.3796; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12395.3469; train_optim_loss: 12395.3469; val_kl_reg_loss: 103.5189; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12290.0461; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12393.5650; val_optim_loss: 12393.5650
heaps
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9964; val_auprc_score: 0.9961; val_best_acc_score: 0.9740; val_best_f1_score: 0.9741; train_kl_reg_loss: 103.9858; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12291.7594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12395.7452; train_optim_loss: 12395.7452; val_kl_reg_loss: 103.5992; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12290.9290; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12394.5281; val_optim_loss: 12394.5281
heaps
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9964; val_auprc_score: 0.9962; val_best_acc_score: 0.9737; val_best_f1_score: 0.9737; train_kl_reg_loss: 104.0120; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12291.7124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12395.7243; train_optim_loss: 12395.7243; val_kl_reg_loss: 103.6035; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12291.2797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12394.8831; val_optim_loss: 12394.8831
heaps
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9964; val_auprc_score: 0.9963; val_best_acc_score: 0.9736; val_best_f1_score: 0.9736; train_kl_reg_loss: 104.0058; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12291.1093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12395.1152; train_optim_loss: 12395.1152; val_kl_reg_loss: 103.5063; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12290.7211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12394.2273; val_optim_loss: 12394.2273

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

heaps
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9964; val_auprc_score: 0.9963; val_best_acc_score: 0.9739; val_best_f1_score: 0.9740; train_kl_reg_loss: 103.9419; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12291.1294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12395.0713; train_optim_loss: 12395.0713; val_kl_reg_loss: 103.5329; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12290.7335; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12394.2665; val_optim_loss: 12394.2665
heaps
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9964; val_auprc_score: 0.9963; val_best_acc_score: 0.9737; val_best_f1_score: 0.9738; train_kl_reg_loss: 103.9637; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12291.4927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12395.4563; train_optim_loss: 12395.4563; val_kl_reg_loss: 103.5388; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12291.9384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12395.4772; val_optim_loss: 12395.4772
heaps
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9963; val_auprc_score: 0.9960; val_best_acc_score: 0.9737; val_best_f1_score: 0.9738; train_kl_reg_loss: 103.9685; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12290.6419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12394.6103; train_optim_loss: 12394.6103; val_kl_reg_loss: 103.5548; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12290.9081; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12394.4629; val_optim_loss: 12394.4629
heaps
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9963; val_auprc_score: 0.9960; val_best_acc_score: 0.9739; val_best_f1_score: 0.9740; train_kl_reg_loss: 103.9776; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12291.1372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12395.1148; train_optim_loss: 12395.1148; val_kl_reg_loss: 103.5466; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12290.0896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12393.6361; val_optim_loss: 12393.6361

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1457 min 34 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
Val AUROC score: 0.9965
Val AUPRC score: 0.9964
Val best accuracy score: 0.9742
Val best F1 score: 0.9742
Val gene expr MSE score: 2.6347

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
