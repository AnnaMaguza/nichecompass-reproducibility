None
Run timestamp: 14072023_011736_10.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_10']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9618; val_auprc_score: 0.9519; val_best_acc_score: 0.9044; val_best_f1_score: 0.9091; train_kl_reg_loss: 18234.0542; train_edge_recon_loss: 26629202.1972; train_gene_expr_recon_loss: 863095.3337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27510531.6024; train_optim_loss: 27510531.6024; val_kl_reg_loss: 14502.7362; val_edge_recon_loss: 26427593.0000; val_gene_expr_recon_loss: 791512.9208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27233608.6438; val_optim_loss: 27233608.6438
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9777; val_auprc_score: 0.9728; val_best_acc_score: 0.9308; val_best_f1_score: 0.9329; train_kl_reg_loss: 13393.7330; train_edge_recon_loss: 26117962.2936; train_gene_expr_recon_loss: 773040.6942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26904396.7416; train_optim_loss: 26904396.7416; val_kl_reg_loss: 12399.1708; val_edge_recon_loss: 26266167.8219; val_gene_expr_recon_loss: 754245.3408; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27032812.2329; val_optim_loss: 27032812.2329
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9808; val_auprc_score: 0.9762; val_best_acc_score: 0.9381; val_best_f1_score: 0.9397; train_kl_reg_loss: 12913.5265; train_edge_recon_loss: 26002280.4679; train_gene_expr_recon_loss: 741799.9310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26756993.9297; train_optim_loss: 26756993.9297; val_kl_reg_loss: 12935.5484; val_edge_recon_loss: 26211949.5890; val_gene_expr_recon_loss: 728744.8626; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26953629.9589; val_optim_loss: 26953629.9589
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9820; val_auprc_score: 0.9776; val_best_acc_score: 0.9405; val_best_f1_score: 0.9419; train_kl_reg_loss: 13130.1918; train_edge_recon_loss: 25958142.6804; train_gene_expr_recon_loss: 722215.1600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26693488.0612; train_optim_loss: 26693488.0612; val_kl_reg_loss: 12967.5559; val_edge_recon_loss: 26164239.3014; val_gene_expr_recon_loss: 712294.2975; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26889501.2055; val_optim_loss: 26889501.2055
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9841; val_auprc_score: 0.9800; val_best_acc_score: 0.9450; val_best_f1_score: 0.9465; train_kl_reg_loss: 13437.5906; train_edge_recon_loss: 25910982.6865; train_gene_expr_recon_loss: 708913.1701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26633333.4664; train_optim_loss: 26633333.4664; val_kl_reg_loss: 13544.9417; val_edge_recon_loss: 26116103.6438; val_gene_expr_recon_loss: 700675.6618; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26830324.1918; val_optim_loss: 26830324.1918
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9850; val_auprc_score: 0.9808; val_best_acc_score: 0.9486; val_best_f1_score: 0.9496; train_kl_reg_loss: 13709.6504; train_edge_recon_loss: 25885672.5061; train_gene_expr_recon_loss: 699162.2189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26598544.3930; train_optim_loss: 26598544.3930; val_kl_reg_loss: 13865.3118; val_edge_recon_loss: 26119884.8082; val_gene_expr_recon_loss: 695504.3493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26829254.5342; val_optim_loss: 26829254.5342
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9864; val_auprc_score: 0.9829; val_best_acc_score: 0.9515; val_best_f1_score: 0.9525; train_kl_reg_loss: 13980.9101; train_edge_recon_loss: 25860980.4419; train_gene_expr_recon_loss: 692085.5952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26567046.9771; train_optim_loss: 26567046.9771; val_kl_reg_loss: 13732.9735; val_edge_recon_loss: 26072470.0274; val_gene_expr_recon_loss: 689190.4730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26775393.5068; val_optim_loss: 26775393.5068
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9861; val_auprc_score: 0.9820; val_best_acc_score: 0.9517; val_best_f1_score: 0.9526; train_kl_reg_loss: 14183.9583; train_edge_recon_loss: 25856012.4924; train_gene_expr_recon_loss: 687041.8101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26557238.2829; train_optim_loss: 26557238.2829; val_kl_reg_loss: 14113.8745; val_edge_recon_loss: 26031870.1233; val_gene_expr_recon_loss: 684694.8211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26730678.8767; val_optim_loss: 26730678.8767
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9865; val_auprc_score: 0.9826; val_best_acc_score: 0.9517; val_best_f1_score: 0.9526; train_kl_reg_loss: 14401.8331; train_edge_recon_loss: 25833835.1682; train_gene_expr_recon_loss: 681967.3215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26530204.3349; train_optim_loss: 26530204.3349; val_kl_reg_loss: 14702.9960; val_edge_recon_loss: 26053193.6986; val_gene_expr_recon_loss: 678676.3711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26746573.1781; val_optim_loss: 26746573.1781
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9876; val_auprc_score: 0.9840; val_best_acc_score: 0.9551; val_best_f1_score: 0.9559; train_kl_reg_loss: 14680.7416; train_edge_recon_loss: 25814074.6728; train_gene_expr_recon_loss: 678136.4199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26506891.8364; train_optim_loss: 26506891.8364; val_kl_reg_loss: 14529.9743; val_edge_recon_loss: 26013915.7534; val_gene_expr_recon_loss: 676341.4923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26704787.1781; val_optim_loss: 26704787.1781
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9880; val_auprc_score: 0.9845; val_best_acc_score: 0.9559; val_best_f1_score: 0.9567; train_kl_reg_loss: 14845.0657; train_edge_recon_loss: 25821454.0321; train_gene_expr_recon_loss: 674795.3032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26511094.3930; train_optim_loss: 26511094.3930; val_kl_reg_loss: 15042.4988; val_edge_recon_loss: 25982304.7945; val_gene_expr_recon_loss: 671509.3450; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26668856.6301; val_optim_loss: 26668856.6301
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9884; val_auprc_score: 0.9847; val_best_acc_score: 0.9575; val_best_f1_score: 0.9583; train_kl_reg_loss: 15010.7856; train_edge_recon_loss: 25808572.3471; train_gene_expr_recon_loss: 671524.4482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26495107.5933; train_optim_loss: 26495107.5933; val_kl_reg_loss: 14587.8392; val_edge_recon_loss: 26013461.0000; val_gene_expr_recon_loss: 669333.9268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26697382.8356; val_optim_loss: 26697382.8356
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9884; val_auprc_score: 0.9852; val_best_acc_score: 0.9572; val_best_f1_score: 0.9581; train_kl_reg_loss: 15269.8614; train_edge_recon_loss: 25794926.4404; train_gene_expr_recon_loss: 669228.2180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26479424.5336; train_optim_loss: 26479424.5336; val_kl_reg_loss: 15138.4842; val_edge_recon_loss: 25992578.7945; val_gene_expr_recon_loss: 667156.4803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26674873.6986; val_optim_loss: 26674873.6986
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9880; val_auprc_score: 0.9843; val_best_acc_score: 0.9574; val_best_f1_score: 0.9581; train_kl_reg_loss: 15376.1904; train_edge_recon_loss: 25796800.4083; train_gene_expr_recon_loss: 667397.1623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26479573.7401; train_optim_loss: 26479573.7401; val_kl_reg_loss: 14627.1681; val_edge_recon_loss: 26010998.4521; val_gene_expr_recon_loss: 666586.1939; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26692211.7671; val_optim_loss: 26692211.7671
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9883; val_auprc_score: 0.9848; val_best_acc_score: 0.9571; val_best_f1_score: 0.9577; train_kl_reg_loss: 15374.2126; train_edge_recon_loss: 25782589.0826; train_gene_expr_recon_loss: 665470.1807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26463433.4709; train_optim_loss: 26463433.4709; val_kl_reg_loss: 14846.9869; val_edge_recon_loss: 25996808.5342; val_gene_expr_recon_loss: 665588.3814; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26677243.9863; val_optim_loss: 26677243.9863

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9895; val_auprc_score: 0.9864; val_best_acc_score: 0.9600; val_best_f1_score: 0.9608; train_kl_reg_loss: 15402.2080; train_edge_recon_loss: 25755134.5061; train_gene_expr_recon_loss: 661453.8265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26431990.5122; train_optim_loss: 26431990.5122; val_kl_reg_loss: 15150.9147; val_edge_recon_loss: 25934498.4795; val_gene_expr_recon_loss: 661052.4563; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26610701.8219; val_optim_loss: 26610701.8219
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9890; val_auprc_score: 0.9856; val_best_acc_score: 0.9592; val_best_f1_score: 0.9601; train_kl_reg_loss: 15441.7703; train_edge_recon_loss: 25756011.8517; train_gene_expr_recon_loss: 660343.6720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26431797.3135; train_optim_loss: 26431797.3135; val_kl_reg_loss: 15220.0410; val_edge_recon_loss: 25969860.5890; val_gene_expr_recon_loss: 659937.2299; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26645017.8630; val_optim_loss: 26645017.8630
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9891; val_auprc_score: 0.9859; val_best_acc_score: 0.9597; val_best_f1_score: 0.9604; train_kl_reg_loss: 15363.7502; train_edge_recon_loss: 25754868.8486; train_gene_expr_recon_loss: 660245.1280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26430477.7202; train_optim_loss: 26430477.7202; val_kl_reg_loss: 14987.3067; val_edge_recon_loss: 25974558.1370; val_gene_expr_recon_loss: 659368.3904; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26648913.9041; val_optim_loss: 26648913.9041
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9897; val_auprc_score: 0.9865; val_best_acc_score: 0.9604; val_best_f1_score: 0.9611; train_kl_reg_loss: 15227.2248; train_edge_recon_loss: 25751511.6590; train_gene_expr_recon_loss: 659777.8265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26426516.6820; train_optim_loss: 26426516.6820; val_kl_reg_loss: 14926.3427; val_edge_recon_loss: 25938329.6712; val_gene_expr_recon_loss: 659368.7911; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26612624.7945; val_optim_loss: 26612624.7945
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9896; val_auprc_score: 0.9866; val_best_acc_score: 0.9608; val_best_f1_score: 0.9615; train_kl_reg_loss: 15154.9520; train_edge_recon_loss: 25756891.1284; train_gene_expr_recon_loss: 659762.3811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26431808.4266; train_optim_loss: 26431808.4266; val_kl_reg_loss: 14982.9664; val_edge_recon_loss: 25933356.6986; val_gene_expr_recon_loss: 659133.0565; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26607472.7123; val_optim_loss: 26607472.7123
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9899; val_auprc_score: 0.9869; val_best_acc_score: 0.9608; val_best_f1_score: 0.9614; train_kl_reg_loss: 15132.9116; train_edge_recon_loss: 25748370.7034; train_gene_expr_recon_loss: 659745.0982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26423248.7064; train_optim_loss: 26423248.7064; val_kl_reg_loss: 14700.1189; val_edge_recon_loss: 25954609.7397; val_gene_expr_recon_loss: 659598.8776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26628908.7534; val_optim_loss: 26628908.7534
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9899; val_auprc_score: 0.9872; val_best_acc_score: 0.9611; val_best_f1_score: 0.9618; train_kl_reg_loss: 15025.3918; train_edge_recon_loss: 25748937.7752; train_gene_expr_recon_loss: 659184.0705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26423147.2294; train_optim_loss: 26423147.2294; val_kl_reg_loss: 14687.5441; val_edge_recon_loss: 25938822.3425; val_gene_expr_recon_loss: 659621.4349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26613131.3288; val_optim_loss: 26613131.3288
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9899; val_auprc_score: 0.9867; val_best_acc_score: 0.9615; val_best_f1_score: 0.9621; train_kl_reg_loss: 14971.1594; train_edge_recon_loss: 25748412.0321; train_gene_expr_recon_loss: 659162.1476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26422545.3211; train_optim_loss: 26422545.3211; val_kl_reg_loss: 14686.6633; val_edge_recon_loss: 25935902.8219; val_gene_expr_recon_loss: 660354.7123; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26610944.2466; val_optim_loss: 26610944.2466
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9895; val_auprc_score: 0.9863; val_best_acc_score: 0.9600; val_best_f1_score: 0.9607; train_kl_reg_loss: 14927.7277; train_edge_recon_loss: 25750265.8593; train_gene_expr_recon_loss: 659447.2509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26424640.8425; train_optim_loss: 26424640.8425; val_kl_reg_loss: 14661.3540; val_edge_recon_loss: 25942735.7123; val_gene_expr_recon_loss: 659555.9135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26616952.9041; val_optim_loss: 26616952.9041

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9898; val_auprc_score: 0.9867; val_best_acc_score: 0.9615; val_best_f1_score: 0.9621; train_kl_reg_loss: 14926.1519; train_edge_recon_loss: 25748285.8150; train_gene_expr_recon_loss: 658940.7124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26422152.6728; train_optim_loss: 26422152.6728; val_kl_reg_loss: 14676.8205; val_edge_recon_loss: 25926242.3699; val_gene_expr_recon_loss: 658143.9863; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26599063.2603; val_optim_loss: 26599063.2603
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9900; val_auprc_score: 0.9870; val_best_acc_score: 0.9611; val_best_f1_score: 0.9618; train_kl_reg_loss: 14917.2217; train_edge_recon_loss: 25747201.9694; train_gene_expr_recon_loss: 658557.2953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26420676.4709; train_optim_loss: 26420676.4709; val_kl_reg_loss: 14719.1710; val_edge_recon_loss: 25913704.4658; val_gene_expr_recon_loss: 658908.5826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26587332.1370; val_optim_loss: 26587332.1370
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9900; val_auprc_score: 0.9871; val_best_acc_score: 0.9612; val_best_f1_score: 0.9619; train_kl_reg_loss: 14944.4468; train_edge_recon_loss: 25739832.4052; train_gene_expr_recon_loss: 658603.0694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26413379.9174; train_optim_loss: 26413379.9174; val_kl_reg_loss: 14718.6636; val_edge_recon_loss: 25931218.8082; val_gene_expr_recon_loss: 658755.7607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26604693.2603; val_optim_loss: 26604693.2603
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9903; val_auprc_score: 0.9876; val_best_acc_score: 0.9612; val_best_f1_score: 0.9618; train_kl_reg_loss: 14941.1651; train_edge_recon_loss: 25741771.3838; train_gene_expr_recon_loss: 658581.1040; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26415293.6315; train_optim_loss: 26415293.6315; val_kl_reg_loss: 14689.3146; val_edge_recon_loss: 25921227.7123; val_gene_expr_recon_loss: 658895.9105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26594812.9452; val_optim_loss: 26594812.9452
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9898; val_auprc_score: 0.9867; val_best_acc_score: 0.9613; val_best_f1_score: 0.9620; train_kl_reg_loss: 14915.2652; train_edge_recon_loss: 25749273.6881; train_gene_expr_recon_loss: 658514.9097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26422703.8211; train_optim_loss: 26422703.8211; val_kl_reg_loss: 14669.0409; val_edge_recon_loss: 25941131.9589; val_gene_expr_recon_loss: 659577.1216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26615378.0548; val_optim_loss: 26615378.0548
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9901; val_auprc_score: 0.9869; val_best_acc_score: 0.9617; val_best_f1_score: 0.9624; train_kl_reg_loss: 14891.6320; train_edge_recon_loss: 25748676.6223; train_gene_expr_recon_loss: 658548.8254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26422117.0765; train_optim_loss: 26422117.0765; val_kl_reg_loss: 14634.2990; val_edge_recon_loss: 25914902.7397; val_gene_expr_recon_loss: 659816.7860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26589353.7397; val_optim_loss: 26589353.7397

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9900; val_auprc_score: 0.9870; val_best_acc_score: 0.9612; val_best_f1_score: 0.9619; train_kl_reg_loss: 14870.4564; train_edge_recon_loss: 25745002.3517; train_gene_expr_recon_loss: 658127.5834; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26418000.4465; train_optim_loss: 26418000.4465; val_kl_reg_loss: 14629.0173; val_edge_recon_loss: 25928566.6164; val_gene_expr_recon_loss: 659402.8553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26602598.4521; val_optim_loss: 26602598.4521
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9900; val_auprc_score: 0.9868; val_best_acc_score: 0.9615; val_best_f1_score: 0.9621; train_kl_reg_loss: 14879.6983; train_edge_recon_loss: 25742928.9572; train_gene_expr_recon_loss: 658245.5449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26416054.1636; train_optim_loss: 26416054.1636; val_kl_reg_loss: 14661.2677; val_edge_recon_loss: 25943697.9863; val_gene_expr_recon_loss: 658672.5655; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26617031.7671; val_optim_loss: 26617031.7671
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9896; val_auprc_score: 0.9863; val_best_acc_score: 0.9615; val_best_f1_score: 0.9622; train_kl_reg_loss: 14882.4007; train_edge_recon_loss: 25740039.9113; train_gene_expr_recon_loss: 658411.3643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26413333.6743; train_optim_loss: 26413333.6743; val_kl_reg_loss: 14651.5599; val_edge_recon_loss: 25938077.8356; val_gene_expr_recon_loss: 657888.1584; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26610617.6164; val_optim_loss: 26610617.6164
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9894; val_auprc_score: 0.9863; val_best_acc_score: 0.9606; val_best_f1_score: 0.9613; train_kl_reg_loss: 14885.6570; train_edge_recon_loss: 25745211.7966; train_gene_expr_recon_loss: 658418.8212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26418516.2538; train_optim_loss: 26418516.2538; val_kl_reg_loss: 14646.3011; val_edge_recon_loss: 25976792.6438; val_gene_expr_recon_loss: 659205.0441; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26650644.0137; val_optim_loss: 26650644.0137

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 149 min 26 sec.
Using best model state, which was in epoch 26.

--- MODEL EVALUATION ---
Val AUROC score: 0.9900
Val AUPRC score: 0.9871
Val best accuracy score: 0.9614
Val best F1 score: 0.9621
Val gene expr MSE score: 1.6707

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
