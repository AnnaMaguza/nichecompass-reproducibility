None
Run timestamp: 16072023_185904_1015.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_1015']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1818, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1818, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9899; val_auprc_score: 0.9862; val_best_acc_score: 0.9660; val_best_f1_score: 0.9666; train_kl_reg_loss: 15217.3074; train_edge_recon_loss: 26427441.1015; train_gene_expr_recon_loss: 20715814.7232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 47158473.1238; train_optim_loss: 47158473.1238; val_kl_reg_loss: 16230.5639; val_edge_recon_loss: 25840367.4500; val_gene_expr_recon_loss: 19889330.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45745928.5000; val_optim_loss: 45745928.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9926; val_auprc_score: 0.9901; val_best_acc_score: 0.9717; val_best_f1_score: 0.9722; train_kl_reg_loss: 16221.8706; train_edge_recon_loss: 25726244.1196; train_gene_expr_recon_loss: 19482345.7608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45224811.7552; train_optim_loss: 45224811.7552; val_kl_reg_loss: 16655.1844; val_edge_recon_loss: 25742194.8250; val_gene_expr_recon_loss: 19243151.5250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45002001.7000; val_optim_loss: 45002001.7000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9940; val_auprc_score: 0.9924; val_best_acc_score: 0.9742; val_best_f1_score: 0.9746; train_kl_reg_loss: 16767.7114; train_edge_recon_loss: 25654705.3324; train_gene_expr_recon_loss: 18982886.7622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44654359.7997; train_optim_loss: 44654359.7997; val_kl_reg_loss: 17239.4951; val_edge_recon_loss: 25691050.3750; val_gene_expr_recon_loss: 18900067.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 44608357.0000; val_optim_loss: 44608357.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9949; val_auprc_score: 0.9933; val_best_acc_score: 0.9775; val_best_f1_score: 0.9778; train_kl_reg_loss: 17270.8525; train_edge_recon_loss: 25612648.7789; train_gene_expr_recon_loss: 18655902.7705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44285822.3588; train_optim_loss: 44285822.3588; val_kl_reg_loss: 17355.6392; val_edge_recon_loss: 25627045.6250; val_gene_expr_recon_loss: 18583933.6750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 44228335.0500; val_optim_loss: 44228335.0500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9960; val_auprc_score: 0.9950; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 17695.2086; train_edge_recon_loss: 25599280.6203; train_gene_expr_recon_loss: 18463114.0250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44080089.7691; train_optim_loss: 44080089.7691; val_kl_reg_loss: 18120.0894; val_edge_recon_loss: 25612545.3500; val_gene_expr_recon_loss: 18415806.2125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 44046471.6500; val_optim_loss: 44046471.6500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9962; val_auprc_score: 0.9951; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 18213.2980; train_edge_recon_loss: 25566689.3825; train_gene_expr_recon_loss: 18288830.6022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43873733.2851; train_optim_loss: 43873733.2851; val_kl_reg_loss: 18581.1313; val_edge_recon_loss: 25599893.1750; val_gene_expr_recon_loss: 18366089.1750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43984563.4500; val_optim_loss: 43984563.4500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9967; val_auprc_score: 0.9960; val_best_acc_score: 0.9817; val_best_f1_score: 0.9819; train_kl_reg_loss: 18332.5316; train_edge_recon_loss: 25556918.4256; train_gene_expr_recon_loss: 18159344.0654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43734595.0932; train_optim_loss: 43734595.0932; val_kl_reg_loss: 18534.5143; val_edge_recon_loss: 25593251.3250; val_gene_expr_recon_loss: 18210615.0375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43822400.8500; val_optim_loss: 43822400.8500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9966; val_auprc_score: 0.9957; val_best_acc_score: 0.9821; val_best_f1_score: 0.9823; train_kl_reg_loss: 18633.9457; train_edge_recon_loss: 25542878.8456; train_gene_expr_recon_loss: 18034019.8373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43595532.5897; train_optim_loss: 43595532.5897; val_kl_reg_loss: 18757.8831; val_edge_recon_loss: 25587780.4000; val_gene_expr_recon_loss: 18114636.9750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43721174.9000; val_optim_loss: 43721174.9000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9970; val_auprc_score: 0.9964; val_best_acc_score: 0.9826; val_best_f1_score: 0.9828; train_kl_reg_loss: 18636.0516; train_edge_recon_loss: 25553816.1446; train_gene_expr_recon_loss: 17937027.3797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43509479.5883; train_optim_loss: 43509479.5883; val_kl_reg_loss: 18311.4215; val_edge_recon_loss: 25592313.1000; val_gene_expr_recon_loss: 18054178.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43664803.0000; val_optim_loss: 43664803.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9972; val_auprc_score: 0.9964; val_best_acc_score: 0.9836; val_best_f1_score: 0.9837; train_kl_reg_loss: 18676.9973; train_edge_recon_loss: 25524943.6885; train_gene_expr_recon_loss: 17866467.2823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43410088.0556; train_optim_loss: 43410088.0556; val_kl_reg_loss: 17761.9630; val_edge_recon_loss: 25580373.6000; val_gene_expr_recon_loss: 18121269.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43719405.4000; val_optim_loss: 43719405.4000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9970; val_auprc_score: 0.9963; val_best_acc_score: 0.9837; val_best_f1_score: 0.9839; train_kl_reg_loss: 18780.0786; train_edge_recon_loss: 25529021.1822; train_gene_expr_recon_loss: 17804774.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43352575.3769; train_optim_loss: 43352575.3769; val_kl_reg_loss: 18957.0816; val_edge_recon_loss: 25578252.5250; val_gene_expr_recon_loss: 18042282.3000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43639492.0500; val_optim_loss: 43639492.0500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9972; val_auprc_score: 0.9964; val_best_acc_score: 0.9834; val_best_f1_score: 0.9836; train_kl_reg_loss: 18845.3641; train_edge_recon_loss: 25523929.1822; train_gene_expr_recon_loss: 17749343.1864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43292117.7636; train_optim_loss: 43292117.7636; val_kl_reg_loss: 18783.7706; val_edge_recon_loss: 25589357.8000; val_gene_expr_recon_loss: 18008137.8500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43616279.5000; val_optim_loss: 43616279.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9973; val_auprc_score: 0.9965; val_best_acc_score: 0.9846; val_best_f1_score: 0.9847; train_kl_reg_loss: 18843.0453; train_edge_recon_loss: 25511038.9124; train_gene_expr_recon_loss: 17716428.4673; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43246310.4979; train_optim_loss: 43246310.4979; val_kl_reg_loss: 19131.7705; val_edge_recon_loss: 25568729.4750; val_gene_expr_recon_loss: 18013569.0875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43601430.4500; val_optim_loss: 43601430.4500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9972; val_auprc_score: 0.9963; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 18934.9488; train_edge_recon_loss: 25512967.5772; train_gene_expr_recon_loss: 17663088.4047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43194990.9819; train_optim_loss: 43194990.9819; val_kl_reg_loss: 19204.0159; val_edge_recon_loss: 25539626.7000; val_gene_expr_recon_loss: 17971356.3000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43530186.7500; val_optim_loss: 43530186.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9972; val_auprc_score: 0.9963; val_best_acc_score: 0.9845; val_best_f1_score: 0.9847; train_kl_reg_loss: 18899.6342; train_edge_recon_loss: 25508738.6398; train_gene_expr_recon_loss: 17643900.9026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43171539.1266; train_optim_loss: 43171539.1266; val_kl_reg_loss: 18375.0974; val_edge_recon_loss: 25565364.0500; val_gene_expr_recon_loss: 18015313.2750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43599052.4000; val_optim_loss: 43599052.4000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9974; val_auprc_score: 0.9968; val_best_acc_score: 0.9846; val_best_f1_score: 0.9847; train_kl_reg_loss: 18984.1528; train_edge_recon_loss: 25504235.9861; train_gene_expr_recon_loss: 17619644.0445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43142864.2670; train_optim_loss: 43142864.2670; val_kl_reg_loss: 19090.6752; val_edge_recon_loss: 25558158.3250; val_gene_expr_recon_loss: 17982320.1625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43559569.1500; val_optim_loss: 43559569.1500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9972; val_auprc_score: 0.9962; val_best_acc_score: 0.9847; val_best_f1_score: 0.9849; train_kl_reg_loss: 19006.4363; train_edge_recon_loss: 25496733.3491; train_gene_expr_recon_loss: 17588983.0862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43104722.9597; train_optim_loss: 43104722.9597; val_kl_reg_loss: 19484.4767; val_edge_recon_loss: 25553064.4250; val_gene_expr_recon_loss: 17982166.1375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43554715.0500; val_optim_loss: 43554715.0500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9974; val_auprc_score: 0.9967; val_best_acc_score: 0.9854; val_best_f1_score: 0.9855; train_kl_reg_loss: 19044.8309; train_edge_recon_loss: 25496446.9569; train_gene_expr_recon_loss: 17574562.3018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43090054.1196; train_optim_loss: 43090054.1196; val_kl_reg_loss: 19023.0907; val_edge_recon_loss: 25519711.0500; val_gene_expr_recon_loss: 18016210.0375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43554944.0500; val_optim_loss: 43554944.0500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9973; val_auprc_score: 0.9966; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 20847.4210; train_edge_recon_loss: 25471281.1349; train_gene_expr_recon_loss: 17346052.4576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42838181.0292; train_optim_loss: 42838181.0292; val_kl_reg_loss: 20926.3265; val_edge_recon_loss: 25515912.8000; val_gene_expr_recon_loss: 17856832.5125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43393671.5500; val_optim_loss: 43393671.5500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9972; val_auprc_score: 0.9962; val_best_acc_score: 0.9844; val_best_f1_score: 0.9846; train_kl_reg_loss: 20748.1646; train_edge_recon_loss: 25453688.4701; train_gene_expr_recon_loss: 17313710.1780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42788146.8873; train_optim_loss: 42788146.8873; val_kl_reg_loss: 20292.5698; val_edge_recon_loss: 25507002.0500; val_gene_expr_recon_loss: 17898866.4500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43426160.9500; val_optim_loss: 43426160.9500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9969; val_auprc_score: 0.9960; val_best_acc_score: 0.9844; val_best_f1_score: 0.9845; train_kl_reg_loss: 20110.8788; train_edge_recon_loss: 25455425.9499; train_gene_expr_recon_loss: 17307943.2921; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42783480.1558; train_optim_loss: 42783480.1558; val_kl_reg_loss: 19702.6036; val_edge_recon_loss: 25494581.9500; val_gene_expr_recon_loss: 17914932.7875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43429217.3000; val_optim_loss: 43429217.3000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9970; val_auprc_score: 0.9958; val_best_acc_score: 0.9843; val_best_f1_score: 0.9845; train_kl_reg_loss: 19662.0597; train_edge_recon_loss: 25458285.7079; train_gene_expr_recon_loss: 17290843.8317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42768791.6106; train_optim_loss: 42768791.6106; val_kl_reg_loss: 19368.1977; val_edge_recon_loss: 25490297.5000; val_gene_expr_recon_loss: 17876534.9625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43386200.6500; val_optim_loss: 43386200.6500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9973; val_auprc_score: 0.9966; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 19403.1725; train_edge_recon_loss: 25455072.9847; train_gene_expr_recon_loss: 17293297.4465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42767773.5800; train_optim_loss: 42767773.5800; val_kl_reg_loss: 19185.8605; val_edge_recon_loss: 25462242.3250; val_gene_expr_recon_loss: 17883775.5750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43365203.7500; val_optim_loss: 43365203.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9970; val_auprc_score: 0.9962; val_best_acc_score: 0.9842; val_best_f1_score: 0.9844; train_kl_reg_loss: 19283.6557; train_edge_recon_loss: 25456242.7232; train_gene_expr_recon_loss: 17275127.2656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42750653.6912; train_optim_loss: 42750653.6912; val_kl_reg_loss: 19123.4011; val_edge_recon_loss: 25500174.4500; val_gene_expr_recon_loss: 17914786.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43434084.4000; val_optim_loss: 43434084.4000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9971; val_auprc_score: 0.9963; val_best_acc_score: 0.9848; val_best_f1_score: 0.9849; train_kl_reg_loss: 19206.8004; train_edge_recon_loss: 25447467.1739; train_gene_expr_recon_loss: 17262690.0807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42729364.0668; train_optim_loss: 42729364.0668; val_kl_reg_loss: 19080.8130; val_edge_recon_loss: 25484635.0500; val_gene_expr_recon_loss: 17897846.4500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43401562.4000; val_optim_loss: 43401562.4000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9969; val_auprc_score: 0.9958; val_best_acc_score: 0.9843; val_best_f1_score: 0.9844; train_kl_reg_loss: 19163.5174; train_edge_recon_loss: 25452154.6287; train_gene_expr_recon_loss: 17259589.7051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42730907.8220; train_optim_loss: 42730907.8220; val_kl_reg_loss: 18984.2405; val_edge_recon_loss: 25497371.4250; val_gene_expr_recon_loss: 17893222.2250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43409577.8500; val_optim_loss: 43409577.8500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9971; val_auprc_score: 0.9962; val_best_acc_score: 0.9851; val_best_f1_score: 0.9853; train_kl_reg_loss: 19139.0788; train_edge_recon_loss: 25445034.0250; train_gene_expr_recon_loss: 17252463.0223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42716636.1446; train_optim_loss: 42716636.1446; val_kl_reg_loss: 18974.8473; val_edge_recon_loss: 25463019.9750; val_gene_expr_recon_loss: 17913306.2625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43395300.8000; val_optim_loss: 43395300.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9970; val_auprc_score: 0.9962; val_best_acc_score: 0.9846; val_best_f1_score: 0.9847; train_kl_reg_loss: 19261.7236; train_edge_recon_loss: 25447361.6245; train_gene_expr_recon_loss: 17218549.5285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42685172.8345; train_optim_loss: 42685172.8345; val_kl_reg_loss: 19189.1124; val_edge_recon_loss: 25477387.8500; val_gene_expr_recon_loss: 17931907.4875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43428484.8500; val_optim_loss: 43428484.8500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9969; val_auprc_score: 0.9958; val_best_acc_score: 0.9844; val_best_f1_score: 0.9846; train_kl_reg_loss: 19363.2974; train_edge_recon_loss: 25445850.7789; train_gene_expr_recon_loss: 17203207.9388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42668422.0918; train_optim_loss: 42668422.0918; val_kl_reg_loss: 19208.6411; val_edge_recon_loss: 25495007.3500; val_gene_expr_recon_loss: 17888528.7750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43402744.9500; val_optim_loss: 43402744.9500
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9971; val_auprc_score: 0.9962; val_best_acc_score: 0.9850; val_best_f1_score: 0.9852; train_kl_reg_loss: 19389.1716; train_edge_recon_loss: 25439804.5174; train_gene_expr_recon_loss: 17208725.7608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42667919.4214; train_optim_loss: 42667919.4214; val_kl_reg_loss: 19240.3759; val_edge_recon_loss: 25468826.6500; val_gene_expr_recon_loss: 17909717.2750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43397784.3500; val_optim_loss: 43397784.3500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9969; val_auprc_score: 0.9960; val_best_acc_score: 0.9841; val_best_f1_score: 0.9843; train_kl_reg_loss: 19395.0569; train_edge_recon_loss: 25445497.7413; train_gene_expr_recon_loss: 17202838.9499; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42667731.8554; train_optim_loss: 42667731.8554; val_kl_reg_loss: 19217.1093; val_edge_recon_loss: 25509172.1000; val_gene_expr_recon_loss: 17838689.5750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43367079.1000; val_optim_loss: 43367079.1000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 333 min 47 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
Val AUROC score: 0.9970
Val AUPRC score: 0.9962
Val best accuracy score: 0.9843
Val best F1 score: 0.9844
Val gene expr MSE score: 0.4706

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
