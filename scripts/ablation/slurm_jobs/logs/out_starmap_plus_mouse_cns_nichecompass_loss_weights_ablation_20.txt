None
Run timestamp: 30062023_102940_20.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_20']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
heaps
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9890; val_auprc_score: 0.9852; val_best_acc_score: 0.9615; val_best_f1_score: 0.9623; train_kl_reg_loss: 2361.1310; train_edge_recon_loss: 27775.6160; train_gene_expr_recon_loss: 12729.1207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42865.8677; train_optim_loss: 42865.8677; val_kl_reg_loss: 2463.2157; val_edge_recon_loss: 26145.8656; val_gene_expr_recon_loss: 11497.8974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40106.9785; val_optim_loss: 40106.9785
heaps
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9919; val_auprc_score: 0.9891; val_best_acc_score: 0.9692; val_best_f1_score: 0.9697; train_kl_reg_loss: 2499.2324; train_edge_recon_loss: 27218.2235; train_gene_expr_recon_loss: 11179.0381; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40896.4939; train_optim_loss: 40896.4939; val_kl_reg_loss: 2455.6023; val_edge_recon_loss: 26036.5755; val_gene_expr_recon_loss: 10872.8093; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39364.9871; val_optim_loss: 39364.9871
heaps
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9928; val_auprc_score: 0.9905; val_best_acc_score: 0.9724; val_best_f1_score: 0.9728; train_kl_reg_loss: 2519.6209; train_edge_recon_loss: 27126.9184; train_gene_expr_recon_loss: 10747.1010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40393.6403; train_optim_loss: 40393.6403; val_kl_reg_loss: 2595.8800; val_edge_recon_loss: 25990.8820; val_gene_expr_recon_loss: 10538.8757; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39125.6375; val_optim_loss: 39125.6375
heaps
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9937; val_auprc_score: 0.9916; val_best_acc_score: 0.9741; val_best_f1_score: 0.9745; train_kl_reg_loss: 2534.1177; train_edge_recon_loss: 27077.2167; train_gene_expr_recon_loss: 10508.2255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40119.5599; train_optim_loss: 40119.5599; val_kl_reg_loss: 2491.9760; val_edge_recon_loss: 25931.6934; val_gene_expr_recon_loss: 10405.9670; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38829.6366; val_optim_loss: 38829.6366
heaps
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9945; val_auprc_score: 0.9925; val_best_acc_score: 0.9763; val_best_f1_score: 0.9766; train_kl_reg_loss: 2546.0513; train_edge_recon_loss: 27041.8091; train_gene_expr_recon_loss: 10357.9700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39945.8303; train_optim_loss: 39945.8303; val_kl_reg_loss: 2534.7233; val_edge_recon_loss: 25894.7382; val_gene_expr_recon_loss: 10287.5378; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38716.9993; val_optim_loss: 38716.9993
heaps
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9955; val_auprc_score: 0.9942; val_best_acc_score: 0.9785; val_best_f1_score: 0.9788; train_kl_reg_loss: 2559.7316; train_edge_recon_loss: 26997.5882; train_gene_expr_recon_loss: 10245.0526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39802.3724; train_optim_loss: 39802.3724; val_kl_reg_loss: 2553.9697; val_edge_recon_loss: 25870.5475; val_gene_expr_recon_loss: 10164.5381; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38589.0552; val_optim_loss: 38589.0552
heaps
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9957; val_auprc_score: 0.9944; val_best_acc_score: 0.9788; val_best_f1_score: 0.9791; train_kl_reg_loss: 2571.7304; train_edge_recon_loss: 26965.6609; train_gene_expr_recon_loss: 10182.7275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39720.1187; train_optim_loss: 39720.1187; val_kl_reg_loss: 2589.8872; val_edge_recon_loss: 25814.1407; val_gene_expr_recon_loss: 10128.8277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38532.8558; val_optim_loss: 38532.8558
heaps
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 2582.4433; train_edge_recon_loss: 26938.5715; train_gene_expr_recon_loss: 10119.8475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39640.8622; train_optim_loss: 39640.8622; val_kl_reg_loss: 2580.8299; val_edge_recon_loss: 25775.2279; val_gene_expr_recon_loss: 10067.2339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38423.2916; val_optim_loss: 38423.2916
heaps
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9964; val_auprc_score: 0.9952; val_best_acc_score: 0.9813; val_best_f1_score: 0.9815; train_kl_reg_loss: 2591.1330; train_edge_recon_loss: 26913.2495; train_gene_expr_recon_loss: 10084.6125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39588.9949; train_optim_loss: 39588.9949; val_kl_reg_loss: 2605.8826; val_edge_recon_loss: 25794.3472; val_gene_expr_recon_loss: 10071.3156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38471.5456; val_optim_loss: 38471.5456
heaps
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9968; val_auprc_score: 0.9959; val_best_acc_score: 0.9825; val_best_f1_score: 0.9826; train_kl_reg_loss: 2598.5355; train_edge_recon_loss: 26900.1473; train_gene_expr_recon_loss: 10042.8032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39541.4860; train_optim_loss: 39541.4860; val_kl_reg_loss: 2586.1999; val_edge_recon_loss: 25728.5099; val_gene_expr_recon_loss: 10022.1409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38336.8504; val_optim_loss: 38336.8504
heaps
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9970; val_auprc_score: 0.9961; val_best_acc_score: 0.9831; val_best_f1_score: 0.9833; train_kl_reg_loss: 2609.3732; train_edge_recon_loss: 26866.7386; train_gene_expr_recon_loss: 10025.6951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39501.8070; train_optim_loss: 39501.8070; val_kl_reg_loss: 2558.4259; val_edge_recon_loss: 25736.1796; val_gene_expr_recon_loss: 10031.0609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38325.6666; val_optim_loss: 38325.6666
heaps
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9970; val_auprc_score: 0.9962; val_best_acc_score: 0.9830; val_best_f1_score: 0.9832; train_kl_reg_loss: 2616.6995; train_edge_recon_loss: 26850.3659; train_gene_expr_recon_loss: 9999.0990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39466.1643; train_optim_loss: 39466.1643; val_kl_reg_loss: 2557.5817; val_edge_recon_loss: 25724.2166; val_gene_expr_recon_loss: 10005.8247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38287.6230; val_optim_loss: 38287.6230
heaps
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9972; val_auprc_score: 0.9963; val_best_acc_score: 0.9838; val_best_f1_score: 0.9840; train_kl_reg_loss: 2620.6899; train_edge_recon_loss: 26852.2287; train_gene_expr_recon_loss: 9972.7494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39445.6680; train_optim_loss: 39445.6680; val_kl_reg_loss: 2648.8908; val_edge_recon_loss: 25711.6456; val_gene_expr_recon_loss: 9980.1174; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38340.6536; val_optim_loss: 38340.6536
heaps
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9976; val_auprc_score: 0.9971; val_best_acc_score: 0.9848; val_best_f1_score: 0.9850; train_kl_reg_loss: 2627.6889; train_edge_recon_loss: 26832.7913; train_gene_expr_recon_loss: 9953.3195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39413.7997; train_optim_loss: 39413.7997; val_kl_reg_loss: 2620.3127; val_edge_recon_loss: 25687.7138; val_gene_expr_recon_loss: 10010.2298; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38318.2562; val_optim_loss: 38318.2562
heaps
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9973; val_auprc_score: 0.9962; val_best_acc_score: 0.9848; val_best_f1_score: 0.9849; train_kl_reg_loss: 2634.5476; train_edge_recon_loss: 26819.1704; train_gene_expr_recon_loss: 9942.9027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39396.6207; train_optim_loss: 39396.6207; val_kl_reg_loss: 2662.6952; val_edge_recon_loss: 25707.5691; val_gene_expr_recon_loss: 9961.7552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38332.0196; val_optim_loss: 38332.0196
heaps
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9977; val_auprc_score: 0.9970; val_best_acc_score: 0.9866; val_best_f1_score: 0.9867; train_kl_reg_loss: 2639.6932; train_edge_recon_loss: 26806.4500; train_gene_expr_recon_loss: 9927.1525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39373.2957; train_optim_loss: 39373.2957; val_kl_reg_loss: 2621.7762; val_edge_recon_loss: 25657.8600; val_gene_expr_recon_loss: 9988.1977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38267.8336; val_optim_loss: 38267.8336
heaps
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9979; val_auprc_score: 0.9973; val_best_acc_score: 0.9865; val_best_f1_score: 0.9867; train_kl_reg_loss: 2643.6602; train_edge_recon_loss: 26804.6996; train_gene_expr_recon_loss: 9909.2145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39357.5744; train_optim_loss: 39357.5744; val_kl_reg_loss: 2625.6308; val_edge_recon_loss: 25670.2459; val_gene_expr_recon_loss: 9962.8901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38258.7666; val_optim_loss: 38258.7666
heaps
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9976; val_auprc_score: 0.9970; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 2647.4142; train_edge_recon_loss: 26800.9324; train_gene_expr_recon_loss: 9896.8056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39345.1522; train_optim_loss: 39345.1522; val_kl_reg_loss: 2655.9216; val_edge_recon_loss: 25687.0750; val_gene_expr_recon_loss: 9939.3944; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38282.3910; val_optim_loss: 38282.3910
heaps
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9979; val_auprc_score: 0.9971; val_best_acc_score: 0.9868; val_best_f1_score: 0.9869; train_kl_reg_loss: 2652.1183; train_edge_recon_loss: 26793.2678; train_gene_expr_recon_loss: 9898.8486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39344.2347; train_optim_loss: 39344.2347; val_kl_reg_loss: 2671.5144; val_edge_recon_loss: 25654.6670; val_gene_expr_recon_loss: 9943.8526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38270.0342; val_optim_loss: 38270.0342
heaps
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9979; val_auprc_score: 0.9972; val_best_acc_score: 0.9872; val_best_f1_score: 0.9873; train_kl_reg_loss: 2654.7031; train_edge_recon_loss: 26789.2008; train_gene_expr_recon_loss: 9880.7305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39324.6345; train_optim_loss: 39324.6345; val_kl_reg_loss: 2638.8704; val_edge_recon_loss: 25631.2232; val_gene_expr_recon_loss: 9996.6898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38266.7835; val_optim_loss: 38266.7835
heaps
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9980; val_auprc_score: 0.9971; val_best_acc_score: 0.9874; val_best_f1_score: 0.9875; train_kl_reg_loss: 2658.9964; train_edge_recon_loss: 26780.7537; train_gene_expr_recon_loss: 9874.9181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39314.6681; train_optim_loss: 39314.6681; val_kl_reg_loss: 2689.2701; val_edge_recon_loss: 25627.6661; val_gene_expr_recon_loss: 9947.2129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38264.1488; val_optim_loss: 38264.1488

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

heaps
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9980; val_auprc_score: 0.9973; val_best_acc_score: 0.9875; val_best_f1_score: 0.9875; train_kl_reg_loss: 2659.2457; train_edge_recon_loss: 26758.7634; train_gene_expr_recon_loss: 9825.7164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39243.7255; train_optim_loss: 39243.7255; val_kl_reg_loss: 2676.9444; val_edge_recon_loss: 25638.7584; val_gene_expr_recon_loss: 9924.7855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38240.4884; val_optim_loss: 38240.4884
heaps
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9983; val_auprc_score: 0.9977; val_best_acc_score: 0.9880; val_best_f1_score: 0.9881; train_kl_reg_loss: 2658.1102; train_edge_recon_loss: 26756.8810; train_gene_expr_recon_loss: 9815.8090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39230.8002; train_optim_loss: 39230.8002; val_kl_reg_loss: 2669.3209; val_edge_recon_loss: 25631.9539; val_gene_expr_recon_loss: 9941.9690; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38243.2438; val_optim_loss: 38243.2438
heaps
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9880; val_best_f1_score: 0.9881; train_kl_reg_loss: 2657.8241; train_edge_recon_loss: 26755.2364; train_gene_expr_recon_loss: 9811.7659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39224.8263; train_optim_loss: 39224.8263; val_kl_reg_loss: 2666.8672; val_edge_recon_loss: 25625.3684; val_gene_expr_recon_loss: 9936.7284; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38228.9640; val_optim_loss: 38228.9640
heaps
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9982; val_auprc_score: 0.9973; val_best_acc_score: 0.9879; val_best_f1_score: 0.9880; train_kl_reg_loss: 2657.7093; train_edge_recon_loss: 26757.8017; train_gene_expr_recon_loss: 9806.3661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39221.8770; train_optim_loss: 39221.8770; val_kl_reg_loss: 2667.4924; val_edge_recon_loss: 25639.0077; val_gene_expr_recon_loss: 9920.6642; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38227.1644; val_optim_loss: 38227.1644
heaps
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9983; val_auprc_score: 0.9977; val_best_acc_score: 0.9884; val_best_f1_score: 0.9884; train_kl_reg_loss: 2657.0637; train_edge_recon_loss: 26758.8307; train_gene_expr_recon_loss: 9805.4206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39221.3150; train_optim_loss: 39221.3150; val_kl_reg_loss: 2669.9144; val_edge_recon_loss: 25615.6333; val_gene_expr_recon_loss: 9924.9345; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38210.4821; val_optim_loss: 38210.4821
heaps
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9878; val_best_f1_score: 0.9878; train_kl_reg_loss: 2659.3401; train_edge_recon_loss: 26750.9363; train_gene_expr_recon_loss: 9807.4673; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39217.7437; train_optim_loss: 39217.7437; val_kl_reg_loss: 2665.8799; val_edge_recon_loss: 25622.1066; val_gene_expr_recon_loss: 9916.8141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38204.8005; val_optim_loss: 38204.8005
heaps
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9884; val_best_f1_score: 0.9885; train_kl_reg_loss: 2658.0589; train_edge_recon_loss: 26757.1971; train_gene_expr_recon_loss: 9794.6203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39209.8764; train_optim_loss: 39209.8764; val_kl_reg_loss: 2655.9625; val_edge_recon_loss: 25621.1715; val_gene_expr_recon_loss: 9926.0697; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38203.2035; val_optim_loss: 38203.2035
heaps
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9877; val_best_f1_score: 0.9878; train_kl_reg_loss: 2659.1747; train_edge_recon_loss: 26752.7982; train_gene_expr_recon_loss: 9800.3147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39212.2876; train_optim_loss: 39212.2876; val_kl_reg_loss: 2671.4683; val_edge_recon_loss: 25631.3885; val_gene_expr_recon_loss: 9957.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38260.6771; val_optim_loss: 38260.6771
heaps
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9984; val_auprc_score: 0.9979; val_best_acc_score: 0.9885; val_best_f1_score: 0.9885; train_kl_reg_loss: 2659.3042; train_edge_recon_loss: 26756.5717; train_gene_expr_recon_loss: 9804.9203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39220.7963; train_optim_loss: 39220.7963; val_kl_reg_loss: 2662.2723; val_edge_recon_loss: 25627.4233; val_gene_expr_recon_loss: 9933.9841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38223.6796; val_optim_loss: 38223.6796
heaps
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9982; val_auprc_score: 0.9974; val_best_acc_score: 0.9883; val_best_f1_score: 0.9883; train_kl_reg_loss: 2661.5051; train_edge_recon_loss: 26743.1004; train_gene_expr_recon_loss: 9798.1984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39202.8039; train_optim_loss: 39202.8039; val_kl_reg_loss: 2670.6225; val_edge_recon_loss: 25614.4730; val_gene_expr_recon_loss: 9928.1281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38213.2236; val_optim_loss: 38213.2236
heaps
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9883; val_best_f1_score: 0.9884; train_kl_reg_loss: 2660.5456; train_edge_recon_loss: 26751.4941; train_gene_expr_recon_loss: 9794.1112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39206.1509; train_optim_loss: 39206.1509; val_kl_reg_loss: 2665.7420; val_edge_recon_loss: 25596.0997; val_gene_expr_recon_loss: 9935.4399; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38197.2819; val_optim_loss: 38197.2819
heaps
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9877; val_best_f1_score: 0.9878; train_kl_reg_loss: 2661.2498; train_edge_recon_loss: 26747.9650; train_gene_expr_recon_loss: 9787.6878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39196.9026; train_optim_loss: 39196.9026; val_kl_reg_loss: 2670.0698; val_edge_recon_loss: 25636.0414; val_gene_expr_recon_loss: 9913.6425; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38219.7537; val_optim_loss: 38219.7537
heaps
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9883; val_best_f1_score: 0.9884; train_kl_reg_loss: 2662.7117; train_edge_recon_loss: 26744.6454; train_gene_expr_recon_loss: 9791.9205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39199.2775; train_optim_loss: 39199.2775; val_kl_reg_loss: 2669.2961; val_edge_recon_loss: 25606.2524; val_gene_expr_recon_loss: 9935.7251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38211.2735; val_optim_loss: 38211.2735
heaps
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9983; val_auprc_score: 0.9977; val_best_acc_score: 0.9882; val_best_f1_score: 0.9883; train_kl_reg_loss: 2662.4792; train_edge_recon_loss: 26748.7266; train_gene_expr_recon_loss: 9796.0146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39207.2203; train_optim_loss: 39207.2203; val_kl_reg_loss: 2681.1138; val_edge_recon_loss: 25613.0184; val_gene_expr_recon_loss: 9927.7058; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38221.8377; val_optim_loss: 38221.8377
heaps
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9983; val_auprc_score: 0.9977; val_best_acc_score: 0.9879; val_best_f1_score: 0.9880; train_kl_reg_loss: 2663.0655; train_edge_recon_loss: 26745.6708; train_gene_expr_recon_loss: 9792.2562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39200.9926; train_optim_loss: 39200.9926; val_kl_reg_loss: 2672.4318; val_edge_recon_loss: 25630.0267; val_gene_expr_recon_loss: 9951.9113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38254.3701; val_optim_loss: 38254.3701

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

heaps
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9981; val_auprc_score: 0.9974; val_best_acc_score: 0.9882; val_best_f1_score: 0.9882; train_kl_reg_loss: 2660.8021; train_edge_recon_loss: 26751.2769; train_gene_expr_recon_loss: 9785.2968; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39197.3757; train_optim_loss: 39197.3757; val_kl_reg_loss: 2677.1008; val_edge_recon_loss: 25616.4202; val_gene_expr_recon_loss: 9925.8677; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38219.3884; val_optim_loss: 38219.3884
heaps
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9983; val_auprc_score: 0.9978; val_best_acc_score: 0.9883; val_best_f1_score: 0.9883; train_kl_reg_loss: 2663.4069; train_edge_recon_loss: 26742.7746; train_gene_expr_recon_loss: 9783.8846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39190.0661; train_optim_loss: 39190.0661; val_kl_reg_loss: 2674.1549; val_edge_recon_loss: 25611.4755; val_gene_expr_recon_loss: 9944.8611; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38230.4917; val_optim_loss: 38230.4917
heaps
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9983; val_auprc_score: 0.9976; val_best_acc_score: 0.9885; val_best_f1_score: 0.9886; train_kl_reg_loss: 2662.3943; train_edge_recon_loss: 26744.6152; train_gene_expr_recon_loss: 9776.4265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39183.4359; train_optim_loss: 39183.4359; val_kl_reg_loss: 2675.7952; val_edge_recon_loss: 25602.6158; val_gene_expr_recon_loss: 9936.3024; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38214.7133; val_optim_loss: 38214.7133
heaps
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9983; val_auprc_score: 0.9978; val_best_acc_score: 0.9881; val_best_f1_score: 0.9882; train_kl_reg_loss: 2663.3777; train_edge_recon_loss: 26739.7012; train_gene_expr_recon_loss: 9779.0505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39182.1295; train_optim_loss: 39182.1295; val_kl_reg_loss: 2676.8149; val_edge_recon_loss: 25619.8197; val_gene_expr_recon_loss: 9942.2776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38238.9123; val_optim_loss: 38238.9123

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 369 min 54 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
Val AUROC score: 0.9982
Val AUPRC score: 0.9975
Val best accuracy score: 0.9881
Val best F1 score: 0.9882
Val gene expr MSE score: 0.6443

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
