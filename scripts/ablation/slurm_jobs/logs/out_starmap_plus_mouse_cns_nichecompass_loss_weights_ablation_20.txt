None
Run timestamp: 02072023_113943_20.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_20']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9884; val_auprc_score: 0.9838; val_best_acc_score: 0.9610; val_best_f1_score: 0.9618; train_kl_reg_loss: 2309.6915; train_edge_recon_loss: 27731.2021; train_gene_expr_recon_loss: 12563.1649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42604.0585; train_optim_loss: 42604.0585; val_kl_reg_loss: 2314.9312; val_edge_recon_loss: 26185.1446; val_gene_expr_recon_loss: 11346.9684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39847.0443; val_optim_loss: 39847.0443
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9919; val_auprc_score: 0.9892; val_best_acc_score: 0.9692; val_best_f1_score: 0.9698; train_kl_reg_loss: 2444.1570; train_edge_recon_loss: 27169.1644; train_gene_expr_recon_loss: 11031.3023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40644.6238; train_optim_loss: 40644.6238; val_kl_reg_loss: 2449.4030; val_edge_recon_loss: 26091.2358; val_gene_expr_recon_loss: 10715.7488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39256.3877; val_optim_loss: 39256.3877
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9931; val_auprc_score: 0.9906; val_best_acc_score: 0.9726; val_best_f1_score: 0.9731; train_kl_reg_loss: 2463.2453; train_edge_recon_loss: 27092.3141; train_gene_expr_recon_loss: 10596.2761; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40151.8354; train_optim_loss: 40151.8354; val_kl_reg_loss: 2436.6283; val_edge_recon_loss: 25908.3058; val_gene_expr_recon_loss: 10463.8850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38808.8192; val_optim_loss: 38808.8192
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9937; val_auprc_score: 0.9916; val_best_acc_score: 0.9748; val_best_f1_score: 0.9751; train_kl_reg_loss: 2480.1784; train_edge_recon_loss: 27028.0750; train_gene_expr_recon_loss: 10346.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39854.7144; train_optim_loss: 39854.7144; val_kl_reg_loss: 2421.5921; val_edge_recon_loss: 25914.6392; val_gene_expr_recon_loss: 10229.2112; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38565.4427; val_optim_loss: 38565.4427
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9946; val_auprc_score: 0.9926; val_best_acc_score: 0.9765; val_best_f1_score: 0.9768; train_kl_reg_loss: 2494.4552; train_edge_recon_loss: 26986.4204; train_gene_expr_recon_loss: 10189.6281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39670.5037; train_optim_loss: 39670.5037; val_kl_reg_loss: 2449.3489; val_edge_recon_loss: 25897.8062; val_gene_expr_recon_loss: 10134.8306; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38481.9855; val_optim_loss: 38481.9855
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9954; val_auprc_score: 0.9940; val_best_acc_score: 0.9784; val_best_f1_score: 0.9786; train_kl_reg_loss: 2509.1340; train_edge_recon_loss: 26939.6935; train_gene_expr_recon_loss: 10089.5105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39538.3381; train_optim_loss: 39538.3381; val_kl_reg_loss: 2514.7337; val_edge_recon_loss: 25848.0339; val_gene_expr_recon_loss: 10018.7706; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38381.5385; val_optim_loss: 38381.5385
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9959; val_auprc_score: 0.9945; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 2521.2490; train_edge_recon_loss: 26909.9759; train_gene_expr_recon_loss: 10014.0259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39445.2508; train_optim_loss: 39445.2508; val_kl_reg_loss: 2482.6499; val_edge_recon_loss: 25809.8434; val_gene_expr_recon_loss: 9994.2686; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38286.7619; val_optim_loss: 38286.7619
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9960; val_auprc_score: 0.9950; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 2531.6241; train_edge_recon_loss: 26879.4175; train_gene_expr_recon_loss: 9958.2125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39369.2541; train_optim_loss: 39369.2541; val_kl_reg_loss: 2495.2867; val_edge_recon_loss: 25770.7218; val_gene_expr_recon_loss: 9952.9097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38218.9180; val_optim_loss: 38218.9180
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9966; val_auprc_score: 0.9957; val_best_acc_score: 0.9817; val_best_f1_score: 0.9819; train_kl_reg_loss: 2543.8421; train_edge_recon_loss: 26849.8773; train_gene_expr_recon_loss: 9918.1228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39311.8422; train_optim_loss: 39311.8422; val_kl_reg_loss: 2542.8907; val_edge_recon_loss: 25771.6366; val_gene_expr_recon_loss: 9900.1212; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38214.6483; val_optim_loss: 38214.6483
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9966; val_auprc_score: 0.9955; val_best_acc_score: 0.9825; val_best_f1_score: 0.9827; train_kl_reg_loss: 2550.6281; train_edge_recon_loss: 26837.8215; train_gene_expr_recon_loss: 9879.9080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39268.3575; train_optim_loss: 39268.3575; val_kl_reg_loss: 2562.9898; val_edge_recon_loss: 25744.0560; val_gene_expr_recon_loss: 9895.5144; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38202.5603; val_optim_loss: 38202.5603
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9971; val_auprc_score: 0.9961; val_best_acc_score: 0.9837; val_best_f1_score: 0.9839; train_kl_reg_loss: 2558.3574; train_edge_recon_loss: 26822.7470; train_gene_expr_recon_loss: 9846.9669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39228.0712; train_optim_loss: 39228.0712; val_kl_reg_loss: 2581.5739; val_edge_recon_loss: 25717.8455; val_gene_expr_recon_loss: 9851.0705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38150.4900; val_optim_loss: 38150.4900
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9972; val_auprc_score: 0.9964; val_best_acc_score: 0.9841; val_best_f1_score: 0.9842; train_kl_reg_loss: 2566.2311; train_edge_recon_loss: 26802.2607; train_gene_expr_recon_loss: 9835.2877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39203.7794; train_optim_loss: 39203.7794; val_kl_reg_loss: 2572.4387; val_edge_recon_loss: 25698.6010; val_gene_expr_recon_loss: 9843.1503; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38114.1900; val_optim_loss: 38114.1900
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9975; val_auprc_score: 0.9966; val_best_acc_score: 0.9848; val_best_f1_score: 0.9850; train_kl_reg_loss: 2573.2413; train_edge_recon_loss: 26787.9572; train_gene_expr_recon_loss: 9806.8535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39168.0520; train_optim_loss: 39168.0520; val_kl_reg_loss: 2534.7375; val_edge_recon_loss: 25685.3485; val_gene_expr_recon_loss: 9860.3455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38080.4314; val_optim_loss: 38080.4314
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9976; val_auprc_score: 0.9969; val_best_acc_score: 0.9848; val_best_f1_score: 0.9849; train_kl_reg_loss: 2579.9227; train_edge_recon_loss: 26772.7995; train_gene_expr_recon_loss: 9791.4336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39144.1557; train_optim_loss: 39144.1557; val_kl_reg_loss: 2558.6856; val_edge_recon_loss: 25683.4461; val_gene_expr_recon_loss: 9853.2477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38095.3793; val_optim_loss: 38095.3793
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9977; val_auprc_score: 0.9969; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 2584.1005; train_edge_recon_loss: 26767.7833; train_gene_expr_recon_loss: 9774.3787; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39126.2624; train_optim_loss: 39126.2624; val_kl_reg_loss: 2583.6721; val_edge_recon_loss: 25656.4370; val_gene_expr_recon_loss: 9821.8418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38061.9507; val_optim_loss: 38061.9507
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9978; val_auprc_score: 0.9972; val_best_acc_score: 0.9862; val_best_f1_score: 0.9863; train_kl_reg_loss: 2589.6285; train_edge_recon_loss: 26756.2091; train_gene_expr_recon_loss: 9760.4489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39106.2865; train_optim_loss: 39106.2865; val_kl_reg_loss: 2570.3197; val_edge_recon_loss: 25660.3515; val_gene_expr_recon_loss: 9865.8545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38096.5256; val_optim_loss: 38096.5256
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9978; val_auprc_score: 0.9969; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 2593.9434; train_edge_recon_loss: 26748.2862; train_gene_expr_recon_loss: 9750.9855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39093.2150; train_optim_loss: 39093.2150; val_kl_reg_loss: 2589.6564; val_edge_recon_loss: 25664.7297; val_gene_expr_recon_loss: 9841.3627; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38095.7489; val_optim_loss: 38095.7489
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9980; val_auprc_score: 0.9972; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 2598.4888; train_edge_recon_loss: 26734.7355; train_gene_expr_recon_loss: 9744.3941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39077.6185; train_optim_loss: 39077.6185; val_kl_reg_loss: 2600.3002; val_edge_recon_loss: 25641.8480; val_gene_expr_recon_loss: 9828.6742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38070.8224; val_optim_loss: 38070.8224
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9979; val_auprc_score: 0.9972; val_best_acc_score: 0.9872; val_best_f1_score: 0.9873; train_kl_reg_loss: 2601.3172; train_edge_recon_loss: 26737.0042; train_gene_expr_recon_loss: 9727.4932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39065.8146; train_optim_loss: 39065.8146; val_kl_reg_loss: 2578.8875; val_edge_recon_loss: 25639.0814; val_gene_expr_recon_loss: 9821.7844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38039.7536; val_optim_loss: 38039.7536
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9980; val_auprc_score: 0.9974; val_best_acc_score: 0.9875; val_best_f1_score: 0.9876; train_kl_reg_loss: 2606.3034; train_edge_recon_loss: 26721.4354; train_gene_expr_recon_loss: 9714.9405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39042.6793; train_optim_loss: 39042.6793; val_kl_reg_loss: 2616.6353; val_edge_recon_loss: 25632.2066; val_gene_expr_recon_loss: 9818.0787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38066.9205; val_optim_loss: 38066.9205
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9980; val_auprc_score: 0.9973; val_best_acc_score: 0.9874; val_best_f1_score: 0.9875; train_kl_reg_loss: 2607.7713; train_edge_recon_loss: 26726.7734; train_gene_expr_recon_loss: 9713.9676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39048.5123; train_optim_loss: 39048.5123; val_kl_reg_loss: 2600.6150; val_edge_recon_loss: 25623.9071; val_gene_expr_recon_loss: 9792.0969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38016.6191; val_optim_loss: 38016.6191
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9982; val_auprc_score: 0.9976; val_best_acc_score: 0.9879; val_best_f1_score: 0.9880; train_kl_reg_loss: 2610.0018; train_edge_recon_loss: 26723.3773; train_gene_expr_recon_loss: 9699.5592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39032.9383; train_optim_loss: 39032.9383; val_kl_reg_loss: 2636.4086; val_edge_recon_loss: 25633.1900; val_gene_expr_recon_loss: 9819.9329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38089.5314; val_optim_loss: 38089.5314
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9981; val_auprc_score: 0.9976; val_best_acc_score: 0.9871; val_best_f1_score: 0.9872; train_kl_reg_loss: 2615.2827; train_edge_recon_loss: 26705.8303; train_gene_expr_recon_loss: 9696.0073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39017.1203; train_optim_loss: 39017.1203; val_kl_reg_loss: 2612.2903; val_edge_recon_loss: 25640.9333; val_gene_expr_recon_loss: 9833.8372; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38087.0609; val_optim_loss: 38087.0609
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9983; val_auprc_score: 0.9977; val_best_acc_score: 0.9881; val_best_f1_score: 0.9882; train_kl_reg_loss: 2618.2866; train_edge_recon_loss: 26698.5987; train_gene_expr_recon_loss: 9683.0007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38999.8861; train_optim_loss: 38999.8861; val_kl_reg_loss: 2655.2603; val_edge_recon_loss: 25628.4843; val_gene_expr_recon_loss: 9828.1290; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38111.8737; val_optim_loss: 38111.8737
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9882; val_best_f1_score: 0.9883; train_kl_reg_loss: 2619.5526; train_edge_recon_loss: 26702.0300; train_gene_expr_recon_loss: 9680.6987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39002.2813; train_optim_loss: 39002.2813; val_kl_reg_loss: 2589.2612; val_edge_recon_loss: 25623.6757; val_gene_expr_recon_loss: 9831.5834; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38044.5203; val_optim_loss: 38044.5203

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9985; val_auprc_score: 0.9979; val_best_acc_score: 0.9888; val_best_f1_score: 0.9888; train_kl_reg_loss: 2618.4386; train_edge_recon_loss: 26685.2890; train_gene_expr_recon_loss: 9632.1243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38935.8520; train_optim_loss: 38935.8520; val_kl_reg_loss: 2625.8703; val_edge_recon_loss: 25597.6216; val_gene_expr_recon_loss: 9785.6960; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38009.1879; val_optim_loss: 38009.1879
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9985; val_auprc_score: 0.9979; val_best_acc_score: 0.9889; val_best_f1_score: 0.9889; train_kl_reg_loss: 2616.5908; train_edge_recon_loss: 26684.0304; train_gene_expr_recon_loss: 9623.5797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38924.2009; train_optim_loss: 38924.2009; val_kl_reg_loss: 2628.8090; val_edge_recon_loss: 25586.6920; val_gene_expr_recon_loss: 9799.1785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38014.6794; val_optim_loss: 38014.6794
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9884; val_best_f1_score: 0.9885; train_kl_reg_loss: 2616.1003; train_edge_recon_loss: 26687.0633; train_gene_expr_recon_loss: 9617.8717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38921.0353; train_optim_loss: 38921.0353; val_kl_reg_loss: 2626.5196; val_edge_recon_loss: 25621.4687; val_gene_expr_recon_loss: 9801.4137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38049.4020; val_optim_loss: 38049.4020
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9887; val_best_f1_score: 0.9888; train_kl_reg_loss: 2615.2629; train_edge_recon_loss: 26689.4466; train_gene_expr_recon_loss: 9623.2960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38928.0056; train_optim_loss: 38928.0056; val_kl_reg_loss: 2635.0245; val_edge_recon_loss: 25596.6244; val_gene_expr_recon_loss: 9790.9265; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38022.5756; val_optim_loss: 38022.5756
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9888; val_best_f1_score: 0.9888; train_kl_reg_loss: 2615.4341; train_edge_recon_loss: 26686.7751; train_gene_expr_recon_loss: 9615.1982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38917.4075; train_optim_loss: 38917.4075; val_kl_reg_loss: 2631.1319; val_edge_recon_loss: 25592.1810; val_gene_expr_recon_loss: 9803.3174; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38026.6301; val_optim_loss: 38026.6301

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9984; val_auprc_score: 0.9978; val_best_acc_score: 0.9888; val_best_f1_score: 0.9889; train_kl_reg_loss: 2618.3662; train_edge_recon_loss: 26678.8298; train_gene_expr_recon_loss: 9613.1851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38910.3811; train_optim_loss: 38910.3811; val_kl_reg_loss: 2630.6848; val_edge_recon_loss: 25592.5310; val_gene_expr_recon_loss: 9798.4845; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38021.7002; val_optim_loss: 38021.7002
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9888; val_best_f1_score: 0.9889; train_kl_reg_loss: 2617.2595; train_edge_recon_loss: 26676.6434; train_gene_expr_recon_loss: 9605.8164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38899.7193; train_optim_loss: 38899.7193; val_kl_reg_loss: 2630.9277; val_edge_recon_loss: 25589.9456; val_gene_expr_recon_loss: 9789.1288; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38010.0022; val_optim_loss: 38010.0022
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9891; val_best_f1_score: 0.9892; train_kl_reg_loss: 2615.7575; train_edge_recon_loss: 26686.0236; train_gene_expr_recon_loss: 9609.0747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38910.8558; train_optim_loss: 38910.8558; val_kl_reg_loss: 2628.8595; val_edge_recon_loss: 25580.6873; val_gene_expr_recon_loss: 9788.5176; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37998.0645; val_optim_loss: 37998.0645
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9985; val_auprc_score: 0.9980; val_best_acc_score: 0.9889; val_best_f1_score: 0.9890; train_kl_reg_loss: 2616.4615; train_edge_recon_loss: 26681.4013; train_gene_expr_recon_loss: 9609.9840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38907.8469; train_optim_loss: 38907.8469; val_kl_reg_loss: 2628.3302; val_edge_recon_loss: 25604.7320; val_gene_expr_recon_loss: 9815.1221; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38048.1845; val_optim_loss: 38048.1845
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9984; val_auprc_score: 0.9979; val_best_acc_score: 0.9891; val_best_f1_score: 0.9892; train_kl_reg_loss: 2616.1866; train_edge_recon_loss: 26680.4654; train_gene_expr_recon_loss: 9608.4989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38905.1510; train_optim_loss: 38905.1510; val_kl_reg_loss: 2630.7794; val_edge_recon_loss: 25589.1772; val_gene_expr_recon_loss: 9802.2384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38022.1953; val_optim_loss: 38022.1953
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9984; val_auprc_score: 0.9979; val_best_acc_score: 0.9888; val_best_f1_score: 0.9889; train_kl_reg_loss: 2617.0503; train_edge_recon_loss: 26674.8637; train_gene_expr_recon_loss: 9610.0254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38901.9394; train_optim_loss: 38901.9394; val_kl_reg_loss: 2630.1576; val_edge_recon_loss: 25616.5579; val_gene_expr_recon_loss: 9796.2550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38042.9705; val_optim_loss: 38042.9705
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9985; val_auprc_score: 0.9977; val_best_acc_score: 0.9888; val_best_f1_score: 0.9888; train_kl_reg_loss: 2616.6124; train_edge_recon_loss: 26683.5298; train_gene_expr_recon_loss: 9611.7841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38911.9263; train_optim_loss: 38911.9263; val_kl_reg_loss: 2628.7261; val_edge_recon_loss: 25610.1173; val_gene_expr_recon_loss: 9788.9745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38027.8178; val_optim_loss: 38027.8178

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9986; val_auprc_score: 0.9981; val_best_acc_score: 0.9890; val_best_f1_score: 0.9890; train_kl_reg_loss: 2615.6352; train_edge_recon_loss: 26683.4062; train_gene_expr_recon_loss: 9611.9140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38910.9555; train_optim_loss: 38910.9555; val_kl_reg_loss: 2629.7176; val_edge_recon_loss: 25606.6083; val_gene_expr_recon_loss: 9799.9705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38036.2965; val_optim_loss: 38036.2965
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9984; val_auprc_score: 0.9977; val_best_acc_score: 0.9888; val_best_f1_score: 0.9888; train_kl_reg_loss: 2617.0281; train_edge_recon_loss: 26677.3990; train_gene_expr_recon_loss: 9607.5065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38901.9337; train_optim_loss: 38901.9337; val_kl_reg_loss: 2630.7546; val_edge_recon_loss: 25593.1608; val_gene_expr_recon_loss: 9818.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38042.6239; val_optim_loss: 38042.6239
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9984; val_auprc_score: 0.9978; val_best_acc_score: 0.9891; val_best_f1_score: 0.9892; train_kl_reg_loss: 2616.6909; train_edge_recon_loss: 26681.0640; train_gene_expr_recon_loss: 9611.4821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38909.2370; train_optim_loss: 38909.2370; val_kl_reg_loss: 2630.7712; val_edge_recon_loss: 25589.2324; val_gene_expr_recon_loss: 9769.2884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37989.2920; val_optim_loss: 37989.2920
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9890; val_best_f1_score: 0.9890; train_kl_reg_loss: 2616.2652; train_edge_recon_loss: 26682.3148; train_gene_expr_recon_loss: 9608.3742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38906.9543; train_optim_loss: 38906.9543; val_kl_reg_loss: 2629.9889; val_edge_recon_loss: 25600.2923; val_gene_expr_recon_loss: 9808.2173; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38038.4985; val_optim_loss: 38038.4985
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9984; val_auprc_score: 0.9979; val_best_acc_score: 0.9885; val_best_f1_score: 0.9885; train_kl_reg_loss: 2616.5007; train_edge_recon_loss: 26681.2388; train_gene_expr_recon_loss: 9610.6427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38908.3824; train_optim_loss: 38908.3824; val_kl_reg_loss: 2630.4918; val_edge_recon_loss: 25617.0347; val_gene_expr_recon_loss: 9797.3083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38044.8348; val_optim_loss: 38044.8348
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9986; val_auprc_score: 0.9982; val_best_acc_score: 0.9887; val_best_f1_score: 0.9888; train_kl_reg_loss: 2616.8067; train_edge_recon_loss: 26677.0611; train_gene_expr_recon_loss: 9606.2946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38900.1625; train_optim_loss: 38900.1625; val_kl_reg_loss: 2631.1144; val_edge_recon_loss: 25606.3753; val_gene_expr_recon_loss: 9796.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38034.4661; val_optim_loss: 38034.4661
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9984; val_auprc_score: 0.9976; val_best_acc_score: 0.9885; val_best_f1_score: 0.9886; train_kl_reg_loss: 2617.0796; train_edge_recon_loss: 26678.6007; train_gene_expr_recon_loss: 9606.8011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38902.4815; train_optim_loss: 38902.4815; val_kl_reg_loss: 2629.7082; val_edge_recon_loss: 25611.7451; val_gene_expr_recon_loss: 9806.7768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38048.2302; val_optim_loss: 38048.2302

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9984; val_auprc_score: 0.9977; val_best_acc_score: 0.9890; val_best_f1_score: 0.9891; train_kl_reg_loss: 2616.5470; train_edge_recon_loss: 26682.4632; train_gene_expr_recon_loss: 9607.6074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38906.6177; train_optim_loss: 38906.6177; val_kl_reg_loss: 2630.2613; val_edge_recon_loss: 25603.4159; val_gene_expr_recon_loss: 9788.4811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38022.1583; val_optim_loss: 38022.1583
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9986; val_auprc_score: 0.9983; val_best_acc_score: 0.9893; val_best_f1_score: 0.9894; train_kl_reg_loss: 2616.5348; train_edge_recon_loss: 26680.9138; train_gene_expr_recon_loss: 9603.6936; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38901.1422; train_optim_loss: 38901.1422; val_kl_reg_loss: 2630.1153; val_edge_recon_loss: 25580.9744; val_gene_expr_recon_loss: 9800.7246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38011.8141; val_optim_loss: 38011.8141
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9986; val_auprc_score: 0.9981; val_best_acc_score: 0.9891; val_best_f1_score: 0.9892; train_kl_reg_loss: 2616.3800; train_edge_recon_loss: 26682.9079; train_gene_expr_recon_loss: 9606.0981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38905.3861; train_optim_loss: 38905.3861; val_kl_reg_loss: 2630.3322; val_edge_recon_loss: 25612.0388; val_gene_expr_recon_loss: 9817.3365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38059.7076; val_optim_loss: 38059.7076
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9985; val_auprc_score: 0.9977; val_best_acc_score: 0.9891; val_best_f1_score: 0.9892; train_kl_reg_loss: 2616.4745; train_edge_recon_loss: 26684.3204; train_gene_expr_recon_loss: 9600.5722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38901.3672; train_optim_loss: 38901.3672; val_kl_reg_loss: 2629.9588; val_edge_recon_loss: 25602.4956; val_gene_expr_recon_loss: 9792.7870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38025.2415; val_optim_loss: 38025.2415

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 448 min 11 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
Val AUROC score: 0.9985
Val AUPRC score: 0.9980
Val best accuracy score: 0.9887
Val best F1 score: 0.9888
Val gene expr MSE score: 0.6821

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
