None
Run timestamp: 19072023_194637_2.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '30000.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9494; val_auprc_score: 0.9366; val_best_acc_score: 0.8889; val_best_f1_score: 0.8956; train_kl_reg_loss: 51326.7947; train_edge_recon_loss: 27005591.6239; train_gene_expr_recon_loss: 7611119.5103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34668037.8853; train_optim_loss: 34668037.8853; val_kl_reg_loss: 48465.3534; val_edge_recon_loss: 26666019.8630; val_gene_expr_recon_loss: 7058764.6130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33773249.9178; val_optim_loss: 33773249.9178
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9634; val_auprc_score: 0.9553; val_best_acc_score: 0.9055; val_best_f1_score: 0.9098; train_kl_reg_loss: 45728.1153; train_edge_recon_loss: 26369805.8456; train_gene_expr_recon_loss: 6881628.1571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33297162.1529; train_optim_loss: 33297162.1529; val_kl_reg_loss: 42107.6451; val_edge_recon_loss: 26523703.2877; val_gene_expr_recon_loss: 6764330.4897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33330141.3973; val_optim_loss: 33330141.3973
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9732; val_auprc_score: 0.9680; val_best_acc_score: 0.9212; val_best_f1_score: 0.9238; train_kl_reg_loss: 38840.4372; train_edge_recon_loss: 26230935.0321; train_gene_expr_recon_loss: 6677418.3574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32947193.8180; train_optim_loss: 32947193.8180; val_kl_reg_loss: 36354.0214; val_edge_recon_loss: 26436439.0685; val_gene_expr_recon_loss: 6644834.3116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33117627.4521; val_optim_loss: 33117627.4521
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9771; val_auprc_score: 0.9725; val_best_acc_score: 0.9282; val_best_f1_score: 0.9304; train_kl_reg_loss: 36824.1740; train_edge_recon_loss: 26128616.9266; train_gene_expr_recon_loss: 6573099.4591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32738540.5474; train_optim_loss: 32738540.5474; val_kl_reg_loss: 35130.2350; val_edge_recon_loss: 26357538.1644; val_gene_expr_recon_loss: 6541287.5034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32933955.9041; val_optim_loss: 32933955.9041
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9795; val_auprc_score: 0.9753; val_best_acc_score: 0.9329; val_best_f1_score: 0.9348; train_kl_reg_loss: 36217.1859; train_edge_recon_loss: 26087053.2202; train_gene_expr_recon_loss: 6511080.4916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32634350.9235; train_optim_loss: 32634350.9235; val_kl_reg_loss: 34592.9215; val_edge_recon_loss: 26324620.6301; val_gene_expr_recon_loss: 6500784.0616; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32859997.5479; val_optim_loss: 32859997.5479
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9798; val_auprc_score: 0.9754; val_best_acc_score: 0.9351; val_best_f1_score: 0.9370; train_kl_reg_loss: 35402.9197; train_edge_recon_loss: 26057491.3563; train_gene_expr_recon_loss: 6469154.7638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32562049.0107; train_optim_loss: 32562049.0107; val_kl_reg_loss: 34370.0671; val_edge_recon_loss: 26289142.1096; val_gene_expr_recon_loss: 6481023.4897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32804535.6575; val_optim_loss: 32804535.6575
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9812; val_auprc_score: 0.9774; val_best_acc_score: 0.9376; val_best_f1_score: 0.9392; train_kl_reg_loss: 34828.0732; train_edge_recon_loss: 26027876.3180; train_gene_expr_recon_loss: 6442101.5306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32504805.8838; train_optim_loss: 32504805.8838; val_kl_reg_loss: 33892.7733; val_edge_recon_loss: 26287778.6575; val_gene_expr_recon_loss: 6461408.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32783079.5342; val_optim_loss: 32783079.5342
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9820; val_auprc_score: 0.9784; val_best_acc_score: 0.9395; val_best_f1_score: 0.9411; train_kl_reg_loss: 34228.3895; train_edge_recon_loss: 26028519.6070; train_gene_expr_recon_loss: 6421197.9935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32483946.0031; train_optim_loss: 32483946.0031; val_kl_reg_loss: 33760.4971; val_edge_recon_loss: 26256521.9178; val_gene_expr_recon_loss: 6427958.7432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32718241.1644; val_optim_loss: 32718241.1644
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9829; val_auprc_score: 0.9790; val_best_acc_score: 0.9409; val_best_f1_score: 0.9424; train_kl_reg_loss: 33866.8078; train_edge_recon_loss: 26007832.7477; train_gene_expr_recon_loss: 6406378.0875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32448077.6728; train_optim_loss: 32448077.6728; val_kl_reg_loss: 32961.9906; val_edge_recon_loss: 26237051.2877; val_gene_expr_recon_loss: 6429317.1404; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32699330.4110; val_optim_loss: 32699330.4110
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9831; val_auprc_score: 0.9795; val_best_acc_score: 0.9421; val_best_f1_score: 0.9436; train_kl_reg_loss: 33267.4749; train_edge_recon_loss: 25990466.7156; train_gene_expr_recon_loss: 6390069.4786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32413803.6820; train_optim_loss: 32413803.6820; val_kl_reg_loss: 31783.7558; val_edge_recon_loss: 26223776.6712; val_gene_expr_recon_loss: 6419074.0137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32674634.3699; val_optim_loss: 32674634.3699
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9843; val_auprc_score: 0.9811; val_best_acc_score: 0.9434; val_best_f1_score: 0.9448; train_kl_reg_loss: 33025.6734; train_edge_recon_loss: 25980402.6361; train_gene_expr_recon_loss: 6379643.4541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32393071.7722; train_optim_loss: 32393071.7722; val_kl_reg_loss: 32364.1523; val_edge_recon_loss: 26185617.7260; val_gene_expr_recon_loss: 6401260.9452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32619242.8219; val_optim_loss: 32619242.8219
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9840; val_auprc_score: 0.9805; val_best_acc_score: 0.9435; val_best_f1_score: 0.9448; train_kl_reg_loss: 33075.2486; train_edge_recon_loss: 25972348.0459; train_gene_expr_recon_loss: 6370197.5887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32375620.9358; train_optim_loss: 32375620.9358; val_kl_reg_loss: 31768.2047; val_edge_recon_loss: 26195791.5205; val_gene_expr_recon_loss: 6394688.5137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32622248.2877; val_optim_loss: 32622248.2877
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9840; val_auprc_score: 0.9802; val_best_acc_score: 0.9434; val_best_f1_score: 0.9447; train_kl_reg_loss: 32986.7119; train_edge_recon_loss: 25960005.7508; train_gene_expr_recon_loss: 6360829.8968; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32353822.3976; train_optim_loss: 32353822.3976; val_kl_reg_loss: 32922.6586; val_edge_recon_loss: 26181109.9726; val_gene_expr_recon_loss: 6375849.6781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32589882.4384; val_optim_loss: 32589882.4384
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9845; val_auprc_score: 0.9810; val_best_acc_score: 0.9458; val_best_f1_score: 0.9470; train_kl_reg_loss: 32892.9395; train_edge_recon_loss: 25946136.1758; train_gene_expr_recon_loss: 6357962.7489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32336991.8899; train_optim_loss: 32336991.8899; val_kl_reg_loss: 32452.1217; val_edge_recon_loss: 26181376.4521; val_gene_expr_recon_loss: 6377161.5411; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32590990.1096; val_optim_loss: 32590990.1096
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9848; val_auprc_score: 0.9814; val_best_acc_score: 0.9467; val_best_f1_score: 0.9478; train_kl_reg_loss: 32585.6825; train_edge_recon_loss: 25939405.0076; train_gene_expr_recon_loss: 6355028.1904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32327018.8349; train_optim_loss: 32327018.8349; val_kl_reg_loss: 31950.8484; val_edge_recon_loss: 26165264.4384; val_gene_expr_recon_loss: 6385408.1336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32582623.4795; val_optim_loss: 32582623.4795
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9846; val_auprc_score: 0.9811; val_best_acc_score: 0.9460; val_best_f1_score: 0.9472; train_kl_reg_loss: 32454.7117; train_edge_recon_loss: 25930986.2554; train_gene_expr_recon_loss: 6342884.7347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32306325.6850; train_optim_loss: 32306325.6850; val_kl_reg_loss: 31747.4151; val_edge_recon_loss: 26191390.3562; val_gene_expr_recon_loss: 6358613.0411; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32581750.7123; val_optim_loss: 32581750.7123
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9861; val_auprc_score: 0.9829; val_best_acc_score: 0.9488; val_best_f1_score: 0.9499; train_kl_reg_loss: 32549.3361; train_edge_recon_loss: 25928580.3777; train_gene_expr_recon_loss: 6338615.0111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32299744.7125; train_optim_loss: 32299744.7125; val_kl_reg_loss: 31177.7572; val_edge_recon_loss: 26163907.1507; val_gene_expr_recon_loss: 6359997.8562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32555082.7260; val_optim_loss: 32555082.7260
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9855; val_auprc_score: 0.9822; val_best_acc_score: 0.9474; val_best_f1_score: 0.9486; train_kl_reg_loss: 32303.8917; train_edge_recon_loss: 25927024.4572; train_gene_expr_recon_loss: 6335528.1743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32294856.5352; train_optim_loss: 32294856.5352; val_kl_reg_loss: 32344.7588; val_edge_recon_loss: 26172466.2055; val_gene_expr_recon_loss: 6371593.3938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32576404.3699; val_optim_loss: 32576404.3699
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9864; val_auprc_score: 0.9835; val_best_acc_score: 0.9489; val_best_f1_score: 0.9501; train_kl_reg_loss: 32404.3859; train_edge_recon_loss: 25916859.8578; train_gene_expr_recon_loss: 6329491.3861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32278755.6284; train_optim_loss: 32278755.6284; val_kl_reg_loss: 31046.6847; val_edge_recon_loss: 26179304.6438; val_gene_expr_recon_loss: 6363939.4247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32574290.8082; val_optim_loss: 32574290.8082
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9869; val_auprc_score: 0.9840; val_best_acc_score: 0.9505; val_best_f1_score: 0.9513; train_kl_reg_loss: 32135.8134; train_edge_recon_loss: 25909268.5138; train_gene_expr_recon_loss: 6327267.9048; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32268672.2187; train_optim_loss: 32268672.2187; val_kl_reg_loss: 31327.3073; val_edge_recon_loss: 26162387.6438; val_gene_expr_recon_loss: 6367669.6267; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32561384.5479; val_optim_loss: 32561384.5479
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9863; val_auprc_score: 0.9830; val_best_acc_score: 0.9499; val_best_f1_score: 0.9510; train_kl_reg_loss: 32288.0015; train_edge_recon_loss: 25907363.4052; train_gene_expr_recon_loss: 6327257.4358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32266908.8349; train_optim_loss: 32266908.8349; val_kl_reg_loss: 31422.2341; val_edge_recon_loss: 26137950.3973; val_gene_expr_recon_loss: 6345434.6370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32514807.3151; val_optim_loss: 32514807.3151
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9871; val_auprc_score: 0.9840; val_best_acc_score: 0.9520; val_best_f1_score: 0.9529; train_kl_reg_loss: 31959.8617; train_edge_recon_loss: 25905502.4281; train_gene_expr_recon_loss: 6323221.2229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32260683.4908; train_optim_loss: 32260683.4908; val_kl_reg_loss: 31036.7321; val_edge_recon_loss: 26134282.0000; val_gene_expr_recon_loss: 6360130.0719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32525448.8356; val_optim_loss: 32525448.8356
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9868; val_auprc_score: 0.9838; val_best_acc_score: 0.9511; val_best_f1_score: 0.9520; train_kl_reg_loss: 31822.4879; train_edge_recon_loss: 25886982.1407; train_gene_expr_recon_loss: 6322600.8456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32241405.4190; train_optim_loss: 32241405.4190; val_kl_reg_loss: 31529.9345; val_edge_recon_loss: 26122673.6849; val_gene_expr_recon_loss: 6351646.1199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32505849.6301; val_optim_loss: 32505849.6301
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9863; val_auprc_score: 0.9830; val_best_acc_score: 0.9505; val_best_f1_score: 0.9513; train_kl_reg_loss: 32229.8018; train_edge_recon_loss: 25883392.1636; train_gene_expr_recon_loss: 6317013.2534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32232635.1820; train_optim_loss: 32232635.1820; val_kl_reg_loss: 31646.8985; val_edge_recon_loss: 26112515.8630; val_gene_expr_recon_loss: 6351254.6815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32495417.4658; val_optim_loss: 32495417.4658
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9875; val_auprc_score: 0.9847; val_best_acc_score: 0.9524; val_best_f1_score: 0.9534; train_kl_reg_loss: 31767.0250; train_edge_recon_loss: 25897274.1330; train_gene_expr_recon_loss: 6313672.8219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32242713.9924; train_optim_loss: 32242713.9924; val_kl_reg_loss: 31194.5878; val_edge_recon_loss: 26106000.0685; val_gene_expr_recon_loss: 6337676.4932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32474871.1233; val_optim_loss: 32474871.1233
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9873; val_auprc_score: 0.9844; val_best_acc_score: 0.9519; val_best_f1_score: 0.9529; train_kl_reg_loss: 31818.9331; train_edge_recon_loss: 25883484.2018; train_gene_expr_recon_loss: 6313029.7366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32228332.8211; train_optim_loss: 32228332.8211; val_kl_reg_loss: 30778.6359; val_edge_recon_loss: 26142776.9178; val_gene_expr_recon_loss: 6348008.1233; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32521563.6712; val_optim_loss: 32521563.6712
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9873; val_auprc_score: 0.9844; val_best_acc_score: 0.9519; val_best_f1_score: 0.9530; train_kl_reg_loss: 31665.8554; train_edge_recon_loss: 25874160.6147; train_gene_expr_recon_loss: 6310348.9537; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32216175.4083; train_optim_loss: 32216175.4083; val_kl_reg_loss: 31327.7625; val_edge_recon_loss: 26092513.4658; val_gene_expr_recon_loss: 6335373.4760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32459214.8904; val_optim_loss: 32459214.8904
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9867; val_auprc_score: 0.9832; val_best_acc_score: 0.9517; val_best_f1_score: 0.9527; train_kl_reg_loss: 31680.1364; train_edge_recon_loss: 25874069.4450; train_gene_expr_recon_loss: 6305703.9560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32211453.5657; train_optim_loss: 32211453.5657; val_kl_reg_loss: 31274.5064; val_edge_recon_loss: 26132542.2740; val_gene_expr_recon_loss: 6352308.3322; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32516125.0685; val_optim_loss: 32516125.0685
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9876; val_auprc_score: 0.9846; val_best_acc_score: 0.9532; val_best_f1_score: 0.9541; train_kl_reg_loss: 31632.1899; train_edge_recon_loss: 25867747.7508; train_gene_expr_recon_loss: 6306057.6716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32205437.6162; train_optim_loss: 32205437.6162; val_kl_reg_loss: 31053.2911; val_edge_recon_loss: 26108047.8493; val_gene_expr_recon_loss: 6354397.8767; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32493498.9041; val_optim_loss: 32493498.9041
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9875; val_auprc_score: 0.9845; val_best_acc_score: 0.9535; val_best_f1_score: 0.9545; train_kl_reg_loss: 31558.7719; train_edge_recon_loss: 25865042.3746; train_gene_expr_recon_loss: 6304510.5050; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32201111.6239; train_optim_loss: 32201111.6239; val_kl_reg_loss: 31653.4602; val_edge_recon_loss: 26063880.6027; val_gene_expr_recon_loss: 6342633.6541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32438167.7397; val_optim_loss: 32438167.7397
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9876; val_auprc_score: 0.9845; val_best_acc_score: 0.9539; val_best_f1_score: 0.9548; train_kl_reg_loss: 31691.8877; train_edge_recon_loss: 25858648.9450; train_gene_expr_recon_loss: 6305048.3024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32195389.1147; train_optim_loss: 32195389.1147; val_kl_reg_loss: 30369.1384; val_edge_recon_loss: 26107148.8356; val_gene_expr_recon_loss: 6326255.0651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32463772.9315; val_optim_loss: 32463772.9315
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9877; val_auprc_score: 0.9843; val_best_acc_score: 0.9537; val_best_f1_score: 0.9546; train_kl_reg_loss: 31396.2913; train_edge_recon_loss: 25863571.4297; train_gene_expr_recon_loss: 6301219.8089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32196187.5321; train_optim_loss: 32196187.5321; val_kl_reg_loss: 30921.6895; val_edge_recon_loss: 26116085.7123; val_gene_expr_recon_loss: 6346236.1781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32493243.5479; val_optim_loss: 32493243.5479
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9877; val_auprc_score: 0.9845; val_best_acc_score: 0.9544; val_best_f1_score: 0.9552; train_kl_reg_loss: 31418.5138; train_edge_recon_loss: 25856996.7630; train_gene_expr_recon_loss: 6301119.4354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32189534.7217; train_optim_loss: 32189534.7217; val_kl_reg_loss: 31169.3666; val_edge_recon_loss: 26105184.1507; val_gene_expr_recon_loss: 6333437.7260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32469791.3836; val_optim_loss: 32469791.3836
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9878; val_auprc_score: 0.9848; val_best_acc_score: 0.9543; val_best_f1_score: 0.9551; train_kl_reg_loss: 31468.6097; train_edge_recon_loss: 25851639.5795; train_gene_expr_recon_loss: 6301072.2748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32184180.4679; train_optim_loss: 32184180.4679; val_kl_reg_loss: 30381.2185; val_edge_recon_loss: 26088294.6164; val_gene_expr_recon_loss: 6320608.1884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32439283.9178; val_optim_loss: 32439283.9178

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9880; val_auprc_score: 0.9851; val_best_acc_score: 0.9543; val_best_f1_score: 0.9552; train_kl_reg_loss: 32419.1654; train_edge_recon_loss: 25828719.4067; train_gene_expr_recon_loss: 6243691.5990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32104830.1942; train_optim_loss: 32104830.1942; val_kl_reg_loss: 32939.7154; val_edge_recon_loss: 26064940.3973; val_gene_expr_recon_loss: 6275842.0205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32373722.0274; val_optim_loss: 32373722.0274
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9878; val_auprc_score: 0.9849; val_best_acc_score: 0.9545; val_best_f1_score: 0.9554; train_kl_reg_loss: 33507.8633; train_edge_recon_loss: 25850590.2768; train_gene_expr_recon_loss: 6237363.3486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32121461.4939; train_optim_loss: 32121461.4939; val_kl_reg_loss: 33118.3023; val_edge_recon_loss: 26076398.0411; val_gene_expr_recon_loss: 6277489.1267; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32387005.4521; val_optim_loss: 32387005.4521
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9885; val_auprc_score: 0.9858; val_best_acc_score: 0.9556; val_best_f1_score: 0.9564; train_kl_reg_loss: 33692.8394; train_edge_recon_loss: 25841125.3119; train_gene_expr_recon_loss: 6234627.7489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32109445.9251; train_optim_loss: 32109445.9251; val_kl_reg_loss: 33301.5725; val_edge_recon_loss: 26065136.8904; val_gene_expr_recon_loss: 6275277.4726; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32373715.8767; val_optim_loss: 32373715.8767
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9879; val_auprc_score: 0.9848; val_best_acc_score: 0.9545; val_best_f1_score: 0.9554; train_kl_reg_loss: 33942.9629; train_edge_recon_loss: 25845338.1223; train_gene_expr_recon_loss: 6230095.0271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32109376.1223; train_optim_loss: 32109376.1223; val_kl_reg_loss: 33233.4508; val_edge_recon_loss: 26066078.6027; val_gene_expr_recon_loss: 6275495.8767; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32374807.8767; val_optim_loss: 32374807.8767
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9883; val_auprc_score: 0.9856; val_best_acc_score: 0.9547; val_best_f1_score: 0.9556; train_kl_reg_loss: 33978.5207; train_edge_recon_loss: 25838867.1575; train_gene_expr_recon_loss: 6230246.1911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32103091.8807; train_optim_loss: 32103091.8807; val_kl_reg_loss: 33415.1400; val_edge_recon_loss: 26071842.8904; val_gene_expr_recon_loss: 6271450.6199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32376708.5890; val_optim_loss: 32376708.5890
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9884; val_auprc_score: 0.9854; val_best_acc_score: 0.9561; val_best_f1_score: 0.9570; train_kl_reg_loss: 34111.9793; train_edge_recon_loss: 25843913.6086; train_gene_expr_recon_loss: 6228241.8991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32106267.5015; train_optim_loss: 32106267.5015; val_kl_reg_loss: 33656.1047; val_edge_recon_loss: 26052849.1507; val_gene_expr_recon_loss: 6270519.9144; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32357025.2740; val_optim_loss: 32357025.2740
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9881; val_auprc_score: 0.9853; val_best_acc_score: 0.9546; val_best_f1_score: 0.9555; train_kl_reg_loss: 34179.8691; train_edge_recon_loss: 25828719.3364; train_gene_expr_recon_loss: 6226380.8624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32089280.0520; train_optim_loss: 32089280.0520; val_kl_reg_loss: 33448.7889; val_edge_recon_loss: 26108118.3014; val_gene_expr_recon_loss: 6272883.4486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32414450.6027; val_optim_loss: 32414450.6027
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9888; val_auprc_score: 0.9863; val_best_acc_score: 0.9557; val_best_f1_score: 0.9564; train_kl_reg_loss: 34219.5875; train_edge_recon_loss: 25830111.8960; train_gene_expr_recon_loss: 6224339.2729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32088670.8028; train_optim_loss: 32088670.8028; val_kl_reg_loss: 33564.0322; val_edge_recon_loss: 26044348.9863; val_gene_expr_recon_loss: 6258608.8014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32336521.7945; val_optim_loss: 32336521.7945
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9881; val_auprc_score: 0.9851; val_best_acc_score: 0.9548; val_best_f1_score: 0.9556; train_kl_reg_loss: 34247.1128; train_edge_recon_loss: 25832672.2997; train_gene_expr_recon_loss: 6230038.1808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32096957.6131; train_optim_loss: 32096957.6131; val_kl_reg_loss: 33695.6113; val_edge_recon_loss: 26074517.0000; val_gene_expr_recon_loss: 6272313.4897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32380526.1233; val_optim_loss: 32380526.1233
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9888; val_auprc_score: 0.9861; val_best_acc_score: 0.9559; val_best_f1_score: 0.9567; train_kl_reg_loss: 34374.2851; train_edge_recon_loss: 25821942.5199; train_gene_expr_recon_loss: 6226028.9644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32082345.7997; train_optim_loss: 32082345.7997; val_kl_reg_loss: 33640.3145; val_edge_recon_loss: 26050468.2192; val_gene_expr_recon_loss: 6266985.5514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32351094.0411; val_optim_loss: 32351094.0411
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9886; val_auprc_score: 0.9860; val_best_acc_score: 0.9552; val_best_f1_score: 0.9560; train_kl_reg_loss: 34377.6594; train_edge_recon_loss: 25832601.5994; train_gene_expr_recon_loss: 6223041.7156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32090021.0031; train_optim_loss: 32090021.0031; val_kl_reg_loss: 33662.5872; val_edge_recon_loss: 26057050.3151; val_gene_expr_recon_loss: 6274131.9795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32364844.8219; val_optim_loss: 32364844.8219
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9887; val_auprc_score: 0.9863; val_best_acc_score: 0.9556; val_best_f1_score: 0.9564; train_kl_reg_loss: 34053.6738; train_edge_recon_loss: 25824519.5826; train_gene_expr_recon_loss: 6224520.6762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32083093.9434; train_optim_loss: 32083093.9434; val_kl_reg_loss: 33737.5883; val_edge_recon_loss: 26085712.2192; val_gene_expr_recon_loss: 6273455.4623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32392905.1781; val_optim_loss: 32392905.1781

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9884; val_auprc_score: 0.9856; val_best_acc_score: 0.9549; val_best_f1_score: 0.9559; train_kl_reg_loss: 34317.0718; train_edge_recon_loss: 25827693.6514; train_gene_expr_recon_loss: 6216436.6785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32078447.3746; train_optim_loss: 32078447.3746; val_kl_reg_loss: 33867.6695; val_edge_recon_loss: 26070842.8493; val_gene_expr_recon_loss: 6258710.1267; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32363420.6438; val_optim_loss: 32363420.6438
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9884; val_auprc_score: 0.9857; val_best_acc_score: 0.9551; val_best_f1_score: 0.9559; train_kl_reg_loss: 34381.7123; train_edge_recon_loss: 25829172.9526; train_gene_expr_recon_loss: 6216240.1495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32079794.8150; train_optim_loss: 32079794.8150; val_kl_reg_loss: 33735.1375; val_edge_recon_loss: 26083064.8630; val_gene_expr_recon_loss: 6256035.3185; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32372835.3699; val_optim_loss: 32372835.3699
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9887; val_auprc_score: 0.9861; val_best_acc_score: 0.9556; val_best_f1_score: 0.9565; train_kl_reg_loss: 34404.4182; train_edge_recon_loss: 25825658.0657; train_gene_expr_recon_loss: 6218621.1632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32078683.6697; train_optim_loss: 32078683.6697; val_kl_reg_loss: 33852.6037; val_edge_recon_loss: 26075028.5890; val_gene_expr_recon_loss: 6266696.8425; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32375578.0000; val_optim_loss: 32375578.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9882; val_auprc_score: 0.9854; val_best_acc_score: 0.9549; val_best_f1_score: 0.9559; train_kl_reg_loss: 34441.7018; train_edge_recon_loss: 25820612.0749; train_gene_expr_recon_loss: 6215611.7974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32070665.5765; train_optim_loss: 32070665.5765; val_kl_reg_loss: 33877.3619; val_edge_recon_loss: 26077222.5479; val_gene_expr_recon_loss: 6265016.2158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32376116.0959; val_optim_loss: 32376116.0959

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 231 min 41 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
Val AUROC score: 0.9882
Val AUPRC score: 0.9852
Val best accuracy score: 0.9547
Val best F1 score: 0.9555
Val gene expr MSE score: 1.5531

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
