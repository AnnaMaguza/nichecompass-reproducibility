None
Run timestamp: 28062023_164600_11.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_11']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
heaps
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9466; val_auprc_score: 0.9406; val_best_acc_score: 0.8766; val_best_f1_score: 0.8793; train_kl_reg_loss: 1734.6865; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 132023.2785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133757.9651; train_optim_loss: 133757.9651; val_kl_reg_loss: 1724.2452; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125090.0177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126814.2626; val_optim_loss: 126814.2626
heaps
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9541; val_auprc_score: 0.9511; val_best_acc_score: 0.8841; val_best_f1_score: 0.8870; train_kl_reg_loss: 1941.6854; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123910.2225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125851.9080; train_optim_loss: 125851.9080; val_kl_reg_loss: 1985.3884; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 119891.2803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121876.6687; val_optim_loss: 121876.6687
heaps
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9566; val_auprc_score: 0.9551; val_best_acc_score: 0.8872; val_best_f1_score: 0.8890; train_kl_reg_loss: 2079.3086; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 120063.7528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 122143.0616; train_optim_loss: 122143.0616; val_kl_reg_loss: 2041.9760; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117334.4898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119376.4660; val_optim_loss: 119376.4660
heaps
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9565; val_auprc_score: 0.9557; val_best_acc_score: 0.8868; val_best_f1_score: 0.8893; train_kl_reg_loss: 2063.7322; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117877.5445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119941.2767; train_optim_loss: 119941.2767; val_kl_reg_loss: 2000.1416; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115462.7271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117462.8683; val_optim_loss: 117462.8683
heaps
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9583; val_auprc_score: 0.9575; val_best_acc_score: 0.8889; val_best_f1_score: 0.8906; train_kl_reg_loss: 2032.3788; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116510.9920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118543.3708; train_optim_loss: 118543.3708; val_kl_reg_loss: 1946.8289; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 114727.3673; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 116674.1959; val_optim_loss: 116674.1959
heaps
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9587; val_auprc_score: 0.9596; val_best_acc_score: 0.8893; val_best_f1_score: 0.8904; train_kl_reg_loss: 2001.0865; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115696.3396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117697.4260; train_optim_loss: 117697.4260; val_kl_reg_loss: 1903.5319; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 114229.3155; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 116132.8475; val_optim_loss: 116132.8475
heaps
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9576; val_auprc_score: 0.9582; val_best_acc_score: 0.8874; val_best_f1_score: 0.8885; train_kl_reg_loss: 1978.3192; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115122.7648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117101.0840; train_optim_loss: 117101.0840; val_kl_reg_loss: 1941.1742; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 113669.0062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 115610.1805; val_optim_loss: 115610.1805
heaps
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9571; val_auprc_score: 0.9580; val_best_acc_score: 0.8868; val_best_f1_score: 0.8883; train_kl_reg_loss: 1958.2352; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114718.0829; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116676.3181; train_optim_loss: 116676.3181; val_kl_reg_loss: 1885.6510; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 113297.5294; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 115183.1801; val_optim_loss: 115183.1801
heaps
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9582; val_auprc_score: 0.9591; val_best_acc_score: 0.8884; val_best_f1_score: 0.8887; train_kl_reg_loss: 1940.4875; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114436.1838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116376.6713; train_optim_loss: 116376.6713; val_kl_reg_loss: 1902.3409; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 113029.5408; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 114931.8819; val_optim_loss: 114931.8819
heaps
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9550; val_auprc_score: 0.9551; val_best_acc_score: 0.8843; val_best_f1_score: 0.8862; train_kl_reg_loss: 1924.4571; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114204.5337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116128.9909; train_optim_loss: 116128.9909; val_kl_reg_loss: 1917.2463; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 112777.8968; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 114695.1430; val_optim_loss: 114695.1430
heaps
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9583; val_auprc_score: 0.9588; val_best_acc_score: 0.8897; val_best_f1_score: 0.8905; train_kl_reg_loss: 1910.1283; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 113986.8553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115896.9835; train_optim_loss: 115896.9835; val_kl_reg_loss: 1861.1063; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 112474.1174; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 114335.2234; val_optim_loss: 114335.2234
heaps
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9570; val_auprc_score: 0.9580; val_best_acc_score: 0.8878; val_best_f1_score: 0.8893; train_kl_reg_loss: 1897.7142; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 113812.4579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115710.1722; train_optim_loss: 115710.1722; val_kl_reg_loss: 1844.8526; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 112673.1707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 114518.0231; val_optim_loss: 114518.0231
heaps
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9577; val_auprc_score: 0.9588; val_best_acc_score: 0.8881; val_best_f1_score: 0.8894; train_kl_reg_loss: 1889.0683; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 113713.7419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115602.8101; train_optim_loss: 115602.8101; val_kl_reg_loss: 1817.5960; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 112400.3567; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 114217.9535; val_optim_loss: 114217.9535
heaps
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9551; val_auprc_score: 0.9553; val_best_acc_score: 0.8850; val_best_f1_score: 0.8869; train_kl_reg_loss: 1878.8407; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 113626.0505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115504.8913; train_optim_loss: 115504.8913; val_kl_reg_loss: 1877.7511; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 112323.0295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 114200.7806; val_optim_loss: 114200.7806
heaps
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9578; val_auprc_score: 0.9591; val_best_acc_score: 0.8879; val_best_f1_score: 0.8897; train_kl_reg_loss: 1869.8707; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 113556.9627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115426.8333; train_optim_loss: 115426.8333; val_kl_reg_loss: 1834.6183; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 112494.8872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 114329.5054; val_optim_loss: 114329.5054
heaps
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9588; val_auprc_score: 0.9600; val_best_acc_score: 0.8895; val_best_f1_score: 0.8901; train_kl_reg_loss: 1865.2537; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 113498.8970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115364.1508; train_optim_loss: 115364.1508; val_kl_reg_loss: 1825.8972; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 112049.6805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 113875.5777; val_optim_loss: 113875.5777
heaps
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9580; val_auprc_score: 0.9591; val_best_acc_score: 0.8885; val_best_f1_score: 0.8900; train_kl_reg_loss: 1856.6439; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 113452.3659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115309.0098; train_optim_loss: 115309.0098; val_kl_reg_loss: 1802.6804; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 112317.8305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 114120.5114; val_optim_loss: 114120.5114
heaps
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9583; val_auprc_score: 0.9593; val_best_acc_score: 0.8891; val_best_f1_score: 0.8906; train_kl_reg_loss: 1846.2107; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 113392.0718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115238.2826; train_optim_loss: 115238.2826; val_kl_reg_loss: 1812.5610; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 112211.8641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 114024.4251; val_optim_loss: 114024.4251
heaps
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9574; val_auprc_score: 0.9584; val_best_acc_score: 0.8889; val_best_f1_score: 0.8895; train_kl_reg_loss: 1844.0616; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 113318.8698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115162.9312; train_optim_loss: 115162.9312; val_kl_reg_loss: 1813.1938; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 112208.3322; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 114021.5258; val_optim_loss: 114021.5258
heaps
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9615; val_auprc_score: 0.9631; val_best_acc_score: 0.8944; val_best_f1_score: 0.8947; train_kl_reg_loss: 1838.3278; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 113276.5675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115114.8952; train_optim_loss: 115114.8952; val_kl_reg_loss: 1777.6730; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 112044.1008; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 113821.7738; val_optim_loss: 113821.7738
heaps
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9619; val_auprc_score: 0.9633; val_best_acc_score: 0.8947; val_best_f1_score: 0.8956; train_kl_reg_loss: 1833.4261; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 113298.2083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115131.6344; train_optim_loss: 115131.6344; val_kl_reg_loss: 1799.5297; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 112166.8519; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 113966.3819; val_optim_loss: 113966.3819
heaps
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9603; val_auprc_score: 0.9613; val_best_acc_score: 0.8933; val_best_f1_score: 0.8940; train_kl_reg_loss: 1828.1270; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 113216.3879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115044.5149; train_optim_loss: 115044.5149; val_kl_reg_loss: 1778.3561; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 112458.3847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 114236.7414; val_optim_loss: 114236.7414
heaps
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9597; val_auprc_score: 0.9611; val_best_acc_score: 0.8910; val_best_f1_score: 0.8918; train_kl_reg_loss: 1821.0104; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 113262.4567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115083.4671; train_optim_loss: 115083.4671; val_kl_reg_loss: 1816.6595; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 112237.9095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 114054.5691; val_optim_loss: 114054.5691
heaps
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9606; val_auprc_score: 0.9621; val_best_acc_score: 0.8928; val_best_f1_score: 0.8933; train_kl_reg_loss: 1816.4506; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 113178.7157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 114995.1662; train_optim_loss: 114995.1662; val_kl_reg_loss: 1773.5401; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 112035.6067; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 113809.1471; val_optim_loss: 113809.1471
heaps
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9613; val_auprc_score: 0.9624; val_best_acc_score: 0.8940; val_best_f1_score: 0.8948; train_kl_reg_loss: 1812.6449; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 113155.2651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 114967.9100; train_optim_loss: 114967.9100; val_kl_reg_loss: 1752.5196; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 111919.7692; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 113672.2890; val_optim_loss: 113672.2890
heaps
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9610; val_auprc_score: 0.9623; val_best_acc_score: 0.8940; val_best_f1_score: 0.8944; train_kl_reg_loss: 1808.3710; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 113090.1882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 114898.5592; train_optim_loss: 114898.5592; val_kl_reg_loss: 1773.6747; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 111979.6147; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 113753.2895; val_optim_loss: 113753.2895
heaps
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9605; val_auprc_score: 0.9620; val_best_acc_score: 0.8921; val_best_f1_score: 0.8928; train_kl_reg_loss: 1804.5924; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 113093.9457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 114898.5381; train_optim_loss: 114898.5381; val_kl_reg_loss: 1775.1921; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 112192.4009; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 113967.5928; val_optim_loss: 113967.5928
heaps
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9613; val_auprc_score: 0.9623; val_best_acc_score: 0.8937; val_best_f1_score: 0.8941; train_kl_reg_loss: 1800.0924; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 113088.5391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 114888.6313; train_optim_loss: 114888.6313; val_kl_reg_loss: 1783.6857; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 112010.3081; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 113793.9938; val_optim_loss: 113793.9938
heaps
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9609; val_auprc_score: 0.9622; val_best_acc_score: 0.8929; val_best_f1_score: 0.8936; train_kl_reg_loss: 1794.0852; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 113092.4462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 114886.5315; train_optim_loss: 114886.5315; val_kl_reg_loss: 1752.4118; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 112231.9727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 113984.3846; val_optim_loss: 113984.3846

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

heaps
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9633; val_auprc_score: 0.9645; val_best_acc_score: 0.8962; val_best_f1_score: 0.8968; train_kl_reg_loss: 1528.6050; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 112366.5284; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 113895.1334; train_optim_loss: 113895.1334; val_kl_reg_loss: 1344.5400; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 111567.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 112912.3761; val_optim_loss: 112912.3761
heaps
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9633; val_auprc_score: 0.9647; val_best_acc_score: 0.8963; val_best_f1_score: 0.8964; train_kl_reg_loss: 1304.5372; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 112047.5223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 113352.0594; train_optim_loss: 113352.0594; val_kl_reg_loss: 1231.0475; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 111396.1046; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 112627.1522; val_optim_loss: 112627.1522
heaps
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9648; val_auprc_score: 0.9663; val_best_acc_score: 0.8992; val_best_f1_score: 0.8997; train_kl_reg_loss: 1238.8914; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 111906.3110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 113145.2025; train_optim_loss: 113145.2025; val_kl_reg_loss: 1200.1283; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 111346.5558; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 112546.6838; val_optim_loss: 112546.6838
heaps
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9638; val_auprc_score: 0.9649; val_best_acc_score: 0.8978; val_best_f1_score: 0.8982; train_kl_reg_loss: 1214.0990; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 111814.2662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 113028.3652; train_optim_loss: 113028.3652; val_kl_reg_loss: 1186.2741; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 111359.6700; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 112545.9442; val_optim_loss: 112545.9442
heaps
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9640; val_auprc_score: 0.9654; val_best_acc_score: 0.8971; val_best_f1_score: 0.8974; train_kl_reg_loss: 1199.1708; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 111771.1288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 112970.2995; train_optim_loss: 112970.2995; val_kl_reg_loss: 1172.8507; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 111720.9818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 112893.8322; val_optim_loss: 112893.8322
heaps
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9645; val_auprc_score: 0.9656; val_best_acc_score: 0.8991; val_best_f1_score: 0.8993; train_kl_reg_loss: 1190.2177; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 111781.0804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 112971.2981; train_optim_loss: 112971.2981; val_kl_reg_loss: 1167.1276; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 111626.5866; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 112793.7139; val_optim_loss: 112793.7139
heaps
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9640; val_auprc_score: 0.9653; val_best_acc_score: 0.8978; val_best_f1_score: 0.8981; train_kl_reg_loss: 1185.8111; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 111684.7910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 112870.6022; train_optim_loss: 112870.6022; val_kl_reg_loss: 1168.4093; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 111466.8370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 112635.2470; val_optim_loss: 112635.2470
heaps
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9653; val_auprc_score: 0.9671; val_best_acc_score: 0.8993; val_best_f1_score: 0.8995; train_kl_reg_loss: 1181.5846; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 111721.5946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 112903.1792; train_optim_loss: 112903.1792; val_kl_reg_loss: 1161.6138; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 111520.8292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 112682.4428; val_optim_loss: 112682.4428

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

heaps
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9651; val_auprc_score: 0.9668; val_best_acc_score: 0.8993; val_best_f1_score: 0.8991; train_kl_reg_loss: 1173.8367; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 111646.2401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 112820.0768; train_optim_loss: 112820.0768; val_kl_reg_loss: 1152.8705; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 111406.7633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 112559.6335; val_optim_loss: 112559.6335
heaps
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9652; val_auprc_score: 0.9669; val_best_acc_score: 0.8993; val_best_f1_score: 0.8996; train_kl_reg_loss: 1169.3873; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 111564.9461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 112734.3335; train_optim_loss: 112734.3335; val_kl_reg_loss: 1148.1498; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 111403.3981; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 112551.5482; val_optim_loss: 112551.5482
heaps
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9657; val_auprc_score: 0.9674; val_best_acc_score: 0.9000; val_best_f1_score: 0.9003; train_kl_reg_loss: 1167.5154; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 111588.9252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 112756.4406; train_optim_loss: 112756.4406; val_kl_reg_loss: 1147.3839; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 111360.5493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 112507.9332; val_optim_loss: 112507.9332
heaps
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9652; val_auprc_score: 0.9668; val_best_acc_score: 0.8999; val_best_f1_score: 0.9001; train_kl_reg_loss: 1165.9689; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 111565.2239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 112731.1928; train_optim_loss: 112731.1928; val_kl_reg_loss: 1144.6686; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 111374.1208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 112518.7895; val_optim_loss: 112518.7895
heaps
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9651; val_auprc_score: 0.9665; val_best_acc_score: 0.8995; val_best_f1_score: 0.8996; train_kl_reg_loss: 1165.3250; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 111562.5910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 112727.9160; train_optim_loss: 112727.9160; val_kl_reg_loss: 1143.2828; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 111226.9039; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 112370.1866; val_optim_loss: 112370.1866
heaps
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9639; val_auprc_score: 0.9653; val_best_acc_score: 0.8966; val_best_f1_score: 0.8975; train_kl_reg_loss: 1164.0659; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 111574.3250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 112738.3909; train_optim_loss: 112738.3909; val_kl_reg_loss: 1144.6077; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 111415.8900; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 112560.4976; val_optim_loss: 112560.4976
heaps
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9658; val_auprc_score: 0.9672; val_best_acc_score: 0.9013; val_best_f1_score: 0.9013; train_kl_reg_loss: 1163.5638; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 111583.5458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 112747.1095; train_optim_loss: 112747.1095; val_kl_reg_loss: 1142.5771; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 111439.3809; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 112581.9582; val_optim_loss: 112581.9582
heaps
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9653; val_auprc_score: 0.9667; val_best_acc_score: 0.8997; val_best_f1_score: 0.8999; train_kl_reg_loss: 1162.5706; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 111572.7545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 112735.3251; train_optim_loss: 112735.3251; val_kl_reg_loss: 1139.6163; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 111357.0041; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 112496.6204; val_optim_loss: 112496.6204
heaps
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9649; val_auprc_score: 0.9666; val_best_acc_score: 0.8986; val_best_f1_score: 0.8987; train_kl_reg_loss: 1161.7275; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 111566.8577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 112728.5851; train_optim_loss: 112728.5851; val_kl_reg_loss: 1140.4084; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 111247.0935; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 112387.5022; val_optim_loss: 112387.5022

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

heaps
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9651; val_auprc_score: 0.9665; val_best_acc_score: 0.8986; val_best_f1_score: 0.8992; train_kl_reg_loss: 1161.2764; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 111510.9644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 112672.2408; train_optim_loss: 112672.2408; val_kl_reg_loss: 1141.7736; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 111428.6520; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 112570.4262; val_optim_loss: 112570.4262
heaps
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9644; val_auprc_score: 0.9660; val_best_acc_score: 0.8983; val_best_f1_score: 0.8989; train_kl_reg_loss: 1160.8551; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 111522.5920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 112683.4470; train_optim_loss: 112683.4470; val_kl_reg_loss: 1140.7678; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 111440.4822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 112581.2502; val_optim_loss: 112581.2502
heaps
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9652; val_auprc_score: 0.9666; val_best_acc_score: 0.8996; val_best_f1_score: 0.8994; train_kl_reg_loss: 1160.6702; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 111513.8713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 112674.5415; train_optim_loss: 112674.5415; val_kl_reg_loss: 1140.6596; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 111479.7378; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 112620.3973; val_optim_loss: 112620.3973
heaps
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9655; val_auprc_score: 0.9669; val_best_acc_score: 0.8999; val_best_f1_score: 0.9005; train_kl_reg_loss: 1160.4268; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 111514.1694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 112674.5965; train_optim_loss: 112674.5965; val_kl_reg_loss: 1140.5592; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 111417.4822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 112558.0411; val_optim_loss: 112558.0411

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 78 min 44 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
Val AUROC score: 0.9655
Val AUPRC score: 0.9672
Val best accuracy score: 0.8999
Val best F1 score: 0.8999
Val gene expr MSE score: 2.6066

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
