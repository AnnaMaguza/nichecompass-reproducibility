None
Run timestamp: 26072023_042055_4.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '3000.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '128', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 128
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9860; val_auprc_score: 0.9830; val_best_acc_score: 0.9473; val_best_f1_score: 0.9483; train_kl_reg_loss: 15085.1116; train_edge_recon_loss: 26140601.7047; train_gene_expr_recon_loss: 791798.7787; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26947485.5961; train_optim_loss: 26947485.5961; val_kl_reg_loss: 14603.1306; val_edge_recon_loss: 26033822.5340; val_gene_expr_recon_loss: 755954.8064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26804380.4590; val_optim_loss: 26804380.4590
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9888; val_auprc_score: 0.9861; val_best_acc_score: 0.9564; val_best_f1_score: 0.9572; train_kl_reg_loss: 14778.2423; train_edge_recon_loss: 25862893.2469; train_gene_expr_recon_loss: 735073.4776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26612744.9739; train_optim_loss: 26612744.9739; val_kl_reg_loss: 15493.8266; val_edge_recon_loss: 25968543.7225; val_gene_expr_recon_loss: 728479.5137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26712517.0524; val_optim_loss: 26712517.0524
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9906; val_auprc_score: 0.9883; val_best_acc_score: 0.9603; val_best_f1_score: 0.9610; train_kl_reg_loss: 15054.9561; train_edge_recon_loss: 25806021.2050; train_gene_expr_recon_loss: 721790.8644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26542867.0137; train_optim_loss: 26542867.0137; val_kl_reg_loss: 14942.5418; val_edge_recon_loss: 25925934.0558; val_gene_expr_recon_loss: 718288.5760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26659165.2199; val_optim_loss: 26659165.2199
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9918; val_auprc_score: 0.9898; val_best_acc_score: 0.9631; val_best_f1_score: 0.9637; train_kl_reg_loss: 15294.2855; train_edge_recon_loss: 25776598.1839; train_gene_expr_recon_loss: 712586.6848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26504479.1590; train_optim_loss: 26504479.1590; val_kl_reg_loss: 15569.8089; val_edge_recon_loss: 25875507.4660; val_gene_expr_recon_loss: 708317.3748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26599394.6510; val_optim_loss: 26599394.6510
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9917; val_auprc_score: 0.9896; val_best_acc_score: 0.9645; val_best_f1_score: 0.9651; train_kl_reg_loss: 15262.4544; train_edge_recon_loss: 25751649.1439; train_gene_expr_recon_loss: 709898.2061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26476809.8211; train_optim_loss: 26476809.8211; val_kl_reg_loss: 14632.2239; val_edge_recon_loss: 25890837.1536; val_gene_expr_recon_loss: 706342.1395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26611811.5183; val_optim_loss: 26611811.5183
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9923; val_auprc_score: 0.9901; val_best_acc_score: 0.9661; val_best_f1_score: 0.9665; train_kl_reg_loss: 15240.6975; train_edge_recon_loss: 25733300.5962; train_gene_expr_recon_loss: 707059.7154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26455601.0185; train_optim_loss: 26455601.0185; val_kl_reg_loss: 14776.2913; val_edge_recon_loss: 25856127.5759; val_gene_expr_recon_loss: 706109.5100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26577013.4049; val_optim_loss: 26577013.4049
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9927; val_auprc_score: 0.9908; val_best_acc_score: 0.9672; val_best_f1_score: 0.9677; train_kl_reg_loss: 15280.7502; train_edge_recon_loss: 25722615.8881; train_gene_expr_recon_loss: 703648.3582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26441545.0015; train_optim_loss: 26441545.0015; val_kl_reg_loss: 15047.5694; val_edge_recon_loss: 25822382.4119; val_gene_expr_recon_loss: 705942.5976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26543372.6073; val_optim_loss: 26543372.6073
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9929; val_auprc_score: 0.9911; val_best_acc_score: 0.9676; val_best_f1_score: 0.9681; train_kl_reg_loss: 15193.9927; train_edge_recon_loss: 25709983.9340; train_gene_expr_recon_loss: 702673.9540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26427851.8881; train_optim_loss: 26427851.8881; val_kl_reg_loss: 15231.9996; val_edge_recon_loss: 25812477.2740; val_gene_expr_recon_loss: 703837.8996; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26531547.1553; val_optim_loss: 26531547.1553
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9928; val_auprc_score: 0.9906; val_best_acc_score: 0.9683; val_best_f1_score: 0.9688; train_kl_reg_loss: 15284.6956; train_edge_recon_loss: 25697576.1218; train_gene_expr_recon_loss: 701449.2898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26414310.1189; train_optim_loss: 26414310.1189; val_kl_reg_loss: 15000.0943; val_edge_recon_loss: 25794452.8010; val_gene_expr_recon_loss: 711039.5373; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26520492.4503; val_optim_loss: 26520492.4503
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9930; val_auprc_score: 0.9912; val_best_acc_score: 0.9692; val_best_f1_score: 0.9697; train_kl_reg_loss: 15180.7615; train_edge_recon_loss: 25690119.1662; train_gene_expr_recon_loss: 700841.3211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26406141.2649; train_optim_loss: 26406141.2649; val_kl_reg_loss: 15293.0893; val_edge_recon_loss: 25818260.7504; val_gene_expr_recon_loss: 699042.0750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26532595.9424; val_optim_loss: 26532595.9424
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9934; val_auprc_score: 0.9914; val_best_acc_score: 0.9702; val_best_f1_score: 0.9706; train_kl_reg_loss: 15207.2562; train_edge_recon_loss: 25681632.0764; train_gene_expr_recon_loss: 700122.5502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26396961.8813; train_optim_loss: 26396961.8813; val_kl_reg_loss: 15143.0163; val_edge_recon_loss: 25779220.7225; val_gene_expr_recon_loss: 700003.6789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26494367.4293; val_optim_loss: 26494367.4293
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9936; val_auprc_score: 0.9917; val_best_acc_score: 0.9705; val_best_f1_score: 0.9709; train_kl_reg_loss: 15233.7644; train_edge_recon_loss: 25671076.2408; train_gene_expr_recon_loss: 698975.6222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26385285.6362; train_optim_loss: 26385285.6362; val_kl_reg_loss: 14948.9132; val_edge_recon_loss: 25777524.6789; val_gene_expr_recon_loss: 697751.4451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26490225.0419; val_optim_loss: 26490225.0419
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9933; val_auprc_score: 0.9913; val_best_acc_score: 0.9703; val_best_f1_score: 0.9707; train_kl_reg_loss: 15170.9912; train_edge_recon_loss: 25661103.0401; train_gene_expr_recon_loss: 699302.7839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26375576.8247; train_optim_loss: 26375576.8247; val_kl_reg_loss: 15313.3607; val_edge_recon_loss: 25732842.5759; val_gene_expr_recon_loss: 696990.1308; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26445146.0698; val_optim_loss: 26445146.0698
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9936; val_auprc_score: 0.9915; val_best_acc_score: 0.9716; val_best_f1_score: 0.9721; train_kl_reg_loss: 15274.5729; train_edge_recon_loss: 25662394.5624; train_gene_expr_recon_loss: 697888.2452; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26375557.3751; train_optim_loss: 26375557.3751; val_kl_reg_loss: 15313.9984; val_edge_recon_loss: 25735357.5969; val_gene_expr_recon_loss: 703553.3251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26454224.9075; val_optim_loss: 26454224.9075
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9933; val_auprc_score: 0.9911; val_best_acc_score: 0.9708; val_best_f1_score: 0.9712; train_kl_reg_loss: 15307.6126; train_edge_recon_loss: 25659552.9677; train_gene_expr_recon_loss: 697944.2556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26372804.8416; train_optim_loss: 26372804.8416; val_kl_reg_loss: 14992.2535; val_edge_recon_loss: 25755759.1082; val_gene_expr_recon_loss: 697872.1380; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26468623.4974; val_optim_loss: 26468623.4974
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9935; val_auprc_score: 0.9915; val_best_acc_score: 0.9716; val_best_f1_score: 0.9719; train_kl_reg_loss: 15215.2285; train_edge_recon_loss: 25646217.0913; train_gene_expr_recon_loss: 697018.6563; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26358450.9852; train_optim_loss: 26358450.9852; val_kl_reg_loss: 15304.3605; val_edge_recon_loss: 25750651.5497; val_gene_expr_recon_loss: 697964.9959; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26463920.9092; val_optim_loss: 26463920.9092
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9936; val_auprc_score: 0.9918; val_best_acc_score: 0.9711; val_best_f1_score: 0.9715; train_kl_reg_loss: 15245.0755; train_edge_recon_loss: 25635471.8947; train_gene_expr_recon_loss: 696567.2009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26347284.1591; train_optim_loss: 26347284.1591; val_kl_reg_loss: 15581.0360; val_edge_recon_loss: 25715487.3316; val_gene_expr_recon_loss: 697724.3322; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26428792.6876; val_optim_loss: 26428792.6876
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9934; val_auprc_score: 0.9915; val_best_acc_score: 0.9711; val_best_f1_score: 0.9715; train_kl_reg_loss: 15258.7764; train_edge_recon_loss: 25640017.4678; train_gene_expr_recon_loss: 696335.6269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26351611.8805; train_optim_loss: 26351611.8805; val_kl_reg_loss: 14718.6437; val_edge_recon_loss: 25759665.1309; val_gene_expr_recon_loss: 696247.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26470630.9442; val_optim_loss: 26470630.9442
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9936; val_auprc_score: 0.9917; val_best_acc_score: 0.9723; val_best_f1_score: 0.9727; train_kl_reg_loss: 15315.1735; train_edge_recon_loss: 25643446.4530; train_gene_expr_recon_loss: 695932.9461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26354694.5712; train_optim_loss: 26354694.5712; val_kl_reg_loss: 15213.7061; val_edge_recon_loss: 25710351.7033; val_gene_expr_recon_loss: 696425.3447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26421990.7190; val_optim_loss: 26421990.7190
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9935; val_auprc_score: 0.9915; val_best_acc_score: 0.9721; val_best_f1_score: 0.9725; train_kl_reg_loss: 15387.6353; train_edge_recon_loss: 25627191.1982; train_gene_expr_recon_loss: 695773.0380; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26338351.8689; train_optim_loss: 26338351.8689; val_kl_reg_loss: 15312.0798; val_edge_recon_loss: 25731628.4677; val_gene_expr_recon_loss: 698135.3980; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26445075.9337; val_optim_loss: 26445075.9337
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9929; val_auprc_score: 0.9907; val_best_acc_score: 0.9709; val_best_f1_score: 0.9713; train_kl_reg_loss: 15393.0300; train_edge_recon_loss: 25628437.2379; train_gene_expr_recon_loss: 695424.6855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26339254.9504; train_optim_loss: 26339254.9504; val_kl_reg_loss: 15477.5448; val_edge_recon_loss: 25709375.1745; val_gene_expr_recon_loss: 697067.5470; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26421920.2810; val_optim_loss: 26421920.2810
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9936; val_auprc_score: 0.9917; val_best_acc_score: 0.9726; val_best_f1_score: 0.9730; train_kl_reg_loss: 15430.7717; train_edge_recon_loss: 25625867.1543; train_gene_expr_recon_loss: 694635.8828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26335933.8172; train_optim_loss: 26335933.8172; val_kl_reg_loss: 15259.4516; val_edge_recon_loss: 25691595.1832; val_gene_expr_recon_loss: 701714.2826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26408568.8935; val_optim_loss: 26408568.8935
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9938; val_auprc_score: 0.9920; val_best_acc_score: 0.9724; val_best_f1_score: 0.9728; train_kl_reg_loss: 15424.3808; train_edge_recon_loss: 25617319.0447; train_gene_expr_recon_loss: 694579.7450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26327323.1739; train_optim_loss: 26327323.1739; val_kl_reg_loss: 15222.6321; val_edge_recon_loss: 25720068.9284; val_gene_expr_recon_loss: 695766.3292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26431057.9005; val_optim_loss: 26431057.9005
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9937; val_auprc_score: 0.9919; val_best_acc_score: 0.9718; val_best_f1_score: 0.9722; train_kl_reg_loss: 15470.0532; train_edge_recon_loss: 25615145.3881; train_gene_expr_recon_loss: 694182.1628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26324797.5998; train_optim_loss: 26324797.5998; val_kl_reg_loss: 15515.6991; val_edge_recon_loss: 25704235.5777; val_gene_expr_recon_loss: 694657.4001; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26414408.6143; val_optim_loss: 26414408.6143
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9934; val_auprc_score: 0.9914; val_best_acc_score: 0.9719; val_best_f1_score: 0.9723; train_kl_reg_loss: 15549.5447; train_edge_recon_loss: 25613860.3787; train_gene_expr_recon_loss: 694138.3469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26323548.2834; train_optim_loss: 26323548.2834; val_kl_reg_loss: 15337.4319; val_edge_recon_loss: 25715142.8569; val_gene_expr_recon_loss: 695698.5297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26426178.8063; val_optim_loss: 26426178.8063
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9935; val_auprc_score: 0.9913; val_best_acc_score: 0.9732; val_best_f1_score: 0.9736; train_kl_reg_loss: 15502.6143; train_edge_recon_loss: 25605947.0418; train_gene_expr_recon_loss: 694076.7490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26315526.3853; train_optim_loss: 26315526.3853; val_kl_reg_loss: 15290.9103; val_edge_recon_loss: 25668959.2635; val_gene_expr_recon_loss: 695331.4630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26379581.6632; val_optim_loss: 26379581.6632
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9934; val_auprc_score: 0.9912; val_best_acc_score: 0.9722; val_best_f1_score: 0.9726; train_kl_reg_loss: 15570.0586; train_edge_recon_loss: 25605922.0811; train_gene_expr_recon_loss: 693516.6436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26315008.7667; train_optim_loss: 26315008.7667; val_kl_reg_loss: 15636.2396; val_edge_recon_loss: 25692888.7766; val_gene_expr_recon_loss: 694791.3266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26403316.3525; val_optim_loss: 26403316.3525
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9934; val_auprc_score: 0.9912; val_best_acc_score: 0.9723; val_best_f1_score: 0.9727; train_kl_reg_loss: 15527.5484; train_edge_recon_loss: 25604958.8561; train_gene_expr_recon_loss: 694444.6274; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26314931.0267; train_optim_loss: 26314931.0267; val_kl_reg_loss: 15332.7024; val_edge_recon_loss: 25698044.1065; val_gene_expr_recon_loss: 697725.1389; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26411101.9668; val_optim_loss: 26411101.9668
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9939; val_auprc_score: 0.9920; val_best_acc_score: 0.9734; val_best_f1_score: 0.9738; train_kl_reg_loss: 15540.9765; train_edge_recon_loss: 25602117.8747; train_gene_expr_recon_loss: 693836.2915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26311495.1367; train_optim_loss: 26311495.1367; val_kl_reg_loss: 15206.4408; val_edge_recon_loss: 25661593.8464; val_gene_expr_recon_loss: 695766.7150; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26372566.9686; val_optim_loss: 26372566.9686
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9938; val_auprc_score: 0.9918; val_best_acc_score: 0.9731; val_best_f1_score: 0.9735; train_kl_reg_loss: 15618.7883; train_edge_recon_loss: 25597954.1222; train_gene_expr_recon_loss: 693206.6816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26306779.5775; train_optim_loss: 26306779.5775; val_kl_reg_loss: 15760.5517; val_edge_recon_loss: 25683838.1658; val_gene_expr_recon_loss: 696994.7889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26396593.4921; val_optim_loss: 26396593.4921
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9937; val_auprc_score: 0.9918; val_best_acc_score: 0.9733; val_best_f1_score: 0.9737; train_kl_reg_loss: 15551.0185; train_edge_recon_loss: 25592832.0359; train_gene_expr_recon_loss: 693544.0756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26301927.1400; train_optim_loss: 26301927.1400; val_kl_reg_loss: 15502.5243; val_edge_recon_loss: 25673152.7888; val_gene_expr_recon_loss: 696239.2990; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26384894.5969; val_optim_loss: 26384894.5969
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9938; val_auprc_score: 0.9919; val_best_acc_score: 0.9735; val_best_f1_score: 0.9739; train_kl_reg_loss: 15608.7681; train_edge_recon_loss: 25590596.5894; train_gene_expr_recon_loss: 693278.2665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26299483.6201; train_optim_loss: 26299483.6201; val_kl_reg_loss: 15964.6265; val_edge_recon_loss: 25668811.1920; val_gene_expr_recon_loss: 698446.3858; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26383222.1728; val_optim_loss: 26383222.1728
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9934; val_auprc_score: 0.9914; val_best_acc_score: 0.9727; val_best_f1_score: 0.9730; train_kl_reg_loss: 15648.3291; train_edge_recon_loss: 25594288.3321; train_gene_expr_recon_loss: 693003.1984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26302939.8646; train_optim_loss: 26302939.8646; val_kl_reg_loss: 15662.4443; val_edge_recon_loss: 25676805.5829; val_gene_expr_recon_loss: 694867.9817; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26387336.0070; val_optim_loss: 26387336.0070

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9937; val_auprc_score: 0.9915; val_best_acc_score: 0.9743; val_best_f1_score: 0.9747; train_kl_reg_loss: 15889.9594; train_edge_recon_loss: 25567727.4688; train_gene_expr_recon_loss: 681472.1497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26265089.5773; train_optim_loss: 26265089.5773; val_kl_reg_loss: 15903.7108; val_edge_recon_loss: 25645116.7784; val_gene_expr_recon_loss: 683960.2074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26344980.7190; val_optim_loss: 26344980.7190
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9941; val_auprc_score: 0.9922; val_best_acc_score: 0.9742; val_best_f1_score: 0.9745; train_kl_reg_loss: 16046.4704; train_edge_recon_loss: 25566674.3261; train_gene_expr_recon_loss: 680346.5168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26263067.3144; train_optim_loss: 26263067.3144; val_kl_reg_loss: 15931.6758; val_edge_recon_loss: 25637515.4433; val_gene_expr_recon_loss: 683190.7607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26336637.8953; val_optim_loss: 26336637.8953
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9938; val_auprc_score: 0.9918; val_best_acc_score: 0.9742; val_best_f1_score: 0.9745; train_kl_reg_loss: 16052.7780; train_edge_recon_loss: 25565758.3709; train_gene_expr_recon_loss: 679769.9414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26261581.0843; train_optim_loss: 26261581.0843; val_kl_reg_loss: 15847.9276; val_edge_recon_loss: 25640945.3002; val_gene_expr_recon_loss: 681794.2285; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26338587.4450; val_optim_loss: 26338587.4450
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9938; val_auprc_score: 0.9918; val_best_acc_score: 0.9738; val_best_f1_score: 0.9742; train_kl_reg_loss: 16021.7254; train_edge_recon_loss: 25560768.6501; train_gene_expr_recon_loss: 679748.5200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26256538.8866; train_optim_loss: 26256538.8866; val_kl_reg_loss: 15895.2136; val_edge_recon_loss: 25630668.0000; val_gene_expr_recon_loss: 683688.5734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26330251.7801; val_optim_loss: 26330251.7801
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9941; val_auprc_score: 0.9923; val_best_acc_score: 0.9745; val_best_f1_score: 0.9748; train_kl_reg_loss: 15961.4961; train_edge_recon_loss: 25555522.3626; train_gene_expr_recon_loss: 679502.9381; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26250986.7908; train_optim_loss: 26250986.7908; val_kl_reg_loss: 15795.4700; val_edge_recon_loss: 25636550.7958; val_gene_expr_recon_loss: 683342.8437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26335689.1222; val_optim_loss: 26335689.1222
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9942; val_auprc_score: 0.9924; val_best_acc_score: 0.9754; val_best_f1_score: 0.9757; train_kl_reg_loss: 15881.9437; train_edge_recon_loss: 25554995.0137; train_gene_expr_recon_loss: 679606.2373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26250483.1908; train_optim_loss: 26250483.1908; val_kl_reg_loss: 15758.7300; val_edge_recon_loss: 25601623.7906; val_gene_expr_recon_loss: 682704.8779; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26300087.4258; val_optim_loss: 26300087.4258
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9941; val_auprc_score: 0.9921; val_best_acc_score: 0.9747; val_best_f1_score: 0.9751; train_kl_reg_loss: 15947.6173; train_edge_recon_loss: 25550753.5592; train_gene_expr_recon_loss: 679617.6838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26246318.8418; train_optim_loss: 26246318.8418; val_kl_reg_loss: 15752.4752; val_edge_recon_loss: 25613636.5724; val_gene_expr_recon_loss: 683196.1990; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26312585.2321; val_optim_loss: 26312585.2321
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9944; val_auprc_score: 0.9927; val_best_acc_score: 0.9752; val_best_f1_score: 0.9756; train_kl_reg_loss: 15846.5907; train_edge_recon_loss: 25552045.8595; train_gene_expr_recon_loss: 679546.7975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26247439.2381; train_optim_loss: 26247439.2381; val_kl_reg_loss: 15770.5978; val_edge_recon_loss: 25602213.2810; val_gene_expr_recon_loss: 682850.7352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26300834.5969; val_optim_loss: 26300834.5969
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9944; val_auprc_score: 0.9925; val_best_acc_score: 0.9753; val_best_f1_score: 0.9756; train_kl_reg_loss: 15821.7233; train_edge_recon_loss: 25554597.2391; train_gene_expr_recon_loss: 679250.7035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26249669.6607; train_optim_loss: 26249669.6607; val_kl_reg_loss: 15648.1183; val_edge_recon_loss: 25602264.8412; val_gene_expr_recon_loss: 683156.6436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26301069.5881; val_optim_loss: 26301069.5881
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9941; val_auprc_score: 0.9920; val_best_acc_score: 0.9746; val_best_f1_score: 0.9749; train_kl_reg_loss: 15765.8639; train_edge_recon_loss: 25551766.4798; train_gene_expr_recon_loss: 678949.3708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26246481.7051; train_optim_loss: 26246481.7051; val_kl_reg_loss: 15743.4469; val_edge_recon_loss: 25616141.0716; val_gene_expr_recon_loss: 682682.2894; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26314566.8150; val_optim_loss: 26314566.8150

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9941; val_auprc_score: 0.9921; val_best_acc_score: 0.9753; val_best_f1_score: 0.9756; train_kl_reg_loss: 15821.0606; train_edge_recon_loss: 25550946.4631; train_gene_expr_recon_loss: 678057.0604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26244824.5906; train_optim_loss: 26244824.5906; val_kl_reg_loss: 15674.6070; val_edge_recon_loss: 25611493.4956; val_gene_expr_recon_loss: 681561.1687; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26308729.2757; val_optim_loss: 26308729.2757
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9943; val_auprc_score: 0.9925; val_best_acc_score: 0.9747; val_best_f1_score: 0.9751; train_kl_reg_loss: 15787.0882; train_edge_recon_loss: 25549111.2364; train_gene_expr_recon_loss: 677952.6861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26242851.0251; train_optim_loss: 26242851.0251; val_kl_reg_loss: 15650.2826; val_edge_recon_loss: 25614648.9860; val_gene_expr_recon_loss: 682077.8004; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26312377.0419; val_optim_loss: 26312377.0419
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9939; val_auprc_score: 0.9917; val_best_acc_score: 0.9749; val_best_f1_score: 0.9753; train_kl_reg_loss: 15751.6528; train_edge_recon_loss: 25550842.5667; train_gene_expr_recon_loss: 677869.3836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26244463.6182; train_optim_loss: 26244463.6182; val_kl_reg_loss: 15672.3611; val_edge_recon_loss: 25606669.0768; val_gene_expr_recon_loss: 680644.3812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26302985.8604; val_optim_loss: 26302985.8604
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9940; val_auprc_score: 0.9921; val_best_acc_score: 0.9741; val_best_f1_score: 0.9744; train_kl_reg_loss: 15772.5828; train_edge_recon_loss: 25550194.4838; train_gene_expr_recon_loss: 678178.5790; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26244145.6487; train_optim_loss: 26244145.6487; val_kl_reg_loss: 15625.6029; val_edge_recon_loss: 25637504.9058; val_gene_expr_recon_loss: 681529.1193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26334659.6283; val_optim_loss: 26334659.6283

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 925 min 43 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
Val AUROC score: 0.9942
Val AUPRC score: 0.9925
Val best accuracy score: 0.9749
Val best F1 score: 0.9752
Val gene expr MSE score: 1.8899

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
