None
Run timestamp: 03072023_205013_13.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_13']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9679; val_auprc_score: 0.9654; val_best_acc_score: 0.9117; val_best_f1_score: 0.9130; train_kl_reg_loss: 1976.7586; train_edge_recon_loss: 28393.9518; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30370.7105; train_optim_loss: 30370.7105; val_kl_reg_loss: 2149.6910; val_edge_recon_loss: 26666.8995; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28816.5906; val_optim_loss: 28816.5906
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9764; val_auprc_score: 0.9745; val_best_acc_score: 0.9239; val_best_f1_score: 0.9244; train_kl_reg_loss: 2230.2262; train_edge_recon_loss: 27439.9038; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29670.1300; train_optim_loss: 29670.1300; val_kl_reg_loss: 2193.9827; val_edge_recon_loss: 26477.2614; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28671.2441; val_optim_loss: 28671.2441
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9799; val_auprc_score: 0.9779; val_best_acc_score: 0.9298; val_best_f1_score: 0.9303; train_kl_reg_loss: 2244.8517; train_edge_recon_loss: 27346.3377; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29591.1894; train_optim_loss: 29591.1894; val_kl_reg_loss: 2211.9522; val_edge_recon_loss: 26513.0522; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28725.0043; val_optim_loss: 28725.0043
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9814; val_auprc_score: 0.9798; val_best_acc_score: 0.9337; val_best_f1_score: 0.9343; train_kl_reg_loss: 2249.6150; train_edge_recon_loss: 27317.7029; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29567.3179; train_optim_loss: 29567.3179; val_kl_reg_loss: 2211.2312; val_edge_recon_loss: 26392.6072; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28603.8382; val_optim_loss: 28603.8382
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9834; val_auprc_score: 0.9819; val_best_acc_score: 0.9374; val_best_f1_score: 0.9380; train_kl_reg_loss: 2256.2358; train_edge_recon_loss: 27285.7027; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29541.9386; train_optim_loss: 29541.9386; val_kl_reg_loss: 2290.3202; val_edge_recon_loss: 26420.7277; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28711.0479; val_optim_loss: 28711.0479
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9834; val_auprc_score: 0.9818; val_best_acc_score: 0.9386; val_best_f1_score: 0.9389; train_kl_reg_loss: 2265.3896; train_edge_recon_loss: 27247.1435; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29512.5332; train_optim_loss: 29512.5332; val_kl_reg_loss: 2219.5236; val_edge_recon_loss: 26412.4558; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28631.9793; val_optim_loss: 28631.9793
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9853; val_auprc_score: 0.9839; val_best_acc_score: 0.9419; val_best_f1_score: 0.9424; train_kl_reg_loss: 2270.1516; train_edge_recon_loss: 27225.9904; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29496.1420; train_optim_loss: 29496.1420; val_kl_reg_loss: 2209.4575; val_edge_recon_loss: 26398.8975; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28608.3551; val_optim_loss: 28608.3551
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9855; val_auprc_score: 0.9841; val_best_acc_score: 0.9431; val_best_f1_score: 0.9432; train_kl_reg_loss: 2269.6824; train_edge_recon_loss: 27226.5457; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29496.2282; train_optim_loss: 29496.2282; val_kl_reg_loss: 2256.9568; val_edge_recon_loss: 26342.7102; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28599.6668; val_optim_loss: 28599.6668
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9863; val_auprc_score: 0.9850; val_best_acc_score: 0.9441; val_best_f1_score: 0.9443; train_kl_reg_loss: 2273.4337; train_edge_recon_loss: 27202.4823; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29475.9161; train_optim_loss: 29475.9161; val_kl_reg_loss: 2205.5319; val_edge_recon_loss: 26332.8386; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28538.3704; val_optim_loss: 28538.3704
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9866; val_auprc_score: 0.9855; val_best_acc_score: 0.9442; val_best_f1_score: 0.9445; train_kl_reg_loss: 2272.4595; train_edge_recon_loss: 27209.3045; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29481.7640; train_optim_loss: 29481.7640; val_kl_reg_loss: 2233.5305; val_edge_recon_loss: 26355.2341; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28588.7645; val_optim_loss: 28588.7645
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9870; val_auprc_score: 0.9853; val_best_acc_score: 0.9469; val_best_f1_score: 0.9472; train_kl_reg_loss: 2277.0820; train_edge_recon_loss: 27179.2622; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29456.3442; train_optim_loss: 29456.3442; val_kl_reg_loss: 2242.1502; val_edge_recon_loss: 26324.9542; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28567.1045; val_optim_loss: 28567.1045
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9868; val_auprc_score: 0.9856; val_best_acc_score: 0.9454; val_best_f1_score: 0.9459; train_kl_reg_loss: 2277.4539; train_edge_recon_loss: 27176.4720; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29453.9259; train_optim_loss: 29453.9259; val_kl_reg_loss: 2230.7568; val_edge_recon_loss: 26313.1248; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28543.8816; val_optim_loss: 28543.8816
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9862; val_auprc_score: 0.9844; val_best_acc_score: 0.9451; val_best_f1_score: 0.9455; train_kl_reg_loss: 2277.8734; train_edge_recon_loss: 27174.1936; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29452.0669; train_optim_loss: 29452.0669; val_kl_reg_loss: 2248.8260; val_edge_recon_loss: 26347.2537; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28596.0797; val_optim_loss: 28596.0797

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9883; val_auprc_score: 0.9871; val_best_acc_score: 0.9495; val_best_f1_score: 0.9498; train_kl_reg_loss: 2274.8666; train_edge_recon_loss: 27138.1715; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29413.0382; train_optim_loss: 29413.0382; val_kl_reg_loss: 2218.9431; val_edge_recon_loss: 26260.8963; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28479.8394; val_optim_loss: 28479.8394
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9883; val_auprc_score: 0.9867; val_best_acc_score: 0.9500; val_best_f1_score: 0.9504; train_kl_reg_loss: 2272.7591; train_edge_recon_loss: 27136.9555; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29409.7146; train_optim_loss: 29409.7146; val_kl_reg_loss: 2236.3022; val_edge_recon_loss: 26266.8130; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28503.1152; val_optim_loss: 28503.1152
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9884; val_auprc_score: 0.9870; val_best_acc_score: 0.9497; val_best_f1_score: 0.9501; train_kl_reg_loss: 2273.8429; train_edge_recon_loss: 27124.9584; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29398.8013; train_optim_loss: 29398.8013; val_kl_reg_loss: 2217.0708; val_edge_recon_loss: 26301.3308; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28518.4016; val_optim_loss: 28518.4016
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9886; val_auprc_score: 0.9872; val_best_acc_score: 0.9507; val_best_f1_score: 0.9510; train_kl_reg_loss: 2271.9261; train_edge_recon_loss: 27130.2681; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29402.1943; train_optim_loss: 29402.1943; val_kl_reg_loss: 2215.2177; val_edge_recon_loss: 26261.1227; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28476.3404; val_optim_loss: 28476.3404
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9882; val_auprc_score: 0.9865; val_best_acc_score: 0.9497; val_best_f1_score: 0.9501; train_kl_reg_loss: 2270.4153; train_edge_recon_loss: 27133.4126; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29403.8279; train_optim_loss: 29403.8279; val_kl_reg_loss: 2205.8267; val_edge_recon_loss: 26281.9436; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28487.7703; val_optim_loss: 28487.7703
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9884; val_auprc_score: 0.9870; val_best_acc_score: 0.9497; val_best_f1_score: 0.9501; train_kl_reg_loss: 2271.8982; train_edge_recon_loss: 27120.3412; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29392.2395; train_optim_loss: 29392.2395; val_kl_reg_loss: 2253.4774; val_edge_recon_loss: 26299.5009; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28552.9782; val_optim_loss: 28552.9782
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9886; val_auprc_score: 0.9872; val_best_acc_score: 0.9501; val_best_f1_score: 0.9502; train_kl_reg_loss: 2271.0719; train_edge_recon_loss: 27125.9272; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29396.9991; train_optim_loss: 29396.9991; val_kl_reg_loss: 2248.9376; val_edge_recon_loss: 26288.4778; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28537.4155; val_optim_loss: 28537.4155
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9890; val_auprc_score: 0.9876; val_best_acc_score: 0.9511; val_best_f1_score: 0.9515; train_kl_reg_loss: 2272.6570; train_edge_recon_loss: 27112.9051; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29385.5622; train_optim_loss: 29385.5622; val_kl_reg_loss: 2244.3101; val_edge_recon_loss: 26274.5638; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28518.8740; val_optim_loss: 28518.8740

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9886; val_auprc_score: 0.9869; val_best_acc_score: 0.9509; val_best_f1_score: 0.9513; train_kl_reg_loss: 2271.5491; train_edge_recon_loss: 27113.1922; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29384.7413; train_optim_loss: 29384.7413; val_kl_reg_loss: 2227.6856; val_edge_recon_loss: 26290.5785; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28518.2643; val_optim_loss: 28518.2643
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9885; val_auprc_score: 0.9870; val_best_acc_score: 0.9502; val_best_f1_score: 0.9504; train_kl_reg_loss: 2269.2400; train_edge_recon_loss: 27121.4132; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29390.6532; train_optim_loss: 29390.6532; val_kl_reg_loss: 2221.5860; val_edge_recon_loss: 26291.1683; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28512.7543; val_optim_loss: 28512.7543
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9887; val_auprc_score: 0.9872; val_best_acc_score: 0.9511; val_best_f1_score: 0.9515; train_kl_reg_loss: 2271.4382; train_edge_recon_loss: 27109.9262; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29381.3644; train_optim_loss: 29381.3644; val_kl_reg_loss: 2234.6272; val_edge_recon_loss: 26255.8533; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28490.4806; val_optim_loss: 28490.4806
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9891; val_auprc_score: 0.9879; val_best_acc_score: 0.9518; val_best_f1_score: 0.9520; train_kl_reg_loss: 2269.8200; train_edge_recon_loss: 27120.9222; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29390.7423; train_optim_loss: 29390.7423; val_kl_reg_loss: 2231.4671; val_edge_recon_loss: 26236.4174; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28467.8845; val_optim_loss: 28467.8845
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9889; val_auprc_score: 0.9877; val_best_acc_score: 0.9504; val_best_f1_score: 0.9507; train_kl_reg_loss: 2270.4637; train_edge_recon_loss: 27115.1555; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29385.6192; train_optim_loss: 29385.6192; val_kl_reg_loss: 2232.4455; val_edge_recon_loss: 26276.0583; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28508.5037; val_optim_loss: 28508.5037
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9886; val_auprc_score: 0.9870; val_best_acc_score: 0.9506; val_best_f1_score: 0.9511; train_kl_reg_loss: 2272.4612; train_edge_recon_loss: 27104.7821; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29377.2432; train_optim_loss: 29377.2432; val_kl_reg_loss: 2228.6119; val_edge_recon_loss: 26275.8552; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28504.4671; val_optim_loss: 28504.4671
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9886; val_auprc_score: 0.9867; val_best_acc_score: 0.9509; val_best_f1_score: 0.9512; train_kl_reg_loss: 2268.4631; train_edge_recon_loss: 27123.7119; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29392.1751; train_optim_loss: 29392.1751; val_kl_reg_loss: 2228.1149; val_edge_recon_loss: 26263.8602; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28491.9749; val_optim_loss: 28491.9749
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9888; val_auprc_score: 0.9870; val_best_acc_score: 0.9518; val_best_f1_score: 0.9520; train_kl_reg_loss: 2267.9510; train_edge_recon_loss: 27126.1072; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29394.0582; train_optim_loss: 29394.0582; val_kl_reg_loss: 2216.6539; val_edge_recon_loss: 26262.0056; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28478.6596; val_optim_loss: 28478.6596

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9888; val_auprc_score: 0.9872; val_best_acc_score: 0.9513; val_best_f1_score: 0.9516; train_kl_reg_loss: 2266.8881; train_edge_recon_loss: 27116.4517; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29383.3398; train_optim_loss: 29383.3398; val_kl_reg_loss: 2226.7872; val_edge_recon_loss: 26270.0069; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28496.7941; val_optim_loss: 28496.7941
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9889; val_auprc_score: 0.9872; val_best_acc_score: 0.9513; val_best_f1_score: 0.9516; train_kl_reg_loss: 2268.8236; train_edge_recon_loss: 27117.3289; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29386.1525; train_optim_loss: 29386.1525; val_kl_reg_loss: 2227.5461; val_edge_recon_loss: 26244.3178; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28471.8639; val_optim_loss: 28471.8639
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9892; val_auprc_score: 0.9879; val_best_acc_score: 0.9515; val_best_f1_score: 0.9515; train_kl_reg_loss: 2269.6345; train_edge_recon_loss: 27114.2151; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29383.8496; train_optim_loss: 29383.8496; val_kl_reg_loss: 2227.9483; val_edge_recon_loss: 26261.9694; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28489.9178; val_optim_loss: 28489.9178
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9889; val_auprc_score: 0.9874; val_best_acc_score: 0.9512; val_best_f1_score: 0.9516; train_kl_reg_loss: 2269.9988; train_edge_recon_loss: 27116.8981; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29386.8969; train_optim_loss: 29386.8969; val_kl_reg_loss: 2229.6047; val_edge_recon_loss: 26260.8233; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28490.4280; val_optim_loss: 28490.4280

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 62 min 30 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9887
Val AUPRC score: 0.9873
Val best accuracy score: 0.9509
Val best F1 score: 0.9511
Val gene expr MSE score: 14.9966

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
