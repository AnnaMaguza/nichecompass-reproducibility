None
Run timestamp: 05072023_224648_13.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_13']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9742; val_auprc_score: 0.9715; val_best_acc_score: 0.9218; val_best_f1_score: 0.9227; train_kl_reg_loss: 2067.5455; train_edge_recon_loss: 28032.5376; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30100.0831; train_optim_loss: 30100.0831; val_kl_reg_loss: 2148.8727; val_edge_recon_loss: 26547.9784; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28696.8512; val_optim_loss: 28696.8512
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9785; val_auprc_score: 0.9766; val_best_acc_score: 0.9286; val_best_f1_score: 0.9291; train_kl_reg_loss: 2231.1140; train_edge_recon_loss: 27375.3116; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29606.4256; train_optim_loss: 29606.4256; val_kl_reg_loss: 2158.1528; val_edge_recon_loss: 26496.7709; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28654.9237; val_optim_loss: 28654.9237
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9824; val_auprc_score: 0.9802; val_best_acc_score: 0.9372; val_best_f1_score: 0.9375; train_kl_reg_loss: 2244.4640; train_edge_recon_loss: 27303.6193; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29548.0832; train_optim_loss: 29548.0832; val_kl_reg_loss: 2181.6041; val_edge_recon_loss: 26420.9670; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28602.5711; val_optim_loss: 28602.5711
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9844; val_auprc_score: 0.9827; val_best_acc_score: 0.9408; val_best_f1_score: 0.9411; train_kl_reg_loss: 2253.1367; train_edge_recon_loss: 27264.8940; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29518.0307; train_optim_loss: 29518.0307; val_kl_reg_loss: 2229.4797; val_edge_recon_loss: 26386.5506; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28616.0303; val_optim_loss: 28616.0303
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9832; val_auprc_score: 0.9815; val_best_acc_score: 0.9386; val_best_f1_score: 0.9389; train_kl_reg_loss: 2261.0840; train_edge_recon_loss: 27229.7330; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29490.8170; train_optim_loss: 29490.8170; val_kl_reg_loss: 2242.7345; val_edge_recon_loss: 26396.0331; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28638.7677; val_optim_loss: 28638.7677
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9844; val_auprc_score: 0.9830; val_best_acc_score: 0.9406; val_best_f1_score: 0.9410; train_kl_reg_loss: 2263.3449; train_edge_recon_loss: 27217.9256; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29481.2705; train_optim_loss: 29481.2705; val_kl_reg_loss: 2215.2774; val_edge_recon_loss: 26394.7992; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28610.0766; val_optim_loss: 28610.0766
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9855; val_auprc_score: 0.9837; val_best_acc_score: 0.9436; val_best_f1_score: 0.9438; train_kl_reg_loss: 2264.3383; train_edge_recon_loss: 27206.4863; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29470.8246; train_optim_loss: 29470.8246; val_kl_reg_loss: 2225.2706; val_edge_recon_loss: 26301.4772; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28526.7478; val_optim_loss: 28526.7478
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9854; val_auprc_score: 0.9843; val_best_acc_score: 0.9424; val_best_f1_score: 0.9426; train_kl_reg_loss: 2264.3391; train_edge_recon_loss: 27198.6166; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29462.9557; train_optim_loss: 29462.9557; val_kl_reg_loss: 2293.9713; val_edge_recon_loss: 26431.8479; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28725.8192; val_optim_loss: 28725.8192
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9871; val_auprc_score: 0.9858; val_best_acc_score: 0.9474; val_best_f1_score: 0.9475; train_kl_reg_loss: 2266.3328; train_edge_recon_loss: 27179.5839; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29445.9167; train_optim_loss: 29445.9167; val_kl_reg_loss: 2177.8802; val_edge_recon_loss: 26343.4200; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28521.3002; val_optim_loss: 28521.3002
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9870; val_auprc_score: 0.9854; val_best_acc_score: 0.9465; val_best_f1_score: 0.9468; train_kl_reg_loss: 2269.3897; train_edge_recon_loss: 27167.6956; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29437.0853; train_optim_loss: 29437.0853; val_kl_reg_loss: 2177.8633; val_edge_recon_loss: 26342.2543; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28520.1176; val_optim_loss: 28520.1176
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9860; val_auprc_score: 0.9845; val_best_acc_score: 0.9449; val_best_f1_score: 0.9452; train_kl_reg_loss: 2270.0224; train_edge_recon_loss: 27156.7785; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29426.8008; train_optim_loss: 29426.8008; val_kl_reg_loss: 2239.2959; val_edge_recon_loss: 26341.5004; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28580.7963; val_optim_loss: 28580.7963
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9872; val_auprc_score: 0.9852; val_best_acc_score: 0.9486; val_best_f1_score: 0.9487; train_kl_reg_loss: 2269.9935; train_edge_recon_loss: 27153.6653; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29423.6589; train_optim_loss: 29423.6589; val_kl_reg_loss: 2239.9653; val_edge_recon_loss: 26347.2488; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28587.2142; val_optim_loss: 28587.2142
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9871; val_auprc_score: 0.9855; val_best_acc_score: 0.9472; val_best_f1_score: 0.9475; train_kl_reg_loss: 2270.7447; train_edge_recon_loss: 27152.0633; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29422.8080; train_optim_loss: 29422.8080; val_kl_reg_loss: 2249.1807; val_edge_recon_loss: 26300.1304; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28549.3110; val_optim_loss: 28549.3110
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9882; val_auprc_score: 0.9868; val_best_acc_score: 0.9498; val_best_f1_score: 0.9503; train_kl_reg_loss: 2273.5980; train_edge_recon_loss: 27132.9311; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29406.5290; train_optim_loss: 29406.5290; val_kl_reg_loss: 2238.8705; val_edge_recon_loss: 26316.4847; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28555.3552; val_optim_loss: 28555.3552

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9891; val_auprc_score: 0.9875; val_best_acc_score: 0.9522; val_best_f1_score: 0.9525; train_kl_reg_loss: 2267.5014; train_edge_recon_loss: 27102.5658; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29370.0672; train_optim_loss: 29370.0672; val_kl_reg_loss: 2237.0340; val_edge_recon_loss: 26260.8615; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28497.8954; val_optim_loss: 28497.8954
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9891; val_auprc_score: 0.9876; val_best_acc_score: 0.9522; val_best_f1_score: 0.9524; train_kl_reg_loss: 2267.1595; train_edge_recon_loss: 27098.0403; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29365.1998; train_optim_loss: 29365.1998; val_kl_reg_loss: 2261.0581; val_edge_recon_loss: 26243.2403; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28504.2983; val_optim_loss: 28504.2983
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9886; val_auprc_score: 0.9870; val_best_acc_score: 0.9513; val_best_f1_score: 0.9517; train_kl_reg_loss: 2266.4512; train_edge_recon_loss: 27090.9679; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29357.4191; train_optim_loss: 29357.4191; val_kl_reg_loss: 2218.1248; val_edge_recon_loss: 26296.0764; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28514.2012; val_optim_loss: 28514.2012
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9891; val_auprc_score: 0.9877; val_best_acc_score: 0.9521; val_best_f1_score: 0.9524; train_kl_reg_loss: 2266.1188; train_edge_recon_loss: 27086.9597; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29353.0785; train_optim_loss: 29353.0785; val_kl_reg_loss: 2243.9660; val_edge_recon_loss: 26269.6147; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28513.5806; val_optim_loss: 28513.5806
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9896; val_auprc_score: 0.9883; val_best_acc_score: 0.9529; val_best_f1_score: 0.9532; train_kl_reg_loss: 2263.8638; train_edge_recon_loss: 27092.4425; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29356.3063; train_optim_loss: 29356.3063; val_kl_reg_loss: 2207.6255; val_edge_recon_loss: 26279.4798; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28487.1054; val_optim_loss: 28487.1054
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9894; val_auprc_score: 0.9880; val_best_acc_score: 0.9530; val_best_f1_score: 0.9531; train_kl_reg_loss: 2264.9477; train_edge_recon_loss: 27090.9527; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29355.9004; train_optim_loss: 29355.9004; val_kl_reg_loss: 2223.3604; val_edge_recon_loss: 26223.3455; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28446.7059; val_optim_loss: 28446.7059
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9892; val_auprc_score: 0.9875; val_best_acc_score: 0.9524; val_best_f1_score: 0.9525; train_kl_reg_loss: 2266.6945; train_edge_recon_loss: 27072.8025; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29339.4970; train_optim_loss: 29339.4970; val_kl_reg_loss: 2221.0553; val_edge_recon_loss: 26240.4933; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28461.5487; val_optim_loss: 28461.5487
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9893; val_auprc_score: 0.9879; val_best_acc_score: 0.9527; val_best_f1_score: 0.9531; train_kl_reg_loss: 2262.4417; train_edge_recon_loss: 27086.3497; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29348.7914; train_optim_loss: 29348.7914; val_kl_reg_loss: 2221.7089; val_edge_recon_loss: 26274.5924; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28496.3013; val_optim_loss: 28496.3013
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9892; val_auprc_score: 0.9873; val_best_acc_score: 0.9530; val_best_f1_score: 0.9533; train_kl_reg_loss: 2262.5876; train_edge_recon_loss: 27087.4970; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29350.0846; train_optim_loss: 29350.0846; val_kl_reg_loss: 2232.9393; val_edge_recon_loss: 26224.5081; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28457.4474; val_optim_loss: 28457.4474
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9894; val_auprc_score: 0.9879; val_best_acc_score: 0.9530; val_best_f1_score: 0.9534; train_kl_reg_loss: 2265.8246; train_edge_recon_loss: 27071.2484; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29337.0730; train_optim_loss: 29337.0730; val_kl_reg_loss: 2220.8639; val_edge_recon_loss: 26254.9910; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28475.8550; val_optim_loss: 28475.8550

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9894; val_auprc_score: 0.9879; val_best_acc_score: 0.9530; val_best_f1_score: 0.9534; train_kl_reg_loss: 2263.2166; train_edge_recon_loss: 27076.8957; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29340.1123; train_optim_loss: 29340.1123; val_kl_reg_loss: 2223.2382; val_edge_recon_loss: 26249.9442; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28473.1825; val_optim_loss: 28473.1825
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9895; val_auprc_score: 0.9879; val_best_acc_score: 0.9539; val_best_f1_score: 0.9542; train_kl_reg_loss: 2261.9314; train_edge_recon_loss: 27074.2130; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29336.1444; train_optim_loss: 29336.1444; val_kl_reg_loss: 2230.5972; val_edge_recon_loss: 26230.5718; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28461.1689; val_optim_loss: 28461.1689
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9897; val_auprc_score: 0.9882; val_best_acc_score: 0.9542; val_best_f1_score: 0.9545; train_kl_reg_loss: 2261.5546; train_edge_recon_loss: 27081.6142; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29343.1688; train_optim_loss: 29343.1688; val_kl_reg_loss: 2227.4490; val_edge_recon_loss: 26246.7524; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28474.2013; val_optim_loss: 28474.2013
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9897; val_auprc_score: 0.9881; val_best_acc_score: 0.9537; val_best_f1_score: 0.9540; train_kl_reg_loss: 2263.5477; train_edge_recon_loss: 27072.9156; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29336.4633; train_optim_loss: 29336.4633; val_kl_reg_loss: 2235.1109; val_edge_recon_loss: 26228.0002; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28463.1110; val_optim_loss: 28463.1110

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 35 min 6 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
Val AUROC score: 0.9894
Val AUPRC score: 0.9881
Val best accuracy score: 0.9523
Val best F1 score: 0.9525
Val gene expr MSE score: 14.8045

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
