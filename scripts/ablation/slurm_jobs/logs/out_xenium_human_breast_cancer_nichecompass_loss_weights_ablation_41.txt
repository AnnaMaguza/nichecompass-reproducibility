None
Run timestamp: 29062023_003107_41.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_41']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
heaps
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9484; val_auprc_score: 0.9356; val_best_acc_score: 0.8850; val_best_f1_score: 0.8918; train_kl_reg_loss: 6619.1596; train_edge_recon_loss: 270788.7432; train_gene_expr_recon_loss: 132177.6004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409585.5028; train_optim_loss: 409585.5028; val_kl_reg_loss: 6655.4144; val_edge_recon_loss: 268495.1069; val_gene_expr_recon_loss: 125971.0385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 401121.5592; val_optim_loss: 401121.5592
heaps
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9619; val_auprc_score: 0.9522; val_best_acc_score: 0.9059; val_best_f1_score: 0.9099; train_kl_reg_loss: 6928.5325; train_edge_recon_loss: 263745.5469; train_gene_expr_recon_loss: 124275.6895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394949.7691; train_optim_loss: 394949.7691; val_kl_reg_loss: 6641.6630; val_edge_recon_loss: 267433.4930; val_gene_expr_recon_loss: 121403.4874; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395478.6435; val_optim_loss: 395478.6435
heaps
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9670; val_auprc_score: 0.9585; val_best_acc_score: 0.9145; val_best_f1_score: 0.9179; train_kl_reg_loss: 7060.0959; train_edge_recon_loss: 262656.2675; train_gene_expr_recon_loss: 120764.7513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390481.1142; train_optim_loss: 390481.1142; val_kl_reg_loss: 7031.3634; val_edge_recon_loss: 266964.6188; val_gene_expr_recon_loss: 118853.2796; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392849.2636; val_optim_loss: 392849.2636
heaps
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9691; val_auprc_score: 0.9619; val_best_acc_score: 0.9160; val_best_f1_score: 0.9188; train_kl_reg_loss: 7138.1141; train_edge_recon_loss: 262425.3513; train_gene_expr_recon_loss: 118600.1777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388163.6433; train_optim_loss: 388163.6433; val_kl_reg_loss: 6931.0830; val_edge_recon_loss: 266739.9782; val_gene_expr_recon_loss: 116952.4298; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390623.4914; val_optim_loss: 390623.4914
heaps
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9699; val_auprc_score: 0.9621; val_best_acc_score: 0.9178; val_best_f1_score: 0.9210; train_kl_reg_loss: 7183.0171; train_edge_recon_loss: 262084.3634; train_gene_expr_recon_loss: 117188.0567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386455.4370; train_optim_loss: 386455.4370; val_kl_reg_loss: 7057.9957; val_edge_recon_loss: 267197.9893; val_gene_expr_recon_loss: 115709.7307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389965.7142; val_optim_loss: 389965.7142
heaps
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9710; val_auprc_score: 0.9637; val_best_acc_score: 0.9197; val_best_f1_score: 0.9227; train_kl_reg_loss: 7196.5042; train_edge_recon_loss: 262014.7692; train_gene_expr_recon_loss: 116252.8376; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385464.1108; train_optim_loss: 385464.1108; val_kl_reg_loss: 7030.3040; val_edge_recon_loss: 266685.1271; val_gene_expr_recon_loss: 114981.7136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388697.1456; val_optim_loss: 388697.1456
heaps
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9716; val_auprc_score: 0.9635; val_best_acc_score: 0.9218; val_best_f1_score: 0.9244; train_kl_reg_loss: 7200.6844; train_edge_recon_loss: 261897.9205; train_gene_expr_recon_loss: 115538.2699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384636.8748; train_optim_loss: 384636.8748; val_kl_reg_loss: 7017.1124; val_edge_recon_loss: 266312.0206; val_gene_expr_recon_loss: 114937.6605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388266.7924; val_optim_loss: 388266.7924
heaps
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9715; val_auprc_score: 0.9632; val_best_acc_score: 0.9234; val_best_f1_score: 0.9256; train_kl_reg_loss: 7202.5826; train_edge_recon_loss: 261700.5835; train_gene_expr_recon_loss: 115097.8936; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384001.0591; train_optim_loss: 384001.0591; val_kl_reg_loss: 7110.1995; val_edge_recon_loss: 266189.1135; val_gene_expr_recon_loss: 114248.5012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387547.8125; val_optim_loss: 387547.8125
heaps
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9705; val_auprc_score: 0.9621; val_best_acc_score: 0.9213; val_best_f1_score: 0.9244; train_kl_reg_loss: 7201.3377; train_edge_recon_loss: 261577.8899; train_gene_expr_recon_loss: 114777.3464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383556.5747; train_optim_loss: 383556.5747; val_kl_reg_loss: 6921.1396; val_edge_recon_loss: 266364.8676; val_gene_expr_recon_loss: 113985.9484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387271.9552; val_optim_loss: 387271.9552
heaps
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9736; val_auprc_score: 0.9670; val_best_acc_score: 0.9250; val_best_f1_score: 0.9273; train_kl_reg_loss: 7193.2810; train_edge_recon_loss: 261462.4679; train_gene_expr_recon_loss: 114518.8652; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383174.6143; train_optim_loss: 383174.6143; val_kl_reg_loss: 7002.7863; val_edge_recon_loss: 265753.9963; val_gene_expr_recon_loss: 113654.9807; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386411.7619; val_optim_loss: 386411.7619
heaps
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9725; val_auprc_score: 0.9641; val_best_acc_score: 0.9263; val_best_f1_score: 0.9288; train_kl_reg_loss: 7184.0966; train_edge_recon_loss: 261484.2520; train_gene_expr_recon_loss: 114315.2199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382983.5690; train_optim_loss: 382983.5690; val_kl_reg_loss: 7045.7857; val_edge_recon_loss: 265926.0674; val_gene_expr_recon_loss: 113357.1231; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386328.9774; val_optim_loss: 386328.9774
heaps
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9753; val_auprc_score: 0.9689; val_best_acc_score: 0.9283; val_best_f1_score: 0.9305; train_kl_reg_loss: 7180.0927; train_edge_recon_loss: 261471.1345; train_gene_expr_recon_loss: 114137.0089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382788.2358; train_optim_loss: 382788.2358; val_kl_reg_loss: 7079.1742; val_edge_recon_loss: 265814.1277; val_gene_expr_recon_loss: 113447.0664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386340.3692; val_optim_loss: 386340.3692
heaps
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9741; val_auprc_score: 0.9671; val_best_acc_score: 0.9264; val_best_f1_score: 0.9285; train_kl_reg_loss: 7177.1871; train_edge_recon_loss: 261276.2584; train_gene_expr_recon_loss: 114055.5509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382508.9971; train_optim_loss: 382508.9971; val_kl_reg_loss: 7143.2566; val_edge_recon_loss: 265974.7658; val_gene_expr_recon_loss: 113288.0767; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386406.0991; val_optim_loss: 386406.0991
heaps
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9740; val_auprc_score: 0.9674; val_best_acc_score: 0.9270; val_best_f1_score: 0.9292; train_kl_reg_loss: 7167.4017; train_edge_recon_loss: 261271.0111; train_gene_expr_recon_loss: 113898.9090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382337.3214; train_optim_loss: 382337.3214; val_kl_reg_loss: 6970.6771; val_edge_recon_loss: 266617.6042; val_gene_expr_recon_loss: 113488.8721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387077.1530; val_optim_loss: 387077.1530
heaps
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9720; val_auprc_score: 0.9641; val_best_acc_score: 0.9237; val_best_f1_score: 0.9263; train_kl_reg_loss: 7167.3867; train_edge_recon_loss: 261203.2999; train_gene_expr_recon_loss: 113824.7322; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382195.4172; train_optim_loss: 382195.4172; val_kl_reg_loss: 6885.0972; val_edge_recon_loss: 266260.3170; val_gene_expr_recon_loss: 112901.1402; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386046.5539; val_optim_loss: 386046.5539
heaps
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9749; val_auprc_score: 0.9678; val_best_acc_score: 0.9288; val_best_f1_score: 0.9310; train_kl_reg_loss: 7163.9782; train_edge_recon_loss: 261090.7719; train_gene_expr_recon_loss: 113862.5148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382117.2649; train_optim_loss: 382117.2649; val_kl_reg_loss: 7018.8181; val_edge_recon_loss: 265375.5337; val_gene_expr_recon_loss: 113072.7774; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385467.1303; val_optim_loss: 385467.1303
heaps
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9754; val_auprc_score: 0.9687; val_best_acc_score: 0.9302; val_best_f1_score: 0.9319; train_kl_reg_loss: 7157.5898; train_edge_recon_loss: 261119.6902; train_gene_expr_recon_loss: 113706.2259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381983.5056; train_optim_loss: 381983.5056; val_kl_reg_loss: 6998.0759; val_edge_recon_loss: 265895.3867; val_gene_expr_recon_loss: 112981.1254; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385874.5872; val_optim_loss: 385874.5872
heaps
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9753; val_auprc_score: 0.9686; val_best_acc_score: 0.9298; val_best_f1_score: 0.9322; train_kl_reg_loss: 7155.6026; train_edge_recon_loss: 261172.5953; train_gene_expr_recon_loss: 113669.9202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381998.1185; train_optim_loss: 381998.1185; val_kl_reg_loss: 7081.8119; val_edge_recon_loss: 266061.2926; val_gene_expr_recon_loss: 112754.0537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385897.1591; val_optim_loss: 385897.1591
heaps
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9749; val_auprc_score: 0.9681; val_best_acc_score: 0.9286; val_best_f1_score: 0.9306; train_kl_reg_loss: 7150.9271; train_edge_recon_loss: 261123.9963; train_gene_expr_recon_loss: 113621.9818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381896.9053; train_optim_loss: 381896.9053; val_kl_reg_loss: 7121.1333; val_edge_recon_loss: 265800.4794; val_gene_expr_recon_loss: 113021.7946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385943.4071; val_optim_loss: 385943.4071
heaps
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9762; val_auprc_score: 0.9692; val_best_acc_score: 0.9319; val_best_f1_score: 0.9338; train_kl_reg_loss: 7149.9886; train_edge_recon_loss: 260978.7223; train_gene_expr_recon_loss: 113600.3923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381729.1028; train_optim_loss: 381729.1028; val_kl_reg_loss: 6936.6097; val_edge_recon_loss: 265342.8242; val_gene_expr_recon_loss: 112780.3720; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385059.8047; val_optim_loss: 385059.8047
heaps
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9758; val_auprc_score: 0.9691; val_best_acc_score: 0.9316; val_best_f1_score: 0.9337; train_kl_reg_loss: 7148.7739; train_edge_recon_loss: 261019.2566; train_gene_expr_recon_loss: 113530.1095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381698.1398; train_optim_loss: 381698.1398; val_kl_reg_loss: 6924.5135; val_edge_recon_loss: 265366.7632; val_gene_expr_recon_loss: 112884.3898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385175.6661; val_optim_loss: 385175.6661
heaps
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9746; val_auprc_score: 0.9675; val_best_acc_score: 0.9287; val_best_f1_score: 0.9308; train_kl_reg_loss: 7142.8330; train_edge_recon_loss: 261042.2281; train_gene_expr_recon_loss: 113499.7603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381684.8218; train_optim_loss: 381684.8218; val_kl_reg_loss: 6978.5098; val_edge_recon_loss: 265445.9278; val_gene_expr_recon_loss: 112944.9930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385369.4289; val_optim_loss: 385369.4289
heaps
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9751; val_auprc_score: 0.9681; val_best_acc_score: 0.9292; val_best_f1_score: 0.9311; train_kl_reg_loss: 7141.1008; train_edge_recon_loss: 261095.9253; train_gene_expr_recon_loss: 113480.9986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381718.0244; train_optim_loss: 381718.0244; val_kl_reg_loss: 6969.2468; val_edge_recon_loss: 265832.4394; val_gene_expr_recon_loss: 113115.5847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385917.2693; val_optim_loss: 385917.2693
heaps
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9753; val_auprc_score: 0.9675; val_best_acc_score: 0.9304; val_best_f1_score: 0.9325; train_kl_reg_loss: 7145.1368; train_edge_recon_loss: 260913.3415; train_gene_expr_recon_loss: 113476.5182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381534.9977; train_optim_loss: 381534.9977; val_kl_reg_loss: 7080.3547; val_edge_recon_loss: 265403.4147; val_gene_expr_recon_loss: 112633.6059; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385117.3775; val_optim_loss: 385117.3775

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

heaps
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9773; val_auprc_score: 0.9713; val_best_acc_score: 0.9321; val_best_f1_score: 0.9344; train_kl_reg_loss: 7120.0452; train_edge_recon_loss: 260714.6943; train_gene_expr_recon_loss: 112497.7327; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380332.4722; train_optim_loss: 380332.4722; val_kl_reg_loss: 6950.3231; val_edge_recon_loss: 264764.6032; val_gene_expr_recon_loss: 112050.5066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383765.4346; val_optim_loss: 383765.4346
heaps
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9765; val_auprc_score: 0.9704; val_best_acc_score: 0.9316; val_best_f1_score: 0.9336; train_kl_reg_loss: 7098.7698; train_edge_recon_loss: 260671.5033; train_gene_expr_recon_loss: 112332.5074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380102.7804; train_optim_loss: 380102.7804; val_kl_reg_loss: 6963.2272; val_edge_recon_loss: 265108.6593; val_gene_expr_recon_loss: 111880.5117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383952.3988; val_optim_loss: 383952.3988
heaps
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9768; val_auprc_score: 0.9702; val_best_acc_score: 0.9324; val_best_f1_score: 0.9340; train_kl_reg_loss: 7087.4958; train_edge_recon_loss: 260517.1629; train_gene_expr_recon_loss: 112351.7834; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379956.4432; train_optim_loss: 379956.4432; val_kl_reg_loss: 6987.5715; val_edge_recon_loss: 265110.8189; val_gene_expr_recon_loss: 111794.4818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383892.8709; val_optim_loss: 383892.8709
heaps
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9773; val_auprc_score: 0.9716; val_best_acc_score: 0.9316; val_best_f1_score: 0.9336; train_kl_reg_loss: 7074.5372; train_edge_recon_loss: 260633.2265; train_gene_expr_recon_loss: 112333.3587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380041.1225; train_optim_loss: 380041.1225; val_kl_reg_loss: 6965.6342; val_edge_recon_loss: 265495.4118; val_gene_expr_recon_loss: 111759.7572; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384220.8010; val_optim_loss: 384220.8010
heaps
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9762; val_auprc_score: 0.9694; val_best_acc_score: 0.9323; val_best_f1_score: 0.9342; train_kl_reg_loss: 7062.6588; train_edge_recon_loss: 260594.8177; train_gene_expr_recon_loss: 112324.0003; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379981.4761; train_optim_loss: 379981.4761; val_kl_reg_loss: 6936.0512; val_edge_recon_loss: 265262.7646; val_gene_expr_recon_loss: 112017.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384216.0053; val_optim_loss: 384216.0053

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

heaps
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9769; val_auprc_score: 0.9708; val_best_acc_score: 0.9327; val_best_f1_score: 0.9345; train_kl_reg_loss: 7061.6161; train_edge_recon_loss: 260579.8609; train_gene_expr_recon_loss: 112213.7726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379855.2499; train_optim_loss: 379855.2499; val_kl_reg_loss: 6931.1322; val_edge_recon_loss: 265204.8514; val_gene_expr_recon_loss: 111562.0446; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383698.0280; val_optim_loss: 383698.0280
heaps
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9780; val_auprc_score: 0.9723; val_best_acc_score: 0.9347; val_best_f1_score: 0.9364; train_kl_reg_loss: 7059.2070; train_edge_recon_loss: 260549.7185; train_gene_expr_recon_loss: 112183.2337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379792.1585; train_optim_loss: 379792.1585; val_kl_reg_loss: 6928.8930; val_edge_recon_loss: 264625.6854; val_gene_expr_recon_loss: 111714.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383268.7862; val_optim_loss: 383268.7862
heaps
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9776; val_auprc_score: 0.9720; val_best_acc_score: 0.9330; val_best_f1_score: 0.9350; train_kl_reg_loss: 7057.3842; train_edge_recon_loss: 260503.0188; train_gene_expr_recon_loss: 112154.3830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379714.7865; train_optim_loss: 379714.7865; val_kl_reg_loss: 6931.6838; val_edge_recon_loss: 265043.0354; val_gene_expr_recon_loss: 111705.4937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383680.2138; val_optim_loss: 383680.2138
heaps
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9773; val_auprc_score: 0.9712; val_best_acc_score: 0.9333; val_best_f1_score: 0.9348; train_kl_reg_loss: 7058.7630; train_edge_recon_loss: 260578.0615; train_gene_expr_recon_loss: 112212.0670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379848.8919; train_optim_loss: 379848.8919; val_kl_reg_loss: 6927.3264; val_edge_recon_loss: 265112.4023; val_gene_expr_recon_loss: 111820.2641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383859.9910; val_optim_loss: 383859.9910
heaps
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9775; val_auprc_score: 0.9713; val_best_acc_score: 0.9333; val_best_f1_score: 0.9351; train_kl_reg_loss: 7056.6254; train_edge_recon_loss: 260609.3779; train_gene_expr_recon_loss: 112152.8794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379818.8823; train_optim_loss: 379818.8823; val_kl_reg_loss: 6918.2315; val_edge_recon_loss: 265163.7399; val_gene_expr_recon_loss: 111565.8108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383647.7845; val_optim_loss: 383647.7845
heaps
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9781; val_auprc_score: 0.9721; val_best_acc_score: 0.9343; val_best_f1_score: 0.9362; train_kl_reg_loss: 7057.4915; train_edge_recon_loss: 260524.9693; train_gene_expr_recon_loss: 112171.9251; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379754.3856; train_optim_loss: 379754.3856; val_kl_reg_loss: 6935.5293; val_edge_recon_loss: 264479.6643; val_gene_expr_recon_loss: 111643.0527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383058.2496; val_optim_loss: 383058.2496
heaps
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9774; val_auprc_score: 0.9709; val_best_acc_score: 0.9336; val_best_f1_score: 0.9354; train_kl_reg_loss: 7054.1616; train_edge_recon_loss: 260669.0517; train_gene_expr_recon_loss: 112110.9669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379834.1808; train_optim_loss: 379834.1808; val_kl_reg_loss: 6931.7579; val_edge_recon_loss: 265218.8507; val_gene_expr_recon_loss: 111760.6540; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383911.2636; val_optim_loss: 383911.2636
heaps
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9773; val_auprc_score: 0.9709; val_best_acc_score: 0.9336; val_best_f1_score: 0.9354; train_kl_reg_loss: 7057.1499; train_edge_recon_loss: 260475.0169; train_gene_expr_recon_loss: 112125.1308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379657.2974; train_optim_loss: 379657.2974; val_kl_reg_loss: 6939.8416; val_edge_recon_loss: 264693.7985; val_gene_expr_recon_loss: 111806.9349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383440.5728; val_optim_loss: 383440.5728
heaps
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9772; val_auprc_score: 0.9708; val_best_acc_score: 0.9330; val_best_f1_score: 0.9348; train_kl_reg_loss: 7055.9565; train_edge_recon_loss: 260605.6972; train_gene_expr_recon_loss: 112159.4044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379821.0581; train_optim_loss: 379821.0581; val_kl_reg_loss: 6935.3607; val_edge_recon_loss: 264996.8540; val_gene_expr_recon_loss: 111844.7943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383777.0082; val_optim_loss: 383777.0082
heaps
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9773; val_auprc_score: 0.9710; val_best_acc_score: 0.9330; val_best_f1_score: 0.9348; train_kl_reg_loss: 7056.0099; train_edge_recon_loss: 260591.5062; train_gene_expr_recon_loss: 112189.1398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379836.6554; train_optim_loss: 379836.6554; val_kl_reg_loss: 6927.6282; val_edge_recon_loss: 265340.8470; val_gene_expr_recon_loss: 111672.0073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383940.4836; val_optim_loss: 383940.4836

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

heaps
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9773; val_auprc_score: 0.9708; val_best_acc_score: 0.9331; val_best_f1_score: 0.9348; train_kl_reg_loss: 7051.7378; train_edge_recon_loss: 260614.3242; train_gene_expr_recon_loss: 112117.5830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379783.6454; train_optim_loss: 379783.6454; val_kl_reg_loss: 6917.8265; val_edge_recon_loss: 265018.1419; val_gene_expr_recon_loss: 111700.4788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383636.4482; val_optim_loss: 383636.4482
heaps
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9779; val_auprc_score: 0.9722; val_best_acc_score: 0.9334; val_best_f1_score: 0.9350; train_kl_reg_loss: 7054.1840; train_edge_recon_loss: 260605.2814; train_gene_expr_recon_loss: 112117.6203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379777.0858; train_optim_loss: 379777.0858; val_kl_reg_loss: 6923.3409; val_edge_recon_loss: 265071.4410; val_gene_expr_recon_loss: 111724.9241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383719.7085; val_optim_loss: 383719.7085
heaps
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9775; val_auprc_score: 0.9711; val_best_acc_score: 0.9343; val_best_f1_score: 0.9361; train_kl_reg_loss: 7054.5112; train_edge_recon_loss: 260508.9026; train_gene_expr_recon_loss: 112096.7285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379660.1416; train_optim_loss: 379660.1416; val_kl_reg_loss: 6921.7334; val_edge_recon_loss: 264873.4211; val_gene_expr_recon_loss: 111888.1577; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383683.3133; val_optim_loss: 383683.3133
heaps
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9774; val_auprc_score: 0.9709; val_best_acc_score: 0.9334; val_best_f1_score: 0.9351; train_kl_reg_loss: 7055.2789; train_edge_recon_loss: 260496.9340; train_gene_expr_recon_loss: 112152.5028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379704.7161; train_optim_loss: 379704.7161; val_kl_reg_loss: 6919.7001; val_edge_recon_loss: 265035.9971; val_gene_expr_recon_loss: 111750.6678; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383706.3660; val_optim_loss: 383706.3660

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 77 min 40 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9772
Val AUPRC score: 0.9711
Val best accuracy score: 0.9330
Val best F1 score: 0.9347
Val gene expr MSE score: 2.6199

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
