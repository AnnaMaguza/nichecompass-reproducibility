None
Run timestamp: 03072023_122014_3000.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_3000']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9686; val_auprc_score: 0.9561; val_best_acc_score: 0.9240; val_best_f1_score: 0.9266; train_kl_reg_loss: 7565.9752; train_edge_recon_loss: 277944.8643; train_gene_expr_recon_loss: 136167.1491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 421677.9888; train_optim_loss: 421677.9888; val_kl_reg_loss: 8072.3857; val_edge_recon_loss: 266563.7166; val_gene_expr_recon_loss: 119985.6772; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394621.7784; val_optim_loss: 394621.7784
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9754; val_auprc_score: 0.9653; val_best_acc_score: 0.9366; val_best_f1_score: 0.9386; train_kl_reg_loss: 8002.8884; train_edge_recon_loss: 263382.2970; train_gene_expr_recon_loss: 116494.4586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387879.6424; train_optim_loss: 387879.6424; val_kl_reg_loss: 7394.2657; val_edge_recon_loss: 264828.5668; val_gene_expr_recon_loss: 113661.6488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385884.4773; val_optim_loss: 385884.4773
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9790; val_auprc_score: 0.9697; val_best_acc_score: 0.9451; val_best_f1_score: 0.9465; train_kl_reg_loss: 7547.1347; train_edge_recon_loss: 261998.5509; train_gene_expr_recon_loss: 111655.8488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381201.5350; train_optim_loss: 381201.5350; val_kl_reg_loss: 7183.4567; val_edge_recon_loss: 263314.2180; val_gene_expr_recon_loss: 109732.4968; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380230.1733; val_optim_loss: 380230.1733
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9797; val_auprc_score: 0.9712; val_best_acc_score: 0.9471; val_best_f1_score: 0.9484; train_kl_reg_loss: 7368.3979; train_edge_recon_loss: 261374.6230; train_gene_expr_recon_loss: 108715.0006; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 377458.0205; train_optim_loss: 377458.0205; val_kl_reg_loss: 7124.9842; val_edge_recon_loss: 263285.7166; val_gene_expr_recon_loss: 107345.7710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 377756.4744; val_optim_loss: 377756.4744
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9814; val_auprc_score: 0.9742; val_best_acc_score: 0.9503; val_best_f1_score: 0.9519; train_kl_reg_loss: 7256.1911; train_edge_recon_loss: 260938.2034; train_gene_expr_recon_loss: 106468.9491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374663.3434; train_optim_loss: 374663.3434; val_kl_reg_loss: 6973.1905; val_edge_recon_loss: 262591.3054; val_gene_expr_recon_loss: 105496.7994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 375061.2997; val_optim_loss: 375061.2997
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9828; val_auprc_score: 0.9755; val_best_acc_score: 0.9532; val_best_f1_score: 0.9543; train_kl_reg_loss: 7146.2478; train_edge_recon_loss: 260874.7021; train_gene_expr_recon_loss: 104639.7397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372660.6886; train_optim_loss: 372660.6886; val_kl_reg_loss: 6864.6579; val_edge_recon_loss: 262612.9084; val_gene_expr_recon_loss: 103925.2681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373402.8338; val_optim_loss: 373402.8338
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9830; val_auprc_score: 0.9761; val_best_acc_score: 0.9544; val_best_f1_score: 0.9557; train_kl_reg_loss: 7090.3894; train_edge_recon_loss: 260396.7899; train_gene_expr_recon_loss: 102855.1909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370342.3714; train_optim_loss: 370342.3714; val_kl_reg_loss: 6805.3908; val_edge_recon_loss: 262912.7131; val_gene_expr_recon_loss: 102689.8999; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372408.0043; val_optim_loss: 372408.0043
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9836; val_auprc_score: 0.9776; val_best_acc_score: 0.9548; val_best_f1_score: 0.9560; train_kl_reg_loss: 7064.9897; train_edge_recon_loss: 260154.6950; train_gene_expr_recon_loss: 101694.7170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368914.4027; train_optim_loss: 368914.4027; val_kl_reg_loss: 6852.2177; val_edge_recon_loss: 262019.8771; val_gene_expr_recon_loss: 101459.4371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370331.5327; val_optim_loss: 370331.5327
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9841; val_auprc_score: 0.9781; val_best_acc_score: 0.9562; val_best_f1_score: 0.9571; train_kl_reg_loss: 7006.1905; train_edge_recon_loss: 260129.8687; train_gene_expr_recon_loss: 100493.4198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367629.4790; train_optim_loss: 367629.4790; val_kl_reg_loss: 6850.0830; val_edge_recon_loss: 262238.5767; val_gene_expr_recon_loss: 100322.6729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369411.3324; val_optim_loss: 369411.3324
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9849; val_auprc_score: 0.9787; val_best_acc_score: 0.9568; val_best_f1_score: 0.9579; train_kl_reg_loss: 6984.2694; train_edge_recon_loss: 260061.0860; train_gene_expr_recon_loss: 99586.5221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366631.8789; train_optim_loss: 366631.8789; val_kl_reg_loss: 6794.7887; val_edge_recon_loss: 262357.8089; val_gene_expr_recon_loss: 99553.0575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368705.6562; val_optim_loss: 368705.6562
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9849; val_auprc_score: 0.9794; val_best_acc_score: 0.9569; val_best_f1_score: 0.9580; train_kl_reg_loss: 6973.1666; train_edge_recon_loss: 259712.2882; train_gene_expr_recon_loss: 98486.3497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365171.8034; train_optim_loss: 365171.8034; val_kl_reg_loss: 6723.1267; val_edge_recon_loss: 261756.6477; val_gene_expr_recon_loss: 98780.4727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367260.2500; val_optim_loss: 367260.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9841; val_auprc_score: 0.9776; val_best_acc_score: 0.9574; val_best_f1_score: 0.9584; train_kl_reg_loss: 6941.0248; train_edge_recon_loss: 259884.0316; train_gene_expr_recon_loss: 97840.0753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364665.1310; train_optim_loss: 364665.1310; val_kl_reg_loss: 6746.8188; val_edge_recon_loss: 261576.4531; val_gene_expr_recon_loss: 98065.9577; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366389.2273; val_optim_loss: 366389.2273
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9853; val_auprc_score: 0.9800; val_best_acc_score: 0.9578; val_best_f1_score: 0.9589; train_kl_reg_loss: 6914.8622; train_edge_recon_loss: 259631.5817; train_gene_expr_recon_loss: 97111.3022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363657.7453; train_optim_loss: 363657.7453; val_kl_reg_loss: 6786.7887; val_edge_recon_loss: 262291.8544; val_gene_expr_recon_loss: 97444.5188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366523.1634; val_optim_loss: 366523.1634
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9847; val_auprc_score: 0.9786; val_best_acc_score: 0.9583; val_best_f1_score: 0.9593; train_kl_reg_loss: 6921.7901; train_edge_recon_loss: 259606.2327; train_gene_expr_recon_loss: 96327.6419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362855.6649; train_optim_loss: 362855.6649; val_kl_reg_loss: 6710.9533; val_edge_recon_loss: 261494.9702; val_gene_expr_recon_loss: 97069.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365275.1918; val_optim_loss: 365275.1918
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9851; val_auprc_score: 0.9786; val_best_acc_score: 0.9600; val_best_f1_score: 0.9610; train_kl_reg_loss: 6913.0655; train_edge_recon_loss: 259443.2291; train_gene_expr_recon_loss: 95771.6485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362127.9438; train_optim_loss: 362127.9438; val_kl_reg_loss: 6691.1241; val_edge_recon_loss: 261595.1825; val_gene_expr_recon_loss: 96639.6740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364925.9801; val_optim_loss: 364925.9801
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9857; val_auprc_score: 0.9799; val_best_acc_score: 0.9588; val_best_f1_score: 0.9598; train_kl_reg_loss: 6916.8685; train_edge_recon_loss: 259411.6580; train_gene_expr_recon_loss: 95172.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361501.3299; train_optim_loss: 361501.3299; val_kl_reg_loss: 6768.3041; val_edge_recon_loss: 261589.2820; val_gene_expr_recon_loss: 96330.2940; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364687.8821; val_optim_loss: 364687.8821
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9850; val_auprc_score: 0.9786; val_best_acc_score: 0.9589; val_best_f1_score: 0.9598; train_kl_reg_loss: 6909.4264; train_edge_recon_loss: 259339.6214; train_gene_expr_recon_loss: 94667.8459; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360916.8926; train_optim_loss: 360916.8926; val_kl_reg_loss: 6789.4454; val_edge_recon_loss: 261661.8097; val_gene_expr_recon_loss: 95654.3803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364105.6321; val_optim_loss: 364105.6321
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9860; val_auprc_score: 0.9798; val_best_acc_score: 0.9616; val_best_f1_score: 0.9625; train_kl_reg_loss: 6906.8255; train_edge_recon_loss: 259146.0650; train_gene_expr_recon_loss: 94262.2730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360315.1646; train_optim_loss: 360315.1646; val_kl_reg_loss: 6685.9487; val_edge_recon_loss: 260669.3970; val_gene_expr_recon_loss: 95566.8739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362922.2159; val_optim_loss: 362922.2159
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9864; val_auprc_score: 0.9809; val_best_acc_score: 0.9613; val_best_f1_score: 0.9619; train_kl_reg_loss: 6893.2433; train_edge_recon_loss: 259345.7832; train_gene_expr_recon_loss: 93901.7998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360140.8247; train_optim_loss: 360140.8247; val_kl_reg_loss: 6725.7051; val_edge_recon_loss: 261164.6094; val_gene_expr_recon_loss: 94950.7312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362841.0497; val_optim_loss: 362841.0497
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9866; val_auprc_score: 0.9818; val_best_acc_score: 0.9602; val_best_f1_score: 0.9611; train_kl_reg_loss: 6904.3469; train_edge_recon_loss: 259018.4119; train_gene_expr_recon_loss: 93415.5570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359338.3167; train_optim_loss: 359338.3167; val_kl_reg_loss: 6741.4395; val_edge_recon_loss: 261491.1399; val_gene_expr_recon_loss: 95121.5398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363354.1151; val_optim_loss: 363354.1151
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9858; val_auprc_score: 0.9803; val_best_acc_score: 0.9615; val_best_f1_score: 0.9623; train_kl_reg_loss: 6885.5985; train_edge_recon_loss: 259128.7209; train_gene_expr_recon_loss: 93015.6671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359029.9862; train_optim_loss: 359029.9862; val_kl_reg_loss: 6671.7527; val_edge_recon_loss: 260925.0320; val_gene_expr_recon_loss: 94679.8146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362276.5938; val_optim_loss: 362276.5938
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9859; val_auprc_score: 0.9805; val_best_acc_score: 0.9604; val_best_f1_score: 0.9614; train_kl_reg_loss: 6901.8283; train_edge_recon_loss: 258964.8497; train_gene_expr_recon_loss: 92739.4981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358606.1764; train_optim_loss: 358606.1764; val_kl_reg_loss: 6730.7178; val_edge_recon_loss: 261364.5668; val_gene_expr_recon_loss: 94344.0870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362439.3679; val_optim_loss: 362439.3679
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9859; val_auprc_score: 0.9804; val_best_acc_score: 0.9624; val_best_f1_score: 0.9632; train_kl_reg_loss: 6899.1725; train_edge_recon_loss: 259047.9704; train_gene_expr_recon_loss: 92363.2447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358310.3883; train_optim_loss: 358310.3883; val_kl_reg_loss: 6766.4250; val_edge_recon_loss: 261157.5582; val_gene_expr_recon_loss: 94053.6147; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361977.5952; val_optim_loss: 361977.5952
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9868; val_auprc_score: 0.9816; val_best_acc_score: 0.9623; val_best_f1_score: 0.9631; train_kl_reg_loss: 6896.1248; train_edge_recon_loss: 258784.2472; train_gene_expr_recon_loss: 92034.7646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357715.1356; train_optim_loss: 357715.1356; val_kl_reg_loss: 6714.3566; val_edge_recon_loss: 260863.2507; val_gene_expr_recon_loss: 93954.9418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361532.5469; val_optim_loss: 361532.5469
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9871; val_auprc_score: 0.9825; val_best_acc_score: 0.9630; val_best_f1_score: 0.9636; train_kl_reg_loss: 6905.7554; train_edge_recon_loss: 258690.4531; train_gene_expr_recon_loss: 91879.8802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357476.0897; train_optim_loss: 357476.0897; val_kl_reg_loss: 6758.8630; val_edge_recon_loss: 260799.7585; val_gene_expr_recon_loss: 94181.8938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361740.5142; val_optim_loss: 361740.5142
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9863; val_auprc_score: 0.9808; val_best_acc_score: 0.9605; val_best_f1_score: 0.9615; train_kl_reg_loss: 6908.3890; train_edge_recon_loss: 258542.4522; train_gene_expr_recon_loss: 91551.7648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357002.6064; train_optim_loss: 357002.6064; val_kl_reg_loss: 6756.8224; val_edge_recon_loss: 261545.2557; val_gene_expr_recon_loss: 94098.0202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362400.0952; val_optim_loss: 362400.0952
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9876; val_auprc_score: 0.9833; val_best_acc_score: 0.9640; val_best_f1_score: 0.9647; train_kl_reg_loss: 6898.4257; train_edge_recon_loss: 258759.2297; train_gene_expr_recon_loss: 91222.9488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356880.6043; train_optim_loss: 356880.6043; val_kl_reg_loss: 6719.3212; val_edge_recon_loss: 260388.4190; val_gene_expr_recon_loss: 93586.2720; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360694.0156; val_optim_loss: 360694.0156
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9867; val_auprc_score: 0.9813; val_best_acc_score: 0.9625; val_best_f1_score: 0.9634; train_kl_reg_loss: 6914.8540; train_edge_recon_loss: 258472.9392; train_gene_expr_recon_loss: 91060.3664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356448.1582; train_optim_loss: 356448.1582; val_kl_reg_loss: 6763.9931; val_edge_recon_loss: 260743.1420; val_gene_expr_recon_loss: 94002.6935; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361509.8281; val_optim_loss: 361509.8281
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9875; val_auprc_score: 0.9826; val_best_acc_score: 0.9633; val_best_f1_score: 0.9640; train_kl_reg_loss: 6897.9198; train_edge_recon_loss: 258532.8650; train_gene_expr_recon_loss: 90831.0269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356261.8128; train_optim_loss: 356261.8128; val_kl_reg_loss: 6778.5237; val_edge_recon_loss: 261018.4226; val_gene_expr_recon_loss: 93609.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361406.1293; val_optim_loss: 361406.1293
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9868; val_auprc_score: 0.9817; val_best_acc_score: 0.9627; val_best_f1_score: 0.9635; train_kl_reg_loss: 6899.7298; train_edge_recon_loss: 258677.4840; train_gene_expr_recon_loss: 90664.1871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356241.4010; train_optim_loss: 356241.4010; val_kl_reg_loss: 6741.6556; val_edge_recon_loss: 261253.8004; val_gene_expr_recon_loss: 93555.3920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361550.8494; val_optim_loss: 361550.8494
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9877; val_auprc_score: 0.9830; val_best_acc_score: 0.9636; val_best_f1_score: 0.9644; train_kl_reg_loss: 6912.3180; train_edge_recon_loss: 258365.4610; train_gene_expr_recon_loss: 90417.7609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355695.5387; train_optim_loss: 355695.5387; val_kl_reg_loss: 6808.3543; val_edge_recon_loss: 260734.2678; val_gene_expr_recon_loss: 93240.3324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360782.9560; val_optim_loss: 360782.9560

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9879; val_auprc_score: 0.9830; val_best_acc_score: 0.9646; val_best_f1_score: 0.9653; train_kl_reg_loss: 6883.2896; train_edge_recon_loss: 258237.2455; train_gene_expr_recon_loss: 89685.1434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354805.6784; train_optim_loss: 354805.6784; val_kl_reg_loss: 6695.4588; val_edge_recon_loss: 260400.8395; val_gene_expr_recon_loss: 93268.1353; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360364.4318; val_optim_loss: 360364.4318
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9879; val_auprc_score: 0.9832; val_best_acc_score: 0.9644; val_best_f1_score: 0.9652; train_kl_reg_loss: 6874.3871; train_edge_recon_loss: 258174.3866; train_gene_expr_recon_loss: 89657.2325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354706.0067; train_optim_loss: 354706.0067; val_kl_reg_loss: 6729.6201; val_edge_recon_loss: 260658.7259; val_gene_expr_recon_loss: 93240.5344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360628.8807; val_optim_loss: 360628.8807
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9881; val_auprc_score: 0.9838; val_best_acc_score: 0.9645; val_best_f1_score: 0.9653; train_kl_reg_loss: 6864.0596; train_edge_recon_loss: 258349.6210; train_gene_expr_recon_loss: 89647.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354861.5241; train_optim_loss: 354861.5241; val_kl_reg_loss: 6737.5516; val_edge_recon_loss: 260334.4141; val_gene_expr_recon_loss: 92878.0266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359949.9943; val_optim_loss: 359949.9943
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9880; val_auprc_score: 0.9835; val_best_acc_score: 0.9643; val_best_f1_score: 0.9652; train_kl_reg_loss: 6864.9265; train_edge_recon_loss: 258190.9116; train_gene_expr_recon_loss: 89595.5896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354651.4281; train_optim_loss: 354651.4281; val_kl_reg_loss: 6738.1688; val_edge_recon_loss: 260660.3004; val_gene_expr_recon_loss: 93164.6119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360563.0781; val_optim_loss: 360563.0781
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9886; val_auprc_score: 0.9844; val_best_acc_score: 0.9656; val_best_f1_score: 0.9662; train_kl_reg_loss: 6869.4485; train_edge_recon_loss: 258314.2674; train_gene_expr_recon_loss: 89555.5063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354739.2217; train_optim_loss: 354739.2217; val_kl_reg_loss: 6739.7339; val_edge_recon_loss: 260568.9297; val_gene_expr_recon_loss: 93047.9350; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360356.5966; val_optim_loss: 360356.5966
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9889; val_auprc_score: 0.9848; val_best_acc_score: 0.9653; val_best_f1_score: 0.9660; train_kl_reg_loss: 6855.0333; train_edge_recon_loss: 258403.3852; train_gene_expr_recon_loss: 89504.1396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354762.5581; train_optim_loss: 354762.5581; val_kl_reg_loss: 6705.6384; val_edge_recon_loss: 260163.6080; val_gene_expr_recon_loss: 92912.7415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359781.9901; val_optim_loss: 359781.9901
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9889; val_auprc_score: 0.9849; val_best_acc_score: 0.9653; val_best_f1_score: 0.9659; train_kl_reg_loss: 6863.1650; train_edge_recon_loss: 258284.0928; train_gene_expr_recon_loss: 89499.2382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354646.4971; train_optim_loss: 354646.4971; val_kl_reg_loss: 6721.4653; val_edge_recon_loss: 260273.6357; val_gene_expr_recon_loss: 92987.5636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359982.6634; val_optim_loss: 359982.6634
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9882; val_auprc_score: 0.9840; val_best_acc_score: 0.9644; val_best_f1_score: 0.9650; train_kl_reg_loss: 6858.9131; train_edge_recon_loss: 258126.1864; train_gene_expr_recon_loss: 89495.5759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354480.6761; train_optim_loss: 354480.6761; val_kl_reg_loss: 6734.3142; val_edge_recon_loss: 260683.7848; val_gene_expr_recon_loss: 92959.9929; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360378.0966; val_optim_loss: 360378.0966
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9886; val_auprc_score: 0.9846; val_best_acc_score: 0.9651; val_best_f1_score: 0.9658; train_kl_reg_loss: 6867.9311; train_edge_recon_loss: 258070.4454; train_gene_expr_recon_loss: 89445.3058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354383.6833; train_optim_loss: 354383.6833; val_kl_reg_loss: 6723.6070; val_edge_recon_loss: 260445.0185; val_gene_expr_recon_loss: 93244.3878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360413.0156; val_optim_loss: 360413.0156
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9888; val_auprc_score: 0.9848; val_best_acc_score: 0.9659; val_best_f1_score: 0.9665; train_kl_reg_loss: 6860.8847; train_edge_recon_loss: 258174.5260; train_gene_expr_recon_loss: 89430.6412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354466.0526; train_optim_loss: 354466.0526; val_kl_reg_loss: 6729.9460; val_edge_recon_loss: 260125.2869; val_gene_expr_recon_loss: 93315.5266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360170.7614; val_optim_loss: 360170.7614

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9885; val_auprc_score: 0.9839; val_best_acc_score: 0.9654; val_best_f1_score: 0.9660; train_kl_reg_loss: 6852.1138; train_edge_recon_loss: 258190.3861; train_gene_expr_recon_loss: 89289.5845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354332.0850; train_optim_loss: 354332.0850; val_kl_reg_loss: 6702.9630; val_edge_recon_loss: 260333.7138; val_gene_expr_recon_loss: 93210.0664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360246.7443; val_optim_loss: 360246.7443
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9882; val_auprc_score: 0.9838; val_best_acc_score: 0.9648; val_best_f1_score: 0.9654; train_kl_reg_loss: 6848.5079; train_edge_recon_loss: 258175.6867; train_gene_expr_recon_loss: 89321.1998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354345.3960; train_optim_loss: 354345.3960; val_kl_reg_loss: 6709.4488; val_edge_recon_loss: 260760.4453; val_gene_expr_recon_loss: 92994.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360464.7514; val_optim_loss: 360464.7514
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9876; val_auprc_score: 0.9821; val_best_acc_score: 0.9652; val_best_f1_score: 0.9658; train_kl_reg_loss: 6849.1790; train_edge_recon_loss: 258325.0854; train_gene_expr_recon_loss: 89348.5200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354522.7852; train_optim_loss: 354522.7852; val_kl_reg_loss: 6705.3576; val_edge_recon_loss: 260433.1463; val_gene_expr_recon_loss: 93114.8043; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360253.3026; val_optim_loss: 360253.3026
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9876; val_auprc_score: 0.9826; val_best_acc_score: 0.9651; val_best_f1_score: 0.9659; train_kl_reg_loss: 6845.8469; train_edge_recon_loss: 258241.1348; train_gene_expr_recon_loss: 89218.1609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354305.1426; train_optim_loss: 354305.1426; val_kl_reg_loss: 6721.6108; val_edge_recon_loss: 260408.1903; val_gene_expr_recon_loss: 93234.8683; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360364.6662; val_optim_loss: 360364.6662

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 43 min 27 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
Val AUROC score: 0.9883
Val AUPRC score: 0.9837
Val best accuracy score: 0.9661
Val best F1 score: 0.9667
Val gene expr MSE score: 0.6624

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
