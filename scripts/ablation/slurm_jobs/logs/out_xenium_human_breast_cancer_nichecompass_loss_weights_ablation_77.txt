None
Run timestamp: 28072023_174450_77.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_77']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9465; val_auprc_score: 0.9306; val_best_acc_score: 0.8873; val_best_f1_score: 0.8934; train_kl_reg_loss: 5310.3825; train_edge_recon_loss: 269155.7095; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 274466.0917; train_optim_loss: 274466.0917; val_kl_reg_loss: 5097.3328; val_edge_recon_loss: 266986.4807; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 272083.8135; val_optim_loss: 272083.8135
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9596; val_auprc_score: 0.9468; val_best_acc_score: 0.9047; val_best_f1_score: 0.9091; train_kl_reg_loss: 5260.6676; train_edge_recon_loss: 262810.8511; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 268071.5187; train_optim_loss: 268071.5187; val_kl_reg_loss: 5196.6600; val_edge_recon_loss: 266393.9932; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 271590.6521; val_optim_loss: 271590.6521
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9650; val_auprc_score: 0.9545; val_best_acc_score: 0.9139; val_best_f1_score: 0.9172; train_kl_reg_loss: 5272.6730; train_edge_recon_loss: 261985.3965; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 267258.0694; train_optim_loss: 267258.0694; val_kl_reg_loss: 5197.4407; val_edge_recon_loss: 264834.6830; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 270032.1238; val_optim_loss: 270032.1238
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9674; val_auprc_score: 0.9567; val_best_acc_score: 0.9175; val_best_f1_score: 0.9203; train_kl_reg_loss: 5267.2498; train_edge_recon_loss: 261578.0760; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 266845.3257; train_optim_loss: 266845.3257; val_kl_reg_loss: 5175.8774; val_edge_recon_loss: 265055.7360; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 270231.6131; val_optim_loss: 270231.6131
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9695; val_auprc_score: 0.9585; val_best_acc_score: 0.9234; val_best_f1_score: 0.9257; train_kl_reg_loss: 5258.4411; train_edge_recon_loss: 261424.0472; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 266682.4881; train_optim_loss: 266682.4881; val_kl_reg_loss: 5129.0628; val_edge_recon_loss: 264508.0189; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 269637.0810; val_optim_loss: 269637.0810
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9719; val_auprc_score: 0.9625; val_best_acc_score: 0.9252; val_best_f1_score: 0.9276; train_kl_reg_loss: 5250.1639; train_edge_recon_loss: 261010.1458; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 266260.3102; train_optim_loss: 266260.3102; val_kl_reg_loss: 5232.3019; val_edge_recon_loss: 263691.8014; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268924.1028; val_optim_loss: 268924.1028
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9723; val_auprc_score: 0.9639; val_best_acc_score: 0.9228; val_best_f1_score: 0.9252; train_kl_reg_loss: 5241.5990; train_edge_recon_loss: 261076.4042; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 266318.0033; train_optim_loss: 266318.0033; val_kl_reg_loss: 4995.3694; val_edge_recon_loss: 264832.6694; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 269828.0382; val_optim_loss: 269828.0382
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9728; val_auprc_score: 0.9645; val_best_acc_score: 0.9242; val_best_f1_score: 0.9263; train_kl_reg_loss: 5246.0319; train_edge_recon_loss: 260785.9991; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 266032.0312; train_optim_loss: 266032.0312; val_kl_reg_loss: 5156.0521; val_edge_recon_loss: 264429.6659; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 269585.7196; val_optim_loss: 269585.7196
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9741; val_auprc_score: 0.9661; val_best_acc_score: 0.9282; val_best_f1_score: 0.9305; train_kl_reg_loss: 5247.6767; train_edge_recon_loss: 260801.4437; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 266049.1206; train_optim_loss: 266049.1206; val_kl_reg_loss: 5049.2709; val_edge_recon_loss: 264086.8366; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 269136.1061; val_optim_loss: 269136.1061
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9746; val_auprc_score: 0.9668; val_best_acc_score: 0.9292; val_best_f1_score: 0.9311; train_kl_reg_loss: 5241.7815; train_edge_recon_loss: 260491.7541; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265733.5358; train_optim_loss: 265733.5358; val_kl_reg_loss: 5110.5642; val_edge_recon_loss: 264185.6431; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 269296.2089; val_optim_loss: 269296.2089

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9757; val_auprc_score: 0.9682; val_best_acc_score: 0.9299; val_best_f1_score: 0.9319; train_kl_reg_loss: 5228.5897; train_edge_recon_loss: 260285.8578; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265514.4474; train_optim_loss: 265514.4474; val_kl_reg_loss: 5151.4781; val_edge_recon_loss: 263926.8063; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 269078.2854; val_optim_loss: 269078.2854
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9764; val_auprc_score: 0.9681; val_best_acc_score: 0.9325; val_best_f1_score: 0.9345; train_kl_reg_loss: 5219.6778; train_edge_recon_loss: 260148.0290; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265367.7068; train_optim_loss: 265367.7068; val_kl_reg_loss: 5090.6705; val_edge_recon_loss: 263552.0695; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268642.7389; val_optim_loss: 268642.7389
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9755; val_auprc_score: 0.9675; val_best_acc_score: 0.9312; val_best_f1_score: 0.9334; train_kl_reg_loss: 5217.8246; train_edge_recon_loss: 260139.4809; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265357.3048; train_optim_loss: 265357.3048; val_kl_reg_loss: 5092.5501; val_edge_recon_loss: 263735.0397; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268827.5884; val_optim_loss: 268827.5884
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9766; val_auprc_score: 0.9689; val_best_acc_score: 0.9339; val_best_f1_score: 0.9357; train_kl_reg_loss: 5213.5807; train_edge_recon_loss: 260177.1870; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265390.7682; train_optim_loss: 265390.7682; val_kl_reg_loss: 5072.0905; val_edge_recon_loss: 263480.7847; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268552.8742; val_optim_loss: 268552.8742
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9765; val_auprc_score: 0.9690; val_best_acc_score: 0.9332; val_best_f1_score: 0.9354; train_kl_reg_loss: 5214.9247; train_edge_recon_loss: 260042.6838; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265257.6078; train_optim_loss: 265257.6078; val_kl_reg_loss: 5082.5691; val_edge_recon_loss: 263555.6482; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268638.2159; val_optim_loss: 268638.2159
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9760; val_auprc_score: 0.9683; val_best_acc_score: 0.9316; val_best_f1_score: 0.9338; train_kl_reg_loss: 5211.5824; train_edge_recon_loss: 260111.2477; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265322.8308; train_optim_loss: 265322.8308; val_kl_reg_loss: 5140.1069; val_edge_recon_loss: 264054.3976; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 269194.5037; val_optim_loss: 269194.5037
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9764; val_auprc_score: 0.9685; val_best_acc_score: 0.9325; val_best_f1_score: 0.9345; train_kl_reg_loss: 5216.2639; train_edge_recon_loss: 260033.5008; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265249.7645; train_optim_loss: 265249.7645; val_kl_reg_loss: 5102.0302; val_edge_recon_loss: 263716.0031; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268818.0329; val_optim_loss: 268818.0329
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9758; val_auprc_score: 0.9676; val_best_acc_score: 0.9321; val_best_f1_score: 0.9342; train_kl_reg_loss: 5210.7065; train_edge_recon_loss: 260101.8245; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265312.5310; train_optim_loss: 265312.5310; val_kl_reg_loss: 5075.1652; val_edge_recon_loss: 264031.6741; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 269106.8396; val_optim_loss: 269106.8396

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9772; val_auprc_score: 0.9700; val_best_acc_score: 0.9345; val_best_f1_score: 0.9362; train_kl_reg_loss: 5210.1789; train_edge_recon_loss: 259975.1474; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265185.3265; train_optim_loss: 265185.3265; val_kl_reg_loss: 5107.4680; val_edge_recon_loss: 263348.1065; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268455.5748; val_optim_loss: 268455.5748
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9772; val_auprc_score: 0.9701; val_best_acc_score: 0.9340; val_best_f1_score: 0.9356; train_kl_reg_loss: 5211.8485; train_edge_recon_loss: 259908.5501; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265120.3985; train_optim_loss: 265120.3985; val_kl_reg_loss: 5101.7732; val_edge_recon_loss: 263841.6982; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268943.4708; val_optim_loss: 268943.4708
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9776; val_auprc_score: 0.9703; val_best_acc_score: 0.9349; val_best_f1_score: 0.9364; train_kl_reg_loss: 5207.1583; train_edge_recon_loss: 260046.4537; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265253.6125; train_optim_loss: 265253.6125; val_kl_reg_loss: 5090.4527; val_edge_recon_loss: 263322.8092; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268413.2615; val_optim_loss: 268413.2615
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9774; val_auprc_score: 0.9701; val_best_acc_score: 0.9348; val_best_f1_score: 0.9366; train_kl_reg_loss: 5204.7166; train_edge_recon_loss: 260128.0271; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265332.7449; train_optim_loss: 265332.7449; val_kl_reg_loss: 5120.6096; val_edge_recon_loss: 263628.8037; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268749.4124; val_optim_loss: 268749.4124
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9767; val_auprc_score: 0.9688; val_best_acc_score: 0.9329; val_best_f1_score: 0.9350; train_kl_reg_loss: 5209.5670; train_edge_recon_loss: 259939.1375; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265148.7043; train_optim_loss: 265148.7043; val_kl_reg_loss: 5114.1290; val_edge_recon_loss: 263761.7812; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268875.9108; val_optim_loss: 268875.9108
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9772; val_auprc_score: 0.9696; val_best_acc_score: 0.9346; val_best_f1_score: 0.9364; train_kl_reg_loss: 5212.7626; train_edge_recon_loss: 259828.7907; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265041.5522; train_optim_loss: 265041.5522; val_kl_reg_loss: 5112.8257; val_edge_recon_loss: 263308.2605; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268421.0868; val_optim_loss: 268421.0868
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9772; val_auprc_score: 0.9698; val_best_acc_score: 0.9346; val_best_f1_score: 0.9362; train_kl_reg_loss: 5205.3039; train_edge_recon_loss: 260130.6315; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265335.9354; train_optim_loss: 265335.9354; val_kl_reg_loss: 5101.9692; val_edge_recon_loss: 263385.4453; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268487.4161; val_optim_loss: 268487.4161

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9758; val_auprc_score: 0.9681; val_best_acc_score: 0.9319; val_best_f1_score: 0.9342; train_kl_reg_loss: 5203.0937; train_edge_recon_loss: 260039.7595; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265242.8536; train_optim_loss: 265242.8536; val_kl_reg_loss: 5102.2415; val_edge_recon_loss: 264388.1910; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 269490.4322; val_optim_loss: 269490.4322
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9775; val_auprc_score: 0.9703; val_best_acc_score: 0.9337; val_best_f1_score: 0.9357; train_kl_reg_loss: 5205.3024; train_edge_recon_loss: 260081.2411; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265286.5439; train_optim_loss: 265286.5439; val_kl_reg_loss: 5103.2025; val_edge_recon_loss: 263621.8230; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268725.0267; val_optim_loss: 268725.0267
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9777; val_auprc_score: 0.9701; val_best_acc_score: 0.9349; val_best_f1_score: 0.9371; train_kl_reg_loss: 5205.7948; train_edge_recon_loss: 260087.5158; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265293.3114; train_optim_loss: 265293.3114; val_kl_reg_loss: 5104.4700; val_edge_recon_loss: 263148.4912; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268252.9597; val_optim_loss: 268252.9597
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9782; val_auprc_score: 0.9712; val_best_acc_score: 0.9347; val_best_f1_score: 0.9364; train_kl_reg_loss: 5208.1677; train_edge_recon_loss: 259990.8450; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265199.0122; train_optim_loss: 265199.0122; val_kl_reg_loss: 5106.3813; val_edge_recon_loss: 263395.6758; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268502.0584; val_optim_loss: 268502.0584
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9775; val_auprc_score: 0.9695; val_best_acc_score: 0.9348; val_best_f1_score: 0.9370; train_kl_reg_loss: 5206.5310; train_edge_recon_loss: 259916.7551; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265123.2857; train_optim_loss: 265123.2857; val_kl_reg_loss: 5103.5472; val_edge_recon_loss: 263354.9589; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268458.5066; val_optim_loss: 268458.5066
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9782; val_auprc_score: 0.9712; val_best_acc_score: 0.9356; val_best_f1_score: 0.9374; train_kl_reg_loss: 5207.8478; train_edge_recon_loss: 260005.5963; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265213.4439; train_optim_loss: 265213.4439; val_kl_reg_loss: 5106.5923; val_edge_recon_loss: 263129.1334; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268235.7270; val_optim_loss: 268235.7270
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9780; val_auprc_score: 0.9710; val_best_acc_score: 0.9346; val_best_f1_score: 0.9367; train_kl_reg_loss: 5206.8770; train_edge_recon_loss: 260072.3754; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265279.2522; train_optim_loss: 265279.2522; val_kl_reg_loss: 5103.3390; val_edge_recon_loss: 263353.4844; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268456.8255; val_optim_loss: 268456.8255
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9768; val_auprc_score: 0.9689; val_best_acc_score: 0.9336; val_best_f1_score: 0.9357; train_kl_reg_loss: 5211.0408; train_edge_recon_loss: 259953.8519; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265164.8928; train_optim_loss: 265164.8928; val_kl_reg_loss: 5103.3586; val_edge_recon_loss: 263376.9759; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268480.3343; val_optim_loss: 268480.3343
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9771; val_auprc_score: 0.9696; val_best_acc_score: 0.9339; val_best_f1_score: 0.9359; train_kl_reg_loss: 5208.3388; train_edge_recon_loss: 259916.4668; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265124.8049; train_optim_loss: 265124.8049; val_kl_reg_loss: 5107.5602; val_edge_recon_loss: 263588.7714; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268696.3310; val_optim_loss: 268696.3310
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9768; val_auprc_score: 0.9694; val_best_acc_score: 0.9333; val_best_f1_score: 0.9356; train_kl_reg_loss: 5208.5244; train_edge_recon_loss: 260053.5916; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265262.1154; train_optim_loss: 265262.1154; val_kl_reg_loss: 5107.6474; val_edge_recon_loss: 263935.1279; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 269042.7767; val_optim_loss: 269042.7767

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9770; val_auprc_score: 0.9698; val_best_acc_score: 0.9339; val_best_f1_score: 0.9361; train_kl_reg_loss: 5209.7934; train_edge_recon_loss: 260091.6402; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265301.4344; train_optim_loss: 265301.4344; val_kl_reg_loss: 5109.0289; val_edge_recon_loss: 263596.8220; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268705.8532; val_optim_loss: 268705.8532
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9769; val_auprc_score: 0.9691; val_best_acc_score: 0.9346; val_best_f1_score: 0.9362; train_kl_reg_loss: 5210.1894; train_edge_recon_loss: 259897.6945; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265107.8844; train_optim_loss: 265107.8844; val_kl_reg_loss: 5108.1046; val_edge_recon_loss: 263444.4404; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268552.5440; val_optim_loss: 268552.5440
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9768; val_auprc_score: 0.9687; val_best_acc_score: 0.9341; val_best_f1_score: 0.9360; train_kl_reg_loss: 5209.7337; train_edge_recon_loss: 260013.2775; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265223.0114; train_optim_loss: 265223.0114; val_kl_reg_loss: 5106.5282; val_edge_recon_loss: 263727.0664; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268833.5962; val_optim_loss: 268833.5962
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9776; val_auprc_score: 0.9702; val_best_acc_score: 0.9341; val_best_f1_score: 0.9363; train_kl_reg_loss: 5209.2635; train_edge_recon_loss: 259953.5861; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265162.8496; train_optim_loss: 265162.8496; val_kl_reg_loss: 5107.2619; val_edge_recon_loss: 263588.1256; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268695.3869; val_optim_loss: 268695.3869

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 53 min 11 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
val AUROC score: 0.9770
val AUPRC score: 0.9696
val best accuracy score: 0.9344
val best F1 score: 0.9364
val target rna MSE score: 5.3863
val source rna MSE score: 3.7169

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
