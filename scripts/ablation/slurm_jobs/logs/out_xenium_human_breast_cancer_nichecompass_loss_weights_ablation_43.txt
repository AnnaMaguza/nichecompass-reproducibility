None
Run timestamp: 29062023_013834_43.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_43']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
heaps
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9840; val_auprc_score: 0.9810; val_best_acc_score: 0.9411; val_best_f1_score: 0.9423; train_kl_reg_loss: 6852.7084; train_edge_recon_loss: 266212.1908; train_gene_expr_recon_loss: 131469.3239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 404534.2233; train_optim_loss: 404534.2233; val_kl_reg_loss: 6883.5902; val_edge_recon_loss: 262429.7572; val_gene_expr_recon_loss: 126055.9444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395369.2928; val_optim_loss: 395369.2928
heaps
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9893; val_auprc_score: 0.9875; val_best_acc_score: 0.9530; val_best_f1_score: 0.9537; train_kl_reg_loss: 7174.8178; train_edge_recon_loss: 261650.7801; train_gene_expr_recon_loss: 124290.3476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393115.9451; train_optim_loss: 393115.9451; val_kl_reg_loss: 7183.8825; val_edge_recon_loss: 260934.9075; val_gene_expr_recon_loss: 123078.2962; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391197.0870; val_optim_loss: 391197.0870
heaps
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9898; val_auprc_score: 0.9879; val_best_acc_score: 0.9559; val_best_f1_score: 0.9567; train_kl_reg_loss: 7223.0511; train_edge_recon_loss: 260783.1116; train_gene_expr_recon_loss: 122409.3757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390415.5385; train_optim_loss: 390415.5385; val_kl_reg_loss: 7190.1966; val_edge_recon_loss: 260521.8846; val_gene_expr_recon_loss: 122072.6097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389784.6927; val_optim_loss: 389784.6927
heaps
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9903; val_auprc_score: 0.9884; val_best_acc_score: 0.9580; val_best_f1_score: 0.9587; train_kl_reg_loss: 7222.8607; train_edge_recon_loss: 260450.3812; train_gene_expr_recon_loss: 121666.3221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389339.5639; train_optim_loss: 389339.5639; val_kl_reg_loss: 7394.6926; val_edge_recon_loss: 260263.4465; val_gene_expr_recon_loss: 121551.2425; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389209.3806; val_optim_loss: 389209.3806
heaps
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9915; val_auprc_score: 0.9899; val_best_acc_score: 0.9611; val_best_f1_score: 0.9618; train_kl_reg_loss: 7209.4066; train_edge_recon_loss: 260129.5473; train_gene_expr_recon_loss: 121252.2360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388591.1901; train_optim_loss: 388591.1901; val_kl_reg_loss: 7194.6703; val_edge_recon_loss: 259986.5058; val_gene_expr_recon_loss: 121148.1479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388329.3238; val_optim_loss: 388329.3238
heaps
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9918; val_auprc_score: 0.9900; val_best_acc_score: 0.9627; val_best_f1_score: 0.9633; train_kl_reg_loss: 7194.7877; train_edge_recon_loss: 260002.8154; train_gene_expr_recon_loss: 120989.9995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388187.6026; train_optim_loss: 388187.6026; val_kl_reg_loss: 7188.3244; val_edge_recon_loss: 259892.6719; val_gene_expr_recon_loss: 121083.5200; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388164.5156; val_optim_loss: 388164.5156
heaps
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9920; val_auprc_score: 0.9906; val_best_acc_score: 0.9627; val_best_f1_score: 0.9634; train_kl_reg_loss: 7180.1296; train_edge_recon_loss: 259764.1727; train_gene_expr_recon_loss: 120838.3501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387782.6521; train_optim_loss: 387782.6521; val_kl_reg_loss: 7172.9785; val_edge_recon_loss: 259770.4250; val_gene_expr_recon_loss: 121144.7159; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388088.1195; val_optim_loss: 388088.1195
heaps
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9916; val_auprc_score: 0.9897; val_best_acc_score: 0.9633; val_best_f1_score: 0.9639; train_kl_reg_loss: 7171.1007; train_edge_recon_loss: 259739.1918; train_gene_expr_recon_loss: 120753.5411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387663.8337; train_optim_loss: 387663.8337; val_kl_reg_loss: 7052.3508; val_edge_recon_loss: 259985.2745; val_gene_expr_recon_loss: 120990.6770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388028.3018; val_optim_loss: 388028.3018
heaps
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9922; val_auprc_score: 0.9906; val_best_acc_score: 0.9646; val_best_f1_score: 0.9651; train_kl_reg_loss: 7159.6315; train_edge_recon_loss: 259593.2374; train_gene_expr_recon_loss: 120666.3110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387419.1800; train_optim_loss: 387419.1800; val_kl_reg_loss: 6928.9939; val_edge_recon_loss: 259655.3662; val_gene_expr_recon_loss: 120849.3831; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387433.7426; val_optim_loss: 387433.7426
heaps
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9926; val_auprc_score: 0.9912; val_best_acc_score: 0.9650; val_best_f1_score: 0.9655; train_kl_reg_loss: 7150.5525; train_edge_recon_loss: 259546.6102; train_gene_expr_recon_loss: 120600.5571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387297.7196; train_optim_loss: 387297.7196; val_kl_reg_loss: 7169.8668; val_edge_recon_loss: 259592.9209; val_gene_expr_recon_loss: 121015.7944; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387778.5820; val_optim_loss: 387778.5820
heaps
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9927; val_auprc_score: 0.9911; val_best_acc_score: 0.9654; val_best_f1_score: 0.9661; train_kl_reg_loss: 7140.5142; train_edge_recon_loss: 259403.0156; train_gene_expr_recon_loss: 120526.9933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387070.5233; train_optim_loss: 387070.5233; val_kl_reg_loss: 7027.5305; val_edge_recon_loss: 259401.4177; val_gene_expr_recon_loss: 120722.4640; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387151.4126; val_optim_loss: 387151.4126
heaps
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9923; val_auprc_score: 0.9903; val_best_acc_score: 0.9661; val_best_f1_score: 0.9666; train_kl_reg_loss: 7134.7739; train_edge_recon_loss: 259450.3859; train_gene_expr_recon_loss: 120496.6137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387081.7736; train_optim_loss: 387081.7736; val_kl_reg_loss: 7015.1217; val_edge_recon_loss: 259342.2452; val_gene_expr_recon_loss: 120630.8226; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386988.1892; val_optim_loss: 386988.1892
heaps
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9926; val_auprc_score: 0.9909; val_best_acc_score: 0.9670; val_best_f1_score: 0.9674; train_kl_reg_loss: 7133.5454; train_edge_recon_loss: 259287.3745; train_gene_expr_recon_loss: 120448.2600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386869.1798; train_optim_loss: 386869.1798; val_kl_reg_loss: 6974.3730; val_edge_recon_loss: 259431.4243; val_gene_expr_recon_loss: 120635.1037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387040.8997; val_optim_loss: 387040.8997
heaps
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9925; val_auprc_score: 0.9907; val_best_acc_score: 0.9662; val_best_f1_score: 0.9668; train_kl_reg_loss: 7127.9259; train_edge_recon_loss: 259292.2886; train_gene_expr_recon_loss: 120385.1633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386805.3786; train_optim_loss: 386805.3786; val_kl_reg_loss: 7117.5251; val_edge_recon_loss: 259429.4884; val_gene_expr_recon_loss: 120567.1093; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387114.1231; val_optim_loss: 387114.1231
heaps
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9935; val_auprc_score: 0.9920; val_best_acc_score: 0.9690; val_best_f1_score: 0.9694; train_kl_reg_loss: 7122.2426; train_edge_recon_loss: 259228.1873; train_gene_expr_recon_loss: 120376.5623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386726.9922; train_optim_loss: 386726.9922; val_kl_reg_loss: 6996.7017; val_edge_recon_loss: 258787.7151; val_gene_expr_recon_loss: 120595.5299; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386379.9472; val_optim_loss: 386379.9472
heaps
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9931; val_auprc_score: 0.9915; val_best_acc_score: 0.9676; val_best_f1_score: 0.9681; train_kl_reg_loss: 7118.7407; train_edge_recon_loss: 259196.0464; train_gene_expr_recon_loss: 120329.7782; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386644.5653; train_optim_loss: 386644.5653; val_kl_reg_loss: 7058.4807; val_edge_recon_loss: 259330.8961; val_gene_expr_recon_loss: 120573.2744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386962.6519; val_optim_loss: 386962.6519
heaps
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9929; val_auprc_score: 0.9911; val_best_acc_score: 0.9681; val_best_f1_score: 0.9686; train_kl_reg_loss: 7113.5004; train_edge_recon_loss: 259082.5076; train_gene_expr_recon_loss: 120292.5111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386488.5192; train_optim_loss: 386488.5192; val_kl_reg_loss: 7087.5969; val_edge_recon_loss: 259162.3282; val_gene_expr_recon_loss: 120470.7672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386720.6920; val_optim_loss: 386720.6920
heaps
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9931; val_auprc_score: 0.9916; val_best_acc_score: 0.9682; val_best_f1_score: 0.9687; train_kl_reg_loss: 7111.6206; train_edge_recon_loss: 259098.5652; train_gene_expr_recon_loss: 120270.7578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386480.9437; train_optim_loss: 386480.9437; val_kl_reg_loss: 7112.2536; val_edge_recon_loss: 259130.5692; val_gene_expr_recon_loss: 120384.0948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386626.9171; val_optim_loss: 386626.9171
heaps
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9930; val_auprc_score: 0.9915; val_best_acc_score: 0.9680; val_best_f1_score: 0.9685; train_kl_reg_loss: 7105.9468; train_edge_recon_loss: 259058.0540; train_gene_expr_recon_loss: 120255.0989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386419.1002; train_optim_loss: 386419.1002; val_kl_reg_loss: 7043.6401; val_edge_recon_loss: 258784.3920; val_gene_expr_recon_loss: 120445.4746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386273.5062; val_optim_loss: 386273.5062
heaps
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9934; val_auprc_score: 0.9917; val_best_acc_score: 0.9692; val_best_f1_score: 0.9696; train_kl_reg_loss: 7105.3620; train_edge_recon_loss: 258975.0963; train_gene_expr_recon_loss: 120214.5328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386294.9911; train_optim_loss: 386294.9911; val_kl_reg_loss: 7014.2893; val_edge_recon_loss: 258725.1222; val_gene_expr_recon_loss: 120358.1102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386097.5226; val_optim_loss: 386097.5226
heaps
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9932; val_auprc_score: 0.9915; val_best_acc_score: 0.9687; val_best_f1_score: 0.9692; train_kl_reg_loss: 7100.5866; train_edge_recon_loss: 258999.5769; train_gene_expr_recon_loss: 120194.2544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386294.4175; train_optim_loss: 386294.4175; val_kl_reg_loss: 7037.3067; val_edge_recon_loss: 258851.5350; val_gene_expr_recon_loss: 120457.3673; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386346.2089; val_optim_loss: 386346.2089
heaps
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9936; val_auprc_score: 0.9922; val_best_acc_score: 0.9687; val_best_f1_score: 0.9692; train_kl_reg_loss: 7099.6309; train_edge_recon_loss: 258993.7948; train_gene_expr_recon_loss: 120194.2456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386287.6713; train_optim_loss: 386287.6713; val_kl_reg_loss: 7037.2471; val_edge_recon_loss: 258901.6725; val_gene_expr_recon_loss: 120507.8183; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386446.7383; val_optim_loss: 386446.7383
heaps
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9936; val_auprc_score: 0.9921; val_best_acc_score: 0.9691; val_best_f1_score: 0.9695; train_kl_reg_loss: 7094.5678; train_edge_recon_loss: 259013.3949; train_gene_expr_recon_loss: 120181.2440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386289.2065; train_optim_loss: 386289.2065; val_kl_reg_loss: 7087.0654; val_edge_recon_loss: 258673.3809; val_gene_expr_recon_loss: 120264.9552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386025.4015; val_optim_loss: 386025.4015
heaps
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9935; val_auprc_score: 0.9918; val_best_acc_score: 0.9696; val_best_f1_score: 0.9701; train_kl_reg_loss: 7092.3606; train_edge_recon_loss: 258902.6943; train_gene_expr_recon_loss: 120131.4642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386126.5193; train_optim_loss: 386126.5193; val_kl_reg_loss: 6906.9288; val_edge_recon_loss: 258703.5477; val_gene_expr_recon_loss: 120342.6835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385953.1602; val_optim_loss: 385953.1602
heaps
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9936; val_auprc_score: 0.9921; val_best_acc_score: 0.9707; val_best_f1_score: 0.9711; train_kl_reg_loss: 7091.4098; train_edge_recon_loss: 258903.6183; train_gene_expr_recon_loss: 120076.7009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386071.7287; train_optim_loss: 386071.7287; val_kl_reg_loss: 6964.8471; val_edge_recon_loss: 258675.2433; val_gene_expr_recon_loss: 120392.7455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386032.8358; val_optim_loss: 386032.8358
heaps
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9933; val_auprc_score: 0.9916; val_best_acc_score: 0.9702; val_best_f1_score: 0.9707; train_kl_reg_loss: 7089.7923; train_edge_recon_loss: 258864.3118; train_gene_expr_recon_loss: 120117.6435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386071.7477; train_optim_loss: 386071.7477; val_kl_reg_loss: 7019.6365; val_edge_recon_loss: 258622.4294; val_gene_expr_recon_loss: 120612.6851; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386254.7513; val_optim_loss: 386254.7513
heaps
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9935; val_auprc_score: 0.9918; val_best_acc_score: 0.9702; val_best_f1_score: 0.9706; train_kl_reg_loss: 7090.6721; train_edge_recon_loss: 258778.6296; train_gene_expr_recon_loss: 120052.9448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385922.2465; train_optim_loss: 385922.2465; val_kl_reg_loss: 7052.7116; val_edge_recon_loss: 258775.1480; val_gene_expr_recon_loss: 120466.8041; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386294.6632; val_optim_loss: 386294.6632
heaps
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9938; val_auprc_score: 0.9921; val_best_acc_score: 0.9706; val_best_f1_score: 0.9710; train_kl_reg_loss: 7087.7234; train_edge_recon_loss: 258854.5476; train_gene_expr_recon_loss: 120050.3054; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385992.5760; train_optim_loss: 385992.5760; val_kl_reg_loss: 6945.1533; val_edge_recon_loss: 258777.5998; val_gene_expr_recon_loss: 120117.2806; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385840.0337; val_optim_loss: 385840.0337
heaps
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9937; val_auprc_score: 0.9923; val_best_acc_score: 0.9705; val_best_f1_score: 0.9709; train_kl_reg_loss: 7087.4069; train_edge_recon_loss: 258860.6098; train_gene_expr_recon_loss: 120044.4563; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385992.4736; train_optim_loss: 385992.4736; val_kl_reg_loss: 7055.7511; val_edge_recon_loss: 258515.4604; val_gene_expr_recon_loss: 120709.9619; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386281.1742; val_optim_loss: 386281.1742
heaps
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9938; val_auprc_score: 0.9922; val_best_acc_score: 0.9706; val_best_f1_score: 0.9710; train_kl_reg_loss: 7084.8935; train_edge_recon_loss: 258693.2152; train_gene_expr_recon_loss: 119930.9973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385709.1059; train_optim_loss: 385709.1059; val_kl_reg_loss: 6906.6098; val_edge_recon_loss: 258537.2487; val_gene_expr_recon_loss: 120911.8899; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386355.7488; val_optim_loss: 386355.7488
heaps
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9938; val_auprc_score: 0.9924; val_best_acc_score: 0.9710; val_best_f1_score: 0.9714; train_kl_reg_loss: 7082.3377; train_edge_recon_loss: 258791.0374; train_gene_expr_recon_loss: 119865.9621; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385739.3368; train_optim_loss: 385739.3368; val_kl_reg_loss: 7047.2777; val_edge_recon_loss: 258681.5511; val_gene_expr_recon_loss: 119664.0559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385392.8841; val_optim_loss: 385392.8841
heaps
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9936; val_auprc_score: 0.9920; val_best_acc_score: 0.9712; val_best_f1_score: 0.9716; train_kl_reg_loss: 7081.9203; train_edge_recon_loss: 258762.9758; train_gene_expr_recon_loss: 119638.4863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385483.3826; train_optim_loss: 385483.3826; val_kl_reg_loss: 7009.9059; val_edge_recon_loss: 258401.3145; val_gene_expr_recon_loss: 120005.9447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385417.1644; val_optim_loss: 385417.1644
heaps
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9939; val_auprc_score: 0.9923; val_best_acc_score: 0.9715; val_best_f1_score: 0.9719; train_kl_reg_loss: 7084.9764; train_edge_recon_loss: 258621.4844; train_gene_expr_recon_loss: 119401.4157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385107.8768; train_optim_loss: 385107.8768; val_kl_reg_loss: 6907.3350; val_edge_recon_loss: 258465.0178; val_gene_expr_recon_loss: 119103.2409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384475.5949; val_optim_loss: 384475.5949
heaps
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9940; val_auprc_score: 0.9923; val_best_acc_score: 0.9724; val_best_f1_score: 0.9728; train_kl_reg_loss: 7083.3085; train_edge_recon_loss: 258586.3389; train_gene_expr_recon_loss: 119069.6002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384739.2480; train_optim_loss: 384739.2480; val_kl_reg_loss: 7073.1311; val_edge_recon_loss: 258619.7526; val_gene_expr_recon_loss: 117670.3260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383363.2086; val_optim_loss: 383363.2086
heaps
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9941; val_auprc_score: 0.9927; val_best_acc_score: 0.9723; val_best_f1_score: 0.9727; train_kl_reg_loss: 7083.0108; train_edge_recon_loss: 258623.9212; train_gene_expr_recon_loss: 118683.9525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384390.8847; train_optim_loss: 384390.8847; val_kl_reg_loss: 7002.9579; val_edge_recon_loss: 258210.8817; val_gene_expr_recon_loss: 118153.9644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383367.8034; val_optim_loss: 383367.8034
heaps
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9939; val_auprc_score: 0.9922; val_best_acc_score: 0.9710; val_best_f1_score: 0.9715; train_kl_reg_loss: 7083.7962; train_edge_recon_loss: 258605.5852; train_gene_expr_recon_loss: 118522.0346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384211.4162; train_optim_loss: 384211.4162; val_kl_reg_loss: 7041.4571; val_edge_recon_loss: 258638.7337; val_gene_expr_recon_loss: 121162.9691; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386843.1609; val_optim_loss: 386843.1609
heaps
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9941; val_auprc_score: 0.9927; val_best_acc_score: 0.9722; val_best_f1_score: 0.9726; train_kl_reg_loss: 7079.3055; train_edge_recon_loss: 258586.3472; train_gene_expr_recon_loss: 118745.0374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384410.6896; train_optim_loss: 384410.6896; val_kl_reg_loss: 7043.1316; val_edge_recon_loss: 258385.0815; val_gene_expr_recon_loss: 116468.7704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381896.9828; val_optim_loss: 381896.9828
heaps
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9943; val_auprc_score: 0.9925; val_best_acc_score: 0.9726; val_best_f1_score: 0.9729; train_kl_reg_loss: 7077.1223; train_edge_recon_loss: 258553.0402; train_gene_expr_recon_loss: 119076.0081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384706.1709; train_optim_loss: 384706.1709; val_kl_reg_loss: 6989.6327; val_edge_recon_loss: 258473.6406; val_gene_expr_recon_loss: 113471.3814; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 378934.6552; val_optim_loss: 378934.6552
heaps
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9945; val_auprc_score: 0.9931; val_best_acc_score: 0.9732; val_best_f1_score: 0.9736; train_kl_reg_loss: 7076.6251; train_edge_recon_loss: 258530.4569; train_gene_expr_recon_loss: 119619.1820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385226.2639; train_optim_loss: 385226.2639; val_kl_reg_loss: 7018.8606; val_edge_recon_loss: 258159.1910; val_gene_expr_recon_loss: 118705.8581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383883.9109; val_optim_loss: 383883.9109
heaps
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9939; val_auprc_score: 0.9925; val_best_acc_score: 0.9715; val_best_f1_score: 0.9720; train_kl_reg_loss: 7077.5816; train_edge_recon_loss: 258471.3948; train_gene_expr_recon_loss: 120606.8289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386155.8059; train_optim_loss: 386155.8059; val_kl_reg_loss: 7031.0504; val_edge_recon_loss: 258347.2523; val_gene_expr_recon_loss: 133727.5492; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399105.8527; val_optim_loss: 399105.8527
heaps
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9936; val_auprc_score: 0.9919; val_best_acc_score: 0.9716; val_best_f1_score: 0.9721; train_kl_reg_loss: 7078.6300; train_edge_recon_loss: 258491.1628; train_gene_expr_recon_loss: 121977.1193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387546.9119; train_optim_loss: 387546.9119; val_kl_reg_loss: 6994.9434; val_edge_recon_loss: 258172.4212; val_gene_expr_recon_loss: 119458.4845; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384625.8504; val_optim_loss: 384625.8504
heaps
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9940; val_auprc_score: 0.9925; val_best_acc_score: 0.9722; val_best_f1_score: 0.9726; train_kl_reg_loss: 7078.4949; train_edge_recon_loss: 258476.7862; train_gene_expr_recon_loss: 122933.3290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388488.6104; train_optim_loss: 388488.6104; val_kl_reg_loss: 7022.4076; val_edge_recon_loss: 258178.5728; val_gene_expr_recon_loss: 116677.8968; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381878.8776; val_optim_loss: 381878.8776

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

heaps
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9945; val_auprc_score: 0.9931; val_best_acc_score: 0.9739; val_best_f1_score: 0.9741; train_kl_reg_loss: 7028.6318; train_edge_recon_loss: 258332.8326; train_gene_expr_recon_loss: 128553.9737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393915.4376; train_optim_loss: 393915.4376; val_kl_reg_loss: 6898.7347; val_edge_recon_loss: 257995.2742; val_gene_expr_recon_loss: 128004.3341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392898.3448; val_optim_loss: 392898.3448
heaps
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9946; val_auprc_score: 0.9931; val_best_acc_score: 0.9738; val_best_f1_score: 0.9741; train_kl_reg_loss: 6945.6530; train_edge_recon_loss: 258269.5108; train_gene_expr_recon_loss: 131295.6410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 396510.8051; train_optim_loss: 396510.8051; val_kl_reg_loss: 6859.1684; val_edge_recon_loss: 258100.2886; val_gene_expr_recon_loss: 127174.2613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392133.7192; val_optim_loss: 392133.7192
heaps
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9945; val_auprc_score: 0.9930; val_best_acc_score: 0.9737; val_best_f1_score: 0.9740; train_kl_reg_loss: 6904.7089; train_edge_recon_loss: 258295.0136; train_gene_expr_recon_loss: 128941.4670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394141.1891; train_optim_loss: 394141.1891; val_kl_reg_loss: 6856.7419; val_edge_recon_loss: 258041.2118; val_gene_expr_recon_loss: 118973.7155; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383871.6687; val_optim_loss: 383871.6687
heaps
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9946; val_auprc_score: 0.9932; val_best_acc_score: 0.9736; val_best_f1_score: 0.9739; train_kl_reg_loss: 6877.8230; train_edge_recon_loss: 258296.1301; train_gene_expr_recon_loss: 132815.7646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397989.7176; train_optim_loss: 397989.7176; val_kl_reg_loss: 6863.6676; val_edge_recon_loss: 258072.5017; val_gene_expr_recon_loss: 125617.8662; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390554.0352; val_optim_loss: 390554.0352

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 566 min 46 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9941
Val AUPRC score: 0.9925
Val best accuracy score: 0.9721
Val best F1 score: 0.9725
Val gene expr MSE score: 2.6376

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
