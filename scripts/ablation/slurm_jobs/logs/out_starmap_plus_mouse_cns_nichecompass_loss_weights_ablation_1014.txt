None
Run timestamp: 16072023_181831_1014.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_1014']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1818, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1818, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9881; val_auprc_score: 0.9832; val_best_acc_score: 0.9626; val_best_f1_score: 0.9635; train_kl_reg_loss: 15634.6740; train_edge_recon_loss: 26566494.1912; train_gene_expr_recon_loss: 20733591.7169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 47315720.6029; train_optim_loss: 47315720.6029; val_kl_reg_loss: 16633.4355; val_edge_recon_loss: 25874193.4098; val_gene_expr_recon_loss: 19932889.5738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45823716.3934; val_optim_loss: 45823716.3934
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9902; val_auprc_score: 0.9868; val_best_acc_score: 0.9667; val_best_f1_score: 0.9673; train_kl_reg_loss: 16411.6655; train_edge_recon_loss: 25772749.2059; train_gene_expr_recon_loss: 19591070.7941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45380231.6250; train_optim_loss: 45380231.6250; val_kl_reg_loss: 16556.5797; val_edge_recon_loss: 25841384.7541; val_gene_expr_recon_loss: 19333443.7705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45191385.1803; val_optim_loss: 45191385.1803
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9917; val_auprc_score: 0.9891; val_best_acc_score: 0.9698; val_best_f1_score: 0.9703; train_kl_reg_loss: 16808.5833; train_edge_recon_loss: 25694461.5956; train_gene_expr_recon_loss: 19094701.0699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44805971.3015; train_optim_loss: 44805971.3015; val_kl_reg_loss: 17595.4548; val_edge_recon_loss: 25770245.2459; val_gene_expr_recon_loss: 18952216.7213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 44740057.5738; val_optim_loss: 44740057.5738
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9930; val_auprc_score: 0.9908; val_best_acc_score: 0.9731; val_best_f1_score: 0.9735; train_kl_reg_loss: 17315.4527; train_edge_recon_loss: 25657359.5735; train_gene_expr_recon_loss: 18764284.4890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44438959.5956; train_optim_loss: 44438959.5956; val_kl_reg_loss: 17864.2402; val_edge_recon_loss: 25713602.7541; val_gene_expr_recon_loss: 18680497.1803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 44411964.0656; val_optim_loss: 44411964.0656
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9931; val_auprc_score: 0.9910; val_best_acc_score: 0.9733; val_best_f1_score: 0.9738; train_kl_reg_loss: 17964.8958; train_edge_recon_loss: 25624106.7279; train_gene_expr_recon_loss: 18497876.7022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44139948.1912; train_optim_loss: 44139948.1912; val_kl_reg_loss: 18504.8606; val_edge_recon_loss: 25693639.6721; val_gene_expr_recon_loss: 18552766.3279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 44264910.9508; val_optim_loss: 44264910.9508
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9937; val_auprc_score: 0.9916; val_best_acc_score: 0.9745; val_best_f1_score: 0.9749; train_kl_reg_loss: 18111.9390; train_edge_recon_loss: 25611686.1360; train_gene_expr_recon_loss: 18296512.3529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43926310.4191; train_optim_loss: 43926310.4191; val_kl_reg_loss: 18858.4248; val_edge_recon_loss: 25680009.0492; val_gene_expr_recon_loss: 18247766.2951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43946633.8361; val_optim_loss: 43946633.8361
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9945; val_auprc_score: 0.9931; val_best_acc_score: 0.9757; val_best_f1_score: 0.9760; train_kl_reg_loss: 18581.3933; train_edge_recon_loss: 25603684.9338; train_gene_expr_recon_loss: 18123759.8989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43746026.2279; train_optim_loss: 43746026.2279; val_kl_reg_loss: 19373.6418; val_edge_recon_loss: 25685973.5738; val_gene_expr_recon_loss: 18156969.0492; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43862316.0000; val_optim_loss: 43862316.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9947; val_auprc_score: 0.9931; val_best_acc_score: 0.9762; val_best_f1_score: 0.9766; train_kl_reg_loss: 18602.3272; train_edge_recon_loss: 25591031.7316; train_gene_expr_recon_loss: 17975788.2335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43585422.4338; train_optim_loss: 43585422.4338; val_kl_reg_loss: 18745.7102; val_edge_recon_loss: 25711322.0328; val_gene_expr_recon_loss: 18047944.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43778011.5410; val_optim_loss: 43778011.5410
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9954; val_auprc_score: 0.9940; val_best_acc_score: 0.9780; val_best_f1_score: 0.9782; train_kl_reg_loss: 18495.6438; train_edge_recon_loss: 25594352.0551; train_gene_expr_recon_loss: 17841842.8456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43454690.4044; train_optim_loss: 43454690.4044; val_kl_reg_loss: 18354.8508; val_edge_recon_loss: 25637896.2295; val_gene_expr_recon_loss: 17988804.7869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43645055.5410; val_optim_loss: 43645055.5410
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9957; val_auprc_score: 0.9946; val_best_acc_score: 0.9790; val_best_f1_score: 0.9792; train_kl_reg_loss: 18504.7904; train_edge_recon_loss: 25590469.6912; train_gene_expr_recon_loss: 17734775.7923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43343750.2868; train_optim_loss: 43343750.2868; val_kl_reg_loss: 18335.7190; val_edge_recon_loss: 25653302.5246; val_gene_expr_recon_loss: 17911224.2951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43582862.4262; val_optim_loss: 43582862.4262
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9954; val_auprc_score: 0.9941; val_best_acc_score: 0.9787; val_best_f1_score: 0.9789; train_kl_reg_loss: 18504.8014; train_edge_recon_loss: 25571279.7243; train_gene_expr_recon_loss: 17664610.7886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43254395.3235; train_optim_loss: 43254395.3235; val_kl_reg_loss: 17989.0073; val_edge_recon_loss: 25637369.0820; val_gene_expr_recon_loss: 17922492.1311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43577850.2951; val_optim_loss: 43577850.2951
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9955; val_auprc_score: 0.9944; val_best_acc_score: 0.9793; val_best_f1_score: 0.9796; train_kl_reg_loss: 18638.4613; train_edge_recon_loss: 25573903.2096; train_gene_expr_recon_loss: 17577348.0092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43169889.6985; train_optim_loss: 43169889.6985; val_kl_reg_loss: 18702.5219; val_edge_recon_loss: 25643191.3770; val_gene_expr_recon_loss: 17839567.1967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43501460.9180; val_optim_loss: 43501460.9180
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9959; val_auprc_score: 0.9949; val_best_acc_score: 0.9792; val_best_f1_score: 0.9795; train_kl_reg_loss: 18674.1392; train_edge_recon_loss: 25569541.1213; train_gene_expr_recon_loss: 17527347.7555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43115562.9706; train_optim_loss: 43115562.9706; val_kl_reg_loss: 18785.3040; val_edge_recon_loss: 25642710.3934; val_gene_expr_recon_loss: 17777600.5902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43439095.8689; val_optim_loss: 43439095.8689
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9958; val_auprc_score: 0.9945; val_best_acc_score: 0.9794; val_best_f1_score: 0.9797; train_kl_reg_loss: 18740.7565; train_edge_recon_loss: 25558573.3934; train_gene_expr_recon_loss: 17467392.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43044706.2574; train_optim_loss: 43044706.2574; val_kl_reg_loss: 18854.2539; val_edge_recon_loss: 25624979.9672; val_gene_expr_recon_loss: 17761949.9836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43405784.3279; val_optim_loss: 43405784.3279
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9957; val_auprc_score: 0.9947; val_best_acc_score: 0.9795; val_best_f1_score: 0.9797; train_kl_reg_loss: 18758.6661; train_edge_recon_loss: 25560209.6728; train_gene_expr_recon_loss: 17429434.6636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43008402.9265; train_optim_loss: 43008402.9265; val_kl_reg_loss: 19299.9367; val_edge_recon_loss: 25629266.7541; val_gene_expr_recon_loss: 17769144.2295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43417710.6230; val_optim_loss: 43417710.6230
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9958; val_auprc_score: 0.9946; val_best_acc_score: 0.9792; val_best_f1_score: 0.9795; train_kl_reg_loss: 18839.3228; train_edge_recon_loss: 25552935.6140; train_gene_expr_recon_loss: 17385682.6930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42957457.6912; train_optim_loss: 42957457.6912; val_kl_reg_loss: 19351.5748; val_edge_recon_loss: 25620089.0820; val_gene_expr_recon_loss: 17827145.6066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43466586.4262; val_optim_loss: 43466586.4262
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9957; val_auprc_score: 0.9945; val_best_acc_score: 0.9799; val_best_f1_score: 0.9801; train_kl_reg_loss: 18874.1717; train_edge_recon_loss: 25544306.9081; train_gene_expr_recon_loss: 17355435.0533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42918616.1912; train_optim_loss: 42918616.1912; val_kl_reg_loss: 18934.7825; val_edge_recon_loss: 25610933.0820; val_gene_expr_recon_loss: 17777945.4098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43407813.5738; val_optim_loss: 43407813.5738
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9958; val_auprc_score: 0.9946; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 18914.9625; train_edge_recon_loss: 25542553.2721; train_gene_expr_recon_loss: 17328316.1507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42889784.3971; train_optim_loss: 42889784.3971; val_kl_reg_loss: 19351.3305; val_edge_recon_loss: 25607927.3443; val_gene_expr_recon_loss: 17776729.1967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43404007.7377; val_optim_loss: 43404007.7377
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9957; val_auprc_score: 0.9941; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 18909.3944; train_edge_recon_loss: 25540228.9669; train_gene_expr_recon_loss: 17303617.6048; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42862756.0956; train_optim_loss: 42862756.0956; val_kl_reg_loss: 19200.2966; val_edge_recon_loss: 25612715.3770; val_gene_expr_recon_loss: 17775470.7213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43407386.3607; val_optim_loss: 43407386.3607
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9961; val_auprc_score: 0.9947; val_best_acc_score: 0.9815; val_best_f1_score: 0.9817; train_kl_reg_loss: 18959.9939; train_edge_recon_loss: 25535260.4743; train_gene_expr_recon_loss: 17296044.8162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42850265.2647; train_optim_loss: 42850265.2647; val_kl_reg_loss: 18947.1239; val_edge_recon_loss: 25572143.2131; val_gene_expr_recon_loss: 17773886.9836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43364977.1803; val_optim_loss: 43364977.1803
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9959; val_auprc_score: 0.9949; val_best_acc_score: 0.9805; val_best_f1_score: 0.9808; train_kl_reg_loss: 18972.1209; train_edge_recon_loss: 25522401.1912; train_gene_expr_recon_loss: 17265222.9320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42806596.3456; train_optim_loss: 42806596.3456; val_kl_reg_loss: 19116.2995; val_edge_recon_loss: 25614020.9836; val_gene_expr_recon_loss: 17794791.8033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43427929.2459; val_optim_loss: 43427929.2459
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9963; val_auprc_score: 0.9949; val_best_acc_score: 0.9820; val_best_f1_score: 0.9822; train_kl_reg_loss: 18983.5815; train_edge_recon_loss: 25535200.5772; train_gene_expr_recon_loss: 17256525.5662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42810709.8235; train_optim_loss: 42810709.8235; val_kl_reg_loss: 19191.3386; val_edge_recon_loss: 25577566.6230; val_gene_expr_recon_loss: 17793858.0164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43390616.0000; val_optim_loss: 43390616.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9962; val_auprc_score: 0.9948; val_best_acc_score: 0.9816; val_best_f1_score: 0.9818; train_kl_reg_loss: 18977.0366; train_edge_recon_loss: 25527157.9375; train_gene_expr_recon_loss: 17248287.9798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42794422.8750; train_optim_loss: 42794422.8750; val_kl_reg_loss: 19072.8612; val_edge_recon_loss: 25625495.0164; val_gene_expr_recon_loss: 17805315.5902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43449883.3443; val_optim_loss: 43449883.3443
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9967; val_auprc_score: 0.9956; val_best_acc_score: 0.9827; val_best_f1_score: 0.9829; train_kl_reg_loss: 19039.6704; train_edge_recon_loss: 25522814.1213; train_gene_expr_recon_loss: 17211820.5349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42753674.2500; train_optim_loss: 42753674.2500; val_kl_reg_loss: 19102.0160; val_edge_recon_loss: 25568537.6393; val_gene_expr_recon_loss: 17778901.9180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43366541.6393; val_optim_loss: 43366541.6393

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9964; val_auprc_score: 0.9954; val_best_acc_score: 0.9815; val_best_f1_score: 0.9816; train_kl_reg_loss: 20585.0563; train_edge_recon_loss: 25494295.8493; train_gene_expr_recon_loss: 16987820.5092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42502701.4044; train_optim_loss: 42502701.4044; val_kl_reg_loss: 20413.7334; val_edge_recon_loss: 25567068.3607; val_gene_expr_recon_loss: 17676927.4754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43264409.6393; val_optim_loss: 43264409.6393
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9962; val_auprc_score: 0.9951; val_best_acc_score: 0.9815; val_best_f1_score: 0.9817; train_kl_reg_loss: 20258.5849; train_edge_recon_loss: 25488889.2316; train_gene_expr_recon_loss: 16948202.2206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42457350.1103; train_optim_loss: 42457350.1103; val_kl_reg_loss: 19704.0564; val_edge_recon_loss: 25541942.9836; val_gene_expr_recon_loss: 17705851.4590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43267498.4918; val_optim_loss: 43267498.4918
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9961; val_auprc_score: 0.9949; val_best_acc_score: 0.9816; val_best_f1_score: 0.9817; train_kl_reg_loss: 19665.5023; train_edge_recon_loss: 25478348.6103; train_gene_expr_recon_loss: 16925910.3162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42423924.4559; train_optim_loss: 42423924.4559; val_kl_reg_loss: 19250.5801; val_edge_recon_loss: 25528807.4098; val_gene_expr_recon_loss: 17630786.9672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43178844.8525; val_optim_loss: 43178844.8525
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9960; val_auprc_score: 0.9947; val_best_acc_score: 0.9819; val_best_f1_score: 0.9821; train_kl_reg_loss: 19390.0585; train_edge_recon_loss: 25481479.4081; train_gene_expr_recon_loss: 16916381.1268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42417250.6838; train_optim_loss: 42417250.6838; val_kl_reg_loss: 19172.2165; val_edge_recon_loss: 25504099.2131; val_gene_expr_recon_loss: 17686450.7377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43209722.3607; val_optim_loss: 43209722.3607
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9959; val_auprc_score: 0.9948; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 19261.6520; train_edge_recon_loss: 25480586.2868; train_gene_expr_recon_loss: 16909762.6618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42409610.5441; train_optim_loss: 42409610.5441; val_kl_reg_loss: 19038.8635; val_edge_recon_loss: 25519102.6230; val_gene_expr_recon_loss: 17712632.9344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43250774.7541; val_optim_loss: 43250774.7541
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9960; val_auprc_score: 0.9949; val_best_acc_score: 0.9811; val_best_f1_score: 0.9814; train_kl_reg_loss: 19214.5207; train_edge_recon_loss: 25483824.9669; train_gene_expr_recon_loss: 16899910.1085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42402949.5662; train_optim_loss: 42402949.5662; val_kl_reg_loss: 19028.5209; val_edge_recon_loss: 25536794.6230; val_gene_expr_recon_loss: 17740001.1639; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43295824.1967; val_optim_loss: 43295824.1967
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9960; val_auprc_score: 0.9946; val_best_acc_score: 0.9815; val_best_f1_score: 0.9817; train_kl_reg_loss: 19193.8414; train_edge_recon_loss: 25475714.8860; train_gene_expr_recon_loss: 16897221.1489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42392129.8603; train_optim_loss: 42392129.8603; val_kl_reg_loss: 18972.0715; val_edge_recon_loss: 25511844.0656; val_gene_expr_recon_loss: 17728036.7213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43258852.7869; val_optim_loss: 43258852.7869

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9959; val_auprc_score: 0.9944; val_best_acc_score: 0.9811; val_best_f1_score: 0.9814; train_kl_reg_loss: 19277.3203; train_edge_recon_loss: 25476860.9816; train_gene_expr_recon_loss: 16845147.1820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42341285.6176; train_optim_loss: 42341285.6176; val_kl_reg_loss: 19141.2006; val_edge_recon_loss: 25540111.7377; val_gene_expr_recon_loss: 17681235.6393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43240488.4590; val_optim_loss: 43240488.4590
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9960; val_auprc_score: 0.9947; val_best_acc_score: 0.9813; val_best_f1_score: 0.9815; train_kl_reg_loss: 19372.7261; train_edge_recon_loss: 25471211.6875; train_gene_expr_recon_loss: 16849745.6654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42340330.1250; train_optim_loss: 42340330.1250; val_kl_reg_loss: 19205.0176; val_edge_recon_loss: 25524876.8197; val_gene_expr_recon_loss: 17729003.7377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43273085.0492; val_optim_loss: 43273085.0492
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9961; val_auprc_score: 0.9948; val_best_acc_score: 0.9817; val_best_f1_score: 0.9819; train_kl_reg_loss: 19404.9083; train_edge_recon_loss: 25468670.5735; train_gene_expr_recon_loss: 16857778.4982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42345853.9485; train_optim_loss: 42345853.9485; val_kl_reg_loss: 19189.4334; val_edge_recon_loss: 25530485.8689; val_gene_expr_recon_loss: 17686510.5902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43236186.0328; val_optim_loss: 43236186.0328
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9959; val_auprc_score: 0.9946; val_best_acc_score: 0.9813; val_best_f1_score: 0.9815; train_kl_reg_loss: 19406.8619; train_edge_recon_loss: 25476972.7647; train_gene_expr_recon_loss: 16844425.9779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42340805.6176; train_optim_loss: 42340805.6176; val_kl_reg_loss: 19214.8062; val_edge_recon_loss: 25530405.5738; val_gene_expr_recon_loss: 17707323.1803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43256943.8689; val_optim_loss: 43256943.8689

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 219 min 54 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
Val AUROC score: 0.9961
Val AUPRC score: 0.9948
Val best accuracy score: 0.9817
Val best F1 score: 0.9819
Val gene expr MSE score: 0.4833

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
