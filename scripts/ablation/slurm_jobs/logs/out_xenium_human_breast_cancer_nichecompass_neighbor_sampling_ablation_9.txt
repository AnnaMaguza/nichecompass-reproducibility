None
Run timestamp: 19072023_131420_9.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_9']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9666; val_auprc_score: 0.9604; val_best_acc_score: 0.9086; val_best_f1_score: 0.9125; train_kl_reg_loss: 46398.4778; train_edge_recon_loss: 26794332.6501; train_gene_expr_recon_loss: 7531808.7157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34372539.8712; train_optim_loss: 34372539.8712; val_kl_reg_loss: 44432.9142; val_edge_recon_loss: 26477381.0035; val_gene_expr_recon_loss: 6988153.3206; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33509967.2544; val_optim_loss: 33509967.2544
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9849; val_auprc_score: 0.9825; val_best_acc_score: 0.9417; val_best_f1_score: 0.9431; train_kl_reg_loss: 38347.2797; train_edge_recon_loss: 26237582.6804; train_gene_expr_recon_loss: 6887991.6810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33163921.6237; train_optim_loss: 33163921.6237; val_kl_reg_loss: 33410.5022; val_edge_recon_loss: 26254503.9512; val_gene_expr_recon_loss: 6833105.7927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33121020.2300; val_optim_loss: 33121020.2300
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9872; val_auprc_score: 0.9849; val_best_acc_score: 0.9487; val_best_f1_score: 0.9498; train_kl_reg_loss: 33719.1347; train_edge_recon_loss: 26063389.5384; train_gene_expr_recon_loss: 6778553.6810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32875662.3367; train_optim_loss: 32875662.3367; val_kl_reg_loss: 33339.9947; val_edge_recon_loss: 26136827.3659; val_gene_expr_recon_loss: 6752636.8258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32922804.0836; val_optim_loss: 32922804.0836
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9887; val_auprc_score: 0.9865; val_best_acc_score: 0.9526; val_best_f1_score: 0.9536; train_kl_reg_loss: 32586.1130; train_edge_recon_loss: 26005602.9736; train_gene_expr_recon_loss: 6725314.8113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32763503.9154; train_optim_loss: 32763503.9154; val_kl_reg_loss: 31555.4463; val_edge_recon_loss: 26091590.8641; val_gene_expr_recon_loss: 6718693.8920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32841840.2021; val_optim_loss: 32841840.2021
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9896; val_auprc_score: 0.9874; val_best_acc_score: 0.9566; val_best_f1_score: 0.9574; train_kl_reg_loss: 30599.0614; train_edge_recon_loss: 25966048.6129; train_gene_expr_recon_loss: 6703186.1792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32699833.8518; train_optim_loss: 32699833.8518; val_kl_reg_loss: 29807.3806; val_edge_recon_loss: 26053798.6341; val_gene_expr_recon_loss: 6714228.3188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32797834.2927; val_optim_loss: 32797834.2927
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9903; val_auprc_score: 0.9881; val_best_acc_score: 0.9594; val_best_f1_score: 0.9602; train_kl_reg_loss: 29114.2307; train_edge_recon_loss: 25911314.7828; train_gene_expr_recon_loss: 6688613.9408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32629042.9837; train_optim_loss: 32629042.9837; val_kl_reg_loss: 27912.1797; val_edge_recon_loss: 25998660.1603; val_gene_expr_recon_loss: 6693296.0906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32719868.3066; val_optim_loss: 32719868.3066
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9912; val_auprc_score: 0.9892; val_best_acc_score: 0.9616; val_best_f1_score: 0.9623; train_kl_reg_loss: 28328.3802; train_edge_recon_loss: 25879463.0365; train_gene_expr_recon_loss: 6678758.8561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32586550.2870; train_optim_loss: 32586550.2870; val_kl_reg_loss: 28450.4843; val_edge_recon_loss: 25984229.0174; val_gene_expr_recon_loss: 6690964.0679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32703643.6376; val_optim_loss: 32703643.6376
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9920; val_auprc_score: 0.9903; val_best_acc_score: 0.9640; val_best_f1_score: 0.9646; train_kl_reg_loss: 28001.9751; train_edge_recon_loss: 25857410.7929; train_gene_expr_recon_loss: 6664058.5386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32549471.3382; train_optim_loss: 32549471.3382; val_kl_reg_loss: 27755.0634; val_edge_recon_loss: 25942187.9721; val_gene_expr_recon_loss: 6685168.6324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32655111.6307; val_optim_loss: 32655111.6307
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9922; val_auprc_score: 0.9904; val_best_acc_score: 0.9643; val_best_f1_score: 0.9648; train_kl_reg_loss: 27592.5955; train_edge_recon_loss: 25845276.5376; train_gene_expr_recon_loss: 6656223.5605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32529092.6858; train_optim_loss: 32529092.6858; val_kl_reg_loss: 27538.0719; val_edge_recon_loss: 25921249.0801; val_gene_expr_recon_loss: 6664008.0801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32612795.2683; val_optim_loss: 32612795.2683
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9926; val_auprc_score: 0.9910; val_best_acc_score: 0.9655; val_best_f1_score: 0.9661; train_kl_reg_loss: 27076.2122; train_edge_recon_loss: 25837157.8185; train_gene_expr_recon_loss: 6649683.9725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32513918.0054; train_optim_loss: 32513918.0054; val_kl_reg_loss: 26546.0731; val_edge_recon_loss: 25906437.9512; val_gene_expr_recon_loss: 6665103.6620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32598087.7003; val_optim_loss: 32598087.7003
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9924; val_auprc_score: 0.9905; val_best_acc_score: 0.9658; val_best_f1_score: 0.9662; train_kl_reg_loss: 26578.4153; train_edge_recon_loss: 25812658.2382; train_gene_expr_recon_loss: 6646801.1294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32486037.7905; train_optim_loss: 32486037.7905; val_kl_reg_loss: 26485.9925; val_edge_recon_loss: 25935643.2544; val_gene_expr_recon_loss: 6670320.5575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32632449.7979; val_optim_loss: 32632449.7979
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9931; val_auprc_score: 0.9915; val_best_acc_score: 0.9672; val_best_f1_score: 0.9677; train_kl_reg_loss: 26354.8109; train_edge_recon_loss: 25803386.1078; train_gene_expr_recon_loss: 6640983.3410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32470724.2816; train_optim_loss: 32470724.2816; val_kl_reg_loss: 26089.4639; val_edge_recon_loss: 25884780.6202; val_gene_expr_recon_loss: 6659331.9599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32570202.0627; val_optim_loss: 32570202.0627
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9929; val_auprc_score: 0.9913; val_best_acc_score: 0.9668; val_best_f1_score: 0.9673; train_kl_reg_loss: 25978.5176; train_edge_recon_loss: 25795968.3351; train_gene_expr_recon_loss: 6633387.4313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32455334.3103; train_optim_loss: 32455334.3103; val_kl_reg_loss: 26048.4591; val_edge_recon_loss: 25888945.6585; val_gene_expr_recon_loss: 6646420.2509; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32561414.2997; val_optim_loss: 32561414.2997
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9932; val_auprc_score: 0.9915; val_best_acc_score: 0.9685; val_best_f1_score: 0.9690; train_kl_reg_loss: 25683.5743; train_edge_recon_loss: 25790519.4344; train_gene_expr_recon_loss: 6627486.1206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32443689.1164; train_optim_loss: 32443689.1164; val_kl_reg_loss: 24686.7284; val_edge_recon_loss: 25886954.5087; val_gene_expr_recon_loss: 6666889.9704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32578531.1847; val_optim_loss: 32578531.1847
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9929; val_auprc_score: 0.9911; val_best_acc_score: 0.9680; val_best_f1_score: 0.9685; train_kl_reg_loss: 25402.1697; train_edge_recon_loss: 25775433.7525; train_gene_expr_recon_loss: 6629528.8210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32430364.7292; train_optim_loss: 32430364.7292; val_kl_reg_loss: 25482.3552; val_edge_recon_loss: 25861289.7909; val_gene_expr_recon_loss: 6660731.9530; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32547504.1045; val_optim_loss: 32547504.1045
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9934; val_auprc_score: 0.9919; val_best_acc_score: 0.9690; val_best_f1_score: 0.9695; train_kl_reg_loss: 25100.4533; train_edge_recon_loss: 25772197.0116; train_gene_expr_recon_loss: 6626885.7172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32424183.1590; train_optim_loss: 32424183.1590; val_kl_reg_loss: 24707.1309; val_edge_recon_loss: 25844353.5540; val_gene_expr_recon_loss: 6658316.1707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32527376.8084; val_optim_loss: 32527376.8084
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9936; val_auprc_score: 0.9921; val_best_acc_score: 0.9701; val_best_f1_score: 0.9705; train_kl_reg_loss: 24913.1176; train_edge_recon_loss: 25769409.7168; train_gene_expr_recon_loss: 6620307.5586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32414630.3980; train_optim_loss: 32414630.3980; val_kl_reg_loss: 24267.9613; val_edge_recon_loss: 25869135.6725; val_gene_expr_recon_loss: 6657723.2857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32551126.9617; val_optim_loss: 32551126.9617
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9936; val_auprc_score: 0.9919; val_best_acc_score: 0.9705; val_best_f1_score: 0.9709; train_kl_reg_loss: 24844.1392; train_edge_recon_loss: 25759986.6253; train_gene_expr_recon_loss: 6618476.2258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32403307.0171; train_optim_loss: 32403307.0171; val_kl_reg_loss: 23844.8789; val_edge_recon_loss: 25853459.5610; val_gene_expr_recon_loss: 6651769.7526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32529074.2091; val_optim_loss: 32529074.2091
