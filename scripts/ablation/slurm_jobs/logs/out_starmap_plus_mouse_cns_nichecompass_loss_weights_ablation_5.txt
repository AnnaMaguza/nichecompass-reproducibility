None
Run timestamp: 30062023_100000_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
heaps
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9543; val_auprc_score: 0.9496; val_best_acc_score: 0.8853; val_best_f1_score: 0.8871; train_kl_reg_loss: 680.5528; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13380.1312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14060.6840; train_optim_loss: 14060.6840; val_kl_reg_loss: 900.6943; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11720.0187; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12620.7129; val_optim_loss: 12620.7129
heaps
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9658; val_auprc_score: 0.9628; val_best_acc_score: 0.9047; val_best_f1_score: 0.9050; train_kl_reg_loss: 875.0032; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 11308.6100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12183.6132; train_optim_loss: 12183.6132; val_kl_reg_loss: 822.1382; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10849.9996; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11672.1379; val_optim_loss: 11672.1379
heaps
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9674; val_auprc_score: 0.9641; val_best_acc_score: 0.9070; val_best_f1_score: 0.9076; train_kl_reg_loss: 805.1693; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10769.2967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11574.4660; train_optim_loss: 11574.4660; val_kl_reg_loss: 746.0457; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10538.9746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11285.0203; val_optim_loss: 11285.0203
heaps
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9696; val_auprc_score: 0.9673; val_best_acc_score: 0.9113; val_best_f1_score: 0.9115; train_kl_reg_loss: 753.1131; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10485.7139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11238.8270; train_optim_loss: 11238.8270; val_kl_reg_loss: 699.7503; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10264.3413; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10964.0916; val_optim_loss: 10964.0916
heaps
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9696; val_auprc_score: 0.9685; val_best_acc_score: 0.9096; val_best_f1_score: 0.9106; train_kl_reg_loss: 719.4419; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10300.0252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11019.4671; train_optim_loss: 11019.4671; val_kl_reg_loss: 690.7749; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10134.4783; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10825.2533; val_optim_loss: 10825.2533
heaps
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9705; val_auprc_score: 0.9690; val_best_acc_score: 0.9112; val_best_f1_score: 0.9128; train_kl_reg_loss: 697.0473; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10152.0702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10849.1175; train_optim_loss: 10849.1175; val_kl_reg_loss: 665.1223; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10019.8650; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10684.9872; val_optim_loss: 10684.9872
heaps
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9701; val_auprc_score: 0.9688; val_best_acc_score: 0.9110; val_best_f1_score: 0.9109; train_kl_reg_loss: 682.2524; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10056.8165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10739.0689; train_optim_loss: 10739.0689; val_kl_reg_loss: 663.5728; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9909.4166; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10572.9894; val_optim_loss: 10572.9894
heaps
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9697; val_auprc_score: 0.9686; val_best_acc_score: 0.9088; val_best_f1_score: 0.9104; train_kl_reg_loss: 671.0476; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9956.5658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10627.6134; train_optim_loss: 10627.6134; val_kl_reg_loss: 656.3348; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9840.1627; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10496.4975; val_optim_loss: 10496.4975
heaps
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9708; val_auprc_score: 0.9701; val_best_acc_score: 0.9100; val_best_f1_score: 0.9111; train_kl_reg_loss: 663.3177; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9880.6002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10543.9178; train_optim_loss: 10543.9178; val_kl_reg_loss: 637.8590; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9788.3207; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10426.1798; val_optim_loss: 10426.1798
heaps
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9704; val_auprc_score: 0.9697; val_best_acc_score: 0.9120; val_best_f1_score: 0.9117; train_kl_reg_loss: 657.4995; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9805.7755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10463.2750; train_optim_loss: 10463.2750; val_kl_reg_loss: 632.5651; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9758.8924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10391.4576; val_optim_loss: 10391.4576
heaps
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9692; val_auprc_score: 0.9684; val_best_acc_score: 0.9096; val_best_f1_score: 0.9106; train_kl_reg_loss: 653.2237; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9743.9886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10397.2122; train_optim_loss: 10397.2122; val_kl_reg_loss: 632.1666; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9681.8801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10314.0467; val_optim_loss: 10314.0467
heaps
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9704; val_auprc_score: 0.9702; val_best_acc_score: 0.9109; val_best_f1_score: 0.9103; train_kl_reg_loss: 649.8891; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9688.6457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10338.5347; train_optim_loss: 10338.5347; val_kl_reg_loss: 631.8767; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9644.1081; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10275.9848; val_optim_loss: 10275.9848
heaps
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9695; val_auprc_score: 0.9689; val_best_acc_score: 0.9095; val_best_f1_score: 0.9100; train_kl_reg_loss: 647.7694; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9641.9323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10289.7016; train_optim_loss: 10289.7016; val_kl_reg_loss: 635.4569; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9594.3174; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10229.7744; val_optim_loss: 10229.7744
heaps
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9706; val_auprc_score: 0.9712; val_best_acc_score: 0.9098; val_best_f1_score: 0.9096; train_kl_reg_loss: 646.8541; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9606.3340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10253.1881; train_optim_loss: 10253.1881; val_kl_reg_loss: 628.7292; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9551.3156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10180.0448; val_optim_loss: 10180.0448
heaps
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9707; val_auprc_score: 0.9710; val_best_acc_score: 0.9109; val_best_f1_score: 0.9113; train_kl_reg_loss: 646.0005; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9574.1062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10220.1068; train_optim_loss: 10220.1068; val_kl_reg_loss: 630.9658; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9556.0407; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10187.0065; val_optim_loss: 10187.0065
heaps
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9701; val_auprc_score: 0.9698; val_best_acc_score: 0.9122; val_best_f1_score: 0.9121; train_kl_reg_loss: 646.2233; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9541.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10188.0983; train_optim_loss: 10188.0983; val_kl_reg_loss: 628.4120; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9524.9432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10153.3553; val_optim_loss: 10153.3553
heaps
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9705; val_auprc_score: 0.9704; val_best_acc_score: 0.9112; val_best_f1_score: 0.9119; train_kl_reg_loss: 647.1444; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9503.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10150.4256; train_optim_loss: 10150.4256; val_kl_reg_loss: 625.4043; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9520.4754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10145.8797; val_optim_loss: 10145.8797
heaps
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9700; val_auprc_score: 0.9702; val_best_acc_score: 0.9097; val_best_f1_score: 0.9104; train_kl_reg_loss: 649.3306; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9483.8887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10133.2193; train_optim_loss: 10133.2193; val_kl_reg_loss: 632.0731; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9492.5202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10124.5933; val_optim_loss: 10124.5933
heaps
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9704; val_auprc_score: 0.9706; val_best_acc_score: 0.9104; val_best_f1_score: 0.9102; train_kl_reg_loss: 651.3037; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9458.7184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10110.0221; train_optim_loss: 10110.0221; val_kl_reg_loss: 636.6481; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9486.9662; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10123.6143; val_optim_loss: 10123.6143
heaps
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9703; val_auprc_score: 0.9706; val_best_acc_score: 0.9119; val_best_f1_score: 0.9122; train_kl_reg_loss: 653.8389; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9430.1591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10083.9980; train_optim_loss: 10083.9980; val_kl_reg_loss: 636.9885; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9457.7745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10094.7631; val_optim_loss: 10094.7631
heaps
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9696; val_auprc_score: 0.9698; val_best_acc_score: 0.9093; val_best_f1_score: 0.9095; train_kl_reg_loss: 656.3892; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9411.7680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10068.1572; train_optim_loss: 10068.1572; val_kl_reg_loss: 635.9667; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9461.9747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10097.9415; val_optim_loss: 10097.9415
heaps
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9705; val_auprc_score: 0.9713; val_best_acc_score: 0.9113; val_best_f1_score: 0.9107; train_kl_reg_loss: 658.7090; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9379.1620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10037.8710; train_optim_loss: 10037.8710; val_kl_reg_loss: 650.2297; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9451.7204; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10101.9501; val_optim_loss: 10101.9501
heaps
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9697; val_auprc_score: 0.9698; val_best_acc_score: 0.9105; val_best_f1_score: 0.9106; train_kl_reg_loss: 661.2087; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9369.4003; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10030.6090; train_optim_loss: 10030.6090; val_kl_reg_loss: 647.3589; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9446.9697; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10094.3285; val_optim_loss: 10094.3285
heaps
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9700; val_auprc_score: 0.9710; val_best_acc_score: 0.9115; val_best_f1_score: 0.9111; train_kl_reg_loss: 664.3567; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9346.7410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10011.0976; train_optim_loss: 10011.0976; val_kl_reg_loss: 657.6247; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9431.2373; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10088.8620; val_optim_loss: 10088.8620
heaps
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9699; val_auprc_score: 0.9706; val_best_acc_score: 0.9097; val_best_f1_score: 0.9103; train_kl_reg_loss: 667.1150; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9327.8316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9994.9466; train_optim_loss: 9994.9466; val_kl_reg_loss: 649.8270; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9411.1152; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10060.9422; val_optim_loss: 10060.9422
heaps
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9700; val_auprc_score: 0.9703; val_best_acc_score: 0.9114; val_best_f1_score: 0.9114; train_kl_reg_loss: 668.5731; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9305.1767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9973.7498; train_optim_loss: 9973.7498; val_kl_reg_loss: 654.8437; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9419.7585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10074.6022; val_optim_loss: 10074.6022
heaps
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9698; val_auprc_score: 0.9712; val_best_acc_score: 0.9101; val_best_f1_score: 0.9094; train_kl_reg_loss: 671.4840; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9291.6904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9963.1744; train_optim_loss: 9963.1744; val_kl_reg_loss: 659.9277; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9448.5475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10108.4753; val_optim_loss: 10108.4753
heaps
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9699; val_auprc_score: 0.9712; val_best_acc_score: 0.9115; val_best_f1_score: 0.9116; train_kl_reg_loss: 673.9514; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9281.3991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9955.3505; train_optim_loss: 9955.3505; val_kl_reg_loss: 653.8185; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9413.6244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10067.4429; val_optim_loss: 10067.4429
heaps
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9706; val_auprc_score: 0.9718; val_best_acc_score: 0.9119; val_best_f1_score: 0.9123; train_kl_reg_loss: 675.9255; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9264.0043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9939.9298; train_optim_loss: 9939.9298; val_kl_reg_loss: 658.7605; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9409.2530; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10068.0134; val_optim_loss: 10068.0134

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

heaps
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9697; val_auprc_score: 0.9706; val_best_acc_score: 0.9101; val_best_f1_score: 0.9095; train_kl_reg_loss: 672.4012; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9210.5962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9882.9974; train_optim_loss: 9882.9974; val_kl_reg_loss: 655.3901; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9402.6715; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10058.0617; val_optim_loss: 10058.0617
heaps
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9703; val_auprc_score: 0.9720; val_best_acc_score: 0.9121; val_best_f1_score: 0.9111; train_kl_reg_loss: 673.1004; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9204.1802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9877.2806; train_optim_loss: 9877.2806; val_kl_reg_loss: 654.9699; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9381.5463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10036.5162; val_optim_loss: 10036.5162
heaps
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9698; val_auprc_score: 0.9708; val_best_acc_score: 0.9113; val_best_f1_score: 0.9103; train_kl_reg_loss: 673.4493; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9204.1929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9877.6421; train_optim_loss: 9877.6421; val_kl_reg_loss: 657.6817; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9408.7647; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10066.4463; val_optim_loss: 10066.4463
heaps
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9703; val_auprc_score: 0.9718; val_best_acc_score: 0.9121; val_best_f1_score: 0.9109; train_kl_reg_loss: 673.6757; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9191.5503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9865.2259; train_optim_loss: 9865.2259; val_kl_reg_loss: 656.6961; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9373.7518; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10030.4479; val_optim_loss: 10030.4479
heaps
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9710; val_auprc_score: 0.9725; val_best_acc_score: 0.9127; val_best_f1_score: 0.9115; train_kl_reg_loss: 673.9674; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9198.8218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9872.7892; train_optim_loss: 9872.7892; val_kl_reg_loss: 660.6609; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9401.3144; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10061.9753; val_optim_loss: 10061.9753
heaps
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9699; val_auprc_score: 0.9711; val_best_acc_score: 0.9111; val_best_f1_score: 0.9100; train_kl_reg_loss: 674.4403; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9197.6160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9872.0563; train_optim_loss: 9872.0563; val_kl_reg_loss: 661.1471; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9404.9696; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10066.1167; val_optim_loss: 10066.1167
heaps
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9687; val_auprc_score: 0.9701; val_best_acc_score: 0.9100; val_best_f1_score: 0.9088; train_kl_reg_loss: 674.6913; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9199.0130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9873.7043; train_optim_loss: 9873.7043; val_kl_reg_loss: 658.3702; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9393.8172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10052.1875; val_optim_loss: 10052.1875
heaps
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9689; val_auprc_score: 0.9702; val_best_acc_score: 0.9098; val_best_f1_score: 0.9086; train_kl_reg_loss: 674.8328; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9195.1641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9869.9969; train_optim_loss: 9869.9969; val_kl_reg_loss: 662.4862; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9401.0040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10063.4902; val_optim_loss: 10063.4902

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

heaps
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9697; val_auprc_score: 0.9708; val_best_acc_score: 0.9103; val_best_f1_score: 0.9102; train_kl_reg_loss: 674.7960; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9183.7192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9858.5152; train_optim_loss: 9858.5152; val_kl_reg_loss: 658.0708; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9395.8839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10053.9547; val_optim_loss: 10053.9547
heaps
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9701; val_auprc_score: 0.9718; val_best_acc_score: 0.9115; val_best_f1_score: 0.9112; train_kl_reg_loss: 674.5254; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9187.3248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9861.8502; train_optim_loss: 9861.8502; val_kl_reg_loss: 658.5121; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9401.6912; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10060.2033; val_optim_loss: 10060.2033
heaps
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9705; val_auprc_score: 0.9722; val_best_acc_score: 0.9120; val_best_f1_score: 0.9117; train_kl_reg_loss: 674.3592; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9190.6196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9864.9788; train_optim_loss: 9864.9788; val_kl_reg_loss: 658.8052; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9409.3864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10068.1918; val_optim_loss: 10068.1918
heaps
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9690; val_auprc_score: 0.9706; val_best_acc_score: 0.9096; val_best_f1_score: 0.9100; train_kl_reg_loss: 674.4338; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9185.0971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9859.5309; train_optim_loss: 9859.5309; val_kl_reg_loss: 659.5704; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9401.0629; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10060.6334; val_optim_loss: 10060.6334

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 37 min 11 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
Val AUROC score: 0.9694
Val AUPRC score: 0.9704
Val best accuracy score: 0.9106
Val best F1 score: 0.9096
Val gene expr MSE score: 0.7041

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
