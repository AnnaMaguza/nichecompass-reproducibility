None
Run timestamp: 02072023_084038_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9525; val_auprc_score: 0.9479; val_best_acc_score: 0.8838; val_best_f1_score: 0.8852; train_kl_reg_loss: 695.7509; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13239.2268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13934.9777; train_optim_loss: 13934.9777; val_kl_reg_loss: 839.6395; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11615.3462; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12454.9857; val_optim_loss: 12454.9857
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9622; val_auprc_score: 0.9588; val_best_acc_score: 0.8993; val_best_f1_score: 0.8995; train_kl_reg_loss: 863.5262; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 11179.5284; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12043.0546; train_optim_loss: 12043.0546; val_kl_reg_loss: 781.3161; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10755.8891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11537.2052; val_optim_loss: 11537.2052
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9648; val_auprc_score: 0.9622; val_best_acc_score: 0.9039; val_best_f1_score: 0.9048; train_kl_reg_loss: 790.3064; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10641.8723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11432.1787; train_optim_loss: 11432.1787; val_kl_reg_loss: 748.6749; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10365.4562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11114.1310; val_optim_loss: 11114.1310
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9667; val_auprc_score: 0.9641; val_best_acc_score: 0.9083; val_best_f1_score: 0.9088; train_kl_reg_loss: 738.6994; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10363.8988; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11102.5982; train_optim_loss: 11102.5982; val_kl_reg_loss: 692.4768; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10137.2619; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10829.7387; val_optim_loss: 10829.7387
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9678; val_auprc_score: 0.9659; val_best_acc_score: 0.9078; val_best_f1_score: 0.9092; train_kl_reg_loss: 705.7121; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10182.6068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10888.3189; train_optim_loss: 10888.3189; val_kl_reg_loss: 665.8008; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9990.0432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10655.8440; val_optim_loss: 10655.8440
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9686; val_auprc_score: 0.9669; val_best_acc_score: 0.9098; val_best_f1_score: 0.9109; train_kl_reg_loss: 683.6028; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10030.6654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10714.2681; train_optim_loss: 10714.2681; val_kl_reg_loss: 648.1158; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9890.9731; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10539.0890; val_optim_loss: 10539.0890
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9689; val_auprc_score: 0.9681; val_best_acc_score: 0.9077; val_best_f1_score: 0.9088; train_kl_reg_loss: 668.4657; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9904.4798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10572.9455; train_optim_loss: 10572.9455; val_kl_reg_loss: 646.4483; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9744.8879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10391.3361; val_optim_loss: 10391.3361
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9679; val_auprc_score: 0.9667; val_best_acc_score: 0.9069; val_best_f1_score: 0.9079; train_kl_reg_loss: 657.7578; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9827.9706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10485.7284; train_optim_loss: 10485.7284; val_kl_reg_loss: 634.1004; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9696.4294; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10330.5298; val_optim_loss: 10330.5298
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9676; val_auprc_score: 0.9661; val_best_acc_score: 0.9078; val_best_f1_score: 0.9077; train_kl_reg_loss: 650.0619; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9728.9647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10379.0266; train_optim_loss: 10379.0266; val_kl_reg_loss: 634.1310; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9598.1266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10232.2576; val_optim_loss: 10232.2576
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9684; val_auprc_score: 0.9673; val_best_acc_score: 0.9081; val_best_f1_score: 0.9090; train_kl_reg_loss: 644.9690; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9665.0067; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10309.9757; train_optim_loss: 10309.9757; val_kl_reg_loss: 614.0907; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9569.6775; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10183.7680; val_optim_loss: 10183.7680
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9681; val_auprc_score: 0.9672; val_best_acc_score: 0.9079; val_best_f1_score: 0.9074; train_kl_reg_loss: 641.6398; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9599.6353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10241.2750; train_optim_loss: 10241.2750; val_kl_reg_loss: 625.6709; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9518.8521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10144.5231; val_optim_loss: 10144.5231
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9688; val_auprc_score: 0.9692; val_best_acc_score: 0.9077; val_best_f1_score: 0.9082; train_kl_reg_loss: 639.6569; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9551.3871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10191.0441; train_optim_loss: 10191.0441; val_kl_reg_loss: 619.9147; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9486.6836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10106.5983; val_optim_loss: 10106.5983
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9682; val_auprc_score: 0.9682; val_best_acc_score: 0.9077; val_best_f1_score: 0.9072; train_kl_reg_loss: 638.3443; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9509.0882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10147.4325; train_optim_loss: 10147.4325; val_kl_reg_loss: 622.9678; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9469.9866; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10092.9544; val_optim_loss: 10092.9544
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9683; val_auprc_score: 0.9690; val_best_acc_score: 0.9052; val_best_f1_score: 0.9058; train_kl_reg_loss: 638.2164; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9468.3698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10106.5863; train_optim_loss: 10106.5863; val_kl_reg_loss: 625.7081; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9406.8269; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10032.5351; val_optim_loss: 10032.5351
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9682; val_auprc_score: 0.9685; val_best_acc_score: 0.9075; val_best_f1_score: 0.9074; train_kl_reg_loss: 638.0555; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9423.1260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10061.1815; train_optim_loss: 10061.1815; val_kl_reg_loss: 615.6596; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9402.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10018.1596; val_optim_loss: 10018.1596
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9668; val_auprc_score: 0.9668; val_best_acc_score: 0.9060; val_best_f1_score: 0.9065; train_kl_reg_loss: 638.3258; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9384.7910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10023.1168; train_optim_loss: 10023.1168; val_kl_reg_loss: 618.3762; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9363.5226; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9981.8988; val_optim_loss: 9981.8988
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9674; val_auprc_score: 0.9677; val_best_acc_score: 0.9045; val_best_f1_score: 0.9042; train_kl_reg_loss: 639.6470; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9356.5843; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9996.2313; train_optim_loss: 9996.2313; val_kl_reg_loss: 618.0366; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9335.8863; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9953.9229; val_optim_loss: 9953.9229
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9689; val_auprc_score: 0.9697; val_best_acc_score: 0.9089; val_best_f1_score: 0.9096; train_kl_reg_loss: 640.8545; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9325.1853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9966.0398; train_optim_loss: 9966.0398; val_kl_reg_loss: 629.1666; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9335.4131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9964.5797; val_optim_loss: 9964.5797
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9678; val_auprc_score: 0.9681; val_best_acc_score: 0.9086; val_best_f1_score: 0.9083; train_kl_reg_loss: 642.7221; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9296.2919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9939.0139; train_optim_loss: 9939.0139; val_kl_reg_loss: 633.0397; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9318.0764; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9951.1161; val_optim_loss: 9951.1161
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9674; val_auprc_score: 0.9674; val_best_acc_score: 0.9072; val_best_f1_score: 0.9068; train_kl_reg_loss: 644.1323; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9281.0240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9925.1563; train_optim_loss: 9925.1563; val_kl_reg_loss: 630.1422; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9313.9931; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9944.1352; val_optim_loss: 9944.1352
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9675; val_auprc_score: 0.9674; val_best_acc_score: 0.9066; val_best_f1_score: 0.9068; train_kl_reg_loss: 645.3956; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9249.0069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9894.4025; train_optim_loss: 9894.4025; val_kl_reg_loss: 633.7222; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9305.8403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9939.5624; val_optim_loss: 9939.5624
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9693; val_auprc_score: 0.9704; val_best_acc_score: 0.9098; val_best_f1_score: 0.9101; train_kl_reg_loss: 646.8533; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9232.7270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9879.5802; train_optim_loss: 9879.5802; val_kl_reg_loss: 617.1702; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9308.7203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9925.8905; val_optim_loss: 9925.8905
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9676; val_auprc_score: 0.9687; val_best_acc_score: 0.9066; val_best_f1_score: 0.9058; train_kl_reg_loss: 648.2443; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9211.3428; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9859.5872; train_optim_loss: 9859.5872; val_kl_reg_loss: 641.2468; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9260.7267; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9901.9734; val_optim_loss: 9901.9734
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9671; val_auprc_score: 0.9680; val_best_acc_score: 0.9058; val_best_f1_score: 0.9062; train_kl_reg_loss: 650.1463; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9196.4765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9846.6227; train_optim_loss: 9846.6227; val_kl_reg_loss: 633.6832; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9267.8943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9901.5776; val_optim_loss: 9901.5776
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9679; val_auprc_score: 0.9693; val_best_acc_score: 0.9077; val_best_f1_score: 0.9072; train_kl_reg_loss: 651.8670; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9180.3203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9832.1873; train_optim_loss: 9832.1873; val_kl_reg_loss: 640.7580; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9243.3248; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9884.0829; val_optim_loss: 9884.0829
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9681; val_auprc_score: 0.9689; val_best_acc_score: 0.9084; val_best_f1_score: 0.9075; train_kl_reg_loss: 653.7996; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9168.2293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9822.0289; train_optim_loss: 9822.0289; val_kl_reg_loss: 653.1145; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9268.9157; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9922.0304; val_optim_loss: 9922.0304
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9681; val_auprc_score: 0.9692; val_best_acc_score: 0.9078; val_best_f1_score: 0.9082; train_kl_reg_loss: 655.5031; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9154.8880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9810.3911; train_optim_loss: 9810.3911; val_kl_reg_loss: 640.2477; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9273.3129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9913.5606; val_optim_loss: 9913.5606
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9676; val_auprc_score: 0.9685; val_best_acc_score: 0.9066; val_best_f1_score: 0.9062; train_kl_reg_loss: 657.7343; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9143.3811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9801.1154; train_optim_loss: 9801.1154; val_kl_reg_loss: 646.3785; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9258.2541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9904.6325; val_optim_loss: 9904.6325
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9673; val_auprc_score: 0.9685; val_best_acc_score: 0.9067; val_best_f1_score: 0.9054; train_kl_reg_loss: 659.0866; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9121.6193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9780.7058; train_optim_loss: 9780.7058; val_kl_reg_loss: 644.8162; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9266.7593; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9911.5755; val_optim_loss: 9911.5755

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9670; val_auprc_score: 0.9686; val_best_acc_score: 0.9057; val_best_f1_score: 0.9060; train_kl_reg_loss: 655.9604; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9074.1857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9730.1461; train_optim_loss: 9730.1461; val_kl_reg_loss: 641.0370; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9239.0310; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9880.0681; val_optim_loss: 9880.0681
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9675; val_auprc_score: 0.9684; val_best_acc_score: 0.9084; val_best_f1_score: 0.9082; train_kl_reg_loss: 656.7251; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9066.6575; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9723.3825; train_optim_loss: 9723.3825; val_kl_reg_loss: 641.9217; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9242.4808; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9884.4025; val_optim_loss: 9884.4025
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9674; val_auprc_score: 0.9692; val_best_acc_score: 0.9066; val_best_f1_score: 0.9066; train_kl_reg_loss: 656.6003; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9064.0798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9720.6800; train_optim_loss: 9720.6800; val_kl_reg_loss: 645.7424; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9232.3300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9878.0724; val_optim_loss: 9878.0724
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9679; val_auprc_score: 0.9693; val_best_acc_score: 0.9078; val_best_f1_score: 0.9074; train_kl_reg_loss: 657.4517; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9063.6965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9721.1481; train_optim_loss: 9721.1481; val_kl_reg_loss: 646.1058; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9231.7858; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9877.8916; val_optim_loss: 9877.8916
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9678; val_auprc_score: 0.9696; val_best_acc_score: 0.9078; val_best_f1_score: 0.9073; train_kl_reg_loss: 657.5376; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9059.3552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9716.8927; train_optim_loss: 9716.8927; val_kl_reg_loss: 640.1842; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9246.4273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9886.6117; val_optim_loss: 9886.6117
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9680; val_auprc_score: 0.9697; val_best_acc_score: 0.9073; val_best_f1_score: 0.9069; train_kl_reg_loss: 657.8402; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9062.8091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9720.6493; train_optim_loss: 9720.6493; val_kl_reg_loss: 642.8056; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9215.6927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9858.4983; val_optim_loss: 9858.4983
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9675; val_auprc_score: 0.9694; val_best_acc_score: 0.9070; val_best_f1_score: 0.9064; train_kl_reg_loss: 658.0634; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9053.8013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9711.8647; train_optim_loss: 9711.8647; val_kl_reg_loss: 644.9665; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9246.1947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9891.1610; val_optim_loss: 9891.1610
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9673; val_auprc_score: 0.9693; val_best_acc_score: 0.9066; val_best_f1_score: 0.9061; train_kl_reg_loss: 658.0859; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9054.1855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9712.2713; train_optim_loss: 9712.2713; val_kl_reg_loss: 647.2592; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9249.3279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9896.5871; val_optim_loss: 9896.5871
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9679; val_auprc_score: 0.9693; val_best_acc_score: 0.9075; val_best_f1_score: 0.9067; train_kl_reg_loss: 658.3332; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9047.8988; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9706.2321; train_optim_loss: 9706.2321; val_kl_reg_loss: 641.1336; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9259.2678; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9900.4013; val_optim_loss: 9900.4013
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9679; val_auprc_score: 0.9699; val_best_acc_score: 0.9072; val_best_f1_score: 0.9064; train_kl_reg_loss: 658.0768; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9047.4134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9705.4902; train_optim_loss: 9705.4902; val_kl_reg_loss: 644.3032; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9221.9028; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9866.2060; val_optim_loss: 9866.2060

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9678; val_auprc_score: 0.9690; val_best_acc_score: 0.9076; val_best_f1_score: 0.9066; train_kl_reg_loss: 657.8326; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9039.3663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9697.1989; train_optim_loss: 9697.1989; val_kl_reg_loss: 643.6274; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9233.2486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9876.8759; val_optim_loss: 9876.8759
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9672; val_auprc_score: 0.9689; val_best_acc_score: 0.9072; val_best_f1_score: 0.9062; train_kl_reg_loss: 657.9087; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9045.8604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9703.7691; train_optim_loss: 9703.7691; val_kl_reg_loss: 644.2382; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9259.4926; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9903.7308; val_optim_loss: 9903.7308
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9683; val_auprc_score: 0.9705; val_best_acc_score: 0.9086; val_best_f1_score: 0.9074; train_kl_reg_loss: 658.2388; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9045.4092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9703.6480; train_optim_loss: 9703.6480; val_kl_reg_loss: 644.4617; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9226.5686; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9871.0303; val_optim_loss: 9871.0303
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9674; val_auprc_score: 0.9691; val_best_acc_score: 0.9072; val_best_f1_score: 0.9061; train_kl_reg_loss: 658.0818; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9039.7659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9697.8476; train_optim_loss: 9697.8476; val_kl_reg_loss: 643.5132; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9243.4434; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9886.9568; val_optim_loss: 9886.9568

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 39 min 15 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9681
Val AUPRC score: 0.9698
Val best accuracy score: 0.9072
Val best F1 score: 0.9068
Val gene expr MSE score: 0.6622

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
