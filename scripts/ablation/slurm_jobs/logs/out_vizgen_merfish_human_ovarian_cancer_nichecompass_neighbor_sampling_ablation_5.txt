None
Run timestamp: 13072023_153557_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '20', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 2407083
Number of validation edges: 267453
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9956; val_auprc_score: 0.9954; val_best_acc_score: 0.9686; val_best_f1_score: 0.9686; train_kl_reg_loss: 7924.2399; train_edge_recon_loss: 267782.6923; train_gene_expr_recon_loss: 142385.2304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 418092.1626; train_optim_loss: 418092.1626; val_kl_reg_loss: 7104.3357; val_edge_recon_loss: 262712.4189; val_gene_expr_recon_loss: 133720.4032; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 403537.1571; val_optim_loss: 403537.1571
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9970; val_auprc_score: 0.9966; val_best_acc_score: 0.9755; val_best_f1_score: 0.9757; train_kl_reg_loss: 6947.6445; train_edge_recon_loss: 262094.3552; train_gene_expr_recon_loss: 132934.7691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 401976.7688; train_optim_loss: 401976.7688; val_kl_reg_loss: 6833.2202; val_edge_recon_loss: 261012.0948; val_gene_expr_recon_loss: 131615.7391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399461.0538; val_optim_loss: 399461.0538
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9975; val_auprc_score: 0.9972; val_best_acc_score: 0.9783; val_best_f1_score: 0.9783; train_kl_reg_loss: 6705.8297; train_edge_recon_loss: 260758.9270; train_gene_expr_recon_loss: 131816.4522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 399281.2090; train_optim_loss: 399281.2090; val_kl_reg_loss: 6731.1183; val_edge_recon_loss: 260232.9960; val_gene_expr_recon_loss: 131241.1805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398205.2942; val_optim_loss: 398205.2942
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9806; val_best_f1_score: 0.9807; train_kl_reg_loss: 6619.0695; train_edge_recon_loss: 260136.3906; train_gene_expr_recon_loss: 131141.7782; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397897.2379; train_optim_loss: 397897.2379; val_kl_reg_loss: 6624.1251; val_edge_recon_loss: 259418.7227; val_gene_expr_recon_loss: 122799.0775; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388841.9261; val_optim_loss: 388841.9261
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9981; val_auprc_score: 0.9978; val_best_acc_score: 0.9821; val_best_f1_score: 0.9821; train_kl_reg_loss: 6571.7358; train_edge_recon_loss: 259749.5935; train_gene_expr_recon_loss: 127287.1657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393608.4950; train_optim_loss: 393608.4950; val_kl_reg_loss: 6642.4203; val_edge_recon_loss: 259119.5199; val_gene_expr_recon_loss: 118278.7033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384040.6435; val_optim_loss: 384040.6435
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9983; val_auprc_score: 0.9981; val_best_acc_score: 0.9829; val_best_f1_score: 0.9830; train_kl_reg_loss: 6544.6097; train_edge_recon_loss: 259454.4697; train_gene_expr_recon_loss: 114187.1955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380186.2750; train_optim_loss: 380186.2750; val_kl_reg_loss: 6625.3691; val_edge_recon_loss: 258976.0790; val_gene_expr_recon_loss: 107661.6573; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373263.1054; val_optim_loss: 373263.1054
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9984; val_auprc_score: 0.9982; val_best_acc_score: 0.9838; val_best_f1_score: 0.9839; train_kl_reg_loss: 6523.6747; train_edge_recon_loss: 259204.0196; train_gene_expr_recon_loss: 110239.5190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 375967.2131; train_optim_loss: 375967.2131; val_kl_reg_loss: 6519.5473; val_edge_recon_loss: 258705.2256; val_gene_expr_recon_loss: 109859.2295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 375084.0023; val_optim_loss: 375084.0023
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9985; val_auprc_score: 0.9984; val_best_acc_score: 0.9843; val_best_f1_score: 0.9843; train_kl_reg_loss: 6507.7472; train_edge_recon_loss: 258984.0185; train_gene_expr_recon_loss: 109758.1638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 375249.9294; train_optim_loss: 375249.9294; val_kl_reg_loss: 6519.9710; val_edge_recon_loss: 258624.6357; val_gene_expr_recon_loss: 109873.7852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 375018.3905; val_optim_loss: 375018.3905
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9985; val_auprc_score: 0.9982; val_best_acc_score: 0.9848; val_best_f1_score: 0.9849; train_kl_reg_loss: 6495.0624; train_edge_recon_loss: 258887.9741; train_gene_expr_recon_loss: 109467.5831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374850.6195; train_optim_loss: 374850.6195; val_kl_reg_loss: 6506.0204; val_edge_recon_loss: 258297.4622; val_gene_expr_recon_loss: 109071.0965; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373874.5798; val_optim_loss: 373874.5798
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9986; val_auprc_score: 0.9984; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 6484.1812; train_edge_recon_loss: 258711.0377; train_gene_expr_recon_loss: 109170.6358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374365.8548; train_optim_loss: 374365.8548; val_kl_reg_loss: 6443.3671; val_edge_recon_loss: 258254.8452; val_gene_expr_recon_loss: 108993.2794; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373691.4912; val_optim_loss: 373691.4912

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9989; val_auprc_score: 0.9987; val_best_acc_score: 0.9873; val_best_f1_score: 0.9873; train_kl_reg_loss: 6542.1892; train_edge_recon_loss: 258256.4409; train_gene_expr_recon_loss: 108489.6763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373288.3068; train_optim_loss: 373288.3068; val_kl_reg_loss: 6499.8437; val_edge_recon_loss: 257781.3800; val_gene_expr_recon_loss: 108567.7023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372848.9262; val_optim_loss: 372848.9262
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9989; val_auprc_score: 0.9987; val_best_acc_score: 0.9873; val_best_f1_score: 0.9873; train_kl_reg_loss: 6536.0615; train_edge_recon_loss: 258192.0128; train_gene_expr_recon_loss: 108397.4678; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373125.5419; train_optim_loss: 373125.5419; val_kl_reg_loss: 6520.3424; val_edge_recon_loss: 257681.2596; val_gene_expr_recon_loss: 108439.5157; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372641.1182; val_optim_loss: 372641.1182
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9989; val_auprc_score: 0.9986; val_best_acc_score: 0.9876; val_best_f1_score: 0.9876; train_kl_reg_loss: 6525.1206; train_edge_recon_loss: 258189.8276; train_gene_expr_recon_loss: 108357.7775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373072.7259; train_optim_loss: 373072.7259; val_kl_reg_loss: 6519.5756; val_edge_recon_loss: 257622.5581; val_gene_expr_recon_loss: 108432.2754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372574.4070; val_optim_loss: 372574.4070
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9989; val_auprc_score: 0.9986; val_best_acc_score: 0.9877; val_best_f1_score: 0.9877; train_kl_reg_loss: 6520.4093; train_edge_recon_loss: 258157.6201; train_gene_expr_recon_loss: 108330.4119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373008.4414; train_optim_loss: 373008.4414; val_kl_reg_loss: 6520.1563; val_edge_recon_loss: 257759.7830; val_gene_expr_recon_loss: 108465.3655; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372745.3037; val_optim_loss: 372745.3037
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9990; val_auprc_score: 0.9989; val_best_acc_score: 0.9880; val_best_f1_score: 0.9880; train_kl_reg_loss: 6514.7692; train_edge_recon_loss: 258141.3595; train_gene_expr_recon_loss: 108314.0694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372970.1979; train_optim_loss: 372970.1979; val_kl_reg_loss: 6487.6892; val_edge_recon_loss: 257496.3548; val_gene_expr_recon_loss: 108429.8999; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372413.9442; val_optim_loss: 372413.9442
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9989; val_auprc_score: 0.9987; val_best_acc_score: 0.9880; val_best_f1_score: 0.9880; train_kl_reg_loss: 6511.8951; train_edge_recon_loss: 258122.0974; train_gene_expr_recon_loss: 108278.2840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372912.2763; train_optim_loss: 372912.2763; val_kl_reg_loss: 6503.9804; val_edge_recon_loss: 257546.1273; val_gene_expr_recon_loss: 108407.3030; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372457.4114; val_optim_loss: 372457.4114
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9990; val_auprc_score: 0.9987; val_best_acc_score: 0.9880; val_best_f1_score: 0.9881; train_kl_reg_loss: 6510.6128; train_edge_recon_loss: 258105.1421; train_gene_expr_recon_loss: 108286.8724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372902.6276; train_optim_loss: 372902.6276; val_kl_reg_loss: 6503.0920; val_edge_recon_loss: 257594.9189; val_gene_expr_recon_loss: 108398.9004; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372496.9118; val_optim_loss: 372496.9118
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9989; val_auprc_score: 0.9986; val_best_acc_score: 0.9880; val_best_f1_score: 0.9881; train_kl_reg_loss: 6504.4685; train_edge_recon_loss: 258120.6528; train_gene_expr_recon_loss: 108278.8615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372903.9824; train_optim_loss: 372903.9824; val_kl_reg_loss: 6488.6173; val_edge_recon_loss: 257629.9309; val_gene_expr_recon_loss: 108330.6841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372449.2324; val_optim_loss: 372449.2324
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9989; val_auprc_score: 0.9987; val_best_acc_score: 0.9881; val_best_f1_score: 0.9882; train_kl_reg_loss: 6502.3306; train_edge_recon_loss: 258089.0215; train_gene_expr_recon_loss: 108240.9753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372832.3276; train_optim_loss: 372832.3276; val_kl_reg_loss: 6495.6264; val_edge_recon_loss: 257512.0721; val_gene_expr_recon_loss: 108432.2945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372439.9920; val_optim_loss: 372439.9920

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9990; val_auprc_score: 0.9988; val_best_acc_score: 0.9883; val_best_f1_score: 0.9883; train_kl_reg_loss: 6509.6445; train_edge_recon_loss: 257995.5855; train_gene_expr_recon_loss: 108155.4298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372660.6597; train_optim_loss: 372660.6597; val_kl_reg_loss: 6501.9649; val_edge_recon_loss: 257517.3838; val_gene_expr_recon_loss: 108288.6422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372307.9916; val_optim_loss: 372307.9916
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9990; val_auprc_score: 0.9988; val_best_acc_score: 0.9886; val_best_f1_score: 0.9886; train_kl_reg_loss: 6509.4243; train_edge_recon_loss: 257998.7906; train_gene_expr_recon_loss: 108149.0533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372657.2681; train_optim_loss: 372657.2681; val_kl_reg_loss: 6484.5451; val_edge_recon_loss: 257325.3758; val_gene_expr_recon_loss: 108357.3800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372167.3004; val_optim_loss: 372167.3004
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9990; val_auprc_score: 0.9989; val_best_acc_score: 0.9886; val_best_f1_score: 0.9886; train_kl_reg_loss: 6509.4324; train_edge_recon_loss: 257976.7376; train_gene_expr_recon_loss: 108141.3176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372627.4876; train_optim_loss: 372627.4876; val_kl_reg_loss: 6490.1990; val_edge_recon_loss: 257503.3608; val_gene_expr_recon_loss: 108323.2706; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372316.8304; val_optim_loss: 372316.8304
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9990; val_auprc_score: 0.9988; val_best_acc_score: 0.9883; val_best_f1_score: 0.9884; train_kl_reg_loss: 6508.3865; train_edge_recon_loss: 258001.1369; train_gene_expr_recon_loss: 108131.1047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372640.6280; train_optim_loss: 372640.6280; val_kl_reg_loss: 6494.3403; val_edge_recon_loss: 257537.3644; val_gene_expr_recon_loss: 108287.9481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372319.6529; val_optim_loss: 372319.6529
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9990; val_auprc_score: 0.9987; val_best_acc_score: 0.9886; val_best_f1_score: 0.9886; train_kl_reg_loss: 6509.6179; train_edge_recon_loss: 257997.4928; train_gene_expr_recon_loss: 108140.3219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372647.4328; train_optim_loss: 372647.4328; val_kl_reg_loss: 6493.8840; val_edge_recon_loss: 257387.5090; val_gene_expr_recon_loss: 108278.9292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372160.3221; val_optim_loss: 372160.3221
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9990; val_auprc_score: 0.9987; val_best_acc_score: 0.9883; val_best_f1_score: 0.9883; train_kl_reg_loss: 6509.3790; train_edge_recon_loss: 257976.7400; train_gene_expr_recon_loss: 108155.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372641.9237; train_optim_loss: 372641.9237; val_kl_reg_loss: 6490.0253; val_edge_recon_loss: 257584.8842; val_gene_expr_recon_loss: 108360.6623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372435.5721; val_optim_loss: 372435.5721
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9990; val_auprc_score: 0.9989; val_best_acc_score: 0.9885; val_best_f1_score: 0.9885; train_kl_reg_loss: 6505.7492; train_edge_recon_loss: 257995.4390; train_gene_expr_recon_loss: 108131.2938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372632.4818; train_optim_loss: 372632.4818; val_kl_reg_loss: 6489.7270; val_edge_recon_loss: 257400.3311; val_gene_expr_recon_loss: 108362.3411; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372252.3993; val_optim_loss: 372252.3993
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9990; val_auprc_score: 0.9989; val_best_acc_score: 0.9885; val_best_f1_score: 0.9886; train_kl_reg_loss: 6506.2373; train_edge_recon_loss: 257971.3619; train_gene_expr_recon_loss: 108123.9508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372601.5498; train_optim_loss: 372601.5498; val_kl_reg_loss: 6488.4396; val_edge_recon_loss: 257474.7982; val_gene_expr_recon_loss: 108315.9461; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372279.1837; val_optim_loss: 372279.1837
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9991; val_auprc_score: 0.9990; val_best_acc_score: 0.9888; val_best_f1_score: 0.9888; train_kl_reg_loss: 6504.6511; train_edge_recon_loss: 258022.4721; train_gene_expr_recon_loss: 108138.1970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372665.3204; train_optim_loss: 372665.3204; val_kl_reg_loss: 6489.0501; val_edge_recon_loss: 257450.4463; val_gene_expr_recon_loss: 108398.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372338.1518; val_optim_loss: 372338.1518

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9990; val_auprc_score: 0.9988; val_best_acc_score: 0.9884; val_best_f1_score: 0.9884; train_kl_reg_loss: 6505.4789; train_edge_recon_loss: 258034.2800; train_gene_expr_recon_loss: 108118.2355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372657.9946; train_optim_loss: 372657.9946; val_kl_reg_loss: 6491.7088; val_edge_recon_loss: 257509.2222; val_gene_expr_recon_loss: 108344.7053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372345.6359; val_optim_loss: 372345.6359
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9990; val_auprc_score: 0.9988; val_best_acc_score: 0.9886; val_best_f1_score: 0.9886; train_kl_reg_loss: 6506.6909; train_edge_recon_loss: 257988.9596; train_gene_expr_recon_loss: 108141.2009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372636.8515; train_optim_loss: 372636.8515; val_kl_reg_loss: 6487.1655; val_edge_recon_loss: 257598.9048; val_gene_expr_recon_loss: 108282.4487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372368.5187; val_optim_loss: 372368.5187
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9990; val_auprc_score: 0.9989; val_best_acc_score: 0.9886; val_best_f1_score: 0.9886; train_kl_reg_loss: 6507.1756; train_edge_recon_loss: 258012.6277; train_gene_expr_recon_loss: 108129.3429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372649.1460; train_optim_loss: 372649.1460; val_kl_reg_loss: 6487.7914; val_edge_recon_loss: 257534.1029; val_gene_expr_recon_loss: 108245.3842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372267.2783; val_optim_loss: 372267.2783
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9990; val_auprc_score: 0.9987; val_best_acc_score: 0.9884; val_best_f1_score: 0.9884; train_kl_reg_loss: 6506.9844; train_edge_recon_loss: 258001.6414; train_gene_expr_recon_loss: 108118.6859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372627.3118; train_optim_loss: 372627.3118; val_kl_reg_loss: 6488.2821; val_edge_recon_loss: 257489.1499; val_gene_expr_recon_loss: 108323.9412; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372301.3728; val_optim_loss: 372301.3728

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1571 min 59 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9989
Val AUPRC score: 0.9987
Val best accuracy score: 0.9881
Val best F1 score: 0.9881
Val gene expr MSE score: 9.0218

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
