None
Run timestamp: 16072023_145113_1002.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_1002']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1818, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1818, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9885; val_auprc_score: 0.9841; val_best_acc_score: 0.9637; val_best_f1_score: 0.9645; train_kl_reg_loss: 12201.2934; train_edge_recon_loss: 2662677.6673; train_gene_expr_recon_loss: 2084139.0214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4759017.9770; train_optim_loss: 4759017.9770; val_kl_reg_loss: 12449.6623; val_edge_recon_loss: 2586993.2213; val_gene_expr_recon_loss: 2013100.5389; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4612543.4180; val_optim_loss: 4612543.4180
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9903; val_auprc_score: 0.9867; val_best_acc_score: 0.9682; val_best_f1_score: 0.9688; train_kl_reg_loss: 12654.0528; train_edge_recon_loss: 2576354.1503; train_gene_expr_recon_loss: 1964651.9605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4553660.1783; train_optim_loss: 4553660.1783; val_kl_reg_loss: 12641.2109; val_edge_recon_loss: 2579635.6762; val_gene_expr_recon_loss: 1947842.5328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4540119.4098; val_optim_loss: 4540119.4098
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9919; val_auprc_score: 0.9893; val_best_acc_score: 0.9712; val_best_f1_score: 0.9717; train_kl_reg_loss: 12842.6746; train_edge_recon_loss: 2570260.7835; train_gene_expr_recon_loss: 1912991.1783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4496094.6333; train_optim_loss: 4496094.6333; val_kl_reg_loss: 13027.3619; val_edge_recon_loss: 2573657.3607; val_gene_expr_recon_loss: 1904233.4713; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4490918.1557; val_optim_loss: 4490918.1557
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9926; val_auprc_score: 0.9901; val_best_acc_score: 0.9734; val_best_f1_score: 0.9738; train_kl_reg_loss: 13019.6260; train_edge_recon_loss: 2566108.5712; train_gene_expr_recon_loss: 1878364.2445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4457492.4485; train_optim_loss: 4457492.4485; val_kl_reg_loss: 12831.8741; val_edge_recon_loss: 2571526.1270; val_gene_expr_recon_loss: 1878022.1803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4462380.1721; val_optim_loss: 4462380.1721
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9939; val_auprc_score: 0.9922; val_best_acc_score: 0.9745; val_best_f1_score: 0.9749; train_kl_reg_loss: 13172.6003; train_edge_recon_loss: 2563726.1452; train_gene_expr_recon_loss: 1853806.0051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4430704.7546; train_optim_loss: 4430704.7546; val_kl_reg_loss: 13483.7274; val_edge_recon_loss: 2567791.7500; val_gene_expr_recon_loss: 1855009.8402; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4436285.3115; val_optim_loss: 4436285.3115
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9936; val_auprc_score: 0.9915; val_best_acc_score: 0.9753; val_best_f1_score: 0.9757; train_kl_reg_loss: 13319.9598; train_edge_recon_loss: 2562507.6186; train_gene_expr_recon_loss: 1832203.9745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4408031.5597; train_optim_loss: 4408031.5597; val_kl_reg_loss: 13102.8231; val_edge_recon_loss: 2567114.9549; val_gene_expr_recon_loss: 1838815.2971; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4419033.0656; val_optim_loss: 4419033.0656
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9944; val_auprc_score: 0.9926; val_best_acc_score: 0.9762; val_best_f1_score: 0.9764; train_kl_reg_loss: 13357.6208; train_edge_recon_loss: 2562511.6117; train_gene_expr_recon_loss: 1814475.5816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4390344.8162; train_optim_loss: 4390344.8162; val_kl_reg_loss: 11947.5180; val_edge_recon_loss: 2565677.9467; val_gene_expr_recon_loss: 1831134.3176; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4408759.7541; val_optim_loss: 4408759.7541
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9946; val_auprc_score: 0.9930; val_best_acc_score: 0.9769; val_best_f1_score: 0.9771; train_kl_reg_loss: 13417.2599; train_edge_recon_loss: 2560030.7468; train_gene_expr_recon_loss: 1799551.0565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4372999.0607; train_optim_loss: 4372999.0607; val_kl_reg_loss: 13338.4577; val_edge_recon_loss: 2565475.1148; val_gene_expr_recon_loss: 1812519.5082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4391333.0738; val_optim_loss: 4391333.0738
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9949; val_auprc_score: 0.9935; val_best_acc_score: 0.9773; val_best_f1_score: 0.9776; train_kl_reg_loss: 13472.2630; train_edge_recon_loss: 2559549.4297; train_gene_expr_recon_loss: 1786812.1358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4359833.8240; train_optim_loss: 4359833.8240; val_kl_reg_loss: 13467.7609; val_edge_recon_loss: 2564738.1434; val_gene_expr_recon_loss: 1807315.2418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4385521.1475; val_optim_loss: 4385521.1475
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9948; val_auprc_score: 0.9932; val_best_acc_score: 0.9770; val_best_f1_score: 0.9774; train_kl_reg_loss: 13526.0027; train_edge_recon_loss: 2558620.7105; train_gene_expr_recon_loss: 1776626.9959; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4348773.7188; train_optim_loss: 4348773.7188; val_kl_reg_loss: 13342.7481; val_edge_recon_loss: 2565630.9590; val_gene_expr_recon_loss: 1797304.5225; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4376278.2131; val_optim_loss: 4376278.2131
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9952; val_auprc_score: 0.9938; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 13584.7591; train_edge_recon_loss: 2558491.6691; train_gene_expr_recon_loss: 1767166.8500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4339243.2826; train_optim_loss: 4339243.2826; val_kl_reg_loss: 13435.1405; val_edge_recon_loss: 2564594.6230; val_gene_expr_recon_loss: 1800416.3320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4378446.0902; val_optim_loss: 4378446.0902
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9959; val_auprc_score: 0.9946; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 13668.5172; train_edge_recon_loss: 2558117.9439; train_gene_expr_recon_loss: 1760501.8201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4332288.2872; train_optim_loss: 4332288.2872; val_kl_reg_loss: 13649.5715; val_edge_recon_loss: 2563411.6311; val_gene_expr_recon_loss: 1791943.4959; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4369004.7049; val_optim_loss: 4369004.7049
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9957; val_auprc_score: 0.9947; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 13709.4525; train_edge_recon_loss: 2558556.7220; train_gene_expr_recon_loss: 1752539.8853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4324806.0662; train_optim_loss: 4324806.0662; val_kl_reg_loss: 13698.2733; val_edge_recon_loss: 2565187.1721; val_gene_expr_recon_loss: 1786786.3094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4365671.7377; val_optim_loss: 4365671.7377
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9956; val_auprc_score: 0.9944; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 13781.3363; train_edge_recon_loss: 2556520.8019; train_gene_expr_recon_loss: 1748743.6181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4319045.7702; train_optim_loss: 4319045.7702; val_kl_reg_loss: 13969.3813; val_edge_recon_loss: 2562432.7951; val_gene_expr_recon_loss: 1787972.6762; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4364374.8607; val_optim_loss: 4364374.8607
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9957; val_auprc_score: 0.9946; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 13825.9917; train_edge_recon_loss: 2556505.3874; train_gene_expr_recon_loss: 1744495.1312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4314826.5041; train_optim_loss: 4314826.5041; val_kl_reg_loss: 13933.7508; val_edge_recon_loss: 2563454.6352; val_gene_expr_recon_loss: 1781689.1148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4359077.5082; val_optim_loss: 4359077.5082
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9952; val_auprc_score: 0.9937; val_best_acc_score: 0.9798; val_best_f1_score: 0.9801; train_kl_reg_loss: 13861.9958; train_edge_recon_loss: 2555977.2073; train_gene_expr_recon_loss: 1740442.8610; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4310282.0634; train_optim_loss: 4310282.0634; val_kl_reg_loss: 13903.3813; val_edge_recon_loss: 2563435.1885; val_gene_expr_recon_loss: 1783475.9549; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4360814.5164; val_optim_loss: 4360814.5164
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9961; val_auprc_score: 0.9949; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 13909.7997; train_edge_recon_loss: 2555909.6599; train_gene_expr_recon_loss: 1737899.7780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4307719.2495; train_optim_loss: 4307719.2495; val_kl_reg_loss: 13766.1271; val_edge_recon_loss: 2560639.1926; val_gene_expr_recon_loss: 1783019.6906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4357424.9836; val_optim_loss: 4357424.9836
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9960; val_auprc_score: 0.9950; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 13937.3221; train_edge_recon_loss: 2556015.3428; train_gene_expr_recon_loss: 1735159.0756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4305111.7302; train_optim_loss: 4305111.7302; val_kl_reg_loss: 13927.5928; val_edge_recon_loss: 2563072.8197; val_gene_expr_recon_loss: 1785576.5225; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4362576.9426; val_optim_loss: 4362576.9426
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9958; val_auprc_score: 0.9945; val_best_acc_score: 0.9810; val_best_f1_score: 0.9813; train_kl_reg_loss: 13984.6230; train_edge_recon_loss: 2555676.1278; train_gene_expr_recon_loss: 1731977.4685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4301638.2123; train_optim_loss: 4301638.2123; val_kl_reg_loss: 13760.4767; val_edge_recon_loss: 2561529.4221; val_gene_expr_recon_loss: 1782145.9406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4357435.8361; val_optim_loss: 4357435.8361
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9962; val_auprc_score: 0.9953; val_best_acc_score: 0.9815; val_best_f1_score: 0.9818; train_kl_reg_loss: 14005.5596; train_edge_recon_loss: 2555166.7652; train_gene_expr_recon_loss: 1730568.6257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4299740.9605; train_optim_loss: 4299740.9605; val_kl_reg_loss: 13977.4939; val_edge_recon_loss: 2561399.6230; val_gene_expr_recon_loss: 1782645.1230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4358022.2459; val_optim_loss: 4358022.2459
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9820; val_best_f1_score: 0.9823; train_kl_reg_loss: 14035.3647; train_edge_recon_loss: 2554475.4789; train_gene_expr_recon_loss: 1728478.8012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4296989.6438; train_optim_loss: 4296989.6438; val_kl_reg_loss: 13962.2830; val_edge_recon_loss: 2561177.2213; val_gene_expr_recon_loss: 1783732.1803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4358871.7213; val_optim_loss: 4358871.7213

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9962; val_auprc_score: 0.9951; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 14388.2859; train_edge_recon_loss: 2552440.4637; train_gene_expr_recon_loss: 1704200.6549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4271029.4072; train_optim_loss: 4271029.4072; val_kl_reg_loss: 14163.4917; val_edge_recon_loss: 2556526.0451; val_gene_expr_recon_loss: 1768954.7316; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4339644.2377; val_optim_loss: 4339644.2377
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9962; val_auprc_score: 0.9952; val_best_acc_score: 0.9807; val_best_f1_score: 0.9810; train_kl_reg_loss: 14196.2771; train_edge_recon_loss: 2551878.6857; train_gene_expr_recon_loss: 1700591.8955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4266666.8424; train_optim_loss: 4266666.8424; val_kl_reg_loss: 14068.3983; val_edge_recon_loss: 2556391.6598; val_gene_expr_recon_loss: 1771025.9139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4341485.9754; val_optim_loss: 4341485.9754
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9961; val_auprc_score: 0.9952; val_best_acc_score: 0.9809; val_best_f1_score: 0.9812; train_kl_reg_loss: 14136.2944; train_edge_recon_loss: 2550647.0915; train_gene_expr_recon_loss: 1699953.3883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4264736.7730; train_optim_loss: 4264736.7730; val_kl_reg_loss: 14028.2343; val_edge_recon_loss: 2553584.2623; val_gene_expr_recon_loss: 1770509.8566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4338122.3443; val_optim_loss: 4338122.3443
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9957; val_auprc_score: 0.9942; val_best_acc_score: 0.9805; val_best_f1_score: 0.9808; train_kl_reg_loss: 14134.7200; train_edge_recon_loss: 2550111.7633; train_gene_expr_recon_loss: 1698465.7318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4262712.2183; train_optim_loss: 4262712.2183; val_kl_reg_loss: 14044.5034; val_edge_recon_loss: 2555319.9016; val_gene_expr_recon_loss: 1773391.8545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4342756.2705; val_optim_loss: 4342756.2705
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9961; val_auprc_score: 0.9951; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 14133.4168; train_edge_recon_loss: 2550641.4761; train_gene_expr_recon_loss: 1699221.6916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4263996.5726; train_optim_loss: 4263996.5726; val_kl_reg_loss: 14010.0188; val_edge_recon_loss: 2552594.7500; val_gene_expr_recon_loss: 1774178.3607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4340783.0902; val_optim_loss: 4340783.0902
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9959; val_auprc_score: 0.9947; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 14141.5907; train_edge_recon_loss: 2549899.6999; train_gene_expr_recon_loss: 1698384.4938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4262425.7858; train_optim_loss: 4262425.7858; val_kl_reg_loss: 14032.0078; val_edge_recon_loss: 2552592.2213; val_gene_expr_recon_loss: 1776124.7090; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4342748.9098; val_optim_loss: 4342748.9098
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9962; val_auprc_score: 0.9950; val_best_acc_score: 0.9813; val_best_f1_score: 0.9815; train_kl_reg_loss: 14161.6607; train_edge_recon_loss: 2549376.5322; train_gene_expr_recon_loss: 1696262.6140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4259800.8001; train_optim_loss: 4259800.8001; val_kl_reg_loss: 14033.9565; val_edge_recon_loss: 2553097.3361; val_gene_expr_recon_loss: 1773341.9754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4340473.2951; val_optim_loss: 4340473.2951

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9959; val_auprc_score: 0.9946; val_best_acc_score: 0.9806; val_best_f1_score: 0.9809; train_kl_reg_loss: 14222.4539; train_edge_recon_loss: 2548621.4320; train_gene_expr_recon_loss: 1693284.3621; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4256128.2523; train_optim_loss: 4256128.2523; val_kl_reg_loss: 14103.4637; val_edge_recon_loss: 2554776.8730; val_gene_expr_recon_loss: 1771807.3340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4340687.6803; val_optim_loss: 4340687.6803
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9959; val_auprc_score: 0.9948; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 14246.7542; train_edge_recon_loss: 2548836.8433; train_gene_expr_recon_loss: 1692960.0912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4256043.6893; train_optim_loss: 4256043.6893; val_kl_reg_loss: 14109.0286; val_edge_recon_loss: 2554631.8770; val_gene_expr_recon_loss: 1770255.3730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4338996.2869; val_optim_loss: 4338996.2869
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9957; val_auprc_score: 0.9945; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 14245.8077; train_edge_recon_loss: 2549925.3722; train_gene_expr_recon_loss: 1692887.9814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4257059.1535; train_optim_loss: 4257059.1535; val_kl_reg_loss: 14093.7383; val_edge_recon_loss: 2555228.7582; val_gene_expr_recon_loss: 1770354.3340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4339676.8689; val_optim_loss: 4339676.8689
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9958; val_auprc_score: 0.9942; val_best_acc_score: 0.9807; val_best_f1_score: 0.9810; train_kl_reg_loss: 14235.9240; train_edge_recon_loss: 2549213.5997; train_gene_expr_recon_loss: 1693022.3950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4256471.9187; train_optim_loss: 4256471.9187; val_kl_reg_loss: 14090.5878; val_edge_recon_loss: 2555181.8033; val_gene_expr_recon_loss: 1772702.3361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4341974.7049; val_optim_loss: 4341974.7049

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 197 min 38 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9959
Val AUPRC score: 0.9947
Val best accuracy score: 0.9804
Val best F1 score: 0.9807
Val gene expr MSE score: 0.4814

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
