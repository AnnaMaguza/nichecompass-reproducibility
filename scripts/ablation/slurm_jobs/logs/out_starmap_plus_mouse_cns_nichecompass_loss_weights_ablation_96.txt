None
Run timestamp: 08082023_220957_96.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_96']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9832; val_auprc_score: 0.9783; val_best_acc_score: 0.9459; val_best_f1_score: 0.9469; train_kl_reg_loss: 73828.0310; train_edge_recon_loss: 2955244.2882; train_gene_expr_recon_loss: 19930414.6954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 22959487.0264; train_optim_loss: 22959487.0264; val_kl_reg_loss: 70643.2022; val_edge_recon_loss: 2698230.1719; val_gene_expr_recon_loss: 18703040.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 21471913.5250; val_optim_loss: 21471913.5250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9876; val_auprc_score: 0.9840; val_best_acc_score: 0.9549; val_best_f1_score: 0.9558; train_kl_reg_loss: 62897.7827; train_edge_recon_loss: 2667257.1888; train_gene_expr_recon_loss: 18097123.3213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 20827278.3032; train_optim_loss: 20827278.3032; val_kl_reg_loss: 55574.3038; val_edge_recon_loss: 2656976.6375; val_gene_expr_recon_loss: 17876977.6750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 20589528.6250; val_optim_loss: 20589528.6250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9890; val_auprc_score: 0.9860; val_best_acc_score: 0.9576; val_best_f1_score: 0.9585; train_kl_reg_loss: 52254.9067; train_edge_recon_loss: 2642094.2994; train_gene_expr_recon_loss: 17484322.2211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 20178671.4465; train_optim_loss: 20178671.4465; val_kl_reg_loss: 48630.1732; val_edge_recon_loss: 2640311.6000; val_gene_expr_recon_loss: 17446404.6750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 20135346.4750; val_optim_loss: 20135346.4750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9905; val_auprc_score: 0.9881; val_best_acc_score: 0.9612; val_best_f1_score: 0.9619; train_kl_reg_loss: 45669.6153; train_edge_recon_loss: 2628993.2935; train_gene_expr_recon_loss: 17144911.2754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19819574.1502; train_optim_loss: 19819574.1502; val_kl_reg_loss: 42968.2204; val_edge_recon_loss: 2625990.2563; val_gene_expr_recon_loss: 17203152.3625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19872110.8000; val_optim_loss: 19872110.8000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9910; val_auprc_score: 0.9886; val_best_acc_score: 0.9623; val_best_f1_score: 0.9630; train_kl_reg_loss: 41368.5773; train_edge_recon_loss: 2619661.6123; train_gene_expr_recon_loss: 16918791.2364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19579821.4381; train_optim_loss: 19579821.4381; val_kl_reg_loss: 39430.7724; val_edge_recon_loss: 2616490.2875; val_gene_expr_recon_loss: 17029566.4625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19685487.5000; val_optim_loss: 19685487.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9915; val_auprc_score: 0.9894; val_best_acc_score: 0.9630; val_best_f1_score: 0.9638; train_kl_reg_loss: 38407.4283; train_edge_recon_loss: 2612098.6248; train_gene_expr_recon_loss: 16782263.6092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19432769.6495; train_optim_loss: 19432769.6495; val_kl_reg_loss: 37284.0889; val_edge_recon_loss: 2614241.9813; val_gene_expr_recon_loss: 16875816.6625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19527342.7750; val_optim_loss: 19527342.7750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9915; val_auprc_score: 0.9895; val_best_acc_score: 0.9641; val_best_f1_score: 0.9648; train_kl_reg_loss: 36182.4589; train_edge_recon_loss: 2606876.7375; train_gene_expr_recon_loss: 16671375.9402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19314435.1488; train_optim_loss: 19314435.1488; val_kl_reg_loss: 34889.1512; val_edge_recon_loss: 2611194.9438; val_gene_expr_recon_loss: 16827264.5250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19473348.5500; val_optim_loss: 19473348.5500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9921; val_auprc_score: 0.9902; val_best_acc_score: 0.9662; val_best_f1_score: 0.9668; train_kl_reg_loss: 34383.8177; train_edge_recon_loss: 2603870.0494; train_gene_expr_recon_loss: 16579920.1029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19218173.9638; train_optim_loss: 19218173.9638; val_kl_reg_loss: 33492.7839; val_edge_recon_loss: 2604653.1344; val_gene_expr_recon_loss: 16796939.9625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19435085.9500; val_optim_loss: 19435085.9500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9923; val_auprc_score: 0.9906; val_best_acc_score: 0.9661; val_best_f1_score: 0.9668; train_kl_reg_loss: 33141.5253; train_edge_recon_loss: 2600844.2295; train_gene_expr_recon_loss: 16518342.6245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19152328.3366; train_optim_loss: 19152328.3366; val_kl_reg_loss: 32626.1464; val_edge_recon_loss: 2606325.5719; val_gene_expr_recon_loss: 16799749.9250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19438701.7000; val_optim_loss: 19438701.7000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9926; val_auprc_score: 0.9909; val_best_acc_score: 0.9673; val_best_f1_score: 0.9678; train_kl_reg_loss: 32096.5125; train_edge_recon_loss: 2598443.0428; train_gene_expr_recon_loss: 16464389.9416; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19094929.5049; train_optim_loss: 19094929.5049; val_kl_reg_loss: 31615.0918; val_edge_recon_loss: 2603911.8125; val_gene_expr_recon_loss: 16743754.5375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19379281.3750; val_optim_loss: 19379281.3750
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9930; val_auprc_score: 0.9918; val_best_acc_score: 0.9672; val_best_f1_score: 0.9678; train_kl_reg_loss: 31253.6288; train_edge_recon_loss: 2597561.3863; train_gene_expr_recon_loss: 16410234.4312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19039049.4604; train_optim_loss: 19039049.4604; val_kl_reg_loss: 30725.3795; val_edge_recon_loss: 2601030.4875; val_gene_expr_recon_loss: 16720740.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19352496.0500; val_optim_loss: 19352496.0500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9932; val_auprc_score: 0.9917; val_best_acc_score: 0.9687; val_best_f1_score: 0.9693; train_kl_reg_loss: 30608.5719; train_edge_recon_loss: 2595238.0348; train_gene_expr_recon_loss: 16377465.2142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19003311.7886; train_optim_loss: 19003311.7886; val_kl_reg_loss: 30655.0069; val_edge_recon_loss: 2597947.7781; val_gene_expr_recon_loss: 16690595.0500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19319197.8750; val_optim_loss: 19319197.8750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9930; val_auprc_score: 0.9914; val_best_acc_score: 0.9685; val_best_f1_score: 0.9690; train_kl_reg_loss: 30077.6924; train_edge_recon_loss: 2594026.0021; train_gene_expr_recon_loss: 16365311.4312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18989415.1266; train_optim_loss: 18989415.1266; val_kl_reg_loss: 29758.9035; val_edge_recon_loss: 2600942.6562; val_gene_expr_recon_loss: 16692680.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19323382.0000; val_optim_loss: 19323382.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9936; val_auprc_score: 0.9924; val_best_acc_score: 0.9688; val_best_f1_score: 0.9692; train_kl_reg_loss: 29552.5282; train_edge_recon_loss: 2593643.7917; train_gene_expr_recon_loss: 16316975.7566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18940172.0501; train_optim_loss: 18940172.0501; val_kl_reg_loss: 29258.1950; val_edge_recon_loss: 2598450.0562; val_gene_expr_recon_loss: 16691937.8250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19319646.1500; val_optim_loss: 19319646.1500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9931; val_auprc_score: 0.9916; val_best_acc_score: 0.9685; val_best_f1_score: 0.9690; train_kl_reg_loss: 29131.0553; train_edge_recon_loss: 2592199.3223; train_gene_expr_recon_loss: 16301723.0807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18923053.4687; train_optim_loss: 18923053.4687; val_kl_reg_loss: 29101.8577; val_edge_recon_loss: 2598136.3000; val_gene_expr_recon_loss: 16695564.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19322802.2250; val_optim_loss: 19322802.2250
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9937; val_auprc_score: 0.9923; val_best_acc_score: 0.9695; val_best_f1_score: 0.9700; train_kl_reg_loss: 28801.3613; train_edge_recon_loss: 2591804.3599; train_gene_expr_recon_loss: 16280301.6287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18900907.3352; train_optim_loss: 18900907.3352; val_kl_reg_loss: 28596.4114; val_edge_recon_loss: 2595871.2375; val_gene_expr_recon_loss: 16704007.6500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19328475.4250; val_optim_loss: 19328475.4250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9937; val_auprc_score: 0.9925; val_best_acc_score: 0.9701; val_best_f1_score: 0.9706; train_kl_reg_loss: 29516.5895; train_edge_recon_loss: 2588531.6919; train_gene_expr_recon_loss: 16203781.7079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18821829.9777; train_optim_loss: 18821829.9777; val_kl_reg_loss: 29246.8891; val_edge_recon_loss: 2591502.2656; val_gene_expr_recon_loss: 16669618.3875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19290367.5000; val_optim_loss: 19290367.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9938; val_auprc_score: 0.9927; val_best_acc_score: 0.9702; val_best_f1_score: 0.9706; train_kl_reg_loss: 29559.0128; train_edge_recon_loss: 2587896.7792; train_gene_expr_recon_loss: 16185065.8581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18802521.6300; train_optim_loss: 18802521.6300; val_kl_reg_loss: 29357.3884; val_edge_recon_loss: 2591868.4531; val_gene_expr_recon_loss: 16694367.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19315593.2000; val_optim_loss: 19315593.2000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9939; val_auprc_score: 0.9925; val_best_acc_score: 0.9703; val_best_f1_score: 0.9708; train_kl_reg_loss: 29583.0071; train_edge_recon_loss: 2587060.0261; train_gene_expr_recon_loss: 16184811.0960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18801454.1252; train_optim_loss: 18801454.1252; val_kl_reg_loss: 29291.0824; val_edge_recon_loss: 2592734.5125; val_gene_expr_recon_loss: 16658648.7625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19280674.3750; val_optim_loss: 19280674.3750
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9940; val_auprc_score: 0.9927; val_best_acc_score: 0.9703; val_best_f1_score: 0.9708; train_kl_reg_loss: 29612.1045; train_edge_recon_loss: 2586911.7938; train_gene_expr_recon_loss: 16180127.4325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18796651.3268; train_optim_loss: 18796651.3268; val_kl_reg_loss: 29372.8892; val_edge_recon_loss: 2590607.0125; val_gene_expr_recon_loss: 16680036.7625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19300016.7750; val_optim_loss: 19300016.7750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9938; val_auprc_score: 0.9925; val_best_acc_score: 0.9700; val_best_f1_score: 0.9704; train_kl_reg_loss: 29584.8083; train_edge_recon_loss: 2587420.7062; train_gene_expr_recon_loss: 16180859.8206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18797865.2768; train_optim_loss: 18797865.2768; val_kl_reg_loss: 29258.4765; val_edge_recon_loss: 2590504.5781; val_gene_expr_recon_loss: 16669090.2375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19288853.4750; val_optim_loss: 19288853.4750
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9941; val_auprc_score: 0.9931; val_best_acc_score: 0.9705; val_best_f1_score: 0.9710; train_kl_reg_loss: 29516.8820; train_edge_recon_loss: 2587198.0483; train_gene_expr_recon_loss: 16173440.1794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18790155.0987; train_optim_loss: 18790155.0987; val_kl_reg_loss: 29293.2943; val_edge_recon_loss: 2589351.3844; val_gene_expr_recon_loss: 16692941.9750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19311586.7750; val_optim_loss: 19311586.7750
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9939; val_auprc_score: 0.9925; val_best_acc_score: 0.9700; val_best_f1_score: 0.9704; train_kl_reg_loss: 29456.2754; train_edge_recon_loss: 2586552.3846; train_gene_expr_recon_loss: 16175415.0362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18791423.6940; train_optim_loss: 18791423.6940; val_kl_reg_loss: 29267.2504; val_edge_recon_loss: 2591342.0938; val_gene_expr_recon_loss: 16677638.1500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19298247.5250; val_optim_loss: 19298247.5250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9938; val_auprc_score: 0.9927; val_best_acc_score: 0.9706; val_best_f1_score: 0.9710; train_kl_reg_loss: 29501.0729; train_edge_recon_loss: 2586497.0247; train_gene_expr_recon_loss: 16166165.7260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18782163.8303; train_optim_loss: 18782163.8303; val_kl_reg_loss: 29251.5647; val_edge_recon_loss: 2591042.4625; val_gene_expr_recon_loss: 16706797.7125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19327091.8000; val_optim_loss: 19327091.8000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9938; val_auprc_score: 0.9927; val_best_acc_score: 0.9697; val_best_f1_score: 0.9702; train_kl_reg_loss: 29516.2071; train_edge_recon_loss: 2585803.4259; train_gene_expr_recon_loss: 16152274.7872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18767594.3811; train_optim_loss: 18767594.3811; val_kl_reg_loss: 29256.4974; val_edge_recon_loss: 2593009.6562; val_gene_expr_recon_loss: 16673608.5875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19295874.6750; val_optim_loss: 19295874.6750
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9937; val_auprc_score: 0.9924; val_best_acc_score: 0.9701; val_best_f1_score: 0.9706; train_kl_reg_loss: 29517.9985; train_edge_recon_loss: 2586149.6683; train_gene_expr_recon_loss: 16155081.2072; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18770748.9179; train_optim_loss: 18770748.9179; val_kl_reg_loss: 29252.0710; val_edge_recon_loss: 2593090.8813; val_gene_expr_recon_loss: 16663095.9000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19285438.8000; val_optim_loss: 19285438.8000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9935; val_auprc_score: 0.9923; val_best_acc_score: 0.9697; val_best_f1_score: 0.9702; train_kl_reg_loss: 29510.4105; train_edge_recon_loss: 2586952.4864; train_gene_expr_recon_loss: 16149848.0473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18766310.9624; train_optim_loss: 18766310.9624; val_kl_reg_loss: 29228.3539; val_edge_recon_loss: 2593875.9156; val_gene_expr_recon_loss: 16682845.4625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19305949.8500; val_optim_loss: 19305949.8500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 141 min 27 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
val AUROC score: 0.9938
val AUPRC score: 0.9926
val best accuracy score: 0.9699
val best F1 score: 0.9704
val target rna MSE score: 0.6110
val source rna MSE score: 0.0288

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
