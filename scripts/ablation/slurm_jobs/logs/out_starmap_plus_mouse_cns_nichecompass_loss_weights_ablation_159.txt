None
Run timestamp: 15072023_113711_159.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_159']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9812; val_auprc_score: 0.9748; val_best_acc_score: 0.9442; val_best_f1_score: 0.9456; train_kl_reg_loss: 92046.7696; train_edge_recon_loss: 26964384.6581; train_gene_expr_recon_loss: 11889538.1838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38945969.5441; train_optim_loss: 38945969.5441; val_kl_reg_loss: 114563.5742; val_edge_recon_loss: 26197424.0656; val_gene_expr_recon_loss: 10816142.5246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37128129.9672; val_optim_loss: 37128129.9672
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9831; val_auprc_score: 0.9778; val_best_acc_score: 0.9466; val_best_f1_score: 0.9481; train_kl_reg_loss: 110609.3130; train_edge_recon_loss: 26041424.5956; train_gene_expr_recon_loss: 10637300.1710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36789334.0809; train_optim_loss: 36789334.0809; val_kl_reg_loss: 104338.4937; val_edge_recon_loss: 26049139.2787; val_gene_expr_recon_loss: 10367394.3279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36520872.4590; val_optim_loss: 36520872.4590
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9858; val_auprc_score: 0.9811; val_best_acc_score: 0.9538; val_best_f1_score: 0.9548; train_kl_reg_loss: 97015.2667; train_edge_recon_loss: 25942578.9081; train_gene_expr_recon_loss: 10303705.1305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36343299.3088; train_optim_loss: 36343299.3088; val_kl_reg_loss: 88880.4393; val_edge_recon_loss: 25942630.8525; val_gene_expr_recon_loss: 10128361.7705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36159873.0492; val_optim_loss: 36159873.0492
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9875; val_auprc_score: 0.9833; val_best_acc_score: 0.9581; val_best_f1_score: 0.9590; train_kl_reg_loss: 86933.8022; train_edge_recon_loss: 25848874.7904; train_gene_expr_recon_loss: 10117165.9467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36052974.5221; train_optim_loss: 36052974.5221; val_kl_reg_loss: 82129.6346; val_edge_recon_loss: 25871821.5738; val_gene_expr_recon_loss: 9956913.3607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35910864.7213; val_optim_loss: 35910864.7213
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9886; val_auprc_score: 0.9848; val_best_acc_score: 0.9602; val_best_f1_score: 0.9611; train_kl_reg_loss: 83205.9740; train_edge_recon_loss: 25795414.7647; train_gene_expr_recon_loss: 9969162.9770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35847783.7279; train_optim_loss: 35847783.7279; val_kl_reg_loss: 79377.2845; val_edge_recon_loss: 25821480.2951; val_gene_expr_recon_loss: 9857545.6230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35758403.0164; val_optim_loss: 35758403.0164
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9899; val_auprc_score: 0.9867; val_best_acc_score: 0.9644; val_best_f1_score: 0.9650; train_kl_reg_loss: 77270.9545; train_edge_recon_loss: 25765390.6875; train_gene_expr_recon_loss: 9875437.1544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35718098.8162; train_optim_loss: 35718098.8162; val_kl_reg_loss: 72188.1659; val_edge_recon_loss: 25780887.0820; val_gene_expr_recon_loss: 9788620.9344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35641696.1967; val_optim_loss: 35641696.1967
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9908; val_auprc_score: 0.9880; val_best_acc_score: 0.9646; val_best_f1_score: 0.9654; train_kl_reg_loss: 72861.4831; train_edge_recon_loss: 25734329.7169; train_gene_expr_recon_loss: 9807809.6268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35615000.7794; train_optim_loss: 35615000.7794; val_kl_reg_loss: 68171.0914; val_edge_recon_loss: 25718120.4918; val_gene_expr_recon_loss: 9753251.4754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35539542.8852; val_optim_loss: 35539542.8852
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9913; val_auprc_score: 0.9885; val_best_acc_score: 0.9668; val_best_f1_score: 0.9673; train_kl_reg_loss: 69255.8092; train_edge_recon_loss: 25685685.4596; train_gene_expr_recon_loss: 9751946.7031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35506888.0662; train_optim_loss: 35506888.0662; val_kl_reg_loss: 66732.6303; val_edge_recon_loss: 25718136.5574; val_gene_expr_recon_loss: 9692965.4590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35477834.7541; val_optim_loss: 35477834.7541
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9919; val_auprc_score: 0.9895; val_best_acc_score: 0.9683; val_best_f1_score: 0.9688; train_kl_reg_loss: 65778.4606; train_edge_recon_loss: 25679520.0588; train_gene_expr_recon_loss: 9701222.9632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35446521.4265; train_optim_loss: 35446521.4265; val_kl_reg_loss: 63623.1869; val_edge_recon_loss: 25722649.0820; val_gene_expr_recon_loss: 9697372.5738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35483644.6557; val_optim_loss: 35483644.6557
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9908; val_auprc_score: 0.9880; val_best_acc_score: 0.9670; val_best_f1_score: 0.9677; train_kl_reg_loss: 63413.3965; train_edge_recon_loss: 25674441.1581; train_gene_expr_recon_loss: 9682371.0331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35420225.6250; train_optim_loss: 35420225.6250; val_kl_reg_loss: 57265.2337; val_edge_recon_loss: 25826610.5902; val_gene_expr_recon_loss: 9723757.0164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35607632.7869; val_optim_loss: 35607632.7869
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9922; val_auprc_score: 0.9896; val_best_acc_score: 0.9702; val_best_f1_score: 0.9708; train_kl_reg_loss: 60767.4652; train_edge_recon_loss: 25649125.6875; train_gene_expr_recon_loss: 9652171.4476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35362064.6140; train_optim_loss: 35362064.6140; val_kl_reg_loss: 59356.8379; val_edge_recon_loss: 25680427.0164; val_gene_expr_recon_loss: 9643769.1311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35383552.9836; val_optim_loss: 35383552.9836
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9922; val_auprc_score: 0.9896; val_best_acc_score: 0.9711; val_best_f1_score: 0.9716; train_kl_reg_loss: 59330.3639; train_edge_recon_loss: 25635039.4596; train_gene_expr_recon_loss: 9608847.1581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35303216.9485; train_optim_loss: 35303216.9485; val_kl_reg_loss: 57366.3947; val_edge_recon_loss: 25652506.8197; val_gene_expr_recon_loss: 9616091.0656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35325964.2623; val_optim_loss: 35325964.2623
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9926; val_auprc_score: 0.9902; val_best_acc_score: 0.9722; val_best_f1_score: 0.9726; train_kl_reg_loss: 57420.8297; train_edge_recon_loss: 25621028.1875; train_gene_expr_recon_loss: 9581026.7178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35259475.7500; train_optim_loss: 35259475.7500; val_kl_reg_loss: 55402.4487; val_edge_recon_loss: 25644327.7705; val_gene_expr_recon_loss: 9635475.0656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35335204.9836; val_optim_loss: 35335204.9836
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9928; val_auprc_score: 0.9901; val_best_acc_score: 0.9720; val_best_f1_score: 0.9725; train_kl_reg_loss: 56279.9997; train_edge_recon_loss: 25613034.0625; train_gene_expr_recon_loss: 9555184.6066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35224498.6066; train_optim_loss: 35224498.6066; val_kl_reg_loss: 55500.1956; val_edge_recon_loss: 25637753.5410; val_gene_expr_recon_loss: 9589728.1311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35282981.8361; val_optim_loss: 35282981.8361
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9930; val_auprc_score: 0.9905; val_best_acc_score: 0.9726; val_best_f1_score: 0.9730; train_kl_reg_loss: 55357.7889; train_edge_recon_loss: 25595966.5147; train_gene_expr_recon_loss: 9530082.9669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35181407.1691; train_optim_loss: 35181407.1691; val_kl_reg_loss: 53550.9077; val_edge_recon_loss: 25622432.3607; val_gene_expr_recon_loss: 9558580.4426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35234563.5410; val_optim_loss: 35234563.5410
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9933; val_auprc_score: 0.9908; val_best_acc_score: 0.9741; val_best_f1_score: 0.9745; train_kl_reg_loss: 54050.8851; train_edge_recon_loss: 25595509.9154; train_gene_expr_recon_loss: 9515384.0680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35164944.8897; train_optim_loss: 35164944.8897; val_kl_reg_loss: 53089.9007; val_edge_recon_loss: 25630437.8361; val_gene_expr_recon_loss: 9594489.7377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35278017.4426; val_optim_loss: 35278017.4426
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9930; val_auprc_score: 0.9905; val_best_acc_score: 0.9737; val_best_f1_score: 0.9740; train_kl_reg_loss: 53102.1275; train_edge_recon_loss: 25582292.6066; train_gene_expr_recon_loss: 9503975.8695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35139370.5882; train_optim_loss: 35139370.5882; val_kl_reg_loss: 51162.6521; val_edge_recon_loss: 25627503.1475; val_gene_expr_recon_loss: 9576042.9508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35254708.9180; val_optim_loss: 35254708.9180
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9935; val_auprc_score: 0.9913; val_best_acc_score: 0.9748; val_best_f1_score: 0.9752; train_kl_reg_loss: 52212.3907; train_edge_recon_loss: 25564990.8750; train_gene_expr_recon_loss: 9472720.8401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35089924.0588; train_optim_loss: 35089924.0588; val_kl_reg_loss: 50996.2146; val_edge_recon_loss: 25607682.8197; val_gene_expr_recon_loss: 9560639.9836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35219319.1475; val_optim_loss: 35219319.1475
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9941; val_auprc_score: 0.9921; val_best_acc_score: 0.9754; val_best_f1_score: 0.9757; train_kl_reg_loss: 51809.9847; train_edge_recon_loss: 25564330.9963; train_gene_expr_recon_loss: 9455206.2022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35071347.1691; train_optim_loss: 35071347.1691; val_kl_reg_loss: 50566.0571; val_edge_recon_loss: 25609240.7869; val_gene_expr_recon_loss: 9597042.8525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35256849.7705; val_optim_loss: 35256849.7705
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9943; val_auprc_score: 0.9925; val_best_acc_score: 0.9758; val_best_f1_score: 0.9761; train_kl_reg_loss: 51355.3532; train_edge_recon_loss: 25566383.5515; train_gene_expr_recon_loss: 9442227.7904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35059966.6985; train_optim_loss: 35059966.6985; val_kl_reg_loss: 50175.8082; val_edge_recon_loss: 25631607.7377; val_gene_expr_recon_loss: 9581732.4098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35263516.0000; val_optim_loss: 35263516.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9942; val_auprc_score: 0.9926; val_best_acc_score: 0.9763; val_best_f1_score: 0.9766; train_kl_reg_loss: 50858.1056; train_edge_recon_loss: 25564844.0331; train_gene_expr_recon_loss: 9428808.1305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35044510.2721; train_optim_loss: 35044510.2721; val_kl_reg_loss: 50214.9189; val_edge_recon_loss: 25602313.8689; val_gene_expr_recon_loss: 9581162.9344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35233691.8033; val_optim_loss: 35233691.8033
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9944; val_auprc_score: 0.9928; val_best_acc_score: 0.9770; val_best_f1_score: 0.9773; train_kl_reg_loss: 50097.8134; train_edge_recon_loss: 25567499.5662; train_gene_expr_recon_loss: 9409278.6140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35026876.0515; train_optim_loss: 35026876.0515; val_kl_reg_loss: 49441.8043; val_edge_recon_loss: 25615817.2459; val_gene_expr_recon_loss: 9590482.3279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35255741.6393; val_optim_loss: 35255741.6393

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9943; val_auprc_score: 0.9925; val_best_acc_score: 0.9764; val_best_f1_score: 0.9768; train_kl_reg_loss: 52375.0538; train_edge_recon_loss: 25547924.9963; train_gene_expr_recon_loss: 9323436.5551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34923736.6176; train_optim_loss: 34923736.6176; val_kl_reg_loss: 53061.1574; val_edge_recon_loss: 25602423.5082; val_gene_expr_recon_loss: 9522581.0656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35178065.8361; val_optim_loss: 35178065.8361
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9943; val_auprc_score: 0.9924; val_best_acc_score: 0.9775; val_best_f1_score: 0.9778; train_kl_reg_loss: 54396.1201; train_edge_recon_loss: 25543478.6434; train_gene_expr_recon_loss: 9316313.3824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34914188.1985; train_optim_loss: 34914188.1985; val_kl_reg_loss: 53955.4474; val_edge_recon_loss: 25583785.0820; val_gene_expr_recon_loss: 9534454.3934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35172194.6885; val_optim_loss: 35172194.6885
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9945; val_auprc_score: 0.9929; val_best_acc_score: 0.9773; val_best_f1_score: 0.9777; train_kl_reg_loss: 54761.3447; train_edge_recon_loss: 25544521.6250; train_gene_expr_recon_loss: 9306669.8925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34905952.8088; train_optim_loss: 34905952.8088; val_kl_reg_loss: 54263.2428; val_edge_recon_loss: 25567686.9180; val_gene_expr_recon_loss: 9556280.8525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35178230.6230; val_optim_loss: 35178230.6230
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9944; val_auprc_score: 0.9927; val_best_acc_score: 0.9766; val_best_f1_score: 0.9770; train_kl_reg_loss: 55026.9609; train_edge_recon_loss: 25536708.7169; train_gene_expr_recon_loss: 9311624.6287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34903360.3015; train_optim_loss: 34903360.3015; val_kl_reg_loss: 54456.4331; val_edge_recon_loss: 25584051.3770; val_gene_expr_recon_loss: 9592886.5574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35231394.3607; val_optim_loss: 35231394.3607
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9948; val_auprc_score: 0.9931; val_best_acc_score: 0.9772; val_best_f1_score: 0.9775; train_kl_reg_loss: 55259.7563; train_edge_recon_loss: 25533431.3971; train_gene_expr_recon_loss: 9300458.1746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34889149.2941; train_optim_loss: 34889149.2941; val_kl_reg_loss: 54743.6707; val_edge_recon_loss: 25579678.1967; val_gene_expr_recon_loss: 9531863.4918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35166285.3115; val_optim_loss: 35166285.3115
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9946; val_auprc_score: 0.9928; val_best_acc_score: 0.9770; val_best_f1_score: 0.9773; train_kl_reg_loss: 55465.1560; train_edge_recon_loss: 25545627.5331; train_gene_expr_recon_loss: 9304871.4816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34905964.2059; train_optim_loss: 34905964.2059; val_kl_reg_loss: 54885.6545; val_edge_recon_loss: 25580143.4426; val_gene_expr_recon_loss: 9540721.4918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35175750.6230; val_optim_loss: 35175750.6230
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9948; val_auprc_score: 0.9934; val_best_acc_score: 0.9767; val_best_f1_score: 0.9771; train_kl_reg_loss: 55464.5047; train_edge_recon_loss: 25540864.8640; train_gene_expr_recon_loss: 9297700.2316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34894029.6507; train_optim_loss: 34894029.6507; val_kl_reg_loss: 54710.6641; val_edge_recon_loss: 25570223.0164; val_gene_expr_recon_loss: 9523602.2459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35148535.6721; val_optim_loss: 35148535.6721
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9944; val_auprc_score: 0.9928; val_best_acc_score: 0.9763; val_best_f1_score: 0.9766; train_kl_reg_loss: 55445.4164; train_edge_recon_loss: 25541717.5993; train_gene_expr_recon_loss: 9291281.4265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34888444.4265; train_optim_loss: 34888444.4265; val_kl_reg_loss: 54867.9730; val_edge_recon_loss: 25618141.7705; val_gene_expr_recon_loss: 9540881.5082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35213891.1475; val_optim_loss: 35213891.1475
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9946; val_auprc_score: 0.9927; val_best_acc_score: 0.9772; val_best_f1_score: 0.9775; train_kl_reg_loss: 55524.4854; train_edge_recon_loss: 25532855.0221; train_gene_expr_recon_loss: 9298306.3768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34886685.8750; train_optim_loss: 34886685.8750; val_kl_reg_loss: 54405.1878; val_edge_recon_loss: 25589486.5246; val_gene_expr_recon_loss: 9539380.6721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35183272.3279; val_optim_loss: 35183272.3279
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9946; val_auprc_score: 0.9929; val_best_acc_score: 0.9773; val_best_f1_score: 0.9777; train_kl_reg_loss: 55403.3208; train_edge_recon_loss: 25529845.8162; train_gene_expr_recon_loss: 9281033.1287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34866282.2941; train_optim_loss: 34866282.2941; val_kl_reg_loss: 54605.6215; val_edge_recon_loss: 25584742.4590; val_gene_expr_recon_loss: 9560023.6885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35199371.5410; val_optim_loss: 35199371.5410
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9946; val_auprc_score: 0.9929; val_best_acc_score: 0.9777; val_best_f1_score: 0.9780; train_kl_reg_loss: 55586.7252; train_edge_recon_loss: 25538570.1985; train_gene_expr_recon_loss: 9291018.7390; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34885175.6691; train_optim_loss: 34885175.6691; val_kl_reg_loss: 54933.0099; val_edge_recon_loss: 25579421.6393; val_gene_expr_recon_loss: 9550202.4590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35184557.1148; val_optim_loss: 35184557.1148

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9946; val_auprc_score: 0.9927; val_best_acc_score: 0.9770; val_best_f1_score: 0.9774; train_kl_reg_loss: 55788.3569; train_edge_recon_loss: 25535858.9890; train_gene_expr_recon_loss: 9276337.8493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34867985.1691; train_optim_loss: 34867985.1691; val_kl_reg_loss: 54979.1235; val_edge_recon_loss: 25598791.6721; val_gene_expr_recon_loss: 9553256.3934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35207027.2787; val_optim_loss: 35207027.2787
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9946; val_auprc_score: 0.9930; val_best_acc_score: 0.9776; val_best_f1_score: 0.9779; train_kl_reg_loss: 55784.7997; train_edge_recon_loss: 25535435.9485; train_gene_expr_recon_loss: 9273652.9476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34864873.6618; train_optim_loss: 34864873.6618; val_kl_reg_loss: 55013.5717; val_edge_recon_loss: 25555232.1967; val_gene_expr_recon_loss: 9539289.8033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35149535.8033; val_optim_loss: 35149535.8033
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9945; val_auprc_score: 0.9928; val_best_acc_score: 0.9776; val_best_f1_score: 0.9779; train_kl_reg_loss: 55862.3389; train_edge_recon_loss: 25534908.7316; train_gene_expr_recon_loss: 9275128.9908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34865900.0294; train_optim_loss: 34865900.0294; val_kl_reg_loss: 55123.5008; val_edge_recon_loss: 25563743.4754; val_gene_expr_recon_loss: 9543156.3115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35162023.6066; val_optim_loss: 35162023.6066
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9945; val_auprc_score: 0.9924; val_best_acc_score: 0.9776; val_best_f1_score: 0.9779; train_kl_reg_loss: 55854.7019; train_edge_recon_loss: 25542565.4669; train_gene_expr_recon_loss: 9268508.4614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34866928.6691; train_optim_loss: 34866928.6691; val_kl_reg_loss: 55070.3659; val_edge_recon_loss: 25569468.4262; val_gene_expr_recon_loss: 9542255.5246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35166794.3607; val_optim_loss: 35166794.3607

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 204 min 42 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
Val AUROC score: 0.9943
Val AUPRC score: 0.9927
Val best accuracy score: 0.9765
Val best F1 score: 0.9768
Val gene expr MSE score: 0.5775

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
