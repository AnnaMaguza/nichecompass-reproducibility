None
Run timestamp: 02072023_064949_2009.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_2009']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9732; val_auprc_score: 0.9670; val_best_acc_score: 0.9224; val_best_f1_score: 0.9250; train_kl_reg_loss: 6152.6992; train_edge_recon_loss: 268660.9320; train_gene_expr_recon_loss: 78054.2334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352867.8646; train_optim_loss: 352867.8646; val_kl_reg_loss: 5844.2265; val_edge_recon_loss: 264975.8485; val_gene_expr_recon_loss: 71667.4843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 342487.5586; val_optim_loss: 342487.5586
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9825; val_auprc_score: 0.9789; val_best_acc_score: 0.9387; val_best_f1_score: 0.9403; train_kl_reg_loss: 5897.2852; train_edge_recon_loss: 263352.8592; train_gene_expr_recon_loss: 70167.9216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 339418.0655; train_optim_loss: 339418.0655; val_kl_reg_loss: 5796.7360; val_edge_recon_loss: 263971.1522; val_gene_expr_recon_loss: 68286.7246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 338054.6134; val_optim_loss: 338054.6134
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9839; val_auprc_score: 0.9803; val_best_acc_score: 0.9438; val_best_f1_score: 0.9451; train_kl_reg_loss: 5888.5606; train_edge_recon_loss: 262323.7674; train_gene_expr_recon_loss: 67797.1095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 336009.4370; train_optim_loss: 336009.4370; val_kl_reg_loss: 5771.7941; val_edge_recon_loss: 263608.2074; val_gene_expr_recon_loss: 66756.4784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 336136.4801; val_optim_loss: 336136.4801
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9851; val_auprc_score: 0.9817; val_best_acc_score: 0.9469; val_best_f1_score: 0.9483; train_kl_reg_loss: 5877.1527; train_edge_recon_loss: 261805.6888; train_gene_expr_recon_loss: 66529.4890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 334212.3304; train_optim_loss: 334212.3304; val_kl_reg_loss: 5770.5559; val_edge_recon_loss: 263093.7897; val_gene_expr_recon_loss: 65690.6307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334554.9752; val_optim_loss: 334554.9752
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9868; val_auprc_score: 0.9837; val_best_acc_score: 0.9512; val_best_f1_score: 0.9523; train_kl_reg_loss: 5872.8649; train_edge_recon_loss: 261481.3827; train_gene_expr_recon_loss: 65854.8196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333209.0667; train_optim_loss: 333209.0667; val_kl_reg_loss: 5708.3181; val_edge_recon_loss: 262562.1051; val_gene_expr_recon_loss: 65285.4263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333555.8478; val_optim_loss: 333555.8478
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9871; val_auprc_score: 0.9838; val_best_acc_score: 0.9524; val_best_f1_score: 0.9533; train_kl_reg_loss: 5863.7407; train_edge_recon_loss: 261156.5657; train_gene_expr_recon_loss: 65459.1349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332479.4415; train_optim_loss: 332479.4415; val_kl_reg_loss: 5789.4729; val_edge_recon_loss: 262306.2668; val_gene_expr_recon_loss: 65028.2559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333123.9966; val_optim_loss: 333123.9966
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9892; val_auprc_score: 0.9870; val_best_acc_score: 0.9550; val_best_f1_score: 0.9560; train_kl_reg_loss: 5870.0775; train_edge_recon_loss: 260970.1633; train_gene_expr_recon_loss: 65128.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331968.3628; train_optim_loss: 331968.3628; val_kl_reg_loss: 5804.9636; val_edge_recon_loss: 262231.0437; val_gene_expr_recon_loss: 64704.9132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332740.9193; val_optim_loss: 332740.9193
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9891; val_auprc_score: 0.9867; val_best_acc_score: 0.9553; val_best_f1_score: 0.9561; train_kl_reg_loss: 5868.6633; train_edge_recon_loss: 260823.2762; train_gene_expr_recon_loss: 64921.1857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331613.1248; train_optim_loss: 331613.1248; val_kl_reg_loss: 5781.8709; val_edge_recon_loss: 262187.0491; val_gene_expr_recon_loss: 64566.8457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332535.7643; val_optim_loss: 332535.7643
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9894; val_auprc_score: 0.9868; val_best_acc_score: 0.9571; val_best_f1_score: 0.9578; train_kl_reg_loss: 5875.0348; train_edge_recon_loss: 260615.5908; train_gene_expr_recon_loss: 64763.7806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331254.4060; train_optim_loss: 331254.4060; val_kl_reg_loss: 5781.0593; val_edge_recon_loss: 261808.0880; val_gene_expr_recon_loss: 64558.2348; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332147.3818; val_optim_loss: 332147.3818
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9897; val_auprc_score: 0.9872; val_best_acc_score: 0.9575; val_best_f1_score: 0.9582; train_kl_reg_loss: 5877.6626; train_edge_recon_loss: 260477.5340; train_gene_expr_recon_loss: 64618.7145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330973.9115; train_optim_loss: 330973.9115; val_kl_reg_loss: 5869.0293; val_edge_recon_loss: 262036.8762; val_gene_expr_recon_loss: 64208.9002; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332114.8046; val_optim_loss: 332114.8046
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9896; val_auprc_score: 0.9871; val_best_acc_score: 0.9573; val_best_f1_score: 0.9580; train_kl_reg_loss: 5881.9449; train_edge_recon_loss: 260365.7328; train_gene_expr_recon_loss: 64519.3957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330767.0732; train_optim_loss: 330767.0732; val_kl_reg_loss: 5773.6014; val_edge_recon_loss: 261653.4530; val_gene_expr_recon_loss: 64208.6433; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331635.6997; val_optim_loss: 331635.6997
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9898; val_auprc_score: 0.9874; val_best_acc_score: 0.9584; val_best_f1_score: 0.9592; train_kl_reg_loss: 5881.7280; train_edge_recon_loss: 260389.0296; train_gene_expr_recon_loss: 64440.2401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330710.9980; train_optim_loss: 330710.9980; val_kl_reg_loss: 5760.8859; val_edge_recon_loss: 261560.5045; val_gene_expr_recon_loss: 64082.0841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331403.4732; val_optim_loss: 331403.4732
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9904; val_auprc_score: 0.9881; val_best_acc_score: 0.9602; val_best_f1_score: 0.9609; train_kl_reg_loss: 5885.2091; train_edge_recon_loss: 260250.7594; train_gene_expr_recon_loss: 64348.8147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330484.7831; train_optim_loss: 330484.7831; val_kl_reg_loss: 5809.0814; val_edge_recon_loss: 261302.9633; val_gene_expr_recon_loss: 64232.9494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331344.9955; val_optim_loss: 331344.9955
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9901; val_auprc_score: 0.9876; val_best_acc_score: 0.9585; val_best_f1_score: 0.9591; train_kl_reg_loss: 5899.5075; train_edge_recon_loss: 259982.5419; train_gene_expr_recon_loss: 64279.6663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330161.7152; train_optim_loss: 330161.7152; val_kl_reg_loss: 5852.2623; val_edge_recon_loss: 261662.6091; val_gene_expr_recon_loss: 64062.2562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331577.1282; val_optim_loss: 331577.1282
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9904; val_auprc_score: 0.9882; val_best_acc_score: 0.9595; val_best_f1_score: 0.9601; train_kl_reg_loss: 5899.6900; train_edge_recon_loss: 260019.1653; train_gene_expr_recon_loss: 64202.3451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330121.2006; train_optim_loss: 330121.2006; val_kl_reg_loss: 5731.5160; val_edge_recon_loss: 261331.0723; val_gene_expr_recon_loss: 64032.5910; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331095.1779; val_optim_loss: 331095.1779
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9905; val_auprc_score: 0.9879; val_best_acc_score: 0.9600; val_best_f1_score: 0.9606; train_kl_reg_loss: 5903.7491; train_edge_recon_loss: 260002.6185; train_gene_expr_recon_loss: 64143.9580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330050.3260; train_optim_loss: 330050.3260; val_kl_reg_loss: 5902.0198; val_edge_recon_loss: 261122.1907; val_gene_expr_recon_loss: 63995.2705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331019.4810; val_optim_loss: 331019.4810
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9912; val_auprc_score: 0.9890; val_best_acc_score: 0.9622; val_best_f1_score: 0.9628; train_kl_reg_loss: 5907.3746; train_edge_recon_loss: 259909.5316; train_gene_expr_recon_loss: 64120.7467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329937.6533; train_optim_loss: 329937.6533; val_kl_reg_loss: 5785.2954; val_edge_recon_loss: 260868.9804; val_gene_expr_recon_loss: 63895.2778; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330549.5529; val_optim_loss: 330549.5529
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9909; val_auprc_score: 0.9886; val_best_acc_score: 0.9619; val_best_f1_score: 0.9626; train_kl_reg_loss: 5913.0717; train_edge_recon_loss: 259824.3165; train_gene_expr_recon_loss: 64055.1482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329792.5368; train_optim_loss: 329792.5368; val_kl_reg_loss: 5825.5824; val_edge_recon_loss: 260925.6128; val_gene_expr_recon_loss: 63909.4708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330660.6661; val_optim_loss: 330660.6661
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9914; val_auprc_score: 0.9897; val_best_acc_score: 0.9614; val_best_f1_score: 0.9620; train_kl_reg_loss: 5914.5998; train_edge_recon_loss: 259795.3133; train_gene_expr_recon_loss: 64025.6919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329735.6046; train_optim_loss: 329735.6046; val_kl_reg_loss: 5825.1035; val_edge_recon_loss: 260680.6598; val_gene_expr_recon_loss: 63818.6763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330324.4366; val_optim_loss: 330324.4366
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9913; val_auprc_score: 0.9892; val_best_acc_score: 0.9631; val_best_f1_score: 0.9636; train_kl_reg_loss: 5918.4799; train_edge_recon_loss: 259776.6284; train_gene_expr_recon_loss: 63974.1329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329669.2414; train_optim_loss: 329669.2414; val_kl_reg_loss: 5772.6376; val_edge_recon_loss: 260895.8769; val_gene_expr_recon_loss: 63781.6253; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330450.1391; val_optim_loss: 330450.1391
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9912; val_auprc_score: 0.9886; val_best_acc_score: 0.9625; val_best_f1_score: 0.9631; train_kl_reg_loss: 5923.1510; train_edge_recon_loss: 259709.9477; train_gene_expr_recon_loss: 63953.1738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329586.2729; train_optim_loss: 329586.2729; val_kl_reg_loss: 5817.8501; val_edge_recon_loss: 260998.6863; val_gene_expr_recon_loss: 63807.5691; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330624.1040; val_optim_loss: 330624.1040
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9911; val_auprc_score: 0.9888; val_best_acc_score: 0.9624; val_best_f1_score: 0.9631; train_kl_reg_loss: 5922.2770; train_edge_recon_loss: 259706.9549; train_gene_expr_recon_loss: 63915.3487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329544.5800; train_optim_loss: 329544.5800; val_kl_reg_loss: 5802.7520; val_edge_recon_loss: 260843.0243; val_gene_expr_recon_loss: 63906.9124; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330552.6881; val_optim_loss: 330552.6881
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9914; val_auprc_score: 0.9892; val_best_acc_score: 0.9634; val_best_f1_score: 0.9639; train_kl_reg_loss: 5933.9322; train_edge_recon_loss: 259603.4511; train_gene_expr_recon_loss: 63890.9651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329428.3489; train_optim_loss: 329428.3489; val_kl_reg_loss: 5897.2803; val_edge_recon_loss: 261127.5845; val_gene_expr_recon_loss: 63724.6705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330749.5347; val_optim_loss: 330749.5347

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9916; val_auprc_score: 0.9894; val_best_acc_score: 0.9640; val_best_f1_score: 0.9646; train_kl_reg_loss: 5953.9005; train_edge_recon_loss: 259347.3532; train_gene_expr_recon_loss: 63368.6490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328669.9022; train_optim_loss: 328669.9022; val_kl_reg_loss: 5892.4056; val_edge_recon_loss: 260425.3001; val_gene_expr_recon_loss: 63325.6196; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329643.3264; val_optim_loss: 329643.3264
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9919; val_auprc_score: 0.9898; val_best_acc_score: 0.9648; val_best_f1_score: 0.9653; train_kl_reg_loss: 5951.1487; train_edge_recon_loss: 259234.0118; train_gene_expr_recon_loss: 63338.0370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328523.1969; train_optim_loss: 328523.1969; val_kl_reg_loss: 5860.9913; val_edge_recon_loss: 260477.2612; val_gene_expr_recon_loss: 63336.5500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329674.8009; val_optim_loss: 329674.8009
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9922; val_auprc_score: 0.9904; val_best_acc_score: 0.9657; val_best_f1_score: 0.9662; train_kl_reg_loss: 5946.9218; train_edge_recon_loss: 259279.0113; train_gene_expr_recon_loss: 63292.4750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328518.4078; train_optim_loss: 328518.4078; val_kl_reg_loss: 5826.7425; val_edge_recon_loss: 260562.7494; val_gene_expr_recon_loss: 63213.3069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329602.7979; val_optim_loss: 329602.7979
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9919; val_auprc_score: 0.9899; val_best_acc_score: 0.9644; val_best_f1_score: 0.9650; train_kl_reg_loss: 5942.1575; train_edge_recon_loss: 259302.6813; train_gene_expr_recon_loss: 63267.9260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328512.7642; train_optim_loss: 328512.7642; val_kl_reg_loss: 5903.8042; val_edge_recon_loss: 260557.2845; val_gene_expr_recon_loss: 63212.6666; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329673.7549; val_optim_loss: 329673.7549
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9923; val_auprc_score: 0.9903; val_best_acc_score: 0.9658; val_best_f1_score: 0.9662; train_kl_reg_loss: 5936.6255; train_edge_recon_loss: 259295.7450; train_gene_expr_recon_loss: 63276.6913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328509.0620; train_optim_loss: 328509.0620; val_kl_reg_loss: 5883.3509; val_edge_recon_loss: 260346.2499; val_gene_expr_recon_loss: 63321.3109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329550.9114; val_optim_loss: 329550.9114
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9923; val_auprc_score: 0.9902; val_best_acc_score: 0.9653; val_best_f1_score: 0.9658; train_kl_reg_loss: 5939.0137; train_edge_recon_loss: 259342.9303; train_gene_expr_recon_loss: 63259.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328541.9138; train_optim_loss: 328541.9138; val_kl_reg_loss: 5840.8990; val_edge_recon_loss: 260318.9484; val_gene_expr_recon_loss: 63208.3447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329368.1929; val_optim_loss: 329368.1929
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9918; val_auprc_score: 0.9895; val_best_acc_score: 0.9646; val_best_f1_score: 0.9651; train_kl_reg_loss: 5937.5739; train_edge_recon_loss: 259307.0854; train_gene_expr_recon_loss: 63231.7475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328476.4074; train_optim_loss: 328476.4074; val_kl_reg_loss: 5873.7545; val_edge_recon_loss: 260756.6150; val_gene_expr_recon_loss: 63245.6627; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329876.0334; val_optim_loss: 329876.0334
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9924; val_auprc_score: 0.9906; val_best_acc_score: 0.9657; val_best_f1_score: 0.9662; train_kl_reg_loss: 5938.0883; train_edge_recon_loss: 259255.5003; train_gene_expr_recon_loss: 63223.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328417.3596; train_optim_loss: 328417.3596; val_kl_reg_loss: 5833.7643; val_edge_recon_loss: 260355.0360; val_gene_expr_recon_loss: 63224.0675; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329412.8673; val_optim_loss: 329412.8673
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9923; val_auprc_score: 0.9903; val_best_acc_score: 0.9659; val_best_f1_score: 0.9664; train_kl_reg_loss: 5934.9617; train_edge_recon_loss: 259288.9270; train_gene_expr_recon_loss: 63212.8973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328436.7862; train_optim_loss: 328436.7862; val_kl_reg_loss: 5867.4043; val_edge_recon_loss: 260256.6202; val_gene_expr_recon_loss: 63270.7050; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329394.7288; val_optim_loss: 329394.7288
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9921; val_auprc_score: 0.9900; val_best_acc_score: 0.9655; val_best_f1_score: 0.9660; train_kl_reg_loss: 5937.4006; train_edge_recon_loss: 259261.0751; train_gene_expr_recon_loss: 63203.6895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328402.1658; train_optim_loss: 328402.1658; val_kl_reg_loss: 5869.0156; val_edge_recon_loss: 260426.3892; val_gene_expr_recon_loss: 63161.2725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329456.6755; val_optim_loss: 329456.6755

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9924; val_auprc_score: 0.9906; val_best_acc_score: 0.9659; val_best_f1_score: 0.9663; train_kl_reg_loss: 5944.8840; train_edge_recon_loss: 259241.4171; train_gene_expr_recon_loss: 63143.5908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328329.8917; train_optim_loss: 328329.8917; val_kl_reg_loss: 5867.6407; val_edge_recon_loss: 260523.6247; val_gene_expr_recon_loss: 63091.7630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329483.0283; val_optim_loss: 329483.0283
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9926; val_auprc_score: 0.9908; val_best_acc_score: 0.9660; val_best_f1_score: 0.9665; train_kl_reg_loss: 5944.6946; train_edge_recon_loss: 259208.1152; train_gene_expr_recon_loss: 63142.9745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328295.7839; train_optim_loss: 328295.7839; val_kl_reg_loss: 5866.6406; val_edge_recon_loss: 260326.2139; val_gene_expr_recon_loss: 63178.2446; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329371.0985; val_optim_loss: 329371.0985
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9924; val_auprc_score: 0.9905; val_best_acc_score: 0.9659; val_best_f1_score: 0.9664; train_kl_reg_loss: 5941.4467; train_edge_recon_loss: 259220.2640; train_gene_expr_recon_loss: 63137.8335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328299.5440; train_optim_loss: 328299.5440; val_kl_reg_loss: 5872.2220; val_edge_recon_loss: 260544.9719; val_gene_expr_recon_loss: 63161.8981; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329579.0923; val_optim_loss: 329579.0923
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9926; val_auprc_score: 0.9907; val_best_acc_score: 0.9664; val_best_f1_score: 0.9669; train_kl_reg_loss: 5943.8067; train_edge_recon_loss: 259148.0257; train_gene_expr_recon_loss: 63135.3900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328227.2222; train_optim_loss: 328227.2222; val_kl_reg_loss: 5869.2361; val_edge_recon_loss: 260172.4122; val_gene_expr_recon_loss: 63120.9324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329162.5813; val_optim_loss: 329162.5813
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9923; val_auprc_score: 0.9903; val_best_acc_score: 0.9660; val_best_f1_score: 0.9665; train_kl_reg_loss: 5942.3307; train_edge_recon_loss: 259287.6570; train_gene_expr_recon_loss: 63135.6237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328365.6115; train_optim_loss: 328365.6115; val_kl_reg_loss: 5858.7319; val_edge_recon_loss: 260427.0791; val_gene_expr_recon_loss: 63082.7563; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329368.5661; val_optim_loss: 329368.5661
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9923; val_auprc_score: 0.9903; val_best_acc_score: 0.9660; val_best_f1_score: 0.9665; train_kl_reg_loss: 5936.9086; train_edge_recon_loss: 259325.2435; train_gene_expr_recon_loss: 63126.1231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328388.2752; train_optim_loss: 328388.2752; val_kl_reg_loss: 5859.3690; val_edge_recon_loss: 260429.4307; val_gene_expr_recon_loss: 63211.6209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329500.4208; val_optim_loss: 329500.4208
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9925; val_auprc_score: 0.9906; val_best_acc_score: 0.9664; val_best_f1_score: 0.9669; train_kl_reg_loss: 5938.8106; train_edge_recon_loss: 259202.7851; train_gene_expr_recon_loss: 63119.0156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328260.6107; train_optim_loss: 328260.6107; val_kl_reg_loss: 5869.1812; val_edge_recon_loss: 260260.5468; val_gene_expr_recon_loss: 63034.4225; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329164.1492; val_optim_loss: 329164.1492
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9925; val_auprc_score: 0.9906; val_best_acc_score: 0.9664; val_best_f1_score: 0.9668; train_kl_reg_loss: 5942.1501; train_edge_recon_loss: 259276.7418; train_gene_expr_recon_loss: 63112.7925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328331.6842; train_optim_loss: 328331.6842; val_kl_reg_loss: 5866.8358; val_edge_recon_loss: 260221.8795; val_gene_expr_recon_loss: 63181.0371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329269.7521; val_optim_loss: 329269.7521

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9922; val_auprc_score: 0.9901; val_best_acc_score: 0.9652; val_best_f1_score: 0.9658; train_kl_reg_loss: 5938.5432; train_edge_recon_loss: 259300.9311; train_gene_expr_recon_loss: 63105.7404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328345.2148; train_optim_loss: 328345.2148; val_kl_reg_loss: 5860.3804; val_edge_recon_loss: 260448.0125; val_gene_expr_recon_loss: 63116.2774; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329424.6699; val_optim_loss: 329424.6699
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9925; val_auprc_score: 0.9906; val_best_acc_score: 0.9662; val_best_f1_score: 0.9666; train_kl_reg_loss: 5940.7143; train_edge_recon_loss: 259152.1868; train_gene_expr_recon_loss: 63126.7636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328219.6645; train_optim_loss: 328219.6645; val_kl_reg_loss: 5865.1301; val_edge_recon_loss: 260476.6632; val_gene_expr_recon_loss: 63059.5434; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329401.3354; val_optim_loss: 329401.3354
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9924; val_auprc_score: 0.9906; val_best_acc_score: 0.9657; val_best_f1_score: 0.9662; train_kl_reg_loss: 5940.3729; train_edge_recon_loss: 259246.5878; train_gene_expr_recon_loss: 63109.2344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328296.1950; train_optim_loss: 328296.1950; val_kl_reg_loss: 5863.0384; val_edge_recon_loss: 260628.5757; val_gene_expr_recon_loss: 63122.6431; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329614.2554; val_optim_loss: 329614.2554
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9922; val_auprc_score: 0.9903; val_best_acc_score: 0.9660; val_best_f1_score: 0.9664; train_kl_reg_loss: 5940.5923; train_edge_recon_loss: 259268.3098; train_gene_expr_recon_loss: 63109.0296; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328317.9314; train_optim_loss: 328317.9314; val_kl_reg_loss: 5862.9825; val_edge_recon_loss: 260243.8536; val_gene_expr_recon_loss: 63109.9177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329216.7536; val_optim_loss: 329216.7536

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 219 min 19 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
Val AUROC score: 0.9923
Val AUPRC score: 0.9906
Val best accuracy score: 0.9653
Val best F1 score: 0.9658
Val gene expr MSE score: 1.5336

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
