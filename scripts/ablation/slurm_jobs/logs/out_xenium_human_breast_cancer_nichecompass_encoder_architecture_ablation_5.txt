None
Run timestamp: 03082023_015727_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '128', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 128
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9563; val_auprc_score: 0.9453; val_best_acc_score: 0.8969; val_best_f1_score: 0.9017; train_kl_reg_loss: 6125.2469; train_edge_recon_loss: 269405.7015; train_gene_expr_recon_loss: 119455.2090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 394986.1574; train_optim_loss: 394986.1574; val_kl_reg_loss: 5955.1556; val_edge_recon_loss: 270174.5551; val_gene_expr_recon_loss: 104267.5792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 380397.2893; val_optim_loss: 380397.2893
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9661; val_auprc_score: 0.9583; val_best_acc_score: 0.9110; val_best_f1_score: 0.9148; train_kl_reg_loss: 6285.8318; train_edge_recon_loss: 264192.5725; train_gene_expr_recon_loss: 97335.6591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367814.0638; train_optim_loss: 367814.0638; val_kl_reg_loss: 6458.3585; val_edge_recon_loss: 268161.1320; val_gene_expr_recon_loss: 91652.6043; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366272.0948; val_optim_loss: 366272.0948
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9657; val_auprc_score: 0.9544; val_best_acc_score: 0.9165; val_best_f1_score: 0.9203; train_kl_reg_loss: 6497.2531; train_edge_recon_loss: 263226.5236; train_gene_expr_recon_loss: 90099.6464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 359823.4232; train_optim_loss: 359823.4232; val_kl_reg_loss: 6597.7382; val_edge_recon_loss: 267541.5287; val_gene_expr_recon_loss: 88063.0934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 362202.3593; val_optim_loss: 362202.3593
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9702; val_auprc_score: 0.9626; val_best_acc_score: 0.9190; val_best_f1_score: 0.9219; train_kl_reg_loss: 6552.4440; train_edge_recon_loss: 262811.2010; train_gene_expr_recon_loss: 87625.2518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 356988.8975; train_optim_loss: 356988.8975; val_kl_reg_loss: 6531.6384; val_edge_recon_loss: 267334.3890; val_gene_expr_recon_loss: 86376.8045; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 360242.8328; val_optim_loss: 360242.8328
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9729; val_auprc_score: 0.9664; val_best_acc_score: 0.9222; val_best_f1_score: 0.9246; train_kl_reg_loss: 6566.5181; train_edge_recon_loss: 262631.4527; train_gene_expr_recon_loss: 86520.4129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 355718.3838; train_optim_loss: 355718.3838; val_kl_reg_loss: 6483.1887; val_edge_recon_loss: 267155.4697; val_gene_expr_recon_loss: 85655.9860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 359294.6439; val_optim_loss: 359294.6439
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9720; val_auprc_score: 0.9645; val_best_acc_score: 0.9226; val_best_f1_score: 0.9250; train_kl_reg_loss: 6558.6388; train_edge_recon_loss: 262498.8894; train_gene_expr_recon_loss: 85895.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 354952.8008; train_optim_loss: 354952.8008; val_kl_reg_loss: 6507.2481; val_edge_recon_loss: 267358.4756; val_gene_expr_recon_loss: 85309.4224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 359175.1449; val_optim_loss: 359175.1449
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9724; val_auprc_score: 0.9645; val_best_acc_score: 0.9255; val_best_f1_score: 0.9279; train_kl_reg_loss: 6562.1070; train_edge_recon_loss: 262180.8977; train_gene_expr_recon_loss: 85400.3354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 354143.3401; train_optim_loss: 354143.3401; val_kl_reg_loss: 6613.2939; val_edge_recon_loss: 266611.2936; val_gene_expr_recon_loss: 84720.6224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 357945.2110; val_optim_loss: 357945.2110
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9728; val_auprc_score: 0.9654; val_best_acc_score: 0.9244; val_best_f1_score: 0.9268; train_kl_reg_loss: 6560.1000; train_edge_recon_loss: 262105.1846; train_gene_expr_recon_loss: 85075.8614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 353741.1459; train_optim_loss: 353741.1459; val_kl_reg_loss: 6515.8558; val_edge_recon_loss: 266832.1110; val_gene_expr_recon_loss: 84383.6735; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 357731.6406; val_optim_loss: 357731.6406
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9739; val_auprc_score: 0.9657; val_best_acc_score: 0.9273; val_best_f1_score: 0.9297; train_kl_reg_loss: 6549.7609; train_edge_recon_loss: 262007.0656; train_gene_expr_recon_loss: 84759.5248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 353316.3511; train_optim_loss: 353316.3511; val_kl_reg_loss: 6627.6851; val_edge_recon_loss: 266876.7518; val_gene_expr_recon_loss: 84488.7244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 357993.1622; val_optim_loss: 357993.1622
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9746; val_auprc_score: 0.9679; val_best_acc_score: 0.9268; val_best_f1_score: 0.9290; train_kl_reg_loss: 6548.7528; train_edge_recon_loss: 261921.6440; train_gene_expr_recon_loss: 84625.9741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 353096.3708; train_optim_loss: 353096.3708; val_kl_reg_loss: 6550.1097; val_edge_recon_loss: 267098.5173; val_gene_expr_recon_loss: 83891.8248; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 357540.4503; val_optim_loss: 357540.4503
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9757; val_auprc_score: 0.9693; val_best_acc_score: 0.9288; val_best_f1_score: 0.9309; train_kl_reg_loss: 6547.2397; train_edge_recon_loss: 261744.8637; train_gene_expr_recon_loss: 84385.5252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 352677.6281; train_optim_loss: 352677.6281; val_kl_reg_loss: 6483.0187; val_edge_recon_loss: 266834.9217; val_gene_expr_recon_loss: 83860.6509; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 357178.5904; val_optim_loss: 357178.5904
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9756; val_auprc_score: 0.9688; val_best_acc_score: 0.9299; val_best_f1_score: 0.9320; train_kl_reg_loss: 6539.5816; train_edge_recon_loss: 261777.9000; train_gene_expr_recon_loss: 84242.0305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 352559.5122; train_optim_loss: 352559.5122; val_kl_reg_loss: 6628.6320; val_edge_recon_loss: 266947.1470; val_gene_expr_recon_loss: 83702.2671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 357278.0459; val_optim_loss: 357278.0459
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9755; val_auprc_score: 0.9684; val_best_acc_score: 0.9298; val_best_f1_score: 0.9314; train_kl_reg_loss: 6541.7195; train_edge_recon_loss: 261751.6112; train_gene_expr_recon_loss: 84073.5863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 352366.9166; train_optim_loss: 352366.9166; val_kl_reg_loss: 6490.8455; val_edge_recon_loss: 266360.6130; val_gene_expr_recon_loss: 83552.9374; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 356404.3955; val_optim_loss: 356404.3955
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9746; val_auprc_score: 0.9671; val_best_acc_score: 0.9291; val_best_f1_score: 0.9312; train_kl_reg_loss: 6544.1099; train_edge_recon_loss: 261578.1010; train_gene_expr_recon_loss: 83958.1263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 352080.3374; train_optim_loss: 352080.3374; val_kl_reg_loss: 6639.4944; val_edge_recon_loss: 266679.4005; val_gene_expr_recon_loss: 83672.2497; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 356991.1446; val_optim_loss: 356991.1446
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9754; val_auprc_score: 0.9683; val_best_acc_score: 0.9298; val_best_f1_score: 0.9321; train_kl_reg_loss: 6533.0049; train_edge_recon_loss: 261582.1253; train_gene_expr_recon_loss: 83822.9962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 351938.1262; train_optim_loss: 351938.1262; val_kl_reg_loss: 6569.0674; val_edge_recon_loss: 266406.5524; val_gene_expr_recon_loss: 83395.1633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 356370.7840; val_optim_loss: 356370.7840
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9768; val_auprc_score: 0.9703; val_best_acc_score: 0.9330; val_best_f1_score: 0.9345; train_kl_reg_loss: 6532.3124; train_edge_recon_loss: 261538.8507; train_gene_expr_recon_loss: 83672.4400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 351743.6034; train_optim_loss: 351743.6034; val_kl_reg_loss: 6512.0495; val_edge_recon_loss: 265455.9970; val_gene_expr_recon_loss: 83312.7496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 355280.7956; val_optim_loss: 355280.7956
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9777; val_auprc_score: 0.9714; val_best_acc_score: 0.9342; val_best_f1_score: 0.9359; train_kl_reg_loss: 6543.1603; train_edge_recon_loss: 261386.7994; train_gene_expr_recon_loss: 83627.3021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 351557.2613; train_optim_loss: 351557.2613; val_kl_reg_loss: 6524.9133; val_edge_recon_loss: 266191.9482; val_gene_expr_recon_loss: 83052.2709; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 355769.1325; val_optim_loss: 355769.1325
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9761; val_auprc_score: 0.9690; val_best_acc_score: 0.9316; val_best_f1_score: 0.9337; train_kl_reg_loss: 6540.4836; train_edge_recon_loss: 261447.6945; train_gene_expr_recon_loss: 83402.3576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 351390.5352; train_optim_loss: 351390.5352; val_kl_reg_loss: 6435.2712; val_edge_recon_loss: 265654.6485; val_gene_expr_recon_loss: 83068.5872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 355158.5062; val_optim_loss: 355158.5062
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9774; val_auprc_score: 0.9706; val_best_acc_score: 0.9337; val_best_f1_score: 0.9356; train_kl_reg_loss: 6529.4579; train_edge_recon_loss: 261485.0593; train_gene_expr_recon_loss: 83339.7478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 351354.2649; train_optim_loss: 351354.2649; val_kl_reg_loss: 6478.7624; val_edge_recon_loss: 265961.5138; val_gene_expr_recon_loss: 83067.0096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 355507.2854; val_optim_loss: 355507.2854
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9759; val_auprc_score: 0.9688; val_best_acc_score: 0.9321; val_best_f1_score: 0.9342; train_kl_reg_loss: 6543.9669; train_edge_recon_loss: 261271.3497; train_gene_expr_recon_loss: 83175.9397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 350991.2563; train_optim_loss: 350991.2563; val_kl_reg_loss: 6558.0716; val_edge_recon_loss: 266057.9855; val_gene_expr_recon_loss: 82770.0869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 355386.1440; val_optim_loss: 355386.1440
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9767; val_auprc_score: 0.9699; val_best_acc_score: 0.9328; val_best_f1_score: 0.9345; train_kl_reg_loss: 6538.4991; train_edge_recon_loss: 261240.4331; train_gene_expr_recon_loss: 83152.9250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 350931.8572; train_optim_loss: 350931.8572; val_kl_reg_loss: 6521.5888; val_edge_recon_loss: 266459.2447; val_gene_expr_recon_loss: 82718.2583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 355699.0912; val_optim_loss: 355699.0912
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9783; val_auprc_score: 0.9723; val_best_acc_score: 0.9346; val_best_f1_score: 0.9362; train_kl_reg_loss: 6535.6311; train_edge_recon_loss: 261181.8532; train_gene_expr_recon_loss: 83060.0125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 350777.4967; train_optim_loss: 350777.4967; val_kl_reg_loss: 6553.0937; val_edge_recon_loss: 266119.0487; val_gene_expr_recon_loss: 82766.1663; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 355438.3090; val_optim_loss: 355438.3090

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9792; val_auprc_score: 0.9728; val_best_acc_score: 0.9374; val_best_f1_score: 0.9388; train_kl_reg_loss: 6526.6219; train_edge_recon_loss: 260653.4013; train_gene_expr_recon_loss: 81624.4843; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348804.5071; train_optim_loss: 348804.5071; val_kl_reg_loss: 6503.9205; val_edge_recon_loss: 265370.8853; val_gene_expr_recon_loss: 81266.8409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 353141.6459; val_optim_loss: 353141.6459
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9798; val_auprc_score: 0.9737; val_best_acc_score: 0.9387; val_best_f1_score: 0.9401; train_kl_reg_loss: 6506.2328; train_edge_recon_loss: 260684.1311; train_gene_expr_recon_loss: 81451.3715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348641.7357; train_optim_loss: 348641.7357; val_kl_reg_loss: 6522.7827; val_edge_recon_loss: 264893.8073; val_gene_expr_recon_loss: 81139.0450; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 352555.6345; val_optim_loss: 352555.6345
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9804; val_auprc_score: 0.9751; val_best_acc_score: 0.9390; val_best_f1_score: 0.9402; train_kl_reg_loss: 6492.2697; train_edge_recon_loss: 260587.3909; train_gene_expr_recon_loss: 81349.5031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348429.1638; train_optim_loss: 348429.1638; val_kl_reg_loss: 6536.6383; val_edge_recon_loss: 264923.8230; val_gene_expr_recon_loss: 80995.6540; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 352456.1147; val_optim_loss: 352456.1147
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9791; val_auprc_score: 0.9731; val_best_acc_score: 0.9379; val_best_f1_score: 0.9394; train_kl_reg_loss: 6488.8628; train_edge_recon_loss: 260536.6188; train_gene_expr_recon_loss: 81316.7007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348342.1822; train_optim_loss: 348342.1822; val_kl_reg_loss: 6472.3875; val_edge_recon_loss: 265595.2342; val_gene_expr_recon_loss: 81047.9119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 353115.5346; val_optim_loss: 353115.5346
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9801; val_auprc_score: 0.9746; val_best_acc_score: 0.9391; val_best_f1_score: 0.9405; train_kl_reg_loss: 6478.9143; train_edge_recon_loss: 260568.2276; train_gene_expr_recon_loss: 81288.0144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348335.1565; train_optim_loss: 348335.1565; val_kl_reg_loss: 6479.6421; val_edge_recon_loss: 265240.3429; val_gene_expr_recon_loss: 80976.3615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 352696.3453; val_optim_loss: 352696.3453
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9794; val_auprc_score: 0.9732; val_best_acc_score: 0.9387; val_best_f1_score: 0.9401; train_kl_reg_loss: 6478.4765; train_edge_recon_loss: 260560.2471; train_gene_expr_recon_loss: 81317.9007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348356.6243; train_optim_loss: 348356.6243; val_kl_reg_loss: 6500.8772; val_edge_recon_loss: 265072.8127; val_gene_expr_recon_loss: 81037.6882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 352611.3788; val_optim_loss: 352611.3788
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9802; val_auprc_score: 0.9745; val_best_acc_score: 0.9395; val_best_f1_score: 0.9408; train_kl_reg_loss: 6470.2598; train_edge_recon_loss: 260667.9317; train_gene_expr_recon_loss: 81220.1081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348358.2998; train_optim_loss: 348358.2998; val_kl_reg_loss: 6511.7332; val_edge_recon_loss: 265002.1867; val_gene_expr_recon_loss: 81114.4734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 352628.3926; val_optim_loss: 352628.3926

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9789; val_auprc_score: 0.9723; val_best_acc_score: 0.9374; val_best_f1_score: 0.9390; train_kl_reg_loss: 6465.0948; train_edge_recon_loss: 260508.8226; train_gene_expr_recon_loss: 81112.5372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348086.4549; train_optim_loss: 348086.4549; val_kl_reg_loss: 6475.0677; val_edge_recon_loss: 265431.9810; val_gene_expr_recon_loss: 80846.4540; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 352753.5021; val_optim_loss: 352753.5021
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9792; val_auprc_score: 0.9728; val_best_acc_score: 0.9376; val_best_f1_score: 0.9394; train_kl_reg_loss: 6465.1833; train_edge_recon_loss: 260522.1811; train_gene_expr_recon_loss: 81080.8583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348068.2222; train_optim_loss: 348068.2222; val_kl_reg_loss: 6470.5319; val_edge_recon_loss: 265338.5711; val_gene_expr_recon_loss: 80849.8420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 352658.9439; val_optim_loss: 352658.9439
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9802; val_auprc_score: 0.9742; val_best_acc_score: 0.9396; val_best_f1_score: 0.9409; train_kl_reg_loss: 6467.7639; train_edge_recon_loss: 260549.7577; train_gene_expr_recon_loss: 81094.3546; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348111.8761; train_optim_loss: 348111.8761; val_kl_reg_loss: 6475.7822; val_edge_recon_loss: 265270.3796; val_gene_expr_recon_loss: 80811.3833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 352557.5453; val_optim_loss: 352557.5453
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9790; val_auprc_score: 0.9726; val_best_acc_score: 0.9381; val_best_f1_score: 0.9395; train_kl_reg_loss: 6465.7806; train_edge_recon_loss: 260568.1142; train_gene_expr_recon_loss: 81029.3322; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348063.2270; train_optim_loss: 348063.2270; val_kl_reg_loss: 6477.0242; val_edge_recon_loss: 265381.6878; val_gene_expr_recon_loss: 80996.5075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 352855.2186; val_optim_loss: 352855.2186

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 187 min 58 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9792
val AUPRC score: 0.9727
val best accuracy score: 0.9372
val best F1 score: 0.9390
val target rna MSE score: 0.3005
val source rna MSE score: 0.2294

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
