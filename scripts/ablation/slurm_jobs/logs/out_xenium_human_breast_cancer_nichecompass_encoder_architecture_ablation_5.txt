None
Run timestamp: 10072023_171848_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9397; val_auprc_score: 0.9224; val_best_acc_score: 0.8771; val_best_f1_score: 0.8848; train_kl_reg_loss: 6143.0149; train_edge_recon_loss: 274635.4162; train_gene_expr_recon_loss: 81681.3678; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362459.8000; train_optim_loss: 362459.8000; val_kl_reg_loss: 6030.8549; val_edge_recon_loss: 269668.6780; val_gene_expr_recon_loss: 72491.4205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 348190.9531; val_optim_loss: 348190.9531
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9510; val_auprc_score: 0.9353; val_best_acc_score: 0.8946; val_best_f1_score: 0.9002; train_kl_reg_loss: 5909.6949; train_edge_recon_loss: 265715.9860; train_gene_expr_recon_loss: 68996.8647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 340622.5453; train_optim_loss: 340622.5453; val_kl_reg_loss: 5737.6763; val_edge_recon_loss: 269079.0210; val_gene_expr_recon_loss: 65884.9288; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 340701.6262; val_optim_loss: 340701.6262
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9610; val_auprc_score: 0.9499; val_best_acc_score: 0.9056; val_best_f1_score: 0.9098; train_kl_reg_loss: 5882.4143; train_edge_recon_loss: 264460.3333; train_gene_expr_recon_loss: 62871.7276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333214.4754; train_optim_loss: 333214.4754; val_kl_reg_loss: 6070.3138; val_edge_recon_loss: 268165.2146; val_gene_expr_recon_loss: 59759.8166; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333995.3458; val_optim_loss: 333995.3458
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9648; val_auprc_score: 0.9557; val_best_acc_score: 0.9122; val_best_f1_score: 0.9156; train_kl_reg_loss: 6018.5299; train_edge_recon_loss: 263800.7382; train_gene_expr_recon_loss: 57280.9042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327100.1726; train_optim_loss: 327100.1726; val_kl_reg_loss: 6080.9689; val_edge_recon_loss: 267900.6137; val_gene_expr_recon_loss: 54796.8888; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328778.4720; val_optim_loss: 328778.4720
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9674; val_auprc_score: 0.9579; val_best_acc_score: 0.9179; val_best_f1_score: 0.9209; train_kl_reg_loss: 6137.4224; train_edge_recon_loss: 263426.1790; train_gene_expr_recon_loss: 53327.7536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322891.3547; train_optim_loss: 322891.3547; val_kl_reg_loss: 6161.5686; val_edge_recon_loss: 267336.0555; val_gene_expr_recon_loss: 51600.6998; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325098.3240; val_optim_loss: 325098.3240
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9681; val_auprc_score: 0.9588; val_best_acc_score: 0.9179; val_best_f1_score: 0.9210; train_kl_reg_loss: 6202.1281; train_edge_recon_loss: 263255.4789; train_gene_expr_recon_loss: 50709.3519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320166.9596; train_optim_loss: 320166.9596; val_kl_reg_loss: 6170.1863; val_edge_recon_loss: 267288.7568; val_gene_expr_recon_loss: 49388.4878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322847.4317; val_optim_loss: 322847.4317
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9677; val_auprc_score: 0.9578; val_best_acc_score: 0.9188; val_best_f1_score: 0.9214; train_kl_reg_loss: 6235.6236; train_edge_recon_loss: 263058.7165; train_gene_expr_recon_loss: 48887.2904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318181.6313; train_optim_loss: 318181.6313; val_kl_reg_loss: 6251.3901; val_edge_recon_loss: 267289.6937; val_gene_expr_recon_loss: 47896.8647; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321437.9498; val_optim_loss: 321437.9498
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9696; val_auprc_score: 0.9607; val_best_acc_score: 0.9205; val_best_f1_score: 0.9232; train_kl_reg_loss: 6269.0358; train_edge_recon_loss: 262742.7267; train_gene_expr_recon_loss: 47617.4788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 316629.2415; train_optim_loss: 316629.2415; val_kl_reg_loss: 6282.8217; val_edge_recon_loss: 266799.3232; val_gene_expr_recon_loss: 46787.5749; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319869.7175; val_optim_loss: 319869.7175
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9698; val_auprc_score: 0.9600; val_best_acc_score: 0.9225; val_best_f1_score: 0.9253; train_kl_reg_loss: 6277.3800; train_edge_recon_loss: 262695.7465; train_gene_expr_recon_loss: 46691.3732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 315664.4997; train_optim_loss: 315664.4997; val_kl_reg_loss: 6344.7041; val_edge_recon_loss: 266445.7654; val_gene_expr_recon_loss: 46003.3005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318793.7701; val_optim_loss: 318793.7701
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9723; val_auprc_score: 0.9647; val_best_acc_score: 0.9244; val_best_f1_score: 0.9267; train_kl_reg_loss: 6279.1265; train_edge_recon_loss: 262536.2029; train_gene_expr_recon_loss: 45963.5275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 314778.8572; train_optim_loss: 314778.8572; val_kl_reg_loss: 6322.4068; val_edge_recon_loss: 266883.2120; val_gene_expr_recon_loss: 45466.7885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318672.4067; val_optim_loss: 318672.4067
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9707; val_auprc_score: 0.9614; val_best_acc_score: 0.9238; val_best_f1_score: 0.9265; train_kl_reg_loss: 6287.3363; train_edge_recon_loss: 262512.3286; train_gene_expr_recon_loss: 45405.8285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 314205.4942; train_optim_loss: 314205.4942; val_kl_reg_loss: 6274.0668; val_edge_recon_loss: 266603.2089; val_gene_expr_recon_loss: 44987.3135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317864.5892; val_optim_loss: 317864.5892
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9734; val_auprc_score: 0.9664; val_best_acc_score: 0.9247; val_best_f1_score: 0.9271; train_kl_reg_loss: 6286.7556; train_edge_recon_loss: 262371.8633; train_gene_expr_recon_loss: 44965.0491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 313623.6675; train_optim_loss: 313623.6675; val_kl_reg_loss: 6285.9571; val_edge_recon_loss: 266811.5948; val_gene_expr_recon_loss: 44511.3418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317608.8923; val_optim_loss: 317608.8923
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9718; val_auprc_score: 0.9635; val_best_acc_score: 0.9248; val_best_f1_score: 0.9274; train_kl_reg_loss: 6283.6992; train_edge_recon_loss: 262359.9814; train_gene_expr_recon_loss: 44583.4365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 313227.1174; train_optim_loss: 313227.1174; val_kl_reg_loss: 6340.9684; val_edge_recon_loss: 266715.2331; val_gene_expr_recon_loss: 44134.2479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317190.4482; val_optim_loss: 317190.4482
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9737; val_auprc_score: 0.9662; val_best_acc_score: 0.9270; val_best_f1_score: 0.9295; train_kl_reg_loss: 6283.4094; train_edge_recon_loss: 262153.2232; train_gene_expr_recon_loss: 44286.5040; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 312723.1360; train_optim_loss: 312723.1360; val_kl_reg_loss: 6307.2225; val_edge_recon_loss: 266434.5847; val_gene_expr_recon_loss: 43924.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 316666.6731; val_optim_loss: 316666.6731
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9740; val_auprc_score: 0.9668; val_best_acc_score: 0.9265; val_best_f1_score: 0.9293; train_kl_reg_loss: 6284.5792; train_edge_recon_loss: 262210.7374; train_gene_expr_recon_loss: 44009.3406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 312504.6570; train_optim_loss: 312504.6570; val_kl_reg_loss: 6229.4339; val_edge_recon_loss: 266647.0413; val_gene_expr_recon_loss: 43800.7930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 316677.2710; val_optim_loss: 316677.2710
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9726; val_auprc_score: 0.9636; val_best_acc_score: 0.9265; val_best_f1_score: 0.9289; train_kl_reg_loss: 6295.7618; train_edge_recon_loss: 261921.2189; train_gene_expr_recon_loss: 43783.7946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 312000.7750; train_optim_loss: 312000.7750; val_kl_reg_loss: 6296.6518; val_edge_recon_loss: 266756.6867; val_gene_expr_recon_loss: 43487.4360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 316540.7722; val_optim_loss: 316540.7722
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9745; val_auprc_score: 0.9671; val_best_acc_score: 0.9277; val_best_f1_score: 0.9296; train_kl_reg_loss: 6286.7444; train_edge_recon_loss: 262055.5507; train_gene_expr_recon_loss: 43571.8357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 311914.1308; train_optim_loss: 311914.1308; val_kl_reg_loss: 6276.9501; val_edge_recon_loss: 265994.5097; val_gene_expr_recon_loss: 43344.3995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 315615.8573; val_optim_loss: 315615.8573
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9761; val_auprc_score: 0.9694; val_best_acc_score: 0.9300; val_best_f1_score: 0.9320; train_kl_reg_loss: 6289.1629; train_edge_recon_loss: 261830.8333; train_gene_expr_recon_loss: 43357.6721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 311477.6676; train_optim_loss: 311477.6676; val_kl_reg_loss: 6353.1104; val_edge_recon_loss: 265713.4206; val_gene_expr_recon_loss: 42976.1859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 315042.7150; val_optim_loss: 315042.7150
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9744; val_auprc_score: 0.9666; val_best_acc_score: 0.9283; val_best_f1_score: 0.9308; train_kl_reg_loss: 6291.1888; train_edge_recon_loss: 261807.8781; train_gene_expr_recon_loss: 43205.0138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 311304.0803; train_optim_loss: 311304.0803; val_kl_reg_loss: 6313.0716; val_edge_recon_loss: 266314.1412; val_gene_expr_recon_loss: 42911.8130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 315539.0259; val_optim_loss: 315539.0259
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9748; val_auprc_score: 0.9676; val_best_acc_score: 0.9283; val_best_f1_score: 0.9305; train_kl_reg_loss: 6300.3079; train_edge_recon_loss: 261808.6713; train_gene_expr_recon_loss: 43062.5079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 311171.4867; train_optim_loss: 311171.4867; val_kl_reg_loss: 6211.7071; val_edge_recon_loss: 266623.0025; val_gene_expr_recon_loss: 42897.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 315732.1332; val_optim_loss: 315732.1332
