None
Run timestamp: 28072023_160151_68.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_68']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9842; val_auprc_score: 0.9810; val_best_acc_score: 0.9418; val_best_f1_score: 0.9431; train_kl_reg_loss: 2098.3182; train_edge_recon_loss: 27582.4641; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29680.7824; train_optim_loss: 29680.7824; val_kl_reg_loss: 2156.4532; val_edge_recon_loss: 26137.5187; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28293.9719; val_optim_loss: 28293.9719
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9900; val_auprc_score: 0.9876; val_best_acc_score: 0.9584; val_best_f1_score: 0.9591; train_kl_reg_loss: 2183.9088; train_edge_recon_loss: 27216.4051; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29400.3139; train_optim_loss: 29400.3139; val_kl_reg_loss: 2202.1206; val_edge_recon_loss: 26091.2875; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28293.4080; val_optim_loss: 28293.4080
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9913; val_auprc_score: 0.9889; val_best_acc_score: 0.9628; val_best_f1_score: 0.9633; train_kl_reg_loss: 2204.8975; train_edge_recon_loss: 27129.5708; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29334.4683; train_optim_loss: 29334.4683; val_kl_reg_loss: 2148.8508; val_edge_recon_loss: 25981.6093; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28130.4601; val_optim_loss: 28130.4601
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9922; val_auprc_score: 0.9904; val_best_acc_score: 0.9652; val_best_f1_score: 0.9657; train_kl_reg_loss: 2214.5465; train_edge_recon_loss: 27078.9339; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29293.4804; train_optim_loss: 29293.4804; val_kl_reg_loss: 2229.9699; val_edge_recon_loss: 25983.8130; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28213.7829; val_optim_loss: 28213.7829
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9921; val_auprc_score: 0.9901; val_best_acc_score: 0.9657; val_best_f1_score: 0.9662; train_kl_reg_loss: 2218.7590; train_edge_recon_loss: 27055.0547; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29273.8137; train_optim_loss: 29273.8137; val_kl_reg_loss: 2206.8383; val_edge_recon_loss: 25927.7154; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28134.5537; val_optim_loss: 28134.5537
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9926; val_auprc_score: 0.9903; val_best_acc_score: 0.9670; val_best_f1_score: 0.9675; train_kl_reg_loss: 2223.0679; train_edge_recon_loss: 27029.9616; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29253.0295; train_optim_loss: 29253.0295; val_kl_reg_loss: 2268.9313; val_edge_recon_loss: 25877.3432; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28146.2746; val_optim_loss: 28146.2746
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9929; val_auprc_score: 0.9907; val_best_acc_score: 0.9688; val_best_f1_score: 0.9693; train_kl_reg_loss: 2225.7589; train_edge_recon_loss: 27010.4931; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29236.2520; train_optim_loss: 29236.2520; val_kl_reg_loss: 2345.7957; val_edge_recon_loss: 25845.1733; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28190.9690; val_optim_loss: 28190.9690
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9940; val_auprc_score: 0.9923; val_best_acc_score: 0.9713; val_best_f1_score: 0.9716; train_kl_reg_loss: 2225.6188; train_edge_recon_loss: 27004.4447; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29230.0635; train_optim_loss: 29230.0635; val_kl_reg_loss: 2231.2426; val_edge_recon_loss: 25870.5470; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28101.7896; val_optim_loss: 28101.7896
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9942; val_auprc_score: 0.9925; val_best_acc_score: 0.9726; val_best_f1_score: 0.9730; train_kl_reg_loss: 2228.9655; train_edge_recon_loss: 26979.4104; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29208.3759; train_optim_loss: 29208.3759; val_kl_reg_loss: 2211.0321; val_edge_recon_loss: 25863.8109; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28074.8430; val_optim_loss: 28074.8430
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9942; val_auprc_score: 0.9924; val_best_acc_score: 0.9728; val_best_f1_score: 0.9732; train_kl_reg_loss: 2230.7680; train_edge_recon_loss: 26968.2068; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29198.9748; train_optim_loss: 29198.9748; val_kl_reg_loss: 2291.7546; val_edge_recon_loss: 25841.3586; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28133.1132; val_optim_loss: 28133.1132
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9945; val_auprc_score: 0.9926; val_best_acc_score: 0.9737; val_best_f1_score: 0.9739; train_kl_reg_loss: 2232.8362; train_edge_recon_loss: 26952.2989; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29185.1351; train_optim_loss: 29185.1351; val_kl_reg_loss: 2190.7619; val_edge_recon_loss: 25819.0982; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28009.8600; val_optim_loss: 28009.8600
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9947; val_auprc_score: 0.9930; val_best_acc_score: 0.9746; val_best_f1_score: 0.9749; train_kl_reg_loss: 2233.6049; train_edge_recon_loss: 26947.6613; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29181.2662; train_optim_loss: 29181.2662; val_kl_reg_loss: 2311.9739; val_edge_recon_loss: 25918.1441; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28230.1180; val_optim_loss: 28230.1180
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9952; val_auprc_score: 0.9939; val_best_acc_score: 0.9754; val_best_f1_score: 0.9757; train_kl_reg_loss: 2234.3201; train_edge_recon_loss: 26944.2119; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29178.5320; train_optim_loss: 29178.5320; val_kl_reg_loss: 2205.1291; val_edge_recon_loss: 25787.9852; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27993.1143; val_optim_loss: 27993.1143
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9951; val_auprc_score: 0.9935; val_best_acc_score: 0.9760; val_best_f1_score: 0.9763; train_kl_reg_loss: 2236.8590; train_edge_recon_loss: 26930.2607; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29167.1197; train_optim_loss: 29167.1197; val_kl_reg_loss: 2265.7220; val_edge_recon_loss: 25753.4766; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28019.1986; val_optim_loss: 28019.1986
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9949; val_auprc_score: 0.9932; val_best_acc_score: 0.9750; val_best_f1_score: 0.9753; train_kl_reg_loss: 2237.4698; train_edge_recon_loss: 26923.2472; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29160.7170; train_optim_loss: 29160.7170; val_kl_reg_loss: 2234.6398; val_edge_recon_loss: 25761.3846; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27996.0244; val_optim_loss: 27996.0244
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9952; val_auprc_score: 0.9935; val_best_acc_score: 0.9759; val_best_f1_score: 0.9762; train_kl_reg_loss: 2238.2697; train_edge_recon_loss: 26913.8752; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29152.1449; train_optim_loss: 29152.1449; val_kl_reg_loss: 2240.5234; val_edge_recon_loss: 25729.3966; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27969.9200; val_optim_loss: 27969.9200
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9955; val_auprc_score: 0.9942; val_best_acc_score: 0.9771; val_best_f1_score: 0.9774; train_kl_reg_loss: 2240.4137; train_edge_recon_loss: 26906.5067; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29146.9204; train_optim_loss: 29146.9204; val_kl_reg_loss: 2223.4072; val_edge_recon_loss: 25731.6751; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27955.0823; val_optim_loss: 27955.0823
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9949; val_auprc_score: 0.9931; val_best_acc_score: 0.9757; val_best_f1_score: 0.9760; train_kl_reg_loss: 2240.6364; train_edge_recon_loss: 26902.2388; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29142.8752; train_optim_loss: 29142.8752; val_kl_reg_loss: 2280.9574; val_edge_recon_loss: 25762.9823; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28043.9397; val_optim_loss: 28043.9397
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9955; val_auprc_score: 0.9941; val_best_acc_score: 0.9771; val_best_f1_score: 0.9774; train_kl_reg_loss: 2241.4663; train_edge_recon_loss: 26893.8120; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29135.2783; train_optim_loss: 29135.2783; val_kl_reg_loss: 2219.5557; val_edge_recon_loss: 25780.4230; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27999.9787; val_optim_loss: 27999.9787
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9958; val_auprc_score: 0.9946; val_best_acc_score: 0.9775; val_best_f1_score: 0.9777; train_kl_reg_loss: 2242.1341; train_edge_recon_loss: 26898.8857; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29141.0198; train_optim_loss: 29141.0198; val_kl_reg_loss: 2259.6758; val_edge_recon_loss: 25727.6578; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27987.3336; val_optim_loss: 27987.3336
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9955; val_auprc_score: 0.9940; val_best_acc_score: 0.9780; val_best_f1_score: 0.9783; train_kl_reg_loss: 2242.7083; train_edge_recon_loss: 26888.9939; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29131.7022; train_optim_loss: 29131.7022; val_kl_reg_loss: 2236.0271; val_edge_recon_loss: 25742.1825; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27978.2096; val_optim_loss: 27978.2096

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9959; val_auprc_score: 0.9944; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 2237.0643; train_edge_recon_loss: 26868.5629; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29105.6272; train_optim_loss: 29105.6272; val_kl_reg_loss: 2232.3674; val_edge_recon_loss: 25684.5901; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27916.9575; val_optim_loss: 27916.9575
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9956; val_auprc_score: 0.9941; val_best_acc_score: 0.9789; val_best_f1_score: 0.9791; train_kl_reg_loss: 2238.5450; train_edge_recon_loss: 26858.6029; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29097.1479; train_optim_loss: 29097.1479; val_kl_reg_loss: 2227.0302; val_edge_recon_loss: 25694.3587; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27921.3890; val_optim_loss: 27921.3890
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9959; val_auprc_score: 0.9944; val_best_acc_score: 0.9795; val_best_f1_score: 0.9797; train_kl_reg_loss: 2237.3254; train_edge_recon_loss: 26856.7615; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29094.0869; train_optim_loss: 29094.0869; val_kl_reg_loss: 2220.7759; val_edge_recon_loss: 25683.5976; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27904.3735; val_optim_loss: 27904.3735
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9960; val_auprc_score: 0.9946; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 2237.9662; train_edge_recon_loss: 26849.7939; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29087.7601; train_optim_loss: 29087.7601; val_kl_reg_loss: 2234.4398; val_edge_recon_loss: 25680.3397; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27914.7795; val_optim_loss: 27914.7795
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9962; val_auprc_score: 0.9949; val_best_acc_score: 0.9799; val_best_f1_score: 0.9801; train_kl_reg_loss: 2237.3640; train_edge_recon_loss: 26855.6800; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29093.0440; train_optim_loss: 29093.0440; val_kl_reg_loss: 2223.1329; val_edge_recon_loss: 25676.3953; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27899.5281; val_optim_loss: 27899.5281
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9961; val_auprc_score: 0.9947; val_best_acc_score: 0.9801; val_best_f1_score: 0.9802; train_kl_reg_loss: 2236.5450; train_edge_recon_loss: 26851.7797; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29088.3246; train_optim_loss: 29088.3246; val_kl_reg_loss: 2223.4564; val_edge_recon_loss: 25659.8939; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27883.3503; val_optim_loss: 27883.3503
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9962; val_auprc_score: 0.9948; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 2236.0494; train_edge_recon_loss: 26855.2412; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29091.2907; train_optim_loss: 29091.2907; val_kl_reg_loss: 2228.7139; val_edge_recon_loss: 25671.3520; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27900.0659; val_optim_loss: 27900.0659
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9961; val_auprc_score: 0.9947; val_best_acc_score: 0.9802; val_best_f1_score: 0.9803; train_kl_reg_loss: 2237.5665; train_edge_recon_loss: 26843.5560; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29081.1225; train_optim_loss: 29081.1225; val_kl_reg_loss: 2223.0087; val_edge_recon_loss: 25663.5995; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27886.6083; val_optim_loss: 27886.6083
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9959; val_auprc_score: 0.9944; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 2237.1678; train_edge_recon_loss: 26846.1619; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29083.3297; train_optim_loss: 29083.3297; val_kl_reg_loss: 2234.0854; val_edge_recon_loss: 25681.6804; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27915.7659; val_optim_loss: 27915.7659
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9960; val_auprc_score: 0.9944; val_best_acc_score: 0.9803; val_best_f1_score: 0.9804; train_kl_reg_loss: 2236.6766; train_edge_recon_loss: 26848.9086; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29085.5852; train_optim_loss: 29085.5852; val_kl_reg_loss: 2226.2795; val_edge_recon_loss: 25678.8104; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27905.0898; val_optim_loss: 27905.0898

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9961; val_auprc_score: 0.9947; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 2237.4522; train_edge_recon_loss: 26843.4977; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29080.9499; train_optim_loss: 29080.9499; val_kl_reg_loss: 2234.1033; val_edge_recon_loss: 25658.3724; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27892.4756; val_optim_loss: 27892.4756
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9961; val_auprc_score: 0.9946; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 2236.2054; train_edge_recon_loss: 26843.2083; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29079.4138; train_optim_loss: 29079.4138; val_kl_reg_loss: 2236.9722; val_edge_recon_loss: 25668.4964; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27905.4686; val_optim_loss: 27905.4686
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9958; val_auprc_score: 0.9943; val_best_acc_score: 0.9795; val_best_f1_score: 0.9797; train_kl_reg_loss: 2236.1309; train_edge_recon_loss: 26845.4321; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29081.5631; train_optim_loss: 29081.5631; val_kl_reg_loss: 2236.1478; val_edge_recon_loss: 25700.0350; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27936.1828; val_optim_loss: 27936.1828
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9960; val_auprc_score: 0.9947; val_best_acc_score: 0.9800; val_best_f1_score: 0.9801; train_kl_reg_loss: 2236.0212; train_edge_recon_loss: 26843.5636; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29079.5848; train_optim_loss: 29079.5848; val_kl_reg_loss: 2235.4015; val_edge_recon_loss: 25657.6697; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27893.0711; val_optim_loss: 27893.0711

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 555 min 57 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
val AUROC score: 0.9960
val AUPRC score: 0.9945
val best accuracy score: 0.9799
val best F1 score: 0.9800
val target rna MSE score: 5.3882
val source rna MSE score: 3.1833

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
