None
Run timestamp: 05082023_112330_18.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_fc_layers_encoder', '1', '--n_layers_encoder', '2', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '128', '--n_sampled_neighbors', '4', '--node_batch_size', 'None', '--timestamp_suffix', '_18']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_hidden: 500, n_latent: 1385, n_addon_latent: 10, n_fc_layers: 1, n_layers: 2, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1385, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 500
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1385, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 500

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 128
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9950; val_auprc_score: 0.9949; val_best_acc_score: 0.9654; val_best_f1_score: 0.9655; train_kl_reg_loss: 7378.1191; train_edge_recon_loss: 264924.7226; train_gene_expr_recon_loss: 190543.3635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 462846.2052; train_optim_loss: 462846.2052; val_kl_reg_loss: 6516.8891; val_edge_recon_loss: 261390.8529; val_gene_expr_recon_loss: 179112.4501; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 447020.1915; val_optim_loss: 447020.1915
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9964; val_auprc_score: 0.9964; val_best_acc_score: 0.9716; val_best_f1_score: 0.9717; train_kl_reg_loss: 6651.8737; train_edge_recon_loss: 259932.5323; train_gene_expr_recon_loss: 178213.7053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444798.1114; train_optim_loss: 444798.1114; val_kl_reg_loss: 6518.3255; val_edge_recon_loss: 260199.6624; val_gene_expr_recon_loss: 177082.9108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443800.8987; val_optim_loss: 443800.8987
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9970; val_auprc_score: 0.9969; val_best_acc_score: 0.9745; val_best_f1_score: 0.9746; train_kl_reg_loss: 6578.4489; train_edge_recon_loss: 259127.5609; train_gene_expr_recon_loss: 177128.4054; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 442834.4152; train_optim_loss: 442834.4152; val_kl_reg_loss: 6315.4809; val_edge_recon_loss: 259485.4098; val_gene_expr_recon_loss: 176430.3264; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442231.2171; val_optim_loss: 442231.2171
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9973; val_auprc_score: 0.9973; val_best_acc_score: 0.9763; val_best_f1_score: 0.9763; train_kl_reg_loss: 6559.5892; train_edge_recon_loss: 258545.3670; train_gene_expr_recon_loss: 176835.9073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441940.8637; train_optim_loss: 441940.8637; val_kl_reg_loss: 6371.8057; val_edge_recon_loss: 259132.4037; val_gene_expr_recon_loss: 176019.4676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441523.6770; val_optim_loss: 441523.6770
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9975; val_auprc_score: 0.9975; val_best_acc_score: 0.9777; val_best_f1_score: 0.9777; train_kl_reg_loss: 6558.2151; train_edge_recon_loss: 258217.7017; train_gene_expr_recon_loss: 176591.7949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441367.7116; train_optim_loss: 441367.7116; val_kl_reg_loss: 6507.3696; val_edge_recon_loss: 258739.5632; val_gene_expr_recon_loss: 175903.8720; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441150.8046; val_optim_loss: 441150.8046
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9977; val_auprc_score: 0.9977; val_best_acc_score: 0.9787; val_best_f1_score: 0.9787; train_kl_reg_loss: 6561.9685; train_edge_recon_loss: 257948.4218; train_gene_expr_recon_loss: 176380.0263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440890.4165; train_optim_loss: 440890.4165; val_kl_reg_loss: 6500.5166; val_edge_recon_loss: 258593.2182; val_gene_expr_recon_loss: 175550.0664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440643.8015; val_optim_loss: 440643.8015
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9976; val_auprc_score: 0.9975; val_best_acc_score: 0.9780; val_best_f1_score: 0.9781; train_kl_reg_loss: 6567.1691; train_edge_recon_loss: 257760.8381; train_gene_expr_recon_loss: 176276.0498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440604.0570; train_optim_loss: 440604.0570; val_kl_reg_loss: 6516.1371; val_edge_recon_loss: 258304.6654; val_gene_expr_recon_loss: 175639.0534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440459.8561; val_optim_loss: 440459.8561
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9980; val_auprc_score: 0.9978; val_best_acc_score: 0.9798; val_best_f1_score: 0.9799; train_kl_reg_loss: 6570.0494; train_edge_recon_loss: 257649.4591; train_gene_expr_recon_loss: 176134.6716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440354.1803; train_optim_loss: 440354.1803; val_kl_reg_loss: 6657.1446; val_edge_recon_loss: 258076.7420; val_gene_expr_recon_loss: 175548.8228; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440282.7097; val_optim_loss: 440282.7097
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9980; val_auprc_score: 0.9979; val_best_acc_score: 0.9801; val_best_f1_score: 0.9802; train_kl_reg_loss: 6569.3086; train_edge_recon_loss: 257562.2808; train_gene_expr_recon_loss: 176093.2502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440224.8398; train_optim_loss: 440224.8398; val_kl_reg_loss: 6498.3579; val_edge_recon_loss: 258201.0676; val_gene_expr_recon_loss: 175363.0426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440062.4689; val_optim_loss: 440062.4689
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9979; val_auprc_score: 0.9977; val_best_acc_score: 0.9794; val_best_f1_score: 0.9794; train_kl_reg_loss: 6572.6027; train_edge_recon_loss: 257448.0499; train_gene_expr_recon_loss: 175955.4728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 439976.1254; train_optim_loss: 439976.1254; val_kl_reg_loss: 6439.0473; val_edge_recon_loss: 258192.9211; val_gene_expr_recon_loss: 175382.1884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440014.1562; val_optim_loss: 440014.1562
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9980; val_auprc_score: 0.9980; val_best_acc_score: 0.9803; val_best_f1_score: 0.9804; train_kl_reg_loss: 6577.3775; train_edge_recon_loss: 257361.5060; train_gene_expr_recon_loss: 175957.4588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 439896.3422; train_optim_loss: 439896.3422; val_kl_reg_loss: 6429.3629; val_edge_recon_loss: 258157.5052; val_gene_expr_recon_loss: 175143.3974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 439730.2656; val_optim_loss: 439730.2656
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9980; val_auprc_score: 0.9978; val_best_acc_score: 0.9808; val_best_f1_score: 0.9809; train_kl_reg_loss: 6579.2049; train_edge_recon_loss: 257320.7141; train_gene_expr_recon_loss: 175808.0848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 439708.0039; train_optim_loss: 439708.0039; val_kl_reg_loss: 6592.7854; val_edge_recon_loss: 258051.2276; val_gene_expr_recon_loss: 175287.8613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 439931.8745; val_optim_loss: 439931.8745
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9980; val_auprc_score: 0.9979; val_best_acc_score: 0.9807; val_best_f1_score: 0.9807; train_kl_reg_loss: 6586.5827; train_edge_recon_loss: 257211.6191; train_gene_expr_recon_loss: 175808.2261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 439606.4282; train_optim_loss: 439606.4282; val_kl_reg_loss: 6453.7530; val_edge_recon_loss: 257852.8637; val_gene_expr_recon_loss: 175096.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 439402.8893; val_optim_loss: 439402.8893
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9980; val_auprc_score: 0.9979; val_best_acc_score: 0.9807; val_best_f1_score: 0.9808; train_kl_reg_loss: 6590.6535; train_edge_recon_loss: 257187.7589; train_gene_expr_recon_loss: 175816.6893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 439595.1017; train_optim_loss: 439595.1017; val_kl_reg_loss: 6590.4313; val_edge_recon_loss: 257983.5038; val_gene_expr_recon_loss: 175059.2399; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 439633.1751; val_optim_loss: 439633.1751
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9980; val_auprc_score: 0.9978; val_best_acc_score: 0.9803; val_best_f1_score: 0.9803; train_kl_reg_loss: 6592.4891; train_edge_recon_loss: 257131.5298; train_gene_expr_recon_loss: 175711.9326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 439435.9512; train_optim_loss: 439435.9512; val_kl_reg_loss: 6545.7162; val_edge_recon_loss: 257670.5851; val_gene_expr_recon_loss: 175288.6799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 439504.9814; val_optim_loss: 439504.9814
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9980; val_auprc_score: 0.9979; val_best_acc_score: 0.9804; val_best_f1_score: 0.9804; train_kl_reg_loss: 6595.8393; train_edge_recon_loss: 257088.5104; train_gene_expr_recon_loss: 175692.6344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 439376.9843; train_optim_loss: 439376.9843; val_kl_reg_loss: 6591.9692; val_edge_recon_loss: 257907.0740; val_gene_expr_recon_loss: 175261.2302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 439760.2739; val_optim_loss: 439760.2739
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9981; val_auprc_score: 0.9981; val_best_acc_score: 0.9815; val_best_f1_score: 0.9816; train_kl_reg_loss: 6599.8089; train_edge_recon_loss: 257058.4079; train_gene_expr_recon_loss: 175631.4115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 439289.6284; train_optim_loss: 439289.6284; val_kl_reg_loss: 6673.3497; val_edge_recon_loss: 257698.5275; val_gene_expr_recon_loss: 175268.4977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 439640.3757; val_optim_loss: 439640.3757

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9985; val_auprc_score: 0.9984; val_best_acc_score: 0.9841; val_best_f1_score: 0.9842; train_kl_reg_loss: 6645.3706; train_edge_recon_loss: 256530.5150; train_gene_expr_recon_loss: 174438.7851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437614.6705; train_optim_loss: 437614.6705; val_kl_reg_loss: 6606.5492; val_edge_recon_loss: 257130.2133; val_gene_expr_recon_loss: 173730.6745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437467.4370; val_optim_loss: 437467.4370
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9985; val_auprc_score: 0.9984; val_best_acc_score: 0.9839; val_best_f1_score: 0.9839; train_kl_reg_loss: 6625.6580; train_edge_recon_loss: 256518.4057; train_gene_expr_recon_loss: 174194.0020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437338.0658; train_optim_loss: 437338.0658; val_kl_reg_loss: 6602.2306; val_edge_recon_loss: 256998.0642; val_gene_expr_recon_loss: 173594.4205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437194.7156; val_optim_loss: 437194.7156
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9985; val_auprc_score: 0.9982; val_best_acc_score: 0.9841; val_best_f1_score: 0.9841; train_kl_reg_loss: 6612.7868; train_edge_recon_loss: 256495.7626; train_gene_expr_recon_loss: 174104.0872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437212.6366; train_optim_loss: 437212.6366; val_kl_reg_loss: 6595.2362; val_edge_recon_loss: 256992.3173; val_gene_expr_recon_loss: 173636.3882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437223.9420; val_optim_loss: 437223.9420
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9986; val_auprc_score: 0.9984; val_best_acc_score: 0.9842; val_best_f1_score: 0.9842; train_kl_reg_loss: 6608.8424; train_edge_recon_loss: 256470.1259; train_gene_expr_recon_loss: 174007.8645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437086.8327; train_optim_loss: 437086.8327; val_kl_reg_loss: 6573.1814; val_edge_recon_loss: 257036.0274; val_gene_expr_recon_loss: 173617.0875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437226.2966; val_optim_loss: 437226.2966
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9986; val_auprc_score: 0.9986; val_best_acc_score: 0.9846; val_best_f1_score: 0.9847; train_kl_reg_loss: 6604.3760; train_edge_recon_loss: 256443.8077; train_gene_expr_recon_loss: 173957.1984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437005.3820; train_optim_loss: 437005.3820; val_kl_reg_loss: 6610.3346; val_edge_recon_loss: 256835.6474; val_gene_expr_recon_loss: 173570.6898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437016.6717; val_optim_loss: 437016.6717
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9987; val_auprc_score: 0.9986; val_best_acc_score: 0.9850; val_best_f1_score: 0.9850; train_kl_reg_loss: 6600.7675; train_edge_recon_loss: 256392.5196; train_gene_expr_recon_loss: 173907.3789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436900.6661; train_optim_loss: 436900.6661; val_kl_reg_loss: 6555.1436; val_edge_recon_loss: 256968.2439; val_gene_expr_recon_loss: 173479.2819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437002.6691; val_optim_loss: 437002.6691
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9987; val_auprc_score: 0.9986; val_best_acc_score: 0.9852; val_best_f1_score: 0.9852; train_kl_reg_loss: 6596.3863; train_edge_recon_loss: 256446.0203; train_gene_expr_recon_loss: 173905.9745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436948.3810; train_optim_loss: 436948.3810; val_kl_reg_loss: 6568.3667; val_edge_recon_loss: 256880.5670; val_gene_expr_recon_loss: 173335.2544; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436784.1881; val_optim_loss: 436784.1881
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9987; val_auprc_score: 0.9987; val_best_acc_score: 0.9847; val_best_f1_score: 0.9847; train_kl_reg_loss: 6592.5046; train_edge_recon_loss: 256418.1220; train_gene_expr_recon_loss: 173831.8148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436842.4414; train_optim_loss: 436842.4414; val_kl_reg_loss: 6551.5998; val_edge_recon_loss: 256744.0452; val_gene_expr_recon_loss: 173368.4942; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436664.1388; val_optim_loss: 436664.1388
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9987; val_auprc_score: 0.9986; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 6591.0335; train_edge_recon_loss: 256402.2038; train_gene_expr_recon_loss: 173850.4581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436843.6954; train_optim_loss: 436843.6954; val_kl_reg_loss: 6562.7295; val_edge_recon_loss: 256771.4449; val_gene_expr_recon_loss: 173373.0609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436707.2358; val_optim_loss: 436707.2358
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9987; val_auprc_score: 0.9987; val_best_acc_score: 0.9850; val_best_f1_score: 0.9851; train_kl_reg_loss: 6586.6351; train_edge_recon_loss: 256394.1648; train_gene_expr_recon_loss: 173782.5860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436763.3860; train_optim_loss: 436763.3860; val_kl_reg_loss: 6615.2554; val_edge_recon_loss: 256893.3375; val_gene_expr_recon_loss: 173260.3044; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436768.8972; val_optim_loss: 436768.8972
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9987; val_auprc_score: 0.9984; val_best_acc_score: 0.9851; val_best_f1_score: 0.9851; train_kl_reg_loss: 6585.3180; train_edge_recon_loss: 256407.2594; train_gene_expr_recon_loss: 173765.8004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436758.3779; train_optim_loss: 436758.3779; val_kl_reg_loss: 6588.4467; val_edge_recon_loss: 256975.9498; val_gene_expr_recon_loss: 173384.3868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436948.7838; val_optim_loss: 436948.7838
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9988; val_auprc_score: 0.9987; val_best_acc_score: 0.9854; val_best_f1_score: 0.9854; train_kl_reg_loss: 6587.3303; train_edge_recon_loss: 256346.1480; train_gene_expr_recon_loss: 173781.1638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436714.6422; train_optim_loss: 436714.6422; val_kl_reg_loss: 6570.6313; val_edge_recon_loss: 256722.7574; val_gene_expr_recon_loss: 173373.8419; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436667.2301; val_optim_loss: 436667.2301

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9988; val_auprc_score: 0.9987; val_best_acc_score: 0.9857; val_best_f1_score: 0.9857; train_kl_reg_loss: 6589.2985; train_edge_recon_loss: 256269.1609; train_gene_expr_recon_loss: 173557.7825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436416.2419; train_optim_loss: 436416.2419; val_kl_reg_loss: 6571.4577; val_edge_recon_loss: 256701.1962; val_gene_expr_recon_loss: 173153.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436426.0523; val_optim_loss: 436426.0523
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9989; val_auprc_score: 0.9988; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 6591.0462; train_edge_recon_loss: 256299.7939; train_gene_expr_recon_loss: 173530.7631; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436421.6031; train_optim_loss: 436421.6031; val_kl_reg_loss: 6563.9652; val_edge_recon_loss: 256788.7309; val_gene_expr_recon_loss: 173194.7275; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436547.4237; val_optim_loss: 436547.4237
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9988; val_auprc_score: 0.9986; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 6590.1053; train_edge_recon_loss: 256286.4119; train_gene_expr_recon_loss: 173594.0099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436470.5272; train_optim_loss: 436470.5272; val_kl_reg_loss: 6554.0592; val_edge_recon_loss: 256649.2997; val_gene_expr_recon_loss: 173110.4876; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436313.8462; val_optim_loss: 436313.8462
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9988; val_auprc_score: 0.9986; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 6586.4528; train_edge_recon_loss: 256266.6464; train_gene_expr_recon_loss: 173544.5789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436397.6780; train_optim_loss: 436397.6780; val_kl_reg_loss: 6571.6827; val_edge_recon_loss: 256705.3744; val_gene_expr_recon_loss: 173272.6333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436549.6905; val_optim_loss: 436549.6905
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9988; val_auprc_score: 0.9988; val_best_acc_score: 0.9861; val_best_f1_score: 0.9861; train_kl_reg_loss: 6586.7248; train_edge_recon_loss: 256304.7003; train_gene_expr_recon_loss: 173569.1659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436460.5911; train_optim_loss: 436460.5911; val_kl_reg_loss: 6559.0432; val_edge_recon_loss: 256693.1117; val_gene_expr_recon_loss: 173187.4826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436439.6378; val_optim_loss: 436439.6378
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9988; val_auprc_score: 0.9986; val_best_acc_score: 0.9860; val_best_f1_score: 0.9860; train_kl_reg_loss: 6588.0160; train_edge_recon_loss: 256262.3677; train_gene_expr_recon_loss: 173547.4108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436397.7945; train_optim_loss: 436397.7945; val_kl_reg_loss: 6562.7359; val_edge_recon_loss: 256758.3245; val_gene_expr_recon_loss: 173338.6908; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436659.7512; val_optim_loss: 436659.7512
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9988; val_auprc_score: 0.9987; val_best_acc_score: 0.9859; val_best_f1_score: 0.9859; train_kl_reg_loss: 6586.1687; train_edge_recon_loss: 256268.2829; train_gene_expr_recon_loss: 173522.3362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436376.7880; train_optim_loss: 436376.7880; val_kl_reg_loss: 6555.4946; val_edge_recon_loss: 256679.7529; val_gene_expr_recon_loss: 173173.4930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436408.7405; val_optim_loss: 436408.7405

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9989; val_auprc_score: 0.9987; val_best_acc_score: 0.9862; val_best_f1_score: 0.9863; train_kl_reg_loss: 6585.1530; train_edge_recon_loss: 256254.9646; train_gene_expr_recon_loss: 173500.5910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436340.7087; train_optim_loss: 436340.7087; val_kl_reg_loss: 6563.5604; val_edge_recon_loss: 256628.9338; val_gene_expr_recon_loss: 173358.2651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436550.7597; val_optim_loss: 436550.7597
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9988; val_auprc_score: 0.9987; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 6586.5965; train_edge_recon_loss: 256307.7472; train_gene_expr_recon_loss: 173477.8080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436372.1517; train_optim_loss: 436372.1517; val_kl_reg_loss: 6561.1123; val_edge_recon_loss: 256559.3354; val_gene_expr_recon_loss: 173226.9089; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436347.3571; val_optim_loss: 436347.3571
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9988; val_auprc_score: 0.9988; val_best_acc_score: 0.9857; val_best_f1_score: 0.9857; train_kl_reg_loss: 6585.1014; train_edge_recon_loss: 256229.3661; train_gene_expr_recon_loss: 173510.3361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436324.8037; train_optim_loss: 436324.8037; val_kl_reg_loss: 6561.8161; val_edge_recon_loss: 256780.1233; val_gene_expr_recon_loss: 173241.4398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436583.3794; val_optim_loss: 436583.3794
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9988; val_auprc_score: 0.9987; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 6585.7937; train_edge_recon_loss: 256279.1606; train_gene_expr_recon_loss: 173511.1530; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436376.1074; train_optim_loss: 436376.1074; val_kl_reg_loss: 6561.0936; val_edge_recon_loss: 256702.2050; val_gene_expr_recon_loss: 173070.7164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436334.0142; val_optim_loss: 436334.0142

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 588 min 40 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
val AUROC score: 0.9988
val AUPRC score: 0.9987
val best accuracy score: 0.9857
val best F1 score: 0.9857
val target rna MSE score: 3.1346
val source rna MSE score: 0.4413

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
