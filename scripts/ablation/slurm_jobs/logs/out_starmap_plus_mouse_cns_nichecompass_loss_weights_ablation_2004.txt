None
Run timestamp: 16072023_212213_2004.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_2004']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8908; val_auprc_score: 0.8858; val_best_acc_score: 0.7982; val_best_f1_score: 0.8106; train_kl_reg_loss: 83056.6525; train_edge_recon_loss: 3406402.5534; train_gene_expr_recon_loss: 11828949.4427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15318408.6406; train_optim_loss: 15318408.6406; val_kl_reg_loss: 88991.8881; val_edge_recon_loss: 3034905.6023; val_gene_expr_recon_loss: 10690704.8182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13814602.4091; val_optim_loss: 13814602.4091
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9304; val_auprc_score: 0.9231; val_best_acc_score: 0.8455; val_best_f1_score: 0.8541; train_kl_reg_loss: 101789.1991; train_edge_recon_loss: 2890818.0768; train_gene_expr_recon_loss: 10457793.6094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13450400.8646; train_optim_loss: 13450400.8646; val_kl_reg_loss: 95563.6967; val_edge_recon_loss: 2857818.0000; val_gene_expr_recon_loss: 10267165.1818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13220546.7727; val_optim_loss: 13220546.7727
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9514; val_auprc_score: 0.9400; val_best_acc_score: 0.8860; val_best_f1_score: 0.8913; train_kl_reg_loss: 89789.1458; train_edge_recon_loss: 2800270.5013; train_gene_expr_recon_loss: 10163246.2344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13053305.9167; train_optim_loss: 13053305.9167; val_kl_reg_loss: 82621.9996; val_edge_recon_loss: 2795154.2159; val_gene_expr_recon_loss: 10038483.4545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12916259.6818; val_optim_loss: 12916259.6818
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9640; val_auprc_score: 0.9542; val_best_acc_score: 0.9077; val_best_f1_score: 0.9114; train_kl_reg_loss: 83177.8949; train_edge_recon_loss: 2741067.3906; train_gene_expr_recon_loss: 9965134.3594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12789379.6354; train_optim_loss: 12789379.6354; val_kl_reg_loss: 78306.1939; val_edge_recon_loss: 2756950.2955; val_gene_expr_recon_loss: 9900527.7727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12735784.2727; val_optim_loss: 12735784.2727
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9706; val_auprc_score: 0.9621; val_best_acc_score: 0.9222; val_best_f1_score: 0.9245; train_kl_reg_loss: 78431.0712; train_edge_recon_loss: 2709792.6159; train_gene_expr_recon_loss: 9806773.9479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12594997.6302; train_optim_loss: 12594997.6302; val_kl_reg_loss: 74323.3704; val_edge_recon_loss: 2730759.0114; val_gene_expr_recon_loss: 9757875.3636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12562957.7273; val_optim_loss: 12562957.7273
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9728; val_auprc_score: 0.9641; val_best_acc_score: 0.9279; val_best_f1_score: 0.9304; train_kl_reg_loss: 74083.1914; train_edge_recon_loss: 2691575.1797; train_gene_expr_recon_loss: 9666387.5260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12432045.9115; train_optim_loss: 12432045.9115; val_kl_reg_loss: 69961.9954; val_edge_recon_loss: 2714613.0568; val_gene_expr_recon_loss: 9632033.2273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12416608.2727; val_optim_loss: 12416608.2727
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9768; val_auprc_score: 0.9689; val_best_acc_score: 0.9346; val_best_f1_score: 0.9365; train_kl_reg_loss: 70248.5637; train_edge_recon_loss: 2682273.6901; train_gene_expr_recon_loss: 9534876.2604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12287398.5521; train_optim_loss: 12287398.5521; val_kl_reg_loss: 66307.2177; val_edge_recon_loss: 2706530.8182; val_gene_expr_recon_loss: 9533879.8636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12306717.9545; val_optim_loss: 12306717.9545
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9758; val_auprc_score: 0.9678; val_best_acc_score: 0.9351; val_best_f1_score: 0.9371; train_kl_reg_loss: 67109.3825; train_edge_recon_loss: 2674228.7396; train_gene_expr_recon_loss: 9412976.3646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12154314.4792; train_optim_loss: 12154314.4792; val_kl_reg_loss: 63956.7079; val_edge_recon_loss: 2706963.4659; val_gene_expr_recon_loss: 9419415.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12190335.1364; val_optim_loss: 12190335.1364
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9768; val_auprc_score: 0.9679; val_best_acc_score: 0.9374; val_best_f1_score: 0.9393; train_kl_reg_loss: 64473.3865; train_edge_recon_loss: 2667766.6849; train_gene_expr_recon_loss: 9308393.3073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12040633.3333; train_optim_loss: 12040633.3333; val_kl_reg_loss: 61814.9093; val_edge_recon_loss: 2691939.9205; val_gene_expr_recon_loss: 9338152.7273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12091907.5000; val_optim_loss: 12091907.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9773; val_auprc_score: 0.9693; val_best_acc_score: 0.9381; val_best_f1_score: 0.9399; train_kl_reg_loss: 62235.1652; train_edge_recon_loss: 2662932.7044; train_gene_expr_recon_loss: 9223030.2448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11948198.1198; train_optim_loss: 11948198.1198; val_kl_reg_loss: 59997.9957; val_edge_recon_loss: 2693674.5682; val_gene_expr_recon_loss: 9275063.7727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12028736.4091; val_optim_loss: 12028736.4091
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9768; val_auprc_score: 0.9684; val_best_acc_score: 0.9380; val_best_f1_score: 0.9400; train_kl_reg_loss: 60734.2578; train_edge_recon_loss: 2660295.1497; train_gene_expr_recon_loss: 9135725.9323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11856755.3281; train_optim_loss: 11856755.3281; val_kl_reg_loss: 58847.7905; val_edge_recon_loss: 2683016.8864; val_gene_expr_recon_loss: 9214389.2273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11956254.0909; val_optim_loss: 11956254.0909
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9784; val_auprc_score: 0.9700; val_best_acc_score: 0.9399; val_best_f1_score: 0.9415; train_kl_reg_loss: 59048.2154; train_edge_recon_loss: 2658889.0846; train_gene_expr_recon_loss: 9061240.0365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11779177.3594; train_optim_loss: 11779177.3594; val_kl_reg_loss: 57074.1610; val_edge_recon_loss: 2689733.6591; val_gene_expr_recon_loss: 9165093.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11911901.0455; val_optim_loss: 11911901.0455
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9780; val_auprc_score: 0.9702; val_best_acc_score: 0.9398; val_best_f1_score: 0.9415; train_kl_reg_loss: 57949.6348; train_edge_recon_loss: 2654348.7018; train_gene_expr_recon_loss: 9001896.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11714194.7188; train_optim_loss: 11714194.7188; val_kl_reg_loss: 55683.8393; val_edge_recon_loss: 2683311.5909; val_gene_expr_recon_loss: 9122977.6818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11861973.1818; val_optim_loss: 11861973.1818
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9784; val_auprc_score: 0.9712; val_best_acc_score: 0.9404; val_best_f1_score: 0.9422; train_kl_reg_loss: 56971.6941; train_edge_recon_loss: 2654365.2591; train_gene_expr_recon_loss: 8940723.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11652059.9792; train_optim_loss: 11652059.9792; val_kl_reg_loss: 55311.7786; val_edge_recon_loss: 2678387.7614; val_gene_expr_recon_loss: 9076676.7727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11810376.3182; val_optim_loss: 11810376.3182
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9777; val_auprc_score: 0.9697; val_best_acc_score: 0.9389; val_best_f1_score: 0.9407; train_kl_reg_loss: 55884.8241; train_edge_recon_loss: 2652030.1458; train_gene_expr_recon_loss: 8889987.6823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11597902.6875; train_optim_loss: 11597902.6875; val_kl_reg_loss: 54639.9927; val_edge_recon_loss: 2682659.4318; val_gene_expr_recon_loss: 9047426.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11784726.1818; val_optim_loss: 11784726.1818
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9789; val_auprc_score: 0.9722; val_best_acc_score: 0.9400; val_best_f1_score: 0.9418; train_kl_reg_loss: 55142.6314; train_edge_recon_loss: 2651179.9089; train_gene_expr_recon_loss: 8837069.7031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11543392.2396; train_optim_loss: 11543392.2396; val_kl_reg_loss: 53730.6655; val_edge_recon_loss: 2671782.3409; val_gene_expr_recon_loss: 9033277.6818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11758790.6818; val_optim_loss: 11758790.6818
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9784; val_auprc_score: 0.9707; val_best_acc_score: 0.9403; val_best_f1_score: 0.9422; train_kl_reg_loss: 54609.6887; train_edge_recon_loss: 2647494.1536; train_gene_expr_recon_loss: 8801047.4740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11503151.3021; train_optim_loss: 11503151.3021; val_kl_reg_loss: 52746.1962; val_edge_recon_loss: 2680847.2386; val_gene_expr_recon_loss: 8996348.1818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11729941.7273; val_optim_loss: 11729941.7273
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9788; val_auprc_score: 0.9716; val_best_acc_score: 0.9401; val_best_f1_score: 0.9420; train_kl_reg_loss: 53765.9501; train_edge_recon_loss: 2647403.9180; train_gene_expr_recon_loss: 8761053.3698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11462223.2031; train_optim_loss: 11462223.2031; val_kl_reg_loss: 52068.8407; val_edge_recon_loss: 2674783.2727; val_gene_expr_recon_loss: 8967942.1364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11694794.2273; val_optim_loss: 11694794.2273
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9771; val_auprc_score: 0.9685; val_best_acc_score: 0.9391; val_best_f1_score: 0.9413; train_kl_reg_loss: 53238.4067; train_edge_recon_loss: 2645380.7826; train_gene_expr_recon_loss: 8722105.6406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11420724.8385; train_optim_loss: 11420724.8385; val_kl_reg_loss: 51762.3860; val_edge_recon_loss: 2675054.7386; val_gene_expr_recon_loss: 8966999.3636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11693816.4091; val_optim_loss: 11693816.4091
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9789; val_auprc_score: 0.9717; val_best_acc_score: 0.9418; val_best_f1_score: 0.9434; train_kl_reg_loss: 52846.1576; train_edge_recon_loss: 2641366.4440; train_gene_expr_recon_loss: 8698098.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11392311.5938; train_optim_loss: 11392311.5938; val_kl_reg_loss: 51386.6032; val_edge_recon_loss: 2671859.7273; val_gene_expr_recon_loss: 8956695.6818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11679942.0000; val_optim_loss: 11679942.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9792; val_auprc_score: 0.9718; val_best_acc_score: 0.9419; val_best_f1_score: 0.9435; train_kl_reg_loss: 52444.9583; train_edge_recon_loss: 2642240.3776; train_gene_expr_recon_loss: 8665543.8854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11360229.2344; train_optim_loss: 11360229.2344; val_kl_reg_loss: 51202.2718; val_edge_recon_loss: 2673575.1818; val_gene_expr_recon_loss: 8960361.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11685138.9545; val_optim_loss: 11685138.9545
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9793; val_auprc_score: 0.9726; val_best_acc_score: 0.9414; val_best_f1_score: 0.9431; train_kl_reg_loss: 52099.7220; train_edge_recon_loss: 2641672.6068; train_gene_expr_recon_loss: 8642195.1406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11335967.4792; train_optim_loss: 11335967.4792; val_kl_reg_loss: 50506.6689; val_edge_recon_loss: 2671180.7500; val_gene_expr_recon_loss: 8931999.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11653687.0000; val_optim_loss: 11653687.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9785; val_auprc_score: 0.9715; val_best_acc_score: 0.9414; val_best_f1_score: 0.9431; train_kl_reg_loss: 51679.2096; train_edge_recon_loss: 2638889.3424; train_gene_expr_recon_loss: 8616121.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11306689.6823; train_optim_loss: 11306689.6823; val_kl_reg_loss: 50181.4638; val_edge_recon_loss: 2670575.0000; val_gene_expr_recon_loss: 8919414.3182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11640170.7727; val_optim_loss: 11640170.7727
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9791; val_auprc_score: 0.9720; val_best_acc_score: 0.9416; val_best_f1_score: 0.9432; train_kl_reg_loss: 51087.1678; train_edge_recon_loss: 2639016.8151; train_gene_expr_recon_loss: 8597158.8411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11287262.8333; train_optim_loss: 11287262.8333; val_kl_reg_loss: 49684.0344; val_edge_recon_loss: 2672752.8182; val_gene_expr_recon_loss: 8925278.5455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11647715.4091; val_optim_loss: 11647715.4091
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9793; val_auprc_score: 0.9726; val_best_acc_score: 0.9416; val_best_f1_score: 0.9435; train_kl_reg_loss: 50691.7340; train_edge_recon_loss: 2640624.7357; train_gene_expr_recon_loss: 8580727.0573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11272043.5260; train_optim_loss: 11272043.5260; val_kl_reg_loss: 49275.1491; val_edge_recon_loss: 2671933.1477; val_gene_expr_recon_loss: 8926517.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11647725.6364; val_optim_loss: 11647725.6364
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9790; val_auprc_score: 0.9721; val_best_acc_score: 0.9409; val_best_f1_score: 0.9426; train_kl_reg_loss: 50136.0315; train_edge_recon_loss: 2640359.9141; train_gene_expr_recon_loss: 8554383.2448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11244879.1667; train_optim_loss: 11244879.1667; val_kl_reg_loss: 49220.2827; val_edge_recon_loss: 2671914.8523; val_gene_expr_recon_loss: 8929158.5455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11650293.6818; val_optim_loss: 11650293.6818
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9788; val_auprc_score: 0.9719; val_best_acc_score: 0.9422; val_best_f1_score: 0.9440; train_kl_reg_loss: 49914.0089; train_edge_recon_loss: 2635884.1693; train_gene_expr_recon_loss: 8538186.2526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11223984.4375; train_optim_loss: 11223984.4375; val_kl_reg_loss: 48616.8908; val_edge_recon_loss: 2674749.2386; val_gene_expr_recon_loss: 8860746.4318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11584112.5455; val_optim_loss: 11584112.5455
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9808; val_auprc_score: 0.9743; val_best_acc_score: 0.9447; val_best_f1_score: 0.9461; train_kl_reg_loss: 49599.5697; train_edge_recon_loss: 2636049.7773; train_gene_expr_recon_loss: 8519689.4010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11205338.7344; train_optim_loss: 11205338.7344; val_kl_reg_loss: 48494.7725; val_edge_recon_loss: 2661452.7159; val_gene_expr_recon_loss: 8917629.3636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11627576.7727; val_optim_loss: 11627576.7727
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9796; val_auprc_score: 0.9728; val_best_acc_score: 0.9436; val_best_f1_score: 0.9453; train_kl_reg_loss: 49117.7593; train_edge_recon_loss: 2634993.5052; train_gene_expr_recon_loss: 8507364.2057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11191475.4688; train_optim_loss: 11191475.4688; val_kl_reg_loss: 47552.2834; val_edge_recon_loss: 2664517.7841; val_gene_expr_recon_loss: 8913563.3182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11625633.4091; val_optim_loss: 11625633.4091
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9800; val_auprc_score: 0.9734; val_best_acc_score: 0.9434; val_best_f1_score: 0.9451; train_kl_reg_loss: 48758.2854; train_edge_recon_loss: 2635542.8971; train_gene_expr_recon_loss: 8497956.7005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11182257.8854; train_optim_loss: 11182257.8854; val_kl_reg_loss: 47575.1854; val_edge_recon_loss: 2665903.1932; val_gene_expr_recon_loss: 8953473.5909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11666952.0000; val_optim_loss: 11666952.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9798; val_auprc_score: 0.9726; val_best_acc_score: 0.9440; val_best_f1_score: 0.9458; train_kl_reg_loss: 48420.0348; train_edge_recon_loss: 2634373.6901; train_gene_expr_recon_loss: 8486905.0859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11169698.7917; train_optim_loss: 11169698.7917; val_kl_reg_loss: 47076.2290; val_edge_recon_loss: 2667113.5795; val_gene_expr_recon_loss: 8932023.1818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11646213.0455; val_optim_loss: 11646213.0455

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9797; val_auprc_score: 0.9721; val_best_acc_score: 0.9431; val_best_f1_score: 0.9448; train_kl_reg_loss: 48626.3817; train_edge_recon_loss: 2632545.6068; train_gene_expr_recon_loss: 8410327.7214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11091499.6927; train_optim_loss: 11091499.6927; val_kl_reg_loss: 47310.8484; val_edge_recon_loss: 2664634.1136; val_gene_expr_recon_loss: 8884974.3636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11596919.2727; val_optim_loss: 11596919.2727
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9808; val_auprc_score: 0.9745; val_best_acc_score: 0.9444; val_best_f1_score: 0.9460; train_kl_reg_loss: 48424.1171; train_edge_recon_loss: 2630769.7331; train_gene_expr_recon_loss: 8402888.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11082082.2448; train_optim_loss: 11082082.2448; val_kl_reg_loss: 47179.3761; val_edge_recon_loss: 2659170.0568; val_gene_expr_recon_loss: 8875559.2273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11581908.6364; val_optim_loss: 11581908.6364
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9807; val_auprc_score: 0.9740; val_best_acc_score: 0.9456; val_best_f1_score: 0.9469; train_kl_reg_loss: 48462.9678; train_edge_recon_loss: 2630813.1979; train_gene_expr_recon_loss: 8398221.3724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11077497.5365; train_optim_loss: 11077497.5365; val_kl_reg_loss: 47253.2516; val_edge_recon_loss: 2662249.9318; val_gene_expr_recon_loss: 8892967.3182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11602470.6364; val_optim_loss: 11602470.6364
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9797; val_auprc_score: 0.9727; val_best_acc_score: 0.9447; val_best_f1_score: 0.9463; train_kl_reg_loss: 48405.0705; train_edge_recon_loss: 2631669.1445; train_gene_expr_recon_loss: 8399299.3203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11079373.5260; train_optim_loss: 11079373.5260; val_kl_reg_loss: 47246.0913; val_edge_recon_loss: 2660979.2727; val_gene_expr_recon_loss: 8891705.7727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11599931.1364; val_optim_loss: 11599931.1364
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9791; val_auprc_score: 0.9723; val_best_acc_score: 0.9424; val_best_f1_score: 0.9440; train_kl_reg_loss: 48349.6984; train_edge_recon_loss: 2629829.1888; train_gene_expr_recon_loss: 8398040.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11076219.2552; train_optim_loss: 11076219.2552; val_kl_reg_loss: 46925.0014; val_edge_recon_loss: 2669916.5795; val_gene_expr_recon_loss: 8859679.5909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11576521.1364; val_optim_loss: 11576521.1364
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9800; val_auprc_score: 0.9740; val_best_acc_score: 0.9444; val_best_f1_score: 0.9460; train_kl_reg_loss: 48311.1678; train_edge_recon_loss: 2629789.7161; train_gene_expr_recon_loss: 8396771.1406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11074872.0677; train_optim_loss: 11074872.0677; val_kl_reg_loss: 47099.4041; val_edge_recon_loss: 2663048.2614; val_gene_expr_recon_loss: 8908459.1818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11618606.7727; val_optim_loss: 11618606.7727
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9797; val_auprc_score: 0.9723; val_best_acc_score: 0.9452; val_best_f1_score: 0.9467; train_kl_reg_loss: 48284.4446; train_edge_recon_loss: 2628224.0417; train_gene_expr_recon_loss: 8385369.3776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11061877.8646; train_optim_loss: 11061877.8646; val_kl_reg_loss: 47092.7757; val_edge_recon_loss: 2660160.6705; val_gene_expr_recon_loss: 8868328.6818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11575582.0909; val_optim_loss: 11575582.0909
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9793; val_auprc_score: 0.9723; val_best_acc_score: 0.9440; val_best_f1_score: 0.9453; train_kl_reg_loss: 48256.3200; train_edge_recon_loss: 2631023.6016; train_gene_expr_recon_loss: 8388913.2708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11068193.1667; train_optim_loss: 11068193.1667; val_kl_reg_loss: 46998.7319; val_edge_recon_loss: 2663401.5682; val_gene_expr_recon_loss: 8875671.2727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11586071.5000; val_optim_loss: 11586071.5000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9800; val_auprc_score: 0.9736; val_best_acc_score: 0.9448; val_best_f1_score: 0.9462; train_kl_reg_loss: 48129.8489; train_edge_recon_loss: 2628257.3320; train_gene_expr_recon_loss: 8392695.5781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11069082.7865; train_optim_loss: 11069082.7865; val_kl_reg_loss: 46907.2093; val_edge_recon_loss: 2664603.6932; val_gene_expr_recon_loss: 8864741.0455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11576251.8636; val_optim_loss: 11576251.8636
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9797; val_auprc_score: 0.9728; val_best_acc_score: 0.9440; val_best_f1_score: 0.9457; train_kl_reg_loss: 48058.4156; train_edge_recon_loss: 2630250.9883; train_gene_expr_recon_loss: 8392575.4089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11070884.7969; train_optim_loss: 11070884.7969; val_kl_reg_loss: 46649.9244; val_edge_recon_loss: 2663980.9659; val_gene_expr_recon_loss: 8884829.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11595460.2273; val_optim_loss: 11595460.2273
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9802; val_auprc_score: 0.9732; val_best_acc_score: 0.9452; val_best_f1_score: 0.9467; train_kl_reg_loss: 47976.1606; train_edge_recon_loss: 2630462.2630; train_gene_expr_recon_loss: 8396116.3880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11074554.7760; train_optim_loss: 11074554.7760; val_kl_reg_loss: 46604.7008; val_edge_recon_loss: 2656683.9318; val_gene_expr_recon_loss: 8881304.2273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11584592.8182; val_optim_loss: 11584592.8182

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9792; val_auprc_score: 0.9718; val_best_acc_score: 0.9440; val_best_f1_score: 0.9456; train_kl_reg_loss: 47924.2124; train_edge_recon_loss: 2629148.0716; train_gene_expr_recon_loss: 8375507.2865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11052579.5833; train_optim_loss: 11052579.5833; val_kl_reg_loss: 46703.7915; val_edge_recon_loss: 2663293.3864; val_gene_expr_recon_loss: 8863601.1136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11573598.3182; val_optim_loss: 11573598.3182
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9809; val_auprc_score: 0.9748; val_best_acc_score: 0.9460; val_best_f1_score: 0.9476; train_kl_reg_loss: 47950.4643; train_edge_recon_loss: 2630425.2643; train_gene_expr_recon_loss: 8382215.1536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11060590.8594; train_optim_loss: 11060590.8594; val_kl_reg_loss: 46679.2930; val_edge_recon_loss: 2659482.3977; val_gene_expr_recon_loss: 8861071.8182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11567233.4545; val_optim_loss: 11567233.4545
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9797; val_auprc_score: 0.9724; val_best_acc_score: 0.9457; val_best_f1_score: 0.9473; train_kl_reg_loss: 47971.2538; train_edge_recon_loss: 2627777.6979; train_gene_expr_recon_loss: 8372907.4401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11048656.4062; train_optim_loss: 11048656.4062; val_kl_reg_loss: 46684.5268; val_edge_recon_loss: 2663830.7955; val_gene_expr_recon_loss: 8884469.8636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11594985.2273; val_optim_loss: 11594985.2273
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9794; val_auprc_score: 0.9725; val_best_acc_score: 0.9439; val_best_f1_score: 0.9452; train_kl_reg_loss: 47943.7584; train_edge_recon_loss: 2628264.4831; train_gene_expr_recon_loss: 8374362.6927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11050570.9531; train_optim_loss: 11050570.9531; val_kl_reg_loss: 46731.3253; val_edge_recon_loss: 2667926.4886; val_gene_expr_recon_loss: 8866925.6364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11581583.4545; val_optim_loss: 11581583.4545
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9806; val_auprc_score: 0.9739; val_best_acc_score: 0.9462; val_best_f1_score: 0.9477; train_kl_reg_loss: 47987.2648; train_edge_recon_loss: 2629514.3151; train_gene_expr_recon_loss: 8379960.8828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11057462.4635; train_optim_loss: 11057462.4635; val_kl_reg_loss: 46645.2921; val_edge_recon_loss: 2662323.3750; val_gene_expr_recon_loss: 8862797.5455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11571766.3182; val_optim_loss: 11571766.3182
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9790; val_auprc_score: 0.9720; val_best_acc_score: 0.9428; val_best_f1_score: 0.9443; train_kl_reg_loss: 47934.3469; train_edge_recon_loss: 2629857.5078; train_gene_expr_recon_loss: 8372415.0443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11050206.8698; train_optim_loss: 11050206.8698; val_kl_reg_loss: 46692.0989; val_edge_recon_loss: 2668646.5227; val_gene_expr_recon_loss: 8895708.1364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11611046.6818; val_optim_loss: 11611046.6818

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9803; val_auprc_score: 0.9736; val_best_acc_score: 0.9448; val_best_f1_score: 0.9462; train_kl_reg_loss: 47916.1811; train_edge_recon_loss: 2630782.3164; train_gene_expr_recon_loss: 8375882.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11054580.8229; train_optim_loss: 11054580.8229; val_kl_reg_loss: 46667.4703; val_edge_recon_loss: 2661169.5000; val_gene_expr_recon_loss: 8872295.3636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11580132.4545; val_optim_loss: 11580132.4545
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9799; val_auprc_score: 0.9732; val_best_acc_score: 0.9442; val_best_f1_score: 0.9457; train_kl_reg_loss: 47923.9255; train_edge_recon_loss: 2627265.9010; train_gene_expr_recon_loss: 8372234.6172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11047424.4583; train_optim_loss: 11047424.4583; val_kl_reg_loss: 46755.5751; val_edge_recon_loss: 2664367.4205; val_gene_expr_recon_loss: 8896523.1818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11607646.2273; val_optim_loss: 11607646.2273
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9798; val_auprc_score: 0.9732; val_best_acc_score: 0.9440; val_best_f1_score: 0.9457; train_kl_reg_loss: 47910.9808; train_edge_recon_loss: 2628949.8880; train_gene_expr_recon_loss: 8371647.4583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11048508.3333; train_optim_loss: 11048508.3333; val_kl_reg_loss: 46742.5027; val_edge_recon_loss: 2661661.7386; val_gene_expr_recon_loss: 8889636.8182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11598041.0909; val_optim_loss: 11598041.0909
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9800; val_auprc_score: 0.9734; val_best_acc_score: 0.9452; val_best_f1_score: 0.9468; train_kl_reg_loss: 47943.6407; train_edge_recon_loss: 2627298.7409; train_gene_expr_recon_loss: 8378958.5651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11054200.9531; train_optim_loss: 11054200.9531; val_kl_reg_loss: 46661.7788; val_edge_recon_loss: 2661523.3523; val_gene_expr_recon_loss: 8881146.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11589331.2727; val_optim_loss: 11589331.2727

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 50 min 46 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
Val AUROC score: 0.9796
Val AUPRC score: 0.9729
Val best accuracy score: 0.9447
Val best F1 score: 0.9463
Val gene expr MSE score: 0.6701

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
