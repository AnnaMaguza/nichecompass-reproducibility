None
Run timestamp: 12072023_194635_4.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1931624
Number of validation edges: 214624
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9944; val_auprc_score: 0.9943; val_best_acc_score: 0.9636; val_best_f1_score: 0.9637; train_kl_reg_loss: 8277.6540; train_edge_recon_loss: 268727.7042; train_gene_expr_recon_loss: 142583.7686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 419589.1266; train_optim_loss: 419589.1266; val_kl_reg_loss: 7406.4681; val_edge_recon_loss: 263968.5315; val_gene_expr_recon_loss: 133327.3046; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 404702.3045; val_optim_loss: 404702.3045
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9956; val_auprc_score: 0.9955; val_best_acc_score: 0.9683; val_best_f1_score: 0.9684; train_kl_reg_loss: 7176.1169; train_edge_recon_loss: 262675.8221; train_gene_expr_recon_loss: 131962.5270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 401814.4660; train_optim_loss: 401814.4660; val_kl_reg_loss: 6826.2834; val_edge_recon_loss: 262348.2331; val_gene_expr_recon_loss: 130700.5898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399875.1064; val_optim_loss: 399875.1064
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9963; val_auprc_score: 0.9960; val_best_acc_score: 0.9715; val_best_f1_score: 0.9716; train_kl_reg_loss: 6872.8215; train_edge_recon_loss: 261453.7616; train_gene_expr_recon_loss: 130400.9930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 398727.5761; train_optim_loss: 398727.5761; val_kl_reg_loss: 6564.4014; val_edge_recon_loss: 261734.7810; val_gene_expr_recon_loss: 130293.4607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398592.6432; val_optim_loss: 398592.6432
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9967; val_auprc_score: 0.9965; val_best_acc_score: 0.9734; val_best_f1_score: 0.9735; train_kl_reg_loss: 6767.9148; train_edge_recon_loss: 260820.5638; train_gene_expr_recon_loss: 129629.1698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397217.6482; train_optim_loss: 397217.6482; val_kl_reg_loss: 6592.5711; val_edge_recon_loss: 260891.1415; val_gene_expr_recon_loss: 119828.0268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387311.7405; val_optim_loss: 387311.7405
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9971; val_auprc_score: 0.9968; val_best_acc_score: 0.9755; val_best_f1_score: 0.9756; train_kl_reg_loss: 6719.5935; train_edge_recon_loss: 260423.3190; train_gene_expr_recon_loss: 125155.6793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392298.5920; train_optim_loss: 392298.5920; val_kl_reg_loss: 6637.0520; val_edge_recon_loss: 260559.1699; val_gene_expr_recon_loss: 119312.5492; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386508.7701; val_optim_loss: 386508.7701
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9971; val_auprc_score: 0.9968; val_best_acc_score: 0.9757; val_best_f1_score: 0.9758; train_kl_reg_loss: 6694.9377; train_edge_recon_loss: 260193.6145; train_gene_expr_recon_loss: 117043.8903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383932.4425; train_optim_loss: 383932.4425; val_kl_reg_loss: 6412.4860; val_edge_recon_loss: 260502.3980; val_gene_expr_recon_loss: 111401.0493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 378315.9328; val_optim_loss: 378315.9328
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9973; val_auprc_score: 0.9970; val_best_acc_score: 0.9766; val_best_f1_score: 0.9767; train_kl_reg_loss: 6672.0987; train_edge_recon_loss: 260060.5312; train_gene_expr_recon_loss: 111174.7354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 377907.3655; train_optim_loss: 377907.3655; val_kl_reg_loss: 6570.0499; val_edge_recon_loss: 260242.3355; val_gene_expr_recon_loss: 116149.9281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382962.3141; val_optim_loss: 382962.3141
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9973; val_auprc_score: 0.9971; val_best_acc_score: 0.9771; val_best_f1_score: 0.9772; train_kl_reg_loss: 6663.1328; train_edge_recon_loss: 259850.9638; train_gene_expr_recon_loss: 110127.2468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376641.3434; train_optim_loss: 376641.3434; val_kl_reg_loss: 6595.2073; val_edge_recon_loss: 260110.9277; val_gene_expr_recon_loss: 110251.6010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 376957.7369; val_optim_loss: 376957.7369
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9974; val_auprc_score: 0.9971; val_best_acc_score: 0.9774; val_best_f1_score: 0.9775; train_kl_reg_loss: 6654.2439; train_edge_recon_loss: 259687.1281; train_gene_expr_recon_loss: 109869.3692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376210.7414; train_optim_loss: 376210.7414; val_kl_reg_loss: 6378.3102; val_edge_recon_loss: 260098.1225; val_gene_expr_recon_loss: 109834.5008; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 376310.9331; val_optim_loss: 376310.9331
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9976; val_auprc_score: 0.9973; val_best_acc_score: 0.9787; val_best_f1_score: 0.9788; train_kl_reg_loss: 6642.8134; train_edge_recon_loss: 259599.8903; train_gene_expr_recon_loss: 109807.1405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376049.8442; train_optim_loss: 376049.8442; val_kl_reg_loss: 6631.3697; val_edge_recon_loss: 259966.8144; val_gene_expr_recon_loss: 110023.8754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 376622.0595; val_optim_loss: 376622.0595
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9975; val_auprc_score: 0.9972; val_best_acc_score: 0.9782; val_best_f1_score: 0.9783; train_kl_reg_loss: 6635.5048; train_edge_recon_loss: 259489.6430; train_gene_expr_recon_loss: 109486.4408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 375611.5887; train_optim_loss: 375611.5887; val_kl_reg_loss: 6639.3227; val_edge_recon_loss: 259799.6014; val_gene_expr_recon_loss: 108344.2729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374783.1977; val_optim_loss: 374783.1977
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9976; val_auprc_score: 0.9974; val_best_acc_score: 0.9781; val_best_f1_score: 0.9783; train_kl_reg_loss: 6630.2096; train_edge_recon_loss: 259439.2767; train_gene_expr_recon_loss: 109345.6680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 375415.1538; train_optim_loss: 375415.1538; val_kl_reg_loss: 6731.9885; val_edge_recon_loss: 259681.9399; val_gene_expr_recon_loss: 109225.1608; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 375639.0894; val_optim_loss: 375639.0894
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9976; val_auprc_score: 0.9973; val_best_acc_score: 0.9786; val_best_f1_score: 0.9787; train_kl_reg_loss: 6628.1080; train_edge_recon_loss: 259297.6172; train_gene_expr_recon_loss: 109190.1062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 375115.8311; train_optim_loss: 375115.8311; val_kl_reg_loss: 6569.8457; val_edge_recon_loss: 259512.2333; val_gene_expr_recon_loss: 109112.5632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 375194.6430; val_optim_loss: 375194.6430
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9977; val_auprc_score: 0.9973; val_best_acc_score: 0.9792; val_best_f1_score: 0.9793; train_kl_reg_loss: 6616.6792; train_edge_recon_loss: 259289.2771; train_gene_expr_recon_loss: 109196.0065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 375101.9628; train_optim_loss: 375101.9628; val_kl_reg_loss: 6544.9373; val_edge_recon_loss: 259497.5959; val_gene_expr_recon_loss: 109202.6566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 375245.1911; val_optim_loss: 375245.1911
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9978; val_auprc_score: 0.9975; val_best_acc_score: 0.9800; val_best_f1_score: 0.9801; train_kl_reg_loss: 6614.3722; train_edge_recon_loss: 259234.1322; train_gene_expr_recon_loss: 108918.4828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374766.9870; train_optim_loss: 374766.9870; val_kl_reg_loss: 6569.3242; val_edge_recon_loss: 259481.7118; val_gene_expr_recon_loss: 108804.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374855.1237; val_optim_loss: 374855.1237

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9980; val_auprc_score: 0.9977; val_best_acc_score: 0.9813; val_best_f1_score: 0.9813; train_kl_reg_loss: 6675.5610; train_edge_recon_loss: 258834.5889; train_gene_expr_recon_loss: 108139.7035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373649.8532; train_optim_loss: 373649.8532; val_kl_reg_loss: 6621.0438; val_edge_recon_loss: 259007.2112; val_gene_expr_recon_loss: 108078.3570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373706.6118; val_optim_loss: 373706.6118
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9980; val_auprc_score: 0.9978; val_best_acc_score: 0.9811; val_best_f1_score: 0.9812; train_kl_reg_loss: 6662.9475; train_edge_recon_loss: 258767.5784; train_gene_expr_recon_loss: 107949.5271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373380.0529; train_optim_loss: 373380.0529; val_kl_reg_loss: 6618.2634; val_edge_recon_loss: 258944.5557; val_gene_expr_recon_loss: 108038.1859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373601.0047; val_optim_loss: 373601.0047
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9982; val_auprc_score: 0.9980; val_best_acc_score: 0.9819; val_best_f1_score: 0.9819; train_kl_reg_loss: 6654.0267; train_edge_recon_loss: 258786.9242; train_gene_expr_recon_loss: 107859.5260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373300.4765; train_optim_loss: 373300.4765; val_kl_reg_loss: 6626.1964; val_edge_recon_loss: 259008.5280; val_gene_expr_recon_loss: 107976.6677; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373611.3911; val_optim_loss: 373611.3911
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9982; val_auprc_score: 0.9981; val_best_acc_score: 0.9822; val_best_f1_score: 0.9822; train_kl_reg_loss: 6649.5837; train_edge_recon_loss: 258752.8182; train_gene_expr_recon_loss: 107815.1811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373217.5829; train_optim_loss: 373217.5829; val_kl_reg_loss: 6614.7745; val_edge_recon_loss: 258984.2910; val_gene_expr_recon_loss: 107721.8551; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373320.9199; val_optim_loss: 373320.9199
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9982; val_auprc_score: 0.9980; val_best_acc_score: 0.9821; val_best_f1_score: 0.9822; train_kl_reg_loss: 6645.5492; train_edge_recon_loss: 258723.9456; train_gene_expr_recon_loss: 107749.5084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373119.0027; train_optim_loss: 373119.0027; val_kl_reg_loss: 6597.8888; val_edge_recon_loss: 259003.6330; val_gene_expr_recon_loss: 107581.1001; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373182.6226; val_optim_loss: 373182.6226
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9982; val_auprc_score: 0.9979; val_best_acc_score: 0.9820; val_best_f1_score: 0.9820; train_kl_reg_loss: 6640.5998; train_edge_recon_loss: 258710.1150; train_gene_expr_recon_loss: 107746.0293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373096.7435; train_optim_loss: 373096.7435; val_kl_reg_loss: 6618.3633; val_edge_recon_loss: 258933.3000; val_gene_expr_recon_loss: 107810.1243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373361.7874; val_optim_loss: 373361.7874
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9825; val_best_f1_score: 0.9826; train_kl_reg_loss: 6636.5907; train_edge_recon_loss: 258729.0544; train_gene_expr_recon_loss: 107709.7730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373075.4184; train_optim_loss: 373075.4184; val_kl_reg_loss: 6595.0914; val_edge_recon_loss: 258931.3999; val_gene_expr_recon_loss: 108117.5157; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373644.0079; val_optim_loss: 373644.0079
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9824; val_best_f1_score: 0.9824; train_kl_reg_loss: 6632.5709; train_edge_recon_loss: 258696.1002; train_gene_expr_recon_loss: 107723.0240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373051.6948; train_optim_loss: 373051.6948; val_kl_reg_loss: 6611.7289; val_edge_recon_loss: 258925.9771; val_gene_expr_recon_loss: 107911.3286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373449.0347; val_optim_loss: 373449.0347
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9982; val_auprc_score: 0.9980; val_best_acc_score: 0.9823; val_best_f1_score: 0.9823; train_kl_reg_loss: 6627.9140; train_edge_recon_loss: 258715.9231; train_gene_expr_recon_loss: 107688.3885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373032.2255; train_optim_loss: 373032.2255; val_kl_reg_loss: 6603.1874; val_edge_recon_loss: 259024.8229; val_gene_expr_recon_loss: 107182.2984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372810.3100; val_optim_loss: 372810.3100
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9824; val_best_f1_score: 0.9825; train_kl_reg_loss: 6622.1177; train_edge_recon_loss: 258727.1029; train_gene_expr_recon_loss: 107712.4837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373061.7047; train_optim_loss: 373061.7047; val_kl_reg_loss: 6595.2228; val_edge_recon_loss: 258939.1480; val_gene_expr_recon_loss: 108551.0536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374085.4247; val_optim_loss: 374085.4247
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9983; val_auprc_score: 0.9981; val_best_acc_score: 0.9829; val_best_f1_score: 0.9829; train_kl_reg_loss: 6623.8117; train_edge_recon_loss: 258665.9955; train_gene_expr_recon_loss: 107628.2161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372918.0235; train_optim_loss: 372918.0235; val_kl_reg_loss: 6582.8841; val_edge_recon_loss: 258957.0073; val_gene_expr_recon_loss: 107930.1733; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373470.0651; val_optim_loss: 373470.0651
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9827; val_best_f1_score: 0.9828; train_kl_reg_loss: 6619.6457; train_edge_recon_loss: 258647.5292; train_gene_expr_recon_loss: 107598.1581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372865.3335; train_optim_loss: 372865.3335; val_kl_reg_loss: 6597.5116; val_edge_recon_loss: 258885.7433; val_gene_expr_recon_loss: 106846.8340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372330.0891; val_optim_loss: 372330.0891
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9983; val_auprc_score: 0.9981; val_best_acc_score: 0.9828; val_best_f1_score: 0.9829; train_kl_reg_loss: 6617.8879; train_edge_recon_loss: 258637.2665; train_gene_expr_recon_loss: 107606.2600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372861.4144; train_optim_loss: 372861.4144; val_kl_reg_loss: 6581.0772; val_edge_recon_loss: 258858.3639; val_gene_expr_recon_loss: 106300.2229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371739.6645; val_optim_loss: 371739.6645
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9983; val_auprc_score: 0.9981; val_best_acc_score: 0.9827; val_best_f1_score: 0.9828; train_kl_reg_loss: 6616.2782; train_edge_recon_loss: 258632.0727; train_gene_expr_recon_loss: 107609.9735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372858.3244; train_optim_loss: 372858.3244; val_kl_reg_loss: 6595.0610; val_edge_recon_loss: 258879.3815; val_gene_expr_recon_loss: 107880.8051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373355.2473; val_optim_loss: 373355.2473
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9983; val_auprc_score: 0.9981; val_best_acc_score: 0.9828; val_best_f1_score: 0.9828; train_kl_reg_loss: 6614.8282; train_edge_recon_loss: 258658.5730; train_gene_expr_recon_loss: 107527.7827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372801.1838; train_optim_loss: 372801.1838; val_kl_reg_loss: 6579.5786; val_edge_recon_loss: 258809.5524; val_gene_expr_recon_loss: 106875.6050; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372264.7351; val_optim_loss: 372264.7351
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9828; val_best_f1_score: 0.9829; train_kl_reg_loss: 6612.9790; train_edge_recon_loss: 258623.6500; train_gene_expr_recon_loss: 107562.8814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372799.5105; train_optim_loss: 372799.5105; val_kl_reg_loss: 6589.9774; val_edge_recon_loss: 258860.2028; val_gene_expr_recon_loss: 106884.8195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372334.9994; val_optim_loss: 372334.9994
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9983; val_auprc_score: 0.9981; val_best_acc_score: 0.9830; val_best_f1_score: 0.9831; train_kl_reg_loss: 6611.7365; train_edge_recon_loss: 258602.1911; train_gene_expr_recon_loss: 107344.4350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372558.3627; train_optim_loss: 372558.3627; val_kl_reg_loss: 6602.5726; val_edge_recon_loss: 258796.5093; val_gene_expr_recon_loss: 107562.7549; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372961.8365; val_optim_loss: 372961.8365

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9984; val_auprc_score: 0.9982; val_best_acc_score: 0.9831; val_best_f1_score: 0.9831; train_kl_reg_loss: 6614.7578; train_edge_recon_loss: 258563.7919; train_gene_expr_recon_loss: 107310.4830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372489.0331; train_optim_loss: 372489.0331; val_kl_reg_loss: 6590.9952; val_edge_recon_loss: 258801.7623; val_gene_expr_recon_loss: 107460.1462; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372852.9042; val_optim_loss: 372852.9042
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9984; val_auprc_score: 0.9982; val_best_acc_score: 0.9834; val_best_f1_score: 0.9835; train_kl_reg_loss: 6613.4040; train_edge_recon_loss: 258569.3380; train_gene_expr_recon_loss: 107300.2702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372483.0119; train_optim_loss: 372483.0119; val_kl_reg_loss: 6585.2320; val_edge_recon_loss: 258709.6367; val_gene_expr_recon_loss: 107080.3385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372375.2069; val_optim_loss: 372375.2069
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9984; val_auprc_score: 0.9981; val_best_acc_score: 0.9831; val_best_f1_score: 0.9831; train_kl_reg_loss: 6613.8866; train_edge_recon_loss: 258555.4429; train_gene_expr_recon_loss: 107287.1036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372456.4330; train_optim_loss: 372456.4330; val_kl_reg_loss: 6583.3815; val_edge_recon_loss: 258830.3170; val_gene_expr_recon_loss: 107191.2180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372604.9151; val_optim_loss: 372604.9151
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9984; val_auprc_score: 0.9982; val_best_acc_score: 0.9829; val_best_f1_score: 0.9829; train_kl_reg_loss: 6613.8800; train_edge_recon_loss: 258518.3089; train_gene_expr_recon_loss: 107294.8548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372427.0436; train_optim_loss: 372427.0436; val_kl_reg_loss: 6586.6943; val_edge_recon_loss: 258861.9240; val_gene_expr_recon_loss: 107156.5857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372605.2048; val_optim_loss: 372605.2048

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 565 min 30 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
Val AUROC score: 0.9983
Val AUPRC score: 0.9981
Val best accuracy score: 0.9830
Val best F1 score: 0.9831
Val gene expr MSE score: 9.3226

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
