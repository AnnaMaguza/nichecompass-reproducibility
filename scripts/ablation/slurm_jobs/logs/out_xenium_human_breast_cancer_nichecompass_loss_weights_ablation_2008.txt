None
Run timestamp: 16072023_082226_2008.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_2008']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9383; val_auprc_score: 0.9200; val_best_acc_score: 0.8779; val_best_f1_score: 0.8854; train_kl_reg_loss: 19458.4640; train_edge_recon_loss: 26892085.3500; train_gene_expr_recon_loss: 903905.4258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27815449.2529; train_optim_loss: 27815449.2529; val_kl_reg_loss: 18362.1904; val_edge_recon_loss: 26761162.5526; val_gene_expr_recon_loss: 820293.5806; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27599818.2632; val_optim_loss: 27599818.2632
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9522; val_auprc_score: 0.9369; val_best_acc_score: 0.8939; val_best_f1_score: 0.8994; train_kl_reg_loss: 16490.9820; train_edge_recon_loss: 26260054.2324; train_gene_expr_recon_loss: 794825.8667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27071371.0265; train_optim_loss: 27071371.0265; val_kl_reg_loss: 14631.8257; val_edge_recon_loss: 26668409.2895; val_gene_expr_recon_loss: 774084.9334; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27457126.0526; val_optim_loss: 27457126.0526
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9599; val_auprc_score: 0.9494; val_best_acc_score: 0.9027; val_best_f1_score: 0.9071; train_kl_reg_loss: 14137.1286; train_edge_recon_loss: 26139396.8618; train_gene_expr_recon_loss: 764608.4051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26918142.3941; train_optim_loss: 26918142.3941; val_kl_reg_loss: 13213.4052; val_edge_recon_loss: 26666152.4211; val_gene_expr_recon_loss: 754537.8808; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27433903.8158; val_optim_loss: 27433903.8158
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9643; val_auprc_score: 0.9547; val_best_acc_score: 0.9108; val_best_f1_score: 0.9143; train_kl_reg_loss: 13757.2601; train_edge_recon_loss: 26080728.5765; train_gene_expr_recon_loss: 741582.7469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26836068.6029; train_optim_loss: 26836068.6029; val_kl_reg_loss: 13587.8526; val_edge_recon_loss: 26526823.4737; val_gene_expr_recon_loss: 734059.3947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27274470.6316; val_optim_loss: 27274470.6316
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9676; val_auprc_score: 0.9582; val_best_acc_score: 0.9164; val_best_f1_score: 0.9195; train_kl_reg_loss: 13816.7603; train_edge_recon_loss: 26018147.9588; train_gene_expr_recon_loss: 726025.1375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26757989.8588; train_optim_loss: 26757989.8588; val_kl_reg_loss: 13597.2727; val_edge_recon_loss: 26545864.9737; val_gene_expr_recon_loss: 718363.7640; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27277825.8421; val_optim_loss: 27277825.8421
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9670; val_auprc_score: 0.9559; val_best_acc_score: 0.9177; val_best_f1_score: 0.9202; train_kl_reg_loss: 13912.3601; train_edge_recon_loss: 25990263.2588; train_gene_expr_recon_loss: 715256.4777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26719432.1265; train_optim_loss: 26719432.1265; val_kl_reg_loss: 13434.4734; val_edge_recon_loss: 26514959.1579; val_gene_expr_recon_loss: 711714.6982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27240108.1579; val_optim_loss: 27240108.1579
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9676; val_auprc_score: 0.9569; val_best_acc_score: 0.9195; val_best_f1_score: 0.9225; train_kl_reg_loss: 14049.7252; train_edge_recon_loss: 25989385.8618; train_gene_expr_recon_loss: 706114.4216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26709550.0588; train_optim_loss: 26709550.0588; val_kl_reg_loss: 13997.0542; val_edge_recon_loss: 26492359.7632; val_gene_expr_recon_loss: 701196.5074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27207553.2105; val_optim_loss: 27207553.2105
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9700; val_auprc_score: 0.9603; val_best_acc_score: 0.9219; val_best_f1_score: 0.9244; train_kl_reg_loss: 14313.7191; train_edge_recon_loss: 25955908.8088; train_gene_expr_recon_loss: 698512.5325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26668735.0618; train_optim_loss: 26668735.0618; val_kl_reg_loss: 14282.7447; val_edge_recon_loss: 26432886.2895; val_gene_expr_recon_loss: 695191.9770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27142361.0000; val_optim_loss: 27142361.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9701; val_auprc_score: 0.9604; val_best_acc_score: 0.9223; val_best_f1_score: 0.9248; train_kl_reg_loss: 14558.9958; train_edge_recon_loss: 25951706.1441; train_gene_expr_recon_loss: 692413.9068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26658679.0206; train_optim_loss: 26658679.0206; val_kl_reg_loss: 14506.6057; val_edge_recon_loss: 26424600.8947; val_gene_expr_recon_loss: 689163.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27128271.1053; val_optim_loss: 27128271.1053
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9724; val_auprc_score: 0.9654; val_best_acc_score: 0.9246; val_best_f1_score: 0.9271; train_kl_reg_loss: 14704.9245; train_edge_recon_loss: 25945159.8794; train_gene_expr_recon_loss: 687439.2607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26647303.9971; train_optim_loss: 26647303.9971; val_kl_reg_loss: 14717.2158; val_edge_recon_loss: 26507396.0263; val_gene_expr_recon_loss: 687943.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27210056.5263; val_optim_loss: 27210056.5263
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9743; val_auprc_score: 0.9670; val_best_acc_score: 0.9271; val_best_f1_score: 0.9298; train_kl_reg_loss: 15011.1499; train_edge_recon_loss: 25934196.0529; train_gene_expr_recon_loss: 682838.0339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26632045.2559; train_optim_loss: 26632045.2559; val_kl_reg_loss: 14519.5183; val_edge_recon_loss: 26443714.2105; val_gene_expr_recon_loss: 678673.3734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27136907.0000; val_optim_loss: 27136907.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9740; val_auprc_score: 0.9662; val_best_acc_score: 0.9274; val_best_f1_score: 0.9299; train_kl_reg_loss: 15033.0026; train_edge_recon_loss: 25934806.8618; train_gene_expr_recon_loss: 678551.0930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26628390.9529; train_optim_loss: 26628390.9529; val_kl_reg_loss: 14734.2217; val_edge_recon_loss: 26438708.9211; val_gene_expr_recon_loss: 677714.7130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27131157.8421; val_optim_loss: 27131157.8421
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9748; val_auprc_score: 0.9674; val_best_acc_score: 0.9300; val_best_f1_score: 0.9322; train_kl_reg_loss: 15149.9757; train_edge_recon_loss: 25926362.7588; train_gene_expr_recon_loss: 675055.6686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26616568.4294; train_optim_loss: 26616568.4294; val_kl_reg_loss: 14552.8840; val_edge_recon_loss: 26356382.4474; val_gene_expr_recon_loss: 675874.0765; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27046809.4211; val_optim_loss: 27046809.4211
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9746; val_auprc_score: 0.9665; val_best_acc_score: 0.9310; val_best_f1_score: 0.9331; train_kl_reg_loss: 15303.9202; train_edge_recon_loss: 25918607.9882; train_gene_expr_recon_loss: 672264.7931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26606176.7000; train_optim_loss: 26606176.7000; val_kl_reg_loss: 14893.7667; val_edge_recon_loss: 26429978.4737; val_gene_expr_recon_loss: 671143.1768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27116015.4474; val_optim_loss: 27116015.4474
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9751; val_auprc_score: 0.9682; val_best_acc_score: 0.9300; val_best_f1_score: 0.9319; train_kl_reg_loss: 15625.5977; train_edge_recon_loss: 25900276.0441; train_gene_expr_recon_loss: 669425.2201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26585326.8529; train_optim_loss: 26585326.8529; val_kl_reg_loss: 15050.0969; val_edge_recon_loss: 26439238.3684; val_gene_expr_recon_loss: 669298.8043; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27123587.3947; val_optim_loss: 27123587.3947
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9763; val_auprc_score: 0.9690; val_best_acc_score: 0.9335; val_best_f1_score: 0.9356; train_kl_reg_loss: 15688.3553; train_edge_recon_loss: 25908986.1500; train_gene_expr_recon_loss: 667016.8626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26591691.4029; train_optim_loss: 26591691.4029; val_kl_reg_loss: 15625.2598; val_edge_recon_loss: 26376480.1316; val_gene_expr_recon_loss: 666387.6324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27058493.0263; val_optim_loss: 27058493.0263
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9758; val_auprc_score: 0.9675; val_best_acc_score: 0.9330; val_best_f1_score: 0.9348; train_kl_reg_loss: 15795.9329; train_edge_recon_loss: 25893293.0294; train_gene_expr_recon_loss: 664955.9358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26574044.9029; train_optim_loss: 26574044.9029; val_kl_reg_loss: 15535.6495; val_edge_recon_loss: 26405198.3947; val_gene_expr_recon_loss: 662753.7064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27083487.9211; val_optim_loss: 27083487.9211

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9769; val_auprc_score: 0.9690; val_best_acc_score: 0.9353; val_best_f1_score: 0.9371; train_kl_reg_loss: 15823.8050; train_edge_recon_loss: 25865588.6265; train_gene_expr_recon_loss: 659247.0802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26540659.4765; train_optim_loss: 26540659.4765; val_kl_reg_loss: 15503.8730; val_edge_recon_loss: 26349236.7632; val_gene_expr_recon_loss: 659422.7434; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27024163.4211; val_optim_loss: 27024163.4211
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9774; val_auprc_score: 0.9710; val_best_acc_score: 0.9354; val_best_f1_score: 0.9370; train_kl_reg_loss: 15854.5835; train_edge_recon_loss: 25861441.7294; train_gene_expr_recon_loss: 658351.1172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26535647.4324; train_optim_loss: 26535647.4324; val_kl_reg_loss: 15336.9273; val_edge_recon_loss: 26387075.8421; val_gene_expr_recon_loss: 658556.2286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27060968.9211; val_optim_loss: 27060968.9211
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9772; val_auprc_score: 0.9698; val_best_acc_score: 0.9355; val_best_f1_score: 0.9373; train_kl_reg_loss: 15764.0076; train_edge_recon_loss: 25869460.8824; train_gene_expr_recon_loss: 657938.7915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26543163.7029; train_optim_loss: 26543163.7029; val_kl_reg_loss: 15268.9007; val_edge_recon_loss: 26372608.5789; val_gene_expr_recon_loss: 658036.9877; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27045914.5000; val_optim_loss: 27045914.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9787; val_auprc_score: 0.9725; val_best_acc_score: 0.9369; val_best_f1_score: 0.9388; train_kl_reg_loss: 15650.0530; train_edge_recon_loss: 25867451.2794; train_gene_expr_recon_loss: 657600.9426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26540702.3059; train_optim_loss: 26540702.3059; val_kl_reg_loss: 15263.1960; val_edge_recon_loss: 26346545.9737; val_gene_expr_recon_loss: 658277.8141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27020086.8684; val_optim_loss: 27020086.8684
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9778; val_auprc_score: 0.9708; val_best_acc_score: 0.9355; val_best_f1_score: 0.9373; train_kl_reg_loss: 15562.7106; train_edge_recon_loss: 25864331.7559; train_gene_expr_recon_loss: 657609.4948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26537503.9941; train_optim_loss: 26537503.9941; val_kl_reg_loss: 15293.6320; val_edge_recon_loss: 26357496.9474; val_gene_expr_recon_loss: 657997.6760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27030788.2632; val_optim_loss: 27030788.2632
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9774; val_auprc_score: 0.9706; val_best_acc_score: 0.9343; val_best_f1_score: 0.9363; train_kl_reg_loss: 15599.7563; train_edge_recon_loss: 25881336.4971; train_gene_expr_recon_loss: 657062.9474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26553999.2588; train_optim_loss: 26553999.2588; val_kl_reg_loss: 15231.4676; val_edge_recon_loss: 26380868.9211; val_gene_expr_recon_loss: 656716.1176; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27052816.6842; val_optim_loss: 27052816.6842
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9791; val_auprc_score: 0.9728; val_best_acc_score: 0.9375; val_best_f1_score: 0.9391; train_kl_reg_loss: 15607.2249; train_edge_recon_loss: 25866396.2824; train_gene_expr_recon_loss: 656574.1619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26538577.7353; train_optim_loss: 26538577.7353; val_kl_reg_loss: 15124.9112; val_edge_recon_loss: 26323053.1842; val_gene_expr_recon_loss: 657226.1776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26995404.2895; val_optim_loss: 26995404.2895
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9784; val_auprc_score: 0.9721; val_best_acc_score: 0.9358; val_best_f1_score: 0.9375; train_kl_reg_loss: 15513.5393; train_edge_recon_loss: 25854005.7882; train_gene_expr_recon_loss: 656386.7423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26525906.0588; train_optim_loss: 26525906.0588; val_kl_reg_loss: 15113.5495; val_edge_recon_loss: 26348949.4211; val_gene_expr_recon_loss: 657229.1990; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27021292.1842; val_optim_loss: 27021292.1842
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9787; val_auprc_score: 0.9724; val_best_acc_score: 0.9364; val_best_f1_score: 0.9381; train_kl_reg_loss: 15506.4161; train_edge_recon_loss: 25857044.2676; train_gene_expr_recon_loss: 655720.2248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26528270.9235; train_optim_loss: 26528270.9235; val_kl_reg_loss: 15039.0285; val_edge_recon_loss: 26344201.6842; val_gene_expr_recon_loss: 658119.5041; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27017360.2105; val_optim_loss: 27017360.2105
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9777; val_auprc_score: 0.9705; val_best_acc_score: 0.9366; val_best_f1_score: 0.9384; train_kl_reg_loss: 15508.9992; train_edge_recon_loss: 25859314.4206; train_gene_expr_recon_loss: 656006.5945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26530829.9912; train_optim_loss: 26530829.9912; val_kl_reg_loss: 15148.3469; val_edge_recon_loss: 26349569.4737; val_gene_expr_recon_loss: 657755.0691; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27022472.9211; val_optim_loss: 27022472.9211
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9785; val_auprc_score: 0.9718; val_best_acc_score: 0.9373; val_best_f1_score: 0.9389; train_kl_reg_loss: 15463.2551; train_edge_recon_loss: 25864135.2353; train_gene_expr_recon_loss: 655764.3653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26535362.8206; train_optim_loss: 26535362.8206; val_kl_reg_loss: 15052.6321; val_edge_recon_loss: 26353542.9474; val_gene_expr_recon_loss: 658698.6842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27027294.2105; val_optim_loss: 27027294.2105

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9786; val_auprc_score: 0.9721; val_best_acc_score: 0.9374; val_best_f1_score: 0.9392; train_kl_reg_loss: 15405.2591; train_edge_recon_loss: 25852759.3647; train_gene_expr_recon_loss: 655194.9672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26523359.5824; train_optim_loss: 26523359.5824; val_kl_reg_loss: 15015.7804; val_edge_recon_loss: 26339465.1579; val_gene_expr_recon_loss: 654870.8298; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27009351.7895; val_optim_loss: 27009351.7895
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9785; val_auprc_score: 0.9716; val_best_acc_score: 0.9361; val_best_f1_score: 0.9380; train_kl_reg_loss: 15378.1701; train_edge_recon_loss: 25859442.7059; train_gene_expr_recon_loss: 654989.3533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26529810.2471; train_optim_loss: 26529810.2471; val_kl_reg_loss: 14989.8401; val_edge_recon_loss: 26384669.5263; val_gene_expr_recon_loss: 655631.2410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27055290.5789; val_optim_loss: 27055290.5789
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9788; val_auprc_score: 0.9721; val_best_acc_score: 0.9377; val_best_f1_score: 0.9394; train_kl_reg_loss: 15346.4560; train_edge_recon_loss: 25859546.9353; train_gene_expr_recon_loss: 655291.5423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26530184.9206; train_optim_loss: 26530184.9206; val_kl_reg_loss: 14924.4561; val_edge_recon_loss: 26325636.1053; val_gene_expr_recon_loss: 656300.9696; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26996861.5000; val_optim_loss: 26996861.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9785; val_auprc_score: 0.9719; val_best_acc_score: 0.9367; val_best_f1_score: 0.9384; train_kl_reg_loss: 15335.4049; train_edge_recon_loss: 25870507.8412; train_gene_expr_recon_loss: 655122.4526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26540965.7559; train_optim_loss: 26540965.7559; val_kl_reg_loss: 14944.7052; val_edge_recon_loss: 26370387.6316; val_gene_expr_recon_loss: 653189.9227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27038522.2632; val_optim_loss: 27038522.2632

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 41 min 48 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9777
Val AUPRC score: 0.9704
Val best accuracy score: 0.9362
Val best F1 score: 0.9382
Val gene expr MSE score: 1.6320

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
