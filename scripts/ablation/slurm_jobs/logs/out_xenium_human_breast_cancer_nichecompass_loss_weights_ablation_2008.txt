None
Run timestamp: 02072023_064251_2008.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_2008']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9464; val_auprc_score: 0.9305; val_best_acc_score: 0.8874; val_best_f1_score: 0.8937; train_kl_reg_loss: 6417.4087; train_edge_recon_loss: 272000.7581; train_gene_expr_recon_loss: 80699.6104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359117.7772; train_optim_loss: 359117.7772; val_kl_reg_loss: 6069.9610; val_edge_recon_loss: 269062.4050; val_gene_expr_recon_loss: 73454.6308; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 348586.9959; val_optim_loss: 348586.9959
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9611; val_auprc_score: 0.9517; val_best_acc_score: 0.9033; val_best_f1_score: 0.9069; train_kl_reg_loss: 6054.7014; train_edge_recon_loss: 264709.2094; train_gene_expr_recon_loss: 71313.9751; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 342077.8858; train_optim_loss: 342077.8858; val_kl_reg_loss: 5735.1356; val_edge_recon_loss: 268945.7035; val_gene_expr_recon_loss: 69783.8921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 344464.7319; val_optim_loss: 344464.7319
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9653; val_auprc_score: 0.9562; val_best_acc_score: 0.9118; val_best_f1_score: 0.9152; train_kl_reg_loss: 5970.0137; train_edge_recon_loss: 263580.7969; train_gene_expr_recon_loss: 68495.9897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 338046.8001; train_optim_loss: 338046.8001; val_kl_reg_loss: 5894.3673; val_edge_recon_loss: 268202.9445; val_gene_expr_recon_loss: 67244.1437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 341341.4576; val_optim_loss: 341341.4576
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9678; val_auprc_score: 0.9588; val_best_acc_score: 0.9177; val_best_f1_score: 0.9208; train_kl_reg_loss: 5957.0858; train_edge_recon_loss: 263093.3074; train_gene_expr_recon_loss: 66663.0448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 335713.4388; train_optim_loss: 335713.4388; val_kl_reg_loss: 5870.5783; val_edge_recon_loss: 267632.1266; val_gene_expr_recon_loss: 65878.0554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 339380.7607; val_optim_loss: 339380.7607
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9715; val_auprc_score: 0.9646; val_best_acc_score: 0.9223; val_best_f1_score: 0.9251; train_kl_reg_loss: 5934.2520; train_edge_recon_loss: 262803.7456; train_gene_expr_recon_loss: 65418.4960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 334156.4932; train_optim_loss: 334156.4932; val_kl_reg_loss: 5791.2303; val_edge_recon_loss: 266895.1495; val_gene_expr_recon_loss: 64808.5058; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 337494.8882; val_optim_loss: 337494.8882
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9734; val_auprc_score: 0.9671; val_best_acc_score: 0.9247; val_best_f1_score: 0.9269; train_kl_reg_loss: 5953.8051; train_edge_recon_loss: 262503.2074; train_gene_expr_recon_loss: 64520.9658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332977.9777; train_optim_loss: 332977.9777; val_kl_reg_loss: 5731.1364; val_edge_recon_loss: 267235.3849; val_gene_expr_recon_loss: 64267.9006; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 337234.4227; val_optim_loss: 337234.4227
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9740; val_auprc_score: 0.9680; val_best_acc_score: 0.9258; val_best_f1_score: 0.9282; train_kl_reg_loss: 5945.1545; train_edge_recon_loss: 262312.6853; train_gene_expr_recon_loss: 63919.2896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332177.1295; train_optim_loss: 332177.1295; val_kl_reg_loss: 5681.0400; val_edge_recon_loss: 267059.9155; val_gene_expr_recon_loss: 63700.8977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 336441.8532; val_optim_loss: 336441.8532
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9745; val_auprc_score: 0.9677; val_best_acc_score: 0.9275; val_best_f1_score: 0.9296; train_kl_reg_loss: 5954.8772; train_edge_recon_loss: 262007.0683; train_gene_expr_recon_loss: 63409.8990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331371.8452; train_optim_loss: 331371.8452; val_kl_reg_loss: 5813.3580; val_edge_recon_loss: 266789.1632; val_gene_expr_recon_loss: 63202.9458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335805.4659; val_optim_loss: 335805.4659
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9745; val_auprc_score: 0.9676; val_best_acc_score: 0.9287; val_best_f1_score: 0.9311; train_kl_reg_loss: 5951.2185; train_edge_recon_loss: 262029.9198; train_gene_expr_recon_loss: 63082.2970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331063.4355; train_optim_loss: 331063.4355; val_kl_reg_loss: 5842.9319; val_edge_recon_loss: 266998.9564; val_gene_expr_recon_loss: 62708.7901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335550.6776; val_optim_loss: 335550.6776
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9754; val_auprc_score: 0.9693; val_best_acc_score: 0.9287; val_best_f1_score: 0.9304; train_kl_reg_loss: 5960.1346; train_edge_recon_loss: 261770.5365; train_gene_expr_recon_loss: 62745.7464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330476.4180; train_optim_loss: 330476.4180; val_kl_reg_loss: 5827.7427; val_edge_recon_loss: 266756.1830; val_gene_expr_recon_loss: 62573.6217; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335157.5465; val_optim_loss: 335157.5465
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9737; val_auprc_score: 0.9664; val_best_acc_score: 0.9282; val_best_f1_score: 0.9307; train_kl_reg_loss: 5964.8223; train_edge_recon_loss: 261664.0613; train_gene_expr_recon_loss: 62508.3662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330137.2498; train_optim_loss: 330137.2498; val_kl_reg_loss: 5779.9247; val_edge_recon_loss: 266357.2426; val_gene_expr_recon_loss: 62412.9700; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334550.1382; val_optim_loss: 334550.1382
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9760; val_auprc_score: 0.9697; val_best_acc_score: 0.9312; val_best_f1_score: 0.9334; train_kl_reg_loss: 5957.1562; train_edge_recon_loss: 261649.9587; train_gene_expr_recon_loss: 62324.1090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329931.2237; train_optim_loss: 329931.2237; val_kl_reg_loss: 5912.1345; val_edge_recon_loss: 266225.4889; val_gene_expr_recon_loss: 62244.0082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334381.6332; val_optim_loss: 334381.6332
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9776; val_auprc_score: 0.9714; val_best_acc_score: 0.9334; val_best_f1_score: 0.9356; train_kl_reg_loss: 5964.9719; train_edge_recon_loss: 261599.8909; train_gene_expr_recon_loss: 62148.5088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329713.3720; train_optim_loss: 329713.3720; val_kl_reg_loss: 5781.9233; val_edge_recon_loss: 266088.7632; val_gene_expr_recon_loss: 61993.3895; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333864.0736; val_optim_loss: 333864.0736
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9769; val_auprc_score: 0.9702; val_best_acc_score: 0.9336; val_best_f1_score: 0.9354; train_kl_reg_loss: 5977.3109; train_edge_recon_loss: 261466.8559; train_gene_expr_recon_loss: 61972.5294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329416.6963; train_optim_loss: 329416.6963; val_kl_reg_loss: 5946.3762; val_edge_recon_loss: 265499.7839; val_gene_expr_recon_loss: 61903.9194; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333350.0802; val_optim_loss: 333350.0802
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9762; val_auprc_score: 0.9692; val_best_acc_score: 0.9327; val_best_f1_score: 0.9348; train_kl_reg_loss: 5967.4505; train_edge_recon_loss: 261458.1177; train_gene_expr_recon_loss: 61884.0359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329309.6046; train_optim_loss: 329309.6046; val_kl_reg_loss: 5789.7459; val_edge_recon_loss: 266182.1221; val_gene_expr_recon_loss: 61845.8892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333817.7570; val_optim_loss: 333817.7570
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9769; val_auprc_score: 0.9703; val_best_acc_score: 0.9338; val_best_f1_score: 0.9362; train_kl_reg_loss: 5965.7946; train_edge_recon_loss: 261318.5500; train_gene_expr_recon_loss: 61768.1441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329052.4882; train_optim_loss: 329052.4882; val_kl_reg_loss: 5915.2926; val_edge_recon_loss: 265580.6324; val_gene_expr_recon_loss: 61650.5728; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333146.4979; val_optim_loss: 333146.4979
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9786; val_auprc_score: 0.9732; val_best_acc_score: 0.9349; val_best_f1_score: 0.9372; train_kl_reg_loss: 5972.7936; train_edge_recon_loss: 261453.6170; train_gene_expr_recon_loss: 61695.6705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329122.0806; train_optim_loss: 329122.0806; val_kl_reg_loss: 5850.3932; val_edge_recon_loss: 266170.2736; val_gene_expr_recon_loss: 61658.7067; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333679.3734; val_optim_loss: 333679.3734
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9773; val_auprc_score: 0.9714; val_best_acc_score: 0.9334; val_best_f1_score: 0.9355; train_kl_reg_loss: 5972.8514; train_edge_recon_loss: 261376.5529; train_gene_expr_recon_loss: 61619.7095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328969.1140; train_optim_loss: 328969.1140; val_kl_reg_loss: 5826.5602; val_edge_recon_loss: 265817.4907; val_gene_expr_recon_loss: 61635.4274; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333279.4807; val_optim_loss: 333279.4807
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9774; val_auprc_score: 0.9705; val_best_acc_score: 0.9348; val_best_f1_score: 0.9367; train_kl_reg_loss: 5974.8836; train_edge_recon_loss: 261300.5054; train_gene_expr_recon_loss: 61511.0957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328786.4845; train_optim_loss: 328786.4845; val_kl_reg_loss: 5839.1218; val_edge_recon_loss: 265808.2891; val_gene_expr_recon_loss: 61596.3014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333243.7142; val_optim_loss: 333243.7142
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9786; val_auprc_score: 0.9728; val_best_acc_score: 0.9356; val_best_f1_score: 0.9371; train_kl_reg_loss: 5979.8578; train_edge_recon_loss: 261144.2933; train_gene_expr_recon_loss: 61489.0713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328613.2226; train_optim_loss: 328613.2226; val_kl_reg_loss: 5905.5902; val_edge_recon_loss: 266282.8902; val_gene_expr_recon_loss: 61387.9387; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333576.4194; val_optim_loss: 333576.4194

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9787; val_auprc_score: 0.9727; val_best_acc_score: 0.9366; val_best_f1_score: 0.9384; train_kl_reg_loss: 5981.8654; train_edge_recon_loss: 260838.5621; train_gene_expr_recon_loss: 61052.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327872.4886; train_optim_loss: 327872.4886; val_kl_reg_loss: 5875.5382; val_edge_recon_loss: 265579.1067; val_gene_expr_recon_loss: 61102.1810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332556.8273; val_optim_loss: 332556.8273
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9796; val_auprc_score: 0.9741; val_best_acc_score: 0.9373; val_best_f1_score: 0.9390; train_kl_reg_loss: 5968.4340; train_edge_recon_loss: 260872.8112; train_gene_expr_recon_loss: 60968.7078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327809.9529; train_optim_loss: 327809.9529; val_kl_reg_loss: 5830.9358; val_edge_recon_loss: 265441.8542; val_gene_expr_recon_loss: 61229.4603; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332502.2504; val_optim_loss: 332502.2504
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9793; val_auprc_score: 0.9734; val_best_acc_score: 0.9377; val_best_f1_score: 0.9392; train_kl_reg_loss: 5975.0227; train_edge_recon_loss: 260774.1423; train_gene_expr_recon_loss: 60970.0809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327719.2454; train_optim_loss: 327719.2454; val_kl_reg_loss: 5866.1892; val_edge_recon_loss: 265319.0097; val_gene_expr_recon_loss: 60994.9264; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332180.1283; val_optim_loss: 332180.1283
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9788; val_auprc_score: 0.9729; val_best_acc_score: 0.9367; val_best_f1_score: 0.9384; train_kl_reg_loss: 5970.9195; train_edge_recon_loss: 260682.9364; train_gene_expr_recon_loss: 60910.6270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327564.4818; train_optim_loss: 327564.4818; val_kl_reg_loss: 5879.9016; val_edge_recon_loss: 265514.1600; val_gene_expr_recon_loss: 61000.2899; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332394.3520; val_optim_loss: 332394.3520
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9790; val_auprc_score: 0.9730; val_best_acc_score: 0.9373; val_best_f1_score: 0.9390; train_kl_reg_loss: 5954.1905; train_edge_recon_loss: 260936.5939; train_gene_expr_recon_loss: 60952.4543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327843.2388; train_optim_loss: 327843.2388; val_kl_reg_loss: 5841.9518; val_edge_recon_loss: 265698.4677; val_gene_expr_recon_loss: 60860.6846; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332401.1003; val_optim_loss: 332401.1003
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9801; val_auprc_score: 0.9747; val_best_acc_score: 0.9390; val_best_f1_score: 0.9404; train_kl_reg_loss: 5966.4314; train_edge_recon_loss: 260777.4537; train_gene_expr_recon_loss: 60893.5591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327637.4445; train_optim_loss: 327637.4445; val_kl_reg_loss: 5853.6486; val_edge_recon_loss: 265130.1949; val_gene_expr_recon_loss: 61084.5403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332068.3832; val_optim_loss: 332068.3832
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9789; val_auprc_score: 0.9728; val_best_acc_score: 0.9367; val_best_f1_score: 0.9384; train_kl_reg_loss: 5962.2606; train_edge_recon_loss: 260861.7334; train_gene_expr_recon_loss: 60868.0812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327692.0760; train_optim_loss: 327692.0760; val_kl_reg_loss: 5827.7749; val_edge_recon_loss: 265798.9007; val_gene_expr_recon_loss: 61004.5895; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332631.2677; val_optim_loss: 332631.2677
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9798; val_auprc_score: 0.9746; val_best_acc_score: 0.9383; val_best_f1_score: 0.9399; train_kl_reg_loss: 5955.4695; train_edge_recon_loss: 260891.9876; train_gene_expr_recon_loss: 60861.6361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327709.0932; train_optim_loss: 327709.0932; val_kl_reg_loss: 5802.0753; val_edge_recon_loss: 265547.1604; val_gene_expr_recon_loss: 61058.7979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332408.0333; val_optim_loss: 332408.0333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9803; val_auprc_score: 0.9753; val_best_acc_score: 0.9382; val_best_f1_score: 0.9401; train_kl_reg_loss: 5956.3318; train_edge_recon_loss: 260761.8427; train_gene_expr_recon_loss: 60835.3430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327553.5170; train_optim_loss: 327553.5170; val_kl_reg_loss: 5815.6636; val_edge_recon_loss: 265650.5327; val_gene_expr_recon_loss: 60886.9146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332353.1094; val_optim_loss: 332353.1094
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9802; val_auprc_score: 0.9751; val_best_acc_score: 0.9385; val_best_f1_score: 0.9402; train_kl_reg_loss: 5954.9306; train_edge_recon_loss: 260872.0666; train_gene_expr_recon_loss: 60845.5352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327672.5327; train_optim_loss: 327672.5327; val_kl_reg_loss: 5831.5609; val_edge_recon_loss: 265777.1343; val_gene_expr_recon_loss: 60893.1585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332501.8544; val_optim_loss: 332501.8544

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9806; val_auprc_score: 0.9749; val_best_acc_score: 0.9400; val_best_f1_score: 0.9418; train_kl_reg_loss: 5954.8458; train_edge_recon_loss: 260783.6351; train_gene_expr_recon_loss: 60748.8258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327487.3059; train_optim_loss: 327487.3059; val_kl_reg_loss: 5826.9213; val_edge_recon_loss: 264929.6600; val_gene_expr_recon_loss: 60897.2890; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331653.8688; val_optim_loss: 331653.8688
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9793; val_auprc_score: 0.9739; val_best_acc_score: 0.9382; val_best_f1_score: 0.9401; train_kl_reg_loss: 5950.4772; train_edge_recon_loss: 260758.1293; train_gene_expr_recon_loss: 60757.6255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327466.2323; train_optim_loss: 327466.2323; val_kl_reg_loss: 5829.4871; val_edge_recon_loss: 265643.3908; val_gene_expr_recon_loss: 60887.7230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332360.6003; val_optim_loss: 332360.6003
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9802; val_auprc_score: 0.9751; val_best_acc_score: 0.9389; val_best_f1_score: 0.9404; train_kl_reg_loss: 5952.5328; train_edge_recon_loss: 260756.1980; train_gene_expr_recon_loss: 60744.6729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327453.4038; train_optim_loss: 327453.4038; val_kl_reg_loss: 5824.4394; val_edge_recon_loss: 265554.1982; val_gene_expr_recon_loss: 60818.8506; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332197.4889; val_optim_loss: 332197.4889
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9802; val_auprc_score: 0.9746; val_best_acc_score: 0.9393; val_best_f1_score: 0.9408; train_kl_reg_loss: 5945.1235; train_edge_recon_loss: 260855.4739; train_gene_expr_recon_loss: 60742.1021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327542.6994; train_optim_loss: 327542.6994; val_kl_reg_loss: 5821.4959; val_edge_recon_loss: 265553.5942; val_gene_expr_recon_loss: 60915.3488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332290.4400; val_optim_loss: 332290.4400
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9800; val_auprc_score: 0.9740; val_best_acc_score: 0.9382; val_best_f1_score: 0.9395; train_kl_reg_loss: 5950.7853; train_edge_recon_loss: 260700.1106; train_gene_expr_recon_loss: 60765.2203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327416.1165; train_optim_loss: 327416.1165; val_kl_reg_loss: 5833.0526; val_edge_recon_loss: 265601.2942; val_gene_expr_recon_loss: 61022.9785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332457.3257; val_optim_loss: 332457.3257

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9803; val_auprc_score: 0.9748; val_best_acc_score: 0.9397; val_best_f1_score: 0.9414; train_kl_reg_loss: 5955.2609; train_edge_recon_loss: 260580.0868; train_gene_expr_recon_loss: 60739.2987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327274.6466; train_optim_loss: 327274.6466; val_kl_reg_loss: 5831.7030; val_edge_recon_loss: 265124.0510; val_gene_expr_recon_loss: 61006.7976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331962.5506; val_optim_loss: 331962.5506
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9803; val_auprc_score: 0.9747; val_best_acc_score: 0.9389; val_best_f1_score: 0.9405; train_kl_reg_loss: 5952.5259; train_edge_recon_loss: 260762.5023; train_gene_expr_recon_loss: 60742.1841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327457.2124; train_optim_loss: 327457.2124; val_kl_reg_loss: 5829.0130; val_edge_recon_loss: 265348.1865; val_gene_expr_recon_loss: 61022.9617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332200.1600; val_optim_loss: 332200.1600
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9798; val_auprc_score: 0.9745; val_best_acc_score: 0.9385; val_best_f1_score: 0.9400; train_kl_reg_loss: 5953.2780; train_edge_recon_loss: 260664.2665; train_gene_expr_recon_loss: 60767.7639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327385.3089; train_optim_loss: 327385.3089; val_kl_reg_loss: 5829.5855; val_edge_recon_loss: 265563.0117; val_gene_expr_recon_loss: 60994.1196; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332386.7179; val_optim_loss: 332386.7179
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9794; val_auprc_score: 0.9733; val_best_acc_score: 0.9378; val_best_f1_score: 0.9396; train_kl_reg_loss: 5953.0106; train_edge_recon_loss: 260730.6035; train_gene_expr_recon_loss: 60744.3013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327427.9152; train_optim_loss: 327427.9152; val_kl_reg_loss: 5831.9178; val_edge_recon_loss: 265555.4134; val_gene_expr_recon_loss: 61043.4201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332430.7525; val_optim_loss: 332430.7525

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 59 min 27 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9793
Val AUPRC score: 0.9734
Val best accuracy score: 0.9372
Val best F1 score: 0.9392
Val gene expr MSE score: 1.4267

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
