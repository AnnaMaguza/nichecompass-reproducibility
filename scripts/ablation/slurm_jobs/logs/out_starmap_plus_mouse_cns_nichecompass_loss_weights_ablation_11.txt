None
Run timestamp: 29062023_161622_11.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_11']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1818, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1818, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
heaps
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9743; val_auprc_score: 0.9670; val_best_acc_score: 0.9289; val_best_f1_score: 0.9298; train_kl_reg_loss: 2284.4517; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 208558.4012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210842.8529; train_optim_loss: 210842.8529; val_kl_reg_loss: 2324.6476; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 196826.7365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 199151.3864; val_optim_loss: 199151.3864
heaps
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9773; val_auprc_score: 0.9702; val_best_acc_score: 0.9369; val_best_f1_score: 0.9374; train_kl_reg_loss: 2448.2901; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 196515.1772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198963.4671; train_optim_loss: 198963.4671; val_kl_reg_loss: 2494.1697; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 191581.3871; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194075.5568; val_optim_loss: 194075.5568
heaps
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9801; val_auprc_score: 0.9747; val_best_acc_score: 0.9423; val_best_f1_score: 0.9428; train_kl_reg_loss: 2737.5636; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 191420.5970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194158.1610; train_optim_loss: 194158.1610; val_kl_reg_loss: 2824.5891; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 187545.2898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190369.8778; val_optim_loss: 190369.8778
heaps
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9796; val_auprc_score: 0.9746; val_best_acc_score: 0.9405; val_best_f1_score: 0.9411; train_kl_reg_loss: 3141.9373; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 186505.0289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189646.9661; train_optim_loss: 189646.9661; val_kl_reg_loss: 3217.7435; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 182792.8317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186010.5753; val_optim_loss: 186010.5753
heaps
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9801; val_auprc_score: 0.9762; val_best_acc_score: 0.9401; val_best_f1_score: 0.9407; train_kl_reg_loss: 3502.0227; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 181976.6094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185478.6326; train_optim_loss: 185478.6326; val_kl_reg_loss: 3543.8434; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 179834.6278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183378.4730; val_optim_loss: 183378.4730
heaps
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9819; val_auprc_score: 0.9792; val_best_acc_score: 0.9412; val_best_f1_score: 0.9417; train_kl_reg_loss: 3766.4813; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 178189.6985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181956.1801; train_optim_loss: 181956.1801; val_kl_reg_loss: 3790.9534; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 176162.2479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179953.2031; val_optim_loss: 179953.2031
heaps
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9802; val_auprc_score: 0.9777; val_best_acc_score: 0.9378; val_best_f1_score: 0.9379; train_kl_reg_loss: 3954.4665; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 175153.7017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179108.1687; train_optim_loss: 179108.1687; val_kl_reg_loss: 3887.6896; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 174054.8295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177942.5199; val_optim_loss: 177942.5199
heaps
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9806; val_auprc_score: 0.9789; val_best_acc_score: 0.9379; val_best_f1_score: 0.9380; train_kl_reg_loss: 4077.7738; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 172859.3066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176937.0806; train_optim_loss: 176937.0806; val_kl_reg_loss: 4051.7088; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 172135.7564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176187.4645; val_optim_loss: 176187.4645
heaps
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9800; val_auprc_score: 0.9790; val_best_acc_score: 0.9372; val_best_f1_score: 0.9368; train_kl_reg_loss: 4167.7462; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 170869.7013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175037.4470; train_optim_loss: 175037.4470; val_kl_reg_loss: 4142.5908; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 171242.9901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175385.5824; val_optim_loss: 175385.5824
heaps
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9794; val_auprc_score: 0.9786; val_best_acc_score: 0.9366; val_best_f1_score: 0.9367; train_kl_reg_loss: 4223.7473; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 169304.7961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173528.5434; train_optim_loss: 173528.5434; val_kl_reg_loss: 4127.4936; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 169788.0923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173915.5866; val_optim_loss: 173915.5866
heaps
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9800; val_auprc_score: 0.9803; val_best_acc_score: 0.9375; val_best_f1_score: 0.9377; train_kl_reg_loss: 4269.1608; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 167848.4076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172117.5682; train_optim_loss: 172117.5682; val_kl_reg_loss: 4202.1129; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 168384.2024; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172586.3168; val_optim_loss: 172586.3168
heaps
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9806; val_auprc_score: 0.9799; val_best_acc_score: 0.9381; val_best_f1_score: 0.9383; train_kl_reg_loss: 4299.0581; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 166953.6348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171252.6930; train_optim_loss: 171252.6930; val_kl_reg_loss: 4225.3340; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 168077.4126; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172302.7464; val_optim_loss: 172302.7464
heaps
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9791; val_auprc_score: 0.9793; val_best_acc_score: 0.9375; val_best_f1_score: 0.9369; train_kl_reg_loss: 4316.7535; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 165892.6235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170209.3776; train_optim_loss: 170209.3776; val_kl_reg_loss: 4189.9825; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 167441.4432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171631.4268; val_optim_loss: 171631.4268
heaps
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9796; val_auprc_score: 0.9799; val_best_acc_score: 0.9389; val_best_f1_score: 0.9381; train_kl_reg_loss: 4328.2198; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 165070.6032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169398.8232; train_optim_loss: 169398.8232; val_kl_reg_loss: 4263.9185; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 166612.2848; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170876.2031; val_optim_loss: 170876.2031
heaps
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9792; val_auprc_score: 0.9800; val_best_acc_score: 0.9383; val_best_f1_score: 0.9373; train_kl_reg_loss: 4343.1599; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 164495.5987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168838.7590; train_optim_loss: 168838.7590; val_kl_reg_loss: 4242.1980; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 165986.6634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170228.8615; val_optim_loss: 170228.8615
heaps
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9792; val_auprc_score: 0.9800; val_best_acc_score: 0.9369; val_best_f1_score: 0.9367; train_kl_reg_loss: 4348.0223; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 163845.7651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168193.7874; train_optim_loss: 168193.7874; val_kl_reg_loss: 4340.9619; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 165144.2607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169485.2230; val_optim_loss: 169485.2230
heaps
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9794; val_auprc_score: 0.9808; val_best_acc_score: 0.9384; val_best_f1_score: 0.9377; train_kl_reg_loss: 4352.4070; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 163204.8385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167557.2459; train_optim_loss: 167557.2459; val_kl_reg_loss: 4350.5252; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 165365.9027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169716.4283; val_optim_loss: 169716.4283
heaps
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9790; val_auprc_score: 0.9801; val_best_acc_score: 0.9359; val_best_f1_score: 0.9350; train_kl_reg_loss: 4352.5929; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 162705.2358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167057.8280; train_optim_loss: 167057.8280; val_kl_reg_loss: 4256.3002; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 164633.1001; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168889.4013; val_optim_loss: 168889.4013
heaps
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9784; val_auprc_score: 0.9795; val_best_acc_score: 0.9373; val_best_f1_score: 0.9361; train_kl_reg_loss: 4356.2360; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 162286.6121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166642.8477; train_optim_loss: 166642.8477; val_kl_reg_loss: 4253.8962; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 164503.6349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168757.5305; val_optim_loss: 168757.5305
heaps
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9783; val_auprc_score: 0.9800; val_best_acc_score: 0.9358; val_best_f1_score: 0.9352; train_kl_reg_loss: 4358.0811; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 161891.7434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166249.8243; train_optim_loss: 166249.8243; val_kl_reg_loss: 4310.6920; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 164515.7947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168826.4851; val_optim_loss: 168826.4851
heaps
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9786; val_auprc_score: 0.9799; val_best_acc_score: 0.9366; val_best_f1_score: 0.9363; train_kl_reg_loss: 4355.6702; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 161476.8223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165832.4924; train_optim_loss: 165832.4924; val_kl_reg_loss: 4250.4890; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 164683.8679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168934.3580; val_optim_loss: 168934.3580
heaps
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9772; val_auprc_score: 0.9795; val_best_acc_score: 0.9355; val_best_f1_score: 0.9348; train_kl_reg_loss: 4355.5132; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 161149.7996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165505.3133; train_optim_loss: 165505.3133; val_kl_reg_loss: 4275.3336; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 164438.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168713.9339; val_optim_loss: 168713.9339
heaps
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9782; val_auprc_score: 0.9806; val_best_acc_score: 0.9356; val_best_f1_score: 0.9350; train_kl_reg_loss: 4350.5383; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 160790.7077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165141.2463; train_optim_loss: 165141.2463; val_kl_reg_loss: 4278.5215; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 163670.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167949.1705; val_optim_loss: 167949.1705
heaps
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9779; val_auprc_score: 0.9802; val_best_acc_score: 0.9351; val_best_f1_score: 0.9344; train_kl_reg_loss: 4353.2067; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 160658.5458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165011.7528; train_optim_loss: 165011.7528; val_kl_reg_loss: 4243.4425; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 164137.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168381.4027; val_optim_loss: 168381.4027
heaps
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9775; val_auprc_score: 0.9800; val_best_acc_score: 0.9355; val_best_f1_score: 0.9350; train_kl_reg_loss: 4350.4526; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 160304.2013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164654.6541; train_optim_loss: 164654.6541; val_kl_reg_loss: 4274.0558; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 164066.0646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168340.1193; val_optim_loss: 168340.1193
heaps
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9780; val_auprc_score: 0.9803; val_best_acc_score: 0.9361; val_best_f1_score: 0.9353; train_kl_reg_loss: 4347.4109; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 160026.2658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164373.6764; train_optim_loss: 164373.6764; val_kl_reg_loss: 4256.7370; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 163608.1037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167864.8416; val_optim_loss: 167864.8416
heaps
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9774; val_auprc_score: 0.9799; val_best_acc_score: 0.9348; val_best_f1_score: 0.9340; train_kl_reg_loss: 4346.4270; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 159828.3061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164174.7331; train_optim_loss: 164174.7331; val_kl_reg_loss: 4262.8375; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 163799.9155; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168062.7528; val_optim_loss: 168062.7528
heaps
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9767; val_auprc_score: 0.9791; val_best_acc_score: 0.9343; val_best_f1_score: 0.9332; train_kl_reg_loss: 4348.1508; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 159661.9602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164010.1110; train_optim_loss: 164010.1110; val_kl_reg_loss: 4240.1784; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 164135.6499; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168375.8295; val_optim_loss: 168375.8295
heaps
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9774; val_auprc_score: 0.9802; val_best_acc_score: 0.9370; val_best_f1_score: 0.9361; train_kl_reg_loss: 4339.6590; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 159394.8005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163734.4596; train_optim_loss: 163734.4596; val_kl_reg_loss: 4281.3633; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 163415.4240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167696.7869; val_optim_loss: 167696.7869
heaps
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9779; val_auprc_score: 0.9806; val_best_acc_score: 0.9367; val_best_f1_score: 0.9355; train_kl_reg_loss: 4337.0115; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 159161.7427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163498.7540; train_optim_loss: 163498.7540; val_kl_reg_loss: 4192.0144; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 163778.8210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167970.8352; val_optim_loss: 167970.8352
heaps
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9763; val_auprc_score: 0.9790; val_best_acc_score: 0.9348; val_best_f1_score: 0.9337; train_kl_reg_loss: 4334.2894; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 159138.6969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163472.9868; train_optim_loss: 163472.9868; val_kl_reg_loss: 4248.0763; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 163533.5355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167781.6122; val_optim_loss: 167781.6122
heaps
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9772; val_auprc_score: 0.9799; val_best_acc_score: 0.9356; val_best_f1_score: 0.9344; train_kl_reg_loss: 4333.9048; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 158962.3215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163296.2253; train_optim_loss: 163296.2253; val_kl_reg_loss: 4235.5391; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 163672.0710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167907.6094; val_optim_loss: 167907.6094
heaps
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9767; val_auprc_score: 0.9793; val_best_acc_score: 0.9363; val_best_f1_score: 0.9353; train_kl_reg_loss: 4328.6442; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 158815.2548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163143.8988; train_optim_loss: 163143.8988; val_kl_reg_loss: 4248.9817; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 163486.3189; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167735.3011; val_optim_loss: 167735.3011

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

heaps
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9799; val_auprc_score: 0.9825; val_best_acc_score: 0.9381; val_best_f1_score: 0.9375; train_kl_reg_loss: 4203.9008; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 157132.1542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161336.0552; train_optim_loss: 161336.0552; val_kl_reg_loss: 4086.7163; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 163221.6257; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167308.3416; val_optim_loss: 167308.3416
heaps
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9797; val_auprc_score: 0.9816; val_best_acc_score: 0.9384; val_best_f1_score: 0.9377; train_kl_reg_loss: 4134.0757; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 156756.5139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160890.5893; train_optim_loss: 160890.5893; val_kl_reg_loss: 4012.9213; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 162377.3026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166390.2251; val_optim_loss: 166390.2251
heaps
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9801; val_auprc_score: 0.9819; val_best_acc_score: 0.9389; val_best_f1_score: 0.9381; train_kl_reg_loss: 4084.4147; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 156505.7008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160590.1153; train_optim_loss: 160590.1153; val_kl_reg_loss: 3982.3418; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 162898.4055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166880.7486; val_optim_loss: 166880.7486
heaps
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9800; val_auprc_score: 0.9824; val_best_acc_score: 0.9392; val_best_f1_score: 0.9383; train_kl_reg_loss: 4046.7588; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 156420.2327; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160466.9919; train_optim_loss: 160466.9919; val_kl_reg_loss: 3936.6920; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 163042.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166979.6839; val_optim_loss: 166979.6839
heaps
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9807; val_auprc_score: 0.9831; val_best_acc_score: 0.9400; val_best_f1_score: 0.9390; train_kl_reg_loss: 4014.9343; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 156424.9770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160439.9122; train_optim_loss: 160439.9122; val_kl_reg_loss: 3919.0817; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 162394.7010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166313.7820; val_optim_loss: 166313.7820
heaps
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9801; val_auprc_score: 0.9821; val_best_acc_score: 0.9395; val_best_f1_score: 0.9386; train_kl_reg_loss: 3981.9989; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 156239.3389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160221.3377; train_optim_loss: 160221.3377; val_kl_reg_loss: 3886.2823; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 162666.3587; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166552.6420; val_optim_loss: 166552.6420
heaps
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9805; val_auprc_score: 0.9826; val_best_acc_score: 0.9402; val_best_f1_score: 0.9392; train_kl_reg_loss: 3959.0037; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 156309.0889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160268.0925; train_optim_loss: 160268.0925; val_kl_reg_loss: 3861.5088; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 162815.0866; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166676.5945; val_optim_loss: 166676.5945
heaps
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9805; val_auprc_score: 0.9824; val_best_acc_score: 0.9400; val_best_f1_score: 0.9389; train_kl_reg_loss: 3936.8553; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 156176.8181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160113.6737; train_optim_loss: 160113.6737; val_kl_reg_loss: 3850.1620; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 162487.5099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166337.6712; val_optim_loss: 166337.6712
heaps
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9806; val_auprc_score: 0.9822; val_best_acc_score: 0.9396; val_best_f1_score: 0.9386; train_kl_reg_loss: 3922.9196; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 156173.4497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160096.3692; train_optim_loss: 160096.3692; val_kl_reg_loss: 3824.2480; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 162430.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166254.9354; val_optim_loss: 166254.9354
heaps
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9806; val_auprc_score: 0.9827; val_best_acc_score: 0.9405; val_best_f1_score: 0.9393; train_kl_reg_loss: 3901.5040; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 156040.8350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159942.3394; train_optim_loss: 159942.3394; val_kl_reg_loss: 3816.9581; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 162896.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166713.6619; val_optim_loss: 166713.6619
heaps
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9807; val_auprc_score: 0.9831; val_best_acc_score: 0.9393; val_best_f1_score: 0.9380; train_kl_reg_loss: 3893.1348; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 156147.4494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160040.5837; train_optim_loss: 160040.5837; val_kl_reg_loss: 3793.1334; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 163083.5895; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166876.7237; val_optim_loss: 166876.7237
heaps
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9805; val_auprc_score: 0.9823; val_best_acc_score: 0.9389; val_best_f1_score: 0.9380; train_kl_reg_loss: 3878.9867; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 155950.5943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159829.5802; train_optim_loss: 159829.5802; val_kl_reg_loss: 3785.1122; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 163186.5774; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166971.6903; val_optim_loss: 166971.6903
heaps
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9806; val_auprc_score: 0.9828; val_best_acc_score: 0.9393; val_best_f1_score: 0.9382; train_kl_reg_loss: 3866.2627; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 156044.3887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159910.6515; train_optim_loss: 159910.6515; val_kl_reg_loss: 3789.2503; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 162901.2081; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166690.4581; val_optim_loss: 166690.4581

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

heaps
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9805; val_auprc_score: 0.9823; val_best_acc_score: 0.9393; val_best_f1_score: 0.9390; train_kl_reg_loss: 3856.4616; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 155783.5702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159640.0319; train_optim_loss: 159640.0319; val_kl_reg_loss: 3768.6039; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 162954.7152; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166723.3196; val_optim_loss: 166723.3196
heaps
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9807; val_auprc_score: 0.9826; val_best_acc_score: 0.9391; val_best_f1_score: 0.9386; train_kl_reg_loss: 3847.0381; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 155772.9176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159619.9552; train_optim_loss: 159619.9552; val_kl_reg_loss: 3762.8616; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 163144.2116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166907.0717; val_optim_loss: 166907.0717
heaps
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9808; val_auprc_score: 0.9830; val_best_acc_score: 0.9390; val_best_f1_score: 0.9386; train_kl_reg_loss: 3846.6762; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 155735.0015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159581.6774; train_optim_loss: 159581.6774; val_kl_reg_loss: 3765.6434; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 162760.1222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166525.7642; val_optim_loss: 166525.7642
heaps
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9809; val_auprc_score: 0.9833; val_best_acc_score: 0.9396; val_best_f1_score: 0.9389; train_kl_reg_loss: 3844.1669; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 155607.3691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159451.5363; train_optim_loss: 159451.5363; val_kl_reg_loss: 3759.6718; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 162948.0540; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166707.7259; val_optim_loss: 166707.7259

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 55 min 18 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
Val AUROC score: 0.9799
Val AUPRC score: 0.9819
Val best accuracy score: 0.9384
Val best F1 score: 0.9374
Val gene expr MSE score: 0.4996

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
