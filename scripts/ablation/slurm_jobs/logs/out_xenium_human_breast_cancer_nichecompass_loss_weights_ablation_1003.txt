None
Run timestamp: 15072023_183555_1003.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_1003']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9894; val_auprc_score: 0.9877; val_best_acc_score: 0.9530; val_best_f1_score: 0.9538; train_kl_reg_loss: 11874.1855; train_edge_recon_loss: 2637242.0060; train_gene_expr_recon_loss: 1313932.2653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3963048.4578; train_optim_loss: 3963048.4578; val_kl_reg_loss: 12303.2338; val_edge_recon_loss: 2625468.6228; val_gene_expr_recon_loss: 1255522.9878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3893294.8415; val_optim_loss: 3893294.8415
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9923; val_auprc_score: 0.9909; val_best_acc_score: 0.9628; val_best_f1_score: 0.9634; train_kl_reg_loss: 12755.2561; train_edge_recon_loss: 2595472.4599; train_gene_expr_recon_loss: 1241294.4822; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3849522.2005; train_optim_loss: 3849522.2005; val_kl_reg_loss: 12963.5641; val_edge_recon_loss: 2601892.4172; val_gene_expr_recon_loss: 1233484.0161; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3848339.9948; val_optim_loss: 3848339.9948
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9928; val_auprc_score: 0.9914; val_best_acc_score: 0.9655; val_best_f1_score: 0.9660; train_kl_reg_loss: 13113.1587; train_edge_recon_loss: 2588235.4618; train_gene_expr_recon_loss: 1227846.2554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3829194.8735; train_optim_loss: 3829194.8735; val_kl_reg_loss: 13174.4510; val_edge_recon_loss: 2604120.8319; val_gene_expr_recon_loss: 1223800.1729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3841095.4512; val_optim_loss: 3841095.4512
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9932; val_auprc_score: 0.9918; val_best_acc_score: 0.9667; val_best_f1_score: 0.9672; train_kl_reg_loss: 13265.9223; train_edge_recon_loss: 2584207.1735; train_gene_expr_recon_loss: 1222154.3535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3819627.4527; train_optim_loss: 3819627.4527; val_kl_reg_loss: 13075.2757; val_edge_recon_loss: 2595247.5418; val_gene_expr_recon_loss: 1224265.7835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3832588.5984; val_optim_loss: 3832588.5984
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9944; val_auprc_score: 0.9931; val_best_acc_score: 0.9709; val_best_f1_score: 0.9712; train_kl_reg_loss: 13329.2989; train_edge_recon_loss: 2580975.8502; train_gene_expr_recon_loss: 1219976.9611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3814282.1130; train_optim_loss: 3814282.1130; val_kl_reg_loss: 13413.4465; val_edge_recon_loss: 2587078.9512; val_gene_expr_recon_loss: 1220841.3349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3821333.7256; val_optim_loss: 3821333.7256
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9943; val_auprc_score: 0.9931; val_best_acc_score: 0.9710; val_best_f1_score: 0.9713; train_kl_reg_loss: 13361.1588; train_edge_recon_loss: 2578548.2620; train_gene_expr_recon_loss: 1218362.3729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3810271.7966; train_optim_loss: 3810271.7966; val_kl_reg_loss: 13406.4199; val_edge_recon_loss: 2587316.6551; val_gene_expr_recon_loss: 1221339.1507; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3822062.2239; val_optim_loss: 3822062.2239
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9945; val_auprc_score: 0.9931; val_best_acc_score: 0.9717; val_best_f1_score: 0.9721; train_kl_reg_loss: 13361.3450; train_edge_recon_loss: 2577216.7163; train_gene_expr_recon_loss: 1217364.6493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3807942.7086; train_optim_loss: 3807942.7086; val_kl_reg_loss: 13569.8645; val_edge_recon_loss: 2598268.5017; val_gene_expr_recon_loss: 1222009.8898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3833848.2596; val_optim_loss: 3833848.2596
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9942; val_auprc_score: 0.9927; val_best_acc_score: 0.9719; val_best_f1_score: 0.9722; train_kl_reg_loss: 13348.6147; train_edge_recon_loss: 2575681.6181; train_gene_expr_recon_loss: 1217330.3086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3806360.5404; train_optim_loss: 3806360.5404; val_kl_reg_loss: 13404.3644; val_edge_recon_loss: 2585275.6551; val_gene_expr_recon_loss: 1219714.1141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3818394.1455; val_optim_loss: 3818394.1455
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9947; val_auprc_score: 0.9934; val_best_acc_score: 0.9735; val_best_f1_score: 0.9738; train_kl_reg_loss: 13329.2600; train_edge_recon_loss: 2574853.6538; train_gene_expr_recon_loss: 1216623.6261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3804806.5373; train_optim_loss: 3804806.5373; val_kl_reg_loss: 13636.1284; val_edge_recon_loss: 2582680.4451; val_gene_expr_recon_loss: 1218634.9826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3814951.5566; val_optim_loss: 3814951.5566
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9943; val_auprc_score: 0.9927; val_best_acc_score: 0.9732; val_best_f1_score: 0.9736; train_kl_reg_loss: 13299.0656; train_edge_recon_loss: 2572564.5433; train_gene_expr_recon_loss: 1216137.8259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3802001.4318; train_optim_loss: 3802001.4318; val_kl_reg_loss: 13470.1257; val_edge_recon_loss: 2582891.9312; val_gene_expr_recon_loss: 1218844.4290; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3815206.4852; val_optim_loss: 3815206.4852
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9942; val_auprc_score: 0.9928; val_best_acc_score: 0.9725; val_best_f1_score: 0.9729; train_kl_reg_loss: 13278.5114; train_edge_recon_loss: 2571972.9628; train_gene_expr_recon_loss: 1216017.6897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3801269.1636; train_optim_loss: 3801269.1636; val_kl_reg_loss: 12765.5185; val_edge_recon_loss: 2581391.4556; val_gene_expr_recon_loss: 1219182.6899; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3813339.6690; val_optim_loss: 3813339.6690
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9946; val_auprc_score: 0.9933; val_best_acc_score: 0.9737; val_best_f1_score: 0.9740; train_kl_reg_loss: 13249.9503; train_edge_recon_loss: 2571906.5232; train_gene_expr_recon_loss: 1215930.8410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3801087.3139; train_optim_loss: 3801087.3139; val_kl_reg_loss: 13178.7810; val_edge_recon_loss: 2584459.2125; val_gene_expr_recon_loss: 1218012.8850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3815650.8780; val_optim_loss: 3815650.8780
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9947; val_auprc_score: 0.9933; val_best_acc_score: 0.9749; val_best_f1_score: 0.9752; train_kl_reg_loss: 13219.4578; train_edge_recon_loss: 2570857.7539; train_gene_expr_recon_loss: 1215260.4958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3799337.7043; train_optim_loss: 3799337.7043; val_kl_reg_loss: 12957.8682; val_edge_recon_loss: 2578849.6211; val_gene_expr_recon_loss: 1218874.7857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3810682.2709; val_optim_loss: 3810682.2709
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9945; val_auprc_score: 0.9930; val_best_acc_score: 0.9742; val_best_f1_score: 0.9746; train_kl_reg_loss: 13192.9540; train_edge_recon_loss: 2570304.9259; train_gene_expr_recon_loss: 1215798.3365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3799296.2152; train_optim_loss: 3799296.2152; val_kl_reg_loss: 13117.2819; val_edge_recon_loss: 2580150.6934; val_gene_expr_recon_loss: 1218328.8733; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3811596.8545; val_optim_loss: 3811596.8545
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9944; val_auprc_score: 0.9927; val_best_acc_score: 0.9745; val_best_f1_score: 0.9748; train_kl_reg_loss: 13162.3312; train_edge_recon_loss: 2569889.4888; train_gene_expr_recon_loss: 1215346.9079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3798398.7265; train_optim_loss: 3798398.7265; val_kl_reg_loss: 13156.5606; val_edge_recon_loss: 2575228.9974; val_gene_expr_recon_loss: 1217846.1381; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3806231.7030; val_optim_loss: 3806231.7030
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9948; val_auprc_score: 0.9933; val_best_acc_score: 0.9759; val_best_f1_score: 0.9761; train_kl_reg_loss: 13131.2052; train_edge_recon_loss: 2569235.3237; train_gene_expr_recon_loss: 1214791.3786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3797157.9092; train_optim_loss: 3797157.9092; val_kl_reg_loss: 12984.2718; val_edge_recon_loss: 2575675.3179; val_gene_expr_recon_loss: 1217242.0814; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3805901.6794; val_optim_loss: 3805901.6794
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9947; val_auprc_score: 0.9933; val_best_acc_score: 0.9752; val_best_f1_score: 0.9755; train_kl_reg_loss: 13101.8051; train_edge_recon_loss: 2568841.1057; train_gene_expr_recon_loss: 1214812.6927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3796755.6016; train_optim_loss: 3796755.6016; val_kl_reg_loss: 13049.7188; val_edge_recon_loss: 2579050.7308; val_gene_expr_recon_loss: 1218247.1625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3810347.6202; val_optim_loss: 3810347.6202
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9945; val_auprc_score: 0.9931; val_best_acc_score: 0.9750; val_best_f1_score: 0.9753; train_kl_reg_loss: 13067.7038; train_edge_recon_loss: 2568288.2595; train_gene_expr_recon_loss: 1214729.5780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3796085.5461; train_optim_loss: 3796085.5461; val_kl_reg_loss: 12944.6261; val_edge_recon_loss: 2576838.3929; val_gene_expr_recon_loss: 1216428.4003; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3806211.4207; val_optim_loss: 3806211.4207
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9951; val_auprc_score: 0.9938; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 13037.4887; train_edge_recon_loss: 2567882.2475; train_gene_expr_recon_loss: 1214797.8303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3795717.5711; train_optim_loss: 3795717.5711; val_kl_reg_loss: 13080.6262; val_edge_recon_loss: 2574458.9826; val_gene_expr_recon_loss: 1218261.0775; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3805800.6890; val_optim_loss: 3805800.6890
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9950; val_auprc_score: 0.9934; val_best_acc_score: 0.9766; val_best_f1_score: 0.9769; train_kl_reg_loss: 13010.9483; train_edge_recon_loss: 2567051.9322; train_gene_expr_recon_loss: 1214402.1495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3794465.0261; train_optim_loss: 3794465.0261; val_kl_reg_loss: 12752.6587; val_edge_recon_loss: 2573277.4190; val_gene_expr_recon_loss: 1218755.0632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3804785.1394; val_optim_loss: 3804785.1394
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9947; val_auprc_score: 0.9931; val_best_acc_score: 0.9762; val_best_f1_score: 0.9765; train_kl_reg_loss: 12977.4946; train_edge_recon_loss: 2567409.0039; train_gene_expr_recon_loss: 1214014.5498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3794401.0474; train_optim_loss: 3794401.0474; val_kl_reg_loss: 12987.2057; val_edge_recon_loss: 2576283.4599; val_gene_expr_recon_loss: 1218378.5126; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3807649.1768; val_optim_loss: 3807649.1768
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9948; val_auprc_score: 0.9932; val_best_acc_score: 0.9760; val_best_f1_score: 0.9763; train_kl_reg_loss: 12956.5982; train_edge_recon_loss: 2567166.8380; train_gene_expr_recon_loss: 1213921.8848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3794045.3277; train_optim_loss: 3794045.3277; val_kl_reg_loss: 12795.9632; val_edge_recon_loss: 2575961.4800; val_gene_expr_recon_loss: 1216429.2173; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3805186.6655; val_optim_loss: 3805186.6655
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9945; val_auprc_score: 0.9930; val_best_acc_score: 0.9752; val_best_f1_score: 0.9755; train_kl_reg_loss: 12928.9853; train_edge_recon_loss: 2566431.8906; train_gene_expr_recon_loss: 1214342.7655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3793703.6425; train_optim_loss: 3793703.6425; val_kl_reg_loss: 13108.7952; val_edge_recon_loss: 2573686.9974; val_gene_expr_recon_loss: 1215070.7439; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3801866.5392; val_optim_loss: 3801866.5392
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9948; val_auprc_score: 0.9932; val_best_acc_score: 0.9765; val_best_f1_score: 0.9767; train_kl_reg_loss: 12921.7979; train_edge_recon_loss: 2566113.5548; train_gene_expr_recon_loss: 1214155.0517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3793190.4003; train_optim_loss: 3793190.4003; val_kl_reg_loss: 12615.6040; val_edge_recon_loss: 2572212.7247; val_gene_expr_recon_loss: 1216741.8271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3801570.1655; val_optim_loss: 3801570.1655
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9950; val_auprc_score: 0.9934; val_best_acc_score: 0.9772; val_best_f1_score: 0.9774; train_kl_reg_loss: 12892.9680; train_edge_recon_loss: 2566087.1160; train_gene_expr_recon_loss: 1214348.6399; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3793328.7259; train_optim_loss: 3793328.7259; val_kl_reg_loss: 12759.9766; val_edge_recon_loss: 2577702.1333; val_gene_expr_recon_loss: 1215838.4399; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3806300.5557; val_optim_loss: 3806300.5557
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9949; val_auprc_score: 0.9936; val_best_acc_score: 0.9763; val_best_f1_score: 0.9765; train_kl_reg_loss: 12857.3894; train_edge_recon_loss: 2565733.3800; train_gene_expr_recon_loss: 1214018.1780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3792608.9471; train_optim_loss: 3792608.9471; val_kl_reg_loss: 12593.9419; val_edge_recon_loss: 2569475.1490; val_gene_expr_recon_loss: 1217053.1781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3799122.2639; val_optim_loss: 3799122.2639
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9953; val_auprc_score: 0.9941; val_best_acc_score: 0.9772; val_best_f1_score: 0.9775; train_kl_reg_loss: 12833.2182; train_edge_recon_loss: 2565288.3886; train_gene_expr_recon_loss: 1213599.7200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3791721.3295; train_optim_loss: 3791721.3295; val_kl_reg_loss: 12833.8331; val_edge_recon_loss: 2570916.0897; val_gene_expr_recon_loss: 1217735.8767; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3801485.8049; val_optim_loss: 3801485.8049
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9947; val_auprc_score: 0.9931; val_best_acc_score: 0.9768; val_best_f1_score: 0.9771; train_kl_reg_loss: 12821.5731; train_edge_recon_loss: 2565013.7064; train_gene_expr_recon_loss: 1213672.9089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3791508.1915; train_optim_loss: 3791508.1915; val_kl_reg_loss: 12397.1697; val_edge_recon_loss: 2569328.8476; val_gene_expr_recon_loss: 1217731.8476; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3799457.8676; val_optim_loss: 3799457.8676
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9953; val_auprc_score: 0.9940; val_best_acc_score: 0.9768; val_best_f1_score: 0.9771; train_kl_reg_loss: 12796.9297; train_edge_recon_loss: 2565060.0280; train_gene_expr_recon_loss: 1213434.5463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3791291.5036; train_optim_loss: 3791291.5036; val_kl_reg_loss: 12614.6755; val_edge_recon_loss: 2570125.6716; val_gene_expr_recon_loss: 1217573.6834; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3800314.0340; val_optim_loss: 3800314.0340
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9949; val_auprc_score: 0.9934; val_best_acc_score: 0.9771; val_best_f1_score: 0.9773; train_kl_reg_loss: 12766.6385; train_edge_recon_loss: 2564778.9008; train_gene_expr_recon_loss: 1213038.6405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3790584.1778; train_optim_loss: 3790584.1778; val_kl_reg_loss: 12817.3319; val_edge_recon_loss: 2569532.7256; val_gene_expr_recon_loss: 1218028.3619; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3800378.4199; val_optim_loss: 3800378.4199

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9952; val_auprc_score: 0.9937; val_best_acc_score: 0.9776; val_best_f1_score: 0.9779; train_kl_reg_loss: 12793.6306; train_edge_recon_loss: 2561668.0280; train_gene_expr_recon_loss: 1205234.9476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3779696.6065; train_optim_loss: 3779696.6065; val_kl_reg_loss: 12645.4482; val_edge_recon_loss: 2568409.0218; val_gene_expr_recon_loss: 1209837.6202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3790892.1028; val_optim_loss: 3790892.1028
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9950; val_auprc_score: 0.9935; val_best_acc_score: 0.9772; val_best_f1_score: 0.9775; train_kl_reg_loss: 12568.7335; train_edge_recon_loss: 2561840.7729; train_gene_expr_recon_loss: 1204657.6598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3779067.1696; train_optim_loss: 3779067.1696; val_kl_reg_loss: 12424.8181; val_edge_recon_loss: 2568754.5706; val_gene_expr_recon_loss: 1209664.1790; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3790843.5671; val_optim_loss: 3790843.5671
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9954; val_auprc_score: 0.9939; val_best_acc_score: 0.9782; val_best_f1_score: 0.9785; train_kl_reg_loss: 12473.5616; train_edge_recon_loss: 2561653.0181; train_gene_expr_recon_loss: 1203789.6637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3777916.2451; train_optim_loss: 3777916.2451; val_kl_reg_loss: 12442.0268; val_edge_recon_loss: 2565571.9155; val_gene_expr_recon_loss: 1210213.8162; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3788227.7552; val_optim_loss: 3788227.7552
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9954; val_auprc_score: 0.9940; val_best_acc_score: 0.9788; val_best_f1_score: 0.9790; train_kl_reg_loss: 12408.8489; train_edge_recon_loss: 2561065.9076; train_gene_expr_recon_loss: 1203938.8277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3777413.5836; train_optim_loss: 3777413.5836; val_kl_reg_loss: 12257.0140; val_edge_recon_loss: 2563086.5505; val_gene_expr_recon_loss: 1208458.3253; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3783801.8902; val_optim_loss: 3783801.8902
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9953; val_auprc_score: 0.9937; val_best_acc_score: 0.9781; val_best_f1_score: 0.9784; train_kl_reg_loss: 12361.2969; train_edge_recon_loss: 2561033.0448; train_gene_expr_recon_loss: 1203179.6731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3776574.0181; train_optim_loss: 3776574.0181; val_kl_reg_loss: 12358.9507; val_edge_recon_loss: 2566373.9791; val_gene_expr_recon_loss: 1208500.7631; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3787233.6908; val_optim_loss: 3787233.6908
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9952; val_auprc_score: 0.9935; val_best_acc_score: 0.9778; val_best_f1_score: 0.9781; train_kl_reg_loss: 12336.3614; train_edge_recon_loss: 2561422.4274; train_gene_expr_recon_loss: 1203455.1787; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3777213.9696; train_optim_loss: 3777213.9696; val_kl_reg_loss: 12219.6551; val_edge_recon_loss: 2566646.2587; val_gene_expr_recon_loss: 1207463.1620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3786329.0732; val_optim_loss: 3786329.0732
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9955; val_auprc_score: 0.9941; val_best_acc_score: 0.9787; val_best_f1_score: 0.9790; train_kl_reg_loss: 12300.6371; train_edge_recon_loss: 2560796.0717; train_gene_expr_recon_loss: 1203339.8994; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3776436.6089; train_optim_loss: 3776436.6089; val_kl_reg_loss: 12139.6873; val_edge_recon_loss: 2564332.4643; val_gene_expr_recon_loss: 1207745.6503; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3784217.8127; val_optim_loss: 3784217.8127
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9953; val_auprc_score: 0.9938; val_best_acc_score: 0.9786; val_best_f1_score: 0.9789; train_kl_reg_loss: 12273.5867; train_edge_recon_loss: 2561520.0491; train_gene_expr_recon_loss: 1202912.4910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3776706.1252; train_optim_loss: 3776706.1252; val_kl_reg_loss: 12211.6447; val_edge_recon_loss: 2564714.6986; val_gene_expr_recon_loss: 1207395.1141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3784321.4608; val_optim_loss: 3784321.4608

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9954; val_auprc_score: 0.9939; val_best_acc_score: 0.9784; val_best_f1_score: 0.9787; train_kl_reg_loss: 12288.0836; train_edge_recon_loss: 2560561.4242; train_gene_expr_recon_loss: 1201814.7795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3774664.2869; train_optim_loss: 3774664.2869; val_kl_reg_loss: 12261.9613; val_edge_recon_loss: 2565124.6559; val_gene_expr_recon_loss: 1205405.7139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3782792.3328; val_optim_loss: 3782792.3328
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9953; val_auprc_score: 0.9938; val_best_acc_score: 0.9784; val_best_f1_score: 0.9787; train_kl_reg_loss: 12281.4797; train_edge_recon_loss: 2560992.5043; train_gene_expr_recon_loss: 1201577.7365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3774851.7238; train_optim_loss: 3774851.7238; val_kl_reg_loss: 12225.4769; val_edge_recon_loss: 2565009.4765; val_gene_expr_recon_loss: 1207754.2012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3784989.1551; val_optim_loss: 3784989.1551
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9955; val_auprc_score: 0.9941; val_best_acc_score: 0.9782; val_best_f1_score: 0.9785; train_kl_reg_loss: 12281.9582; train_edge_recon_loss: 2561004.7600; train_gene_expr_recon_loss: 1201707.9477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3774994.6641; train_optim_loss: 3774994.6641; val_kl_reg_loss: 12227.3561; val_edge_recon_loss: 2564150.0235; val_gene_expr_recon_loss: 1205669.6263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3782046.9974; val_optim_loss: 3782046.9974
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9953; val_auprc_score: 0.9938; val_best_acc_score: 0.9785; val_best_f1_score: 0.9787; train_kl_reg_loss: 12271.5668; train_edge_recon_loss: 2560656.2931; train_gene_expr_recon_loss: 1201766.4407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3774694.2963; train_optim_loss: 3774694.2963; val_kl_reg_loss: 12218.2154; val_edge_recon_loss: 2564657.3650; val_gene_expr_recon_loss: 1206906.6420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3783782.2186; val_optim_loss: 3783782.2186
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9954; val_auprc_score: 0.9939; val_best_acc_score: 0.9785; val_best_f1_score: 0.9788; train_kl_reg_loss: 12257.3573; train_edge_recon_loss: 2560415.3655; train_gene_expr_recon_loss: 1202068.3185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3774741.0430; train_optim_loss: 3774741.0430; val_kl_reg_loss: 12187.1820; val_edge_recon_loss: 2563449.6307; val_gene_expr_recon_loss: 1205718.3371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3781355.1516; val_optim_loss: 3781355.1516
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9953; val_auprc_score: 0.9937; val_best_acc_score: 0.9783; val_best_f1_score: 0.9785; train_kl_reg_loss: 12256.4890; train_edge_recon_loss: 2560646.6779; train_gene_expr_recon_loss: 1201595.6730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3774498.8387; train_optim_loss: 3774498.8387; val_kl_reg_loss: 12223.2477; val_edge_recon_loss: 2565517.1115; val_gene_expr_recon_loss: 1206284.8149; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3784025.1733; val_optim_loss: 3784025.1733
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9955; val_auprc_score: 0.9943; val_best_acc_score: 0.9786; val_best_f1_score: 0.9788; train_kl_reg_loss: 12253.4645; train_edge_recon_loss: 2560759.7697; train_gene_expr_recon_loss: 1201233.2645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3774246.4955; train_optim_loss: 3774246.4955; val_kl_reg_loss: 12198.8173; val_edge_recon_loss: 2563555.4617; val_gene_expr_recon_loss: 1207528.6995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3783282.9739; val_optim_loss: 3783282.9739
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9954; val_auprc_score: 0.9940; val_best_acc_score: 0.9786; val_best_f1_score: 0.9789; train_kl_reg_loss: 12256.6084; train_edge_recon_loss: 2561074.8404; train_gene_expr_recon_loss: 1201544.1498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3774875.6001; train_optim_loss: 3774875.6001; val_kl_reg_loss: 12208.7289; val_edge_recon_loss: 2563603.7213; val_gene_expr_recon_loss: 1206059.7927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3781872.2456; val_optim_loss: 3781872.2456
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9952; val_auprc_score: 0.9937; val_best_acc_score: 0.9778; val_best_f1_score: 0.9781; train_kl_reg_loss: 12246.6929; train_edge_recon_loss: 2560841.5976; train_gene_expr_recon_loss: 1201561.1886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3774649.4817; train_optim_loss: 3774649.4817; val_kl_reg_loss: 12211.7659; val_edge_recon_loss: 2567924.6220; val_gene_expr_recon_loss: 1207031.7936; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3787168.1786; val_optim_loss: 3787168.1786

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9955; val_auprc_score: 0.9941; val_best_acc_score: 0.9785; val_best_f1_score: 0.9788; train_kl_reg_loss: 12249.5134; train_edge_recon_loss: 2560871.1736; train_gene_expr_recon_loss: 1201152.9772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3774273.6645; train_optim_loss: 3774273.6645; val_kl_reg_loss: 12196.9997; val_edge_recon_loss: 2565651.2796; val_gene_expr_recon_loss: 1206570.7848; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3784419.0688; val_optim_loss: 3784419.0688
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9953; val_auprc_score: 0.9938; val_best_acc_score: 0.9782; val_best_f1_score: 0.9784; train_kl_reg_loss: 12244.2108; train_edge_recon_loss: 2560459.4775; train_gene_expr_recon_loss: 1201375.8778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3774079.5673; train_optim_loss: 3774079.5673; val_kl_reg_loss: 12197.9628; val_edge_recon_loss: 2565567.9347; val_gene_expr_recon_loss: 1205669.9791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3783435.8702; val_optim_loss: 3783435.8702
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9952; val_auprc_score: 0.9937; val_best_acc_score: 0.9781; val_best_f1_score: 0.9784; train_kl_reg_loss: 12247.7341; train_edge_recon_loss: 2559881.9512; train_gene_expr_recon_loss: 1201885.2743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3774014.9560; train_optim_loss: 3774014.9560; val_kl_reg_loss: 12192.4620; val_edge_recon_loss: 2564562.9068; val_gene_expr_recon_loss: 1205829.8541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3782585.2369; val_optim_loss: 3782585.2369
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9953; val_auprc_score: 0.9937; val_best_acc_score: 0.9783; val_best_f1_score: 0.9785; train_kl_reg_loss: 12246.8088; train_edge_recon_loss: 2560751.1691; train_gene_expr_recon_loss: 1201579.8505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3774577.8329; train_optim_loss: 3774577.8329; val_kl_reg_loss: 12192.3228; val_edge_recon_loss: 2564827.2692; val_gene_expr_recon_loss: 1206966.0126; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3783985.5949; val_optim_loss: 3783985.5949

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1244 min 46 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
Val AUROC score: 0.9954
Val AUPRC score: 0.9939
Val best accuracy score: 0.9783
Val best F1 score: 0.9786
Val gene expr MSE score: 2.6155

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
