None
Run timestamp: 15072023_215502_1008.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_1008']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9395; val_auprc_score: 0.9217; val_best_acc_score: 0.8790; val_best_f1_score: 0.8868; train_kl_reg_loss: 21810.4159; train_edge_recon_loss: 26878626.7559; train_gene_expr_recon_loss: 1353816.3136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28254253.4706; train_optim_loss: 28254253.4706; val_kl_reg_loss: 19995.6737; val_edge_recon_loss: 26784141.5526; val_gene_expr_recon_loss: 1292728.3158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28096865.5263; val_optim_loss: 28096865.5263
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9584; val_auprc_score: 0.9484; val_best_acc_score: 0.9003; val_best_f1_score: 0.9045; train_kl_reg_loss: 17378.6496; train_edge_recon_loss: 26233787.2735; train_gene_expr_recon_loss: 1267437.6763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27518603.6029; train_optim_loss: 27518603.6029; val_kl_reg_loss: 15572.6688; val_edge_recon_loss: 26738665.5263; val_gene_expr_recon_loss: 1253862.7516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28008100.9474; val_optim_loss: 28008100.9474
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9645; val_auprc_score: 0.9550; val_best_acc_score: 0.9104; val_best_f1_score: 0.9139; train_kl_reg_loss: 15765.8317; train_edge_recon_loss: 26110693.6824; train_gene_expr_recon_loss: 1236554.4937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27363014.0147; train_optim_loss: 27363014.0147; val_kl_reg_loss: 14949.9097; val_edge_recon_loss: 26605225.9737; val_gene_expr_recon_loss: 1228446.4490; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27848622.2632; val_optim_loss: 27848622.2632
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9654; val_auprc_score: 0.9544; val_best_acc_score: 0.9151; val_best_f1_score: 0.9183; train_kl_reg_loss: 15707.9987; train_edge_recon_loss: 26049351.4441; train_gene_expr_recon_loss: 1219616.8415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27284676.3500; train_optim_loss: 27284676.3500; val_kl_reg_loss: 15299.5200; val_edge_recon_loss: 26581250.0263; val_gene_expr_recon_loss: 1215750.5016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27812300.1316; val_optim_loss: 27812300.1316
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9699; val_auprc_score: 0.9602; val_best_acc_score: 0.9219; val_best_f1_score: 0.9245; train_kl_reg_loss: 15735.8478; train_edge_recon_loss: 26000326.5382; train_gene_expr_recon_loss: 1209632.3790; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27225694.7588; train_optim_loss: 27225694.7588; val_kl_reg_loss: 15644.7297; val_edge_recon_loss: 26489298.8684; val_gene_expr_recon_loss: 1210972.0707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27715915.5000; val_optim_loss: 27715915.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9703; val_auprc_score: 0.9615; val_best_acc_score: 0.9217; val_best_f1_score: 0.9246; train_kl_reg_loss: 15865.7633; train_edge_recon_loss: 25982858.8529; train_gene_expr_recon_loss: 1203063.9945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27201788.6118; train_optim_loss: 27201788.6118; val_kl_reg_loss: 15765.7335; val_edge_recon_loss: 26505699.0789; val_gene_expr_recon_loss: 1203974.5691; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27725439.3947; val_optim_loss: 27725439.3947
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9727; val_auprc_score: 0.9654; val_best_acc_score: 0.9252; val_best_f1_score: 0.9277; train_kl_reg_loss: 15923.6037; train_edge_recon_loss: 25975266.8294; train_gene_expr_recon_loss: 1198393.9614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27189584.4029; train_optim_loss: 27189584.4029; val_kl_reg_loss: 15769.7251; val_edge_recon_loss: 26471123.9211; val_gene_expr_recon_loss: 1198023.2072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27684916.8684; val_optim_loss: 27684916.8684
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9725; val_auprc_score: 0.9637; val_best_acc_score: 0.9260; val_best_f1_score: 0.9283; train_kl_reg_loss: 15964.3537; train_edge_recon_loss: 25955823.5559; train_gene_expr_recon_loss: 1195845.2061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27167633.0941; train_optim_loss: 27167633.0941; val_kl_reg_loss: 15364.0773; val_edge_recon_loss: 26484466.3421; val_gene_expr_recon_loss: 1199666.4342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27699496.7368; val_optim_loss: 27699496.7368
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9740; val_auprc_score: 0.9663; val_best_acc_score: 0.9272; val_best_f1_score: 0.9293; train_kl_reg_loss: 16001.4791; train_edge_recon_loss: 25937420.2176; train_gene_expr_recon_loss: 1194463.6553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27147885.3676; train_optim_loss: 27147885.3676; val_kl_reg_loss: 16091.5042; val_edge_recon_loss: 26478792.6579; val_gene_expr_recon_loss: 1196906.8651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27691790.9737; val_optim_loss: 27691790.9737
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9748; val_auprc_score: 0.9668; val_best_acc_score: 0.9310; val_best_f1_score: 0.9331; train_kl_reg_loss: 16000.7356; train_edge_recon_loss: 25951664.4382; train_gene_expr_recon_loss: 1192223.2017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27159888.3941; train_optim_loss: 27159888.3941; val_kl_reg_loss: 15946.9876; val_edge_recon_loss: 26406532.6842; val_gene_expr_recon_loss: 1194019.5115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27616499.0526; val_optim_loss: 27616499.0526
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9764; val_auprc_score: 0.9694; val_best_acc_score: 0.9315; val_best_f1_score: 0.9334; train_kl_reg_loss: 16054.8696; train_edge_recon_loss: 25934650.5706; train_gene_expr_recon_loss: 1190222.9750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27140928.3971; train_optim_loss: 27140928.3971; val_kl_reg_loss: 15663.4445; val_edge_recon_loss: 26475991.6842; val_gene_expr_recon_loss: 1192412.8865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27684068.1053; val_optim_loss: 27684068.1053
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9764; val_auprc_score: 0.9690; val_best_acc_score: 0.9337; val_best_f1_score: 0.9356; train_kl_reg_loss: 15877.3270; train_edge_recon_loss: 25909826.5441; train_gene_expr_recon_loss: 1189660.7770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27115364.6206; train_optim_loss: 27115364.6206; val_kl_reg_loss: 15511.7845; val_edge_recon_loss: 26399231.1842; val_gene_expr_recon_loss: 1190991.6546; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27605734.7105; val_optim_loss: 27605734.7105
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9769; val_auprc_score: 0.9703; val_best_acc_score: 0.9337; val_best_f1_score: 0.9356; train_kl_reg_loss: 15877.1756; train_edge_recon_loss: 25917861.2735; train_gene_expr_recon_loss: 1187980.5033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27121718.8941; train_optim_loss: 27121718.8941; val_kl_reg_loss: 15545.1348; val_edge_recon_loss: 26424394.3421; val_gene_expr_recon_loss: 1191719.5888; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27631658.9737; val_optim_loss: 27631658.9737
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9784; val_auprc_score: 0.9715; val_best_acc_score: 0.9360; val_best_f1_score: 0.9378; train_kl_reg_loss: 15884.0206; train_edge_recon_loss: 25903752.1088; train_gene_expr_recon_loss: 1188219.0180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27107855.1412; train_optim_loss: 27107855.1412; val_kl_reg_loss: 15529.2604; val_edge_recon_loss: 26377525.0263; val_gene_expr_recon_loss: 1194569.9868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27587624.4474; val_optim_loss: 27587624.4474
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9777; val_auprc_score: 0.9704; val_best_acc_score: 0.9369; val_best_f1_score: 0.9384; train_kl_reg_loss: 15828.6035; train_edge_recon_loss: 25898417.8647; train_gene_expr_recon_loss: 1186898.7033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27101145.0618; train_optim_loss: 27101145.0618; val_kl_reg_loss: 15332.6778; val_edge_recon_loss: 26361079.9211; val_gene_expr_recon_loss: 1189574.8865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27565987.5789; val_optim_loss: 27565987.5789
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9785; val_auprc_score: 0.9719; val_best_acc_score: 0.9370; val_best_f1_score: 0.9387; train_kl_reg_loss: 15705.7351; train_edge_recon_loss: 25889361.1176; train_gene_expr_recon_loss: 1186310.2625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27091377.1412; train_optim_loss: 27091377.1412; val_kl_reg_loss: 15606.1968; val_edge_recon_loss: 26405793.7105; val_gene_expr_recon_loss: 1192478.8158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27613878.6579; val_optim_loss: 27613878.6579
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9788; val_auprc_score: 0.9726; val_best_acc_score: 0.9367; val_best_f1_score: 0.9383; train_kl_reg_loss: 15735.9299; train_edge_recon_loss: 25872996.0500; train_gene_expr_recon_loss: 1186617.4086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27075349.4088; train_optim_loss: 27075349.4088; val_kl_reg_loss: 15507.9800; val_edge_recon_loss: 26413339.9474; val_gene_expr_recon_loss: 1191447.0132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27620295.0263; val_optim_loss: 27620295.0263
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9789; val_auprc_score: 0.9726; val_best_acc_score: 0.9378; val_best_f1_score: 0.9395; train_kl_reg_loss: 15693.8138; train_edge_recon_loss: 25865636.5706; train_gene_expr_recon_loss: 1185866.3404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27067196.7235; train_optim_loss: 27067196.7235; val_kl_reg_loss: 15346.5127; val_edge_recon_loss: 26306267.6579; val_gene_expr_recon_loss: 1188008.3668; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27509622.5526; val_optim_loss: 27509622.5526
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9791; val_auprc_score: 0.9724; val_best_acc_score: 0.9383; val_best_f1_score: 0.9399; train_kl_reg_loss: 15637.1636; train_edge_recon_loss: 25873947.6382; train_gene_expr_recon_loss: 1185059.7658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27074644.6088; train_optim_loss: 27074644.6088; val_kl_reg_loss: 14645.7683; val_edge_recon_loss: 26327114.2105; val_gene_expr_recon_loss: 1189375.9836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27531136.0789; val_optim_loss: 27531136.0789
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9797; val_auprc_score: 0.9733; val_best_acc_score: 0.9398; val_best_f1_score: 0.9412; train_kl_reg_loss: 15582.9070; train_edge_recon_loss: 25876500.7000; train_gene_expr_recon_loss: 1185317.2803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27077400.8676; train_optim_loss: 27077400.8676; val_kl_reg_loss: 15363.0839; val_edge_recon_loss: 26343362.9737; val_gene_expr_recon_loss: 1190215.8306; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27548941.7105; val_optim_loss: 27548941.7105
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9806; val_auprc_score: 0.9749; val_best_acc_score: 0.9398; val_best_f1_score: 0.9412; train_kl_reg_loss: 15580.8089; train_edge_recon_loss: 25857701.2353; train_gene_expr_recon_loss: 1184499.8871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27057781.9176; train_optim_loss: 27057781.9176; val_kl_reg_loss: 14919.9670; val_edge_recon_loss: 26350474.1579; val_gene_expr_recon_loss: 1187580.6628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27552974.6316; val_optim_loss: 27552974.6316
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9812; val_auprc_score: 0.9756; val_best_acc_score: 0.9413; val_best_f1_score: 0.9427; train_kl_reg_loss: 15584.0279; train_edge_recon_loss: 25854884.2941; train_gene_expr_recon_loss: 1184486.8866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27054955.2000; train_optim_loss: 27054955.2000; val_kl_reg_loss: 14852.8502; val_edge_recon_loss: 26338788.6053; val_gene_expr_recon_loss: 1190241.8799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27543883.3158; val_optim_loss: 27543883.3158

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9823; val_auprc_score: 0.9772; val_best_acc_score: 0.9436; val_best_f1_score: 0.9448; train_kl_reg_loss: 15882.5717; train_edge_recon_loss: 25830354.3824; train_gene_expr_recon_loss: 1168097.8112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27014334.7588; train_optim_loss: 27014334.7588; val_kl_reg_loss: 15691.3079; val_edge_recon_loss: 26272430.9474; val_gene_expr_recon_loss: 1173039.3586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27461161.6842; val_optim_loss: 27461161.6842
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9811; val_auprc_score: 0.9751; val_best_acc_score: 0.9414; val_best_f1_score: 0.9431; train_kl_reg_loss: 15984.4970; train_edge_recon_loss: 25825834.4735; train_gene_expr_recon_loss: 1166797.3781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27008616.3206; train_optim_loss: 27008616.3206; val_kl_reg_loss: 15501.8906; val_edge_recon_loss: 26335652.1053; val_gene_expr_recon_loss: 1168546.8536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27519700.7105; val_optim_loss: 27519700.7105
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9813; val_auprc_score: 0.9751; val_best_acc_score: 0.9429; val_best_f1_score: 0.9445; train_kl_reg_loss: 15957.9697; train_edge_recon_loss: 25816151.5088; train_gene_expr_recon_loss: 1165826.3811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26997935.8176; train_optim_loss: 26997935.8176; val_kl_reg_loss: 15456.2835; val_edge_recon_loss: 26300323.3158; val_gene_expr_recon_loss: 1170313.6266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27486093.4474; val_optim_loss: 27486093.4474
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9819; val_auprc_score: 0.9760; val_best_acc_score: 0.9439; val_best_f1_score: 0.9452; train_kl_reg_loss: 15883.4480; train_edge_recon_loss: 25830052.3941; train_gene_expr_recon_loss: 1165922.2752; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27011858.0529; train_optim_loss: 27011858.0529; val_kl_reg_loss: 15642.3004; val_edge_recon_loss: 26287983.0000; val_gene_expr_recon_loss: 1170435.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27474060.8158; val_optim_loss: 27474060.8158
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9821; val_auprc_score: 0.9764; val_best_acc_score: 0.9449; val_best_f1_score: 0.9462; train_kl_reg_loss: 15783.5630; train_edge_recon_loss: 25812594.7206; train_gene_expr_recon_loss: 1165477.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26993855.9647; train_optim_loss: 26993855.9647; val_kl_reg_loss: 15423.6344; val_edge_recon_loss: 26284502.6842; val_gene_expr_recon_loss: 1171989.0082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27471915.3421; val_optim_loss: 27471915.3421

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9822; val_auprc_score: 0.9771; val_best_acc_score: 0.9438; val_best_f1_score: 0.9451; train_kl_reg_loss: 15795.4237; train_edge_recon_loss: 25819147.0324; train_gene_expr_recon_loss: 1163258.7436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26998201.2088; train_optim_loss: 26998201.2088; val_kl_reg_loss: 15501.0870; val_edge_recon_loss: 26283999.6579; val_gene_expr_recon_loss: 1169712.1990; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27469212.9211; val_optim_loss: 27469212.9211
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9819; val_auprc_score: 0.9760; val_best_acc_score: 0.9438; val_best_f1_score: 0.9451; train_kl_reg_loss: 15767.1073; train_edge_recon_loss: 25820768.3000; train_gene_expr_recon_loss: 1162760.4987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26999295.9176; train_optim_loss: 26999295.9176; val_kl_reg_loss: 15483.9483; val_edge_recon_loss: 26324281.8421; val_gene_expr_recon_loss: 1169870.8684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27509636.6579; val_optim_loss: 27509636.6579
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9825; val_auprc_score: 0.9768; val_best_acc_score: 0.9446; val_best_f1_score: 0.9459; train_kl_reg_loss: 15799.3737; train_edge_recon_loss: 25826740.3412; train_gene_expr_recon_loss: 1163164.6011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27005704.3382; train_optim_loss: 27005704.3382; val_kl_reg_loss: 15499.4971; val_edge_recon_loss: 26295887.5263; val_gene_expr_recon_loss: 1165669.7039; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27477056.7368; val_optim_loss: 27477056.7368
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9822; val_auprc_score: 0.9770; val_best_acc_score: 0.9433; val_best_f1_score: 0.9448; train_kl_reg_loss: 15777.6910; train_edge_recon_loss: 25811507.2971; train_gene_expr_recon_loss: 1163288.5818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26990573.5559; train_optim_loss: 26990573.5559; val_kl_reg_loss: 15476.5509; val_edge_recon_loss: 26307734.3947; val_gene_expr_recon_loss: 1166119.9145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27489330.8421; val_optim_loss: 27489330.8421

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 45 min 17 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
Val AUROC score: 0.9815
Val AUPRC score: 0.9760
Val best accuracy score: 0.9429
Val best F1 score: 0.9442
Val gene expr MSE score: 2.6848

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
