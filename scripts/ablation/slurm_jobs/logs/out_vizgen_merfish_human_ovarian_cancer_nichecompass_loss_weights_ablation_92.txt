None
Run timestamp: 17072023_232950_92.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_92']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1931624
Number of validation edges: 214624
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9915; val_auprc_score: 0.9911; val_best_acc_score: 0.9541; val_best_f1_score: 0.9543; train_kl_reg_loss: 32465.4209; train_edge_recon_loss: 2698474.7017; train_gene_expr_recon_loss: 1407027.8932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4137968.0150; train_optim_loss: 4137968.0150; val_kl_reg_loss: 23752.1051; val_edge_recon_loss: 2634272.7220; val_gene_expr_recon_loss: 1326909.5482; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3984934.3613; val_optim_loss: 3984934.3613
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9943; val_auprc_score: 0.9938; val_best_acc_score: 0.9645; val_best_f1_score: 0.9647; train_kl_reg_loss: 21101.1039; train_edge_recon_loss: 2615047.7786; train_gene_expr_recon_loss: 1312993.4270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3949142.3056; train_optim_loss: 3949142.3056; val_kl_reg_loss: 18344.8907; val_edge_recon_loss: 2617190.9613; val_gene_expr_recon_loss: 1304018.9449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3939554.7899; val_optim_loss: 3939554.7899
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9958; val_auprc_score: 0.9954; val_best_acc_score: 0.9701; val_best_f1_score: 0.9703; train_kl_reg_loss: 17624.5444; train_edge_recon_loss: 2603559.6549; train_gene_expr_recon_loss: 1301341.2064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3922525.4081; train_optim_loss: 3922525.4081; val_kl_reg_loss: 16656.4069; val_edge_recon_loss: 2608294.6208; val_gene_expr_recon_loss: 1296858.7366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3921809.7625; val_optim_loss: 3921809.7625
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9959; val_auprc_score: 0.9955; val_best_acc_score: 0.9708; val_best_f1_score: 0.9710; train_kl_reg_loss: 16237.3241; train_edge_recon_loss: 2596879.2752; train_gene_expr_recon_loss: 1296513.8418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3909630.4432; train_optim_loss: 3909630.4432; val_kl_reg_loss: 15429.4637; val_edge_recon_loss: 2601433.5720; val_gene_expr_recon_loss: 1293966.0967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3910829.1363; val_optim_loss: 3910829.1363
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9964; val_auprc_score: 0.9960; val_best_acc_score: 0.9729; val_best_f1_score: 0.9731; train_kl_reg_loss: 15391.6991; train_edge_recon_loss: 2592978.1909; train_gene_expr_recon_loss: 1292911.3615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3901281.2503; train_optim_loss: 3901281.2503; val_kl_reg_loss: 14660.7492; val_edge_recon_loss: 2597908.5482; val_gene_expr_recon_loss: 1292877.5729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3905446.8732; val_optim_loss: 3905446.8732
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9967; val_auprc_score: 0.9964; val_best_acc_score: 0.9746; val_best_f1_score: 0.9747; train_kl_reg_loss: 14846.6344; train_edge_recon_loss: 2589622.3205; train_gene_expr_recon_loss: 1290611.2662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3895080.2189; train_optim_loss: 3895080.2189; val_kl_reg_loss: 14710.7983; val_edge_recon_loss: 2595596.8988; val_gene_expr_recon_loss: 1281197.4872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3891505.1845; val_optim_loss: 3891505.1845
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9970; val_auprc_score: 0.9965; val_best_acc_score: 0.9759; val_best_f1_score: 0.9761; train_kl_reg_loss: 14448.9861; train_edge_recon_loss: 2587200.1270; train_gene_expr_recon_loss: 1299463.4668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3901112.5802; train_optim_loss: 3901112.5802; val_kl_reg_loss: 13969.9326; val_edge_recon_loss: 2592799.2292; val_gene_expr_recon_loss: 1252498.2289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3859267.3940; val_optim_loss: 3859267.3940
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9971; val_auprc_score: 0.9968; val_best_acc_score: 0.9765; val_best_f1_score: 0.9766; train_kl_reg_loss: 14169.4789; train_edge_recon_loss: 2584310.4037; train_gene_expr_recon_loss: 1280277.4373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3878757.3216; train_optim_loss: 3878757.3216; val_kl_reg_loss: 13882.0515; val_edge_recon_loss: 2589069.1756; val_gene_expr_recon_loss: 1336937.8571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3939889.0839; val_optim_loss: 3939889.0839
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9975; val_auprc_score: 0.9971; val_best_acc_score: 0.9791; val_best_f1_score: 0.9791; train_kl_reg_loss: 13960.0313; train_edge_recon_loss: 2582957.7772; train_gene_expr_recon_loss: 1194031.6929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3790949.5029; train_optim_loss: 3790949.5029; val_kl_reg_loss: 14121.3088; val_edge_recon_loss: 2588655.1482; val_gene_expr_recon_loss: 1218868.8134; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3821645.2744; val_optim_loss: 3821645.2744
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9974; val_auprc_score: 0.9971; val_best_acc_score: 0.9782; val_best_f1_score: 0.9782; train_kl_reg_loss: 13795.5148; train_edge_recon_loss: 2581469.6204; train_gene_expr_recon_loss: 1114592.6076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3709857.7428; train_optim_loss: 3709857.7428; val_kl_reg_loss: 13765.2058; val_edge_recon_loss: 2587906.7994; val_gene_expr_recon_loss: 1099449.2449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3701121.2470; val_optim_loss: 3701121.2470
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9977; val_auprc_score: 0.9973; val_best_acc_score: 0.9801; val_best_f1_score: 0.9802; train_kl_reg_loss: 13658.6007; train_edge_recon_loss: 2579802.4769; train_gene_expr_recon_loss: 1087982.8353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3681443.9134; train_optim_loss: 3681443.9134; val_kl_reg_loss: 13299.3751; val_edge_recon_loss: 2586574.1958; val_gene_expr_recon_loss: 1087437.3802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3687310.9464; val_optim_loss: 3687310.9464
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9976; val_auprc_score: 0.9972; val_best_acc_score: 0.9799; val_best_f1_score: 0.9800; train_kl_reg_loss: 13572.9541; train_edge_recon_loss: 2578871.8451; train_gene_expr_recon_loss: 1085044.6802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3677489.4790; train_optim_loss: 3677489.4790; val_kl_reg_loss: 13599.3770; val_edge_recon_loss: 2583657.2804; val_gene_expr_recon_loss: 1086420.7509; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3683677.4095; val_optim_loss: 3683677.4095
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9978; val_auprc_score: 0.9975; val_best_acc_score: 0.9809; val_best_f1_score: 0.9810; train_kl_reg_loss: 13485.8253; train_edge_recon_loss: 2577357.3912; train_gene_expr_recon_loss: 1082306.2482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3673149.4653; train_optim_loss: 3673149.4653; val_kl_reg_loss: 13694.5081; val_edge_recon_loss: 2582377.8476; val_gene_expr_recon_loss: 1085430.9743; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3681503.3345; val_optim_loss: 3681503.3345
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9978; val_auprc_score: 0.9975; val_best_acc_score: 0.9809; val_best_f1_score: 0.9810; train_kl_reg_loss: 13405.2407; train_edge_recon_loss: 2576630.0279; train_gene_expr_recon_loss: 1081567.0474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3671602.3163; train_optim_loss: 3671602.3163; val_kl_reg_loss: 13305.7349; val_edge_recon_loss: 2582472.6548; val_gene_expr_recon_loss: 1082109.5906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3677887.9768; val_optim_loss: 3677887.9768
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9812; val_best_f1_score: 0.9813; train_kl_reg_loss: 13390.1373; train_edge_recon_loss: 2575230.3379; train_gene_expr_recon_loss: 1080740.3098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3669360.7821; train_optim_loss: 3669360.7821; val_kl_reg_loss: 13575.9857; val_edge_recon_loss: 2579787.6542; val_gene_expr_recon_loss: 1083334.6430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3676698.2857; val_optim_loss: 3676698.2857
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9980; val_auprc_score: 0.9977; val_best_acc_score: 0.9822; val_best_f1_score: 0.9823; train_kl_reg_loss: 13345.6265; train_edge_recon_loss: 2574824.8669; train_gene_expr_recon_loss: 1080074.3991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3668244.8921; train_optim_loss: 3668244.8921; val_kl_reg_loss: 13181.5917; val_edge_recon_loss: 2580006.5083; val_gene_expr_recon_loss: 1084477.3760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3677665.4708; val_optim_loss: 3677665.4708
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9818; val_best_f1_score: 0.9818; train_kl_reg_loss: 13295.5658; train_edge_recon_loss: 2573967.8490; train_gene_expr_recon_loss: 1080182.4855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3667445.8962; train_optim_loss: 3667445.8962; val_kl_reg_loss: 13014.8860; val_edge_recon_loss: 2581117.3786; val_gene_expr_recon_loss: 1083619.9418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3677752.2137; val_optim_loss: 3677752.2137
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9828; val_best_f1_score: 0.9829; train_kl_reg_loss: 13232.3089; train_edge_recon_loss: 2572813.0447; train_gene_expr_recon_loss: 1079425.4995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3665470.8510; train_optim_loss: 3665470.8510; val_kl_reg_loss: 13281.1821; val_edge_recon_loss: 2580544.7839; val_gene_expr_recon_loss: 1083545.5606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3677371.5333; val_optim_loss: 3677371.5333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9981; val_auprc_score: 0.9978; val_best_acc_score: 0.9832; val_best_f1_score: 0.9832; train_kl_reg_loss: 13218.3960; train_edge_recon_loss: 2572662.1166; train_gene_expr_recon_loss: 1078863.0646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3664743.5754; train_optim_loss: 3664743.5754; val_kl_reg_loss: 13102.6666; val_edge_recon_loss: 2579305.7958; val_gene_expr_recon_loss: 1082616.0848; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3675024.5417; val_optim_loss: 3675024.5417
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9980; val_auprc_score: 0.9977; val_best_acc_score: 0.9830; val_best_f1_score: 0.9831; train_kl_reg_loss: 13168.5079; train_edge_recon_loss: 2572185.1716; train_gene_expr_recon_loss: 1078685.3201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3664039.0018; train_optim_loss: 3664039.0018; val_kl_reg_loss: 12874.1723; val_edge_recon_loss: 2579332.3298; val_gene_expr_recon_loss: 1082127.9981; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3674334.4994; val_optim_loss: 3674334.4994
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9981; val_auprc_score: 0.9978; val_best_acc_score: 0.9834; val_best_f1_score: 0.9834; train_kl_reg_loss: 13147.9203; train_edge_recon_loss: 2571799.9661; train_gene_expr_recon_loss: 1077952.2808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3662900.1680; train_optim_loss: 3662900.1680; val_kl_reg_loss: 12962.0965; val_edge_recon_loss: 2578514.0673; val_gene_expr_recon_loss: 1078780.9801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3670257.1381; val_optim_loss: 3670257.1381
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9982; val_auprc_score: 0.9978; val_best_acc_score: 0.9834; val_best_f1_score: 0.9834; train_kl_reg_loss: 13121.9931; train_edge_recon_loss: 2571590.3845; train_gene_expr_recon_loss: 1077531.8163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3662244.1928; train_optim_loss: 3662244.1928; val_kl_reg_loss: 13130.2512; val_edge_recon_loss: 2576700.3673; val_gene_expr_recon_loss: 1080416.2714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3670246.8929; val_optim_loss: 3670246.8929
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9982; val_auprc_score: 0.9979; val_best_acc_score: 0.9835; val_best_f1_score: 0.9836; train_kl_reg_loss: 13107.8183; train_edge_recon_loss: 2571262.7978; train_gene_expr_recon_loss: 1076945.5213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3661316.1342; train_optim_loss: 3661316.1342; val_kl_reg_loss: 13126.5975; val_edge_recon_loss: 2576300.0625; val_gene_expr_recon_loss: 1080938.7467; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3670365.4030; val_optim_loss: 3670365.4030
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9982; val_auprc_score: 0.9978; val_best_acc_score: 0.9839; val_best_f1_score: 0.9839; train_kl_reg_loss: 13069.9388; train_edge_recon_loss: 2570696.3265; train_gene_expr_recon_loss: 1077093.3261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3660859.5904; train_optim_loss: 3660859.5904; val_kl_reg_loss: 13044.0664; val_edge_recon_loss: 2577209.3333; val_gene_expr_recon_loss: 1082627.8240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3672881.2262; val_optim_loss: 3672881.2262
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9982; val_auprc_score: 0.9978; val_best_acc_score: 0.9833; val_best_f1_score: 0.9834; train_kl_reg_loss: 13058.3731; train_edge_recon_loss: 2570210.7125; train_gene_expr_recon_loss: 1076474.3173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3659743.4049; train_optim_loss: 3659743.4049; val_kl_reg_loss: 13065.1377; val_edge_recon_loss: 2576685.7274; val_gene_expr_recon_loss: 1081631.5382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3671382.4012; val_optim_loss: 3671382.4012
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9983; val_auprc_score: 0.9978; val_best_acc_score: 0.9838; val_best_f1_score: 0.9839; train_kl_reg_loss: 13022.0927; train_edge_recon_loss: 2569996.2098; train_gene_expr_recon_loss: 1076134.5135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3659152.8161; train_optim_loss: 3659152.8161; val_kl_reg_loss: 12976.4665; val_edge_recon_loss: 2575225.3375; val_gene_expr_recon_loss: 1080897.4064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3669099.2149; val_optim_loss: 3669099.2149
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9982; val_auprc_score: 0.9978; val_best_acc_score: 0.9838; val_best_f1_score: 0.9839; train_kl_reg_loss: 13018.6327; train_edge_recon_loss: 2569327.1574; train_gene_expr_recon_loss: 1074597.0915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3656942.8811; train_optim_loss: 3656942.8811; val_kl_reg_loss: 12918.6587; val_edge_recon_loss: 2577331.1839; val_gene_expr_recon_loss: 1075538.5574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3665788.4012; val_optim_loss: 3665788.4012
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9838; val_best_f1_score: 0.9839; train_kl_reg_loss: 13006.2241; train_edge_recon_loss: 2569173.6499; train_gene_expr_recon_loss: 1074017.1874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3656197.0563; train_optim_loss: 3656197.0563; val_kl_reg_loss: 13047.3056; val_edge_recon_loss: 2573226.0190; val_gene_expr_recon_loss: 1084436.9568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3670710.2798; val_optim_loss: 3670710.2798
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9982; val_auprc_score: 0.9978; val_best_acc_score: 0.9838; val_best_f1_score: 0.9839; train_kl_reg_loss: 12953.5312; train_edge_recon_loss: 2568989.1632; train_gene_expr_recon_loss: 1073673.4945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3655616.1879; train_optim_loss: 3655616.1879; val_kl_reg_loss: 13092.6915; val_edge_recon_loss: 2575623.3661; val_gene_expr_recon_loss: 1079916.5217; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3668632.5827; val_optim_loss: 3668632.5827
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9838; val_best_f1_score: 0.9839; train_kl_reg_loss: 12950.9508; train_edge_recon_loss: 2568712.9762; train_gene_expr_recon_loss: 1073146.7468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3654810.6735; train_optim_loss: 3654810.6735; val_kl_reg_loss: 12995.0343; val_edge_recon_loss: 2574663.8661; val_gene_expr_recon_loss: 1033548.3382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3621207.2417; val_optim_loss: 3621207.2417
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9982; val_auprc_score: 0.9978; val_best_acc_score: 0.9836; val_best_f1_score: 0.9837; train_kl_reg_loss: 12938.9068; train_edge_recon_loss: 2568258.0068; train_gene_expr_recon_loss: 1073624.2007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3654821.1162; train_optim_loss: 3654821.1162; val_kl_reg_loss: 12998.9632; val_edge_recon_loss: 2574555.4560; val_gene_expr_recon_loss: 1129653.7449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3717208.1560; val_optim_loss: 3717208.1560
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9983; val_auprc_score: 0.9978; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 12908.0228; train_edge_recon_loss: 2568805.2546; train_gene_expr_recon_loss: 1069531.5868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3651244.8642; train_optim_loss: 3651244.8642; val_kl_reg_loss: 12826.6118; val_edge_recon_loss: 2574059.1143; val_gene_expr_recon_loss: 1076871.4210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3663757.1542; val_optim_loss: 3663757.1542
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9981; val_auprc_score: 0.9976; val_best_acc_score: 0.9835; val_best_f1_score: 0.9836; train_kl_reg_loss: 12885.7247; train_edge_recon_loss: 2567795.7446; train_gene_expr_recon_loss: 1069271.8820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3649953.3517; train_optim_loss: 3649953.3517; val_kl_reg_loss: 12935.0790; val_edge_recon_loss: 2572597.0339; val_gene_expr_recon_loss: 1074866.8644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3660398.9780; val_optim_loss: 3660398.9780
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9984; val_auprc_score: 0.9981; val_best_acc_score: 0.9848; val_best_f1_score: 0.9849; train_kl_reg_loss: 12898.0465; train_edge_recon_loss: 2567845.6857; train_gene_expr_recon_loss: 1069090.3920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3649834.1234; train_optim_loss: 3649834.1234; val_kl_reg_loss: 12660.5007; val_edge_recon_loss: 2571237.5738; val_gene_expr_recon_loss: 1074978.5134; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3658876.5887; val_optim_loss: 3658876.5887

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 13478.6789; train_edge_recon_loss: 2564879.8191; train_gene_expr_recon_loss: 1062036.6785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3640395.1770; train_optim_loss: 3640395.1770; val_kl_reg_loss: 13481.3743; val_edge_recon_loss: 2569468.5714; val_gene_expr_recon_loss: 1070122.1860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3653072.1238; val_optim_loss: 3653072.1238
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9984; val_auprc_score: 0.9981; val_best_acc_score: 0.9859; val_best_f1_score: 0.9859; train_kl_reg_loss: 13557.2890; train_edge_recon_loss: 2564579.6803; train_gene_expr_recon_loss: 1060953.1444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3639090.1113; train_optim_loss: 3639090.1113; val_kl_reg_loss: 13493.6118; val_edge_recon_loss: 2569877.9113; val_gene_expr_recon_loss: 1070159.1857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3653530.7155; val_optim_loss: 3653530.7155
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9855; val_best_f1_score: 0.9855; train_kl_reg_loss: 13548.4769; train_edge_recon_loss: 2564513.1027; train_gene_expr_recon_loss: 1060630.6884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3638692.2664; train_optim_loss: 3638692.2664; val_kl_reg_loss: 13462.3589; val_edge_recon_loss: 2570513.2595; val_gene_expr_recon_loss: 1069735.7949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3653711.4167; val_optim_loss: 3653711.4167
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9986; val_auprc_score: 0.9983; val_best_acc_score: 0.9860; val_best_f1_score: 0.9860; train_kl_reg_loss: 13524.7206; train_edge_recon_loss: 2564320.8480; train_gene_expr_recon_loss: 1060434.3156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3638279.8837; train_optim_loss: 3638279.8837; val_kl_reg_loss: 13460.5860; val_edge_recon_loss: 2570450.9940; val_gene_expr_recon_loss: 1069783.2839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3653694.8542; val_optim_loss: 3653694.8542

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1253 min 49 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9981
Val AUPRC score: 0.9977
Val best accuracy score: 0.9840
Val best F1 score: 0.9841
Val gene expr MSE score: 8.4634

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
