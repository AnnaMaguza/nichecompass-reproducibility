None
Run timestamp: 20072023_111649_1.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '30000.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9702; val_auprc_score: 0.9583; val_best_acc_score: 0.9257; val_best_f1_score: 0.9283; train_kl_reg_loss: 78346.9931; train_edge_recon_loss: 27049581.1958; train_gene_expr_recon_loss: 11589524.7115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38717452.9504; train_optim_loss: 38717452.9504; val_kl_reg_loss: 89554.2210; val_edge_recon_loss: 26488373.7907; val_gene_expr_recon_loss: 10478032.1744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37055959.8605; val_optim_loss: 37055959.8605
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9718; val_auprc_score: 0.9604; val_best_acc_score: 0.9313; val_best_f1_score: 0.9334; train_kl_reg_loss: 89669.7781; train_edge_recon_loss: 26085459.4987; train_gene_expr_recon_loss: 10357092.1632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36532221.4308; train_optim_loss: 36532221.4308; val_kl_reg_loss: 83005.4674; val_edge_recon_loss: 26353302.2326; val_gene_expr_recon_loss: 10077091.3140; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36513399.1163; val_optim_loss: 36513399.1163
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9761; val_auprc_score: 0.9659; val_best_acc_score: 0.9398; val_best_f1_score: 0.9418; train_kl_reg_loss: 85871.2345; train_edge_recon_loss: 25960986.6762; train_gene_expr_recon_loss: 10014606.4883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36061464.4439; train_optim_loss: 36061464.4439; val_kl_reg_loss: 80216.6314; val_edge_recon_loss: 26222189.5581; val_gene_expr_recon_loss: 9858276.5349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36160682.7442; val_optim_loss: 36160682.7442
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9775; val_auprc_score: 0.9665; val_best_acc_score: 0.9457; val_best_f1_score: 0.9474; train_kl_reg_loss: 78681.3467; train_edge_recon_loss: 25907160.9974; train_gene_expr_recon_loss: 9808228.4804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35794070.8721; train_optim_loss: 35794070.8721; val_kl_reg_loss: 73404.7791; val_edge_recon_loss: 26081235.7907; val_gene_expr_recon_loss: 9668858.6860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35823499.2093; val_optim_loss: 35823499.2093
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9790; val_auprc_score: 0.9704; val_best_acc_score: 0.9488; val_best_f1_score: 0.9504; train_kl_reg_loss: 73610.6924; train_edge_recon_loss: 25848244.5091; train_gene_expr_recon_loss: 9674137.7180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35595992.9347; train_optim_loss: 35595992.9347; val_kl_reg_loss: 65070.0193; val_edge_recon_loss: 26071070.3953; val_gene_expr_recon_loss: 9570849.2209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35706989.5814; val_optim_loss: 35706989.5814
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9785; val_auprc_score: 0.9678; val_best_acc_score: 0.9487; val_best_f1_score: 0.9502; train_kl_reg_loss: 70100.6750; train_edge_recon_loss: 25817001.5248; train_gene_expr_recon_loss: 9559919.7076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35447021.8956; train_optim_loss: 35447021.8956; val_kl_reg_loss: 65019.7509; val_edge_recon_loss: 26131462.8837; val_gene_expr_recon_loss: 9551098.6744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35747581.3488; val_optim_loss: 35747581.3488
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9805; val_auprc_score: 0.9720; val_best_acc_score: 0.9508; val_best_f1_score: 0.9522; train_kl_reg_loss: 68545.0401; train_edge_recon_loss: 25796812.5796; train_gene_expr_recon_loss: 9492816.6475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35358174.3238; train_optim_loss: 35358174.3238; val_kl_reg_loss: 70099.2781; val_edge_recon_loss: 25967403.1628; val_gene_expr_recon_loss: 9452367.4419; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35489869.7674; val_optim_loss: 35489869.7674
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9807; val_auprc_score: 0.9729; val_best_acc_score: 0.9530; val_best_f1_score: 0.9543; train_kl_reg_loss: 66101.1860; train_edge_recon_loss: 25777349.6527; train_gene_expr_recon_loss: 9435384.1723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35278834.9817; train_optim_loss: 35278834.9817; val_kl_reg_loss: 65225.7789; val_edge_recon_loss: 25966190.9767; val_gene_expr_recon_loss: 9398593.8023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35430010.3721; val_optim_loss: 35430010.3721
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9794; val_auprc_score: 0.9691; val_best_acc_score: 0.9525; val_best_f1_score: 0.9537; train_kl_reg_loss: 64818.2480; train_edge_recon_loss: 25756229.8381; train_gene_expr_recon_loss: 9348981.8838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35170029.8956; train_optim_loss: 35170029.8956; val_kl_reg_loss: 62167.2518; val_edge_recon_loss: 25928879.0233; val_gene_expr_recon_loss: 9366991.9360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35358038.3721; val_optim_loss: 35358038.3721
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9814; val_auprc_score: 0.9736; val_best_acc_score: 0.9539; val_best_f1_score: 0.9553; train_kl_reg_loss: 62032.0909; train_edge_recon_loss: 25744101.3446; train_gene_expr_recon_loss: 9331445.7702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35137579.2010; train_optim_loss: 35137579.2010; val_kl_reg_loss: 58649.6086; val_edge_recon_loss: 25950098.7442; val_gene_expr_recon_loss: 9359233.3140; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35367981.5814; val_optim_loss: 35367981.5814
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9822; val_auprc_score: 0.9751; val_best_acc_score: 0.9549; val_best_f1_score: 0.9560; train_kl_reg_loss: 62836.0847; train_edge_recon_loss: 25710079.6841; train_gene_expr_recon_loss: 9249038.6358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35021954.3708; train_optim_loss: 35021954.3708; val_kl_reg_loss: 60376.0454; val_edge_recon_loss: 25887382.6512; val_gene_expr_recon_loss: 9294769.0814; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35242528.0465; val_optim_loss: 35242528.0465
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9813; val_auprc_score: 0.9731; val_best_acc_score: 0.9542; val_best_f1_score: 0.9557; train_kl_reg_loss: 63323.8652; train_edge_recon_loss: 25704667.0888; train_gene_expr_recon_loss: 9183068.1991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34951059.1123; train_optim_loss: 34951059.1123; val_kl_reg_loss: 62172.9254; val_edge_recon_loss: 25926017.5581; val_gene_expr_recon_loss: 9309595.8488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35297786.6047; val_optim_loss: 35297786.6047
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9803; val_auprc_score: 0.9723; val_best_acc_score: 0.9539; val_best_f1_score: 0.9553; train_kl_reg_loss: 62358.7084; train_edge_recon_loss: 25706691.4360; train_gene_expr_recon_loss: 9165166.9282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34934217.0548; train_optim_loss: 34934217.0548; val_kl_reg_loss: 61479.5582; val_edge_recon_loss: 25921585.2326; val_gene_expr_recon_loss: 9266806.9651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35249871.8605; val_optim_loss: 35249871.8605
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9814; val_auprc_score: 0.9731; val_best_acc_score: 0.9546; val_best_f1_score: 0.9560; train_kl_reg_loss: 61980.8416; train_edge_recon_loss: 25702282.6136; train_gene_expr_recon_loss: 9103586.5163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34867849.9478; train_optim_loss: 34867849.9478; val_kl_reg_loss: 59383.5811; val_edge_recon_loss: 25912409.1628; val_gene_expr_recon_loss: 9208246.2907; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35180039.0698; val_optim_loss: 35180039.0698
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9800; val_auprc_score: 0.9705; val_best_acc_score: 0.9542; val_best_f1_score: 0.9557; train_kl_reg_loss: 61900.5828; train_edge_recon_loss: 25725439.0470; train_gene_expr_recon_loss: 9086783.0033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34874122.6423; train_optim_loss: 34874122.6423; val_kl_reg_loss: 65887.1623; val_edge_recon_loss: 26103720.6047; val_gene_expr_recon_loss: 9343316.6163; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35512924.3721; val_optim_loss: 35512924.3721
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9818; val_auprc_score: 0.9744; val_best_acc_score: 0.9550; val_best_f1_score: 0.9563; train_kl_reg_loss: 63520.9871; train_edge_recon_loss: 25715364.3499; train_gene_expr_recon_loss: 9048593.5490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34827478.8407; train_optim_loss: 34827478.8407; val_kl_reg_loss: 60137.6498; val_edge_recon_loss: 25939355.1163; val_gene_expr_recon_loss: 9173060.6628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35172553.4884; val_optim_loss: 35172553.4884
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9805; val_auprc_score: 0.9717; val_best_acc_score: 0.9552; val_best_f1_score: 0.9565; train_kl_reg_loss: 61972.6194; train_edge_recon_loss: 25676055.4543; train_gene_expr_recon_loss: 8989944.6064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34727972.6292; train_optim_loss: 34727972.6292; val_kl_reg_loss: 60950.6638; val_edge_recon_loss: 25951223.6047; val_gene_expr_recon_loss: 9189123.8953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35201298.0000; val_optim_loss: 35201298.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9823; val_auprc_score: 0.9752; val_best_acc_score: 0.9574; val_best_f1_score: 0.9587; train_kl_reg_loss: 62181.4675; train_edge_recon_loss: 25662365.0104; train_gene_expr_recon_loss: 8961103.2030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34685649.6893; train_optim_loss: 34685649.6893; val_kl_reg_loss: 61118.8505; val_edge_recon_loss: 25867226.9767; val_gene_expr_recon_loss: 9180146.4477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35108492.4651; val_optim_loss: 35108492.4651
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9835; val_auprc_score: 0.9773; val_best_acc_score: 0.9592; val_best_f1_score: 0.9603; train_kl_reg_loss: 62283.8219; train_edge_recon_loss: 25665005.7023; train_gene_expr_recon_loss: 8938764.9458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34666054.4909; train_optim_loss: 34666054.4909; val_kl_reg_loss: 57517.6540; val_edge_recon_loss: 25929400.7442; val_gene_expr_recon_loss: 9234308.9767; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35221227.3953; val_optim_loss: 35221227.3953
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9838; val_auprc_score: 0.9774; val_best_acc_score: 0.9585; val_best_f1_score: 0.9595; train_kl_reg_loss: 61211.1335; train_edge_recon_loss: 25655762.1880; train_gene_expr_recon_loss: 8923123.3114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34640096.6684; train_optim_loss: 34640096.6684; val_kl_reg_loss: 59929.7303; val_edge_recon_loss: 25816877.7907; val_gene_expr_recon_loss: 9158394.1744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35035201.8605; val_optim_loss: 35035201.8605
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9819; val_auprc_score: 0.9747; val_best_acc_score: 0.9558; val_best_f1_score: 0.9570; train_kl_reg_loss: 61529.4629; train_edge_recon_loss: 25640170.8982; train_gene_expr_recon_loss: 8895526.0457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34597226.4021; train_optim_loss: 34597226.4021; val_kl_reg_loss: 59616.8313; val_edge_recon_loss: 25900567.5116; val_gene_expr_recon_loss: 9212761.4651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35172945.8605; val_optim_loss: 35172945.8605
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9822; val_auprc_score: 0.9751; val_best_acc_score: 0.9569; val_best_f1_score: 0.9581; train_kl_reg_loss: 61790.2808; train_edge_recon_loss: 25662166.7311; train_gene_expr_recon_loss: 8889277.5444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34613234.5509; train_optim_loss: 34613234.5509; val_kl_reg_loss: 59047.9786; val_edge_recon_loss: 25916534.2558; val_gene_expr_recon_loss: 9147882.6919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35123465.1628; val_optim_loss: 35123465.1628
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9818; val_auprc_score: 0.9734; val_best_acc_score: 0.9573; val_best_f1_score: 0.9585; train_kl_reg_loss: 61490.9170; train_edge_recon_loss: 25653471.2454; train_gene_expr_recon_loss: 8855277.6580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34570239.8642; train_optim_loss: 34570239.8642; val_kl_reg_loss: 62736.5204; val_edge_recon_loss: 25895397.3256; val_gene_expr_recon_loss: 9353645.5407; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35311779.3488; val_optim_loss: 35311779.3488
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9839; val_auprc_score: 0.9772; val_best_acc_score: 0.9596; val_best_f1_score: 0.9607; train_kl_reg_loss: 62627.7305; train_edge_recon_loss: 25661627.6501; train_gene_expr_recon_loss: 8862911.1710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34587166.5144; train_optim_loss: 34587166.5144; val_kl_reg_loss: 60840.6189; val_edge_recon_loss: 25842476.3488; val_gene_expr_recon_loss: 9132905.4012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35036222.1395; val_optim_loss: 35036222.1395

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9831; val_auprc_score: 0.9760; val_best_acc_score: 0.9584; val_best_f1_score: 0.9596; train_kl_reg_loss: 64378.3583; train_edge_recon_loss: 25620168.6580; train_gene_expr_recon_loss: 8729877.0268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34414424.0757; train_optim_loss: 34414424.0757; val_kl_reg_loss: 63876.2685; val_edge_recon_loss: 25831731.3953; val_gene_expr_recon_loss: 9071236.0814; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34966843.5814; val_optim_loss: 34966843.5814
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9831; val_auprc_score: 0.9760; val_best_acc_score: 0.9587; val_best_f1_score: 0.9599; train_kl_reg_loss: 65898.2218; train_edge_recon_loss: 25631248.2245; train_gene_expr_recon_loss: 8697014.9086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34394161.3577; train_optim_loss: 34394161.3577; val_kl_reg_loss: 64602.1985; val_edge_recon_loss: 25855657.1860; val_gene_expr_recon_loss: 9051535.6628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34971795.2093; val_optim_loss: 34971795.2093
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9832; val_auprc_score: 0.9758; val_best_acc_score: 0.9585; val_best_f1_score: 0.9598; train_kl_reg_loss: 67000.6934; train_edge_recon_loss: 25606502.8564; train_gene_expr_recon_loss: 8694736.6789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34368240.2428; train_optim_loss: 34368240.2428; val_kl_reg_loss: 65848.2071; val_edge_recon_loss: 25858988.5349; val_gene_expr_recon_loss: 9092875.7384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35017712.5116; val_optim_loss: 35017712.5116
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9833; val_auprc_score: 0.9764; val_best_acc_score: 0.9583; val_best_f1_score: 0.9594; train_kl_reg_loss: 67232.6132; train_edge_recon_loss: 25613362.9530; train_gene_expr_recon_loss: 8683306.5816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34363902.0705; train_optim_loss: 34363902.0705; val_kl_reg_loss: 65609.2210; val_edge_recon_loss: 25847108.2326; val_gene_expr_recon_loss: 9035939.0756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34948656.3721; val_optim_loss: 34948656.3721
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9833; val_auprc_score: 0.9763; val_best_acc_score: 0.9589; val_best_f1_score: 0.9600; train_kl_reg_loss: 67031.4823; train_edge_recon_loss: 25619107.2898; train_gene_expr_recon_loss: 8678701.6789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34364840.4700; train_optim_loss: 34364840.4700; val_kl_reg_loss: 65672.4541; val_edge_recon_loss: 25857023.7442; val_gene_expr_recon_loss: 9066448.5988; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34989144.7907; val_optim_loss: 34989144.7907
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9838; val_auprc_score: 0.9772; val_best_acc_score: 0.9583; val_best_f1_score: 0.9595; train_kl_reg_loss: 67485.6428; train_edge_recon_loss: 25627519.5431; train_gene_expr_recon_loss: 8676434.4047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34371439.5901; train_optim_loss: 34371439.5901; val_kl_reg_loss: 66246.2876; val_edge_recon_loss: 25815593.2093; val_gene_expr_recon_loss: 9033125.9826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34914965.5349; val_optim_loss: 34914965.5349
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9836; val_auprc_score: 0.9769; val_best_acc_score: 0.9591; val_best_f1_score: 0.9603; train_kl_reg_loss: 67761.4491; train_edge_recon_loss: 25606363.6423; train_gene_expr_recon_loss: 8663738.3916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34337863.4961; train_optim_loss: 34337863.4961; val_kl_reg_loss: 66423.9746; val_edge_recon_loss: 25804520.2558; val_gene_expr_recon_loss: 9055289.2384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34926233.5349; val_optim_loss: 34926233.5349
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9832; val_auprc_score: 0.9766; val_best_acc_score: 0.9580; val_best_f1_score: 0.9593; train_kl_reg_loss: 68186.3064; train_edge_recon_loss: 25593769.7389; train_gene_expr_recon_loss: 8656456.9445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34318413.0235; train_optim_loss: 34318413.0235; val_kl_reg_loss: 67056.6479; val_edge_recon_loss: 25824211.1628; val_gene_expr_recon_loss: 9065462.9186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34956730.6512; val_optim_loss: 34956730.6512
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9838; val_auprc_score: 0.9776; val_best_acc_score: 0.9590; val_best_f1_score: 0.9599; train_kl_reg_loss: 68222.7653; train_edge_recon_loss: 25594788.6110; train_gene_expr_recon_loss: 8657217.1625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34320228.5300; train_optim_loss: 34320228.5300; val_kl_reg_loss: 66714.6921; val_edge_recon_loss: 25842504.0000; val_gene_expr_recon_loss: 9036638.8488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34945857.4884; val_optim_loss: 34945857.4884
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9837; val_auprc_score: 0.9774; val_best_acc_score: 0.9581; val_best_f1_score: 0.9592; train_kl_reg_loss: 67881.5294; train_edge_recon_loss: 25613503.7624; train_gene_expr_recon_loss: 8652866.6240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34334251.8381; train_optim_loss: 34334251.8381; val_kl_reg_loss: 66421.8356; val_edge_recon_loss: 25866792.7907; val_gene_expr_recon_loss: 9048280.7035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34981495.4884; val_optim_loss: 34981495.4884

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9834; val_auprc_score: 0.9767; val_best_acc_score: 0.9597; val_best_f1_score: 0.9608; train_kl_reg_loss: 67846.6582; train_edge_recon_loss: 25607659.6136; train_gene_expr_recon_loss: 8639677.3336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34315183.5666; train_optim_loss: 34315183.5666; val_kl_reg_loss: 66340.0281; val_edge_recon_loss: 25803684.3953; val_gene_expr_recon_loss: 9055735.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34925760.0930; val_optim_loss: 34925760.0930
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9832; val_auprc_score: 0.9770; val_best_acc_score: 0.9585; val_best_f1_score: 0.9597; train_kl_reg_loss: 67804.4673; train_edge_recon_loss: 25602828.4099; train_gene_expr_recon_loss: 8639707.3198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34310340.1645; train_optim_loss: 34310340.1645; val_kl_reg_loss: 66460.8365; val_edge_recon_loss: 25848534.2093; val_gene_expr_recon_loss: 9053468.4535; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34968463.1860; val_optim_loss: 34968463.1860
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9839; val_auprc_score: 0.9772; val_best_acc_score: 0.9592; val_best_f1_score: 0.9602; train_kl_reg_loss: 68001.7906; train_edge_recon_loss: 25607362.2167; train_gene_expr_recon_loss: 8624202.0490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34299566.0783; train_optim_loss: 34299566.0783; val_kl_reg_loss: 66443.2112; val_edge_recon_loss: 25882411.6279; val_gene_expr_recon_loss: 9040816.9360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34989671.8605; val_optim_loss: 34989671.8605
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9835; val_auprc_score: 0.9767; val_best_acc_score: 0.9593; val_best_f1_score: 0.9605; train_kl_reg_loss: 68018.4926; train_edge_recon_loss: 25608354.6867; train_gene_expr_recon_loss: 8628991.3584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34305364.5535; train_optim_loss: 34305364.5535; val_kl_reg_loss: 66330.1262; val_edge_recon_loss: 25787330.2093; val_gene_expr_recon_loss: 9045840.2326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34899500.4651; val_optim_loss: 34899500.4651
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9842; val_auprc_score: 0.9779; val_best_acc_score: 0.9594; val_best_f1_score: 0.9605; train_kl_reg_loss: 68216.9353; train_edge_recon_loss: 25603847.7546; train_gene_expr_recon_loss: 8637417.4700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34309482.2037; train_optim_loss: 34309482.2037; val_kl_reg_loss: 66809.3068; val_edge_recon_loss: 25807497.9535; val_gene_expr_recon_loss: 9057581.7151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34931889.0233; val_optim_loss: 34931889.0233
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9834; val_auprc_score: 0.9766; val_best_acc_score: 0.9589; val_best_f1_score: 0.9601; train_kl_reg_loss: 68247.5771; train_edge_recon_loss: 25608715.9086; train_gene_expr_recon_loss: 8634180.2108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34311143.6867; train_optim_loss: 34311143.6867; val_kl_reg_loss: 66620.4136; val_edge_recon_loss: 25805391.1628; val_gene_expr_recon_loss: 9040560.0581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34912571.2093; val_optim_loss: 34912571.2093
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9836; val_auprc_score: 0.9771; val_best_acc_score: 0.9586; val_best_f1_score: 0.9598; train_kl_reg_loss: 68218.0066; train_edge_recon_loss: 25603819.5013; train_gene_expr_recon_loss: 8627856.5242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34299894.0157; train_optim_loss: 34299894.0157; val_kl_reg_loss: 66658.2758; val_edge_recon_loss: 25824958.6744; val_gene_expr_recon_loss: 9068751.2674; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34960368.3256; val_optim_loss: 34960368.3256
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9830; val_auprc_score: 0.9755; val_best_acc_score: 0.9589; val_best_f1_score: 0.9600; train_kl_reg_loss: 68272.9310; train_edge_recon_loss: 25608305.0862; train_gene_expr_recon_loss: 8636482.8551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34313060.8851; train_optim_loss: 34313060.8851; val_kl_reg_loss: 66638.5071; val_edge_recon_loss: 25842276.6512; val_gene_expr_recon_loss: 9054357.0756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34963272.1628; val_optim_loss: 34963272.1628

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9839; val_auprc_score: 0.9775; val_best_acc_score: 0.9590; val_best_f1_score: 0.9602; train_kl_reg_loss: 68281.7024; train_edge_recon_loss: 25621718.2611; train_gene_expr_recon_loss: 8629230.4158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34319230.3394; train_optim_loss: 34319230.3394; val_kl_reg_loss: 66741.5182; val_edge_recon_loss: 25780747.2791; val_gene_expr_recon_loss: 9032801.9128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34880290.6047; val_optim_loss: 34880290.6047
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9845; val_auprc_score: 0.9786; val_best_acc_score: 0.9597; val_best_f1_score: 0.9607; train_kl_reg_loss: 68297.8871; train_edge_recon_loss: 25588666.2298; train_gene_expr_recon_loss: 8629434.2794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34286398.4439; train_optim_loss: 34286398.4439; val_kl_reg_loss: 66543.4809; val_edge_recon_loss: 25802878.8837; val_gene_expr_recon_loss: 9036423.4535; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34905845.8605; val_optim_loss: 34905845.8605
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9843; val_auprc_score: 0.9780; val_best_acc_score: 0.9600; val_best_f1_score: 0.9610; train_kl_reg_loss: 68312.9559; train_edge_recon_loss: 25607478.6527; train_gene_expr_recon_loss: 8636354.8727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34312146.4360; train_optim_loss: 34312146.4360; val_kl_reg_loss: 66741.0680; val_edge_recon_loss: 25808494.2791; val_gene_expr_recon_loss: 9047438.5407; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34922673.8605; val_optim_loss: 34922673.8605
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9829; val_auprc_score: 0.9761; val_best_acc_score: 0.9582; val_best_f1_score: 0.9594; train_kl_reg_loss: 68309.2831; train_edge_recon_loss: 25617005.1410; train_gene_expr_recon_loss: 8635740.9804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34321055.3969; train_optim_loss: 34321055.3969; val_kl_reg_loss: 66660.9720; val_edge_recon_loss: 25810929.7209; val_gene_expr_recon_loss: 9053572.8895; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34931163.9070; val_optim_loss: 34931163.9070
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9836; val_auprc_score: 0.9766; val_best_acc_score: 0.9590; val_best_f1_score: 0.9601; train_kl_reg_loss: 68306.4443; train_edge_recon_loss: 25609956.1958; train_gene_expr_recon_loss: 8630313.5979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34308576.2193; train_optim_loss: 34308576.2193; val_kl_reg_loss: 66639.7939; val_edge_recon_loss: 25811502.6512; val_gene_expr_recon_loss: 9072261.2965; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34950403.4419; val_optim_loss: 34950403.4419

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9835; val_auprc_score: 0.9770; val_best_acc_score: 0.9574; val_best_f1_score: 0.9586; train_kl_reg_loss: 68228.0085; train_edge_recon_loss: 25598102.7937; train_gene_expr_recon_loss: 8624576.6345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34290907.4282; train_optim_loss: 34290907.4282; val_kl_reg_loss: 66582.0975; val_edge_recon_loss: 25877917.6744; val_gene_expr_recon_loss: 9033198.9826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34977698.6047; val_optim_loss: 34977698.6047
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9839; val_auprc_score: 0.9776; val_best_acc_score: 0.9603; val_best_f1_score: 0.9614; train_kl_reg_loss: 68251.1574; train_edge_recon_loss: 25593034.4256; train_gene_expr_recon_loss: 8632863.5894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34294149.2115; train_optim_loss: 34294149.2115; val_kl_reg_loss: 66700.3251; val_edge_recon_loss: 25801107.4651; val_gene_expr_recon_loss: 9038218.8663; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34906026.6977; val_optim_loss: 34906026.6977
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9834; val_auprc_score: 0.9772; val_best_acc_score: 0.9590; val_best_f1_score: 0.9601; train_kl_reg_loss: 68204.3442; train_edge_recon_loss: 25615887.8773; train_gene_expr_recon_loss: 8624782.9824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34308875.1958; train_optim_loss: 34308875.1958; val_kl_reg_loss: 66757.4129; val_edge_recon_loss: 25808004.2093; val_gene_expr_recon_loss: 9059384.8547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34934146.5581; val_optim_loss: 34934146.5581
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9829; val_auprc_score: 0.9757; val_best_acc_score: 0.9594; val_best_f1_score: 0.9605; train_kl_reg_loss: 68213.2585; train_edge_recon_loss: 25597344.7128; train_gene_expr_recon_loss: 8620280.8362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34285838.7807; train_optim_loss: 34285838.7807; val_kl_reg_loss: 66592.0394; val_edge_recon_loss: 25817069.0930; val_gene_expr_recon_loss: 9073808.5988; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34957469.8605; val_optim_loss: 34957469.8605

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 80 min 42 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
Val AUROC score: 0.9836
Val AUPRC score: 0.9763
Val best accuracy score: 0.9592
Val best F1 score: 0.9603
Val gene expr MSE score: 0.6696

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
