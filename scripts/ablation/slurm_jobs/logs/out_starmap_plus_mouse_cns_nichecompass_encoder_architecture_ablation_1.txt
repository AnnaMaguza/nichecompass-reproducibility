None
Run timestamp: 26072023_044634_1.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '30.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9746; val_auprc_score: 0.9624; val_best_acc_score: 0.9399; val_best_f1_score: 0.9417; train_kl_reg_loss: 6080.7932; train_edge_recon_loss: 266318.0412; train_gene_expr_recon_loss: 13644.6983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 286043.5323; train_optim_loss: 286043.5323; val_kl_reg_loss: 5933.2588; val_edge_recon_loss: 260180.3063; val_gene_expr_recon_loss: 12486.9743; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278600.5392; val_optim_loss: 278600.5392
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9786; val_auprc_score: 0.9664; val_best_acc_score: 0.9508; val_best_f1_score: 0.9522; train_kl_reg_loss: 5971.4173; train_edge_recon_loss: 258883.4729; train_gene_expr_recon_loss: 12129.1724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276984.0630; train_optim_loss: 276984.0630; val_kl_reg_loss: 5909.1360; val_edge_recon_loss: 258877.2629; val_gene_expr_recon_loss: 11864.6628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276651.0607; val_optim_loss: 276651.0607
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9798; val_auprc_score: 0.9682; val_best_acc_score: 0.9526; val_best_f1_score: 0.9540; train_kl_reg_loss: 5911.2096; train_edge_recon_loss: 258190.8136; train_gene_expr_recon_loss: 11663.4865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 275765.5090; train_optim_loss: 275765.5090; val_kl_reg_loss: 5841.1924; val_edge_recon_loss: 258932.9677; val_gene_expr_recon_loss: 11461.0783; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276235.2376; val_optim_loss: 276235.2376
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9826; val_auprc_score: 0.9722; val_best_acc_score: 0.9569; val_best_f1_score: 0.9581; train_kl_reg_loss: 5895.0868; train_edge_recon_loss: 257740.1534; train_gene_expr_recon_loss: 11405.5796; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 275040.8198; train_optim_loss: 275040.8198; val_kl_reg_loss: 5786.9825; val_edge_recon_loss: 257821.6275; val_gene_expr_recon_loss: 11261.5305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274870.1395; val_optim_loss: 274870.1395
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9821; val_auprc_score: 0.9721; val_best_acc_score: 0.9587; val_best_f1_score: 0.9598; train_kl_reg_loss: 5883.7207; train_edge_recon_loss: 257523.8625; train_gene_expr_recon_loss: 11218.9971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274626.5800; train_optim_loss: 274626.5800; val_kl_reg_loss: 5702.8679; val_edge_recon_loss: 258009.3692; val_gene_expr_recon_loss: 11153.3400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274865.5781; val_optim_loss: 274865.5781
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9821; val_auprc_score: 0.9721; val_best_acc_score: 0.9581; val_best_f1_score: 0.9591; train_kl_reg_loss: 5874.8736; train_edge_recon_loss: 257481.0424; train_gene_expr_recon_loss: 11098.3216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274454.2376; train_optim_loss: 274454.2376; val_kl_reg_loss: 5692.0213; val_edge_recon_loss: 258064.4188; val_gene_expr_recon_loss: 11026.8271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274783.2693; val_optim_loss: 274783.2693
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9843; val_auprc_score: 0.9757; val_best_acc_score: 0.9605; val_best_f1_score: 0.9614; train_kl_reg_loss: 5872.7638; train_edge_recon_loss: 257196.9174; train_gene_expr_recon_loss: 10977.4992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274047.1807; train_optim_loss: 274047.1807; val_kl_reg_loss: 5618.2144; val_edge_recon_loss: 257611.9520; val_gene_expr_recon_loss: 10942.8843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274173.0511; val_optim_loss: 274173.0511
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9847; val_auprc_score: 0.9768; val_best_acc_score: 0.9609; val_best_f1_score: 0.9618; train_kl_reg_loss: 5861.1263; train_edge_recon_loss: 257052.7287; train_gene_expr_recon_loss: 10894.1589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273808.0148; train_optim_loss: 273808.0148; val_kl_reg_loss: 5789.1697; val_edge_recon_loss: 258146.5441; val_gene_expr_recon_loss: 10875.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274811.1221; val_optim_loss: 274811.1221
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9849; val_auprc_score: 0.9768; val_best_acc_score: 0.9626; val_best_f1_score: 0.9634; train_kl_reg_loss: 5855.8625; train_edge_recon_loss: 256942.2682; train_gene_expr_recon_loss: 10816.5879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273614.7185; train_optim_loss: 273614.7185; val_kl_reg_loss: 5925.0443; val_edge_recon_loss: 258002.3129; val_gene_expr_recon_loss: 10754.8839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274682.2387; val_optim_loss: 274682.2387
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9840; val_auprc_score: 0.9747; val_best_acc_score: 0.9617; val_best_f1_score: 0.9627; train_kl_reg_loss: 5852.9484; train_edge_recon_loss: 256925.7031; train_gene_expr_recon_loss: 10758.9540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273537.6048; train_optim_loss: 273537.6048; val_kl_reg_loss: 5751.9036; val_edge_recon_loss: 257718.1403; val_gene_expr_recon_loss: 10741.2858; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274211.3314; val_optim_loss: 274211.3314
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9844; val_auprc_score: 0.9751; val_best_acc_score: 0.9641; val_best_f1_score: 0.9649; train_kl_reg_loss: 5846.0241; train_edge_recon_loss: 256830.8541; train_gene_expr_recon_loss: 10706.0620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273382.9404; train_optim_loss: 273382.9404; val_kl_reg_loss: 5879.1079; val_edge_recon_loss: 257803.5154; val_gene_expr_recon_loss: 10660.0425; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274342.6657; val_optim_loss: 274342.6657

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9858; val_auprc_score: 0.9774; val_best_acc_score: 0.9644; val_best_f1_score: 0.9652; train_kl_reg_loss: 5839.2286; train_edge_recon_loss: 256483.3269; train_gene_expr_recon_loss: 10652.4678; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272975.0234; train_optim_loss: 272975.0234; val_kl_reg_loss: 5748.1987; val_edge_recon_loss: 257364.1546; val_gene_expr_recon_loss: 10649.2884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273761.6410; val_optim_loss: 273761.6410
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9868; val_auprc_score: 0.9791; val_best_acc_score: 0.9657; val_best_f1_score: 0.9665; train_kl_reg_loss: 5824.3599; train_edge_recon_loss: 256500.3656; train_gene_expr_recon_loss: 10633.1593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272957.8845; train_optim_loss: 272957.8845; val_kl_reg_loss: 5726.6548; val_edge_recon_loss: 256950.1335; val_gene_expr_recon_loss: 10613.7997; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273290.5865; val_optim_loss: 273290.5865
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9859; val_auprc_score: 0.9774; val_best_acc_score: 0.9654; val_best_f1_score: 0.9662; train_kl_reg_loss: 5814.3952; train_edge_recon_loss: 256348.3329; train_gene_expr_recon_loss: 10624.5889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272787.3167; train_optim_loss: 272787.3167; val_kl_reg_loss: 5744.4655; val_edge_recon_loss: 257083.6475; val_gene_expr_recon_loss: 10586.4367; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273414.5501; val_optim_loss: 273414.5501
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9864; val_auprc_score: 0.9791; val_best_acc_score: 0.9660; val_best_f1_score: 0.9668; train_kl_reg_loss: 5805.6170; train_edge_recon_loss: 256532.6792; train_gene_expr_recon_loss: 10606.9615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272945.2579; train_optim_loss: 272945.2579; val_kl_reg_loss: 5781.9192; val_edge_recon_loss: 257307.8276; val_gene_expr_recon_loss: 10599.9345; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273689.6799; val_optim_loss: 273689.6799
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9866; val_auprc_score: 0.9788; val_best_acc_score: 0.9656; val_best_f1_score: 0.9664; train_kl_reg_loss: 5809.2375; train_edge_recon_loss: 256436.8799; train_gene_expr_recon_loss: 10611.5102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272857.6268; train_optim_loss: 272857.6268; val_kl_reg_loss: 5699.5789; val_edge_recon_loss: 256908.8846; val_gene_expr_recon_loss: 10610.2579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273218.7227; val_optim_loss: 273218.7227
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9870; val_auprc_score: 0.9795; val_best_acc_score: 0.9681; val_best_f1_score: 0.9687; train_kl_reg_loss: 5806.6109; train_edge_recon_loss: 256456.6900; train_gene_expr_recon_loss: 10588.4220; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272851.7227; train_optim_loss: 272851.7227; val_kl_reg_loss: 5747.5767; val_edge_recon_loss: 256673.6323; val_gene_expr_recon_loss: 10586.6065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273007.8140; val_optim_loss: 273007.8140
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9880; val_auprc_score: 0.9809; val_best_acc_score: 0.9681; val_best_f1_score: 0.9687; train_kl_reg_loss: 5805.2238; train_edge_recon_loss: 256432.9221; train_gene_expr_recon_loss: 10583.2994; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272821.4446; train_optim_loss: 272821.4446; val_kl_reg_loss: 5711.8340; val_edge_recon_loss: 256714.8029; val_gene_expr_recon_loss: 10590.7330; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273017.3710; val_optim_loss: 273017.3710
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9871; val_auprc_score: 0.9802; val_best_acc_score: 0.9663; val_best_f1_score: 0.9670; train_kl_reg_loss: 5803.9355; train_edge_recon_loss: 256349.8614; train_gene_expr_recon_loss: 10583.8647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272737.6621; train_optim_loss: 272737.6621; val_kl_reg_loss: 5740.2192; val_edge_recon_loss: 256810.7956; val_gene_expr_recon_loss: 10550.4279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273101.4420; val_optim_loss: 273101.4420
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9862; val_auprc_score: 0.9787; val_best_acc_score: 0.9653; val_best_f1_score: 0.9661; train_kl_reg_loss: 5792.4608; train_edge_recon_loss: 256431.1636; train_gene_expr_recon_loss: 10574.6745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272798.2994; train_optim_loss: 272798.2994; val_kl_reg_loss: 5710.1406; val_edge_recon_loss: 257473.5894; val_gene_expr_recon_loss: 10570.9384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273754.6679; val_optim_loss: 273754.6679
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9873; val_auprc_score: 0.9804; val_best_acc_score: 0.9671; val_best_f1_score: 0.9678; train_kl_reg_loss: 5793.3706; train_edge_recon_loss: 256290.0855; train_gene_expr_recon_loss: 10569.1833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272652.6399; train_optim_loss: 272652.6399; val_kl_reg_loss: 5701.6830; val_edge_recon_loss: 256909.8176; val_gene_expr_recon_loss: 10543.7459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273155.2467; val_optim_loss: 273155.2467

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9876; val_auprc_score: 0.9808; val_best_acc_score: 0.9669; val_best_f1_score: 0.9676; train_kl_reg_loss: 5795.1200; train_edge_recon_loss: 256249.4049; train_gene_expr_recon_loss: 10562.2859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272606.8107; train_optim_loss: 272606.8107; val_kl_reg_loss: 5719.4416; val_edge_recon_loss: 256968.7186; val_gene_expr_recon_loss: 10584.5729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273272.7327; val_optim_loss: 273272.7327
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9878; val_auprc_score: 0.9805; val_best_acc_score: 0.9678; val_best_f1_score: 0.9685; train_kl_reg_loss: 5798.1847; train_edge_recon_loss: 256360.1090; train_gene_expr_recon_loss: 10559.8569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272718.1508; train_optim_loss: 272718.1508; val_kl_reg_loss: 5724.1311; val_edge_recon_loss: 256369.2238; val_gene_expr_recon_loss: 10542.0079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272635.3641; val_optim_loss: 272635.3641
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9870; val_auprc_score: 0.9792; val_best_acc_score: 0.9664; val_best_f1_score: 0.9672; train_kl_reg_loss: 5790.6171; train_edge_recon_loss: 256372.9471; train_gene_expr_recon_loss: 10558.7034; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272722.2675; train_optim_loss: 272722.2675; val_kl_reg_loss: 5714.1616; val_edge_recon_loss: 256813.9066; val_gene_expr_recon_loss: 10557.5354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273085.6052; val_optim_loss: 273085.6052
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9874; val_auprc_score: 0.9806; val_best_acc_score: 0.9671; val_best_f1_score: 0.9678; train_kl_reg_loss: 5791.0816; train_edge_recon_loss: 256422.3712; train_gene_expr_recon_loss: 10563.7517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272777.2048; train_optim_loss: 272777.2048; val_kl_reg_loss: 5719.2367; val_edge_recon_loss: 256977.5489; val_gene_expr_recon_loss: 10544.7744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273241.5603; val_optim_loss: 273241.5603
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9871; val_auprc_score: 0.9799; val_best_acc_score: 0.9677; val_best_f1_score: 0.9683; train_kl_reg_loss: 5793.9992; train_edge_recon_loss: 256287.1608; train_gene_expr_recon_loss: 10563.2541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272644.4139; train_optim_loss: 272644.4139; val_kl_reg_loss: 5717.0185; val_edge_recon_loss: 256799.9431; val_gene_expr_recon_loss: 10564.8117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273081.7736; val_optim_loss: 273081.7736
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9878; val_auprc_score: 0.9813; val_best_acc_score: 0.9680; val_best_f1_score: 0.9687; train_kl_reg_loss: 5793.8878; train_edge_recon_loss: 256265.0868; train_gene_expr_recon_loss: 10563.0735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272622.0480; train_optim_loss: 272622.0480; val_kl_reg_loss: 5710.8254; val_edge_recon_loss: 256851.5116; val_gene_expr_recon_loss: 10542.6418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273104.9804; val_optim_loss: 273104.9804

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9878; val_auprc_score: 0.9809; val_best_acc_score: 0.9685; val_best_f1_score: 0.9692; train_kl_reg_loss: 5791.1885; train_edge_recon_loss: 256287.3580; train_gene_expr_recon_loss: 10557.6613; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272636.2079; train_optim_loss: 272636.2079; val_kl_reg_loss: 5713.2051; val_edge_recon_loss: 256135.4907; val_gene_expr_recon_loss: 10583.6004; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272432.2980; val_optim_loss: 272432.2980
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9870; val_auprc_score: 0.9798; val_best_acc_score: 0.9672; val_best_f1_score: 0.9678; train_kl_reg_loss: 5789.9836; train_edge_recon_loss: 256343.5172; train_gene_expr_recon_loss: 10562.0462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272695.5471; train_optim_loss: 272695.5471; val_kl_reg_loss: 5713.6144; val_edge_recon_loss: 256964.4978; val_gene_expr_recon_loss: 10543.5152; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273221.6275; val_optim_loss: 273221.6275
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9875; val_auprc_score: 0.9803; val_best_acc_score: 0.9683; val_best_f1_score: 0.9689; train_kl_reg_loss: 5792.3152; train_edge_recon_loss: 256303.8981; train_gene_expr_recon_loss: 10553.2780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272649.4913; train_optim_loss: 272649.4913; val_kl_reg_loss: 5724.2233; val_edge_recon_loss: 257128.1059; val_gene_expr_recon_loss: 10571.1575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273423.4880; val_optim_loss: 273423.4880
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9870; val_auprc_score: 0.9797; val_best_acc_score: 0.9666; val_best_f1_score: 0.9673; train_kl_reg_loss: 5795.5938; train_edge_recon_loss: 256161.8010; train_gene_expr_recon_loss: 10559.6085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272517.0033; train_optim_loss: 272517.0033; val_kl_reg_loss: 5722.1935; val_edge_recon_loss: 256728.8685; val_gene_expr_recon_loss: 10573.1708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273024.2333; val_optim_loss: 273024.2333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9863; val_auprc_score: 0.9786; val_best_acc_score: 0.9656; val_best_f1_score: 0.9663; train_kl_reg_loss: 5795.7383; train_edge_recon_loss: 256152.9919; train_gene_expr_recon_loss: 10556.1344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272504.8642; train_optim_loss: 272504.8642; val_kl_reg_loss: 5717.2757; val_edge_recon_loss: 257031.6225; val_gene_expr_recon_loss: 10546.9810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273295.8786; val_optim_loss: 273295.8786

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9881; val_auprc_score: 0.9818; val_best_acc_score: 0.9678; val_best_f1_score: 0.9684; train_kl_reg_loss: 5794.2473; train_edge_recon_loss: 256381.8714; train_gene_expr_recon_loss: 10564.8946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272741.0133; train_optim_loss: 272741.0133; val_kl_reg_loss: 5716.6214; val_edge_recon_loss: 256700.4290; val_gene_expr_recon_loss: 10560.4013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272977.4509; val_optim_loss: 272977.4509
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9868; val_auprc_score: 0.9786; val_best_acc_score: 0.9678; val_best_f1_score: 0.9684; train_kl_reg_loss: 5794.7178; train_edge_recon_loss: 256410.2729; train_gene_expr_recon_loss: 10557.0450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272762.0356; train_optim_loss: 272762.0356; val_kl_reg_loss: 5717.6727; val_edge_recon_loss: 256746.3390; val_gene_expr_recon_loss: 10562.7704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273026.7823; val_optim_loss: 273026.7823
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9868; val_auprc_score: 0.9785; val_best_acc_score: 0.9672; val_best_f1_score: 0.9679; train_kl_reg_loss: 5794.4751; train_edge_recon_loss: 256479.2162; train_gene_expr_recon_loss: 10551.3810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272825.0718; train_optim_loss: 272825.0718; val_kl_reg_loss: 5719.5909; val_edge_recon_loss: 256983.9548; val_gene_expr_recon_loss: 10570.5150; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273274.0621; val_optim_loss: 273274.0621
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9879; val_auprc_score: 0.9810; val_best_acc_score: 0.9675; val_best_f1_score: 0.9681; train_kl_reg_loss: 5792.9357; train_edge_recon_loss: 256291.1208; train_gene_expr_recon_loss: 10552.0496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272636.1062; train_optim_loss: 272636.1062; val_kl_reg_loss: 5712.1790; val_edge_recon_loss: 256928.8318; val_gene_expr_recon_loss: 10540.5221; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273181.5338; val_optim_loss: 273181.5338

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 47 min 57 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
Val AUROC score: 0.9881
Val AUPRC score: 0.9820
Val best accuracy score: 0.9676
Val best F1 score: 0.9683
Val gene expr MSE score: 0.7127

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
