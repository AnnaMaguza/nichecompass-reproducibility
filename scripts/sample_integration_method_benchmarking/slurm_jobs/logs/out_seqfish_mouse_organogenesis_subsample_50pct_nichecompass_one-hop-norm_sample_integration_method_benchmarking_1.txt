Run timestamp: 26062023_181550_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_50pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '6', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 54907
Number of validation edges: 6100
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9744; val_auprc_score: 0.9769; val_best_acc_score: 0.8990; val_best_f1_score: 0.8907; train_kl_reg_loss: 106.9780; train_edge_recon_loss: 100634.2754; train_gene_expr_recon_loss: 133145.6719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 233886.9219; train_optim_loss: 233886.9219; val_kl_reg_loss: 232.8278; val_edge_recon_loss: 115239.7969; val_gene_expr_recon_loss: 131014.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246486.7812; val_optim_loss: 246486.7812
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9725; val_auprc_score: 0.9721; val_best_acc_score: 0.8782; val_best_f1_score: 0.8889; train_kl_reg_loss: 327.5378; train_edge_recon_loss: 101445.5605; train_gene_expr_recon_loss: 130441.3887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 232214.4844; train_optim_loss: 232214.4844; val_kl_reg_loss: 471.3674; val_edge_recon_loss: 118612.4609; val_gene_expr_recon_loss: 128445.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 247529.1094; val_optim_loss: 247529.1094
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9719; val_auprc_score: 0.9721; val_best_acc_score: 0.8988; val_best_f1_score: 0.9049; train_kl_reg_loss: 494.4360; train_edge_recon_loss: 102472.3691; train_gene_expr_recon_loss: 128188.5391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 231155.3438; train_optim_loss: 231155.3438; val_kl_reg_loss: 479.7498; val_edge_recon_loss: 116457.7734; val_gene_expr_recon_loss: 126291.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243229.3125; val_optim_loss: 243229.3125
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9648; val_auprc_score: 0.9635; val_best_acc_score: 0.8911; val_best_f1_score: 0.8966; train_kl_reg_loss: 544.1283; train_edge_recon_loss: 100900.7500; train_gene_expr_recon_loss: 126080.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227525.6797; train_optim_loss: 227525.6797; val_kl_reg_loss: 676.3260; val_edge_recon_loss: 109442.7578; val_gene_expr_recon_loss: 123953.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234072.2500; val_optim_loss: 234072.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9564; val_auprc_score: 0.9539; val_best_acc_score: 0.8876; val_best_f1_score: 0.8903; train_kl_reg_loss: 810.6186; train_edge_recon_loss: 101435.7910; train_gene_expr_recon_loss: 123697.0039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 225943.4141; train_optim_loss: 225943.4141; val_kl_reg_loss: 912.2557; val_edge_recon_loss: 115015.5859; val_gene_expr_recon_loss: 121569.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237496.9688; val_optim_loss: 237496.9688
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9482; val_auprc_score: 0.9428; val_best_acc_score: 0.8792; val_best_f1_score: 0.8837; train_kl_reg_loss: 957.9370; train_edge_recon_loss: 100900.9336; train_gene_expr_recon_loss: 121777.3789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 223636.2461; train_optim_loss: 223636.2461; val_kl_reg_loss: 963.2367; val_edge_recon_loss: 108476.7422; val_gene_expr_recon_loss: 120141.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229581.3906; val_optim_loss: 229581.3906
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9339; val_auprc_score: 0.9251; val_best_acc_score: 0.8599; val_best_f1_score: 0.8676; train_kl_reg_loss: 1074.4673; train_edge_recon_loss: 98913.1211; train_gene_expr_recon_loss: 120257.3945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220244.9805; train_optim_loss: 220244.9805; val_kl_reg_loss: 1283.4800; val_edge_recon_loss: 96019.6953; val_gene_expr_recon_loss: 119200.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216503.2812; val_optim_loss: 216503.2812
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9161; val_auprc_score: 0.9041; val_best_acc_score: 0.8482; val_best_f1_score: 0.8561; train_kl_reg_loss: 1621.9553; train_edge_recon_loss: 94023.9785; train_gene_expr_recon_loss: 119203.9160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214849.8477; train_optim_loss: 214849.8477; val_kl_reg_loss: 2241.5000; val_edge_recon_loss: 92855.8438; val_gene_expr_recon_loss: 118512.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213609.4531; val_optim_loss: 213609.4531
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9129; val_auprc_score: 0.9019; val_best_acc_score: 0.8382; val_best_f1_score: 0.8488; train_kl_reg_loss: 2822.7326; train_edge_recon_loss: 91216.8984; train_gene_expr_recon_loss: 118538.5840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212578.2109; train_optim_loss: 212578.2109; val_kl_reg_loss: 3637.6084; val_edge_recon_loss: 89717.0547; val_gene_expr_recon_loss: 117715.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211069.7812; val_optim_loss: 211069.7812
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9111; val_auprc_score: 0.9005; val_best_acc_score: 0.8385; val_best_f1_score: 0.8479; train_kl_reg_loss: 4177.5649; train_edge_recon_loss: 87677.6562; train_gene_expr_recon_loss: 117715.2207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209570.4414; train_optim_loss: 209570.4414; val_kl_reg_loss: 4637.9209; val_edge_recon_loss: 86103.9141; val_gene_expr_recon_loss: 116642.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207383.9375; val_optim_loss: 207383.9375
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9161; val_auprc_score: 0.9069; val_best_acc_score: 0.8435; val_best_f1_score: 0.8512; train_kl_reg_loss: 4835.0463; train_edge_recon_loss: 86544.9355; train_gene_expr_recon_loss: 116562.2109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207942.1914; train_optim_loss: 207942.1914; val_kl_reg_loss: 4719.6514; val_edge_recon_loss: 83844.3672; val_gene_expr_recon_loss: 115420.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 203984.1562; val_optim_loss: 203984.1562
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9248; val_auprc_score: 0.9209; val_best_acc_score: 0.8485; val_best_f1_score: 0.8564; train_kl_reg_loss: 4703.7615; train_edge_recon_loss: 86613.9199; train_gene_expr_recon_loss: 115388.6816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206706.3633; train_optim_loss: 206706.3633; val_kl_reg_loss: 4323.6821; val_edge_recon_loss: 88100.7578; val_gene_expr_recon_loss: 114215.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206639.9688; val_optim_loss: 206639.9688
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9293; val_auprc_score: 0.9263; val_best_acc_score: 0.8504; val_best_f1_score: 0.8573; train_kl_reg_loss: 4307.4222; train_edge_recon_loss: 86283.8633; train_gene_expr_recon_loss: 114117.1016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204708.3867; train_optim_loss: 204708.3867; val_kl_reg_loss: 4054.2278; val_edge_recon_loss: 82574.6172; val_gene_expr_recon_loss: 113104.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 199733.1562; val_optim_loss: 199733.1562
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9320; val_auprc_score: 0.9301; val_best_acc_score: 0.8534; val_best_f1_score: 0.8597; train_kl_reg_loss: 4207.5918; train_edge_recon_loss: 86973.6367; train_gene_expr_recon_loss: 113065.1055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204246.3320; train_optim_loss: 204246.3320; val_kl_reg_loss: 4208.3955; val_edge_recon_loss: 87514.2734; val_gene_expr_recon_loss: 112170.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 203893.0000; val_optim_loss: 203893.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9335; val_auprc_score: 0.9306; val_best_acc_score: 0.8583; val_best_f1_score: 0.8618; train_kl_reg_loss: 4444.8195; train_edge_recon_loss: 85452.3105; train_gene_expr_recon_loss: 112168.8711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202066.0039; train_optim_loss: 202066.0039; val_kl_reg_loss: 4391.7002; val_edge_recon_loss: 87290.9922; val_gene_expr_recon_loss: 111407.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 203089.9062; val_optim_loss: 203089.9062
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9398; val_auprc_score: 0.9383; val_best_acc_score: 0.8671; val_best_f1_score: 0.8679; train_kl_reg_loss: 4513.7910; train_edge_recon_loss: 84596.4023; train_gene_expr_recon_loss: 111575.7246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200685.9180; train_optim_loss: 200685.9180; val_kl_reg_loss: 4353.6382; val_edge_recon_loss: 82079.0547; val_gene_expr_recon_loss: 110731.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197164.0938; val_optim_loss: 197164.0938
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9435; val_auprc_score: 0.9409; val_best_acc_score: 0.8711; val_best_f1_score: 0.8744; train_kl_reg_loss: 4503.7307; train_edge_recon_loss: 84087.5625; train_gene_expr_recon_loss: 110917.2559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199508.5508; train_optim_loss: 199508.5508; val_kl_reg_loss: 4347.8398; val_edge_recon_loss: 86523.3125; val_gene_expr_recon_loss: 109880.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200752.0938; val_optim_loss: 200752.0938
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9494; val_auprc_score: 0.9486; val_best_acc_score: 0.8802; val_best_f1_score: 0.8825; train_kl_reg_loss: 4473.1688; train_edge_recon_loss: 83677.3203; train_gene_expr_recon_loss: 109921.2949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198071.7812; train_optim_loss: 198071.7812; val_kl_reg_loss: 4280.9395; val_edge_recon_loss: 80760.4688; val_gene_expr_recon_loss: 109188.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194229.8750; val_optim_loss: 194229.8750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9476; val_auprc_score: 0.9457; val_best_acc_score: 0.8769; val_best_f1_score: 0.8801; train_kl_reg_loss: 4394.1666; train_edge_recon_loss: 83713.2695; train_gene_expr_recon_loss: 109369.7852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197477.2227; train_optim_loss: 197477.2227; val_kl_reg_loss: 4248.8359; val_edge_recon_loss: 82985.7031; val_gene_expr_recon_loss: 108411.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195646.3125; val_optim_loss: 195646.3125
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9524; val_auprc_score: 0.9486; val_best_acc_score: 0.8839; val_best_f1_score: 0.8859; train_kl_reg_loss: 4417.2738; train_edge_recon_loss: 82745.5449; train_gene_expr_recon_loss: 108553.8457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195716.6641; train_optim_loss: 195716.6641; val_kl_reg_loss: 4338.0830; val_edge_recon_loss: 83940.9531; val_gene_expr_recon_loss: 107574.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195853.1719; val_optim_loss: 195853.1719
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9560; val_auprc_score: 0.9518; val_best_acc_score: 0.8866; val_best_f1_score: 0.8896; train_kl_reg_loss: 4484.5702; train_edge_recon_loss: 82844.7070; train_gene_expr_recon_loss: 107705.1152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195034.3906; train_optim_loss: 195034.3906; val_kl_reg_loss: 4298.9321; val_edge_recon_loss: 82027.4062; val_gene_expr_recon_loss: 106875.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193201.8125; val_optim_loss: 193201.8125
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9611; val_auprc_score: 0.9598; val_best_acc_score: 0.8974; val_best_f1_score: 0.8978; train_kl_reg_loss: 4448.4016; train_edge_recon_loss: 83139.0938; train_gene_expr_recon_loss: 106965.5469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194553.0391; train_optim_loss: 194553.0391; val_kl_reg_loss: 4417.5176; val_edge_recon_loss: 82110.2969; val_gene_expr_recon_loss: 106281.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192808.8438; val_optim_loss: 192808.8438
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9628; val_auprc_score: 0.9606; val_best_acc_score: 0.9006; val_best_f1_score: 0.9017; train_kl_reg_loss: 4651.8954; train_edge_recon_loss: 81544.3652; train_gene_expr_recon_loss: 106188.2598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192384.5195; train_optim_loss: 192384.5195; val_kl_reg_loss: 4559.4780; val_edge_recon_loss: 80517.0859; val_gene_expr_recon_loss: 105441.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190517.5938; val_optim_loss: 190517.5938
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9657; val_auprc_score: 0.9652; val_best_acc_score: 0.9004; val_best_f1_score: 0.9018; train_kl_reg_loss: 4701.9434; train_edge_recon_loss: 82379.5117; train_gene_expr_recon_loss: 105502.0195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192583.4727; train_optim_loss: 192583.4727; val_kl_reg_loss: 4561.4668; val_edge_recon_loss: 82595.5312; val_gene_expr_recon_loss: 104726.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191883.7188; val_optim_loss: 191883.7188
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9675; val_auprc_score: 0.9658; val_best_acc_score: 0.9053; val_best_f1_score: 0.9068; train_kl_reg_loss: 4716.0677; train_edge_recon_loss: 82582.7480; train_gene_expr_recon_loss: 104888.9824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192187.7969; train_optim_loss: 192187.7969; val_kl_reg_loss: 4535.1655; val_edge_recon_loss: 82141.5234; val_gene_expr_recon_loss: 104216.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190892.8750; val_optim_loss: 190892.8750
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9655; val_auprc_score: 0.9618; val_best_acc_score: 0.9041; val_best_f1_score: 0.9048; train_kl_reg_loss: 4664.6554; train_edge_recon_loss: 80566.6426; train_gene_expr_recon_loss: 104303.4590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189534.7539; train_optim_loss: 189534.7539; val_kl_reg_loss: 4464.4932; val_edge_recon_loss: 82751.4688; val_gene_expr_recon_loss: 103552.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190768.2188; val_optim_loss: 190768.2188

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9679; val_auprc_score: 0.9650; val_best_acc_score: 0.9087; val_best_f1_score: 0.9101; train_kl_reg_loss: 4651.0323; train_edge_recon_loss: 83178.1152; train_gene_expr_recon_loss: 103747.8301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191576.9766; train_optim_loss: 191576.9766; val_kl_reg_loss: 4470.8364; val_edge_recon_loss: 80374.5703; val_gene_expr_recon_loss: 103537.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188382.5000; val_optim_loss: 188382.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9696; val_auprc_score: 0.9684; val_best_acc_score: 0.9080; val_best_f1_score: 0.9098; train_kl_reg_loss: 4661.3214; train_edge_recon_loss: 82315.6250; train_gene_expr_recon_loss: 103960.2109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190937.1562; train_optim_loss: 190937.1562; val_kl_reg_loss: 4484.1230; val_edge_recon_loss: 78992.4609; val_gene_expr_recon_loss: 103528.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187005.4062; val_optim_loss: 187005.4062
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9681; val_auprc_score: 0.9658; val_best_acc_score: 0.9058; val_best_f1_score: 0.9071; train_kl_reg_loss: 4678.4357; train_edge_recon_loss: 82043.5762; train_gene_expr_recon_loss: 103878.3945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190600.4023; train_optim_loss: 190600.4023; val_kl_reg_loss: 4497.1787; val_edge_recon_loss: 78198.8984; val_gene_expr_recon_loss: 103467.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186163.4375; val_optim_loss: 186163.4375
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9672; val_auprc_score: 0.9629; val_best_acc_score: 0.9084; val_best_f1_score: 0.9085; train_kl_reg_loss: 4706.9554; train_edge_recon_loss: 81887.5293; train_gene_expr_recon_loss: 103719.2695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190313.7539; train_optim_loss: 190313.7539; val_kl_reg_loss: 4517.1211; val_edge_recon_loss: 82864.1094; val_gene_expr_recon_loss: 103414.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190796.0000; val_optim_loss: 190796.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9669; val_auprc_score: 0.9640; val_best_acc_score: 0.9075; val_best_f1_score: 0.9083; train_kl_reg_loss: 4708.3024; train_edge_recon_loss: 80416.0605; train_gene_expr_recon_loss: 103771.9453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188896.3086; train_optim_loss: 188896.3086; val_kl_reg_loss: 4525.1934; val_edge_recon_loss: 86326.6328; val_gene_expr_recon_loss: 103347.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194199.5312; val_optim_loss: 194199.5312
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9704; val_auprc_score: 0.9694; val_best_acc_score: 0.9096; val_best_f1_score: 0.9107; train_kl_reg_loss: 4707.5660; train_edge_recon_loss: 80061.4062; train_gene_expr_recon_loss: 103646.3223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188415.3008; train_optim_loss: 188415.3008; val_kl_reg_loss: 4504.2295; val_edge_recon_loss: 82307.5625; val_gene_expr_recon_loss: 103278.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190089.8750; val_optim_loss: 190089.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9702; val_auprc_score: 0.9691; val_best_acc_score: 0.9107; val_best_f1_score: 0.9116; train_kl_reg_loss: 4699.0526; train_edge_recon_loss: 81715.9062; train_gene_expr_recon_loss: 103548.6445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189963.6016; train_optim_loss: 189963.6016; val_kl_reg_loss: 4509.3809; val_edge_recon_loss: 83120.9922; val_gene_expr_recon_loss: 103273.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190903.5938; val_optim_loss: 190903.5938
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9692; val_auprc_score: 0.9676; val_best_acc_score: 0.9093; val_best_f1_score: 0.9106; train_kl_reg_loss: 4692.0388; train_edge_recon_loss: 82258.1680; train_gene_expr_recon_loss: 103560.7246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190510.9336; train_optim_loss: 190510.9336; val_kl_reg_loss: 4492.4619; val_edge_recon_loss: 80855.1328; val_gene_expr_recon_loss: 103271.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188618.7812; val_optim_loss: 188618.7812
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9696; val_auprc_score: 0.9690; val_best_acc_score: 0.9083; val_best_f1_score: 0.9090; train_kl_reg_loss: 4695.3468; train_edge_recon_loss: 80342.5469; train_gene_expr_recon_loss: 103476.8535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188514.7461; train_optim_loss: 188514.7461; val_kl_reg_loss: 4493.8950; val_edge_recon_loss: 84327.4453; val_gene_expr_recon_loss: 103268.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192089.8750; val_optim_loss: 192089.8750

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 16 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
Val AUROC score: 0.9696
Val AUPRC score: 0.9693
Val best accuracy score: 0.9076
Val best F1 score: 0.9078
Val gene expr MSE score: 1.6111
Duration of model training in run 1: 0 hours, 2 minutes and 22 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 54907
Number of validation edges: 6100
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9737; val_auprc_score: 0.9748; val_best_acc_score: 0.9133; val_best_f1_score: 0.9095; train_kl_reg_loss: 104.5764; train_edge_recon_loss: 102543.1719; train_gene_expr_recon_loss: 132298.9961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 234946.7383; train_optim_loss: 234946.7383; val_kl_reg_loss: 258.9329; val_edge_recon_loss: 116347.2969; val_gene_expr_recon_loss: 130596.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 247202.8438; val_optim_loss: 247202.8438
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9742; val_auprc_score: 0.9746; val_best_acc_score: 0.8778; val_best_f1_score: 0.8886; train_kl_reg_loss: 355.2361; train_edge_recon_loss: 101693.7188; train_gene_expr_recon_loss: 129350.7363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 231399.6914; train_optim_loss: 231399.6914; val_kl_reg_loss: 462.1696; val_edge_recon_loss: 118076.5469; val_gene_expr_recon_loss: 127745.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246284.1250; val_optim_loss: 246284.1250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9687; val_auprc_score: 0.9691; val_best_acc_score: 0.8777; val_best_f1_score: 0.8880; train_kl_reg_loss: 517.2843; train_edge_recon_loss: 103517.8867; train_gene_expr_recon_loss: 126834.6074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 230869.7812; train_optim_loss: 230869.7812; val_kl_reg_loss: 577.6860; val_edge_recon_loss: 117617.6406; val_gene_expr_recon_loss: 125133.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243328.4688; val_optim_loss: 243328.4688
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9657; val_auprc_score: 0.9659; val_best_acc_score: 0.8825; val_best_f1_score: 0.8898; train_kl_reg_loss: 693.1380; train_edge_recon_loss: 102048.3633; train_gene_expr_recon_loss: 124412.4570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227153.9609; train_optim_loss: 227153.9609; val_kl_reg_loss: 860.4413; val_edge_recon_loss: 115032.7812; val_gene_expr_recon_loss: 122462.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238355.7500; val_optim_loss: 238355.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9562; val_auprc_score: 0.9539; val_best_acc_score: 0.8818; val_best_f1_score: 0.8841; train_kl_reg_loss: 954.0405; train_edge_recon_loss: 101688.4902; train_gene_expr_recon_loss: 121755.7168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224398.2461; train_optim_loss: 224398.2461; val_kl_reg_loss: 985.9358; val_edge_recon_loss: 114057.6016; val_gene_expr_recon_loss: 120079.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 235123.1562; val_optim_loss: 235123.1562
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9444; val_auprc_score: 0.9401; val_best_acc_score: 0.8664; val_best_f1_score: 0.8713; train_kl_reg_loss: 1034.7515; train_edge_recon_loss: 100220.1738; train_gene_expr_recon_loss: 119704.3047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220959.2344; train_optim_loss: 220959.2344; val_kl_reg_loss: 1058.4531; val_edge_recon_loss: 101203.1016; val_gene_expr_recon_loss: 118672.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220933.6250; val_optim_loss: 220933.6250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9262; val_auprc_score: 0.9148; val_best_acc_score: 0.8510; val_best_f1_score: 0.8598; train_kl_reg_loss: 1191.6385; train_edge_recon_loss: 98103.6113; train_gene_expr_recon_loss: 118644.7031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217939.9531; train_optim_loss: 217939.9531; val_kl_reg_loss: 1433.1841; val_edge_recon_loss: 98537.2969; val_gene_expr_recon_loss: 117828.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217798.6250; val_optim_loss: 217798.6250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9102; val_auprc_score: 0.8983; val_best_acc_score: 0.8353; val_best_f1_score: 0.8454; train_kl_reg_loss: 1818.8792; train_edge_recon_loss: 93763.8477; train_gene_expr_recon_loss: 117567.9746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213150.6992; train_optim_loss: 213150.6992; val_kl_reg_loss: 2474.6272; val_edge_recon_loss: 92403.2109; val_gene_expr_recon_loss: 117071.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211948.8750; val_optim_loss: 211948.8750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8997; val_auprc_score: 0.8842; val_best_acc_score: 0.8266; val_best_f1_score: 0.8394; train_kl_reg_loss: 3076.3615; train_edge_recon_loss: 90555.1055; train_gene_expr_recon_loss: 116669.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210301.4062; train_optim_loss: 210301.4062; val_kl_reg_loss: 3845.4639; val_edge_recon_loss: 88068.2109; val_gene_expr_recon_loss: 116356.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208270.0938; val_optim_loss: 208270.0938
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9058; val_auprc_score: 0.8962; val_best_acc_score: 0.8315; val_best_f1_score: 0.8418; train_kl_reg_loss: 4271.7889; train_edge_recon_loss: 87500.8535; train_gene_expr_recon_loss: 115899.9746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207672.6172; train_optim_loss: 207672.6172; val_kl_reg_loss: 4532.0293; val_edge_recon_loss: 90010.0234; val_gene_expr_recon_loss: 115240.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209782.3438; val_optim_loss: 209782.3438
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9102; val_auprc_score: 0.9036; val_best_acc_score: 0.8322; val_best_f1_score: 0.8446; train_kl_reg_loss: 4725.6013; train_edge_recon_loss: 87700.0527; train_gene_expr_recon_loss: 114611.6992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207037.3516; train_optim_loss: 207037.3516; val_kl_reg_loss: 4621.7588; val_edge_recon_loss: 86543.6328; val_gene_expr_recon_loss: 113861.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205027.1406; val_optim_loss: 205027.1406
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9139; val_auprc_score: 0.9088; val_best_acc_score: 0.8396; val_best_f1_score: 0.8466; train_kl_reg_loss: 4638.9504; train_edge_recon_loss: 85561.4961; train_gene_expr_recon_loss: 113427.4277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203627.8711; train_optim_loss: 203627.8711; val_kl_reg_loss: 4352.8037; val_edge_recon_loss: 86997.7734; val_gene_expr_recon_loss: 112708.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204059.4844; val_optim_loss: 204059.4844
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9217; val_auprc_score: 0.9199; val_best_acc_score: 0.8419; val_best_f1_score: 0.8490; train_kl_reg_loss: 4401.1881; train_edge_recon_loss: 85667.8438; train_gene_expr_recon_loss: 112204.4805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202273.5078; train_optim_loss: 202273.5078; val_kl_reg_loss: 4300.6587; val_edge_recon_loss: 84562.4062; val_gene_expr_recon_loss: 111560.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200423.6875; val_optim_loss: 200423.6875
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9241; val_auprc_score: 0.9224; val_best_acc_score: 0.8439; val_best_f1_score: 0.8504; train_kl_reg_loss: 4463.7751; train_edge_recon_loss: 86066.4590; train_gene_expr_recon_loss: 111256.0273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201786.2656; train_optim_loss: 201786.2656; val_kl_reg_loss: 4421.0986; val_edge_recon_loss: 85294.0625; val_gene_expr_recon_loss: 110669.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200384.4375; val_optim_loss: 200384.4375
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9289; val_auprc_score: 0.9287; val_best_acc_score: 0.8501; val_best_f1_score: 0.8543; train_kl_reg_loss: 4510.2578; train_edge_recon_loss: 85013.5039; train_gene_expr_recon_loss: 110382.3496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199906.1094; train_optim_loss: 199906.1094; val_kl_reg_loss: 4398.0654; val_edge_recon_loss: 83922.4609; val_gene_expr_recon_loss: 109863.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198184.1562; val_optim_loss: 198184.1562
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9310; val_auprc_score: 0.9303; val_best_acc_score: 0.8540; val_best_f1_score: 0.8574; train_kl_reg_loss: 4504.9270; train_edge_recon_loss: 83455.1855; train_gene_expr_recon_loss: 109744.6035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197704.7148; train_optim_loss: 197704.7148; val_kl_reg_loss: 4357.4741; val_edge_recon_loss: 85141.7578; val_gene_expr_recon_loss: 109080.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198579.8281; val_optim_loss: 198579.8281
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9356; val_auprc_score: 0.9351; val_best_acc_score: 0.8590; val_best_f1_score: 0.8626; train_kl_reg_loss: 4421.2760; train_edge_recon_loss: 83668.8125; train_gene_expr_recon_loss: 108869.3398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196959.4219; train_optim_loss: 196959.4219; val_kl_reg_loss: 4205.1162; val_edge_recon_loss: 82134.7266; val_gene_expr_recon_loss: 108386.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194726.4688; val_optim_loss: 194726.4688
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9401; val_auprc_score: 0.9398; val_best_acc_score: 0.8652; val_best_f1_score: 0.8690; train_kl_reg_loss: 4248.7151; train_edge_recon_loss: 84986.1504; train_gene_expr_recon_loss: 108011.1699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197246.0391; train_optim_loss: 197246.0391; val_kl_reg_loss: 4159.8140; val_edge_recon_loss: 87576.5938; val_gene_expr_recon_loss: 107607.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 199343.4531; val_optim_loss: 199343.4531
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9439; val_auprc_score: 0.9412; val_best_acc_score: 0.8719; val_best_f1_score: 0.8748; train_kl_reg_loss: 4333.4827; train_edge_recon_loss: 81842.8750; train_gene_expr_recon_loss: 107323.9961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193500.3555; train_optim_loss: 193500.3555; val_kl_reg_loss: 4332.2910; val_edge_recon_loss: 79546.2031; val_gene_expr_recon_loss: 106966.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190845.3125; val_optim_loss: 190845.3125
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9486; val_auprc_score: 0.9483; val_best_acc_score: 0.8748; val_best_f1_score: 0.8776; train_kl_reg_loss: 4438.8408; train_edge_recon_loss: 83017.1406; train_gene_expr_recon_loss: 106660.5840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194116.5625; train_optim_loss: 194116.5625; val_kl_reg_loss: 4267.1035; val_edge_recon_loss: 81554.7500; val_gene_expr_recon_loss: 106174.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191996.4688; val_optim_loss: 191996.4688
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9520; val_auprc_score: 0.9510; val_best_acc_score: 0.8806; val_best_f1_score: 0.8833; train_kl_reg_loss: 4343.7825; train_edge_recon_loss: 84140.5410; train_gene_expr_recon_loss: 106014.8926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194499.2148; train_optim_loss: 194499.2148; val_kl_reg_loss: 4224.5732; val_edge_recon_loss: 85850.7031; val_gene_expr_recon_loss: 105577.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195653.1562; val_optim_loss: 195653.1562
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9543; val_auprc_score: 0.9530; val_best_acc_score: 0.8853; val_best_f1_score: 0.8877; train_kl_reg_loss: 4331.0264; train_edge_recon_loss: 83927.9824; train_gene_expr_recon_loss: 105436.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193695.4688; train_optim_loss: 193695.4688; val_kl_reg_loss: 4253.9756; val_edge_recon_loss: 87068.7734; val_gene_expr_recon_loss: 104899.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196222.6875; val_optim_loss: 196222.6875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9572; val_auprc_score: 0.9519; val_best_acc_score: 0.8890; val_best_f1_score: 0.8911; train_kl_reg_loss: 4354.4592; train_edge_recon_loss: 82613.3496; train_gene_expr_recon_loss: 105049.4219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192017.2344; train_optim_loss: 192017.2344; val_kl_reg_loss: 4260.0742; val_edge_recon_loss: 82220.1641; val_gene_expr_recon_loss: 104818.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191298.5312; val_optim_loss: 191298.5312
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9574; val_auprc_score: 0.9569; val_best_acc_score: 0.8865; val_best_f1_score: 0.8897; train_kl_reg_loss: 4370.0112; train_edge_recon_loss: 82089.1621; train_gene_expr_recon_loss: 104904.9824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191364.1602; train_optim_loss: 191364.1602; val_kl_reg_loss: 4282.7812; val_edge_recon_loss: 86146.3984; val_gene_expr_recon_loss: 104733.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195162.5000; val_optim_loss: 195162.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9569; val_auprc_score: 0.9559; val_best_acc_score: 0.8882; val_best_f1_score: 0.8911; train_kl_reg_loss: 4388.0494; train_edge_recon_loss: 82818.9805; train_gene_expr_recon_loss: 104754.9727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191962.0039; train_optim_loss: 191962.0039; val_kl_reg_loss: 4299.8384; val_edge_recon_loss: 85662.8438; val_gene_expr_recon_loss: 104688.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194651.2500; val_optim_loss: 194651.2500

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 34 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9447
Val AUPRC score: 0.9454
Val best accuracy score: 0.8686
Val best F1 score: 0.8726
Val gene expr MSE score: 1.7528
Duration of model training in run 2: 0 hours, 1 minutes and 37 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 107073
Number of validation edges: 11897
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9925; val_auprc_score: 0.9921; val_best_acc_score: 0.8159; val_best_f1_score: 0.8386; train_kl_reg_loss: 212.1101; train_edge_recon_loss: 102838.4710; train_gene_expr_recon_loss: 130808.0792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 233858.6607; train_optim_loss: 233858.6607; val_kl_reg_loss: 455.3358; val_edge_recon_loss: 118879.3125; val_gene_expr_recon_loss: 126715.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246050.0000; val_optim_loss: 246050.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9842; val_auprc_score: 0.9842; val_best_acc_score: 0.8760; val_best_f1_score: 0.8887; train_kl_reg_loss: 509.5386; train_edge_recon_loss: 101584.1975; train_gene_expr_recon_loss: 126603.9520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228697.6853; train_optim_loss: 228697.6853; val_kl_reg_loss: 674.4869; val_edge_recon_loss: 115512.6797; val_gene_expr_recon_loss: 122879.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 239066.4375; val_optim_loss: 239066.4375
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9672; val_auprc_score: 0.9669; val_best_acc_score: 0.8950; val_best_f1_score: 0.8989; train_kl_reg_loss: 829.9018; train_edge_recon_loss: 102146.7478; train_gene_expr_recon_loss: 122786.2768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 225762.9286; train_optim_loss: 225762.9286; val_kl_reg_loss: 920.2454; val_edge_recon_loss: 111864.8281; val_gene_expr_recon_loss: 119484.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 232269.3125; val_optim_loss: 232269.3125
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9398; val_auprc_score: 0.9361; val_best_acc_score: 0.8631; val_best_f1_score: 0.8704; train_kl_reg_loss: 1063.3905; train_edge_recon_loss: 98059.9777; train_gene_expr_recon_loss: 120085.7310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219209.0982; train_optim_loss: 219209.0982; val_kl_reg_loss: 1449.0383; val_edge_recon_loss: 94360.7969; val_gene_expr_recon_loss: 118127.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213937.2188; val_optim_loss: 213937.2188
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9174; val_auprc_score: 0.9104; val_best_acc_score: 0.8409; val_best_f1_score: 0.8509; train_kl_reg_loss: 2261.4452; train_edge_recon_loss: 92877.1462; train_gene_expr_recon_loss: 118965.0123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214103.6004; train_optim_loss: 214103.6004; val_kl_reg_loss: 3408.7080; val_edge_recon_loss: 86212.8359; val_gene_expr_recon_loss: 117165.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206786.8750; val_optim_loss: 206786.8750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9272; val_auprc_score: 0.9220; val_best_acc_score: 0.8510; val_best_f1_score: 0.8575; train_kl_reg_loss: 4115.2392; train_edge_recon_loss: 87845.3359; train_gene_expr_recon_loss: 117387.4699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209348.0446; train_optim_loss: 209348.0446; val_kl_reg_loss: 4381.7832; val_edge_recon_loss: 83467.1797; val_gene_expr_recon_loss: 115233.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 203082.2344; val_optim_loss: 203082.2344
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9359; val_auprc_score: 0.9334; val_best_acc_score: 0.8585; val_best_f1_score: 0.8634; train_kl_reg_loss: 4341.9515; train_edge_recon_loss: 86333.2701; train_gene_expr_recon_loss: 115283.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205958.6228; train_optim_loss: 205958.6228; val_kl_reg_loss: 4020.5049; val_edge_recon_loss: 83422.1094; val_gene_expr_recon_loss: 113114.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200557.1719; val_optim_loss: 200557.1719
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9396; val_auprc_score: 0.9395; val_best_acc_score: 0.8612; val_best_f1_score: 0.8655; train_kl_reg_loss: 4263.8717; train_edge_recon_loss: 84955.7433; train_gene_expr_recon_loss: 113299.4509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202519.0670; train_optim_loss: 202519.0670; val_kl_reg_loss: 4296.8418; val_edge_recon_loss: 85149.3281; val_gene_expr_recon_loss: 111453.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200899.3906; val_optim_loss: 200899.3906
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9449; val_auprc_score: 0.9446; val_best_acc_score: 0.8698; val_best_f1_score: 0.8722; train_kl_reg_loss: 4441.9616; train_edge_recon_loss: 84908.5145; train_gene_expr_recon_loss: 111992.4688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201342.9464; train_optim_loss: 201342.9464; val_kl_reg_loss: 4290.6475; val_edge_recon_loss: 83243.1172; val_gene_expr_recon_loss: 110221.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197755.3125; val_optim_loss: 197755.3125
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9526; val_auprc_score: 0.9537; val_best_acc_score: 0.8797; val_best_f1_score: 0.8812; train_kl_reg_loss: 4415.1117; train_edge_recon_loss: 84974.1228; train_gene_expr_recon_loss: 110610.4319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199999.6696; train_optim_loss: 199999.6696; val_kl_reg_loss: 4272.3926; val_edge_recon_loss: 83008.3203; val_gene_expr_recon_loss: 108948.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196229.1250; val_optim_loss: 196229.1250
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9578; val_auprc_score: 0.9590; val_best_acc_score: 0.8876; val_best_f1_score: 0.8883; train_kl_reg_loss: 4354.5402; train_edge_recon_loss: 83809.4453; train_gene_expr_recon_loss: 109331.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197495.1384; train_optim_loss: 197495.1384; val_kl_reg_loss: 4185.9209; val_edge_recon_loss: 83768.6250; val_gene_expr_recon_loss: 107650.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195605.3438; val_optim_loss: 195605.3438
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9634; val_auprc_score: 0.9639; val_best_acc_score: 0.8985; val_best_f1_score: 0.8984; train_kl_reg_loss: 4405.6271; train_edge_recon_loss: 82893.5636; train_gene_expr_recon_loss: 108081.9196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195381.1049; train_optim_loss: 195381.1049; val_kl_reg_loss: 4329.4531; val_edge_recon_loss: 82146.8281; val_gene_expr_recon_loss: 106397.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192873.3125; val_optim_loss: 192873.3125
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9692; val_auprc_score: 0.9688; val_best_acc_score: 0.9082; val_best_f1_score: 0.9096; train_kl_reg_loss: 4386.2309; train_edge_recon_loss: 82720.4319; train_gene_expr_recon_loss: 106648.4163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193755.0826; train_optim_loss: 193755.0826; val_kl_reg_loss: 4327.2314; val_edge_recon_loss: 83010.2344; val_gene_expr_recon_loss: 105329.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192667.1250; val_optim_loss: 192667.1250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9729; val_auprc_score: 0.9723; val_best_acc_score: 0.9131; val_best_f1_score: 0.9139; train_kl_reg_loss: 4526.9653; train_edge_recon_loss: 82735.7109; train_gene_expr_recon_loss: 105799.3705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193062.0446; train_optim_loss: 193062.0446; val_kl_reg_loss: 4360.6709; val_edge_recon_loss: 80654.6719; val_gene_expr_recon_loss: 104331.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189346.7500; val_optim_loss: 189346.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9775; val_auprc_score: 0.9765; val_best_acc_score: 0.9217; val_best_f1_score: 0.9224; train_kl_reg_loss: 4430.4213; train_edge_recon_loss: 81332.3460; train_gene_expr_recon_loss: 104782.2299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190544.9955; train_optim_loss: 190544.9955; val_kl_reg_loss: 4399.0254; val_edge_recon_loss: 78989.2969; val_gene_expr_recon_loss: 103305.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186693.4219; val_optim_loss: 186693.4219
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9800; val_auprc_score: 0.9787; val_best_acc_score: 0.9274; val_best_f1_score: 0.9276; train_kl_reg_loss: 4541.3093; train_edge_recon_loss: 82629.5379; train_gene_expr_recon_loss: 103885.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191056.1295; train_optim_loss: 191056.1295; val_kl_reg_loss: 4448.0498; val_edge_recon_loss: 82038.0078; val_gene_expr_recon_loss: 102598.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189084.3438; val_optim_loss: 189084.3438
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9826; val_auprc_score: 0.9816; val_best_acc_score: 0.9313; val_best_f1_score: 0.9312; train_kl_reg_loss: 4570.2589; train_edge_recon_loss: 81384.6931; train_gene_expr_recon_loss: 103114.5882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189069.5424; train_optim_loss: 189069.5424; val_kl_reg_loss: 4453.5801; val_edge_recon_loss: 81175.7109; val_gene_expr_recon_loss: 101751.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187381.0781; val_optim_loss: 187381.0781
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9847; val_auprc_score: 0.9835; val_best_acc_score: 0.9382; val_best_f1_score: 0.9385; train_kl_reg_loss: 4588.8172; train_edge_recon_loss: 80631.2489; train_gene_expr_recon_loss: 102294.9498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187515.0179; train_optim_loss: 187515.0179; val_kl_reg_loss: 4467.7920; val_edge_recon_loss: 82077.0625; val_gene_expr_recon_loss: 101160.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187704.9062; val_optim_loss: 187704.9062

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9841; val_auprc_score: 0.9830; val_best_acc_score: 0.9360; val_best_f1_score: 0.9366; train_kl_reg_loss: 4580.8371; train_edge_recon_loss: 81281.7511; train_gene_expr_recon_loss: 102005.6116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187868.2009; train_optim_loss: 187868.2009; val_kl_reg_loss: 4444.9336; val_edge_recon_loss: 80172.9531; val_gene_expr_recon_loss: 101133.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185751.1250; val_optim_loss: 185751.1250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9848; val_auprc_score: 0.9832; val_best_acc_score: 0.9373; val_best_f1_score: 0.9379; train_kl_reg_loss: 4572.9600; train_edge_recon_loss: 80617.3482; train_gene_expr_recon_loss: 101903.9911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187094.2991; train_optim_loss: 187094.2991; val_kl_reg_loss: 4450.2358; val_edge_recon_loss: 79522.1484; val_gene_expr_recon_loss: 101045.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185018.0156; val_optim_loss: 185018.0156
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9851; val_auprc_score: 0.9842; val_best_acc_score: 0.9390; val_best_f1_score: 0.9391; train_kl_reg_loss: 4583.1974; train_edge_recon_loss: 80907.4855; train_gene_expr_recon_loss: 101912.0525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187402.7388; train_optim_loss: 187402.7388; val_kl_reg_loss: 4458.8105; val_edge_recon_loss: 77337.6797; val_gene_expr_recon_loss: 100984.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182781.0000; val_optim_loss: 182781.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9849; val_auprc_score: 0.9841; val_best_acc_score: 0.9387; val_best_f1_score: 0.9398; train_kl_reg_loss: 4586.8491; train_edge_recon_loss: 80314.7891; train_gene_expr_recon_loss: 101808.2489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186709.8839; train_optim_loss: 186709.8839; val_kl_reg_loss: 4456.9209; val_edge_recon_loss: 78893.3828; val_gene_expr_recon_loss: 100920.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184270.7188; val_optim_loss: 184270.7188
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9842; val_auprc_score: 0.9826; val_best_acc_score: 0.9365; val_best_f1_score: 0.9373; train_kl_reg_loss: 4583.1351; train_edge_recon_loss: 80648.4844; train_gene_expr_recon_loss: 101815.2109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187046.8326; train_optim_loss: 187046.8326; val_kl_reg_loss: 4433.9229; val_edge_recon_loss: 81313.9062; val_gene_expr_recon_loss: 100858.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186605.9531; val_optim_loss: 186605.9531
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9847; val_auprc_score: 0.9831; val_best_acc_score: 0.9370; val_best_f1_score: 0.9375; train_kl_reg_loss: 4568.5086; train_edge_recon_loss: 80578.7645; train_gene_expr_recon_loss: 101557.8895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186705.1629; train_optim_loss: 186705.1629; val_kl_reg_loss: 4444.9668; val_edge_recon_loss: 81049.1797; val_gene_expr_recon_loss: 100790.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186284.6875; val_optim_loss: 186284.6875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9856; val_auprc_score: 0.9853; val_best_acc_score: 0.9386; val_best_f1_score: 0.9391; train_kl_reg_loss: 4576.1401; train_edge_recon_loss: 80898.2812; train_gene_expr_recon_loss: 101579.8650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187054.2857; train_optim_loss: 187054.2857; val_kl_reg_loss: 4451.6440; val_edge_recon_loss: 80544.3828; val_gene_expr_recon_loss: 100786.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185782.1875; val_optim_loss: 185782.1875
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9850; val_auprc_score: 0.9842; val_best_acc_score: 0.9371; val_best_f1_score: 0.9379; train_kl_reg_loss: 4572.4184; train_edge_recon_loss: 81467.6518; train_gene_expr_recon_loss: 101511.2846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187551.3549; train_optim_loss: 187551.3549; val_kl_reg_loss: 4412.2656; val_edge_recon_loss: 78619.7891; val_gene_expr_recon_loss: 100788.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183820.6250; val_optim_loss: 183820.6250
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9849; val_auprc_score: 0.9832; val_best_acc_score: 0.9387; val_best_f1_score: 0.9385; train_kl_reg_loss: 4574.7298; train_edge_recon_loss: 80263.9308; train_gene_expr_recon_loss: 101717.8783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186556.5424; train_optim_loss: 186556.5424; val_kl_reg_loss: 4422.6162; val_edge_recon_loss: 77279.5703; val_gene_expr_recon_loss: 100789.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182491.5312; val_optim_loss: 182491.5312
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9859; val_auprc_score: 0.9851; val_best_acc_score: 0.9399; val_best_f1_score: 0.9405; train_kl_reg_loss: 4580.3055; train_edge_recon_loss: 81257.7210; train_gene_expr_recon_loss: 101603.5301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187441.5558; train_optim_loss: 187441.5558; val_kl_reg_loss: 4421.5840; val_edge_recon_loss: 78389.3750; val_gene_expr_recon_loss: 100788.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183599.1250; val_optim_loss: 183599.1250
