Run timestamp: 26062023_181550_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_50pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '6', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 54907
Number of validation edges: 6100
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9744; val_auprc_score: 0.9769; val_best_acc_score: 0.8990; val_best_f1_score: 0.8907; train_kl_reg_loss: 106.9780; train_edge_recon_loss: 100634.2754; train_gene_expr_recon_loss: 133145.6719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 233886.9219; train_optim_loss: 233886.9219; val_kl_reg_loss: 232.8278; val_edge_recon_loss: 115239.7969; val_gene_expr_recon_loss: 131014.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246486.7812; val_optim_loss: 246486.7812
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9725; val_auprc_score: 0.9721; val_best_acc_score: 0.8782; val_best_f1_score: 0.8889; train_kl_reg_loss: 327.5378; train_edge_recon_loss: 101445.5605; train_gene_expr_recon_loss: 130441.3887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 232214.4844; train_optim_loss: 232214.4844; val_kl_reg_loss: 471.3674; val_edge_recon_loss: 118612.4609; val_gene_expr_recon_loss: 128445.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 247529.1094; val_optim_loss: 247529.1094
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9719; val_auprc_score: 0.9721; val_best_acc_score: 0.8988; val_best_f1_score: 0.9049; train_kl_reg_loss: 494.4360; train_edge_recon_loss: 102472.3691; train_gene_expr_recon_loss: 128188.5391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 231155.3438; train_optim_loss: 231155.3438; val_kl_reg_loss: 479.7498; val_edge_recon_loss: 116457.7734; val_gene_expr_recon_loss: 126291.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243229.3125; val_optim_loss: 243229.3125
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9648; val_auprc_score: 0.9635; val_best_acc_score: 0.8911; val_best_f1_score: 0.8966; train_kl_reg_loss: 544.1283; train_edge_recon_loss: 100900.7500; train_gene_expr_recon_loss: 126080.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227525.6797; train_optim_loss: 227525.6797; val_kl_reg_loss: 676.3260; val_edge_recon_loss: 109442.7578; val_gene_expr_recon_loss: 123953.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234072.2500; val_optim_loss: 234072.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9564; val_auprc_score: 0.9539; val_best_acc_score: 0.8876; val_best_f1_score: 0.8903; train_kl_reg_loss: 810.6186; train_edge_recon_loss: 101435.7910; train_gene_expr_recon_loss: 123697.0039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 225943.4141; train_optim_loss: 225943.4141; val_kl_reg_loss: 912.2557; val_edge_recon_loss: 115015.5859; val_gene_expr_recon_loss: 121569.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237496.9688; val_optim_loss: 237496.9688
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9482; val_auprc_score: 0.9428; val_best_acc_score: 0.8792; val_best_f1_score: 0.8837; train_kl_reg_loss: 957.9370; train_edge_recon_loss: 100900.9336; train_gene_expr_recon_loss: 121777.3789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 223636.2461; train_optim_loss: 223636.2461; val_kl_reg_loss: 963.2367; val_edge_recon_loss: 108476.7422; val_gene_expr_recon_loss: 120141.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229581.3906; val_optim_loss: 229581.3906
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9339; val_auprc_score: 0.9251; val_best_acc_score: 0.8599; val_best_f1_score: 0.8676; train_kl_reg_loss: 1074.4673; train_edge_recon_loss: 98913.1211; train_gene_expr_recon_loss: 120257.3945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220244.9805; train_optim_loss: 220244.9805; val_kl_reg_loss: 1283.4800; val_edge_recon_loss: 96019.6953; val_gene_expr_recon_loss: 119200.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216503.2812; val_optim_loss: 216503.2812
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9161; val_auprc_score: 0.9041; val_best_acc_score: 0.8482; val_best_f1_score: 0.8561; train_kl_reg_loss: 1621.9553; train_edge_recon_loss: 94023.9785; train_gene_expr_recon_loss: 119203.9160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214849.8477; train_optim_loss: 214849.8477; val_kl_reg_loss: 2241.5000; val_edge_recon_loss: 92855.8438; val_gene_expr_recon_loss: 118512.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213609.4531; val_optim_loss: 213609.4531
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9129; val_auprc_score: 0.9019; val_best_acc_score: 0.8382; val_best_f1_score: 0.8488; train_kl_reg_loss: 2822.7326; train_edge_recon_loss: 91216.8984; train_gene_expr_recon_loss: 118538.5840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212578.2109; train_optim_loss: 212578.2109; val_kl_reg_loss: 3637.6084; val_edge_recon_loss: 89717.0547; val_gene_expr_recon_loss: 117715.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211069.7812; val_optim_loss: 211069.7812
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9111; val_auprc_score: 0.9005; val_best_acc_score: 0.8385; val_best_f1_score: 0.8479; train_kl_reg_loss: 4177.5649; train_edge_recon_loss: 87677.6562; train_gene_expr_recon_loss: 117715.2207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209570.4414; train_optim_loss: 209570.4414; val_kl_reg_loss: 4637.9209; val_edge_recon_loss: 86103.9141; val_gene_expr_recon_loss: 116642.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207383.9375; val_optim_loss: 207383.9375
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9161; val_auprc_score: 0.9069; val_best_acc_score: 0.8435; val_best_f1_score: 0.8512; train_kl_reg_loss: 4835.0463; train_edge_recon_loss: 86544.9355; train_gene_expr_recon_loss: 116562.2109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207942.1914; train_optim_loss: 207942.1914; val_kl_reg_loss: 4719.6514; val_edge_recon_loss: 83844.3672; val_gene_expr_recon_loss: 115420.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 203984.1562; val_optim_loss: 203984.1562
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9248; val_auprc_score: 0.9209; val_best_acc_score: 0.8485; val_best_f1_score: 0.8564; train_kl_reg_loss: 4703.7615; train_edge_recon_loss: 86613.9199; train_gene_expr_recon_loss: 115388.6816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206706.3633; train_optim_loss: 206706.3633; val_kl_reg_loss: 4323.6821; val_edge_recon_loss: 88100.7578; val_gene_expr_recon_loss: 114215.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206639.9688; val_optim_loss: 206639.9688
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9293; val_auprc_score: 0.9263; val_best_acc_score: 0.8504; val_best_f1_score: 0.8573; train_kl_reg_loss: 4307.4222; train_edge_recon_loss: 86283.8633; train_gene_expr_recon_loss: 114117.1016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204708.3867; train_optim_loss: 204708.3867; val_kl_reg_loss: 4054.2278; val_edge_recon_loss: 82574.6172; val_gene_expr_recon_loss: 113104.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 199733.1562; val_optim_loss: 199733.1562
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9320; val_auprc_score: 0.9301; val_best_acc_score: 0.8534; val_best_f1_score: 0.8597; train_kl_reg_loss: 4207.5918; train_edge_recon_loss: 86973.6367; train_gene_expr_recon_loss: 113065.1055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204246.3320; train_optim_loss: 204246.3320; val_kl_reg_loss: 4208.3955; val_edge_recon_loss: 87514.2734; val_gene_expr_recon_loss: 112170.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 203893.0000; val_optim_loss: 203893.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9335; val_auprc_score: 0.9306; val_best_acc_score: 0.8583; val_best_f1_score: 0.8618; train_kl_reg_loss: 4444.8195; train_edge_recon_loss: 85452.3105; train_gene_expr_recon_loss: 112168.8711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202066.0039; train_optim_loss: 202066.0039; val_kl_reg_loss: 4391.7002; val_edge_recon_loss: 87290.9922; val_gene_expr_recon_loss: 111407.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 203089.9062; val_optim_loss: 203089.9062
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9398; val_auprc_score: 0.9383; val_best_acc_score: 0.8671; val_best_f1_score: 0.8679; train_kl_reg_loss: 4513.7910; train_edge_recon_loss: 84596.4023; train_gene_expr_recon_loss: 111575.7246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200685.9180; train_optim_loss: 200685.9180; val_kl_reg_loss: 4353.6382; val_edge_recon_loss: 82079.0547; val_gene_expr_recon_loss: 110731.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197164.0938; val_optim_loss: 197164.0938
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9435; val_auprc_score: 0.9409; val_best_acc_score: 0.8711; val_best_f1_score: 0.8744; train_kl_reg_loss: 4503.7307; train_edge_recon_loss: 84087.5625; train_gene_expr_recon_loss: 110917.2559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199508.5508; train_optim_loss: 199508.5508; val_kl_reg_loss: 4347.8398; val_edge_recon_loss: 86523.3125; val_gene_expr_recon_loss: 109880.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200752.0938; val_optim_loss: 200752.0938
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9494; val_auprc_score: 0.9486; val_best_acc_score: 0.8802; val_best_f1_score: 0.8825; train_kl_reg_loss: 4473.1688; train_edge_recon_loss: 83677.3203; train_gene_expr_recon_loss: 109921.2949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198071.7812; train_optim_loss: 198071.7812; val_kl_reg_loss: 4280.9395; val_edge_recon_loss: 80760.4688; val_gene_expr_recon_loss: 109188.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194229.8750; val_optim_loss: 194229.8750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9476; val_auprc_score: 0.9457; val_best_acc_score: 0.8769; val_best_f1_score: 0.8801; train_kl_reg_loss: 4394.1666; train_edge_recon_loss: 83713.2695; train_gene_expr_recon_loss: 109369.7852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197477.2227; train_optim_loss: 197477.2227; val_kl_reg_loss: 4248.8359; val_edge_recon_loss: 82985.7031; val_gene_expr_recon_loss: 108411.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195646.3125; val_optim_loss: 195646.3125
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9524; val_auprc_score: 0.9486; val_best_acc_score: 0.8839; val_best_f1_score: 0.8859; train_kl_reg_loss: 4417.2738; train_edge_recon_loss: 82745.5449; train_gene_expr_recon_loss: 108553.8457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195716.6641; train_optim_loss: 195716.6641; val_kl_reg_loss: 4338.0830; val_edge_recon_loss: 83940.9531; val_gene_expr_recon_loss: 107574.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195853.1719; val_optim_loss: 195853.1719
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9560; val_auprc_score: 0.9518; val_best_acc_score: 0.8866; val_best_f1_score: 0.8896; train_kl_reg_loss: 4484.5702; train_edge_recon_loss: 82844.7070; train_gene_expr_recon_loss: 107705.1152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195034.3906; train_optim_loss: 195034.3906; val_kl_reg_loss: 4298.9321; val_edge_recon_loss: 82027.4062; val_gene_expr_recon_loss: 106875.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193201.8125; val_optim_loss: 193201.8125
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9611; val_auprc_score: 0.9598; val_best_acc_score: 0.8974; val_best_f1_score: 0.8978; train_kl_reg_loss: 4448.4016; train_edge_recon_loss: 83139.0938; train_gene_expr_recon_loss: 106965.5469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194553.0391; train_optim_loss: 194553.0391; val_kl_reg_loss: 4417.5176; val_edge_recon_loss: 82110.2969; val_gene_expr_recon_loss: 106281.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192808.8438; val_optim_loss: 192808.8438
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9628; val_auprc_score: 0.9606; val_best_acc_score: 0.9006; val_best_f1_score: 0.9017; train_kl_reg_loss: 4651.8954; train_edge_recon_loss: 81544.3652; train_gene_expr_recon_loss: 106188.2598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192384.5195; train_optim_loss: 192384.5195; val_kl_reg_loss: 4559.4780; val_edge_recon_loss: 80517.0859; val_gene_expr_recon_loss: 105441.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190517.5938; val_optim_loss: 190517.5938
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9657; val_auprc_score: 0.9652; val_best_acc_score: 0.9004; val_best_f1_score: 0.9018; train_kl_reg_loss: 4701.9434; train_edge_recon_loss: 82379.5117; train_gene_expr_recon_loss: 105502.0195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192583.4727; train_optim_loss: 192583.4727; val_kl_reg_loss: 4561.4668; val_edge_recon_loss: 82595.5312; val_gene_expr_recon_loss: 104726.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191883.7188; val_optim_loss: 191883.7188
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9675; val_auprc_score: 0.9658; val_best_acc_score: 0.9053; val_best_f1_score: 0.9068; train_kl_reg_loss: 4716.0677; train_edge_recon_loss: 82582.7480; train_gene_expr_recon_loss: 104888.9824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192187.7969; train_optim_loss: 192187.7969; val_kl_reg_loss: 4535.1655; val_edge_recon_loss: 82141.5234; val_gene_expr_recon_loss: 104216.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190892.8750; val_optim_loss: 190892.8750
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9655; val_auprc_score: 0.9618; val_best_acc_score: 0.9041; val_best_f1_score: 0.9048; train_kl_reg_loss: 4664.6554; train_edge_recon_loss: 80566.6426; train_gene_expr_recon_loss: 104303.4590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189534.7539; train_optim_loss: 189534.7539; val_kl_reg_loss: 4464.4932; val_edge_recon_loss: 82751.4688; val_gene_expr_recon_loss: 103552.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190768.2188; val_optim_loss: 190768.2188

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9679; val_auprc_score: 0.9650; val_best_acc_score: 0.9087; val_best_f1_score: 0.9101; train_kl_reg_loss: 4651.0323; train_edge_recon_loss: 83178.1152; train_gene_expr_recon_loss: 103747.8301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191576.9766; train_optim_loss: 191576.9766; val_kl_reg_loss: 4470.8364; val_edge_recon_loss: 80374.5703; val_gene_expr_recon_loss: 103537.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188382.5000; val_optim_loss: 188382.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9696; val_auprc_score: 0.9684; val_best_acc_score: 0.9080; val_best_f1_score: 0.9098; train_kl_reg_loss: 4661.3214; train_edge_recon_loss: 82315.6250; train_gene_expr_recon_loss: 103960.2109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190937.1562; train_optim_loss: 190937.1562; val_kl_reg_loss: 4484.1230; val_edge_recon_loss: 78992.4609; val_gene_expr_recon_loss: 103528.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187005.4062; val_optim_loss: 187005.4062
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9681; val_auprc_score: 0.9658; val_best_acc_score: 0.9058; val_best_f1_score: 0.9071; train_kl_reg_loss: 4678.4357; train_edge_recon_loss: 82043.5762; train_gene_expr_recon_loss: 103878.3945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190600.4023; train_optim_loss: 190600.4023; val_kl_reg_loss: 4497.1787; val_edge_recon_loss: 78198.8984; val_gene_expr_recon_loss: 103467.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186163.4375; val_optim_loss: 186163.4375
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9672; val_auprc_score: 0.9629; val_best_acc_score: 0.9084; val_best_f1_score: 0.9085; train_kl_reg_loss: 4706.9554; train_edge_recon_loss: 81887.5293; train_gene_expr_recon_loss: 103719.2695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190313.7539; train_optim_loss: 190313.7539; val_kl_reg_loss: 4517.1211; val_edge_recon_loss: 82864.1094; val_gene_expr_recon_loss: 103414.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190796.0000; val_optim_loss: 190796.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9669; val_auprc_score: 0.9640; val_best_acc_score: 0.9075; val_best_f1_score: 0.9083; train_kl_reg_loss: 4708.3024; train_edge_recon_loss: 80416.0605; train_gene_expr_recon_loss: 103771.9453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188896.3086; train_optim_loss: 188896.3086; val_kl_reg_loss: 4525.1934; val_edge_recon_loss: 86326.6328; val_gene_expr_recon_loss: 103347.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194199.5312; val_optim_loss: 194199.5312
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9704; val_auprc_score: 0.9694; val_best_acc_score: 0.9096; val_best_f1_score: 0.9107; train_kl_reg_loss: 4707.5660; train_edge_recon_loss: 80061.4062; train_gene_expr_recon_loss: 103646.3223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188415.3008; train_optim_loss: 188415.3008; val_kl_reg_loss: 4504.2295; val_edge_recon_loss: 82307.5625; val_gene_expr_recon_loss: 103278.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190089.8750; val_optim_loss: 190089.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9702; val_auprc_score: 0.9691; val_best_acc_score: 0.9107; val_best_f1_score: 0.9116; train_kl_reg_loss: 4699.0526; train_edge_recon_loss: 81715.9062; train_gene_expr_recon_loss: 103548.6445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189963.6016; train_optim_loss: 189963.6016; val_kl_reg_loss: 4509.3809; val_edge_recon_loss: 83120.9922; val_gene_expr_recon_loss: 103273.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190903.5938; val_optim_loss: 190903.5938
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9692; val_auprc_score: 0.9676; val_best_acc_score: 0.9093; val_best_f1_score: 0.9106; train_kl_reg_loss: 4692.0388; train_edge_recon_loss: 82258.1680; train_gene_expr_recon_loss: 103560.7246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190510.9336; train_optim_loss: 190510.9336; val_kl_reg_loss: 4492.4619; val_edge_recon_loss: 80855.1328; val_gene_expr_recon_loss: 103271.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188618.7812; val_optim_loss: 188618.7812
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9696; val_auprc_score: 0.9690; val_best_acc_score: 0.9083; val_best_f1_score: 0.9090; train_kl_reg_loss: 4695.3468; train_edge_recon_loss: 80342.5469; train_gene_expr_recon_loss: 103476.8535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188514.7461; train_optim_loss: 188514.7461; val_kl_reg_loss: 4493.8950; val_edge_recon_loss: 84327.4453; val_gene_expr_recon_loss: 103268.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192089.8750; val_optim_loss: 192089.8750

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 16 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
Val AUROC score: 0.9696
Val AUPRC score: 0.9693
Val best accuracy score: 0.9076
Val best F1 score: 0.9078
Val gene expr MSE score: 1.6111
Duration of model training in run 1: 0 hours, 2 minutes and 22 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 54907
Number of validation edges: 6100
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9737; val_auprc_score: 0.9748; val_best_acc_score: 0.9133; val_best_f1_score: 0.9095; train_kl_reg_loss: 104.5764; train_edge_recon_loss: 102543.1719; train_gene_expr_recon_loss: 132298.9961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 234946.7383; train_optim_loss: 234946.7383; val_kl_reg_loss: 258.9329; val_edge_recon_loss: 116347.2969; val_gene_expr_recon_loss: 130596.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 247202.8438; val_optim_loss: 247202.8438
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9742; val_auprc_score: 0.9746; val_best_acc_score: 0.8778; val_best_f1_score: 0.8886; train_kl_reg_loss: 355.2361; train_edge_recon_loss: 101693.7188; train_gene_expr_recon_loss: 129350.7363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 231399.6914; train_optim_loss: 231399.6914; val_kl_reg_loss: 462.1696; val_edge_recon_loss: 118076.5469; val_gene_expr_recon_loss: 127745.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246284.1250; val_optim_loss: 246284.1250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9687; val_auprc_score: 0.9691; val_best_acc_score: 0.8777; val_best_f1_score: 0.8880; train_kl_reg_loss: 517.2843; train_edge_recon_loss: 103517.8867; train_gene_expr_recon_loss: 126834.6074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 230869.7812; train_optim_loss: 230869.7812; val_kl_reg_loss: 577.6860; val_edge_recon_loss: 117617.6406; val_gene_expr_recon_loss: 125133.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243328.4688; val_optim_loss: 243328.4688
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9657; val_auprc_score: 0.9659; val_best_acc_score: 0.8825; val_best_f1_score: 0.8898; train_kl_reg_loss: 693.1380; train_edge_recon_loss: 102048.3633; train_gene_expr_recon_loss: 124412.4570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227153.9609; train_optim_loss: 227153.9609; val_kl_reg_loss: 860.4413; val_edge_recon_loss: 115032.7812; val_gene_expr_recon_loss: 122462.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238355.7500; val_optim_loss: 238355.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9562; val_auprc_score: 0.9539; val_best_acc_score: 0.8818; val_best_f1_score: 0.8841; train_kl_reg_loss: 954.0405; train_edge_recon_loss: 101688.4902; train_gene_expr_recon_loss: 121755.7168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224398.2461; train_optim_loss: 224398.2461; val_kl_reg_loss: 985.9358; val_edge_recon_loss: 114057.6016; val_gene_expr_recon_loss: 120079.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 235123.1562; val_optim_loss: 235123.1562
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9444; val_auprc_score: 0.9401; val_best_acc_score: 0.8664; val_best_f1_score: 0.8713; train_kl_reg_loss: 1034.7515; train_edge_recon_loss: 100220.1738; train_gene_expr_recon_loss: 119704.3047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220959.2344; train_optim_loss: 220959.2344; val_kl_reg_loss: 1058.4531; val_edge_recon_loss: 101203.1016; val_gene_expr_recon_loss: 118672.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220933.6250; val_optim_loss: 220933.6250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9262; val_auprc_score: 0.9148; val_best_acc_score: 0.8510; val_best_f1_score: 0.8598; train_kl_reg_loss: 1191.6385; train_edge_recon_loss: 98103.6113; train_gene_expr_recon_loss: 118644.7031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217939.9531; train_optim_loss: 217939.9531; val_kl_reg_loss: 1433.1841; val_edge_recon_loss: 98537.2969; val_gene_expr_recon_loss: 117828.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217798.6250; val_optim_loss: 217798.6250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9102; val_auprc_score: 0.8983; val_best_acc_score: 0.8353; val_best_f1_score: 0.8454; train_kl_reg_loss: 1818.8792; train_edge_recon_loss: 93763.8477; train_gene_expr_recon_loss: 117567.9746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213150.6992; train_optim_loss: 213150.6992; val_kl_reg_loss: 2474.6272; val_edge_recon_loss: 92403.2109; val_gene_expr_recon_loss: 117071.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211948.8750; val_optim_loss: 211948.8750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8997; val_auprc_score: 0.8842; val_best_acc_score: 0.8266; val_best_f1_score: 0.8394; train_kl_reg_loss: 3076.3615; train_edge_recon_loss: 90555.1055; train_gene_expr_recon_loss: 116669.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210301.4062; train_optim_loss: 210301.4062; val_kl_reg_loss: 3845.4639; val_edge_recon_loss: 88068.2109; val_gene_expr_recon_loss: 116356.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208270.0938; val_optim_loss: 208270.0938
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9058; val_auprc_score: 0.8962; val_best_acc_score: 0.8315; val_best_f1_score: 0.8418; train_kl_reg_loss: 4271.7889; train_edge_recon_loss: 87500.8535; train_gene_expr_recon_loss: 115899.9746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207672.6172; train_optim_loss: 207672.6172; val_kl_reg_loss: 4532.0293; val_edge_recon_loss: 90010.0234; val_gene_expr_recon_loss: 115240.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209782.3438; val_optim_loss: 209782.3438
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9102; val_auprc_score: 0.9036; val_best_acc_score: 0.8322; val_best_f1_score: 0.8446; train_kl_reg_loss: 4725.6013; train_edge_recon_loss: 87700.0527; train_gene_expr_recon_loss: 114611.6992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207037.3516; train_optim_loss: 207037.3516; val_kl_reg_loss: 4621.7588; val_edge_recon_loss: 86543.6328; val_gene_expr_recon_loss: 113861.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205027.1406; val_optim_loss: 205027.1406
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9139; val_auprc_score: 0.9088; val_best_acc_score: 0.8396; val_best_f1_score: 0.8466; train_kl_reg_loss: 4638.9504; train_edge_recon_loss: 85561.4961; train_gene_expr_recon_loss: 113427.4277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203627.8711; train_optim_loss: 203627.8711; val_kl_reg_loss: 4352.8037; val_edge_recon_loss: 86997.7734; val_gene_expr_recon_loss: 112708.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204059.4844; val_optim_loss: 204059.4844
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9217; val_auprc_score: 0.9199; val_best_acc_score: 0.8419; val_best_f1_score: 0.8490; train_kl_reg_loss: 4401.1881; train_edge_recon_loss: 85667.8438; train_gene_expr_recon_loss: 112204.4805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202273.5078; train_optim_loss: 202273.5078; val_kl_reg_loss: 4300.6587; val_edge_recon_loss: 84562.4062; val_gene_expr_recon_loss: 111560.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200423.6875; val_optim_loss: 200423.6875
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9241; val_auprc_score: 0.9224; val_best_acc_score: 0.8439; val_best_f1_score: 0.8504; train_kl_reg_loss: 4463.7751; train_edge_recon_loss: 86066.4590; train_gene_expr_recon_loss: 111256.0273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201786.2656; train_optim_loss: 201786.2656; val_kl_reg_loss: 4421.0986; val_edge_recon_loss: 85294.0625; val_gene_expr_recon_loss: 110669.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200384.4375; val_optim_loss: 200384.4375
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9289; val_auprc_score: 0.9287; val_best_acc_score: 0.8501; val_best_f1_score: 0.8543; train_kl_reg_loss: 4510.2578; train_edge_recon_loss: 85013.5039; train_gene_expr_recon_loss: 110382.3496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199906.1094; train_optim_loss: 199906.1094; val_kl_reg_loss: 4398.0654; val_edge_recon_loss: 83922.4609; val_gene_expr_recon_loss: 109863.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198184.1562; val_optim_loss: 198184.1562
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9310; val_auprc_score: 0.9303; val_best_acc_score: 0.8540; val_best_f1_score: 0.8574; train_kl_reg_loss: 4504.9270; train_edge_recon_loss: 83455.1855; train_gene_expr_recon_loss: 109744.6035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197704.7148; train_optim_loss: 197704.7148; val_kl_reg_loss: 4357.4741; val_edge_recon_loss: 85141.7578; val_gene_expr_recon_loss: 109080.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198579.8281; val_optim_loss: 198579.8281
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9356; val_auprc_score: 0.9351; val_best_acc_score: 0.8590; val_best_f1_score: 0.8626; train_kl_reg_loss: 4421.2760; train_edge_recon_loss: 83668.8125; train_gene_expr_recon_loss: 108869.3398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196959.4219; train_optim_loss: 196959.4219; val_kl_reg_loss: 4205.1162; val_edge_recon_loss: 82134.7266; val_gene_expr_recon_loss: 108386.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194726.4688; val_optim_loss: 194726.4688
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9401; val_auprc_score: 0.9398; val_best_acc_score: 0.8652; val_best_f1_score: 0.8690; train_kl_reg_loss: 4248.7151; train_edge_recon_loss: 84986.1504; train_gene_expr_recon_loss: 108011.1699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197246.0391; train_optim_loss: 197246.0391; val_kl_reg_loss: 4159.8140; val_edge_recon_loss: 87576.5938; val_gene_expr_recon_loss: 107607.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 199343.4531; val_optim_loss: 199343.4531
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9439; val_auprc_score: 0.9412; val_best_acc_score: 0.8719; val_best_f1_score: 0.8748; train_kl_reg_loss: 4333.4827; train_edge_recon_loss: 81842.8750; train_gene_expr_recon_loss: 107323.9961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193500.3555; train_optim_loss: 193500.3555; val_kl_reg_loss: 4332.2910; val_edge_recon_loss: 79546.2031; val_gene_expr_recon_loss: 106966.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190845.3125; val_optim_loss: 190845.3125
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9486; val_auprc_score: 0.9483; val_best_acc_score: 0.8748; val_best_f1_score: 0.8776; train_kl_reg_loss: 4438.8408; train_edge_recon_loss: 83017.1406; train_gene_expr_recon_loss: 106660.5840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194116.5625; train_optim_loss: 194116.5625; val_kl_reg_loss: 4267.1035; val_edge_recon_loss: 81554.7500; val_gene_expr_recon_loss: 106174.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191996.4688; val_optim_loss: 191996.4688
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9520; val_auprc_score: 0.9510; val_best_acc_score: 0.8806; val_best_f1_score: 0.8833; train_kl_reg_loss: 4343.7825; train_edge_recon_loss: 84140.5410; train_gene_expr_recon_loss: 106014.8926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194499.2148; train_optim_loss: 194499.2148; val_kl_reg_loss: 4224.5732; val_edge_recon_loss: 85850.7031; val_gene_expr_recon_loss: 105577.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195653.1562; val_optim_loss: 195653.1562
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9543; val_auprc_score: 0.9530; val_best_acc_score: 0.8853; val_best_f1_score: 0.8877; train_kl_reg_loss: 4331.0264; train_edge_recon_loss: 83927.9824; train_gene_expr_recon_loss: 105436.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193695.4688; train_optim_loss: 193695.4688; val_kl_reg_loss: 4253.9756; val_edge_recon_loss: 87068.7734; val_gene_expr_recon_loss: 104899.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196222.6875; val_optim_loss: 196222.6875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9572; val_auprc_score: 0.9519; val_best_acc_score: 0.8890; val_best_f1_score: 0.8911; train_kl_reg_loss: 4354.4592; train_edge_recon_loss: 82613.3496; train_gene_expr_recon_loss: 105049.4219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192017.2344; train_optim_loss: 192017.2344; val_kl_reg_loss: 4260.0742; val_edge_recon_loss: 82220.1641; val_gene_expr_recon_loss: 104818.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191298.5312; val_optim_loss: 191298.5312
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9574; val_auprc_score: 0.9569; val_best_acc_score: 0.8865; val_best_f1_score: 0.8897; train_kl_reg_loss: 4370.0112; train_edge_recon_loss: 82089.1621; train_gene_expr_recon_loss: 104904.9824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191364.1602; train_optim_loss: 191364.1602; val_kl_reg_loss: 4282.7812; val_edge_recon_loss: 86146.3984; val_gene_expr_recon_loss: 104733.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195162.5000; val_optim_loss: 195162.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9569; val_auprc_score: 0.9559; val_best_acc_score: 0.8882; val_best_f1_score: 0.8911; train_kl_reg_loss: 4388.0494; train_edge_recon_loss: 82818.9805; train_gene_expr_recon_loss: 104754.9727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191962.0039; train_optim_loss: 191962.0039; val_kl_reg_loss: 4299.8384; val_edge_recon_loss: 85662.8438; val_gene_expr_recon_loss: 104688.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194651.2500; val_optim_loss: 194651.2500

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 34 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9447
Val AUPRC score: 0.9454
Val best accuracy score: 0.8686
Val best F1 score: 0.8726
Val gene expr MSE score: 1.7528
Duration of model training in run 2: 0 hours, 1 minutes and 37 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 107073
Number of validation edges: 11897
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9925; val_auprc_score: 0.9921; val_best_acc_score: 0.8159; val_best_f1_score: 0.8386; train_kl_reg_loss: 212.1101; train_edge_recon_loss: 102838.4710; train_gene_expr_recon_loss: 130808.0792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 233858.6607; train_optim_loss: 233858.6607; val_kl_reg_loss: 455.3358; val_edge_recon_loss: 118879.3125; val_gene_expr_recon_loss: 126715.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246050.0000; val_optim_loss: 246050.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9842; val_auprc_score: 0.9842; val_best_acc_score: 0.8760; val_best_f1_score: 0.8887; train_kl_reg_loss: 509.5386; train_edge_recon_loss: 101584.1975; train_gene_expr_recon_loss: 126603.9520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228697.6853; train_optim_loss: 228697.6853; val_kl_reg_loss: 674.4869; val_edge_recon_loss: 115512.6797; val_gene_expr_recon_loss: 122879.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 239066.4375; val_optim_loss: 239066.4375
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9672; val_auprc_score: 0.9669; val_best_acc_score: 0.8950; val_best_f1_score: 0.8989; train_kl_reg_loss: 829.9018; train_edge_recon_loss: 102146.7478; train_gene_expr_recon_loss: 122786.2768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 225762.9286; train_optim_loss: 225762.9286; val_kl_reg_loss: 920.2454; val_edge_recon_loss: 111864.8281; val_gene_expr_recon_loss: 119484.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 232269.3125; val_optim_loss: 232269.3125
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9398; val_auprc_score: 0.9361; val_best_acc_score: 0.8631; val_best_f1_score: 0.8704; train_kl_reg_loss: 1063.3905; train_edge_recon_loss: 98059.9777; train_gene_expr_recon_loss: 120085.7310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219209.0982; train_optim_loss: 219209.0982; val_kl_reg_loss: 1449.0383; val_edge_recon_loss: 94360.7969; val_gene_expr_recon_loss: 118127.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213937.2188; val_optim_loss: 213937.2188
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9174; val_auprc_score: 0.9104; val_best_acc_score: 0.8409; val_best_f1_score: 0.8509; train_kl_reg_loss: 2261.4452; train_edge_recon_loss: 92877.1462; train_gene_expr_recon_loss: 118965.0123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214103.6004; train_optim_loss: 214103.6004; val_kl_reg_loss: 3408.7080; val_edge_recon_loss: 86212.8359; val_gene_expr_recon_loss: 117165.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206786.8750; val_optim_loss: 206786.8750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9272; val_auprc_score: 0.9220; val_best_acc_score: 0.8510; val_best_f1_score: 0.8575; train_kl_reg_loss: 4115.2392; train_edge_recon_loss: 87845.3359; train_gene_expr_recon_loss: 117387.4699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209348.0446; train_optim_loss: 209348.0446; val_kl_reg_loss: 4381.7832; val_edge_recon_loss: 83467.1797; val_gene_expr_recon_loss: 115233.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 203082.2344; val_optim_loss: 203082.2344
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9359; val_auprc_score: 0.9334; val_best_acc_score: 0.8585; val_best_f1_score: 0.8634; train_kl_reg_loss: 4341.9515; train_edge_recon_loss: 86333.2701; train_gene_expr_recon_loss: 115283.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205958.6228; train_optim_loss: 205958.6228; val_kl_reg_loss: 4020.5049; val_edge_recon_loss: 83422.1094; val_gene_expr_recon_loss: 113114.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200557.1719; val_optim_loss: 200557.1719
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9396; val_auprc_score: 0.9395; val_best_acc_score: 0.8612; val_best_f1_score: 0.8655; train_kl_reg_loss: 4263.8717; train_edge_recon_loss: 84955.7433; train_gene_expr_recon_loss: 113299.4509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202519.0670; train_optim_loss: 202519.0670; val_kl_reg_loss: 4296.8418; val_edge_recon_loss: 85149.3281; val_gene_expr_recon_loss: 111453.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200899.3906; val_optim_loss: 200899.3906
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9449; val_auprc_score: 0.9446; val_best_acc_score: 0.8698; val_best_f1_score: 0.8722; train_kl_reg_loss: 4441.9616; train_edge_recon_loss: 84908.5145; train_gene_expr_recon_loss: 111992.4688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201342.9464; train_optim_loss: 201342.9464; val_kl_reg_loss: 4290.6475; val_edge_recon_loss: 83243.1172; val_gene_expr_recon_loss: 110221.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197755.3125; val_optim_loss: 197755.3125
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9526; val_auprc_score: 0.9537; val_best_acc_score: 0.8797; val_best_f1_score: 0.8812; train_kl_reg_loss: 4415.1117; train_edge_recon_loss: 84974.1228; train_gene_expr_recon_loss: 110610.4319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199999.6696; train_optim_loss: 199999.6696; val_kl_reg_loss: 4272.3926; val_edge_recon_loss: 83008.3203; val_gene_expr_recon_loss: 108948.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196229.1250; val_optim_loss: 196229.1250
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9578; val_auprc_score: 0.9590; val_best_acc_score: 0.8876; val_best_f1_score: 0.8883; train_kl_reg_loss: 4354.5402; train_edge_recon_loss: 83809.4453; train_gene_expr_recon_loss: 109331.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197495.1384; train_optim_loss: 197495.1384; val_kl_reg_loss: 4185.9209; val_edge_recon_loss: 83768.6250; val_gene_expr_recon_loss: 107650.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195605.3438; val_optim_loss: 195605.3438
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9634; val_auprc_score: 0.9639; val_best_acc_score: 0.8985; val_best_f1_score: 0.8984; train_kl_reg_loss: 4405.6271; train_edge_recon_loss: 82893.5636; train_gene_expr_recon_loss: 108081.9196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195381.1049; train_optim_loss: 195381.1049; val_kl_reg_loss: 4329.4531; val_edge_recon_loss: 82146.8281; val_gene_expr_recon_loss: 106397.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192873.3125; val_optim_loss: 192873.3125
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9692; val_auprc_score: 0.9688; val_best_acc_score: 0.9082; val_best_f1_score: 0.9096; train_kl_reg_loss: 4386.2309; train_edge_recon_loss: 82720.4319; train_gene_expr_recon_loss: 106648.4163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193755.0826; train_optim_loss: 193755.0826; val_kl_reg_loss: 4327.2314; val_edge_recon_loss: 83010.2344; val_gene_expr_recon_loss: 105329.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192667.1250; val_optim_loss: 192667.1250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9729; val_auprc_score: 0.9723; val_best_acc_score: 0.9131; val_best_f1_score: 0.9139; train_kl_reg_loss: 4526.9653; train_edge_recon_loss: 82735.7109; train_gene_expr_recon_loss: 105799.3705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193062.0446; train_optim_loss: 193062.0446; val_kl_reg_loss: 4360.6709; val_edge_recon_loss: 80654.6719; val_gene_expr_recon_loss: 104331.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189346.7500; val_optim_loss: 189346.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9775; val_auprc_score: 0.9765; val_best_acc_score: 0.9217; val_best_f1_score: 0.9224; train_kl_reg_loss: 4430.4213; train_edge_recon_loss: 81332.3460; train_gene_expr_recon_loss: 104782.2299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190544.9955; train_optim_loss: 190544.9955; val_kl_reg_loss: 4399.0254; val_edge_recon_loss: 78989.2969; val_gene_expr_recon_loss: 103305.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186693.4219; val_optim_loss: 186693.4219
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9800; val_auprc_score: 0.9787; val_best_acc_score: 0.9274; val_best_f1_score: 0.9276; train_kl_reg_loss: 4541.3093; train_edge_recon_loss: 82629.5379; train_gene_expr_recon_loss: 103885.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191056.1295; train_optim_loss: 191056.1295; val_kl_reg_loss: 4448.0498; val_edge_recon_loss: 82038.0078; val_gene_expr_recon_loss: 102598.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189084.3438; val_optim_loss: 189084.3438
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9826; val_auprc_score: 0.9816; val_best_acc_score: 0.9313; val_best_f1_score: 0.9312; train_kl_reg_loss: 4570.2589; train_edge_recon_loss: 81384.6931; train_gene_expr_recon_loss: 103114.5882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189069.5424; train_optim_loss: 189069.5424; val_kl_reg_loss: 4453.5801; val_edge_recon_loss: 81175.7109; val_gene_expr_recon_loss: 101751.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187381.0781; val_optim_loss: 187381.0781
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9847; val_auprc_score: 0.9835; val_best_acc_score: 0.9382; val_best_f1_score: 0.9385; train_kl_reg_loss: 4588.8172; train_edge_recon_loss: 80631.2489; train_gene_expr_recon_loss: 102294.9498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187515.0179; train_optim_loss: 187515.0179; val_kl_reg_loss: 4467.7920; val_edge_recon_loss: 82077.0625; val_gene_expr_recon_loss: 101160.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187704.9062; val_optim_loss: 187704.9062

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9841; val_auprc_score: 0.9830; val_best_acc_score: 0.9360; val_best_f1_score: 0.9366; train_kl_reg_loss: 4580.8371; train_edge_recon_loss: 81281.7511; train_gene_expr_recon_loss: 102005.6116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187868.2009; train_optim_loss: 187868.2009; val_kl_reg_loss: 4444.9336; val_edge_recon_loss: 80172.9531; val_gene_expr_recon_loss: 101133.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185751.1250; val_optim_loss: 185751.1250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9848; val_auprc_score: 0.9832; val_best_acc_score: 0.9373; val_best_f1_score: 0.9379; train_kl_reg_loss: 4572.9600; train_edge_recon_loss: 80617.3482; train_gene_expr_recon_loss: 101903.9911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187094.2991; train_optim_loss: 187094.2991; val_kl_reg_loss: 4450.2358; val_edge_recon_loss: 79522.1484; val_gene_expr_recon_loss: 101045.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185018.0156; val_optim_loss: 185018.0156
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9851; val_auprc_score: 0.9842; val_best_acc_score: 0.9390; val_best_f1_score: 0.9391; train_kl_reg_loss: 4583.1974; train_edge_recon_loss: 80907.4855; train_gene_expr_recon_loss: 101912.0525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187402.7388; train_optim_loss: 187402.7388; val_kl_reg_loss: 4458.8105; val_edge_recon_loss: 77337.6797; val_gene_expr_recon_loss: 100984.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182781.0000; val_optim_loss: 182781.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9849; val_auprc_score: 0.9841; val_best_acc_score: 0.9387; val_best_f1_score: 0.9398; train_kl_reg_loss: 4586.8491; train_edge_recon_loss: 80314.7891; train_gene_expr_recon_loss: 101808.2489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186709.8839; train_optim_loss: 186709.8839; val_kl_reg_loss: 4456.9209; val_edge_recon_loss: 78893.3828; val_gene_expr_recon_loss: 100920.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184270.7188; val_optim_loss: 184270.7188
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9842; val_auprc_score: 0.9826; val_best_acc_score: 0.9365; val_best_f1_score: 0.9373; train_kl_reg_loss: 4583.1351; train_edge_recon_loss: 80648.4844; train_gene_expr_recon_loss: 101815.2109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187046.8326; train_optim_loss: 187046.8326; val_kl_reg_loss: 4433.9229; val_edge_recon_loss: 81313.9062; val_gene_expr_recon_loss: 100858.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186605.9531; val_optim_loss: 186605.9531
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9847; val_auprc_score: 0.9831; val_best_acc_score: 0.9370; val_best_f1_score: 0.9375; train_kl_reg_loss: 4568.5086; train_edge_recon_loss: 80578.7645; train_gene_expr_recon_loss: 101557.8895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186705.1629; train_optim_loss: 186705.1629; val_kl_reg_loss: 4444.9668; val_edge_recon_loss: 81049.1797; val_gene_expr_recon_loss: 100790.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186284.6875; val_optim_loss: 186284.6875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9856; val_auprc_score: 0.9853; val_best_acc_score: 0.9386; val_best_f1_score: 0.9391; train_kl_reg_loss: 4576.1401; train_edge_recon_loss: 80898.2812; train_gene_expr_recon_loss: 101579.8650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187054.2857; train_optim_loss: 187054.2857; val_kl_reg_loss: 4451.6440; val_edge_recon_loss: 80544.3828; val_gene_expr_recon_loss: 100786.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185782.1875; val_optim_loss: 185782.1875
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9850; val_auprc_score: 0.9842; val_best_acc_score: 0.9371; val_best_f1_score: 0.9379; train_kl_reg_loss: 4572.4184; train_edge_recon_loss: 81467.6518; train_gene_expr_recon_loss: 101511.2846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187551.3549; train_optim_loss: 187551.3549; val_kl_reg_loss: 4412.2656; val_edge_recon_loss: 78619.7891; val_gene_expr_recon_loss: 100788.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183820.6250; val_optim_loss: 183820.6250
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9849; val_auprc_score: 0.9832; val_best_acc_score: 0.9387; val_best_f1_score: 0.9385; train_kl_reg_loss: 4574.7298; train_edge_recon_loss: 80263.9308; train_gene_expr_recon_loss: 101717.8783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186556.5424; train_optim_loss: 186556.5424; val_kl_reg_loss: 4422.6162; val_edge_recon_loss: 77279.5703; val_gene_expr_recon_loss: 100789.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182491.5312; val_optim_loss: 182491.5312
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9859; val_auprc_score: 0.9851; val_best_acc_score: 0.9399; val_best_f1_score: 0.9405; train_kl_reg_loss: 4580.3055; train_edge_recon_loss: 81257.7210; train_gene_expr_recon_loss: 101603.5301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187441.5558; train_optim_loss: 187441.5558; val_kl_reg_loss: 4421.5840; val_edge_recon_loss: 78389.3750; val_gene_expr_recon_loss: 100788.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183599.1250; val_optim_loss: 183599.1250
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9854; val_auprc_score: 0.9842; val_best_acc_score: 0.9392; val_best_f1_score: 0.9398; train_kl_reg_loss: 4579.9088; train_edge_recon_loss: 80046.9342; train_gene_expr_recon_loss: 101623.7746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186250.6183; train_optim_loss: 186250.6183; val_kl_reg_loss: 4420.2051; val_edge_recon_loss: 79266.9688; val_gene_expr_recon_loss: 100783.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184471.0938; val_optim_loss: 184471.0938
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9849; val_auprc_score: 0.9836; val_best_acc_score: 0.9381; val_best_f1_score: 0.9387; train_kl_reg_loss: 4579.7203; train_edge_recon_loss: 80677.1373; train_gene_expr_recon_loss: 101603.0993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186859.9554; train_optim_loss: 186859.9554; val_kl_reg_loss: 4413.6353; val_edge_recon_loss: 83806.7812; val_gene_expr_recon_loss: 100781.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189001.8750; val_optim_loss: 189001.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9854; val_auprc_score: 0.9847; val_best_acc_score: 0.9393; val_best_f1_score: 0.9400; train_kl_reg_loss: 4577.6980; train_edge_recon_loss: 80809.4788; train_gene_expr_recon_loss: 101630.7879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187017.9621; train_optim_loss: 187017.9621; val_kl_reg_loss: 4420.1274; val_edge_recon_loss: 78615.1875; val_gene_expr_recon_loss: 100781.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183816.6562; val_optim_loss: 183816.6562
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9847; val_auprc_score: 0.9839; val_best_acc_score: 0.9373; val_best_f1_score: 0.9380; train_kl_reg_loss: 4573.7389; train_edge_recon_loss: 80365.8025; train_gene_expr_recon_loss: 101524.9654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186464.5089; train_optim_loss: 186464.5089; val_kl_reg_loss: 4413.0127; val_edge_recon_loss: 78959.1797; val_gene_expr_recon_loss: 100780.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184153.1250; val_optim_loss: 184153.1250
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9854; val_auprc_score: 0.9842; val_best_acc_score: 0.9416; val_best_f1_score: 0.9424; train_kl_reg_loss: 4579.3588; train_edge_recon_loss: 81307.4542; train_gene_expr_recon_loss: 101628.6674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187515.4754; train_optim_loss: 187515.4754; val_kl_reg_loss: 4416.6084; val_edge_recon_loss: 80198.5469; val_gene_expr_recon_loss: 100780.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185395.5156; val_optim_loss: 185395.5156

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 6 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
Val AUROC score: 0.9844
Val AUPRC score: 0.9832
Val best accuracy score: 0.9365
Val best F1 score: 0.9375
Val gene expr MSE score: 1.4558
Duration of model training in run 3: 0 hours, 4 minutes and 12 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 107073
Number of validation edges: 11897
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9927; val_auprc_score: 0.9923; val_best_acc_score: 0.8056; val_best_f1_score: 0.8321; train_kl_reg_loss: 190.8290; train_edge_recon_loss: 102221.6150; train_gene_expr_recon_loss: 138190.4129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240602.8594; train_optim_loss: 240602.8594; val_kl_reg_loss: 423.7154; val_edge_recon_loss: 122482.5547; val_gene_expr_recon_loss: 134286.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 257193.2188; val_optim_loss: 257193.2188
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9871; val_auprc_score: 0.9851; val_best_acc_score: 0.8760; val_best_f1_score: 0.8595; train_kl_reg_loss: 530.1786; train_edge_recon_loss: 101671.9766; train_gene_expr_recon_loss: 132659.5993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 234861.7567; train_optim_loss: 234861.7567; val_kl_reg_loss: 680.5594; val_edge_recon_loss: 116651.1016; val_gene_expr_recon_loss: 129343.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246675.4062; val_optim_loss: 246675.4062
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9753; val_auprc_score: 0.9753; val_best_acc_score: 0.8824; val_best_f1_score: 0.8925; train_kl_reg_loss: 938.5604; train_edge_recon_loss: 102512.5748; train_gene_expr_recon_loss: 128168.8147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 231619.9509; train_optim_loss: 231619.9509; val_kl_reg_loss: 1001.6963; val_edge_recon_loss: 115531.1641; val_gene_expr_recon_loss: 124790.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241323.0938; val_optim_loss: 241323.0938
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9555; val_auprc_score: 0.9527; val_best_acc_score: 0.8818; val_best_f1_score: 0.8856; train_kl_reg_loss: 1010.2524; train_edge_recon_loss: 100713.1261; train_gene_expr_recon_loss: 124460.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226183.6183; train_optim_loss: 226183.6183; val_kl_reg_loss: 1115.1588; val_edge_recon_loss: 100930.8750; val_gene_expr_recon_loss: 122108.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224154.3906; val_optim_loss: 224154.3906
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9283; val_auprc_score: 0.9224; val_best_acc_score: 0.8507; val_best_f1_score: 0.8584; train_kl_reg_loss: 1486.8712; train_edge_recon_loss: 97024.7846; train_gene_expr_recon_loss: 122211.4509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220723.1071; train_optim_loss: 220723.1071; val_kl_reg_loss: 2188.9731; val_edge_recon_loss: 90283.5391; val_gene_expr_recon_loss: 120570.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213043.4375; val_optim_loss: 213043.4375
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9211; val_auprc_score: 0.9142; val_best_acc_score: 0.8460; val_best_f1_score: 0.8554; train_kl_reg_loss: 3111.1922; train_edge_recon_loss: 90588.1272; train_gene_expr_recon_loss: 120305.7076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214005.0246; train_optim_loss: 214005.0246; val_kl_reg_loss: 4150.7871; val_edge_recon_loss: 84850.2109; val_gene_expr_recon_loss: 118662.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207663.4062; val_optim_loss: 207663.4062
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9279; val_auprc_score: 0.9231; val_best_acc_score: 0.8507; val_best_f1_score: 0.8580; train_kl_reg_loss: 4528.1911; train_edge_recon_loss: 87120.0703; train_gene_expr_recon_loss: 118201.9598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209850.2232; train_optim_loss: 209850.2232; val_kl_reg_loss: 4442.5093; val_edge_recon_loss: 85221.4375; val_gene_expr_recon_loss: 116386.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206050.4688; val_optim_loss: 206050.4688
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9338; val_auprc_score: 0.9326; val_best_acc_score: 0.8531; val_best_f1_score: 0.8590; train_kl_reg_loss: 4455.1436; train_edge_recon_loss: 86347.4431; train_gene_expr_recon_loss: 115972.2321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206774.8170; train_optim_loss: 206774.8170; val_kl_reg_loss: 4265.9561; val_edge_recon_loss: 83250.5469; val_gene_expr_recon_loss: 114132.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201648.5156; val_optim_loss: 201648.5156
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9387; val_auprc_score: 0.9384; val_best_acc_score: 0.8583; val_best_f1_score: 0.8640; train_kl_reg_loss: 4494.2214; train_edge_recon_loss: 85818.5056; train_gene_expr_recon_loss: 113981.0491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204293.7746; train_optim_loss: 204293.7746; val_kl_reg_loss: 4502.8223; val_edge_recon_loss: 87341.4297; val_gene_expr_recon_loss: 112243.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204087.9844; val_optim_loss: 204087.9844
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9479; val_auprc_score: 0.9479; val_best_acc_score: 0.8734; val_best_f1_score: 0.8759; train_kl_reg_loss: 4613.8476; train_edge_recon_loss: 83998.8772; train_gene_expr_recon_loss: 112200.2076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200812.9308; train_optim_loss: 200812.9308; val_kl_reg_loss: 4424.9980; val_edge_recon_loss: 83528.4297; val_gene_expr_recon_loss: 110609.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198563.0625; val_optim_loss: 198563.0625
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9560; val_auprc_score: 0.9560; val_best_acc_score: 0.8853; val_best_f1_score: 0.8863; train_kl_reg_loss: 4506.3847; train_edge_recon_loss: 83302.2779; train_gene_expr_recon_loss: 110449.1786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198257.8415; train_optim_loss: 198257.8415; val_kl_reg_loss: 4253.0986; val_edge_recon_loss: 83213.8594; val_gene_expr_recon_loss: 109096.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196563.4062; val_optim_loss: 196563.4062
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9606; val_auprc_score: 0.9598; val_best_acc_score: 0.8933; val_best_f1_score: 0.8943; train_kl_reg_loss: 4450.0139; train_edge_recon_loss: 83454.5871; train_gene_expr_recon_loss: 109065.7087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196970.3058; train_optim_loss: 196970.3058; val_kl_reg_loss: 4343.1553; val_edge_recon_loss: 83549.9922; val_gene_expr_recon_loss: 107666.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195559.7656; val_optim_loss: 195559.7656
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9683; val_auprc_score: 0.9683; val_best_acc_score: 0.9042; val_best_f1_score: 0.9053; train_kl_reg_loss: 4523.7800; train_edge_recon_loss: 83445.2656; train_gene_expr_recon_loss: 107728.0424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195697.0871; train_optim_loss: 195697.0871; val_kl_reg_loss: 4448.3018; val_edge_recon_loss: 80769.9062; val_gene_expr_recon_loss: 106313.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191531.5312; val_optim_loss: 191531.5312
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9713; val_auprc_score: 0.9702; val_best_acc_score: 0.9090; val_best_f1_score: 0.9108; train_kl_reg_loss: 4570.4337; train_edge_recon_loss: 81593.3114; train_gene_expr_recon_loss: 106487.0826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192650.8237; train_optim_loss: 192650.8237; val_kl_reg_loss: 4461.5420; val_edge_recon_loss: 85059.1484; val_gene_expr_recon_loss: 105023.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194544.4844; val_optim_loss: 194544.4844
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9752; val_auprc_score: 0.9727; val_best_acc_score: 0.9172; val_best_f1_score: 0.9185; train_kl_reg_loss: 4635.8521; train_edge_recon_loss: 81703.1585; train_gene_expr_recon_loss: 105302.5837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191641.5938; train_optim_loss: 191641.5938; val_kl_reg_loss: 4504.1895; val_edge_recon_loss: 81362.8438; val_gene_expr_recon_loss: 104037.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189904.4062; val_optim_loss: 189904.4062
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9799; val_auprc_score: 0.9791; val_best_acc_score: 0.9254; val_best_f1_score: 0.9256; train_kl_reg_loss: 4635.6667; train_edge_recon_loss: 82378.1328; train_gene_expr_recon_loss: 104278.6685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191292.4688; train_optim_loss: 191292.4688; val_kl_reg_loss: 4547.3291; val_edge_recon_loss: 76579.2422; val_gene_expr_recon_loss: 103147.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184273.9688; val_optim_loss: 184273.9688
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9811; val_auprc_score: 0.9797; val_best_acc_score: 0.9295; val_best_f1_score: 0.9294; train_kl_reg_loss: 4606.8428; train_edge_recon_loss: 81252.0491; train_gene_expr_recon_loss: 103377.7467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189236.6406; train_optim_loss: 189236.6406; val_kl_reg_loss: 4456.6221; val_edge_recon_loss: 80853.1641; val_gene_expr_recon_loss: 102311.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187621.0469; val_optim_loss: 187621.0469
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9845; val_auprc_score: 0.9831; val_best_acc_score: 0.9363; val_best_f1_score: 0.9369; train_kl_reg_loss: 4651.4563; train_edge_recon_loss: 81214.1886; train_gene_expr_recon_loss: 102664.0826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188529.7277; train_optim_loss: 188529.7277; val_kl_reg_loss: 4515.9922; val_edge_recon_loss: 80829.4453; val_gene_expr_recon_loss: 101631.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186977.2969; val_optim_loss: 186977.2969
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9858; val_auprc_score: 0.9855; val_best_acc_score: 0.9393; val_best_f1_score: 0.9393; train_kl_reg_loss: 4601.0339; train_edge_recon_loss: 81258.6250; train_gene_expr_recon_loss: 101995.4241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187855.0826; train_optim_loss: 187855.0826; val_kl_reg_loss: 4586.6680; val_edge_recon_loss: 79495.6797; val_gene_expr_recon_loss: 101006.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185088.9219; val_optim_loss: 185088.9219

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9850; val_auprc_score: 0.9839; val_best_acc_score: 0.9394; val_best_f1_score: 0.9395; train_kl_reg_loss: 4683.6664; train_edge_recon_loss: 80808.8984; train_gene_expr_recon_loss: 101685.4397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187178.0045; train_optim_loss: 187178.0045; val_kl_reg_loss: 4540.9785; val_edge_recon_loss: 80283.4375; val_gene_expr_recon_loss: 100922.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185747.3750; val_optim_loss: 185747.3750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9853; val_auprc_score: 0.9837; val_best_acc_score: 0.9389; val_best_f1_score: 0.9394; train_kl_reg_loss: 4637.8704; train_edge_recon_loss: 81045.2779; train_gene_expr_recon_loss: 101515.6272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187198.7723; train_optim_loss: 187198.7723; val_kl_reg_loss: 4504.2700; val_edge_recon_loss: 80359.7812; val_gene_expr_recon_loss: 100845.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185709.1250; val_optim_loss: 185709.1250
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9848; val_auprc_score: 0.9831; val_best_acc_score: 0.9387; val_best_f1_score: 0.9391; train_kl_reg_loss: 4607.9016; train_edge_recon_loss: 80513.1339; train_gene_expr_recon_loss: 101506.8884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186627.9219; train_optim_loss: 186627.9219; val_kl_reg_loss: 4484.4497; val_edge_recon_loss: 80979.4688; val_gene_expr_recon_loss: 100771.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186235.8438; val_optim_loss: 186235.8438

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 25 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
Val AUROC score: 0.9806
Val AUPRC score: 0.9796
Val best accuracy score: 0.9274
Val best F1 score: 0.9281
Val gene expr MSE score: 1.5561
Duration of model training in run 4: 0 hours, 2 minutes and 30 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 159885
Number of validation edges: 17764
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9932; val_auprc_score: 0.9930; val_best_acc_score: 0.9205; val_best_f1_score: 0.9142; train_kl_reg_loss: 255.2682; train_edge_recon_loss: 102535.8813; train_gene_expr_recon_loss: 136619.6906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 239410.8422; train_optim_loss: 239410.8422; val_kl_reg_loss: 460.3546; val_edge_recon_loss: 123565.1055; val_gene_expr_recon_loss: 131538.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 255563.6719; val_optim_loss: 255563.6719
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9784; val_auprc_score: 0.9782; val_best_acc_score: 0.8925; val_best_f1_score: 0.8824; train_kl_reg_loss: 804.1564; train_edge_recon_loss: 101926.0898; train_gene_expr_recon_loss: 129982.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 232712.5828; train_optim_loss: 232712.5828; val_kl_reg_loss: 1160.6473; val_edge_recon_loss: 115304.7617; val_gene_expr_recon_loss: 124703.3320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241168.7422; val_optim_loss: 241168.7422
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9506; val_auprc_score: 0.9489; val_best_acc_score: 0.8781; val_best_f1_score: 0.8793; train_kl_reg_loss: 1232.1445; train_edge_recon_loss: 100536.5461; train_gene_expr_recon_loss: 124481.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226250.2547; train_optim_loss: 226250.2547; val_kl_reg_loss: 1495.4861; val_edge_recon_loss: 100019.1484; val_gene_expr_recon_loss: 121113.0195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222627.6562; val_optim_loss: 222627.6562
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9197; val_auprc_score: 0.9126; val_best_acc_score: 0.8447; val_best_f1_score: 0.8542; train_kl_reg_loss: 2492.3910; train_edge_recon_loss: 93894.5859; train_gene_expr_recon_loss: 121490.6773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217877.6547; train_optim_loss: 217877.6547; val_kl_reg_loss: 3751.1714; val_edge_recon_loss: 90576.8281; val_gene_expr_recon_loss: 118761.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213089.3594; val_optim_loss: 213089.3594
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9322; val_auprc_score: 0.9283; val_best_acc_score: 0.8547; val_best_f1_score: 0.8617; train_kl_reg_loss: 4246.0543; train_edge_recon_loss: 88608.4164; train_gene_expr_recon_loss: 118777.9242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211632.3937; train_optim_loss: 211632.3937; val_kl_reg_loss: 4378.2891; val_edge_recon_loss: 87327.7578; val_gene_expr_recon_loss: 115949.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207655.7188; val_optim_loss: 207655.7188
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9433; val_auprc_score: 0.9421; val_best_acc_score: 0.8646; val_best_f1_score: 0.8684; train_kl_reg_loss: 4537.7197; train_edge_recon_loss: 86567.4469; train_gene_expr_recon_loss: 116099.0258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207204.1875; train_optim_loss: 207204.1875; val_kl_reg_loss: 4502.8457; val_edge_recon_loss: 86330.1641; val_gene_expr_recon_loss: 113549.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204382.0312; val_optim_loss: 204382.0312
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9526; val_auprc_score: 0.9529; val_best_acc_score: 0.8770; val_best_f1_score: 0.8790; train_kl_reg_loss: 4687.0852; train_edge_recon_loss: 84950.4594; train_gene_expr_recon_loss: 113606.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203243.7687; train_optim_loss: 203243.7687; val_kl_reg_loss: 4518.3965; val_edge_recon_loss: 84261.5742; val_gene_expr_recon_loss: 111282.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200062.0781; val_optim_loss: 200062.0781
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9600; val_auprc_score: 0.9603; val_best_acc_score: 0.8911; val_best_f1_score: 0.8922; train_kl_reg_loss: 4610.1434; train_edge_recon_loss: 84220.1930; train_gene_expr_recon_loss: 111579.2305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200409.5656; train_optim_loss: 200409.5656; val_kl_reg_loss: 4398.5635; val_edge_recon_loss: 82743.9102; val_gene_expr_recon_loss: 109454.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196596.5625; val_optim_loss: 196596.5625
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9679; val_auprc_score: 0.9678; val_best_acc_score: 0.9040; val_best_f1_score: 0.9048; train_kl_reg_loss: 4565.2593; train_edge_recon_loss: 83503.4641; train_gene_expr_recon_loss: 109827.1141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197895.8359; train_optim_loss: 197895.8359; val_kl_reg_loss: 4471.5261; val_edge_recon_loss: 80836.5078; val_gene_expr_recon_loss: 107811.5273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193119.5625; val_optim_loss: 193119.5625
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9749; val_auprc_score: 0.9739; val_best_acc_score: 0.9177; val_best_f1_score: 0.9178; train_kl_reg_loss: 4579.0006; train_edge_recon_loss: 83603.4180; train_gene_expr_recon_loss: 108195.7117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196378.1297; train_optim_loss: 196378.1297; val_kl_reg_loss: 4527.9880; val_edge_recon_loss: 83098.8281; val_gene_expr_recon_loss: 106130.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193757.4922; val_optim_loss: 193757.4922
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9792; val_auprc_score: 0.9779; val_best_acc_score: 0.9246; val_best_f1_score: 0.9253; train_kl_reg_loss: 4682.6644; train_edge_recon_loss: 82192.4492; train_gene_expr_recon_loss: 106726.2063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193601.3172; train_optim_loss: 193601.3172; val_kl_reg_loss: 4628.2981; val_edge_recon_loss: 78958.0625; val_gene_expr_recon_loss: 104873.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188459.5703; val_optim_loss: 188459.5703
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9836; val_auprc_score: 0.9829; val_best_acc_score: 0.9342; val_best_f1_score: 0.9353; train_kl_reg_loss: 4724.8657; train_edge_recon_loss: 82504.0648; train_gene_expr_recon_loss: 105628.1719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192857.1016; train_optim_loss: 192857.1016; val_kl_reg_loss: 4676.5671; val_edge_recon_loss: 83845.5312; val_gene_expr_recon_loss: 103756.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192278.5078; val_optim_loss: 192278.5078
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9853; val_auprc_score: 0.9831; val_best_acc_score: 0.9395; val_best_f1_score: 0.9398; train_kl_reg_loss: 4739.7952; train_edge_recon_loss: 81693.3516; train_gene_expr_recon_loss: 104391.3109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190824.4594; train_optim_loss: 190824.4594; val_kl_reg_loss: 4641.3789; val_edge_recon_loss: 79202.1328; val_gene_expr_recon_loss: 102793.0820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186636.5938; val_optim_loss: 186636.5938
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9879; val_auprc_score: 0.9867; val_best_acc_score: 0.9460; val_best_f1_score: 0.9465; train_kl_reg_loss: 4780.5922; train_edge_recon_loss: 81214.1453; train_gene_expr_recon_loss: 103475.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189469.8922; train_optim_loss: 189469.8922; val_kl_reg_loss: 4627.6729; val_edge_recon_loss: 84825.4609; val_gene_expr_recon_loss: 101964.5430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191417.6719; val_optim_loss: 191417.6719
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9892; val_auprc_score: 0.9873; val_best_acc_score: 0.9512; val_best_f1_score: 0.9518; train_kl_reg_loss: 4742.6187; train_edge_recon_loss: 80333.2742; train_gene_expr_recon_loss: 102705.1859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187781.0766; train_optim_loss: 187781.0766; val_kl_reg_loss: 4616.6697; val_edge_recon_loss: 82676.0898; val_gene_expr_recon_loss: 101180.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188473.6406; val_optim_loss: 188473.6406
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9908; val_auprc_score: 0.9896; val_best_acc_score: 0.9551; val_best_f1_score: 0.9556; train_kl_reg_loss: 4715.8593; train_edge_recon_loss: 80201.0414; train_gene_expr_recon_loss: 102045.8898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186962.7938; train_optim_loss: 186962.7938; val_kl_reg_loss: 4546.2998; val_edge_recon_loss: 82287.9922; val_gene_expr_recon_loss: 100397.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187231.8750; val_optim_loss: 187231.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9912; val_auprc_score: 0.9898; val_best_acc_score: 0.9557; val_best_f1_score: 0.9562; train_kl_reg_loss: 4647.8879; train_edge_recon_loss: 80099.2492; train_gene_expr_recon_loss: 101506.8078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186253.9453; train_optim_loss: 186253.9453; val_kl_reg_loss: 4601.8218; val_edge_recon_loss: 78825.2383; val_gene_expr_recon_loss: 100468.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183895.6094; val_optim_loss: 183895.6094
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9907; val_auprc_score: 0.9893; val_best_acc_score: 0.9551; val_best_f1_score: 0.9557; train_kl_reg_loss: 4714.7453; train_edge_recon_loss: 79765.9727; train_gene_expr_recon_loss: 101396.9750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185877.6922; train_optim_loss: 185877.6922; val_kl_reg_loss: 4618.0742; val_edge_recon_loss: 76459.8594; val_gene_expr_recon_loss: 100350.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181428.1875; val_optim_loss: 181428.1875
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9911; val_auprc_score: 0.9893; val_best_acc_score: 0.9572; val_best_f1_score: 0.9576; train_kl_reg_loss: 4706.2072; train_edge_recon_loss: 80658.2461; train_gene_expr_recon_loss: 101427.4750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186791.9266; train_optim_loss: 186791.9266; val_kl_reg_loss: 4589.4050; val_edge_recon_loss: 80590.7695; val_gene_expr_recon_loss: 100320.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185500.8203; val_optim_loss: 185500.8203
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9906; val_auprc_score: 0.9895; val_best_acc_score: 0.9552; val_best_f1_score: 0.9557; train_kl_reg_loss: 4673.6723; train_edge_recon_loss: 80171.0695; train_gene_expr_recon_loss: 101322.3430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186167.0844; train_optim_loss: 186167.0844; val_kl_reg_loss: 4571.9792; val_edge_recon_loss: 77676.9609; val_gene_expr_recon_loss: 100232.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182481.6250; val_optim_loss: 182481.6250
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9907; val_auprc_score: 0.9890; val_best_acc_score: 0.9556; val_best_f1_score: 0.9563; train_kl_reg_loss: 4684.7664; train_edge_recon_loss: 80117.4094; train_gene_expr_recon_loss: 101421.4484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186223.6219; train_optim_loss: 186223.6219; val_kl_reg_loss: 4603.0771; val_edge_recon_loss: 81394.4609; val_gene_expr_recon_loss: 100177.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186174.6562; val_optim_loss: 186174.6562

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9908; val_auprc_score: 0.9891; val_best_acc_score: 0.9572; val_best_f1_score: 0.9576; train_kl_reg_loss: 4686.2358; train_edge_recon_loss: 79758.2141; train_gene_expr_recon_loss: 101323.6680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185768.1141; train_optim_loss: 185768.1141; val_kl_reg_loss: 4587.0046; val_edge_recon_loss: 81953.7773; val_gene_expr_recon_loss: 100174.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186715.2344; val_optim_loss: 186715.2344
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9914; val_auprc_score: 0.9906; val_best_acc_score: 0.9569; val_best_f1_score: 0.9575; train_kl_reg_loss: 4684.5534; train_edge_recon_loss: 80217.6461; train_gene_expr_recon_loss: 101364.7914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186266.9891; train_optim_loss: 186266.9891; val_kl_reg_loss: 4585.2258; val_edge_recon_loss: 78428.0312; val_gene_expr_recon_loss: 100172.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183186.1484; val_optim_loss: 183186.1484
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9913; val_auprc_score: 0.9904; val_best_acc_score: 0.9569; val_best_f1_score: 0.9574; train_kl_reg_loss: 4677.7332; train_edge_recon_loss: 79524.7703; train_gene_expr_recon_loss: 101299.1453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185501.6516; train_optim_loss: 185501.6516; val_kl_reg_loss: 4582.4519; val_edge_recon_loss: 77007.9805; val_gene_expr_recon_loss: 100161.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181751.5547; val_optim_loss: 181751.5547

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 2 sec.
Using best model state, which was in epoch 18.

--- MODEL EVALUATION ---
Val AUROC score: 0.9909
Val AUPRC score: 0.9892
Val best accuracy score: 0.9558
Val best F1 score: 0.9562
Val gene expr MSE score: 1.4256
Duration of model training in run 5: 0 hours, 4 minutes and 9 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 159885
Number of validation edges: 17764
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9926; val_auprc_score: 0.9922; val_best_acc_score: 0.9469; val_best_f1_score: 0.9446; train_kl_reg_loss: 299.5195; train_edge_recon_loss: 102835.6000; train_gene_expr_recon_loss: 134471.9633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237607.0844; train_optim_loss: 237607.0844; val_kl_reg_loss: 603.3661; val_edge_recon_loss: 119048.5742; val_gene_expr_recon_loss: 130766.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 250418.1562; val_optim_loss: 250418.1562
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9781; val_auprc_score: 0.9784; val_best_acc_score: 0.8993; val_best_f1_score: 0.8909; train_kl_reg_loss: 927.8230; train_edge_recon_loss: 101736.7664; train_gene_expr_recon_loss: 127219.8172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229884.4078; train_optim_loss: 229884.4078; val_kl_reg_loss: 1088.2622; val_edge_recon_loss: 116208.4141; val_gene_expr_recon_loss: 124296.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241593.1328; val_optim_loss: 241593.1328
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9518; val_auprc_score: 0.9501; val_best_acc_score: 0.8771; val_best_f1_score: 0.8823; train_kl_reg_loss: 1138.4143; train_edge_recon_loss: 100808.9125; train_gene_expr_recon_loss: 122125.2945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224072.6219; train_optim_loss: 224072.6219; val_kl_reg_loss: 1333.5508; val_edge_recon_loss: 97046.6289; val_gene_expr_recon_loss: 120767.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 219147.5859; val_optim_loss: 219147.5859
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9249; val_auprc_score: 0.9176; val_best_acc_score: 0.8512; val_best_f1_score: 0.8599; train_kl_reg_loss: 2111.4822; train_edge_recon_loss: 95243.3305; train_gene_expr_recon_loss: 119361.8492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216716.6609; train_optim_loss: 216716.6609; val_kl_reg_loss: 3372.0009; val_edge_recon_loss: 89101.5625; val_gene_expr_recon_loss: 119102.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211575.9766; val_optim_loss: 211575.9766
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9339; val_auprc_score: 0.9300; val_best_acc_score: 0.8577; val_best_f1_score: 0.8634; train_kl_reg_loss: 4228.2046; train_edge_recon_loss: 88487.7961; train_gene_expr_recon_loss: 117115.9297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209831.9328; train_optim_loss: 209831.9328; val_kl_reg_loss: 4394.8115; val_edge_recon_loss: 87101.4570; val_gene_expr_recon_loss: 116516.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208012.2969; val_optim_loss: 208012.2969
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9449; val_auprc_score: 0.9444; val_best_acc_score: 0.8668; val_best_f1_score: 0.8696; train_kl_reg_loss: 4450.4706; train_edge_recon_loss: 85836.2766; train_gene_expr_recon_loss: 114388.2547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204675.0016; train_optim_loss: 204675.0016; val_kl_reg_loss: 4271.6208; val_edge_recon_loss: 84192.4453; val_gene_expr_recon_loss: 113869.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202333.4609; val_optim_loss: 202333.4609
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9509; val_auprc_score: 0.9510; val_best_acc_score: 0.8769; val_best_f1_score: 0.8784; train_kl_reg_loss: 4470.9265; train_edge_recon_loss: 85481.7117; train_gene_expr_recon_loss: 112252.6758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202205.3141; train_optim_loss: 202205.3141; val_kl_reg_loss: 4397.8594; val_edge_recon_loss: 84764.8945; val_gene_expr_recon_loss: 112049.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201212.1562; val_optim_loss: 201212.1562
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9598; val_auprc_score: 0.9601; val_best_acc_score: 0.8913; val_best_f1_score: 0.8923; train_kl_reg_loss: 4429.7474; train_edge_recon_loss: 84364.7391; train_gene_expr_recon_loss: 110502.4359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199296.9219; train_optim_loss: 199296.9219; val_kl_reg_loss: 4233.3794; val_edge_recon_loss: 79784.7109; val_gene_expr_recon_loss: 110309.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194327.5781; val_optim_loss: 194327.5781
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9691; val_auprc_score: 0.9691; val_best_acc_score: 0.9055; val_best_f1_score: 0.9070; train_kl_reg_loss: 4428.8806; train_edge_recon_loss: 83837.5930; train_gene_expr_recon_loss: 108737.4719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197003.9422; train_optim_loss: 197003.9422; val_kl_reg_loss: 4335.0061; val_edge_recon_loss: 81720.6211; val_gene_expr_recon_loss: 108624.8320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194680.4688; val_optim_loss: 194680.4688
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9755; val_auprc_score: 0.9748; val_best_acc_score: 0.9200; val_best_f1_score: 0.9203; train_kl_reg_loss: 4481.0160; train_edge_recon_loss: 83282.4031; train_gene_expr_recon_loss: 106996.8555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194760.2734; train_optim_loss: 194760.2734; val_kl_reg_loss: 4506.9492; val_edge_recon_loss: 78855.2812; val_gene_expr_recon_loss: 107050.5195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190412.7500; val_optim_loss: 190412.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9803; val_auprc_score: 0.9795; val_best_acc_score: 0.9280; val_best_f1_score: 0.9290; train_kl_reg_loss: 4557.6677; train_edge_recon_loss: 82441.2508; train_gene_expr_recon_loss: 105581.3297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192580.2469; train_optim_loss: 192580.2469; val_kl_reg_loss: 4498.7815; val_edge_recon_loss: 84059.2266; val_gene_expr_recon_loss: 105741.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194299.2734; val_optim_loss: 194299.2734
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9826; val_auprc_score: 0.9818; val_best_acc_score: 0.9343; val_best_f1_score: 0.9348; train_kl_reg_loss: 4620.4177; train_edge_recon_loss: 81660.2492; train_gene_expr_recon_loss: 104298.8203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190579.4891; train_optim_loss: 190579.4891; val_kl_reg_loss: 4543.3628; val_edge_recon_loss: 81322.3086; val_gene_expr_recon_loss: 104460.1914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190325.8672; val_optim_loss: 190325.8672
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9866; val_auprc_score: 0.9840; val_best_acc_score: 0.9432; val_best_f1_score: 0.9438; train_kl_reg_loss: 4686.9657; train_edge_recon_loss: 80981.7695; train_gene_expr_recon_loss: 103209.6891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188878.4234; train_optim_loss: 188878.4234; val_kl_reg_loss: 4530.0581; val_edge_recon_loss: 80784.9141; val_gene_expr_recon_loss: 103466.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188781.8047; val_optim_loss: 188781.8047
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9889; val_auprc_score: 0.9884; val_best_acc_score: 0.9487; val_best_f1_score: 0.9489; train_kl_reg_loss: 4689.9543; train_edge_recon_loss: 81224.2258; train_gene_expr_recon_loss: 102221.9055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188136.0828; train_optim_loss: 188136.0828; val_kl_reg_loss: 4582.4629; val_edge_recon_loss: 77764.6445; val_gene_expr_recon_loss: 102664.2461; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185011.3516; val_optim_loss: 185011.3516
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9902; val_auprc_score: 0.9895; val_best_acc_score: 0.9537; val_best_f1_score: 0.9541; train_kl_reg_loss: 4646.2187; train_edge_recon_loss: 80785.2172; train_gene_expr_recon_loss: 101474.8852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186906.3234; train_optim_loss: 186906.3234; val_kl_reg_loss: 4596.2563; val_edge_recon_loss: 82204.5938; val_gene_expr_recon_loss: 101849.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188650.1953; val_optim_loss: 188650.1953
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9903; val_auprc_score: 0.9889; val_best_acc_score: 0.9553; val_best_f1_score: 0.9558; train_kl_reg_loss: 4663.8329; train_edge_recon_loss: 80708.3453; train_gene_expr_recon_loss: 100746.1828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186118.3625; train_optim_loss: 186118.3625; val_kl_reg_loss: 4511.8384; val_edge_recon_loss: 79104.6875; val_gene_expr_recon_loss: 101338.7617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184955.2891; val_optim_loss: 184955.2891
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9921; val_auprc_score: 0.9907; val_best_acc_score: 0.9610; val_best_f1_score: 0.9614; train_kl_reg_loss: 4613.4610; train_edge_recon_loss: 80098.0516; train_gene_expr_recon_loss: 100224.7227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184936.2344; train_optim_loss: 184936.2344; val_kl_reg_loss: 4514.9736; val_edge_recon_loss: 77442.0898; val_gene_expr_recon_loss: 100610.2617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182567.3281; val_optim_loss: 182567.3281
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9921; val_auprc_score: 0.9908; val_best_acc_score: 0.9611; val_best_f1_score: 0.9615; train_kl_reg_loss: 4633.0478; train_edge_recon_loss: 79855.4891; train_gene_expr_recon_loss: 99626.9398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184115.4750; train_optim_loss: 184115.4750; val_kl_reg_loss: 4519.0142; val_edge_recon_loss: 81759.7461; val_gene_expr_recon_loss: 100078.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186356.8125; val_optim_loss: 186356.8125
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9929; val_auprc_score: 0.9914; val_best_acc_score: 0.9631; val_best_f1_score: 0.9633; train_kl_reg_loss: 4599.0792; train_edge_recon_loss: 79567.9203; train_gene_expr_recon_loss: 98989.6359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183156.6359; train_optim_loss: 183156.6359; val_kl_reg_loss: 4503.0581; val_edge_recon_loss: 80728.4883; val_gene_expr_recon_loss: 99554.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184786.0547; val_optim_loss: 184786.0547
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9931; val_auprc_score: 0.9913; val_best_acc_score: 0.9646; val_best_f1_score: 0.9649; train_kl_reg_loss: 4538.8154; train_edge_recon_loss: 80077.0531; train_gene_expr_recon_loss: 98599.3156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183215.1812; train_optim_loss: 183215.1812; val_kl_reg_loss: 4494.5398; val_edge_recon_loss: 81758.3086; val_gene_expr_recon_loss: 99223.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185475.9766; val_optim_loss: 185475.9766

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9935; val_auprc_score: 0.9923; val_best_acc_score: 0.9644; val_best_f1_score: 0.9648; train_kl_reg_loss: 4553.6383; train_edge_recon_loss: 79520.5930; train_gene_expr_recon_loss: 98240.5805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182314.8094; train_optim_loss: 182314.8094; val_kl_reg_loss: 4433.7891; val_edge_recon_loss: 79256.8633; val_gene_expr_recon_loss: 99071.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182762.3203; val_optim_loss: 182762.3203
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9933; val_auprc_score: 0.9923; val_best_acc_score: 0.9637; val_best_f1_score: 0.9641; train_kl_reg_loss: 4511.7854; train_edge_recon_loss: 79055.8531; train_gene_expr_recon_loss: 98184.5586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181752.2000; train_optim_loss: 181752.2000; val_kl_reg_loss: 4438.3213; val_edge_recon_loss: 75059.1289; val_gene_expr_recon_loss: 99022.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178520.2031; val_optim_loss: 178520.2031
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9931; val_auprc_score: 0.9914; val_best_acc_score: 0.9639; val_best_f1_score: 0.9643; train_kl_reg_loss: 4512.9535; train_edge_recon_loss: 79434.8055; train_gene_expr_recon_loss: 98127.9211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182075.6812; train_optim_loss: 182075.6812; val_kl_reg_loss: 4438.7749; val_edge_recon_loss: 80739.4062; val_gene_expr_recon_loss: 98947.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184125.7891; val_optim_loss: 184125.7891
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9930; val_auprc_score: 0.9914; val_best_acc_score: 0.9638; val_best_f1_score: 0.9641; train_kl_reg_loss: 4506.5100; train_edge_recon_loss: 79446.4039; train_gene_expr_recon_loss: 98149.0805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182101.9937; train_optim_loss: 182101.9937; val_kl_reg_loss: 4413.7263; val_edge_recon_loss: 80897.0430; val_gene_expr_recon_loss: 98906.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184216.8984; val_optim_loss: 184216.8984
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9931; val_auprc_score: 0.9916; val_best_acc_score: 0.9655; val_best_f1_score: 0.9658; train_kl_reg_loss: 4509.0588; train_edge_recon_loss: 79736.7109; train_gene_expr_recon_loss: 98081.4500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182327.2203; train_optim_loss: 182327.2203; val_kl_reg_loss: 4431.4421; val_edge_recon_loss: 79699.1797; val_gene_expr_recon_loss: 98876.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183006.7109; val_optim_loss: 183006.7109

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9937; val_auprc_score: 0.9930; val_best_acc_score: 0.9638; val_best_f1_score: 0.9641; train_kl_reg_loss: 4513.7397; train_edge_recon_loss: 79528.2914; train_gene_expr_recon_loss: 98050.1438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182092.1703; train_optim_loss: 182092.1703; val_kl_reg_loss: 4362.7842; val_edge_recon_loss: 77257.5625; val_gene_expr_recon_loss: 98879.5195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180499.8672; val_optim_loss: 180499.8672
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9936; val_auprc_score: 0.9929; val_best_acc_score: 0.9640; val_best_f1_score: 0.9643; train_kl_reg_loss: 4513.2582; train_edge_recon_loss: 79910.5312; train_gene_expr_recon_loss: 97983.4898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182407.2812; train_optim_loss: 182407.2812; val_kl_reg_loss: 4357.8960; val_edge_recon_loss: 77319.9688; val_gene_expr_recon_loss: 98885.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180563.8281; val_optim_loss: 180563.8281
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9932; val_auprc_score: 0.9913; val_best_acc_score: 0.9643; val_best_f1_score: 0.9646; train_kl_reg_loss: 4510.2209; train_edge_recon_loss: 79599.3625; train_gene_expr_recon_loss: 98032.0437; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182141.6266; train_optim_loss: 182141.6266; val_kl_reg_loss: 4350.8936; val_edge_recon_loss: 76811.2070; val_gene_expr_recon_loss: 98881.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180043.8906; val_optim_loss: 180043.8906

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 46 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
Val AUROC score: 0.9932
Val AUPRC score: 0.9921
Val best accuracy score: 0.9648
Val best F1 score: 0.9651
Val gene expr MSE score: 1.3778
Duration of model training in run 6: 0 hours, 4 minutes and 52 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 212411
Number of validation edges: 23601
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9914; val_auprc_score: 0.9905; val_best_acc_score: 0.9556; val_best_f1_score: 0.9550; train_kl_reg_loss: 385.8654; train_edge_recon_loss: 101693.2548; train_gene_expr_recon_loss: 135555.7686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237634.8882; train_optim_loss: 237634.8882; val_kl_reg_loss: 1035.6353; val_edge_recon_loss: 120358.4805; val_gene_expr_recon_loss: 129374.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 250768.5859; val_optim_loss: 250768.5859
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9673; val_auprc_score: 0.9677; val_best_acc_score: 0.8886; val_best_f1_score: 0.8954; train_kl_reg_loss: 1245.6890; train_edge_recon_loss: 101794.8558; train_gene_expr_recon_loss: 125841.5415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228882.0877; train_optim_loss: 228882.0877; val_kl_reg_loss: 1323.6240; val_edge_recon_loss: 111377.6250; val_gene_expr_recon_loss: 122625.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 235326.8047; val_optim_loss: 235326.8047
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9277; val_auprc_score: 0.9231; val_best_acc_score: 0.8529; val_best_f1_score: 0.8614; train_kl_reg_loss: 1860.2666; train_edge_recon_loss: 97124.1274; train_gene_expr_recon_loss: 120744.5072; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219728.9014; train_optim_loss: 219728.9014; val_kl_reg_loss: 3030.1395; val_edge_recon_loss: 94297.4375; val_gene_expr_recon_loss: 119406.9727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216734.5469; val_optim_loss: 216734.5469
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9358; val_auprc_score: 0.9321; val_best_acc_score: 0.8575; val_best_f1_score: 0.8632; train_kl_reg_loss: 3967.5558; train_edge_recon_loss: 89361.5787; train_gene_expr_recon_loss: 117469.4050; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210798.5373; train_optim_loss: 210798.5373; val_kl_reg_loss: 4354.6941; val_edge_recon_loss: 85115.7305; val_gene_expr_recon_loss: 116374.0820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205844.5000; val_optim_loss: 205844.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9472; val_auprc_score: 0.9464; val_best_acc_score: 0.8687; val_best_f1_score: 0.8719; train_kl_reg_loss: 4435.7993; train_edge_recon_loss: 86382.9663; train_gene_expr_recon_loss: 114345.9261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205164.6923; train_optim_loss: 205164.6923; val_kl_reg_loss: 4521.5718; val_edge_recon_loss: 84498.5859; val_gene_expr_recon_loss: 112917.8398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201937.9922; val_optim_loss: 201937.9922
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9602; val_auprc_score: 0.9607; val_best_acc_score: 0.8891; val_best_f1_score: 0.8893; train_kl_reg_loss: 4492.5118; train_edge_recon_loss: 85073.5186; train_gene_expr_recon_loss: 111559.7410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201125.7716; train_optim_loss: 201125.7716; val_kl_reg_loss: 4436.5371; val_edge_recon_loss: 83682.3398; val_gene_expr_recon_loss: 110436.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198554.9844; val_optim_loss: 198554.9844
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9726; val_auprc_score: 0.9725; val_best_acc_score: 0.9110; val_best_f1_score: 0.9109; train_kl_reg_loss: 4431.7340; train_edge_recon_loss: 84019.1388; train_gene_expr_recon_loss: 109138.0607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197588.9339; train_optim_loss: 197588.9339; val_kl_reg_loss: 4414.1130; val_edge_recon_loss: 83288.1289; val_gene_expr_recon_loss: 108349.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196051.3906; val_optim_loss: 196051.3906
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9805; val_auprc_score: 0.9802; val_best_acc_score: 0.9265; val_best_f1_score: 0.9274; train_kl_reg_loss: 4621.1298; train_edge_recon_loss: 82116.7326; train_gene_expr_recon_loss: 106953.5721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193691.4363; train_optim_loss: 193691.4363; val_kl_reg_loss: 4685.2324; val_edge_recon_loss: 82100.7969; val_gene_expr_recon_loss: 106102.9023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192888.9219; val_optim_loss: 192888.9219
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9848; val_auprc_score: 0.9836; val_best_acc_score: 0.9389; val_best_f1_score: 0.9390; train_kl_reg_loss: 4707.8163; train_edge_recon_loss: 82462.2007; train_gene_expr_recon_loss: 105086.3702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192256.3882; train_optim_loss: 192256.3882; val_kl_reg_loss: 4705.8298; val_edge_recon_loss: 82516.8828; val_gene_expr_recon_loss: 104829.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192052.6719; val_optim_loss: 192052.6719
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9885; val_auprc_score: 0.9874; val_best_acc_score: 0.9491; val_best_f1_score: 0.9493; train_kl_reg_loss: 4733.4858; train_edge_recon_loss: 81382.6334; train_gene_expr_recon_loss: 103578.9579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189695.0757; train_optim_loss: 189695.0757; val_kl_reg_loss: 4707.5554; val_edge_recon_loss: 80127.7734; val_gene_expr_recon_loss: 103033.2148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187868.5391; val_optim_loss: 187868.5391
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9899; val_auprc_score: 0.9883; val_best_acc_score: 0.9543; val_best_f1_score: 0.9547; train_kl_reg_loss: 4771.4257; train_edge_recon_loss: 81718.6502; train_gene_expr_recon_loss: 102370.6803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188860.7560; train_optim_loss: 188860.7560; val_kl_reg_loss: 4740.7490; val_edge_recon_loss: 80563.0664; val_gene_expr_recon_loss: 102109.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187413.7578; val_optim_loss: 187413.7578
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9919; val_auprc_score: 0.9912; val_best_acc_score: 0.9586; val_best_f1_score: 0.9590; train_kl_reg_loss: 4704.3360; train_edge_recon_loss: 80894.3600; train_gene_expr_recon_loss: 101431.5865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187030.2861; train_optim_loss: 187030.2861; val_kl_reg_loss: 4645.3655; val_edge_recon_loss: 76923.4023; val_gene_expr_recon_loss: 101783.4805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183352.2422; val_optim_loss: 183352.2422
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9920; val_auprc_score: 0.9901; val_best_acc_score: 0.9604; val_best_f1_score: 0.9610; train_kl_reg_loss: 4673.9019; train_edge_recon_loss: 80516.8462; train_gene_expr_recon_loss: 100623.6623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185814.4087; train_optim_loss: 185814.4087; val_kl_reg_loss: 4565.1797; val_edge_recon_loss: 80173.3438; val_gene_expr_recon_loss: 100801.3477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185539.8672; val_optim_loss: 185539.8672
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9932; val_auprc_score: 0.9920; val_best_acc_score: 0.9637; val_best_f1_score: 0.9641; train_kl_reg_loss: 4662.8859; train_edge_recon_loss: 80406.3498; train_gene_expr_recon_loss: 99963.8173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185033.0517; train_optim_loss: 185033.0517; val_kl_reg_loss: 4619.7729; val_edge_recon_loss: 79008.4922; val_gene_expr_recon_loss: 99870.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183499.1250; val_optim_loss: 183499.1250
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9934; val_auprc_score: 0.9923; val_best_acc_score: 0.9646; val_best_f1_score: 0.9648; train_kl_reg_loss: 4626.1046; train_edge_recon_loss: 79834.3269; train_gene_expr_recon_loss: 99236.8155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183697.2464; train_optim_loss: 183697.2464; val_kl_reg_loss: 4545.9509; val_edge_recon_loss: 79276.4492; val_gene_expr_recon_loss: 98978.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182801.0625; val_optim_loss: 182801.0625
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9938; val_auprc_score: 0.9928; val_best_acc_score: 0.9664; val_best_f1_score: 0.9667; train_kl_reg_loss: 4587.5832; train_edge_recon_loss: 79882.9363; train_gene_expr_recon_loss: 98692.3546; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183162.8738; train_optim_loss: 183162.8738; val_kl_reg_loss: 4434.7761; val_edge_recon_loss: 80344.3008; val_gene_expr_recon_loss: 98727.1445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183506.2188; val_optim_loss: 183506.2188
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9941; val_auprc_score: 0.9930; val_best_acc_score: 0.9675; val_best_f1_score: 0.9678; train_kl_reg_loss: 4539.2521; train_edge_recon_loss: 79651.1785; train_gene_expr_recon_loss: 98104.0300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182294.4603; train_optim_loss: 182294.4603; val_kl_reg_loss: 4464.3760; val_edge_recon_loss: 78545.7109; val_gene_expr_recon_loss: 98203.3867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181213.4766; val_optim_loss: 181213.4766
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9942; val_auprc_score: 0.9928; val_best_acc_score: 0.9683; val_best_f1_score: 0.9686; train_kl_reg_loss: 4503.8701; train_edge_recon_loss: 79121.9093; train_gene_expr_recon_loss: 97678.5703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181304.3510; train_optim_loss: 181304.3510; val_kl_reg_loss: 4380.4158; val_edge_recon_loss: 78607.7266; val_gene_expr_recon_loss: 96794.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179782.4688; val_optim_loss: 179782.4688
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9947; val_auprc_score: 0.9938; val_best_acc_score: 0.9685; val_best_f1_score: 0.9690; train_kl_reg_loss: 4450.1685; train_edge_recon_loss: 79026.5901; train_gene_expr_recon_loss: 97227.8347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180704.5950; train_optim_loss: 180704.5950; val_kl_reg_loss: 4358.0276; val_edge_recon_loss: 80096.2852; val_gene_expr_recon_loss: 97262.8164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181717.1250; val_optim_loss: 181717.1250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9950; val_auprc_score: 0.9943; val_best_acc_score: 0.9707; val_best_f1_score: 0.9710; train_kl_reg_loss: 4439.7652; train_edge_recon_loss: 80032.4026; train_gene_expr_recon_loss: 96782.1821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181254.3486; train_optim_loss: 181254.3486; val_kl_reg_loss: 4364.4297; val_edge_recon_loss: 79220.2344; val_gene_expr_recon_loss: 96763.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180348.2188; val_optim_loss: 180348.2188
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9951; val_auprc_score: 0.9941; val_best_acc_score: 0.9707; val_best_f1_score: 0.9710; train_kl_reg_loss: 4398.3886; train_edge_recon_loss: 78822.2764; train_gene_expr_recon_loss: 96389.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179609.7897; train_optim_loss: 179609.7897; val_kl_reg_loss: 4327.2834; val_edge_recon_loss: 76857.3594; val_gene_expr_recon_loss: 96590.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177774.8594; val_optim_loss: 177774.8594
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9956; val_auprc_score: 0.9941; val_best_acc_score: 0.9717; val_best_f1_score: 0.9719; train_kl_reg_loss: 4348.7257; train_edge_recon_loss: 79072.9014; train_gene_expr_recon_loss: 95991.5649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179413.1923; train_optim_loss: 179413.1923; val_kl_reg_loss: 4293.7671; val_edge_recon_loss: 78948.0000; val_gene_expr_recon_loss: 96120.3008; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179362.0625; val_optim_loss: 179362.0625
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9951; val_auprc_score: 0.9939; val_best_acc_score: 0.9714; val_best_f1_score: 0.9717; train_kl_reg_loss: 4359.3222; train_edge_recon_loss: 78776.2885; train_gene_expr_recon_loss: 95701.4477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178837.0601; train_optim_loss: 178837.0601; val_kl_reg_loss: 4299.6475; val_edge_recon_loss: 77475.1875; val_gene_expr_recon_loss: 95951.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177726.4688; val_optim_loss: 177726.4688
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9952; val_auprc_score: 0.9944; val_best_acc_score: 0.9715; val_best_f1_score: 0.9719; train_kl_reg_loss: 4324.6756; train_edge_recon_loss: 78503.4357; train_gene_expr_recon_loss: 95313.0757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178141.1875; train_optim_loss: 178141.1875; val_kl_reg_loss: 4235.1951; val_edge_recon_loss: 76511.2109; val_gene_expr_recon_loss: 95529.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176275.8281; val_optim_loss: 176275.8281
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9954; val_auprc_score: 0.9945; val_best_acc_score: 0.9722; val_best_f1_score: 0.9725; train_kl_reg_loss: 4295.5672; train_edge_recon_loss: 78981.0703; train_gene_expr_recon_loss: 95079.1316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178355.7716; train_optim_loss: 178355.7716; val_kl_reg_loss: 4194.6719; val_edge_recon_loss: 78567.6406; val_gene_expr_recon_loss: 94914.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177676.7344; val_optim_loss: 177676.7344
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9955; val_auprc_score: 0.9944; val_best_acc_score: 0.9716; val_best_f1_score: 0.9718; train_kl_reg_loss: 4239.9767; train_edge_recon_loss: 78289.5619; train_gene_expr_recon_loss: 94799.1779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177328.7139; train_optim_loss: 177328.7139; val_kl_reg_loss: 3986.3390; val_edge_recon_loss: 76995.9922; val_gene_expr_recon_loss: 94578.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175560.4219; val_optim_loss: 175560.4219
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9960; val_auprc_score: 0.9944; val_best_acc_score: 0.9735; val_best_f1_score: 0.9736; train_kl_reg_loss: 4169.5734; train_edge_recon_loss: 78350.7758; train_gene_expr_recon_loss: 94417.1743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176937.5216; train_optim_loss: 176937.5216; val_kl_reg_loss: 4012.4916; val_edge_recon_loss: 75789.2695; val_gene_expr_recon_loss: 94356.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174158.6484; val_optim_loss: 174158.6484
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9962; val_auprc_score: 0.9954; val_best_acc_score: 0.9745; val_best_f1_score: 0.9748; train_kl_reg_loss: 4121.0920; train_edge_recon_loss: 78622.2776; train_gene_expr_recon_loss: 94173.7734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176917.1418; train_optim_loss: 176917.1418; val_kl_reg_loss: 4010.4186; val_edge_recon_loss: 78596.6875; val_gene_expr_recon_loss: 94925.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177532.8594; val_optim_loss: 177532.8594
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9958; val_auprc_score: 0.9943; val_best_acc_score: 0.9742; val_best_f1_score: 0.9743; train_kl_reg_loss: 4102.0195; train_edge_recon_loss: 78652.4706; train_gene_expr_recon_loss: 93941.0415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176695.5300; train_optim_loss: 176695.5300; val_kl_reg_loss: 3974.8619; val_edge_recon_loss: 78231.1406; val_gene_expr_recon_loss: 93679.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175885.7969; val_optim_loss: 175885.7969
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9960; val_auprc_score: 0.9943; val_best_acc_score: 0.9744; val_best_f1_score: 0.9746; train_kl_reg_loss: 4046.1424; train_edge_recon_loss: 78476.7524; train_gene_expr_recon_loss: 93759.2710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176282.1635; train_optim_loss: 176282.1635; val_kl_reg_loss: 3980.1256; val_edge_recon_loss: 77849.8398; val_gene_expr_recon_loss: 93476.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175306.9219; val_optim_loss: 175306.9219

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9958; val_auprc_score: 0.9937; val_best_acc_score: 0.9747; val_best_f1_score: 0.9749; train_kl_reg_loss: 4033.2823; train_edge_recon_loss: 78056.3828; train_gene_expr_recon_loss: 93523.1208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175612.7849; train_optim_loss: 175612.7849; val_kl_reg_loss: 3928.4294; val_edge_recon_loss: 77378.3711; val_gene_expr_recon_loss: 94284.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175591.7969; val_optim_loss: 175591.7969
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9962; val_auprc_score: 0.9950; val_best_acc_score: 0.9740; val_best_f1_score: 0.9743; train_kl_reg_loss: 4032.9124; train_edge_recon_loss: 78521.6454; train_gene_expr_recon_loss: 93468.8984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176023.4579; train_optim_loss: 176023.4579; val_kl_reg_loss: 3957.1033; val_edge_recon_loss: 76749.2031; val_gene_expr_recon_loss: 93456.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174162.8125; val_optim_loss: 174162.8125
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9959; val_auprc_score: 0.9951; val_best_acc_score: 0.9744; val_best_f1_score: 0.9748; train_kl_reg_loss: 4031.3773; train_edge_recon_loss: 78473.7332; train_gene_expr_recon_loss: 93487.4982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175992.6070; train_optim_loss: 175992.6070; val_kl_reg_loss: 3928.4408; val_edge_recon_loss: 77435.8633; val_gene_expr_recon_loss: 93418.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174782.9766; val_optim_loss: 174782.9766

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 7 min 55 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
Val AUROC score: 0.9957
Val AUPRC score: 0.9949
Val best accuracy score: 0.9716
Val best F1 score: 0.9719
Val gene expr MSE score: 1.1848
Duration of model training in run 7: 0 hours, 8 minutes and 3 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 212411
Number of validation edges: 23601
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9904; val_auprc_score: 0.9899; val_best_acc_score: 0.9474; val_best_f1_score: 0.9456; train_kl_reg_loss: 370.5737; train_edge_recon_loss: 102153.6929; train_gene_expr_recon_loss: 137715.2212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240239.4868; train_optim_loss: 240239.4868; val_kl_reg_loss: 856.7162; val_edge_recon_loss: 118367.2852; val_gene_expr_recon_loss: 129982.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 249206.2969; val_optim_loss: 249206.2969
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9615; val_auprc_score: 0.9604; val_best_acc_score: 0.8913; val_best_f1_score: 0.8957; train_kl_reg_loss: 1108.8567; train_edge_recon_loss: 101682.5751; train_gene_expr_recon_loss: 128300.7272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 231092.1575; train_optim_loss: 231092.1575; val_kl_reg_loss: 1251.6920; val_edge_recon_loss: 106243.6367; val_gene_expr_recon_loss: 123673.9805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 231169.3125; val_optim_loss: 231169.3125
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9220; val_auprc_score: 0.9163; val_best_acc_score: 0.8444; val_best_f1_score: 0.8545; train_kl_reg_loss: 2223.3604; train_edge_recon_loss: 95688.4850; train_gene_expr_recon_loss: 122543.2458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220455.0925; train_optim_loss: 220455.0925; val_kl_reg_loss: 3703.0742; val_edge_recon_loss: 91433.0781; val_gene_expr_recon_loss: 119893.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215029.6484; val_optim_loss: 215029.6484
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9391; val_auprc_score: 0.9368; val_best_acc_score: 0.8600; val_best_f1_score: 0.8645; train_kl_reg_loss: 4280.5247; train_edge_recon_loss: 88291.9477; train_gene_expr_recon_loss: 118792.2584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211364.7308; train_optim_loss: 211364.7308; val_kl_reg_loss: 4319.3960; val_edge_recon_loss: 85962.2578; val_gene_expr_recon_loss: 115177.6367; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205459.2969; val_optim_loss: 205459.2969
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9479; val_auprc_score: 0.9474; val_best_acc_score: 0.8699; val_best_f1_score: 0.8731; train_kl_reg_loss: 4499.8704; train_edge_recon_loss: 86359.1556; train_gene_expr_recon_loss: 114793.1941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205652.2224; train_optim_loss: 205652.2224; val_kl_reg_loss: 4577.2998; val_edge_recon_loss: 83928.4023; val_gene_expr_recon_loss: 111903.3398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200409.0469; val_optim_loss: 200409.0469
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9585; val_auprc_score: 0.9579; val_best_acc_score: 0.8871; val_best_f1_score: 0.8881; train_kl_reg_loss: 4585.2575; train_edge_recon_loss: 84698.3450; train_gene_expr_recon_loss: 111571.5036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200855.1046; train_optim_loss: 200855.1046; val_kl_reg_loss: 4431.3293; val_edge_recon_loss: 81764.2539; val_gene_expr_recon_loss: 109892.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196087.8047; val_optim_loss: 196087.8047
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9690; val_auprc_score: 0.9682; val_best_acc_score: 0.9035; val_best_f1_score: 0.9047; train_kl_reg_loss: 4507.1082; train_edge_recon_loss: 83827.3131; train_gene_expr_recon_loss: 108988.8107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197323.2308; train_optim_loss: 197323.2308; val_kl_reg_loss: 4472.6711; val_edge_recon_loss: 82672.0352; val_gene_expr_recon_loss: 107041.9258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194186.6328; val_optim_loss: 194186.6328
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9772; val_auprc_score: 0.9758; val_best_acc_score: 0.9209; val_best_f1_score: 0.9218; train_kl_reg_loss: 4592.8373; train_edge_recon_loss: 83285.6382; train_gene_expr_recon_loss: 106958.7392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194837.2163; train_optim_loss: 194837.2163; val_kl_reg_loss: 4445.1951; val_edge_recon_loss: 83460.4688; val_gene_expr_recon_loss: 105821.8711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193727.5391; val_optim_loss: 193727.5391
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9830; val_auprc_score: 0.9822; val_best_acc_score: 0.9338; val_best_f1_score: 0.9345; train_kl_reg_loss: 4594.7324; train_edge_recon_loss: 82384.2127; train_gene_expr_recon_loss: 105241.7073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192220.6514; train_optim_loss: 192220.6514; val_kl_reg_loss: 4522.2686; val_edge_recon_loss: 81954.2148; val_gene_expr_recon_loss: 104445.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190921.8281; val_optim_loss: 190921.8281
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9872; val_auprc_score: 0.9862; val_best_acc_score: 0.9451; val_best_f1_score: 0.9454; train_kl_reg_loss: 4672.2412; train_edge_recon_loss: 81752.1671; train_gene_expr_recon_loss: 103705.5859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190129.9928; train_optim_loss: 190129.9928; val_kl_reg_loss: 4546.5278; val_edge_recon_loss: 80707.2500; val_gene_expr_recon_loss: 101716.8008; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186970.5781; val_optim_loss: 186970.5781
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9892; val_auprc_score: 0.9880; val_best_acc_score: 0.9502; val_best_f1_score: 0.9507; train_kl_reg_loss: 4670.2356; train_edge_recon_loss: 82002.7350; train_gene_expr_recon_loss: 102541.9916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189214.9615; train_optim_loss: 189214.9615; val_kl_reg_loss: 4630.5469; val_edge_recon_loss: 77312.2383; val_gene_expr_recon_loss: 101165.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183108.3203; val_optim_loss: 183108.3203
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9915; val_auprc_score: 0.9908; val_best_acc_score: 0.9573; val_best_f1_score: 0.9577; train_kl_reg_loss: 4664.5325; train_edge_recon_loss: 81228.3185; train_gene_expr_recon_loss: 101550.5992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187443.4495; train_optim_loss: 187443.4495; val_kl_reg_loss: 4621.8455; val_edge_recon_loss: 80773.2305; val_gene_expr_recon_loss: 100763.8711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186158.9531; val_optim_loss: 186158.9531
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9924; val_auprc_score: 0.9911; val_best_acc_score: 0.9611; val_best_f1_score: 0.9614; train_kl_reg_loss: 4643.4139; train_edge_recon_loss: 81026.2332; train_gene_expr_recon_loss: 100802.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186472.4507; train_optim_loss: 186472.4507; val_kl_reg_loss: 4602.9587; val_edge_recon_loss: 78529.7734; val_gene_expr_recon_loss: 99729.1758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182861.9062; val_optim_loss: 182861.9062
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9929; val_auprc_score: 0.9916; val_best_acc_score: 0.9628; val_best_f1_score: 0.9633; train_kl_reg_loss: 4656.5113; train_edge_recon_loss: 80058.8588; train_gene_expr_recon_loss: 99926.8251; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184642.1935; train_optim_loss: 184642.1935; val_kl_reg_loss: 4575.3662; val_edge_recon_loss: 78438.7344; val_gene_expr_recon_loss: 98931.8398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181945.9375; val_optim_loss: 181945.9375
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9934; val_auprc_score: 0.9924; val_best_acc_score: 0.9643; val_best_f1_score: 0.9645; train_kl_reg_loss: 4618.6477; train_edge_recon_loss: 79988.5228; train_gene_expr_recon_loss: 99247.7079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183854.8774; train_optim_loss: 183854.8774; val_kl_reg_loss: 4547.7468; val_edge_recon_loss: 76717.3906; val_gene_expr_recon_loss: 98239.0273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179504.1719; val_optim_loss: 179504.1719
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9935; val_auprc_score: 0.9924; val_best_acc_score: 0.9658; val_best_f1_score: 0.9663; train_kl_reg_loss: 4599.1224; train_edge_recon_loss: 79948.8528; train_gene_expr_recon_loss: 98747.6611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183295.6370; train_optim_loss: 183295.6370; val_kl_reg_loss: 4492.4529; val_edge_recon_loss: 79759.4727; val_gene_expr_recon_loss: 98134.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182386.7891; val_optim_loss: 182386.7891
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9942; val_auprc_score: 0.9930; val_best_acc_score: 0.9668; val_best_f1_score: 0.9672; train_kl_reg_loss: 4549.1652; train_edge_recon_loss: 80179.7440; train_gene_expr_recon_loss: 98176.7674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182905.6755; train_optim_loss: 182905.6755; val_kl_reg_loss: 4421.3132; val_edge_recon_loss: 78701.5352; val_gene_expr_recon_loss: 97367.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180490.5156; val_optim_loss: 180490.5156
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9943; val_auprc_score: 0.9934; val_best_acc_score: 0.9676; val_best_f1_score: 0.9681; train_kl_reg_loss: 4513.3364; train_edge_recon_loss: 80085.5703; train_gene_expr_recon_loss: 97657.0108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182255.9195; train_optim_loss: 182255.9195; val_kl_reg_loss: 4454.9155; val_edge_recon_loss: 79031.5703; val_gene_expr_recon_loss: 96822.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180308.8281; val_optim_loss: 180308.8281

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9944; val_auprc_score: 0.9933; val_best_acc_score: 0.9674; val_best_f1_score: 0.9678; train_kl_reg_loss: 4511.2814; train_edge_recon_loss: 78993.4513; train_gene_expr_recon_loss: 97383.1785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180887.9135; train_optim_loss: 180887.9135; val_kl_reg_loss: 4409.1282; val_edge_recon_loss: 77060.0469; val_gene_expr_recon_loss: 96545.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178014.9609; val_optim_loss: 178014.9609
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9941; val_auprc_score: 0.9923; val_best_acc_score: 0.9680; val_best_f1_score: 0.9685; train_kl_reg_loss: 4482.6113; train_edge_recon_loss: 79960.2386; train_gene_expr_recon_loss: 97382.8522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181825.7031; train_optim_loss: 181825.7031; val_kl_reg_loss: 4398.2229; val_edge_recon_loss: 76636.9922; val_gene_expr_recon_loss: 96976.5664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178011.7812; val_optim_loss: 178011.7812
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9943; val_auprc_score: 0.9932; val_best_acc_score: 0.9679; val_best_f1_score: 0.9682; train_kl_reg_loss: 4470.8818; train_edge_recon_loss: 78892.1605; train_gene_expr_recon_loss: 97297.1058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180660.1478; train_optim_loss: 180660.1478; val_kl_reg_loss: 4395.0464; val_edge_recon_loss: 79873.7227; val_gene_expr_recon_loss: 96818.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181086.8906; val_optim_loss: 181086.8906
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9946; val_auprc_score: 0.9932; val_best_acc_score: 0.9692; val_best_f1_score: 0.9696; train_kl_reg_loss: 4461.9511; train_edge_recon_loss: 79264.6695; train_gene_expr_recon_loss: 97160.4736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180887.0913; train_optim_loss: 180887.0913; val_kl_reg_loss: 4407.8699; val_edge_recon_loss: 78364.4727; val_gene_expr_recon_loss: 96182.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178954.9141; val_optim_loss: 178954.9141
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9941; val_auprc_score: 0.9927; val_best_acc_score: 0.9682; val_best_f1_score: 0.9687; train_kl_reg_loss: 4464.4403; train_edge_recon_loss: 79659.7939; train_gene_expr_recon_loss: 97172.6310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181296.8654; train_optim_loss: 181296.8654; val_kl_reg_loss: 4377.5107; val_edge_recon_loss: 79339.3125; val_gene_expr_recon_loss: 96365.8164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180082.6406; val_optim_loss: 180082.6406

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9942; val_auprc_score: 0.9932; val_best_acc_score: 0.9667; val_best_f1_score: 0.9672; train_kl_reg_loss: 4456.0297; train_edge_recon_loss: 79531.7446; train_gene_expr_recon_loss: 97150.7945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181138.5709; train_optim_loss: 181138.5709; val_kl_reg_loss: 4377.4502; val_edge_recon_loss: 78257.3008; val_gene_expr_recon_loss: 95998.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178633.5156; val_optim_loss: 178633.5156
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9949; val_auprc_score: 0.9938; val_best_acc_score: 0.9689; val_best_f1_score: 0.9692; train_kl_reg_loss: 4456.3714; train_edge_recon_loss: 78678.0162; train_gene_expr_recon_loss: 97114.2332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180248.6214; train_optim_loss: 180248.6214; val_kl_reg_loss: 4384.3621; val_edge_recon_loss: 78898.1289; val_gene_expr_recon_loss: 96212.4492; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179494.9453; val_optim_loss: 179494.9453
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9943; val_auprc_score: 0.9934; val_best_acc_score: 0.9685; val_best_f1_score: 0.9688; train_kl_reg_loss: 4455.8868; train_edge_recon_loss: 79455.7181; train_gene_expr_recon_loss: 96998.3834; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180909.9892; train_optim_loss: 180909.9892; val_kl_reg_loss: 4341.2742; val_edge_recon_loss: 78350.0273; val_gene_expr_recon_loss: 96059.4570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178750.7578; val_optim_loss: 178750.7578

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 1 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
Val AUROC score: 0.9941
Val AUPRC score: 0.9924
Val best accuracy score: 0.9674
Val best F1 score: 0.9678
Val gene expr MSE score: 1.3085
Duration of model training in run 8: 0 hours, 6 minutes and 9 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 265201
Number of validation edges: 29466
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9870; val_auprc_score: 0.9872; val_best_acc_score: 0.9377; val_best_f1_score: 0.9352; train_kl_reg_loss: 405.1998; train_edge_recon_loss: 101985.0000; train_gene_expr_recon_loss: 132542.9403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 234933.1415; train_optim_loss: 234933.1415; val_kl_reg_loss: 839.0150; val_edge_recon_loss: 115498.1250; val_gene_expr_recon_loss: 126867.5195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243204.6562; val_optim_loss: 243204.6562
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9407; val_auprc_score: 0.9382; val_best_acc_score: 0.8642; val_best_f1_score: 0.8721; train_kl_reg_loss: 1094.9627; train_edge_recon_loss: 100334.1319; train_gene_expr_recon_loss: 122878.4779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224307.5717; train_optim_loss: 224307.5717; val_kl_reg_loss: 1742.5303; val_edge_recon_loss: 99118.5391; val_gene_expr_recon_loss: 119977.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220838.2969; val_optim_loss: 220838.2969
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9334; val_auprc_score: 0.9284; val_best_acc_score: 0.8592; val_best_f1_score: 0.8648; train_kl_reg_loss: 3348.4097; train_edge_recon_loss: 90471.8732; train_gene_expr_recon_loss: 117887.5708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211707.8520; train_optim_loss: 211707.8520; val_kl_reg_loss: 4316.7612; val_edge_recon_loss: 87327.2656; val_gene_expr_recon_loss: 116000.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207644.8516; val_optim_loss: 207644.8516
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9507; val_auprc_score: 0.9499; val_best_acc_score: 0.8754; val_best_f1_score: 0.8773; train_kl_reg_loss: 4253.8339; train_edge_recon_loss: 86192.6921; train_gene_expr_recon_loss: 113712.7698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204159.2950; train_optim_loss: 204159.2950; val_kl_reg_loss: 4382.7175; val_edge_recon_loss: 84257.2734; val_gene_expr_recon_loss: 112030.6680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200670.6562; val_optim_loss: 200670.6562
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9669; val_auprc_score: 0.9675; val_best_acc_score: 0.9007; val_best_f1_score: 0.9016; train_kl_reg_loss: 4365.3704; train_edge_recon_loss: 84909.3318; train_gene_expr_recon_loss: 110264.4380; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199539.1406; train_optim_loss: 199539.1406; val_kl_reg_loss: 4360.2288; val_edge_recon_loss: 81345.1562; val_gene_expr_recon_loss: 109292.3398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194997.7266; val_optim_loss: 194997.7266
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9775; val_auprc_score: 0.9770; val_best_acc_score: 0.9224; val_best_f1_score: 0.9226; train_kl_reg_loss: 4338.1740; train_edge_recon_loss: 82569.3346; train_gene_expr_recon_loss: 107522.9246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194430.4338; train_optim_loss: 194430.4338; val_kl_reg_loss: 4393.5757; val_edge_recon_loss: 82640.1484; val_gene_expr_recon_loss: 106851.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193885.1250; val_optim_loss: 193885.1250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9845; val_auprc_score: 0.9842; val_best_acc_score: 0.9381; val_best_f1_score: 0.9384; train_kl_reg_loss: 4427.8022; train_edge_recon_loss: 81687.8920; train_gene_expr_recon_loss: 105187.9858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191303.6829; train_optim_loss: 191303.6829; val_kl_reg_loss: 4364.9529; val_edge_recon_loss: 80823.7148; val_gene_expr_recon_loss: 104466.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189655.3750; val_optim_loss: 189655.3750
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9884; val_auprc_score: 0.9869; val_best_acc_score: 0.9486; val_best_f1_score: 0.9487; train_kl_reg_loss: 4496.3013; train_edge_recon_loss: 81897.7385; train_gene_expr_recon_loss: 103263.0216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189657.0607; train_optim_loss: 189657.0607; val_kl_reg_loss: 4471.6191; val_edge_recon_loss: 80457.0547; val_gene_expr_recon_loss: 102857.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187786.5938; val_optim_loss: 187786.5938
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9910; val_auprc_score: 0.9891; val_best_acc_score: 0.9578; val_best_f1_score: 0.9580; train_kl_reg_loss: 4551.6934; train_edge_recon_loss: 80537.4789; train_gene_expr_recon_loss: 101682.9949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186772.1664; train_optim_loss: 186772.1664; val_kl_reg_loss: 4530.5991; val_edge_recon_loss: 79526.9180; val_gene_expr_recon_loss: 101414.8633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185472.3828; val_optim_loss: 185472.3828
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9924; val_auprc_score: 0.9915; val_best_acc_score: 0.9613; val_best_f1_score: 0.9616; train_kl_reg_loss: 4535.1873; train_edge_recon_loss: 80104.5657; train_gene_expr_recon_loss: 100512.2224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185151.9733; train_optim_loss: 185151.9733; val_kl_reg_loss: 4476.1987; val_edge_recon_loss: 79376.4023; val_gene_expr_recon_loss: 100429.9727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184282.5781; val_optim_loss: 184282.5781
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9932; val_auprc_score: 0.9917; val_best_acc_score: 0.9640; val_best_f1_score: 0.9643; train_kl_reg_loss: 4512.0543; train_edge_recon_loss: 80084.9426; train_gene_expr_recon_loss: 99430.0630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184027.0597; train_optim_loss: 184027.0597; val_kl_reg_loss: 4466.9614; val_edge_recon_loss: 78390.0703; val_gene_expr_recon_loss: 99552.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182409.5781; val_optim_loss: 182409.5781
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9940; val_auprc_score: 0.9926; val_best_acc_score: 0.9675; val_best_f1_score: 0.9678; train_kl_reg_loss: 4477.7641; train_edge_recon_loss: 80327.0253; train_gene_expr_recon_loss: 98656.7054; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183461.4945; train_optim_loss: 183461.4945; val_kl_reg_loss: 4436.6750; val_edge_recon_loss: 77428.1484; val_gene_expr_recon_loss: 98647.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180511.8906; val_optim_loss: 180511.8906
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9942; val_auprc_score: 0.9932; val_best_acc_score: 0.9683; val_best_f1_score: 0.9685; train_kl_reg_loss: 4452.9552; train_edge_recon_loss: 79897.7978; train_gene_expr_recon_loss: 97985.6512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182336.4053; train_optim_loss: 182336.4053; val_kl_reg_loss: 4366.7627; val_edge_recon_loss: 77044.0352; val_gene_expr_recon_loss: 98010.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179421.4844; val_optim_loss: 179421.4844
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9945; val_auprc_score: 0.9935; val_best_acc_score: 0.9694; val_best_f1_score: 0.9696; train_kl_reg_loss: 4394.2227; train_edge_recon_loss: 78644.7835; train_gene_expr_recon_loss: 97383.4853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180422.4908; train_optim_loss: 180422.4908; val_kl_reg_loss: 4315.6465; val_edge_recon_loss: 80181.4336; val_gene_expr_recon_loss: 97592.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182089.6562; val_optim_loss: 182089.6562
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9945; val_auprc_score: 0.9927; val_best_acc_score: 0.9696; val_best_f1_score: 0.9698; train_kl_reg_loss: 4342.1270; train_edge_recon_loss: 79227.5041; train_gene_expr_recon_loss: 96843.4830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180413.1131; train_optim_loss: 180413.1131; val_kl_reg_loss: 4329.5388; val_edge_recon_loss: 79165.8438; val_gene_expr_recon_loss: 97011.6211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180507.0000; val_optim_loss: 180507.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9949; val_auprc_score: 0.9942; val_best_acc_score: 0.9702; val_best_f1_score: 0.9704; train_kl_reg_loss: 4308.8751; train_edge_recon_loss: 79390.0368; train_gene_expr_recon_loss: 96341.5248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180040.4375; train_optim_loss: 180040.4375; val_kl_reg_loss: 4214.8569; val_edge_recon_loss: 78950.5391; val_gene_expr_recon_loss: 96553.4414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179718.8359; val_optim_loss: 179718.8359

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9948; val_auprc_score: 0.9937; val_best_acc_score: 0.9700; val_best_f1_score: 0.9703; train_kl_reg_loss: 4262.3754; train_edge_recon_loss: 78733.4642; train_gene_expr_recon_loss: 96017.5239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179013.3640; train_optim_loss: 179013.3640; val_kl_reg_loss: 4263.4419; val_edge_recon_loss: 78528.0391; val_gene_expr_recon_loss: 96570.8789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179362.3594; val_optim_loss: 179362.3594
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9949; val_auprc_score: 0.9932; val_best_acc_score: 0.9702; val_best_f1_score: 0.9705; train_kl_reg_loss: 4281.0141; train_edge_recon_loss: 78689.5303; train_gene_expr_recon_loss: 96063.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179033.6884; train_optim_loss: 179033.6884; val_kl_reg_loss: 4210.4143; val_edge_recon_loss: 78192.5156; val_gene_expr_recon_loss: 96391.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178794.1250; val_optim_loss: 178794.1250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9945; val_auprc_score: 0.9930; val_best_acc_score: 0.9686; val_best_f1_score: 0.9691; train_kl_reg_loss: 4258.0286; train_edge_recon_loss: 79199.1048; train_gene_expr_recon_loss: 95932.2762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179389.4081; train_optim_loss: 179389.4081; val_kl_reg_loss: 4256.3547; val_edge_recon_loss: 77813.5000; val_gene_expr_recon_loss: 96537.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178606.8984; val_optim_loss: 178606.8984
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9946; val_auprc_score: 0.9927; val_best_acc_score: 0.9705; val_best_f1_score: 0.9708; train_kl_reg_loss: 4268.4653; train_edge_recon_loss: 78676.9481; train_gene_expr_recon_loss: 95932.1144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178877.5285; train_optim_loss: 178877.5285; val_kl_reg_loss: 4237.9736; val_edge_recon_loss: 78856.2305; val_gene_expr_recon_loss: 96595.9258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179690.1328; val_optim_loss: 179690.1328
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9950; val_auprc_score: 0.9935; val_best_acc_score: 0.9709; val_best_f1_score: 0.9711; train_kl_reg_loss: 4269.8612; train_edge_recon_loss: 78156.1907; train_gene_expr_recon_loss: 95930.0234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178356.0763; train_optim_loss: 178356.0763; val_kl_reg_loss: 4209.6436; val_edge_recon_loss: 78344.3828; val_gene_expr_recon_loss: 96313.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178867.4453; val_optim_loss: 178867.4453
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9948; val_auprc_score: 0.9936; val_best_acc_score: 0.9695; val_best_f1_score: 0.9698; train_kl_reg_loss: 4247.5573; train_edge_recon_loss: 78867.0188; train_gene_expr_recon_loss: 95850.9081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178965.4825; train_optim_loss: 178965.4825; val_kl_reg_loss: 4215.1240; val_edge_recon_loss: 76309.0039; val_gene_expr_recon_loss: 96398.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176922.7734; val_optim_loss: 176922.7734
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9952; val_auprc_score: 0.9940; val_best_acc_score: 0.9713; val_best_f1_score: 0.9716; train_kl_reg_loss: 4256.0212; train_edge_recon_loss: 78750.3529; train_gene_expr_recon_loss: 95778.9963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178785.3695; train_optim_loss: 178785.3695; val_kl_reg_loss: 4225.2236; val_edge_recon_loss: 78009.8633; val_gene_expr_recon_loss: 96287.3789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178522.4688; val_optim_loss: 178522.4688
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9950; val_auprc_score: 0.9942; val_best_acc_score: 0.9704; val_best_f1_score: 0.9706; train_kl_reg_loss: 4253.2100; train_edge_recon_loss: 79167.8493; train_gene_expr_recon_loss: 95739.6108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179160.6700; train_optim_loss: 179160.6700; val_kl_reg_loss: 4234.4556; val_edge_recon_loss: 78485.6680; val_gene_expr_recon_loss: 96263.9180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178984.0312; val_optim_loss: 178984.0312
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9950; val_auprc_score: 0.9937; val_best_acc_score: 0.9707; val_best_f1_score: 0.9709; train_kl_reg_loss: 4262.5379; train_edge_recon_loss: 79032.0303; train_gene_expr_recon_loss: 95708.9439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179003.5129; train_optim_loss: 179003.5129; val_kl_reg_loss: 4200.6589; val_edge_recon_loss: 77704.1523; val_gene_expr_recon_loss: 96223.0195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178127.8281; val_optim_loss: 178127.8281

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9951; val_auprc_score: 0.9935; val_best_acc_score: 0.9706; val_best_f1_score: 0.9709; train_kl_reg_loss: 4234.6936; train_edge_recon_loss: 78785.6153; train_gene_expr_recon_loss: 95663.8084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178684.1167; train_optim_loss: 178684.1167; val_kl_reg_loss: 4118.2612; val_edge_recon_loss: 78600.4180; val_gene_expr_recon_loss: 96359.1523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179077.8359; val_optim_loss: 179077.8359
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9951; val_auprc_score: 0.9941; val_best_acc_score: 0.9707; val_best_f1_score: 0.9710; train_kl_reg_loss: 4238.5529; train_edge_recon_loss: 78492.8258; train_gene_expr_recon_loss: 95653.7918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178385.1710; train_optim_loss: 178385.1710; val_kl_reg_loss: 4112.8960; val_edge_recon_loss: 77872.9531; val_gene_expr_recon_loss: 96142.3945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178128.2422; val_optim_loss: 178128.2422
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9951; val_auprc_score: 0.9937; val_best_acc_score: 0.9704; val_best_f1_score: 0.9706; train_kl_reg_loss: 4231.6854; train_edge_recon_loss: 79184.8695; train_gene_expr_recon_loss: 95726.6259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179143.1801; train_optim_loss: 179143.1801; val_kl_reg_loss: 4105.7186; val_edge_recon_loss: 78159.1758; val_gene_expr_recon_loss: 96203.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178468.2266; val_optim_loss: 178468.2266

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 8 min 46 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
Val AUROC score: 0.9952
Val AUPRC score: 0.9939
Val best accuracy score: 0.9705
Val best F1 score: 0.9706
Val gene expr MSE score: 1.2659
Duration of model training in run 9: 0 hours, 8 minutes and 56 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 265201
Number of validation edges: 29466
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9853; val_auprc_score: 0.9852; val_best_acc_score: 0.9318; val_best_f1_score: 0.9294; train_kl_reg_loss: 543.7953; train_edge_recon_loss: 101473.9655; train_gene_expr_recon_loss: 132228.6222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 234246.3814; train_optim_loss: 234246.3814; val_kl_reg_loss: 1079.1052; val_edge_recon_loss: 117073.3125; val_gene_expr_recon_loss: 125276.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243428.6719; val_optim_loss: 243428.6719
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9397; val_auprc_score: 0.9354; val_best_acc_score: 0.8668; val_best_f1_score: 0.8726; train_kl_reg_loss: 1140.2428; train_edge_recon_loss: 100170.5864; train_gene_expr_recon_loss: 122841.2555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224152.0836; train_optim_loss: 224152.0836; val_kl_reg_loss: 1946.9850; val_edge_recon_loss: 95610.4609; val_gene_expr_recon_loss: 119735.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217292.6719; val_optim_loss: 217292.6719
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9418; val_auprc_score: 0.9395; val_best_acc_score: 0.8616; val_best_f1_score: 0.8667; train_kl_reg_loss: 3596.0035; train_edge_recon_loss: 88439.6305; train_gene_expr_recon_loss: 118405.5772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210441.2114; train_optim_loss: 210441.2114; val_kl_reg_loss: 4306.1038; val_edge_recon_loss: 85969.6055; val_gene_expr_recon_loss: 115662.4180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205938.1250; val_optim_loss: 205938.1250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9555; val_auprc_score: 0.9549; val_best_acc_score: 0.8813; val_best_f1_score: 0.8825; train_kl_reg_loss: 4334.6440; train_edge_recon_loss: 85233.2716; train_gene_expr_recon_loss: 114016.3667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203584.2822; train_optim_loss: 203584.2822; val_kl_reg_loss: 4430.9297; val_edge_recon_loss: 81153.6641; val_gene_expr_recon_loss: 112061.5742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197646.1641; val_optim_loss: 197646.1641
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9698; val_auprc_score: 0.9695; val_best_acc_score: 0.9075; val_best_f1_score: 0.9086; train_kl_reg_loss: 4254.2567; train_edge_recon_loss: 84124.1723; train_gene_expr_recon_loss: 110718.4301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199096.8585; train_optim_loss: 199096.8585; val_kl_reg_loss: 4211.0010; val_edge_recon_loss: 81018.4062; val_gene_expr_recon_loss: 109192.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194422.0469; val_optim_loss: 194422.0469
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9809; val_auprc_score: 0.9801; val_best_acc_score: 0.9302; val_best_f1_score: 0.9307; train_kl_reg_loss: 4235.9991; train_edge_recon_loss: 82724.3097; train_gene_expr_recon_loss: 108022.3851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194982.6912; train_optim_loss: 194982.6912; val_kl_reg_loss: 4262.2622; val_edge_recon_loss: 80672.1250; val_gene_expr_recon_loss: 106571.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191506.1172; val_optim_loss: 191506.1172
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9864; val_auprc_score: 0.9857; val_best_acc_score: 0.9422; val_best_f1_score: 0.9426; train_kl_reg_loss: 4334.2873; train_edge_recon_loss: 81611.0432; train_gene_expr_recon_loss: 105498.2335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191443.5616; train_optim_loss: 191443.5616; val_kl_reg_loss: 4314.0325; val_edge_recon_loss: 81135.4492; val_gene_expr_recon_loss: 104274.1055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189723.5938; val_optim_loss: 189723.5938
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9895; val_auprc_score: 0.9883; val_best_acc_score: 0.9503; val_best_f1_score: 0.9507; train_kl_reg_loss: 4423.2893; train_edge_recon_loss: 80917.0528; train_gene_expr_recon_loss: 103589.2174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188929.5588; train_optim_loss: 188929.5588; val_kl_reg_loss: 4369.3010; val_edge_recon_loss: 80029.0742; val_gene_expr_recon_loss: 102459.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186858.1562; val_optim_loss: 186858.1562
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9912; val_auprc_score: 0.9903; val_best_acc_score: 0.9574; val_best_f1_score: 0.9576; train_kl_reg_loss: 4431.1031; train_edge_recon_loss: 81109.5464; train_gene_expr_recon_loss: 101977.5510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187518.2004; train_optim_loss: 187518.2004; val_kl_reg_loss: 4427.6196; val_edge_recon_loss: 78705.4688; val_gene_expr_recon_loss: 101168.2227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184301.3125; val_optim_loss: 184301.3125
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9923; val_auprc_score: 0.9908; val_best_acc_score: 0.9610; val_best_f1_score: 0.9612; train_kl_reg_loss: 4440.7961; train_edge_recon_loss: 80295.2059; train_gene_expr_recon_loss: 100754.6117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185490.6140; train_optim_loss: 185490.6140; val_kl_reg_loss: 4361.3367; val_edge_recon_loss: 78608.9414; val_gene_expr_recon_loss: 100184.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183155.2031; val_optim_loss: 183155.2031
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9937; val_auprc_score: 0.9929; val_best_acc_score: 0.9649; val_best_f1_score: 0.9651; train_kl_reg_loss: 4386.7228; train_edge_recon_loss: 79391.8176; train_gene_expr_recon_loss: 99766.8070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183545.3502; train_optim_loss: 183545.3502; val_kl_reg_loss: 4355.4954; val_edge_recon_loss: 79295.7539; val_gene_expr_recon_loss: 99312.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182964.2031; val_optim_loss: 182964.2031
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9937; val_auprc_score: 0.9921; val_best_acc_score: 0.9658; val_best_f1_score: 0.9662; train_kl_reg_loss: 4361.9728; train_edge_recon_loss: 79293.8906; train_gene_expr_recon_loss: 98847.0795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182502.9449; train_optim_loss: 182502.9449; val_kl_reg_loss: 4366.3994; val_edge_recon_loss: 79176.1406; val_gene_expr_recon_loss: 98379.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181921.8281; val_optim_loss: 181921.8281
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9942; val_auprc_score: 0.9923; val_best_acc_score: 0.9677; val_best_f1_score: 0.9679; train_kl_reg_loss: 4323.3193; train_edge_recon_loss: 79272.4853; train_gene_expr_recon_loss: 98163.8341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181759.6397; train_optim_loss: 181759.6397; val_kl_reg_loss: 4150.4875; val_edge_recon_loss: 78135.7656; val_gene_expr_recon_loss: 97564.8320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179851.0859; val_optim_loss: 179851.0859
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9944; val_auprc_score: 0.9927; val_best_acc_score: 0.9687; val_best_f1_score: 0.9690; train_kl_reg_loss: 4253.8001; train_edge_recon_loss: 78781.4311; train_gene_expr_recon_loss: 97596.7619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180631.9926; train_optim_loss: 180631.9926; val_kl_reg_loss: 4264.6680; val_edge_recon_loss: 78253.9883; val_gene_expr_recon_loss: 96997.7695; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179516.4297; val_optim_loss: 179516.4297
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9952; val_auprc_score: 0.9943; val_best_acc_score: 0.9715; val_best_f1_score: 0.9718; train_kl_reg_loss: 4240.3496; train_edge_recon_loss: 78823.3575; train_gene_expr_recon_loss: 96924.8952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179988.6029; train_optim_loss: 179988.6029; val_kl_reg_loss: 4178.9404; val_edge_recon_loss: 77724.6211; val_gene_expr_recon_loss: 96640.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178543.6562; val_optim_loss: 178543.6562
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9953; val_auprc_score: 0.9942; val_best_acc_score: 0.9712; val_best_f1_score: 0.9715; train_kl_reg_loss: 4212.5951; train_edge_recon_loss: 79104.4508; train_gene_expr_recon_loss: 96488.9945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179806.0395; train_optim_loss: 179806.0395; val_kl_reg_loss: 4188.2383; val_edge_recon_loss: 77099.2969; val_gene_expr_recon_loss: 96090.9414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177378.4766; val_optim_loss: 177378.4766
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9952; val_auprc_score: 0.9936; val_best_acc_score: 0.9719; val_best_f1_score: 0.9720; train_kl_reg_loss: 4191.8084; train_edge_recon_loss: 78715.0335; train_gene_expr_recon_loss: 95951.2229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178858.0634; train_optim_loss: 178858.0634; val_kl_reg_loss: 4104.2166; val_edge_recon_loss: 77475.6289; val_gene_expr_recon_loss: 95560.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177140.7422; val_optim_loss: 177140.7422
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9950; val_auprc_score: 0.9940; val_best_acc_score: 0.9703; val_best_f1_score: 0.9706; train_kl_reg_loss: 4149.7426; train_edge_recon_loss: 78479.7063; train_gene_expr_recon_loss: 95539.5515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178169.0000; train_optim_loss: 178169.0000; val_kl_reg_loss: 4068.1541; val_edge_recon_loss: 78041.1484; val_gene_expr_recon_loss: 95314.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177423.4688; val_optim_loss: 177423.4688
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9956; val_auprc_score: 0.9944; val_best_acc_score: 0.9731; val_best_f1_score: 0.9735; train_kl_reg_loss: 4124.6156; train_edge_recon_loss: 78978.6622; train_gene_expr_recon_loss: 95075.5267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178178.8033; train_optim_loss: 178178.8033; val_kl_reg_loss: 4097.4921; val_edge_recon_loss: 77963.4297; val_gene_expr_recon_loss: 94839.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176900.2188; val_optim_loss: 176900.2188
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9959; val_auprc_score: 0.9944; val_best_acc_score: 0.9743; val_best_f1_score: 0.9745; train_kl_reg_loss: 4102.1417; train_edge_recon_loss: 78351.8732; train_gene_expr_recon_loss: 94726.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177180.0478; train_optim_loss: 177180.0478; val_kl_reg_loss: 4087.4952; val_edge_recon_loss: 78616.1797; val_gene_expr_recon_loss: 94425.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177129.6562; val_optim_loss: 177129.6562
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9959; val_auprc_score: 0.9944; val_best_acc_score: 0.9746; val_best_f1_score: 0.9749; train_kl_reg_loss: 4092.4096; train_edge_recon_loss: 77730.7367; train_gene_expr_recon_loss: 94348.1301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176171.2767; train_optim_loss: 176171.2767; val_kl_reg_loss: 4072.8916; val_edge_recon_loss: 77853.9062; val_gene_expr_recon_loss: 93896.8867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175823.6797; val_optim_loss: 175823.6797
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9959; val_auprc_score: 0.9946; val_best_acc_score: 0.9744; val_best_f1_score: 0.9747; train_kl_reg_loss: 4058.7926; train_edge_recon_loss: 78133.0634; train_gene_expr_recon_loss: 93988.3594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176180.2151; train_optim_loss: 176180.2151; val_kl_reg_loss: 4021.8107; val_edge_recon_loss: 76507.9648; val_gene_expr_recon_loss: 93806.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174336.3672; val_optim_loss: 174336.3672
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9960; val_auprc_score: 0.9941; val_best_acc_score: 0.9752; val_best_f1_score: 0.9755; train_kl_reg_loss: 4041.9524; train_edge_recon_loss: 78276.1301; train_gene_expr_recon_loss: 93589.4743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175907.5570; train_optim_loss: 175907.5570; val_kl_reg_loss: 4025.1805; val_edge_recon_loss: 78756.6445; val_gene_expr_recon_loss: 93418.7852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176200.6094; val_optim_loss: 176200.6094
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9960; val_auprc_score: 0.9951; val_best_acc_score: 0.9746; val_best_f1_score: 0.9749; train_kl_reg_loss: 4031.4599; train_edge_recon_loss: 77887.9283; train_gene_expr_recon_loss: 93324.1213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175243.5110; train_optim_loss: 175243.5110; val_kl_reg_loss: 4025.1448; val_edge_recon_loss: 76886.3945; val_gene_expr_recon_loss: 93097.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174009.4219; val_optim_loss: 174009.4219
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9961; val_auprc_score: 0.9946; val_best_acc_score: 0.9764; val_best_f1_score: 0.9767; train_kl_reg_loss: 4012.7640; train_edge_recon_loss: 77647.0188; train_gene_expr_recon_loss: 93033.6029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174693.3842; train_optim_loss: 174693.3842; val_kl_reg_loss: 3930.4316; val_edge_recon_loss: 75976.6992; val_gene_expr_recon_loss: 92900.4727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172807.6016; val_optim_loss: 172807.6016
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9961; val_auprc_score: 0.9952; val_best_acc_score: 0.9753; val_best_f1_score: 0.9756; train_kl_reg_loss: 3886.2709; train_edge_recon_loss: 77674.4141; train_gene_expr_recon_loss: 92820.1641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174380.8502; train_optim_loss: 174380.8502; val_kl_reg_loss: 3606.7679; val_edge_recon_loss: 77540.4102; val_gene_expr_recon_loss: 92662.7852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173809.9688; val_optim_loss: 173809.9688
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9962; val_auprc_score: 0.9946; val_best_acc_score: 0.9764; val_best_f1_score: 0.9767; train_kl_reg_loss: 3817.9021; train_edge_recon_loss: 77760.9343; train_gene_expr_recon_loss: 92551.2178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174130.0551; train_optim_loss: 174130.0551; val_kl_reg_loss: 3695.7875; val_edge_recon_loss: 75943.5156; val_gene_expr_recon_loss: 92304.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171943.5078; val_optim_loss: 171943.5078
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9964; val_auprc_score: 0.9952; val_best_acc_score: 0.9770; val_best_f1_score: 0.9772; train_kl_reg_loss: 3778.5251; train_edge_recon_loss: 77707.1250; train_gene_expr_recon_loss: 92225.3093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173710.9586; train_optim_loss: 173710.9586; val_kl_reg_loss: 3618.5073; val_edge_recon_loss: 77418.8594; val_gene_expr_recon_loss: 92096.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173133.8750; val_optim_loss: 173133.8750
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9964; val_auprc_score: 0.9944; val_best_acc_score: 0.9764; val_best_f1_score: 0.9767; train_kl_reg_loss: 3727.2690; train_edge_recon_loss: 77464.1769; train_gene_expr_recon_loss: 92034.9913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173226.4375; train_optim_loss: 173226.4375; val_kl_reg_loss: 3602.4741; val_edge_recon_loss: 77549.9258; val_gene_expr_recon_loss: 92083.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173236.3125; val_optim_loss: 173236.3125
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9966; val_auprc_score: 0.9951; val_best_acc_score: 0.9778; val_best_f1_score: 0.9780; train_kl_reg_loss: 3703.1121; train_edge_recon_loss: 77267.3051; train_gene_expr_recon_loss: 91818.8065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172789.2261; train_optim_loss: 172789.2261; val_kl_reg_loss: 3652.8936; val_edge_recon_loss: 77279.9258; val_gene_expr_recon_loss: 91612.2305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172545.0469; val_optim_loss: 172545.0469

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9969; val_auprc_score: 0.9955; val_best_acc_score: 0.9786; val_best_f1_score: 0.9788; train_kl_reg_loss: 3711.5224; train_edge_recon_loss: 77928.6673; train_gene_expr_recon_loss: 91630.0441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173270.2335; train_optim_loss: 173270.2335; val_kl_reg_loss: 3602.8547; val_edge_recon_loss: 75405.4023; val_gene_expr_recon_loss: 91668.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170676.6562; val_optim_loss: 170676.6562
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9965; val_auprc_score: 0.9956; val_best_acc_score: 0.9769; val_best_f1_score: 0.9772; train_kl_reg_loss: 3665.4302; train_edge_recon_loss: 77649.6181; train_gene_expr_recon_loss: 91582.3488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172897.3980; train_optim_loss: 172897.3980; val_kl_reg_loss: 3591.5841; val_edge_recon_loss: 76607.0391; val_gene_expr_recon_loss: 91652.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171851.4062; val_optim_loss: 171851.4062
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9968; val_auprc_score: 0.9959; val_best_acc_score: 0.9781; val_best_f1_score: 0.9783; train_kl_reg_loss: 3695.5078; train_edge_recon_loss: 77362.9187; train_gene_expr_recon_loss: 91652.5464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172710.9733; train_optim_loss: 172710.9733; val_kl_reg_loss: 3608.0967; val_edge_recon_loss: 76819.8477; val_gene_expr_recon_loss: 91527.7383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171955.6719; val_optim_loss: 171955.6719
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9965; val_auprc_score: 0.9948; val_best_acc_score: 0.9778; val_best_f1_score: 0.9780; train_kl_reg_loss: 3682.2424; train_edge_recon_loss: 78010.2270; train_gene_expr_recon_loss: 91518.3860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173210.8548; train_optim_loss: 173210.8548; val_kl_reg_loss: 3598.6455; val_edge_recon_loss: 76289.9414; val_gene_expr_recon_loss: 91493.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171382.2031; val_optim_loss: 171382.2031

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9968; val_auprc_score: 0.9958; val_best_acc_score: 0.9781; val_best_f1_score: 0.9783; train_kl_reg_loss: 3679.3539; train_edge_recon_loss: 77554.0767; train_gene_expr_recon_loss: 91604.9393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172838.3713; train_optim_loss: 172838.3713; val_kl_reg_loss: 3600.4318; val_edge_recon_loss: 76115.6289; val_gene_expr_recon_loss: 91401.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171117.9688; val_optim_loss: 171117.9688
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9966; val_auprc_score: 0.9953; val_best_acc_score: 0.9783; val_best_f1_score: 0.9786; train_kl_reg_loss: 3679.6001; train_edge_recon_loss: 78196.1153; train_gene_expr_recon_loss: 91519.3235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173395.0404; train_optim_loss: 173395.0404; val_kl_reg_loss: 3600.9293; val_edge_recon_loss: 76591.7812; val_gene_expr_recon_loss: 91641.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171834.1562; val_optim_loss: 171834.1562
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9963; val_auprc_score: 0.9948; val_best_acc_score: 0.9775; val_best_f1_score: 0.9777; train_kl_reg_loss: 3681.6982; train_edge_recon_loss: 77848.7495; train_gene_expr_recon_loss: 91524.7091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173055.1581; train_optim_loss: 173055.1581; val_kl_reg_loss: 3601.6985; val_edge_recon_loss: 76798.3359; val_gene_expr_recon_loss: 91515.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171915.0703; val_optim_loss: 171915.0703

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 12 min 2 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9965
Val AUPRC score: 0.9951
Val best accuracy score: 0.9779
Val best F1 score: 0.9780
Val gene expr MSE score: 1.0817
Duration of model training in run 10: 0 hours, 12 minutes and 12 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
