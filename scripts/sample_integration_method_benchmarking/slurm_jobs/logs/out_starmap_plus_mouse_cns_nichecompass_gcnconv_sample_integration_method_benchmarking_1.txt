Run timestamp: 31082023_102424_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '--edge_batch_size_list', '4096', '--node_batch_size_list', 'None', '--seeds', '1', '--run_index', '2', '--cell_type_key', 'Main_molecular_cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gcnconv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000', '--contrastive_logits_pos_ratio', '0.015625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 380406
Number of validation nodes: 42267
Number of training edges: 914339
Number of validation edges: 101593
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9442; val_auprc_score: 0.9696; val_best_acc_score: 0.9259; val_best_f1_score: 0.9507; train_kl_reg_loss: 19731.7136; train_edge_recon_loss: 1577867.4163; train_cat_covariates_contrastive_loss: 325421.8121; train_gene_expr_recon_loss: 2174245.1635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4097266.0882; train_optim_loss: 4097266.0882; val_kl_reg_loss: 23380.8585; val_edge_recon_loss: 1468673.6150; val_cat_covariates_contrastive_loss: 316686.5037; val_gene_expr_recon_loss: 1912295.2650; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3721036.2400; val_optim_loss: 3721036.2400
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9567; val_auprc_score: 0.9718; val_best_acc_score: 0.9420; val_best_f1_score: 0.9611; train_kl_reg_loss: 23808.9262; train_edge_recon_loss: 1449979.5140; train_cat_covariates_contrastive_loss: 317466.8933; train_gene_expr_recon_loss: 1837130.1138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3628385.4464; train_optim_loss: 3628385.4464; val_kl_reg_loss: 22741.1395; val_edge_recon_loss: 1457260.0750; val_cat_covariates_contrastive_loss: 316933.3125; val_gene_expr_recon_loss: 1788952.0950; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3585886.6400; val_optim_loss: 3585886.6400
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9586; val_auprc_score: 0.9711; val_best_acc_score: 0.9481; val_best_f1_score: 0.9651; train_kl_reg_loss: 22548.5108; train_edge_recon_loss: 1437927.3292; train_cat_covariates_contrastive_loss: 317070.5533; train_gene_expr_recon_loss: 1752382.8019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3529929.1987; train_optim_loss: 3529929.1987; val_kl_reg_loss: 21149.9034; val_edge_recon_loss: 1448843.8950; val_cat_covariates_contrastive_loss: 316392.4738; val_gene_expr_recon_loss: 1731455.8850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3517842.1400; val_optim_loss: 3517842.1400
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9601; val_auprc_score: 0.9711; val_best_acc_score: 0.9525; val_best_f1_score: 0.9679; train_kl_reg_loss: 20727.3684; train_edge_recon_loss: 1427515.8108; train_cat_covariates_contrastive_loss: 316927.3458; train_gene_expr_recon_loss: 1703406.2427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3468576.7656; train_optim_loss: 3468576.7656; val_kl_reg_loss: 19557.6337; val_edge_recon_loss: 1452006.7450; val_cat_covariates_contrastive_loss: 316223.6450; val_gene_expr_recon_loss: 1690947.2450; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3478735.3200; val_optim_loss: 3478735.3200
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9609; val_auprc_score: 0.9717; val_best_acc_score: 0.9540; val_best_f1_score: 0.9690; train_kl_reg_loss: 19021.8103; train_edge_recon_loss: 1424832.4888; train_cat_covariates_contrastive_loss: 316566.7404; train_gene_expr_recon_loss: 1667526.6590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3427947.6908; train_optim_loss: 3427947.6908; val_kl_reg_loss: 17816.6710; val_edge_recon_loss: 1445043.2250; val_cat_covariates_contrastive_loss: 316375.4150; val_gene_expr_recon_loss: 1657407.5300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3436642.8500; val_optim_loss: 3436642.8500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9607; val_auprc_score: 0.9708; val_best_acc_score: 0.9567; val_best_f1_score: 0.9708; train_kl_reg_loss: 17774.1644; train_edge_recon_loss: 1418263.1127; train_cat_covariates_contrastive_loss: 316506.6164; train_gene_expr_recon_loss: 1639790.0753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3392333.9699; train_optim_loss: 3392333.9699; val_kl_reg_loss: 16707.0360; val_edge_recon_loss: 1435087.2350; val_cat_covariates_contrastive_loss: 316130.2737; val_gene_expr_recon_loss: 1634696.8700; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3402621.4000; val_optim_loss: 3402621.4000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9618; val_auprc_score: 0.9715; val_best_acc_score: 0.9577; val_best_f1_score: 0.9715; train_kl_reg_loss: 16650.7818; train_edge_recon_loss: 1417098.4325; train_cat_covariates_contrastive_loss: 316489.0844; train_gene_expr_recon_loss: 1617127.6066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3367365.9107; train_optim_loss: 3367365.9107; val_kl_reg_loss: 15887.8958; val_edge_recon_loss: 1429932.7200; val_cat_covariates_contrastive_loss: 316411.5787; val_gene_expr_recon_loss: 1614840.2400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3377072.4100; val_optim_loss: 3377072.4100
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9623; val_auprc_score: 0.9715; val_best_acc_score: 0.9586; val_best_f1_score: 0.9720; train_kl_reg_loss: 15821.3564; train_edge_recon_loss: 1415436.6641; train_cat_covariates_contrastive_loss: 316350.3415; train_gene_expr_recon_loss: 1597921.2539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3345529.6250; train_optim_loss: 3345529.6250; val_kl_reg_loss: 14971.0202; val_edge_recon_loss: 1440154.4450; val_cat_covariates_contrastive_loss: 316454.8762; val_gene_expr_recon_loss: 1598586.8400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3370167.1800; val_optim_loss: 3370167.1800
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9614; val_auprc_score: 0.9707; val_best_acc_score: 0.9593; val_best_f1_score: 0.9725; train_kl_reg_loss: 15141.9129; train_edge_recon_loss: 1414499.6339; train_cat_covariates_contrastive_loss: 316376.9342; train_gene_expr_recon_loss: 1582387.7249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3328406.2076; train_optim_loss: 3328406.2076; val_kl_reg_loss: 14498.8748; val_edge_recon_loss: 1434353.0100; val_cat_covariates_contrastive_loss: 316085.0625; val_gene_expr_recon_loss: 1580980.4500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3345917.4400; val_optim_loss: 3345917.4400
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9612; val_auprc_score: 0.9704; val_best_acc_score: 0.9588; val_best_f1_score: 0.9722; train_kl_reg_loss: 14687.3808; train_edge_recon_loss: 1410869.5419; train_cat_covariates_contrastive_loss: 316433.6800; train_gene_expr_recon_loss: 1569863.1362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3311853.7333; train_optim_loss: 3311853.7333; val_kl_reg_loss: 14139.5668; val_edge_recon_loss: 1438515.7300; val_cat_covariates_contrastive_loss: 315937.7675; val_gene_expr_recon_loss: 1572321.9850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3340915.0700; val_optim_loss: 3340915.0700
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9626; val_auprc_score: 0.9716; val_best_acc_score: 0.9600; val_best_f1_score: 0.9730; train_kl_reg_loss: 14316.4968; train_edge_recon_loss: 1413647.8320; train_cat_covariates_contrastive_loss: 316397.5710; train_gene_expr_recon_loss: 1558022.9124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3302384.8259; train_optim_loss: 3302384.8259; val_kl_reg_loss: 13758.5990; val_edge_recon_loss: 1433387.0550; val_cat_covariates_contrastive_loss: 316058.7375; val_gene_expr_recon_loss: 1561815.1700; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3325019.5900; val_optim_loss: 3325019.5900
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9623; val_auprc_score: 0.9711; val_best_acc_score: 0.9607; val_best_f1_score: 0.9734; train_kl_reg_loss: 14071.1724; train_edge_recon_loss: 1412806.0619; train_cat_covariates_contrastive_loss: 316544.1560; train_gene_expr_recon_loss: 1549157.4247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3292578.8092; train_optim_loss: 3292578.8092; val_kl_reg_loss: 13621.6013; val_edge_recon_loss: 1430088.7450; val_cat_covariates_contrastive_loss: 316547.8013; val_gene_expr_recon_loss: 1554460.6850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3314718.8100; val_optim_loss: 3314718.8100
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9626; val_auprc_score: 0.9718; val_best_acc_score: 0.9605; val_best_f1_score: 0.9733; train_kl_reg_loss: 13937.3673; train_edge_recon_loss: 1407593.3700; train_cat_covariates_contrastive_loss: 316483.7334; train_gene_expr_recon_loss: 1541839.8767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3279854.3471; train_optim_loss: 3279854.3471; val_kl_reg_loss: 13408.3474; val_edge_recon_loss: 1433967.9300; val_cat_covariates_contrastive_loss: 316040.0413; val_gene_expr_recon_loss: 1544858.9600; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3308275.2900; val_optim_loss: 3308275.2900
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9643; val_auprc_score: 0.9733; val_best_acc_score: 0.9612; val_best_f1_score: 0.9738; train_kl_reg_loss: 13789.1396; train_edge_recon_loss: 1409379.9375; train_cat_covariates_contrastive_loss: 316278.8124; train_gene_expr_recon_loss: 1535123.8756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3274571.7634; train_optim_loss: 3274571.7634; val_kl_reg_loss: 13250.1929; val_edge_recon_loss: 1429723.5000; val_cat_covariates_contrastive_loss: 316083.4050; val_gene_expr_recon_loss: 1540494.4900; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3299551.6100; val_optim_loss: 3299551.6100
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9638; val_auprc_score: 0.9725; val_best_acc_score: 0.9620; val_best_f1_score: 0.9743; train_kl_reg_loss: 13708.8132; train_edge_recon_loss: 1405817.1373; train_cat_covariates_contrastive_loss: 316471.5233; train_gene_expr_recon_loss: 1528658.5926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3264656.0681; train_optim_loss: 3264656.0681; val_kl_reg_loss: 13628.8311; val_edge_recon_loss: 1421706.8050; val_cat_covariates_contrastive_loss: 315652.7913; val_gene_expr_recon_loss: 1535639.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3286627.9000; val_optim_loss: 3286627.9000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9621; val_auprc_score: 0.9714; val_best_acc_score: 0.9615; val_best_f1_score: 0.9741; train_kl_reg_loss: 13642.8765; train_edge_recon_loss: 1406192.7494; train_cat_covariates_contrastive_loss: 316261.9475; train_gene_expr_recon_loss: 1523282.3538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3259379.9297; train_optim_loss: 3259379.9297; val_kl_reg_loss: 13315.1607; val_edge_recon_loss: 1421556.5500; val_cat_covariates_contrastive_loss: 316191.6813; val_gene_expr_recon_loss: 1530955.1750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3282018.5900; val_optim_loss: 3282018.5900
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9631; val_auprc_score: 0.9716; val_best_acc_score: 0.9618; val_best_f1_score: 0.9742; train_kl_reg_loss: 13569.8244; train_edge_recon_loss: 1407234.2824; train_cat_covariates_contrastive_loss: 316227.1267; train_gene_expr_recon_loss: 1518742.1836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3255773.4051; train_optim_loss: 3255773.4051; val_kl_reg_loss: 13345.0023; val_edge_recon_loss: 1427405.5650; val_cat_covariates_contrastive_loss: 315869.7075; val_gene_expr_recon_loss: 1528111.3800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3284731.6800; val_optim_loss: 3284731.6800
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9617; val_auprc_score: 0.9706; val_best_acc_score: 0.9615; val_best_f1_score: 0.9740; train_kl_reg_loss: 13576.8091; train_edge_recon_loss: 1406857.8002; train_cat_covariates_contrastive_loss: 316301.3153; train_gene_expr_recon_loss: 1515185.6607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3251921.5826; train_optim_loss: 3251921.5826; val_kl_reg_loss: 13206.9532; val_edge_recon_loss: 1429407.3050; val_cat_covariates_contrastive_loss: 316035.3613; val_gene_expr_recon_loss: 1521402.8850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3280052.5100; val_optim_loss: 3280052.5100
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9629; val_auprc_score: 0.9718; val_best_acc_score: 0.9619; val_best_f1_score: 0.9743; train_kl_reg_loss: 13531.1045; train_edge_recon_loss: 1404974.0251; train_cat_covariates_contrastive_loss: 316182.5953; train_gene_expr_recon_loss: 1510751.5179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3245439.2444; train_optim_loss: 3245439.2444; val_kl_reg_loss: 13160.5023; val_edge_recon_loss: 1427799.2500; val_cat_covariates_contrastive_loss: 316082.3075; val_gene_expr_recon_loss: 1517782.8200; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3274824.8600; val_optim_loss: 3274824.8600
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9621; val_auprc_score: 0.9707; val_best_acc_score: 0.9624; val_best_f1_score: 0.9746; train_kl_reg_loss: 13457.5291; train_edge_recon_loss: 1405541.7595; train_cat_covariates_contrastive_loss: 316175.1186; train_gene_expr_recon_loss: 1507501.2455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3242675.6496; train_optim_loss: 3242675.6496; val_kl_reg_loss: 13119.3142; val_edge_recon_loss: 1427681.5200; val_cat_covariates_contrastive_loss: 316299.7825; val_gene_expr_recon_loss: 1515157.4950; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3272258.1200; val_optim_loss: 3272258.1200
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9619; val_auprc_score: 0.9705; val_best_acc_score: 0.9622; val_best_f1_score: 0.9744; train_kl_reg_loss: 13485.7619; train_edge_recon_loss: 1403463.7746; train_cat_covariates_contrastive_loss: 316197.5338; train_gene_expr_recon_loss: 1504427.2997; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3237574.3672; train_optim_loss: 3237574.3672; val_kl_reg_loss: 13275.1155; val_edge_recon_loss: 1432439.3000; val_cat_covariates_contrastive_loss: 315981.4225; val_gene_expr_recon_loss: 1513010.3850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3274706.2000; val_optim_loss: 3274706.2000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9649; val_auprc_score: 0.9729; val_best_acc_score: 0.9629; val_best_f1_score: 0.9749; train_kl_reg_loss: 13464.2082; train_edge_recon_loss: 1405937.1562; train_cat_covariates_contrastive_loss: 316197.6943; train_gene_expr_recon_loss: 1501469.4090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3237068.4621; train_optim_loss: 3237068.4621; val_kl_reg_loss: 13242.0384; val_edge_recon_loss: 1432350.3350; val_cat_covariates_contrastive_loss: 315759.8387; val_gene_expr_recon_loss: 1509511.2600; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3270863.4800; val_optim_loss: 3270863.4800
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9643; val_auprc_score: 0.9726; val_best_acc_score: 0.9641; val_best_f1_score: 0.9757; train_kl_reg_loss: 13370.4979; train_edge_recon_loss: 1406183.4844; train_cat_covariates_contrastive_loss: 316122.9224; train_gene_expr_recon_loss: 1499180.4503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3234857.3583; train_optim_loss: 3234857.3583; val_kl_reg_loss: 13039.3196; val_edge_recon_loss: 1425675.7450; val_cat_covariates_contrastive_loss: 316018.3837; val_gene_expr_recon_loss: 1507193.0950; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3261926.5400; val_optim_loss: 3261926.5400
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9624; val_auprc_score: 0.9715; val_best_acc_score: 0.9626; val_best_f1_score: 0.9748; train_kl_reg_loss: 13425.2170; train_edge_recon_loss: 1404798.0519; train_cat_covariates_contrastive_loss: 316193.5679; train_gene_expr_recon_loss: 1496883.5569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3231300.4085; train_optim_loss: 3231300.4085; val_kl_reg_loss: 13093.0243; val_edge_recon_loss: 1423512.2050; val_cat_covariates_contrastive_loss: 315965.7000; val_gene_expr_recon_loss: 1506014.7650; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3258585.7200; val_optim_loss: 3258585.7200
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9640; val_auprc_score: 0.9720; val_best_acc_score: 0.9639; val_best_f1_score: 0.9756; train_kl_reg_loss: 13389.7657; train_edge_recon_loss: 1403720.2667; train_cat_covariates_contrastive_loss: 316137.2214; train_gene_expr_recon_loss: 1494643.5737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3227890.8292; train_optim_loss: 3227890.8292; val_kl_reg_loss: 12968.6998; val_edge_recon_loss: 1434359.4150; val_cat_covariates_contrastive_loss: 316339.6600; val_gene_expr_recon_loss: 1504374.5900; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3268042.3800; val_optim_loss: 3268042.3800
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9634; val_auprc_score: 0.9718; val_best_acc_score: 0.9639; val_best_f1_score: 0.9757; train_kl_reg_loss: 13355.0154; train_edge_recon_loss: 1406811.8722; train_cat_covariates_contrastive_loss: 316021.0925; train_gene_expr_recon_loss: 1492946.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3229134.3092; train_optim_loss: 3229134.3092; val_kl_reg_loss: 13144.0009; val_edge_recon_loss: 1419165.7350; val_cat_covariates_contrastive_loss: 316029.0150; val_gene_expr_recon_loss: 1501877.6100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3250216.3300; val_optim_loss: 3250216.3300
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9643; val_auprc_score: 0.9726; val_best_acc_score: 0.9650; val_best_f1_score: 0.9763; train_kl_reg_loss: 13341.1309; train_edge_recon_loss: 1404676.2511; train_cat_covariates_contrastive_loss: 316066.0237; train_gene_expr_recon_loss: 1491457.0977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3225540.5022; train_optim_loss: 3225540.5022; val_kl_reg_loss: 13170.7918; val_edge_recon_loss: 1423020.5650; val_cat_covariates_contrastive_loss: 315872.2750; val_gene_expr_recon_loss: 1501709.3850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3253773.0400; val_optim_loss: 3253773.0400
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9644; val_auprc_score: 0.9729; val_best_acc_score: 0.9647; val_best_f1_score: 0.9762; train_kl_reg_loss: 13309.1290; train_edge_recon_loss: 1403937.7461; train_cat_covariates_contrastive_loss: 315946.9593; train_gene_expr_recon_loss: 1489423.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3222617.1217; train_optim_loss: 3222617.1217; val_kl_reg_loss: 13037.0686; val_edge_recon_loss: 1416047.6900; val_cat_covariates_contrastive_loss: 315770.8200; val_gene_expr_recon_loss: 1500207.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3245062.7000; val_optim_loss: 3245062.7000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9652; val_auprc_score: 0.9730; val_best_acc_score: 0.9654; val_best_f1_score: 0.9766; train_kl_reg_loss: 13353.0634; train_edge_recon_loss: 1402290.6763; train_cat_covariates_contrastive_loss: 316098.9907; train_gene_expr_recon_loss: 1488035.8973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3219778.6417; train_optim_loss: 3219778.6417; val_kl_reg_loss: 13116.7567; val_edge_recon_loss: 1424332.5450; val_cat_covariates_contrastive_loss: 315772.0525; val_gene_expr_recon_loss: 1498440.0750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3251661.4200; val_optim_loss: 3251661.4200
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9636; val_auprc_score: 0.9718; val_best_acc_score: 0.9648; val_best_f1_score: 0.9762; train_kl_reg_loss: 13324.5630; train_edge_recon_loss: 1405679.8873; train_cat_covariates_contrastive_loss: 316036.8641; train_gene_expr_recon_loss: 1486385.4643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3221426.7656; train_optim_loss: 3221426.7656; val_kl_reg_loss: 13031.9564; val_edge_recon_loss: 1430404.8500; val_cat_covariates_contrastive_loss: 316147.1013; val_gene_expr_recon_loss: 1496815.0100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3256398.9200; val_optim_loss: 3256398.9200
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9642; val_auprc_score: 0.9727; val_best_acc_score: 0.9642; val_best_f1_score: 0.9758; train_kl_reg_loss: 13300.2892; train_edge_recon_loss: 1403904.8661; train_cat_covariates_contrastive_loss: 315995.6106; train_gene_expr_recon_loss: 1485797.6629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3218998.4252; train_optim_loss: 3218998.4252; val_kl_reg_loss: 12899.9843; val_edge_recon_loss: 1429052.5050; val_cat_covariates_contrastive_loss: 316184.9575; val_gene_expr_recon_loss: 1497486.6600; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3255624.1000; val_optim_loss: 3255624.1000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9638; val_auprc_score: 0.9718; val_best_acc_score: 0.9650; val_best_f1_score: 0.9763; train_kl_reg_loss: 13316.7785; train_edge_recon_loss: 1404170.2176; train_cat_covariates_contrastive_loss: 316056.7203; train_gene_expr_recon_loss: 1484982.7366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3218526.4621; train_optim_loss: 3218526.4621; val_kl_reg_loss: 12933.2583; val_edge_recon_loss: 1427387.0650; val_cat_covariates_contrastive_loss: 315856.1375; val_gene_expr_recon_loss: 1496918.9000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3253095.3800; val_optim_loss: 3253095.3800

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9642; val_auprc_score: 0.9724; val_best_acc_score: 0.9651; val_best_f1_score: 0.9764; train_kl_reg_loss: 13151.0639; train_edge_recon_loss: 1400531.5748; train_cat_covariates_contrastive_loss: 316080.1440; train_gene_expr_recon_loss: 1479770.0525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3209532.8248; train_optim_loss: 3209532.8248; val_kl_reg_loss: 12879.1784; val_edge_recon_loss: 1413591.3650; val_cat_covariates_contrastive_loss: 315926.4675; val_gene_expr_recon_loss: 1493563.0450; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3235960.0500; val_optim_loss: 3235960.0500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9622; val_auprc_score: 0.9707; val_best_acc_score: 0.9645; val_best_f1_score: 0.9760; train_kl_reg_loss: 13143.5819; train_edge_recon_loss: 1401568.5419; train_cat_covariates_contrastive_loss: 315934.6869; train_gene_expr_recon_loss: 1479938.0056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3210584.8103; train_optim_loss: 3210584.8103; val_kl_reg_loss: 12773.3816; val_edge_recon_loss: 1421187.5200; val_cat_covariates_contrastive_loss: 316036.4000; val_gene_expr_recon_loss: 1492326.7100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3242324.0300; val_optim_loss: 3242324.0300
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9633; val_auprc_score: 0.9719; val_best_acc_score: 0.9648; val_best_f1_score: 0.9763; train_kl_reg_loss: 13119.2840; train_edge_recon_loss: 1400538.9515; train_cat_covariates_contrastive_loss: 315940.1876; train_gene_expr_recon_loss: 1479417.7489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3209016.1730; train_optim_loss: 3209016.1730; val_kl_reg_loss: 12808.5833; val_edge_recon_loss: 1419337.4150; val_cat_covariates_contrastive_loss: 315716.0662; val_gene_expr_recon_loss: 1492966.6550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3240828.7400; val_optim_loss: 3240828.7400
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9641; val_auprc_score: 0.9722; val_best_acc_score: 0.9650; val_best_f1_score: 0.9764; train_kl_reg_loss: 13106.9502; train_edge_recon_loss: 1399905.4950; train_cat_covariates_contrastive_loss: 316042.2773; train_gene_expr_recon_loss: 1479754.6094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3208809.3315; train_optim_loss: 3208809.3315; val_kl_reg_loss: 12757.4612; val_edge_recon_loss: 1422215.8150; val_cat_covariates_contrastive_loss: 315684.7275; val_gene_expr_recon_loss: 1491126.2800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3241784.2800; val_optim_loss: 3241784.2800
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9643; val_auprc_score: 0.9724; val_best_acc_score: 0.9650; val_best_f1_score: 0.9763; train_kl_reg_loss: 13099.9126; train_edge_recon_loss: 1400461.6546; train_cat_covariates_contrastive_loss: 315900.4201; train_gene_expr_recon_loss: 1479161.4671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3208623.4420; train_optim_loss: 3208623.4420; val_kl_reg_loss: 12751.8035; val_edge_recon_loss: 1423444.7900; val_cat_covariates_contrastive_loss: 316069.6400; val_gene_expr_recon_loss: 1492957.8800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3245224.1200; val_optim_loss: 3245224.1200

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9635; val_auprc_score: 0.9722; val_best_acc_score: 0.9650; val_best_f1_score: 0.9763; train_kl_reg_loss: 13059.7336; train_edge_recon_loss: 1402315.3510; train_cat_covariates_contrastive_loss: 315970.1550; train_gene_expr_recon_loss: 1478784.1964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3210129.4342; train_optim_loss: 3210129.4342; val_kl_reg_loss: 12744.0899; val_edge_recon_loss: 1420796.3750; val_cat_covariates_contrastive_loss: 315755.2675; val_gene_expr_recon_loss: 1489741.5950; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3239037.3500; val_optim_loss: 3239037.3500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9652; val_auprc_score: 0.9735; val_best_acc_score: 0.9653; val_best_f1_score: 0.9766; train_kl_reg_loss: 13048.6480; train_edge_recon_loss: 1401108.5731; train_cat_covariates_contrastive_loss: 315964.2241; train_gene_expr_recon_loss: 1478238.5910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3208360.0424; train_optim_loss: 3208360.0424; val_kl_reg_loss: 12751.5646; val_edge_recon_loss: 1420049.5850; val_cat_covariates_contrastive_loss: 315692.3325; val_gene_expr_recon_loss: 1493046.1700; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3241539.6500; val_optim_loss: 3241539.6500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9638; val_auprc_score: 0.9721; val_best_acc_score: 0.9644; val_best_f1_score: 0.9759; train_kl_reg_loss: 13046.5682; train_edge_recon_loss: 1402299.0485; train_cat_covariates_contrastive_loss: 315994.6812; train_gene_expr_recon_loss: 1478642.8934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3209983.1964; train_optim_loss: 3209983.1964; val_kl_reg_loss: 12758.1878; val_edge_recon_loss: 1426387.0250; val_cat_covariates_contrastive_loss: 316161.3812; val_gene_expr_recon_loss: 1491431.0950; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3246737.6700; val_optim_loss: 3246737.6700
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9643; val_auprc_score: 0.9722; val_best_acc_score: 0.9649; val_best_f1_score: 0.9762; train_kl_reg_loss: 13052.3257; train_edge_recon_loss: 1402344.4369; train_cat_covariates_contrastive_loss: 316037.4967; train_gene_expr_recon_loss: 1478419.2349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3209853.4900; train_optim_loss: 3209853.4900; val_kl_reg_loss: 12751.2728; val_edge_recon_loss: 1425319.2100; val_cat_covariates_contrastive_loss: 315802.2450; val_gene_expr_recon_loss: 1491476.1350; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3245348.9200; val_optim_loss: 3245348.9200

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 188 min 1 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
val AUROC score: 0.9642
val AUPRC score: 0.9727
val best accuracy score: 0.9655
val best F1 score: 0.9767
val target rna MSE score: 0.6269
val source rna MSE score: 0.1107
Val cat covariate0 mean sim diff: 0.0005
Duration of model training in run 2: 3 hours, 9 minutes and 16 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
