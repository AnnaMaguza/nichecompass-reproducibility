Run timestamp: 28082023_201718_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '8', '--edge_batch_size_list', '512', '--node_batch_size_list', 'None', '--seeds', '1', '--run_index', '2', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '100000.0', '--contrastive_logits_pos_ratio', '0.03125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 254146
Number of validation nodes: 28238
Number of training edges: 1162586
Number of validation edges: 129176
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9747; val_auprc_score: 0.9901; val_best_acc_score: 0.9442; val_best_f1_score: 0.9637; train_kl_reg_loss: 15579.3516; train_edge_recon_loss: 1363127.0678; train_cat_covariates_contrastive_loss: 65258.2081; train_gene_expr_recon_loss: 2756344.8435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4200309.4653; train_optim_loss: 4200309.4653; val_kl_reg_loss: 14499.2375; val_edge_recon_loss: 1337078.4901; val_cat_covariates_contrastive_loss: 65693.9335; val_gene_expr_recon_loss: 2440076.0800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3857347.7421; val_optim_loss: 3857347.7421
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9775; val_auprc_score: 0.9912; val_best_acc_score: 0.9492; val_best_f1_score: 0.9669; train_kl_reg_loss: 16353.1753; train_edge_recon_loss: 1321231.1584; train_cat_covariates_contrastive_loss: 65984.5656; train_gene_expr_recon_loss: 2277054.7885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3680623.6877; train_optim_loss: 3680623.6877; val_kl_reg_loss: 18361.3545; val_edge_recon_loss: 1330658.7984; val_cat_covariates_contrastive_loss: 65917.4561; val_gene_expr_recon_loss: 2165648.2406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3580585.8656; val_optim_loss: 3580585.8656
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9804; val_auprc_score: 0.9923; val_best_acc_score: 0.9529; val_best_f1_score: 0.9693; train_kl_reg_loss: 18972.4645; train_edge_recon_loss: 1316371.8048; train_cat_covariates_contrastive_loss: 66170.9861; train_gene_expr_recon_loss: 2106355.2395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3507870.4970; train_optim_loss: 3507870.4970; val_kl_reg_loss: 19856.4806; val_edge_recon_loss: 1325626.2480; val_cat_covariates_contrastive_loss: 66238.7817; val_gene_expr_recon_loss: 2067234.1107; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3478955.6126; val_optim_loss: 3478955.6126
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9815; val_auprc_score: 0.9928; val_best_acc_score: 0.9548; val_best_f1_score: 0.9704; train_kl_reg_loss: 20318.2019; train_edge_recon_loss: 1315568.6495; train_cat_covariates_contrastive_loss: 66185.8599; train_gene_expr_recon_loss: 2042239.8108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3444312.5223; train_optim_loss: 3444312.5223; val_kl_reg_loss: 20775.4839; val_edge_recon_loss: 1327170.1122; val_cat_covariates_contrastive_loss: 66009.2368; val_gene_expr_recon_loss: 2024074.1640; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3438029.0020; val_optim_loss: 3438029.0020
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9804; val_auprc_score: 0.9921; val_best_acc_score: 0.9548; val_best_f1_score: 0.9704; train_kl_reg_loss: 20901.7562; train_edge_recon_loss: 1316689.1428; train_cat_covariates_contrastive_loss: 66242.1255; train_gene_expr_recon_loss: 2010873.6729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3414706.6941; train_optim_loss: 3414706.6941; val_kl_reg_loss: 21722.9142; val_edge_recon_loss: 1336730.4461; val_cat_covariates_contrastive_loss: 66114.6801; val_gene_expr_recon_loss: 2005564.3883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3430132.4200; val_optim_loss: 3430132.4200
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9829; val_auprc_score: 0.9934; val_best_acc_score: 0.9556; val_best_f1_score: 0.9710; train_kl_reg_loss: 21514.5424; train_edge_recon_loss: 1317052.7733; train_cat_covariates_contrastive_loss: 66341.8543; train_gene_expr_recon_loss: 1988297.1115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3393206.2806; train_optim_loss: 3393206.2806; val_kl_reg_loss: 21126.0631; val_edge_recon_loss: 1330073.7816; val_cat_covariates_contrastive_loss: 66805.8831; val_gene_expr_recon_loss: 2014165.8799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3432171.6117; val_optim_loss: 3432171.6117
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9831; val_auprc_score: 0.9933; val_best_acc_score: 0.9575; val_best_f1_score: 0.9722; train_kl_reg_loss: 22079.4327; train_edge_recon_loss: 1316873.4101; train_cat_covariates_contrastive_loss: 66335.0628; train_gene_expr_recon_loss: 1976838.5161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3382126.4236; train_optim_loss: 3382126.4236; val_kl_reg_loss: 22750.5432; val_edge_recon_loss: 1326964.8340; val_cat_covariates_contrastive_loss: 66565.7582; val_gene_expr_recon_loss: 1979980.3458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3396261.4753; val_optim_loss: 3396261.4753
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9818; val_auprc_score: 0.9928; val_best_acc_score: 0.9569; val_best_f1_score: 0.9719; train_kl_reg_loss: 22497.1669; train_edge_recon_loss: 1316658.6667; train_cat_covariates_contrastive_loss: 66398.6077; train_gene_expr_recon_loss: 1962447.2597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3368001.7024; train_optim_loss: 3368001.7024; val_kl_reg_loss: 22526.4094; val_edge_recon_loss: 1327693.2540; val_cat_covariates_contrastive_loss: 66462.2500; val_gene_expr_recon_loss: 1960915.8903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3377597.8024; val_optim_loss: 3377597.8024
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9827; val_auprc_score: 0.9931; val_best_acc_score: 0.9584; val_best_f1_score: 0.9728; train_kl_reg_loss: 22873.8672; train_edge_recon_loss: 1314159.0188; train_cat_covariates_contrastive_loss: 66438.5878; train_gene_expr_recon_loss: 1954316.6344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3357788.1049; train_optim_loss: 3357788.1049; val_kl_reg_loss: 23384.9440; val_edge_recon_loss: 1326167.2357; val_cat_covariates_contrastive_loss: 66405.7361; val_gene_expr_recon_loss: 1953758.1023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3369716.0168; val_optim_loss: 3369716.0168
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9835; val_auprc_score: 0.9934; val_best_acc_score: 0.9590; val_best_f1_score: 0.9732; train_kl_reg_loss: 23317.9873; train_edge_recon_loss: 1313386.0876; train_cat_covariates_contrastive_loss: 66468.0037; train_gene_expr_recon_loss: 1946105.0803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3349277.1605; train_optim_loss: 3349277.1605; val_kl_reg_loss: 23592.0161; val_edge_recon_loss: 1323747.0168; val_cat_covariates_contrastive_loss: 66516.5746; val_gene_expr_recon_loss: 1945676.5934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3359532.1937; val_optim_loss: 3359532.1937
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9834; val_auprc_score: 0.9934; val_best_acc_score: 0.9587; val_best_f1_score: 0.9730; train_kl_reg_loss: 23683.6498; train_edge_recon_loss: 1314034.1766; train_cat_covariates_contrastive_loss: 66455.9523; train_gene_expr_recon_loss: 1939484.0124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3343657.7950; train_optim_loss: 3343657.7950; val_kl_reg_loss: 24039.4083; val_edge_recon_loss: 1325913.2021; val_cat_covariates_contrastive_loss: 66651.9337; val_gene_expr_recon_loss: 1941180.0756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3357784.6245; val_optim_loss: 3357784.6245
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9833; val_auprc_score: 0.9934; val_best_acc_score: 0.9569; val_best_f1_score: 0.9718; train_kl_reg_loss: 23938.1534; train_edge_recon_loss: 1315324.9911; train_cat_covariates_contrastive_loss: 66478.7664; train_gene_expr_recon_loss: 1930506.3851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3336248.2983; train_optim_loss: 3336248.2983; val_kl_reg_loss: 23167.8159; val_edge_recon_loss: 1328020.8958; val_cat_covariates_contrastive_loss: 66829.3981; val_gene_expr_recon_loss: 1937802.1996; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3355820.2905; val_optim_loss: 3355820.2905
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9834; val_auprc_score: 0.9934; val_best_acc_score: 0.9589; val_best_f1_score: 0.9731; train_kl_reg_loss: 24312.9035; train_edge_recon_loss: 1317433.4765; train_cat_covariates_contrastive_loss: 66474.7488; train_gene_expr_recon_loss: 1928089.4662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3336310.5942; train_optim_loss: 3336310.5942; val_kl_reg_loss: 24466.0916; val_edge_recon_loss: 1329698.0099; val_cat_covariates_contrastive_loss: 66769.5866; val_gene_expr_recon_loss: 1938857.2599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3359790.9377; val_optim_loss: 3359790.9377
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9833; val_auprc_score: 0.9932; val_best_acc_score: 0.9584; val_best_f1_score: 0.9728; train_kl_reg_loss: 24621.3811; train_edge_recon_loss: 1316068.6117; train_cat_covariates_contrastive_loss: 66584.4243; train_gene_expr_recon_loss: 1921464.7605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3328739.1743; train_optim_loss: 3328739.1743; val_kl_reg_loss: 24681.5880; val_edge_recon_loss: 1328860.0613; val_cat_covariates_contrastive_loss: 66682.6370; val_gene_expr_recon_loss: 1934563.6260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3354787.9051; val_optim_loss: 3354787.9051
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9836; val_auprc_score: 0.9934; val_best_acc_score: 0.9584; val_best_f1_score: 0.9728; train_kl_reg_loss: 24801.0495; train_edge_recon_loss: 1316830.1837; train_cat_covariates_contrastive_loss: 66570.4514; train_gene_expr_recon_loss: 1917091.0263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3325292.7152; train_optim_loss: 3325292.7152; val_kl_reg_loss: 24981.0334; val_edge_recon_loss: 1323775.4170; val_cat_covariates_contrastive_loss: 66796.0095; val_gene_expr_recon_loss: 1937322.3898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3352874.8518; val_optim_loss: 3352874.8518
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9831; val_auprc_score: 0.9931; val_best_acc_score: 0.9595; val_best_f1_score: 0.9735; train_kl_reg_loss: 25125.6170; train_edge_recon_loss: 1317615.5898; train_cat_covariates_contrastive_loss: 66643.6410; train_gene_expr_recon_loss: 1909686.6718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3319071.5199; train_optim_loss: 3319071.5199; val_kl_reg_loss: 25535.8048; val_edge_recon_loss: 1332875.5573; val_cat_covariates_contrastive_loss: 66571.8349; val_gene_expr_recon_loss: 1921567.5870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3346550.7974; val_optim_loss: 3346550.7974
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9831; val_auprc_score: 0.9933; val_best_acc_score: 0.9585; val_best_f1_score: 0.9729; train_kl_reg_loss: 25175.1184; train_edge_recon_loss: 1314644.0662; train_cat_covariates_contrastive_loss: 66611.1358; train_gene_expr_recon_loss: 1909695.3719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3316125.6920; train_optim_loss: 3316125.6920; val_kl_reg_loss: 26196.9744; val_edge_recon_loss: 1324295.3251; val_cat_covariates_contrastive_loss: 66654.8116; val_gene_expr_recon_loss: 1916973.5099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3334120.6265; val_optim_loss: 3334120.6265
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9845; val_auprc_score: 0.9938; val_best_acc_score: 0.9605; val_best_f1_score: 0.9741; train_kl_reg_loss: 25449.1736; train_edge_recon_loss: 1314321.1643; train_cat_covariates_contrastive_loss: 66752.8188; train_gene_expr_recon_loss: 1904830.2966; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3311353.4550; train_optim_loss: 3311353.4550; val_kl_reg_loss: 25292.7378; val_edge_recon_loss: 1325963.2811; val_cat_covariates_contrastive_loss: 66931.1112; val_gene_expr_recon_loss: 1920844.7757; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3339031.9111; val_optim_loss: 3339031.9111
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9821; val_auprc_score: 0.9928; val_best_acc_score: 0.9583; val_best_f1_score: 0.9728; train_kl_reg_loss: 25667.1658; train_edge_recon_loss: 1312902.1144; train_cat_covariates_contrastive_loss: 66658.9925; train_gene_expr_recon_loss: 1902552.1864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3307780.4557; train_optim_loss: 3307780.4557; val_kl_reg_loss: 25691.7276; val_edge_recon_loss: 1325387.1052; val_cat_covariates_contrastive_loss: 66756.2216; val_gene_expr_recon_loss: 1909092.1102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3326927.1660; val_optim_loss: 3326927.1660
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9838; val_auprc_score: 0.9936; val_best_acc_score: 0.9590; val_best_f1_score: 0.9732; train_kl_reg_loss: 25615.8144; train_edge_recon_loss: 1314688.2859; train_cat_covariates_contrastive_loss: 66715.5043; train_gene_expr_recon_loss: 1899106.0777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3306125.6810; train_optim_loss: 3306125.6810; val_kl_reg_loss: 25996.9296; val_edge_recon_loss: 1329923.1028; val_cat_covariates_contrastive_loss: 66699.4516; val_gene_expr_recon_loss: 1906448.8394; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3329068.3241; val_optim_loss: 3329068.3241
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9839; val_auprc_score: 0.9936; val_best_acc_score: 0.9598; val_best_f1_score: 0.9737; train_kl_reg_loss: 25771.4840; train_edge_recon_loss: 1314746.6309; train_cat_covariates_contrastive_loss: 66671.2617; train_gene_expr_recon_loss: 1895275.6926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3302465.0686; train_optim_loss: 3302465.0686; val_kl_reg_loss: 25796.7812; val_edge_recon_loss: 1335363.5973; val_cat_covariates_contrastive_loss: 66824.4819; val_gene_expr_recon_loss: 1903171.9289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3331156.7895; val_optim_loss: 3331156.7895
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9828; val_auprc_score: 0.9931; val_best_acc_score: 0.9598; val_best_f1_score: 0.9737; train_kl_reg_loss: 26131.2579; train_edge_recon_loss: 1316409.4358; train_cat_covariates_contrastive_loss: 66748.5976; train_gene_expr_recon_loss: 1898562.1874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3307851.4786; train_optim_loss: 3307851.4786; val_kl_reg_loss: 26309.9315; val_edge_recon_loss: 1323863.2816; val_cat_covariates_contrastive_loss: 66758.1350; val_gene_expr_recon_loss: 1902489.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3319420.3478; val_optim_loss: 3319420.3478
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9827; val_auprc_score: 0.9929; val_best_acc_score: 0.9592; val_best_f1_score: 0.9734; train_kl_reg_loss: 26178.3359; train_edge_recon_loss: 1314529.7024; train_cat_covariates_contrastive_loss: 66787.0265; train_gene_expr_recon_loss: 1890191.5963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3297686.6595; train_optim_loss: 3297686.6595; val_kl_reg_loss: 26690.0378; val_edge_recon_loss: 1324325.3528; val_cat_covariates_contrastive_loss: 66427.9629; val_gene_expr_recon_loss: 1911762.7712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3329206.1235; val_optim_loss: 3329206.1235
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9840; val_auprc_score: 0.9936; val_best_acc_score: 0.9601; val_best_f1_score: 0.9739; train_kl_reg_loss: 26421.8833; train_edge_recon_loss: 1313415.7433; train_cat_covariates_contrastive_loss: 66739.6228; train_gene_expr_recon_loss: 1889254.4111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3295831.6640; train_optim_loss: 3295831.6640; val_kl_reg_loss: 26665.0785; val_edge_recon_loss: 1320761.2604; val_cat_covariates_contrastive_loss: 66817.0808; val_gene_expr_recon_loss: 1893470.2806; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3307713.6986; val_optim_loss: 3307713.6986
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9834; val_auprc_score: 0.9933; val_best_acc_score: 0.9600; val_best_f1_score: 0.9738; train_kl_reg_loss: 26390.1893; train_edge_recon_loss: 1314749.4930; train_cat_covariates_contrastive_loss: 66760.9385; train_gene_expr_recon_loss: 1890128.0982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3298028.7214; train_optim_loss: 3298028.7214; val_kl_reg_loss: 27583.6914; val_edge_recon_loss: 1330128.4550; val_cat_covariates_contrastive_loss: 66573.6289; val_gene_expr_recon_loss: 1914443.9056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3338729.6828; val_optim_loss: 3338729.6828
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9833; val_auprc_score: 0.9931; val_best_acc_score: 0.9603; val_best_f1_score: 0.9741; train_kl_reg_loss: 26606.6409; train_edge_recon_loss: 1316393.8036; train_cat_covariates_contrastive_loss: 66817.5511; train_gene_expr_recon_loss: 1884668.0602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3294486.0542; train_optim_loss: 3294486.0542; val_kl_reg_loss: 26471.9734; val_edge_recon_loss: 1330572.1853; val_cat_covariates_contrastive_loss: 66804.4392; val_gene_expr_recon_loss: 1901237.7085; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3325086.3004; val_optim_loss: 3325086.3004
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9838; val_auprc_score: 0.9934; val_best_acc_score: 0.9610; val_best_f1_score: 0.9745; train_kl_reg_loss: 26693.9934; train_edge_recon_loss: 1316251.5583; train_cat_covariates_contrastive_loss: 66822.7867; train_gene_expr_recon_loss: 1881830.8851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3291599.2252; train_optim_loss: 3291599.2252; val_kl_reg_loss: 28973.9772; val_edge_recon_loss: 1324384.4941; val_cat_covariates_contrastive_loss: 66944.0978; val_gene_expr_recon_loss: 1893322.7347; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3313625.3103; val_optim_loss: 3313625.3103
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9842; val_auprc_score: 0.9937; val_best_acc_score: 0.9600; val_best_f1_score: 0.9738; train_kl_reg_loss: 27336.9018; train_edge_recon_loss: 1314324.2968; train_cat_covariates_contrastive_loss: 66823.8972; train_gene_expr_recon_loss: 1883555.7528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3292040.8483; train_optim_loss: 3292040.8483; val_kl_reg_loss: 26836.5850; val_edge_recon_loss: 1329803.5173; val_cat_covariates_contrastive_loss: 67037.2505; val_gene_expr_recon_loss: 1892097.8967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3315775.2460; val_optim_loss: 3315775.2460

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9844; val_auprc_score: 0.9937; val_best_acc_score: 0.9615; val_best_f1_score: 0.9748; train_kl_reg_loss: 26837.9994; train_edge_recon_loss: 1313421.1031; train_cat_covariates_contrastive_loss: 67026.6159; train_gene_expr_recon_loss: 1846818.7032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3254104.4249; train_optim_loss: 3254104.4249; val_kl_reg_loss: 26940.3234; val_edge_recon_loss: 1325882.9392; val_cat_covariates_contrastive_loss: 67077.9846; val_gene_expr_recon_loss: 1861265.4817; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3281166.7352; val_optim_loss: 3281166.7352
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9849; val_auprc_score: 0.9938; val_best_acc_score: 0.9615; val_best_f1_score: 0.9748; train_kl_reg_loss: 26651.6485; train_edge_recon_loss: 1312015.6915; train_cat_covariates_contrastive_loss: 67000.7672; train_gene_expr_recon_loss: 1839646.4665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3245314.5739; train_optim_loss: 3245314.5739; val_kl_reg_loss: 26512.0294; val_edge_recon_loss: 1332977.2564; val_cat_covariates_contrastive_loss: 67140.8967; val_gene_expr_recon_loss: 1857914.2026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3284544.3785; val_optim_loss: 3284544.3785
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9849; val_auprc_score: 0.9940; val_best_acc_score: 0.9622; val_best_f1_score: 0.9752; train_kl_reg_loss: 26296.5428; train_edge_recon_loss: 1312125.7121; train_cat_covariates_contrastive_loss: 66979.6567; train_gene_expr_recon_loss: 1837060.7307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3242462.6420; train_optim_loss: 3242462.6420; val_kl_reg_loss: 26034.7436; val_edge_recon_loss: 1324639.1428; val_cat_covariates_contrastive_loss: 67098.7846; val_gene_expr_recon_loss: 1854291.2204; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3272063.8804; val_optim_loss: 3272063.8804
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9847; val_auprc_score: 0.9937; val_best_acc_score: 0.9625; val_best_f1_score: 0.9754; train_kl_reg_loss: 25901.4974; train_edge_recon_loss: 1309778.9759; train_cat_covariates_contrastive_loss: 66915.4926; train_gene_expr_recon_loss: 1834966.3627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3237562.3308; train_optim_loss: 3237562.3308; val_kl_reg_loss: 25900.2271; val_edge_recon_loss: 1317499.2041; val_cat_covariates_contrastive_loss: 66897.1327; val_gene_expr_recon_loss: 1853343.6709; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3263640.2292; val_optim_loss: 3263640.2292
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9851; val_auprc_score: 0.9938; val_best_acc_score: 0.9626; val_best_f1_score: 0.9755; train_kl_reg_loss: 25607.4739; train_edge_recon_loss: 1313950.3666; train_cat_covariates_contrastive_loss: 66852.5858; train_gene_expr_recon_loss: 1834065.6723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3240476.1006; train_optim_loss: 3240476.1006; val_kl_reg_loss: 25384.1943; val_edge_recon_loss: 1326033.7643; val_cat_covariates_contrastive_loss: 66892.2720; val_gene_expr_recon_loss: 1853210.2683; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3271520.5059; val_optim_loss: 3271520.5059
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9851; val_auprc_score: 0.9940; val_best_acc_score: 0.9616; val_best_f1_score: 0.9749; train_kl_reg_loss: 25288.8065; train_edge_recon_loss: 1313338.6263; train_cat_covariates_contrastive_loss: 66855.0851; train_gene_expr_recon_loss: 1832312.7616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3237795.2787; train_optim_loss: 3237795.2787; val_kl_reg_loss: 25239.3872; val_edge_recon_loss: 1325519.2614; val_cat_covariates_contrastive_loss: 66920.4981; val_gene_expr_recon_loss: 1849292.7678; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3266971.9130; val_optim_loss: 3266971.9130
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9857; val_auprc_score: 0.9943; val_best_acc_score: 0.9630; val_best_f1_score: 0.9758; train_kl_reg_loss: 25118.1737; train_edge_recon_loss: 1309268.5610; train_cat_covariates_contrastive_loss: 66819.1227; train_gene_expr_recon_loss: 1831477.7535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3232683.6122; train_optim_loss: 3232683.6122; val_kl_reg_loss: 25096.7209; val_edge_recon_loss: 1317990.0420; val_cat_covariates_contrastive_loss: 66853.9782; val_gene_expr_recon_loss: 1848289.5178; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3258230.2540; val_optim_loss: 3258230.2540
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9850; val_auprc_score: 0.9940; val_best_acc_score: 0.9624; val_best_f1_score: 0.9754; train_kl_reg_loss: 24984.4804; train_edge_recon_loss: 1312010.3547; train_cat_covariates_contrastive_loss: 66825.9556; train_gene_expr_recon_loss: 1831081.4890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3234902.2782; train_optim_loss: 3234902.2782; val_kl_reg_loss: 24995.8091; val_edge_recon_loss: 1324544.6581; val_cat_covariates_contrastive_loss: 66854.4887; val_gene_expr_recon_loss: 1848670.8617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3265065.8271; val_optim_loss: 3265065.8271
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9852; val_auprc_score: 0.9941; val_best_acc_score: 0.9635; val_best_f1_score: 0.9761; train_kl_reg_loss: 24814.2241; train_edge_recon_loss: 1311518.6524; train_cat_covariates_contrastive_loss: 66828.6240; train_gene_expr_recon_loss: 1829524.3909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3232685.8904; train_optim_loss: 3232685.8904; val_kl_reg_loss: 24674.7107; val_edge_recon_loss: 1317382.4590; val_cat_covariates_contrastive_loss: 66993.8576; val_gene_expr_recon_loss: 1848444.7989; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3257495.8211; val_optim_loss: 3257495.8211
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9857; val_auprc_score: 0.9944; val_best_acc_score: 0.9630; val_best_f1_score: 0.9758; train_kl_reg_loss: 24614.5303; train_edge_recon_loss: 1311221.7627; train_cat_covariates_contrastive_loss: 66747.8816; train_gene_expr_recon_loss: 1828963.8563; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3231548.0280; train_optim_loss: 3231548.0280; val_kl_reg_loss: 24627.7232; val_edge_recon_loss: 1316526.4960; val_cat_covariates_contrastive_loss: 66805.5412; val_gene_expr_recon_loss: 1848042.8098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3256002.5642; val_optim_loss: 3256002.5642
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9852; val_auprc_score: 0.9940; val_best_acc_score: 0.9631; val_best_f1_score: 0.9759; train_kl_reg_loss: 24575.9250; train_edge_recon_loss: 1311257.1973; train_cat_covariates_contrastive_loss: 66693.1015; train_gene_expr_recon_loss: 1828987.7463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3231513.9704; train_optim_loss: 3231513.9704; val_kl_reg_loss: 24511.7827; val_edge_recon_loss: 1320378.0237; val_cat_covariates_contrastive_loss: 66697.4677; val_gene_expr_recon_loss: 1848711.9521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3260299.2243; val_optim_loss: 3260299.2243
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9850; val_auprc_score: 0.9940; val_best_acc_score: 0.9627; val_best_f1_score: 0.9757; train_kl_reg_loss: 24431.2594; train_edge_recon_loss: 1312036.5383; train_cat_covariates_contrastive_loss: 66743.1340; train_gene_expr_recon_loss: 1828435.2942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3231646.2261; train_optim_loss: 3231646.2261; val_kl_reg_loss: 24438.3456; val_edge_recon_loss: 1317905.0914; val_cat_covariates_contrastive_loss: 66661.4580; val_gene_expr_recon_loss: 1847999.0702; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3257003.9684; val_optim_loss: 3257003.9684
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9854; val_auprc_score: 0.9940; val_best_acc_score: 0.9632; val_best_f1_score: 0.9759; train_kl_reg_loss: 24225.5102; train_edge_recon_loss: 1312380.3898; train_cat_covariates_contrastive_loss: 66756.2484; train_gene_expr_recon_loss: 1827931.8561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3231294.0054; train_optim_loss: 3231294.0054; val_kl_reg_loss: 24340.0082; val_edge_recon_loss: 1327166.1808; val_cat_covariates_contrastive_loss: 66783.5394; val_gene_expr_recon_loss: 1847406.2006; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3265695.9121; val_optim_loss: 3265695.9121
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9859; val_auprc_score: 0.9943; val_best_acc_score: 0.9641; val_best_f1_score: 0.9765; train_kl_reg_loss: 24137.1014; train_edge_recon_loss: 1305672.4505; train_cat_covariates_contrastive_loss: 66764.9161; train_gene_expr_recon_loss: 1828595.2651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3225169.7366; train_optim_loss: 3225169.7366; val_kl_reg_loss: 24296.5556; val_edge_recon_loss: 1318573.0059; val_cat_covariates_contrastive_loss: 66746.2782; val_gene_expr_recon_loss: 1847333.1349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3256948.9723; val_optim_loss: 3256948.9723

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9853; val_auprc_score: 0.9941; val_best_acc_score: 0.9633; val_best_f1_score: 0.9759; train_kl_reg_loss: 24153.7300; train_edge_recon_loss: 1307990.4622; train_cat_covariates_contrastive_loss: 66702.7478; train_gene_expr_recon_loss: 1823550.7365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3222397.6736; train_optim_loss: 3222397.6736; val_kl_reg_loss: 24120.2178; val_edge_recon_loss: 1321431.5786; val_cat_covariates_contrastive_loss: 66845.3892; val_gene_expr_recon_loss: 1844075.0217; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3256472.2045; val_optim_loss: 3256472.2045
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9851; val_auprc_score: 0.9939; val_best_acc_score: 0.9628; val_best_f1_score: 0.9757; train_kl_reg_loss: 24063.7806; train_edge_recon_loss: 1310268.3470; train_cat_covariates_contrastive_loss: 66675.0604; train_gene_expr_recon_loss: 1823855.1954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3224862.3831; train_optim_loss: 3224862.3831; val_kl_reg_loss: 24090.6485; val_edge_recon_loss: 1319097.2164; val_cat_covariates_contrastive_loss: 66739.0860; val_gene_expr_recon_loss: 1842628.2258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3252555.1700; val_optim_loss: 3252555.1700
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9856; val_auprc_score: 0.9940; val_best_acc_score: 0.9631; val_best_f1_score: 0.9758; train_kl_reg_loss: 24020.2228; train_edge_recon_loss: 1308896.7944; train_cat_covariates_contrastive_loss: 66710.2717; train_gene_expr_recon_loss: 1822620.8317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3222248.1214; train_optim_loss: 3222248.1214; val_kl_reg_loss: 24027.8218; val_edge_recon_loss: 1316956.7841; val_cat_covariates_contrastive_loss: 66815.6149; val_gene_expr_recon_loss: 1842337.1571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3250137.3834; val_optim_loss: 3250137.3834
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9848; val_auprc_score: 0.9938; val_best_acc_score: 0.9632; val_best_f1_score: 0.9760; train_kl_reg_loss: 23975.5104; train_edge_recon_loss: 1310026.6561; train_cat_covariates_contrastive_loss: 66725.4547; train_gene_expr_recon_loss: 1822371.2515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3223098.8731; train_optim_loss: 3223098.8731; val_kl_reg_loss: 24010.4852; val_edge_recon_loss: 1315298.7120; val_cat_covariates_contrastive_loss: 66664.3214; val_gene_expr_recon_loss: 1841861.6255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3247835.1571; val_optim_loss: 3247835.1571
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9854; val_auprc_score: 0.9942; val_best_acc_score: 0.9635; val_best_f1_score: 0.9762; train_kl_reg_loss: 23928.9598; train_edge_recon_loss: 1309755.0709; train_cat_covariates_contrastive_loss: 66708.5888; train_gene_expr_recon_loss: 1822620.5008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3223013.1202; train_optim_loss: 3223013.1202; val_kl_reg_loss: 23979.5594; val_edge_recon_loss: 1317992.7169; val_cat_covariates_contrastive_loss: 66705.3772; val_gene_expr_recon_loss: 1844567.6571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3253245.3073; val_optim_loss: 3253245.3073
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9848; val_auprc_score: 0.9938; val_best_acc_score: 0.9629; val_best_f1_score: 0.9757; train_kl_reg_loss: 23894.3292; train_edge_recon_loss: 1310543.3907; train_cat_covariates_contrastive_loss: 66729.9982; train_gene_expr_recon_loss: 1822959.9674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3224127.6871; train_optim_loss: 3224127.6871; val_kl_reg_loss: 23899.3697; val_edge_recon_loss: 1313190.1645; val_cat_covariates_contrastive_loss: 66701.0931; val_gene_expr_recon_loss: 1845566.0573; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3249356.6828; val_optim_loss: 3249356.6828
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9850; val_auprc_score: 0.9938; val_best_acc_score: 0.9625; val_best_f1_score: 0.9755; train_kl_reg_loss: 23886.5675; train_edge_recon_loss: 1308825.2490; train_cat_covariates_contrastive_loss: 66730.3900; train_gene_expr_recon_loss: 1822144.6225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3221586.8255; train_optim_loss: 3221586.8255; val_kl_reg_loss: 23900.5079; val_edge_recon_loss: 1326078.5020; val_cat_covariates_contrastive_loss: 66803.0201; val_gene_expr_recon_loss: 1842371.5949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3259153.6314; val_optim_loss: 3259153.6314
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9859; val_auprc_score: 0.9943; val_best_acc_score: 0.9633; val_best_f1_score: 0.9759; train_kl_reg_loss: 23867.3537; train_edge_recon_loss: 1307573.5183; train_cat_covariates_contrastive_loss: 66718.5948; train_gene_expr_recon_loss: 1822064.7138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3220224.1825; train_optim_loss: 3220224.1825; val_kl_reg_loss: 23918.3410; val_edge_recon_loss: 1320731.7648; val_cat_covariates_contrastive_loss: 66791.5212; val_gene_expr_recon_loss: 1843554.1369; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3254995.7727; val_optim_loss: 3254995.7727

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9854; val_auprc_score: 0.9940; val_best_acc_score: 0.9627; val_best_f1_score: 0.9756; train_kl_reg_loss: 23879.3782; train_edge_recon_loss: 1309644.2479; train_cat_covariates_contrastive_loss: 66731.4236; train_gene_expr_recon_loss: 1821551.1115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3221806.1576; train_optim_loss: 3221806.1576; val_kl_reg_loss: 23908.5640; val_edge_recon_loss: 1318872.7134; val_cat_covariates_contrastive_loss: 66792.0225; val_gene_expr_recon_loss: 1845111.7564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3254685.0573; val_optim_loss: 3254685.0573
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9853; val_auprc_score: 0.9941; val_best_acc_score: 0.9634; val_best_f1_score: 0.9760; train_kl_reg_loss: 23861.6470; train_edge_recon_loss: 1312658.8132; train_cat_covariates_contrastive_loss: 66716.3464; train_gene_expr_recon_loss: 1821172.7816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3224409.5882; train_optim_loss: 3224409.5882; val_kl_reg_loss: 23888.7095; val_edge_recon_loss: 1320888.3755; val_cat_covariates_contrastive_loss: 66760.2471; val_gene_expr_recon_loss: 1842821.6581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3254358.9862; val_optim_loss: 3254358.9862
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9857; val_auprc_score: 0.9942; val_best_acc_score: 0.9633; val_best_f1_score: 0.9760; train_kl_reg_loss: 23853.0006; train_edge_recon_loss: 1310571.0042; train_cat_covariates_contrastive_loss: 66707.9572; train_gene_expr_recon_loss: 1821463.6999; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3222595.6645; train_optim_loss: 3222595.6645; val_kl_reg_loss: 23890.6595; val_edge_recon_loss: 1318283.4654; val_cat_covariates_contrastive_loss: 66838.3899; val_gene_expr_recon_loss: 1843383.1003; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3252395.6166; val_optim_loss: 3252395.6166
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9853; val_auprc_score: 0.9941; val_best_acc_score: 0.9629; val_best_f1_score: 0.9757; train_kl_reg_loss: 23836.0655; train_edge_recon_loss: 1310912.3112; train_cat_covariates_contrastive_loss: 66726.6632; train_gene_expr_recon_loss: 1821183.4173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3222658.4600; train_optim_loss: 3222658.4600; val_kl_reg_loss: 23866.3193; val_edge_recon_loss: 1321456.3577; val_cat_covariates_contrastive_loss: 66828.8133; val_gene_expr_recon_loss: 1843835.1937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3255986.6907; val_optim_loss: 3255986.6907

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1039 min 9 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
val AUROC score: 0.9707
val AUPRC score: 0.9850
val best accuracy score: 0.9573
val best F1 score: 0.9719
val target rna MSE score: 0.5048
val source rna MSE score: 0.0853
Val cat covariate0 mean sim diff: -0.0001
Val cat covariate1 mean sim diff: -0.0963
Duration of model training in run 2: 17 hours, 23 minutes and 1 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
