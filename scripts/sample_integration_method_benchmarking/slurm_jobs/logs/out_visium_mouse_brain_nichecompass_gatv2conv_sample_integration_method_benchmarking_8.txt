Run timestamp: 29082023_194454_8.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '6', '--edge_batch_size_list', '256', '--node_batch_size_list', 'None', '--seeds', '1', '--run_index', '2', '--cell_type_key', 'cell_type', '--filter_genes', '--n_svg', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'visium_mouse_brain', '--reference_batches', 'batch1', 'batch2', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'data', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '2', '2', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '5000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_8']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 32285 genes.
Keeping 32285 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1530, n_latent: 1520, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1520, n_addon_gp_input: 10, n_cat_covariates_embed_input: 4, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1520, n_addon_gp_input: 10, n_cat_covariates_embed_input: 4, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 10948
Number of validation nodes: 1216
Number of training edges: 33527
Number of validation edges: 3725
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8276; val_auprc_score: 0.9098; val_best_acc_score: 0.7724; val_best_f1_score: 0.8442; train_kl_reg_loss: 113367.6438; train_edge_recon_loss: 2616906.8588; train_cat_covariates_contrastive_loss: 3289508.3511; train_gene_expr_recon_loss: 76060156.5496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 82079939.3588; train_optim_loss: 82079939.3588; val_kl_reg_loss: 100680.2068; val_edge_recon_loss: 2711852.8000; val_cat_covariates_contrastive_loss: 3132862.3333; val_gene_expr_recon_loss: 55717127.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61662522.6667; val_optim_loss: 61662522.6667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8207; val_auprc_score: 0.8985; val_best_acc_score: 0.7671; val_best_f1_score: 0.8379; train_kl_reg_loss: 112956.8514; train_edge_recon_loss: 2581592.0649; train_cat_covariates_contrastive_loss: 3150134.2634; train_gene_expr_recon_loss: 52782328.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58627011.2977; train_optim_loss: 58627011.2977; val_kl_reg_loss: 116872.4563; val_edge_recon_loss: 2690621.6500; val_cat_covariates_contrastive_loss: 3133183.2000; val_gene_expr_recon_loss: 50310468.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56251145.6000; val_optim_loss: 56251145.6000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8406; val_auprc_score: 0.9121; val_best_acc_score: 0.7836; val_best_f1_score: 0.8549; train_kl_reg_loss: 93667.2384; train_edge_recon_loss: 2514991.5668; train_cat_covariates_contrastive_loss: 3161018.9962; train_gene_expr_recon_loss: 50142500.3664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55912178.0458; train_optim_loss: 55912178.0458; val_kl_reg_loss: 70393.9625; val_edge_recon_loss: 2532591.6167; val_cat_covariates_contrastive_loss: 3134427.8667; val_gene_expr_recon_loss: 49092349.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54829763.2000; val_optim_loss: 54829763.2000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8376; val_auprc_score: 0.9117; val_best_acc_score: 0.7903; val_best_f1_score: 0.8608; train_kl_reg_loss: 76542.1990; train_edge_recon_loss: 2276407.6078; train_cat_covariates_contrastive_loss: 3148748.5191; train_gene_expr_recon_loss: 49078008.3969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54579706.7786; train_optim_loss: 54579706.7786; val_kl_reg_loss: 87016.1589; val_edge_recon_loss: 2150219.8750; val_cat_covariates_contrastive_loss: 3134541.1167; val_gene_expr_recon_loss: 48408413.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53780191.2000; val_optim_loss: 53780191.2000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8338; val_auprc_score: 0.9073; val_best_acc_score: 0.7868; val_best_f1_score: 0.8600; train_kl_reg_loss: 92865.9752; train_edge_recon_loss: 2121805.8321; train_cat_covariates_contrastive_loss: 3137709.8321; train_gene_expr_recon_loss: 48335677.7099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53688059.5115; train_optim_loss: 53688059.5115; val_kl_reg_loss: 96526.4042; val_edge_recon_loss: 2137180.7833; val_cat_covariates_contrastive_loss: 3135229.3667; val_gene_expr_recon_loss: 47137392.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52506328.5333; val_optim_loss: 52506328.5333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8566; val_auprc_score: 0.9216; val_best_acc_score: 0.8154; val_best_f1_score: 0.8774; train_kl_reg_loss: 100402.6430; train_edge_recon_loss: 2055766.1450; train_cat_covariates_contrastive_loss: 3137505.9924; train_gene_expr_recon_loss: 47643543.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52937218.3511; train_optim_loss: 52937218.3511; val_kl_reg_loss: 100471.9833; val_edge_recon_loss: 2018526.8083; val_cat_covariates_contrastive_loss: 3137126.9333; val_gene_expr_recon_loss: 46808733.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52064859.2000; val_optim_loss: 52064859.2000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8599; val_auprc_score: 0.9208; val_best_acc_score: 0.8100; val_best_f1_score: 0.8733; train_kl_reg_loss: 98069.0048; train_edge_recon_loss: 2017399.7500; train_cat_covariates_contrastive_loss: 3137438.6832; train_gene_expr_recon_loss: 47083196.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52336104.2137; train_optim_loss: 52336104.2137; val_kl_reg_loss: 93552.1156; val_edge_recon_loss: 2032019.8500; val_cat_covariates_contrastive_loss: 3135741.6500; val_gene_expr_recon_loss: 46302261.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51563575.4667; val_optim_loss: 51563575.4667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8761; val_auprc_score: 0.9339; val_best_acc_score: 0.8199; val_best_f1_score: 0.8798; train_kl_reg_loss: 92370.8217; train_edge_recon_loss: 1989423.7195; train_cat_covariates_contrastive_loss: 3137503.7481; train_gene_expr_recon_loss: 46570307.8779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51789606.2595; train_optim_loss: 51789606.2595; val_kl_reg_loss: 93919.0901; val_edge_recon_loss: 1976216.4917; val_cat_covariates_contrastive_loss: 3136671.9667; val_gene_expr_recon_loss: 45872578.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51079385.8667; val_optim_loss: 51079385.8667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8736; val_auprc_score: 0.9304; val_best_acc_score: 0.8153; val_best_f1_score: 0.8761; train_kl_reg_loss: 88442.5519; train_edge_recon_loss: 1973301.6823; train_cat_covariates_contrastive_loss: 3138653.2328; train_gene_expr_recon_loss: 46089907.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51290305.4656; train_optim_loss: 51290305.4656; val_kl_reg_loss: 86450.3552; val_edge_recon_loss: 2030519.3333; val_cat_covariates_contrastive_loss: 3138605.9833; val_gene_expr_recon_loss: 45319431.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50575007.2000; val_optim_loss: 50575007.2000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8761; val_auprc_score: 0.9261; val_best_acc_score: 0.8215; val_best_f1_score: 0.8805; train_kl_reg_loss: 84641.3909; train_edge_recon_loss: 1973911.8349; train_cat_covariates_contrastive_loss: 3139930.6603; train_gene_expr_recon_loss: 45652100.9466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50850584.8244; train_optim_loss: 50850584.8244; val_kl_reg_loss: 80596.6193; val_edge_recon_loss: 1998902.6000; val_cat_covariates_contrastive_loss: 3139184.0000; val_gene_expr_recon_loss: 44733883.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49952566.9333; val_optim_loss: 49952566.9333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8901; val_auprc_score: 0.9357; val_best_acc_score: 0.8303; val_best_f1_score: 0.8836; train_kl_reg_loss: 79033.9717; train_edge_recon_loss: 1951203.9113; train_cat_covariates_contrastive_loss: 3141514.0286; train_gene_expr_recon_loss: 45228575.5420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50400327.3893; train_optim_loss: 50400327.3893; val_kl_reg_loss: 74347.1911; val_edge_recon_loss: 1987458.9000; val_cat_covariates_contrastive_loss: 3145821.9000; val_gene_expr_recon_loss: 44537797.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49745425.8667; val_optim_loss: 49745425.8667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8969; val_auprc_score: 0.9416; val_best_acc_score: 0.8377; val_best_f1_score: 0.8892; train_kl_reg_loss: 73953.7759; train_edge_recon_loss: 1942131.0296; train_cat_covariates_contrastive_loss: 3143205.1851; train_gene_expr_recon_loss: 44839789.8321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49999079.9084; train_optim_loss: 49999079.9084; val_kl_reg_loss: 71387.0510; val_edge_recon_loss: 1945034.3000; val_cat_covariates_contrastive_loss: 3142632.8333; val_gene_expr_recon_loss: 44254205.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49413258.9333; val_optim_loss: 49413258.9333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9004; val_auprc_score: 0.9432; val_best_acc_score: 0.8402; val_best_f1_score: 0.8913; train_kl_reg_loss: 70247.8412; train_edge_recon_loss: 1928731.7424; train_cat_covariates_contrastive_loss: 3145033.6966; train_gene_expr_recon_loss: 44477207.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49621220.1832; train_optim_loss: 49621220.1832; val_kl_reg_loss: 68566.2234; val_edge_recon_loss: 1935379.5333; val_cat_covariates_contrastive_loss: 3144616.4667; val_gene_expr_recon_loss: 43617005.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48765567.4667; val_optim_loss: 48765567.4667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9117; val_auprc_score: 0.9517; val_best_acc_score: 0.8558; val_best_f1_score: 0.8980; train_kl_reg_loss: 66814.8672; train_edge_recon_loss: 1917802.3693; train_cat_covariates_contrastive_loss: 3145917.7977; train_gene_expr_recon_loss: 44064522.0153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49195057.2519; train_optim_loss: 49195057.2519; val_kl_reg_loss: 64562.8581; val_edge_recon_loss: 1908310.7583; val_cat_covariates_contrastive_loss: 3145886.5167; val_gene_expr_recon_loss: 43376220.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48494980.5333; val_optim_loss: 48494980.5333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9073; val_auprc_score: 0.9441; val_best_acc_score: 0.8616; val_best_f1_score: 0.9026; train_kl_reg_loss: 63507.5186; train_edge_recon_loss: 1893844.7481; train_cat_covariates_contrastive_loss: 3147576.5897; train_gene_expr_recon_loss: 43742802.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48847731.6336; train_optim_loss: 48847731.6336; val_kl_reg_loss: 63873.0539; val_edge_recon_loss: 1892969.6667; val_cat_covariates_contrastive_loss: 3143074.6500; val_gene_expr_recon_loss: 43087687.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48187605.0667; val_optim_loss: 48187605.0667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9168; val_auprc_score: 0.9503; val_best_acc_score: 0.8604; val_best_f1_score: 0.9020; train_kl_reg_loss: 61340.0066; train_edge_recon_loss: 1878989.3674; train_cat_covariates_contrastive_loss: 3149512.6698; train_gene_expr_recon_loss: 43414209.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48504051.7252; train_optim_loss: 48504051.7252; val_kl_reg_loss: 59266.9203; val_edge_recon_loss: 1863034.9750; val_cat_covariates_contrastive_loss: 3149484.2500; val_gene_expr_recon_loss: 42928334.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48000120.0000; val_optim_loss: 48000120.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9164; val_auprc_score: 0.9493; val_best_acc_score: 0.8658; val_best_f1_score: 0.9059; train_kl_reg_loss: 58855.0402; train_edge_recon_loss: 1881080.2529; train_cat_covariates_contrastive_loss: 3148242.0878; train_gene_expr_recon_loss: 43166330.6870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48254508.1832; train_optim_loss: 48254508.1832; val_kl_reg_loss: 56771.1633; val_edge_recon_loss: 1887346.2250; val_cat_covariates_contrastive_loss: 3156152.8667; val_gene_expr_recon_loss: 42579459.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47679729.0667; val_optim_loss: 47679729.0667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9281; val_auprc_score: 0.9548; val_best_acc_score: 0.8764; val_best_f1_score: 0.9114; train_kl_reg_loss: 56894.1118; train_edge_recon_loss: 1865990.7548; train_cat_covariates_contrastive_loss: 3151973.2519; train_gene_expr_recon_loss: 42898325.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47973183.4504; train_optim_loss: 47973183.4504; val_kl_reg_loss: 56967.5031; val_edge_recon_loss: 1855205.3333; val_cat_covariates_contrastive_loss: 3151891.9167; val_gene_expr_recon_loss: 42266758.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47330822.9333; val_optim_loss: 47330822.9333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9213; val_auprc_score: 0.9494; val_best_acc_score: 0.8821; val_best_f1_score: 0.9162; train_kl_reg_loss: 54285.6312; train_edge_recon_loss: 1855521.1040; train_cat_covariates_contrastive_loss: 3151245.2023; train_gene_expr_recon_loss: 42648106.6870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47709158.5954; train_optim_loss: 47709158.5954; val_kl_reg_loss: 52492.6802; val_edge_recon_loss: 1847427.7000; val_cat_covariates_contrastive_loss: 3150130.0500; val_gene_expr_recon_loss: 42142705.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47192755.2000; val_optim_loss: 47192755.2000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9322; val_auprc_score: 0.9571; val_best_acc_score: 0.8911; val_best_f1_score: 0.9222; train_kl_reg_loss: 52133.3380; train_edge_recon_loss: 1846739.2920; train_cat_covariates_contrastive_loss: 3153072.3416; train_gene_expr_recon_loss: 42401615.5115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47453560.3664; train_optim_loss: 47453560.3664; val_kl_reg_loss: 49723.8138; val_edge_recon_loss: 1833631.2833; val_cat_covariates_contrastive_loss: 3151928.7333; val_gene_expr_recon_loss: 41762971.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46798256.0000; val_optim_loss: 46798256.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9257; val_auprc_score: 0.9523; val_best_acc_score: 0.8881; val_best_f1_score: 0.9210; train_kl_reg_loss: 49795.9286; train_edge_recon_loss: 1837430.5677; train_cat_covariates_contrastive_loss: 3152851.2920; train_gene_expr_recon_loss: 42182426.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47222504.3053; train_optim_loss: 47222504.3053; val_kl_reg_loss: 48885.2406; val_edge_recon_loss: 1849779.9917; val_cat_covariates_contrastive_loss: 3151833.8833; val_gene_expr_recon_loss: 41603057.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46653556.2667; val_optim_loss: 46653556.2667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9299; val_auprc_score: 0.9581; val_best_acc_score: 0.8941; val_best_f1_score: 0.9250; train_kl_reg_loss: 47829.2546; train_edge_recon_loss: 1831736.5802; train_cat_covariates_contrastive_loss: 3148153.8511; train_gene_expr_recon_loss: 41965668.7328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46993388.3969; train_optim_loss: 46993388.3969; val_kl_reg_loss: 46610.5943; val_edge_recon_loss: 1808744.6917; val_cat_covariates_contrastive_loss: 3147185.3167; val_gene_expr_recon_loss: 41346848.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46349388.8000; val_optim_loss: 46349388.8000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9322; val_auprc_score: 0.9570; val_best_acc_score: 0.9050; val_best_f1_score: 0.9332; train_kl_reg_loss: 46281.6492; train_edge_recon_loss: 1826802.7700; train_cat_covariates_contrastive_loss: 3154276.2844; train_gene_expr_recon_loss: 41782064.6107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46809425.4046; train_optim_loss: 46809425.4046; val_kl_reg_loss: 46069.9062; val_edge_recon_loss: 1813974.8333; val_cat_covariates_contrastive_loss: 3143978.0667; val_gene_expr_recon_loss: 41274517.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46278540.2667; val_optim_loss: 46278540.2667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9228; val_auprc_score: 0.9503; val_best_acc_score: 0.8967; val_best_f1_score: 0.9264; train_kl_reg_loss: 44754.6478; train_edge_recon_loss: 1819979.7853; train_cat_covariates_contrastive_loss: 3149640.4485; train_gene_expr_recon_loss: 41596278.7481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46610653.4962; train_optim_loss: 46610653.4962; val_kl_reg_loss: 45649.9208; val_edge_recon_loss: 1842058.5500; val_cat_covariates_contrastive_loss: 3148615.3667; val_gene_expr_recon_loss: 40994401.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46030725.3333; val_optim_loss: 46030725.3333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9294; val_auprc_score: 0.9542; val_best_acc_score: 0.9093; val_best_f1_score: 0.9363; train_kl_reg_loss: 43628.0573; train_edge_recon_loss: 1826588.5534; train_cat_covariates_contrastive_loss: 3149428.5439; train_gene_expr_recon_loss: 41404590.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46424235.6641; train_optim_loss: 46424235.6641; val_kl_reg_loss: 43422.2602; val_edge_recon_loss: 1803808.9500; val_cat_covariates_contrastive_loss: 3144759.2000; val_gene_expr_recon_loss: 40803462.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45795452.8000; val_optim_loss: 45795452.8000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9283; val_auprc_score: 0.9522; val_best_acc_score: 0.9009; val_best_f1_score: 0.9292; train_kl_reg_loss: 42334.9854; train_edge_recon_loss: 1807552.4122; train_cat_covariates_contrastive_loss: 3150171.6202; train_gene_expr_recon_loss: 41248271.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46248330.9924; train_optim_loss: 46248330.9924; val_kl_reg_loss: 42729.4505; val_edge_recon_loss: 1837791.1250; val_cat_covariates_contrastive_loss: 3148110.3000; val_gene_expr_recon_loss: 40886736.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45915367.7333; val_optim_loss: 45915367.7333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9373; val_auprc_score: 0.9591; val_best_acc_score: 0.9144; val_best_f1_score: 0.9391; train_kl_reg_loss: 41034.5056; train_edge_recon_loss: 1812863.8302; train_cat_covariates_contrastive_loss: 3148947.4695; train_gene_expr_recon_loss: 41103124.7634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46105970.5038; train_optim_loss: 46105970.5038; val_kl_reg_loss: 39841.8659; val_edge_recon_loss: 1763547.4583; val_cat_covariates_contrastive_loss: 3149278.9667; val_gene_expr_recon_loss: 40523722.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45476391.2000; val_optim_loss: 45476391.2000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9333; val_auprc_score: 0.9552; val_best_acc_score: 0.9119; val_best_f1_score: 0.9377; train_kl_reg_loss: 39821.5645; train_edge_recon_loss: 1824332.6450; train_cat_covariates_contrastive_loss: 3150535.4618; train_gene_expr_recon_loss: 40946645.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45961334.7176; train_optim_loss: 45961334.7176; val_kl_reg_loss: 40686.5534; val_edge_recon_loss: 1793839.8917; val_cat_covariates_contrastive_loss: 3152988.7500; val_gene_expr_recon_loss: 40291638.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45279153.6000; val_optim_loss: 45279153.6000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9382; val_auprc_score: 0.9613; val_best_acc_score: 0.9104; val_best_f1_score: 0.9358; train_kl_reg_loss: 39245.9294; train_edge_recon_loss: 1794274.5410; train_cat_covariates_contrastive_loss: 3149989.0515; train_gene_expr_recon_loss: 40808665.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45792174.8702; train_optim_loss: 45792174.8702; val_kl_reg_loss: 39260.4755; val_edge_recon_loss: 1816510.4250; val_cat_covariates_contrastive_loss: 3146337.2833; val_gene_expr_recon_loss: 40465253.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45467361.0667; val_optim_loss: 45467361.0667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9355; val_auprc_score: 0.9581; val_best_acc_score: 0.9141; val_best_f1_score: 0.9387; train_kl_reg_loss: 38591.4328; train_edge_recon_loss: 1787941.1155; train_cat_covariates_contrastive_loss: 3150170.0935; train_gene_expr_recon_loss: 40663884.4885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45640587.1145; train_optim_loss: 45640587.1145; val_kl_reg_loss: 38460.5292; val_edge_recon_loss: 1811975.7917; val_cat_covariates_contrastive_loss: 3149252.7000; val_gene_expr_recon_loss: 40191792.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45191480.8000; val_optim_loss: 45191480.8000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9437; val_auprc_score: 0.9638; val_best_acc_score: 0.9157; val_best_f1_score: 0.9397; train_kl_reg_loss: 37297.3359; train_edge_recon_loss: 1790778.3082; train_cat_covariates_contrastive_loss: 3149907.2309; train_gene_expr_recon_loss: 40562389.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45540371.9084; train_optim_loss: 45540371.9084; val_kl_reg_loss: 36982.9938; val_edge_recon_loss: 1777319.9500; val_cat_covariates_contrastive_loss: 3152517.8500; val_gene_expr_recon_loss: 40135027.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45101847.7333; val_optim_loss: 45101847.7333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9324; val_auprc_score: 0.9547; val_best_acc_score: 0.9115; val_best_f1_score: 0.9376; train_kl_reg_loss: 36808.8889; train_edge_recon_loss: 1796259.4179; train_cat_covariates_contrastive_loss: 3149658.4084; train_gene_expr_recon_loss: 40408402.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45391129.0687; train_optim_loss: 45391129.0687; val_kl_reg_loss: 37572.3255; val_edge_recon_loss: 1800599.8083; val_cat_covariates_contrastive_loss: 3151694.7500; val_gene_expr_recon_loss: 39940700.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44930567.2000; val_optim_loss: 44930567.2000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9428; val_auprc_score: 0.9626; val_best_acc_score: 0.9162; val_best_f1_score: 0.9402; train_kl_reg_loss: 36300.5205; train_edge_recon_loss: 1783878.4704; train_cat_covariates_contrastive_loss: 3152371.6603; train_gene_expr_recon_loss: 40323362.7176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45295913.2519; train_optim_loss: 45295913.2519; val_kl_reg_loss: 36236.6401; val_edge_recon_loss: 1831194.1250; val_cat_covariates_contrastive_loss: 3147638.3500; val_gene_expr_recon_loss: 39927364.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44942433.6000; val_optim_loss: 44942433.6000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9361; val_auprc_score: 0.9615; val_best_acc_score: 0.9051; val_best_f1_score: 0.9315; train_kl_reg_loss: 35854.9245; train_edge_recon_loss: 1809369.7214; train_cat_covariates_contrastive_loss: 3149690.6660; train_gene_expr_recon_loss: 40251660.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45246575.7557; train_optim_loss: 45246575.7557; val_kl_reg_loss: 35241.1307; val_edge_recon_loss: 1819198.9083; val_cat_covariates_contrastive_loss: 3149913.3167; val_gene_expr_recon_loss: 39632793.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44637147.7333; val_optim_loss: 44637147.7333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9325; val_auprc_score: 0.9546; val_best_acc_score: 0.9082; val_best_f1_score: 0.9338; train_kl_reg_loss: 34988.5093; train_edge_recon_loss: 1806060.2891; train_cat_covariates_contrastive_loss: 3149612.3282; train_gene_expr_recon_loss: 40139779.2672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45130440.4885; train_optim_loss: 45130440.4885; val_kl_reg_loss: 35038.8956; val_edge_recon_loss: 1813963.5333; val_cat_covariates_contrastive_loss: 3152083.9833; val_gene_expr_recon_loss: 39557051.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44558137.6000; val_optim_loss: 44558137.6000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9308; val_auprc_score: 0.9561; val_best_acc_score: 0.9054; val_best_f1_score: 0.9324; train_kl_reg_loss: 34910.6054; train_edge_recon_loss: 1785817.0105; train_cat_covariates_contrastive_loss: 3151100.5668; train_gene_expr_recon_loss: 40014995.9389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44986824.3053; train_optim_loss: 44986824.3053; val_kl_reg_loss: 34603.6531; val_edge_recon_loss: 1809786.7000; val_cat_covariates_contrastive_loss: 3148321.6667; val_gene_expr_recon_loss: 39681523.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44674235.2000; val_optim_loss: 44674235.2000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9405; val_auprc_score: 0.9619; val_best_acc_score: 0.9175; val_best_f1_score: 0.9420; train_kl_reg_loss: 33958.4662; train_edge_recon_loss: 1791996.9647; train_cat_covariates_contrastive_loss: 3149737.5534; train_gene_expr_recon_loss: 39964054.6870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44939747.6031; train_optim_loss: 44939747.6031; val_kl_reg_loss: 33970.0474; val_edge_recon_loss: 1742748.7250; val_cat_covariates_contrastive_loss: 3150944.1500; val_gene_expr_recon_loss: 39633088.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44560750.9333; val_optim_loss: 44560750.9333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9372; val_auprc_score: 0.9566; val_best_acc_score: 0.9129; val_best_f1_score: 0.9383; train_kl_reg_loss: 33538.3262; train_edge_recon_loss: 1780254.3693; train_cat_covariates_contrastive_loss: 3150751.0458; train_gene_expr_recon_loss: 39877957.4351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44842501.3130; train_optim_loss: 44842501.3130; val_kl_reg_loss: 33252.1238; val_edge_recon_loss: 1788425.8417; val_cat_covariates_contrastive_loss: 3154468.8500; val_gene_expr_recon_loss: 39332520.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44308666.4000; val_optim_loss: 44308666.4000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9389; val_auprc_score: 0.9607; val_best_acc_score: 0.9205; val_best_f1_score: 0.9437; train_kl_reg_loss: 33471.1859; train_edge_recon_loss: 1784093.4819; train_cat_covariates_contrastive_loss: 3151251.1450; train_gene_expr_recon_loss: 39802593.2214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44771408.8244; train_optim_loss: 44771408.8244; val_kl_reg_loss: 33769.5995; val_edge_recon_loss: 1755852.6333; val_cat_covariates_contrastive_loss: 3147438.4500; val_gene_expr_recon_loss: 39359942.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44297003.7333; val_optim_loss: 44297003.7333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9297; val_auprc_score: 0.9533; val_best_acc_score: 0.9027; val_best_f1_score: 0.9307; train_kl_reg_loss: 33576.6847; train_edge_recon_loss: 1790799.8874; train_cat_covariates_contrastive_loss: 3150351.2156; train_gene_expr_recon_loss: 39757077.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44731805.8626; train_optim_loss: 44731805.8626; val_kl_reg_loss: 32880.3809; val_edge_recon_loss: 1837993.2417; val_cat_covariates_contrastive_loss: 3148186.8167; val_gene_expr_recon_loss: 39254352.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44273413.3333; val_optim_loss: 44273413.3333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9360; val_auprc_score: 0.9586; val_best_acc_score: 0.9160; val_best_f1_score: 0.9399; train_kl_reg_loss: 32455.3547; train_edge_recon_loss: 1781109.7605; train_cat_covariates_contrastive_loss: 3150813.2347; train_gene_expr_recon_loss: 39660515.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44624894.1069; train_optim_loss: 44624894.1069; val_kl_reg_loss: 32655.1204; val_edge_recon_loss: 1776781.3583; val_cat_covariates_contrastive_loss: 3147966.3167; val_gene_expr_recon_loss: 39104662.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44062064.8000; val_optim_loss: 44062064.8000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9340; val_auprc_score: 0.9559; val_best_acc_score: 0.9092; val_best_f1_score: 0.9351; train_kl_reg_loss: 32368.0154; train_edge_recon_loss: 1785564.2462; train_cat_covariates_contrastive_loss: 3150986.2405; train_gene_expr_recon_loss: 39613778.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44582696.7634; train_optim_loss: 44582696.7634; val_kl_reg_loss: 32910.5689; val_edge_recon_loss: 1823804.1583; val_cat_covariates_contrastive_loss: 3147676.3500; val_gene_expr_recon_loss: 39396553.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44400943.7333; val_optim_loss: 44400943.7333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9368; val_auprc_score: 0.9581; val_best_acc_score: 0.9178; val_best_f1_score: 0.9415; train_kl_reg_loss: 32105.6397; train_edge_recon_loss: 1789931.2901; train_cat_covariates_contrastive_loss: 3152126.6660; train_gene_expr_recon_loss: 39576048.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44550211.7252; train_optim_loss: 44550211.7252; val_kl_reg_loss: 32011.2247; val_edge_recon_loss: 1781482.3750; val_cat_covariates_contrastive_loss: 3148648.2500; val_gene_expr_recon_loss: 39027073.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43989214.6667; val_optim_loss: 43989214.6667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9426; val_auprc_score: 0.9589; val_best_acc_score: 0.9214; val_best_f1_score: 0.9436; train_kl_reg_loss: 31707.3022; train_edge_recon_loss: 1782915.0153; train_cat_covariates_contrastive_loss: 3150408.8817; train_gene_expr_recon_loss: 39532954.0153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44497985.2824; train_optim_loss: 44497985.2824; val_kl_reg_loss: 30676.6656; val_edge_recon_loss: 1810070.8083; val_cat_covariates_contrastive_loss: 3170965.7833; val_gene_expr_recon_loss: 39019770.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44031483.7333; val_optim_loss: 44031483.7333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9282; val_auprc_score: 0.9543; val_best_acc_score: 0.9106; val_best_f1_score: 0.9361; train_kl_reg_loss: 31979.2502; train_edge_recon_loss: 1786914.5639; train_cat_covariates_contrastive_loss: 3152189.1851; train_gene_expr_recon_loss: 39481874.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44452957.3435; train_optim_loss: 44452957.3435; val_kl_reg_loss: 32880.9482; val_edge_recon_loss: 1861059.9750; val_cat_covariates_contrastive_loss: 3148428.6667; val_gene_expr_recon_loss: 39179957.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44222327.7333; val_optim_loss: 44222327.7333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9391; val_auprc_score: 0.9585; val_best_acc_score: 0.9187; val_best_f1_score: 0.9417; train_kl_reg_loss: 31523.6768; train_edge_recon_loss: 1787282.1202; train_cat_covariates_contrastive_loss: 3150261.6947; train_gene_expr_recon_loss: 39424573.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44393641.1298; train_optim_loss: 44393641.1298; val_kl_reg_loss: 30353.2617; val_edge_recon_loss: 1800145.2333; val_cat_covariates_contrastive_loss: 3150826.5833; val_gene_expr_recon_loss: 39014729.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43996054.1333; val_optim_loss: 43996054.1333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9308; val_auprc_score: 0.9541; val_best_acc_score: 0.9056; val_best_f1_score: 0.9333; train_kl_reg_loss: 31142.3586; train_edge_recon_loss: 1784693.4170; train_cat_covariates_contrastive_loss: 3154752.5744; train_gene_expr_recon_loss: 39377235.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44347823.3893; train_optim_loss: 44347823.3893; val_kl_reg_loss: 30255.4837; val_edge_recon_loss: 1814610.9750; val_cat_covariates_contrastive_loss: 3149048.7167; val_gene_expr_recon_loss: 38937757.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43931672.8000; val_optim_loss: 43931672.8000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9421; val_auprc_score: 0.9625; val_best_acc_score: 0.9205; val_best_f1_score: 0.9429; train_kl_reg_loss: 30698.1670; train_edge_recon_loss: 1770727.6746; train_cat_covariates_contrastive_loss: 3153228.6775; train_gene_expr_recon_loss: 39302582.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44257236.4275; train_optim_loss: 44257236.4275; val_kl_reg_loss: 30763.0389; val_edge_recon_loss: 1803036.9917; val_cat_covariates_contrastive_loss: 3151132.7333; val_gene_expr_recon_loss: 38927718.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43912651.7333; val_optim_loss: 43912651.7333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9414; val_auprc_score: 0.9588; val_best_acc_score: 0.9163; val_best_f1_score: 0.9396; train_kl_reg_loss: 30959.9947; train_edge_recon_loss: 1770207.6326; train_cat_covariates_contrastive_loss: 3154174.5573; train_gene_expr_recon_loss: 39284059.6947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44239401.7405; train_optim_loss: 44239401.7405; val_kl_reg_loss: 31697.0469; val_edge_recon_loss: 1785528.9750; val_cat_covariates_contrastive_loss: 3154576.3833; val_gene_expr_recon_loss: 38926877.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43898680.0000; val_optim_loss: 43898680.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9451; val_auprc_score: 0.9632; val_best_acc_score: 0.9213; val_best_f1_score: 0.9432; train_kl_reg_loss: 30634.8750; train_edge_recon_loss: 1776824.4857; train_cat_covariates_contrastive_loss: 3151336.1450; train_gene_expr_recon_loss: 39258180.5496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44216976.1527; train_optim_loss: 44216976.1527; val_kl_reg_loss: 29827.9733; val_edge_recon_loss: 1823588.4417; val_cat_covariates_contrastive_loss: 3150424.1000; val_gene_expr_recon_loss: 38933193.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43937034.4000; val_optim_loss: 43937034.4000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9365; val_auprc_score: 0.9566; val_best_acc_score: 0.9193; val_best_f1_score: 0.9426; train_kl_reg_loss: 30505.3763; train_edge_recon_loss: 1768645.8826; train_cat_covariates_contrastive_loss: 3152069.8855; train_gene_expr_recon_loss: 39221913.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44173134.7481; train_optim_loss: 44173134.7481; val_kl_reg_loss: 31134.2495; val_edge_recon_loss: 1788817.6333; val_cat_covariates_contrastive_loss: 3150358.1500; val_gene_expr_recon_loss: 38740191.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43710501.6000; val_optim_loss: 43710501.6000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9391; val_auprc_score: 0.9603; val_best_acc_score: 0.9224; val_best_f1_score: 0.9451; train_kl_reg_loss: 29936.2343; train_edge_recon_loss: 1784358.0973; train_cat_covariates_contrastive_loss: 3154984.1737; train_gene_expr_recon_loss: 39249630.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44218909.5267; train_optim_loss: 44218909.5267; val_kl_reg_loss: 31131.7857; val_edge_recon_loss: 1762259.1167; val_cat_covariates_contrastive_loss: 3149980.0667; val_gene_expr_recon_loss: 38801359.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43744730.1333; val_optim_loss: 43744730.1333
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9433; val_auprc_score: 0.9625; val_best_acc_score: 0.9189; val_best_f1_score: 0.9422; train_kl_reg_loss: 30881.6282; train_edge_recon_loss: 1770885.7824; train_cat_covariates_contrastive_loss: 3151598.9733; train_gene_expr_recon_loss: 39141401.8626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44094768.0611; train_optim_loss: 44094768.0611; val_kl_reg_loss: 30294.7632; val_edge_recon_loss: 1785505.2583; val_cat_covariates_contrastive_loss: 3152324.0000; val_gene_expr_recon_loss: 38872615.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43840740.2667; val_optim_loss: 43840740.2667
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9424; val_auprc_score: 0.9608; val_best_acc_score: 0.9302; val_best_f1_score: 0.9503; train_kl_reg_loss: 30239.8503; train_edge_recon_loss: 1771358.7824; train_cat_covariates_contrastive_loss: 3153618.3817; train_gene_expr_recon_loss: 39111269.4046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44066486.5344; train_optim_loss: 44066486.5344; val_kl_reg_loss: 30057.4577; val_edge_recon_loss: 1742428.4083; val_cat_covariates_contrastive_loss: 3170405.3167; val_gene_expr_recon_loss: 38512145.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43455036.2667; val_optim_loss: 43455036.2667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9380; val_auprc_score: 0.9573; val_best_acc_score: 0.9233; val_best_f1_score: 0.9450; train_kl_reg_loss: 30269.9709; train_edge_recon_loss: 1772199.3073; train_cat_covariates_contrastive_loss: 3151883.3321; train_gene_expr_recon_loss: 39115227.6336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44069580.1221; train_optim_loss: 44069580.1221; val_kl_reg_loss: 31250.1771; val_edge_recon_loss: 1810934.7750; val_cat_covariates_contrastive_loss: 3151076.1000; val_gene_expr_recon_loss: 38723088.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43716349.3333; val_optim_loss: 43716349.3333
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9448; val_auprc_score: 0.9643; val_best_acc_score: 0.9250; val_best_f1_score: 0.9465; train_kl_reg_loss: 30599.2961; train_edge_recon_loss: 1759327.2815; train_cat_covariates_contrastive_loss: 3151130.5153; train_gene_expr_recon_loss: 39081588.9771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44022646.0153; train_optim_loss: 44022646.0153; val_kl_reg_loss: 30010.8275; val_edge_recon_loss: 1785211.5417; val_cat_covariates_contrastive_loss: 3155550.0167; val_gene_expr_recon_loss: 38613427.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43584200.0000; val_optim_loss: 43584200.0000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9377; val_auprc_score: 0.9591; val_best_acc_score: 0.9201; val_best_f1_score: 0.9430; train_kl_reg_loss: 29715.7308; train_edge_recon_loss: 1768777.9094; train_cat_covariates_contrastive_loss: 3151152.2347; train_gene_expr_recon_loss: 39068048.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44017694.7481; train_optim_loss: 44017694.7481; val_kl_reg_loss: 28352.0353; val_edge_recon_loss: 1787665.5417; val_cat_covariates_contrastive_loss: 3149592.6833; val_gene_expr_recon_loss: 38553397.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43519007.2000; val_optim_loss: 43519007.2000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9482; val_auprc_score: 0.9644; val_best_acc_score: 0.9297; val_best_f1_score: 0.9498; train_kl_reg_loss: 29630.1424; train_edge_recon_loss: 1778506.5162; train_cat_covariates_contrastive_loss: 3153388.5172; train_gene_expr_recon_loss: 39021036.6718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43982561.6794; train_optim_loss: 43982561.6794; val_kl_reg_loss: 29712.7273; val_edge_recon_loss: 1753139.6500; val_cat_covariates_contrastive_loss: 3152086.7167; val_gene_expr_recon_loss: 38596908.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43531847.2000; val_optim_loss: 43531847.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9476; val_auprc_score: 0.9653; val_best_acc_score: 0.9261; val_best_f1_score: 0.9475; train_kl_reg_loss: 29885.1473; train_edge_recon_loss: 1765763.5792; train_cat_covariates_contrastive_loss: 3155546.0649; train_gene_expr_recon_loss: 38973471.2977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43924666.1679; train_optim_loss: 43924666.1679; val_kl_reg_loss: 29919.0400; val_edge_recon_loss: 1785966.0667; val_cat_covariates_contrastive_loss: 3150914.5833; val_gene_expr_recon_loss: 38578076.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43544876.2667; val_optim_loss: 43544876.2667
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9406; val_auprc_score: 0.9584; val_best_acc_score: 0.9242; val_best_f1_score: 0.9462; train_kl_reg_loss: 30257.7912; train_edge_recon_loss: 1759031.4351; train_cat_covariates_contrastive_loss: 3153110.0477; train_gene_expr_recon_loss: 38948149.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43890549.0382; train_optim_loss: 43890549.0382; val_kl_reg_loss: 30606.4289; val_edge_recon_loss: 1766926.1167; val_cat_covariates_contrastive_loss: 3151700.0833; val_gene_expr_recon_loss: 38623318.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43572550.9333; val_optim_loss: 43572550.9333
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9374; val_auprc_score: 0.9566; val_best_acc_score: 0.9211; val_best_f1_score: 0.9433; train_kl_reg_loss: 30634.3303; train_edge_recon_loss: 1777012.0048; train_cat_covariates_contrastive_loss: 3158206.7118; train_gene_expr_recon_loss: 38952831.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43918684.1221; train_optim_loss: 43918684.1221; val_kl_reg_loss: 31178.8794; val_edge_recon_loss: 1798437.5167; val_cat_covariates_contrastive_loss: 3147602.1667; val_gene_expr_recon_loss: 38591264.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43568482.9333; val_optim_loss: 43568482.9333
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9433; val_auprc_score: 0.9622; val_best_acc_score: 0.9238; val_best_f1_score: 0.9454; train_kl_reg_loss: 30571.0332; train_edge_recon_loss: 1776751.1155; train_cat_covariates_contrastive_loss: 3151294.9580; train_gene_expr_recon_loss: 38962971.0840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43921588.2748; train_optim_loss: 43921588.2748; val_kl_reg_loss: 30981.1324; val_edge_recon_loss: 1771737.5417; val_cat_covariates_contrastive_loss: 3155238.4333; val_gene_expr_recon_loss: 38604014.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43561971.2000; val_optim_loss: 43561971.2000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 43 min 52 sec.
Using best model state, which was in epoch 54.

--- MODEL EVALUATION ---
val AUROC score: 0.9145
val AUPRC score: 0.9387
val best accuracy score: 0.9116
val best F1 score: 0.9370
val target rna MSE score: 220.2782
val source rna MSE score: 84.1570
Val cat covariate0 mean sim diff: 0.0004
Val cat covariate1 mean sim diff: -0.0343
Duration of model training in run 2: 0 hours, 44 minutes and 16 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
