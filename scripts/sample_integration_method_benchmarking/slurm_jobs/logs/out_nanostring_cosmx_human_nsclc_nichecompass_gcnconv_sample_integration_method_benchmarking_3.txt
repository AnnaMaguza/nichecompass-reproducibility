Run timestamp: 02092023_192905_3.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '12', '--edge_batch_size_list', '4096', '--node_batch_size_list', 'None', '--seeds', '5', '--run_index', '6', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gcnconv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 254146
Number of validation nodes: 28238
Number of training edges: 1721208
Number of validation edges: 191245
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9673; val_auprc_score: 0.9884; val_best_acc_score: 0.9289; val_best_f1_score: 0.9543; train_kl_reg_loss: 21274.8205; train_edge_recon_loss: 1456394.0606; train_cat_covariates_contrastive_loss: 644989.1102; train_gene_expr_recon_loss: 3170503.1075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5293161.0843; train_optim_loss: 5293161.0843; val_kl_reg_loss: 18623.3223; val_edge_recon_loss: 1354966.8404; val_cat_covariates_contrastive_loss: 637526.2606; val_gene_expr_recon_loss: 2921365.5106; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4932481.9468; val_optim_loss: 4932481.9468
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9785; val_auprc_score: 0.9920; val_best_acc_score: 0.9475; val_best_f1_score: 0.9661; train_kl_reg_loss: 15405.9719; train_edge_recon_loss: 1328002.0341; train_cat_covariates_contrastive_loss: 638525.7736; train_gene_expr_recon_loss: 2860352.8652; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4842286.6366; train_optim_loss: 4842286.6366; val_kl_reg_loss: 13681.8965; val_edge_recon_loss: 1325881.6489; val_cat_covariates_contrastive_loss: 637642.6516; val_gene_expr_recon_loss: 2813268.2021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4790474.3936; val_optim_loss: 4790474.3936
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9788; val_auprc_score: 0.9919; val_best_acc_score: 0.9491; val_best_f1_score: 0.9670; train_kl_reg_loss: 13058.7759; train_edge_recon_loss: 1316901.0499; train_cat_covariates_contrastive_loss: 637287.8581; train_gene_expr_recon_loss: 2777313.3314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4744561.0226; train_optim_loss: 4744561.0226; val_kl_reg_loss: 12406.8980; val_edge_recon_loss: 1324903.0053; val_cat_covariates_contrastive_loss: 636723.2447; val_gene_expr_recon_loss: 2747116.5372; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4721149.6809; val_optim_loss: 4721149.6809
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9790; val_auprc_score: 0.9922; val_best_acc_score: 0.9500; val_best_f1_score: 0.9676; train_kl_reg_loss: 12660.9518; train_edge_recon_loss: 1312863.7093; train_cat_covariates_contrastive_loss: 636325.6154; train_gene_expr_recon_loss: 2720161.0831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4682011.3682; train_optim_loss: 4682011.3682; val_kl_reg_loss: 12343.3604; val_edge_recon_loss: 1318910.1303; val_cat_covariates_contrastive_loss: 635646.6981; val_gene_expr_recon_loss: 2700064.2819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4666964.5106; val_optim_loss: 4666964.5106
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9793; val_auprc_score: 0.9921; val_best_acc_score: 0.9529; val_best_f1_score: 0.9695; train_kl_reg_loss: 12614.8932; train_edge_recon_loss: 1312117.5466; train_cat_covariates_contrastive_loss: 635497.2211; train_gene_expr_recon_loss: 2676984.6443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4637214.2981; train_optim_loss: 4637214.2981; val_kl_reg_loss: 12520.7573; val_edge_recon_loss: 1319757.4043; val_cat_covariates_contrastive_loss: 634349.1636; val_gene_expr_recon_loss: 2662054.5585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4628681.9149; val_optim_loss: 4628681.9149
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9817; val_auprc_score: 0.9929; val_best_acc_score: 0.9561; val_best_f1_score: 0.9715; train_kl_reg_loss: 12749.7061; train_edge_recon_loss: 1311550.1657; train_cat_covariates_contrastive_loss: 635072.0356; train_gene_expr_recon_loss: 2643182.4115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4602554.3397; train_optim_loss: 4602554.3397; val_kl_reg_loss: 12569.0717; val_edge_recon_loss: 1310564.6941; val_cat_covariates_contrastive_loss: 635339.6848; val_gene_expr_recon_loss: 2630813.2021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4589286.6383; val_optim_loss: 4589286.6383
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9813; val_auprc_score: 0.9928; val_best_acc_score: 0.9559; val_best_f1_score: 0.9714; train_kl_reg_loss: 13017.2503; train_edge_recon_loss: 1310390.1918; train_cat_covariates_contrastive_loss: 634862.7142; train_gene_expr_recon_loss: 2616035.0321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4574305.1841; train_optim_loss: 4574305.1841; val_kl_reg_loss: 12874.4212; val_edge_recon_loss: 1316517.1941; val_cat_covariates_contrastive_loss: 634769.7540; val_gene_expr_recon_loss: 2606278.7021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4570440.0745; val_optim_loss: 4570440.0745
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9811; val_auprc_score: 0.9926; val_best_acc_score: 0.9570; val_best_f1_score: 0.9721; train_kl_reg_loss: 13194.0516; train_edge_recon_loss: 1309430.8426; train_cat_covariates_contrastive_loss: 634470.8116; train_gene_expr_recon_loss: 2593776.4578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4550872.1568; train_optim_loss: 4550872.1568; val_kl_reg_loss: 13287.6543; val_edge_recon_loss: 1315991.9521; val_cat_covariates_contrastive_loss: 634113.8551; val_gene_expr_recon_loss: 2587372.8457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4550766.3511; val_optim_loss: 4550766.3511
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9817; val_auprc_score: 0.9928; val_best_acc_score: 0.9578; val_best_f1_score: 0.9726; train_kl_reg_loss: 13363.5117; train_edge_recon_loss: 1307029.8887; train_cat_covariates_contrastive_loss: 634478.0294; train_gene_expr_recon_loss: 2575401.7369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4530273.1710; train_optim_loss: 4530273.1710; val_kl_reg_loss: 13294.2208; val_edge_recon_loss: 1314999.4255; val_cat_covariates_contrastive_loss: 634150.7580; val_gene_expr_recon_loss: 2570673.6755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4533118.1277; val_optim_loss: 4533118.1277
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9819; val_auprc_score: 0.9930; val_best_acc_score: 0.9596; val_best_f1_score: 0.9738; train_kl_reg_loss: 13555.6137; train_edge_recon_loss: 1306968.2203; train_cat_covariates_contrastive_loss: 634194.1593; train_gene_expr_recon_loss: 2561638.0962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4516356.1057; train_optim_loss: 4516356.1057; val_kl_reg_loss: 13203.1429; val_edge_recon_loss: 1315636.3059; val_cat_covariates_contrastive_loss: 634277.4335; val_gene_expr_recon_loss: 2558824.4787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4521941.3404; val_optim_loss: 4521941.3404
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9818; val_auprc_score: 0.9928; val_best_acc_score: 0.9593; val_best_f1_score: 0.9735; train_kl_reg_loss: 13657.1206; train_edge_recon_loss: 1304613.0938; train_cat_covariates_contrastive_loss: 634215.5815; train_gene_expr_recon_loss: 2550190.4002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4502676.1971; train_optim_loss: 4502676.1971; val_kl_reg_loss: 13211.1110; val_edge_recon_loss: 1315372.5106; val_cat_covariates_contrastive_loss: 634191.9880; val_gene_expr_recon_loss: 2551786.7021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4514562.2872; val_optim_loss: 4514562.2872
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9824; val_auprc_score: 0.9931; val_best_acc_score: 0.9605; val_best_f1_score: 0.9744; train_kl_reg_loss: 13782.4605; train_edge_recon_loss: 1307163.5131; train_cat_covariates_contrastive_loss: 634011.1537; train_gene_expr_recon_loss: 2540600.9382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4495558.0641; train_optim_loss: 4495558.0641; val_kl_reg_loss: 13603.0479; val_edge_recon_loss: 1311964.5559; val_cat_covariates_contrastive_loss: 633634.3444; val_gene_expr_recon_loss: 2539032.4362; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4498234.4255; val_optim_loss: 4498234.4255
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9821; val_auprc_score: 0.9930; val_best_acc_score: 0.9604; val_best_f1_score: 0.9743; train_kl_reg_loss: 13860.6521; train_edge_recon_loss: 1305732.9852; train_cat_covariates_contrastive_loss: 633976.6483; train_gene_expr_recon_loss: 2532434.2945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4486004.5713; train_optim_loss: 4486004.5713; val_kl_reg_loss: 13885.1117; val_edge_recon_loss: 1312794.5665; val_cat_covariates_contrastive_loss: 633477.7646; val_gene_expr_recon_loss: 2532933.6277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4493091.0532; val_optim_loss: 4493091.0532
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9825; val_auprc_score: 0.9931; val_best_acc_score: 0.9615; val_best_f1_score: 0.9750; train_kl_reg_loss: 13985.1511; train_edge_recon_loss: 1303139.2785; train_cat_covariates_contrastive_loss: 633916.0592; train_gene_expr_recon_loss: 2526807.2536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4477847.7363; train_optim_loss: 4477847.7363; val_kl_reg_loss: 13749.8011; val_edge_recon_loss: 1306874.1755; val_cat_covariates_contrastive_loss: 633570.6769; val_gene_expr_recon_loss: 2531198.5957; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4485393.2340; val_optim_loss: 4485393.2340
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9827; val_auprc_score: 0.9931; val_best_acc_score: 0.9620; val_best_f1_score: 0.9754; train_kl_reg_loss: 14036.1235; train_edge_recon_loss: 1304391.2791; train_cat_covariates_contrastive_loss: 633781.6833; train_gene_expr_recon_loss: 2519230.8248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4471439.9228; train_optim_loss: 4471439.9228; val_kl_reg_loss: 14071.2924; val_edge_recon_loss: 1309614.3271; val_cat_covariates_contrastive_loss: 633631.5106; val_gene_expr_recon_loss: 2523727.6489; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4481044.8085; val_optim_loss: 4481044.8085
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9813; val_auprc_score: 0.9926; val_best_acc_score: 0.9615; val_best_f1_score: 0.9751; train_kl_reg_loss: 14114.5632; train_edge_recon_loss: 1306676.7732; train_cat_covariates_contrastive_loss: 633721.0217; train_gene_expr_recon_loss: 2514877.7738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4469390.1425; train_optim_loss: 4469390.1425; val_kl_reg_loss: 14212.8384; val_edge_recon_loss: 1309735.7527; val_cat_covariates_contrastive_loss: 632866.7580; val_gene_expr_recon_loss: 2518130.6383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4474945.9894; val_optim_loss: 4474945.9894
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9834; val_auprc_score: 0.9934; val_best_acc_score: 0.9617; val_best_f1_score: 0.9751; train_kl_reg_loss: 14156.9429; train_edge_recon_loss: 1305882.1185; train_cat_covariates_contrastive_loss: 633699.5892; train_gene_expr_recon_loss: 2511231.3314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4464969.9846; train_optim_loss: 4464969.9846; val_kl_reg_loss: 13970.5653; val_edge_recon_loss: 1312206.9840; val_cat_covariates_contrastive_loss: 633713.5997; val_gene_expr_recon_loss: 2516896.1596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4476787.3617; val_optim_loss: 4476787.3617
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9823; val_auprc_score: 0.9929; val_best_acc_score: 0.9624; val_best_f1_score: 0.9756; train_kl_reg_loss: 14210.6425; train_edge_recon_loss: 1304617.7093; train_cat_covariates_contrastive_loss: 633656.0089; train_gene_expr_recon_loss: 2506059.1360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4458543.4988; train_optim_loss: 4458543.4988; val_kl_reg_loss: 14088.8073; val_edge_recon_loss: 1311999.3910; val_cat_covariates_contrastive_loss: 633384.5691; val_gene_expr_recon_loss: 2510309.2021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4469782.0106; val_optim_loss: 4469782.0106
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9832; val_auprc_score: 0.9933; val_best_acc_score: 0.9637; val_best_f1_score: 0.9765; train_kl_reg_loss: 14297.7575; train_edge_recon_loss: 1301586.8227; train_cat_covariates_contrastive_loss: 633389.3587; train_gene_expr_recon_loss: 2504033.3925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4453307.3337; train_optim_loss: 4453307.3337; val_kl_reg_loss: 13910.5225; val_edge_recon_loss: 1305868.2500; val_cat_covariates_contrastive_loss: 633470.4973; val_gene_expr_recon_loss: 2508775.5691; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4462024.8085; val_optim_loss: 4462024.8085
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9834; val_auprc_score: 0.9935; val_best_acc_score: 0.9623; val_best_f1_score: 0.9755; train_kl_reg_loss: 14327.7389; train_edge_recon_loss: 1303952.3305; train_cat_covariates_contrastive_loss: 633487.0903; train_gene_expr_recon_loss: 2499432.2850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4451199.4561; train_optim_loss: 4451199.4561; val_kl_reg_loss: 14084.8492; val_edge_recon_loss: 1308628.8032; val_cat_covariates_contrastive_loss: 633428.4787; val_gene_expr_recon_loss: 2506909.3617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4463051.5213; val_optim_loss: 4463051.5213
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9833; val_auprc_score: 0.9934; val_best_acc_score: 0.9620; val_best_f1_score: 0.9754; train_kl_reg_loss: 14355.0185; train_edge_recon_loss: 1304355.2536; train_cat_covariates_contrastive_loss: 633363.0518; train_gene_expr_recon_loss: 2496439.1508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4448512.4834; train_optim_loss: 4448512.4834; val_kl_reg_loss: 14067.3448; val_edge_recon_loss: 1310654.8511; val_cat_covariates_contrastive_loss: 633655.7247; val_gene_expr_recon_loss: 2503169.9787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4461547.9043; val_optim_loss: 4461547.9043
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9838; val_auprc_score: 0.9936; val_best_acc_score: 0.9629; val_best_f1_score: 0.9759; train_kl_reg_loss: 14381.9705; train_edge_recon_loss: 1305001.1594; train_cat_covariates_contrastive_loss: 633401.4762; train_gene_expr_recon_loss: 2494969.1342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4447753.7387; train_optim_loss: 4447753.7387; val_kl_reg_loss: 14108.0162; val_edge_recon_loss: 1305312.0053; val_cat_covariates_contrastive_loss: 633565.2274; val_gene_expr_recon_loss: 2503113.2287; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4456098.4468; val_optim_loss: 4456098.4468
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9828; val_auprc_score: 0.9932; val_best_acc_score: 0.9622; val_best_f1_score: 0.9754; train_kl_reg_loss: 14426.2469; train_edge_recon_loss: 1304756.5454; train_cat_covariates_contrastive_loss: 633325.1462; train_gene_expr_recon_loss: 2492462.0861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4444970.0249; train_optim_loss: 4444970.0249; val_kl_reg_loss: 14324.1899; val_edge_recon_loss: 1316413.9255; val_cat_covariates_contrastive_loss: 633222.3830; val_gene_expr_recon_loss: 2499227.9043; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4463188.3830; val_optim_loss: 4463188.3830
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9821; val_auprc_score: 0.9929; val_best_acc_score: 0.9638; val_best_f1_score: 0.9765; train_kl_reg_loss: 14424.9137; train_edge_recon_loss: 1303119.5493; train_cat_covariates_contrastive_loss: 633283.8092; train_gene_expr_recon_loss: 2491000.3314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4441828.6033; train_optim_loss: 4441828.6033; val_kl_reg_loss: 14500.8873; val_edge_recon_loss: 1308724.2101; val_cat_covariates_contrastive_loss: 632622.2420; val_gene_expr_recon_loss: 2500420.1755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4456267.5213; val_optim_loss: 4456267.5213
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9835; val_auprc_score: 0.9934; val_best_acc_score: 0.9639; val_best_f1_score: 0.9765; train_kl_reg_loss: 14444.1298; train_edge_recon_loss: 1301859.3607; train_cat_covariates_contrastive_loss: 633266.7096; train_gene_expr_recon_loss: 2490407.9400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4439978.1378; train_optim_loss: 4439978.1378; val_kl_reg_loss: 14116.5738; val_edge_recon_loss: 1310698.5160; val_cat_covariates_contrastive_loss: 633328.2633; val_gene_expr_recon_loss: 2498009.2979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4456152.6702; val_optim_loss: 4456152.6702
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9832; val_auprc_score: 0.9933; val_best_acc_score: 0.9643; val_best_f1_score: 0.9769; train_kl_reg_loss: 14480.9184; train_edge_recon_loss: 1302018.6244; train_cat_covariates_contrastive_loss: 633205.3094; train_gene_expr_recon_loss: 2488834.1580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4438539.0024; train_optim_loss: 4438539.0024; val_kl_reg_loss: 14174.7440; val_edge_recon_loss: 1311939.9309; val_cat_covariates_contrastive_loss: 633199.2872; val_gene_expr_recon_loss: 2498625.1968; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4457939.2021; val_optim_loss: 4457939.2021

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9834; val_auprc_score: 0.9933; val_best_acc_score: 0.9645; val_best_f1_score: 0.9770; train_kl_reg_loss: 14384.9776; train_edge_recon_loss: 1300357.9575; train_cat_covariates_contrastive_loss: 633376.0252; train_gene_expr_recon_loss: 2479762.0380; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4427880.9941; train_optim_loss: 4427880.9941; val_kl_reg_loss: 14144.6871; val_edge_recon_loss: 1304270.1888; val_cat_covariates_contrastive_loss: 633358.0386; val_gene_expr_recon_loss: 2489130.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4440903.1702; val_optim_loss: 4440903.1702
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9835; val_auprc_score: 0.9932; val_best_acc_score: 0.9645; val_best_f1_score: 0.9770; train_kl_reg_loss: 14434.5129; train_edge_recon_loss: 1302733.5926; train_cat_covariates_contrastive_loss: 633330.2470; train_gene_expr_recon_loss: 2478007.7162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4428506.0653; train_optim_loss: 4428506.0653; val_kl_reg_loss: 14197.9964; val_edge_recon_loss: 1310015.3218; val_cat_covariates_contrastive_loss: 633196.7380; val_gene_expr_recon_loss: 2489238.0851; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4446648.1702; val_optim_loss: 4446648.1702
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9840; val_auprc_score: 0.9937; val_best_acc_score: 0.9646; val_best_f1_score: 0.9770; train_kl_reg_loss: 14430.5062; train_edge_recon_loss: 1301992.9477; train_cat_covariates_contrastive_loss: 633311.4295; train_gene_expr_recon_loss: 2476848.0392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4426582.9145; train_optim_loss: 4426582.9145; val_kl_reg_loss: 14134.8112; val_edge_recon_loss: 1308533.9441; val_cat_covariates_contrastive_loss: 633413.0465; val_gene_expr_recon_loss: 2487177.4840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4443259.2766; val_optim_loss: 4443259.2766
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9841; val_auprc_score: 0.9937; val_best_acc_score: 0.9644; val_best_f1_score: 0.9769; train_kl_reg_loss: 14422.4662; train_edge_recon_loss: 1301022.0855; train_cat_covariates_contrastive_loss: 633239.9350; train_gene_expr_recon_loss: 2476941.9917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4425626.4774; train_optim_loss: 4425626.4774; val_kl_reg_loss: 14205.6610; val_edge_recon_loss: 1305883.9335; val_cat_covariates_contrastive_loss: 633239.7301; val_gene_expr_recon_loss: 2486830.1809; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4440159.5106; val_optim_loss: 4440159.5106
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9831; val_auprc_score: 0.9931; val_best_acc_score: 0.9646; val_best_f1_score: 0.9771; train_kl_reg_loss: 14435.0636; train_edge_recon_loss: 1299349.6523; train_cat_covariates_contrastive_loss: 633225.7580; train_gene_expr_recon_loss: 2475639.3023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4422649.7720; train_optim_loss: 4422649.7720; val_kl_reg_loss: 14246.2023; val_edge_recon_loss: 1307024.2899; val_cat_covariates_contrastive_loss: 633090.5638; val_gene_expr_recon_loss: 2488299.9521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4442661.0319; val_optim_loss: 4442661.0319
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9830; val_auprc_score: 0.9932; val_best_acc_score: 0.9650; val_best_f1_score: 0.9773; train_kl_reg_loss: 14434.4080; train_edge_recon_loss: 1301728.3563; train_cat_covariates_contrastive_loss: 633245.8998; train_gene_expr_recon_loss: 2475965.7785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4425374.4489; train_optim_loss: 4425374.4489; val_kl_reg_loss: 14340.8501; val_edge_recon_loss: 1304232.3750; val_cat_covariates_contrastive_loss: 632942.8138; val_gene_expr_recon_loss: 2489325.5638; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4440841.6170; val_optim_loss: 4440841.6170
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9839; val_auprc_score: 0.9935; val_best_acc_score: 0.9647; val_best_f1_score: 0.9770; train_kl_reg_loss: 14430.2170; train_edge_recon_loss: 1300818.0713; train_cat_covariates_contrastive_loss: 633201.0067; train_gene_expr_recon_loss: 2475506.7037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4423955.9976; train_optim_loss: 4423955.9976; val_kl_reg_loss: 14171.4962; val_edge_recon_loss: 1306998.9016; val_cat_covariates_contrastive_loss: 633170.4202; val_gene_expr_recon_loss: 2487150.2660; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4441491.0638; val_optim_loss: 4441491.0638
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9835; val_auprc_score: 0.9933; val_best_acc_score: 0.9644; val_best_f1_score: 0.9769; train_kl_reg_loss: 14382.5401; train_edge_recon_loss: 1301340.7550; train_cat_covariates_contrastive_loss: 633253.0615; train_gene_expr_recon_loss: 2475070.9911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4424047.3456; train_optim_loss: 4424047.3456; val_kl_reg_loss: 14343.8789; val_edge_recon_loss: 1305059.4096; val_cat_covariates_contrastive_loss: 632834.7048; val_gene_expr_recon_loss: 2488643.7979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4440881.7447; val_optim_loss: 4440881.7447

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9833; val_auprc_score: 0.9933; val_best_acc_score: 0.9647; val_best_f1_score: 0.9770; train_kl_reg_loss: 14476.2883; train_edge_recon_loss: 1300220.4011; train_cat_covariates_contrastive_loss: 633091.6597; train_gene_expr_recon_loss: 2474600.9382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4422389.2957; train_optim_loss: 4422389.2957; val_kl_reg_loss: 14211.6381; val_edge_recon_loss: 1306575.2660; val_cat_covariates_contrastive_loss: 633097.6556; val_gene_expr_recon_loss: 2485023.4521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4438907.9681; val_optim_loss: 4438907.9681
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9836; val_auprc_score: 0.9934; val_best_acc_score: 0.9653; val_best_f1_score: 0.9775; train_kl_reg_loss: 14394.0472; train_edge_recon_loss: 1301314.1615; train_cat_covariates_contrastive_loss: 633187.1504; train_gene_expr_recon_loss: 2473854.1651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4422749.5261; train_optim_loss: 4422749.5261; val_kl_reg_loss: 14195.9988; val_edge_recon_loss: 1302945.3830; val_cat_covariates_contrastive_loss: 632923.9694; val_gene_expr_recon_loss: 2485384.7021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4435450.0213; val_optim_loss: 4435450.0213
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9828; val_auprc_score: 0.9931; val_best_acc_score: 0.9646; val_best_f1_score: 0.9770; train_kl_reg_loss: 14375.0032; train_edge_recon_loss: 1301365.7061; train_cat_covariates_contrastive_loss: 633197.4434; train_gene_expr_recon_loss: 2473596.4299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4422534.5891; train_optim_loss: 4422534.5891; val_kl_reg_loss: 14194.4971; val_edge_recon_loss: 1314689.0000; val_cat_covariates_contrastive_loss: 632945.9761; val_gene_expr_recon_loss: 2485298.9096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4447128.3830; val_optim_loss: 4447128.3830
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9834; val_auprc_score: 0.9934; val_best_acc_score: 0.9644; val_best_f1_score: 0.9769; train_kl_reg_loss: 14369.1514; train_edge_recon_loss: 1301848.9525; train_cat_covariates_contrastive_loss: 633209.5530; train_gene_expr_recon_loss: 2474343.0273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4423770.6758; train_optim_loss: 4423770.6758; val_kl_reg_loss: 14139.6388; val_edge_recon_loss: 1304054.4601; val_cat_covariates_contrastive_loss: 632965.1955; val_gene_expr_recon_loss: 2487207.6755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4438366.9681; val_optim_loss: 4438366.9681
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9832; val_auprc_score: 0.9932; val_best_acc_score: 0.9650; val_best_f1_score: 0.9772; train_kl_reg_loss: 14351.8252; train_edge_recon_loss: 1301040.8536; train_cat_covariates_contrastive_loss: 633208.0122; train_gene_expr_recon_loss: 2473641.3343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4422242.0261; train_optim_loss: 4422242.0261; val_kl_reg_loss: 14181.1824; val_edge_recon_loss: 1306275.9681; val_cat_covariates_contrastive_loss: 633082.4069; val_gene_expr_recon_loss: 2487618.4309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4441157.9894; val_optim_loss: 4441157.9894
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9830; val_auprc_score: 0.9931; val_best_acc_score: 0.9650; val_best_f1_score: 0.9773; train_kl_reg_loss: 14379.4741; train_edge_recon_loss: 1301300.0303; train_cat_covariates_contrastive_loss: 633221.7638; train_gene_expr_recon_loss: 2473353.2827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4422254.5368; train_optim_loss: 4422254.5368; val_kl_reg_loss: 14224.6637; val_edge_recon_loss: 1305435.2793; val_cat_covariates_contrastive_loss: 633255.9056; val_gene_expr_recon_loss: 2484611.8245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4437527.6383; val_optim_loss: 4437527.6383

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9836; val_auprc_score: 0.9934; val_best_acc_score: 0.9652; val_best_f1_score: 0.9774; train_kl_reg_loss: 14406.7939; train_edge_recon_loss: 1300802.8023; train_cat_covariates_contrastive_loss: 633148.6954; train_gene_expr_recon_loss: 2474203.0113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4422561.2874; train_optim_loss: 4422561.2874; val_kl_reg_loss: 14186.0501; val_edge_recon_loss: 1301849.3564; val_cat_covariates_contrastive_loss: 633104.0239; val_gene_expr_recon_loss: 2484089.2606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4433228.6489; val_optim_loss: 4433228.6489
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9836; val_auprc_score: 0.9935; val_best_acc_score: 0.9650; val_best_f1_score: 0.9773; train_kl_reg_loss: 14388.3954; train_edge_recon_loss: 1301061.3667; train_cat_covariates_contrastive_loss: 633180.6692; train_gene_expr_recon_loss: 2472915.6087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4421546.0570; train_optim_loss: 4421546.0570; val_kl_reg_loss: 14184.8659; val_edge_recon_loss: 1307205.4043; val_cat_covariates_contrastive_loss: 633261.6888; val_gene_expr_recon_loss: 2484375.6011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4439027.5638; val_optim_loss: 4439027.5638
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9834; val_auprc_score: 0.9933; val_best_acc_score: 0.9653; val_best_f1_score: 0.9774; train_kl_reg_loss: 14384.2844; train_edge_recon_loss: 1300402.5344; train_cat_covariates_contrastive_loss: 633095.1623; train_gene_expr_recon_loss: 2473372.6194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4421254.6200; train_optim_loss: 4421254.6200; val_kl_reg_loss: 14191.3329; val_edge_recon_loss: 1303875.2952; val_cat_covariates_contrastive_loss: 632944.0638; val_gene_expr_recon_loss: 2484493.8617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4435504.5426; val_optim_loss: 4435504.5426
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9832; val_auprc_score: 0.9932; val_best_acc_score: 0.9651; val_best_f1_score: 0.9774; train_kl_reg_loss: 14381.3849; train_edge_recon_loss: 1302054.8673; train_cat_covariates_contrastive_loss: 633179.5806; train_gene_expr_recon_loss: 2473718.1271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4423333.9679; train_optim_loss: 4423333.9679; val_kl_reg_loss: 14181.6716; val_edge_recon_loss: 1302027.7766; val_cat_covariates_contrastive_loss: 633164.7540; val_gene_expr_recon_loss: 2485366.8936; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4434741.0745; val_optim_loss: 4434741.0745
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9830; val_auprc_score: 0.9931; val_best_acc_score: 0.9647; val_best_f1_score: 0.9771; train_kl_reg_loss: 14377.2665; train_edge_recon_loss: 1299961.9786; train_cat_covariates_contrastive_loss: 633192.1853; train_gene_expr_recon_loss: 2473460.7524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4420992.1663; train_optim_loss: 4420992.1663; val_kl_reg_loss: 14192.1171; val_edge_recon_loss: 1306061.7686; val_cat_covariates_contrastive_loss: 633064.6064; val_gene_expr_recon_loss: 2486713.9415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4440032.4787; val_optim_loss: 4440032.4787

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9834; val_auprc_score: 0.9933; val_best_acc_score: 0.9649; val_best_f1_score: 0.9772; train_kl_reg_loss: 14375.0803; train_edge_recon_loss: 1300884.7298; train_cat_covariates_contrastive_loss: 633204.6685; train_gene_expr_recon_loss: 2474534.4774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4422998.9632; train_optim_loss: 4422998.9632; val_kl_reg_loss: 14177.7135; val_edge_recon_loss: 1306478.9601; val_cat_covariates_contrastive_loss: 633230.2048; val_gene_expr_recon_loss: 2485568.5798; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4439455.4894; val_optim_loss: 4439455.4894
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9836; val_auprc_score: 0.9934; val_best_acc_score: 0.9649; val_best_f1_score: 0.9772; train_kl_reg_loss: 14379.3592; train_edge_recon_loss: 1300743.9374; train_cat_covariates_contrastive_loss: 633173.6051; train_gene_expr_recon_loss: 2473729.0030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4422025.9192; train_optim_loss: 4422025.9192; val_kl_reg_loss: 14184.8916; val_edge_recon_loss: 1303061.6941; val_cat_covariates_contrastive_loss: 633090.5864; val_gene_expr_recon_loss: 2486921.2766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4437258.4149; val_optim_loss: 4437258.4149
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9834; val_auprc_score: 0.9933; val_best_acc_score: 0.9649; val_best_f1_score: 0.9772; train_kl_reg_loss: 14377.4479; train_edge_recon_loss: 1298376.1348; train_cat_covariates_contrastive_loss: 633167.0687; train_gene_expr_recon_loss: 2473532.5119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4419453.1591; train_optim_loss: 4419453.1591; val_kl_reg_loss: 14186.7788; val_edge_recon_loss: 1307395.9574; val_cat_covariates_contrastive_loss: 633362.2194; val_gene_expr_recon_loss: 2484665.4734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4439610.4255; val_optim_loss: 4439610.4255
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9837; val_auprc_score: 0.9935; val_best_acc_score: 0.9647; val_best_f1_score: 0.9771; train_kl_reg_loss: 14383.6335; train_edge_recon_loss: 1300649.7185; train_cat_covariates_contrastive_loss: 633185.7337; train_gene_expr_recon_loss: 2474410.1692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4422629.2399; train_optim_loss: 4422629.2399; val_kl_reg_loss: 14194.2660; val_edge_recon_loss: 1307588.4707; val_cat_covariates_contrastive_loss: 633095.5173; val_gene_expr_recon_loss: 2485382.1383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4440260.3723; val_optim_loss: 4440260.3723

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 573 min 6 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
val AUROC score: 0.9491
val AUPRC score: 0.9734
val best accuracy score: 0.9524
val best F1 score: 0.9688
val target rna MSE score: 1.0856
val source rna MSE score: 0.1171
Val cat covariate0 mean sim diff: -0.0005
Val cat covariate1 mean sim diff: -0.1105
Duration of model training in run 6: 9 hours, 35 minutes and 21 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
