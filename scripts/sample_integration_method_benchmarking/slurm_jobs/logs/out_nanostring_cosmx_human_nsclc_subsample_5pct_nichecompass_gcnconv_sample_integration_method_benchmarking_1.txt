Run timestamp: 02092023_222739_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '4096', '4096', '4096', '4096', '4096', '4096', '4096', '4096', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc_subsample_5pct', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gcnconv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 12706
Number of validation nodes: 1412
Number of training edges: 116179
Number of validation edges: 12908
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9020; val_auprc_score: 0.9614; val_best_acc_score: 0.8411; val_best_f1_score: 0.8966; train_kl_reg_loss: 2922.1956; train_edge_recon_loss: 1870308.0733; train_cat_covariates_contrastive_loss: 755386.4483; train_gene_expr_recon_loss: 3788493.0086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6417109.7586; train_optim_loss: 6417109.7586; val_kl_reg_loss: 2820.0480; val_edge_recon_loss: 2032777.9375; val_cat_covariates_contrastive_loss: 627082.1094; val_gene_expr_recon_loss: 3543126.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6205806.5000; val_optim_loss: 6205806.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8465; val_auprc_score: 0.9343; val_best_acc_score: 0.8326; val_best_f1_score: 0.8980; train_kl_reg_loss: 6823.9314; train_edge_recon_loss: 1695480.2241; train_cat_covariates_contrastive_loss: 665516.1121; train_gene_expr_recon_loss: 3345697.1552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5713517.4310; train_optim_loss: 5713517.4310; val_kl_reg_loss: 14178.1860; val_edge_recon_loss: 1631670.2500; val_cat_covariates_contrastive_loss: 627433.0312; val_gene_expr_recon_loss: 3240601.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5513883.2500; val_optim_loss: 5513883.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8645; val_auprc_score: 0.9410; val_best_acc_score: 0.8536; val_best_f1_score: 0.9083; train_kl_reg_loss: 21383.0876; train_edge_recon_loss: 1519274.4224; train_cat_covariates_contrastive_loss: 630975.1983; train_gene_expr_recon_loss: 3133697.9483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5305330.6207; train_optim_loss: 5305330.6207; val_kl_reg_loss: 24560.6792; val_edge_recon_loss: 1485945.3750; val_cat_covariates_contrastive_loss: 627196.0000; val_gene_expr_recon_loss: 3089550.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5227252.7500; val_optim_loss: 5227252.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8940; val_auprc_score: 0.9484; val_best_acc_score: 0.8868; val_best_f1_score: 0.9278; train_kl_reg_loss: 22715.7944; train_edge_recon_loss: 1443140.3147; train_cat_covariates_contrastive_loss: 629466.6961; train_gene_expr_recon_loss: 3014110.4741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5109433.2931; train_optim_loss: 5109433.2931; val_kl_reg_loss: 19910.0845; val_edge_recon_loss: 1424201.4375; val_cat_covariates_contrastive_loss: 627673.7500; val_gene_expr_recon_loss: 3012088.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5083873.7500; val_optim_loss: 5083873.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9101; val_auprc_score: 0.9595; val_best_acc_score: 0.9020; val_best_f1_score: 0.9383; train_kl_reg_loss: 21147.4385; train_edge_recon_loss: 1391559.0690; train_cat_covariates_contrastive_loss: 629803.1228; train_gene_expr_recon_loss: 2950624.8707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4993134.4828; train_optim_loss: 4993134.4828; val_kl_reg_loss: 20908.4253; val_edge_recon_loss: 1342875.6562; val_cat_covariates_contrastive_loss: 628341.0000; val_gene_expr_recon_loss: 2921787.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4913912.5000; val_optim_loss: 4913912.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9157; val_auprc_score: 0.9624; val_best_acc_score: 0.9019; val_best_f1_score: 0.9379; train_kl_reg_loss: 20692.7584; train_edge_recon_loss: 1379333.4957; train_cat_covariates_contrastive_loss: 629651.9332; train_gene_expr_recon_loss: 2908601.8534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4938280.0172; train_optim_loss: 4938280.0172; val_kl_reg_loss: 19948.7075; val_edge_recon_loss: 1369721.3750; val_cat_covariates_contrastive_loss: 628189.4844; val_gene_expr_recon_loss: 2896360.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4914220.3750; val_optim_loss: 4914220.3750
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9176; val_auprc_score: 0.9628; val_best_acc_score: 0.9023; val_best_f1_score: 0.9379; train_kl_reg_loss: 19464.3419; train_edge_recon_loss: 1373535.7500; train_cat_covariates_contrastive_loss: 629563.0431; train_gene_expr_recon_loss: 2881971.4741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4904534.6207; train_optim_loss: 4904534.6207; val_kl_reg_loss: 18875.9248; val_edge_recon_loss: 1385649.4375; val_cat_covariates_contrastive_loss: 628410.7812; val_gene_expr_recon_loss: 2921990.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4954926.7500; val_optim_loss: 4954926.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9204; val_auprc_score: 0.9650; val_best_acc_score: 0.9040; val_best_f1_score: 0.9393; train_kl_reg_loss: 18122.9358; train_edge_recon_loss: 1368803.4612; train_cat_covariates_contrastive_loss: 629916.8405; train_gene_expr_recon_loss: 2863768.9741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4880612.1724; train_optim_loss: 4880612.1724; val_kl_reg_loss: 17553.1445; val_edge_recon_loss: 1341253.6562; val_cat_covariates_contrastive_loss: 628862.4375; val_gene_expr_recon_loss: 2846272.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4833942.1250; val_optim_loss: 4833942.1250
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9248; val_auprc_score: 0.9650; val_best_acc_score: 0.9084; val_best_f1_score: 0.9415; train_kl_reg_loss: 16535.9131; train_edge_recon_loss: 1358099.2112; train_cat_covariates_contrastive_loss: 630499.3836; train_gene_expr_recon_loss: 2849003.1207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4854137.6724; train_optim_loss: 4854137.6724; val_kl_reg_loss: 15802.5742; val_edge_recon_loss: 1369416.6875; val_cat_covariates_contrastive_loss: 630544.4375; val_gene_expr_recon_loss: 2897634.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4913398.5000; val_optim_loss: 4913398.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9294; val_auprc_score: 0.9664; val_best_acc_score: 0.9152; val_best_f1_score: 0.9456; train_kl_reg_loss: 15123.5086; train_edge_recon_loss: 1354893.3147; train_cat_covariates_contrastive_loss: 631706.2845; train_gene_expr_recon_loss: 2836752.6207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4838475.7414; train_optim_loss: 4838475.7414; val_kl_reg_loss: 14893.0723; val_edge_recon_loss: 1381364.0000; val_cat_covariates_contrastive_loss: 631246.8438; val_gene_expr_recon_loss: 2886498.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4914001.8750; val_optim_loss: 4914001.8750
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9340; val_auprc_score: 0.9688; val_best_acc_score: 0.9218; val_best_f1_score: 0.9501; train_kl_reg_loss: 14409.5599; train_edge_recon_loss: 1343999.6336; train_cat_covariates_contrastive_loss: 632903.8427; train_gene_expr_recon_loss: 2823704.3103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4815017.3448; train_optim_loss: 4815017.3448; val_kl_reg_loss: 14910.0117; val_edge_recon_loss: 1337792.4062; val_cat_covariates_contrastive_loss: 631635.1875; val_gene_expr_recon_loss: 2909497.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4893834.8750; val_optim_loss: 4893834.8750
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9327; val_auprc_score: 0.9672; val_best_acc_score: 0.9247; val_best_f1_score: 0.9516; train_kl_reg_loss: 14147.9728; train_edge_recon_loss: 1346028.3621; train_cat_covariates_contrastive_loss: 633208.2823; train_gene_expr_recon_loss: 2814729.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4808114.3276; train_optim_loss: 4808114.3276; val_kl_reg_loss: 14084.3975; val_edge_recon_loss: 1339483.5000; val_cat_covariates_contrastive_loss: 632915.0469; val_gene_expr_recon_loss: 2812300.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4798783.2500; val_optim_loss: 4798783.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9429; val_auprc_score: 0.9731; val_best_acc_score: 0.9256; val_best_f1_score: 0.9517; train_kl_reg_loss: 13763.5730; train_edge_recon_loss: 1341240.7672; train_cat_covariates_contrastive_loss: 633656.5431; train_gene_expr_recon_loss: 2801456.4483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4790117.3103; train_optim_loss: 4790117.3103; val_kl_reg_loss: 13408.3999; val_edge_recon_loss: 1358259.1250; val_cat_covariates_contrastive_loss: 632788.6875; val_gene_expr_recon_loss: 2822041.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4826497.8750; val_optim_loss: 4826497.8750
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9383; val_auprc_score: 0.9700; val_best_acc_score: 0.9227; val_best_f1_score: 0.9499; train_kl_reg_loss: 13457.6544; train_edge_recon_loss: 1340110.2371; train_cat_covariates_contrastive_loss: 633894.1250; train_gene_expr_recon_loss: 2794211.5603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4781673.5690; train_optim_loss: 4781673.5690; val_kl_reg_loss: 13178.7690; val_edge_recon_loss: 1378324.1562; val_cat_covariates_contrastive_loss: 632172.3594; val_gene_expr_recon_loss: 2806646.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4830322.2500; val_optim_loss: 4830322.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9375; val_auprc_score: 0.9704; val_best_acc_score: 0.9245; val_best_f1_score: 0.9513; train_kl_reg_loss: 13139.8198; train_edge_recon_loss: 1335459.9310; train_cat_covariates_contrastive_loss: 633666.4569; train_gene_expr_recon_loss: 2780338.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4762604.2241; train_optim_loss: 4762604.2241; val_kl_reg_loss: 12903.7852; val_edge_recon_loss: 1350725.1250; val_cat_covariates_contrastive_loss: 632057.7500; val_gene_expr_recon_loss: 2779397.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4775083.7500; val_optim_loss: 4775083.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9433; val_auprc_score: 0.9723; val_best_acc_score: 0.9283; val_best_f1_score: 0.9536; train_kl_reg_loss: 12796.2048; train_edge_recon_loss: 1334597.1379; train_cat_covariates_contrastive_loss: 633664.7500; train_gene_expr_recon_loss: 2773194.6207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4754252.7414; train_optim_loss: 4754252.7414; val_kl_reg_loss: 12544.2847; val_edge_recon_loss: 1359047.5938; val_cat_covariates_contrastive_loss: 633490.9062; val_gene_expr_recon_loss: 2785156.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4790239.2500; val_optim_loss: 4790239.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9392; val_auprc_score: 0.9705; val_best_acc_score: 0.9248; val_best_f1_score: 0.9516; train_kl_reg_loss: 12415.0629; train_edge_recon_loss: 1335454.2026; train_cat_covariates_contrastive_loss: 634588.7974; train_gene_expr_recon_loss: 2761784.5517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4744242.6724; train_optim_loss: 4744242.6724; val_kl_reg_loss: 12302.8311; val_edge_recon_loss: 1344765.7500; val_cat_covariates_contrastive_loss: 634702.1250; val_gene_expr_recon_loss: 2786455.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4778226.2500; val_optim_loss: 4778226.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9421; val_auprc_score: 0.9718; val_best_acc_score: 0.9298; val_best_f1_score: 0.9547; train_kl_reg_loss: 12329.6788; train_edge_recon_loss: 1328871.5603; train_cat_covariates_contrastive_loss: 634153.5022; train_gene_expr_recon_loss: 2757247.4569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4732602.2414; train_optim_loss: 4732602.2414; val_kl_reg_loss: 12214.7900; val_edge_recon_loss: 1318790.2812; val_cat_covariates_contrastive_loss: 632675.9688; val_gene_expr_recon_loss: 2819452.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4783133.8750; val_optim_loss: 4783133.8750
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9414; val_auprc_score: 0.9717; val_best_acc_score: 0.9291; val_best_f1_score: 0.9542; train_kl_reg_loss: 12060.3321; train_edge_recon_loss: 1338116.5991; train_cat_covariates_contrastive_loss: 634227.4569; train_gene_expr_recon_loss: 2748129.1724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4732533.5000; train_optim_loss: 4732533.5000; val_kl_reg_loss: 11994.6104; val_edge_recon_loss: 1314201.0000; val_cat_covariates_contrastive_loss: 632503.0625; val_gene_expr_recon_loss: 2751124.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4709823.2500; val_optim_loss: 4709823.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9493; val_auprc_score: 0.9756; val_best_acc_score: 0.9343; val_best_f1_score: 0.9576; train_kl_reg_loss: 11816.5966; train_edge_recon_loss: 1318958.5388; train_cat_covariates_contrastive_loss: 634326.9849; train_gene_expr_recon_loss: 2741986.0345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4707088.1379; train_optim_loss: 4707088.1379; val_kl_reg_loss: 11961.4692; val_edge_recon_loss: 1296377.1562; val_cat_covariates_contrastive_loss: 635177.3750; val_gene_expr_recon_loss: 2749498.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4693014.6250; val_optim_loss: 4693014.6250
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9434; val_auprc_score: 0.9723; val_best_acc_score: 0.9289; val_best_f1_score: 0.9539; train_kl_reg_loss: 11749.1154; train_edge_recon_loss: 1330833.7026; train_cat_covariates_contrastive_loss: 633994.0582; train_gene_expr_recon_loss: 2733933.4483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4710510.3448; train_optim_loss: 4710510.3448; val_kl_reg_loss: 11747.4297; val_edge_recon_loss: 1329940.0000; val_cat_covariates_contrastive_loss: 633828.1406; val_gene_expr_recon_loss: 2758822.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4734338.6250; val_optim_loss: 4734338.6250
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9470; val_auprc_score: 0.9748; val_best_acc_score: 0.9335; val_best_f1_score: 0.9570; train_kl_reg_loss: 11479.6784; train_edge_recon_loss: 1331437.5733; train_cat_covariates_contrastive_loss: 633747.3966; train_gene_expr_recon_loss: 2727919.4569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4704584.1207; train_optim_loss: 4704584.1207; val_kl_reg_loss: 11294.0178; val_edge_recon_loss: 1309785.1562; val_cat_covariates_contrastive_loss: 633910.5156; val_gene_expr_recon_loss: 2734823.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4689813.0000; val_optim_loss: 4689813.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9481; val_auprc_score: 0.9751; val_best_acc_score: 0.9324; val_best_f1_score: 0.9561; train_kl_reg_loss: 11462.6671; train_edge_recon_loss: 1331147.8017; train_cat_covariates_contrastive_loss: 633884.4289; train_gene_expr_recon_loss: 2718501.6293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4694996.5345; train_optim_loss: 4694996.5345; val_kl_reg_loss: 11499.6389; val_edge_recon_loss: 1338374.4062; val_cat_covariates_contrastive_loss: 633960.2500; val_gene_expr_recon_loss: 2728346.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4712180.7500; val_optim_loss: 4712180.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9430; val_auprc_score: 0.9721; val_best_acc_score: 0.9316; val_best_f1_score: 0.9557; train_kl_reg_loss: 11324.5835; train_edge_recon_loss: 1316568.5733; train_cat_covariates_contrastive_loss: 633653.1121; train_gene_expr_recon_loss: 2713475.7241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4675022.0517; train_optim_loss: 4675022.0517; val_kl_reg_loss: 11284.0530; val_edge_recon_loss: 1336943.4062; val_cat_covariates_contrastive_loss: 633385.9844; val_gene_expr_recon_loss: 2729170.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4710783.6250; val_optim_loss: 4710783.6250
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9444; val_auprc_score: 0.9722; val_best_acc_score: 0.9316; val_best_f1_score: 0.9557; train_kl_reg_loss: 11163.2739; train_edge_recon_loss: 1321876.8405; train_cat_covariates_contrastive_loss: 633987.3556; train_gene_expr_recon_loss: 2709022.1724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4676049.6897; train_optim_loss: 4676049.6897; val_kl_reg_loss: 11009.6672; val_edge_recon_loss: 1317935.7500; val_cat_covariates_contrastive_loss: 633810.7031; val_gene_expr_recon_loss: 2676088.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4638844.2500; val_optim_loss: 4638844.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9402; val_auprc_score: 0.9704; val_best_acc_score: 0.9334; val_best_f1_score: 0.9570; train_kl_reg_loss: 11105.3602; train_edge_recon_loss: 1324346.5948; train_cat_covariates_contrastive_loss: 633793.1013; train_gene_expr_recon_loss: 2696516.6121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4665761.6724; train_optim_loss: 4665761.6724; val_kl_reg_loss: 10844.4888; val_edge_recon_loss: 1298500.7500; val_cat_covariates_contrastive_loss: 633326.4531; val_gene_expr_recon_loss: 2733928.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4676600.0000; val_optim_loss: 4676600.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9475; val_auprc_score: 0.9735; val_best_acc_score: 0.9396; val_best_f1_score: 0.9607; train_kl_reg_loss: 11012.7152; train_edge_recon_loss: 1322915.8448; train_cat_covariates_contrastive_loss: 633642.5711; train_gene_expr_recon_loss: 2696266.6552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4663837.7931; train_optim_loss: 4663837.7931; val_kl_reg_loss: 11067.2898; val_edge_recon_loss: 1318756.4688; val_cat_covariates_contrastive_loss: 634022.3750; val_gene_expr_recon_loss: 2732433.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4696279.6250; val_optim_loss: 4696279.6250
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9451; val_auprc_score: 0.9727; val_best_acc_score: 0.9398; val_best_f1_score: 0.9609; train_kl_reg_loss: 10926.4955; train_edge_recon_loss: 1325447.2112; train_cat_covariates_contrastive_loss: 633634.0668; train_gene_expr_recon_loss: 2690117.4828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4660125.2931; train_optim_loss: 4660125.2931; val_kl_reg_loss: 11019.7188; val_edge_recon_loss: 1307811.6562; val_cat_covariates_contrastive_loss: 632175.8594; val_gene_expr_recon_loss: 2726854.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4677861.6250; val_optim_loss: 4677861.6250
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9429; val_auprc_score: 0.9709; val_best_acc_score: 0.9378; val_best_f1_score: 0.9595; train_kl_reg_loss: 10750.5093; train_edge_recon_loss: 1317844.2543; train_cat_covariates_contrastive_loss: 632980.9181; train_gene_expr_recon_loss: 2683600.5776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4645176.2414; train_optim_loss: 4645176.2414; val_kl_reg_loss: 10782.2883; val_edge_recon_loss: 1311576.0625; val_cat_covariates_contrastive_loss: 633285.1875; val_gene_expr_recon_loss: 2704350.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4659993.8750; val_optim_loss: 4659993.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9418; val_auprc_score: 0.9691; val_best_acc_score: 0.9390; val_best_f1_score: 0.9601; train_kl_reg_loss: 10761.5605; train_edge_recon_loss: 1326962.2931; train_cat_covariates_contrastive_loss: 633357.7457; train_gene_expr_recon_loss: 2677144.8362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4648226.5000; train_optim_loss: 4648226.5000; val_kl_reg_loss: 10885.7585; val_edge_recon_loss: 1359044.3750; val_cat_covariates_contrastive_loss: 632826.7969; val_gene_expr_recon_loss: 2701170.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4703927.6250; val_optim_loss: 4703927.6250
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9421; val_auprc_score: 0.9700; val_best_acc_score: 0.9362; val_best_f1_score: 0.9582; train_kl_reg_loss: 10817.6775; train_edge_recon_loss: 1313520.7802; train_cat_covariates_contrastive_loss: 633428.1659; train_gene_expr_recon_loss: 2678156.2931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4635922.9483; train_optim_loss: 4635922.9483; val_kl_reg_loss: 10798.6479; val_edge_recon_loss: 1333644.8438; val_cat_covariates_contrastive_loss: 633027.2188; val_gene_expr_recon_loss: 2690253.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4667724.5000; val_optim_loss: 4667724.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9452; val_auprc_score: 0.9710; val_best_acc_score: 0.9405; val_best_f1_score: 0.9612; train_kl_reg_loss: 10724.2470; train_edge_recon_loss: 1326836.4095; train_cat_covariates_contrastive_loss: 633539.6250; train_gene_expr_recon_loss: 2678357.6121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4649457.9138; train_optim_loss: 4649457.9138; val_kl_reg_loss: 10619.8066; val_edge_recon_loss: 1321552.6562; val_cat_covariates_contrastive_loss: 633211.9062; val_gene_expr_recon_loss: 2652700.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4618084.7500; val_optim_loss: 4618084.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9408; val_auprc_score: 0.9693; val_best_acc_score: 0.9401; val_best_f1_score: 0.9612; train_kl_reg_loss: 10725.5572; train_edge_recon_loss: 1317175.8233; train_cat_covariates_contrastive_loss: 633492.4267; train_gene_expr_recon_loss: 2678528.1724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4639921.9483; train_optim_loss: 4639921.9483; val_kl_reg_loss: 10884.1567; val_edge_recon_loss: 1291547.2188; val_cat_covariates_contrastive_loss: 633351.3594; val_gene_expr_recon_loss: 2685207.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4620990.3750; val_optim_loss: 4620990.3750
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9404; val_auprc_score: 0.9694; val_best_acc_score: 0.9381; val_best_f1_score: 0.9598; train_kl_reg_loss: 10722.7957; train_edge_recon_loss: 1318284.2112; train_cat_covariates_contrastive_loss: 633298.6983; train_gene_expr_recon_loss: 2674757.9310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4637063.6207; train_optim_loss: 4637063.6207; val_kl_reg_loss: 10734.2319; val_edge_recon_loss: 1336402.6875; val_cat_covariates_contrastive_loss: 633422.8906; val_gene_expr_recon_loss: 2690109.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4670669.1250; val_optim_loss: 4670669.1250
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9458; val_auprc_score: 0.9732; val_best_acc_score: 0.9390; val_best_f1_score: 0.9603; train_kl_reg_loss: 10691.5604; train_edge_recon_loss: 1319568.4828; train_cat_covariates_contrastive_loss: 633699.0194; train_gene_expr_recon_loss: 2672693.6810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4636652.7241; train_optim_loss: 4636652.7241; val_kl_reg_loss: 10815.2266; val_edge_recon_loss: 1309228.9688; val_cat_covariates_contrastive_loss: 633300.6406; val_gene_expr_recon_loss: 2659036.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4612381.0000; val_optim_loss: 4612381.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9479; val_auprc_score: 0.9727; val_best_acc_score: 0.9402; val_best_f1_score: 0.9610; train_kl_reg_loss: 10689.6405; train_edge_recon_loss: 1321862.8491; train_cat_covariates_contrastive_loss: 633796.5151; train_gene_expr_recon_loss: 2673872.8103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4640221.8103; train_optim_loss: 4640221.8103; val_kl_reg_loss: 10784.9141; val_edge_recon_loss: 1301986.5625; val_cat_covariates_contrastive_loss: 633145.6250; val_gene_expr_recon_loss: 2667067.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4612984.2500; val_optim_loss: 4612984.2500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9437; val_auprc_score: 0.9705; val_best_acc_score: 0.9398; val_best_f1_score: 0.9610; train_kl_reg_loss: 10707.8132; train_edge_recon_loss: 1332444.2414; train_cat_covariates_contrastive_loss: 633725.7220; train_gene_expr_recon_loss: 2672602.5259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4649480.3276; train_optim_loss: 4649480.3276; val_kl_reg_loss: 10929.3833; val_edge_recon_loss: 1339730.4375; val_cat_covariates_contrastive_loss: 632694.1875; val_gene_expr_recon_loss: 2707157.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4690511.8750; val_optim_loss: 4690511.8750
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9404; val_auprc_score: 0.9689; val_best_acc_score: 0.9393; val_best_f1_score: 0.9606; train_kl_reg_loss: 10746.1837; train_edge_recon_loss: 1317918.3362; train_cat_covariates_contrastive_loss: 633073.1659; train_gene_expr_recon_loss: 2674768.7845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4636506.5172; train_optim_loss: 4636506.5172; val_kl_reg_loss: 10771.3726; val_edge_recon_loss: 1313999.2812; val_cat_covariates_contrastive_loss: 633026.6719; val_gene_expr_recon_loss: 2691031.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4648829.0000; val_optim_loss: 4648829.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9414; val_auprc_score: 0.9703; val_best_acc_score: 0.9418; val_best_f1_score: 0.9625; train_kl_reg_loss: 10722.2847; train_edge_recon_loss: 1318767.8879; train_cat_covariates_contrastive_loss: 633281.2953; train_gene_expr_recon_loss: 2673975.9397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4636747.3621; train_optim_loss: 4636747.3621; val_kl_reg_loss: 10879.0244; val_edge_recon_loss: 1270787.5312; val_cat_covariates_contrastive_loss: 632949.1562; val_gene_expr_recon_loss: 2734016.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4648631.8750; val_optim_loss: 4648631.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9428; val_auprc_score: 0.9699; val_best_acc_score: 0.9414; val_best_f1_score: 0.9618; train_kl_reg_loss: 10747.6736; train_edge_recon_loss: 1321110.5259; train_cat_covariates_contrastive_loss: 633398.6164; train_gene_expr_recon_loss: 2675358.0345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4640614.8448; train_optim_loss: 4640614.8448; val_kl_reg_loss: 10684.7563; val_edge_recon_loss: 1322390.1250; val_cat_covariates_contrastive_loss: 633398.1719; val_gene_expr_recon_loss: 2686109.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4652582.7500; val_optim_loss: 4652582.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9424; val_auprc_score: 0.9704; val_best_acc_score: 0.9397; val_best_f1_score: 0.9609; train_kl_reg_loss: 10744.4130; train_edge_recon_loss: 1317492.3836; train_cat_covariates_contrastive_loss: 633301.3901; train_gene_expr_recon_loss: 2673277.4397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4634815.6207; train_optim_loss: 4634815.6207; val_kl_reg_loss: 10822.9243; val_edge_recon_loss: 1320733.1875; val_cat_covariates_contrastive_loss: 633493.5781; val_gene_expr_recon_loss: 2650027.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4615076.8750; val_optim_loss: 4615076.8750
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9418; val_auprc_score: 0.9692; val_best_acc_score: 0.9394; val_best_f1_score: 0.9607; train_kl_reg_loss: 10736.6832; train_edge_recon_loss: 1316722.9871; train_cat_covariates_contrastive_loss: 633080.0948; train_gene_expr_recon_loss: 2673507.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4634046.7414; train_optim_loss: 4634046.7414; val_kl_reg_loss: 10799.3862; val_edge_recon_loss: 1321886.7812; val_cat_covariates_contrastive_loss: 632967.5000; val_gene_expr_recon_loss: 2664687.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4630341.6250; val_optim_loss: 4630341.6250
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9418; val_auprc_score: 0.9696; val_best_acc_score: 0.9401; val_best_f1_score: 0.9610; train_kl_reg_loss: 10741.3552; train_edge_recon_loss: 1316819.3836; train_cat_covariates_contrastive_loss: 633000.3168; train_gene_expr_recon_loss: 2672140.1983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4632701.1897; train_optim_loss: 4632701.1897; val_kl_reg_loss: 10768.8240; val_edge_recon_loss: 1323401.9062; val_cat_covariates_contrastive_loss: 633574.6875; val_gene_expr_recon_loss: 2673382.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4641127.5000; val_optim_loss: 4641127.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 10 min 15 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
val AUROC score: 0.9408
val AUPRC score: 0.9681
val best accuracy score: 0.9404
val best F1 score: 0.9611
val target rna MSE score: 0.9184
val source rna MSE score: 0.1206
Val cat covariate0 mean sim diff: 0.0022
Val cat covariate1 mean sim diff: -0.0798
Duration of model training in run 8: 0 hours, 10 minutes and 25 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 12706
Number of validation nodes: 1412
Number of training edges: 116179
Number of validation edges: 12908
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8992; val_auprc_score: 0.9617; val_best_acc_score: 0.8345; val_best_f1_score: 0.8981; train_kl_reg_loss: 2521.1755; train_edge_recon_loss: 1847358.0259; train_cat_covariates_contrastive_loss: 756120.7198; train_gene_expr_recon_loss: 3838181.9655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6444181.8621; train_optim_loss: 6444181.8621; val_kl_reg_loss: 2776.3348; val_edge_recon_loss: 1949506.8438; val_cat_covariates_contrastive_loss: 627166.7969; val_gene_expr_recon_loss: 3482177.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6061627.2500; val_optim_loss: 6061627.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8605; val_auprc_score: 0.9412; val_best_acc_score: 0.8460; val_best_f1_score: 0.9038; train_kl_reg_loss: 7221.6413; train_edge_recon_loss: 1697650.5560; train_cat_covariates_contrastive_loss: 663544.2586; train_gene_expr_recon_loss: 3345842.1638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5714258.6034; train_optim_loss: 5714258.6034; val_kl_reg_loss: 14966.7119; val_edge_recon_loss: 1598747.5938; val_cat_covariates_contrastive_loss: 627468.8438; val_gene_expr_recon_loss: 3131809.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5372992.7500; val_optim_loss: 5372992.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8567; val_auprc_score: 0.9376; val_best_acc_score: 0.8463; val_best_f1_score: 0.9053; train_kl_reg_loss: 22720.3298; train_edge_recon_loss: 1507017.9440; train_cat_covariates_contrastive_loss: 629940.7328; train_gene_expr_recon_loss: 3112827.0776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5272506.1379; train_optim_loss: 5272506.1379; val_kl_reg_loss: 24627.9326; val_edge_recon_loss: 1525473.1562; val_cat_covariates_contrastive_loss: 627107.2812; val_gene_expr_recon_loss: 3028852.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5206060.6250; val_optim_loss: 5206060.6250
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8850; val_auprc_score: 0.9492; val_best_acc_score: 0.8617; val_best_f1_score: 0.9128; train_kl_reg_loss: 24152.8340; train_edge_recon_loss: 1472051.6293; train_cat_covariates_contrastive_loss: 628804.5108; train_gene_expr_recon_loss: 2999106.7845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5124115.7586; train_optim_loss: 5124115.7586; val_kl_reg_loss: 21663.1172; val_edge_recon_loss: 1424885.9375; val_cat_covariates_contrastive_loss: 627416.1250; val_gene_expr_recon_loss: 2986285.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5060250.5000; val_optim_loss: 5060250.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9143; val_auprc_score: 0.9607; val_best_acc_score: 0.8993; val_best_f1_score: 0.9362; train_kl_reg_loss: 20996.0212; train_edge_recon_loss: 1413044.4914; train_cat_covariates_contrastive_loss: 630334.6659; train_gene_expr_recon_loss: 2941868.5603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5006243.7759; train_optim_loss: 5006243.7759; val_kl_reg_loss: 23174.4922; val_edge_recon_loss: 1419274.7812; val_cat_covariates_contrastive_loss: 628312.2969; val_gene_expr_recon_loss: 2939426.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5010188.5000; val_optim_loss: 5010188.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9158; val_auprc_score: 0.9625; val_best_acc_score: 0.8972; val_best_f1_score: 0.9352; train_kl_reg_loss: 21957.4516; train_edge_recon_loss: 1387448.6207; train_cat_covariates_contrastive_loss: 629732.7672; train_gene_expr_recon_loss: 2904964.0862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4944102.8793; train_optim_loss: 4944102.8793; val_kl_reg_loss: 20202.4692; val_edge_recon_loss: 1394865.4062; val_cat_covariates_contrastive_loss: 628199.6094; val_gene_expr_recon_loss: 2883242.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4926509.7500; val_optim_loss: 4926509.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9166; val_auprc_score: 0.9611; val_best_acc_score: 0.9031; val_best_f1_score: 0.9390; train_kl_reg_loss: 20018.8309; train_edge_recon_loss: 1373955.0172; train_cat_covariates_contrastive_loss: 629874.6853; train_gene_expr_recon_loss: 2873986.4397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4897835.0000; train_optim_loss: 4897835.0000; val_kl_reg_loss: 19006.0972; val_edge_recon_loss: 1381079.7500; val_cat_covariates_contrastive_loss: 628867.9062; val_gene_expr_recon_loss: 2855001.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4883955.3750; val_optim_loss: 4883955.3750
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9233; val_auprc_score: 0.9645; val_best_acc_score: 0.9048; val_best_f1_score: 0.9396; train_kl_reg_loss: 18445.8244; train_edge_recon_loss: 1369341.1250; train_cat_covariates_contrastive_loss: 630122.1681; train_gene_expr_recon_loss: 2855600.5948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4873509.7069; train_optim_loss: 4873509.7069; val_kl_reg_loss: 17396.5635; val_edge_recon_loss: 1354234.2812; val_cat_covariates_contrastive_loss: 629015.9219; val_gene_expr_recon_loss: 2853370.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4854017.2500; val_optim_loss: 4854017.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9299; val_auprc_score: 0.9674; val_best_acc_score: 0.9119; val_best_f1_score: 0.9437; train_kl_reg_loss: 16806.0934; train_edge_recon_loss: 1354742.4310; train_cat_covariates_contrastive_loss: 630793.7694; train_gene_expr_recon_loss: 2839209.6207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4841551.9483; train_optim_loss: 4841551.9483; val_kl_reg_loss: 16178.1584; val_edge_recon_loss: 1364967.0312; val_cat_covariates_contrastive_loss: 630348.2031; val_gene_expr_recon_loss: 2806125.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4817619.2500; val_optim_loss: 4817619.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9285; val_auprc_score: 0.9669; val_best_acc_score: 0.9177; val_best_f1_score: 0.9471; train_kl_reg_loss: 15530.6304; train_edge_recon_loss: 1362194.5129; train_cat_covariates_contrastive_loss: 631790.3276; train_gene_expr_recon_loss: 2825107.9224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4834623.3793; train_optim_loss: 4834623.3793; val_kl_reg_loss: 15011.7554; val_edge_recon_loss: 1352826.1562; val_cat_covariates_contrastive_loss: 631190.2344; val_gene_expr_recon_loss: 2825890.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4824918.8750; val_optim_loss: 4824918.8750
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9341; val_auprc_score: 0.9698; val_best_acc_score: 0.9190; val_best_f1_score: 0.9478; train_kl_reg_loss: 14684.4726; train_edge_recon_loss: 1346063.8750; train_cat_covariates_contrastive_loss: 633178.2263; train_gene_expr_recon_loss: 2811338.0517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4805264.6379; train_optim_loss: 4805264.6379; val_kl_reg_loss: 14314.0449; val_edge_recon_loss: 1364195.9688; val_cat_covariates_contrastive_loss: 632062.7500; val_gene_expr_recon_loss: 2777851.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4788423.8750; val_optim_loss: 4788423.8750
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9430; val_auprc_score: 0.9712; val_best_acc_score: 0.9262; val_best_f1_score: 0.9525; train_kl_reg_loss: 14313.4787; train_edge_recon_loss: 1329153.5431; train_cat_covariates_contrastive_loss: 634039.0108; train_gene_expr_recon_loss: 2798311.8362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4775817.8793; train_optim_loss: 4775817.8793; val_kl_reg_loss: 14174.6931; val_edge_recon_loss: 1329547.3750; val_cat_covariates_contrastive_loss: 634289.2812; val_gene_expr_recon_loss: 2769613.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4747625.2500; val_optim_loss: 4747625.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9417; val_auprc_score: 0.9736; val_best_acc_score: 0.9241; val_best_f1_score: 0.9513; train_kl_reg_loss: 14037.4671; train_edge_recon_loss: 1339634.6466; train_cat_covariates_contrastive_loss: 634419.8103; train_gene_expr_recon_loss: 2787619.5517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4775711.5345; train_optim_loss: 4775711.5345; val_kl_reg_loss: 13874.2524; val_edge_recon_loss: 1348540.1562; val_cat_covariates_contrastive_loss: 633848.1562; val_gene_expr_recon_loss: 2744441.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4740703.5000; val_optim_loss: 4740703.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9404; val_auprc_score: 0.9722; val_best_acc_score: 0.9239; val_best_f1_score: 0.9509; train_kl_reg_loss: 13738.8846; train_edge_recon_loss: 1333585.1336; train_cat_covariates_contrastive_loss: 634469.4353; train_gene_expr_recon_loss: 2780465.8017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4762259.1897; train_optim_loss: 4762259.1897; val_kl_reg_loss: 13432.7793; val_edge_recon_loss: 1347896.8125; val_cat_covariates_contrastive_loss: 633761.1562; val_gene_expr_recon_loss: 2736819.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4731909.8750; val_optim_loss: 4731909.8750
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9421; val_auprc_score: 0.9741; val_best_acc_score: 0.9246; val_best_f1_score: 0.9517; train_kl_reg_loss: 13389.5053; train_edge_recon_loss: 1334533.8405; train_cat_covariates_contrastive_loss: 634674.6659; train_gene_expr_recon_loss: 2770806.8362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4753404.8621; train_optim_loss: 4753404.8621; val_kl_reg_loss: 13079.3672; val_edge_recon_loss: 1327892.3750; val_cat_covariates_contrastive_loss: 633945.8750; val_gene_expr_recon_loss: 2741149.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4716067.1250; val_optim_loss: 4716067.1250
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9452; val_auprc_score: 0.9754; val_best_acc_score: 0.9283; val_best_f1_score: 0.9539; train_kl_reg_loss: 13109.0170; train_edge_recon_loss: 1336162.4353; train_cat_covariates_contrastive_loss: 634906.4504; train_gene_expr_recon_loss: 2761295.1552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4745473.0690; train_optim_loss: 4745473.0690; val_kl_reg_loss: 12676.4819; val_edge_recon_loss: 1311835.7812; val_cat_covariates_contrastive_loss: 634110.0625; val_gene_expr_recon_loss: 2736869.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4695491.8750; val_optim_loss: 4695491.8750
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9442; val_auprc_score: 0.9738; val_best_acc_score: 0.9256; val_best_f1_score: 0.9523; train_kl_reg_loss: 12807.8120; train_edge_recon_loss: 1334608.7112; train_cat_covariates_contrastive_loss: 635066.8815; train_gene_expr_recon_loss: 2752044.2069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4734527.6034; train_optim_loss: 4734527.6034; val_kl_reg_loss: 12606.8025; val_edge_recon_loss: 1330167.1562; val_cat_covariates_contrastive_loss: 633753.0469; val_gene_expr_recon_loss: 2740148.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4716675.5000; val_optim_loss: 4716675.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9448; val_auprc_score: 0.9731; val_best_acc_score: 0.9289; val_best_f1_score: 0.9541; train_kl_reg_loss: 12482.1432; train_edge_recon_loss: 1328093.2802; train_cat_covariates_contrastive_loss: 634830.5560; train_gene_expr_recon_loss: 2744498.7155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4719904.6724; train_optim_loss: 4719904.6724; val_kl_reg_loss: 12544.9980; val_edge_recon_loss: 1308718.4688; val_cat_covariates_contrastive_loss: 635512.7969; val_gene_expr_recon_loss: 2772403.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4729179.5000; val_optim_loss: 4729179.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9425; val_auprc_score: 0.9723; val_best_acc_score: 0.9262; val_best_f1_score: 0.9523; train_kl_reg_loss: 12410.5057; train_edge_recon_loss: 1325884.0690; train_cat_covariates_contrastive_loss: 635063.0086; train_gene_expr_recon_loss: 2736573.9741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4709931.5345; train_optim_loss: 4709931.5345; val_kl_reg_loss: 11936.7251; val_edge_recon_loss: 1345897.5625; val_cat_covariates_contrastive_loss: 635552.1250; val_gene_expr_recon_loss: 2675223.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4668610.0000; val_optim_loss: 4668610.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9442; val_auprc_score: 0.9735; val_best_acc_score: 0.9284; val_best_f1_score: 0.9540; train_kl_reg_loss: 12248.8078; train_edge_recon_loss: 1336908.5733; train_cat_covariates_contrastive_loss: 634854.1422; train_gene_expr_recon_loss: 2733999.0948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4718010.5862; train_optim_loss: 4718010.5862; val_kl_reg_loss: 12181.5142; val_edge_recon_loss: 1336150.7812; val_cat_covariates_contrastive_loss: 634546.0312; val_gene_expr_recon_loss: 2745861.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4728740.1250; val_optim_loss: 4728740.1250
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9419; val_auprc_score: 0.9711; val_best_acc_score: 0.9281; val_best_f1_score: 0.9538; train_kl_reg_loss: 12037.3102; train_edge_recon_loss: 1333465.3491; train_cat_covariates_contrastive_loss: 634805.2802; train_gene_expr_recon_loss: 2724441.6897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4704749.6552; train_optim_loss: 4704749.6552; val_kl_reg_loss: 11880.0337; val_edge_recon_loss: 1326907.8438; val_cat_covariates_contrastive_loss: 633754.6406; val_gene_expr_recon_loss: 2684531.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4657074.5000; val_optim_loss: 4657074.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9462; val_auprc_score: 0.9750; val_best_acc_score: 0.9301; val_best_f1_score: 0.9551; train_kl_reg_loss: 11892.5789; train_edge_recon_loss: 1323593.3491; train_cat_covariates_contrastive_loss: 634820.0108; train_gene_expr_recon_loss: 2718936.6724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4689242.6552; train_optim_loss: 4689242.6552; val_kl_reg_loss: 11848.3083; val_edge_recon_loss: 1322222.5625; val_cat_covariates_contrastive_loss: 634461.6250; val_gene_expr_recon_loss: 2721040.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4689572.7500; val_optim_loss: 4689572.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9467; val_auprc_score: 0.9745; val_best_acc_score: 0.9315; val_best_f1_score: 0.9556; train_kl_reg_loss: 11797.3288; train_edge_recon_loss: 1326984.9310; train_cat_covariates_contrastive_loss: 634927.3578; train_gene_expr_recon_loss: 2709241.6207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4682951.2414; train_optim_loss: 4682951.2414; val_kl_reg_loss: 11527.0999; val_edge_recon_loss: 1362331.0625; val_cat_covariates_contrastive_loss: 634603.1719; val_gene_expr_recon_loss: 2694498.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4702960.0000; val_optim_loss: 4702960.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9459; val_auprc_score: 0.9746; val_best_acc_score: 0.9316; val_best_f1_score: 0.9561; train_kl_reg_loss: 11691.2426; train_edge_recon_loss: 1331386.3103; train_cat_covariates_contrastive_loss: 634767.1228; train_gene_expr_recon_loss: 2703864.7759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4681709.4483; train_optim_loss: 4681709.4483; val_kl_reg_loss: 11544.3032; val_edge_recon_loss: 1318796.1875; val_cat_covariates_contrastive_loss: 633371.0938; val_gene_expr_recon_loss: 2674790.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4638501.3750; val_optim_loss: 4638501.3750
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9469; val_auprc_score: 0.9748; val_best_acc_score: 0.9304; val_best_f1_score: 0.9552; train_kl_reg_loss: 11565.1389; train_edge_recon_loss: 1324054.5905; train_cat_covariates_contrastive_loss: 634903.6940; train_gene_expr_recon_loss: 2699791.4397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4670314.8621; train_optim_loss: 4670314.8621; val_kl_reg_loss: 11358.1863; val_edge_recon_loss: 1322974.7500; val_cat_covariates_contrastive_loss: 633533.8125; val_gene_expr_recon_loss: 2674709.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4642576.1250; val_optim_loss: 4642576.1250
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9478; val_auprc_score: 0.9750; val_best_acc_score: 0.9302; val_best_f1_score: 0.9549; train_kl_reg_loss: 11506.3971; train_edge_recon_loss: 1332023.9181; train_cat_covariates_contrastive_loss: 634897.1789; train_gene_expr_recon_loss: 2694208.3448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4672635.8966; train_optim_loss: 4672635.8966; val_kl_reg_loss: 11552.7725; val_edge_recon_loss: 1336162.4062; val_cat_covariates_contrastive_loss: 633481.4375; val_gene_expr_recon_loss: 2677981.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4659178.3750; val_optim_loss: 4659178.3750
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9463; val_auprc_score: 0.9752; val_best_acc_score: 0.9341; val_best_f1_score: 0.9576; train_kl_reg_loss: 11390.8564; train_edge_recon_loss: 1321119.4655; train_cat_covariates_contrastive_loss: 634574.7177; train_gene_expr_recon_loss: 2687220.1034; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4654305.1379; train_optim_loss: 4654305.1379; val_kl_reg_loss: 11179.7898; val_edge_recon_loss: 1306207.8750; val_cat_covariates_contrastive_loss: 633719.4219; val_gene_expr_recon_loss: 2706261.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4657368.3750; val_optim_loss: 4657368.3750
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9460; val_auprc_score: 0.9731; val_best_acc_score: 0.9354; val_best_f1_score: 0.9582; train_kl_reg_loss: 11380.7393; train_edge_recon_loss: 1322992.8707; train_cat_covariates_contrastive_loss: 634425.8621; train_gene_expr_recon_loss: 2681486.8276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4650286.3448; train_optim_loss: 4650286.3448; val_kl_reg_loss: 11253.8350; val_edge_recon_loss: 1324426.3750; val_cat_covariates_contrastive_loss: 634223.8281; val_gene_expr_recon_loss: 2697292.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4667196.0000; val_optim_loss: 4667196.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9455; val_auprc_score: 0.9724; val_best_acc_score: 0.9355; val_best_f1_score: 0.9582; train_kl_reg_loss: 11270.6250; train_edge_recon_loss: 1327197.7586; train_cat_covariates_contrastive_loss: 634720.0388; train_gene_expr_recon_loss: 2677806.3362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4650994.7586; train_optim_loss: 4650994.7586; val_kl_reg_loss: 11206.9856; val_edge_recon_loss: 1309112.6562; val_cat_covariates_contrastive_loss: 633917.5938; val_gene_expr_recon_loss: 2695206.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4649443.1250; val_optim_loss: 4649443.1250
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9496; val_auprc_score: 0.9761; val_best_acc_score: 0.9355; val_best_f1_score: 0.9581; train_kl_reg_loss: 11337.2567; train_edge_recon_loss: 1317879.0603; train_cat_covariates_contrastive_loss: 634347.7284; train_gene_expr_recon_loss: 2677947.1293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4641511.1552; train_optim_loss: 4641511.1552; val_kl_reg_loss: 11236.3152; val_edge_recon_loss: 1323373.6875; val_cat_covariates_contrastive_loss: 634315.8438; val_gene_expr_recon_loss: 2617439.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4586365.3750; val_optim_loss: 4586365.3750
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9440; val_auprc_score: 0.9726; val_best_acc_score: 0.9336; val_best_f1_score: 0.9573; train_kl_reg_loss: 11336.0147; train_edge_recon_loss: 1327266.2586; train_cat_covariates_contrastive_loss: 634442.0862; train_gene_expr_recon_loss: 2674992.0086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4648036.3103; train_optim_loss: 4648036.3103; val_kl_reg_loss: 11196.5571; val_edge_recon_loss: 1303232.3125; val_cat_covariates_contrastive_loss: 633693.3594; val_gene_expr_recon_loss: 2653904.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4602026.5000; val_optim_loss: 4602026.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9457; val_auprc_score: 0.9723; val_best_acc_score: 0.9348; val_best_f1_score: 0.9579; train_kl_reg_loss: 11315.6835; train_edge_recon_loss: 1326907.5948; train_cat_covariates_contrastive_loss: 634230.8362; train_gene_expr_recon_loss: 2673033.2931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4645487.3966; train_optim_loss: 4645487.3966; val_kl_reg_loss: 11175.9956; val_edge_recon_loss: 1337650.1250; val_cat_covariates_contrastive_loss: 635496.6562; val_gene_expr_recon_loss: 2647876.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4632198.8750; val_optim_loss: 4632198.8750
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9489; val_auprc_score: 0.9756; val_best_acc_score: 0.9332; val_best_f1_score: 0.9569; train_kl_reg_loss: 11277.7197; train_edge_recon_loss: 1320896.3879; train_cat_covariates_contrastive_loss: 634488.9159; train_gene_expr_recon_loss: 2673141.3017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4639804.3621; train_optim_loss: 4639804.3621; val_kl_reg_loss: 11275.9253; val_edge_recon_loss: 1324349.6562; val_cat_covariates_contrastive_loss: 633928.6250; val_gene_expr_recon_loss: 2622588.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4592142.5000; val_optim_loss: 4592142.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9464; val_auprc_score: 0.9750; val_best_acc_score: 0.9353; val_best_f1_score: 0.9582; train_kl_reg_loss: 11303.8290; train_edge_recon_loss: 1329646.9397; train_cat_covariates_contrastive_loss: 634875.1638; train_gene_expr_recon_loss: 2675250.3448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4651076.2759; train_optim_loss: 4651076.2759; val_kl_reg_loss: 11132.2134; val_edge_recon_loss: 1287827.3438; val_cat_covariates_contrastive_loss: 633548.2500; val_gene_expr_recon_loss: 2665081.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4597588.8750; val_optim_loss: 4597588.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9476; val_auprc_score: 0.9752; val_best_acc_score: 0.9339; val_best_f1_score: 0.9573; train_kl_reg_loss: 11288.8295; train_edge_recon_loss: 1321574.9483; train_cat_covariates_contrastive_loss: 634615.3190; train_gene_expr_recon_loss: 2671553.4655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4639032.5517; train_optim_loss: 4639032.5517; val_kl_reg_loss: 11385.5039; val_edge_recon_loss: 1340816.7812; val_cat_covariates_contrastive_loss: 633689.5938; val_gene_expr_recon_loss: 2632926.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4618817.8750; val_optim_loss: 4618817.8750
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9474; val_auprc_score: 0.9750; val_best_acc_score: 0.9329; val_best_f1_score: 0.9569; train_kl_reg_loss: 11284.2127; train_edge_recon_loss: 1319537.2155; train_cat_covariates_contrastive_loss: 634602.6810; train_gene_expr_recon_loss: 2670943.1379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4636367.2586; train_optim_loss: 4636367.2586; val_kl_reg_loss: 11295.2202; val_edge_recon_loss: 1323013.5625; val_cat_covariates_contrastive_loss: 633701.9531; val_gene_expr_recon_loss: 2696872.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4664882.8750; val_optim_loss: 4664882.8750
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9442; val_auprc_score: 0.9726; val_best_acc_score: 0.9353; val_best_f1_score: 0.9583; train_kl_reg_loss: 11293.0355; train_edge_recon_loss: 1321548.9914; train_cat_covariates_contrastive_loss: 634801.1789; train_gene_expr_recon_loss: 2671338.8190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4638982.0345; train_optim_loss: 4638982.0345; val_kl_reg_loss: 11135.2468; val_edge_recon_loss: 1334243.2812; val_cat_covariates_contrastive_loss: 634906.5625; val_gene_expr_recon_loss: 2629583.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4609868.7500; val_optim_loss: 4609868.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9479; val_auprc_score: 0.9748; val_best_acc_score: 0.9309; val_best_f1_score: 0.9551; train_kl_reg_loss: 11314.4607; train_edge_recon_loss: 1332203.0129; train_cat_covariates_contrastive_loss: 634386.0043; train_gene_expr_recon_loss: 2673300.1207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4651203.5690; train_optim_loss: 4651203.5690; val_kl_reg_loss: 11266.1758; val_edge_recon_loss: 1366289.4688; val_cat_covariates_contrastive_loss: 634247.0938; val_gene_expr_recon_loss: 2630596.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4642399.7500; val_optim_loss: 4642399.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 9 min 22 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
val AUROC score: 0.9423
val AUPRC score: 0.9713
val best accuracy score: 0.9315
val best F1 score: 0.9558
val target rna MSE score: 0.9886
val source rna MSE score: 0.1302
Val cat covariate0 mean sim diff: 0.0005
Val cat covariate1 mean sim diff: -0.0867
Duration of model training in run 7: 0 hours, 9 minutes and 30 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 12706
Number of validation nodes: 1412
Number of training edges: 87817
Number of validation edges: 9757
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9517; val_auprc_score: 0.9810; val_best_acc_score: 0.8260; val_best_f1_score: 0.8955; train_kl_reg_loss: 2558.6363; train_edge_recon_loss: 1871897.5511; train_cat_covariates_contrastive_loss: 784432.4148; train_gene_expr_recon_loss: 3868473.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6527362.4545; train_optim_loss: 6527362.4545; val_kl_reg_loss: 1886.8988; val_edge_recon_loss: 2034852.0417; val_cat_covariates_contrastive_loss: 627164.0000; val_gene_expr_recon_loss: 3632373.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6296276.6667; val_optim_loss: 6296276.6667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8813; val_auprc_score: 0.9509; val_best_acc_score: 0.8588; val_best_f1_score: 0.9115; train_kl_reg_loss: 2996.4260; train_edge_recon_loss: 1769821.1591; train_cat_covariates_contrastive_loss: 680044.9915; train_gene_expr_recon_loss: 3445779.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5898641.4545; train_optim_loss: 5898641.4545; val_kl_reg_loss: 5083.5229; val_edge_recon_loss: 1772798.1667; val_cat_covariates_contrastive_loss: 627837.8333; val_gene_expr_recon_loss: 3345356.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5751075.5000; val_optim_loss: 5751075.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8565; val_auprc_score: 0.9372; val_best_acc_score: 0.8457; val_best_f1_score: 0.9028; train_kl_reg_loss: 9749.3683; train_edge_recon_loss: 1624991.2045; train_cat_covariates_contrastive_loss: 650261.0597; train_gene_expr_recon_loss: 3210573.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5495574.9318; train_optim_loss: 5495574.9318; val_kl_reg_loss: 18094.1803; val_edge_recon_loss: 1532332.5833; val_cat_covariates_contrastive_loss: 627222.7500; val_gene_expr_recon_loss: 3132304.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5309953.6667; val_optim_loss: 5309953.6667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8595; val_auprc_score: 0.9403; val_best_acc_score: 0.8493; val_best_f1_score: 0.9060; train_kl_reg_loss: 21490.3790; train_edge_recon_loss: 1485458.9716; train_cat_covariates_contrastive_loss: 628929.2244; train_gene_expr_recon_loss: 3077314.7045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5213193.3182; train_optim_loss: 5213193.3182; val_kl_reg_loss: 24156.7682; val_edge_recon_loss: 1486750.2500; val_cat_covariates_contrastive_loss: 627029.8542; val_gene_expr_recon_loss: 3019651.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5157588.3333; val_optim_loss: 5157588.3333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8859; val_auprc_score: 0.9513; val_best_acc_score: 0.8666; val_best_f1_score: 0.9170; train_kl_reg_loss: 22715.2039; train_edge_recon_loss: 1454510.8409; train_cat_covariates_contrastive_loss: 629050.7301; train_gene_expr_recon_loss: 2986680.2614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5092956.9545; train_optim_loss: 5092956.9545; val_kl_reg_loss: 21103.1081; val_edge_recon_loss: 1431077.5833; val_cat_covariates_contrastive_loss: 627401.7917; val_gene_expr_recon_loss: 2868300.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4947883.0000; val_optim_loss: 4947883.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9015; val_auprc_score: 0.9524; val_best_acc_score: 0.8942; val_best_f1_score: 0.9325; train_kl_reg_loss: 20141.0268; train_edge_recon_loss: 1408570.5795; train_cat_covariates_contrastive_loss: 630129.3068; train_gene_expr_recon_loss: 2932610.8409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4991451.7727; train_optim_loss: 4991451.7727; val_kl_reg_loss: 19595.9382; val_edge_recon_loss: 1413255.2917; val_cat_covariates_contrastive_loss: 627978.1250; val_gene_expr_recon_loss: 2923475.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4984305.1667; val_optim_loss: 4984305.1667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9162; val_auprc_score: 0.9624; val_best_acc_score: 0.9012; val_best_f1_score: 0.9374; train_kl_reg_loss: 20266.5881; train_edge_recon_loss: 1380687.6591; train_cat_covariates_contrastive_loss: 630156.2642; train_gene_expr_recon_loss: 2896608.1023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4927718.5455; train_optim_loss: 4927718.5455; val_kl_reg_loss: 20146.8555; val_edge_recon_loss: 1348250.8750; val_cat_covariates_contrastive_loss: 628655.4583; val_gene_expr_recon_loss: 2880549.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4877602.6667; val_optim_loss: 4877602.6667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9179; val_auprc_score: 0.9621; val_best_acc_score: 0.8987; val_best_f1_score: 0.9352; train_kl_reg_loss: 19700.9769; train_edge_recon_loss: 1381024.5341; train_cat_covariates_contrastive_loss: 630271.3551; train_gene_expr_recon_loss: 2873543.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4904540.4091; train_optim_loss: 4904540.4091; val_kl_reg_loss: 19287.1986; val_edge_recon_loss: 1384068.7083; val_cat_covariates_contrastive_loss: 628652.5417; val_gene_expr_recon_loss: 2850670.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4882679.3333; val_optim_loss: 4882679.3333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9194; val_auprc_score: 0.9630; val_best_acc_score: 0.9018; val_best_f1_score: 0.9375; train_kl_reg_loss: 18806.8429; train_edge_recon_loss: 1375285.7557; train_cat_covariates_contrastive_loss: 630566.3665; train_gene_expr_recon_loss: 2850690.1477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4875349.0455; train_optim_loss: 4875349.0455; val_kl_reg_loss: 18514.5781; val_edge_recon_loss: 1355338.6667; val_cat_covariates_contrastive_loss: 629252.1042; val_gene_expr_recon_loss: 2873120.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4876226.0000; val_optim_loss: 4876226.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9271; val_auprc_score: 0.9664; val_best_acc_score: 0.9096; val_best_f1_score: 0.9420; train_kl_reg_loss: 17531.4719; train_edge_recon_loss: 1362382.6989; train_cat_covariates_contrastive_loss: 630637.3778; train_gene_expr_recon_loss: 2833786.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4844337.5682; train_optim_loss: 4844337.5682; val_kl_reg_loss: 16805.6647; val_edge_recon_loss: 1344744.5417; val_cat_covariates_contrastive_loss: 630385.6042; val_gene_expr_recon_loss: 2838086.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4830022.1667; val_optim_loss: 4830022.1667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9307; val_auprc_score: 0.9673; val_best_acc_score: 0.9170; val_best_f1_score: 0.9465; train_kl_reg_loss: 16608.2790; train_edge_recon_loss: 1359540.2330; train_cat_covariates_contrastive_loss: 631633.2131; train_gene_expr_recon_loss: 2822304.1932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4830085.8636; train_optim_loss: 4830085.8636; val_kl_reg_loss: 16296.3490; val_edge_recon_loss: 1351355.9583; val_cat_covariates_contrastive_loss: 631110.5208; val_gene_expr_recon_loss: 2842019.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4840782.3333; val_optim_loss: 4840782.3333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9293; val_auprc_score: 0.9673; val_best_acc_score: 0.9203; val_best_f1_score: 0.9490; train_kl_reg_loss: 15853.8686; train_edge_recon_loss: 1343542.3182; train_cat_covariates_contrastive_loss: 633249.2415; train_gene_expr_recon_loss: 2810452.9659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4803098.3864; train_optim_loss: 4803098.3864; val_kl_reg_loss: 15638.1159; val_edge_recon_loss: 1322444.7917; val_cat_covariates_contrastive_loss: 632668.2917; val_gene_expr_recon_loss: 2810785.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4781536.1667; val_optim_loss: 4781536.1667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9302; val_auprc_score: 0.9652; val_best_acc_score: 0.9201; val_best_f1_score: 0.9487; train_kl_reg_loss: 15384.4184; train_edge_recon_loss: 1351952.3125; train_cat_covariates_contrastive_loss: 634036.9858; train_gene_expr_recon_loss: 2797077.8523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4798451.5909; train_optim_loss: 4798451.5909; val_kl_reg_loss: 15281.0329; val_edge_recon_loss: 1348616.2083; val_cat_covariates_contrastive_loss: 633404.8333; val_gene_expr_recon_loss: 2776586.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4773889.0000; val_optim_loss: 4773889.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9386; val_auprc_score: 0.9711; val_best_acc_score: 0.9231; val_best_f1_score: 0.9506; train_kl_reg_loss: 15234.1576; train_edge_recon_loss: 1339975.7273; train_cat_covariates_contrastive_loss: 634413.9886; train_gene_expr_recon_loss: 2789851.8295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4779475.7273; train_optim_loss: 4779475.7273; val_kl_reg_loss: 14872.5326; val_edge_recon_loss: 1336814.1250; val_cat_covariates_contrastive_loss: 632968.5625; val_gene_expr_recon_loss: 2748126.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4732781.8333; val_optim_loss: 4732781.8333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9338; val_auprc_score: 0.9678; val_best_acc_score: 0.9205; val_best_f1_score: 0.9490; train_kl_reg_loss: 14713.9354; train_edge_recon_loss: 1335921.8011; train_cat_covariates_contrastive_loss: 634226.5057; train_gene_expr_recon_loss: 2781407.7386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4766270.0000; train_optim_loss: 4766270.0000; val_kl_reg_loss: 14910.3333; val_edge_recon_loss: 1352156.0000; val_cat_covariates_contrastive_loss: 633596.5625; val_gene_expr_recon_loss: 2804460.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4805122.6667; val_optim_loss: 4805122.6667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9334; val_auprc_score: 0.9688; val_best_acc_score: 0.9226; val_best_f1_score: 0.9504; train_kl_reg_loss: 14533.4337; train_edge_recon_loss: 1329279.4261; train_cat_covariates_contrastive_loss: 634519.7244; train_gene_expr_recon_loss: 2769589.3977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4747921.9773; train_optim_loss: 4747921.9773; val_kl_reg_loss: 14165.0944; val_edge_recon_loss: 1334439.2917; val_cat_covariates_contrastive_loss: 633172.9167; val_gene_expr_recon_loss: 2777631.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4759409.0000; val_optim_loss: 4759409.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9356; val_auprc_score: 0.9691; val_best_acc_score: 0.9242; val_best_f1_score: 0.9514; train_kl_reg_loss: 14311.9585; train_edge_recon_loss: 1339070.0398; train_cat_covariates_contrastive_loss: 634766.0000; train_gene_expr_recon_loss: 2767252.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4755400.6136; train_optim_loss: 4755400.6136; val_kl_reg_loss: 14222.6436; val_edge_recon_loss: 1312020.2083; val_cat_covariates_contrastive_loss: 633758.1458; val_gene_expr_recon_loss: 2753137.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4713138.6667; val_optim_loss: 4713138.6667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9373; val_auprc_score: 0.9706; val_best_acc_score: 0.9224; val_best_f1_score: 0.9498; train_kl_reg_loss: 14006.4707; train_edge_recon_loss: 1341968.7557; train_cat_covariates_contrastive_loss: 635229.0767; train_gene_expr_recon_loss: 2759142.9773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4750347.2273; train_optim_loss: 4750347.2273; val_kl_reg_loss: 13783.0716; val_edge_recon_loss: 1356615.9167; val_cat_covariates_contrastive_loss: 633603.0833; val_gene_expr_recon_loss: 2804974.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4808976.8333; val_optim_loss: 4808976.8333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9465; val_auprc_score: 0.9749; val_best_acc_score: 0.9285; val_best_f1_score: 0.9537; train_kl_reg_loss: 13726.4571; train_edge_recon_loss: 1331695.4886; train_cat_covariates_contrastive_loss: 634679.7841; train_gene_expr_recon_loss: 2757184.5795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4737286.3182; train_optim_loss: 4737286.3182; val_kl_reg_loss: 13911.0625; val_edge_recon_loss: 1325196.8750; val_cat_covariates_contrastive_loss: 633952.4167; val_gene_expr_recon_loss: 2786000.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4759061.0000; val_optim_loss: 4759061.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9382; val_auprc_score: 0.9722; val_best_acc_score: 0.9285; val_best_f1_score: 0.9543; train_kl_reg_loss: 13582.5718; train_edge_recon_loss: 1335517.8636; train_cat_covariates_contrastive_loss: 634588.9233; train_gene_expr_recon_loss: 2746614.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4730304.1818; train_optim_loss: 4730304.1818; val_kl_reg_loss: 13172.3073; val_edge_recon_loss: 1281312.3750; val_cat_covariates_contrastive_loss: 633515.9167; val_gene_expr_recon_loss: 2689889.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4617890.1667; val_optim_loss: 4617890.1667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9408; val_auprc_score: 0.9696; val_best_acc_score: 0.9265; val_best_f1_score: 0.9520; train_kl_reg_loss: 13323.3821; train_edge_recon_loss: 1329944.4432; train_cat_covariates_contrastive_loss: 634687.4915; train_gene_expr_recon_loss: 2743950.0341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4721905.2955; train_optim_loss: 4721905.2955; val_kl_reg_loss: 13204.2035; val_edge_recon_loss: 1349828.3333; val_cat_covariates_contrastive_loss: 633902.0417; val_gene_expr_recon_loss: 2715498.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4712433.3333; val_optim_loss: 4712433.3333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9446; val_auprc_score: 0.9735; val_best_acc_score: 0.9283; val_best_f1_score: 0.9536; train_kl_reg_loss: 13030.7134; train_edge_recon_loss: 1334537.2841; train_cat_covariates_contrastive_loss: 634926.7528; train_gene_expr_recon_loss: 2736269.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4718764.3864; train_optim_loss: 4718764.3864; val_kl_reg_loss: 12885.5270; val_edge_recon_loss: 1328073.2500; val_cat_covariates_contrastive_loss: 634518.8333; val_gene_expr_recon_loss: 2748413.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4723890.8333; val_optim_loss: 4723890.8333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9432; val_auprc_score: 0.9730; val_best_acc_score: 0.9266; val_best_f1_score: 0.9525; train_kl_reg_loss: 12853.7161; train_edge_recon_loss: 1338054.3580; train_cat_covariates_contrastive_loss: 634887.7812; train_gene_expr_recon_loss: 2726387.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4712182.8636; train_optim_loss: 4712182.8636; val_kl_reg_loss: 12761.2272; val_edge_recon_loss: 1330880.6667; val_cat_covariates_contrastive_loss: 634764.8958; val_gene_expr_recon_loss: 2721803.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4700210.3333; val_optim_loss: 4700210.3333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9397; val_auprc_score: 0.9712; val_best_acc_score: 0.9268; val_best_f1_score: 0.9527; train_kl_reg_loss: 12658.5688; train_edge_recon_loss: 1325084.6761; train_cat_covariates_contrastive_loss: 635080.7273; train_gene_expr_recon_loss: 2723445.2841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4696269.2727; train_optim_loss: 4696269.2727; val_kl_reg_loss: 12766.7529; val_edge_recon_loss: 1319231.3750; val_cat_covariates_contrastive_loss: 633875.7708; val_gene_expr_recon_loss: 2758876.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4724749.8333; val_optim_loss: 4724749.8333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9391; val_auprc_score: 0.9702; val_best_acc_score: 0.9262; val_best_f1_score: 0.9521; train_kl_reg_loss: 12593.7769; train_edge_recon_loss: 1327117.5682; train_cat_covariates_contrastive_loss: 635202.1818; train_gene_expr_recon_loss: 2715433.3295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4690346.8409; train_optim_loss: 4690346.8409; val_kl_reg_loss: 12580.9307; val_edge_recon_loss: 1360282.6250; val_cat_covariates_contrastive_loss: 634154.1250; val_gene_expr_recon_loss: 2691986.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4699004.0000; val_optim_loss: 4699004.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9415; val_auprc_score: 0.9715; val_best_acc_score: 0.9277; val_best_f1_score: 0.9531; train_kl_reg_loss: 12628.3312; train_edge_recon_loss: 1323754.6477; train_cat_covariates_contrastive_loss: 634980.1250; train_gene_expr_recon_loss: 2718441.3068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4689804.3636; train_optim_loss: 4689804.3636; val_kl_reg_loss: 12612.8646; val_edge_recon_loss: 1350999.4583; val_cat_covariates_contrastive_loss: 634354.7708; val_gene_expr_recon_loss: 2747862.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4745829.3333; val_optim_loss: 4745829.3333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9397; val_auprc_score: 0.9718; val_best_acc_score: 0.9256; val_best_f1_score: 0.9523; train_kl_reg_loss: 12591.3660; train_edge_recon_loss: 1327257.4261; train_cat_covariates_contrastive_loss: 635015.2756; train_gene_expr_recon_loss: 2715388.4773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4690252.5682; train_optim_loss: 4690252.5682; val_kl_reg_loss: 12519.8665; val_edge_recon_loss: 1320290.9583; val_cat_covariates_contrastive_loss: 634377.3125; val_gene_expr_recon_loss: 2723558.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4690747.0000; val_optim_loss: 4690747.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9406; val_auprc_score: 0.9718; val_best_acc_score: 0.9240; val_best_f1_score: 0.9508; train_kl_reg_loss: 12553.9082; train_edge_recon_loss: 1333791.1193; train_cat_covariates_contrastive_loss: 635178.4858; train_gene_expr_recon_loss: 2717255.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4698779.4545; train_optim_loss: 4698779.4545; val_kl_reg_loss: 12513.7161; val_edge_recon_loss: 1345245.7917; val_cat_covariates_contrastive_loss: 635096.6458; val_gene_expr_recon_loss: 2770924.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4763780.3333; val_optim_loss: 4763780.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 52 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
val AUROC score: 0.9322
val AUPRC score: 0.9665
val best accuracy score: 0.9203
val best F1 score: 0.9483
val target rna MSE score: 0.9336
val source rna MSE score: 0.1742
Val cat covariate0 mean sim diff: -0.0016
Val cat covariate1 mean sim diff: -0.1098
Duration of model training in run 6: 0 hours, 4 minutes and 58 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 12706
Number of validation nodes: 1412
Number of training edges: 87817
Number of validation edges: 9757
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9352; val_auprc_score: 0.9747; val_best_acc_score: 0.8293; val_best_f1_score: 0.8957; train_kl_reg_loss: 3007.5324; train_edge_recon_loss: 1867774.3523; train_cat_covariates_contrastive_loss: 771494.4688; train_gene_expr_recon_loss: 3778404.5682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6420680.8636; train_optim_loss: 6420680.8636; val_kl_reg_loss: 2099.2259; val_edge_recon_loss: 2047691.9583; val_cat_covariates_contrastive_loss: 627171.1250; val_gene_expr_recon_loss: 3532355.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6209317.5000; val_optim_loss: 6209317.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8554; val_auprc_score: 0.9394; val_best_acc_score: 0.8339; val_best_f1_score: 0.8979; train_kl_reg_loss: 4095.4843; train_edge_recon_loss: 1755277.0114; train_cat_covariates_contrastive_loss: 678572.9034; train_gene_expr_recon_loss: 3404723.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5842669.2500; train_optim_loss: 5842669.2500; val_kl_reg_loss: 7817.9277; val_edge_recon_loss: 1779354.0417; val_cat_covariates_contrastive_loss: 627690.8542; val_gene_expr_recon_loss: 3373443.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5788305.8333; val_optim_loss: 5788305.8333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8406; val_auprc_score: 0.9350; val_best_acc_score: 0.8266; val_best_f1_score: 0.8930; train_kl_reg_loss: 13614.1501; train_edge_recon_loss: 1589188.3693; train_cat_covariates_contrastive_loss: 644846.8352; train_gene_expr_recon_loss: 3190889.2159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5438538.5455; train_optim_loss: 5438538.5455; val_kl_reg_loss: 21533.5684; val_edge_recon_loss: 1536830.6250; val_cat_covariates_contrastive_loss: 627355.9375; val_gene_expr_recon_loss: 3200373.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5386093.3333; val_optim_loss: 5386093.3333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8599; val_auprc_score: 0.9427; val_best_acc_score: 0.8487; val_best_f1_score: 0.9068; train_kl_reg_loss: 22912.4584; train_edge_recon_loss: 1482245.2841; train_cat_covariates_contrastive_loss: 628849.0994; train_gene_expr_recon_loss: 3068111.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5202117.8864; train_optim_loss: 5202117.8864; val_kl_reg_loss: 23407.2904; val_edge_recon_loss: 1452959.8333; val_cat_covariates_contrastive_loss: 627347.2917; val_gene_expr_recon_loss: 3035888.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5139603.3333; val_optim_loss: 5139603.3333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8951; val_auprc_score: 0.9529; val_best_acc_score: 0.8717; val_best_f1_score: 0.9184; train_kl_reg_loss: 21039.9929; train_edge_recon_loss: 1437463.2955; train_cat_covariates_contrastive_loss: 629642.1790; train_gene_expr_recon_loss: 2992471.5341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5080616.9545; train_optim_loss: 5080616.9545; val_kl_reg_loss: 19024.4857; val_edge_recon_loss: 1418025.9167; val_cat_covariates_contrastive_loss: 627980.9583; val_gene_expr_recon_loss: 2949951.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5014982.5000; val_optim_loss: 5014982.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9081; val_auprc_score: 0.9560; val_best_acc_score: 0.9007; val_best_f1_score: 0.9371; train_kl_reg_loss: 19307.2113; train_edge_recon_loss: 1386003.5284; train_cat_covariates_contrastive_loss: 630536.3636; train_gene_expr_recon_loss: 2938483.5682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4974330.7045; train_optim_loss: 4974330.7045; val_kl_reg_loss: 19876.2565; val_edge_recon_loss: 1377419.5000; val_cat_covariates_contrastive_loss: 628595.8333; val_gene_expr_recon_loss: 2983601.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5009493.0000; val_optim_loss: 5009493.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9102; val_auprc_score: 0.9602; val_best_acc_score: 0.8982; val_best_f1_score: 0.9359; train_kl_reg_loss: 19456.8481; train_edge_recon_loss: 1371685.9886; train_cat_covariates_contrastive_loss: 630485.4148; train_gene_expr_recon_loss: 2895979.2386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4917607.4318; train_optim_loss: 4917607.4318; val_kl_reg_loss: 18657.6523; val_edge_recon_loss: 1365508.3333; val_cat_covariates_contrastive_loss: 629189.8958; val_gene_expr_recon_loss: 2889520.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4902876.6667; val_optim_loss: 4902876.6667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9192; val_auprc_score: 0.9639; val_best_acc_score: 0.9040; val_best_f1_score: 0.9394; train_kl_reg_loss: 18206.7426; train_edge_recon_loss: 1367855.7443; train_cat_covariates_contrastive_loss: 630792.2983; train_gene_expr_recon_loss: 2873557.2045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4890411.9773; train_optim_loss: 4890411.9773; val_kl_reg_loss: 17440.8086; val_edge_recon_loss: 1346895.6250; val_cat_covariates_contrastive_loss: 629493.7083; val_gene_expr_recon_loss: 2895056.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4888886.3333; val_optim_loss: 4888886.3333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9202; val_auprc_score: 0.9625; val_best_acc_score: 0.9011; val_best_f1_score: 0.9373; train_kl_reg_loss: 17225.6203; train_edge_recon_loss: 1360473.0625; train_cat_covariates_contrastive_loss: 630834.6420; train_gene_expr_recon_loss: 2857239.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4865772.7500; train_optim_loss: 4865772.7500; val_kl_reg_loss: 17049.9831; val_edge_recon_loss: 1387619.5417; val_cat_covariates_contrastive_loss: 629976.6875; val_gene_expr_recon_loss: 2925096.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4959742.6667; val_optim_loss: 4959742.6667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9200; val_auprc_score: 0.9619; val_best_acc_score: 0.9083; val_best_f1_score: 0.9414; train_kl_reg_loss: 16229.3515; train_edge_recon_loss: 1362476.2670; train_cat_covariates_contrastive_loss: 631645.1705; train_gene_expr_recon_loss: 2840315.2841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4850666.0682; train_optim_loss: 4850666.0682; val_kl_reg_loss: 15701.7962; val_edge_recon_loss: 1347228.7917; val_cat_covariates_contrastive_loss: 630779.0417; val_gene_expr_recon_loss: 2823846.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4817555.8333; val_optim_loss: 4817555.8333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9296; val_auprc_score: 0.9676; val_best_acc_score: 0.9171; val_best_f1_score: 0.9475; train_kl_reg_loss: 15193.5415; train_edge_recon_loss: 1358944.4432; train_cat_covariates_contrastive_loss: 632637.0398; train_gene_expr_recon_loss: 2825265.2955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4832040.3636; train_optim_loss: 4832040.3636; val_kl_reg_loss: 14685.5244; val_edge_recon_loss: 1313720.6667; val_cat_covariates_contrastive_loss: 632814.1458; val_gene_expr_recon_loss: 2847566.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4808786.6667; val_optim_loss: 4808786.6667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9337; val_auprc_score: 0.9682; val_best_acc_score: 0.9212; val_best_f1_score: 0.9494; train_kl_reg_loss: 14472.8321; train_edge_recon_loss: 1343195.4659; train_cat_covariates_contrastive_loss: 633803.4034; train_gene_expr_recon_loss: 2815322.5114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4806794.2273; train_optim_loss: 4806794.2273; val_kl_reg_loss: 14595.2337; val_edge_recon_loss: 1328548.0000; val_cat_covariates_contrastive_loss: 633392.0000; val_gene_expr_recon_loss: 2909193.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4885728.6667; val_optim_loss: 4885728.6667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9340; val_auprc_score: 0.9678; val_best_acc_score: 0.9211; val_best_f1_score: 0.9492; train_kl_reg_loss: 14048.1549; train_edge_recon_loss: 1340090.2784; train_cat_covariates_contrastive_loss: 634319.8920; train_gene_expr_recon_loss: 2808268.8068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4796727.2045; train_optim_loss: 4796727.2045; val_kl_reg_loss: 13540.8708; val_edge_recon_loss: 1349380.5833; val_cat_covariates_contrastive_loss: 633964.9583; val_gene_expr_recon_loss: 2794431.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4791318.0000; val_optim_loss: 4791318.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9381; val_auprc_score: 0.9707; val_best_acc_score: 0.9236; val_best_f1_score: 0.9510; train_kl_reg_loss: 13858.9519; train_edge_recon_loss: 1339673.5000; train_cat_covariates_contrastive_loss: 634351.9773; train_gene_expr_recon_loss: 2798039.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4785923.4318; train_optim_loss: 4785923.4318; val_kl_reg_loss: 13867.0924; val_edge_recon_loss: 1340620.0000; val_cat_covariates_contrastive_loss: 632761.0208; val_gene_expr_recon_loss: 2819004.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4806252.3333; val_optim_loss: 4806252.3333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9359; val_auprc_score: 0.9700; val_best_acc_score: 0.9216; val_best_f1_score: 0.9497; train_kl_reg_loss: 13524.0355; train_edge_recon_loss: 1334175.4318; train_cat_covariates_contrastive_loss: 634861.4517; train_gene_expr_recon_loss: 2787898.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4770459.4773; train_optim_loss: 4770459.4773; val_kl_reg_loss: 13854.6182; val_edge_recon_loss: 1331411.7917; val_cat_covariates_contrastive_loss: 633346.0625; val_gene_expr_recon_loss: 2810532.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4789145.3333; val_optim_loss: 4789145.3333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9408; val_auprc_score: 0.9715; val_best_acc_score: 0.9247; val_best_f1_score: 0.9515; train_kl_reg_loss: 13489.9340; train_edge_recon_loss: 1339957.7784; train_cat_covariates_contrastive_loss: 634541.5881; train_gene_expr_recon_loss: 2779492.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4767481.8182; train_optim_loss: 4767481.8182; val_kl_reg_loss: 13184.8994; val_edge_recon_loss: 1345433.9583; val_cat_covariates_contrastive_loss: 634320.9792; val_gene_expr_recon_loss: 2809772.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4802712.8333; val_optim_loss: 4802712.8333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9377; val_auprc_score: 0.9719; val_best_acc_score: 0.9253; val_best_f1_score: 0.9518; train_kl_reg_loss: 13068.5277; train_edge_recon_loss: 1330584.9943; train_cat_covariates_contrastive_loss: 635447.3210; train_gene_expr_recon_loss: 2770315.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4749416.7273; train_optim_loss: 4749416.7273; val_kl_reg_loss: 13150.8805; val_edge_recon_loss: 1330949.3333; val_cat_covariates_contrastive_loss: 634474.5000; val_gene_expr_recon_loss: 2734265.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4712840.1667; val_optim_loss: 4712840.1667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9445; val_auprc_score: 0.9750; val_best_acc_score: 0.9271; val_best_f1_score: 0.9534; train_kl_reg_loss: 12950.6698; train_edge_recon_loss: 1333705.5795; train_cat_covariates_contrastive_loss: 635706.0682; train_gene_expr_recon_loss: 2765854.9886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4748217.3409; train_optim_loss: 4748217.3409; val_kl_reg_loss: 12950.8919; val_edge_recon_loss: 1299380.0833; val_cat_covariates_contrastive_loss: 635301.6250; val_gene_expr_recon_loss: 2823298.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4770931.0000; val_optim_loss: 4770931.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9349; val_auprc_score: 0.9688; val_best_acc_score: 0.9245; val_best_f1_score: 0.9514; train_kl_reg_loss: 12925.1843; train_edge_recon_loss: 1321215.2102; train_cat_covariates_contrastive_loss: 635468.5142; train_gene_expr_recon_loss: 2757645.2386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4727254.0682; train_optim_loss: 4727254.0682; val_kl_reg_loss: 12783.7321; val_edge_recon_loss: 1350576.9167; val_cat_covariates_contrastive_loss: 634027.5417; val_gene_expr_recon_loss: 2797249.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4794637.6667; val_optim_loss: 4794637.6667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9424; val_auprc_score: 0.9712; val_best_acc_score: 0.9293; val_best_f1_score: 0.9546; train_kl_reg_loss: 12662.9230; train_edge_recon_loss: 1331822.0000; train_cat_covariates_contrastive_loss: 635606.0227; train_gene_expr_recon_loss: 2747968.9773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4728059.9318; train_optim_loss: 4728059.9318; val_kl_reg_loss: 12577.4886; val_edge_recon_loss: 1304450.2083; val_cat_covariates_contrastive_loss: 635139.4167; val_gene_expr_recon_loss: 2761176.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4713343.1667; val_optim_loss: 4713343.1667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9378; val_auprc_score: 0.9701; val_best_acc_score: 0.9278; val_best_f1_score: 0.9538; train_kl_reg_loss: 12565.0381; train_edge_recon_loss: 1331980.6705; train_cat_covariates_contrastive_loss: 634890.0085; train_gene_expr_recon_loss: 2745423.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4724859.1364; train_optim_loss: 4724859.1364; val_kl_reg_loss: 12506.1738; val_edge_recon_loss: 1327450.2917; val_cat_covariates_contrastive_loss: 634765.9792; val_gene_expr_recon_loss: 2738388.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4713111.5000; val_optim_loss: 4713111.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9347; val_auprc_score: 0.9686; val_best_acc_score: 0.9231; val_best_f1_score: 0.9505; train_kl_reg_loss: 12404.3862; train_edge_recon_loss: 1329123.9602; train_cat_covariates_contrastive_loss: 635137.8892; train_gene_expr_recon_loss: 2744599.7841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4721266.0227; train_optim_loss: 4721266.0227; val_kl_reg_loss: 12584.7799; val_edge_recon_loss: 1338635.0417; val_cat_covariates_contrastive_loss: 634439.6042; val_gene_expr_recon_loss: 2776427.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4762086.3333; val_optim_loss: 4762086.3333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9423; val_auprc_score: 0.9726; val_best_acc_score: 0.9283; val_best_f1_score: 0.9535; train_kl_reg_loss: 12409.2453; train_edge_recon_loss: 1329803.1420; train_cat_covariates_contrastive_loss: 635237.4375; train_gene_expr_recon_loss: 2740194.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4717644.7727; train_optim_loss: 4717644.7727; val_kl_reg_loss: 12701.3942; val_edge_recon_loss: 1338908.0417; val_cat_covariates_contrastive_loss: 634660.5833; val_gene_expr_recon_loss: 2767652.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4753922.6667; val_optim_loss: 4753922.6667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9402; val_auprc_score: 0.9706; val_best_acc_score: 0.9260; val_best_f1_score: 0.9522; train_kl_reg_loss: 12430.8533; train_edge_recon_loss: 1331153.5852; train_cat_covariates_contrastive_loss: 635034.6136; train_gene_expr_recon_loss: 2741172.2614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4719791.2955; train_optim_loss: 4719791.2955; val_kl_reg_loss: 12389.9733; val_edge_recon_loss: 1345931.5417; val_cat_covariates_contrastive_loss: 634535.7708; val_gene_expr_recon_loss: 2816499.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4809357.1667; val_optim_loss: 4809357.1667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9335; val_auprc_score: 0.9679; val_best_acc_score: 0.9255; val_best_f1_score: 0.9522; train_kl_reg_loss: 12404.5897; train_edge_recon_loss: 1333152.4602; train_cat_covariates_contrastive_loss: 635305.7756; train_gene_expr_recon_loss: 2738280.5795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4719143.3636; train_optim_loss: 4719143.3636; val_kl_reg_loss: 12298.9792; val_edge_recon_loss: 1345986.6667; val_cat_covariates_contrastive_loss: 633558.3750; val_gene_expr_recon_loss: 2756063.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4747907.8333; val_optim_loss: 4747907.8333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 10 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
val AUROC score: 0.9335
val AUPRC score: 0.9674
val best accuracy score: 0.9202
val best F1 score: 0.9487
val target rna MSE score: 1.1268
val source rna MSE score: 0.2143
Val cat covariate0 mean sim diff: -0.0052
Val cat covariate1 mean sim diff: -0.1167
Duration of model training in run 5: 0 hours, 4 minutes and 16 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 12706
Number of validation nodes: 1412
Number of training edges: 59255
Number of validation edges: 6583
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9362; val_auprc_score: 0.9765; val_best_acc_score: 0.8196; val_best_f1_score: 0.8931; train_kl_reg_loss: 3247.9465; train_edge_recon_loss: 1873356.7917; train_cat_covariates_contrastive_loss: 816563.5000; train_gene_expr_recon_loss: 3895337.1333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6588505.4667; train_optim_loss: 6588505.4667; val_kl_reg_loss: 4619.7148; val_edge_recon_loss: 2023069.3125; val_cat_covariates_contrastive_loss: 626954.6562; val_gene_expr_recon_loss: 3732001.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6386645.2500; val_optim_loss: 6386645.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8795; val_auprc_score: 0.9526; val_best_acc_score: 0.8421; val_best_f1_score: 0.9039; train_kl_reg_loss: 3025.5248; train_edge_recon_loss: 1838924.2667; train_cat_covariates_contrastive_loss: 682714.0292; train_gene_expr_recon_loss: 3562758.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6087422.2333; train_optim_loss: 6087422.2333; val_kl_reg_loss: 3174.5815; val_edge_recon_loss: 1932526.3750; val_cat_covariates_contrastive_loss: 627538.5312; val_gene_expr_recon_loss: 3476890.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6040129.5000; val_optim_loss: 6040129.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8360; val_auprc_score: 0.9308; val_best_acc_score: 0.8351; val_best_f1_score: 0.8970; train_kl_reg_loss: 5355.5109; train_edge_recon_loss: 1720479.0583; train_cat_covariates_contrastive_loss: 669617.1792; train_gene_expr_recon_loss: 3359651.3500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5755103.0333; train_optim_loss: 5755103.0333; val_kl_reg_loss: 8658.7222; val_edge_recon_loss: 1692593.0000; val_cat_covariates_contrastive_loss: 628074.3438; val_gene_expr_recon_loss: 3286320.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5615646.2500; val_optim_loss: 5615646.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8256; val_auprc_score: 0.9280; val_best_acc_score: 0.8265; val_best_f1_score: 0.8932; train_kl_reg_loss: 12607.8725; train_edge_recon_loss: 1594178.6833; train_cat_covariates_contrastive_loss: 639890.4958; train_gene_expr_recon_loss: 3215041.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5461718.9000; train_optim_loss: 5461718.9000; val_kl_reg_loss: 18353.3789; val_edge_recon_loss: 1575376.8750; val_cat_covariates_contrastive_loss: 627675.1875; val_gene_expr_recon_loss: 3190596.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5412002.0000; val_optim_loss: 5412002.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8290; val_auprc_score: 0.9275; val_best_acc_score: 0.8320; val_best_f1_score: 0.8957; train_kl_reg_loss: 22154.9445; train_edge_recon_loss: 1497323.2083; train_cat_covariates_contrastive_loss: 629216.1958; train_gene_expr_recon_loss: 3108505.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5257199.8667; train_optim_loss: 5257199.8667; val_kl_reg_loss: 24648.8672; val_edge_recon_loss: 1544143.7500; val_cat_covariates_contrastive_loss: 627195.3438; val_gene_expr_recon_loss: 3084946.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5280934.0000; val_optim_loss: 5280934.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8431; val_auprc_score: 0.9347; val_best_acc_score: 0.8422; val_best_f1_score: 0.9028; train_kl_reg_loss: 25013.8016; train_edge_recon_loss: 1468272.7250; train_cat_covariates_contrastive_loss: 628768.9292; train_gene_expr_recon_loss: 3029272.6500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5151328.1000; train_optim_loss: 5151328.1000; val_kl_reg_loss: 26089.1523; val_edge_recon_loss: 1512578.9375; val_cat_covariates_contrastive_loss: 627421.9062; val_gene_expr_recon_loss: 3038831.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5204921.0000; val_optim_loss: 5204921.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8695; val_auprc_score: 0.9446; val_best_acc_score: 0.8546; val_best_f1_score: 0.9101; train_kl_reg_loss: 24765.2305; train_edge_recon_loss: 1469052.9750; train_cat_covariates_contrastive_loss: 629729.4875; train_gene_expr_recon_loss: 2973279.7167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5096827.4333; train_optim_loss: 5096827.4333; val_kl_reg_loss: 23581.7471; val_edge_recon_loss: 1448391.4375; val_cat_covariates_contrastive_loss: 627623.5000; val_gene_expr_recon_loss: 2995777.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5095374.5000; val_optim_loss: 5095374.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8879; val_auprc_score: 0.9497; val_best_acc_score: 0.8729; val_best_f1_score: 0.9182; train_kl_reg_loss: 21910.5137; train_edge_recon_loss: 1438979.2167; train_cat_covariates_contrastive_loss: 630501.8250; train_gene_expr_recon_loss: 2934039.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5025430.7333; train_optim_loss: 5025430.7333; val_kl_reg_loss: 20311.1963; val_edge_recon_loss: 1466148.9375; val_cat_covariates_contrastive_loss: 628473.1250; val_gene_expr_recon_loss: 2961879.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5076812.2500; val_optim_loss: 5076812.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9082; val_auprc_score: 0.9574; val_best_acc_score: 0.8888; val_best_f1_score: 0.9298; train_kl_reg_loss: 21241.2423; train_edge_recon_loss: 1392342.3667; train_cat_covariates_contrastive_loss: 630397.2458; train_gene_expr_recon_loss: 2912450.9000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4956431.7000; train_optim_loss: 4956431.7000; val_kl_reg_loss: 21682.0176; val_edge_recon_loss: 1391928.9375; val_cat_covariates_contrastive_loss: 628942.5000; val_gene_expr_recon_loss: 2951056.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4993610.0000; val_optim_loss: 4993610.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9054; val_auprc_score: 0.9578; val_best_acc_score: 0.8934; val_best_f1_score: 0.9331; train_kl_reg_loss: 21903.1104; train_edge_recon_loss: 1374402.4083; train_cat_covariates_contrastive_loss: 630720.3000; train_gene_expr_recon_loss: 2888700.8500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4915726.6667; train_optim_loss: 4915726.6667; val_kl_reg_loss: 21313.5049; val_edge_recon_loss: 1368779.7500; val_cat_covariates_contrastive_loss: 629406.5000; val_gene_expr_recon_loss: 2913977.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4933477.0000; val_optim_loss: 4933477.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9075; val_auprc_score: 0.9588; val_best_acc_score: 0.8954; val_best_f1_score: 0.9338; train_kl_reg_loss: 21260.5520; train_edge_recon_loss: 1365171.6250; train_cat_covariates_contrastive_loss: 630754.8167; train_gene_expr_recon_loss: 2865124.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4882311.7667; train_optim_loss: 4882311.7667; val_kl_reg_loss: 20701.0674; val_edge_recon_loss: 1374495.1875; val_cat_covariates_contrastive_loss: 629362.4062; val_gene_expr_recon_loss: 2895719.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4920277.5000; val_optim_loss: 4920277.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9130; val_auprc_score: 0.9604; val_best_acc_score: 0.8994; val_best_f1_score: 0.9358; train_kl_reg_loss: 20369.7690; train_edge_recon_loss: 1370059.3500; train_cat_covariates_contrastive_loss: 631259.0000; train_gene_expr_recon_loss: 2853531.7333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4875219.8000; train_optim_loss: 4875219.8000; val_kl_reg_loss: 19745.4307; val_edge_recon_loss: 1375126.5625; val_cat_covariates_contrastive_loss: 630315.9688; val_gene_expr_recon_loss: 2902284.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4927472.2500; val_optim_loss: 4927472.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9136; val_auprc_score: 0.9595; val_best_acc_score: 0.9000; val_best_f1_score: 0.9369; train_kl_reg_loss: 19443.8853; train_edge_recon_loss: 1362001.6917; train_cat_covariates_contrastive_loss: 631749.5875; train_gene_expr_recon_loss: 2842657.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4855852.9667; train_optim_loss: 4855852.9667; val_kl_reg_loss: 19246.0400; val_edge_recon_loss: 1361520.8125; val_cat_covariates_contrastive_loss: 631270.0312; val_gene_expr_recon_loss: 2887419.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4899456.0000; val_optim_loss: 4899456.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9212; val_auprc_score: 0.9653; val_best_acc_score: 0.9086; val_best_f1_score: 0.9418; train_kl_reg_loss: 18520.2212; train_edge_recon_loss: 1351395.0083; train_cat_covariates_contrastive_loss: 632597.9292; train_gene_expr_recon_loss: 2832916.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4835430.0667; train_optim_loss: 4835430.0667; val_kl_reg_loss: 17779.1260; val_edge_recon_loss: 1332203.8750; val_cat_covariates_contrastive_loss: 631246.4062; val_gene_expr_recon_loss: 2870319.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4851548.5000; val_optim_loss: 4851548.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9181; val_auprc_score: 0.9605; val_best_acc_score: 0.9120; val_best_f1_score: 0.9441; train_kl_reg_loss: 17673.3098; train_edge_recon_loss: 1355191.4417; train_cat_covariates_contrastive_loss: 633003.9292; train_gene_expr_recon_loss: 2823131.3667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4829000.0333; train_optim_loss: 4829000.0333; val_kl_reg_loss: 17124.6152; val_edge_recon_loss: 1351780.7500; val_cat_covariates_contrastive_loss: 633398.3125; val_gene_expr_recon_loss: 2859381.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4861685.5000; val_optim_loss: 4861685.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9269; val_auprc_score: 0.9665; val_best_acc_score: 0.9155; val_best_f1_score: 0.9460; train_kl_reg_loss: 16931.9270; train_edge_recon_loss: 1359150.8333; train_cat_covariates_contrastive_loss: 633960.9125; train_gene_expr_recon_loss: 2818358.8167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4828402.5000; train_optim_loss: 4828402.5000; val_kl_reg_loss: 16716.3984; val_edge_recon_loss: 1343240.6875; val_cat_covariates_contrastive_loss: 633929.0312; val_gene_expr_recon_loss: 2845566.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4839452.5000; val_optim_loss: 4839452.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9189; val_auprc_score: 0.9607; val_best_acc_score: 0.9136; val_best_f1_score: 0.9448; train_kl_reg_loss: 16414.8952; train_edge_recon_loss: 1346521.8417; train_cat_covariates_contrastive_loss: 634462.8500; train_gene_expr_recon_loss: 2811362.5667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4808762.2000; train_optim_loss: 4808762.2000; val_kl_reg_loss: 16243.3604; val_edge_recon_loss: 1369148.0625; val_cat_covariates_contrastive_loss: 633819.0938; val_gene_expr_recon_loss: 2828677.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4847888.5000; val_optim_loss: 4847888.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9297; val_auprc_score: 0.9659; val_best_acc_score: 0.9179; val_best_f1_score: 0.9469; train_kl_reg_loss: 16107.6654; train_edge_recon_loss: 1336425.5083; train_cat_covariates_contrastive_loss: 635313.8667; train_gene_expr_recon_loss: 2794970.4500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4782817.5333; train_optim_loss: 4782817.5333; val_kl_reg_loss: 15729.3994; val_edge_recon_loss: 1372191.5000; val_cat_covariates_contrastive_loss: 633864.9062; val_gene_expr_recon_loss: 2831997.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4853783.5000; val_optim_loss: 4853783.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9283; val_auprc_score: 0.9656; val_best_acc_score: 0.9205; val_best_f1_score: 0.9491; train_kl_reg_loss: 15889.3730; train_edge_recon_loss: 1349859.2750; train_cat_covariates_contrastive_loss: 635245.1625; train_gene_expr_recon_loss: 2793397.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4794391.1000; train_optim_loss: 4794391.1000; val_kl_reg_loss: 15594.3242; val_edge_recon_loss: 1346082.0000; val_cat_covariates_contrastive_loss: 634640.4062; val_gene_expr_recon_loss: 2806412.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4802729.2500; val_optim_loss: 4802729.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9244; val_auprc_score: 0.9627; val_best_acc_score: 0.9175; val_best_f1_score: 0.9472; train_kl_reg_loss: 15715.7081; train_edge_recon_loss: 1337968.7500; train_cat_covariates_contrastive_loss: 635737.4667; train_gene_expr_recon_loss: 2782441.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4771862.9333; train_optim_loss: 4771862.9333; val_kl_reg_loss: 15395.4316; val_edge_recon_loss: 1368306.1250; val_cat_covariates_contrastive_loss: 633171.2188; val_gene_expr_recon_loss: 2824613.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4841486.5000; val_optim_loss: 4841486.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9255; val_auprc_score: 0.9643; val_best_acc_score: 0.9203; val_best_f1_score: 0.9489; train_kl_reg_loss: 15386.5582; train_edge_recon_loss: 1331070.3417; train_cat_covariates_contrastive_loss: 635421.6958; train_gene_expr_recon_loss: 2777465.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4759344.4667; train_optim_loss: 4759344.4667; val_kl_reg_loss: 15153.8916; val_edge_recon_loss: 1359714.6875; val_cat_covariates_contrastive_loss: 635076.7500; val_gene_expr_recon_loss: 2821321.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4831266.5000; val_optim_loss: 4831266.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9296; val_auprc_score: 0.9655; val_best_acc_score: 0.9211; val_best_f1_score: 0.9488; train_kl_reg_loss: 15108.9021; train_edge_recon_loss: 1333963.3167; train_cat_covariates_contrastive_loss: 635803.4625; train_gene_expr_recon_loss: 2771096.3000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4755972.0000; train_optim_loss: 4755972.0000; val_kl_reg_loss: 14822.7178; val_edge_recon_loss: 1367852.0625; val_cat_covariates_contrastive_loss: 633882.1562; val_gene_expr_recon_loss: 2803546.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4820103.0000; val_optim_loss: 4820103.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9322; val_auprc_score: 0.9689; val_best_acc_score: 0.9264; val_best_f1_score: 0.9530; train_kl_reg_loss: 14873.7860; train_edge_recon_loss: 1333285.4750; train_cat_covariates_contrastive_loss: 635434.1542; train_gene_expr_recon_loss: 2773054.3833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4756647.8667; train_optim_loss: 4756647.8667; val_kl_reg_loss: 14331.5000; val_edge_recon_loss: 1308578.0625; val_cat_covariates_contrastive_loss: 634387.2188; val_gene_expr_recon_loss: 2804025.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4761322.5000; val_optim_loss: 4761322.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9243; val_auprc_score: 0.9644; val_best_acc_score: 0.9211; val_best_f1_score: 0.9497; train_kl_reg_loss: 14413.1072; train_edge_recon_loss: 1335884.5417; train_cat_covariates_contrastive_loss: 635850.6208; train_gene_expr_recon_loss: 2761338.7833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4747487.0333; train_optim_loss: 4747487.0333; val_kl_reg_loss: 14386.5288; val_edge_recon_loss: 1341528.3125; val_cat_covariates_contrastive_loss: 636121.4062; val_gene_expr_recon_loss: 2797058.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4789094.5000; val_optim_loss: 4789094.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9297; val_auprc_score: 0.9682; val_best_acc_score: 0.9237; val_best_f1_score: 0.9516; train_kl_reg_loss: 14182.4415; train_edge_recon_loss: 1334977.7083; train_cat_covariates_contrastive_loss: 635753.7125; train_gene_expr_recon_loss: 2756563.4667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4741477.3333; train_optim_loss: 4741477.3333; val_kl_reg_loss: 13736.4316; val_edge_recon_loss: 1308279.1250; val_cat_covariates_contrastive_loss: 635949.0625; val_gene_expr_recon_loss: 2783482.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4741446.7500; val_optim_loss: 4741446.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9341; val_auprc_score: 0.9692; val_best_acc_score: 0.9261; val_best_f1_score: 0.9527; train_kl_reg_loss: 13987.3232; train_edge_recon_loss: 1333241.9333; train_cat_covariates_contrastive_loss: 636642.3958; train_gene_expr_recon_loss: 2752651.9500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4736523.5000; train_optim_loss: 4736523.5000; val_kl_reg_loss: 13947.1978; val_edge_recon_loss: 1330982.1250; val_cat_covariates_contrastive_loss: 635649.4375; val_gene_expr_recon_loss: 2789152.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4769731.0000; val_optim_loss: 4769731.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9301; val_auprc_score: 0.9664; val_best_acc_score: 0.9231; val_best_f1_score: 0.9508; train_kl_reg_loss: 13742.2404; train_edge_recon_loss: 1334766.5667; train_cat_covariates_contrastive_loss: 636342.1000; train_gene_expr_recon_loss: 2750568.4333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4735419.3667; train_optim_loss: 4735419.3667; val_kl_reg_loss: 13559.5874; val_edge_recon_loss: 1351630.1875; val_cat_covariates_contrastive_loss: 637315.5312; val_gene_expr_recon_loss: 2787149.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4789655.2500; val_optim_loss: 4789655.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9306; val_auprc_score: 0.9658; val_best_acc_score: 0.9230; val_best_f1_score: 0.9510; train_kl_reg_loss: 13646.7092; train_edge_recon_loss: 1329613.6333; train_cat_covariates_contrastive_loss: 636208.7208; train_gene_expr_recon_loss: 2740389.6833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4719858.7000; train_optim_loss: 4719858.7000; val_kl_reg_loss: 13171.9414; val_edge_recon_loss: 1319720.5625; val_cat_covariates_contrastive_loss: 635005.6562; val_gene_expr_recon_loss: 2785206.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4753104.5000; val_optim_loss: 4753104.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9300; val_auprc_score: 0.9654; val_best_acc_score: 0.9252; val_best_f1_score: 0.9519; train_kl_reg_loss: 13357.8934; train_edge_recon_loss: 1325319.9833; train_cat_covariates_contrastive_loss: 636021.4417; train_gene_expr_recon_loss: 2739408.9000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4714108.2000; train_optim_loss: 4714108.2000; val_kl_reg_loss: 13303.9644; val_edge_recon_loss: 1342281.9375; val_cat_covariates_contrastive_loss: 634476.3750; val_gene_expr_recon_loss: 2790426.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4780489.0000; val_optim_loss: 4780489.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9332; val_auprc_score: 0.9678; val_best_acc_score: 0.9256; val_best_f1_score: 0.9520; train_kl_reg_loss: 13407.3607; train_edge_recon_loss: 1334802.6750; train_cat_covariates_contrastive_loss: 636077.8333; train_gene_expr_recon_loss: 2733335.3833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4717623.2333; train_optim_loss: 4717623.2333; val_kl_reg_loss: 13348.3535; val_edge_recon_loss: 1346439.8125; val_cat_covariates_contrastive_loss: 634899.0625; val_gene_expr_recon_loss: 2776945.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4771632.5000; val_optim_loss: 4771632.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9310; val_auprc_score: 0.9666; val_best_acc_score: 0.9226; val_best_f1_score: 0.9506; train_kl_reg_loss: 13413.1135; train_edge_recon_loss: 1325997.4417; train_cat_covariates_contrastive_loss: 635757.5625; train_gene_expr_recon_loss: 2733640.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4708808.7333; train_optim_loss: 4708808.7333; val_kl_reg_loss: 13236.1748; val_edge_recon_loss: 1332515.0000; val_cat_covariates_contrastive_loss: 634979.6250; val_gene_expr_recon_loss: 2757827.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4738557.7500; val_optim_loss: 4738557.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9346; val_auprc_score: 0.9695; val_best_acc_score: 0.9256; val_best_f1_score: 0.9523; train_kl_reg_loss: 13437.9685; train_edge_recon_loss: 1326230.1083; train_cat_covariates_contrastive_loss: 636632.7625; train_gene_expr_recon_loss: 2730124.2833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4706425.1000; train_optim_loss: 4706425.1000; val_kl_reg_loss: 13335.4175; val_edge_recon_loss: 1319357.3750; val_cat_covariates_contrastive_loss: 634335.6250; val_gene_expr_recon_loss: 2782408.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4749437.2500; val_optim_loss: 4749437.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9278; val_auprc_score: 0.9646; val_best_acc_score: 0.9244; val_best_f1_score: 0.9515; train_kl_reg_loss: 13454.0729; train_edge_recon_loss: 1333660.4500; train_cat_covariates_contrastive_loss: 636206.8917; train_gene_expr_recon_loss: 2733993.6833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4717315.1000; train_optim_loss: 4717315.1000; val_kl_reg_loss: 13369.4380; val_edge_recon_loss: 1340284.3125; val_cat_covariates_contrastive_loss: 636251.0938; val_gene_expr_recon_loss: 2782004.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4771909.2500; val_optim_loss: 4771909.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9314; val_auprc_score: 0.9656; val_best_acc_score: 0.9258; val_best_f1_score: 0.9521; train_kl_reg_loss: 13379.8439; train_edge_recon_loss: 1334356.8417; train_cat_covariates_contrastive_loss: 636081.0750; train_gene_expr_recon_loss: 2738884.5500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4722702.3667; train_optim_loss: 4722702.3667; val_kl_reg_loss: 13231.3975; val_edge_recon_loss: 1352284.2500; val_cat_covariates_contrastive_loss: 635624.6562; val_gene_expr_recon_loss: 2767428.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4768568.7500; val_optim_loss: 4768568.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9320; val_auprc_score: 0.9662; val_best_acc_score: 0.9241; val_best_f1_score: 0.9512; train_kl_reg_loss: 13342.4503; train_edge_recon_loss: 1322991.9250; train_cat_covariates_contrastive_loss: 636196.6708; train_gene_expr_recon_loss: 2736318.0333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4708849.1333; train_optim_loss: 4708849.1333; val_kl_reg_loss: 13208.9995; val_edge_recon_loss: 1353869.1250; val_cat_covariates_contrastive_loss: 634897.0625; val_gene_expr_recon_loss: 2757423.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4759398.7500; val_optim_loss: 4759398.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9360; val_auprc_score: 0.9692; val_best_acc_score: 0.9268; val_best_f1_score: 0.9529; train_kl_reg_loss: 13337.3300; train_edge_recon_loss: 1331612.9083; train_cat_covariates_contrastive_loss: 635963.2625; train_gene_expr_recon_loss: 2730430.7833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4711344.3667; train_optim_loss: 4711344.3667; val_kl_reg_loss: 13201.2773; val_edge_recon_loss: 1329322.8750; val_cat_covariates_contrastive_loss: 636363.8438; val_gene_expr_recon_loss: 2756717.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4735605.5000; val_optim_loss: 4735605.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9314; val_auprc_score: 0.9675; val_best_acc_score: 0.9247; val_best_f1_score: 0.9516; train_kl_reg_loss: 13353.2212; train_edge_recon_loss: 1327315.6750; train_cat_covariates_contrastive_loss: 636015.2500; train_gene_expr_recon_loss: 2732831.3500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4709515.4333; train_optim_loss: 4709515.4333; val_kl_reg_loss: 13261.7871; val_edge_recon_loss: 1324341.2500; val_cat_covariates_contrastive_loss: 635353.3750; val_gene_expr_recon_loss: 2779210.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4752167.2500; val_optim_loss: 4752167.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9328; val_auprc_score: 0.9691; val_best_acc_score: 0.9253; val_best_f1_score: 0.9523; train_kl_reg_loss: 13365.2160; train_edge_recon_loss: 1335729.0417; train_cat_covariates_contrastive_loss: 636146.1583; train_gene_expr_recon_loss: 2736872.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4722112.9667; train_optim_loss: 4722112.9667; val_kl_reg_loss: 13217.8779; val_edge_recon_loss: 1316084.0000; val_cat_covariates_contrastive_loss: 635711.8125; val_gene_expr_recon_loss: 2758961.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4723974.7500; val_optim_loss: 4723974.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9233; val_auprc_score: 0.9633; val_best_acc_score: 0.9215; val_best_f1_score: 0.9497; train_kl_reg_loss: 13344.0294; train_edge_recon_loss: 1324533.9667; train_cat_covariates_contrastive_loss: 636712.9708; train_gene_expr_recon_loss: 2734500.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4709090.9667; train_optim_loss: 4709090.9667; val_kl_reg_loss: 13286.7979; val_edge_recon_loss: 1345812.3750; val_cat_covariates_contrastive_loss: 638139.0000; val_gene_expr_recon_loss: 2779487.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4776726.0000; val_optim_loss: 4776726.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9342; val_auprc_score: 0.9663; val_best_acc_score: 0.9267; val_best_f1_score: 0.9530; train_kl_reg_loss: 13363.1367; train_edge_recon_loss: 1317709.6333; train_cat_covariates_contrastive_loss: 636201.4167; train_gene_expr_recon_loss: 2735420.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4702694.3000; train_optim_loss: 4702694.3000; val_kl_reg_loss: 13269.8594; val_edge_recon_loss: 1332739.5625; val_cat_covariates_contrastive_loss: 635912.2188; val_gene_expr_recon_loss: 2775559.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4757481.2500; val_optim_loss: 4757481.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9266; val_auprc_score: 0.9610; val_best_acc_score: 0.9210; val_best_f1_score: 0.9493; train_kl_reg_loss: 13355.8883; train_edge_recon_loss: 1313126.5167; train_cat_covariates_contrastive_loss: 635930.1708; train_gene_expr_recon_loss: 2731741.1833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4694153.8333; train_optim_loss: 4694153.8333; val_kl_reg_loss: 13298.0186; val_edge_recon_loss: 1363400.0625; val_cat_covariates_contrastive_loss: 635897.1875; val_gene_expr_recon_loss: 2773550.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4786145.5000; val_optim_loss: 4786145.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9344; val_auprc_score: 0.9685; val_best_acc_score: 0.9260; val_best_f1_score: 0.9523; train_kl_reg_loss: 13359.9949; train_edge_recon_loss: 1328102.4833; train_cat_covariates_contrastive_loss: 636468.9917; train_gene_expr_recon_loss: 2737411.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4715342.9000; train_optim_loss: 4715342.9000; val_kl_reg_loss: 13249.9766; val_edge_recon_loss: 1355526.6250; val_cat_covariates_contrastive_loss: 636080.4688; val_gene_expr_recon_loss: 2793925.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4798782.5000; val_optim_loss: 4798782.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9351; val_auprc_score: 0.9674; val_best_acc_score: 0.9261; val_best_f1_score: 0.9521; train_kl_reg_loss: 13343.1982; train_edge_recon_loss: 1327475.3250; train_cat_covariates_contrastive_loss: 635908.7542; train_gene_expr_recon_loss: 2736029.2167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4712756.4333; train_optim_loss: 4712756.4333; val_kl_reg_loss: 13302.0044; val_edge_recon_loss: 1353399.3750; val_cat_covariates_contrastive_loss: 634256.0938; val_gene_expr_recon_loss: 2773371.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4774328.5000; val_optim_loss: 4774328.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9260; val_auprc_score: 0.9634; val_best_acc_score: 0.9226; val_best_f1_score: 0.9507; train_kl_reg_loss: 13328.9050; train_edge_recon_loss: 1325307.6417; train_cat_covariates_contrastive_loss: 635848.9875; train_gene_expr_recon_loss: 2729707.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4704192.7333; train_optim_loss: 4704192.7333; val_kl_reg_loss: 13307.5557; val_edge_recon_loss: 1327878.8125; val_cat_covariates_contrastive_loss: 635863.6250; val_gene_expr_recon_loss: 2783268.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4760318.7500; val_optim_loss: 4760318.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9323; val_auprc_score: 0.9678; val_best_acc_score: 0.9269; val_best_f1_score: 0.9530; train_kl_reg_loss: 13339.7457; train_edge_recon_loss: 1326488.8667; train_cat_covariates_contrastive_loss: 636192.4917; train_gene_expr_recon_loss: 2728379.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4704400.3000; train_optim_loss: 4704400.3000; val_kl_reg_loss: 13212.4717; val_edge_recon_loss: 1329104.6875; val_cat_covariates_contrastive_loss: 635954.4062; val_gene_expr_recon_loss: 2759872.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4738144.0000; val_optim_loss: 4738144.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9369; val_auprc_score: 0.9663; val_best_acc_score: 0.9254; val_best_f1_score: 0.9516; train_kl_reg_loss: 13359.7510; train_edge_recon_loss: 1322218.0750; train_cat_covariates_contrastive_loss: 636135.8750; train_gene_expr_recon_loss: 2730936.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4702650.3333; train_optim_loss: 4702650.3333; val_kl_reg_loss: 13234.4395; val_edge_recon_loss: 1365109.7500; val_cat_covariates_contrastive_loss: 634523.6562; val_gene_expr_recon_loss: 2764095.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4776963.5000; val_optim_loss: 4776963.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 59 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
val AUROC score: 0.9210
val AUPRC score: 0.9606
val best accuracy score: 0.9199
val best F1 score: 0.9487
val target rna MSE score: 0.9432
val source rna MSE score: 0.2401
Val cat covariate0 mean sim diff: -0.0016
Val cat covariate1 mean sim diff: -0.1113
Duration of model training in run 4: 0 hours, 6 minutes and 4 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 12706
Number of validation nodes: 1412
Number of training edges: 59255
Number of validation edges: 6583
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9431; val_auprc_score: 0.9789; val_best_acc_score: 0.8175; val_best_f1_score: 0.8912; train_kl_reg_loss: 3054.6629; train_edge_recon_loss: 1874458.4833; train_cat_covariates_contrastive_loss: 808863.2542; train_gene_expr_recon_loss: 3853040.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6539417.1000; train_optim_loss: 6539417.1000; val_kl_reg_loss: 3699.0293; val_edge_recon_loss: 2047086.1875; val_cat_covariates_contrastive_loss: 627024.8750; val_gene_expr_recon_loss: 3650940.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6328751.0000; val_optim_loss: 6328751.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8804; val_auprc_score: 0.9548; val_best_acc_score: 0.8435; val_best_f1_score: 0.9044; train_kl_reg_loss: 2798.4761; train_edge_recon_loss: 1849599.5000; train_cat_covariates_contrastive_loss: 687386.1792; train_gene_expr_recon_loss: 3542963.6500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6082747.8667; train_optim_loss: 6082747.8667; val_kl_reg_loss: 3224.1482; val_edge_recon_loss: 1945377.7500; val_cat_covariates_contrastive_loss: 627490.7500; val_gene_expr_recon_loss: 3449922.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6026015.2500; val_optim_loss: 6026015.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8507; val_auprc_score: 0.9360; val_best_acc_score: 0.8376; val_best_f1_score: 0.8997; train_kl_reg_loss: 5058.9098; train_edge_recon_loss: 1721055.1583; train_cat_covariates_contrastive_loss: 671526.2708; train_gene_expr_recon_loss: 3370534.8500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5768175.2000; train_optim_loss: 5768175.2000; val_kl_reg_loss: 7561.7241; val_edge_recon_loss: 1759826.6250; val_cat_covariates_contrastive_loss: 628267.0938; val_gene_expr_recon_loss: 3277881.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5673536.7500; val_optim_loss: 5673536.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8276; val_auprc_score: 0.9261; val_best_acc_score: 0.8323; val_best_f1_score: 0.8971; train_kl_reg_loss: 11902.0544; train_edge_recon_loss: 1594415.5667; train_cat_covariates_contrastive_loss: 646866.8333; train_gene_expr_recon_loss: 3234456.7167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5487641.2000; train_optim_loss: 5487641.2000; val_kl_reg_loss: 18164.9912; val_edge_recon_loss: 1561143.5625; val_cat_covariates_contrastive_loss: 628047.5312; val_gene_expr_recon_loss: 3165226.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5372582.2500; val_optim_loss: 5372582.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8475; val_auprc_score: 0.9342; val_best_acc_score: 0.8414; val_best_f1_score: 0.9011; train_kl_reg_loss: 21408.5746; train_edge_recon_loss: 1520842.5417; train_cat_covariates_contrastive_loss: 631176.4458; train_gene_expr_recon_loss: 3141054.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5314481.6000; train_optim_loss: 5314481.6000; val_kl_reg_loss: 22411.0371; val_edge_recon_loss: 1496902.5625; val_cat_covariates_contrastive_loss: 627683.2812; val_gene_expr_recon_loss: 3087911.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5234908.7500; val_optim_loss: 5234908.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8677; val_auprc_score: 0.9411; val_best_acc_score: 0.8602; val_best_f1_score: 0.9121; train_kl_reg_loss: 23097.1747; train_edge_recon_loss: 1474125.7000; train_cat_covariates_contrastive_loss: 629938.9125; train_gene_expr_recon_loss: 3070826.2833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5197988.0667; train_optim_loss: 5197988.0667; val_kl_reg_loss: 21948.7520; val_edge_recon_loss: 1472696.7500; val_cat_covariates_contrastive_loss: 627924.9062; val_gene_expr_recon_loss: 3045464.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5168035.2500; val_optim_loss: 5168035.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9017; val_auprc_score: 0.9556; val_best_acc_score: 0.8963; val_best_f1_score: 0.9347; train_kl_reg_loss: 21300.5934; train_edge_recon_loss: 1400018.1833; train_cat_covariates_contrastive_loss: 630490.0667; train_gene_expr_recon_loss: 3020154.5333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5071963.4000; train_optim_loss: 5071963.4000; val_kl_reg_loss: 20921.6074; val_edge_recon_loss: 1351229.6250; val_cat_covariates_contrastive_loss: 629045.1875; val_gene_expr_recon_loss: 3003332.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5004528.2500; val_optim_loss: 5004528.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9044; val_auprc_score: 0.9571; val_best_acc_score: 0.8967; val_best_f1_score: 0.9347; train_kl_reg_loss: 20946.8681; train_edge_recon_loss: 1377039.8917; train_cat_covariates_contrastive_loss: 630664.2333; train_gene_expr_recon_loss: 2972825.6833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5001476.6333; train_optim_loss: 5001476.6333; val_kl_reg_loss: 20474.5195; val_edge_recon_loss: 1366831.9375; val_cat_covariates_contrastive_loss: 629055.0938; val_gene_expr_recon_loss: 2929431.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4945793.5000; val_optim_loss: 4945793.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9003; val_auprc_score: 0.9529; val_best_acc_score: 0.8939; val_best_f1_score: 0.9332; train_kl_reg_loss: 20195.7866; train_edge_recon_loss: 1371239.6167; train_cat_covariates_contrastive_loss: 631013.6875; train_gene_expr_recon_loss: 2943806.2667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4966255.3333; train_optim_loss: 4966255.3333; val_kl_reg_loss: 19483.0127; val_edge_recon_loss: 1392511.4375; val_cat_covariates_contrastive_loss: 629147.0000; val_gene_expr_recon_loss: 2928560.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4969701.7500; val_optim_loss: 4969701.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9034; val_auprc_score: 0.9567; val_best_acc_score: 0.8950; val_best_f1_score: 0.9338; train_kl_reg_loss: 19709.5331; train_edge_recon_loss: 1369185.1667; train_cat_covariates_contrastive_loss: 631067.3667; train_gene_expr_recon_loss: 2918171.9000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4938133.9333; train_optim_loss: 4938133.9333; val_kl_reg_loss: 18834.3174; val_edge_recon_loss: 1382339.1250; val_cat_covariates_contrastive_loss: 629324.3125; val_gene_expr_recon_loss: 2887138.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4917636.5000; val_optim_loss: 4917636.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9042; val_auprc_score: 0.9534; val_best_acc_score: 0.8980; val_best_f1_score: 0.9355; train_kl_reg_loss: 19129.0639; train_edge_recon_loss: 1363519.9917; train_cat_covariates_contrastive_loss: 630926.0583; train_gene_expr_recon_loss: 2897397.2167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4910972.3333; train_optim_loss: 4910972.3333; val_kl_reg_loss: 19341.4414; val_edge_recon_loss: 1371581.0625; val_cat_covariates_contrastive_loss: 629608.2500; val_gene_expr_recon_loss: 2908016.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4928547.5000; val_optim_loss: 4928547.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9106; val_auprc_score: 0.9588; val_best_acc_score: 0.9028; val_best_f1_score: 0.9386; train_kl_reg_loss: 18629.3716; train_edge_recon_loss: 1364535.9250; train_cat_covariates_contrastive_loss: 631267.7125; train_gene_expr_recon_loss: 2889487.4667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4903920.5667; train_optim_loss: 4903920.5667; val_kl_reg_loss: 17994.2588; val_edge_recon_loss: 1330818.9375; val_cat_covariates_contrastive_loss: 629946.9375; val_gene_expr_recon_loss: 2886813.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4865574.0000; val_optim_loss: 4865574.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9076; val_auprc_score: 0.9566; val_best_acc_score: 0.9024; val_best_f1_score: 0.9384; train_kl_reg_loss: 17792.8518; train_edge_recon_loss: 1365119.3083; train_cat_covariates_contrastive_loss: 631642.1875; train_gene_expr_recon_loss: 2873610.3833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4888164.7333; train_optim_loss: 4888164.7333; val_kl_reg_loss: 17352.8252; val_edge_recon_loss: 1339851.1250; val_cat_covariates_contrastive_loss: 630420.7500; val_gene_expr_recon_loss: 2856054.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4843679.0000; val_optim_loss: 4843679.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9108; val_auprc_score: 0.9610; val_best_acc_score: 0.8997; val_best_f1_score: 0.9368; train_kl_reg_loss: 17076.3306; train_edge_recon_loss: 1365690.5833; train_cat_covariates_contrastive_loss: 632257.8417; train_gene_expr_recon_loss: 2860599.2167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4875624.0000; train_optim_loss: 4875624.0000; val_kl_reg_loss: 16273.2236; val_edge_recon_loss: 1365457.7500; val_cat_covariates_contrastive_loss: 631277.5625; val_gene_expr_recon_loss: 2828451.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4841460.2500; val_optim_loss: 4841460.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9215; val_auprc_score: 0.9642; val_best_acc_score: 0.9053; val_best_f1_score: 0.9401; train_kl_reg_loss: 16426.3379; train_edge_recon_loss: 1350877.6917; train_cat_covariates_contrastive_loss: 632585.7542; train_gene_expr_recon_loss: 2854766.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4854656.1000; train_optim_loss: 4854656.1000; val_kl_reg_loss: 16075.3818; val_edge_recon_loss: 1360972.2500; val_cat_covariates_contrastive_loss: 631615.8750; val_gene_expr_recon_loss: 2849988.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4858652.0000; val_optim_loss: 4858652.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9277; val_auprc_score: 0.9670; val_best_acc_score: 0.9086; val_best_f1_score: 0.9412; train_kl_reg_loss: 15861.1467; train_edge_recon_loss: 1348348.7333; train_cat_covariates_contrastive_loss: 633454.9042; train_gene_expr_recon_loss: 2843387.9000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4841052.7000; train_optim_loss: 4841052.7000; val_kl_reg_loss: 15335.8218; val_edge_recon_loss: 1343080.5000; val_cat_covariates_contrastive_loss: 632096.1250; val_gene_expr_recon_loss: 2822956.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4813468.7500; val_optim_loss: 4813468.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9294; val_auprc_score: 0.9677; val_best_acc_score: 0.9154; val_best_f1_score: 0.9462; train_kl_reg_loss: 15188.4678; train_edge_recon_loss: 1356118.7417; train_cat_covariates_contrastive_loss: 634179.9500; train_gene_expr_recon_loss: 2831499.5167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4836986.6667; train_optim_loss: 4836986.6667; val_kl_reg_loss: 14764.6182; val_edge_recon_loss: 1305747.0625; val_cat_covariates_contrastive_loss: 634412.7188; val_gene_expr_recon_loss: 2813957.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4768881.7500; val_optim_loss: 4768881.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9229; val_auprc_score: 0.9633; val_best_acc_score: 0.9168; val_best_f1_score: 0.9465; train_kl_reg_loss: 14724.5248; train_edge_recon_loss: 1339205.3417; train_cat_covariates_contrastive_loss: 634781.4292; train_gene_expr_recon_loss: 2825275.2167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4813986.5667; train_optim_loss: 4813986.5667; val_kl_reg_loss: 14165.2163; val_edge_recon_loss: 1327522.4375; val_cat_covariates_contrastive_loss: 634034.7500; val_gene_expr_recon_loss: 2813000.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4788723.2500; val_optim_loss: 4788723.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9343; val_auprc_score: 0.9682; val_best_acc_score: 0.9197; val_best_f1_score: 0.9482; train_kl_reg_loss: 14390.8404; train_edge_recon_loss: 1331927.6667; train_cat_covariates_contrastive_loss: 635217.8292; train_gene_expr_recon_loss: 2817603.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4799139.5333; train_optim_loss: 4799139.5333; val_kl_reg_loss: 14503.0527; val_edge_recon_loss: 1330897.0625; val_cat_covariates_contrastive_loss: 634422.3125; val_gene_expr_recon_loss: 2822428.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4802250.5000; val_optim_loss: 4802250.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9316; val_auprc_score: 0.9660; val_best_acc_score: 0.9199; val_best_f1_score: 0.9485; train_kl_reg_loss: 14135.5287; train_edge_recon_loss: 1337563.9417; train_cat_covariates_contrastive_loss: 635861.3708; train_gene_expr_recon_loss: 2809193.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4796754.1000; train_optim_loss: 4796754.1000; val_kl_reg_loss: 13806.5986; val_edge_recon_loss: 1346909.3750; val_cat_covariates_contrastive_loss: 637016.0000; val_gene_expr_recon_loss: 2805691.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4803423.5000; val_optim_loss: 4803423.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9298; val_auprc_score: 0.9646; val_best_acc_score: 0.9177; val_best_f1_score: 0.9470; train_kl_reg_loss: 13972.2783; train_edge_recon_loss: 1332324.9667; train_cat_covariates_contrastive_loss: 636510.5875; train_gene_expr_recon_loss: 2803498.9000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4786306.7000; train_optim_loss: 4786306.7000; val_kl_reg_loss: 13715.4902; val_edge_recon_loss: 1346990.3750; val_cat_covariates_contrastive_loss: 635690.7188; val_gene_expr_recon_loss: 2800455.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4796852.2500; val_optim_loss: 4796852.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9245; val_auprc_score: 0.9612; val_best_acc_score: 0.9175; val_best_f1_score: 0.9473; train_kl_reg_loss: 13859.6827; train_edge_recon_loss: 1339176.1000; train_cat_covariates_contrastive_loss: 635890.5375; train_gene_expr_recon_loss: 2800827.4833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4789753.8000; train_optim_loss: 4789753.8000; val_kl_reg_loss: 13788.7432; val_edge_recon_loss: 1360585.6875; val_cat_covariates_contrastive_loss: 635336.0938; val_gene_expr_recon_loss: 2792240.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4801950.5000; val_optim_loss: 4801950.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9254; val_auprc_score: 0.9639; val_best_acc_score: 0.9148; val_best_f1_score: 0.9454; train_kl_reg_loss: 13928.4768; train_edge_recon_loss: 1335850.8583; train_cat_covariates_contrastive_loss: 636946.4708; train_gene_expr_recon_loss: 2798422.0167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4785147.8333; train_optim_loss: 4785147.8333; val_kl_reg_loss: 13869.8613; val_edge_recon_loss: 1381977.7500; val_cat_covariates_contrastive_loss: 635229.7500; val_gene_expr_recon_loss: 2801405.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4832482.2500; val_optim_loss: 4832482.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9266; val_auprc_score: 0.9618; val_best_acc_score: 0.9197; val_best_f1_score: 0.9482; train_kl_reg_loss: 13946.0630; train_edge_recon_loss: 1333401.7333; train_cat_covariates_contrastive_loss: 635806.1458; train_gene_expr_recon_loss: 2798281.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4781435.7333; train_optim_loss: 4781435.7333; val_kl_reg_loss: 13747.8364; val_edge_recon_loss: 1367730.7500; val_cat_covariates_contrastive_loss: 634786.9062; val_gene_expr_recon_loss: 2791965.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4808230.7500; val_optim_loss: 4808230.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9305; val_auprc_score: 0.9653; val_best_acc_score: 0.9214; val_best_f1_score: 0.9497; train_kl_reg_loss: 13891.6979; train_edge_recon_loss: 1338274.5000; train_cat_covariates_contrastive_loss: 635829.5792; train_gene_expr_recon_loss: 2801231.8500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4789227.5667; train_optim_loss: 4789227.5667; val_kl_reg_loss: 13881.7734; val_edge_recon_loss: 1341918.3125; val_cat_covariates_contrastive_loss: 634528.7500; val_gene_expr_recon_loss: 2790881.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4781210.5000; val_optim_loss: 4781210.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 49 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
val AUROC score: 0.9173
val AUPRC score: 0.9608
val best accuracy score: 0.9109
val best F1 score: 0.9428
val target rna MSE score: 1.2940
val source rna MSE score: 0.4857
Val cat covariate0 mean sim diff: 0.0035
Val cat covariate1 mean sim diff: -0.1257
Duration of model training in run 3: 0 hours, 2 minutes and 53 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 12706
Number of validation nodes: 1412
Number of training edges: 30579
Number of validation edges: 3397
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8720; val_auprc_score: 0.9530; val_best_acc_score: 0.8178; val_best_f1_score: 0.8913; train_kl_reg_loss: 1514.0299; train_edge_recon_loss: 1796094.0156; train_cat_covariates_contrastive_loss: 955898.6328; train_gene_expr_recon_loss: 4006004.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6759511.4375; train_optim_loss: 6759511.4375; val_kl_reg_loss: 4149.3784; val_edge_recon_loss: 2035564.8750; val_cat_covariates_contrastive_loss: 627398.8750; val_gene_expr_recon_loss: 3865096.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6532210.0000; val_optim_loss: 6532210.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8839; val_auprc_score: 0.9580; val_best_acc_score: 0.8333; val_best_f1_score: 0.8987; train_kl_reg_loss: 4593.5738; train_edge_recon_loss: 1923323.1562; train_cat_covariates_contrastive_loss: 643301.0938; train_gene_expr_recon_loss: 3698251.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6269469.0000; train_optim_loss: 6269469.0000; val_kl_reg_loss: 3036.9766; val_edge_recon_loss: 1978302.6250; val_cat_covariates_contrastive_loss: 627477.9375; val_gene_expr_recon_loss: 3658758.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6267576.0000; val_optim_loss: 6267576.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8644; val_auprc_score: 0.9488; val_best_acc_score: 0.8266; val_best_f1_score: 0.8968; train_kl_reg_loss: 2465.8711; train_edge_recon_loss: 1833320.0469; train_cat_covariates_contrastive_loss: 695394.0391; train_gene_expr_recon_loss: 3557455.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6088635.3125; train_optim_loss: 6088635.3125; val_kl_reg_loss: 2494.6704; val_edge_recon_loss: 1977965.6250; val_cat_covariates_contrastive_loss: 627696.0625; val_gene_expr_recon_loss: 3522068.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6130224.0000; val_optim_loss: 6130224.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8241; val_auprc_score: 0.9300; val_best_acc_score: 0.8210; val_best_f1_score: 0.8916; train_kl_reg_loss: 2874.5234; train_edge_recon_loss: 1813991.9375; train_cat_covariates_contrastive_loss: 683333.8359; train_gene_expr_recon_loss: 3418793.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5918994.2500; train_optim_loss: 5918994.2500; val_kl_reg_loss: 3343.5808; val_edge_recon_loss: 1937726.1250; val_cat_covariates_contrastive_loss: 628015.8750; val_gene_expr_recon_loss: 3408681.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5977767.0000; val_optim_loss: 5977767.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8149; val_auprc_score: 0.9191; val_best_acc_score: 0.8248; val_best_f1_score: 0.8919; train_kl_reg_loss: 4458.0592; train_edge_recon_loss: 1712240.6406; train_cat_covariates_contrastive_loss: 672025.6016; train_gene_expr_recon_loss: 3322004.4688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5710728.6875; train_optim_loss: 5710728.6875; val_kl_reg_loss: 5844.2451; val_edge_recon_loss: 1790160.2500; val_cat_covariates_contrastive_loss: 628409.3125; val_gene_expr_recon_loss: 3309176.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5733590.0000; val_optim_loss: 5733590.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8037; val_auprc_score: 0.9206; val_best_acc_score: 0.8205; val_best_f1_score: 0.8916; train_kl_reg_loss: 7414.5054; train_edge_recon_loss: 1659611.5625; train_cat_covariates_contrastive_loss: 656969.3047; train_gene_expr_recon_loss: 3226894.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5550890.2500; train_optim_loss: 5550890.2500; val_kl_reg_loss: 9572.7168; val_edge_recon_loss: 1653713.0000; val_cat_covariates_contrastive_loss: 628380.8125; val_gene_expr_recon_loss: 3224202.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5515869.0000; val_optim_loss: 5515869.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.7859; val_auprc_score: 0.9087; val_best_acc_score: 0.8088; val_best_f1_score: 0.8846; train_kl_reg_loss: 11916.5210; train_edge_recon_loss: 1606972.1094; train_cat_covariates_contrastive_loss: 644913.3516; train_gene_expr_recon_loss: 3155155.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5418957.6875; train_optim_loss: 5418957.6875; val_kl_reg_loss: 14482.2100; val_edge_recon_loss: 1674161.1250; val_cat_covariates_contrastive_loss: 627899.3125; val_gene_expr_recon_loss: 3167463.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5484006.0000; val_optim_loss: 5484006.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.7797; val_auprc_score: 0.9105; val_best_acc_score: 0.8076; val_best_f1_score: 0.8851; train_kl_reg_loss: 17258.7992; train_edge_recon_loss: 1542719.7031; train_cat_covariates_contrastive_loss: 633002.9219; train_gene_expr_recon_loss: 3100040.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5293022.1875; train_optim_loss: 5293022.1875; val_kl_reg_loss: 19759.3184; val_edge_recon_loss: 1576162.6250; val_cat_covariates_contrastive_loss: 627949.3750; val_gene_expr_recon_loss: 3116576.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5340447.5000; val_optim_loss: 5340447.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.7801; val_auprc_score: 0.9141; val_best_acc_score: 0.8048; val_best_f1_score: 0.8836; train_kl_reg_loss: 21087.0400; train_edge_recon_loss: 1523143.9688; train_cat_covariates_contrastive_loss: 631228.2266; train_gene_expr_recon_loss: 3045610.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5221069.9375; train_optim_loss: 5221069.9375; val_kl_reg_loss: 22670.1543; val_edge_recon_loss: 1580926.6250; val_cat_covariates_contrastive_loss: 627723.8750; val_gene_expr_recon_loss: 3075059.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5306379.5000; val_optim_loss: 5306379.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.7866; val_auprc_score: 0.9154; val_best_acc_score: 0.8066; val_best_f1_score: 0.8836; train_kl_reg_loss: 23423.9937; train_edge_recon_loss: 1494598.8906; train_cat_covariates_contrastive_loss: 630273.8125; train_gene_expr_recon_loss: 3006821.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5155117.7500; train_optim_loss: 5155117.7500; val_kl_reg_loss: 22605.6406; val_edge_recon_loss: 1571877.0000; val_cat_covariates_contrastive_loss: 627650.3750; val_gene_expr_recon_loss: 3035472.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5257605.0000; val_optim_loss: 5257605.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8069; val_auprc_score: 0.9234; val_best_acc_score: 0.8187; val_best_f1_score: 0.8901; train_kl_reg_loss: 23232.3494; train_edge_recon_loss: 1514639.6875; train_cat_covariates_contrastive_loss: 630339.8906; train_gene_expr_recon_loss: 2987211.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5155423.1250; train_optim_loss: 5155423.1250; val_kl_reg_loss: 22150.6406; val_edge_recon_loss: 1508316.0000; val_cat_covariates_contrastive_loss: 628073.3750; val_gene_expr_recon_loss: 3003873.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5162413.0000; val_optim_loss: 5162413.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8227; val_auprc_score: 0.9238; val_best_acc_score: 0.8217; val_best_f1_score: 0.8904; train_kl_reg_loss: 22153.9373; train_edge_recon_loss: 1483115.4219; train_cat_covariates_contrastive_loss: 631998.3516; train_gene_expr_recon_loss: 2939276.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5076544.5625; train_optim_loss: 5076544.5625; val_kl_reg_loss: 22022.3164; val_edge_recon_loss: 1530705.1250; val_cat_covariates_contrastive_loss: 628832.3125; val_gene_expr_recon_loss: 2981994.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5163554.0000; val_optim_loss: 5163554.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8350; val_auprc_score: 0.9267; val_best_acc_score: 0.8329; val_best_f1_score: 0.8959; train_kl_reg_loss: 21525.4495; train_edge_recon_loss: 1454329.3281; train_cat_covariates_contrastive_loss: 632850.6172; train_gene_expr_recon_loss: 2922504.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5031210.0625; train_optim_loss: 5031210.0625; val_kl_reg_loss: 20752.0254; val_edge_recon_loss: 1496954.0000; val_cat_covariates_contrastive_loss: 629500.5625; val_gene_expr_recon_loss: 2965752.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5112958.5000; val_optim_loss: 5112958.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8605; val_auprc_score: 0.9341; val_best_acc_score: 0.8506; val_best_f1_score: 0.9061; train_kl_reg_loss: 21159.3328; train_edge_recon_loss: 1426380.3438; train_cat_covariates_contrastive_loss: 632531.5156; train_gene_expr_recon_loss: 2909722.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4989793.6875; train_optim_loss: 4989793.6875; val_kl_reg_loss: 21307.9375; val_edge_recon_loss: 1457054.7500; val_cat_covariates_contrastive_loss: 630465.0000; val_gene_expr_recon_loss: 2949229.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5058057.5000; val_optim_loss: 5058057.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8670; val_auprc_score: 0.9335; val_best_acc_score: 0.8649; val_best_f1_score: 0.9132; train_kl_reg_loss: 21378.7002; train_edge_recon_loss: 1415420.2656; train_cat_covariates_contrastive_loss: 632029.8594; train_gene_expr_recon_loss: 2904942.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4973771.3125; train_optim_loss: 4973771.3125; val_kl_reg_loss: 21030.2539; val_edge_recon_loss: 1466340.8750; val_cat_covariates_contrastive_loss: 630326.9375; val_gene_expr_recon_loss: 2933546.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5051244.0000; val_optim_loss: 5051244.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8788; val_auprc_score: 0.9444; val_best_acc_score: 0.8765; val_best_f1_score: 0.9216; train_kl_reg_loss: 21952.0764; train_edge_recon_loss: 1382695.9844; train_cat_covariates_contrastive_loss: 631913.9141; train_gene_expr_recon_loss: 2878061.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4914623.6875; train_optim_loss: 4914623.6875; val_kl_reg_loss: 21330.1875; val_edge_recon_loss: 1416812.8750; val_cat_covariates_contrastive_loss: 630449.1875; val_gene_expr_recon_loss: 2915684.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4984276.5000; val_optim_loss: 4984276.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8620; val_auprc_score: 0.9368; val_best_acc_score: 0.8755; val_best_f1_score: 0.9219; train_kl_reg_loss: 21658.7559; train_edge_recon_loss: 1360628.3438; train_cat_covariates_contrastive_loss: 631851.6562; train_gene_expr_recon_loss: 2865190.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4879329.6875; train_optim_loss: 4879329.6875; val_kl_reg_loss: 21178.1562; val_edge_recon_loss: 1399178.7500; val_cat_covariates_contrastive_loss: 630621.6875; val_gene_expr_recon_loss: 2900814.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4951792.5000; val_optim_loss: 4951792.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8818; val_auprc_score: 0.9444; val_best_acc_score: 0.8791; val_best_f1_score: 0.9229; train_kl_reg_loss: 21049.8318; train_edge_recon_loss: 1372840.9219; train_cat_covariates_contrastive_loss: 631880.8672; train_gene_expr_recon_loss: 2854447.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4880219.1875; train_optim_loss: 4880219.1875; val_kl_reg_loss: 20506.2578; val_edge_recon_loss: 1403562.2500; val_cat_covariates_contrastive_loss: 630135.0625; val_gene_expr_recon_loss: 2890268.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4944472.0000; val_optim_loss: 4944472.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8774; val_auprc_score: 0.9423; val_best_acc_score: 0.8804; val_best_f1_score: 0.9248; train_kl_reg_loss: 20814.1743; train_edge_recon_loss: 1381845.7812; train_cat_covariates_contrastive_loss: 631930.1953; train_gene_expr_recon_loss: 2841660.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4876251.0625; train_optim_loss: 4876251.0625; val_kl_reg_loss: 19932.7305; val_edge_recon_loss: 1394434.3750; val_cat_covariates_contrastive_loss: 632053.5000; val_gene_expr_recon_loss: 2877554.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4923975.0000; val_optim_loss: 4923975.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8864; val_auprc_score: 0.9476; val_best_acc_score: 0.8854; val_best_f1_score: 0.9272; train_kl_reg_loss: 20178.1377; train_edge_recon_loss: 1367698.1406; train_cat_covariates_contrastive_loss: 632071.9297; train_gene_expr_recon_loss: 2824398.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4844347.0625; train_optim_loss: 4844347.0625; val_kl_reg_loss: 19743.6250; val_edge_recon_loss: 1406817.6250; val_cat_covariates_contrastive_loss: 630917.4375; val_gene_expr_recon_loss: 2866263.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4923742.0000; val_optim_loss: 4923742.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8839; val_auprc_score: 0.9473; val_best_acc_score: 0.8842; val_best_f1_score: 0.9271; train_kl_reg_loss: 19905.4866; train_edge_recon_loss: 1390450.3906; train_cat_covariates_contrastive_loss: 632523.5000; train_gene_expr_recon_loss: 2813362.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4856242.1250; train_optim_loss: 4856242.1250; val_kl_reg_loss: 19095.9688; val_edge_recon_loss: 1408552.2500; val_cat_covariates_contrastive_loss: 631950.5000; val_gene_expr_recon_loss: 2860497.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4920096.0000; val_optim_loss: 4920096.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8777; val_auprc_score: 0.9441; val_best_acc_score: 0.8821; val_best_f1_score: 0.9262; train_kl_reg_loss: 19528.1184; train_edge_recon_loss: 1331712.7656; train_cat_covariates_contrastive_loss: 632828.7734; train_gene_expr_recon_loss: 2807666.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4791736.0625; train_optim_loss: 4791736.0625; val_kl_reg_loss: 18854.7383; val_edge_recon_loss: 1380943.3750; val_cat_covariates_contrastive_loss: 632448.5625; val_gene_expr_recon_loss: 2848977.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4881224.0000; val_optim_loss: 4881224.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8889; val_auprc_score: 0.9447; val_best_acc_score: 0.8906; val_best_f1_score: 0.9302; train_kl_reg_loss: 18711.9548; train_edge_recon_loss: 1371049.8125; train_cat_covariates_contrastive_loss: 633845.7969; train_gene_expr_recon_loss: 2800458.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4824066.0625; train_optim_loss: 4824066.0625; val_kl_reg_loss: 18427.2461; val_edge_recon_loss: 1404640.6250; val_cat_covariates_contrastive_loss: 632934.8125; val_gene_expr_recon_loss: 2845842.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4901845.0000; val_optim_loss: 4901845.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8878; val_auprc_score: 0.9489; val_best_acc_score: 0.8882; val_best_f1_score: 0.9296; train_kl_reg_loss: 18668.3406; train_edge_recon_loss: 1350526.4844; train_cat_covariates_contrastive_loss: 634049.8359; train_gene_expr_recon_loss: 2797566.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4800811.0000; train_optim_loss: 4800811.0000; val_kl_reg_loss: 17735.1270; val_edge_recon_loss: 1371174.1250; val_cat_covariates_contrastive_loss: 632895.3750; val_gene_expr_recon_loss: 2840042.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4861847.0000; val_optim_loss: 4861847.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8858; val_auprc_score: 0.9446; val_best_acc_score: 0.8884; val_best_f1_score: 0.9295; train_kl_reg_loss: 17823.7117; train_edge_recon_loss: 1365297.7500; train_cat_covariates_contrastive_loss: 634670.3594; train_gene_expr_recon_loss: 2784253.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4802045.2500; train_optim_loss: 4802045.2500; val_kl_reg_loss: 17175.3047; val_edge_recon_loss: 1405644.1250; val_cat_covariates_contrastive_loss: 633676.6875; val_gene_expr_recon_loss: 2832037.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4888533.5000; val_optim_loss: 4888533.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9084; val_auprc_score: 0.9583; val_best_acc_score: 0.8997; val_best_f1_score: 0.9360; train_kl_reg_loss: 17550.9622; train_edge_recon_loss: 1350692.8438; train_cat_covariates_contrastive_loss: 635299.1641; train_gene_expr_recon_loss: 2773992.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4777535.3125; train_optim_loss: 4777535.3125; val_kl_reg_loss: 17199.0938; val_edge_recon_loss: 1357924.5000; val_cat_covariates_contrastive_loss: 634407.3750; val_gene_expr_recon_loss: 2822795.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4832326.0000; val_optim_loss: 4832326.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9001; val_auprc_score: 0.9531; val_best_acc_score: 0.9007; val_best_f1_score: 0.9368; train_kl_reg_loss: 17216.4768; train_edge_recon_loss: 1371828.0312; train_cat_covariates_contrastive_loss: 635685.6172; train_gene_expr_recon_loss: 2777263.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4801993.4375; train_optim_loss: 4801993.4375; val_kl_reg_loss: 16866.1094; val_edge_recon_loss: 1348113.6250; val_cat_covariates_contrastive_loss: 633829.1250; val_gene_expr_recon_loss: 2822786.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4821595.0000; val_optim_loss: 4821595.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9087; val_auprc_score: 0.9582; val_best_acc_score: 0.8959; val_best_f1_score: 0.9339; train_kl_reg_loss: 16976.8093; train_edge_recon_loss: 1357638.7344; train_cat_covariates_contrastive_loss: 635920.2422; train_gene_expr_recon_loss: 2769332.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4779868.6875; train_optim_loss: 4779868.6875; val_kl_reg_loss: 16326.1885; val_edge_recon_loss: 1377461.8750; val_cat_covariates_contrastive_loss: 634093.8750; val_gene_expr_recon_loss: 2816436.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4844318.0000; val_optim_loss: 4844318.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8920; val_auprc_score: 0.9468; val_best_acc_score: 0.8981; val_best_f1_score: 0.9351; train_kl_reg_loss: 16602.7378; train_edge_recon_loss: 1351708.3750; train_cat_covariates_contrastive_loss: 637253.0156; train_gene_expr_recon_loss: 2771422.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4776986.5000; train_optim_loss: 4776986.5000; val_kl_reg_loss: 16136.4180; val_edge_recon_loss: 1379900.7500; val_cat_covariates_contrastive_loss: 636460.6250; val_gene_expr_recon_loss: 2809252.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4841750.0000; val_optim_loss: 4841750.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8939; val_auprc_score: 0.9522; val_best_acc_score: 0.8959; val_best_f1_score: 0.9349; train_kl_reg_loss: 16364.2816; train_edge_recon_loss: 1338381.2188; train_cat_covariates_contrastive_loss: 637067.4609; train_gene_expr_recon_loss: 2760427.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4752240.9375; train_optim_loss: 4752240.9375; val_kl_reg_loss: 16045.3203; val_edge_recon_loss: 1367737.0000; val_cat_covariates_contrastive_loss: 635267.7500; val_gene_expr_recon_loss: 2805523.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4824573.5000; val_optim_loss: 4824573.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8951; val_auprc_score: 0.9511; val_best_acc_score: 0.8961; val_best_f1_score: 0.9344; train_kl_reg_loss: 16408.1494; train_edge_recon_loss: 1369753.8594; train_cat_covariates_contrastive_loss: 636511.9922; train_gene_expr_recon_loss: 2765153.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4787827.5625; train_optim_loss: 4787827.5625; val_kl_reg_loss: 15826.2461; val_edge_recon_loss: 1353995.3750; val_cat_covariates_contrastive_loss: 635417.3750; val_gene_expr_recon_loss: 2803922.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4809161.0000; val_optim_loss: 4809161.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9027; val_auprc_score: 0.9554; val_best_acc_score: 0.9010; val_best_f1_score: 0.9372; train_kl_reg_loss: 16071.1621; train_edge_recon_loss: 1322999.9531; train_cat_covariates_contrastive_loss: 637483.7500; train_gene_expr_recon_loss: 2756270.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4732825.1250; train_optim_loss: 4732825.1250; val_kl_reg_loss: 15632.5840; val_edge_recon_loss: 1353709.1250; val_cat_covariates_contrastive_loss: 634891.1250; val_gene_expr_recon_loss: 2796328.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4800561.5000; val_optim_loss: 4800561.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9023; val_auprc_score: 0.9515; val_best_acc_score: 0.9002; val_best_f1_score: 0.9359; train_kl_reg_loss: 15894.1619; train_edge_recon_loss: 1342880.7344; train_cat_covariates_contrastive_loss: 636871.5781; train_gene_expr_recon_loss: 2744584.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4740230.6250; train_optim_loss: 4740230.6250; val_kl_reg_loss: 15309.1797; val_edge_recon_loss: 1388786.2500; val_cat_covariates_contrastive_loss: 635355.4375; val_gene_expr_recon_loss: 2792355.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4831806.0000; val_optim_loss: 4831806.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9142; val_auprc_score: 0.9596; val_best_acc_score: 0.9086; val_best_f1_score: 0.9425; train_kl_reg_loss: 15460.8656; train_edge_recon_loss: 1333245.0000; train_cat_covariates_contrastive_loss: 637235.9922; train_gene_expr_recon_loss: 2744870.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4730811.9375; train_optim_loss: 4730811.9375; val_kl_reg_loss: 14956.7744; val_edge_recon_loss: 1322187.5000; val_cat_covariates_contrastive_loss: 637494.4375; val_gene_expr_recon_loss: 2789999.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4764638.0000; val_optim_loss: 4764638.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9120; val_auprc_score: 0.9565; val_best_acc_score: 0.9041; val_best_f1_score: 0.9386; train_kl_reg_loss: 15158.3015; train_edge_recon_loss: 1346603.0156; train_cat_covariates_contrastive_loss: 637583.7969; train_gene_expr_recon_loss: 2742597.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4741942.8125; train_optim_loss: 4741942.8125; val_kl_reg_loss: 14523.5117; val_edge_recon_loss: 1398331.6250; val_cat_covariates_contrastive_loss: 637293.9375; val_gene_expr_recon_loss: 2785629.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4835778.5000; val_optim_loss: 4835778.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9012; val_auprc_score: 0.9519; val_best_acc_score: 0.8982; val_best_f1_score: 0.9356; train_kl_reg_loss: 14852.6829; train_edge_recon_loss: 1317954.3750; train_cat_covariates_contrastive_loss: 638384.1016; train_gene_expr_recon_loss: 2745051.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4716243.0625; train_optim_loss: 4716243.0625; val_kl_reg_loss: 14582.7090; val_edge_recon_loss: 1407255.3750; val_cat_covariates_contrastive_loss: 637272.0000; val_gene_expr_recon_loss: 2785696.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4844806.0000; val_optim_loss: 4844806.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8965; val_auprc_score: 0.9490; val_best_acc_score: 0.8994; val_best_f1_score: 0.9361; train_kl_reg_loss: 14996.9598; train_edge_recon_loss: 1333632.3594; train_cat_covariates_contrastive_loss: 637888.7812; train_gene_expr_recon_loss: 2732686.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4719204.8750; train_optim_loss: 4719204.8750; val_kl_reg_loss: 14697.8887; val_edge_recon_loss: 1373101.8750; val_cat_covariates_contrastive_loss: 638614.9375; val_gene_expr_recon_loss: 2778800.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4805215.0000; val_optim_loss: 4805215.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9120; val_auprc_score: 0.9594; val_best_acc_score: 0.9058; val_best_f1_score: 0.9401; train_kl_reg_loss: 14740.7881; train_edge_recon_loss: 1336038.2812; train_cat_covariates_contrastive_loss: 637130.4062; train_gene_expr_recon_loss: 2729514.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4717424.5000; train_optim_loss: 4717424.5000; val_kl_reg_loss: 14375.4688; val_edge_recon_loss: 1340059.8750; val_cat_covariates_contrastive_loss: 634895.2500; val_gene_expr_recon_loss: 2777455.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4766785.5000; val_optim_loss: 4766785.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9041; val_auprc_score: 0.9512; val_best_acc_score: 0.9071; val_best_f1_score: 0.9410; train_kl_reg_loss: 14615.1469; train_edge_recon_loss: 1335125.1875; train_cat_covariates_contrastive_loss: 638211.5547; train_gene_expr_recon_loss: 2730321.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4718273.5625; train_optim_loss: 4718273.5625; val_kl_reg_loss: 14301.0859; val_edge_recon_loss: 1361686.1250; val_cat_covariates_contrastive_loss: 638054.3750; val_gene_expr_recon_loss: 2777405.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4791447.5000; val_optim_loss: 4791447.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9080; val_auprc_score: 0.9533; val_best_acc_score: 0.9062; val_best_f1_score: 0.9397; train_kl_reg_loss: 14603.0834; train_edge_recon_loss: 1345122.5000; train_cat_covariates_contrastive_loss: 638029.1172; train_gene_expr_recon_loss: 2732305.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4730060.6875; train_optim_loss: 4730060.6875; val_kl_reg_loss: 14327.3828; val_edge_recon_loss: 1390768.7500; val_cat_covariates_contrastive_loss: 635743.8125; val_gene_expr_recon_loss: 2776775.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4817615.5000; val_optim_loss: 4817615.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9130; val_auprc_score: 0.9591; val_best_acc_score: 0.9047; val_best_f1_score: 0.9397; train_kl_reg_loss: 14586.2085; train_edge_recon_loss: 1315336.4219; train_cat_covariates_contrastive_loss: 637920.5078; train_gene_expr_recon_loss: 2728756.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4696599.3125; train_optim_loss: 4696599.3125; val_kl_reg_loss: 14311.5605; val_edge_recon_loss: 1354384.0000; val_cat_covariates_contrastive_loss: 636273.7500; val_gene_expr_recon_loss: 2774499.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4779468.0000; val_optim_loss: 4779468.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9076; val_auprc_score: 0.9529; val_best_acc_score: 0.9058; val_best_f1_score: 0.9395; train_kl_reg_loss: 14659.3071; train_edge_recon_loss: 1343954.2969; train_cat_covariates_contrastive_loss: 636967.3359; train_gene_expr_recon_loss: 2726966.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4722547.6250; train_optim_loss: 4722547.6250; val_kl_reg_loss: 14410.9141; val_edge_recon_loss: 1387219.1250; val_cat_covariates_contrastive_loss: 637023.7500; val_gene_expr_recon_loss: 2776819.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4815473.0000; val_optim_loss: 4815473.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 53 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
val AUROC score: 0.8974
val AUPRC score: 0.9482
val best accuracy score: 0.9018
val best F1 score: 0.9382
val target rna MSE score: 1.0706
val source rna MSE score: 0.3165
Val cat covariate0 mean sim diff: -0.0036
Val cat covariate1 mean sim diff: -0.1210
Duration of model training in run 2: 0 hours, 2 minutes and 56 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 12706
Number of validation nodes: 1412
Number of training edges: 30579
Number of validation edges: 3397
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8597; val_auprc_score: 0.9465; val_best_acc_score: 0.8128; val_best_f1_score: 0.8875; train_kl_reg_loss: 1293.1351; train_edge_recon_loss: 1795348.1250; train_cat_covariates_contrastive_loss: 974617.8984; train_gene_expr_recon_loss: 4034377.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6805636.6875; train_optim_loss: 6805636.6875; val_kl_reg_loss: 3456.1506; val_edge_recon_loss: 2045154.2500; val_cat_covariates_contrastive_loss: 627474.2500; val_gene_expr_recon_loss: 3900872.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6576957.0000; val_optim_loss: 6576957.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8767; val_auprc_score: 0.9548; val_best_acc_score: 0.8201; val_best_f1_score: 0.8900; train_kl_reg_loss: 3589.4948; train_edge_recon_loss: 1898634.5156; train_cat_covariates_contrastive_loss: 653759.1328; train_gene_expr_recon_loss: 3800355.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6356338.8750; train_optim_loss: 6356338.8750; val_kl_reg_loss: 2420.8452; val_edge_recon_loss: 2036521.2500; val_cat_covariates_contrastive_loss: 627619.0000; val_gene_expr_recon_loss: 3689340.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6355901.0000; val_optim_loss: 6355901.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8575; val_auprc_score: 0.9407; val_best_acc_score: 0.8104; val_best_f1_score: 0.8833; train_kl_reg_loss: 2130.7834; train_edge_recon_loss: 1805873.8125; train_cat_covariates_contrastive_loss: 696993.2656; train_gene_expr_recon_loss: 3610699.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6115697.0625; train_optim_loss: 6115697.0625; val_kl_reg_loss: 2426.4834; val_edge_recon_loss: 2030041.1250; val_cat_covariates_contrastive_loss: 627657.9375; val_gene_expr_recon_loss: 3547464.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6207590.0000; val_optim_loss: 6207590.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8302; val_auprc_score: 0.9321; val_best_acc_score: 0.8197; val_best_f1_score: 0.8917; train_kl_reg_loss: 2518.0203; train_edge_recon_loss: 1813669.4375; train_cat_covariates_contrastive_loss: 679045.2578; train_gene_expr_recon_loss: 3493744.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5988976.7500; train_optim_loss: 5988976.7500; val_kl_reg_loss: 2651.5466; val_edge_recon_loss: 1959391.3750; val_cat_covariates_contrastive_loss: 628227.6875; val_gene_expr_recon_loss: 3445931.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6036201.5000; val_optim_loss: 6036201.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8308; val_auprc_score: 0.9304; val_best_acc_score: 0.8271; val_best_f1_score: 0.8943; train_kl_reg_loss: 3310.7226; train_edge_recon_loss: 1749883.3125; train_cat_covariates_contrastive_loss: 672978.7969; train_gene_expr_recon_loss: 3393105.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5819278.2500; train_optim_loss: 5819278.2500; val_kl_reg_loss: 3826.9004; val_edge_recon_loss: 1883797.0000; val_cat_covariates_contrastive_loss: 628635.0625; val_gene_expr_recon_loss: 3338634.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5854893.5000; val_optim_loss: 5854893.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8125; val_auprc_score: 0.9234; val_best_acc_score: 0.8178; val_best_f1_score: 0.8909; train_kl_reg_loss: 4882.3046; train_edge_recon_loss: 1696240.3594; train_cat_covariates_contrastive_loss: 670187.0703; train_gene_expr_recon_loss: 3288404.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5659714.5000; train_optim_loss: 5659714.5000; val_kl_reg_loss: 6114.4121; val_edge_recon_loss: 1734304.1250; val_cat_covariates_contrastive_loss: 628465.5625; val_gene_expr_recon_loss: 3253233.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5622117.5000; val_optim_loss: 5622117.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8010; val_auprc_score: 0.9185; val_best_acc_score: 0.8181; val_best_f1_score: 0.8908; train_kl_reg_loss: 7821.4404; train_edge_recon_loss: 1634499.7188; train_cat_covariates_contrastive_loss: 660591.6641; train_gene_expr_recon_loss: 3219409.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5522321.8125; train_optim_loss: 5522321.8125; val_kl_reg_loss: 10039.4102; val_edge_recon_loss: 1646864.7500; val_cat_covariates_contrastive_loss: 628223.8750; val_gene_expr_recon_loss: 3184220.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5469348.5000; val_optim_loss: 5469348.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.7762; val_auprc_score: 0.9065; val_best_acc_score: 0.8054; val_best_f1_score: 0.8837; train_kl_reg_loss: 12602.5878; train_edge_recon_loss: 1582398.2500; train_cat_covariates_contrastive_loss: 640820.3281; train_gene_expr_recon_loss: 3152832.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5388653.2500; train_optim_loss: 5388653.2500; val_kl_reg_loss: 15310.1709; val_edge_recon_loss: 1634755.2500; val_cat_covariates_contrastive_loss: 628055.8125; val_gene_expr_recon_loss: 3132725.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5410846.5000; val_optim_loss: 5410846.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.7730; val_auprc_score: 0.9068; val_best_acc_score: 0.7925; val_best_f1_score: 0.8751; train_kl_reg_loss: 17595.5753; train_edge_recon_loss: 1559481.8906; train_cat_covariates_contrastive_loss: 634182.9219; train_gene_expr_recon_loss: 3101846.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5313107.0000; train_optim_loss: 5313107.0000; val_kl_reg_loss: 19361.8477; val_edge_recon_loss: 1650599.3750; val_cat_covariates_contrastive_loss: 627690.0625; val_gene_expr_recon_loss: 3090465.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5388117.0000; val_optim_loss: 5388117.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.7795; val_auprc_score: 0.9109; val_best_acc_score: 0.7994; val_best_f1_score: 0.8810; train_kl_reg_loss: 20630.7734; train_edge_recon_loss: 1524430.0312; train_cat_covariates_contrastive_loss: 630589.7969; train_gene_expr_recon_loss: 3055767.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5231418.5000; train_optim_loss: 5231418.5000; val_kl_reg_loss: 21148.7207; val_edge_recon_loss: 1578125.3750; val_cat_covariates_contrastive_loss: 627814.1875; val_gene_expr_recon_loss: 3046189.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5273278.0000; val_optim_loss: 5273278.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.7866; val_auprc_score: 0.9041; val_best_acc_score: 0.7975; val_best_f1_score: 0.8753; train_kl_reg_loss: 22345.2971; train_edge_recon_loss: 1518672.0312; train_cat_covariates_contrastive_loss: 630882.0156; train_gene_expr_recon_loss: 3034086.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5205985.3750; train_optim_loss: 5205985.3750; val_kl_reg_loss: 22118.8320; val_edge_recon_loss: 1629819.1250; val_cat_covariates_contrastive_loss: 628235.5625; val_gene_expr_recon_loss: 3017544.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5297718.0000; val_optim_loss: 5297718.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8109; val_auprc_score: 0.9220; val_best_acc_score: 0.8077; val_best_f1_score: 0.8820; train_kl_reg_loss: 22583.7964; train_edge_recon_loss: 1498993.6875; train_cat_covariates_contrastive_loss: 631380.6094; train_gene_expr_recon_loss: 3001239.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5154197.2500; train_optim_loss: 5154197.2500; val_kl_reg_loss: 21918.7227; val_edge_recon_loss: 1546262.6250; val_cat_covariates_contrastive_loss: 628980.2500; val_gene_expr_recon_loss: 2987543.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5184705.0000; val_optim_loss: 5184705.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8176; val_auprc_score: 0.9209; val_best_acc_score: 0.8221; val_best_f1_score: 0.8905; train_kl_reg_loss: 21571.6057; train_edge_recon_loss: 1485301.0312; train_cat_covariates_contrastive_loss: 631919.0391; train_gene_expr_recon_loss: 2972941.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5111733.0000; train_optim_loss: 5111733.0000; val_kl_reg_loss: 20495.8828; val_edge_recon_loss: 1517284.1250; val_cat_covariates_contrastive_loss: 629317.1875; val_gene_expr_recon_loss: 2967106.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5134203.0000; val_optim_loss: 5134203.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8379; val_auprc_score: 0.9301; val_best_acc_score: 0.8357; val_best_f1_score: 0.8979; train_kl_reg_loss: 20518.7861; train_edge_recon_loss: 1431793.0781; train_cat_covariates_contrastive_loss: 632572.9219; train_gene_expr_recon_loss: 2951480.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5036365.6250; train_optim_loss: 5036365.6250; val_kl_reg_loss: 19855.5234; val_edge_recon_loss: 1479892.7500; val_cat_covariates_contrastive_loss: 630046.7500; val_gene_expr_recon_loss: 2947395.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5077190.0000; val_optim_loss: 5077190.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8515; val_auprc_score: 0.9333; val_best_acc_score: 0.8484; val_best_f1_score: 0.9049; train_kl_reg_loss: 20124.1111; train_edge_recon_loss: 1417226.3594; train_cat_covariates_contrastive_loss: 633747.6719; train_gene_expr_recon_loss: 2929763.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5000861.6875; train_optim_loss: 5000861.6875; val_kl_reg_loss: 19815.2891; val_edge_recon_loss: 1434260.2500; val_cat_covariates_contrastive_loss: 631452.8750; val_gene_expr_recon_loss: 2930380.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5015909.0000; val_optim_loss: 5015909.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8718; val_auprc_score: 0.9398; val_best_acc_score: 0.8622; val_best_f1_score: 0.9118; train_kl_reg_loss: 20180.9817; train_edge_recon_loss: 1383434.9844; train_cat_covariates_contrastive_loss: 634038.6484; train_gene_expr_recon_loss: 2911738.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4949393.4375; train_optim_loss: 4949393.4375; val_kl_reg_loss: 20226.3789; val_edge_recon_loss: 1409603.2500; val_cat_covariates_contrastive_loss: 633041.3750; val_gene_expr_recon_loss: 2910567.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4973438.0000; val_optim_loss: 4973438.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8777; val_auprc_score: 0.9448; val_best_acc_score: 0.8682; val_best_f1_score: 0.9169; train_kl_reg_loss: 20236.5527; train_edge_recon_loss: 1378856.9375; train_cat_covariates_contrastive_loss: 635253.4375; train_gene_expr_recon_loss: 2894642.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4928989.0625; train_optim_loss: 4928989.0625; val_kl_reg_loss: 19931.9805; val_edge_recon_loss: 1396933.2500; val_cat_covariates_contrastive_loss: 634803.6250; val_gene_expr_recon_loss: 2895393.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4947062.0000; val_optim_loss: 4947062.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8844; val_auprc_score: 0.9475; val_best_acc_score: 0.8790; val_best_f1_score: 0.9231; train_kl_reg_loss: 20087.3088; train_edge_recon_loss: 1362036.1562; train_cat_covariates_contrastive_loss: 636000.4922; train_gene_expr_recon_loss: 2874592.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4892716.7500; train_optim_loss: 4892716.7500; val_kl_reg_loss: 19490.6680; val_edge_recon_loss: 1356494.3750; val_cat_covariates_contrastive_loss: 633079.8750; val_gene_expr_recon_loss: 2881231.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4890296.5000; val_optim_loss: 4890296.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8949; val_auprc_score: 0.9513; val_best_acc_score: 0.8790; val_best_f1_score: 0.9222; train_kl_reg_loss: 20013.2812; train_edge_recon_loss: 1363705.8906; train_cat_covariates_contrastive_loss: 635766.2969; train_gene_expr_recon_loss: 2873937.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4893423.3125; train_optim_loss: 4893423.3125; val_kl_reg_loss: 19471.9336; val_edge_recon_loss: 1400405.5000; val_cat_covariates_contrastive_loss: 635174.7500; val_gene_expr_recon_loss: 2868950.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4924002.5000; val_optim_loss: 4924002.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8925; val_auprc_score: 0.9496; val_best_acc_score: 0.8794; val_best_f1_score: 0.9233; train_kl_reg_loss: 19330.8030; train_edge_recon_loss: 1356459.3281; train_cat_covariates_contrastive_loss: 635490.1875; train_gene_expr_recon_loss: 2854232.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4865512.6875; train_optim_loss: 4865512.6875; val_kl_reg_loss: 18702.3672; val_edge_recon_loss: 1416703.1250; val_cat_covariates_contrastive_loss: 635345.0000; val_gene_expr_recon_loss: 2858719.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4929470.0000; val_optim_loss: 4929470.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8825; val_auprc_score: 0.9450; val_best_acc_score: 0.8786; val_best_f1_score: 0.9235; train_kl_reg_loss: 18719.5417; train_edge_recon_loss: 1353547.5625; train_cat_covariates_contrastive_loss: 636037.0938; train_gene_expr_recon_loss: 2839593.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4847898.0000; train_optim_loss: 4847898.0000; val_kl_reg_loss: 17942.3398; val_edge_recon_loss: 1415860.5000; val_cat_covariates_contrastive_loss: 633581.7500; val_gene_expr_recon_loss: 2847092.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4914477.0000; val_optim_loss: 4914477.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8944; val_auprc_score: 0.9443; val_best_acc_score: 0.8895; val_best_f1_score: 0.9293; train_kl_reg_loss: 18388.0005; train_edge_recon_loss: 1371335.9375; train_cat_covariates_contrastive_loss: 636383.4766; train_gene_expr_recon_loss: 2827040.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4853147.6250; train_optim_loss: 4853147.6250; val_kl_reg_loss: 18083.4961; val_edge_recon_loss: 1404654.8750; val_cat_covariates_contrastive_loss: 633834.5000; val_gene_expr_recon_loss: 2838896.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4895469.0000; val_optim_loss: 4895469.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8888; val_auprc_score: 0.9477; val_best_acc_score: 0.8838; val_best_f1_score: 0.9273; train_kl_reg_loss: 18233.2324; train_edge_recon_loss: 1361390.7344; train_cat_covariates_contrastive_loss: 636348.6875; train_gene_expr_recon_loss: 2822416.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4838389.7500; train_optim_loss: 4838389.7500; val_kl_reg_loss: 17856.1758; val_edge_recon_loss: 1386400.0000; val_cat_covariates_contrastive_loss: 634616.3750; val_gene_expr_recon_loss: 2835634.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4874507.0000; val_optim_loss: 4874507.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9024; val_auprc_score: 0.9538; val_best_acc_score: 0.8904; val_best_f1_score: 0.9302; train_kl_reg_loss: 18154.7283; train_edge_recon_loss: 1373498.9062; train_cat_covariates_contrastive_loss: 636368.6406; train_gene_expr_recon_loss: 2823431.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4851453.8125; train_optim_loss: 4851453.8125; val_kl_reg_loss: 17872.6289; val_edge_recon_loss: 1392577.1250; val_cat_covariates_contrastive_loss: 635243.5625; val_gene_expr_recon_loss: 2835550.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4881243.0000; val_optim_loss: 4881243.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8934; val_auprc_score: 0.9496; val_best_acc_score: 0.8921; val_best_f1_score: 0.9321; train_kl_reg_loss: 18156.1055; train_edge_recon_loss: 1352112.4844; train_cat_covariates_contrastive_loss: 636322.1797; train_gene_expr_recon_loss: 2825774.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4832365.5000; train_optim_loss: 4832365.5000; val_kl_reg_loss: 17886.0527; val_edge_recon_loss: 1352357.6250; val_cat_covariates_contrastive_loss: 634252.4375; val_gene_expr_recon_loss: 2834381.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4838878.0000; val_optim_loss: 4838878.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8868; val_auprc_score: 0.9467; val_best_acc_score: 0.8832; val_best_f1_score: 0.9262; train_kl_reg_loss: 18067.8511; train_edge_recon_loss: 1355823.4062; train_cat_covariates_contrastive_loss: 636739.7266; train_gene_expr_recon_loss: 2811631.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4822262.3125; train_optim_loss: 4822262.3125; val_kl_reg_loss: 17951.5020; val_edge_recon_loss: 1421300.5000; val_cat_covariates_contrastive_loss: 634085.1250; val_gene_expr_recon_loss: 2835160.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4908497.5000; val_optim_loss: 4908497.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8883; val_auprc_score: 0.9478; val_best_acc_score: 0.8870; val_best_f1_score: 0.9289; train_kl_reg_loss: 18213.8455; train_edge_recon_loss: 1369493.5469; train_cat_covariates_contrastive_loss: 636991.6172; train_gene_expr_recon_loss: 2823495.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4848194.6250; train_optim_loss: 4848194.6250; val_kl_reg_loss: 17926.5742; val_edge_recon_loss: 1397967.2500; val_cat_covariates_contrastive_loss: 633782.0000; val_gene_expr_recon_loss: 2834448.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4884124.5000; val_optim_loss: 4884124.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9014; val_auprc_score: 0.9548; val_best_acc_score: 0.8842; val_best_f1_score: 0.9266; train_kl_reg_loss: 18153.1189; train_edge_recon_loss: 1365487.8438; train_cat_covariates_contrastive_loss: 636260.0938; train_gene_expr_recon_loss: 2823574.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4843475.2500; train_optim_loss: 4843475.2500; val_kl_reg_loss: 17788.2969; val_edge_recon_loss: 1435061.1250; val_cat_covariates_contrastive_loss: 634578.1250; val_gene_expr_recon_loss: 2829966.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4917393.5000; val_optim_loss: 4917393.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8983; val_auprc_score: 0.9506; val_best_acc_score: 0.8908; val_best_f1_score: 0.9308; train_kl_reg_loss: 18036.7908; train_edge_recon_loss: 1351851.2500; train_cat_covariates_contrastive_loss: 636103.8672; train_gene_expr_recon_loss: 2816152.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4822144.6250; train_optim_loss: 4822144.6250; val_kl_reg_loss: 17714.3164; val_edge_recon_loss: 1370430.1250; val_cat_covariates_contrastive_loss: 635158.1875; val_gene_expr_recon_loss: 2829610.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4852913.0000; val_optim_loss: 4852913.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9048; val_auprc_score: 0.9553; val_best_acc_score: 0.8967; val_best_f1_score: 0.9347; train_kl_reg_loss: 18057.4529; train_edge_recon_loss: 1343982.3594; train_cat_covariates_contrastive_loss: 635821.1797; train_gene_expr_recon_loss: 2828233.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4826094.3750; train_optim_loss: 4826094.3750; val_kl_reg_loss: 17815.0820; val_edge_recon_loss: 1351305.5000; val_cat_covariates_contrastive_loss: 634929.0625; val_gene_expr_recon_loss: 2832207.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4836257.0000; val_optim_loss: 4836257.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8845; val_auprc_score: 0.9416; val_best_acc_score: 0.8896; val_best_f1_score: 0.9303; train_kl_reg_loss: 18048.2852; train_edge_recon_loss: 1346162.0156; train_cat_covariates_contrastive_loss: 636156.0078; train_gene_expr_recon_loss: 2823628.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4823994.5625; train_optim_loss: 4823994.5625; val_kl_reg_loss: 17728.9375; val_edge_recon_loss: 1383310.8750; val_cat_covariates_contrastive_loss: 635220.4375; val_gene_expr_recon_loss: 2831545.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4867805.5000; val_optim_loss: 4867805.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8833; val_auprc_score: 0.9441; val_best_acc_score: 0.8843; val_best_f1_score: 0.9273; train_kl_reg_loss: 18049.1606; train_edge_recon_loss: 1371708.8594; train_cat_covariates_contrastive_loss: 636154.2969; train_gene_expr_recon_loss: 2817584.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4843497.1875; train_optim_loss: 4843497.1875; val_kl_reg_loss: 17773.9766; val_edge_recon_loss: 1398188.5000; val_cat_covariates_contrastive_loss: 635629.8750; val_gene_expr_recon_loss: 2831730.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4883323.0000; val_optim_loss: 4883323.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8996; val_auprc_score: 0.9505; val_best_acc_score: 0.8933; val_best_f1_score: 0.9322; train_kl_reg_loss: 18058.8975; train_edge_recon_loss: 1346696.9531; train_cat_covariates_contrastive_loss: 636077.4766; train_gene_expr_recon_loss: 2820437.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4821270.3750; train_optim_loss: 4821270.3750; val_kl_reg_loss: 17841.1895; val_edge_recon_loss: 1382808.2500; val_cat_covariates_contrastive_loss: 633367.9375; val_gene_expr_recon_loss: 2831884.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4865901.5000; val_optim_loss: 4865901.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9026; val_auprc_score: 0.9558; val_best_acc_score: 0.8863; val_best_f1_score: 0.9279; train_kl_reg_loss: 18050.6238; train_edge_recon_loss: 1356502.0625; train_cat_covariates_contrastive_loss: 636195.5547; train_gene_expr_recon_loss: 2825719.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4836467.3125; train_optim_loss: 4836467.3125; val_kl_reg_loss: 17854.1250; val_edge_recon_loss: 1400258.8750; val_cat_covariates_contrastive_loss: 635960.3750; val_gene_expr_recon_loss: 2833722.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4887796.0000; val_optim_loss: 4887796.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8929; val_auprc_score: 0.9497; val_best_acc_score: 0.8858; val_best_f1_score: 0.9284; train_kl_reg_loss: 18057.7234; train_edge_recon_loss: 1352210.4844; train_cat_covariates_contrastive_loss: 636077.8438; train_gene_expr_recon_loss: 2823821.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4830167.2500; train_optim_loss: 4830167.2500; val_kl_reg_loss: 17786.1660; val_edge_recon_loss: 1394987.5000; val_cat_covariates_contrastive_loss: 634878.4375; val_gene_expr_recon_loss: 2829852.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4877504.0000; val_optim_loss: 4877504.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8925; val_auprc_score: 0.9486; val_best_acc_score: 0.8933; val_best_f1_score: 0.9327; train_kl_reg_loss: 18055.4141; train_edge_recon_loss: 1354782.5000; train_cat_covariates_contrastive_loss: 635997.8203; train_gene_expr_recon_loss: 2821238.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4830074.2500; train_optim_loss: 4830074.2500; val_kl_reg_loss: 17791.0742; val_edge_recon_loss: 1374414.7500; val_cat_covariates_contrastive_loss: 633942.9375; val_gene_expr_recon_loss: 2830408.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4856557.0000; val_optim_loss: 4856557.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9010; val_auprc_score: 0.9532; val_best_acc_score: 0.8930; val_best_f1_score: 0.9323; train_kl_reg_loss: 18045.3970; train_edge_recon_loss: 1349203.5156; train_cat_covariates_contrastive_loss: 635754.0156; train_gene_expr_recon_loss: 2819227.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4822230.5625; train_optim_loss: 4822230.5625; val_kl_reg_loss: 17824.3535; val_edge_recon_loss: 1353248.3750; val_cat_covariates_contrastive_loss: 632226.0625; val_gene_expr_recon_loss: 2831225.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4834524.0000; val_optim_loss: 4834524.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8909; val_auprc_score: 0.9503; val_best_acc_score: 0.8885; val_best_f1_score: 0.9298; train_kl_reg_loss: 18055.4292; train_edge_recon_loss: 1347399.3125; train_cat_covariates_contrastive_loss: 636553.2891; train_gene_expr_recon_loss: 2814518.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4816526.8125; train_optim_loss: 4816526.8125; val_kl_reg_loss: 17775.3008; val_edge_recon_loss: 1388026.6250; val_cat_covariates_contrastive_loss: 635285.8750; val_gene_expr_recon_loss: 2831765.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4872853.0000; val_optim_loss: 4872853.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8976; val_auprc_score: 0.9528; val_best_acc_score: 0.8921; val_best_f1_score: 0.9317; train_kl_reg_loss: 18113.6541; train_edge_recon_loss: 1364809.0000; train_cat_covariates_contrastive_loss: 636573.5391; train_gene_expr_recon_loss: 2825405.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4844901.5625; train_optim_loss: 4844901.5625; val_kl_reg_loss: 17730.5742; val_edge_recon_loss: 1374058.1250; val_cat_covariates_contrastive_loss: 635499.8125; val_gene_expr_recon_loss: 2831190.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4858478.5000; val_optim_loss: 4858478.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8855; val_auprc_score: 0.9455; val_best_acc_score: 0.8831; val_best_f1_score: 0.9264; train_kl_reg_loss: 17999.2656; train_edge_recon_loss: 1354490.8594; train_cat_covariates_contrastive_loss: 636127.2500; train_gene_expr_recon_loss: 2808350.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4816967.5625; train_optim_loss: 4816967.5625; val_kl_reg_loss: 17854.4141; val_edge_recon_loss: 1409599.7500; val_cat_covariates_contrastive_loss: 634555.8125; val_gene_expr_recon_loss: 2832717.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4894727.5000; val_optim_loss: 4894727.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8880; val_auprc_score: 0.9459; val_best_acc_score: 0.8869; val_best_f1_score: 0.9286; train_kl_reg_loss: 18081.1021; train_edge_recon_loss: 1362597.3906; train_cat_covariates_contrastive_loss: 636183.7656; train_gene_expr_recon_loss: 2816911.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4833773.9375; train_optim_loss: 4833773.9375; val_kl_reg_loss: 17837.4609; val_edge_recon_loss: 1422209.7500; val_cat_covariates_contrastive_loss: 636960.8125; val_gene_expr_recon_loss: 2829992.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4907000.5000; val_optim_loss: 4907000.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8962; val_auprc_score: 0.9519; val_best_acc_score: 0.8897; val_best_f1_score: 0.9306; train_kl_reg_loss: 18048.4836; train_edge_recon_loss: 1351649.2969; train_cat_covariates_contrastive_loss: 635905.8438; train_gene_expr_recon_loss: 2815856.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4821460.2500; train_optim_loss: 4821460.2500; val_kl_reg_loss: 17749.7090; val_edge_recon_loss: 1365545.8750; val_cat_covariates_contrastive_loss: 633841.5625; val_gene_expr_recon_loss: 2829046.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4846183.0000; val_optim_loss: 4846183.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9004; val_auprc_score: 0.9533; val_best_acc_score: 0.8937; val_best_f1_score: 0.9327; train_kl_reg_loss: 18042.6309; train_edge_recon_loss: 1340582.7344; train_cat_covariates_contrastive_loss: 636454.7969; train_gene_expr_recon_loss: 2807503.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4802583.7500; train_optim_loss: 4802583.7500; val_kl_reg_loss: 17828.7617; val_edge_recon_loss: 1358713.0000; val_cat_covariates_contrastive_loss: 634970.8125; val_gene_expr_recon_loss: 2833939.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4845452.0000; val_optim_loss: 4845452.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8857; val_auprc_score: 0.9450; val_best_acc_score: 0.8821; val_best_f1_score: 0.9262; train_kl_reg_loss: 18059.6021; train_edge_recon_loss: 1350212.6250; train_cat_covariates_contrastive_loss: 636237.6016; train_gene_expr_recon_loss: 2818785.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4823295.0000; train_optim_loss: 4823295.0000; val_kl_reg_loss: 17810.6055; val_edge_recon_loss: 1394714.1250; val_cat_covariates_contrastive_loss: 635989.4375; val_gene_expr_recon_loss: 2831469.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4879983.0000; val_optim_loss: 4879983.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8967; val_auprc_score: 0.9480; val_best_acc_score: 0.8821; val_best_f1_score: 0.9251; train_kl_reg_loss: 18082.6877; train_edge_recon_loss: 1362003.7500; train_cat_covariates_contrastive_loss: 636091.5312; train_gene_expr_recon_loss: 2824422.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4840600.6875; train_optim_loss: 4840600.6875; val_kl_reg_loss: 17817.6172; val_edge_recon_loss: 1434308.5000; val_cat_covariates_contrastive_loss: 633348.1250; val_gene_expr_recon_loss: 2831448.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4916922.0000; val_optim_loss: 4916922.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 7 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.8914
val AUPRC score: 0.9499
val best accuracy score: 0.8858
val best F1 score: 0.9283
val target rna MSE score: 1.0745
val source rna MSE score: 0.4041
Val cat covariate0 mean sim diff: -0.0046
Val cat covariate1 mean sim diff: -0.1234
Duration of model training in run 1: 0 hours, 3 minutes and 10 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
