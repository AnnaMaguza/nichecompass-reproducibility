Run timestamp: 02092023_155335_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc_subsample_5pct', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gcnconv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 12706
Number of validation nodes: 1412
Number of training edges: 116179
Number of validation edges: 12908
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9634; val_auprc_score: 0.9855; val_best_acc_score: 0.8163; val_best_f1_score: 0.8908; train_kl_reg_loss: 2413.3206; train_edge_recon_loss: 1843122.5167; train_cat_covariates_contrastive_loss: 813558.0250; train_gene_expr_recon_loss: 3956800.0333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6615893.9333; train_optim_loss: 6615893.9333; val_kl_reg_loss: 2710.3992; val_edge_recon_loss: 2051667.8125; val_cat_covariates_contrastive_loss: 626974.0000; val_gene_expr_recon_loss: 3726053.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6407406.0000; val_optim_loss: 6407406.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8912; val_auprc_score: 0.9555; val_best_acc_score: 0.8461; val_best_f1_score: 0.9048; train_kl_reg_loss: 2385.8986; train_edge_recon_loss: 1813490.9250; train_cat_covariates_contrastive_loss: 686883.5792; train_gene_expr_recon_loss: 3602601.7833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6105362.1333; train_optim_loss: 6105362.1333; val_kl_reg_loss: 2848.1516; val_edge_recon_loss: 1954561.8125; val_cat_covariates_contrastive_loss: 627441.1250; val_gene_expr_recon_loss: 3476893.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6061744.0000; val_optim_loss: 6061744.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8669; val_auprc_score: 0.9449; val_best_acc_score: 0.8471; val_best_f1_score: 0.9050; train_kl_reg_loss: 4535.5913; train_edge_recon_loss: 1709640.6000; train_cat_covariates_contrastive_loss: 667385.1833; train_gene_expr_recon_loss: 3386051.3833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5767612.7667; train_optim_loss: 5767612.7667; val_kl_reg_loss: 6823.9973; val_edge_recon_loss: 1693745.5625; val_cat_covariates_contrastive_loss: 627836.9688; val_gene_expr_recon_loss: 3299620.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5628026.5000; val_optim_loss: 5628026.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8499; val_auprc_score: 0.9354; val_best_acc_score: 0.8322; val_best_f1_score: 0.8961; train_kl_reg_loss: 10861.6663; train_edge_recon_loss: 1612740.9500; train_cat_covariates_contrastive_loss: 648177.9542; train_gene_expr_recon_loss: 3222909.8167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5494690.3333; train_optim_loss: 5494690.3333; val_kl_reg_loss: 16727.0791; val_edge_recon_loss: 1571570.5625; val_cat_covariates_contrastive_loss: 627649.4375; val_gene_expr_recon_loss: 3179934.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5395881.5000; val_optim_loss: 5395881.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8560; val_auprc_score: 0.9389; val_best_acc_score: 0.8493; val_best_f1_score: 0.9058; train_kl_reg_loss: 20910.9082; train_edge_recon_loss: 1526439.6917; train_cat_covariates_contrastive_loss: 629987.5625; train_gene_expr_recon_loss: 3125206.0667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5302544.2000; train_optim_loss: 5302544.2000; val_kl_reg_loss: 23280.8945; val_edge_recon_loss: 1476898.0625; val_cat_covariates_contrastive_loss: 627149.6875; val_gene_expr_recon_loss: 3096089.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5223418.0000; val_optim_loss: 5223418.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8691; val_auprc_score: 0.9430; val_best_acc_score: 0.8572; val_best_f1_score: 0.9110; train_kl_reg_loss: 23730.2103; train_edge_recon_loss: 1460639.6750; train_cat_covariates_contrastive_loss: 628395.2792; train_gene_expr_recon_loss: 3057382.1500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5170147.2667; train_optim_loss: 5170147.2667; val_kl_reg_loss: 23262.2578; val_edge_recon_loss: 1464156.3125; val_cat_covariates_contrastive_loss: 627229.8125; val_gene_expr_recon_loss: 3027854.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5142502.5000; val_optim_loss: 5142502.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8897; val_auprc_score: 0.9522; val_best_acc_score: 0.8716; val_best_f1_score: 0.9193; train_kl_reg_loss: 21846.0066; train_edge_recon_loss: 1444196.0250; train_cat_covariates_contrastive_loss: 629318.1792; train_gene_expr_recon_loss: 3000196.1167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5095556.4000; train_optim_loss: 5095556.4000; val_kl_reg_loss: 20714.9775; val_edge_recon_loss: 1408133.6250; val_cat_covariates_contrastive_loss: 627526.2812; val_gene_expr_recon_loss: 2985892.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5042267.5000; val_optim_loss: 5042267.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9128; val_auprc_score: 0.9608; val_best_acc_score: 0.8971; val_best_f1_score: 0.9344; train_kl_reg_loss: 18943.1599; train_edge_recon_loss: 1409896.6583; train_cat_covariates_contrastive_loss: 630343.5833; train_gene_expr_recon_loss: 2965368.1500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5024551.5333; train_optim_loss: 5024551.5333; val_kl_reg_loss: 18699.4336; val_edge_recon_loss: 1385940.0625; val_cat_covariates_contrastive_loss: 628379.0000; val_gene_expr_recon_loss: 2953335.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4986354.2500; val_optim_loss: 4986354.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9128; val_auprc_score: 0.9609; val_best_acc_score: 0.9017; val_best_f1_score: 0.9382; train_kl_reg_loss: 19125.3392; train_edge_recon_loss: 1378762.0083; train_cat_covariates_contrastive_loss: 630379.2667; train_gene_expr_recon_loss: 2928963.4500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4957230.0667; train_optim_loss: 4957230.0667; val_kl_reg_loss: 19084.8965; val_edge_recon_loss: 1355356.7500; val_cat_covariates_contrastive_loss: 628532.1250; val_gene_expr_recon_loss: 2923015.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4925989.5000; val_optim_loss: 4925989.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9152; val_auprc_score: 0.9611; val_best_acc_score: 0.9019; val_best_f1_score: 0.9380; train_kl_reg_loss: 18955.3400; train_edge_recon_loss: 1368298.7500; train_cat_covariates_contrastive_loss: 630406.2958; train_gene_expr_recon_loss: 2907408.7333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4925069.0333; train_optim_loss: 4925069.0333; val_kl_reg_loss: 18276.4941; val_edge_recon_loss: 1355143.2500; val_cat_covariates_contrastive_loss: 628581.6250; val_gene_expr_recon_loss: 2906060.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4908062.0000; val_optim_loss: 4908062.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9211; val_auprc_score: 0.9638; val_best_acc_score: 0.9032; val_best_f1_score: 0.9383; train_kl_reg_loss: 18267.2655; train_edge_recon_loss: 1374367.3750; train_cat_covariates_contrastive_loss: 630347.6208; train_gene_expr_recon_loss: 2885778.8667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4908761.1000; train_optim_loss: 4908761.1000; val_kl_reg_loss: 18216.2969; val_edge_recon_loss: 1372244.7500; val_cat_covariates_contrastive_loss: 628813.2500; val_gene_expr_recon_loss: 2885051.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4904325.2500; val_optim_loss: 4904325.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9206; val_auprc_score: 0.9625; val_best_acc_score: 0.9054; val_best_f1_score: 0.9395; train_kl_reg_loss: 17902.1095; train_edge_recon_loss: 1373876.3583; train_cat_covariates_contrastive_loss: 630396.9000; train_gene_expr_recon_loss: 2877641.3500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4899816.6667; train_optim_loss: 4899816.6667; val_kl_reg_loss: 17528.0303; val_edge_recon_loss: 1361213.7500; val_cat_covariates_contrastive_loss: 629020.2812; val_gene_expr_recon_loss: 2857425.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4865187.7500; val_optim_loss: 4865187.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9219; val_auprc_score: 0.9616; val_best_acc_score: 0.9075; val_best_f1_score: 0.9410; train_kl_reg_loss: 17157.3102; train_edge_recon_loss: 1362380.0333; train_cat_covariates_contrastive_loss: 630525.2583; train_gene_expr_recon_loss: 2860106.0333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4870168.6667; train_optim_loss: 4870168.6667; val_kl_reg_loss: 16867.2744; val_edge_recon_loss: 1377477.3750; val_cat_covariates_contrastive_loss: 629444.5000; val_gene_expr_recon_loss: 2863283.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4887072.7500; val_optim_loss: 4887072.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9252; val_auprc_score: 0.9640; val_best_acc_score: 0.9122; val_best_f1_score: 0.9435; train_kl_reg_loss: 16355.0899; train_edge_recon_loss: 1365376.9750; train_cat_covariates_contrastive_loss: 630900.8833; train_gene_expr_recon_loss: 2850051.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4862684.3667; train_optim_loss: 4862684.3667; val_kl_reg_loss: 15865.8018; val_edge_recon_loss: 1357354.6875; val_cat_covariates_contrastive_loss: 629557.0938; val_gene_expr_recon_loss: 2851966.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4854744.0000; val_optim_loss: 4854744.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9296; val_auprc_score: 0.9678; val_best_acc_score: 0.9184; val_best_f1_score: 0.9478; train_kl_reg_loss: 15657.9306; train_edge_recon_loss: 1358837.7500; train_cat_covariates_contrastive_loss: 631617.6417; train_gene_expr_recon_loss: 2841315.7000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4847429.0667; train_optim_loss: 4847429.0667; val_kl_reg_loss: 15509.4150; val_edge_recon_loss: 1335741.6875; val_cat_covariates_contrastive_loss: 630531.1875; val_gene_expr_recon_loss: 2845410.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4827192.2500; val_optim_loss: 4827192.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9332; val_auprc_score: 0.9686; val_best_acc_score: 0.9185; val_best_f1_score: 0.9477; train_kl_reg_loss: 15203.6207; train_edge_recon_loss: 1363558.9500; train_cat_covariates_contrastive_loss: 632595.5375; train_gene_expr_recon_loss: 2835625.0333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4846983.0667; train_optim_loss: 4846983.0667; val_kl_reg_loss: 15294.3062; val_edge_recon_loss: 1356119.4375; val_cat_covariates_contrastive_loss: 631797.5000; val_gene_expr_recon_loss: 2842611.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4845822.2500; val_optim_loss: 4845822.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9351; val_auprc_score: 0.9698; val_best_acc_score: 0.9220; val_best_f1_score: 0.9499; train_kl_reg_loss: 14911.5820; train_edge_recon_loss: 1346273.3000; train_cat_covariates_contrastive_loss: 633174.0750; train_gene_expr_recon_loss: 2825886.0500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4820244.9667; train_optim_loss: 4820244.9667; val_kl_reg_loss: 14837.0913; val_edge_recon_loss: 1336375.3750; val_cat_covariates_contrastive_loss: 631752.7812; val_gene_expr_recon_loss: 2828346.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4811311.7500; val_optim_loss: 4811311.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9355; val_auprc_score: 0.9696; val_best_acc_score: 0.9260; val_best_f1_score: 0.9522; train_kl_reg_loss: 14669.3339; train_edge_recon_loss: 1347502.7333; train_cat_covariates_contrastive_loss: 633873.6333; train_gene_expr_recon_loss: 2817213.1167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4813258.7667; train_optim_loss: 4813258.7667; val_kl_reg_loss: 14799.1455; val_edge_recon_loss: 1341444.1875; val_cat_covariates_contrastive_loss: 632259.0000; val_gene_expr_recon_loss: 2818638.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4807140.2500; val_optim_loss: 4807140.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9384; val_auprc_score: 0.9708; val_best_acc_score: 0.9246; val_best_f1_score: 0.9515; train_kl_reg_loss: 14602.7743; train_edge_recon_loss: 1338052.1250; train_cat_covariates_contrastive_loss: 633883.7500; train_gene_expr_recon_loss: 2810280.1000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4796818.7000; train_optim_loss: 4796818.7000; val_kl_reg_loss: 14681.0244; val_edge_recon_loss: 1339567.7500; val_cat_covariates_contrastive_loss: 632913.1562; val_gene_expr_recon_loss: 2827913.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4815075.2500; val_optim_loss: 4815075.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9362; val_auprc_score: 0.9687; val_best_acc_score: 0.9219; val_best_f1_score: 0.9499; train_kl_reg_loss: 14311.4551; train_edge_recon_loss: 1342127.5500; train_cat_covariates_contrastive_loss: 634423.0917; train_gene_expr_recon_loss: 2802975.2667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4793837.4000; train_optim_loss: 4793837.4000; val_kl_reg_loss: 14236.9810; val_edge_recon_loss: 1340661.8750; val_cat_covariates_contrastive_loss: 632737.0000; val_gene_expr_recon_loss: 2803194.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4790830.5000; val_optim_loss: 4790830.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9390; val_auprc_score: 0.9709; val_best_acc_score: 0.9240; val_best_f1_score: 0.9513; train_kl_reg_loss: 14007.0181; train_edge_recon_loss: 1332237.8000; train_cat_covariates_contrastive_loss: 634365.7417; train_gene_expr_recon_loss: 2800391.2667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4781001.8000; train_optim_loss: 4781001.8000; val_kl_reg_loss: 14183.8828; val_edge_recon_loss: 1321096.5000; val_cat_covariates_contrastive_loss: 634354.8438; val_gene_expr_recon_loss: 2805148.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4774783.5000; val_optim_loss: 4774783.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9425; val_auprc_score: 0.9727; val_best_acc_score: 0.9258; val_best_f1_score: 0.9522; train_kl_reg_loss: 13952.2770; train_edge_recon_loss: 1340178.8583; train_cat_covariates_contrastive_loss: 634390.1792; train_gene_expr_recon_loss: 2793438.6500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4781959.9333; train_optim_loss: 4781959.9333; val_kl_reg_loss: 13696.3438; val_edge_recon_loss: 1340661.3750; val_cat_covariates_contrastive_loss: 633061.9375; val_gene_expr_recon_loss: 2804480.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4791900.5000; val_optim_loss: 4791900.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9411; val_auprc_score: 0.9728; val_best_acc_score: 0.9259; val_best_f1_score: 0.9523; train_kl_reg_loss: 13717.1183; train_edge_recon_loss: 1336967.2667; train_cat_covariates_contrastive_loss: 634503.2250; train_gene_expr_recon_loss: 2783320.6500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4768508.1667; train_optim_loss: 4768508.1667; val_kl_reg_loss: 13575.0098; val_edge_recon_loss: 1328423.5625; val_cat_covariates_contrastive_loss: 632679.3125; val_gene_expr_recon_loss: 2795890.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4770568.0000; val_optim_loss: 4770568.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9424; val_auprc_score: 0.9723; val_best_acc_score: 0.9271; val_best_f1_score: 0.9532; train_kl_reg_loss: 13558.3694; train_edge_recon_loss: 1337529.1833; train_cat_covariates_contrastive_loss: 634119.7417; train_gene_expr_recon_loss: 2785618.2833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4770825.6000; train_optim_loss: 4770825.6000; val_kl_reg_loss: 13486.2383; val_edge_recon_loss: 1330541.5000; val_cat_covariates_contrastive_loss: 633607.3750; val_gene_expr_recon_loss: 2785492.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4763127.2500; val_optim_loss: 4763127.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9436; val_auprc_score: 0.9725; val_best_acc_score: 0.9299; val_best_f1_score: 0.9551; train_kl_reg_loss: 13205.1191; train_edge_recon_loss: 1337205.4833; train_cat_covariates_contrastive_loss: 634651.5958; train_gene_expr_recon_loss: 2772200.0333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4757262.2000; train_optim_loss: 4757262.2000; val_kl_reg_loss: 13240.0889; val_edge_recon_loss: 1306893.5000; val_cat_covariates_contrastive_loss: 633490.0625; val_gene_expr_recon_loss: 2775251.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4728874.7500; val_optim_loss: 4728874.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9365; val_auprc_score: 0.9689; val_best_acc_score: 0.9243; val_best_f1_score: 0.9515; train_kl_reg_loss: 13055.6945; train_edge_recon_loss: 1320134.8333; train_cat_covariates_contrastive_loss: 634796.2542; train_gene_expr_recon_loss: 2770431.3833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4738418.1333; train_optim_loss: 4738418.1333; val_kl_reg_loss: 13316.8516; val_edge_recon_loss: 1338260.7500; val_cat_covariates_contrastive_loss: 633452.0625; val_gene_expr_recon_loss: 2772863.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4757892.7500; val_optim_loss: 4757892.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9397; val_auprc_score: 0.9720; val_best_acc_score: 0.9251; val_best_f1_score: 0.9519; train_kl_reg_loss: 12951.8068; train_edge_recon_loss: 1331510.2667; train_cat_covariates_contrastive_loss: 634546.6708; train_gene_expr_recon_loss: 2765046.7167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4744055.4333; train_optim_loss: 4744055.4333; val_kl_reg_loss: 13057.1997; val_edge_recon_loss: 1337119.3125; val_cat_covariates_contrastive_loss: 633820.3438; val_gene_expr_recon_loss: 2772037.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4756034.2500; val_optim_loss: 4756034.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9369; val_auprc_score: 0.9693; val_best_acc_score: 0.9236; val_best_f1_score: 0.9510; train_kl_reg_loss: 12812.5548; train_edge_recon_loss: 1334271.8250; train_cat_covariates_contrastive_loss: 634761.3167; train_gene_expr_recon_loss: 2758007.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4739852.8667; train_optim_loss: 4739852.8667; val_kl_reg_loss: 12851.3784; val_edge_recon_loss: 1326535.7500; val_cat_covariates_contrastive_loss: 633058.4688; val_gene_expr_recon_loss: 2764339.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4736785.0000; val_optim_loss: 4736785.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9427; val_auprc_score: 0.9720; val_best_acc_score: 0.9288; val_best_f1_score: 0.9542; train_kl_reg_loss: 12721.8009; train_edge_recon_loss: 1318612.2250; train_cat_covariates_contrastive_loss: 634644.6833; train_gene_expr_recon_loss: 2754692.9333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4720671.6667; train_optim_loss: 4720671.6667; val_kl_reg_loss: 12443.7295; val_edge_recon_loss: 1320154.7500; val_cat_covariates_contrastive_loss: 633323.3125; val_gene_expr_recon_loss: 2768535.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4734457.5000; val_optim_loss: 4734457.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9440; val_auprc_score: 0.9741; val_best_acc_score: 0.9277; val_best_f1_score: 0.9535; train_kl_reg_loss: 12518.7069; train_edge_recon_loss: 1332985.1000; train_cat_covariates_contrastive_loss: 634684.4708; train_gene_expr_recon_loss: 2753206.3833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4733394.6333; train_optim_loss: 4733394.6333; val_kl_reg_loss: 12655.4263; val_edge_recon_loss: 1327742.2500; val_cat_covariates_contrastive_loss: 634489.7812; val_gene_expr_recon_loss: 2764789.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4739676.7500; val_optim_loss: 4739676.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9429; val_auprc_score: 0.9726; val_best_acc_score: 0.9266; val_best_f1_score: 0.9528; train_kl_reg_loss: 12525.5314; train_edge_recon_loss: 1336407.6000; train_cat_covariates_contrastive_loss: 634734.5417; train_gene_expr_recon_loss: 2753321.4667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4736989.1667; train_optim_loss: 4736989.1667; val_kl_reg_loss: 12596.2871; val_edge_recon_loss: 1327791.3125; val_cat_covariates_contrastive_loss: 633614.3125; val_gene_expr_recon_loss: 2746661.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4720663.0000; val_optim_loss: 4720663.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9440; val_auprc_score: 0.9741; val_best_acc_score: 0.9264; val_best_f1_score: 0.9528; train_kl_reg_loss: 12594.8273; train_edge_recon_loss: 1324454.0417; train_cat_covariates_contrastive_loss: 634964.2750; train_gene_expr_recon_loss: 2751961.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4723975.0000; train_optim_loss: 4723975.0000; val_kl_reg_loss: 12621.0059; val_edge_recon_loss: 1314433.4375; val_cat_covariates_contrastive_loss: 633764.6562; val_gene_expr_recon_loss: 2765246.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4726065.7500; val_optim_loss: 4726065.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9465; val_auprc_score: 0.9750; val_best_acc_score: 0.9300; val_best_f1_score: 0.9551; train_kl_reg_loss: 12553.2939; train_edge_recon_loss: 1322547.4667; train_cat_covariates_contrastive_loss: 634871.0542; train_gene_expr_recon_loss: 2751702.6333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4721674.5333; train_optim_loss: 4721674.5333; val_kl_reg_loss: 12636.9346; val_edge_recon_loss: 1306651.5000; val_cat_covariates_contrastive_loss: 634178.3438; val_gene_expr_recon_loss: 2763683.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4717150.0000; val_optim_loss: 4717150.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9403; val_auprc_score: 0.9711; val_best_acc_score: 0.9290; val_best_f1_score: 0.9544; train_kl_reg_loss: 12554.2613; train_edge_recon_loss: 1323869.4000; train_cat_covariates_contrastive_loss: 635026.3167; train_gene_expr_recon_loss: 2749613.3000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4721063.3000; train_optim_loss: 4721063.3000; val_kl_reg_loss: 12617.1978; val_edge_recon_loss: 1316262.3750; val_cat_covariates_contrastive_loss: 632843.3750; val_gene_expr_recon_loss: 2752835.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4714558.5000; val_optim_loss: 4714558.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9435; val_auprc_score: 0.9745; val_best_acc_score: 0.9280; val_best_f1_score: 0.9539; train_kl_reg_loss: 12544.3057; train_edge_recon_loss: 1327950.6333; train_cat_covariates_contrastive_loss: 635021.1292; train_gene_expr_recon_loss: 2751310.4500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4726826.5667; train_optim_loss: 4726826.5667; val_kl_reg_loss: 12546.1250; val_edge_recon_loss: 1295602.3750; val_cat_covariates_contrastive_loss: 633140.8125; val_gene_expr_recon_loss: 2765338.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4706628.2500; val_optim_loss: 4706628.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9414; val_auprc_score: 0.9711; val_best_acc_score: 0.9265; val_best_f1_score: 0.9525; train_kl_reg_loss: 12529.3130; train_edge_recon_loss: 1324861.5667; train_cat_covariates_contrastive_loss: 634977.0833; train_gene_expr_recon_loss: 2753177.4333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4725545.4667; train_optim_loss: 4725545.4667; val_kl_reg_loss: 12673.2646; val_edge_recon_loss: 1343341.7500; val_cat_covariates_contrastive_loss: 633954.1562; val_gene_expr_recon_loss: 2755920.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4745890.0000; val_optim_loss: 4745890.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9457; val_auprc_score: 0.9737; val_best_acc_score: 0.9285; val_best_f1_score: 0.9540; train_kl_reg_loss: 12510.1495; train_edge_recon_loss: 1331537.0417; train_cat_covariates_contrastive_loss: 635098.9625; train_gene_expr_recon_loss: 2746619.1333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4725765.2333; train_optim_loss: 4725765.2333; val_kl_reg_loss: 12438.4219; val_edge_recon_loss: 1335577.4375; val_cat_covariates_contrastive_loss: 634231.8750; val_gene_expr_recon_loss: 2769235.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4751483.0000; val_optim_loss: 4751483.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9452; val_auprc_score: 0.9733; val_best_acc_score: 0.9287; val_best_f1_score: 0.9540; train_kl_reg_loss: 12467.1271; train_edge_recon_loss: 1332180.5167; train_cat_covariates_contrastive_loss: 635037.9583; train_gene_expr_recon_loss: 2746436.5500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4726122.1667; train_optim_loss: 4726122.1667; val_kl_reg_loss: 12517.5630; val_edge_recon_loss: 1331692.0625; val_cat_covariates_contrastive_loss: 634306.8750; val_gene_expr_recon_loss: 2756163.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4734680.0000; val_optim_loss: 4734680.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9417; val_auprc_score: 0.9711; val_best_acc_score: 0.9263; val_best_f1_score: 0.9527; train_kl_reg_loss: 12458.3513; train_edge_recon_loss: 1327161.4333; train_cat_covariates_contrastive_loss: 634721.1458; train_gene_expr_recon_loss: 2747999.8500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4722340.8000; train_optim_loss: 4722340.8000; val_kl_reg_loss: 12540.2676; val_edge_recon_loss: 1331067.9375; val_cat_covariates_contrastive_loss: 633510.8438; val_gene_expr_recon_loss: 2760118.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4737237.7500; val_optim_loss: 4737237.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9423; val_auprc_score: 0.9729; val_best_acc_score: 0.9300; val_best_f1_score: 0.9555; train_kl_reg_loss: 12495.2604; train_edge_recon_loss: 1333898.4250; train_cat_covariates_contrastive_loss: 634804.1542; train_gene_expr_recon_loss: 2746474.1000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4727671.9333; train_optim_loss: 4727671.9333; val_kl_reg_loss: 12499.5137; val_edge_recon_loss: 1288007.1875; val_cat_covariates_contrastive_loss: 633149.2812; val_gene_expr_recon_loss: 2754265.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4687921.2500; val_optim_loss: 4687921.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9407; val_auprc_score: 0.9712; val_best_acc_score: 0.9255; val_best_f1_score: 0.9521; train_kl_reg_loss: 12479.9260; train_edge_recon_loss: 1330911.2333; train_cat_covariates_contrastive_loss: 634881.8708; train_gene_expr_recon_loss: 2747655.8500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4725928.8667; train_optim_loss: 4725928.8667; val_kl_reg_loss: 12524.5430; val_edge_recon_loss: 1345853.6250; val_cat_covariates_contrastive_loss: 634091.0938; val_gene_expr_recon_loss: 2751327.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4743796.5000; val_optim_loss: 4743796.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9403; val_auprc_score: 0.9706; val_best_acc_score: 0.9263; val_best_f1_score: 0.9527; train_kl_reg_loss: 12467.7267; train_edge_recon_loss: 1327387.1083; train_cat_covariates_contrastive_loss: 634682.2750; train_gene_expr_recon_loss: 2745783.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4720320.8000; train_optim_loss: 4720320.8000; val_kl_reg_loss: 12520.9551; val_edge_recon_loss: 1342887.7500; val_cat_covariates_contrastive_loss: 633815.0312; val_gene_expr_recon_loss: 2761235.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4750459.5000; val_optim_loss: 4750459.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9450; val_auprc_score: 0.9746; val_best_acc_score: 0.9275; val_best_f1_score: 0.9533; train_kl_reg_loss: 12470.7617; train_edge_recon_loss: 1317107.4917; train_cat_covariates_contrastive_loss: 634785.1083; train_gene_expr_recon_loss: 2749363.4500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4713726.8667; train_optim_loss: 4713726.8667; val_kl_reg_loss: 12530.3926; val_edge_recon_loss: 1323138.4375; val_cat_covariates_contrastive_loss: 633300.8125; val_gene_expr_recon_loss: 2755723.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4724692.5000; val_optim_loss: 4724692.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9431; val_auprc_score: 0.9725; val_best_acc_score: 0.9262; val_best_f1_score: 0.9528; train_kl_reg_loss: 12475.3352; train_edge_recon_loss: 1326433.3000; train_cat_covariates_contrastive_loss: 634567.5500; train_gene_expr_recon_loss: 2745690.6833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4719166.9000; train_optim_loss: 4719166.9000; val_kl_reg_loss: 12522.2939; val_edge_recon_loss: 1328959.5625; val_cat_covariates_contrastive_loss: 634159.3438; val_gene_expr_recon_loss: 2771267.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4746908.5000; val_optim_loss: 4746908.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9447; val_auprc_score: 0.9739; val_best_acc_score: 0.9286; val_best_f1_score: 0.9541; train_kl_reg_loss: 12478.3733; train_edge_recon_loss: 1335234.9667; train_cat_covariates_contrastive_loss: 634232.4333; train_gene_expr_recon_loss: 2746854.0333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4728799.8333; train_optim_loss: 4728799.8333; val_kl_reg_loss: 12499.8662; val_edge_recon_loss: 1336752.7500; val_cat_covariates_contrastive_loss: 634406.2812; val_gene_expr_recon_loss: 2761096.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4744756.0000; val_optim_loss: 4744756.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9426; val_auprc_score: 0.9726; val_best_acc_score: 0.9266; val_best_f1_score: 0.9529; train_kl_reg_loss: 12457.7447; train_edge_recon_loss: 1325316.4833; train_cat_covariates_contrastive_loss: 634665.3125; train_gene_expr_recon_loss: 2746605.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4719044.9667; train_optim_loss: 4719044.9667; val_kl_reg_loss: 12509.9443; val_edge_recon_loss: 1340271.8125; val_cat_covariates_contrastive_loss: 633612.0000; val_gene_expr_recon_loss: 2753646.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4740040.5000; val_optim_loss: 4740040.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9463; val_auprc_score: 0.9738; val_best_acc_score: 0.9268; val_best_f1_score: 0.9529; train_kl_reg_loss: 12462.3143; train_edge_recon_loss: 1333801.0167; train_cat_covariates_contrastive_loss: 634588.5000; train_gene_expr_recon_loss: 2746975.4833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4727827.3333; train_optim_loss: 4727827.3333; val_kl_reg_loss: 12509.7808; val_edge_recon_loss: 1345326.5000; val_cat_covariates_contrastive_loss: 634118.0312; val_gene_expr_recon_loss: 2755468.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4747423.0000; val_optim_loss: 4747423.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9444; val_auprc_score: 0.9730; val_best_acc_score: 0.9299; val_best_f1_score: 0.9546; train_kl_reg_loss: 12465.9059; train_edge_recon_loss: 1338006.7417; train_cat_covariates_contrastive_loss: 634827.0875; train_gene_expr_recon_loss: 2747361.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4732661.4667; train_optim_loss: 4732661.4667; val_kl_reg_loss: 12475.0112; val_edge_recon_loss: 1334571.0625; val_cat_covariates_contrastive_loss: 633584.8750; val_gene_expr_recon_loss: 2746723.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4727354.7500; val_optim_loss: 4727354.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 40 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
val AUROC score: 0.9340
val AUPRC score: 0.9670
val best accuracy score: 0.9225
val best F1 score: 0.9500
val target rna MSE score: 0.9338
val source rna MSE score: 0.1583
Val cat covariate0 mean sim diff: -0.0051
Val cat covariate1 mean sim diff: -0.1074
Duration of model training in run 8: 0 hours, 6 minutes and 52 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 12706
Number of validation nodes: 1412
Number of training edges: 116179
Number of validation edges: 12908
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9642; val_auprc_score: 0.9861; val_best_acc_score: 0.8218; val_best_f1_score: 0.8936; train_kl_reg_loss: 2399.7710; train_edge_recon_loss: 1849231.9417; train_cat_covariates_contrastive_loss: 814203.3500; train_gene_expr_recon_loss: 3919297.9833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6585133.0000; train_optim_loss: 6585133.0000; val_kl_reg_loss: 2388.1571; val_edge_recon_loss: 2048975.5625; val_cat_covariates_contrastive_loss: 627036.0625; val_gene_expr_recon_loss: 3627554.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6305954.2500; val_optim_loss: 6305954.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8818; val_auprc_score: 0.9539; val_best_acc_score: 0.8374; val_best_f1_score: 0.8993; train_kl_reg_loss: 2373.5477; train_edge_recon_loss: 1807029.4750; train_cat_covariates_contrastive_loss: 688091.1542; train_gene_expr_recon_loss: 3605018.7000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6102512.9000; train_optim_loss: 6102512.9000; val_kl_reg_loss: 2831.4205; val_edge_recon_loss: 1975675.7500; val_cat_covariates_contrastive_loss: 627406.1875; val_gene_expr_recon_loss: 3452114.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6058028.0000; val_optim_loss: 6058028.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8614; val_auprc_score: 0.9423; val_best_acc_score: 0.8408; val_best_f1_score: 0.9020; train_kl_reg_loss: 4606.4358; train_edge_recon_loss: 1718804.6417; train_cat_covariates_contrastive_loss: 667131.7250; train_gene_expr_recon_loss: 3405840.8833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5796383.6000; train_optim_loss: 5796383.6000; val_kl_reg_loss: 6375.2529; val_edge_recon_loss: 1711098.0625; val_cat_covariates_contrastive_loss: 627765.7500; val_gene_expr_recon_loss: 3265857.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5611096.5000; val_optim_loss: 5611096.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8440; val_auprc_score: 0.9313; val_best_acc_score: 0.8336; val_best_f1_score: 0.8964; train_kl_reg_loss: 11252.2218; train_edge_recon_loss: 1594538.1417; train_cat_covariates_contrastive_loss: 645706.7917; train_gene_expr_recon_loss: 3257644.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5509141.7000; train_optim_loss: 5509141.7000; val_kl_reg_loss: 16182.7070; val_edge_recon_loss: 1563142.7500; val_cat_covariates_contrastive_loss: 627456.0938; val_gene_expr_recon_loss: 3161867.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5368649.5000; val_optim_loss: 5368649.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8569; val_auprc_score: 0.9398; val_best_acc_score: 0.8455; val_best_f1_score: 0.9040; train_kl_reg_loss: 21654.8932; train_edge_recon_loss: 1507016.8833; train_cat_covariates_contrastive_loss: 629119.0083; train_gene_expr_recon_loss: 3161133.8667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5318924.6667; train_optim_loss: 5318924.6667; val_kl_reg_loss: 22519.9102; val_edge_recon_loss: 1482132.5000; val_cat_covariates_contrastive_loss: 627061.3125; val_gene_expr_recon_loss: 3085455.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5217169.0000; val_optim_loss: 5217169.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8747; val_auprc_score: 0.9477; val_best_acc_score: 0.8549; val_best_f1_score: 0.9099; train_kl_reg_loss: 24256.5658; train_edge_recon_loss: 1470530.7583; train_cat_covariates_contrastive_loss: 628102.1000; train_gene_expr_recon_loss: 3083174.3833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5206063.8000; train_optim_loss: 5206063.8000; val_kl_reg_loss: 22085.5664; val_edge_recon_loss: 1449421.1250; val_cat_covariates_contrastive_loss: 627315.4688; val_gene_expr_recon_loss: 3006699.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5105522.0000; val_optim_loss: 5105522.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8883; val_auprc_score: 0.9522; val_best_acc_score: 0.8697; val_best_f1_score: 0.9176; train_kl_reg_loss: 22619.1072; train_edge_recon_loss: 1445175.6833; train_cat_covariates_contrastive_loss: 629146.2250; train_gene_expr_recon_loss: 3026302.6500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5123243.7000; train_optim_loss: 5123243.7000; val_kl_reg_loss: 19747.2803; val_edge_recon_loss: 1407544.5000; val_cat_covariates_contrastive_loss: 627542.5625; val_gene_expr_recon_loss: 2970720.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5025555.0000; val_optim_loss: 5025555.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9033; val_auprc_score: 0.9544; val_best_acc_score: 0.8947; val_best_f1_score: 0.9323; train_kl_reg_loss: 19520.8023; train_edge_recon_loss: 1420053.6500; train_cat_covariates_contrastive_loss: 630839.5333; train_gene_expr_recon_loss: 2980060.8667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5050474.8667; train_optim_loss: 5050474.8667; val_kl_reg_loss: 18312.4443; val_edge_recon_loss: 1398794.5000; val_cat_covariates_contrastive_loss: 628399.9688; val_gene_expr_recon_loss: 2924751.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4970258.5000; val_optim_loss: 4970258.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9155; val_auprc_score: 0.9607; val_best_acc_score: 0.8982; val_best_f1_score: 0.9350; train_kl_reg_loss: 20036.5822; train_edge_recon_loss: 1382845.6750; train_cat_covariates_contrastive_loss: 630427.7583; train_gene_expr_recon_loss: 2950996.8667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4984306.8667; train_optim_loss: 4984306.8667; val_kl_reg_loss: 20233.7402; val_edge_recon_loss: 1404416.1250; val_cat_covariates_contrastive_loss: 628716.0312; val_gene_expr_recon_loss: 2901907.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4955273.7500; val_optim_loss: 4955273.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9155; val_auprc_score: 0.9616; val_best_acc_score: 0.8996; val_best_f1_score: 0.9360; train_kl_reg_loss: 20102.8150; train_edge_recon_loss: 1380769.3750; train_cat_covariates_contrastive_loss: 630553.1000; train_gene_expr_recon_loss: 2925888.8167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4957314.1000; train_optim_loss: 4957314.1000; val_kl_reg_loss: 18925.2295; val_edge_recon_loss: 1372904.4375; val_cat_covariates_contrastive_loss: 628858.1875; val_gene_expr_recon_loss: 2870234.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4890922.5000; val_optim_loss: 4890922.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9196; val_auprc_score: 0.9626; val_best_acc_score: 0.9016; val_best_f1_score: 0.9371; train_kl_reg_loss: 19106.6919; train_edge_recon_loss: 1372398.1333; train_cat_covariates_contrastive_loss: 630607.0750; train_gene_expr_recon_loss: 2905215.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4927327.4000; train_optim_loss: 4927327.4000; val_kl_reg_loss: 18557.9014; val_edge_recon_loss: 1376092.9375; val_cat_covariates_contrastive_loss: 629045.2500; val_gene_expr_recon_loss: 2857704.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4881400.2500; val_optim_loss: 4881400.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9192; val_auprc_score: 0.9607; val_best_acc_score: 0.9030; val_best_f1_score: 0.9382; train_kl_reg_loss: 18848.7431; train_edge_recon_loss: 1377629.5667; train_cat_covariates_contrastive_loss: 630591.8583; train_gene_expr_recon_loss: 2885871.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4912941.3667; train_optim_loss: 4912941.3667; val_kl_reg_loss: 18402.4365; val_edge_recon_loss: 1367037.4375; val_cat_covariates_contrastive_loss: 629397.2188; val_gene_expr_recon_loss: 2842307.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4857144.7500; val_optim_loss: 4857144.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9241; val_auprc_score: 0.9653; val_best_acc_score: 0.9060; val_best_f1_score: 0.9398; train_kl_reg_loss: 18187.0000; train_edge_recon_loss: 1372664.4667; train_cat_covariates_contrastive_loss: 630763.8125; train_gene_expr_recon_loss: 2874665.5500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4896280.8000; train_optim_loss: 4896280.8000; val_kl_reg_loss: 17217.2168; val_edge_recon_loss: 1358400.0625; val_cat_covariates_contrastive_loss: 629387.9688; val_gene_expr_recon_loss: 2839252.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4844257.5000; val_optim_loss: 4844257.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9291; val_auprc_score: 0.9664; val_best_acc_score: 0.9132; val_best_f1_score: 0.9444; train_kl_reg_loss: 17330.7134; train_edge_recon_loss: 1362195.1500; train_cat_covariates_contrastive_loss: 631056.1375; train_gene_expr_recon_loss: 2865231.0500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4875813.0000; train_optim_loss: 4875813.0000; val_kl_reg_loss: 16480.7881; val_edge_recon_loss: 1371452.7500; val_cat_covariates_contrastive_loss: 629649.1562; val_gene_expr_recon_loss: 2822562.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4840144.7500; val_optim_loss: 4840144.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9320; val_auprc_score: 0.9680; val_best_acc_score: 0.9166; val_best_f1_score: 0.9464; train_kl_reg_loss: 16498.0922; train_edge_recon_loss: 1356629.0583; train_cat_covariates_contrastive_loss: 631460.1042; train_gene_expr_recon_loss: 2857291.0333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4861878.2667; train_optim_loss: 4861878.2667; val_kl_reg_loss: 15955.9502; val_edge_recon_loss: 1360951.1250; val_cat_covariates_contrastive_loss: 630452.1250; val_gene_expr_recon_loss: 2810186.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4817545.7500; val_optim_loss: 4817545.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9342; val_auprc_score: 0.9694; val_best_acc_score: 0.9166; val_best_f1_score: 0.9463; train_kl_reg_loss: 16068.2981; train_edge_recon_loss: 1357463.7583; train_cat_covariates_contrastive_loss: 632079.2833; train_gene_expr_recon_loss: 2845996.5333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4851607.7667; train_optim_loss: 4851607.7667; val_kl_reg_loss: 15599.6499; val_edge_recon_loss: 1363546.1875; val_cat_covariates_contrastive_loss: 631239.0625; val_gene_expr_recon_loss: 2800250.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4810635.0000; val_optim_loss: 4810635.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9351; val_auprc_score: 0.9700; val_best_acc_score: 0.9220; val_best_f1_score: 0.9501; train_kl_reg_loss: 15768.3883; train_edge_recon_loss: 1347114.5250; train_cat_covariates_contrastive_loss: 632596.3750; train_gene_expr_recon_loss: 2840181.7667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4835661.0000; train_optim_loss: 4835661.0000; val_kl_reg_loss: 15300.8159; val_edge_recon_loss: 1320898.9375; val_cat_covariates_contrastive_loss: 631639.7500; val_gene_expr_recon_loss: 2794346.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4762185.5000; val_optim_loss: 4762185.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9344; val_auprc_score: 0.9688; val_best_acc_score: 0.9204; val_best_f1_score: 0.9487; train_kl_reg_loss: 15552.9083; train_edge_recon_loss: 1352750.4000; train_cat_covariates_contrastive_loss: 633059.3250; train_gene_expr_recon_loss: 2834291.1000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4835653.7333; train_optim_loss: 4835653.7333; val_kl_reg_loss: 15015.4238; val_edge_recon_loss: 1342172.3125; val_cat_covariates_contrastive_loss: 631811.6562; val_gene_expr_recon_loss: 2790335.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4779335.2500; val_optim_loss: 4779335.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9381; val_auprc_score: 0.9720; val_best_acc_score: 0.9230; val_best_f1_score: 0.9506; train_kl_reg_loss: 15250.1902; train_edge_recon_loss: 1350619.2500; train_cat_covariates_contrastive_loss: 633700.0333; train_gene_expr_recon_loss: 2826884.3167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4826453.8000; train_optim_loss: 4826453.8000; val_kl_reg_loss: 15074.8618; val_edge_recon_loss: 1341637.1250; val_cat_covariates_contrastive_loss: 632680.1875; val_gene_expr_recon_loss: 2789782.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4779174.7500; val_optim_loss: 4779174.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9365; val_auprc_score: 0.9702; val_best_acc_score: 0.9232; val_best_f1_score: 0.9507; train_kl_reg_loss: 15125.2633; train_edge_recon_loss: 1349693.2583; train_cat_covariates_contrastive_loss: 633847.8375; train_gene_expr_recon_loss: 2816214.3000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4814880.7000; train_optim_loss: 4814880.7000; val_kl_reg_loss: 14608.4507; val_edge_recon_loss: 1339682.5625; val_cat_covariates_contrastive_loss: 632235.0938; val_gene_expr_recon_loss: 2798343.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4784869.2500; val_optim_loss: 4784869.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9352; val_auprc_score: 0.9678; val_best_acc_score: 0.9228; val_best_f1_score: 0.9505; train_kl_reg_loss: 14787.7029; train_edge_recon_loss: 1337560.9833; train_cat_covariates_contrastive_loss: 633698.2667; train_gene_expr_recon_loss: 2812041.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4798088.7000; train_optim_loss: 4798088.7000; val_kl_reg_loss: 14427.6670; val_edge_recon_loss: 1347063.3750; val_cat_covariates_contrastive_loss: 632481.4062; val_gene_expr_recon_loss: 2775929.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4769901.7500; val_optim_loss: 4769901.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9386; val_auprc_score: 0.9725; val_best_acc_score: 0.9231; val_best_f1_score: 0.9506; train_kl_reg_loss: 14628.0377; train_edge_recon_loss: 1337861.0000; train_cat_covariates_contrastive_loss: 633783.3208; train_gene_expr_recon_loss: 2811064.8833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4797337.1667; train_optim_loss: 4797337.1667; val_kl_reg_loss: 14401.3037; val_edge_recon_loss: 1343099.1250; val_cat_covariates_contrastive_loss: 633040.6250; val_gene_expr_recon_loss: 2765917.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4756458.0000; val_optim_loss: 4756458.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9394; val_auprc_score: 0.9729; val_best_acc_score: 0.9234; val_best_f1_score: 0.9508; train_kl_reg_loss: 14646.3629; train_edge_recon_loss: 1335366.8667; train_cat_covariates_contrastive_loss: 634189.9500; train_gene_expr_recon_loss: 2810123.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4794327.0667; train_optim_loss: 4794327.0667; val_kl_reg_loss: 14419.5552; val_edge_recon_loss: 1326829.3125; val_cat_covariates_contrastive_loss: 633246.1250; val_gene_expr_recon_loss: 2775719.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4750214.5000; val_optim_loss: 4750214.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9408; val_auprc_score: 0.9723; val_best_acc_score: 0.9245; val_best_f1_score: 0.9516; train_kl_reg_loss: 14659.8906; train_edge_recon_loss: 1347734.5000; train_cat_covariates_contrastive_loss: 634034.5167; train_gene_expr_recon_loss: 2805247.6333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4801676.6333; train_optim_loss: 4801676.6333; val_kl_reg_loss: 14406.4258; val_edge_recon_loss: 1322835.3750; val_cat_covariates_contrastive_loss: 632673.0625; val_gene_expr_recon_loss: 2769952.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4739867.2500; val_optim_loss: 4739867.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9375; val_auprc_score: 0.9703; val_best_acc_score: 0.9247; val_best_f1_score: 0.9516; train_kl_reg_loss: 14618.5312; train_edge_recon_loss: 1329077.5000; train_cat_covariates_contrastive_loss: 633747.6542; train_gene_expr_recon_loss: 2805757.2833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4783200.9667; train_optim_loss: 4783200.9667; val_kl_reg_loss: 14482.7339; val_edge_recon_loss: 1329248.5625; val_cat_covariates_contrastive_loss: 633324.4688; val_gene_expr_recon_loss: 2772367.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4749423.7500; val_optim_loss: 4749423.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9404; val_auprc_score: 0.9724; val_best_acc_score: 0.9263; val_best_f1_score: 0.9525; train_kl_reg_loss: 14642.4314; train_edge_recon_loss: 1329211.3917; train_cat_covariates_contrastive_loss: 634040.6583; train_gene_expr_recon_loss: 2810005.0167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4787899.4667; train_optim_loss: 4787899.4667; val_kl_reg_loss: 14377.6641; val_edge_recon_loss: 1316370.6875; val_cat_covariates_contrastive_loss: 632736.0312; val_gene_expr_recon_loss: 2782730.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4746215.2500; val_optim_loss: 4746215.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9361; val_auprc_score: 0.9700; val_best_acc_score: 0.9249; val_best_f1_score: 0.9520; train_kl_reg_loss: 14574.8965; train_edge_recon_loss: 1337572.5583; train_cat_covariates_contrastive_loss: 634298.1500; train_gene_expr_recon_loss: 2805682.3000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4792127.9333; train_optim_loss: 4792127.9333; val_kl_reg_loss: 14344.0361; val_edge_recon_loss: 1305708.7500; val_cat_covariates_contrastive_loss: 632103.6562; val_gene_expr_recon_loss: 2778398.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4730555.2500; val_optim_loss: 4730555.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9396; val_auprc_score: 0.9713; val_best_acc_score: 0.9248; val_best_f1_score: 0.9516; train_kl_reg_loss: 14571.9105; train_edge_recon_loss: 1341658.4667; train_cat_covariates_contrastive_loss: 634058.5625; train_gene_expr_recon_loss: 2806540.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4796829.4667; train_optim_loss: 4796829.4667; val_kl_reg_loss: 14279.8979; val_edge_recon_loss: 1327135.9375; val_cat_covariates_contrastive_loss: 633075.5938; val_gene_expr_recon_loss: 2777789.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4752281.5000; val_optim_loss: 4752281.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9434; val_auprc_score: 0.9734; val_best_acc_score: 0.9255; val_best_f1_score: 0.9519; train_kl_reg_loss: 14536.7949; train_edge_recon_loss: 1333443.4833; train_cat_covariates_contrastive_loss: 634067.8208; train_gene_expr_recon_loss: 2803265.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4785313.4333; train_optim_loss: 4785313.4333; val_kl_reg_loss: 14274.8696; val_edge_recon_loss: 1344607.1875; val_cat_covariates_contrastive_loss: 632897.2812; val_gene_expr_recon_loss: 2768450.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4760229.7500; val_optim_loss: 4760229.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9436; val_auprc_score: 0.9728; val_best_acc_score: 0.9258; val_best_f1_score: 0.9524; train_kl_reg_loss: 14504.9114; train_edge_recon_loss: 1331020.3083; train_cat_covariates_contrastive_loss: 633891.2042; train_gene_expr_recon_loss: 2803108.4500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4782524.8333; train_optim_loss: 4782524.8333; val_kl_reg_loss: 14184.3296; val_edge_recon_loss: 1317283.5000; val_cat_covariates_contrastive_loss: 633218.9688; val_gene_expr_recon_loss: 2758242.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4722929.5000; val_optim_loss: 4722929.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9388; val_auprc_score: 0.9708; val_best_acc_score: 0.9239; val_best_f1_score: 0.9511; train_kl_reg_loss: 14488.5327; train_edge_recon_loss: 1326812.7000; train_cat_covariates_contrastive_loss: 634285.6458; train_gene_expr_recon_loss: 2803723.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4779310.5667; train_optim_loss: 4779310.5667; val_kl_reg_loss: 14161.9951; val_edge_recon_loss: 1342758.1250; val_cat_covariates_contrastive_loss: 632776.6250; val_gene_expr_recon_loss: 2762965.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4752661.7500; val_optim_loss: 4752661.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9414; val_auprc_score: 0.9728; val_best_acc_score: 0.9272; val_best_f1_score: 0.9532; train_kl_reg_loss: 14444.8895; train_edge_recon_loss: 1342454.1167; train_cat_covariates_contrastive_loss: 633937.1750; train_gene_expr_recon_loss: 2801298.1333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4792134.3333; train_optim_loss: 4792134.3333; val_kl_reg_loss: 14164.1240; val_edge_recon_loss: 1318798.9375; val_cat_covariates_contrastive_loss: 633634.2188; val_gene_expr_recon_loss: 2757301.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4723898.5000; val_optim_loss: 4723898.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9382; val_auprc_score: 0.9720; val_best_acc_score: 0.9241; val_best_f1_score: 0.9515; train_kl_reg_loss: 14400.0694; train_edge_recon_loss: 1337443.7167; train_cat_covariates_contrastive_loss: 634210.8250; train_gene_expr_recon_loss: 2802227.4833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4788282.1667; train_optim_loss: 4788282.1667; val_kl_reg_loss: 14199.1704; val_edge_recon_loss: 1317328.0625; val_cat_covariates_contrastive_loss: 632772.4375; val_gene_expr_recon_loss: 2759872.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4724172.0000; val_optim_loss: 4724172.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9392; val_auprc_score: 0.9723; val_best_acc_score: 0.9248; val_best_f1_score: 0.9516; train_kl_reg_loss: 14415.6081; train_edge_recon_loss: 1344634.3750; train_cat_covariates_contrastive_loss: 634267.3083; train_gene_expr_recon_loss: 2799624.1833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4792941.5000; train_optim_loss: 4792941.5000; val_kl_reg_loss: 14133.9971; val_edge_recon_loss: 1350399.4375; val_cat_covariates_contrastive_loss: 633339.1250; val_gene_expr_recon_loss: 2764524.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4762397.0000; val_optim_loss: 4762397.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9402; val_auprc_score: 0.9713; val_best_acc_score: 0.9243; val_best_f1_score: 0.9512; train_kl_reg_loss: 14345.3477; train_edge_recon_loss: 1339540.8750; train_cat_covariates_contrastive_loss: 634346.0875; train_gene_expr_recon_loss: 2793285.4833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4781517.8000; train_optim_loss: 4781517.8000; val_kl_reg_loss: 14137.2280; val_edge_recon_loss: 1336394.2500; val_cat_covariates_contrastive_loss: 633442.5938; val_gene_expr_recon_loss: 2769586.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4753560.7500; val_optim_loss: 4753560.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9409; val_auprc_score: 0.9734; val_best_acc_score: 0.9232; val_best_f1_score: 0.9507; train_kl_reg_loss: 14351.0066; train_edge_recon_loss: 1338010.0083; train_cat_covariates_contrastive_loss: 634114.8083; train_gene_expr_recon_loss: 2798210.0667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4784685.9333; train_optim_loss: 4784685.9333; val_kl_reg_loss: 14149.4800; val_edge_recon_loss: 1329191.6250; val_cat_covariates_contrastive_loss: 633064.6250; val_gene_expr_recon_loss: 2774655.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4751061.5000; val_optim_loss: 4751061.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9390; val_auprc_score: 0.9710; val_best_acc_score: 0.9249; val_best_f1_score: 0.9518; train_kl_reg_loss: 14368.4983; train_edge_recon_loss: 1339361.0500; train_cat_covariates_contrastive_loss: 634264.5042; train_gene_expr_recon_loss: 2801474.6833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4789468.6333; train_optim_loss: 4789468.6333; val_kl_reg_loss: 14150.7769; val_edge_recon_loss: 1315253.9375; val_cat_covariates_contrastive_loss: 632758.3750; val_gene_expr_recon_loss: 2760825.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4722988.7500; val_optim_loss: 4722988.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9404; val_auprc_score: 0.9723; val_best_acc_score: 0.9234; val_best_f1_score: 0.9503; train_kl_reg_loss: 14366.6579; train_edge_recon_loss: 1338383.5250; train_cat_covariates_contrastive_loss: 634036.5125; train_gene_expr_recon_loss: 2796887.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4783673.8667; train_optim_loss: 4783673.8667; val_kl_reg_loss: 14121.4990; val_edge_recon_loss: 1360362.6250; val_cat_covariates_contrastive_loss: 632677.5625; val_gene_expr_recon_loss: 2763520.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4770682.0000; val_optim_loss: 4770682.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 14 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
val AUROC score: 0.9361
val AUPRC score: 0.9694
val best accuracy score: 0.9237
val best F1 score: 0.9514
val target rna MSE score: 0.9716
val source rna MSE score: 0.1567
Val cat covariate0 mean sim diff: -0.0018
Val cat covariate1 mean sim diff: -0.1195
Duration of model training in run 7: 0 hours, 5 minutes and 19 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 12706
Number of validation nodes: 1412
Number of training edges: 87817
Number of validation edges: 9757
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9610; val_auprc_score: 0.9864; val_best_acc_score: 0.8118; val_best_f1_score: 0.8892; train_kl_reg_loss: 2442.1885; train_edge_recon_loss: 1848796.0114; train_cat_covariates_contrastive_loss: 871612.3182; train_gene_expr_recon_loss: 4045974.2045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6768824.6818; train_optim_loss: 6768824.6818; val_kl_reg_loss: 5400.7583; val_edge_recon_loss: 2024240.6250; val_cat_covariates_contrastive_loss: 626843.8750; val_gene_expr_recon_loss: 3823513.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6479998.7500; val_optim_loss: 6479998.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9445; val_auprc_score: 0.9800; val_best_acc_score: 0.8445; val_best_f1_score: 0.9049; train_kl_reg_loss: 4040.1952; train_edge_recon_loss: 1936321.9773; train_cat_covariates_contrastive_loss: 661950.7784; train_gene_expr_recon_loss: 3729522.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6331835.3636; train_optim_loss: 6331835.3636; val_kl_reg_loss: 2305.2839; val_edge_recon_loss: 2015378.9375; val_cat_covariates_contrastive_loss: 627052.8750; val_gene_expr_recon_loss: 3614921.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6259659.0000; val_optim_loss: 6259659.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8925; val_auprc_score: 0.9549; val_best_acc_score: 0.8570; val_best_f1_score: 0.9090; train_kl_reg_loss: 2970.2849; train_edge_recon_loss: 1811003.0000; train_cat_covariates_contrastive_loss: 685838.3466; train_gene_expr_recon_loss: 3538895.2045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6038706.8182; train_optim_loss: 6038706.8182; val_kl_reg_loss: 3972.3965; val_edge_recon_loss: 1954510.5000; val_cat_covariates_contrastive_loss: 627485.0312; val_gene_expr_recon_loss: 3528075.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6114043.2500; val_optim_loss: 6114043.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8822; val_auprc_score: 0.9470; val_best_acc_score: 0.8628; val_best_f1_score: 0.9129; train_kl_reg_loss: 5750.5069; train_edge_recon_loss: 1707112.6477; train_cat_covariates_contrastive_loss: 664157.7670; train_gene_expr_recon_loss: 3403029.4091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5780050.3182; train_optim_loss: 5780050.3182; val_kl_reg_loss: 8479.5962; val_edge_recon_loss: 1751677.0625; val_cat_covariates_contrastive_loss: 628034.0938; val_gene_expr_recon_loss: 3404855.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5793045.7500; val_optim_loss: 5793045.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8671; val_auprc_score: 0.9413; val_best_acc_score: 0.8520; val_best_f1_score: 0.9065; train_kl_reg_loss: 10680.6034; train_edge_recon_loss: 1633885.0000; train_cat_covariates_contrastive_loss: 646032.4375; train_gene_expr_recon_loss: 3259220.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5549818.7727; train_optim_loss: 5549818.7727; val_kl_reg_loss: 17395.8125; val_edge_recon_loss: 1596069.7500; val_cat_covariates_contrastive_loss: 627764.4688; val_gene_expr_recon_loss: 3355295.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5596525.5000; val_optim_loss: 5596525.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8540; val_auprc_score: 0.9359; val_best_acc_score: 0.8493; val_best_f1_score: 0.9055; train_kl_reg_loss: 19956.1495; train_edge_recon_loss: 1558113.0568; train_cat_covariates_contrastive_loss: 633131.8352; train_gene_expr_recon_loss: 3165633.5682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5376834.6818; train_optim_loss: 5376834.6818; val_kl_reg_loss: 25036.3398; val_edge_recon_loss: 1525803.8125; val_cat_covariates_contrastive_loss: 627252.1250; val_gene_expr_recon_loss: 3169516.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5347608.5000; val_optim_loss: 5347608.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8633; val_auprc_score: 0.9397; val_best_acc_score: 0.8510; val_best_f1_score: 0.9070; train_kl_reg_loss: 27201.7131; train_edge_recon_loss: 1490090.8295; train_cat_covariates_contrastive_loss: 628481.8920; train_gene_expr_recon_loss: 3099277.3182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5245051.8182; train_optim_loss: 5245051.8182; val_kl_reg_loss: 26988.9502; val_edge_recon_loss: 1517313.4375; val_cat_covariates_contrastive_loss: 627387.6250; val_gene_expr_recon_loss: 3062525.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5234216.0000; val_optim_loss: 5234216.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8711; val_auprc_score: 0.9437; val_best_acc_score: 0.8585; val_best_f1_score: 0.9116; train_kl_reg_loss: 29197.1442; train_edge_recon_loss: 1468484.9773; train_cat_covariates_contrastive_loss: 628326.9091; train_gene_expr_recon_loss: 3042893.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5168902.0909; train_optim_loss: 5168902.0909; val_kl_reg_loss: 29562.0430; val_edge_recon_loss: 1438996.1875; val_cat_covariates_contrastive_loss: 627199.4062; val_gene_expr_recon_loss: 3080188.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5175946.2500; val_optim_loss: 5175946.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8824; val_auprc_score: 0.9479; val_best_acc_score: 0.8651; val_best_f1_score: 0.9154; train_kl_reg_loss: 27534.3439; train_edge_recon_loss: 1448209.7159; train_cat_covariates_contrastive_loss: 629084.1080; train_gene_expr_recon_loss: 2985747.7045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5090575.8182; train_optim_loss: 5090575.8182; val_kl_reg_loss: 27084.5811; val_edge_recon_loss: 1465863.1875; val_cat_covariates_contrastive_loss: 627520.4062; val_gene_expr_recon_loss: 2978560.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5099028.5000; val_optim_loss: 5099028.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8967; val_auprc_score: 0.9540; val_best_acc_score: 0.8741; val_best_f1_score: 0.9190; train_kl_reg_loss: 25922.4606; train_edge_recon_loss: 1429643.5114; train_cat_covariates_contrastive_loss: 629575.5568; train_gene_expr_recon_loss: 2962887.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5048028.5455; train_optim_loss: 5048028.5455; val_kl_reg_loss: 25826.6377; val_edge_recon_loss: 1447803.9375; val_cat_covariates_contrastive_loss: 627804.0938; val_gene_expr_recon_loss: 2997307.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5098742.0000; val_optim_loss: 5098742.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9116; val_auprc_score: 0.9600; val_best_acc_score: 0.8963; val_best_f1_score: 0.9339; train_kl_reg_loss: 23734.0652; train_edge_recon_loss: 1393046.2500; train_cat_covariates_contrastive_loss: 629894.5795; train_gene_expr_recon_loss: 2939560.7955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4986235.6364; train_optim_loss: 4986235.6364; val_kl_reg_loss: 22553.0762; val_edge_recon_loss: 1404463.8750; val_cat_covariates_contrastive_loss: 628602.2188; val_gene_expr_recon_loss: 2971523.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5027143.2500; val_optim_loss: 5027143.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9136; val_auprc_score: 0.9597; val_best_acc_score: 0.9005; val_best_f1_score: 0.9374; train_kl_reg_loss: 24135.1388; train_edge_recon_loss: 1395412.6818; train_cat_covariates_contrastive_loss: 629978.8352; train_gene_expr_recon_loss: 2913236.5227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4962763.2273; train_optim_loss: 4962763.2273; val_kl_reg_loss: 24001.7148; val_edge_recon_loss: 1352964.4375; val_cat_covariates_contrastive_loss: 628494.0938; val_gene_expr_recon_loss: 2926397.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4931858.2500; val_optim_loss: 4931858.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9098; val_auprc_score: 0.9573; val_best_acc_score: 0.8958; val_best_f1_score: 0.9339; train_kl_reg_loss: 24763.8984; train_edge_recon_loss: 1386514.7727; train_cat_covariates_contrastive_loss: 630000.3636; train_gene_expr_recon_loss: 2893464.1136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4934743.1364; train_optim_loss: 4934743.1364; val_kl_reg_loss: 24626.9531; val_edge_recon_loss: 1391217.8750; val_cat_covariates_contrastive_loss: 628347.5000; val_gene_expr_recon_loss: 2888048.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4932240.7500; val_optim_loss: 4932240.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9162; val_auprc_score: 0.9599; val_best_acc_score: 0.9010; val_best_f1_score: 0.9371; train_kl_reg_loss: 24468.2626; train_edge_recon_loss: 1374495.6477; train_cat_covariates_contrastive_loss: 630249.0455; train_gene_expr_recon_loss: 2878580.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4907793.7273; train_optim_loss: 4907793.7273; val_kl_reg_loss: 24217.4043; val_edge_recon_loss: 1363933.9375; val_cat_covariates_contrastive_loss: 628565.7188; val_gene_expr_recon_loss: 2829040.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4845757.0000; val_optim_loss: 4845757.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9132; val_auprc_score: 0.9612; val_best_acc_score: 0.8961; val_best_f1_score: 0.9343; train_kl_reg_loss: 24057.9347; train_edge_recon_loss: 1375440.3636; train_cat_covariates_contrastive_loss: 630062.6023; train_gene_expr_recon_loss: 2863017.9545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4892578.7727; train_optim_loss: 4892578.7727; val_kl_reg_loss: 23522.7910; val_edge_recon_loss: 1376663.9375; val_cat_covariates_contrastive_loss: 629083.2500; val_gene_expr_recon_loss: 2848247.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4877518.0000; val_optim_loss: 4877518.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9112; val_auprc_score: 0.9589; val_best_acc_score: 0.8948; val_best_f1_score: 0.9337; train_kl_reg_loss: 23218.1637; train_edge_recon_loss: 1373556.4318; train_cat_covariates_contrastive_loss: 630214.4261; train_gene_expr_recon_loss: 2849374.7955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4876363.8182; train_optim_loss: 4876363.8182; val_kl_reg_loss: 23353.0010; val_edge_recon_loss: 1394137.3125; val_cat_covariates_contrastive_loss: 628939.5000; val_gene_expr_recon_loss: 2932047.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4978477.7500; val_optim_loss: 4978477.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9142; val_auprc_score: 0.9592; val_best_acc_score: 0.8954; val_best_f1_score: 0.9336; train_kl_reg_loss: 22655.6850; train_edge_recon_loss: 1369949.5909; train_cat_covariates_contrastive_loss: 630319.3636; train_gene_expr_recon_loss: 2847425.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4870349.6364; train_optim_loss: 4870349.6364; val_kl_reg_loss: 23001.9209; val_edge_recon_loss: 1423223.1250; val_cat_covariates_contrastive_loss: 628806.3125; val_gene_expr_recon_loss: 2939099.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5014130.7500; val_optim_loss: 5014130.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9137; val_auprc_score: 0.9611; val_best_acc_score: 0.8966; val_best_f1_score: 0.9346; train_kl_reg_loss: 21756.3127; train_edge_recon_loss: 1363519.0341; train_cat_covariates_contrastive_loss: 630342.2216; train_gene_expr_recon_loss: 2841696.5227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4857314.0455; train_optim_loss: 4857314.0455; val_kl_reg_loss: 21791.2617; val_edge_recon_loss: 1362383.5625; val_cat_covariates_contrastive_loss: 629039.2812; val_gene_expr_recon_loss: 2889931.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4903145.7500; val_optim_loss: 4903145.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9210; val_auprc_score: 0.9632; val_best_acc_score: 0.9020; val_best_f1_score: 0.9379; train_kl_reg_loss: 21224.9647; train_edge_recon_loss: 1377947.2727; train_cat_covariates_contrastive_loss: 630339.3864; train_gene_expr_recon_loss: 2825802.9545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4855314.5455; train_optim_loss: 4855314.5455; val_kl_reg_loss: 21986.4775; val_edge_recon_loss: 1355205.3750; val_cat_covariates_contrastive_loss: 629482.0938; val_gene_expr_recon_loss: 2916285.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4922959.0000; val_optim_loss: 4922959.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9183; val_auprc_score: 0.9638; val_best_acc_score: 0.8999; val_best_f1_score: 0.9366; train_kl_reg_loss: 21228.3945; train_edge_recon_loss: 1359221.2500; train_cat_covariates_contrastive_loss: 630519.1477; train_gene_expr_recon_loss: 2827821.5227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4838790.3182; train_optim_loss: 4838790.3182; val_kl_reg_loss: 21739.8301; val_edge_recon_loss: 1360955.6875; val_cat_covariates_contrastive_loss: 629039.4688; val_gene_expr_recon_loss: 2915290.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4927025.5000; val_optim_loss: 4927025.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9160; val_auprc_score: 0.9610; val_best_acc_score: 0.8986; val_best_f1_score: 0.9361; train_kl_reg_loss: 21156.3711; train_edge_recon_loss: 1373505.1023; train_cat_covariates_contrastive_loss: 630467.5511; train_gene_expr_recon_loss: 2827734.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4852863.6818; train_optim_loss: 4852863.6818; val_kl_reg_loss: 21072.7031; val_edge_recon_loss: 1369483.0625; val_cat_covariates_contrastive_loss: 629569.1875; val_gene_expr_recon_loss: 2769676.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4789801.2500; val_optim_loss: 4789801.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9165; val_auprc_score: 0.9624; val_best_acc_score: 0.8969; val_best_f1_score: 0.9346; train_kl_reg_loss: 21100.8912; train_edge_recon_loss: 1365668.8523; train_cat_covariates_contrastive_loss: 630592.3295; train_gene_expr_recon_loss: 2826032.5227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4843394.6364; train_optim_loss: 4843394.6364; val_kl_reg_loss: 21207.9844; val_edge_recon_loss: 1370888.3125; val_cat_covariates_contrastive_loss: 629342.6875; val_gene_expr_recon_loss: 2834823.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4856262.5000; val_optim_loss: 4856262.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9233; val_auprc_score: 0.9656; val_best_acc_score: 0.9005; val_best_f1_score: 0.9371; train_kl_reg_loss: 21056.5304; train_edge_recon_loss: 1375393.3750; train_cat_covariates_contrastive_loss: 630501.5852; train_gene_expr_recon_loss: 2823603.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4850554.9091; train_optim_loss: 4850554.9091; val_kl_reg_loss: 20564.1719; val_edge_recon_loss: 1358180.1875; val_cat_covariates_contrastive_loss: 629306.6875; val_gene_expr_recon_loss: 2773920.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4781971.5000; val_optim_loss: 4781971.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9169; val_auprc_score: 0.9631; val_best_acc_score: 0.8957; val_best_f1_score: 0.9340; train_kl_reg_loss: 21084.0016; train_edge_recon_loss: 1362603.9318; train_cat_covariates_contrastive_loss: 630648.8920; train_gene_expr_recon_loss: 2830075.6136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4844412.3636; train_optim_loss: 4844412.3636; val_kl_reg_loss: 21870.1084; val_edge_recon_loss: 1415909.6875; val_cat_covariates_contrastive_loss: 629779.5938; val_gene_expr_recon_loss: 2856088.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4923647.5000; val_optim_loss: 4923647.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9131; val_auprc_score: 0.9613; val_best_acc_score: 0.8959; val_best_f1_score: 0.9337; train_kl_reg_loss: 20920.2145; train_edge_recon_loss: 1360397.4886; train_cat_covariates_contrastive_loss: 630590.5341; train_gene_expr_recon_loss: 2827236.6591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4839144.8182; train_optim_loss: 4839144.8182; val_kl_reg_loss: 21132.7305; val_edge_recon_loss: 1374707.8125; val_cat_covariates_contrastive_loss: 629457.7500; val_gene_expr_recon_loss: 2845844.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4871142.7500; val_optim_loss: 4871142.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9261; val_auprc_score: 0.9664; val_best_acc_score: 0.9035; val_best_f1_score: 0.9390; train_kl_reg_loss: 20872.5962; train_edge_recon_loss: 1365517.5227; train_cat_covariates_contrastive_loss: 630670.7500; train_gene_expr_recon_loss: 2825045.1364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4842106.0000; train_optim_loss: 4842106.0000; val_kl_reg_loss: 21702.6133; val_edge_recon_loss: 1338243.9375; val_cat_covariates_contrastive_loss: 629797.6250; val_gene_expr_recon_loss: 2895375.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4885119.5000; val_optim_loss: 4885119.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9220; val_auprc_score: 0.9652; val_best_acc_score: 0.9009; val_best_f1_score: 0.9368; train_kl_reg_loss: 20802.6412; train_edge_recon_loss: 1365228.9318; train_cat_covariates_contrastive_loss: 630747.6875; train_gene_expr_recon_loss: 2827576.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4844356.2273; train_optim_loss: 4844356.2273; val_kl_reg_loss: 20545.7725; val_edge_recon_loss: 1392349.9375; val_cat_covariates_contrastive_loss: 629617.4375; val_gene_expr_recon_loss: 2768313.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4810826.2500; val_optim_loss: 4810826.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9181; val_auprc_score: 0.9621; val_best_acc_score: 0.8991; val_best_f1_score: 0.9361; train_kl_reg_loss: 20597.8546; train_edge_recon_loss: 1355587.3068; train_cat_covariates_contrastive_loss: 630722.8182; train_gene_expr_recon_loss: 2820755.9773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4827664.0455; train_optim_loss: 4827664.0455; val_kl_reg_loss: 20989.3711; val_edge_recon_loss: 1401650.3125; val_cat_covariates_contrastive_loss: 629433.5938; val_gene_expr_recon_loss: 2858148.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4910221.5000; val_optim_loss: 4910221.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9197; val_auprc_score: 0.9629; val_best_acc_score: 0.8997; val_best_f1_score: 0.9361; train_kl_reg_loss: 20642.6390; train_edge_recon_loss: 1364542.8182; train_cat_covariates_contrastive_loss: 630642.3864; train_gene_expr_recon_loss: 2821787.1591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4837615.0455; train_optim_loss: 4837615.0455; val_kl_reg_loss: 20802.6553; val_edge_recon_loss: 1366092.9375; val_cat_covariates_contrastive_loss: 629601.8438; val_gene_expr_recon_loss: 2765994.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4782492.0000; val_optim_loss: 4782492.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9226; val_auprc_score: 0.9634; val_best_acc_score: 0.8991; val_best_f1_score: 0.9357; train_kl_reg_loss: 20677.4171; train_edge_recon_loss: 1367452.6250; train_cat_covariates_contrastive_loss: 630723.2841; train_gene_expr_recon_loss: 2826698.7955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4845552.0909; train_optim_loss: 4845552.0909; val_kl_reg_loss: 20961.7822; val_edge_recon_loss: 1402812.6250; val_cat_covariates_contrastive_loss: 629580.0938; val_gene_expr_recon_loss: 2784086.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4837441.2500; val_optim_loss: 4837441.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9220; val_auprc_score: 0.9651; val_best_acc_score: 0.8996; val_best_f1_score: 0.9364; train_kl_reg_loss: 20630.0234; train_edge_recon_loss: 1373578.1591; train_cat_covariates_contrastive_loss: 630683.7898; train_gene_expr_recon_loss: 2822072.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4846964.5909; train_optim_loss: 4846964.5909; val_kl_reg_loss: 21445.8711; val_edge_recon_loss: 1348987.7500; val_cat_covariates_contrastive_loss: 629503.8125; val_gene_expr_recon_loss: 2886639.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4886576.5000; val_optim_loss: 4886576.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 8 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9122
val AUPRC score: 0.9591
val best accuracy score: 0.8948
val best F1 score: 0.9333
val target rna MSE score: 1.0617
val source rna MSE score: 0.4217
Val cat covariate0 mean sim diff: -0.0042
Val cat covariate1 mean sim diff: -0.1483
Duration of model training in run 6: 0 hours, 3 minutes and 12 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 12706
Number of validation nodes: 1412
Number of training edges: 87817
Number of validation edges: 9757
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9629; val_auprc_score: 0.9850; val_best_acc_score: 0.8098; val_best_f1_score: 0.8881; train_kl_reg_loss: 2072.1713; train_edge_recon_loss: 1824707.9886; train_cat_covariates_contrastive_loss: 863059.6591; train_gene_expr_recon_loss: 3977443.4773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6667283.2727; train_optim_loss: 6667283.2727; val_kl_reg_loss: 3611.6710; val_edge_recon_loss: 2016060.6250; val_cat_covariates_contrastive_loss: 627007.4688; val_gene_expr_recon_loss: 3825102.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6471782.2500; val_optim_loss: 6471782.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9329; val_auprc_score: 0.9751; val_best_acc_score: 0.8560; val_best_f1_score: 0.9101; train_kl_reg_loss: 2576.5696; train_edge_recon_loss: 1865086.9205; train_cat_covariates_contrastive_loss: 680620.9148; train_gene_expr_recon_loss: 3699175.5682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6247459.9091; train_optim_loss: 6247459.9091; val_kl_reg_loss: 2296.5164; val_edge_recon_loss: 1962100.7500; val_cat_covariates_contrastive_loss: 627222.9062; val_gene_expr_recon_loss: 3595449.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6187070.0000; val_optim_loss: 6187070.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8705; val_auprc_score: 0.9499; val_best_acc_score: 0.8396; val_best_f1_score: 0.9016; train_kl_reg_loss: 2832.4478; train_edge_recon_loss: 1784041.3295; train_cat_covariates_contrastive_loss: 679223.3693; train_gene_expr_recon_loss: 3518982.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5985079.3636; train_optim_loss: 5985079.3636; val_kl_reg_loss: 3677.6495; val_edge_recon_loss: 1859932.9375; val_cat_covariates_contrastive_loss: 627695.8125; val_gene_expr_recon_loss: 3408249.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5899555.5000; val_optim_loss: 5899555.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8591; val_auprc_score: 0.9434; val_best_acc_score: 0.8357; val_best_f1_score: 0.9000; train_kl_reg_loss: 5097.3464; train_edge_recon_loss: 1708659.4091; train_cat_covariates_contrastive_loss: 670010.7784; train_gene_expr_recon_loss: 3375787.9545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5759555.5455; train_optim_loss: 5759555.5455; val_kl_reg_loss: 7054.3706; val_edge_recon_loss: 1705717.9375; val_cat_covariates_contrastive_loss: 627864.5938; val_gene_expr_recon_loss: 3205626.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5546263.0000; val_optim_loss: 5546263.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8459; val_auprc_score: 0.9357; val_best_acc_score: 0.8298; val_best_f1_score: 0.8963; train_kl_reg_loss: 9920.1904; train_edge_recon_loss: 1611210.8636; train_cat_covariates_contrastive_loss: 653120.3750; train_gene_expr_recon_loss: 3252785.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5527036.8636; train_optim_loss: 5527036.8636; val_kl_reg_loss: 14775.0664; val_edge_recon_loss: 1598197.3125; val_cat_covariates_contrastive_loss: 627698.2188; val_gene_expr_recon_loss: 3371876.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5612547.0000; val_optim_loss: 5612547.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8472; val_auprc_score: 0.9342; val_best_acc_score: 0.8355; val_best_f1_score: 0.8970; train_kl_reg_loss: 18716.6508; train_edge_recon_loss: 1545963.3409; train_cat_covariates_contrastive_loss: 633433.8864; train_gene_expr_recon_loss: 3175449.9318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5373563.7727; train_optim_loss: 5373563.7727; val_kl_reg_loss: 22129.4717; val_edge_recon_loss: 1564780.1875; val_cat_covariates_contrastive_loss: 627397.9375; val_gene_expr_recon_loss: 3148406.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5362714.2500; val_optim_loss: 5362714.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8611; val_auprc_score: 0.9407; val_best_acc_score: 0.8470; val_best_f1_score: 0.9045; train_kl_reg_loss: 23275.5051; train_edge_recon_loss: 1491213.6591; train_cat_covariates_contrastive_loss: 628719.2159; train_gene_expr_recon_loss: 3113665.6136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5256873.9091; train_optim_loss: 5256873.9091; val_kl_reg_loss: 23980.1689; val_edge_recon_loss: 1467801.5000; val_cat_covariates_contrastive_loss: 627302.0000; val_gene_expr_recon_loss: 3083681.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5202765.0000; val_optim_loss: 5202765.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8733; val_auprc_score: 0.9455; val_best_acc_score: 0.8546; val_best_f1_score: 0.9095; train_kl_reg_loss: 23459.2678; train_edge_recon_loss: 1467049.5114; train_cat_covariates_contrastive_loss: 628709.2159; train_gene_expr_recon_loss: 3060927.9545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5180145.8182; train_optim_loss: 5180145.8182; val_kl_reg_loss: 23181.7090; val_edge_recon_loss: 1449201.8750; val_cat_covariates_contrastive_loss: 627378.6250; val_gene_expr_recon_loss: 3081883.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5181646.0000; val_optim_loss: 5181646.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8840; val_auprc_score: 0.9492; val_best_acc_score: 0.8603; val_best_f1_score: 0.9125; train_kl_reg_loss: 21894.0886; train_edge_recon_loss: 1442063.6250; train_cat_covariates_contrastive_loss: 629767.9602; train_gene_expr_recon_loss: 3021187.7045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5114913.2727; train_optim_loss: 5114913.2727; val_kl_reg_loss: 19511.9297; val_edge_recon_loss: 1426844.3125; val_cat_covariates_contrastive_loss: 627872.5312; val_gene_expr_recon_loss: 2899089.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4973318.5000; val_optim_loss: 4973318.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9018; val_auprc_score: 0.9545; val_best_acc_score: 0.8840; val_best_f1_score: 0.9255; train_kl_reg_loss: 19690.6087; train_edge_recon_loss: 1407721.2955; train_cat_covariates_contrastive_loss: 630805.8864; train_gene_expr_recon_loss: 2990818.2045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5049035.9545; train_optim_loss: 5049035.9545; val_kl_reg_loss: 18808.7783; val_edge_recon_loss: 1422632.5000; val_cat_covariates_contrastive_loss: 628949.4688; val_gene_expr_recon_loss: 2905185.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4975576.7500; val_optim_loss: 4975576.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9119; val_auprc_score: 0.9598; val_best_acc_score: 0.8946; val_best_f1_score: 0.9328; train_kl_reg_loss: 19077.6735; train_edge_recon_loss: 1389275.3523; train_cat_covariates_contrastive_loss: 631021.1477; train_gene_expr_recon_loss: 2965945.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5005320.0909; train_optim_loss: 5005320.0909; val_kl_reg_loss: 20162.4688; val_edge_recon_loss: 1419866.1875; val_cat_covariates_contrastive_loss: 629920.5938; val_gene_expr_recon_loss: 3005281.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5075230.5000; val_optim_loss: 5075230.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9134; val_auprc_score: 0.9594; val_best_acc_score: 0.9016; val_best_f1_score: 0.9375; train_kl_reg_loss: 19718.7045; train_edge_recon_loss: 1378845.8750; train_cat_covariates_contrastive_loss: 630844.6193; train_gene_expr_recon_loss: 2940161.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4969570.2273; train_optim_loss: 4969570.2273; val_kl_reg_loss: 20339.6426; val_edge_recon_loss: 1340777.6250; val_cat_covariates_contrastive_loss: 629664.1562; val_gene_expr_recon_loss: 2872219.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4863001.0000; val_optim_loss: 4863001.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9152; val_auprc_score: 0.9620; val_best_acc_score: 0.9002; val_best_f1_score: 0.9370; train_kl_reg_loss: 19255.0460; train_edge_recon_loss: 1368736.3068; train_cat_covariates_contrastive_loss: 631115.7841; train_gene_expr_recon_loss: 2918162.9773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4937270.1364; train_optim_loss: 4937270.1364; val_kl_reg_loss: 17876.7686; val_edge_recon_loss: 1307604.5625; val_cat_covariates_contrastive_loss: 629246.7812; val_gene_expr_recon_loss: 2850318.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4805046.7500; val_optim_loss: 4805046.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9224; val_auprc_score: 0.9643; val_best_acc_score: 0.8982; val_best_f1_score: 0.9352; train_kl_reg_loss: 18524.5813; train_edge_recon_loss: 1355852.9659; train_cat_covariates_contrastive_loss: 631280.1420; train_gene_expr_recon_loss: 2903767.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4909424.9091; train_optim_loss: 4909424.9091; val_kl_reg_loss: 18984.3604; val_edge_recon_loss: 1373087.3750; val_cat_covariates_contrastive_loss: 629639.9062; val_gene_expr_recon_loss: 2817052.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4838764.5000; val_optim_loss: 4838764.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9182; val_auprc_score: 0.9617; val_best_acc_score: 0.9008; val_best_f1_score: 0.9368; train_kl_reg_loss: 18235.9817; train_edge_recon_loss: 1365698.4318; train_cat_covariates_contrastive_loss: 631329.1023; train_gene_expr_recon_loss: 2892617.3182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4907880.7727; train_optim_loss: 4907880.7727; val_kl_reg_loss: 17705.8516; val_edge_recon_loss: 1392503.6250; val_cat_covariates_contrastive_loss: 629623.7812; val_gene_expr_recon_loss: 2785227.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4825061.0000; val_optim_loss: 4825061.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9223; val_auprc_score: 0.9636; val_best_acc_score: 0.9042; val_best_f1_score: 0.9389; train_kl_reg_loss: 17878.9812; train_edge_recon_loss: 1362977.4545; train_cat_covariates_contrastive_loss: 631524.4830; train_gene_expr_recon_loss: 2885575.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4897956.0000; train_optim_loss: 4897956.0000; val_kl_reg_loss: 17989.3359; val_edge_recon_loss: 1373315.3750; val_cat_covariates_contrastive_loss: 630413.4375; val_gene_expr_recon_loss: 2947223.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4968941.2500; val_optim_loss: 4968941.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9217; val_auprc_score: 0.9620; val_best_acc_score: 0.9057; val_best_f1_score: 0.9397; train_kl_reg_loss: 17147.4295; train_edge_recon_loss: 1356552.3523; train_cat_covariates_contrastive_loss: 631683.6307; train_gene_expr_recon_loss: 2877894.1136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4883277.5455; train_optim_loss: 4883277.5455; val_kl_reg_loss: 16359.6768; val_edge_recon_loss: 1373089.6250; val_cat_covariates_contrastive_loss: 630932.0625; val_gene_expr_recon_loss: 2775572.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4795953.5000; val_optim_loss: 4795953.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9231; val_auprc_score: 0.9629; val_best_acc_score: 0.9087; val_best_f1_score: 0.9416; train_kl_reg_loss: 16557.0316; train_edge_recon_loss: 1346032.9432; train_cat_covariates_contrastive_loss: 632200.7159; train_gene_expr_recon_loss: 2872091.8864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4866882.5000; train_optim_loss: 4866882.5000; val_kl_reg_loss: 17229.2559; val_edge_recon_loss: 1366016.9375; val_cat_covariates_contrastive_loss: 631171.9062; val_gene_expr_recon_loss: 2901999.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4916417.0000; val_optim_loss: 4916417.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9241; val_auprc_score: 0.9637; val_best_acc_score: 0.9111; val_best_f1_score: 0.9433; train_kl_reg_loss: 16236.4028; train_edge_recon_loss: 1343111.7500; train_cat_covariates_contrastive_loss: 632936.0568; train_gene_expr_recon_loss: 2856438.4773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4848722.6364; train_optim_loss: 4848722.6364; val_kl_reg_loss: 16204.0195; val_edge_recon_loss: 1383411.8125; val_cat_covariates_contrastive_loss: 631674.4375; val_gene_expr_recon_loss: 2915784.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4947074.7500; val_optim_loss: 4947074.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9274; val_auprc_score: 0.9651; val_best_acc_score: 0.9165; val_best_f1_score: 0.9463; train_kl_reg_loss: 15875.7314; train_edge_recon_loss: 1336721.0568; train_cat_covariates_contrastive_loss: 632916.2045; train_gene_expr_recon_loss: 2846513.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4832026.8182; train_optim_loss: 4832026.8182; val_kl_reg_loss: 15846.8203; val_edge_recon_loss: 1368553.5625; val_cat_covariates_contrastive_loss: 632498.1875; val_gene_expr_recon_loss: 2783883.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4800782.0000; val_optim_loss: 4800782.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9314; val_auprc_score: 0.9668; val_best_acc_score: 0.9187; val_best_f1_score: 0.9478; train_kl_reg_loss: 15498.0745; train_edge_recon_loss: 1352757.6023; train_cat_covariates_contrastive_loss: 633809.7102; train_gene_expr_recon_loss: 2845588.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4847653.5909; train_optim_loss: 4847653.5909; val_kl_reg_loss: 15455.7681; val_edge_recon_loss: 1336150.8125; val_cat_covariates_contrastive_loss: 632776.2812; val_gene_expr_recon_loss: 2820092.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4804475.7500; val_optim_loss: 4804475.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9299; val_auprc_score: 0.9653; val_best_acc_score: 0.9180; val_best_f1_score: 0.9478; train_kl_reg_loss: 15520.8844; train_edge_recon_loss: 1342715.8750; train_cat_covariates_contrastive_loss: 634274.3523; train_gene_expr_recon_loss: 2831601.6818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4824112.7727; train_optim_loss: 4824112.7727; val_kl_reg_loss: 15917.8540; val_edge_recon_loss: 1351942.2500; val_cat_covariates_contrastive_loss: 633001.0312; val_gene_expr_recon_loss: 2915515.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4916376.5000; val_optim_loss: 4916376.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9310; val_auprc_score: 0.9675; val_best_acc_score: 0.9185; val_best_f1_score: 0.9475; train_kl_reg_loss: 15475.5387; train_edge_recon_loss: 1337569.4545; train_cat_covariates_contrastive_loss: 634018.7102; train_gene_expr_recon_loss: 2838407.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4825470.9091; train_optim_loss: 4825470.9091; val_kl_reg_loss: 15553.2266; val_edge_recon_loss: 1360875.9375; val_cat_covariates_contrastive_loss: 632394.9688; val_gene_expr_recon_loss: 2788855.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4797679.5000; val_optim_loss: 4797679.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9320; val_auprc_score: 0.9674; val_best_acc_score: 0.9178; val_best_f1_score: 0.9473; train_kl_reg_loss: 15584.8152; train_edge_recon_loss: 1335365.6932; train_cat_covariates_contrastive_loss: 633918.8636; train_gene_expr_recon_loss: 2836061.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4820931.0909; train_optim_loss: 4820931.0909; val_kl_reg_loss: 15655.1040; val_edge_recon_loss: 1367871.0000; val_cat_covariates_contrastive_loss: 631953.1250; val_gene_expr_recon_loss: 2776939.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4792418.2500; val_optim_loss: 4792418.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9272; val_auprc_score: 0.9636; val_best_acc_score: 0.9151; val_best_f1_score: 0.9453; train_kl_reg_loss: 15540.3546; train_edge_recon_loss: 1338882.3636; train_cat_covariates_contrastive_loss: 633718.5682; train_gene_expr_recon_loss: 2842075.3409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4830216.5909; train_optim_loss: 4830216.5909; val_kl_reg_loss: 15435.8164; val_edge_recon_loss: 1375317.7500; val_cat_covariates_contrastive_loss: 633252.8125; val_gene_expr_recon_loss: 2765030.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4789036.7500; val_optim_loss: 4789036.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9280; val_auprc_score: 0.9643; val_best_acc_score: 0.9193; val_best_f1_score: 0.9482; train_kl_reg_loss: 15531.0548; train_edge_recon_loss: 1343435.4659; train_cat_covariates_contrastive_loss: 633758.0909; train_gene_expr_recon_loss: 2840664.0682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4833388.7273; train_optim_loss: 4833388.7273; val_kl_reg_loss: 15083.0029; val_edge_recon_loss: 1347909.8125; val_cat_covariates_contrastive_loss: 632869.2500; val_gene_expr_recon_loss: 2720099.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4715961.0000; val_optim_loss: 4715961.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9313; val_auprc_score: 0.9686; val_best_acc_score: 0.9191; val_best_f1_score: 0.9479; train_kl_reg_loss: 15461.1147; train_edge_recon_loss: 1346597.4886; train_cat_covariates_contrastive_loss: 633990.9886; train_gene_expr_recon_loss: 2835008.2955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4831057.8182; train_optim_loss: 4831057.8182; val_kl_reg_loss: 15898.2275; val_edge_recon_loss: 1349354.7500; val_cat_covariates_contrastive_loss: 632432.2500; val_gene_expr_recon_loss: 2948704.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4946390.0000; val_optim_loss: 4946390.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9356; val_auprc_score: 0.9693; val_best_acc_score: 0.9237; val_best_f1_score: 0.9511; train_kl_reg_loss: 15457.5766; train_edge_recon_loss: 1333308.8409; train_cat_covariates_contrastive_loss: 633857.0966; train_gene_expr_recon_loss: 2832024.3864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4814647.8636; train_optim_loss: 4814647.8636; val_kl_reg_loss: 15679.4541; val_edge_recon_loss: 1322323.8125; val_cat_covariates_contrastive_loss: 632888.7500; val_gene_expr_recon_loss: 2785495.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4756387.0000; val_optim_loss: 4756387.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9257; val_auprc_score: 0.9647; val_best_acc_score: 0.9161; val_best_f1_score: 0.9463; train_kl_reg_loss: 15450.0948; train_edge_recon_loss: 1352284.2273; train_cat_covariates_contrastive_loss: 633860.8636; train_gene_expr_recon_loss: 2833441.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4835037.0455; train_optim_loss: 4835037.0455; val_kl_reg_loss: 15407.4897; val_edge_recon_loss: 1343634.6875; val_cat_covariates_contrastive_loss: 632914.8438; val_gene_expr_recon_loss: 2878944.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4870901.0000; val_optim_loss: 4870901.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9322; val_auprc_score: 0.9684; val_best_acc_score: 0.9197; val_best_f1_score: 0.9482; train_kl_reg_loss: 15446.9953; train_edge_recon_loss: 1337876.6818; train_cat_covariates_contrastive_loss: 634067.3295; train_gene_expr_recon_loss: 2831432.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4818823.5455; train_optim_loss: 4818823.5455; val_kl_reg_loss: 15660.3696; val_edge_recon_loss: 1336502.4375; val_cat_covariates_contrastive_loss: 631410.5625; val_gene_expr_recon_loss: 2784797.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4768370.7500; val_optim_loss: 4768370.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9298; val_auprc_score: 0.9664; val_best_acc_score: 0.9190; val_best_f1_score: 0.9479; train_kl_reg_loss: 15426.1240; train_edge_recon_loss: 1340844.8750; train_cat_covariates_contrastive_loss: 633977.3807; train_gene_expr_recon_loss: 2831685.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4821934.1364; train_optim_loss: 4821934.1364; val_kl_reg_loss: 15988.1582; val_edge_recon_loss: 1386512.9375; val_cat_covariates_contrastive_loss: 633126.2188; val_gene_expr_recon_loss: 2830159.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4865787.0000; val_optim_loss: 4865787.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9329; val_auprc_score: 0.9689; val_best_acc_score: 0.9192; val_best_f1_score: 0.9484; train_kl_reg_loss: 15458.2382; train_edge_recon_loss: 1349892.7500; train_cat_covariates_contrastive_loss: 634141.2045; train_gene_expr_recon_loss: 2837225.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4836717.6364; train_optim_loss: 4836717.6364; val_kl_reg_loss: 15391.5947; val_edge_recon_loss: 1348655.5625; val_cat_covariates_contrastive_loss: 632869.3125; val_gene_expr_recon_loss: 2730259.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4727176.0000; val_optim_loss: 4727176.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9330; val_auprc_score: 0.9690; val_best_acc_score: 0.9214; val_best_f1_score: 0.9494; train_kl_reg_loss: 15397.3635; train_edge_recon_loss: 1342807.7955; train_cat_covariates_contrastive_loss: 633751.9432; train_gene_expr_recon_loss: 2837078.8409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4829035.9545; train_optim_loss: 4829035.9545; val_kl_reg_loss: 15717.6108; val_edge_recon_loss: 1325812.9375; val_cat_covariates_contrastive_loss: 633752.8438; val_gene_expr_recon_loss: 2871589.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4846872.5000; val_optim_loss: 4846872.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9285; val_auprc_score: 0.9656; val_best_acc_score: 0.9195; val_best_f1_score: 0.9484; train_kl_reg_loss: 15441.7594; train_edge_recon_loss: 1350900.0000; train_cat_covariates_contrastive_loss: 633790.1761; train_gene_expr_recon_loss: 2837474.1591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4837606.0909; train_optim_loss: 4837606.0909; val_kl_reg_loss: 15528.2666; val_edge_recon_loss: 1362786.1875; val_cat_covariates_contrastive_loss: 632896.2812; val_gene_expr_recon_loss: 2816124.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4827335.5000; val_optim_loss: 4827335.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 29 sec.
Using best model state, which was in epoch 26.

--- MODEL EVALUATION ---
val AUROC score: 0.9327
val AUPRC score: 0.9690
val best accuracy score: 0.9200
val best F1 score: 0.9485
val target rna MSE score: 1.0729
val source rna MSE score: 0.3064
Val cat covariate0 mean sim diff: 0.0021
Val cat covariate1 mean sim diff: -0.1199
Duration of model training in run 5: 0 hours, 3 minutes and 33 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 12706
Number of validation nodes: 1412
Number of training edges: 59255
Number of validation edges: 6583
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9554; val_auprc_score: 0.9843; val_best_acc_score: 0.8099; val_best_f1_score: 0.8876; train_kl_reg_loss: 1362.2832; train_edge_recon_loss: 1781291.3594; train_cat_covariates_contrastive_loss: 949379.0078; train_gene_expr_recon_loss: 4048837.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6780870.1250; train_optim_loss: 6780870.1250; val_kl_reg_loss: 3057.0669; val_edge_recon_loss: 2048549.5000; val_cat_covariates_contrastive_loss: 627322.6250; val_gene_expr_recon_loss: 3916797.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6595727.0000; val_optim_loss: 6595727.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9466; val_auprc_score: 0.9783; val_best_acc_score: 0.8313; val_best_f1_score: 0.8981; train_kl_reg_loss: 3086.5891; train_edge_recon_loss: 1899867.0312; train_cat_covariates_contrastive_loss: 661536.2109; train_gene_expr_recon_loss: 3832307.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6396796.9375; train_optim_loss: 6396796.9375; val_kl_reg_loss: 2097.7512; val_edge_recon_loss: 2063868.0000; val_cat_covariates_contrastive_loss: 627446.8750; val_gene_expr_recon_loss: 3731623.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6425035.5000; val_optim_loss: 6425035.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9144; val_auprc_score: 0.9668; val_best_acc_score: 0.8535; val_best_f1_score: 0.9037; train_kl_reg_loss: 2147.4067; train_edge_recon_loss: 1823154.7969; train_cat_covariates_contrastive_loss: 693270.9297; train_gene_expr_recon_loss: 3657911.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6176485.0625; train_optim_loss: 6176485.0625; val_kl_reg_loss: 2330.2034; val_edge_recon_loss: 1997056.5000; val_cat_covariates_contrastive_loss: 627488.5000; val_gene_expr_recon_loss: 3595307.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6222182.0000; val_optim_loss: 6222182.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8689; val_auprc_score: 0.9444; val_best_acc_score: 0.8380; val_best_f1_score: 0.8990; train_kl_reg_loss: 2820.0644; train_edge_recon_loss: 1785639.5156; train_cat_covariates_contrastive_loss: 674809.9766; train_gene_expr_recon_loss: 3539082.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6002352.3750; train_optim_loss: 6002352.3750; val_kl_reg_loss: 3366.1030; val_edge_recon_loss: 1995226.5000; val_cat_covariates_contrastive_loss: 627781.8125; val_gene_expr_recon_loss: 3475828.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6102203.0000; val_optim_loss: 6102203.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8585; val_auprc_score: 0.9424; val_best_acc_score: 0.8413; val_best_f1_score: 0.9024; train_kl_reg_loss: 4201.2192; train_edge_recon_loss: 1714765.1719; train_cat_covariates_contrastive_loss: 668075.8594; train_gene_expr_recon_loss: 3429336.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5816378.6875; train_optim_loss: 5816378.6875; val_kl_reg_loss: 5016.4805; val_edge_recon_loss: 1804403.7500; val_cat_covariates_contrastive_loss: 628014.1875; val_gene_expr_recon_loss: 3368900.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5806335.0000; val_optim_loss: 5806335.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8470; val_auprc_score: 0.9372; val_best_acc_score: 0.8271; val_best_f1_score: 0.8945; train_kl_reg_loss: 6505.9916; train_edge_recon_loss: 1660145.1875; train_cat_covariates_contrastive_loss: 658826.1641; train_gene_expr_recon_loss: 3305793.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5631270.5625; train_optim_loss: 5631270.5625; val_kl_reg_loss: 7723.9922; val_edge_recon_loss: 1719339.5000; val_cat_covariates_contrastive_loss: 627917.7500; val_gene_expr_recon_loss: 3274993.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5629974.0000; val_optim_loss: 5629974.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8444; val_auprc_score: 0.9365; val_best_acc_score: 0.8278; val_best_f1_score: 0.8961; train_kl_reg_loss: 10267.9775; train_edge_recon_loss: 1611632.7188; train_cat_covariates_contrastive_loss: 648293.2969; train_gene_expr_recon_loss: 3218452.4688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5488646.2500; train_optim_loss: 5488646.2500; val_kl_reg_loss: 12837.3125; val_edge_recon_loss: 1594254.5000; val_cat_covariates_contrastive_loss: 627886.9375; val_gene_expr_recon_loss: 3206811.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5441790.0000; val_optim_loss: 5441790.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8434; val_auprc_score: 0.9317; val_best_acc_score: 0.8343; val_best_f1_score: 0.8970; train_kl_reg_loss: 16601.5530; train_edge_recon_loss: 1560613.9688; train_cat_covariates_contrastive_loss: 634683.8516; train_gene_expr_recon_loss: 3167681.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5379581.1250; train_optim_loss: 5379581.1250; val_kl_reg_loss: 19763.3672; val_edge_recon_loss: 1532224.0000; val_cat_covariates_contrastive_loss: 627745.6875; val_gene_expr_recon_loss: 3154369.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5334102.5000; val_optim_loss: 5334102.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8466; val_auprc_score: 0.9344; val_best_acc_score: 0.8368; val_best_f1_score: 0.8985; train_kl_reg_loss: 22045.0286; train_edge_recon_loss: 1524504.0469; train_cat_covariates_contrastive_loss: 630197.3906; train_gene_expr_recon_loss: 3111201.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5287947.8750; train_optim_loss: 5287947.8750; val_kl_reg_loss: 24301.7070; val_edge_recon_loss: 1505537.5000; val_cat_covariates_contrastive_loss: 627477.3750; val_gene_expr_recon_loss: 3107599.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5264916.0000; val_optim_loss: 5264916.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8574; val_auprc_score: 0.9400; val_best_acc_score: 0.8412; val_best_f1_score: 0.9001; train_kl_reg_loss: 25788.2986; train_edge_recon_loss: 1476100.7969; train_cat_covariates_contrastive_loss: 629128.3750; train_gene_expr_recon_loss: 3084111.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5215129.1875; train_optim_loss: 5215129.1875; val_kl_reg_loss: 24119.3906; val_edge_recon_loss: 1496886.5000; val_cat_covariates_contrastive_loss: 627509.3750; val_gene_expr_recon_loss: 3066860.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5215375.0000; val_optim_loss: 5215375.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8711; val_auprc_score: 0.9459; val_best_acc_score: 0.8496; val_best_f1_score: 0.9056; train_kl_reg_loss: 25740.4263; train_edge_recon_loss: 1462509.5469; train_cat_covariates_contrastive_loss: 628862.5547; train_gene_expr_recon_loss: 3023044.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5140157.4375; train_optim_loss: 5140157.4375; val_kl_reg_loss: 24508.9727; val_edge_recon_loss: 1452609.7500; val_cat_covariates_contrastive_loss: 627569.3125; val_gene_expr_recon_loss: 3028576.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5133265.0000; val_optim_loss: 5133265.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8705; val_auprc_score: 0.9444; val_best_acc_score: 0.8528; val_best_f1_score: 0.9086; train_kl_reg_loss: 24284.4597; train_edge_recon_loss: 1434982.3281; train_cat_covariates_contrastive_loss: 629676.7422; train_gene_expr_recon_loss: 2996775.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5085718.6875; train_optim_loss: 5085718.6875; val_kl_reg_loss: 22611.5234; val_edge_recon_loss: 1440824.2500; val_cat_covariates_contrastive_loss: 627816.3750; val_gene_expr_recon_loss: 3001696.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5092948.5000; val_optim_loss: 5092948.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8743; val_auprc_score: 0.9432; val_best_acc_score: 0.8623; val_best_f1_score: 0.9135; train_kl_reg_loss: 23215.8970; train_edge_recon_loss: 1432877.5312; train_cat_covariates_contrastive_loss: 630109.3672; train_gene_expr_recon_loss: 2976758.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5062961.3750; train_optim_loss: 5062961.3750; val_kl_reg_loss: 21713.9883; val_edge_recon_loss: 1420981.1250; val_cat_covariates_contrastive_loss: 628148.1875; val_gene_expr_recon_loss: 2977579.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5048422.0000; val_optim_loss: 5048422.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8965; val_auprc_score: 0.9531; val_best_acc_score: 0.8759; val_best_f1_score: 0.9207; train_kl_reg_loss: 21973.6042; train_edge_recon_loss: 1420708.9062; train_cat_covariates_contrastive_loss: 630768.0078; train_gene_expr_recon_loss: 2959575.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5033025.5625; train_optim_loss: 5033025.5625; val_kl_reg_loss: 21062.7188; val_edge_recon_loss: 1402118.3750; val_cat_covariates_contrastive_loss: 629059.9375; val_gene_expr_recon_loss: 2955218.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5007459.0000; val_optim_loss: 5007459.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8970; val_auprc_score: 0.9521; val_best_acc_score: 0.8843; val_best_f1_score: 0.9262; train_kl_reg_loss: 21232.3835; train_edge_recon_loss: 1391672.4062; train_cat_covariates_contrastive_loss: 631291.3359; train_gene_expr_recon_loss: 2937429.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4981625.9375; train_optim_loss: 4981625.9375; val_kl_reg_loss: 21221.4141; val_edge_recon_loss: 1424420.1250; val_cat_covariates_contrastive_loss: 629533.5625; val_gene_expr_recon_loss: 2939031.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5014206.5000; val_optim_loss: 5014206.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9033; val_auprc_score: 0.9535; val_best_acc_score: 0.8919; val_best_f1_score: 0.9310; train_kl_reg_loss: 21610.4670; train_edge_recon_loss: 1384294.0469; train_cat_covariates_contrastive_loss: 631435.0469; train_gene_expr_recon_loss: 2912017.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4949357.1875; train_optim_loss: 4949357.1875; val_kl_reg_loss: 21165.0215; val_edge_recon_loss: 1403199.6250; val_cat_covariates_contrastive_loss: 629747.0625; val_gene_expr_recon_loss: 2924468.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4978580.0000; val_optim_loss: 4978580.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9062; val_auprc_score: 0.9580; val_best_acc_score: 0.8955; val_best_f1_score: 0.9339; train_kl_reg_loss: 21915.1709; train_edge_recon_loss: 1392863.3906; train_cat_covariates_contrastive_loss: 631579.0000; train_gene_expr_recon_loss: 2903342.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4949700.4375; train_optim_loss: 4949700.4375; val_kl_reg_loss: 21133.0879; val_edge_recon_loss: 1370595.7500; val_cat_covariates_contrastive_loss: 630250.9375; val_gene_expr_recon_loss: 2909605.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4931585.0000; val_optim_loss: 4931585.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9084; val_auprc_score: 0.9584; val_best_acc_score: 0.8948; val_best_f1_score: 0.9329; train_kl_reg_loss: 21462.6650; train_edge_recon_loss: 1379980.3125; train_cat_covariates_contrastive_loss: 631581.4688; train_gene_expr_recon_loss: 2889860.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4922884.9375; train_optim_loss: 4922884.9375; val_kl_reg_loss: 20955.5840; val_edge_recon_loss: 1400075.3750; val_cat_covariates_contrastive_loss: 629906.8125; val_gene_expr_recon_loss: 2898130.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4949068.5000; val_optim_loss: 4949068.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9102; val_auprc_score: 0.9569; val_best_acc_score: 0.8990; val_best_f1_score: 0.9355; train_kl_reg_loss: 21094.6973; train_edge_recon_loss: 1354085.8438; train_cat_covariates_contrastive_loss: 631726.8203; train_gene_expr_recon_loss: 2877181.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4884088.6250; train_optim_loss: 4884088.6250; val_kl_reg_loss: 20556.3906; val_edge_recon_loss: 1361371.8750; val_cat_covariates_contrastive_loss: 629759.4375; val_gene_expr_recon_loss: 2885173.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4896861.0000; val_optim_loss: 4896861.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9075; val_auprc_score: 0.9562; val_best_acc_score: 0.8961; val_best_f1_score: 0.9335; train_kl_reg_loss: 20936.2942; train_edge_recon_loss: 1371175.7500; train_cat_covariates_contrastive_loss: 631530.7109; train_gene_expr_recon_loss: 2871689.4688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4895332.3125; train_optim_loss: 4895332.3125; val_kl_reg_loss: 20121.1582; val_edge_recon_loss: 1393785.5000; val_cat_covariates_contrastive_loss: 630025.6250; val_gene_expr_recon_loss: 2883052.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4926984.5000; val_optim_loss: 4926984.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9087; val_auprc_score: 0.9573; val_best_acc_score: 0.8960; val_best_f1_score: 0.9341; train_kl_reg_loss: 20270.9951; train_edge_recon_loss: 1365112.9062; train_cat_covariates_contrastive_loss: 631465.4531; train_gene_expr_recon_loss: 2854890.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4871740.1250; train_optim_loss: 4871740.1250; val_kl_reg_loss: 19751.4766; val_edge_recon_loss: 1373133.1250; val_cat_covariates_contrastive_loss: 630429.5000; val_gene_expr_recon_loss: 2871316.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4894630.0000; val_optim_loss: 4894630.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9117; val_auprc_score: 0.9610; val_best_acc_score: 0.8967; val_best_f1_score: 0.9350; train_kl_reg_loss: 19845.9343; train_edge_recon_loss: 1360471.9844; train_cat_covariates_contrastive_loss: 631654.5000; train_gene_expr_recon_loss: 2863283.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4875256.0625; train_optim_loss: 4875256.0625; val_kl_reg_loss: 19423.7617; val_edge_recon_loss: 1360237.6250; val_cat_covariates_contrastive_loss: 630341.5625; val_gene_expr_recon_loss: 2863701.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4873704.0000; val_optim_loss: 4873704.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9132; val_auprc_score: 0.9576; val_best_acc_score: 0.8975; val_best_f1_score: 0.9348; train_kl_reg_loss: 19407.8835; train_edge_recon_loss: 1375960.6562; train_cat_covariates_contrastive_loss: 632130.1875; train_gene_expr_recon_loss: 2841696.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4869195.5625; train_optim_loss: 4869195.5625; val_kl_reg_loss: 18728.3438; val_edge_recon_loss: 1390019.3750; val_cat_covariates_contrastive_loss: 630553.7500; val_gene_expr_recon_loss: 2858149.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4897450.5000; val_optim_loss: 4897450.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9115; val_auprc_score: 0.9573; val_best_acc_score: 0.9014; val_best_f1_score: 0.9370; train_kl_reg_loss: 19154.8315; train_edge_recon_loss: 1363223.7188; train_cat_covariates_contrastive_loss: 631688.4609; train_gene_expr_recon_loss: 2843035.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4857102.5625; train_optim_loss: 4857102.5625; val_kl_reg_loss: 18591.4102; val_edge_recon_loss: 1361497.5000; val_cat_covariates_contrastive_loss: 630554.1875; val_gene_expr_recon_loss: 2854639.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4865282.5000; val_optim_loss: 4865282.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9111; val_auprc_score: 0.9597; val_best_acc_score: 0.8982; val_best_f1_score: 0.9350; train_kl_reg_loss: 18442.3247; train_edge_recon_loss: 1361317.1250; train_cat_covariates_contrastive_loss: 632532.6094; train_gene_expr_recon_loss: 2828891.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4841183.6875; train_optim_loss: 4841183.6875; val_kl_reg_loss: 18033.1953; val_edge_recon_loss: 1384188.5000; val_cat_covariates_contrastive_loss: 631080.2500; val_gene_expr_recon_loss: 2845171.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4878473.0000; val_optim_loss: 4878473.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9161; val_auprc_score: 0.9617; val_best_acc_score: 0.9031; val_best_f1_score: 0.9385; train_kl_reg_loss: 18250.0286; train_edge_recon_loss: 1355836.5469; train_cat_covariates_contrastive_loss: 633105.8047; train_gene_expr_recon_loss: 2830864.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4838056.6250; train_optim_loss: 4838056.6250; val_kl_reg_loss: 17679.0996; val_edge_recon_loss: 1355909.2500; val_cat_covariates_contrastive_loss: 631732.4375; val_gene_expr_recon_loss: 2839023.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4844344.0000; val_optim_loss: 4844344.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9201; val_auprc_score: 0.9641; val_best_acc_score: 0.9060; val_best_f1_score: 0.9401; train_kl_reg_loss: 17862.4189; train_edge_recon_loss: 1348413.4688; train_cat_covariates_contrastive_loss: 632982.0078; train_gene_expr_recon_loss: 2824049.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4823307.6250; train_optim_loss: 4823307.6250; val_kl_reg_loss: 17583.0898; val_edge_recon_loss: 1360104.1250; val_cat_covariates_contrastive_loss: 631402.9375; val_gene_expr_recon_loss: 2837492.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4846583.0000; val_optim_loss: 4846583.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9196; val_auprc_score: 0.9618; val_best_acc_score: 0.9071; val_best_f1_score: 0.9402; train_kl_reg_loss: 17654.9905; train_edge_recon_loss: 1356089.9844; train_cat_covariates_contrastive_loss: 633173.5625; train_gene_expr_recon_loss: 2818159.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4825078.3750; train_optim_loss: 4825078.3750; val_kl_reg_loss: 17275.7891; val_edge_recon_loss: 1366325.0000; val_cat_covariates_contrastive_loss: 632078.0000; val_gene_expr_recon_loss: 2828869.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4844548.5000; val_optim_loss: 4844548.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9218; val_auprc_score: 0.9627; val_best_acc_score: 0.9091; val_best_f1_score: 0.9419; train_kl_reg_loss: 17289.5754; train_edge_recon_loss: 1348845.1562; train_cat_covariates_contrastive_loss: 633656.3906; train_gene_expr_recon_loss: 2809627.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4809419.0000; train_optim_loss: 4809419.0000; val_kl_reg_loss: 17002.6094; val_edge_recon_loss: 1373444.2500; val_cat_covariates_contrastive_loss: 632957.8125; val_gene_expr_recon_loss: 2824570.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4847975.0000; val_optim_loss: 4847975.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9211; val_auprc_score: 0.9642; val_best_acc_score: 0.9090; val_best_f1_score: 0.9421; train_kl_reg_loss: 17101.1785; train_edge_recon_loss: 1353550.4062; train_cat_covariates_contrastive_loss: 634203.0469; train_gene_expr_recon_loss: 2808051.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4812905.7500; train_optim_loss: 4812905.7500; val_kl_reg_loss: 16667.5625; val_edge_recon_loss: 1348872.5000; val_cat_covariates_contrastive_loss: 633586.1875; val_gene_expr_recon_loss: 2823751.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4822877.0000; val_optim_loss: 4822877.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9244; val_auprc_score: 0.9655; val_best_acc_score: 0.9099; val_best_f1_score: 0.9422; train_kl_reg_loss: 16900.1111; train_edge_recon_loss: 1338020.5312; train_cat_covariates_contrastive_loss: 634548.5469; train_gene_expr_recon_loss: 2803005.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4792474.3125; train_optim_loss: 4792474.3125; val_kl_reg_loss: 16568.0957; val_edge_recon_loss: 1367224.5000; val_cat_covariates_contrastive_loss: 634384.2500; val_gene_expr_recon_loss: 2815618.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4833795.0000; val_optim_loss: 4833795.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9204; val_auprc_score: 0.9641; val_best_acc_score: 0.9127; val_best_f1_score: 0.9443; train_kl_reg_loss: 16744.7310; train_edge_recon_loss: 1359551.2969; train_cat_covariates_contrastive_loss: 634880.8750; train_gene_expr_recon_loss: 2800652.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4811829.6875; train_optim_loss: 4811829.6875; val_kl_reg_loss: 16137.6143; val_edge_recon_loss: 1340909.8750; val_cat_covariates_contrastive_loss: 634543.6875; val_gene_expr_recon_loss: 2818006.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4809597.0000; val_optim_loss: 4809597.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9302; val_auprc_score: 0.9675; val_best_acc_score: 0.9172; val_best_f1_score: 0.9471; train_kl_reg_loss: 16463.3990; train_edge_recon_loss: 1335828.4219; train_cat_covariates_contrastive_loss: 635085.7812; train_gene_expr_recon_loss: 2789935.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4777313.5000; train_optim_loss: 4777313.5000; val_kl_reg_loss: 16270.8281; val_edge_recon_loss: 1339397.8750; val_cat_covariates_contrastive_loss: 634232.9375; val_gene_expr_recon_loss: 2809880.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4799782.0000; val_optim_loss: 4799782.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9322; val_auprc_score: 0.9680; val_best_acc_score: 0.9175; val_best_f1_score: 0.9475; train_kl_reg_loss: 16483.4854; train_edge_recon_loss: 1356953.4219; train_cat_covariates_contrastive_loss: 635281.1953; train_gene_expr_recon_loss: 2791634.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4800352.4375; train_optim_loss: 4800352.4375; val_kl_reg_loss: 16272.2363; val_edge_recon_loss: 1332641.7500; val_cat_covariates_contrastive_loss: 634374.6250; val_gene_expr_recon_loss: 2806670.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4789959.0000; val_optim_loss: 4789959.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9229; val_auprc_score: 0.9616; val_best_acc_score: 0.9159; val_best_f1_score: 0.9462; train_kl_reg_loss: 16344.1744; train_edge_recon_loss: 1350241.2188; train_cat_covariates_contrastive_loss: 636278.1875; train_gene_expr_recon_loss: 2785899.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4788762.8125; train_optim_loss: 4788762.8125; val_kl_reg_loss: 15960.9951; val_edge_recon_loss: 1352206.3750; val_cat_covariates_contrastive_loss: 634489.1875; val_gene_expr_recon_loss: 2801253.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4803909.5000; val_optim_loss: 4803909.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9345; val_auprc_score: 0.9675; val_best_acc_score: 0.9213; val_best_f1_score: 0.9492; train_kl_reg_loss: 16015.9203; train_edge_recon_loss: 1329185.5469; train_cat_covariates_contrastive_loss: 635972.9062; train_gene_expr_recon_loss: 2783936.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4765111.1250; train_optim_loss: 4765111.1250; val_kl_reg_loss: 15574.3730; val_edge_recon_loss: 1355518.0000; val_cat_covariates_contrastive_loss: 634563.9375; val_gene_expr_recon_loss: 2799874.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4805530.0000; val_optim_loss: 4805530.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9278; val_auprc_score: 0.9637; val_best_acc_score: 0.9167; val_best_f1_score: 0.9466; train_kl_reg_loss: 15916.9291; train_edge_recon_loss: 1351200.2188; train_cat_covariates_contrastive_loss: 635866.8906; train_gene_expr_recon_loss: 2778929.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4781913.5625; train_optim_loss: 4781913.5625; val_kl_reg_loss: 15565.1016; val_edge_recon_loss: 1370765.7500; val_cat_covariates_contrastive_loss: 635494.9375; val_gene_expr_recon_loss: 2795204.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4817030.5000; val_optim_loss: 4817030.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9228; val_auprc_score: 0.9637; val_best_acc_score: 0.9143; val_best_f1_score: 0.9455; train_kl_reg_loss: 15819.2157; train_edge_recon_loss: 1340313.7656; train_cat_covariates_contrastive_loss: 636037.1562; train_gene_expr_recon_loss: 2778494.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4770664.4375; train_optim_loss: 4770664.4375; val_kl_reg_loss: 15751.5957; val_edge_recon_loss: 1354291.2500; val_cat_covariates_contrastive_loss: 634090.5625; val_gene_expr_recon_loss: 2791310.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4795444.0000; val_optim_loss: 4795444.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9262; val_auprc_score: 0.9648; val_best_acc_score: 0.9155; val_best_f1_score: 0.9462; train_kl_reg_loss: 15812.0983; train_edge_recon_loss: 1338433.0938; train_cat_covariates_contrastive_loss: 636358.3203; train_gene_expr_recon_loss: 2772265.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4762869.2500; train_optim_loss: 4762869.2500; val_kl_reg_loss: 15520.6641; val_edge_recon_loss: 1344308.8750; val_cat_covariates_contrastive_loss: 634302.2500; val_gene_expr_recon_loss: 2788471.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4782603.0000; val_optim_loss: 4782603.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9324; val_auprc_score: 0.9690; val_best_acc_score: 0.9241; val_best_f1_score: 0.9521; train_kl_reg_loss: 15675.3015; train_edge_recon_loss: 1326159.1094; train_cat_covariates_contrastive_loss: 635891.5625; train_gene_expr_recon_loss: 2777155.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4754881.3750; train_optim_loss: 4754881.3750; val_kl_reg_loss: 15543.4258; val_edge_recon_loss: 1288819.3750; val_cat_covariates_contrastive_loss: 634261.9375; val_gene_expr_recon_loss: 2791136.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4729761.0000; val_optim_loss: 4729761.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9237; val_auprc_score: 0.9649; val_best_acc_score: 0.9140; val_best_f1_score: 0.9451; train_kl_reg_loss: 15690.8698; train_edge_recon_loss: 1348176.4688; train_cat_covariates_contrastive_loss: 636051.3203; train_gene_expr_recon_loss: 2773820.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4773739.0625; train_optim_loss: 4773739.0625; val_kl_reg_loss: 15534.4199; val_edge_recon_loss: 1360402.8750; val_cat_covariates_contrastive_loss: 635427.6250; val_gene_expr_recon_loss: 2792361.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4803726.5000; val_optim_loss: 4803726.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9280; val_auprc_score: 0.9644; val_best_acc_score: 0.9155; val_best_f1_score: 0.9455; train_kl_reg_loss: 15634.1840; train_edge_recon_loss: 1334120.4375; train_cat_covariates_contrastive_loss: 636125.4922; train_gene_expr_recon_loss: 2769560.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4755440.3750; train_optim_loss: 4755440.3750; val_kl_reg_loss: 15466.3145; val_edge_recon_loss: 1366316.8750; val_cat_covariates_contrastive_loss: 635769.9375; val_gene_expr_recon_loss: 2788283.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4805837.0000; val_optim_loss: 4805837.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9272; val_auprc_score: 0.9650; val_best_acc_score: 0.9159; val_best_f1_score: 0.9466; train_kl_reg_loss: 15685.0276; train_edge_recon_loss: 1344797.1406; train_cat_covariates_contrastive_loss: 636314.7578; train_gene_expr_recon_loss: 2771976.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4768773.3125; train_optim_loss: 4768773.3125; val_kl_reg_loss: 15496.5977; val_edge_recon_loss: 1345759.1250; val_cat_covariates_contrastive_loss: 635951.6250; val_gene_expr_recon_loss: 2787692.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4784899.5000; val_optim_loss: 4784899.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9260; val_auprc_score: 0.9644; val_best_acc_score: 0.9205; val_best_f1_score: 0.9496; train_kl_reg_loss: 15739.1652; train_edge_recon_loss: 1330540.7969; train_cat_covariates_contrastive_loss: 636077.2266; train_gene_expr_recon_loss: 2773793.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4756150.8750; train_optim_loss: 4756150.8750; val_kl_reg_loss: 15587.0508; val_edge_recon_loss: 1307454.7500; val_cat_covariates_contrastive_loss: 635236.7500; val_gene_expr_recon_loss: 2789962.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4748241.0000; val_optim_loss: 4748241.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9308; val_auprc_score: 0.9663; val_best_acc_score: 0.9185; val_best_f1_score: 0.9476; train_kl_reg_loss: 15705.3188; train_edge_recon_loss: 1343247.5156; train_cat_covariates_contrastive_loss: 636199.8516; train_gene_expr_recon_loss: 2778196.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4773348.6250; train_optim_loss: 4773348.6250; val_kl_reg_loss: 15512.2012; val_edge_recon_loss: 1356109.6250; val_cat_covariates_contrastive_loss: 634556.3125; val_gene_expr_recon_loss: 2788374.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4794553.0000; val_optim_loss: 4794553.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9264; val_auprc_score: 0.9651; val_best_acc_score: 0.9191; val_best_f1_score: 0.9480; train_kl_reg_loss: 15721.2942; train_edge_recon_loss: 1344140.3906; train_cat_covariates_contrastive_loss: 636142.5156; train_gene_expr_recon_loss: 2772077.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4768081.4375; train_optim_loss: 4768081.4375; val_kl_reg_loss: 15560.3223; val_edge_recon_loss: 1336709.0000; val_cat_covariates_contrastive_loss: 634843.1250; val_gene_expr_recon_loss: 2788742.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4775854.5000; val_optim_loss: 4775854.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9260; val_auprc_score: 0.9642; val_best_acc_score: 0.9187; val_best_f1_score: 0.9483; train_kl_reg_loss: 15670.4908; train_edge_recon_loss: 1344428.1406; train_cat_covariates_contrastive_loss: 636178.3438; train_gene_expr_recon_loss: 2770225.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4766502.2500; train_optim_loss: 4766502.2500; val_kl_reg_loss: 15555.5752; val_edge_recon_loss: 1331951.7500; val_cat_covariates_contrastive_loss: 634214.3750; val_gene_expr_recon_loss: 2788761.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4770483.0000; val_optim_loss: 4770483.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9332; val_auprc_score: 0.9670; val_best_acc_score: 0.9232; val_best_f1_score: 0.9507; train_kl_reg_loss: 15696.4586; train_edge_recon_loss: 1337586.7188; train_cat_covariates_contrastive_loss: 636510.9922; train_gene_expr_recon_loss: 2777876.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4767670.8750; train_optim_loss: 4767670.8750; val_kl_reg_loss: 15480.7939; val_edge_recon_loss: 1327122.5000; val_cat_covariates_contrastive_loss: 634940.0000; val_gene_expr_recon_loss: 2790742.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4768285.0000; val_optim_loss: 4768285.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 34 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
val AUROC score: 0.9171
val AUPRC score: 0.9581
val best accuracy score: 0.9093
val best F1 score: 0.9417
val target rna MSE score: 0.9863
val source rna MSE score: 0.2478
Val cat covariate0 mean sim diff: -0.0059
Val cat covariate1 mean sim diff: -0.1180
Duration of model training in run 4: 0 hours, 3 minutes and 38 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 12706
Number of validation nodes: 1412
Number of training edges: 59255
Number of validation edges: 6583
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9519; val_auprc_score: 0.9817; val_best_acc_score: 0.8102; val_best_f1_score: 0.8876; train_kl_reg_loss: 1530.0235; train_edge_recon_loss: 1806501.7969; train_cat_covariates_contrastive_loss: 962264.7969; train_gene_expr_recon_loss: 4004988.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6775285.3125; train_optim_loss: 6775285.3125; val_kl_reg_loss: 4615.5674; val_edge_recon_loss: 2054893.3750; val_cat_covariates_contrastive_loss: 627040.4375; val_gene_expr_recon_loss: 3809056.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6495606.0000; val_optim_loss: 6495606.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9476; val_auprc_score: 0.9813; val_best_acc_score: 0.8224; val_best_f1_score: 0.8942; train_kl_reg_loss: 5623.6933; train_edge_recon_loss: 1988168.3125; train_cat_covariates_contrastive_loss: 637460.0156; train_gene_expr_recon_loss: 3756231.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6387483.8750; train_optim_loss: 6387483.8750; val_kl_reg_loss: 4260.2783; val_edge_recon_loss: 2040854.1250; val_cat_covariates_contrastive_loss: 626986.0625; val_gene_expr_recon_loss: 3606364.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6278465.0000; val_optim_loss: 6278465.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9275; val_auprc_score: 0.9732; val_best_acc_score: 0.8506; val_best_f1_score: 0.9084; train_kl_reg_loss: 2869.2261; train_edge_recon_loss: 1873045.0625; train_cat_covariates_contrastive_loss: 685175.7500; train_gene_expr_recon_loss: 3606445.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6167535.6875; train_optim_loss: 6167535.6875; val_kl_reg_loss: 2334.2690; val_edge_recon_loss: 1973745.5000; val_cat_covariates_contrastive_loss: 627277.3125; val_gene_expr_recon_loss: 3496490.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6099847.0000; val_optim_loss: 6099847.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8829; val_auprc_score: 0.9536; val_best_acc_score: 0.8372; val_best_f1_score: 0.8993; train_kl_reg_loss: 2843.3005; train_edge_recon_loss: 1794450.5156; train_cat_covariates_contrastive_loss: 684302.1328; train_gene_expr_recon_loss: 3486322.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5967918.6875; train_optim_loss: 5967918.6875; val_kl_reg_loss: 3058.9612; val_edge_recon_loss: 1987097.0000; val_cat_covariates_contrastive_loss: 627703.6875; val_gene_expr_recon_loss: 3402436.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6020296.0000; val_optim_loss: 6020296.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8509; val_auprc_score: 0.9378; val_best_acc_score: 0.8357; val_best_f1_score: 0.9004; train_kl_reg_loss: 4204.3210; train_edge_recon_loss: 1728516.9531; train_cat_covariates_contrastive_loss: 672684.2891; train_gene_expr_recon_loss: 3394305.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5799711.2500; train_optim_loss: 5799711.2500; val_kl_reg_loss: 5081.6875; val_edge_recon_loss: 1818166.5000; val_cat_covariates_contrastive_loss: 627972.8750; val_gene_expr_recon_loss: 3304472.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5755693.0000; val_optim_loss: 5755693.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8392; val_auprc_score: 0.9298; val_best_acc_score: 0.8275; val_best_f1_score: 0.8937; train_kl_reg_loss: 6866.5248; train_edge_recon_loss: 1667978.1406; train_cat_covariates_contrastive_loss: 662213.2500; train_gene_expr_recon_loss: 3296660.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5633718.7500; train_optim_loss: 5633718.7500; val_kl_reg_loss: 8533.3252; val_edge_recon_loss: 1739073.7500; val_cat_covariates_contrastive_loss: 627917.2500; val_gene_expr_recon_loss: 3211295.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5586819.5000; val_optim_loss: 5586819.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8295; val_auprc_score: 0.9295; val_best_acc_score: 0.8307; val_best_f1_score: 0.8962; train_kl_reg_loss: 11388.7949; train_edge_recon_loss: 1612028.6562; train_cat_covariates_contrastive_loss: 653106.5547; train_gene_expr_recon_loss: 3217213.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5493737.0000; train_optim_loss: 5493737.0000; val_kl_reg_loss: 14931.1094; val_edge_recon_loss: 1600933.2500; val_cat_covariates_contrastive_loss: 627921.4375; val_gene_expr_recon_loss: 3147624.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5391410.0000; val_optim_loss: 5391410.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8371; val_auprc_score: 0.9318; val_best_acc_score: 0.8232; val_best_f1_score: 0.8914; train_kl_reg_loss: 18273.6738; train_edge_recon_loss: 1573313.5938; train_cat_covariates_contrastive_loss: 636846.3359; train_gene_expr_recon_loss: 3154822.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5383256.0000; train_optim_loss: 5383256.0000; val_kl_reg_loss: 21235.9141; val_edge_recon_loss: 1593222.6250; val_cat_covariates_contrastive_loss: 627633.8125; val_gene_expr_recon_loss: 3095332.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5337425.0000; val_optim_loss: 5337425.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8350; val_auprc_score: 0.9293; val_best_acc_score: 0.8239; val_best_f1_score: 0.8909; train_kl_reg_loss: 23868.0471; train_edge_recon_loss: 1547287.9844; train_cat_covariates_contrastive_loss: 630804.4609; train_gene_expr_recon_loss: 3091264.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5293224.6875; train_optim_loss: 5293224.6875; val_kl_reg_loss: 24877.8906; val_edge_recon_loss: 1536852.1250; val_cat_covariates_contrastive_loss: 627588.2500; val_gene_expr_recon_loss: 3047971.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5237289.5000; val_optim_loss: 5237289.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8402; val_auprc_score: 0.9338; val_best_acc_score: 0.8403; val_best_f1_score: 0.9012; train_kl_reg_loss: 26101.2830; train_edge_recon_loss: 1505547.0312; train_cat_covariates_contrastive_loss: 629431.0156; train_gene_expr_recon_loss: 3066883.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5227962.5000; train_optim_loss: 5227962.5000; val_kl_reg_loss: 25688.7207; val_edge_recon_loss: 1462412.8750; val_cat_covariates_contrastive_loss: 627270.8750; val_gene_expr_recon_loss: 3008678.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5124051.0000; val_optim_loss: 5124051.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8484; val_auprc_score: 0.9379; val_best_acc_score: 0.8430; val_best_f1_score: 0.9037; train_kl_reg_loss: 26400.8184; train_edge_recon_loss: 1485300.0469; train_cat_covariates_contrastive_loss: 628848.5938; train_gene_expr_recon_loss: 3024141.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5164691.3750; train_optim_loss: 5164691.3750; val_kl_reg_loss: 25215.5000; val_edge_recon_loss: 1466217.2500; val_cat_covariates_contrastive_loss: 627601.0625; val_gene_expr_recon_loss: 2973354.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5092388.0000; val_optim_loss: 5092388.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8581; val_auprc_score: 0.9394; val_best_acc_score: 0.8431; val_best_f1_score: 0.9036; train_kl_reg_loss: 26522.8364; train_edge_recon_loss: 1478623.6406; train_cat_covariates_contrastive_loss: 628779.3516; train_gene_expr_recon_loss: 2993001.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5126927.6875; train_optim_loss: 5126927.6875; val_kl_reg_loss: 24412.9395; val_edge_recon_loss: 1480198.3750; val_cat_covariates_contrastive_loss: 627399.8125; val_gene_expr_recon_loss: 2942800.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5074811.0000; val_optim_loss: 5074811.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8623; val_auprc_score: 0.9391; val_best_acc_score: 0.8442; val_best_f1_score: 0.9033; train_kl_reg_loss: 24689.7080; train_edge_recon_loss: 1465615.7656; train_cat_covariates_contrastive_loss: 629870.1250; train_gene_expr_recon_loss: 2956039.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5076215.3125; train_optim_loss: 5076215.3125; val_kl_reg_loss: 24198.1289; val_edge_recon_loss: 1501929.0000; val_cat_covariates_contrastive_loss: 627672.0000; val_gene_expr_recon_loss: 2919781.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5073581.0000; val_optim_loss: 5073581.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8786; val_auprc_score: 0.9459; val_best_acc_score: 0.8532; val_best_f1_score: 0.9079; train_kl_reg_loss: 23503.1653; train_edge_recon_loss: 1433713.3906; train_cat_covariates_contrastive_loss: 630338.6719; train_gene_expr_recon_loss: 2945190.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5032745.3750; train_optim_loss: 5032745.3750; val_kl_reg_loss: 21505.7285; val_edge_recon_loss: 1465141.8750; val_cat_covariates_contrastive_loss: 628132.3750; val_gene_expr_recon_loss: 2903196.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5017977.0000; val_optim_loss: 5017977.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8794; val_auprc_score: 0.9474; val_best_acc_score: 0.8621; val_best_f1_score: 0.9139; train_kl_reg_loss: 22226.3613; train_edge_recon_loss: 1421299.5469; train_cat_covariates_contrastive_loss: 631060.1719; train_gene_expr_recon_loss: 2924541.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4999127.2500; train_optim_loss: 4999127.2500; val_kl_reg_loss: 21278.5840; val_edge_recon_loss: 1429223.6250; val_cat_covariates_contrastive_loss: 628621.9375; val_gene_expr_recon_loss: 2888006.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4967131.0000; val_optim_loss: 4967131.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8980; val_auprc_score: 0.9539; val_best_acc_score: 0.8852; val_best_f1_score: 0.9265; train_kl_reg_loss: 21365.3694; train_edge_recon_loss: 1401915.9062; train_cat_covariates_contrastive_loss: 631113.5781; train_gene_expr_recon_loss: 2910624.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4965019.6875; train_optim_loss: 4965019.6875; val_kl_reg_loss: 20393.2305; val_edge_recon_loss: 1397887.3750; val_cat_covariates_contrastive_loss: 628930.1875; val_gene_expr_recon_loss: 2876249.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4923460.0000; val_optim_loss: 4923460.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8996; val_auprc_score: 0.9514; val_best_acc_score: 0.8925; val_best_f1_score: 0.9313; train_kl_reg_loss: 21252.0327; train_edge_recon_loss: 1388224.6875; train_cat_covariates_contrastive_loss: 631102.8594; train_gene_expr_recon_loss: 2904200.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4944779.9375; train_optim_loss: 4944779.9375; val_kl_reg_loss: 20937.2051; val_edge_recon_loss: 1398560.2500; val_cat_covariates_contrastive_loss: 629440.6875; val_gene_expr_recon_loss: 2863342.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4912281.0000; val_optim_loss: 4912281.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9053; val_auprc_score: 0.9550; val_best_acc_score: 0.8933; val_best_f1_score: 0.9318; train_kl_reg_loss: 21774.2024; train_edge_recon_loss: 1378697.9531; train_cat_covariates_contrastive_loss: 630864.6406; train_gene_expr_recon_loss: 2887265.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4918602.6250; train_optim_loss: 4918602.6250; val_kl_reg_loss: 21240.9727; val_edge_recon_loss: 1400300.0000; val_cat_covariates_contrastive_loss: 629597.0625; val_gene_expr_recon_loss: 2850027.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4901165.5000; val_optim_loss: 4901165.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9080; val_auprc_score: 0.9568; val_best_acc_score: 0.8919; val_best_f1_score: 0.9316; train_kl_reg_loss: 21539.3562; train_edge_recon_loss: 1383013.5156; train_cat_covariates_contrastive_loss: 631043.3516; train_gene_expr_recon_loss: 2873671.4688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4909267.8125; train_optim_loss: 4909267.8125; val_kl_reg_loss: 20699.7930; val_edge_recon_loss: 1380790.5000; val_cat_covariates_contrastive_loss: 629833.1250; val_gene_expr_recon_loss: 2843000.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4874323.5000; val_optim_loss: 4874323.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9081; val_auprc_score: 0.9564; val_best_acc_score: 0.8928; val_best_f1_score: 0.9314; train_kl_reg_loss: 20718.7886; train_edge_recon_loss: 1375157.5156; train_cat_covariates_contrastive_loss: 631275.4062; train_gene_expr_recon_loss: 2861852.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4889004.4375; train_optim_loss: 4889004.4375; val_kl_reg_loss: 20063.5781; val_edge_recon_loss: 1395939.8750; val_cat_covariates_contrastive_loss: 629697.1875; val_gene_expr_recon_loss: 2831693.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4877394.0000; val_optim_loss: 4877394.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9096; val_auprc_score: 0.9577; val_best_acc_score: 0.8953; val_best_f1_score: 0.9334; train_kl_reg_loss: 20472.2100; train_edge_recon_loss: 1365153.1562; train_cat_covariates_contrastive_loss: 631214.2266; train_gene_expr_recon_loss: 2860727.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4877566.5625; train_optim_loss: 4877566.5625; val_kl_reg_loss: 19518.1133; val_edge_recon_loss: 1383951.6250; val_cat_covariates_contrastive_loss: 629983.3125; val_gene_expr_recon_loss: 2827706.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4861159.0000; val_optim_loss: 4861159.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9164; val_auprc_score: 0.9627; val_best_acc_score: 0.8996; val_best_f1_score: 0.9361; train_kl_reg_loss: 19986.7598; train_edge_recon_loss: 1375209.5312; train_cat_covariates_contrastive_loss: 631710.1094; train_gene_expr_recon_loss: 2852813.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4879720.1250; train_optim_loss: 4879720.1250; val_kl_reg_loss: 19421.8828; val_edge_recon_loss: 1358252.7500; val_cat_covariates_contrastive_loss: 630650.6250; val_gene_expr_recon_loss: 2821385.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4829711.0000; val_optim_loss: 4829711.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9097; val_auprc_score: 0.9564; val_best_acc_score: 0.8970; val_best_f1_score: 0.9338; train_kl_reg_loss: 19599.1985; train_edge_recon_loss: 1372395.4688; train_cat_covariates_contrastive_loss: 631617.1094; train_gene_expr_recon_loss: 2849579.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4873191.1875; train_optim_loss: 4873191.1875; val_kl_reg_loss: 18993.4844; val_edge_recon_loss: 1398757.7500; val_cat_covariates_contrastive_loss: 630663.6875; val_gene_expr_recon_loss: 2815461.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4863877.0000; val_optim_loss: 4863877.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9087; val_auprc_score: 0.9563; val_best_acc_score: 0.8981; val_best_f1_score: 0.9349; train_kl_reg_loss: 19415.6562; train_edge_recon_loss: 1364548.2344; train_cat_covariates_contrastive_loss: 631655.8906; train_gene_expr_recon_loss: 2844739.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4860359.3125; train_optim_loss: 4860359.3125; val_kl_reg_loss: 18797.4590; val_edge_recon_loss: 1398508.1250; val_cat_covariates_contrastive_loss: 630504.9375; val_gene_expr_recon_loss: 2806570.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4854381.0000; val_optim_loss: 4854381.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9163; val_auprc_score: 0.9605; val_best_acc_score: 0.9036; val_best_f1_score: 0.9383; train_kl_reg_loss: 18838.7122; train_edge_recon_loss: 1356382.5938; train_cat_covariates_contrastive_loss: 632153.8672; train_gene_expr_recon_loss: 2836338.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4843713.6250; train_optim_loss: 4843713.6250; val_kl_reg_loss: 18111.9102; val_edge_recon_loss: 1362200.5000; val_cat_covariates_contrastive_loss: 630538.4375; val_gene_expr_recon_loss: 2803200.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4814051.0000; val_optim_loss: 4814051.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9186; val_auprc_score: 0.9602; val_best_acc_score: 0.9057; val_best_f1_score: 0.9394; train_kl_reg_loss: 18336.9783; train_edge_recon_loss: 1359239.0000; train_cat_covariates_contrastive_loss: 632577.5938; train_gene_expr_recon_loss: 2825536.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4835689.8125; train_optim_loss: 4835689.8125; val_kl_reg_loss: 17633.1328; val_edge_recon_loss: 1376230.2500; val_cat_covariates_contrastive_loss: 631056.0000; val_gene_expr_recon_loss: 2797851.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4822771.0000; val_optim_loss: 4822771.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9195; val_auprc_score: 0.9606; val_best_acc_score: 0.9076; val_best_f1_score: 0.9410; train_kl_reg_loss: 17970.7449; train_edge_recon_loss: 1336260.2031; train_cat_covariates_contrastive_loss: 632630.1172; train_gene_expr_recon_loss: 2819729.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4806590.1250; train_optim_loss: 4806590.1250; val_kl_reg_loss: 17331.6523; val_edge_recon_loss: 1352703.6250; val_cat_covariates_contrastive_loss: 632383.1875; val_gene_expr_recon_loss: 2796291.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4798709.5000; val_optim_loss: 4798709.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9256; val_auprc_score: 0.9646; val_best_acc_score: 0.9122; val_best_f1_score: 0.9433; train_kl_reg_loss: 17562.2019; train_edge_recon_loss: 1353861.9688; train_cat_covariates_contrastive_loss: 633355.5391; train_gene_expr_recon_loss: 2816449.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4821229.5000; train_optim_loss: 4821229.5000; val_kl_reg_loss: 16808.1172; val_edge_recon_loss: 1357909.2500; val_cat_covariates_contrastive_loss: 632620.1250; val_gene_expr_recon_loss: 2785189.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4792526.5000; val_optim_loss: 4792526.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9254; val_auprc_score: 0.9662; val_best_acc_score: 0.9061; val_best_f1_score: 0.9401; train_kl_reg_loss: 17159.1323; train_edge_recon_loss: 1349800.1562; train_cat_covariates_contrastive_loss: 633429.3828; train_gene_expr_recon_loss: 2813387.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4813775.8125; train_optim_loss: 4813775.8125; val_kl_reg_loss: 16778.5449; val_edge_recon_loss: 1373019.3750; val_cat_covariates_contrastive_loss: 632977.8125; val_gene_expr_recon_loss: 2786514.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4809290.0000; val_optim_loss: 4809290.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9218; val_auprc_score: 0.9607; val_best_acc_score: 0.9137; val_best_f1_score: 0.9446; train_kl_reg_loss: 16831.6250; train_edge_recon_loss: 1350871.1719; train_cat_covariates_contrastive_loss: 633843.4375; train_gene_expr_recon_loss: 2811139.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4812685.3125; train_optim_loss: 4812685.3125; val_kl_reg_loss: 16442.3848; val_edge_recon_loss: 1383640.7500; val_cat_covariates_contrastive_loss: 632969.9375; val_gene_expr_recon_loss: 2781291.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4814344.5000; val_optim_loss: 4814344.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9185; val_auprc_score: 0.9608; val_best_acc_score: 0.9117; val_best_f1_score: 0.9439; train_kl_reg_loss: 16720.0679; train_edge_recon_loss: 1345707.0469; train_cat_covariates_contrastive_loss: 633868.2344; train_gene_expr_recon_loss: 2804997.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4801292.8750; train_optim_loss: 4801292.8750; val_kl_reg_loss: 16269.2344; val_edge_recon_loss: 1339708.8750; val_cat_covariates_contrastive_loss: 632503.5000; val_gene_expr_recon_loss: 2777762.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4766243.5000; val_optim_loss: 4766243.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9274; val_auprc_score: 0.9652; val_best_acc_score: 0.9177; val_best_f1_score: 0.9473; train_kl_reg_loss: 16246.0658; train_edge_recon_loss: 1346886.5469; train_cat_covariates_contrastive_loss: 634724.0234; train_gene_expr_recon_loss: 2804185.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4802042.0000; train_optim_loss: 4802042.0000; val_kl_reg_loss: 15865.8994; val_edge_recon_loss: 1360825.1250; val_cat_covariates_contrastive_loss: 633789.1875; val_gene_expr_recon_loss: 2778241.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4788721.5000; val_optim_loss: 4788721.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9308; val_auprc_score: 0.9645; val_best_acc_score: 0.9199; val_best_f1_score: 0.9486; train_kl_reg_loss: 16292.9656; train_edge_recon_loss: 1346727.3281; train_cat_covariates_contrastive_loss: 634818.6641; train_gene_expr_recon_loss: 2800415.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4798254.6250; train_optim_loss: 4798254.6250; val_kl_reg_loss: 15908.6055; val_edge_recon_loss: 1340266.3750; val_cat_covariates_contrastive_loss: 633891.9375; val_gene_expr_recon_loss: 2768584.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4758651.0000; val_optim_loss: 4758651.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9248; val_auprc_score: 0.9621; val_best_acc_score: 0.9158; val_best_f1_score: 0.9460; train_kl_reg_loss: 16205.0475; train_edge_recon_loss: 1340059.1719; train_cat_covariates_contrastive_loss: 634980.7812; train_gene_expr_recon_loss: 2797588.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4788833.6250; train_optim_loss: 4788833.6250; val_kl_reg_loss: 15669.4873; val_edge_recon_loss: 1389584.7500; val_cat_covariates_contrastive_loss: 633304.0000; val_gene_expr_recon_loss: 2765034.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4803592.5000; val_optim_loss: 4803592.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9259; val_auprc_score: 0.9637; val_best_acc_score: 0.9229; val_best_f1_score: 0.9511; train_kl_reg_loss: 16064.8643; train_edge_recon_loss: 1340530.5312; train_cat_covariates_contrastive_loss: 635401.5312; train_gene_expr_recon_loss: 2792653.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4784650.6875; train_optim_loss: 4784650.6875; val_kl_reg_loss: 15670.6777; val_edge_recon_loss: 1309786.1250; val_cat_covariates_contrastive_loss: 633214.3750; val_gene_expr_recon_loss: 2762845.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4721516.5000; val_optim_loss: 4721516.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9251; val_auprc_score: 0.9642; val_best_acc_score: 0.9185; val_best_f1_score: 0.9481; train_kl_reg_loss: 15759.5009; train_edge_recon_loss: 1338041.2344; train_cat_covariates_contrastive_loss: 635214.6641; train_gene_expr_recon_loss: 2778643.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4767658.4375; train_optim_loss: 4767658.4375; val_kl_reg_loss: 15348.0801; val_edge_recon_loss: 1337429.1250; val_cat_covariates_contrastive_loss: 635117.3125; val_gene_expr_recon_loss: 2758784.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4746679.0000; val_optim_loss: 4746679.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9316; val_auprc_score: 0.9670; val_best_acc_score: 0.9218; val_best_f1_score: 0.9498; train_kl_reg_loss: 15700.3882; train_edge_recon_loss: 1346983.3750; train_cat_covariates_contrastive_loss: 634962.6250; train_gene_expr_recon_loss: 2781832.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4779478.4375; train_optim_loss: 4779478.4375; val_kl_reg_loss: 15290.9395; val_edge_recon_loss: 1362841.2500; val_cat_covariates_contrastive_loss: 634303.3750; val_gene_expr_recon_loss: 2755841.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4768277.0000; val_optim_loss: 4768277.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9243; val_auprc_score: 0.9618; val_best_acc_score: 0.9191; val_best_f1_score: 0.9482; train_kl_reg_loss: 15670.8148; train_edge_recon_loss: 1341272.4688; train_cat_covariates_contrastive_loss: 635853.6328; train_gene_expr_recon_loss: 2779890.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4772687.5625; train_optim_loss: 4772687.5625; val_kl_reg_loss: 15115.9180; val_edge_recon_loss: 1362557.5000; val_cat_covariates_contrastive_loss: 634981.0625; val_gene_expr_recon_loss: 2754120.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4766775.0000; val_optim_loss: 4766775.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9279; val_auprc_score: 0.9646; val_best_acc_score: 0.9234; val_best_f1_score: 0.9507; train_kl_reg_loss: 15365.4226; train_edge_recon_loss: 1339617.0625; train_cat_covariates_contrastive_loss: 634875.6328; train_gene_expr_recon_loss: 2778047.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4767905.1875; train_optim_loss: 4767905.1875; val_kl_reg_loss: 14952.1289; val_edge_recon_loss: 1354349.0000; val_cat_covariates_contrastive_loss: 633968.6875; val_gene_expr_recon_loss: 2751520.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4754790.0000; val_optim_loss: 4754790.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9231; val_auprc_score: 0.9596; val_best_acc_score: 0.9225; val_best_f1_score: 0.9503; train_kl_reg_loss: 15268.5940; train_edge_recon_loss: 1349699.2812; train_cat_covariates_contrastive_loss: 635501.0859; train_gene_expr_recon_loss: 2780055.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4780524.8125; train_optim_loss: 4780524.8125; val_kl_reg_loss: 14814.0703; val_edge_recon_loss: 1340745.6250; val_cat_covariates_contrastive_loss: 634182.5625; val_gene_expr_recon_loss: 2745701.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4735443.0000; val_optim_loss: 4735443.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9336; val_auprc_score: 0.9678; val_best_acc_score: 0.9252; val_best_f1_score: 0.9520; train_kl_reg_loss: 15115.5731; train_edge_recon_loss: 1346226.9688; train_cat_covariates_contrastive_loss: 635468.5859; train_gene_expr_recon_loss: 2782832.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4779643.7500; train_optim_loss: 4779643.7500; val_kl_reg_loss: 14768.3711; val_edge_recon_loss: 1342315.6250; val_cat_covariates_contrastive_loss: 635736.2500; val_gene_expr_recon_loss: 2746529.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4739350.0000; val_optim_loss: 4739350.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9344; val_auprc_score: 0.9676; val_best_acc_score: 0.9250; val_best_f1_score: 0.9518; train_kl_reg_loss: 15081.2164; train_edge_recon_loss: 1335032.8594; train_cat_covariates_contrastive_loss: 635129.7500; train_gene_expr_recon_loss: 2766453.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4751697.2500; train_optim_loss: 4751697.2500; val_kl_reg_loss: 14855.4355; val_edge_recon_loss: 1332269.7500; val_cat_covariates_contrastive_loss: 634473.5625; val_gene_expr_recon_loss: 2750117.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4731716.0000; val_optim_loss: 4731716.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9310; val_auprc_score: 0.9656; val_best_acc_score: 0.9225; val_best_f1_score: 0.9503; train_kl_reg_loss: 15159.0168; train_edge_recon_loss: 1333257.7188; train_cat_covariates_contrastive_loss: 635383.8594; train_gene_expr_recon_loss: 2767646.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4751447.1875; train_optim_loss: 4751447.1875; val_kl_reg_loss: 14837.6611; val_edge_recon_loss: 1338200.8750; val_cat_covariates_contrastive_loss: 634429.9375; val_gene_expr_recon_loss: 2746785.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4734253.5000; val_optim_loss: 4734253.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 9 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
val AUROC score: 0.9208
val AUPRC score: 0.9603
val best accuracy score: 0.9176
val best F1 score: 0.9469
val target rna MSE score: 1.0267
val source rna MSE score: 0.3074
Val cat covariate0 mean sim diff: 0.0051
Val cat covariate1 mean sim diff: -0.1090
Duration of model training in run 3: 0 hours, 3 minutes and 12 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 12706
Number of validation nodes: 1412
Number of training edges: 30579
Number of validation edges: 3397
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8636; val_auprc_score: 0.9489; val_best_acc_score: 0.7539; val_best_f1_score: 0.8597; train_kl_reg_loss: 482.8602; train_edge_recon_loss: 1754704.9375; train_cat_covariates_contrastive_loss: 1177752.2656; train_gene_expr_recon_loss: 4053055.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6985995.2500; train_optim_loss: 6985995.2500; val_kl_reg_loss: 1363.9738; val_edge_recon_loss: 2032624.8750; val_cat_covariates_contrastive_loss: 629090.3125; val_gene_expr_recon_loss: 3891183.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6554263.0000; val_optim_loss: 6554263.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8731; val_auprc_score: 0.9511; val_best_acc_score: 0.8093; val_best_f1_score: 0.8853; train_kl_reg_loss: 2068.6256; train_edge_recon_loss: 1815445.8125; train_cat_covariates_contrastive_loss: 760345.4531; train_gene_expr_recon_loss: 3842917.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6420776.7500; train_optim_loss: 6420776.7500; val_kl_reg_loss: 3290.9458; val_edge_recon_loss: 2087839.0000; val_cat_covariates_contrastive_loss: 627615.5000; val_gene_expr_recon_loss: 3812916.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6531662.0000; val_optim_loss: 6531662.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8784; val_auprc_score: 0.9568; val_best_acc_score: 0.8217; val_best_f1_score: 0.8941; train_kl_reg_loss: 3752.6293; train_edge_recon_loss: 1926241.2812; train_cat_covariates_contrastive_loss: 654744.0781; train_gene_expr_recon_loss: 3771625.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6356363.1250; train_optim_loss: 6356363.1250; val_kl_reg_loss: 3715.4893; val_edge_recon_loss: 1988769.0000; val_cat_covariates_contrastive_loss: 627378.0625; val_gene_expr_recon_loss: 3703621.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6323484.0000; val_optim_loss: 6323484.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8902; val_auprc_score: 0.9553; val_best_acc_score: 0.8299; val_best_f1_score: 0.8951; train_kl_reg_loss: 3386.7362; train_edge_recon_loss: 1905527.2500; train_cat_covariates_contrastive_loss: 656370.7969; train_gene_expr_recon_loss: 3668635.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6233919.7500; train_optim_loss: 6233919.7500; val_kl_reg_loss: 2487.1392; val_edge_recon_loss: 2089283.8750; val_cat_covariates_contrastive_loss: 627622.6250; val_gene_expr_recon_loss: 3600300.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6319694.0000; val_optim_loss: 6319694.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8793; val_auprc_score: 0.9513; val_best_acc_score: 0.8281; val_best_f1_score: 0.8868; train_kl_reg_loss: 2198.4801; train_edge_recon_loss: 1822824.6875; train_cat_covariates_contrastive_loss: 695508.8906; train_gene_expr_recon_loss: 3585488.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6106021.0000; train_optim_loss: 6106021.0000; val_kl_reg_loss: 1771.0444; val_edge_recon_loss: 2044516.5000; val_cat_covariates_contrastive_loss: 627897.8750; val_gene_expr_recon_loss: 3538888.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6213073.5000; val_optim_loss: 6213073.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8685; val_auprc_score: 0.9452; val_best_acc_score: 0.8014; val_best_f1_score: 0.8803; train_kl_reg_loss: 1988.8757; train_edge_recon_loss: 1843443.0000; train_cat_covariates_contrastive_loss: 701136.5000; train_gene_expr_recon_loss: 3513182.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6059751.0000; train_optim_loss: 6059751.0000; val_kl_reg_loss: 2262.6038; val_edge_recon_loss: 2038266.3750; val_cat_covariates_contrastive_loss: 627824.7500; val_gene_expr_recon_loss: 3478317.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6146671.0000; val_optim_loss: 6146671.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8490; val_auprc_score: 0.9314; val_best_acc_score: 0.8173; val_best_f1_score: 0.8899; train_kl_reg_loss: 2454.4993; train_edge_recon_loss: 1811348.9375; train_cat_covariates_contrastive_loss: 675099.5312; train_gene_expr_recon_loss: 3470809.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5959712.2500; train_optim_loss: 5959712.2500; val_kl_reg_loss: 2357.4172; val_edge_recon_loss: 2085170.6250; val_cat_covariates_contrastive_loss: 628224.1250; val_gene_expr_recon_loss: 3430576.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6146328.0000; val_optim_loss: 6146328.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8362; val_auprc_score: 0.9320; val_best_acc_score: 0.8305; val_best_f1_score: 0.8970; train_kl_reg_loss: 2436.1629; train_edge_recon_loss: 1774109.8750; train_cat_covariates_contrastive_loss: 679642.2969; train_gene_expr_recon_loss: 3400061.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5856249.2500; train_optim_loss: 5856249.2500; val_kl_reg_loss: 2635.6787; val_edge_recon_loss: 1920809.1250; val_cat_covariates_contrastive_loss: 628182.3750; val_gene_expr_recon_loss: 3381847.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5933474.0000; val_optim_loss: 5933474.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8270; val_auprc_score: 0.9282; val_best_acc_score: 0.8252; val_best_f1_score: 0.8947; train_kl_reg_loss: 2987.6503; train_edge_recon_loss: 1742649.4062; train_cat_covariates_contrastive_loss: 672934.4219; train_gene_expr_recon_loss: 3346265.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5764837.0000; train_optim_loss: 5764837.0000; val_kl_reg_loss: 3387.7063; val_edge_recon_loss: 1885058.3750; val_cat_covariates_contrastive_loss: 628524.2500; val_gene_expr_recon_loss: 3335605.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5852576.0000; val_optim_loss: 5852576.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8218; val_auprc_score: 0.9266; val_best_acc_score: 0.8209; val_best_f1_score: 0.8900; train_kl_reg_loss: 3745.3269; train_edge_recon_loss: 1720812.8438; train_cat_covariates_contrastive_loss: 668858.5625; train_gene_expr_recon_loss: 3330174.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5723591.0000; train_optim_loss: 5723591.0000; val_kl_reg_loss: 3855.7993; val_edge_recon_loss: 1841537.7500; val_cat_covariates_contrastive_loss: 628850.4375; val_gene_expr_recon_loss: 3294489.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5768734.0000; val_optim_loss: 5768734.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8299; val_auprc_score: 0.9288; val_best_acc_score: 0.8245; val_best_f1_score: 0.8912; train_kl_reg_loss: 4340.5796; train_edge_recon_loss: 1695681.6250; train_cat_covariates_contrastive_loss: 670527.8281; train_gene_expr_recon_loss: 3254995.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5625545.5000; train_optim_loss: 5625545.5000; val_kl_reg_loss: 4983.3721; val_edge_recon_loss: 1764556.8750; val_cat_covariates_contrastive_loss: 628706.0625; val_gene_expr_recon_loss: 3254559.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5652806.0000; val_optim_loss: 5652806.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8256; val_auprc_score: 0.9301; val_best_acc_score: 0.8236; val_best_f1_score: 0.8915; train_kl_reg_loss: 5916.2742; train_edge_recon_loss: 1678385.0312; train_cat_covariates_contrastive_loss: 657346.7188; train_gene_expr_recon_loss: 3248281.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5589929.3750; train_optim_loss: 5589929.3750; val_kl_reg_loss: 6388.1748; val_edge_recon_loss: 1685738.0000; val_cat_covariates_contrastive_loss: 629232.7500; val_gene_expr_recon_loss: 3219341.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5540700.0000; val_optim_loss: 5540700.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.7949; val_auprc_score: 0.9132; val_best_acc_score: 0.8097; val_best_f1_score: 0.8844; train_kl_reg_loss: 7099.5172; train_edge_recon_loss: 1631189.2500; train_cat_covariates_contrastive_loss: 656798.7344; train_gene_expr_recon_loss: 3204074.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5499161.7500; train_optim_loss: 5499161.7500; val_kl_reg_loss: 7909.8564; val_edge_recon_loss: 1684665.2500; val_cat_covariates_contrastive_loss: 628405.1250; val_gene_expr_recon_loss: 3186509.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5507490.0000; val_optim_loss: 5507490.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8039; val_auprc_score: 0.9129; val_best_acc_score: 0.8076; val_best_f1_score: 0.8807; train_kl_reg_loss: 9353.8052; train_edge_recon_loss: 1578333.1562; train_cat_covariates_contrastive_loss: 647898.2656; train_gene_expr_recon_loss: 3170632.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5406217.5000; train_optim_loss: 5406217.5000; val_kl_reg_loss: 10887.9199; val_edge_recon_loss: 1697635.0000; val_cat_covariates_contrastive_loss: 628682.8125; val_gene_expr_recon_loss: 3154415.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5491621.5000; val_optim_loss: 5491621.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.7978; val_auprc_score: 0.9129; val_best_acc_score: 0.8043; val_best_f1_score: 0.8809; train_kl_reg_loss: 12825.5024; train_edge_recon_loss: 1557400.6250; train_cat_covariates_contrastive_loss: 635753.3594; train_gene_expr_recon_loss: 3147332.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5353311.3750; train_optim_loss: 5353311.3750; val_kl_reg_loss: 14038.7500; val_edge_recon_loss: 1609877.7500; val_cat_covariates_contrastive_loss: 628460.5625; val_gene_expr_recon_loss: 3136432.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5388810.0000; val_optim_loss: 5388810.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.7978; val_auprc_score: 0.9112; val_best_acc_score: 0.8081; val_best_f1_score: 0.8829; train_kl_reg_loss: 15404.8005; train_edge_recon_loss: 1544456.7188; train_cat_covariates_contrastive_loss: 632674.9688; train_gene_expr_recon_loss: 3120768.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5313304.6250; train_optim_loss: 5313304.6250; val_kl_reg_loss: 16053.7979; val_edge_recon_loss: 1566709.7500; val_cat_covariates_contrastive_loss: 627963.3125; val_gene_expr_recon_loss: 3112599.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5323326.0000; val_optim_loss: 5323326.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.7960; val_auprc_score: 0.9153; val_best_acc_score: 0.8009; val_best_f1_score: 0.8782; train_kl_reg_loss: 17713.0454; train_edge_recon_loss: 1516670.9688; train_cat_covariates_contrastive_loss: 631242.8281; train_gene_expr_recon_loss: 3089695.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5255321.7500; train_optim_loss: 5255321.7500; val_kl_reg_loss: 18056.8340; val_edge_recon_loss: 1594099.1250; val_cat_covariates_contrastive_loss: 627970.4375; val_gene_expr_recon_loss: 3090027.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5330154.0000; val_optim_loss: 5330154.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8004; val_auprc_score: 0.9157; val_best_acc_score: 0.8085; val_best_f1_score: 0.8824; train_kl_reg_loss: 19001.0264; train_edge_recon_loss: 1520510.8438; train_cat_covariates_contrastive_loss: 630566.6562; train_gene_expr_recon_loss: 3062621.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5232699.5000; train_optim_loss: 5232699.5000; val_kl_reg_loss: 18638.5273; val_edge_recon_loss: 1553278.1250; val_cat_covariates_contrastive_loss: 627582.6875; val_gene_expr_recon_loss: 3067581.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5267080.0000; val_optim_loss: 5267080.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.7976; val_auprc_score: 0.9133; val_best_acc_score: 0.8025; val_best_f1_score: 0.8783; train_kl_reg_loss: 19747.9302; train_edge_recon_loss: 1480822.7188; train_cat_covariates_contrastive_loss: 629372.4688; train_gene_expr_recon_loss: 3051076.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5181019.2500; train_optim_loss: 5181019.2500; val_kl_reg_loss: 19252.7773; val_edge_recon_loss: 1564026.5000; val_cat_covariates_contrastive_loss: 627849.1250; val_gene_expr_recon_loss: 3046024.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5257153.0000; val_optim_loss: 5257153.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8246; val_auprc_score: 0.9236; val_best_acc_score: 0.8136; val_best_f1_score: 0.8850; train_kl_reg_loss: 20119.9048; train_edge_recon_loss: 1477456.5938; train_cat_covariates_contrastive_loss: 630270.9531; train_gene_expr_recon_loss: 3005268.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5133116.5000; train_optim_loss: 5133116.5000; val_kl_reg_loss: 19537.5547; val_edge_recon_loss: 1545596.8750; val_cat_covariates_contrastive_loss: 628145.7500; val_gene_expr_recon_loss: 3025998.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5219278.5000; val_optim_loss: 5219278.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8179; val_auprc_score: 0.9199; val_best_acc_score: 0.8180; val_best_f1_score: 0.8884; train_kl_reg_loss: 20358.7705; train_edge_recon_loss: 1472830.9062; train_cat_covariates_contrastive_loss: 630222.2969; train_gene_expr_recon_loss: 3015632.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5139044.6250; train_optim_loss: 5139044.6250; val_kl_reg_loss: 18925.3066; val_edge_recon_loss: 1507101.7500; val_cat_covariates_contrastive_loss: 628367.5625; val_gene_expr_recon_loss: 3011278.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5165673.0000; val_optim_loss: 5165673.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8338; val_auprc_score: 0.9254; val_best_acc_score: 0.8239; val_best_f1_score: 0.8909; train_kl_reg_loss: 19575.6021; train_edge_recon_loss: 1453993.8125; train_cat_covariates_contrastive_loss: 630570.1406; train_gene_expr_recon_loss: 2996043.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5100183.0000; train_optim_loss: 5100183.0000; val_kl_reg_loss: 18766.2754; val_edge_recon_loss: 1512908.8750; val_cat_covariates_contrastive_loss: 628885.2500; val_gene_expr_recon_loss: 2996292.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5156853.0000; val_optim_loss: 5156853.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8305; val_auprc_score: 0.9288; val_best_acc_score: 0.8323; val_best_f1_score: 0.8964; train_kl_reg_loss: 19207.0166; train_edge_recon_loss: 1459345.1562; train_cat_covariates_contrastive_loss: 631241.7656; train_gene_expr_recon_loss: 2979543.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5089337.3750; train_optim_loss: 5089337.3750; val_kl_reg_loss: 18083.6992; val_edge_recon_loss: 1480927.3750; val_cat_covariates_contrastive_loss: 628864.1875; val_gene_expr_recon_loss: 2981713.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5109589.0000; val_optim_loss: 5109589.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8523; val_auprc_score: 0.9341; val_best_acc_score: 0.8468; val_best_f1_score: 0.9043; train_kl_reg_loss: 18739.3604; train_edge_recon_loss: 1418321.0625; train_cat_covariates_contrastive_loss: 631608.2656; train_gene_expr_recon_loss: 2960807.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5029476.0000; train_optim_loss: 5029476.0000; val_kl_reg_loss: 18126.4766; val_edge_recon_loss: 1418248.3750; val_cat_covariates_contrastive_loss: 628929.3750; val_gene_expr_recon_loss: 2969186.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5034491.0000; val_optim_loss: 5034491.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8570; val_auprc_score: 0.9356; val_best_acc_score: 0.8483; val_best_f1_score: 0.9046; train_kl_reg_loss: 18823.1216; train_edge_recon_loss: 1412995.1562; train_cat_covariates_contrastive_loss: 631488.4219; train_gene_expr_recon_loss: 2962391.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5025698.0000; train_optim_loss: 5025698.0000; val_kl_reg_loss: 18086.9160; val_edge_recon_loss: 1455914.2500; val_cat_covariates_contrastive_loss: 629503.8750; val_gene_expr_recon_loss: 2956378.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5059883.0000; val_optim_loss: 5059883.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8612; val_auprc_score: 0.9385; val_best_acc_score: 0.8550; val_best_f1_score: 0.9084; train_kl_reg_loss: 18848.2178; train_edge_recon_loss: 1421493.9062; train_cat_covariates_contrastive_loss: 631426.4375; train_gene_expr_recon_loss: 2942523.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5014291.7500; train_optim_loss: 5014291.7500; val_kl_reg_loss: 18346.3594; val_edge_recon_loss: 1420925.5000; val_cat_covariates_contrastive_loss: 629299.3750; val_gene_expr_recon_loss: 2946603.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5015174.0000; val_optim_loss: 5015174.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8570; val_auprc_score: 0.9334; val_best_acc_score: 0.8527; val_best_f1_score: 0.9068; train_kl_reg_loss: 19039.6924; train_edge_recon_loss: 1382204.1250; train_cat_covariates_contrastive_loss: 631424.6875; train_gene_expr_recon_loss: 2929706.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4962374.8750; train_optim_loss: 4962374.8750; val_kl_reg_loss: 18318.0820; val_edge_recon_loss: 1451577.5000; val_cat_covariates_contrastive_loss: 629459.4375; val_gene_expr_recon_loss: 2931878.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5031233.0000; val_optim_loss: 5031233.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8717; val_auprc_score: 0.9404; val_best_acc_score: 0.8692; val_best_f1_score: 0.9170; train_kl_reg_loss: 18845.9619; train_edge_recon_loss: 1395329.8750; train_cat_covariates_contrastive_loss: 631604.1562; train_gene_expr_recon_loss: 2907006.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4952786.0000; train_optim_loss: 4952786.0000; val_kl_reg_loss: 18395.9316; val_edge_recon_loss: 1398117.5000; val_cat_covariates_contrastive_loss: 630562.1875; val_gene_expr_recon_loss: 2924079.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4971154.5000; val_optim_loss: 4971154.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8714; val_auprc_score: 0.9391; val_best_acc_score: 0.8726; val_best_f1_score: 0.9194; train_kl_reg_loss: 19239.2744; train_edge_recon_loss: 1380421.0312; train_cat_covariates_contrastive_loss: 631680.4531; train_gene_expr_recon_loss: 2908268.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4939608.7500; train_optim_loss: 4939608.7500; val_kl_reg_loss: 18907.3320; val_edge_recon_loss: 1385282.7500; val_cat_covariates_contrastive_loss: 630854.7500; val_gene_expr_recon_loss: 2908931.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4943976.5000; val_optim_loss: 4943976.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8785; val_auprc_score: 0.9442; val_best_acc_score: 0.8767; val_best_f1_score: 0.9220; train_kl_reg_loss: 19359.8433; train_edge_recon_loss: 1383970.5312; train_cat_covariates_contrastive_loss: 631817.2344; train_gene_expr_recon_loss: 2906763.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4941911.3750; train_optim_loss: 4941911.3750; val_kl_reg_loss: 18325.3262; val_edge_recon_loss: 1380645.5000; val_cat_covariates_contrastive_loss: 630332.5625; val_gene_expr_recon_loss: 2902529.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4931833.0000; val_optim_loss: 4931833.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8827; val_auprc_score: 0.9461; val_best_acc_score: 0.8777; val_best_f1_score: 0.9218; train_kl_reg_loss: 18791.6519; train_edge_recon_loss: 1372472.7188; train_cat_covariates_contrastive_loss: 632013.0469; train_gene_expr_recon_loss: 2883042.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4906320.1250; train_optim_loss: 4906320.1250; val_kl_reg_loss: 18152.3242; val_edge_recon_loss: 1402980.2500; val_cat_covariates_contrastive_loss: 630264.0000; val_gene_expr_recon_loss: 2892731.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4944127.5000; val_optim_loss: 4944127.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8831; val_auprc_score: 0.9421; val_best_acc_score: 0.8806; val_best_f1_score: 0.9241; train_kl_reg_loss: 18831.1133; train_edge_recon_loss: 1370337.9688; train_cat_covariates_contrastive_loss: 632011.8281; train_gene_expr_recon_loss: 2895038.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4916219.2500; train_optim_loss: 4916219.2500; val_kl_reg_loss: 17951.5469; val_edge_recon_loss: 1403104.3750; val_cat_covariates_contrastive_loss: 631983.6250; val_gene_expr_recon_loss: 2886076.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4939115.5000; val_optim_loss: 4939115.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8753; val_auprc_score: 0.9423; val_best_acc_score: 0.8794; val_best_f1_score: 0.9237; train_kl_reg_loss: 18106.0317; train_edge_recon_loss: 1359751.5000; train_cat_covariates_contrastive_loss: 632275.1875; train_gene_expr_recon_loss: 2870514.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4880647.3750; train_optim_loss: 4880647.3750; val_kl_reg_loss: 17034.8789; val_edge_recon_loss: 1375428.7500; val_cat_covariates_contrastive_loss: 630597.1250; val_gene_expr_recon_loss: 2880306.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4903367.0000; val_optim_loss: 4903367.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8802; val_auprc_score: 0.9480; val_best_acc_score: 0.8795; val_best_f1_score: 0.9241; train_kl_reg_loss: 17281.3052; train_edge_recon_loss: 1368615.3750; train_cat_covariates_contrastive_loss: 632416.0312; train_gene_expr_recon_loss: 2856261.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4874573.8750; train_optim_loss: 4874573.8750; val_kl_reg_loss: 16904.6270; val_edge_recon_loss: 1354370.7500; val_cat_covariates_contrastive_loss: 631266.5000; val_gene_expr_recon_loss: 2868803.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4871345.0000; val_optim_loss: 4871345.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8685; val_auprc_score: 0.9367; val_best_acc_score: 0.8804; val_best_f1_score: 0.9244; train_kl_reg_loss: 17354.2559; train_edge_recon_loss: 1377598.0312; train_cat_covariates_contrastive_loss: 632753.1250; train_gene_expr_recon_loss: 2851469.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4879174.6250; train_optim_loss: 4879174.6250; val_kl_reg_loss: 16958.6621; val_edge_recon_loss: 1401667.7500; val_cat_covariates_contrastive_loss: 631782.8125; val_gene_expr_recon_loss: 2865815.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4916225.0000; val_optim_loss: 4916225.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8878; val_auprc_score: 0.9489; val_best_acc_score: 0.8852; val_best_f1_score: 0.9275; train_kl_reg_loss: 17330.8618; train_edge_recon_loss: 1354922.6250; train_cat_covariates_contrastive_loss: 632477.2812; train_gene_expr_recon_loss: 2845630.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4850361.2500; train_optim_loss: 4850361.2500; val_kl_reg_loss: 16647.3164; val_edge_recon_loss: 1364026.8750; val_cat_covariates_contrastive_loss: 631060.8125; val_gene_expr_recon_loss: 2859094.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4870829.0000; val_optim_loss: 4870829.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8920; val_auprc_score: 0.9504; val_best_acc_score: 0.8911; val_best_f1_score: 0.9319; train_kl_reg_loss: 16934.6851; train_edge_recon_loss: 1364615.4062; train_cat_covariates_contrastive_loss: 633089.9844; train_gene_expr_recon_loss: 2828189.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4842829.1250; train_optim_loss: 4842829.1250; val_kl_reg_loss: 16555.3809; val_edge_recon_loss: 1314881.7500; val_cat_covariates_contrastive_loss: 631161.8125; val_gene_expr_recon_loss: 2848915.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4811515.0000; val_optim_loss: 4811515.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8741; val_auprc_score: 0.9426; val_best_acc_score: 0.8822; val_best_f1_score: 0.9261; train_kl_reg_loss: 17169.4302; train_edge_recon_loss: 1358713.6562; train_cat_covariates_contrastive_loss: 632344.2188; train_gene_expr_recon_loss: 2854543.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4862770.8750; train_optim_loss: 4862770.8750; val_kl_reg_loss: 16569.5586; val_edge_recon_loss: 1389441.0000; val_cat_covariates_contrastive_loss: 631431.1250; val_gene_expr_recon_loss: 2849939.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4887381.0000; val_optim_loss: 4887381.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8828; val_auprc_score: 0.9431; val_best_acc_score: 0.8894; val_best_f1_score: 0.9303; train_kl_reg_loss: 16982.5361; train_edge_recon_loss: 1365459.8125; train_cat_covariates_contrastive_loss: 632639.9531; train_gene_expr_recon_loss: 2835383.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4850465.3750; train_optim_loss: 4850465.3750; val_kl_reg_loss: 16272.3516; val_edge_recon_loss: 1341259.7500; val_cat_covariates_contrastive_loss: 631403.8125; val_gene_expr_recon_loss: 2843300.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4832236.5000; val_optim_loss: 4832236.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8769; val_auprc_score: 0.9409; val_best_acc_score: 0.8805; val_best_f1_score: 0.9246; train_kl_reg_loss: 16833.3940; train_edge_recon_loss: 1358230.9062; train_cat_covariates_contrastive_loss: 633093.3281; train_gene_expr_recon_loss: 2843420.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4851577.6250; train_optim_loss: 4851577.6250; val_kl_reg_loss: 16284.7676; val_edge_recon_loss: 1423110.8750; val_cat_covariates_contrastive_loss: 631375.6250; val_gene_expr_recon_loss: 2839555.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4910326.0000; val_optim_loss: 4910326.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8972; val_auprc_score: 0.9538; val_best_acc_score: 0.8942; val_best_f1_score: 0.9331; train_kl_reg_loss: 16570.1616; train_edge_recon_loss: 1369390.5000; train_cat_covariates_contrastive_loss: 632939.8594; train_gene_expr_recon_loss: 2821332.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4840233.2500; train_optim_loss: 4840233.2500; val_kl_reg_loss: 16127.0938; val_edge_recon_loss: 1345375.3750; val_cat_covariates_contrastive_loss: 631639.8125; val_gene_expr_recon_loss: 2833630.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4826772.0000; val_optim_loss: 4826772.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8794; val_auprc_score: 0.9405; val_best_acc_score: 0.8891; val_best_f1_score: 0.9298; train_kl_reg_loss: 16632.8276; train_edge_recon_loss: 1363701.4062; train_cat_covariates_contrastive_loss: 633265.8906; train_gene_expr_recon_loss: 2819349.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4832949.5000; train_optim_loss: 4832949.5000; val_kl_reg_loss: 16155.6689; val_edge_recon_loss: 1386723.8750; val_cat_covariates_contrastive_loss: 632246.1250; val_gene_expr_recon_loss: 2834216.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4869342.0000; val_optim_loss: 4869342.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8853; val_auprc_score: 0.9468; val_best_acc_score: 0.8884; val_best_f1_score: 0.9303; train_kl_reg_loss: 16589.6470; train_edge_recon_loss: 1365677.8750; train_cat_covariates_contrastive_loss: 632829.5781; train_gene_expr_recon_loss: 2831631.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4846728.6250; train_optim_loss: 4846728.6250; val_kl_reg_loss: 16082.9062; val_edge_recon_loss: 1352445.5000; val_cat_covariates_contrastive_loss: 631168.6250; val_gene_expr_recon_loss: 2832200.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4831897.0000; val_optim_loss: 4831897.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8830; val_auprc_score: 0.9443; val_best_acc_score: 0.8856; val_best_f1_score: 0.9275; train_kl_reg_loss: 16476.1514; train_edge_recon_loss: 1361698.4375; train_cat_covariates_contrastive_loss: 633422.2344; train_gene_expr_recon_loss: 2812846.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4824442.8750; train_optim_loss: 4824442.8750; val_kl_reg_loss: 16009.1797; val_edge_recon_loss: 1404573.7500; val_cat_covariates_contrastive_loss: 631687.8750; val_gene_expr_recon_loss: 2831845.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4884116.0000; val_optim_loss: 4884116.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8793; val_auprc_score: 0.9443; val_best_acc_score: 0.8866; val_best_f1_score: 0.9288; train_kl_reg_loss: 16389.2996; train_edge_recon_loss: 1365610.5625; train_cat_covariates_contrastive_loss: 633115.3125; train_gene_expr_recon_loss: 2812785.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4827901.0000; train_optim_loss: 4827901.0000; val_kl_reg_loss: 15961.6914; val_edge_recon_loss: 1383019.1250; val_cat_covariates_contrastive_loss: 631659.5625; val_gene_expr_recon_loss: 2831629.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4862270.0000; val_optim_loss: 4862270.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 47 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.8904
val AUPRC score: 0.9498
val best accuracy score: 0.8852
val best F1 score: 0.9270
val target rna MSE score: 1.2484
val source rna MSE score: 0.4812
Val cat covariate0 mean sim diff: 0.0058
Val cat covariate1 mean sim diff: -0.1194
Duration of model training in run 2: 0 hours, 1 minutes and 50 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 12706
Number of validation nodes: 1412
Number of training edges: 30579
Number of validation edges: 3397
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8641; val_auprc_score: 0.9522; val_best_acc_score: 0.7561; val_best_f1_score: 0.8611; train_kl_reg_loss: 432.8600; train_edge_recon_loss: 1734895.2188; train_cat_covariates_contrastive_loss: 1178869.6406; train_gene_expr_recon_loss: 4190468.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7104666.3750; train_optim_loss: 7104666.3750; val_kl_reg_loss: 1606.1372; val_edge_recon_loss: 2007000.7500; val_cat_covariates_contrastive_loss: 628884.1875; val_gene_expr_recon_loss: 4005049.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6642540.0000; val_optim_loss: 6642540.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8649; val_auprc_score: 0.9498; val_best_acc_score: 0.8061; val_best_f1_score: 0.8849; train_kl_reg_loss: 3111.8366; train_edge_recon_loss: 1878042.8125; train_cat_covariates_contrastive_loss: 704796.6562; train_gene_expr_recon_loss: 3978045.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6563997.2500; train_optim_loss: 6563997.2500; val_kl_reg_loss: 5005.3359; val_edge_recon_loss: 2048193.3750; val_cat_covariates_contrastive_loss: 627289.5625; val_gene_expr_recon_loss: 3870923.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6551412.0000; val_optim_loss: 6551412.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8707; val_auprc_score: 0.9521; val_best_acc_score: 0.8229; val_best_f1_score: 0.8943; train_kl_reg_loss: 5709.2302; train_edge_recon_loss: 1988374.4688; train_cat_covariates_contrastive_loss: 636084.3750; train_gene_expr_recon_loss: 3826801.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6456969.7500; train_optim_loss: 6456969.7500; val_kl_reg_loss: 5404.1631; val_edge_recon_loss: 2035522.1250; val_cat_covariates_contrastive_loss: 627178.5625; val_gene_expr_recon_loss: 3767953.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6436058.0000; val_optim_loss: 6436058.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8592; val_auprc_score: 0.9461; val_best_acc_score: 0.8133; val_best_f1_score: 0.8880; train_kl_reg_loss: 4924.6012; train_edge_recon_loss: 1983693.6562; train_cat_covariates_contrastive_loss: 639966.1562; train_gene_expr_recon_loss: 3721210.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6349795.2500; train_optim_loss: 6349795.2500; val_kl_reg_loss: 3735.3511; val_edge_recon_loss: 2031903.6250; val_cat_covariates_contrastive_loss: 627268.8125; val_gene_expr_recon_loss: 3678693.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6341601.0000; val_optim_loss: 6341601.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8696; val_auprc_score: 0.9501; val_best_acc_score: 0.8269; val_best_f1_score: 0.8911; train_kl_reg_loss: 3303.7402; train_edge_recon_loss: 1906242.4688; train_cat_covariates_contrastive_loss: 671272.9062; train_gene_expr_recon_loss: 3685654.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6266473.1250; train_optim_loss: 6266473.1250; val_kl_reg_loss: 2385.4287; val_edge_recon_loss: 2047625.3750; val_cat_covariates_contrastive_loss: 627597.6875; val_gene_expr_recon_loss: 3611599.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6289207.5000; val_optim_loss: 6289207.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8459; val_auprc_score: 0.9346; val_best_acc_score: 0.8034; val_best_f1_score: 0.8832; train_kl_reg_loss: 2383.8426; train_edge_recon_loss: 1831772.0000; train_cat_covariates_contrastive_loss: 704590.7500; train_gene_expr_recon_loss: 3575520.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6114266.6250; train_optim_loss: 6114266.6250; val_kl_reg_loss: 2403.1482; val_edge_recon_loss: 2103186.0000; val_cat_covariates_contrastive_loss: 627592.3125; val_gene_expr_recon_loss: 3544608.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6277790.0000; val_optim_loss: 6277790.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8534; val_auprc_score: 0.9425; val_best_acc_score: 0.8269; val_best_f1_score: 0.8959; train_kl_reg_loss: 2784.3317; train_edge_recon_loss: 1826573.7812; train_cat_covariates_contrastive_loss: 684770.2344; train_gene_expr_recon_loss: 3521878.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6036006.8750; train_optim_loss: 6036006.8750; val_kl_reg_loss: 2944.0215; val_edge_recon_loss: 1989630.6250; val_cat_covariates_contrastive_loss: 627663.6250; val_gene_expr_recon_loss: 3478454.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6098692.0000; val_optim_loss: 6098692.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8271; val_auprc_score: 0.9275; val_best_acc_score: 0.8240; val_best_f1_score: 0.8938; train_kl_reg_loss: 3312.4450; train_edge_recon_loss: 1778383.8750; train_cat_covariates_contrastive_loss: 676256.4219; train_gene_expr_recon_loss: 3462070.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5920023.0000; train_optim_loss: 5920023.0000; val_kl_reg_loss: 3344.7500; val_edge_recon_loss: 1959871.5000; val_cat_covariates_contrastive_loss: 627865.8125; val_gene_expr_recon_loss: 3422039.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6013121.5000; val_optim_loss: 6013121.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8279; val_auprc_score: 0.9256; val_best_acc_score: 0.8293; val_best_f1_score: 0.8958; train_kl_reg_loss: 3951.4340; train_edge_recon_loss: 1750434.0000; train_cat_covariates_contrastive_loss: 679651.9219; train_gene_expr_recon_loss: 3409481.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5843518.3750; train_optim_loss: 5843518.3750; val_kl_reg_loss: 4442.9619; val_edge_recon_loss: 1928005.8750; val_cat_covariates_contrastive_loss: 627984.8125; val_gene_expr_recon_loss: 3367936.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5928370.0000; val_optim_loss: 5928370.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8319; val_auprc_score: 0.9284; val_best_acc_score: 0.8298; val_best_f1_score: 0.8951; train_kl_reg_loss: 5349.5267; train_edge_recon_loss: 1742625.0625; train_cat_covariates_contrastive_loss: 662489.0938; train_gene_expr_recon_loss: 3355023.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5765486.6250; train_optim_loss: 5765486.6250; val_kl_reg_loss: 5678.6147; val_edge_recon_loss: 1852197.2500; val_cat_covariates_contrastive_loss: 628333.2500; val_gene_expr_recon_loss: 3313603.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5799813.0000; val_optim_loss: 5799813.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8277; val_auprc_score: 0.9321; val_best_acc_score: 0.8255; val_best_f1_score: 0.8933; train_kl_reg_loss: 6783.8610; train_edge_recon_loss: 1697985.4375; train_cat_covariates_contrastive_loss: 661417.6875; train_gene_expr_recon_loss: 3284022.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5650209.2500; train_optim_loss: 5650209.2500; val_kl_reg_loss: 7430.9932; val_edge_recon_loss: 1775567.6250; val_cat_covariates_contrastive_loss: 628388.3750; val_gene_expr_recon_loss: 3262794.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5674181.0000; val_optim_loss: 5674181.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8151; val_auprc_score: 0.9250; val_best_acc_score: 0.8198; val_best_f1_score: 0.8899; train_kl_reg_loss: 8882.6442; train_edge_recon_loss: 1693044.2812; train_cat_covariates_contrastive_loss: 655707.7500; train_gene_expr_recon_loss: 3254719.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5612354.3750; train_optim_loss: 5612354.3750; val_kl_reg_loss: 9277.7656; val_edge_recon_loss: 1716676.5000; val_cat_covariates_contrastive_loss: 628424.9375; val_gene_expr_recon_loss: 3217246.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5571625.0000; val_optim_loss: 5571625.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.7947; val_auprc_score: 0.9084; val_best_acc_score: 0.8089; val_best_f1_score: 0.8832; train_kl_reg_loss: 11164.8125; train_edge_recon_loss: 1653429.7812; train_cat_covariates_contrastive_loss: 650369.1562; train_gene_expr_recon_loss: 3219221.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5534185.7500; train_optim_loss: 5534185.7500; val_kl_reg_loss: 11510.7910; val_edge_recon_loss: 1760542.1250; val_cat_covariates_contrastive_loss: 628002.7500; val_gene_expr_recon_loss: 3178950.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5579005.5000; val_optim_loss: 5579005.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8088; val_auprc_score: 0.9208; val_best_acc_score: 0.8155; val_best_f1_score: 0.8880; train_kl_reg_loss: 13387.1655; train_edge_recon_loss: 1610355.7812; train_cat_covariates_contrastive_loss: 646121.0938; train_gene_expr_recon_loss: 3186411.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5456275.1250; train_optim_loss: 5456275.1250; val_kl_reg_loss: 14208.7998; val_edge_recon_loss: 1655239.3750; val_cat_covariates_contrastive_loss: 627831.2500; val_gene_expr_recon_loss: 3145784.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5443063.5000; val_optim_loss: 5443063.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.7929; val_auprc_score: 0.9133; val_best_acc_score: 0.8056; val_best_f1_score: 0.8825; train_kl_reg_loss: 16617.9526; train_edge_recon_loss: 1593974.1875; train_cat_covariates_contrastive_loss: 640331.4375; train_gene_expr_recon_loss: 3129349.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5380272.5000; train_optim_loss: 5380272.5000; val_kl_reg_loss: 17130.9297; val_edge_recon_loss: 1675968.0000; val_cat_covariates_contrastive_loss: 627724.5000; val_gene_expr_recon_loss: 3110054.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5430878.0000; val_optim_loss: 5430878.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8117; val_auprc_score: 0.9222; val_best_acc_score: 0.8198; val_best_f1_score: 0.8898; train_kl_reg_loss: 20123.7314; train_edge_recon_loss: 1584939.6562; train_cat_covariates_contrastive_loss: 634781.1875; train_gene_expr_recon_loss: 3100578.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5340423.0000; train_optim_loss: 5340423.0000; val_kl_reg_loss: 20299.5723; val_edge_recon_loss: 1549557.6250; val_cat_covariates_contrastive_loss: 627472.3125; val_gene_expr_recon_loss: 3088273.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5285602.5000; val_optim_loss: 5285602.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.7898; val_auprc_score: 0.9092; val_best_acc_score: 0.8121; val_best_f1_score: 0.8858; train_kl_reg_loss: 22413.6235; train_edge_recon_loss: 1569324.4062; train_cat_covariates_contrastive_loss: 633755.6094; train_gene_expr_recon_loss: 3071185.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5296679.5000; train_optim_loss: 5296679.5000; val_kl_reg_loss: 21680.3086; val_edge_recon_loss: 1591744.6250; val_cat_covariates_contrastive_loss: 627609.8750; val_gene_expr_recon_loss: 3065341.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5306376.0000; val_optim_loss: 5306376.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.7790; val_auprc_score: 0.9093; val_best_acc_score: 0.7991; val_best_f1_score: 0.8792; train_kl_reg_loss: 24490.7046; train_edge_recon_loss: 1540233.3750; train_cat_covariates_contrastive_loss: 632526.4531; train_gene_expr_recon_loss: 3072176.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5269426.7500; train_optim_loss: 5269426.7500; val_kl_reg_loss: 23682.1328; val_edge_recon_loss: 1609867.1250; val_cat_covariates_contrastive_loss: 627732.8750; val_gene_expr_recon_loss: 3039819.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5301102.0000; val_optim_loss: 5301102.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.7899; val_auprc_score: 0.9127; val_best_acc_score: 0.8085; val_best_f1_score: 0.8839; train_kl_reg_loss: 26330.3325; train_edge_recon_loss: 1538364.5312; train_cat_covariates_contrastive_loss: 630654.1562; train_gene_expr_recon_loss: 3042802.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5238151.8750; train_optim_loss: 5238151.8750; val_kl_reg_loss: 24495.0273; val_edge_recon_loss: 1575433.6250; val_cat_covariates_contrastive_loss: 627617.5000; val_gene_expr_recon_loss: 3015658.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5243204.5000; val_optim_loss: 5243204.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.7962; val_auprc_score: 0.9200; val_best_acc_score: 0.8059; val_best_f1_score: 0.8830; train_kl_reg_loss: 26058.3096; train_edge_recon_loss: 1520960.2500; train_cat_covariates_contrastive_loss: 630728.1875; train_gene_expr_recon_loss: 3009315.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5187061.8750; train_optim_loss: 5187061.8750; val_kl_reg_loss: 24176.6836; val_edge_recon_loss: 1586483.0000; val_cat_covariates_contrastive_loss: 627653.6875; val_gene_expr_recon_loss: 2994869.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5233182.0000; val_optim_loss: 5233182.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.7903; val_auprc_score: 0.9122; val_best_acc_score: 0.8090; val_best_f1_score: 0.8840; train_kl_reg_loss: 26963.1562; train_edge_recon_loss: 1529284.8750; train_cat_covariates_contrastive_loss: 630898.7031; train_gene_expr_recon_loss: 3006708.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5193855.6250; train_optim_loss: 5193855.6250; val_kl_reg_loss: 24964.4375; val_edge_recon_loss: 1569182.2500; val_cat_covariates_contrastive_loss: 627727.6250; val_gene_expr_recon_loss: 2972868.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5194743.0000; val_optim_loss: 5194743.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.7932; val_auprc_score: 0.9157; val_best_acc_score: 0.8109; val_best_f1_score: 0.8858; train_kl_reg_loss: 26946.6187; train_edge_recon_loss: 1514201.8438; train_cat_covariates_contrastive_loss: 630146.5781; train_gene_expr_recon_loss: 2961092.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5132387.5000; train_optim_loss: 5132387.5000; val_kl_reg_loss: 24466.5938; val_edge_recon_loss: 1552992.0000; val_cat_covariates_contrastive_loss: 627491.9375; val_gene_expr_recon_loss: 2956025.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5160976.0000; val_optim_loss: 5160976.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8013; val_auprc_score: 0.9214; val_best_acc_score: 0.8090; val_best_f1_score: 0.8866; train_kl_reg_loss: 26080.9004; train_edge_recon_loss: 1487779.9062; train_cat_covariates_contrastive_loss: 631456.9844; train_gene_expr_recon_loss: 2954984.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5100302.1250; train_optim_loss: 5100302.1250; val_kl_reg_loss: 24499.3477; val_edge_recon_loss: 1532209.1250; val_cat_covariates_contrastive_loss: 627666.5625; val_gene_expr_recon_loss: 2939909.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5124284.0000; val_optim_loss: 5124284.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8153; val_auprc_score: 0.9239; val_best_acc_score: 0.8154; val_best_f1_score: 0.8867; train_kl_reg_loss: 26607.2314; train_edge_recon_loss: 1511150.1562; train_cat_covariates_contrastive_loss: 630714.9219; train_gene_expr_recon_loss: 2938808.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5107280.5000; train_optim_loss: 5107280.5000; val_kl_reg_loss: 24492.4355; val_edge_recon_loss: 1540065.8750; val_cat_covariates_contrastive_loss: 628025.9375; val_gene_expr_recon_loss: 2924536.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5117121.0000; val_optim_loss: 5117121.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8132; val_auprc_score: 0.9241; val_best_acc_score: 0.8152; val_best_f1_score: 0.8887; train_kl_reg_loss: 25230.2041; train_edge_recon_loss: 1491926.5000; train_cat_covariates_contrastive_loss: 631699.6094; train_gene_expr_recon_loss: 2908115.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5056971.5000; train_optim_loss: 5056971.5000; val_kl_reg_loss: 23069.6055; val_edge_recon_loss: 1538521.0000; val_cat_covariates_contrastive_loss: 628009.4375; val_gene_expr_recon_loss: 2915129.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5104729.5000; val_optim_loss: 5104729.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8302; val_auprc_score: 0.9291; val_best_acc_score: 0.8275; val_best_f1_score: 0.8945; train_kl_reg_loss: 24820.1577; train_edge_recon_loss: 1465125.2188; train_cat_covariates_contrastive_loss: 632115.4844; train_gene_expr_recon_loss: 2910566.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5032627.0000; train_optim_loss: 5032627.0000; val_kl_reg_loss: 23680.2070; val_edge_recon_loss: 1496974.3750; val_cat_covariates_contrastive_loss: 627928.3125; val_gene_expr_recon_loss: 2904525.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5053108.5000; val_optim_loss: 5053108.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8253; val_auprc_score: 0.9228; val_best_acc_score: 0.8318; val_best_f1_score: 0.8963; train_kl_reg_loss: 24831.1616; train_edge_recon_loss: 1477049.0000; train_cat_covariates_contrastive_loss: 631569.7031; train_gene_expr_recon_loss: 2901066.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5034516.6250; train_optim_loss: 5034516.6250; val_kl_reg_loss: 22621.3359; val_edge_recon_loss: 1479540.0000; val_cat_covariates_contrastive_loss: 627907.0000; val_gene_expr_recon_loss: 2892231.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5022300.0000; val_optim_loss: 5022300.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8452; val_auprc_score: 0.9330; val_best_acc_score: 0.8376; val_best_f1_score: 0.8987; train_kl_reg_loss: 24044.7646; train_edge_recon_loss: 1459228.3750; train_cat_covariates_contrastive_loss: 632061.2969; train_gene_expr_recon_loss: 2896265.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5011599.5000; train_optim_loss: 5011599.5000; val_kl_reg_loss: 22424.5469; val_edge_recon_loss: 1489722.8750; val_cat_covariates_contrastive_loss: 628719.2500; val_gene_expr_recon_loss: 2887425.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5028292.0000; val_optim_loss: 5028292.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8519; val_auprc_score: 0.9327; val_best_acc_score: 0.8425; val_best_f1_score: 0.9009; train_kl_reg_loss: 23990.1841; train_edge_recon_loss: 1443305.1562; train_cat_covariates_contrastive_loss: 631583.7656; train_gene_expr_recon_loss: 2899512.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4998391.6250; train_optim_loss: 4998391.6250; val_kl_reg_loss: 22856.0625; val_edge_recon_loss: 1513299.2500; val_cat_covariates_contrastive_loss: 628707.4375; val_gene_expr_recon_loss: 2875353.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5040216.5000; val_optim_loss: 5040216.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8535; val_auprc_score: 0.9325; val_best_acc_score: 0.8545; val_best_f1_score: 0.9100; train_kl_reg_loss: 24283.8154; train_edge_recon_loss: 1422823.8750; train_cat_covariates_contrastive_loss: 631092.6875; train_gene_expr_recon_loss: 2882809.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4961009.6250; train_optim_loss: 4961009.6250; val_kl_reg_loss: 22793.8359; val_edge_recon_loss: 1445631.2500; val_cat_covariates_contrastive_loss: 628953.6250; val_gene_expr_recon_loss: 2870482.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4967861.0000; val_optim_loss: 4967861.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8491; val_auprc_score: 0.9309; val_best_acc_score: 0.8646; val_best_f1_score: 0.9146; train_kl_reg_loss: 23500.1255; train_edge_recon_loss: 1400123.3438; train_cat_covariates_contrastive_loss: 630879.6875; train_gene_expr_recon_loss: 2877814.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4932317.1250; train_optim_loss: 4932317.1250; val_kl_reg_loss: 22047.0898; val_edge_recon_loss: 1422209.7500; val_cat_covariates_contrastive_loss: 629335.8750; val_gene_expr_recon_loss: 2860971.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4934564.5000; val_optim_loss: 4934564.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8544; val_auprc_score: 0.9299; val_best_acc_score: 0.8720; val_best_f1_score: 0.9200; train_kl_reg_loss: 22851.6182; train_edge_recon_loss: 1396672.6875; train_cat_covariates_contrastive_loss: 631192.5781; train_gene_expr_recon_loss: 2859003.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4909720.0000; train_optim_loss: 4909720.0000; val_kl_reg_loss: 22358.0781; val_edge_recon_loss: 1441396.5000; val_cat_covariates_contrastive_loss: 629552.0000; val_gene_expr_recon_loss: 2853475.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4946782.0000; val_optim_loss: 4946782.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8703; val_auprc_score: 0.9377; val_best_acc_score: 0.8802; val_best_f1_score: 0.9241; train_kl_reg_loss: 23477.8242; train_edge_recon_loss: 1391061.2500; train_cat_covariates_contrastive_loss: 631109.6562; train_gene_expr_recon_loss: 2855409.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4901058.2500; train_optim_loss: 4901058.2500; val_kl_reg_loss: 23023.0840; val_edge_recon_loss: 1441339.5000; val_cat_covariates_contrastive_loss: 629627.8750; val_gene_expr_recon_loss: 2845465.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4939455.5000; val_optim_loss: 4939455.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8754; val_auprc_score: 0.9403; val_best_acc_score: 0.8882; val_best_f1_score: 0.9291; train_kl_reg_loss: 23745.8560; train_edge_recon_loss: 1376704.1875; train_cat_covariates_contrastive_loss: 631126.7969; train_gene_expr_recon_loss: 2848404.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4879981.3750; train_optim_loss: 4879981.3750; val_kl_reg_loss: 23045.3555; val_edge_recon_loss: 1397346.8750; val_cat_covariates_contrastive_loss: 630761.7500; val_gene_expr_recon_loss: 2841434.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4892588.5000; val_optim_loss: 4892588.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8739; val_auprc_score: 0.9358; val_best_acc_score: 0.8818; val_best_f1_score: 0.9239; train_kl_reg_loss: 24015.8569; train_edge_recon_loss: 1392522.6250; train_cat_covariates_contrastive_loss: 630993.7656; train_gene_expr_recon_loss: 2852650.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4900182.7500; train_optim_loss: 4900182.7500; val_kl_reg_loss: 23367.2637; val_edge_recon_loss: 1466707.2500; val_cat_covariates_contrastive_loss: 629706.6250; val_gene_expr_recon_loss: 2829361.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4949142.0000; val_optim_loss: 4949142.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8693; val_auprc_score: 0.9372; val_best_acc_score: 0.8884; val_best_f1_score: 0.9299; train_kl_reg_loss: 24399.4731; train_edge_recon_loss: 1384207.9062; train_cat_covariates_contrastive_loss: 631125.6094; train_gene_expr_recon_loss: 2827787.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4867520.2500; train_optim_loss: 4867520.2500; val_kl_reg_loss: 23108.8613; val_edge_recon_loss: 1378972.8750; val_cat_covariates_contrastive_loss: 630442.8125; val_gene_expr_recon_loss: 2828290.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4860815.0000; val_optim_loss: 4860815.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8832; val_auprc_score: 0.9437; val_best_acc_score: 0.8863; val_best_f1_score: 0.9279; train_kl_reg_loss: 23446.8789; train_edge_recon_loss: 1384778.6875; train_cat_covariates_contrastive_loss: 631449.4688; train_gene_expr_recon_loss: 2834512.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4874187.1250; train_optim_loss: 4874187.1250; val_kl_reg_loss: 22188.6992; val_edge_recon_loss: 1415434.7500; val_cat_covariates_contrastive_loss: 630031.0000; val_gene_expr_recon_loss: 2820478.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4888132.5000; val_optim_loss: 4888132.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8680; val_auprc_score: 0.9354; val_best_acc_score: 0.8769; val_best_f1_score: 0.9222; train_kl_reg_loss: 23083.2085; train_edge_recon_loss: 1390946.5000; train_cat_covariates_contrastive_loss: 631860.3750; train_gene_expr_recon_loss: 2822917.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4868807.0000; train_optim_loss: 4868807.0000; val_kl_reg_loss: 22558.4688; val_edge_recon_loss: 1466871.5000; val_cat_covariates_contrastive_loss: 630349.3750; val_gene_expr_recon_loss: 2815284.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4935064.0000; val_optim_loss: 4935064.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8719; val_auprc_score: 0.9387; val_best_acc_score: 0.8885; val_best_f1_score: 0.9297; train_kl_reg_loss: 23278.4932; train_edge_recon_loss: 1387341.3125; train_cat_covariates_contrastive_loss: 631597.9375; train_gene_expr_recon_loss: 2834649.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4876866.8750; train_optim_loss: 4876866.8750; val_kl_reg_loss: 21966.0938; val_edge_recon_loss: 1389836.8750; val_cat_covariates_contrastive_loss: 630499.3750; val_gene_expr_recon_loss: 2808325.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4850628.0000; val_optim_loss: 4850628.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8759; val_auprc_score: 0.9377; val_best_acc_score: 0.8864; val_best_f1_score: 0.9285; train_kl_reg_loss: 22446.5840; train_edge_recon_loss: 1365282.0312; train_cat_covariates_contrastive_loss: 631887.5781; train_gene_expr_recon_loss: 2814506.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4834122.5000; train_optim_loss: 4834122.5000; val_kl_reg_loss: 21632.9336; val_edge_recon_loss: 1401434.5000; val_cat_covariates_contrastive_loss: 630987.9375; val_gene_expr_recon_loss: 2806530.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4860586.0000; val_optim_loss: 4860586.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8843; val_auprc_score: 0.9436; val_best_acc_score: 0.8904; val_best_f1_score: 0.9299; train_kl_reg_loss: 22514.2896; train_edge_recon_loss: 1381028.2500; train_cat_covariates_contrastive_loss: 631946.8281; train_gene_expr_recon_loss: 2819181.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4854670.6250; train_optim_loss: 4854670.6250; val_kl_reg_loss: 22073.5977; val_edge_recon_loss: 1414769.5000; val_cat_covariates_contrastive_loss: 630935.9375; val_gene_expr_recon_loss: 2802486.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4870265.0000; val_optim_loss: 4870265.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8878; val_auprc_score: 0.9466; val_best_acc_score: 0.8892; val_best_f1_score: 0.9297; train_kl_reg_loss: 22640.0894; train_edge_recon_loss: 1387886.3125; train_cat_covariates_contrastive_loss: 632130.8281; train_gene_expr_recon_loss: 2813214.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4855872.0000; train_optim_loss: 4855872.0000; val_kl_reg_loss: 21753.8164; val_edge_recon_loss: 1398419.1250; val_cat_covariates_contrastive_loss: 630565.6250; val_gene_expr_recon_loss: 2798562.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4849301.5000; val_optim_loss: 4849301.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8798; val_auprc_score: 0.9446; val_best_acc_score: 0.8853; val_best_f1_score: 0.9276; train_kl_reg_loss: 22198.6455; train_edge_recon_loss: 1376759.4688; train_cat_covariates_contrastive_loss: 632180.1562; train_gene_expr_recon_loss: 2792926.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4824064.1250; train_optim_loss: 4824064.1250; val_kl_reg_loss: 21515.1445; val_edge_recon_loss: 1400673.3750; val_cat_covariates_contrastive_loss: 631598.5000; val_gene_expr_recon_loss: 2792444.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4846231.5000; val_optim_loss: 4846231.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8784; val_auprc_score: 0.9447; val_best_acc_score: 0.8836; val_best_f1_score: 0.9270; train_kl_reg_loss: 22184.5103; train_edge_recon_loss: 1371485.0312; train_cat_covariates_contrastive_loss: 632175.2500; train_gene_expr_recon_loss: 2796261.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4822106.3750; train_optim_loss: 4822106.3750; val_kl_reg_loss: 21210.2422; val_edge_recon_loss: 1405918.8750; val_cat_covariates_contrastive_loss: 630823.5625; val_gene_expr_recon_loss: 2785801.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4843754.0000; val_optim_loss: 4843754.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8794; val_auprc_score: 0.9403; val_best_acc_score: 0.8885; val_best_f1_score: 0.9293; train_kl_reg_loss: 22042.2915; train_edge_recon_loss: 1372679.7812; train_cat_covariates_contrastive_loss: 632511.3750; train_gene_expr_recon_loss: 2796473.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4823707.2500; train_optim_loss: 4823707.2500; val_kl_reg_loss: 21283.1602; val_edge_recon_loss: 1423625.5000; val_cat_covariates_contrastive_loss: 630475.4375; val_gene_expr_recon_loss: 2785806.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4861190.0000; val_optim_loss: 4861190.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.8855; val_auprc_score: 0.9474; val_best_acc_score: 0.8904; val_best_f1_score: 0.9300; train_kl_reg_loss: 21924.1816; train_edge_recon_loss: 1389055.9375; train_cat_covariates_contrastive_loss: 632542.5156; train_gene_expr_recon_loss: 2792209.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4835732.5000; train_optim_loss: 4835732.5000; val_kl_reg_loss: 21019.3203; val_edge_recon_loss: 1410923.5000; val_cat_covariates_contrastive_loss: 631350.3750; val_gene_expr_recon_loss: 2783368.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4846662.0000; val_optim_loss: 4846662.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.8815; val_auprc_score: 0.9439; val_best_acc_score: 0.8857; val_best_f1_score: 0.9276; train_kl_reg_loss: 21531.0430; train_edge_recon_loss: 1355966.4688; train_cat_covariates_contrastive_loss: 632694.6562; train_gene_expr_recon_loss: 2786037.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4796229.7500; train_optim_loss: 4796229.7500; val_kl_reg_loss: 20686.8340; val_edge_recon_loss: 1416882.3750; val_cat_covariates_contrastive_loss: 631782.0625; val_gene_expr_recon_loss: 2778978.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4848329.0000; val_optim_loss: 4848329.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9003; val_auprc_score: 0.9551; val_best_acc_score: 0.8948; val_best_f1_score: 0.9334; train_kl_reg_loss: 21324.2275; train_edge_recon_loss: 1374874.8750; train_cat_covariates_contrastive_loss: 633034.0625; train_gene_expr_recon_loss: 2775602.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4804835.3750; train_optim_loss: 4804835.3750; val_kl_reg_loss: 20241.6289; val_edge_recon_loss: 1367166.2500; val_cat_covariates_contrastive_loss: 631770.1250; val_gene_expr_recon_loss: 2775791.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4794969.5000; val_optim_loss: 4794969.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.8835; val_auprc_score: 0.9431; val_best_acc_score: 0.8911; val_best_f1_score: 0.9308; train_kl_reg_loss: 20736.7461; train_edge_recon_loss: 1375883.3125; train_cat_covariates_contrastive_loss: 633460.6875; train_gene_expr_recon_loss: 2775847.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4805928.5000; train_optim_loss: 4805928.5000; val_kl_reg_loss: 19908.7148; val_edge_recon_loss: 1386771.7500; val_cat_covariates_contrastive_loss: 631852.6875; val_gene_expr_recon_loss: 2771343.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4809877.0000; val_optim_loss: 4809877.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.8853; val_auprc_score: 0.9438; val_best_acc_score: 0.8897; val_best_f1_score: 0.9304; train_kl_reg_loss: 20495.4961; train_edge_recon_loss: 1371297.4375; train_cat_covariates_contrastive_loss: 633235.9219; train_gene_expr_recon_loss: 2781155.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4806184.5000; train_optim_loss: 4806184.5000; val_kl_reg_loss: 19472.1953; val_edge_recon_loss: 1397654.3750; val_cat_covariates_contrastive_loss: 633668.3125; val_gene_expr_recon_loss: 2769706.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4820501.5000; val_optim_loss: 4820501.5000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.8929; val_auprc_score: 0.9492; val_best_acc_score: 0.8924; val_best_f1_score: 0.9318; train_kl_reg_loss: 20067.0117; train_edge_recon_loss: 1364737.5000; train_cat_covariates_contrastive_loss: 633912.3594; train_gene_expr_recon_loss: 2768419.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4787136.0000; train_optim_loss: 4787136.0000; val_kl_reg_loss: 19108.0918; val_edge_recon_loss: 1384134.8750; val_cat_covariates_contrastive_loss: 632856.3750; val_gene_expr_recon_loss: 2766618.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4802718.0000; val_optim_loss: 4802718.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.8884; val_auprc_score: 0.9481; val_best_acc_score: 0.8948; val_best_f1_score: 0.9335; train_kl_reg_loss: 19647.6128; train_edge_recon_loss: 1369322.6875; train_cat_covariates_contrastive_loss: 633839.2500; train_gene_expr_recon_loss: 2778260.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4801069.6250; train_optim_loss: 4801069.6250; val_kl_reg_loss: 19111.7754; val_edge_recon_loss: 1393914.8750; val_cat_covariates_contrastive_loss: 632282.2500; val_gene_expr_recon_loss: 2759660.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4804969.0000; val_optim_loss: 4804969.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.8913; val_auprc_score: 0.9531; val_best_acc_score: 0.8919; val_best_f1_score: 0.9322; train_kl_reg_loss: 19790.0972; train_edge_recon_loss: 1365602.2812; train_cat_covariates_contrastive_loss: 633834.5156; train_gene_expr_recon_loss: 2764622.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4783849.6250; train_optim_loss: 4783849.6250; val_kl_reg_loss: 19141.2773; val_edge_recon_loss: 1347871.2500; val_cat_covariates_contrastive_loss: 632744.9375; val_gene_expr_recon_loss: 2762664.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4762421.5000; val_optim_loss: 4762421.5000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.8827; val_auprc_score: 0.9407; val_best_acc_score: 0.8861; val_best_f1_score: 0.9285; train_kl_reg_loss: 19864.8906; train_edge_recon_loss: 1362219.4062; train_cat_covariates_contrastive_loss: 634162.7969; train_gene_expr_recon_loss: 2762255.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4778502.1250; train_optim_loss: 4778502.1250; val_kl_reg_loss: 19180.5664; val_edge_recon_loss: 1410286.3750; val_cat_covariates_contrastive_loss: 633331.0625; val_gene_expr_recon_loss: 2763641.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4826439.5000; val_optim_loss: 4826439.5000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.8855; val_auprc_score: 0.9458; val_best_acc_score: 0.8880; val_best_f1_score: 0.9297; train_kl_reg_loss: 19737.8325; train_edge_recon_loss: 1365436.7500; train_cat_covariates_contrastive_loss: 634094.3750; train_gene_expr_recon_loss: 2757836.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4777105.1250; train_optim_loss: 4777105.1250; val_kl_reg_loss: 19233.2500; val_edge_recon_loss: 1379608.6250; val_cat_covariates_contrastive_loss: 633593.8125; val_gene_expr_recon_loss: 2762989.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4795425.0000; val_optim_loss: 4795425.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.8951; val_auprc_score: 0.9521; val_best_acc_score: 0.8940; val_best_f1_score: 0.9330; train_kl_reg_loss: 19798.1919; train_edge_recon_loss: 1353764.7188; train_cat_covariates_contrastive_loss: 634446.9844; train_gene_expr_recon_loss: 2765089.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4773099.6250; train_optim_loss: 4773099.6250; val_kl_reg_loss: 19249.0117; val_edge_recon_loss: 1377897.2500; val_cat_covariates_contrastive_loss: 633345.0000; val_gene_expr_recon_loss: 2761052.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4791543.0000; val_optim_loss: 4791543.0000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.8854; val_auprc_score: 0.9447; val_best_acc_score: 0.8914; val_best_f1_score: 0.9317; train_kl_reg_loss: 19947.1396; train_edge_recon_loss: 1365347.4688; train_cat_covariates_contrastive_loss: 633980.9688; train_gene_expr_recon_loss: 2770742.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4790018.1250; train_optim_loss: 4790018.1250; val_kl_reg_loss: 19135.3516; val_edge_recon_loss: 1380766.8750; val_cat_covariates_contrastive_loss: 633055.6875; val_gene_expr_recon_loss: 2760343.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4793302.0000; val_optim_loss: 4793302.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.8949; val_auprc_score: 0.9533; val_best_acc_score: 0.8976; val_best_f1_score: 0.9356; train_kl_reg_loss: 19820.6484; train_edge_recon_loss: 1361817.0625; train_cat_covariates_contrastive_loss: 634757.6875; train_gene_expr_recon_loss: 2760058.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4776453.7500; train_optim_loss: 4776453.7500; val_kl_reg_loss: 19178.4141; val_edge_recon_loss: 1351275.2500; val_cat_covariates_contrastive_loss: 632949.3750; val_gene_expr_recon_loss: 2760780.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4764183.0000; val_optim_loss: 4764183.0000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.8883; val_auprc_score: 0.9445; val_best_acc_score: 0.8912; val_best_f1_score: 0.9305; train_kl_reg_loss: 19819.3130; train_edge_recon_loss: 1359541.1250; train_cat_covariates_contrastive_loss: 634291.4844; train_gene_expr_recon_loss: 2763426.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4777078.2500; train_optim_loss: 4777078.2500; val_kl_reg_loss: 19208.8574; val_edge_recon_loss: 1435523.8750; val_cat_covariates_contrastive_loss: 633488.6250; val_gene_expr_recon_loss: 2762355.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4850576.5000; val_optim_loss: 4850576.5000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.8986; val_auprc_score: 0.9536; val_best_acc_score: 0.8955; val_best_f1_score: 0.9338; train_kl_reg_loss: 19821.3403; train_edge_recon_loss: 1365603.2188; train_cat_covariates_contrastive_loss: 634532.2656; train_gene_expr_recon_loss: 2767601.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4787558.5000; train_optim_loss: 4787558.5000; val_kl_reg_loss: 19184.8496; val_edge_recon_loss: 1367955.6250; val_cat_covariates_contrastive_loss: 632007.1250; val_gene_expr_recon_loss: 2759510.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4778658.0000; val_optim_loss: 4778658.0000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9040; val_auprc_score: 0.9579; val_best_acc_score: 0.8929; val_best_f1_score: 0.9328; train_kl_reg_loss: 19823.8345; train_edge_recon_loss: 1362841.4062; train_cat_covariates_contrastive_loss: 634704.3281; train_gene_expr_recon_loss: 2758353.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4775723.5000; train_optim_loss: 4775723.5000; val_kl_reg_loss: 19206.9180; val_edge_recon_loss: 1356331.5000; val_cat_covariates_contrastive_loss: 633242.2500; val_gene_expr_recon_loss: 2761068.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4769849.0000; val_optim_loss: 4769849.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 32 sec.
Using best model state, which was in epoch 53.

--- MODEL EVALUATION ---
val AUROC score: 0.8804
val AUPRC score: 0.9411
val best accuracy score: 0.8917
val best F1 score: 0.9310
val target rna MSE score: 0.9779
val source rna MSE score: 0.3632
Val cat covariate0 mean sim diff: -0.0035
Val cat covariate1 mean sim diff: -0.1367
Duration of model training in run 1: 0 hours, 2 minutes and 35 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
