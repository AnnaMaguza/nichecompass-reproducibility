Run timestamp: 29082023_164105_15.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '--edge_batch_size_list', '512', '--node_batch_size_list', 'None', '--seeds', '1', '--run_index', '2', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_15']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 254146
Number of validation nodes: 28238
Number of training edges: 602179
Number of validation edges: 66908
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9408; val_auprc_score: 0.9806; val_best_acc_score: 0.9027; val_best_f1_score: 0.9390; train_kl_reg_loss: 17821.4316; train_edge_recon_loss: 1430485.0956; train_cat_covariates_contrastive_loss: 647885.2345; train_gene_expr_recon_loss: 2918870.2850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5015062.0433; train_optim_loss: 5015062.0433; val_kl_reg_loss: 14092.9347; val_edge_recon_loss: 1401090.4847; val_cat_covariates_contrastive_loss: 641670.4394; val_gene_expr_recon_loss: 2709226.6546; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4766080.5458; val_optim_loss: 4766080.5458
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9560; val_auprc_score: 0.9849; val_best_acc_score: 0.9200; val_best_f1_score: 0.9496; train_kl_reg_loss: 15707.7087; train_edge_recon_loss: 1349257.2142; train_cat_covariates_contrastive_loss: 644224.6573; train_gene_expr_recon_loss: 2589588.8477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4598778.4274; train_optim_loss: 4598778.4274; val_kl_reg_loss: 17264.6508; val_edge_recon_loss: 1363936.0668; val_cat_covariates_contrastive_loss: 646628.0124; val_gene_expr_recon_loss: 2462659.7214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4490488.4466; val_optim_loss: 4490488.4466
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9569; val_auprc_score: 0.9856; val_best_acc_score: 0.9237; val_best_f1_score: 0.9523; train_kl_reg_loss: 19123.0943; train_edge_recon_loss: 1344236.9982; train_cat_covariates_contrastive_loss: 646065.4793; train_gene_expr_recon_loss: 2335434.8260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4344860.3995; train_optim_loss: 4344860.3995; val_kl_reg_loss: 19891.7482; val_edge_recon_loss: 1368891.2052; val_cat_covariates_contrastive_loss: 646491.8993; val_gene_expr_recon_loss: 2247972.4179; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4283247.2710; val_optim_loss: 4283247.2710
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9553; val_auprc_score: 0.9850; val_best_acc_score: 0.9251; val_best_f1_score: 0.9530; train_kl_reg_loss: 20997.0681; train_edge_recon_loss: 1340280.1338; train_cat_covariates_contrastive_loss: 644999.8217; train_gene_expr_recon_loss: 2174044.4993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4180321.5280; train_optim_loss: 4180321.5280; val_kl_reg_loss: 22259.6975; val_edge_recon_loss: 1359525.4695; val_cat_covariates_contrastive_loss: 643374.5701; val_gene_expr_recon_loss: 2128505.9838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4153665.7271; val_optim_loss: 4153665.7271
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9569; val_auprc_score: 0.9855; val_best_acc_score: 0.9271; val_best_f1_score: 0.9542; train_kl_reg_loss: 22109.6147; train_edge_recon_loss: 1337583.2787; train_cat_covariates_contrastive_loss: 644425.2206; train_gene_expr_recon_loss: 2088101.8230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4092219.9335; train_optim_loss: 4092219.9335; val_kl_reg_loss: 22858.5792; val_edge_recon_loss: 1367483.3368; val_cat_covariates_contrastive_loss: 643184.8230; val_gene_expr_recon_loss: 2065019.8798; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4098546.6221; val_optim_loss: 4098546.6221
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9569; val_auprc_score: 0.9852; val_best_acc_score: 0.9259; val_best_f1_score: 0.9535; train_kl_reg_loss: 22867.8486; train_edge_recon_loss: 1338515.2535; train_cat_covariates_contrastive_loss: 643800.7893; train_gene_expr_recon_loss: 2037084.3842; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4042268.2734; train_optim_loss: 4042268.2734; val_kl_reg_loss: 23099.3546; val_edge_recon_loss: 1370048.7490; val_cat_covariates_contrastive_loss: 642732.0720; val_gene_expr_recon_loss: 2026208.4113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4062088.6011; val_optim_loss: 4062088.6011
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9583; val_auprc_score: 0.9858; val_best_acc_score: 0.9271; val_best_f1_score: 0.9543; train_kl_reg_loss: 23287.3372; train_edge_recon_loss: 1338993.6905; train_cat_covariates_contrastive_loss: 643598.8248; train_gene_expr_recon_loss: 2005049.1540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4010929.0076; train_optim_loss: 4010929.0076; val_kl_reg_loss: 23904.8383; val_edge_recon_loss: 1371013.3969; val_cat_covariates_contrastive_loss: 644001.6737; val_gene_expr_recon_loss: 2001514.8836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4040434.7996; val_optim_loss: 4040434.7996
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9585; val_auprc_score: 0.9857; val_best_acc_score: 0.9301; val_best_f1_score: 0.9562; train_kl_reg_loss: 23580.1675; train_edge_recon_loss: 1334104.7218; train_cat_covariates_contrastive_loss: 643415.9958; train_gene_expr_recon_loss: 1981830.6860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3982931.5741; train_optim_loss: 3982931.5741; val_kl_reg_loss: 24035.5427; val_edge_recon_loss: 1351959.9456; val_cat_covariates_contrastive_loss: 642176.2867; val_gene_expr_recon_loss: 1983190.4905; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4001362.2576; val_optim_loss: 4001362.2576
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9569; val_auprc_score: 0.9853; val_best_acc_score: 0.9290; val_best_f1_score: 0.9556; train_kl_reg_loss: 23837.8807; train_edge_recon_loss: 1334435.7308; train_cat_covariates_contrastive_loss: 643162.5193; train_gene_expr_recon_loss: 1968545.8590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3969981.9909; train_optim_loss: 3969981.9909; val_kl_reg_loss: 24175.8445; val_edge_recon_loss: 1355613.8416; val_cat_covariates_contrastive_loss: 642203.6102; val_gene_expr_recon_loss: 1977209.9714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3999203.2691; val_optim_loss: 3999203.2691
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9601; val_auprc_score: 0.9862; val_best_acc_score: 0.9329; val_best_f1_score: 0.9578; train_kl_reg_loss: 24110.1000; train_edge_recon_loss: 1333206.0270; train_cat_covariates_contrastive_loss: 642990.1488; train_gene_expr_recon_loss: 1954778.9304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3955085.2084; train_optim_loss: 3955085.2084; val_kl_reg_loss: 24094.3714; val_edge_recon_loss: 1346248.5134; val_cat_covariates_contrastive_loss: 642690.2075; val_gene_expr_recon_loss: 1962835.2567; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3975868.3550; val_optim_loss: 3975868.3550
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9620; val_auprc_score: 0.9871; val_best_acc_score: 0.9312; val_best_f1_score: 0.9570; train_kl_reg_loss: 24108.3725; train_edge_recon_loss: 1336373.7395; train_cat_covariates_contrastive_loss: 642800.8243; train_gene_expr_recon_loss: 1946209.4899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3949492.4254; train_optim_loss: 3949492.4254; val_kl_reg_loss: 24504.1190; val_edge_recon_loss: 1358551.3788; val_cat_covariates_contrastive_loss: 644380.0258; val_gene_expr_recon_loss: 1954915.7920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3982351.3244; val_optim_loss: 3982351.3244
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9588; val_auprc_score: 0.9858; val_best_acc_score: 0.9312; val_best_f1_score: 0.9569; train_kl_reg_loss: 24183.7570; train_edge_recon_loss: 1333480.7272; train_cat_covariates_contrastive_loss: 643058.2775; train_gene_expr_recon_loss: 1939157.4771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3939880.2375; train_optim_loss: 3939880.2375; val_kl_reg_loss: 25104.1917; val_edge_recon_loss: 1354964.3760; val_cat_covariates_contrastive_loss: 641554.9189; val_gene_expr_recon_loss: 1950022.3626; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3971645.8416; val_optim_loss: 3971645.8416
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9612; val_auprc_score: 0.9864; val_best_acc_score: 0.9331; val_best_f1_score: 0.9579; train_kl_reg_loss: 24360.4723; train_edge_recon_loss: 1330144.2481; train_cat_covariates_contrastive_loss: 642919.0856; train_gene_expr_recon_loss: 1930872.6018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3928296.4097; train_optim_loss: 3928296.4097; val_kl_reg_loss: 23881.5766; val_edge_recon_loss: 1362826.0143; val_cat_covariates_contrastive_loss: 642639.3526; val_gene_expr_recon_loss: 1952780.1097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3982127.0706; val_optim_loss: 3982127.0706
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9642; val_auprc_score: 0.9877; val_best_acc_score: 0.9340; val_best_f1_score: 0.9585; train_kl_reg_loss: 24409.1528; train_edge_recon_loss: 1329551.5377; train_cat_covariates_contrastive_loss: 643078.1412; train_gene_expr_recon_loss: 1925027.2436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3922066.0750; train_optim_loss: 3922066.0750; val_kl_reg_loss: 24375.3047; val_edge_recon_loss: 1362512.8998; val_cat_covariates_contrastive_loss: 644695.5673; val_gene_expr_recon_loss: 1939170.0697; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3970753.8473; val_optim_loss: 3970753.8473
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9636; val_auprc_score: 0.9878; val_best_acc_score: 0.9355; val_best_f1_score: 0.9595; train_kl_reg_loss: 24532.0250; train_edge_recon_loss: 1331527.0137; train_cat_covariates_contrastive_loss: 642757.1543; train_gene_expr_recon_loss: 1917326.6425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3916142.8394; train_optim_loss: 3916142.8394; val_kl_reg_loss: 24333.7432; val_edge_recon_loss: 1342954.9895; val_cat_covariates_contrastive_loss: 644093.9275; val_gene_expr_recon_loss: 1934149.1107; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3945531.7729; val_optim_loss: 3945531.7729
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9631; val_auprc_score: 0.9875; val_best_acc_score: 0.9357; val_best_f1_score: 0.9597; train_kl_reg_loss: 24693.1903; train_edge_recon_loss: 1329939.3856; train_cat_covariates_contrastive_loss: 642690.7083; train_gene_expr_recon_loss: 1914834.7964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3912158.0801; train_optim_loss: 3912158.0801; val_kl_reg_loss: 25419.8789; val_edge_recon_loss: 1349143.4733; val_cat_covariates_contrastive_loss: 643225.9389; val_gene_expr_recon_loss: 1934331.7443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3952121.0305; val_optim_loss: 3952121.0305
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9620; val_auprc_score: 0.9870; val_best_acc_score: 0.9328; val_best_f1_score: 0.9578; train_kl_reg_loss: 24743.5171; train_edge_recon_loss: 1332235.2929; train_cat_covariates_contrastive_loss: 642965.3781; train_gene_expr_recon_loss: 1907808.0788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3907752.2681; train_optim_loss: 3907752.2681; val_kl_reg_loss: 25244.6937; val_edge_recon_loss: 1362887.0067; val_cat_covariates_contrastive_loss: 643042.6531; val_gene_expr_recon_loss: 1930959.1193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3962133.4676; val_optim_loss: 3962133.4676
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9650; val_auprc_score: 0.9877; val_best_acc_score: 0.9375; val_best_f1_score: 0.9606; train_kl_reg_loss: 25010.7782; train_edge_recon_loss: 1332382.2256; train_cat_covariates_contrastive_loss: 642761.0034; train_gene_expr_recon_loss: 1903665.8089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3903819.8175; train_optim_loss: 3903819.8175; val_kl_reg_loss: 25086.6495; val_edge_recon_loss: 1353182.0553; val_cat_covariates_contrastive_loss: 642786.1374; val_gene_expr_recon_loss: 1920120.4838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3941175.3302; val_optim_loss: 3941175.3302
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9642; val_auprc_score: 0.9876; val_best_acc_score: 0.9355; val_best_f1_score: 0.9594; train_kl_reg_loss: 24983.4827; train_edge_recon_loss: 1331112.4273; train_cat_covariates_contrastive_loss: 642880.1969; train_gene_expr_recon_loss: 1902370.5946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3901346.7028; train_optim_loss: 3901346.7028; val_kl_reg_loss: 25393.8424; val_edge_recon_loss: 1356424.0592; val_cat_covariates_contrastive_loss: 643527.0673; val_gene_expr_recon_loss: 1916801.8874; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3942146.8760; val_optim_loss: 3942146.8760
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9618; val_auprc_score: 0.9866; val_best_acc_score: 0.9361; val_best_f1_score: 0.9598; train_kl_reg_loss: 25180.1768; train_edge_recon_loss: 1331709.5971; train_cat_covariates_contrastive_loss: 642747.3729; train_gene_expr_recon_loss: 1894941.8479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3894578.9989; train_optim_loss: 3894578.9989; val_kl_reg_loss: 25359.8826; val_edge_recon_loss: 1365750.2452; val_cat_covariates_contrastive_loss: 641789.7657; val_gene_expr_recon_loss: 1907824.5210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3940724.3989; val_optim_loss: 3940724.3989
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9633; val_auprc_score: 0.9872; val_best_acc_score: 0.9383; val_best_f1_score: 0.9613; train_kl_reg_loss: 25104.0651; train_edge_recon_loss: 1330895.8888; train_cat_covariates_contrastive_loss: 642789.2391; train_gene_expr_recon_loss: 1893528.8722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3892318.0607; train_optim_loss: 3892318.0607; val_kl_reg_loss: 24820.7131; val_edge_recon_loss: 1342736.9523; val_cat_covariates_contrastive_loss: 642833.5243; val_gene_expr_recon_loss: 1906909.6794; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3917300.8664; val_optim_loss: 3917300.8664
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9633; val_auprc_score: 0.9872; val_best_acc_score: 0.9367; val_best_f1_score: 0.9603; train_kl_reg_loss: 25246.7814; train_edge_recon_loss: 1330324.7896; train_cat_covariates_contrastive_loss: 642942.7977; train_gene_expr_recon_loss: 1890193.1972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3888707.5597; train_optim_loss: 3888707.5597; val_kl_reg_loss: 25105.1298; val_edge_recon_loss: 1347622.7385; val_cat_covariates_contrastive_loss: 643091.2595; val_gene_expr_recon_loss: 1906508.4552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3922327.5992; val_optim_loss: 3922327.5992
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9621; val_auprc_score: 0.9867; val_best_acc_score: 0.9346; val_best_f1_score: 0.9589; train_kl_reg_loss: 25330.0857; train_edge_recon_loss: 1329664.7691; train_cat_covariates_contrastive_loss: 642609.4394; train_gene_expr_recon_loss: 1888330.5355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3885934.8286; train_optim_loss: 3885934.8286; val_kl_reg_loss: 26232.5011; val_edge_recon_loss: 1359237.9084; val_cat_covariates_contrastive_loss: 642155.5606; val_gene_expr_recon_loss: 1914191.1135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3941817.0553; val_optim_loss: 3941817.0553
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9623; val_auprc_score: 0.9868; val_best_acc_score: 0.9359; val_best_f1_score: 0.9597; train_kl_reg_loss: 25456.8640; train_edge_recon_loss: 1331636.7661; train_cat_covariates_contrastive_loss: 642764.5860; train_gene_expr_recon_loss: 1881806.5931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3881664.8063; train_optim_loss: 3881664.8063; val_kl_reg_loss: 25776.3230; val_edge_recon_loss: 1367703.6126; val_cat_covariates_contrastive_loss: 641722.3698; val_gene_expr_recon_loss: 1900309.5716; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3935511.8817; val_optim_loss: 3935511.8817
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9626; val_auprc_score: 0.9869; val_best_acc_score: 0.9373; val_best_f1_score: 0.9605; train_kl_reg_loss: 25344.1482; train_edge_recon_loss: 1329570.0776; train_cat_covariates_contrastive_loss: 642730.3023; train_gene_expr_recon_loss: 1882919.6392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3880564.1623; train_optim_loss: 3880564.1623; val_kl_reg_loss: 26247.5051; val_edge_recon_loss: 1345070.3130; val_cat_covariates_contrastive_loss: 641987.6279; val_gene_expr_recon_loss: 1902315.4962; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3915620.9485; val_optim_loss: 3915620.9485
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9652; val_auprc_score: 0.9881; val_best_acc_score: 0.9382; val_best_f1_score: 0.9612; train_kl_reg_loss: 25435.8835; train_edge_recon_loss: 1331254.0888; train_cat_covariates_contrastive_loss: 642565.7525; train_gene_expr_recon_loss: 1879824.3605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3879080.0801; train_optim_loss: 3879080.0801; val_kl_reg_loss: 26308.2593; val_edge_recon_loss: 1345975.0725; val_cat_covariates_contrastive_loss: 642232.4260; val_gene_expr_recon_loss: 1902514.7004; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3917030.4485; val_optim_loss: 3917030.4485
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9638; val_auprc_score: 0.9874; val_best_acc_score: 0.9385; val_best_f1_score: 0.9613; train_kl_reg_loss: 25451.5601; train_edge_recon_loss: 1327645.9090; train_cat_covariates_contrastive_loss: 642679.4498; train_gene_expr_recon_loss: 1876464.0162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3872240.9335; train_optim_loss: 3872240.9335; val_kl_reg_loss: 25472.1669; val_edge_recon_loss: 1349149.4122; val_cat_covariates_contrastive_loss: 642718.5630; val_gene_expr_recon_loss: 1918387.1899; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3935727.3321; val_optim_loss: 3935727.3321
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9656; val_auprc_score: 0.9880; val_best_acc_score: 0.9393; val_best_f1_score: 0.9619; train_kl_reg_loss: 25666.6415; train_edge_recon_loss: 1327800.8402; train_cat_covariates_contrastive_loss: 642644.0243; train_gene_expr_recon_loss: 1874897.3449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3871008.8532; train_optim_loss: 3871008.8532; val_kl_reg_loss: 25119.7161; val_edge_recon_loss: 1345378.5716; val_cat_covariates_contrastive_loss: 643902.1799; val_gene_expr_recon_loss: 1892843.5429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3907243.9905; val_optim_loss: 3907243.9905
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9662; val_auprc_score: 0.9882; val_best_acc_score: 0.9404; val_best_f1_score: 0.9625; train_kl_reg_loss: 25530.7572; train_edge_recon_loss: 1324999.2841; train_cat_covariates_contrastive_loss: 642642.7731; train_gene_expr_recon_loss: 1872235.2940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3865408.1098; train_optim_loss: 3865408.1098; val_kl_reg_loss: 25946.0477; val_edge_recon_loss: 1340401.1174; val_cat_covariates_contrastive_loss: 642416.0315; val_gene_expr_recon_loss: 1890663.4008; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3899426.6145; val_optim_loss: 3899426.6145
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9659; val_auprc_score: 0.9878; val_best_acc_score: 0.9406; val_best_f1_score: 0.9626; train_kl_reg_loss: 25656.9801; train_edge_recon_loss: 1326150.3578; train_cat_covariates_contrastive_loss: 642975.5180; train_gene_expr_recon_loss: 1875649.7640; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3870432.6192; train_optim_loss: 3870432.6192; val_kl_reg_loss: 25535.6055; val_edge_recon_loss: 1349740.3120; val_cat_covariates_contrastive_loss: 643683.5730; val_gene_expr_recon_loss: 1894404.8597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3913364.3454; val_optim_loss: 3913364.3454
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9639; val_auprc_score: 0.9870; val_best_acc_score: 0.9394; val_best_f1_score: 0.9618; train_kl_reg_loss: 26204.5767; train_edge_recon_loss: 1322504.3444; train_cat_covariates_contrastive_loss: 642737.7345; train_gene_expr_recon_loss: 1882647.9503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3874094.6062; train_optim_loss: 3874094.6062; val_kl_reg_loss: 25829.7961; val_edge_recon_loss: 1352115.2595; val_cat_covariates_contrastive_loss: 641437.3225; val_gene_expr_recon_loss: 1958746.3015; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3978128.6832; val_optim_loss: 3978128.6832
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9646; val_auprc_score: 0.9874; val_best_acc_score: 0.9384; val_best_f1_score: 0.9612; train_kl_reg_loss: 26279.6208; train_edge_recon_loss: 1325423.0397; train_cat_covariates_contrastive_loss: 642870.6842; train_gene_expr_recon_loss: 1870517.9466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3865091.2925; train_optim_loss: 3865091.2925; val_kl_reg_loss: 26907.1171; val_edge_recon_loss: 1364435.4456; val_cat_covariates_contrastive_loss: 642600.6236; val_gene_expr_recon_loss: 1884617.8569; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3918561.0553; val_optim_loss: 3918561.0553
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9669; val_auprc_score: 0.9884; val_best_acc_score: 0.9414; val_best_f1_score: 0.9632; train_kl_reg_loss: 26047.2085; train_edge_recon_loss: 1329160.4588; train_cat_covariates_contrastive_loss: 642861.3599; train_gene_expr_recon_loss: 1864362.4671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3862431.4936; train_optim_loss: 3862431.4936; val_kl_reg_loss: 26344.2656; val_edge_recon_loss: 1341896.0439; val_cat_covariates_contrastive_loss: 643011.4614; val_gene_expr_recon_loss: 1891642.2023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3902893.9847; val_optim_loss: 3902893.9847

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9675; val_auprc_score: 0.9886; val_best_acc_score: 0.9413; val_best_f1_score: 0.9630; train_kl_reg_loss: 25895.8922; train_edge_recon_loss: 1328389.0423; train_cat_covariates_contrastive_loss: 642752.5672; train_gene_expr_recon_loss: 1839696.3783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3836733.8811; train_optim_loss: 3836733.8811; val_kl_reg_loss: 25964.3785; val_edge_recon_loss: 1354202.7882; val_cat_covariates_contrastive_loss: 642715.1489; val_gene_expr_recon_loss: 1863650.5973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3886532.9141; val_optim_loss: 3886532.9141
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9666; val_auprc_score: 0.9880; val_best_acc_score: 0.9421; val_best_f1_score: 0.9635; train_kl_reg_loss: 25808.0414; train_edge_recon_loss: 1326561.2430; train_cat_covariates_contrastive_loss: 642646.3784; train_gene_expr_recon_loss: 1833865.0057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3828880.6731; train_optim_loss: 3828880.6731; val_kl_reg_loss: 25607.3395; val_edge_recon_loss: 1346427.1718; val_cat_covariates_contrastive_loss: 642919.0768; val_gene_expr_recon_loss: 1858673.8855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3873627.4714; val_optim_loss: 3873627.4714
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9679; val_auprc_score: 0.9887; val_best_acc_score: 0.9427; val_best_f1_score: 0.9639; train_kl_reg_loss: 25833.2683; train_edge_recon_loss: 1323571.6778; train_cat_covariates_contrastive_loss: 642653.0421; train_gene_expr_recon_loss: 1831218.9913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3823276.9754; train_optim_loss: 3823276.9754; val_kl_reg_loss: 25912.5176; val_edge_recon_loss: 1337628.4933; val_cat_covariates_contrastive_loss: 642903.9413; val_gene_expr_recon_loss: 1860094.7815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3866539.7271; val_optim_loss: 3866539.7271
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9671; val_auprc_score: 0.9882; val_best_acc_score: 0.9420; val_best_f1_score: 0.9633; train_kl_reg_loss: 25747.4080; train_edge_recon_loss: 1323579.6629; train_cat_covariates_contrastive_loss: 642553.7914; train_gene_expr_recon_loss: 1830282.8756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3822163.7362; train_optim_loss: 3822163.7362; val_kl_reg_loss: 25691.2397; val_edge_recon_loss: 1354043.1536; val_cat_covariates_contrastive_loss: 642492.7958; val_gene_expr_recon_loss: 1856479.2099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3878706.3989; val_optim_loss: 3878706.3989
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9675; val_auprc_score: 0.9887; val_best_acc_score: 0.9426; val_best_f1_score: 0.9638; train_kl_reg_loss: 25644.7975; train_edge_recon_loss: 1328660.9448; train_cat_covariates_contrastive_loss: 642416.0727; train_gene_expr_recon_loss: 1828378.3562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3825100.1729; train_optim_loss: 3825100.1729; val_kl_reg_loss: 25752.6005; val_edge_recon_loss: 1340385.0496; val_cat_covariates_contrastive_loss: 642126.3984; val_gene_expr_recon_loss: 1858272.8588; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3866536.9179; val_optim_loss: 3866536.9179
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9659; val_auprc_score: 0.9880; val_best_acc_score: 0.9423; val_best_f1_score: 0.9637; train_kl_reg_loss: 25461.7069; train_edge_recon_loss: 1322997.1564; train_cat_covariates_contrastive_loss: 642570.5987; train_gene_expr_recon_loss: 1826460.0814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3817489.5418; train_optim_loss: 3817489.5418; val_kl_reg_loss: 25631.9105; val_edge_recon_loss: 1340910.1756; val_cat_covariates_contrastive_loss: 642039.4757; val_gene_expr_recon_loss: 1855473.3798; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3864054.9485; val_optim_loss: 3864054.9485
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9666; val_auprc_score: 0.9881; val_best_acc_score: 0.9418; val_best_f1_score: 0.9633; train_kl_reg_loss: 25359.2777; train_edge_recon_loss: 1324971.7859; train_cat_covariates_contrastive_loss: 642436.6124; train_gene_expr_recon_loss: 1827022.0529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3819789.7311; train_optim_loss: 3819789.7311; val_kl_reg_loss: 25430.1568; val_edge_recon_loss: 1353679.4103; val_cat_covariates_contrastive_loss: 642334.6431; val_gene_expr_recon_loss: 1856198.2996; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3877642.5057; val_optim_loss: 3877642.5057
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9678; val_auprc_score: 0.9885; val_best_acc_score: 0.9428; val_best_f1_score: 0.9640; train_kl_reg_loss: 25269.4263; train_edge_recon_loss: 1319603.4561; train_cat_covariates_contrastive_loss: 642423.3968; train_gene_expr_recon_loss: 1826037.5612; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3813333.8394; train_optim_loss: 3813333.8394; val_kl_reg_loss: 25289.8597; val_edge_recon_loss: 1337993.2052; val_cat_covariates_contrastive_loss: 642397.0100; val_gene_expr_recon_loss: 1855604.3225; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3861284.4065; val_optim_loss: 3861284.4065
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9668; val_auprc_score: 0.9883; val_best_acc_score: 0.9424; val_best_f1_score: 0.9637; train_kl_reg_loss: 25269.1456; train_edge_recon_loss: 1319788.3327; train_cat_covariates_contrastive_loss: 642167.5402; train_gene_expr_recon_loss: 1825561.4293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3812786.4456; train_optim_loss: 3812786.4456; val_kl_reg_loss: 25185.3692; val_edge_recon_loss: 1350193.8588; val_cat_covariates_contrastive_loss: 641423.5792; val_gene_expr_recon_loss: 1851179.0477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3867981.8740; val_optim_loss: 3867981.8740
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9672; val_auprc_score: 0.9883; val_best_acc_score: 0.9434; val_best_f1_score: 0.9644; train_kl_reg_loss: 25126.5314; train_edge_recon_loss: 1323572.2989; train_cat_covariates_contrastive_loss: 642247.4087; train_gene_expr_recon_loss: 1824468.2005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3815414.4448; train_optim_loss: 3815414.4448; val_kl_reg_loss: 25250.2447; val_edge_recon_loss: 1351030.4800; val_cat_covariates_contrastive_loss: 641864.9065; val_gene_expr_recon_loss: 1852698.7796; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3870844.4084; val_optim_loss: 3870844.4084
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9671; val_auprc_score: 0.9883; val_best_acc_score: 0.9434; val_best_f1_score: 0.9644; train_kl_reg_loss: 25083.4310; train_edge_recon_loss: 1321539.8214; train_cat_covariates_contrastive_loss: 641954.8826; train_gene_expr_recon_loss: 1824328.8328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3812906.9681; train_optim_loss: 3812906.9681; val_kl_reg_loss: 25195.4870; val_edge_recon_loss: 1332941.5344; val_cat_covariates_contrastive_loss: 641915.3220; val_gene_expr_recon_loss: 1851998.5210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3852050.8702; val_optim_loss: 3852050.8702
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9692; val_auprc_score: 0.9890; val_best_acc_score: 0.9442; val_best_f1_score: 0.9648; train_kl_reg_loss: 24959.1982; train_edge_recon_loss: 1325522.0949; train_cat_covariates_contrastive_loss: 642030.7247; train_gene_expr_recon_loss: 1824239.1873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3816751.2043; train_optim_loss: 3816751.2043; val_kl_reg_loss: 24846.2755; val_edge_recon_loss: 1333753.5802; val_cat_covariates_contrastive_loss: 642090.9256; val_gene_expr_recon_loss: 1854407.8950; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3855098.6851; val_optim_loss: 3855098.6851
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9680; val_auprc_score: 0.9887; val_best_acc_score: 0.9436; val_best_f1_score: 0.9645; train_kl_reg_loss: 24893.3741; train_edge_recon_loss: 1321552.7678; train_cat_covariates_contrastive_loss: 642179.1915; train_gene_expr_recon_loss: 1823091.8238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3811717.1544; train_optim_loss: 3811717.1544; val_kl_reg_loss: 24727.4666; val_edge_recon_loss: 1331052.1193; val_cat_covariates_contrastive_loss: 642241.7677; val_gene_expr_recon_loss: 1852549.1698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3850570.5248; val_optim_loss: 3850570.5248
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9703; val_auprc_score: 0.9896; val_best_acc_score: 0.9449; val_best_f1_score: 0.9653; train_kl_reg_loss: 24850.6619; train_edge_recon_loss: 1323939.7825; train_cat_covariates_contrastive_loss: 642051.0604; train_gene_expr_recon_loss: 1822303.6537; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3813145.1563; train_optim_loss: 3813145.1563; val_kl_reg_loss: 24927.8323; val_edge_recon_loss: 1332169.4905; val_cat_covariates_contrastive_loss: 642295.9952; val_gene_expr_recon_loss: 1852404.9475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3851798.2672; val_optim_loss: 3851798.2672
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9701; val_auprc_score: 0.9895; val_best_acc_score: 0.9447; val_best_f1_score: 0.9651; train_kl_reg_loss: 24822.4184; train_edge_recon_loss: 1321881.3927; train_cat_covariates_contrastive_loss: 641934.0255; train_gene_expr_recon_loss: 1822577.1419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3811214.9802; train_optim_loss: 3811214.9802; val_kl_reg_loss: 24846.9630; val_edge_recon_loss: 1334129.2042; val_cat_covariates_contrastive_loss: 641503.2314; val_gene_expr_recon_loss: 1851862.4914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3852341.8989; val_optim_loss: 3852341.8989
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9669; val_auprc_score: 0.9882; val_best_acc_score: 0.9429; val_best_f1_score: 0.9641; train_kl_reg_loss: 24710.4576; train_edge_recon_loss: 1324436.1158; train_cat_covariates_contrastive_loss: 641808.0325; train_gene_expr_recon_loss: 1821796.4947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3812751.0992; train_optim_loss: 3812751.0992; val_kl_reg_loss: 24879.4565; val_edge_recon_loss: 1341337.5344; val_cat_covariates_contrastive_loss: 641545.2910; val_gene_expr_recon_loss: 1850684.4466; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3858446.7195; val_optim_loss: 3858446.7195
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9689; val_auprc_score: 0.9887; val_best_acc_score: 0.9443; val_best_f1_score: 0.9649; train_kl_reg_loss: 24683.3743; train_edge_recon_loss: 1325435.1470; train_cat_covariates_contrastive_loss: 641738.4240; train_gene_expr_recon_loss: 1821574.4534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3813431.4014; train_optim_loss: 3813431.4014; val_kl_reg_loss: 24399.3996; val_edge_recon_loss: 1346443.8836; val_cat_covariates_contrastive_loss: 642358.5386; val_gene_expr_recon_loss: 1851548.6660; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3864750.4885; val_optim_loss: 3864750.4885

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9687; val_auprc_score: 0.9887; val_best_acc_score: 0.9439; val_best_f1_score: 0.9646; train_kl_reg_loss: 24511.7745; train_edge_recon_loss: 1323587.1401; train_cat_covariates_contrastive_loss: 642055.3561; train_gene_expr_recon_loss: 1817965.2855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3808119.5537; train_optim_loss: 3808119.5537; val_kl_reg_loss: 24670.6270; val_edge_recon_loss: 1351048.3263; val_cat_covariates_contrastive_loss: 642144.0749; val_gene_expr_recon_loss: 1849274.7357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3867137.7672; val_optim_loss: 3867137.7672
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9698; val_auprc_score: 0.9890; val_best_acc_score: 0.9439; val_best_f1_score: 0.9645; train_kl_reg_loss: 24662.0036; train_edge_recon_loss: 1323121.5412; train_cat_covariates_contrastive_loss: 641973.6365; train_gene_expr_recon_loss: 1817502.0373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3807259.2184; train_optim_loss: 3807259.2184; val_kl_reg_loss: 24732.5102; val_edge_recon_loss: 1349994.2901; val_cat_covariates_contrastive_loss: 641872.8855; val_gene_expr_recon_loss: 1853070.2834; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3869669.9847; val_optim_loss: 3869669.9847
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9701; val_auprc_score: 0.9894; val_best_acc_score: 0.9448; val_best_f1_score: 0.9651; train_kl_reg_loss: 24660.8376; train_edge_recon_loss: 1320972.1697; train_cat_covariates_contrastive_loss: 641791.5813; train_gene_expr_recon_loss: 1817375.7429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3804800.3337; train_optim_loss: 3804800.3337; val_kl_reg_loss: 24679.5074; val_edge_recon_loss: 1341650.8626; val_cat_covariates_contrastive_loss: 642675.5921; val_gene_expr_recon_loss: 1849059.1975; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3858065.1565; val_optim_loss: 3858065.1565
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9691; val_auprc_score: 0.9891; val_best_acc_score: 0.9438; val_best_f1_score: 0.9646; train_kl_reg_loss: 24579.7283; train_edge_recon_loss: 1324010.5955; train_cat_covariates_contrastive_loss: 641909.1361; train_gene_expr_recon_loss: 1817205.2882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3807704.7513; train_optim_loss: 3807704.7513; val_kl_reg_loss: 24608.2832; val_edge_recon_loss: 1342763.4752; val_cat_covariates_contrastive_loss: 641739.3430; val_gene_expr_recon_loss: 1848609.9370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3857721.0439; val_optim_loss: 3857721.0439

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 423 min 12 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
val AUROC score: 0.9043
val AUPRC score: 0.9518
val best accuracy score: 0.9158
val best F1 score: 0.9459
val target rna MSE score: 0.5237
val source rna MSE score: 0.1142
Val cat covariate0 mean sim diff: -0.0011
Val cat covariate1 mean sim diff: -0.0878
Duration of model training in run 2: 7 hours, 5 minutes and 22 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
