Run timestamp: 04092023_094213_3.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '12', '--edge_batch_size_list', '256', '--node_batch_size_list', 'None', '--seeds', '5', '--run_index', '6', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc_subsample_25pct', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 63535
Number of validation nodes: 7059
Number of training edges: 433334
Number of validation edges: 48148
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9425; val_auprc_score: 0.9761; val_best_acc_score: 0.9215; val_best_f1_score: 0.9502; train_kl_reg_loss: 12889.1022; train_edge_recon_loss: 1404938.2847; train_cat_covariates_contrastive_loss: 635549.0662; train_gene_expr_recon_loss: 3077508.5412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5130884.9903; train_optim_loss: 5130884.9903; val_kl_reg_loss: 11392.3439; val_edge_recon_loss: 1341420.3833; val_cat_covariates_contrastive_loss: 630293.9676; val_gene_expr_recon_loss: 2837729.4563; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4820836.1349; val_optim_loss: 4820836.1349
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9608; val_auprc_score: 0.9825; val_best_acc_score: 0.9409; val_best_f1_score: 0.9620; train_kl_reg_loss: 11994.7453; train_edge_recon_loss: 1336123.4299; train_cat_covariates_contrastive_loss: 633441.9345; train_gene_expr_recon_loss: 2749856.0741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4731416.1816; train_optim_loss: 4731416.1816; val_kl_reg_loss: 13447.7954; val_edge_recon_loss: 1338301.8767; val_cat_covariates_contrastive_loss: 636934.7407; val_gene_expr_recon_loss: 2635248.1257; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4623932.5423; val_optim_loss: 4623932.5423
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9545; val_auprc_score: 0.9784; val_best_acc_score: 0.9446; val_best_f1_score: 0.9644; train_kl_reg_loss: 16240.9683; train_edge_recon_loss: 1330917.9137; train_cat_covariates_contrastive_loss: 634957.8626; train_gene_expr_recon_loss: 2521723.0464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4503839.7939; train_optim_loss: 4503839.7939; val_kl_reg_loss: 18922.0265; val_edge_recon_loss: 1329113.5992; val_cat_covariates_contrastive_loss: 635374.6065; val_gene_expr_recon_loss: 2425361.7229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4408771.9616; val_optim_loss: 4408771.9616
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9637; val_auprc_score: 0.9827; val_best_acc_score: 0.9492; val_best_f1_score: 0.9672; train_kl_reg_loss: 19744.8698; train_edge_recon_loss: 1328127.8220; train_cat_covariates_contrastive_loss: 636538.0543; train_gene_expr_recon_loss: 2368849.3652; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4353260.1105; train_optim_loss: 4353260.1105; val_kl_reg_loss: 21277.4583; val_edge_recon_loss: 1335165.1908; val_cat_covariates_contrastive_loss: 638187.7536; val_gene_expr_recon_loss: 2331102.6065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4325733.0278; val_optim_loss: 4325733.0278
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9562; val_auprc_score: 0.9787; val_best_acc_score: 0.9489; val_best_f1_score: 0.9671; train_kl_reg_loss: 22071.3425; train_edge_recon_loss: 1327880.2676; train_cat_covariates_contrastive_loss: 636911.7356; train_gene_expr_recon_loss: 2290537.9975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4277401.3473; train_optim_loss: 4277401.3473; val_kl_reg_loss: 23420.6902; val_edge_recon_loss: 1340577.2844; val_cat_covariates_contrastive_loss: 635474.8905; val_gene_expr_recon_loss: 2294049.0668; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4293521.9444; val_optim_loss: 4293521.9444
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9621; val_auprc_score: 0.9817; val_best_acc_score: 0.9487; val_best_f1_score: 0.9668; train_kl_reg_loss: 23494.2499; train_edge_recon_loss: 1328753.8558; train_cat_covariates_contrastive_loss: 637196.4509; train_gene_expr_recon_loss: 2241940.1735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4231384.7289; train_optim_loss: 4231384.7289; val_kl_reg_loss: 23828.6720; val_edge_recon_loss: 1333391.5116; val_cat_covariates_contrastive_loss: 640084.8525; val_gene_expr_recon_loss: 2238830.2255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4236135.2804; val_optim_loss: 4236135.2804
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9597; val_auprc_score: 0.9798; val_best_acc_score: 0.9495; val_best_f1_score: 0.9673; train_kl_reg_loss: 24665.1028; train_edge_recon_loss: 1323786.7081; train_cat_covariates_contrastive_loss: 637831.3709; train_gene_expr_recon_loss: 2212599.7582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4198882.9445; train_optim_loss: 4198882.9445; val_kl_reg_loss: 25763.5781; val_edge_recon_loss: 1346110.4874; val_cat_covariates_contrastive_loss: 636742.3919; val_gene_expr_recon_loss: 2199414.2745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4208030.7328; val_optim_loss: 4208030.7328
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9627; val_auprc_score: 0.9817; val_best_acc_score: 0.9524; val_best_f1_score: 0.9692; train_kl_reg_loss: 25382.5839; train_edge_recon_loss: 1329227.0504; train_cat_covariates_contrastive_loss: 637755.4869; train_gene_expr_recon_loss: 2194346.5526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4186711.6757; train_optim_loss: 4186711.6757; val_kl_reg_loss: 24608.0618; val_edge_recon_loss: 1334419.9200; val_cat_covariates_contrastive_loss: 638867.1353; val_gene_expr_recon_loss: 2222902.3128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4220797.4378; val_optim_loss: 4220797.4378
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9634; val_auprc_score: 0.9813; val_best_acc_score: 0.9522; val_best_f1_score: 0.9691; train_kl_reg_loss: 26422.0872; train_edge_recon_loss: 1325517.9455; train_cat_covariates_contrastive_loss: 638090.8231; train_gene_expr_recon_loss: 2175943.6540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4165974.5130; train_optim_loss: 4165974.5130; val_kl_reg_loss: 26687.0190; val_edge_recon_loss: 1340013.1958; val_cat_covariates_contrastive_loss: 638838.9838; val_gene_expr_recon_loss: 2176227.4233; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4181766.6310; val_optim_loss: 4181766.6310
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9652; val_auprc_score: 0.9825; val_best_acc_score: 0.9535; val_best_f1_score: 0.9700; train_kl_reg_loss: 26845.6381; train_edge_recon_loss: 1325113.1329; train_cat_covariates_contrastive_loss: 638229.2860; train_gene_expr_recon_loss: 2168283.7409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4158471.7983; train_optim_loss: 4158471.7983; val_kl_reg_loss: 26992.4133; val_edge_recon_loss: 1322847.1802; val_cat_covariates_contrastive_loss: 638029.8132; val_gene_expr_recon_loss: 2181943.5536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4169812.9630; val_optim_loss: 4169812.9630
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9627; val_auprc_score: 0.9816; val_best_acc_score: 0.9511; val_best_f1_score: 0.9684; train_kl_reg_loss: 27572.7414; train_edge_recon_loss: 1321434.1230; train_cat_covariates_contrastive_loss: 638608.6557; train_gene_expr_recon_loss: 2156424.3146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4144039.8302; train_optim_loss: 4144039.8302; val_kl_reg_loss: 28181.6636; val_edge_recon_loss: 1328717.7579; val_cat_covariates_contrastive_loss: 638172.0060; val_gene_expr_recon_loss: 2170261.1382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4165332.5754; val_optim_loss: 4165332.5754
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9653; val_auprc_score: 0.9821; val_best_acc_score: 0.9541; val_best_f1_score: 0.9703; train_kl_reg_loss: 28150.2971; train_edge_recon_loss: 1324780.5889; train_cat_covariates_contrastive_loss: 638703.5751; train_gene_expr_recon_loss: 2142747.6518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4134382.1156; train_optim_loss: 4134382.1156; val_kl_reg_loss: 27560.4077; val_edge_recon_loss: 1345648.5013; val_cat_covariates_contrastive_loss: 640118.8125; val_gene_expr_recon_loss: 2164332.9120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4177660.6151; val_optim_loss: 4177660.6151
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9639; val_auprc_score: 0.9819; val_best_acc_score: 0.9540; val_best_f1_score: 0.9703; train_kl_reg_loss: 28869.7513; train_edge_recon_loss: 1323016.9892; train_cat_covariates_contrastive_loss: 638882.3251; train_gene_expr_recon_loss: 2148787.0467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4139556.1192; train_optim_loss: 4139556.1192; val_kl_reg_loss: 28208.0629; val_edge_recon_loss: 1330847.1270; val_cat_covariates_contrastive_loss: 640828.2755; val_gene_expr_recon_loss: 2159591.1534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4159474.6442; val_optim_loss: 4159474.6442
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9671; val_auprc_score: 0.9835; val_best_acc_score: 0.9526; val_best_f1_score: 0.9691; train_kl_reg_loss: 29127.7879; train_edge_recon_loss: 1324241.9247; train_cat_covariates_contrastive_loss: 639161.1401; train_gene_expr_recon_loss: 2141384.6503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4133915.4988; train_optim_loss: 4133915.4988; val_kl_reg_loss: 28249.1794; val_edge_recon_loss: 1333707.1157; val_cat_covariates_contrastive_loss: 641492.6806; val_gene_expr_recon_loss: 2160978.9557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4164427.9299; val_optim_loss: 4164427.9299
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9639; val_auprc_score: 0.9818; val_best_acc_score: 0.9540; val_best_f1_score: 0.9702; train_kl_reg_loss: 29873.1445; train_edge_recon_loss: 1322712.3798; train_cat_covariates_contrastive_loss: 639112.4877; train_gene_expr_recon_loss: 2133481.4031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4125179.4163; train_optim_loss: 4125179.4163; val_kl_reg_loss: 30083.5587; val_edge_recon_loss: 1330188.7493; val_cat_covariates_contrastive_loss: 639332.3350; val_gene_expr_recon_loss: 2156530.3704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4156135.0238; val_optim_loss: 4156135.0238
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9632; val_auprc_score: 0.9815; val_best_acc_score: 0.9539; val_best_f1_score: 0.9702; train_kl_reg_loss: 30005.3010; train_edge_recon_loss: 1323266.7983; train_cat_covariates_contrastive_loss: 639408.3996; train_gene_expr_recon_loss: 2123937.8069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4116618.3123; train_optim_loss: 4116618.3123; val_kl_reg_loss: 30204.6913; val_edge_recon_loss: 1329847.8056; val_cat_covariates_contrastive_loss: 639572.8803; val_gene_expr_recon_loss: 2143298.0179; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4142923.3902; val_optim_loss: 4142923.3902
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9653; val_auprc_score: 0.9828; val_best_acc_score: 0.9534; val_best_f1_score: 0.9698; train_kl_reg_loss: 30370.3894; train_edge_recon_loss: 1325334.5281; train_cat_covariates_contrastive_loss: 639414.6746; train_gene_expr_recon_loss: 2128093.9939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4123213.5883; train_optim_loss: 4123213.5883; val_kl_reg_loss: 29367.7306; val_edge_recon_loss: 1328533.8581; val_cat_covariates_contrastive_loss: 641800.2513; val_gene_expr_recon_loss: 2144397.9530; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4144099.7976; val_optim_loss: 4144099.7976
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9610; val_auprc_score: 0.9799; val_best_acc_score: 0.9515; val_best_f1_score: 0.9686; train_kl_reg_loss: 30864.7413; train_edge_recon_loss: 1326992.8320; train_cat_covariates_contrastive_loss: 639770.8209; train_gene_expr_recon_loss: 2126360.8534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4123989.2441; train_optim_loss: 4123989.2441; val_kl_reg_loss: 30589.2477; val_edge_recon_loss: 1336708.3393; val_cat_covariates_contrastive_loss: 640772.5926; val_gene_expr_recon_loss: 2151112.7586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4159182.9312; val_optim_loss: 4159182.9312
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9603; val_auprc_score: 0.9798; val_best_acc_score: 0.9534; val_best_f1_score: 0.9699; train_kl_reg_loss: 31358.2193; train_edge_recon_loss: 1324928.4754; train_cat_covariates_contrastive_loss: 639711.4661; train_gene_expr_recon_loss: 2113778.3165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4109776.4823; train_optim_loss: 4109776.4823; val_kl_reg_loss: 31205.9319; val_edge_recon_loss: 1330615.2176; val_cat_covariates_contrastive_loss: 638427.3856; val_gene_expr_recon_loss: 2223917.7851; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4224166.2989; val_optim_loss: 4224166.2989
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9593; val_auprc_score: 0.9790; val_best_acc_score: 0.9524; val_best_f1_score: 0.9692; train_kl_reg_loss: 31578.1441; train_edge_recon_loss: 1324879.1042; train_cat_covariates_contrastive_loss: 639978.6883; train_gene_expr_recon_loss: 2122093.1534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4118529.0890; train_optim_loss: 4118529.0890; val_kl_reg_loss: 31727.5389; val_edge_recon_loss: 1336367.8132; val_cat_covariates_contrastive_loss: 639536.5665; val_gene_expr_recon_loss: 2137650.0086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4145281.9180; val_optim_loss: 4145281.9180

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9604; val_auprc_score: 0.9793; val_best_acc_score: 0.9554; val_best_f1_score: 0.9711; train_kl_reg_loss: 31085.2908; train_edge_recon_loss: 1319016.5533; train_cat_covariates_contrastive_loss: 640228.9552; train_gene_expr_recon_loss: 2058260.1802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4048590.9776; train_optim_loss: 4048590.9776; val_kl_reg_loss: 31509.2019; val_edge_recon_loss: 1328654.9861; val_cat_covariates_contrastive_loss: 640569.2970; val_gene_expr_recon_loss: 2104213.9107; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4104947.3915; val_optim_loss: 4104947.3915
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9652; val_auprc_score: 0.9822; val_best_acc_score: 0.9565; val_best_f1_score: 0.9718; train_kl_reg_loss: 31079.6779; train_edge_recon_loss: 1321201.4083; train_cat_covariates_contrastive_loss: 640351.9334; train_gene_expr_recon_loss: 2045886.4120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4038519.4338; train_optim_loss: 4038519.4338; val_kl_reg_loss: 30989.7575; val_edge_recon_loss: 1320368.7844; val_cat_covariates_contrastive_loss: 639589.7847; val_gene_expr_recon_loss: 2099246.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4090194.3347; val_optim_loss: 4090194.3347
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9624; val_auprc_score: 0.9804; val_best_acc_score: 0.9551; val_best_f1_score: 0.9710; train_kl_reg_loss: 30933.9828; train_edge_recon_loss: 1317521.9994; train_cat_covariates_contrastive_loss: 640307.5140; train_gene_expr_recon_loss: 2042920.7953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4031684.2900; train_optim_loss: 4031684.2900; val_kl_reg_loss: 30514.9102; val_edge_recon_loss: 1329044.9239; val_cat_covariates_contrastive_loss: 640383.1872; val_gene_expr_recon_loss: 2096504.8988; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4096447.9140; val_optim_loss: 4096447.9140
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9626; val_auprc_score: 0.9806; val_best_acc_score: 0.9552; val_best_f1_score: 0.9710; train_kl_reg_loss: 30720.2470; train_edge_recon_loss: 1317078.0279; train_cat_covariates_contrastive_loss: 640022.8548; train_gene_expr_recon_loss: 2040254.1445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4028075.2698; train_optim_loss: 4028075.2698; val_kl_reg_loss: 30297.9420; val_edge_recon_loss: 1327575.6901; val_cat_covariates_contrastive_loss: 640704.7437; val_gene_expr_recon_loss: 2094402.8142; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4092981.1944; val_optim_loss: 4092981.1944
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9647; val_auprc_score: 0.9821; val_best_acc_score: 0.9569; val_best_f1_score: 0.9722; train_kl_reg_loss: 30609.4066; train_edge_recon_loss: 1323761.2460; train_cat_covariates_contrastive_loss: 640123.6362; train_gene_expr_recon_loss: 2033887.6313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4028381.9207; train_optim_loss: 4028381.9207; val_kl_reg_loss: 30708.4297; val_edge_recon_loss: 1319531.2579; val_cat_covariates_contrastive_loss: 639713.2437; val_gene_expr_recon_loss: 2087100.8505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4077053.7950; val_optim_loss: 4077053.7950
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9626; val_auprc_score: 0.9806; val_best_acc_score: 0.9554; val_best_f1_score: 0.9711; train_kl_reg_loss: 30491.7922; train_edge_recon_loss: 1317767.9173; train_cat_covariates_contrastive_loss: 640120.1067; train_gene_expr_recon_loss: 2033184.4923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4021564.3039; train_optim_loss: 4021564.3039; val_kl_reg_loss: 30637.9529; val_edge_recon_loss: 1334048.3241; val_cat_covariates_contrastive_loss: 638542.0843; val_gene_expr_recon_loss: 2087856.7302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4091085.0939; val_optim_loss: 4091085.0939
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9632; val_auprc_score: 0.9808; val_best_acc_score: 0.9561; val_best_f1_score: 0.9717; train_kl_reg_loss: 30384.6250; train_edge_recon_loss: 1318530.0729; train_cat_covariates_contrastive_loss: 639746.2714; train_gene_expr_recon_loss: 2030174.3032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4018835.2732; train_optim_loss: 4018835.2732; val_kl_reg_loss: 30189.0852; val_edge_recon_loss: 1320104.5003; val_cat_covariates_contrastive_loss: 639388.8138; val_gene_expr_recon_loss: 2087982.5741; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4077664.9722; val_optim_loss: 4077664.9722
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9650; val_auprc_score: 0.9822; val_best_acc_score: 0.9576; val_best_f1_score: 0.9726; train_kl_reg_loss: 30132.2801; train_edge_recon_loss: 1313824.7302; train_cat_covariates_contrastive_loss: 639747.2210; train_gene_expr_recon_loss: 2029808.9129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4013513.1392; train_optim_loss: 4013513.1392; val_kl_reg_loss: 29759.9931; val_edge_recon_loss: 1322966.4534; val_cat_covariates_contrastive_loss: 640102.3819; val_gene_expr_recon_loss: 2081993.4107; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4074822.2368; val_optim_loss: 4074822.2368
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9637; val_auprc_score: 0.9815; val_best_acc_score: 0.9566; val_best_f1_score: 0.9719; train_kl_reg_loss: 30002.5698; train_edge_recon_loss: 1318085.0085; train_cat_covariates_contrastive_loss: 639530.5272; train_gene_expr_recon_loss: 2027676.6230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4015294.7293; train_optim_loss: 4015294.7293; val_kl_reg_loss: 29939.3288; val_edge_recon_loss: 1328530.1845; val_cat_covariates_contrastive_loss: 639276.3819; val_gene_expr_recon_loss: 2083751.0099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4081496.9127; val_optim_loss: 4081496.9127
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9653; val_auprc_score: 0.9820; val_best_acc_score: 0.9576; val_best_f1_score: 0.9724; train_kl_reg_loss: 29860.0704; train_edge_recon_loss: 1322014.4436; train_cat_covariates_contrastive_loss: 639507.9440; train_gene_expr_recon_loss: 2025862.5263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4017244.9836; train_optim_loss: 4017244.9836; val_kl_reg_loss: 29899.8298; val_edge_recon_loss: 1321939.4193; val_cat_covariates_contrastive_loss: 639474.3737; val_gene_expr_recon_loss: 2085826.0093; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4077139.6349; val_optim_loss: 4077139.6349
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9638; val_auprc_score: 0.9810; val_best_acc_score: 0.9558; val_best_f1_score: 0.9713; train_kl_reg_loss: 29671.7091; train_edge_recon_loss: 1318462.0691; train_cat_covariates_contrastive_loss: 639481.2505; train_gene_expr_recon_loss: 2025503.4691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4013118.5038; train_optim_loss: 4013118.5038; val_kl_reg_loss: 29737.3102; val_edge_recon_loss: 1333061.5516; val_cat_covariates_contrastive_loss: 639912.6782; val_gene_expr_recon_loss: 2081144.2943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4083855.8466; val_optim_loss: 4083855.8466
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9655; val_auprc_score: 0.9820; val_best_acc_score: 0.9559; val_best_f1_score: 0.9713; train_kl_reg_loss: 29608.5961; train_edge_recon_loss: 1316770.5777; train_cat_covariates_contrastive_loss: 639581.9407; train_gene_expr_recon_loss: 2024763.5611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4010724.6748; train_optim_loss: 4010724.6748; val_kl_reg_loss: 29039.9031; val_edge_recon_loss: 1335572.5390; val_cat_covariates_contrastive_loss: 640308.5856; val_gene_expr_recon_loss: 2086954.7784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4091875.8201; val_optim_loss: 4091875.8201

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9648; val_auprc_score: 0.9816; val_best_acc_score: 0.9553; val_best_f1_score: 0.9711; train_kl_reg_loss: 29396.7600; train_edge_recon_loss: 1319454.5122; train_cat_covariates_contrastive_loss: 639390.0363; train_gene_expr_recon_loss: 2017865.7104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4006107.0190; train_optim_loss: 4006107.0190; val_kl_reg_loss: 29125.4537; val_edge_recon_loss: 1329422.7149; val_cat_covariates_contrastive_loss: 640357.6055; val_gene_expr_recon_loss: 2083869.0556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4082774.8360; val_optim_loss: 4082774.8360
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9657; val_auprc_score: 0.9820; val_best_acc_score: 0.9567; val_best_f1_score: 0.9720; train_kl_reg_loss: 29360.8149; train_edge_recon_loss: 1320057.5193; train_cat_covariates_contrastive_loss: 639340.0648; train_gene_expr_recon_loss: 2018004.8199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4006763.2202; train_optim_loss: 4006763.2202; val_kl_reg_loss: 29213.8649; val_edge_recon_loss: 1328347.3413; val_cat_covariates_contrastive_loss: 639436.3892; val_gene_expr_recon_loss: 2080010.0536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4077007.6534; val_optim_loss: 4077007.6534
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9627; val_auprc_score: 0.9805; val_best_acc_score: 0.9565; val_best_f1_score: 0.9718; train_kl_reg_loss: 29353.4452; train_edge_recon_loss: 1315244.2163; train_cat_covariates_contrastive_loss: 639179.5152; train_gene_expr_recon_loss: 2017414.5588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4001191.7366; train_optim_loss: 4001191.7366; val_kl_reg_loss: 29153.6782; val_edge_recon_loss: 1337806.5066; val_cat_covariates_contrastive_loss: 639130.2090; val_gene_expr_recon_loss: 2081491.1171; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4087581.5119; val_optim_loss: 4087581.5119
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9649; val_auprc_score: 0.9815; val_best_acc_score: 0.9579; val_best_f1_score: 0.9727; train_kl_reg_loss: 29226.9732; train_edge_recon_loss: 1316351.0644; train_cat_covariates_contrastive_loss: 639456.9300; train_gene_expr_recon_loss: 2016456.4406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4001491.4071; train_optim_loss: 4001491.4071; val_kl_reg_loss: 29035.0479; val_edge_recon_loss: 1327484.8512; val_cat_covariates_contrastive_loss: 639746.8214; val_gene_expr_recon_loss: 2083630.1475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4079896.8664; val_optim_loss: 4079896.8664

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 368 min 25 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
val AUROC score: 0.9234
val AUPRC score: 0.9519
val best accuracy score: 0.9434
val best F1 score: 0.9629
val target rna MSE score: 1.0662
val source rna MSE score: 0.0782
Val cat covariate0 mean sim diff: -0.0012
Val cat covariate1 mean sim diff: -0.0785
Duration of model training in run 6: 6 hours, 11 minutes and 44 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
