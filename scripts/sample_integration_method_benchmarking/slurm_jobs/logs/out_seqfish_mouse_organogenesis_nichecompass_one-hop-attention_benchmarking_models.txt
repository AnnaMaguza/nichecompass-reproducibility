First script finished. Launching follow up script.
Run timestamp: 01062023_130115.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-attention_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-attention', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9625; val_auprc_score: 0.9927; val_best_acc_score: 0.9367; val_best_f1_score: 0.9635; train_kl_reg_loss: 167.3838; train_edge_recon_loss: 100043.7600; train_gene_expr_recon_loss: 112835.4799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213046.6250; train_optim_loss: 213046.6250; val_kl_reg_loss: 141.5943; val_edge_recon_loss: 104220.3828; val_gene_expr_recon_loss: 102439.7617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206801.7344; val_optim_loss: 206801.7344
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9094; val_auprc_score: 0.9797; val_best_acc_score: 0.9130; val_best_f1_score: 0.9504; train_kl_reg_loss: 570.8920; train_edge_recon_loss: 93189.7366; train_gene_expr_recon_loss: 101862.5407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195623.1685; train_optim_loss: 195623.1685; val_kl_reg_loss: 1873.7002; val_edge_recon_loss: 82178.1172; val_gene_expr_recon_loss: 100280.3789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184332.1953; val_optim_loss: 184332.1953
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9185; val_auprc_score: 0.9826; val_best_acc_score: 0.9198; val_best_f1_score: 0.9542; train_kl_reg_loss: 3031.6630; train_edge_recon_loss: 81150.4364; train_gene_expr_recon_loss: 99564.4721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183746.5703; train_optim_loss: 183746.5703; val_kl_reg_loss: 3046.0873; val_edge_recon_loss: 79982.9492; val_gene_expr_recon_loss: 98553.8945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181582.9375; val_optim_loss: 181582.9375
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9384; val_auprc_score: 0.9866; val_best_acc_score: 0.9260; val_best_f1_score: 0.9576; train_kl_reg_loss: 2531.8446; train_edge_recon_loss: 80234.9336; train_gene_expr_recon_loss: 98167.5725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180934.3516; train_optim_loss: 180934.3516; val_kl_reg_loss: 2078.1947; val_edge_recon_loss: 80180.6484; val_gene_expr_recon_loss: 97244.0586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179502.9062; val_optim_loss: 179502.9062
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9479; val_auprc_score: 0.9889; val_best_acc_score: 0.9320; val_best_f1_score: 0.9609; train_kl_reg_loss: 2186.9422; train_edge_recon_loss: 79348.9286; train_gene_expr_recon_loss: 97064.3800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178600.2511; train_optim_loss: 178600.2511; val_kl_reg_loss: 2174.4270; val_edge_recon_loss: 79943.5312; val_gene_expr_recon_loss: 95907.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178025.2891; val_optim_loss: 178025.2891
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9604; val_auprc_score: 0.9914; val_best_acc_score: 0.9428; val_best_f1_score: 0.9668; train_kl_reg_loss: 2211.7634; train_edge_recon_loss: 78813.6546; train_gene_expr_recon_loss: 96155.5022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177180.9219; train_optim_loss: 177180.9219; val_kl_reg_loss: 2124.1924; val_edge_recon_loss: 78137.2930; val_gene_expr_recon_loss: 95560.3867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175821.8750; val_optim_loss: 175821.8750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9656; val_auprc_score: 0.9929; val_best_acc_score: 0.9481; val_best_f1_score: 0.9701; train_kl_reg_loss: 2174.2320; train_edge_recon_loss: 77989.9559; train_gene_expr_recon_loss: 95526.2416; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175690.4275; train_optim_loss: 175690.4275; val_kl_reg_loss: 2088.5615; val_edge_recon_loss: 76314.2422; val_gene_expr_recon_loss: 94427.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172830.6562; val_optim_loss: 172830.6562
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9718; val_auprc_score: 0.9937; val_best_acc_score: 0.9553; val_best_f1_score: 0.9741; train_kl_reg_loss: 2137.2325; train_edge_recon_loss: 78227.5078; train_gene_expr_recon_loss: 94836.8717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175201.6127; train_optim_loss: 175201.6127; val_kl_reg_loss: 2094.0645; val_edge_recon_loss: 77487.8789; val_gene_expr_recon_loss: 94573.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174155.2344; val_optim_loss: 174155.2344
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9733; val_auprc_score: 0.9928; val_best_acc_score: 0.9571; val_best_f1_score: 0.9750; train_kl_reg_loss: 2123.7825; train_edge_recon_loss: 77276.0658; train_gene_expr_recon_loss: 94292.7232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173692.5681; train_optim_loss: 173692.5681; val_kl_reg_loss: 2078.7574; val_edge_recon_loss: 79179.1914; val_gene_expr_recon_loss: 93827.5039; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175085.4531; val_optim_loss: 175085.4531
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9736; val_auprc_score: 0.9922; val_best_acc_score: 0.9580; val_best_f1_score: 0.9756; train_kl_reg_loss: 2133.6467; train_edge_recon_loss: 78274.5318; train_gene_expr_recon_loss: 93843.2015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174251.3795; train_optim_loss: 174251.3795; val_kl_reg_loss: 2042.7767; val_edge_recon_loss: 79992.8242; val_gene_expr_recon_loss: 93544.2617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175579.8594; val_optim_loss: 175579.8594

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9772; val_auprc_score: 0.9949; val_best_acc_score: 0.9589; val_best_f1_score: 0.9763; train_kl_reg_loss: 2110.2647; train_edge_recon_loss: 77072.5374; train_gene_expr_recon_loss: 93643.6886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172826.4922; train_optim_loss: 172826.4922; val_kl_reg_loss: 2063.6610; val_edge_recon_loss: 77572.2656; val_gene_expr_recon_loss: 93129.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172765.5547; val_optim_loss: 172765.5547
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9738; val_auprc_score: 0.9937; val_best_acc_score: 0.9588; val_best_f1_score: 0.9760; train_kl_reg_loss: 2106.0381; train_edge_recon_loss: 76358.6412; train_gene_expr_recon_loss: 93579.9515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172044.6295; train_optim_loss: 172044.6295; val_kl_reg_loss: 2040.2080; val_edge_recon_loss: 78292.7344; val_gene_expr_recon_loss: 93296.0586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173629.0000; val_optim_loss: 173629.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9750; val_auprc_score: 0.9927; val_best_acc_score: 0.9607; val_best_f1_score: 0.9771; train_kl_reg_loss: 2104.2241; train_edge_recon_loss: 77234.6546; train_gene_expr_recon_loss: 93558.1975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172897.0759; train_optim_loss: 172897.0759; val_kl_reg_loss: 2037.7755; val_edge_recon_loss: 78341.4102; val_gene_expr_recon_loss: 92420.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172799.6797; val_optim_loss: 172799.6797
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9765; val_auprc_score: 0.9946; val_best_acc_score: 0.9599; val_best_f1_score: 0.9767; train_kl_reg_loss: 2097.8786; train_edge_recon_loss: 77033.1657; train_gene_expr_recon_loss: 93446.1953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172577.2400; train_optim_loss: 172577.2400; val_kl_reg_loss: 2051.1720; val_edge_recon_loss: 76820.4570; val_gene_expr_recon_loss: 93373.1211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172244.7500; val_optim_loss: 172244.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9761; val_auprc_score: 0.9944; val_best_acc_score: 0.9590; val_best_f1_score: 0.9763; train_kl_reg_loss: 2095.9107; train_edge_recon_loss: 77152.7338; train_gene_expr_recon_loss: 93391.3984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172640.0413; train_optim_loss: 172640.0413; val_kl_reg_loss: 2028.4510; val_edge_recon_loss: 78697.9727; val_gene_expr_recon_loss: 92854.4883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173580.9141; val_optim_loss: 173580.9141
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9770; val_auprc_score: 0.9938; val_best_acc_score: 0.9608; val_best_f1_score: 0.9773; train_kl_reg_loss: 2102.0076; train_edge_recon_loss: 77975.4492; train_gene_expr_recon_loss: 93464.3717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173541.8315; train_optim_loss: 173541.8315; val_kl_reg_loss: 2043.7689; val_edge_recon_loss: 77051.4609; val_gene_expr_recon_loss: 93078.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172174.0078; val_optim_loss: 172174.0078
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9750; val_auprc_score: 0.9936; val_best_acc_score: 0.9604; val_best_f1_score: 0.9770; train_kl_reg_loss: 2101.5762; train_edge_recon_loss: 77479.4492; train_gene_expr_recon_loss: 93437.1669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173018.1942; train_optim_loss: 173018.1942; val_kl_reg_loss: 2043.1609; val_edge_recon_loss: 78116.8711; val_gene_expr_recon_loss: 92398.6211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172558.6562; val_optim_loss: 172558.6562
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9772; val_auprc_score: 0.9945; val_best_acc_score: 0.9612; val_best_f1_score: 0.9773; train_kl_reg_loss: 2093.4270; train_edge_recon_loss: 77652.7684; train_gene_expr_recon_loss: 93247.3488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172993.5435; train_optim_loss: 172993.5435; val_kl_reg_loss: 2030.1573; val_edge_recon_loss: 79997.9062; val_gene_expr_recon_loss: 92920.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174948.5156; val_optim_loss: 174948.5156
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9772; val_auprc_score: 0.9937; val_best_acc_score: 0.9634; val_best_f1_score: 0.9788; train_kl_reg_loss: 2086.7734; train_edge_recon_loss: 77383.7366; train_gene_expr_recon_loss: 93185.1518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172655.6629; train_optim_loss: 172655.6629; val_kl_reg_loss: 2027.4095; val_edge_recon_loss: 76886.4375; val_gene_expr_recon_loss: 92284.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171198.3438; val_optim_loss: 171198.3438
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9742; val_auprc_score: 0.9938; val_best_acc_score: 0.9599; val_best_f1_score: 0.9768; train_kl_reg_loss: 2079.3052; train_edge_recon_loss: 76341.3627; train_gene_expr_recon_loss: 93252.6903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171673.3583; train_optim_loss: 171673.3583; val_kl_reg_loss: 2024.1673; val_edge_recon_loss: 78856.6953; val_gene_expr_recon_loss: 93108.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173989.7734; val_optim_loss: 173989.7734
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9780; val_auprc_score: 0.9951; val_best_acc_score: 0.9609; val_best_f1_score: 0.9773; train_kl_reg_loss: 2077.5108; train_edge_recon_loss: 77026.6032; train_gene_expr_recon_loss: 93212.8270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172316.9408; train_optim_loss: 172316.9408; val_kl_reg_loss: 2028.1041; val_edge_recon_loss: 77437.3945; val_gene_expr_recon_loss: 93116.3789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172581.8828; val_optim_loss: 172581.8828
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9770; val_auprc_score: 0.9936; val_best_acc_score: 0.9607; val_best_f1_score: 0.9771; train_kl_reg_loss: 2083.9244; train_edge_recon_loss: 76655.9548; train_gene_expr_recon_loss: 93159.8376; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171899.7176; train_optim_loss: 171899.7176; val_kl_reg_loss: 2023.4861; val_edge_recon_loss: 79856.0234; val_gene_expr_recon_loss: 92817.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174697.1250; val_optim_loss: 174697.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9750; val_auprc_score: 0.9942; val_best_acc_score: 0.9617; val_best_f1_score: 0.9778; train_kl_reg_loss: 2074.9742; train_edge_recon_loss: 77120.8220; train_gene_expr_recon_loss: 93095.7969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172291.5915; train_optim_loss: 172291.5915; val_kl_reg_loss: 2019.7116; val_edge_recon_loss: 77635.8867; val_gene_expr_recon_loss: 93096.4648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172752.0625; val_optim_loss: 172752.0625
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9758; val_auprc_score: 0.9935; val_best_acc_score: 0.9623; val_best_f1_score: 0.9782; train_kl_reg_loss: 2073.4085; train_edge_recon_loss: 77250.1328; train_gene_expr_recon_loss: 93139.6585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172463.2009; train_optim_loss: 172463.2009; val_kl_reg_loss: 2011.2010; val_edge_recon_loss: 78268.0508; val_gene_expr_recon_loss: 92543.4102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172822.6641; val_optim_loss: 172822.6641
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9771; val_auprc_score: 0.9951; val_best_acc_score: 0.9598; val_best_f1_score: 0.9767; train_kl_reg_loss: 2077.6451; train_edge_recon_loss: 77345.5039; train_gene_expr_recon_loss: 93179.5095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172602.6562; train_optim_loss: 172602.6562; val_kl_reg_loss: 2016.6526; val_edge_recon_loss: 78367.0352; val_gene_expr_recon_loss: 92537.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172920.7812; val_optim_loss: 172920.7812

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 52 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9769
Val AUPRC score: 0.9944
Val best accuracy score: 0.9624
Val best F1 score: 0.9782
Val gene expr MSE score: 1.1407
Duration of model training in run 1: 0 hours, 1 minutes and 58 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9593; val_auprc_score: 0.9914; val_best_acc_score: 0.9399; val_best_f1_score: 0.9652; train_kl_reg_loss: 160.5475; train_edge_recon_loss: 101856.5831; train_gene_expr_recon_loss: 112478.8142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214495.9453; train_optim_loss: 214495.9453; val_kl_reg_loss: 157.3593; val_edge_recon_loss: 102141.9102; val_gene_expr_recon_loss: 101739.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204038.4375; val_optim_loss: 204038.4375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9020; val_auprc_score: 0.9786; val_best_acc_score: 0.9114; val_best_f1_score: 0.9499; train_kl_reg_loss: 886.9041; train_edge_recon_loss: 91158.4654; train_gene_expr_recon_loss: 101483.2935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193528.6629; train_optim_loss: 193528.6629; val_kl_reg_loss: 2598.7209; val_edge_recon_loss: 80395.2461; val_gene_expr_recon_loss: 99399.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182393.4844; val_optim_loss: 182393.4844
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9200; val_auprc_score: 0.9813; val_best_acc_score: 0.9180; val_best_f1_score: 0.9530; train_kl_reg_loss: 3301.8226; train_edge_recon_loss: 80172.7433; train_gene_expr_recon_loss: 99270.4241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182744.9911; train_optim_loss: 182744.9911; val_kl_reg_loss: 2858.8154; val_edge_recon_loss: 82102.4961; val_gene_expr_recon_loss: 97511.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182472.8438; val_optim_loss: 182472.8438
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9416; val_auprc_score: 0.9874; val_best_acc_score: 0.9285; val_best_f1_score: 0.9590; train_kl_reg_loss: 2390.4531; train_edge_recon_loss: 79469.8142; train_gene_expr_recon_loss: 97817.6395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179677.9051; train_optim_loss: 179677.9051; val_kl_reg_loss: 2060.7938; val_edge_recon_loss: 80209.6406; val_gene_expr_recon_loss: 96139.7070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178410.1406; val_optim_loss: 178410.1406
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9492; val_auprc_score: 0.9888; val_best_acc_score: 0.9361; val_best_f1_score: 0.9632; train_kl_reg_loss: 2240.5510; train_edge_recon_loss: 78006.2210; train_gene_expr_recon_loss: 96796.1853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177042.9576; train_optim_loss: 177042.9576; val_kl_reg_loss: 2178.7188; val_edge_recon_loss: 77321.1523; val_gene_expr_recon_loss: 96017.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175517.8438; val_optim_loss: 175517.8438
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9660; val_auprc_score: 0.9932; val_best_acc_score: 0.9470; val_best_f1_score: 0.9696; train_kl_reg_loss: 2150.1128; train_edge_recon_loss: 78033.4219; train_gene_expr_recon_loss: 95999.3002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176182.8371; train_optim_loss: 176182.8371; val_kl_reg_loss: 2044.7247; val_edge_recon_loss: 76220.9531; val_gene_expr_recon_loss: 94205.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172471.5078; val_optim_loss: 172471.5078
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9675; val_auprc_score: 0.9928; val_best_acc_score: 0.9492; val_best_f1_score: 0.9707; train_kl_reg_loss: 2143.0750; train_edge_recon_loss: 77641.2628; train_gene_expr_recon_loss: 95300.1010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175084.4420; train_optim_loss: 175084.4420; val_kl_reg_loss: 2061.0712; val_edge_recon_loss: 76298.6797; val_gene_expr_recon_loss: 94174.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172534.4844; val_optim_loss: 172534.4844
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9723; val_auprc_score: 0.9939; val_best_acc_score: 0.9527; val_best_f1_score: 0.9727; train_kl_reg_loss: 2131.3698; train_edge_recon_loss: 77444.6401; train_gene_expr_recon_loss: 94643.8555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174219.8650; train_optim_loss: 174219.8650; val_kl_reg_loss: 2118.1727; val_edge_recon_loss: 78895.0664; val_gene_expr_recon_loss: 93893.0820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174906.3125; val_optim_loss: 174906.3125
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9729; val_auprc_score: 0.9937; val_best_acc_score: 0.9570; val_best_f1_score: 0.9752; train_kl_reg_loss: 2166.8417; train_edge_recon_loss: 79360.6847; train_gene_expr_recon_loss: 94138.7997; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175666.3270; train_optim_loss: 175666.3270; val_kl_reg_loss: 2054.6475; val_edge_recon_loss: 76636.2773; val_gene_expr_recon_loss: 93721.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172412.2188; val_optim_loss: 172412.2188
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9743; val_auprc_score: 0.9938; val_best_acc_score: 0.9595; val_best_f1_score: 0.9766; train_kl_reg_loss: 2130.5615; train_edge_recon_loss: 77630.5145; train_gene_expr_recon_loss: 93718.4442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173479.5212; train_optim_loss: 173479.5212; val_kl_reg_loss: 2003.3507; val_edge_recon_loss: 76662.7734; val_gene_expr_recon_loss: 91897.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170564.1250; val_optim_loss: 170564.1250
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9750; val_auprc_score: 0.9946; val_best_acc_score: 0.9620; val_best_f1_score: 0.9780; train_kl_reg_loss: 2100.8419; train_edge_recon_loss: 76850.1044; train_gene_expr_recon_loss: 93360.6016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172311.5480; train_optim_loss: 172311.5480; val_kl_reg_loss: 2005.0898; val_edge_recon_loss: 74208.4492; val_gene_expr_recon_loss: 92122.5742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168336.1172; val_optim_loss: 168336.1172
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9764; val_auprc_score: 0.9945; val_best_acc_score: 0.9627; val_best_f1_score: 0.9783; train_kl_reg_loss: 2088.3829; train_edge_recon_loss: 77249.2299; train_gene_expr_recon_loss: 93034.7450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172372.3549; train_optim_loss: 172372.3549; val_kl_reg_loss: 1999.1255; val_edge_recon_loss: 77996.0312; val_gene_expr_recon_loss: 91988.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171983.2500; val_optim_loss: 171983.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9779; val_auprc_score: 0.9946; val_best_acc_score: 0.9656; val_best_f1_score: 0.9800; train_kl_reg_loss: 2058.9083; train_edge_recon_loss: 75950.1222; train_gene_expr_recon_loss: 92736.6551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170745.6875; train_optim_loss: 170745.6875; val_kl_reg_loss: 2003.8859; val_edge_recon_loss: 77460.7539; val_gene_expr_recon_loss: 91128.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170592.9766; val_optim_loss: 170592.9766
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9800; val_auprc_score: 0.9949; val_best_acc_score: 0.9647; val_best_f1_score: 0.9796; train_kl_reg_loss: 2049.0169; train_edge_recon_loss: 77165.8304; train_gene_expr_recon_loss: 92447.4029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171662.2500; train_optim_loss: 171662.2500; val_kl_reg_loss: 1971.2669; val_edge_recon_loss: 76247.5781; val_gene_expr_recon_loss: 91432.0664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169650.9141; val_optim_loss: 169650.9141

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9802; val_auprc_score: 0.9959; val_best_acc_score: 0.9649; val_best_f1_score: 0.9796; train_kl_reg_loss: 2031.3326; train_edge_recon_loss: 77283.8225; train_gene_expr_recon_loss: 92280.2606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171595.4174; train_optim_loss: 171595.4174; val_kl_reg_loss: 1975.4224; val_edge_recon_loss: 78009.1914; val_gene_expr_recon_loss: 90885.9961; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170870.6094; val_optim_loss: 170870.6094
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9817; val_auprc_score: 0.9955; val_best_acc_score: 0.9672; val_best_f1_score: 0.9808; train_kl_reg_loss: 2030.8197; train_edge_recon_loss: 76504.4950; train_gene_expr_recon_loss: 92321.7316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170857.0458; train_optim_loss: 170857.0458; val_kl_reg_loss: 1971.8978; val_edge_recon_loss: 78225.2500; val_gene_expr_recon_loss: 91420.9727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171618.1094; val_optim_loss: 171618.1094
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9805; val_auprc_score: 0.9956; val_best_acc_score: 0.9667; val_best_f1_score: 0.9807; train_kl_reg_loss: 2024.7302; train_edge_recon_loss: 76419.9872; train_gene_expr_recon_loss: 92181.6786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170626.3984; train_optim_loss: 170626.3984; val_kl_reg_loss: 1971.9654; val_edge_recon_loss: 75766.3398; val_gene_expr_recon_loss: 91485.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169223.9297; val_optim_loss: 169223.9297

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 15 sec.
Using best model state, which was in epoch 11.

--- MODEL EVALUATION ---
Val AUROC score: 0.9788
Val AUPRC score: 0.9957
Val best accuracy score: 0.9592
Val best F1 score: 0.9762
Val gene expr MSE score: 1.1089
Duration of model training in run 2: 0 hours, 1 minutes and 17 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 214020
Number of validation edges: 23779
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9167; val_auprc_score: 0.9833; val_best_acc_score: 0.9143; val_best_f1_score: 0.9515; train_kl_reg_loss: 248.5475; train_edge_recon_loss: 99106.3738; train_gene_expr_recon_loss: 106312.8854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205667.8073; train_optim_loss: 205667.8073; val_kl_reg_loss: 917.0593; val_edge_recon_loss: 82433.0443; val_gene_expr_recon_loss: 98483.8073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181833.9115; val_optim_loss: 181833.9115
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9433; val_auprc_score: 0.9881; val_best_acc_score: 0.9269; val_best_f1_score: 0.9580; train_kl_reg_loss: 2506.2150; train_edge_recon_loss: 81848.9983; train_gene_expr_recon_loss: 97272.7619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181627.9774; train_optim_loss: 181627.9774; val_kl_reg_loss: 2101.0617; val_edge_recon_loss: 79425.2161; val_gene_expr_recon_loss: 95959.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177485.4062; val_optim_loss: 177485.4062
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9737; val_auprc_score: 0.9944; val_best_acc_score: 0.9552; val_best_f1_score: 0.9740; train_kl_reg_loss: 2128.4980; train_edge_recon_loss: 79686.9207; train_gene_expr_recon_loss: 95581.1386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177396.5567; train_optim_loss: 177396.5567; val_kl_reg_loss: 2059.6536; val_edge_recon_loss: 78327.6198; val_gene_expr_recon_loss: 94386.2682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174773.5417; val_optim_loss: 174773.5417
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9801; val_auprc_score: 0.9959; val_best_acc_score: 0.9647; val_best_f1_score: 0.9795; train_kl_reg_loss: 2098.2395; train_edge_recon_loss: 78113.5454; train_gene_expr_recon_loss: 94092.2775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174304.0608; train_optim_loss: 174304.0608; val_kl_reg_loss: 2034.4949; val_edge_recon_loss: 77131.0495; val_gene_expr_recon_loss: 93126.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172291.8438; val_optim_loss: 172291.8438
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9818; val_auprc_score: 0.9963; val_best_acc_score: 0.9685; val_best_f1_score: 0.9818; train_kl_reg_loss: 2069.1693; train_edge_recon_loss: 76750.6102; train_gene_expr_recon_loss: 93041.4742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171861.2523; train_optim_loss: 171861.2523; val_kl_reg_loss: 1975.1556; val_edge_recon_loss: 74911.5990; val_gene_expr_recon_loss: 92239.2526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169126.0052; val_optim_loss: 169126.0052
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9854; val_auprc_score: 0.9968; val_best_acc_score: 0.9720; val_best_f1_score: 0.9837; train_kl_reg_loss: 2053.2324; train_edge_recon_loss: 77694.6400; train_gene_expr_recon_loss: 92330.2514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172078.1227; train_optim_loss: 172078.1227; val_kl_reg_loss: 2041.5223; val_edge_recon_loss: 77256.8021; val_gene_expr_recon_loss: 91663.7682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170962.0938; val_optim_loss: 170962.0938
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9858; val_auprc_score: 0.9966; val_best_acc_score: 0.9732; val_best_f1_score: 0.9844; train_kl_reg_loss: 2046.3886; train_edge_recon_loss: 77271.1670; train_gene_expr_recon_loss: 91640.7662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170958.3212; train_optim_loss: 170958.3212; val_kl_reg_loss: 1948.1403; val_edge_recon_loss: 76473.0286; val_gene_expr_recon_loss: 91083.1823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169504.3490; val_optim_loss: 169504.3490
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9872; val_auprc_score: 0.9968; val_best_acc_score: 0.9739; val_best_f1_score: 0.9848; train_kl_reg_loss: 2011.9603; train_edge_recon_loss: 77288.6221; train_gene_expr_recon_loss: 91159.3423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170459.9248; train_optim_loss: 170459.9248; val_kl_reg_loss: 1993.4933; val_edge_recon_loss: 77300.3021; val_gene_expr_recon_loss: 90531.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169825.6302; val_optim_loss: 169825.6302

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9875; val_auprc_score: 0.9973; val_best_acc_score: 0.9746; val_best_f1_score: 0.9852; train_kl_reg_loss: 1989.3111; train_edge_recon_loss: 77263.5489; train_gene_expr_recon_loss: 90643.4589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169896.3183; train_optim_loss: 169896.3183; val_kl_reg_loss: 1939.7144; val_edge_recon_loss: 76440.4792; val_gene_expr_recon_loss: 90486.2760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168866.4688; val_optim_loss: 168866.4688
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9884; val_auprc_score: 0.9972; val_best_acc_score: 0.9758; val_best_f1_score: 0.9859; train_kl_reg_loss: 1980.0192; train_edge_recon_loss: 76778.8828; train_gene_expr_recon_loss: 90756.5880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169515.4907; train_optim_loss: 169515.4907; val_kl_reg_loss: 1963.1406; val_edge_recon_loss: 75718.7500; val_gene_expr_recon_loss: 90477.1042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168158.9896; val_optim_loss: 168158.9896
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9865; val_auprc_score: 0.9966; val_best_acc_score: 0.9743; val_best_f1_score: 0.9850; train_kl_reg_loss: 1983.2704; train_edge_recon_loss: 76827.3391; train_gene_expr_recon_loss: 90670.5596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169481.1672; train_optim_loss: 169481.1672; val_kl_reg_loss: 1957.2743; val_edge_recon_loss: 77310.1458; val_gene_expr_recon_loss: 90222.0964; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169489.5208; val_optim_loss: 169489.5208
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9868; val_auprc_score: 0.9969; val_best_acc_score: 0.9744; val_best_f1_score: 0.9851; train_kl_reg_loss: 1984.0709; train_edge_recon_loss: 76973.8365; train_gene_expr_recon_loss: 90857.1120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169815.0197; train_optim_loss: 169815.0197; val_kl_reg_loss: 1942.6528; val_edge_recon_loss: 76037.2500; val_gene_expr_recon_loss: 90182.3698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168162.2760; val_optim_loss: 168162.2760
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9872; val_auprc_score: 0.9966; val_best_acc_score: 0.9737; val_best_f1_score: 0.9846; train_kl_reg_loss: 1966.6098; train_edge_recon_loss: 76445.1444; train_gene_expr_recon_loss: 90699.0136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169110.7668; train_optim_loss: 169110.7668; val_kl_reg_loss: 1939.8018; val_edge_recon_loss: 78504.2734; val_gene_expr_recon_loss: 90184.8411; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170628.9167; val_optim_loss: 170628.9167

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9865; val_auprc_score: 0.9965; val_best_acc_score: 0.9747; val_best_f1_score: 0.9853; train_kl_reg_loss: 1969.3411; train_edge_recon_loss: 77116.1259; train_gene_expr_recon_loss: 90559.3698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169644.8362; train_optim_loss: 169644.8362; val_kl_reg_loss: 1938.6588; val_edge_recon_loss: 77201.7318; val_gene_expr_recon_loss: 90257.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169398.1354; val_optim_loss: 169398.1354
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9883; val_auprc_score: 0.9974; val_best_acc_score: 0.9756; val_best_f1_score: 0.9858; train_kl_reg_loss: 1970.1197; train_edge_recon_loss: 76443.1921; train_gene_expr_recon_loss: 90622.3886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169035.7008; train_optim_loss: 169035.7008; val_kl_reg_loss: 1944.4974; val_edge_recon_loss: 76835.9766; val_gene_expr_recon_loss: 90320.8021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169101.2760; val_optim_loss: 169101.2760
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9876; val_auprc_score: 0.9971; val_best_acc_score: 0.9750; val_best_f1_score: 0.9854; train_kl_reg_loss: 1974.5802; train_edge_recon_loss: 76595.8302; train_gene_expr_recon_loss: 90692.5119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169262.9219; train_optim_loss: 169262.9219; val_kl_reg_loss: 1943.0194; val_edge_recon_loss: 76842.0573; val_gene_expr_recon_loss: 90091.3620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168876.4375; val_optim_loss: 168876.4375

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 28 sec.
Using best model state, which was in epoch 10.

--- MODEL EVALUATION ---
Val AUROC score: 0.9878
Val AUPRC score: 0.9971
Val best accuracy score: 0.9749
Val best F1 score: 0.9853
Val gene expr MSE score: 1.0485
Duration of model training in run 3: 0 hours, 2 minutes and 32 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 214020
Number of validation edges: 23779
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9210; val_auprc_score: 0.9827; val_best_acc_score: 0.9183; val_best_f1_score: 0.9533; train_kl_reg_loss: 308.2036; train_edge_recon_loss: 97898.2135; train_gene_expr_recon_loss: 106663.7969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204870.2159; train_optim_loss: 204870.2159; val_kl_reg_loss: 1565.5750; val_edge_recon_loss: 82943.2891; val_gene_expr_recon_loss: 99928.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184437.6823; val_optim_loss: 184437.6823
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9521; val_auprc_score: 0.9892; val_best_acc_score: 0.9377; val_best_f1_score: 0.9640; train_kl_reg_loss: 2662.3003; train_edge_recon_loss: 81236.0353; train_gene_expr_recon_loss: 97382.0188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181280.3530; train_optim_loss: 181280.3530; val_kl_reg_loss: 2013.4550; val_edge_recon_loss: 80808.9349; val_gene_expr_recon_loss: 96961.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179783.7083; val_optim_loss: 179783.7083
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9721; val_auprc_score: 0.9937; val_best_acc_score: 0.9565; val_best_f1_score: 0.9748; train_kl_reg_loss: 2145.8071; train_edge_recon_loss: 78495.2503; train_gene_expr_recon_loss: 95225.6400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175866.6973; train_optim_loss: 175866.6973; val_kl_reg_loss: 2052.1069; val_edge_recon_loss: 77990.4531; val_gene_expr_recon_loss: 95399.5052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175442.0625; val_optim_loss: 175442.0625
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9798; val_auprc_score: 0.9954; val_best_acc_score: 0.9642; val_best_f1_score: 0.9792; train_kl_reg_loss: 2093.1273; train_edge_recon_loss: 77546.6157; train_gene_expr_recon_loss: 93822.0747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173461.8194; train_optim_loss: 173461.8194; val_kl_reg_loss: 2022.9029; val_edge_recon_loss: 77114.1693; val_gene_expr_recon_loss: 94108.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173245.6719; val_optim_loss: 173245.6719
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9821; val_auprc_score: 0.9959; val_best_acc_score: 0.9681; val_best_f1_score: 0.9815; train_kl_reg_loss: 2069.6371; train_edge_recon_loss: 77264.7821; train_gene_expr_recon_loss: 92935.5738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172269.9942; train_optim_loss: 172269.9942; val_kl_reg_loss: 2024.1812; val_edge_recon_loss: 76286.2292; val_gene_expr_recon_loss: 93206.3802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171516.7865; val_optim_loss: 171516.7865
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9850; val_auprc_score: 0.9967; val_best_acc_score: 0.9705; val_best_f1_score: 0.9828; train_kl_reg_loss: 2056.2050; train_edge_recon_loss: 77362.2095; train_gene_expr_recon_loss: 92260.4907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171678.9051; train_optim_loss: 171678.9051; val_kl_reg_loss: 2071.3132; val_edge_recon_loss: 77101.4323; val_gene_expr_recon_loss: 92447.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171619.9479; val_optim_loss: 171619.9479
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9861; val_auprc_score: 0.9971; val_best_acc_score: 0.9730; val_best_f1_score: 0.9844; train_kl_reg_loss: 2042.5809; train_edge_recon_loss: 77453.8058; train_gene_expr_recon_loss: 91586.5084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171082.8941; train_optim_loss: 171082.8941; val_kl_reg_loss: 1964.7958; val_edge_recon_loss: 75354.3672; val_gene_expr_recon_loss: 92246.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169566.0260; val_optim_loss: 169566.0260
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9865; val_auprc_score: 0.9965; val_best_acc_score: 0.9726; val_best_f1_score: 0.9840; train_kl_reg_loss: 2009.8751; train_edge_recon_loss: 76222.0324; train_gene_expr_recon_loss: 90867.1670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169099.0747; train_optim_loss: 169099.0747; val_kl_reg_loss: 2026.5302; val_edge_recon_loss: 77917.1901; val_gene_expr_recon_loss: 91570.6745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171514.3958; val_optim_loss: 171514.3958
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9873; val_auprc_score: 0.9968; val_best_acc_score: 0.9748; val_best_f1_score: 0.9853; train_kl_reg_loss: 1992.0135; train_edge_recon_loss: 76378.7057; train_gene_expr_recon_loss: 90695.4696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169066.1875; train_optim_loss: 169066.1875; val_kl_reg_loss: 1972.1401; val_edge_recon_loss: 77109.4115; val_gene_expr_recon_loss: 91147.7396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170229.2969; val_optim_loss: 170229.2969
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9884; val_auprc_score: 0.9974; val_best_acc_score: 0.9772; val_best_f1_score: 0.9867; train_kl_reg_loss: 1979.6547; train_edge_recon_loss: 76730.4013; train_gene_expr_recon_loss: 90197.3267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168907.3819; train_optim_loss: 168907.3819; val_kl_reg_loss: 1990.7798; val_edge_recon_loss: 76424.8932; val_gene_expr_recon_loss: 90708.8620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169124.5365; val_optim_loss: 169124.5365
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9902; val_auprc_score: 0.9978; val_best_acc_score: 0.9768; val_best_f1_score: 0.9865; train_kl_reg_loss: 1967.8002; train_edge_recon_loss: 76612.6322; train_gene_expr_recon_loss: 89715.1192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168295.5538; train_optim_loss: 168295.5538; val_kl_reg_loss: 1971.4708; val_edge_recon_loss: 77263.2552; val_gene_expr_recon_loss: 90328.5026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169563.2292; val_optim_loss: 169563.2292
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9893; val_auprc_score: 0.9972; val_best_acc_score: 0.9796; val_best_f1_score: 0.9881; train_kl_reg_loss: 1964.9405; train_edge_recon_loss: 76439.4580; train_gene_expr_recon_loss: 89649.9757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168054.3733; train_optim_loss: 168054.3733; val_kl_reg_loss: 1935.2493; val_edge_recon_loss: 75863.9583; val_gene_expr_recon_loss: 90175.5651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167974.7708; val_optim_loss: 167974.7708
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9915; val_auprc_score: 0.9982; val_best_acc_score: 0.9801; val_best_f1_score: 0.9884; train_kl_reg_loss: 1956.6575; train_edge_recon_loss: 76648.0495; train_gene_expr_recon_loss: 89201.7474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167806.4537; train_optim_loss: 167806.4537; val_kl_reg_loss: 1908.7059; val_edge_recon_loss: 74588.9714; val_gene_expr_recon_loss: 89860.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166358.0312; val_optim_loss: 166358.0312
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9894; val_auprc_score: 0.9976; val_best_acc_score: 0.9789; val_best_f1_score: 0.9877; train_kl_reg_loss: 1955.7936; train_edge_recon_loss: 76945.2888; train_gene_expr_recon_loss: 89024.6591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167925.7436; train_optim_loss: 167925.7436; val_kl_reg_loss: 1938.0866; val_edge_recon_loss: 76132.7943; val_gene_expr_recon_loss: 89707.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167778.2292; val_optim_loss: 167778.2292
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9916; val_auprc_score: 0.9980; val_best_acc_score: 0.9792; val_best_f1_score: 0.9879; train_kl_reg_loss: 1956.5050; train_edge_recon_loss: 76395.9829; train_gene_expr_recon_loss: 89040.5078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167392.9965; train_optim_loss: 167392.9965; val_kl_reg_loss: 1952.7023; val_edge_recon_loss: 76595.5859; val_gene_expr_recon_loss: 89587.6615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168135.9531; val_optim_loss: 168135.9531
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9899; val_auprc_score: 0.9962; val_best_acc_score: 0.9807; val_best_f1_score: 0.9887; train_kl_reg_loss: 1951.5957; train_edge_recon_loss: 76693.8061; train_gene_expr_recon_loss: 88616.8307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167262.2338; train_optim_loss: 167262.2338; val_kl_reg_loss: 1927.8264; val_edge_recon_loss: 76622.6432; val_gene_expr_recon_loss: 89490.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168041.1302; val_optim_loss: 168041.1302

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9913; val_auprc_score: 0.9975; val_best_acc_score: 0.9812; val_best_f1_score: 0.9890; train_kl_reg_loss: 1947.7126; train_edge_recon_loss: 76572.7002; train_gene_expr_recon_loss: 88519.5460; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167039.9595; train_optim_loss: 167039.9595; val_kl_reg_loss: 1922.7782; val_edge_recon_loss: 77442.8750; val_gene_expr_recon_loss: 89100.2526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168465.9062; val_optim_loss: 168465.9062
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9905; val_auprc_score: 0.9976; val_best_acc_score: 0.9803; val_best_f1_score: 0.9885; train_kl_reg_loss: 1944.9547; train_edge_recon_loss: 76383.2251; train_gene_expr_recon_loss: 88299.0339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166627.2147; train_optim_loss: 166627.2147; val_kl_reg_loss: 1914.8618; val_edge_recon_loss: 77196.5260; val_gene_expr_recon_loss: 89151.7526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168263.1458; val_optim_loss: 168263.1458
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9934; val_auprc_score: 0.9986; val_best_acc_score: 0.9825; val_best_f1_score: 0.9898; train_kl_reg_loss: 1942.3519; train_edge_recon_loss: 76580.2269; train_gene_expr_recon_loss: 88271.1806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166793.7587; train_optim_loss: 166793.7587; val_kl_reg_loss: 1913.6834; val_edge_recon_loss: 75409.0234; val_gene_expr_recon_loss: 89266.0182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166588.7188; val_optim_loss: 166588.7188

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 1 sec.
Using best model state, which was in epoch 13.

--- MODEL EVALUATION ---
Val AUROC score: 0.9911
Val AUPRC score: 0.9981
Val best accuracy score: 0.9793
Val best F1 score: 0.9879
Val gene expr MSE score: 1.0348
Duration of model training in run 4: 0 hours, 3 minutes and 5 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 319410
Number of validation edges: 35490
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9283; val_auprc_score: 0.9853; val_best_acc_score: 0.9195; val_best_f1_score: 0.9542; train_kl_reg_loss: 927.3796; train_edge_recon_loss: 94384.1915; train_gene_expr_recon_loss: 102619.2047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197930.7752; train_optim_loss: 197930.7752; val_kl_reg_loss: 3204.8706; val_edge_recon_loss: 81942.9984; val_gene_expr_recon_loss: 97008.6766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182156.5469; val_optim_loss: 182156.5469
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9725; val_auprc_score: 0.9942; val_best_acc_score: 0.9564; val_best_f1_score: 0.9747; train_kl_reg_loss: 2311.9928; train_edge_recon_loss: 79872.0733; train_gene_expr_recon_loss: 94623.6629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176807.7304; train_optim_loss: 176807.7304; val_kl_reg_loss: 1998.4488; val_edge_recon_loss: 78859.9406; val_gene_expr_recon_loss: 94135.5016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174993.8937; val_optim_loss: 174993.8937
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9829; val_auprc_score: 0.9962; val_best_acc_score: 0.9684; val_best_f1_score: 0.9816; train_kl_reg_loss: 2042.9154; train_edge_recon_loss: 77737.4972; train_gene_expr_recon_loss: 92402.7692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172183.1835; train_optim_loss: 172183.1835; val_kl_reg_loss: 2047.5295; val_edge_recon_loss: 77221.3313; val_gene_expr_recon_loss: 92447.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171716.1063; val_optim_loss: 171716.1063
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9857; val_auprc_score: 0.9967; val_best_acc_score: 0.9729; val_best_f1_score: 0.9842; train_kl_reg_loss: 2030.0648; train_edge_recon_loss: 77605.1380; train_gene_expr_recon_loss: 91044.8413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170680.0445; train_optim_loss: 170680.0445; val_kl_reg_loss: 1977.0949; val_edge_recon_loss: 77476.9375; val_gene_expr_recon_loss: 91278.0875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170732.1219; val_optim_loss: 170732.1219
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9887; val_auprc_score: 0.9973; val_best_acc_score: 0.9760; val_best_f1_score: 0.9860; train_kl_reg_loss: 1998.3923; train_edge_recon_loss: 77000.3063; train_gene_expr_recon_loss: 90188.6154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169187.3137; train_optim_loss: 169187.3137; val_kl_reg_loss: 1956.6157; val_edge_recon_loss: 77727.6313; val_gene_expr_recon_loss: 90738.6125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170422.8625; val_optim_loss: 170422.8625
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9896; val_auprc_score: 0.9972; val_best_acc_score: 0.9785; val_best_f1_score: 0.9875; train_kl_reg_loss: 1965.8848; train_edge_recon_loss: 76790.3694; train_gene_expr_recon_loss: 89491.6404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168247.8950; train_optim_loss: 168247.8950; val_kl_reg_loss: 1961.3791; val_edge_recon_loss: 76087.4469; val_gene_expr_recon_loss: 90026.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168075.6063; val_optim_loss: 168075.6063
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9912; val_auprc_score: 0.9977; val_best_acc_score: 0.9802; val_best_f1_score: 0.9885; train_kl_reg_loss: 1950.5855; train_edge_recon_loss: 76512.3686; train_gene_expr_recon_loss: 89088.2873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167551.2412; train_optim_loss: 167551.2412; val_kl_reg_loss: 1911.2923; val_edge_recon_loss: 75681.9297; val_gene_expr_recon_loss: 89497.4031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167090.6250; val_optim_loss: 167090.6250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9914; val_auprc_score: 0.9982; val_best_acc_score: 0.9817; val_best_f1_score: 0.9893; train_kl_reg_loss: 1941.1699; train_edge_recon_loss: 76834.3073; train_gene_expr_recon_loss: 88581.2692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167356.7468; train_optim_loss: 167356.7468; val_kl_reg_loss: 1894.2086; val_edge_recon_loss: 76177.8859; val_gene_expr_recon_loss: 89357.8078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167429.9031; val_optim_loss: 167429.9031
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9918; val_auprc_score: 0.9982; val_best_acc_score: 0.9807; val_best_f1_score: 0.9888; train_kl_reg_loss: 1940.6584; train_edge_recon_loss: 76488.2226; train_gene_expr_recon_loss: 88193.2931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166622.1739; train_optim_loss: 166622.1739; val_kl_reg_loss: 1912.2724; val_edge_recon_loss: 76734.5922; val_gene_expr_recon_loss: 88760.2156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167407.0812; val_optim_loss: 167407.0812
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9911; val_auprc_score: 0.9974; val_best_acc_score: 0.9822; val_best_f1_score: 0.9896; train_kl_reg_loss: 1935.5983; train_edge_recon_loss: 76566.7644; train_gene_expr_recon_loss: 87848.9625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166351.3261; train_optim_loss: 166351.3261; val_kl_reg_loss: 1917.7077; val_edge_recon_loss: 74894.2500; val_gene_expr_recon_loss: 88415.7359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165227.6938; val_optim_loss: 165227.6938
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9924; val_auprc_score: 0.9982; val_best_acc_score: 0.9837; val_best_f1_score: 0.9905; train_kl_reg_loss: 1930.1095; train_edge_recon_loss: 75965.5112; train_gene_expr_recon_loss: 87526.4844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165422.1058; train_optim_loss: 165422.1058; val_kl_reg_loss: 1904.8036; val_edge_recon_loss: 76106.0797; val_gene_expr_recon_loss: 88255.5281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166266.4125; val_optim_loss: 166266.4125
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9926; val_auprc_score: 0.9979; val_best_acc_score: 0.9838; val_best_f1_score: 0.9906; train_kl_reg_loss: 1933.5194; train_edge_recon_loss: 75984.1769; train_gene_expr_recon_loss: 87224.4980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165142.1927; train_optim_loss: 165142.1927; val_kl_reg_loss: 1879.2310; val_edge_recon_loss: 75757.4484; val_gene_expr_recon_loss: 88260.0844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165896.7594; val_optim_loss: 165896.7594
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9930; val_auprc_score: 0.9981; val_best_acc_score: 0.9841; val_best_f1_score: 0.9907; train_kl_reg_loss: 1934.6395; train_edge_recon_loss: 76686.9780; train_gene_expr_recon_loss: 87008.4417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165630.0589; train_optim_loss: 165630.0589; val_kl_reg_loss: 1909.7376; val_edge_recon_loss: 77780.8656; val_gene_expr_recon_loss: 87909.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167599.6938; val_optim_loss: 167599.6938

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9922; val_auprc_score: 0.9982; val_best_acc_score: 0.9837; val_best_f1_score: 0.9905; train_kl_reg_loss: 1936.2440; train_edge_recon_loss: 76565.5052; train_gene_expr_recon_loss: 86760.9874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165262.7384; train_optim_loss: 165262.7384; val_kl_reg_loss: 1904.9646; val_edge_recon_loss: 76666.2625; val_gene_expr_recon_loss: 87051.1078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165622.3344; val_optim_loss: 165622.3344
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9930; val_auprc_score: 0.9983; val_best_acc_score: 0.9845; val_best_f1_score: 0.9909; train_kl_reg_loss: 1929.4661; train_edge_recon_loss: 76334.5671; train_gene_expr_recon_loss: 86764.1599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165028.1935; train_optim_loss: 165028.1935; val_kl_reg_loss: 1904.8276; val_edge_recon_loss: 76354.8266; val_gene_expr_recon_loss: 87283.1938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165542.8469; val_optim_loss: 165542.8469
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9929; val_auprc_score: 0.9983; val_best_acc_score: 0.9843; val_best_f1_score: 0.9908; train_kl_reg_loss: 1929.2205; train_edge_recon_loss: 76488.9473; train_gene_expr_recon_loss: 86638.3580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165056.5260; train_optim_loss: 165056.5260; val_kl_reg_loss: 1900.0667; val_edge_recon_loss: 75716.6250; val_gene_expr_recon_loss: 87628.9641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165245.6562; val_optim_loss: 165245.6562

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 27 sec.
Using best model state, which was in epoch 10.

--- MODEL EVALUATION ---
Val AUROC score: 0.9910
Val AUPRC score: 0.9979
Val best accuracy score: 0.9827
Val best F1 score: 0.9899
Val gene expr MSE score: 1.0209
Duration of model training in run 5: 0 hours, 4 minutes and 33 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 319410
Number of validation edges: 35490
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9431; val_auprc_score: 0.9881; val_best_acc_score: 0.9266; val_best_f1_score: 0.9580; train_kl_reg_loss: 1173.8957; train_edge_recon_loss: 92545.9934; train_gene_expr_recon_loss: 102280.8259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196000.7147; train_optim_loss: 196000.7147; val_kl_reg_loss: 3118.5793; val_edge_recon_loss: 80101.2484; val_gene_expr_recon_loss: 96991.3766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180211.2000; val_optim_loss: 180211.2000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9755; val_auprc_score: 0.9950; val_best_acc_score: 0.9599; val_best_f1_score: 0.9769; train_kl_reg_loss: 2253.4924; train_edge_recon_loss: 79006.9786; train_gene_expr_recon_loss: 94697.6749; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175958.1454; train_optim_loss: 175958.1454; val_kl_reg_loss: 2032.9043; val_edge_recon_loss: 75627.7250; val_gene_expr_recon_loss: 94268.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171929.1344; val_optim_loss: 171929.1344
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9847; val_auprc_score: 0.9967; val_best_acc_score: 0.9700; val_best_f1_score: 0.9825; train_kl_reg_loss: 2054.1016; train_edge_recon_loss: 77099.1943; train_gene_expr_recon_loss: 92569.5619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171722.8582; train_optim_loss: 171722.8582; val_kl_reg_loss: 2034.5451; val_edge_recon_loss: 77816.1609; val_gene_expr_recon_loss: 92814.7609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172665.4688; val_optim_loss: 172665.4688
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9875; val_auprc_score: 0.9970; val_best_acc_score: 0.9735; val_best_f1_score: 0.9846; train_kl_reg_loss: 2032.9684; train_edge_recon_loss: 77290.9455; train_gene_expr_recon_loss: 91261.6623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170585.5773; train_optim_loss: 170585.5773; val_kl_reg_loss: 2008.5695; val_edge_recon_loss: 76510.1359; val_gene_expr_recon_loss: 91815.1969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170333.9031; val_optim_loss: 170333.9031
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9862; val_auprc_score: 0.9961; val_best_acc_score: 0.9754; val_best_f1_score: 0.9856; train_kl_reg_loss: 2009.9871; train_edge_recon_loss: 76789.8790; train_gene_expr_recon_loss: 90398.4667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169198.3337; train_optim_loss: 169198.3337; val_kl_reg_loss: 1956.1381; val_edge_recon_loss: 77415.9109; val_gene_expr_recon_loss: 91009.3156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170381.3656; val_optim_loss: 170381.3656
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9886; val_auprc_score: 0.9968; val_best_acc_score: 0.9774; val_best_f1_score: 0.9869; train_kl_reg_loss: 1981.4917; train_edge_recon_loss: 76608.1324; train_gene_expr_recon_loss: 89729.3442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168318.9683; train_optim_loss: 168318.9683; val_kl_reg_loss: 1968.4254; val_edge_recon_loss: 75871.0344; val_gene_expr_recon_loss: 90547.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168387.2313; val_optim_loss: 168387.2313
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9915; val_auprc_score: 0.9982; val_best_acc_score: 0.9790; val_best_f1_score: 0.9878; train_kl_reg_loss: 1962.2004; train_edge_recon_loss: 76224.2827; train_gene_expr_recon_loss: 89094.0499; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167280.5329; train_optim_loss: 167280.5329; val_kl_reg_loss: 1933.0769; val_edge_recon_loss: 76006.3328; val_gene_expr_recon_loss: 89904.2453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167843.6562; val_optim_loss: 167843.6562
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9909; val_auprc_score: 0.9977; val_best_acc_score: 0.9795; val_best_f1_score: 0.9880; train_kl_reg_loss: 1940.9301; train_edge_recon_loss: 76177.0092; train_gene_expr_recon_loss: 88658.0675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166776.0084; train_optim_loss: 166776.0084; val_kl_reg_loss: 1913.3698; val_edge_recon_loss: 77935.7188; val_gene_expr_recon_loss: 89391.6859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169240.7781; val_optim_loss: 169240.7781
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9911; val_auprc_score: 0.9981; val_best_acc_score: 0.9803; val_best_f1_score: 0.9886; train_kl_reg_loss: 1945.0529; train_edge_recon_loss: 76572.5785; train_gene_expr_recon_loss: 88299.5347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166817.1663; train_optim_loss: 166817.1663; val_kl_reg_loss: 1928.0504; val_edge_recon_loss: 75189.8156; val_gene_expr_recon_loss: 89226.1859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166344.0531; val_optim_loss: 166344.0531
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9918; val_auprc_score: 0.9978; val_best_acc_score: 0.9809; val_best_f1_score: 0.9889; train_kl_reg_loss: 1938.3700; train_edge_recon_loss: 76403.7262; train_gene_expr_recon_loss: 87969.5377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166311.6326; train_optim_loss: 166311.6326; val_kl_reg_loss: 1875.0440; val_edge_recon_loss: 76563.9172; val_gene_expr_recon_loss: 88662.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167101.5562; val_optim_loss: 167101.5562
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9920; val_auprc_score: 0.9981; val_best_acc_score: 0.9821; val_best_f1_score: 0.9896; train_kl_reg_loss: 1935.7059; train_edge_recon_loss: 76621.2584; train_gene_expr_recon_loss: 87681.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166238.7344; train_optim_loss: 166238.7344; val_kl_reg_loss: 1891.1213; val_edge_recon_loss: 75353.2141; val_gene_expr_recon_loss: 88511.0188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165755.3531; val_optim_loss: 165755.3531
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9920; val_auprc_score: 0.9982; val_best_acc_score: 0.9816; val_best_f1_score: 0.9893; train_kl_reg_loss: 1935.6311; train_edge_recon_loss: 76454.5321; train_gene_expr_recon_loss: 87370.3856; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165760.5493; train_optim_loss: 165760.5493; val_kl_reg_loss: 1903.9915; val_edge_recon_loss: 75658.5156; val_gene_expr_recon_loss: 88135.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165698.1094; val_optim_loss: 165698.1094
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9923; val_auprc_score: 0.9981; val_best_acc_score: 0.9835; val_best_f1_score: 0.9904; train_kl_reg_loss: 1931.5556; train_edge_recon_loss: 76555.8448; train_gene_expr_recon_loss: 87121.8740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165609.2728; train_optim_loss: 165609.2728; val_kl_reg_loss: 1889.8577; val_edge_recon_loss: 76577.0828; val_gene_expr_recon_loss: 87847.0250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166313.9688; val_optim_loss: 166313.9688
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9933; val_auprc_score: 0.9982; val_best_acc_score: 0.9834; val_best_f1_score: 0.9903; train_kl_reg_loss: 1931.7617; train_edge_recon_loss: 76491.0415; train_gene_expr_recon_loss: 86976.3794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165399.1835; train_optim_loss: 165399.1835; val_kl_reg_loss: 1918.1911; val_edge_recon_loss: 75852.3828; val_gene_expr_recon_loss: 87844.1281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165614.6969; val_optim_loss: 165614.6969
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9925; val_auprc_score: 0.9980; val_best_acc_score: 0.9837; val_best_f1_score: 0.9905; train_kl_reg_loss: 1932.2992; train_edge_recon_loss: 76460.1655; train_gene_expr_recon_loss: 86680.0575; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165072.5224; train_optim_loss: 165072.5224; val_kl_reg_loss: 1939.2392; val_edge_recon_loss: 75457.8438; val_gene_expr_recon_loss: 87532.5766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164929.6562; val_optim_loss: 164929.6562
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9935; val_auprc_score: 0.9986; val_best_acc_score: 0.9843; val_best_f1_score: 0.9909; train_kl_reg_loss: 1927.1963; train_edge_recon_loss: 76026.2214; train_gene_expr_recon_loss: 86550.0940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164503.5124; train_optim_loss: 164503.5124; val_kl_reg_loss: 1893.6848; val_edge_recon_loss: 75241.9859; val_gene_expr_recon_loss: 87090.3234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164225.9937; val_optim_loss: 164225.9937
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9928; val_auprc_score: 0.9977; val_best_acc_score: 0.9850; val_best_f1_score: 0.9912; train_kl_reg_loss: 1929.3154; train_edge_recon_loss: 76181.4131; train_gene_expr_recon_loss: 86356.8105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164467.5405; train_optim_loss: 164467.5405; val_kl_reg_loss: 1907.8499; val_edge_recon_loss: 76271.5312; val_gene_expr_recon_loss: 87345.8891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165525.2750; val_optim_loss: 165525.2750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9940; val_auprc_score: 0.9985; val_best_acc_score: 0.9860; val_best_f1_score: 0.9918; train_kl_reg_loss: 1934.0810; train_edge_recon_loss: 75898.4417; train_gene_expr_recon_loss: 86126.5859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163959.1082; train_optim_loss: 163959.1082; val_kl_reg_loss: 1916.5496; val_edge_recon_loss: 75074.5141; val_gene_expr_recon_loss: 86989.9797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163981.0406; val_optim_loss: 163981.0406
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9943; val_auprc_score: 0.9987; val_best_acc_score: 0.9855; val_best_f1_score: 0.9916; train_kl_reg_loss: 1935.2223; train_edge_recon_loss: 76302.2927; train_gene_expr_recon_loss: 85930.6026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164168.1178; train_optim_loss: 164168.1178; val_kl_reg_loss: 1939.8426; val_edge_recon_loss: 76091.2469; val_gene_expr_recon_loss: 86758.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164789.5656; val_optim_loss: 164789.5656
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9940; val_auprc_score: 0.9986; val_best_acc_score: 0.9864; val_best_f1_score: 0.9921; train_kl_reg_loss: 1936.0272; train_edge_recon_loss: 76672.9844; train_gene_expr_recon_loss: 85761.1701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164370.1807; train_optim_loss: 164370.1807; val_kl_reg_loss: 1925.9540; val_edge_recon_loss: 76115.1391; val_gene_expr_recon_loss: 86533.2859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164574.3750; val_optim_loss: 164574.3750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9947; val_auprc_score: 0.9988; val_best_acc_score: 0.9862; val_best_f1_score: 0.9919; train_kl_reg_loss: 1938.9682; train_edge_recon_loss: 76381.9149; train_gene_expr_recon_loss: 85674.9599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163995.8438; train_optim_loss: 163995.8438; val_kl_reg_loss: 1945.3663; val_edge_recon_loss: 76962.4297; val_gene_expr_recon_loss: 86197.9656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165105.7594; val_optim_loss: 165105.7594

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9934; val_auprc_score: 0.9982; val_best_acc_score: 0.9857; val_best_f1_score: 0.9917; train_kl_reg_loss: 1937.7837; train_edge_recon_loss: 75918.1204; train_gene_expr_recon_loss: 85490.7248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163346.6298; train_optim_loss: 163346.6298; val_kl_reg_loss: 1919.4925; val_edge_recon_loss: 74959.1609; val_gene_expr_recon_loss: 86362.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163241.4031; val_optim_loss: 163241.4031
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9938; val_auprc_score: 0.9982; val_best_acc_score: 0.9857; val_best_f1_score: 0.9917; train_kl_reg_loss: 1930.5079; train_edge_recon_loss: 75531.3011; train_gene_expr_recon_loss: 85379.3011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162841.1106; train_optim_loss: 162841.1106; val_kl_reg_loss: 1913.8799; val_edge_recon_loss: 75568.6922; val_gene_expr_recon_loss: 86176.8453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163659.4156; val_optim_loss: 163659.4156
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9947; val_auprc_score: 0.9985; val_best_acc_score: 0.9865; val_best_f1_score: 0.9921; train_kl_reg_loss: 1934.0977; train_edge_recon_loss: 75936.8169; train_gene_expr_recon_loss: 85356.3912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163227.3061; train_optim_loss: 163227.3061; val_kl_reg_loss: 1920.7978; val_edge_recon_loss: 75738.0547; val_gene_expr_recon_loss: 86409.3141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164068.1656; val_optim_loss: 164068.1656
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9944; val_auprc_score: 0.9985; val_best_acc_score: 0.9865; val_best_f1_score: 0.9921; train_kl_reg_loss: 1931.9375; train_edge_recon_loss: 76187.5040; train_gene_expr_recon_loss: 85357.0403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163476.4820; train_optim_loss: 163476.4820; val_kl_reg_loss: 1922.1550; val_edge_recon_loss: 76432.1906; val_gene_expr_recon_loss: 86177.9438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164532.2875; val_optim_loss: 164532.2875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9943; val_auprc_score: 0.9985; val_best_acc_score: 0.9860; val_best_f1_score: 0.9918; train_kl_reg_loss: 1941.4303; train_edge_recon_loss: 76076.2320; train_gene_expr_recon_loss: 85291.0264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163308.6887; train_optim_loss: 163308.6887; val_kl_reg_loss: 1916.5673; val_edge_recon_loss: 76320.7781; val_gene_expr_recon_loss: 86465.1594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164702.5031; val_optim_loss: 164702.5031
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9930; val_auprc_score: 0.9977; val_best_acc_score: 0.9854; val_best_f1_score: 0.9915; train_kl_reg_loss: 1934.7357; train_edge_recon_loss: 76419.4461; train_gene_expr_recon_loss: 85368.5248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163722.7063; train_optim_loss: 163722.7063; val_kl_reg_loss: 1911.2078; val_edge_recon_loss: 75917.2125; val_gene_expr_recon_loss: 86318.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164146.7938; val_optim_loss: 164146.7938
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9945; val_auprc_score: 0.9985; val_best_acc_score: 0.9858; val_best_f1_score: 0.9917; train_kl_reg_loss: 1931.9172; train_edge_recon_loss: 75552.8067; train_gene_expr_recon_loss: 85334.4525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162819.1743; train_optim_loss: 162819.1743; val_kl_reg_loss: 1911.3206; val_edge_recon_loss: 77504.7781; val_gene_expr_recon_loss: 86343.8797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165759.9750; val_optim_loss: 165759.9750

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 7 min 46 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
Val AUROC score: 0.9942
Val AUPRC score: 0.9986
Val best accuracy score: 0.9860
Val best F1 score: 0.9918
Val gene expr MSE score: 0.9193
Duration of model training in run 6: 0 hours, 7 minutes and 52 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 424361
Number of validation edges: 47151
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9458; val_auprc_score: 0.9886; val_best_acc_score: 0.9312; val_best_f1_score: 0.9606; train_kl_reg_loss: 1384.6626; train_edge_recon_loss: 90749.0667; train_gene_expr_recon_loss: 101328.2129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193461.9411; train_optim_loss: 193461.9411; val_kl_reg_loss: 2204.8962; val_edge_recon_loss: 79220.4570; val_gene_expr_recon_loss: 94818.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176243.6250; val_optim_loss: 176243.6250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9821; val_auprc_score: 0.9957; val_best_acc_score: 0.9683; val_best_f1_score: 0.9815; train_kl_reg_loss: 2093.5010; train_edge_recon_loss: 78513.9543; train_gene_expr_recon_loss: 94083.7314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174691.1872; train_optim_loss: 174691.1872; val_kl_reg_loss: 2066.6776; val_edge_recon_loss: 77797.1146; val_gene_expr_recon_loss: 92214.2057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172077.9974; val_optim_loss: 172077.9974
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9858; val_auprc_score: 0.9964; val_best_acc_score: 0.9730; val_best_f1_score: 0.9843; train_kl_reg_loss: 2024.1156; train_edge_recon_loss: 77087.1292; train_gene_expr_recon_loss: 91995.8263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171107.0709; train_optim_loss: 171107.0709; val_kl_reg_loss: 1991.7112; val_edge_recon_loss: 76365.0052; val_gene_expr_recon_loss: 91121.4492; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169478.1693; val_optim_loss: 169478.1693
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9887; val_auprc_score: 0.9973; val_best_acc_score: 0.9764; val_best_f1_score: 0.9863; train_kl_reg_loss: 1981.3351; train_edge_recon_loss: 76688.8287; train_gene_expr_recon_loss: 90752.7467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169422.9111; train_optim_loss: 169422.9111; val_kl_reg_loss: 1956.8247; val_edge_recon_loss: 75969.2083; val_gene_expr_recon_loss: 90239.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168165.6589; val_optim_loss: 168165.6589
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9901; val_auprc_score: 0.9976; val_best_acc_score: 0.9792; val_best_f1_score: 0.9879; train_kl_reg_loss: 1949.3111; train_edge_recon_loss: 76554.8887; train_gene_expr_recon_loss: 89897.1070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168401.3080; train_optim_loss: 168401.3080; val_kl_reg_loss: 1906.5469; val_edge_recon_loss: 76271.5221; val_gene_expr_recon_loss: 89056.4076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167234.4792; val_optim_loss: 167234.4792
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9902; val_auprc_score: 0.9976; val_best_acc_score: 0.9798; val_best_f1_score: 0.9882; train_kl_reg_loss: 1935.9483; train_edge_recon_loss: 76770.4823; train_gene_expr_recon_loss: 89312.9671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168019.3966; train_optim_loss: 168019.3966; val_kl_reg_loss: 1923.9376; val_edge_recon_loss: 77031.7161; val_gene_expr_recon_loss: 88605.7044; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167561.3568; val_optim_loss: 167561.3568
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9908; val_auprc_score: 0.9979; val_best_acc_score: 0.9812; val_best_f1_score: 0.9891; train_kl_reg_loss: 1928.4556; train_edge_recon_loss: 76474.1167; train_gene_expr_recon_loss: 88656.4818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167059.0544; train_optim_loss: 167059.0544; val_kl_reg_loss: 1909.4668; val_edge_recon_loss: 76345.0339; val_gene_expr_recon_loss: 88726.0807; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166980.5807; val_optim_loss: 166980.5807
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9921; val_auprc_score: 0.9981; val_best_acc_score: 0.9820; val_best_f1_score: 0.9895; train_kl_reg_loss: 1922.4400; train_edge_recon_loss: 76504.2670; train_gene_expr_recon_loss: 88238.1202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166664.8254; train_optim_loss: 166664.8254; val_kl_reg_loss: 1943.9956; val_edge_recon_loss: 76576.8398; val_gene_expr_recon_loss: 87931.3763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166452.2135; val_optim_loss: 166452.2135
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9915; val_auprc_score: 0.9979; val_best_acc_score: 0.9826; val_best_f1_score: 0.9899; train_kl_reg_loss: 1924.1371; train_edge_recon_loss: 76383.9318; train_gene_expr_recon_loss: 87967.3573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166275.4252; train_optim_loss: 166275.4252; val_kl_reg_loss: 1880.5640; val_edge_recon_loss: 75791.3177; val_gene_expr_recon_loss: 86913.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164585.3646; val_optim_loss: 164585.3646
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9919; val_auprc_score: 0.9977; val_best_acc_score: 0.9834; val_best_f1_score: 0.9903; train_kl_reg_loss: 1911.0332; train_edge_recon_loss: 76087.2862; train_gene_expr_recon_loss: 87593.5376; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165591.8582; train_optim_loss: 165591.8582; val_kl_reg_loss: 1879.1409; val_edge_recon_loss: 76806.7214; val_gene_expr_recon_loss: 87307.2240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165993.0885; val_optim_loss: 165993.0885
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9938; val_auprc_score: 0.9986; val_best_acc_score: 0.9849; val_best_f1_score: 0.9912; train_kl_reg_loss: 1918.2841; train_edge_recon_loss: 76149.2791; train_gene_expr_recon_loss: 87424.9150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165492.4778; train_optim_loss: 165492.4778; val_kl_reg_loss: 1967.3099; val_edge_recon_loss: 74729.2018; val_gene_expr_recon_loss: 86999.9336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163696.4427; val_optim_loss: 163696.4427
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9925; val_auprc_score: 0.9978; val_best_acc_score: 0.9851; val_best_f1_score: 0.9913; train_kl_reg_loss: 1916.2980; train_edge_recon_loss: 76218.3906; train_gene_expr_recon_loss: 86994.0314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165128.7200; train_optim_loss: 165128.7200; val_kl_reg_loss: 1900.2607; val_edge_recon_loss: 76482.8112; val_gene_expr_recon_loss: 86694.6315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165077.7031; val_optim_loss: 165077.7031
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9933; val_auprc_score: 0.9982; val_best_acc_score: 0.9850; val_best_f1_score: 0.9913; train_kl_reg_loss: 1919.8153; train_edge_recon_loss: 76031.8373; train_gene_expr_recon_loss: 86733.7111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164685.3639; train_optim_loss: 164685.3639; val_kl_reg_loss: 1904.3613; val_edge_recon_loss: 76170.3464; val_gene_expr_recon_loss: 86023.6198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164098.3255; val_optim_loss: 164098.3255
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9932; val_auprc_score: 0.9985; val_best_acc_score: 0.9851; val_best_f1_score: 0.9913; train_kl_reg_loss: 1920.0494; train_edge_recon_loss: 76039.7979; train_gene_expr_recon_loss: 86609.7749; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164569.6229; train_optim_loss: 164569.6229; val_kl_reg_loss: 1911.2501; val_edge_recon_loss: 75969.6536; val_gene_expr_recon_loss: 85945.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163826.3828; val_optim_loss: 163826.3828

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9936; val_auprc_score: 0.9983; val_best_acc_score: 0.9856; val_best_f1_score: 0.9916; train_kl_reg_loss: 1920.9500; train_edge_recon_loss: 75739.3752; train_gene_expr_recon_loss: 86249.7930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163910.1181; train_optim_loss: 163910.1181; val_kl_reg_loss: 1902.4071; val_edge_recon_loss: 76703.9948; val_gene_expr_recon_loss: 85683.3451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164289.7474; val_optim_loss: 164289.7474
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9937; val_auprc_score: 0.9982; val_best_acc_score: 0.9852; val_best_f1_score: 0.9914; train_kl_reg_loss: 1917.1797; train_edge_recon_loss: 76246.2006; train_gene_expr_recon_loss: 86240.6242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164404.0051; train_optim_loss: 164404.0051; val_kl_reg_loss: 1898.4822; val_edge_recon_loss: 75977.4909; val_gene_expr_recon_loss: 85652.7878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163528.7630; val_optim_loss: 163528.7630
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9940; val_auprc_score: 0.9985; val_best_acc_score: 0.9852; val_best_f1_score: 0.9914; train_kl_reg_loss: 1914.5865; train_edge_recon_loss: 75889.4327; train_gene_expr_recon_loss: 86146.1729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163950.1920; train_optim_loss: 163950.1920; val_kl_reg_loss: 1899.4240; val_edge_recon_loss: 76564.3672; val_gene_expr_recon_loss: 85156.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163620.0417; val_optim_loss: 163620.0417
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9940; val_auprc_score: 0.9983; val_best_acc_score: 0.9861; val_best_f1_score: 0.9919; train_kl_reg_loss: 1915.3054; train_edge_recon_loss: 76412.4099; train_gene_expr_recon_loss: 86100.7924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164428.5072; train_optim_loss: 164428.5072; val_kl_reg_loss: 1906.5174; val_edge_recon_loss: 75267.9831; val_gene_expr_recon_loss: 86019.9792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163194.4766; val_optim_loss: 163194.4766
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9934; val_auprc_score: 0.9981; val_best_acc_score: 0.9855; val_best_f1_score: 0.9915; train_kl_reg_loss: 1918.8009; train_edge_recon_loss: 75839.9213; train_gene_expr_recon_loss: 86123.2417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163881.9654; train_optim_loss: 163881.9654; val_kl_reg_loss: 1902.8206; val_edge_recon_loss: 76522.5729; val_gene_expr_recon_loss: 85144.1315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163569.5260; val_optim_loss: 163569.5260
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9935; val_auprc_score: 0.9982; val_best_acc_score: 0.9854; val_best_f1_score: 0.9915; train_kl_reg_loss: 1917.6251; train_edge_recon_loss: 75906.4796; train_gene_expr_recon_loss: 86125.2141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163949.3203; train_optim_loss: 163949.3203; val_kl_reg_loss: 1902.5257; val_edge_recon_loss: 76544.6797; val_gene_expr_recon_loss: 85642.7526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164089.9583; val_optim_loss: 164089.9583
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9943; val_auprc_score: 0.9987; val_best_acc_score: 0.9864; val_best_f1_score: 0.9920; train_kl_reg_loss: 1917.0236; train_edge_recon_loss: 76101.3380; train_gene_expr_recon_loss: 86063.5107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164081.8720; train_optim_loss: 164081.8720; val_kl_reg_loss: 1904.9156; val_edge_recon_loss: 76140.6367; val_gene_expr_recon_loss: 85200.2552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163245.8073; val_optim_loss: 163245.8073

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9938; val_auprc_score: 0.9985; val_best_acc_score: 0.9861; val_best_f1_score: 0.9919; train_kl_reg_loss: 1915.6129; train_edge_recon_loss: 76141.6148; train_gene_expr_recon_loss: 86020.2939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164077.5204; train_optim_loss: 164077.5204; val_kl_reg_loss: 1900.6238; val_edge_recon_loss: 75660.5938; val_gene_expr_recon_loss: 85860.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163421.4948; val_optim_loss: 163421.4948
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9932; val_auprc_score: 0.9982; val_best_acc_score: 0.9853; val_best_f1_score: 0.9914; train_kl_reg_loss: 1917.2224; train_edge_recon_loss: 75955.3302; train_gene_expr_recon_loss: 85958.7480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163831.3008; train_optim_loss: 163831.3008; val_kl_reg_loss: 1902.4451; val_edge_recon_loss: 75777.3503; val_gene_expr_recon_loss: 84931.6315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162611.4271; val_optim_loss: 162611.4271
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9935; val_auprc_score: 0.9981; val_best_acc_score: 0.9859; val_best_f1_score: 0.9917; train_kl_reg_loss: 1918.4981; train_edge_recon_loss: 76447.5627; train_gene_expr_recon_loss: 86028.4420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164394.5018; train_optim_loss: 164394.5018; val_kl_reg_loss: 1904.5361; val_edge_recon_loss: 76918.1250; val_gene_expr_recon_loss: 85528.4596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164351.1250; val_optim_loss: 164351.1250
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9935; val_auprc_score: 0.9983; val_best_acc_score: 0.9855; val_best_f1_score: 0.9915; train_kl_reg_loss: 1916.4442; train_edge_recon_loss: 75908.5717; train_gene_expr_recon_loss: 86154.5799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163979.5959; train_optim_loss: 163979.5959; val_kl_reg_loss: 1902.2826; val_edge_recon_loss: 76550.6589; val_gene_expr_recon_loss: 85533.8867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163986.8307; val_optim_loss: 163986.8307
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9940; val_auprc_score: 0.9985; val_best_acc_score: 0.9860; val_best_f1_score: 0.9919; train_kl_reg_loss: 1916.1671; train_edge_recon_loss: 76100.4785; train_gene_expr_recon_loss: 86011.9836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164028.6283; train_optim_loss: 164028.6283; val_kl_reg_loss: 1897.7402; val_edge_recon_loss: 74497.6536; val_gene_expr_recon_loss: 85555.9714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161951.3672; val_optim_loss: 161951.3672
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9943; val_auprc_score: 0.9986; val_best_acc_score: 0.9859; val_best_f1_score: 0.9918; train_kl_reg_loss: 1914.3044; train_edge_recon_loss: 75794.8621; train_gene_expr_recon_loss: 85926.9205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163636.0865; train_optim_loss: 163636.0865; val_kl_reg_loss: 1899.6368; val_edge_recon_loss: 75394.2096; val_gene_expr_recon_loss: 85537.6042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162831.4479; val_optim_loss: 162831.4479
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9942; val_auprc_score: 0.9986; val_best_acc_score: 0.9863; val_best_f1_score: 0.9920; train_kl_reg_loss: 1915.9770; train_edge_recon_loss: 76359.1379; train_gene_expr_recon_loss: 86029.9764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164305.0916; train_optim_loss: 164305.0916; val_kl_reg_loss: 1904.4567; val_edge_recon_loss: 75269.3359; val_gene_expr_recon_loss: 86241.1706; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163414.9635; val_optim_loss: 163414.9635
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9944; val_auprc_score: 0.9985; val_best_acc_score: 0.9857; val_best_f1_score: 0.9917; train_kl_reg_loss: 1918.0892; train_edge_recon_loss: 76275.7261; train_gene_expr_recon_loss: 86054.0864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164247.9002; train_optim_loss: 164247.9002; val_kl_reg_loss: 1902.8399; val_edge_recon_loss: 76033.9609; val_gene_expr_recon_loss: 84696.3255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162633.1276; val_optim_loss: 162633.1276

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9928; val_auprc_score: 0.9982; val_best_acc_score: 0.9852; val_best_f1_score: 0.9914; train_kl_reg_loss: 1916.8904; train_edge_recon_loss: 75896.2151; train_gene_expr_recon_loss: 85987.2578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163800.3624; train_optim_loss: 163800.3624; val_kl_reg_loss: 1904.3033; val_edge_recon_loss: 75843.6484; val_gene_expr_recon_loss: 85283.2448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163031.1953; val_optim_loss: 163031.1953
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9941; val_auprc_score: 0.9987; val_best_acc_score: 0.9864; val_best_f1_score: 0.9921; train_kl_reg_loss: 1916.7734; train_edge_recon_loss: 76031.0011; train_gene_expr_recon_loss: 85990.9043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163938.6794; train_optim_loss: 163938.6794; val_kl_reg_loss: 1901.3687; val_edge_recon_loss: 75201.7669; val_gene_expr_recon_loss: 85543.5898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162646.7240; val_optim_loss: 162646.7240
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9938; val_auprc_score: 0.9984; val_best_acc_score: 0.9858; val_best_f1_score: 0.9917; train_kl_reg_loss: 1917.1254; train_edge_recon_loss: 76253.2266; train_gene_expr_recon_loss: 86035.2156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164205.5670; train_optim_loss: 164205.5670; val_kl_reg_loss: 1902.7389; val_edge_recon_loss: 75956.1940; val_gene_expr_recon_loss: 85106.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162965.4010; val_optim_loss: 162965.4010

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 12 min 56 sec.
Using best model state, which was in epoch 26.

--- MODEL EVALUATION ---
Val AUROC score: 0.9934
Val AUPRC score: 0.9982
Val best accuracy score: 0.9857
Val best F1 score: 0.9917
Val gene expr MSE score: 0.8962
Duration of model training in run 7: 0 hours, 13 minutes and 3 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 424361
Number of validation edges: 47151
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9498; val_auprc_score: 0.9889; val_best_acc_score: 0.9332; val_best_f1_score: 0.9617; train_kl_reg_loss: 1357.2842; train_edge_recon_loss: 90362.7554; train_gene_expr_recon_loss: 100333.5825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192053.6223; train_optim_loss: 192053.6223; val_kl_reg_loss: 2137.4759; val_edge_recon_loss: 81310.3438; val_gene_expr_recon_loss: 94570.7865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178018.6068; val_optim_loss: 178018.6068
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9848; val_auprc_score: 0.9965; val_best_acc_score: 0.9705; val_best_f1_score: 0.9829; train_kl_reg_loss: 2074.5293; train_edge_recon_loss: 78624.9261; train_gene_expr_recon_loss: 93221.2835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173920.7392; train_optim_loss: 173920.7392; val_kl_reg_loss: 1970.3706; val_edge_recon_loss: 76200.7513; val_gene_expr_recon_loss: 92341.8385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170512.9635; val_optim_loss: 170512.9635
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9869; val_auprc_score: 0.9968; val_best_acc_score: 0.9759; val_best_f1_score: 0.9860; train_kl_reg_loss: 2003.3970; train_edge_recon_loss: 77104.8983; train_gene_expr_recon_loss: 91345.4751; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170453.7701; train_optim_loss: 170453.7701; val_kl_reg_loss: 2000.7418; val_edge_recon_loss: 76337.0260; val_gene_expr_recon_loss: 91258.6849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169596.4531; val_optim_loss: 169596.4531
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9889; val_auprc_score: 0.9976; val_best_acc_score: 0.9781; val_best_f1_score: 0.9873; train_kl_reg_loss: 1978.4160; train_edge_recon_loss: 77228.1997; train_gene_expr_recon_loss: 90286.5131; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169493.1286; train_optim_loss: 169493.1286; val_kl_reg_loss: 1930.4933; val_edge_recon_loss: 76144.5924; val_gene_expr_recon_loss: 90665.4232; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168740.5078; val_optim_loss: 168740.5078
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9899; val_auprc_score: 0.9976; val_best_acc_score: 0.9802; val_best_f1_score: 0.9885; train_kl_reg_loss: 1945.6076; train_edge_recon_loss: 76708.5688; train_gene_expr_recon_loss: 89472.5397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168126.7163; train_optim_loss: 168126.7163; val_kl_reg_loss: 1899.5880; val_edge_recon_loss: 76274.8633; val_gene_expr_recon_loss: 89552.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167727.2109; val_optim_loss: 167727.2109
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9916; val_auprc_score: 0.9978; val_best_acc_score: 0.9821; val_best_f1_score: 0.9895; train_kl_reg_loss: 1927.7001; train_edge_recon_loss: 76560.2975; train_gene_expr_recon_loss: 88796.9049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167284.9014; train_optim_loss: 167284.9014; val_kl_reg_loss: 1878.3197; val_edge_recon_loss: 76768.1732; val_gene_expr_recon_loss: 88359.7122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167006.2083; val_optim_loss: 167006.2083
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9917; val_auprc_score: 0.9980; val_best_acc_score: 0.9832; val_best_f1_score: 0.9902; train_kl_reg_loss: 1920.2585; train_edge_recon_loss: 76606.7610; train_gene_expr_recon_loss: 88146.7897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166673.8089; train_optim_loss: 166673.8089; val_kl_reg_loss: 1917.0013; val_edge_recon_loss: 76242.3581; val_gene_expr_recon_loss: 88139.8060; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166299.1667; val_optim_loss: 166299.1667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9930; val_auprc_score: 0.9982; val_best_acc_score: 0.9844; val_best_f1_score: 0.9909; train_kl_reg_loss: 1919.7352; train_edge_recon_loss: 76667.9725; train_gene_expr_recon_loss: 87735.6442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166323.3528; train_optim_loss: 166323.3528; val_kl_reg_loss: 1908.7709; val_edge_recon_loss: 75769.2135; val_gene_expr_recon_loss: 88237.6732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165915.6589; val_optim_loss: 165915.6589
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9927; val_auprc_score: 0.9977; val_best_acc_score: 0.9842; val_best_f1_score: 0.9908; train_kl_reg_loss: 1916.3525; train_edge_recon_loss: 76197.2013; train_gene_expr_recon_loss: 87448.3909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165561.9447; train_optim_loss: 165561.9447; val_kl_reg_loss: 1903.5254; val_edge_recon_loss: 75896.4688; val_gene_expr_recon_loss: 87279.5534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165079.5443; val_optim_loss: 165079.5443
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9934; val_auprc_score: 0.9984; val_best_acc_score: 0.9847; val_best_f1_score: 0.9911; train_kl_reg_loss: 1917.0758; train_edge_recon_loss: 76276.1433; train_gene_expr_recon_loss: 87119.1378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165312.3570; train_optim_loss: 165312.3570; val_kl_reg_loss: 1900.3050; val_edge_recon_loss: 76207.6927; val_gene_expr_recon_loss: 87409.5273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165517.5208; val_optim_loss: 165517.5208
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9935; val_auprc_score: 0.9979; val_best_acc_score: 0.9867; val_best_f1_score: 0.9922; train_kl_reg_loss: 1921.7588; train_edge_recon_loss: 76265.0341; train_gene_expr_recon_loss: 86788.7447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164975.5379; train_optim_loss: 164975.5379; val_kl_reg_loss: 1901.9975; val_edge_recon_loss: 74837.9870; val_gene_expr_recon_loss: 86693.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163433.7526; val_optim_loss: 163433.7526
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9931; val_auprc_score: 0.9982; val_best_acc_score: 0.9855; val_best_f1_score: 0.9915; train_kl_reg_loss: 1922.9121; train_edge_recon_loss: 76284.5135; train_gene_expr_recon_loss: 86453.0246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164660.4498; train_optim_loss: 164660.4498; val_kl_reg_loss: 1861.0788; val_edge_recon_loss: 75915.5599; val_gene_expr_recon_loss: 86559.8385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164336.4766; val_optim_loss: 164336.4766
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9936; val_auprc_score: 0.9981; val_best_acc_score: 0.9854; val_best_f1_score: 0.9915; train_kl_reg_loss: 1921.9081; train_edge_recon_loss: 76513.4914; train_gene_expr_recon_loss: 86299.2874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164734.6869; train_optim_loss: 164734.6869; val_kl_reg_loss: 1880.8205; val_edge_recon_loss: 77012.2852; val_gene_expr_recon_loss: 86439.0247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165332.1276; val_optim_loss: 165332.1276
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9932; val_auprc_score: 0.9981; val_best_acc_score: 0.9865; val_best_f1_score: 0.9921; train_kl_reg_loss: 1919.1715; train_edge_recon_loss: 76048.7195; train_gene_expr_recon_loss: 86056.3694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164024.2611; train_optim_loss: 164024.2611; val_kl_reg_loss: 1921.4705; val_edge_recon_loss: 75931.8177; val_gene_expr_recon_loss: 86078.2904; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163931.5755; val_optim_loss: 163931.5755

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9946; val_auprc_score: 0.9989; val_best_acc_score: 0.9872; val_best_f1_score: 0.9925; train_kl_reg_loss: 1921.5984; train_edge_recon_loss: 75809.2216; train_gene_expr_recon_loss: 85891.2562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163622.0754; train_optim_loss: 163622.0754; val_kl_reg_loss: 1894.2136; val_edge_recon_loss: 75259.3333; val_gene_expr_recon_loss: 86605.3398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163758.8880; val_optim_loss: 163758.8880
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9937; val_auprc_score: 0.9984; val_best_acc_score: 0.9865; val_best_f1_score: 0.9921; train_kl_reg_loss: 1917.7224; train_edge_recon_loss: 75990.1905; train_gene_expr_recon_loss: 85714.8305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163622.7425; train_optim_loss: 163622.7425; val_kl_reg_loss: 1893.9765; val_edge_recon_loss: 75929.2305; val_gene_expr_recon_loss: 86487.1862; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164310.3932; val_optim_loss: 164310.3932
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9932; val_auprc_score: 0.9983; val_best_acc_score: 0.9865; val_best_f1_score: 0.9921; train_kl_reg_loss: 1916.3517; train_edge_recon_loss: 75996.6029; train_gene_expr_recon_loss: 85688.3523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163601.3071; train_optim_loss: 163601.3071; val_kl_reg_loss: 1900.9378; val_edge_recon_loss: 76516.9505; val_gene_expr_recon_loss: 86261.8151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164679.7031; val_optim_loss: 164679.7031

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 29 sec.
Using best model state, which was in epoch 11.

--- MODEL EVALUATION ---
Val AUROC score: 0.9936
Val AUPRC score: 0.9987
Val best accuracy score: 0.9854
Val best F1 score: 0.9915
Val gene expr MSE score: 0.9494
Duration of model training in run 8: 0 hours, 6 minutes and 37 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 529546
Number of validation edges: 58838
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9704; val_auprc_score: 0.9940; val_best_acc_score: 0.9520; val_best_f1_score: 0.9723; train_kl_reg_loss: 1549.2464; train_edge_recon_loss: 88258.8519; train_gene_expr_recon_loss: 99044.7913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188852.8899; train_optim_loss: 188852.8899; val_kl_reg_loss: 2122.0914; val_edge_recon_loss: 77168.7559; val_gene_expr_recon_loss: 95084.2197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174375.0684; val_optim_loss: 174375.0684
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9854; val_auprc_score: 0.9963; val_best_acc_score: 0.9721; val_best_f1_score: 0.9838; train_kl_reg_loss: 2036.5888; train_edge_recon_loss: 77699.3246; train_gene_expr_recon_loss: 92330.9706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172066.8827; train_optim_loss: 172066.8827; val_kl_reg_loss: 1988.5685; val_edge_recon_loss: 75827.5977; val_gene_expr_recon_loss: 91895.5771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169711.7461; val_optim_loss: 169711.7461
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9884; val_auprc_score: 0.9972; val_best_acc_score: 0.9761; val_best_f1_score: 0.9861; train_kl_reg_loss: 1991.1368; train_edge_recon_loss: 76998.5608; train_gene_expr_recon_loss: 90411.6627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169401.3608; train_optim_loss: 169401.3608; val_kl_reg_loss: 1928.2136; val_edge_recon_loss: 75941.3340; val_gene_expr_recon_loss: 90849.7100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168719.2598; val_optim_loss: 168719.2598
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9897; val_auprc_score: 0.9972; val_best_acc_score: 0.9785; val_best_f1_score: 0.9875; train_kl_reg_loss: 1948.1867; train_edge_recon_loss: 77152.9147; train_gene_expr_recon_loss: 89245.3209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168346.4231; train_optim_loss: 168346.4231; val_kl_reg_loss: 1927.3811; val_edge_recon_loss: 77159.6074; val_gene_expr_recon_loss: 88745.6865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167832.6719; val_optim_loss: 167832.6719
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9902; val_auprc_score: 0.9975; val_best_acc_score: 0.9812; val_best_f1_score: 0.9890; train_kl_reg_loss: 1928.1824; train_edge_recon_loss: 76385.7829; train_gene_expr_recon_loss: 88528.4358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166842.4017; train_optim_loss: 166842.4017; val_kl_reg_loss: 1886.4984; val_edge_recon_loss: 76588.8809; val_gene_expr_recon_loss: 89269.7568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167745.1367; val_optim_loss: 167745.1367
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9910; val_auprc_score: 0.9975; val_best_acc_score: 0.9821; val_best_f1_score: 0.9895; train_kl_reg_loss: 1916.6618; train_edge_recon_loss: 76427.7642; train_gene_expr_recon_loss: 87909.8703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166254.2978; train_optim_loss: 166254.2978; val_kl_reg_loss: 1891.3198; val_edge_recon_loss: 76435.1377; val_gene_expr_recon_loss: 87970.7930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166297.2480; val_optim_loss: 166297.2480
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9916; val_auprc_score: 0.9979; val_best_acc_score: 0.9828; val_best_f1_score: 0.9899; train_kl_reg_loss: 1912.1772; train_edge_recon_loss: 76695.8379; train_gene_expr_recon_loss: 87398.5400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166006.5560; train_optim_loss: 166006.5560; val_kl_reg_loss: 1918.9405; val_edge_recon_loss: 76218.2021; val_gene_expr_recon_loss: 87534.4824; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165671.6270; val_optim_loss: 165671.6270
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9920; val_auprc_score: 0.9980; val_best_acc_score: 0.9828; val_best_f1_score: 0.9900; train_kl_reg_loss: 1913.6184; train_edge_recon_loss: 76608.1448; train_gene_expr_recon_loss: 87024.2844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165546.0476; train_optim_loss: 165546.0476; val_kl_reg_loss: 1896.7122; val_edge_recon_loss: 76115.4023; val_gene_expr_recon_loss: 87239.9541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165252.0645; val_optim_loss: 165252.0645
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9926; val_auprc_score: 0.9982; val_best_acc_score: 0.9845; val_best_f1_score: 0.9909; train_kl_reg_loss: 1910.5764; train_edge_recon_loss: 76127.0156; train_gene_expr_recon_loss: 86668.8520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164706.4442; train_optim_loss: 164706.4442; val_kl_reg_loss: 1870.3901; val_edge_recon_loss: 76656.2734; val_gene_expr_recon_loss: 86722.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165249.0527; val_optim_loss: 165249.0527
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9926; val_auprc_score: 0.9981; val_best_acc_score: 0.9854; val_best_f1_score: 0.9915; train_kl_reg_loss: 1917.1806; train_edge_recon_loss: 76417.1380; train_gene_expr_recon_loss: 86339.9998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164674.3195; train_optim_loss: 164674.3195; val_kl_reg_loss: 1918.0013; val_edge_recon_loss: 76291.9639; val_gene_expr_recon_loss: 86834.7998; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165044.7676; val_optim_loss: 165044.7676
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9939; val_auprc_score: 0.9983; val_best_acc_score: 0.9864; val_best_f1_score: 0.9920; train_kl_reg_loss: 1913.1236; train_edge_recon_loss: 76271.9054; train_gene_expr_recon_loss: 86021.0257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164206.0548; train_optim_loss: 164206.0548; val_kl_reg_loss: 1925.8992; val_edge_recon_loss: 75458.9111; val_gene_expr_recon_loss: 85982.7939; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163367.6074; val_optim_loss: 163367.6074
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9930; val_auprc_score: 0.9982; val_best_acc_score: 0.9853; val_best_f1_score: 0.9914; train_kl_reg_loss: 1919.5678; train_edge_recon_loss: 76233.5279; train_gene_expr_recon_loss: 85761.8409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163914.9368; train_optim_loss: 163914.9368; val_kl_reg_loss: 1939.8703; val_edge_recon_loss: 76017.5342; val_gene_expr_recon_loss: 85628.2451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163585.6484; val_optim_loss: 163585.6484
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9937; val_auprc_score: 0.9980; val_best_acc_score: 0.9863; val_best_f1_score: 0.9920; train_kl_reg_loss: 1919.8020; train_edge_recon_loss: 76041.6829; train_gene_expr_recon_loss: 85536.4486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163497.9332; train_optim_loss: 163497.9332; val_kl_reg_loss: 1889.1829; val_edge_recon_loss: 75880.7402; val_gene_expr_recon_loss: 85677.9189; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163447.8398; val_optim_loss: 163447.8398
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9933; val_auprc_score: 0.9981; val_best_acc_score: 0.9865; val_best_f1_score: 0.9921; train_kl_reg_loss: 1920.4180; train_edge_recon_loss: 75942.5011; train_gene_expr_recon_loss: 85296.2493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163159.1690; train_optim_loss: 163159.1690; val_kl_reg_loss: 1890.8797; val_edge_recon_loss: 75726.3994; val_gene_expr_recon_loss: 85318.4961; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162935.7754; val_optim_loss: 162935.7754
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9935; val_auprc_score: 0.9981; val_best_acc_score: 0.9867; val_best_f1_score: 0.9922; train_kl_reg_loss: 1921.1405; train_edge_recon_loss: 75972.0863; train_gene_expr_recon_loss: 85053.8986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162947.1255; train_optim_loss: 162947.1255; val_kl_reg_loss: 1915.7818; val_edge_recon_loss: 75782.4697; val_gene_expr_recon_loss: 85677.9014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163376.1504; val_optim_loss: 163376.1504
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9939; val_auprc_score: 0.9981; val_best_acc_score: 0.9873; val_best_f1_score: 0.9926; train_kl_reg_loss: 1925.2871; train_edge_recon_loss: 75942.1046; train_gene_expr_recon_loss: 84898.4356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162765.8269; train_optim_loss: 162765.8269; val_kl_reg_loss: 1925.6189; val_edge_recon_loss: 76661.5029; val_gene_expr_recon_loss: 84608.2070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163195.3301; val_optim_loss: 163195.3301
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9944; val_auprc_score: 0.9982; val_best_acc_score: 0.9869; val_best_f1_score: 0.9923; train_kl_reg_loss: 1931.3693; train_edge_recon_loss: 76265.2758; train_gene_expr_recon_loss: 84629.9727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162826.6195; train_optim_loss: 162826.6195; val_kl_reg_loss: 1910.6079; val_edge_recon_loss: 76306.6338; val_gene_expr_recon_loss: 84537.5645; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162754.8047; val_optim_loss: 162754.8047
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9942; val_auprc_score: 0.9983; val_best_acc_score: 0.9880; val_best_f1_score: 0.9930; train_kl_reg_loss: 1933.2526; train_edge_recon_loss: 76111.3076; train_gene_expr_recon_loss: 84441.4044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162485.9637; train_optim_loss: 162485.9637; val_kl_reg_loss: 1912.8474; val_edge_recon_loss: 75532.8428; val_gene_expr_recon_loss: 83768.0010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161213.6953; val_optim_loss: 161213.6953
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9951; val_auprc_score: 0.9987; val_best_acc_score: 0.9881; val_best_f1_score: 0.9931; train_kl_reg_loss: 1933.5963; train_edge_recon_loss: 76136.4925; train_gene_expr_recon_loss: 84279.5964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162349.6846; train_optim_loss: 162349.6846; val_kl_reg_loss: 1937.2086; val_edge_recon_loss: 75536.7510; val_gene_expr_recon_loss: 83859.3809; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161333.3398; val_optim_loss: 161333.3398
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9942; val_auprc_score: 0.9984; val_best_acc_score: 0.9873; val_best_f1_score: 0.9926; train_kl_reg_loss: 1937.8784; train_edge_recon_loss: 76017.7822; train_gene_expr_recon_loss: 84075.5647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162031.2264; train_optim_loss: 162031.2264; val_kl_reg_loss: 1913.1632; val_edge_recon_loss: 76278.1289; val_gene_expr_recon_loss: 83772.2852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161963.5762; val_optim_loss: 161963.5762
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9944; val_auprc_score: 0.9982; val_best_acc_score: 0.9883; val_best_f1_score: 0.9931; train_kl_reg_loss: 1941.1875; train_edge_recon_loss: 75905.6371; train_gene_expr_recon_loss: 83935.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161782.7007; train_optim_loss: 161782.7007; val_kl_reg_loss: 1927.6726; val_edge_recon_loss: 76571.1963; val_gene_expr_recon_loss: 83942.4668; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162441.3359; val_optim_loss: 162441.3359

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9947; val_auprc_score: 0.9985; val_best_acc_score: 0.9885; val_best_f1_score: 0.9933; train_kl_reg_loss: 1942.6380; train_edge_recon_loss: 76099.1118; train_gene_expr_recon_loss: 83680.1569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161721.9067; train_optim_loss: 161721.9067; val_kl_reg_loss: 1926.9661; val_edge_recon_loss: 75755.0400; val_gene_expr_recon_loss: 84780.0020; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162462.0059; val_optim_loss: 162462.0059
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9943; val_auprc_score: 0.9982; val_best_acc_score: 0.9879; val_best_f1_score: 0.9929; train_kl_reg_loss: 1943.1260; train_edge_recon_loss: 75936.9746; train_gene_expr_recon_loss: 83646.3585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161526.4587; train_optim_loss: 161526.4587; val_kl_reg_loss: 1927.4668; val_edge_recon_loss: 76480.0547; val_gene_expr_recon_loss: 84144.9326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162552.4531; val_optim_loss: 162552.4531
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9949; val_auprc_score: 0.9988; val_best_acc_score: 0.9883; val_best_f1_score: 0.9932; train_kl_reg_loss: 1942.3480; train_edge_recon_loss: 76226.4911; train_gene_expr_recon_loss: 83605.2025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161774.0411; train_optim_loss: 161774.0411; val_kl_reg_loss: 1926.1142; val_edge_recon_loss: 75423.9141; val_gene_expr_recon_loss: 84261.5361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161611.5645; val_optim_loss: 161611.5645

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 12 min 23 sec.
Using best model state, which was in epoch 18.

--- MODEL EVALUATION ---
Val AUROC score: 0.9942
Val AUPRC score: 0.9985
Val best accuracy score: 0.9878
Val best F1 score: 0.9929
Val gene expr MSE score: 0.9187
Duration of model training in run 9: 0 hours, 12 minutes and 33 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 529546
Number of validation edges: 58838
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9666; val_auprc_score: 0.9926; val_best_acc_score: 0.9509; val_best_f1_score: 0.9717; train_kl_reg_loss: 1473.2018; train_edge_recon_loss: 88588.9782; train_gene_expr_recon_loss: 98736.1361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188798.3178; train_optim_loss: 188798.3178; val_kl_reg_loss: 2092.4767; val_edge_recon_loss: 78378.6475; val_gene_expr_recon_loss: 93246.7061; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173717.8320; val_optim_loss: 173717.8320
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9856; val_auprc_score: 0.9966; val_best_acc_score: 0.9721; val_best_f1_score: 0.9838; train_kl_reg_loss: 2036.0744; train_edge_recon_loss: 78028.4409; train_gene_expr_recon_loss: 92274.2296; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172338.7450; train_optim_loss: 172338.7450; val_kl_reg_loss: 1971.0515; val_edge_recon_loss: 76218.6748; val_gene_expr_recon_loss: 91068.4473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169258.1719; val_optim_loss: 169258.1719
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9888; val_auprc_score: 0.9974; val_best_acc_score: 0.9761; val_best_f1_score: 0.9861; train_kl_reg_loss: 1985.5589; train_edge_recon_loss: 77219.8451; train_gene_expr_recon_loss: 90232.6119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169438.0159; train_optim_loss: 169438.0159; val_kl_reg_loss: 1966.9912; val_edge_recon_loss: 76792.6064; val_gene_expr_recon_loss: 88453.7803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167213.3809; val_optim_loss: 167213.3809
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9903; val_auprc_score: 0.9978; val_best_acc_score: 0.9803; val_best_f1_score: 0.9885; train_kl_reg_loss: 1939.6313; train_edge_recon_loss: 77041.8853; train_gene_expr_recon_loss: 89096.1422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168077.6591; train_optim_loss: 168077.6591; val_kl_reg_loss: 1925.7381; val_edge_recon_loss: 76187.3027; val_gene_expr_recon_loss: 88277.2754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166390.3125; val_optim_loss: 166390.3125
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9900; val_auprc_score: 0.9976; val_best_acc_score: 0.9807; val_best_f1_score: 0.9887; train_kl_reg_loss: 1921.8810; train_edge_recon_loss: 76519.3518; train_gene_expr_recon_loss: 88347.5760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166788.8087; train_optim_loss: 166788.8087; val_kl_reg_loss: 1910.4329; val_edge_recon_loss: 76960.8926; val_gene_expr_recon_loss: 86876.4014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165747.7266; val_optim_loss: 165747.7266
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9913; val_auprc_score: 0.9978; val_best_acc_score: 0.9814; val_best_f1_score: 0.9892; train_kl_reg_loss: 1914.9467; train_edge_recon_loss: 76349.2200; train_gene_expr_recon_loss: 87738.1829; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166002.3493; train_optim_loss: 166002.3493; val_kl_reg_loss: 1870.4455; val_edge_recon_loss: 76497.8047; val_gene_expr_recon_loss: 86579.2373; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164947.4883; val_optim_loss: 164947.4883
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9918; val_auprc_score: 0.9979; val_best_acc_score: 0.9825; val_best_f1_score: 0.9898; train_kl_reg_loss: 1910.7217; train_edge_recon_loss: 76219.2754; train_gene_expr_recon_loss: 87249.4502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165379.4469; train_optim_loss: 165379.4469; val_kl_reg_loss: 1911.1008; val_edge_recon_loss: 76191.8252; val_gene_expr_recon_loss: 86306.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164409.7793; val_optim_loss: 164409.7793
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9928; val_auprc_score: 0.9983; val_best_acc_score: 0.9842; val_best_f1_score: 0.9908; train_kl_reg_loss: 1910.0700; train_edge_recon_loss: 76438.7188; train_gene_expr_recon_loss: 86810.4514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165159.2399; train_optim_loss: 165159.2399; val_kl_reg_loss: 1900.5697; val_edge_recon_loss: 75719.1904; val_gene_expr_recon_loss: 85842.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163462.4043; val_optim_loss: 163462.4043
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9927; val_auprc_score: 0.9980; val_best_acc_score: 0.9849; val_best_f1_score: 0.9912; train_kl_reg_loss: 1909.0528; train_edge_recon_loss: 76040.1050; train_gene_expr_recon_loss: 86440.5554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164389.7130; train_optim_loss: 164389.7130; val_kl_reg_loss: 1891.4174; val_edge_recon_loss: 76266.9961; val_gene_expr_recon_loss: 85678.5635; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163836.9785; val_optim_loss: 163836.9785
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9926; val_auprc_score: 0.9979; val_best_acc_score: 0.9859; val_best_f1_score: 0.9918; train_kl_reg_loss: 1914.0958; train_edge_recon_loss: 76089.1650; train_gene_expr_recon_loss: 86131.9781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164135.2389; train_optim_loss: 164135.2389; val_kl_reg_loss: 1906.9315; val_edge_recon_loss: 75150.2266; val_gene_expr_recon_loss: 84575.0908; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161632.2480; val_optim_loss: 161632.2480
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9943; val_auprc_score: 0.9988; val_best_acc_score: 0.9856; val_best_f1_score: 0.9916; train_kl_reg_loss: 1912.7188; train_edge_recon_loss: 76237.5201; train_gene_expr_recon_loss: 85845.9410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163996.1803; train_optim_loss: 163996.1803; val_kl_reg_loss: 1903.3731; val_edge_recon_loss: 74845.7461; val_gene_expr_recon_loss: 84668.9863; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161418.1055; val_optim_loss: 161418.1055
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9936; val_auprc_score: 0.9984; val_best_acc_score: 0.9863; val_best_f1_score: 0.9920; train_kl_reg_loss: 1916.5088; train_edge_recon_loss: 76160.5035; train_gene_expr_recon_loss: 85534.9950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163612.0072; train_optim_loss: 163612.0072; val_kl_reg_loss: 1913.5367; val_edge_recon_loss: 75368.5293; val_gene_expr_recon_loss: 84929.0322; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162211.1016; val_optim_loss: 162211.1016
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9929; val_auprc_score: 0.9979; val_best_acc_score: 0.9867; val_best_f1_score: 0.9922; train_kl_reg_loss: 1919.1203; train_edge_recon_loss: 76189.9615; train_gene_expr_recon_loss: 85291.9566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163401.0394; train_optim_loss: 163401.0394; val_kl_reg_loss: 1922.6064; val_edge_recon_loss: 74823.3379; val_gene_expr_recon_loss: 85033.3262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161779.2695; val_optim_loss: 161779.2695
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9942; val_auprc_score: 0.9986; val_best_acc_score: 0.9873; val_best_f1_score: 0.9926; train_kl_reg_loss: 1921.7473; train_edge_recon_loss: 76281.3339; train_gene_expr_recon_loss: 85081.3309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163284.4113; train_optim_loss: 163284.4113; val_kl_reg_loss: 1889.9166; val_edge_recon_loss: 75307.7334; val_gene_expr_recon_loss: 84200.2012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161397.8516; val_optim_loss: 161397.8516
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9936; val_auprc_score: 0.9982; val_best_acc_score: 0.9867; val_best_f1_score: 0.9922; train_kl_reg_loss: 1924.2595; train_edge_recon_loss: 76259.7879; train_gene_expr_recon_loss: 84865.8054; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163049.8534; train_optim_loss: 163049.8534; val_kl_reg_loss: 1943.7907; val_edge_recon_loss: 75689.3320; val_gene_expr_recon_loss: 83936.6982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161569.8184; val_optim_loss: 161569.8184
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9942; val_auprc_score: 0.9983; val_best_acc_score: 0.9876; val_best_f1_score: 0.9928; train_kl_reg_loss: 1923.0686; train_edge_recon_loss: 76149.3367; train_gene_expr_recon_loss: 84659.0763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162731.4827; train_optim_loss: 162731.4827; val_kl_reg_loss: 1894.7113; val_edge_recon_loss: 75516.9219; val_gene_expr_recon_loss: 83289.2695; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160700.9023; val_optim_loss: 160700.9023
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9947; val_auprc_score: 0.9986; val_best_acc_score: 0.9875; val_best_f1_score: 0.9927; train_kl_reg_loss: 1926.6408; train_edge_recon_loss: 76236.3562; train_gene_expr_recon_loss: 84492.2809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162655.2774; train_optim_loss: 162655.2774; val_kl_reg_loss: 1880.8933; val_edge_recon_loss: 75060.0059; val_gene_expr_recon_loss: 83975.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160916.4941; val_optim_loss: 160916.4941
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9944; val_auprc_score: 0.9986; val_best_acc_score: 0.9876; val_best_f1_score: 0.9928; train_kl_reg_loss: 1930.0795; train_edge_recon_loss: 75953.1131; train_gene_expr_recon_loss: 84277.8022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162160.9950; train_optim_loss: 162160.9950; val_kl_reg_loss: 1905.9919; val_edge_recon_loss: 74883.0723; val_gene_expr_recon_loss: 83580.3340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160369.4004; val_optim_loss: 160369.4004
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9951; val_auprc_score: 0.9989; val_best_acc_score: 0.9879; val_best_f1_score: 0.9929; train_kl_reg_loss: 1932.9422; train_edge_recon_loss: 75949.1620; train_gene_expr_recon_loss: 84118.6697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162000.7745; train_optim_loss: 162000.7745; val_kl_reg_loss: 1921.2477; val_edge_recon_loss: 75891.4053; val_gene_expr_recon_loss: 82614.3145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160426.9688; val_optim_loss: 160426.9688
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9943; val_auprc_score: 0.9984; val_best_acc_score: 0.9882; val_best_f1_score: 0.9931; train_kl_reg_loss: 1935.2644; train_edge_recon_loss: 75720.1325; train_gene_expr_recon_loss: 83997.1849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161652.5825; train_optim_loss: 161652.5825; val_kl_reg_loss: 1937.7113; val_edge_recon_loss: 76109.7070; val_gene_expr_recon_loss: 83176.1826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161223.6035; val_optim_loss: 161223.6035
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9944; val_auprc_score: 0.9985; val_best_acc_score: 0.9887; val_best_f1_score: 0.9934; train_kl_reg_loss: 1940.5778; train_edge_recon_loss: 76140.2188; train_gene_expr_recon_loss: 83839.2689; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161920.0656; train_optim_loss: 161920.0656; val_kl_reg_loss: 1945.5807; val_edge_recon_loss: 74945.7393; val_gene_expr_recon_loss: 82497.4951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159388.8164; val_optim_loss: 159388.8164
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9950; val_auprc_score: 0.9988; val_best_acc_score: 0.9887; val_best_f1_score: 0.9934; train_kl_reg_loss: 1941.3641; train_edge_recon_loss: 75614.3924; train_gene_expr_recon_loss: 83677.5940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161233.3500; train_optim_loss: 161233.3500; val_kl_reg_loss: 1892.2957; val_edge_recon_loss: 75592.4648; val_gene_expr_recon_loss: 82795.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160280.6992; val_optim_loss: 160280.6992
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9947; val_auprc_score: 0.9981; val_best_acc_score: 0.9891; val_best_f1_score: 0.9936; train_kl_reg_loss: 1943.6173; train_edge_recon_loss: 75774.3221; train_gene_expr_recon_loss: 83567.5572; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161285.4959; train_optim_loss: 161285.4959; val_kl_reg_loss: 1901.3194; val_edge_recon_loss: 74013.7471; val_gene_expr_recon_loss: 83338.2754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159253.3418; val_optim_loss: 159253.3418
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9951; val_auprc_score: 0.9983; val_best_acc_score: 0.9891; val_best_f1_score: 0.9936; train_kl_reg_loss: 1941.8130; train_edge_recon_loss: 75961.8357; train_gene_expr_recon_loss: 83400.1761; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161303.8233; train_optim_loss: 161303.8233; val_kl_reg_loss: 1944.9106; val_edge_recon_loss: 75791.6592; val_gene_expr_recon_loss: 83352.9805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161089.5508; val_optim_loss: 161089.5508
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9955; val_auprc_score: 0.9986; val_best_acc_score: 0.9888; val_best_f1_score: 0.9935; train_kl_reg_loss: 1948.5897; train_edge_recon_loss: 76066.2738; train_gene_expr_recon_loss: 83318.9419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161333.8070; train_optim_loss: 161333.8070; val_kl_reg_loss: 1953.3434; val_edge_recon_loss: 76575.5957; val_gene_expr_recon_loss: 82033.4014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160562.3418; val_optim_loss: 160562.3418
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9952; val_auprc_score: 0.9985; val_best_acc_score: 0.9895; val_best_f1_score: 0.9939; train_kl_reg_loss: 1950.6169; train_edge_recon_loss: 75984.4969; train_gene_expr_recon_loss: 83215.3951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161150.5077; train_optim_loss: 161150.5077; val_kl_reg_loss: 1927.4791; val_edge_recon_loss: 75921.2207; val_gene_expr_recon_loss: 82824.8711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160673.5723; val_optim_loss: 160673.5723

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9949; val_auprc_score: 0.9984; val_best_acc_score: 0.9892; val_best_f1_score: 0.9937; train_kl_reg_loss: 1949.3053; train_edge_recon_loss: 75841.5243; train_gene_expr_recon_loss: 82966.8044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160757.6341; train_optim_loss: 160757.6341; val_kl_reg_loss: 1934.2340; val_edge_recon_loss: 75922.6836; val_gene_expr_recon_loss: 81090.3145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158947.2344; val_optim_loss: 158947.2344
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9950; val_auprc_score: 0.9988; val_best_acc_score: 0.9894; val_best_f1_score: 0.9938; train_kl_reg_loss: 1948.7894; train_edge_recon_loss: 75752.9780; train_gene_expr_recon_loss: 82929.1412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160630.9091; train_optim_loss: 160630.9091; val_kl_reg_loss: 1940.8005; val_edge_recon_loss: 75366.3516; val_gene_expr_recon_loss: 81412.9570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158720.1113; val_optim_loss: 158720.1113
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9949; val_auprc_score: 0.9986; val_best_acc_score: 0.9896; val_best_f1_score: 0.9939; train_kl_reg_loss: 1949.3330; train_edge_recon_loss: 75688.0334; train_gene_expr_recon_loss: 82919.6840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160557.0498; train_optim_loss: 160557.0498; val_kl_reg_loss: 1932.7048; val_edge_recon_loss: 74344.1221; val_gene_expr_recon_loss: 82865.4395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159142.2676; val_optim_loss: 159142.2676
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9955; val_auprc_score: 0.9986; val_best_acc_score: 0.9892; val_best_f1_score: 0.9937; train_kl_reg_loss: 1949.9584; train_edge_recon_loss: 76084.7405; train_gene_expr_recon_loss: 82896.1168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160930.8161; train_optim_loss: 160930.8161; val_kl_reg_loss: 1940.7916; val_edge_recon_loss: 75008.9189; val_gene_expr_recon_loss: 81578.1318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158527.8398; val_optim_loss: 158527.8398
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9955; val_auprc_score: 0.9987; val_best_acc_score: 0.9895; val_best_f1_score: 0.9939; train_kl_reg_loss: 1948.7922; train_edge_recon_loss: 75705.4107; train_gene_expr_recon_loss: 82913.7189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160567.9219; train_optim_loss: 160567.9219; val_kl_reg_loss: 1939.2670; val_edge_recon_loss: 74503.1309; val_gene_expr_recon_loss: 82245.7803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158688.1816; val_optim_loss: 158688.1816
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9947; val_auprc_score: 0.9984; val_best_acc_score: 0.9893; val_best_f1_score: 0.9937; train_kl_reg_loss: 1950.1864; train_edge_recon_loss: 75803.2746; train_gene_expr_recon_loss: 82862.1109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160615.5712; train_optim_loss: 160615.5712; val_kl_reg_loss: 1935.2739; val_edge_recon_loss: 76982.8389; val_gene_expr_recon_loss: 82006.5566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160924.6680; val_optim_loss: 160924.6680
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9953; val_auprc_score: 0.9985; val_best_acc_score: 0.9898; val_best_f1_score: 0.9941; train_kl_reg_loss: 1947.0613; train_edge_recon_loss: 75806.2260; train_gene_expr_recon_loss: 82860.4945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160613.7825; train_optim_loss: 160613.7825; val_kl_reg_loss: 1933.9094; val_edge_recon_loss: 74784.1182; val_gene_expr_recon_loss: 82053.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158771.4707; val_optim_loss: 158771.4707

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9947; val_auprc_score: 0.9982; val_best_acc_score: 0.9899; val_best_f1_score: 0.9941; train_kl_reg_loss: 1947.4484; train_edge_recon_loss: 76118.7302; train_gene_expr_recon_loss: 82861.4023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160927.5812; train_optim_loss: 160927.5812; val_kl_reg_loss: 1934.3338; val_edge_recon_loss: 75534.1416; val_gene_expr_recon_loss: 81987.5674; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159456.0410; val_optim_loss: 159456.0410
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9954; val_auprc_score: 0.9987; val_best_acc_score: 0.9888; val_best_f1_score: 0.9935; train_kl_reg_loss: 1949.7887; train_edge_recon_loss: 76131.7874; train_gene_expr_recon_loss: 82832.0189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160913.5952; train_optim_loss: 160913.5952; val_kl_reg_loss: 1940.5131; val_edge_recon_loss: 76024.6152; val_gene_expr_recon_loss: 83333.0791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161298.2031; val_optim_loss: 161298.2031
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9961; val_auprc_score: 0.9988; val_best_acc_score: 0.9906; val_best_f1_score: 0.9945; train_kl_reg_loss: 1949.9009; train_edge_recon_loss: 75883.9547; train_gene_expr_recon_loss: 82813.4804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160647.3353; train_optim_loss: 160647.3353; val_kl_reg_loss: 1934.3162; val_edge_recon_loss: 74393.0332; val_gene_expr_recon_loss: 82557.1836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158884.5312; val_optim_loss: 158884.5312

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 18 min 41 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9948
Val AUPRC score: 0.9983
Val best accuracy score: 0.9890
Val best F1 score: 0.9936
Val gene expr MSE score: 0.8567
Duration of model training in run 10: 0 hours, 18 minutes and 51 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
First script finished. Launching follow up script.
Run timestamp: 01062023_142507.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_1pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-attention_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-attention', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 1132
Number of validation edges: 125
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
702
<class 'int'>
702
<class 'int'>
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7673; val_auprc_score: 0.8843; val_best_acc_score: 0.8919; val_best_f1_score: 0.9385; train_kl_reg_loss: 69.2690; train_edge_recon_loss: 96357.8906; train_gene_expr_recon_loss: 159512.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 255940.0938; train_optim_loss: 255940.0938; val_kl_reg_loss: 73.3132; val_edge_recon_loss: 119148.5859; val_gene_expr_recon_loss: 146174.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265396.0000; val_optim_loss: 265396.0000
702
<class 'int'>
702
<class 'int'>
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8033; val_auprc_score: 0.9345; val_best_acc_score: 0.8912; val_best_f1_score: 0.9385; train_kl_reg_loss: 73.2901; train_edge_recon_loss: 100498.1562; train_gene_expr_recon_loss: 138957.7656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 239529.2188; train_optim_loss: 239529.2188; val_kl_reg_loss: 93.4199; val_edge_recon_loss: 116674.8516; val_gene_expr_recon_loss: 136012.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 252780.4375; val_optim_loss: 252780.4375
702
<class 'int'>
702
<class 'int'>
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7592; val_auprc_score: 0.9168; val_best_acc_score: 0.8973; val_best_f1_score: 0.9421; train_kl_reg_loss: 93.6597; train_edge_recon_loss: 93988.6875; train_gene_expr_recon_loss: 129349.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 223431.6875; train_optim_loss: 223431.6875; val_kl_reg_loss: 133.7551; val_edge_recon_loss: 113114.2656; val_gene_expr_recon_loss: 128692.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241940.8438; val_optim_loss: 241940.8438
702
<class 'int'>
702
<class 'int'>
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7849; val_auprc_score: 0.9154; val_best_acc_score: 0.8431; val_best_f1_score: 0.9111; train_kl_reg_loss: 132.7482; train_edge_recon_loss: 100717.5859; train_gene_expr_recon_loss: 122293.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 223143.5156; train_optim_loss: 223143.5156; val_kl_reg_loss: 190.5258; val_edge_recon_loss: 145360.1875; val_gene_expr_recon_loss: 122802.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268353.6875; val_optim_loss: 268353.6875
702
<class 'int'>
702
<class 'int'>
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7120; val_auprc_score: 0.9442; val_best_acc_score: 0.8803; val_best_f1_score: 0.9363; train_kl_reg_loss: 187.2385; train_edge_recon_loss: 89842.2188; train_gene_expr_recon_loss: 116789.3984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206818.8594; train_optim_loss: 206818.8594; val_kl_reg_loss: 261.4743; val_edge_recon_loss: 96269.8516; val_gene_expr_recon_loss: 118058.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214589.9062; val_optim_loss: 214589.9062
702
<class 'int'>
702
<class 'int'>
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7371; val_auprc_score: 0.9199; val_best_acc_score: 0.8767; val_best_f1_score: 0.9313; train_kl_reg_loss: 260.0769; train_edge_recon_loss: 102636.6406; train_gene_expr_recon_loss: 112274.2734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215171.0000; train_optim_loss: 215171.0000; val_kl_reg_loss: 352.0750; val_edge_recon_loss: 115310.7734; val_gene_expr_recon_loss: 114351.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 230014.0000; val_optim_loss: 230014.0000
702
<class 'int'>
702
<class 'int'>
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.6337; val_auprc_score: 0.9214; val_best_acc_score: 0.9065; val_best_f1_score: 0.9506; train_kl_reg_loss: 346.9485; train_edge_recon_loss: 105563.9219; train_gene_expr_recon_loss: 108942.2578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214853.1250; train_optim_loss: 214853.1250; val_kl_reg_loss: 436.0846; val_edge_recon_loss: 81134.6172; val_gene_expr_recon_loss: 111567.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193138.2500; val_optim_loss: 193138.2500
702
<class 'int'>
702
<class 'int'>
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7739; val_auprc_score: 0.9533; val_best_acc_score: 0.8958; val_best_f1_score: 0.9434; train_kl_reg_loss: 431.6326; train_edge_recon_loss: 101600.5156; train_gene_expr_recon_loss: 106443.4688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208475.6250; train_optim_loss: 208475.6250; val_kl_reg_loss: 502.4259; val_edge_recon_loss: 105343.9922; val_gene_expr_recon_loss: 109596.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215442.9062; val_optim_loss: 215442.9062
702
<class 'int'>
702
<class 'int'>
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7553; val_auprc_score: 0.9029; val_best_acc_score: 0.8553; val_best_f1_score: 0.9173; train_kl_reg_loss: 486.9933; train_edge_recon_loss: 98774.1328; train_gene_expr_recon_loss: 104734.7734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203995.9062; train_optim_loss: 203995.9062; val_kl_reg_loss: 518.3654; val_edge_recon_loss: 141772.1719; val_gene_expr_recon_loss: 108237.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 250527.7344; val_optim_loss: 250527.7344
702
<class 'int'>
702
<class 'int'>
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7823; val_auprc_score: 0.9480; val_best_acc_score: 0.9097; val_best_f1_score: 0.9494; train_kl_reg_loss: 507.8214; train_edge_recon_loss: 90274.3984; train_gene_expr_recon_loss: 103563.9609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194346.1875; train_optim_loss: 194346.1875; val_kl_reg_loss: 501.3828; val_edge_recon_loss: 104692.6016; val_gene_expr_recon_loss: 107298.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 212492.1875; val_optim_loss: 212492.1875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

702
<class 'int'>
702
<class 'int'>
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7062; val_auprc_score: 0.8790; val_best_acc_score: 0.8609; val_best_f1_score: 0.9208; train_kl_reg_loss: 495.3866; train_edge_recon_loss: 112288.6641; train_gene_expr_recon_loss: 102718.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215502.5000; train_optim_loss: 215502.5000; val_kl_reg_loss: 508.7083; val_edge_recon_loss: 137399.8750; val_gene_expr_recon_loss: 107220.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245128.7500; val_optim_loss: 245128.7500
702
<class 'int'>
702
<class 'int'>
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7854; val_auprc_score: 0.9199; val_best_acc_score: 0.8716; val_best_f1_score: 0.9294; train_kl_reg_loss: 491.5377; train_edge_recon_loss: 111381.2734; train_gene_expr_recon_loss: 102684.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214557.3125; train_optim_loss: 214557.3125; val_kl_reg_loss: 501.2398; val_edge_recon_loss: 123282.9062; val_gene_expr_recon_loss: 107141.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 230925.5312; val_optim_loss: 230925.5312
702
<class 'int'>
702
<class 'int'>
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7141; val_auprc_score: 0.8990; val_best_acc_score: 0.8397; val_best_f1_score: 0.9071; train_kl_reg_loss: 482.9072; train_edge_recon_loss: 95974.1250; train_gene_expr_recon_loss: 102613.3281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199070.3594; train_optim_loss: 199070.3594; val_kl_reg_loss: 476.2133; val_edge_recon_loss: 158378.6406; val_gene_expr_recon_loss: 107062.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265917.4375; val_optim_loss: 265917.4375

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 13 sec.
Using best model state, which was in epoch 7.

--- MODEL EVALUATION ---
Val AUROC score: 0.8015
Val AUPRC score: 0.9538
Val best accuracy score: 0.8776
Val best F1 score: 0.9313
Val gene expr MSE score: 2.2352
Duration of model training in run 1: 0 hours, 0 minutes and 28 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 1132
Number of validation edges: 125
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
702
<class 'int'>
702
<class 'int'>
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7989; val_auprc_score: 0.9183; val_best_acc_score: 0.8836; val_best_f1_score: 0.9363; train_kl_reg_loss: 54.1961; train_edge_recon_loss: 93897.7266; train_gene_expr_recon_loss: 162480.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 256432.8594; train_optim_loss: 256432.8594; val_kl_reg_loss: 59.8203; val_edge_recon_loss: 111288.2109; val_gene_expr_recon_loss: 144082.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 255430.1250; val_optim_loss: 255430.1250
702
<class 'int'>
702
<class 'int'>
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8209; val_auprc_score: 0.9612; val_best_acc_score: 0.8716; val_best_f1_score: 0.9294; train_kl_reg_loss: 61.8734; train_edge_recon_loss: 101761.5234; train_gene_expr_recon_loss: 142302.6719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 244126.0625; train_optim_loss: 244126.0625; val_kl_reg_loss: 83.4976; val_edge_recon_loss: 120785.8438; val_gene_expr_recon_loss: 133804.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 254673.8750; val_optim_loss: 254673.8750
702
<class 'int'>
702
<class 'int'>
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7800; val_auprc_score: 0.9219; val_best_acc_score: 0.8658; val_best_f1_score: 0.9259; train_kl_reg_loss: 87.0135; train_edge_recon_loss: 99274.6797; train_gene_expr_recon_loss: 132667.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 232028.9062; train_optim_loss: 232028.9062; val_kl_reg_loss: 127.7397; val_edge_recon_loss: 127047.4922; val_gene_expr_recon_loss: 126530.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 253705.2500; val_optim_loss: 253705.2500
702
<class 'int'>
702
<class 'int'>
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7948; val_auprc_score: 0.9598; val_best_acc_score: 0.8897; val_best_f1_score: 0.9398; train_kl_reg_loss: 130.5813; train_edge_recon_loss: 103670.7422; train_gene_expr_recon_loss: 125756.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229557.4062; train_optim_loss: 229557.4062; val_kl_reg_loss: 190.3544; val_edge_recon_loss: 109111.8750; val_gene_expr_recon_loss: 120773.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 230075.7344; val_optim_loss: 230075.7344
702
<class 'int'>
702
<class 'int'>
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7821; val_auprc_score: 0.9551; val_best_acc_score: 0.9085; val_best_f1_score: 0.9506; train_kl_reg_loss: 195.0998; train_edge_recon_loss: 93575.9531; train_gene_expr_recon_loss: 120107.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213878.2344; train_optim_loss: 213878.2344; val_kl_reg_loss: 269.1555; val_edge_recon_loss: 95136.5078; val_gene_expr_recon_loss: 116189.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211595.0469; val_optim_loss: 211595.0469
702
<class 'int'>
702
<class 'int'>
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8456; val_auprc_score: 0.9671; val_best_acc_score: 0.8649; val_best_f1_score: 0.9259; train_kl_reg_loss: 278.6111; train_edge_recon_loss: 102404.7656; train_gene_expr_recon_loss: 115533.0078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 218216.3750; train_optim_loss: 218216.3750; val_kl_reg_loss: 347.9931; val_edge_recon_loss: 124406.3906; val_gene_expr_recon_loss: 112663.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237417.9688; val_optim_loss: 237417.9688
702
<class 'int'>
702
<class 'int'>
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7300; val_auprc_score: 0.9217; val_best_acc_score: 0.8759; val_best_f1_score: 0.9328; train_kl_reg_loss: 367.8146; train_edge_recon_loss: 101018.6094; train_gene_expr_recon_loss: 111904.4844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213290.9062; train_optim_loss: 213290.9062; val_kl_reg_loss: 421.7967; val_edge_recon_loss: 111130.4609; val_gene_expr_recon_loss: 110085.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221637.3125; val_optim_loss: 221637.3125
702
<class 'int'>
702
<class 'int'>
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7044; val_auprc_score: 0.9117; val_best_acc_score: 0.8741; val_best_f1_score: 0.9328; train_kl_reg_loss: 447.7648; train_edge_recon_loss: 112448.6875; train_gene_expr_recon_loss: 109274.9297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 222171.3750; train_optim_loss: 222171.3750; val_kl_reg_loss: 473.6729; val_edge_recon_loss: 101741.6875; val_gene_expr_recon_loss: 108276.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210492.2500; val_optim_loss: 210492.2500
702
<class 'int'>
702
<class 'int'>
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.6776; val_auprc_score: 0.8632; val_best_acc_score: 0.8716; val_best_f1_score: 0.9266; train_kl_reg_loss: 502.5454; train_edge_recon_loss: 102782.2344; train_gene_expr_recon_loss: 107424.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210709.5625; train_optim_loss: 210709.5625; val_kl_reg_loss: 506.9947; val_edge_recon_loss: 124578.0156; val_gene_expr_recon_loss: 107006.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 232091.9688; val_optim_loss: 232091.9688
702
<class 'int'>
702
<class 'int'>
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8098; val_auprc_score: 0.9627; val_best_acc_score: 0.9130; val_best_f1_score: 0.9542; train_kl_reg_loss: 528.8364; train_edge_recon_loss: 101556.8906; train_gene_expr_recon_loss: 106081.8359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208167.5625; train_optim_loss: 208167.5625; val_kl_reg_loss: 510.6064; val_edge_recon_loss: 75395.7109; val_gene_expr_recon_loss: 106091.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181997.5312; val_optim_loss: 181997.5312
702
<class 'int'>
702
<class 'int'>
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7985; val_auprc_score: 0.9665; val_best_acc_score: 0.8865; val_best_f1_score: 0.9398; train_kl_reg_loss: 523.9767; train_edge_recon_loss: 105444.9609; train_gene_expr_recon_loss: 105106.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211075.4375; train_optim_loss: 211075.4375; val_kl_reg_loss: 479.1177; val_edge_recon_loss: 91499.2656; val_gene_expr_recon_loss: 105414.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197393.0625; val_optim_loss: 197393.0625
702
<class 'int'>
702
<class 'int'>
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7263; val_auprc_score: 0.9554; val_best_acc_score: 0.8993; val_best_f1_score: 0.9470; train_kl_reg_loss: 494.1832; train_edge_recon_loss: 111554.1953; train_gene_expr_recon_loss: 104340.3516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216388.7188; train_optim_loss: 216388.7188; val_kl_reg_loss: 430.2377; val_edge_recon_loss: 81255.4688; val_gene_expr_recon_loss: 104920.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186606.5000; val_optim_loss: 186606.5000
702
<class 'int'>
702
<class 'int'>
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8040; val_auprc_score: 0.9592; val_best_acc_score: 0.8881; val_best_f1_score: 0.9398; train_kl_reg_loss: 450.2386; train_edge_recon_loss: 100561.4062; train_gene_expr_recon_loss: 103777.2344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204788.8750; train_optim_loss: 204788.8750; val_kl_reg_loss: 383.7191; val_edge_recon_loss: 99740.7656; val_gene_expr_recon_loss: 104569.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204693.9062; val_optim_loss: 204693.9062

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

702
<class 'int'>
702
<class 'int'>
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7945; val_auprc_score: 0.9372; val_best_acc_score: 0.9078; val_best_f1_score: 0.9486; train_kl_reg_loss: 398.5386; train_edge_recon_loss: 101683.4453; train_gene_expr_recon_loss: 103438.4766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205520.4688; train_optim_loss: 205520.4688; val_kl_reg_loss: 382.5964; val_edge_recon_loss: 89832.0859; val_gene_expr_recon_loss: 104538.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194752.8594; val_optim_loss: 194752.8594
702
<class 'int'>
702
<class 'int'>
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8203; val_auprc_score: 0.9330; val_best_acc_score: 0.8725; val_best_f1_score: 0.9294; train_kl_reg_loss: 393.3471; train_edge_recon_loss: 97420.7969; train_gene_expr_recon_loss: 103389.2422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201203.3750; train_optim_loss: 201203.3750; val_kl_reg_loss: 374.1954; val_edge_recon_loss: 126254.0391; val_gene_expr_recon_loss: 104503.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 231131.6562; val_optim_loss: 231131.6562
702
<class 'int'>
702
<class 'int'>
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8280; val_auprc_score: 0.9641; val_best_acc_score: 0.8759; val_best_f1_score: 0.9328; train_kl_reg_loss: 385.3378; train_edge_recon_loss: 101820.5078; train_gene_expr_recon_loss: 103324.2891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205530.1250; train_optim_loss: 205530.1250; val_kl_reg_loss: 363.2468; val_edge_recon_loss: 109423.5234; val_gene_expr_recon_loss: 104465.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214252.1562; val_optim_loss: 214252.1562

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 3 sec.
Using best model state, which was in epoch 10.

--- MODEL EVALUATION ---
Val AUROC score: 0.7492
Val AUPRC score: 0.9308
Val best accuracy score: 0.8873
Val best F1 score: 0.9398
Val gene expr MSE score: 1.7836
Duration of model training in run 2: 0 hours, 0 minutes and 4 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 2243
Number of validation edges: 249
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
702
<class 'int'>
702
<class 'int'>
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8072; val_auprc_score: 0.9252; val_best_acc_score: 0.8881; val_best_f1_score: 0.9367; train_kl_reg_loss: 52.7229; train_edge_recon_loss: 104876.0469; train_gene_expr_recon_loss: 158545.7344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263474.5000; train_optim_loss: 263474.5000; val_kl_reg_loss: 54.0773; val_edge_recon_loss: 121344.5859; val_gene_expr_recon_loss: 146058.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267456.9375; val_optim_loss: 267456.9375
702
<class 'int'>
702
<class 'int'>
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7889; val_auprc_score: 0.9163; val_best_acc_score: 0.8553; val_best_f1_score: 0.9160; train_kl_reg_loss: 52.8278; train_edge_recon_loss: 95590.0938; train_gene_expr_recon_loss: 136882.3906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 232525.3125; train_optim_loss: 232525.3125; val_kl_reg_loss: 72.6073; val_edge_recon_loss: 142239.4219; val_gene_expr_recon_loss: 135951.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278263.7188; val_optim_loss: 278263.7188
702
<class 'int'>
702
<class 'int'>
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8135; val_auprc_score: 0.9332; val_best_acc_score: 0.8818; val_best_f1_score: 0.9331; train_kl_reg_loss: 70.9038; train_edge_recon_loss: 102391.1953; train_gene_expr_recon_loss: 127597.1953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 230059.2969; train_optim_loss: 230059.2969; val_kl_reg_loss: 107.3387; val_edge_recon_loss: 125663.0703; val_gene_expr_recon_loss: 128690.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 254461.4062; val_optim_loss: 254461.4062
702
<class 'int'>
702
<class 'int'>
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7890; val_auprc_score: 0.9476; val_best_acc_score: 0.8733; val_best_f1_score: 0.9293; train_kl_reg_loss: 104.8487; train_edge_recon_loss: 101863.3750; train_gene_expr_recon_loss: 120804.8203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 222773.0469; train_optim_loss: 222773.0469; val_kl_reg_loss: 157.5827; val_edge_recon_loss: 118027.1875; val_gene_expr_recon_loss: 122941.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241126.1562; val_optim_loss: 241126.1562
702
<class 'int'>
702
<class 'int'>
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8262; val_auprc_score: 0.9408; val_best_acc_score: 0.8789; val_best_f1_score: 0.9343; train_kl_reg_loss: 153.3076; train_edge_recon_loss: 98228.4375; train_gene_expr_recon_loss: 115503.8906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213885.6250; train_optim_loss: 213885.6250; val_kl_reg_loss: 217.2973; val_edge_recon_loss: 110636.4141; val_gene_expr_recon_loss: 118374.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229228.6250; val_optim_loss: 229228.6250
702
<class 'int'>
702
<class 'int'>
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7663; val_auprc_score: 0.9232; val_best_acc_score: 0.8729; val_best_f1_score: 0.9306; train_kl_reg_loss: 213.5646; train_edge_recon_loss: 101340.7266; train_gene_expr_recon_loss: 111347.8672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212902.1562; train_optim_loss: 212902.1562; val_kl_reg_loss: 280.8916; val_edge_recon_loss: 116193.0078; val_gene_expr_recon_loss: 114823.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 231296.9375; val_optim_loss: 231296.9375
702
<class 'int'>
702
<class 'int'>
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7986; val_auprc_score: 0.9586; val_best_acc_score: 0.8912; val_best_f1_score: 0.9414; train_kl_reg_loss: 275.2457; train_edge_recon_loss: 100013.4219; train_gene_expr_recon_loss: 108094.2422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208382.9062; train_optim_loss: 208382.9062; val_kl_reg_loss: 324.5093; val_edge_recon_loss: 101315.1250; val_gene_expr_recon_loss: 112122.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213761.7969; val_optim_loss: 213761.7969
702
<class 'int'>
702
<class 'int'>
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7211; val_auprc_score: 0.8998; val_best_acc_score: 0.8824; val_best_f1_score: 0.9356; train_kl_reg_loss: 317.7206; train_edge_recon_loss: 94329.2812; train_gene_expr_recon_loss: 105657.1484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200304.1562; train_optim_loss: 200304.1562; val_kl_reg_loss: 349.7615; val_edge_recon_loss: 111446.9766; val_gene_expr_recon_loss: 110087.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221884.0938; val_optim_loss: 221884.0938
702
<class 'int'>
702
<class 'int'>
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7768; val_auprc_score: 0.9391; val_best_acc_score: 0.8912; val_best_f1_score: 0.9414; train_kl_reg_loss: 338.1277; train_edge_recon_loss: 105489.9844; train_gene_expr_recon_loss: 103825.3984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209653.5000; train_optim_loss: 209653.5000; val_kl_reg_loss: 342.7714; val_edge_recon_loss: 100726.9453; val_gene_expr_recon_loss: 108560.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209630.5625; val_optim_loss: 209630.5625
702
<class 'int'>
702
<class 'int'>
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7834; val_auprc_score: 0.9164; val_best_acc_score: 0.8431; val_best_f1_score: 0.9121; train_kl_reg_loss: 331.4003; train_edge_recon_loss: 99485.6484; train_gene_expr_recon_loss: 102442.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202259.5469; train_optim_loss: 202259.5469; val_kl_reg_loss: 316.2592; val_edge_recon_loss: 147106.7188; val_gene_expr_recon_loss: 107410.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 254833.8281; val_optim_loss: 254833.8281
702
<class 'int'>
702
<class 'int'>
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9059; val_auprc_score: 0.9848; val_best_acc_score: 0.8951; val_best_f1_score: 0.9407; train_kl_reg_loss: 307.8243; train_edge_recon_loss: 98176.1562; train_gene_expr_recon_loss: 101365.9844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199849.9688; train_optim_loss: 199849.9688; val_kl_reg_loss: 283.3715; val_edge_recon_loss: 101800.5781; val_gene_expr_recon_loss: 106547.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208631.8906; val_optim_loss: 208631.8906
702
<class 'int'>
702
<class 'int'>
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7410; val_auprc_score: 0.9605; val_best_acc_score: 0.9061; val_best_f1_score: 0.9504; train_kl_reg_loss: 273.8905; train_edge_recon_loss: 102279.2734; train_gene_expr_recon_loss: 100554.2891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203107.4531; train_optim_loss: 203107.4531; val_kl_reg_loss: 252.6101; val_edge_recon_loss: 80594.0156; val_gene_expr_recon_loss: 105904.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186751.2188; val_optim_loss: 186751.2188
702
<class 'int'>
702
<class 'int'>
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8305; val_auprc_score: 0.9684; val_best_acc_score: 0.8842; val_best_f1_score: 0.9376; train_kl_reg_loss: 241.2846; train_edge_recon_loss: 99630.6484; train_gene_expr_recon_loss: 99963.3828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199835.3125; train_optim_loss: 199835.3125; val_kl_reg_loss: 220.3622; val_edge_recon_loss: 99359.9922; val_gene_expr_recon_loss: 105429.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205009.5781; val_optim_loss: 205009.5781
702
<class 'int'>
702
<class 'int'>
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7264; val_auprc_score: 0.8937; val_best_acc_score: 0.8653; val_best_f1_score: 0.9239; train_kl_reg_loss: 208.4492; train_edge_recon_loss: 104271.6094; train_gene_expr_recon_loss: 99522.0078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204002.0625; train_optim_loss: 204002.0625; val_kl_reg_loss: 188.8672; val_edge_recon_loss: 123755.9844; val_gene_expr_recon_loss: 105074.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229018.8594; val_optim_loss: 229018.8594
702
<class 'int'>
702
<class 'int'>
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.6789; val_auprc_score: 0.8858; val_best_acc_score: 0.8586; val_best_f1_score: 0.9222; train_kl_reg_loss: 180.3101; train_edge_recon_loss: 86770.5547; train_gene_expr_recon_loss: 99191.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186141.9375; train_optim_loss: 186141.9375; val_kl_reg_loss: 170.1176; val_edge_recon_loss: 124615.9844; val_gene_expr_recon_loss: 104801.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229588.0938; val_optim_loss: 229588.0938

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

702
<class 'int'>
702
<class 'int'>
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8025; val_auprc_score: 0.9452; val_best_acc_score: 0.8858; val_best_f1_score: 0.9379; train_kl_reg_loss: 159.6148; train_edge_recon_loss: 98167.8203; train_gene_expr_recon_loss: 98889.2734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197216.7188; train_optim_loss: 197216.7188; val_kl_reg_loss: 169.2999; val_edge_recon_loss: 104200.4219; val_gene_expr_recon_loss: 104776.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209145.9844; val_optim_loss: 209145.9844
702
<class 'int'>
702
<class 'int'>
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8518; val_auprc_score: 0.9719; val_best_acc_score: 0.9011; val_best_f1_score: 0.9468; train_kl_reg_loss: 157.5020; train_edge_recon_loss: 98641.7422; train_gene_expr_recon_loss: 98848.4922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197647.7344; train_optim_loss: 197647.7344; val_kl_reg_loss: 166.4816; val_edge_recon_loss: 89925.0625; val_gene_expr_recon_loss: 104746.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194838.3125; val_optim_loss: 194838.3125
702
<class 'int'>
702
<class 'int'>
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.7399; val_auprc_score: 0.9350; val_best_acc_score: 0.8724; val_best_f1_score: 0.9308; train_kl_reg_loss: 155.9456; train_edge_recon_loss: 96032.4062; train_gene_expr_recon_loss: 98857.5547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195045.9062; train_optim_loss: 195045.9062; val_kl_reg_loss: 166.4635; val_edge_recon_loss: 109205.7109; val_gene_expr_recon_loss: 104714.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214086.5469; val_optim_loss: 214086.5469

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 4 sec.
Using best model state, which was in epoch 12.

--- MODEL EVALUATION ---
Val AUROC score: 0.6312
Val AUPRC score: 0.8823
Val best accuracy score: 0.8681
Val best F1 score: 0.9291
Val gene expr MSE score: 2.2557
Duration of model training in run 3: 0 hours, 0 minutes and 4 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 2243
Number of validation edges: 249
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
702
<class 'int'>
702
<class 'int'>
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8422; val_auprc_score: 0.9597; val_best_acc_score: 0.8811; val_best_f1_score: 0.9361; train_kl_reg_loss: 54.9218; train_edge_recon_loss: 100592.3047; train_gene_expr_recon_loss: 161010.4844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261657.7188; train_optim_loss: 261657.7188; val_kl_reg_loss: 63.5841; val_edge_recon_loss: 101047.9688; val_gene_expr_recon_loss: 146453.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 247565.3750; val_optim_loss: 247565.3750
702
<class 'int'>
702
<class 'int'>
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7957; val_auprc_score: 0.9335; val_best_acc_score: 0.8889; val_best_f1_score: 0.9373; train_kl_reg_loss: 62.4814; train_edge_recon_loss: 101946.7500; train_gene_expr_recon_loss: 140363.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242373.1875; train_optim_loss: 242373.1875; val_kl_reg_loss: 88.7149; val_edge_recon_loss: 107138.6562; val_gene_expr_recon_loss: 135589.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 242816.6562; val_optim_loss: 242816.6562
702
<class 'int'>
702
<class 'int'>
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7388; val_auprc_score: 0.8976; val_best_acc_score: 0.8428; val_best_f1_score: 0.9118; train_kl_reg_loss: 87.5730; train_edge_recon_loss: 104208.2422; train_gene_expr_recon_loss: 130378.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 234674.6250; train_optim_loss: 234674.6250; val_kl_reg_loss: 135.1677; val_edge_recon_loss: 133928.8281; val_gene_expr_recon_loss: 127809.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261873.3594; val_optim_loss: 261873.3594
702
<class 'int'>
702
<class 'int'>
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8353; val_auprc_score: 0.9660; val_best_acc_score: 0.8862; val_best_f1_score: 0.9359; train_kl_reg_loss: 131.4072; train_edge_recon_loss: 100257.9688; train_gene_expr_recon_loss: 122998.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 223387.7500; train_optim_loss: 223387.7500; val_kl_reg_loss: 199.6610; val_edge_recon_loss: 112706.6797; val_gene_expr_recon_loss: 121679.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234585.4688; val_optim_loss: 234585.4688
702
<class 'int'>
702
<class 'int'>
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8273; val_auprc_score: 0.9518; val_best_acc_score: 0.8712; val_best_f1_score: 0.9249; train_kl_reg_loss: 194.6884; train_edge_recon_loss: 103624.4375; train_gene_expr_recon_loss: 117128.5234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220947.6562; train_optim_loss: 220947.6562; val_kl_reg_loss: 277.5936; val_edge_recon_loss: 124514.2500; val_gene_expr_recon_loss: 116880.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241672.4062; val_optim_loss: 241672.4062
702
<class 'int'>
702
<class 'int'>
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7772; val_auprc_score: 0.9252; val_best_acc_score: 0.8819; val_best_f1_score: 0.9361; train_kl_reg_loss: 268.5652; train_edge_recon_loss: 106993.5703; train_gene_expr_recon_loss: 112474.4453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219736.5781; train_optim_loss: 219736.5781; val_kl_reg_loss: 343.6369; val_edge_recon_loss: 108088.7188; val_gene_expr_recon_loss: 113257.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221689.8125; val_optim_loss: 221689.8125
702
<class 'int'>
702
<class 'int'>
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8002; val_auprc_score: 0.9291; val_best_acc_score: 0.8596; val_best_f1_score: 0.9239; train_kl_reg_loss: 333.6278; train_edge_recon_loss: 94191.6094; train_gene_expr_recon_loss: 108988.1172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203513.3438; train_optim_loss: 203513.3438; val_kl_reg_loss: 393.8452; val_edge_recon_loss: 118328.0938; val_gene_expr_recon_loss: 110587.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229309.8438; val_optim_loss: 229309.8438
702
<class 'int'>
702
<class 'int'>
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8438; val_auprc_score: 0.9656; val_best_acc_score: 0.8615; val_best_f1_score: 0.9234; train_kl_reg_loss: 381.5829; train_edge_recon_loss: 98886.2969; train_gene_expr_recon_loss: 106253.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205521.6250; train_optim_loss: 205521.6250; val_kl_reg_loss: 425.7145; val_edge_recon_loss: 126769.6328; val_gene_expr_recon_loss: 108649.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 235845.1562; val_optim_loss: 235845.1562
702
<class 'int'>
702
<class 'int'>
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7687; val_auprc_score: 0.9177; val_best_acc_score: 0.8644; val_best_f1_score: 0.9257; train_kl_reg_loss: 412.3472; train_edge_recon_loss: 104744.8594; train_gene_expr_recon_loss: 104311.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209469.1094; train_optim_loss: 209469.1094; val_kl_reg_loss: 434.7921; val_edge_recon_loss: 124056.5625; val_gene_expr_recon_loss: 107225.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 231717.0312; val_optim_loss: 231717.0312

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

702
<class 'int'>
702
<class 'int'>
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7659; val_auprc_score: 0.9344; val_best_acc_score: 0.8400; val_best_f1_score: 0.9121; train_kl_reg_loss: 415.8442; train_edge_recon_loss: 99410.1406; train_gene_expr_recon_loss: 102804.4297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202630.4062; train_optim_loss: 202630.4062; val_kl_reg_loss: 429.7388; val_edge_recon_loss: 136280.4531; val_gene_expr_recon_loss: 107103.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243813.7344; val_optim_loss: 243813.7344
702
<class 'int'>
702
<class 'int'>
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.6949; val_auprc_score: 0.9340; val_best_acc_score: 0.8869; val_best_f1_score: 0.9387; train_kl_reg_loss: 413.8406; train_edge_recon_loss: 103857.7266; train_gene_expr_recon_loss: 102715.1719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206986.7500; train_optim_loss: 206986.7500; val_kl_reg_loss: 425.5739; val_edge_recon_loss: 96288.2031; val_gene_expr_recon_loss: 106981.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 203695.7344; val_optim_loss: 203695.7344
702
<class 'int'>
702
<class 'int'>
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7157; val_auprc_score: 0.9101; val_best_acc_score: 0.8367; val_best_f1_score: 0.9104; train_kl_reg_loss: 408.9085; train_edge_recon_loss: 96449.3281; train_gene_expr_recon_loss: 102579.8203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199438.0625; train_optim_loss: 199438.0625; val_kl_reg_loss: 418.7458; val_edge_recon_loss: 136389.9531; val_gene_expr_recon_loss: 106861.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243670.0625; val_optim_loss: 243670.0625
702
<class 'int'>
702
<class 'int'>
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8051; val_auprc_score: 0.9577; val_best_acc_score: 0.8750; val_best_f1_score: 0.9326; train_kl_reg_loss: 403.8918; train_edge_recon_loss: 95311.1094; train_gene_expr_recon_loss: 102465.0156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198180.0156; train_optim_loss: 198180.0156; val_kl_reg_loss: 414.4532; val_edge_recon_loss: 107893.6797; val_gene_expr_recon_loss: 106742.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215050.2969; val_optim_loss: 215050.2969
702
<class 'int'>
702
<class 'int'>
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8114; val_auprc_score: 0.9459; val_best_acc_score: 0.8720; val_best_f1_score: 0.9306; train_kl_reg_loss: 397.0005; train_edge_recon_loss: 95504.7578; train_gene_expr_recon_loss: 102361.0547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198262.8125; train_optim_loss: 198262.8125; val_kl_reg_loss: 401.1176; val_edge_recon_loss: 110401.6016; val_gene_expr_recon_loss: 106624.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217427.4375; val_optim_loss: 217427.4375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

702
<class 'int'>
702
<class 'int'>
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7615; val_auprc_score: 0.9320; val_best_acc_score: 0.8601; val_best_f1_score: 0.9239; train_kl_reg_loss: 387.4263; train_edge_recon_loss: 101415.4219; train_gene_expr_recon_loss: 102248.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204051.1875; train_optim_loss: 204051.1875; val_kl_reg_loss: 401.7319; val_edge_recon_loss: 120208.3281; val_gene_expr_recon_loss: 106613.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227223.0938; val_optim_loss: 227223.0938
702
<class 'int'>
702
<class 'int'>
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7913; val_auprc_score: 0.9192; val_best_acc_score: 0.8703; val_best_f1_score: 0.9291; train_kl_reg_loss: 389.3749; train_edge_recon_loss: 97051.7031; train_gene_expr_recon_loss: 102228.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199670.0312; train_optim_loss: 199670.0312; val_kl_reg_loss: 399.0648; val_edge_recon_loss: 118745.3516; val_gene_expr_recon_loss: 106601.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 225745.6719; val_optim_loss: 225745.6719
702
<class 'int'>
702
<class 'int'>
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.7981; val_auprc_score: 0.9198; val_best_acc_score: 0.8703; val_best_f1_score: 0.9245; train_kl_reg_loss: 385.3410; train_edge_recon_loss: 106074.6797; train_gene_expr_recon_loss: 102206.1016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208666.1250; train_optim_loss: 208666.1250; val_kl_reg_loss: 398.6389; val_edge_recon_loss: 119087.1484; val_gene_expr_recon_loss: 106589.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 226075.2188; val_optim_loss: 226075.2188

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 3 sec.
Using best model state, which was in epoch 11.

--- MODEL EVALUATION ---
Val AUROC score: 0.6946
Val AUPRC score: 0.8884
Val best accuracy score: 0.8664
Val best F1 score: 0.9268
Val gene expr MSE score: 1.9292
Duration of model training in run 4: 0 hours, 0 minutes and 4 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 3438
Number of validation edges: 382
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
702
<class 'int'>
702
<class 'int'>
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8067; val_auprc_score: 0.9455; val_best_acc_score: 0.8747; val_best_f1_score: 0.9303; train_kl_reg_loss: 56.1115; train_edge_recon_loss: 98997.7109; train_gene_expr_recon_loss: 164305.6406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263359.4688; train_optim_loss: 263359.4688; val_kl_reg_loss: 63.7440; val_edge_recon_loss: 114510.9219; val_gene_expr_recon_loss: 143104.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 257679.5625; val_optim_loss: 257679.5625
702
<class 'int'>
702
<class 'int'>
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7736; val_auprc_score: 0.9188; val_best_acc_score: 0.8578; val_best_f1_score: 0.9191; train_kl_reg_loss: 63.8764; train_edge_recon_loss: 102945.8125; train_gene_expr_recon_loss: 138013.4531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241023.1406; train_optim_loss: 241023.1406; val_kl_reg_loss: 90.1602; val_edge_recon_loss: 130579.6328; val_gene_expr_recon_loss: 133108.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263778.5625; val_optim_loss: 263778.5625
702
<class 'int'>
702
<class 'int'>
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7403; val_auprc_score: 0.9195; val_best_acc_score: 0.8499; val_best_f1_score: 0.9167; train_kl_reg_loss: 91.5670; train_edge_recon_loss: 98741.5781; train_gene_expr_recon_loss: 127735.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226568.3438; train_optim_loss: 226568.3438; val_kl_reg_loss: 135.2508; val_edge_recon_loss: 126096.4688; val_gene_expr_recon_loss: 125858.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 252089.8438; val_optim_loss: 252089.8438
702
<class 'int'>
702
<class 'int'>
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7543; val_auprc_score: 0.9268; val_best_acc_score: 0.8902; val_best_f1_score: 0.9407; train_kl_reg_loss: 136.8767; train_edge_recon_loss: 97843.9297; train_gene_expr_recon_loss: 120303.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 218284.4688; train_optim_loss: 218284.4688; val_kl_reg_loss: 196.0098; val_edge_recon_loss: 100886.7500; val_gene_expr_recon_loss: 120090.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221172.8438; val_optim_loss: 221172.8438
702
<class 'int'>
702
<class 'int'>
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7963; val_auprc_score: 0.9446; val_best_acc_score: 0.8869; val_best_f1_score: 0.9372; train_kl_reg_loss: 200.1869; train_edge_recon_loss: 99830.7266; train_gene_expr_recon_loss: 114622.4688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214653.3750; train_optim_loss: 214653.3750; val_kl_reg_loss: 267.9373; val_edge_recon_loss: 108963.7031; val_gene_expr_recon_loss: 115539.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224771.1875; val_optim_loss: 224771.1875
702
<class 'int'>
702
<class 'int'>
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7866; val_auprc_score: 0.9287; val_best_acc_score: 0.8549; val_best_f1_score: 0.9188; train_kl_reg_loss: 271.3956; train_edge_recon_loss: 108939.4219; train_gene_expr_recon_loss: 110169.9922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219380.8125; train_optim_loss: 219380.8125; val_kl_reg_loss: 337.0393; val_edge_recon_loss: 129267.0703; val_gene_expr_recon_loss: 112084.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241688.6562; val_optim_loss: 241688.6562
702
<class 'int'>
702
<class 'int'>
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7479; val_auprc_score: 0.9233; val_best_acc_score: 0.8821; val_best_f1_score: 0.9361; train_kl_reg_loss: 340.1015; train_edge_recon_loss: 106782.3203; train_gene_expr_recon_loss: 106781.3984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213903.8125; train_optim_loss: 213903.8125; val_kl_reg_loss: 377.0610; val_edge_recon_loss: 107494.2031; val_gene_expr_recon_loss: 109558.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217429.8438; val_optim_loss: 217429.8438
702
<class 'int'>
702
<class 'int'>
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7928; val_auprc_score: 0.9328; val_best_acc_score: 0.8640; val_best_f1_score: 0.9246; train_kl_reg_loss: 382.1716; train_edge_recon_loss: 104061.0859; train_gene_expr_recon_loss: 104395.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208839.0625; train_optim_loss: 208839.0625; val_kl_reg_loss: 404.0070; val_edge_recon_loss: 129667.0156; val_gene_expr_recon_loss: 107727.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237798.8125; val_optim_loss: 237798.8125
702
<class 'int'>
702
<class 'int'>
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7968; val_auprc_score: 0.9307; val_best_acc_score: 0.8787; val_best_f1_score: 0.9338; train_kl_reg_loss: 407.0222; train_edge_recon_loss: 99263.7031; train_gene_expr_recon_loss: 102647.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202317.7188; train_optim_loss: 202317.7188; val_kl_reg_loss: 401.1996; val_edge_recon_loss: 113217.1172; val_gene_expr_recon_loss: 106386.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220004.3438; val_optim_loss: 220004.3438
702
<class 'int'>
702
<class 'int'>
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7374; val_auprc_score: 0.9255; val_best_acc_score: 0.8638; val_best_f1_score: 0.9261; train_kl_reg_loss: 410.6874; train_edge_recon_loss: 103319.2969; train_gene_expr_recon_loss: 101376.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205106.4844; train_optim_loss: 205106.4844; val_kl_reg_loss: 387.4766; val_edge_recon_loss: 117939.7812; val_gene_expr_recon_loss: 105389.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 223716.9688; val_optim_loss: 223716.9688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

702
<class 'int'>
702
<class 'int'>
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8316; val_auprc_score: 0.9706; val_best_acc_score: 0.8904; val_best_f1_score: 0.9397; train_kl_reg_loss: 393.0466; train_edge_recon_loss: 105621.1016; train_gene_expr_recon_loss: 100397.4141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206411.5625; train_optim_loss: 206411.5625; val_kl_reg_loss: 382.9346; val_edge_recon_loss: 101446.9062; val_gene_expr_recon_loss: 105303.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207133.0938; val_optim_loss: 207133.0938
702
<class 'int'>
702
<class 'int'>
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7688; val_auprc_score: 0.9286; val_best_acc_score: 0.8680; val_best_f1_score: 0.9281; train_kl_reg_loss: 386.4485; train_edge_recon_loss: 98907.3281; train_gene_expr_recon_loss: 100304.6016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199598.3750; train_optim_loss: 199598.3750; val_kl_reg_loss: 375.9235; val_edge_recon_loss: 115955.3516; val_gene_expr_recon_loss: 105215.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221546.9062; val_optim_loss: 221546.9062
702
<class 'int'>
702
<class 'int'>
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7841; val_auprc_score: 0.9280; val_best_acc_score: 0.8792; val_best_f1_score: 0.9337; train_kl_reg_loss: 382.1938; train_edge_recon_loss: 98874.0469; train_gene_expr_recon_loss: 100234.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199491.1562; train_optim_loss: 199491.1562; val_kl_reg_loss: 367.2882; val_edge_recon_loss: 115015.7500; val_gene_expr_recon_loss: 105127.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220510.4062; val_optim_loss: 220510.4062
702
<class 'int'>
702
<class 'int'>
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7335; val_auprc_score: 0.9174; val_best_acc_score: 0.8453; val_best_f1_score: 0.9150; train_kl_reg_loss: 373.6991; train_edge_recon_loss: 99694.3984; train_gene_expr_recon_loss: 100173.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200241.8750; train_optim_loss: 200241.8750; val_kl_reg_loss: 361.5003; val_edge_recon_loss: 134021.6250; val_gene_expr_recon_loss: 105038.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 239422.0625; val_optim_loss: 239422.0625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

702
<class 'int'>
702
<class 'int'>
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8103; val_auprc_score: 0.9510; val_best_acc_score: 0.8531; val_best_f1_score: 0.9194; train_kl_reg_loss: 366.4573; train_edge_recon_loss: 101445.2969; train_gene_expr_recon_loss: 100076.5703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201888.3281; train_optim_loss: 201888.3281; val_kl_reg_loss: 358.8341; val_edge_recon_loss: 128983.8438; val_gene_expr_recon_loss: 105030.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234372.6875; val_optim_loss: 234372.6875
702
<class 'int'>
702
<class 'int'>
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7804; val_auprc_score: 0.9371; val_best_acc_score: 0.8615; val_best_f1_score: 0.9219; train_kl_reg_loss: 365.4026; train_edge_recon_loss: 101050.5391; train_gene_expr_recon_loss: 100047.9922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201463.9375; train_optim_loss: 201463.9375; val_kl_reg_loss: 358.3499; val_edge_recon_loss: 127978.0703; val_gene_expr_recon_loss: 105020.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 233357.2969; val_optim_loss: 233357.2969
702
<class 'int'>
702
<class 'int'>
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.7489; val_auprc_score: 0.9318; val_best_acc_score: 0.8844; val_best_f1_score: 0.9373; train_kl_reg_loss: 363.9961; train_edge_recon_loss: 101394.0469; train_gene_expr_recon_loss: 100025.4453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201783.5000; train_optim_loss: 201783.5000; val_kl_reg_loss: 359.3516; val_edge_recon_loss: 106054.9844; val_gene_expr_recon_loss: 105011.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211425.9375; val_optim_loss: 211425.9375

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 4 sec.
Using best model state, which was in epoch 11.

--- MODEL EVALUATION ---
Val AUROC score: 0.7251
Val AUPRC score: 0.8989
Val best accuracy score: 0.8667
Val best F1 score: 0.9257
Val gene expr MSE score: 1.8059
Duration of model training in run 5: 0 hours, 0 minutes and 5 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 3438
Number of validation edges: 382
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
702
<class 'int'>
702
<class 'int'>
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8273; val_auprc_score: 0.9421; val_best_acc_score: 0.8753; val_best_f1_score: 0.9288; train_kl_reg_loss: 52.6891; train_edge_recon_loss: 103275.0625; train_gene_expr_recon_loss: 159796.4844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263124.2500; train_optim_loss: 263124.2500; val_kl_reg_loss: 60.6701; val_edge_recon_loss: 129383.5781; val_gene_expr_recon_loss: 142665.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272109.3125; val_optim_loss: 272109.3125
702
<class 'int'>
702
<class 'int'>
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8257; val_auprc_score: 0.9385; val_best_acc_score: 0.8755; val_best_f1_score: 0.9285; train_kl_reg_loss: 62.4156; train_edge_recon_loss: 103235.2422; train_gene_expr_recon_loss: 137731.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241028.7500; train_optim_loss: 241028.7500; val_kl_reg_loss: 88.4832; val_edge_recon_loss: 131347.7500; val_gene_expr_recon_loss: 132667.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264103.3750; val_optim_loss: 264103.3750
702
<class 'int'>
702
<class 'int'>
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8065; val_auprc_score: 0.9407; val_best_acc_score: 0.8789; val_best_f1_score: 0.9327; train_kl_reg_loss: 91.5486; train_edge_recon_loss: 102503.9609; train_gene_expr_recon_loss: 127616.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 230211.5312; train_optim_loss: 230211.5312; val_kl_reg_loss: 134.5704; val_edge_recon_loss: 114894.0078; val_gene_expr_recon_loss: 125333.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240361.6875; val_optim_loss: 240361.6875
702
<class 'int'>
702
<class 'int'>
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7543; val_auprc_score: 0.9499; val_best_acc_score: 0.8977; val_best_f1_score: 0.9455; train_kl_reg_loss: 137.9758; train_edge_recon_loss: 103135.5469; train_gene_expr_recon_loss: 120220.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 223493.8906; train_optim_loss: 223493.8906; val_kl_reg_loss: 191.8744; val_edge_recon_loss: 89690.0703; val_gene_expr_recon_loss: 119646.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209528.4219; val_optim_loss: 209528.4219
702
<class 'int'>
702
<class 'int'>
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7774; val_auprc_score: 0.9343; val_best_acc_score: 0.8733; val_best_f1_score: 0.9298; train_kl_reg_loss: 197.3492; train_edge_recon_loss: 106566.0078; train_gene_expr_recon_loss: 114457.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 221221.2812; train_optim_loss: 221221.2812; val_kl_reg_loss: 256.9886; val_edge_recon_loss: 109389.2578; val_gene_expr_recon_loss: 115280.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224926.8906; val_optim_loss: 224926.8906
702
<class 'int'>
702
<class 'int'>
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7612; val_auprc_score: 0.9106; val_best_acc_score: 0.8702; val_best_f1_score: 0.9279; train_kl_reg_loss: 264.6946; train_edge_recon_loss: 108926.6562; train_gene_expr_recon_loss: 109936.1484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219127.5000; train_optim_loss: 219127.5000; val_kl_reg_loss: 311.6082; val_edge_recon_loss: 117205.3828; val_gene_expr_recon_loss: 112047.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229564.1094; val_optim_loss: 229564.1094
702
<class 'int'>
702
<class 'int'>
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7596; val_auprc_score: 0.9141; val_best_acc_score: 0.8689; val_best_f1_score: 0.9265; train_kl_reg_loss: 321.1209; train_edge_recon_loss: 99326.9922; train_gene_expr_recon_loss: 106542.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206191.0781; train_optim_loss: 206191.0781; val_kl_reg_loss: 350.0849; val_edge_recon_loss: 121601.4453; val_gene_expr_recon_loss: 109684.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 231636.1250; val_optim_loss: 231636.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

702
<class 'int'>
702
<class 'int'>
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7728; val_auprc_score: 0.9262; val_best_acc_score: 0.8665; val_best_f1_score: 0.9283; train_kl_reg_loss: 364.2033; train_edge_recon_loss: 101404.2344; train_gene_expr_recon_loss: 104005.6484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205774.0938; train_optim_loss: 205774.0938; val_kl_reg_loss: 352.7579; val_edge_recon_loss: 109606.6953; val_gene_expr_recon_loss: 109488.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 219447.5312; val_optim_loss: 219447.5312
702
<class 'int'>
702
<class 'int'>
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7890; val_auprc_score: 0.9175; val_best_acc_score: 0.8728; val_best_f1_score: 0.9287; train_kl_reg_loss: 365.4229; train_edge_recon_loss: 98921.1406; train_gene_expr_recon_loss: 103828.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203115.3750; train_optim_loss: 203115.3750; val_kl_reg_loss: 349.7496; val_edge_recon_loss: 118480.5312; val_gene_expr_recon_loss: 109297.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228128.1250; val_optim_loss: 228128.1250
702
<class 'int'>
702
<class 'int'>
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8160; val_auprc_score: 0.9478; val_best_acc_score: 0.8649; val_best_f1_score: 0.9272; train_kl_reg_loss: 365.4387; train_edge_recon_loss: 99689.2500; train_gene_expr_recon_loss: 103591.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203645.8438; train_optim_loss: 203645.8438; val_kl_reg_loss: 349.4620; val_edge_recon_loss: 112550.5078; val_gene_expr_recon_loss: 109113.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222013.3438; val_optim_loss: 222013.3438

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 2 sec.
Using best model state, which was in epoch 4.

--- MODEL EVALUATION ---
Val AUROC score: 0.8047
Val AUPRC score: 0.9373
Val best accuracy score: 0.8483
Val best F1 score: 0.9125
Val gene expr MSE score: 2.5753
Duration of model training in run 6: 0 hours, 0 minutes and 3 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 4621
Number of validation edges: 513
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
702
<class 'int'>
702
<class 'int'>
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8013; val_auprc_score: 0.9345; val_best_acc_score: 0.8794; val_best_f1_score: 0.9331; train_kl_reg_loss: 47.8792; train_edge_recon_loss: 97361.9297; train_gene_expr_recon_loss: 163130.0156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260539.8281; train_optim_loss: 260539.8281; val_kl_reg_loss: 54.1692; val_edge_recon_loss: 111489.4297; val_gene_expr_recon_loss: 143388.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 254932.1250; val_optim_loss: 254932.1250
702
<class 'int'>
702
<class 'int'>
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7570; val_auprc_score: 0.9035; val_best_acc_score: 0.8680; val_best_f1_score: 0.9262; train_kl_reg_loss: 54.2059; train_edge_recon_loss: 95668.3359; train_gene_expr_recon_loss: 140160.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 235882.6875; train_optim_loss: 235882.6875; val_kl_reg_loss: 81.1111; val_edge_recon_loss: 122948.4297; val_gene_expr_recon_loss: 132855.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 255884.8750; val_optim_loss: 255884.8750
702
<class 'int'>
702
<class 'int'>
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7771; val_auprc_score: 0.9224; val_best_acc_score: 0.8731; val_best_f1_score: 0.9305; train_kl_reg_loss: 81.6094; train_edge_recon_loss: 101105.5312; train_gene_expr_recon_loss: 129799.6328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 230986.7812; train_optim_loss: 230986.7812; val_kl_reg_loss: 128.0747; val_edge_recon_loss: 115449.9922; val_gene_expr_recon_loss: 124937.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240515.0625; val_optim_loss: 240515.0625
702
<class 'int'>
702
<class 'int'>
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7683; val_auprc_score: 0.9130; val_best_acc_score: 0.8680; val_best_f1_score: 0.9265; train_kl_reg_loss: 129.0782; train_edge_recon_loss: 98957.1016; train_gene_expr_recon_loss: 122248.1953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 221334.3750; train_optim_loss: 221334.3750; val_kl_reg_loss: 196.6669; val_edge_recon_loss: 123853.9766; val_gene_expr_recon_loss: 118681.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 242732.2500; val_optim_loss: 242732.2500
702
<class 'int'>
702
<class 'int'>
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7892; val_auprc_score: 0.9478; val_best_acc_score: 0.8870; val_best_f1_score: 0.9381; train_kl_reg_loss: 197.0312; train_edge_recon_loss: 103869.4688; train_gene_expr_recon_loss: 116240.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220307.0312; train_optim_loss: 220307.0312; val_kl_reg_loss: 279.7104; val_edge_recon_loss: 108899.4609; val_gene_expr_recon_loss: 113878.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 223057.7188; val_optim_loss: 223057.7188
702
<class 'int'>
702
<class 'int'>
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8098; val_auprc_score: 0.9547; val_best_acc_score: 0.8650; val_best_f1_score: 0.9268; train_kl_reg_loss: 283.0632; train_edge_recon_loss: 98815.5703; train_gene_expr_recon_loss: 111748.8906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210847.5312; train_optim_loss: 210847.5312; val_kl_reg_loss: 361.3048; val_edge_recon_loss: 117245.4609; val_gene_expr_recon_loss: 110357.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227964.6250; val_optim_loss: 227964.6250
702
<class 'int'>
702
<class 'int'>
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8438; val_auprc_score: 0.9691; val_best_acc_score: 0.8742; val_best_f1_score: 0.9313; train_kl_reg_loss: 361.2579; train_edge_recon_loss: 106039.0703; train_gene_expr_recon_loss: 108394.2344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214794.5625; train_optim_loss: 214794.5625; val_kl_reg_loss: 406.2535; val_edge_recon_loss: 112476.8984; val_gene_expr_recon_loss: 107733.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220617.0312; val_optim_loss: 220617.0312
702
<class 'int'>
702
<class 'int'>
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7600; val_auprc_score: 0.9372; val_best_acc_score: 0.8812; val_best_f1_score: 0.9355; train_kl_reg_loss: 409.6705; train_edge_recon_loss: 104604.7109; train_gene_expr_recon_loss: 105884.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210898.4688; train_optim_loss: 210898.4688; val_kl_reg_loss: 421.7774; val_edge_recon_loss: 104319.8281; val_gene_expr_recon_loss: 105705.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210447.3750; val_optim_loss: 210447.3750
702
<class 'int'>
702
<class 'int'>
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7975; val_auprc_score: 0.9489; val_best_acc_score: 0.8797; val_best_f1_score: 0.9350; train_kl_reg_loss: 427.5505; train_edge_recon_loss: 100855.3203; train_gene_expr_recon_loss: 103989.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205272.1875; train_optim_loss: 205272.1875; val_kl_reg_loss: 417.2701; val_edge_recon_loss: 105305.2812; val_gene_expr_recon_loss: 104144.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209867.0938; val_optim_loss: 209867.0938
702
<class 'int'>
702
<class 'int'>
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7778; val_auprc_score: 0.9368; val_best_acc_score: 0.8657; val_best_f1_score: 0.9263; train_kl_reg_loss: 422.1168; train_edge_recon_loss: 105186.5391; train_gene_expr_recon_loss: 102506.9766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208115.6250; train_optim_loss: 208115.6250; val_kl_reg_loss: 394.7261; val_edge_recon_loss: 120137.8828; val_gene_expr_recon_loss: 102971.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 223504.5938; val_optim_loss: 223504.5938
702
<class 'int'>
702
<class 'int'>
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7380; val_auprc_score: 0.8986; val_best_acc_score: 0.8462; val_best_f1_score: 0.9137; train_kl_reg_loss: 396.9408; train_edge_recon_loss: 105977.1328; train_gene_expr_recon_loss: 101371.0859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207745.1562; train_optim_loss: 207745.1562; val_kl_reg_loss: 359.8840; val_edge_recon_loss: 143133.9688; val_gene_expr_recon_loss: 102103.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245597.0000; val_optim_loss: 245597.0000
702
<class 'int'>
702
<class 'int'>
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7812; val_auprc_score: 0.9333; val_best_acc_score: 0.8777; val_best_f1_score: 0.9326; train_kl_reg_loss: 361.7651; train_edge_recon_loss: 98614.1953; train_gene_expr_recon_loss: 100545.8516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199521.8125; train_optim_loss: 199521.8125; val_kl_reg_loss: 317.1894; val_edge_recon_loss: 112453.3125; val_gene_expr_recon_loss: 101453.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214224.2500; val_optim_loss: 214224.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

702
<class 'int'>
702
<class 'int'>
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7432; val_auprc_score: 0.9210; val_best_acc_score: 0.8700; val_best_f1_score: 0.9288; train_kl_reg_loss: 318.7330; train_edge_recon_loss: 98974.6797; train_gene_expr_recon_loss: 99928.6406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199222.0625; train_optim_loss: 199222.0625; val_kl_reg_loss: 313.2656; val_edge_recon_loss: 116252.0625; val_gene_expr_recon_loss: 101395.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217960.7500; val_optim_loss: 217960.7500
702
<class 'int'>
702
<class 'int'>
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7939; val_auprc_score: 0.9457; val_best_acc_score: 0.8735; val_best_f1_score: 0.9305; train_kl_reg_loss: 314.6171; train_edge_recon_loss: 105487.7891; train_gene_expr_recon_loss: 99898.5234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205700.9375; train_optim_loss: 205700.9375; val_kl_reg_loss: 308.6180; val_edge_recon_loss: 116938.6875; val_gene_expr_recon_loss: 101334.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218581.6562; val_optim_loss: 218581.6562
702
<class 'int'>
702
<class 'int'>
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7712; val_auprc_score: 0.9453; val_best_acc_score: 0.8937; val_best_f1_score: 0.9429; train_kl_reg_loss: 309.9886; train_edge_recon_loss: 106151.5547; train_gene_expr_recon_loss: 99769.6719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206231.2188; train_optim_loss: 206231.2188; val_kl_reg_loss: 303.1069; val_edge_recon_loss: 96034.8672; val_gene_expr_recon_loss: 101271.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197608.9844; val_optim_loss: 197608.9844
702
<class 'int'>
702
<class 'int'>
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7026; val_auprc_score: 0.8988; val_best_acc_score: 0.8677; val_best_f1_score: 0.9284; train_kl_reg_loss: 304.6954; train_edge_recon_loss: 93583.8125; train_gene_expr_recon_loss: 99743.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193632.2500; train_optim_loss: 193632.2500; val_kl_reg_loss: 298.4014; val_edge_recon_loss: 113097.3438; val_gene_expr_recon_loss: 101205.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214601.3594; val_optim_loss: 214601.3594
702
<class 'int'>
702
<class 'int'>
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.7704; val_auprc_score: 0.9478; val_best_acc_score: 0.8760; val_best_f1_score: 0.9322; train_kl_reg_loss: 298.1656; train_edge_recon_loss: 97885.9609; train_gene_expr_recon_loss: 99657.9766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197842.0938; train_optim_loss: 197842.0938; val_kl_reg_loss: 290.4629; val_edge_recon_loss: 112397.7969; val_gene_expr_recon_loss: 101138.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213827.0625; val_optim_loss: 213827.0625
702
<class 'int'>
702
<class 'int'>
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.7418; val_auprc_score: 0.8988; val_best_acc_score: 0.8504; val_best_f1_score: 0.9176; train_kl_reg_loss: 292.3096; train_edge_recon_loss: 104830.8203; train_gene_expr_recon_loss: 99624.5078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204747.6406; train_optim_loss: 204747.6406; val_kl_reg_loss: 286.0622; val_edge_recon_loss: 132734.8594; val_gene_expr_recon_loss: 101070.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234091.7500; val_optim_loss: 234091.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

702
<class 'int'>
702
<class 'int'>
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8045; val_auprc_score: 0.9580; val_best_acc_score: 0.8696; val_best_f1_score: 0.9292; train_kl_reg_loss: 286.7050; train_edge_recon_loss: 105824.1641; train_gene_expr_recon_loss: 99539.3203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205650.1875; train_optim_loss: 205650.1875; val_kl_reg_loss: 284.6876; val_edge_recon_loss: 113642.6250; val_gene_expr_recon_loss: 101063.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214991.1875; val_optim_loss: 214991.1875
702
<class 'int'>
702
<class 'int'>
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.7149; val_auprc_score: 0.9126; val_best_acc_score: 0.8667; val_best_f1_score: 0.9273; train_kl_reg_loss: 286.1373; train_edge_recon_loss: 102341.8984; train_gene_expr_recon_loss: 99543.5781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202171.6250; train_optim_loss: 202171.6250; val_kl_reg_loss: 282.3870; val_edge_recon_loss: 116422.5234; val_gene_expr_recon_loss: 101056.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217761.6875; val_optim_loss: 217761.6875
702
<class 'int'>
702
<class 'int'>
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.7838; val_auprc_score: 0.9315; val_best_acc_score: 0.8717; val_best_f1_score: 0.9293; train_kl_reg_loss: 285.1959; train_edge_recon_loss: 98711.0859; train_gene_expr_recon_loss: 99523.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198519.6250; train_optim_loss: 198519.6250; val_kl_reg_loss: 283.9817; val_edge_recon_loss: 115624.7891; val_gene_expr_recon_loss: 101049.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216958.2656; val_optim_loss: 216958.2656

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 5 sec.
Using best model state, which was in epoch 15.

--- MODEL EVALUATION ---
Val AUROC score: 0.7514
Val AUPRC score: 0.9219
Val best accuracy score: 0.8822
Val best F1 score: 0.9357
Val gene expr MSE score: 1.6487
Duration of model training in run 7: 0 hours, 0 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 4621
Number of validation edges: 513
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
702
<class 'int'>
702
<class 'int'>
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7878; val_auprc_score: 0.9200; val_best_acc_score: 0.8691; val_best_f1_score: 0.9242; train_kl_reg_loss: 61.1443; train_edge_recon_loss: 104034.7734; train_gene_expr_recon_loss: 161343.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265439.7188; train_optim_loss: 265439.7188; val_kl_reg_loss: 59.2091; val_edge_recon_loss: 136115.0938; val_gene_expr_recon_loss: 134951.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271125.8125; val_optim_loss: 271125.8125
702
<class 'int'>
702
<class 'int'>
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8052; val_auprc_score: 0.9369; val_best_acc_score: 0.8703; val_best_f1_score: 0.9266; train_kl_reg_loss: 61.3719; train_edge_recon_loss: 104222.4531; train_gene_expr_recon_loss: 138901.4219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 243185.2500; train_optim_loss: 243185.2500; val_kl_reg_loss: 79.1616; val_edge_recon_loss: 125748.1875; val_gene_expr_recon_loss: 125524.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 251351.7188; val_optim_loss: 251351.7188
702
<class 'int'>
702
<class 'int'>
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7504; val_auprc_score: 0.9264; val_best_acc_score: 0.8777; val_best_f1_score: 0.9327; train_kl_reg_loss: 82.2494; train_edge_recon_loss: 100006.6328; train_gene_expr_recon_loss: 128764.1953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228853.0781; train_optim_loss: 228853.0781; val_kl_reg_loss: 117.6563; val_edge_recon_loss: 112815.6953; val_gene_expr_recon_loss: 118860.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 231794.3438; val_optim_loss: 231794.3438
702
<class 'int'>
702
<class 'int'>
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7608; val_auprc_score: 0.9204; val_best_acc_score: 0.8590; val_best_f1_score: 0.9207; train_kl_reg_loss: 122.6231; train_edge_recon_loss: 102505.9141; train_gene_expr_recon_loss: 121445.0703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224073.6094; train_optim_loss: 224073.6094; val_kl_reg_loss: 171.9676; val_edge_recon_loss: 128173.6953; val_gene_expr_recon_loss: 113687.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 242033.4688; val_optim_loss: 242033.4688
702
<class 'int'>
702
<class 'int'>
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7762; val_auprc_score: 0.9140; val_best_acc_score: 0.8518; val_best_f1_score: 0.9170; train_kl_reg_loss: 178.0415; train_edge_recon_loss: 101775.5703; train_gene_expr_recon_loss: 115687.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217641.2812; train_optim_loss: 217641.2812; val_kl_reg_loss: 234.6788; val_edge_recon_loss: 132821.5469; val_gene_expr_recon_loss: 109658.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 242714.6875; val_optim_loss: 242714.6875
702
<class 'int'>
702
<class 'int'>
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7144; val_auprc_score: 0.8806; val_best_acc_score: 0.8436; val_best_f1_score: 0.9143; train_kl_reg_loss: 243.9098; train_edge_recon_loss: 101227.1953; train_gene_expr_recon_loss: 111235.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212706.9688; train_optim_loss: 212706.9688; val_kl_reg_loss: 294.0245; val_edge_recon_loss: 132845.2188; val_gene_expr_recon_loss: 106634.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 239774.0938; val_optim_loss: 239774.0938

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

702
<class 'int'>
702
<class 'int'>
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7179; val_auprc_score: 0.9293; val_best_acc_score: 0.8939; val_best_f1_score: 0.9439; train_kl_reg_loss: 304.9637; train_edge_recon_loss: 102580.5469; train_gene_expr_recon_loss: 107797.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210683.2812; train_optim_loss: 210683.2812; val_kl_reg_loss: 298.6132; val_edge_recon_loss: 87222.9922; val_gene_expr_recon_loss: 106385.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193906.6875; val_optim_loss: 193906.6875
702
<class 'int'>
702
<class 'int'>
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7355; val_auprc_score: 0.8947; val_best_acc_score: 0.8508; val_best_f1_score: 0.9172; train_kl_reg_loss: 307.7266; train_edge_recon_loss: 96870.0938; train_gene_expr_recon_loss: 107540.1484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204717.9688; train_optim_loss: 204717.9688; val_kl_reg_loss: 297.3837; val_edge_recon_loss: 128440.0547; val_gene_expr_recon_loss: 106146.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234883.7500; val_optim_loss: 234883.7500
702
<class 'int'>
702
<class 'int'>
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7559; val_auprc_score: 0.9123; val_best_acc_score: 0.8493; val_best_f1_score: 0.9185; train_kl_reg_loss: 309.0706; train_edge_recon_loss: 97956.5938; train_gene_expr_recon_loss: 107277.2734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205542.9375; train_optim_loss: 205542.9375; val_kl_reg_loss: 295.9579; val_edge_recon_loss: 121813.6250; val_gene_expr_recon_loss: 105916.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228026.5625; val_optim_loss: 228026.5625
702
<class 'int'>
702
<class 'int'>
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7981; val_auprc_score: 0.9291; val_best_acc_score: 0.8725; val_best_f1_score: 0.9298; train_kl_reg_loss: 308.1927; train_edge_recon_loss: 109703.6562; train_gene_expr_recon_loss: 107017.0234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217028.8750; train_optim_loss: 217028.8750; val_kl_reg_loss: 294.8337; val_edge_recon_loss: 112297.1875; val_gene_expr_recon_loss: 105696.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218288.0625; val_optim_loss: 218288.0625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

702
<class 'int'>
702
<class 'int'>
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7603; val_auprc_score: 0.9219; val_best_acc_score: 0.8574; val_best_f1_score: 0.9217; train_kl_reg_loss: 306.0975; train_edge_recon_loss: 103028.6328; train_gene_expr_recon_loss: 106770.1016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210104.8281; train_optim_loss: 210104.8281; val_kl_reg_loss: 294.2458; val_edge_recon_loss: 120596.1016; val_gene_expr_recon_loss: 105674.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 226564.8125; val_optim_loss: 226564.8125
702
<class 'int'>
702
<class 'int'>
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7210; val_auprc_score: 0.9126; val_best_acc_score: 0.8727; val_best_f1_score: 0.9310; train_kl_reg_loss: 305.8962; train_edge_recon_loss: 101359.8750; train_gene_expr_recon_loss: 106744.1719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208409.9375; train_optim_loss: 208409.9375; val_kl_reg_loss: 293.8183; val_edge_recon_loss: 104376.5391; val_gene_expr_recon_loss: 105653.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210323.5625; val_optim_loss: 210323.5625
702
<class 'int'>
702
<class 'int'>
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7706; val_auprc_score: 0.9195; val_best_acc_score: 0.8548; val_best_f1_score: 0.9187; train_kl_reg_loss: 305.0300; train_edge_recon_loss: 98546.8203; train_gene_expr_recon_loss: 106733.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205585.2500; train_optim_loss: 205585.2500; val_kl_reg_loss: 294.0385; val_edge_recon_loss: 131520.7969; val_gene_expr_recon_loss: 105632.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237446.9375; val_optim_loss: 237446.9375

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 3 sec.
Using best model state, which was in epoch 7.

--- MODEL EVALUATION ---
Val AUROC score: 0.7638
Val AUPRC score: 0.9135
Val best accuracy score: 0.8609
Val best F1 score: 0.9231
Val gene expr MSE score: 1.5078
Duration of model training in run 8: 0 hours, 0 minutes and 4 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 5804
Number of validation edges: 644
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
702
<class 'int'>
702
<class 'int'>
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7668; val_auprc_score: 0.9152; val_best_acc_score: 0.8718; val_best_f1_score: 0.9303; train_kl_reg_loss: 48.4528; train_edge_recon_loss: 102171.6094; train_gene_expr_recon_loss: 163023.5156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265243.5625; train_optim_loss: 265243.5625; val_kl_reg_loss: 50.9281; val_edge_recon_loss: 111363.8984; val_gene_expr_recon_loss: 145134.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 256548.9844; val_optim_loss: 256548.9844
702
<class 'int'>
702
<class 'int'>
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7810; val_auprc_score: 0.9338; val_best_acc_score: 0.8839; val_best_f1_score: 0.9373; train_kl_reg_loss: 52.4958; train_edge_recon_loss: 99501.0547; train_gene_expr_recon_loss: 139865.8281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 239419.3750; train_optim_loss: 239419.3750; val_kl_reg_loss: 74.8471; val_edge_recon_loss: 104411.6719; val_gene_expr_recon_loss: 134345.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238831.8281; val_optim_loss: 238831.8281
702
<class 'int'>
702
<class 'int'>
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7994; val_auprc_score: 0.9453; val_best_acc_score: 0.8637; val_best_f1_score: 0.9246; train_kl_reg_loss: 76.9918; train_edge_recon_loss: 105876.4688; train_gene_expr_recon_loss: 129382.8359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 235336.2969; train_optim_loss: 235336.2969; val_kl_reg_loss: 121.1532; val_edge_recon_loss: 125142.7500; val_gene_expr_recon_loss: 126394.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 251658.2812; val_optim_loss: 251658.2812
702
<class 'int'>
702
<class 'int'>
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7954; val_auprc_score: 0.9292; val_best_acc_score: 0.8575; val_best_f1_score: 0.9212; train_kl_reg_loss: 125.0440; train_edge_recon_loss: 106131.5156; train_gene_expr_recon_loss: 121797.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228054.5156; train_optim_loss: 228054.5156; val_kl_reg_loss: 190.3074; val_edge_recon_loss: 127532.1875; val_gene_expr_recon_loss: 120114.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 247837.1875; val_optim_loss: 247837.1875
702
<class 'int'>
702
<class 'int'>
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7652; val_auprc_score: 0.9261; val_best_acc_score: 0.8777; val_best_f1_score: 0.9340; train_kl_reg_loss: 196.3146; train_edge_recon_loss: 101360.6719; train_gene_expr_recon_loss: 115703.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217260.6719; train_optim_loss: 217260.6719; val_kl_reg_loss: 279.0847; val_edge_recon_loss: 108548.6484; val_gene_expr_recon_loss: 115198.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224025.7969; val_optim_loss: 224025.7969
702
<class 'int'>
702
<class 'int'>
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7633; val_auprc_score: 0.9174; val_best_acc_score: 0.8597; val_best_f1_score: 0.9219; train_kl_reg_loss: 286.7773; train_edge_recon_loss: 101851.5391; train_gene_expr_recon_loss: 110975.4531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213113.7656; train_optim_loss: 213113.7656; val_kl_reg_loss: 359.8569; val_edge_recon_loss: 132115.2188; val_gene_expr_recon_loss: 111536.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244012.0625; val_optim_loss: 244012.0625
702
<class 'int'>
702
<class 'int'>
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7659; val_auprc_score: 0.9194; val_best_acc_score: 0.8602; val_best_f1_score: 0.9232; train_kl_reg_loss: 370.3299; train_edge_recon_loss: 99756.2969; train_gene_expr_recon_loss: 107330.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207457.0000; train_optim_loss: 207457.0000; val_kl_reg_loss: 424.3264; val_edge_recon_loss: 121681.8281; val_gene_expr_recon_loss: 108901.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 231008.1562; val_optim_loss: 231008.1562
702
<class 'int'>
702
<class 'int'>
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7798; val_auprc_score: 0.9251; val_best_acc_score: 0.8598; val_best_f1_score: 0.9240; train_kl_reg_loss: 435.4539; train_edge_recon_loss: 100418.5781; train_gene_expr_recon_loss: 104711.7266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205565.7500; train_optim_loss: 205565.7500; val_kl_reg_loss: 464.7215; val_edge_recon_loss: 119748.2734; val_gene_expr_recon_loss: 107017.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227230.8750; val_optim_loss: 227230.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

702
<class 'int'>
702
<class 'int'>
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7498; val_auprc_score: 0.9197; val_best_acc_score: 0.8690; val_best_f1_score: 0.9286; train_kl_reg_loss: 476.1169; train_edge_recon_loss: 105012.2734; train_gene_expr_recon_loss: 102765.6484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208254.0312; train_optim_loss: 208254.0312; val_kl_reg_loss: 463.1048; val_edge_recon_loss: 119506.5078; val_gene_expr_recon_loss: 106863.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 226833.2188; val_optim_loss: 226833.2188
702
<class 'int'>
702
<class 'int'>
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7410; val_auprc_score: 0.9334; val_best_acc_score: 0.8785; val_best_f1_score: 0.9347; train_kl_reg_loss: 478.0710; train_edge_recon_loss: 104889.5156; train_gene_expr_recon_loss: 102612.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207979.6250; train_optim_loss: 207979.6250; val_kl_reg_loss: 461.9234; val_edge_recon_loss: 105878.7578; val_gene_expr_recon_loss: 106716.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213056.9844; val_optim_loss: 213056.9844
702
<class 'int'>
702
<class 'int'>
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7875; val_auprc_score: 0.9332; val_best_acc_score: 0.8703; val_best_f1_score: 0.9293; train_kl_reg_loss: 476.3024; train_edge_recon_loss: 101343.7891; train_gene_expr_recon_loss: 102461.7656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204281.8594; train_optim_loss: 204281.8594; val_kl_reg_loss: 458.6433; val_edge_recon_loss: 112317.5547; val_gene_expr_recon_loss: 106575.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 219351.2188; val_optim_loss: 219351.2188
702
<class 'int'>
702
<class 'int'>
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7922; val_auprc_score: 0.9454; val_best_acc_score: 0.8702; val_best_f1_score: 0.9280; train_kl_reg_loss: 472.1723; train_edge_recon_loss: 104317.7578; train_gene_expr_recon_loss: 102328.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207118.1250; train_optim_loss: 207118.1250; val_kl_reg_loss: 452.3411; val_edge_recon_loss: 118587.2891; val_gene_expr_recon_loss: 106439.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 225479.2500; val_optim_loss: 225479.2500
702
<class 'int'>
702
<class 'int'>
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7289; val_auprc_score: 0.9227; val_best_acc_score: 0.8775; val_best_f1_score: 0.9340; train_kl_reg_loss: 466.3335; train_edge_recon_loss: 103426.7969; train_gene_expr_recon_loss: 102168.1016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206061.2344; train_optim_loss: 206061.2344; val_kl_reg_loss: 447.6138; val_edge_recon_loss: 107730.6016; val_gene_expr_recon_loss: 106309.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214488.0156; val_optim_loss: 214488.0156

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

702
<class 'int'>
702
<class 'int'>
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7894; val_auprc_score: 0.9299; val_best_acc_score: 0.8675; val_best_f1_score: 0.9280; train_kl_reg_loss: 458.1492; train_edge_recon_loss: 97851.3984; train_gene_expr_recon_loss: 102037.0078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200346.5625; train_optim_loss: 200346.5625; val_kl_reg_loss: 445.8785; val_edge_recon_loss: 118693.5781; val_gene_expr_recon_loss: 106297.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 225436.6094; val_optim_loss: 225436.6094
702
<class 'int'>
702
<class 'int'>
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7667; val_auprc_score: 0.9150; val_best_acc_score: 0.8458; val_best_f1_score: 0.9148; train_kl_reg_loss: 457.4478; train_edge_recon_loss: 104122.6016; train_gene_expr_recon_loss: 101998.5156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206578.5625; train_optim_loss: 206578.5625; val_kl_reg_loss: 442.6922; val_edge_recon_loss: 139050.0938; val_gene_expr_recon_loss: 106284.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245777.4375; val_optim_loss: 245777.4375
702
<class 'int'>
702
<class 'int'>
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7637; val_auprc_score: 0.9098; val_best_acc_score: 0.8402; val_best_f1_score: 0.9115; train_kl_reg_loss: 456.8835; train_edge_recon_loss: 102694.3047; train_gene_expr_recon_loss: 101971.6016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205122.7812; train_optim_loss: 205122.7812; val_kl_reg_loss: 443.2940; val_edge_recon_loss: 142464.8750; val_gene_expr_recon_loss: 106272.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 249180.4688; val_optim_loss: 249180.4688

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 4 sec.
Using best model state, which was in epoch 10.

--- MODEL EVALUATION ---
Val AUROC score: 0.7149
Val AUPRC score: 0.8955
Val best accuracy score: 0.8638
Val best F1 score: 0.9260
Val gene expr MSE score: 1.6969
Duration of model training in run 9: 0 hours, 0 minutes and 5 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 5804
Number of validation edges: 644
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
702
<class 'int'>
702
<class 'int'>
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7756; val_auprc_score: 0.9327; val_best_acc_score: 0.8896; val_best_f1_score: 0.9395; train_kl_reg_loss: 57.6335; train_edge_recon_loss: 100716.1406; train_gene_expr_recon_loss: 167145.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 267919.5625; train_optim_loss: 267919.5625; val_kl_reg_loss: 65.2595; val_edge_recon_loss: 105947.1250; val_gene_expr_recon_loss: 138557.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244569.6562; val_optim_loss: 244569.6562
702
<class 'int'>
702
<class 'int'>
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7405; val_auprc_score: 0.9020; val_best_acc_score: 0.8581; val_best_f1_score: 0.9220; train_kl_reg_loss: 64.8030; train_edge_recon_loss: 102516.6641; train_gene_expr_recon_loss: 138669.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241250.5938; train_optim_loss: 241250.5938; val_kl_reg_loss: 91.1402; val_edge_recon_loss: 129243.0469; val_gene_expr_recon_loss: 127924.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 257258.3750; val_optim_loss: 257258.3750
702
<class 'int'>
702
<class 'int'>
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7400; val_auprc_score: 0.9232; val_best_acc_score: 0.8874; val_best_f1_score: 0.9389; train_kl_reg_loss: 90.6870; train_edge_recon_loss: 99571.5547; train_gene_expr_recon_loss: 128410.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228073.1250; train_optim_loss: 228073.1250; val_kl_reg_loss: 136.4896; val_edge_recon_loss: 101539.8984; val_gene_expr_recon_loss: 120739.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222415.6875; val_optim_loss: 222415.6875
702
<class 'int'>
702
<class 'int'>
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7498; val_auprc_score: 0.9290; val_best_acc_score: 0.8927; val_best_f1_score: 0.9412; train_kl_reg_loss: 134.8489; train_edge_recon_loss: 103255.5547; train_gene_expr_recon_loss: 121290.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224680.9375; train_optim_loss: 224680.9375; val_kl_reg_loss: 196.1652; val_edge_recon_loss: 100679.0234; val_gene_expr_recon_loss: 115291.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216166.6562; val_optim_loss: 216166.6562
702
<class 'int'>
702
<class 'int'>
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7380; val_auprc_score: 0.9176; val_best_acc_score: 0.8690; val_best_f1_score: 0.9293; train_kl_reg_loss: 194.0000; train_edge_recon_loss: 105316.0547; train_gene_expr_recon_loss: 115889.5781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 221399.6250; train_optim_loss: 221399.6250; val_kl_reg_loss: 262.5514; val_edge_recon_loss: 112374.7344; val_gene_expr_recon_loss: 111119.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 223756.9375; val_optim_loss: 223756.9375
702
<class 'int'>
702
<class 'int'>
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7907; val_auprc_score: 0.9317; val_best_acc_score: 0.8845; val_best_f1_score: 0.9361; train_kl_reg_loss: 260.5019; train_edge_recon_loss: 103153.4453; train_gene_expr_recon_loss: 111601.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215015.2188; train_optim_loss: 215015.2188; val_kl_reg_loss: 321.7396; val_edge_recon_loss: 116625.3984; val_gene_expr_recon_loss: 107988.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224935.1562; val_optim_loss: 224935.1562
702
<class 'int'>
702
<class 'int'>
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7073; val_auprc_score: 0.9147; val_best_acc_score: 0.8596; val_best_f1_score: 0.9232; train_kl_reg_loss: 318.9477; train_edge_recon_loss: 101576.2734; train_gene_expr_recon_loss: 108423.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210318.8750; train_optim_loss: 210318.8750; val_kl_reg_loss: 362.8909; val_edge_recon_loss: 118936.7188; val_gene_expr_recon_loss: 105640.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224939.6719; val_optim_loss: 224939.6719

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

702
<class 'int'>
702
<class 'int'>
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7446; val_auprc_score: 0.9145; val_best_acc_score: 0.8730; val_best_f1_score: 0.9305; train_kl_reg_loss: 359.0277; train_edge_recon_loss: 102397.8828; train_gene_expr_recon_loss: 105974.9297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208731.8438; train_optim_loss: 208731.8438; val_kl_reg_loss: 365.2003; val_edge_recon_loss: 119402.9375; val_gene_expr_recon_loss: 105439.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 225208.0312; val_optim_loss: 225208.0312
702
<class 'int'>
702
<class 'int'>
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7618; val_auprc_score: 0.9332; val_best_acc_score: 0.8662; val_best_f1_score: 0.9262; train_kl_reg_loss: 360.0538; train_edge_recon_loss: 99113.5391; train_gene_expr_recon_loss: 105793.1016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205266.6875; train_optim_loss: 205266.6875; val_kl_reg_loss: 363.2823; val_edge_recon_loss: 118643.3125; val_gene_expr_recon_loss: 105245.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224252.5312; val_optim_loss: 224252.5312
702
<class 'int'>
702
<class 'int'>
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7741; val_auprc_score: 0.9376; val_best_acc_score: 0.8592; val_best_f1_score: 0.9231; train_kl_reg_loss: 358.1875; train_edge_recon_loss: 100396.1641; train_gene_expr_recon_loss: 105596.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206350.5625; train_optim_loss: 206350.5625; val_kl_reg_loss: 356.6441; val_edge_recon_loss: 123196.0547; val_gene_expr_recon_loss: 105057.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228610.2500; val_optim_loss: 228610.2500

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 3 sec.
Using best model state, which was in epoch 4.

--- MODEL EVALUATION ---
Val AUROC score: 0.7791
Val AUPRC score: 0.9398
Val best accuracy score: 0.8809
Val best F1 score: 0.9352
Val gene expr MSE score: 2.3296
Duration of model training in run 10: 0 hours, 0 minutes and 3 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
First script finished. Launching follow up script.
Run timestamp: 01062023_142847.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_5pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-attention_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-attention', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 5553
Number of validation edges: 617
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
702
<class 'int'>
702
<class 'int'>
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8686; val_auprc_score: 0.9662; val_best_acc_score: 0.8986; val_best_f1_score: 0.9433; train_kl_reg_loss: 50.5312; train_edge_recon_loss: 104785.4609; train_gene_expr_recon_loss: 157220.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262056.1562; train_optim_loss: 262056.1562; val_kl_reg_loss: 53.9692; val_edge_recon_loss: 100452.8594; val_gene_expr_recon_loss: 137413.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237920.3750; val_optim_loss: 237920.3750
702
<class 'int'>
702
<class 'int'>
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8901; val_auprc_score: 0.9747; val_best_acc_score: 0.9062; val_best_f1_score: 0.9475; train_kl_reg_loss: 54.7981; train_edge_recon_loss: 103033.4453; train_gene_expr_recon_loss: 137125.9844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240214.2188; train_optim_loss: 240214.2188; val_kl_reg_loss: 77.1386; val_edge_recon_loss: 105392.6797; val_gene_expr_recon_loss: 128607.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234077.4062; val_optim_loss: 234077.4062
702
<class 'int'>
702
<class 'int'>
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8766; val_auprc_score: 0.9625; val_best_acc_score: 0.8988; val_best_f1_score: 0.9437; train_kl_reg_loss: 78.2543; train_edge_recon_loss: 101359.4609; train_gene_expr_recon_loss: 128327.5156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229765.2344; train_optim_loss: 229765.2344; val_kl_reg_loss: 116.9646; val_edge_recon_loss: 113091.0391; val_gene_expr_recon_loss: 122349.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 235557.5469; val_optim_loss: 235557.5469
702
<class 'int'>
702
<class 'int'>
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8698; val_auprc_score: 0.9662; val_best_acc_score: 0.8884; val_best_f1_score: 0.9379; train_kl_reg_loss: 119.2471; train_edge_recon_loss: 104233.7891; train_gene_expr_recon_loss: 122051.1484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226404.1875; train_optim_loss: 226404.1875; val_kl_reg_loss: 170.6006; val_edge_recon_loss: 119073.1562; val_gene_expr_recon_loss: 117451.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 236695.5312; val_optim_loss: 236695.5312
702
<class 'int'>
702
<class 'int'>
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9205; val_auprc_score: 0.9850; val_best_acc_score: 0.9059; val_best_f1_score: 0.9469; train_kl_reg_loss: 172.7876; train_edge_recon_loss: 99765.7031; train_gene_expr_recon_loss: 117137.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217076.3750; train_optim_loss: 217076.3750; val_kl_reg_loss: 230.6663; val_edge_recon_loss: 116535.3438; val_gene_expr_recon_loss: 113639.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 230405.7500; val_optim_loss: 230405.7500
702
<class 'int'>
702
<class 'int'>
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8679; val_auprc_score: 0.9730; val_best_acc_score: 0.9083; val_best_f1_score: 0.9496; train_kl_reg_loss: 234.1077; train_edge_recon_loss: 103539.3047; train_gene_expr_recon_loss: 113294.4141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217067.8281; train_optim_loss: 217067.8281; val_kl_reg_loss: 282.2109; val_edge_recon_loss: 103494.6953; val_gene_expr_recon_loss: 110782.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214559.5000; val_optim_loss: 214559.5000
702
<class 'int'>
702
<class 'int'>
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8769; val_auprc_score: 0.9730; val_best_acc_score: 0.8871; val_best_f1_score: 0.9373; train_kl_reg_loss: 286.9437; train_edge_recon_loss: 98139.6875; train_gene_expr_recon_loss: 110403.9922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208830.6250; train_optim_loss: 208830.6250; val_kl_reg_loss: 314.8153; val_edge_recon_loss: 119729.7969; val_gene_expr_recon_loss: 108712.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228757.2188; val_optim_loss: 228757.2188
702
<class 'int'>
702
<class 'int'>
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8571; val_auprc_score: 0.9659; val_best_acc_score: 0.8830; val_best_f1_score: 0.9342; train_kl_reg_loss: 319.0325; train_edge_recon_loss: 103584.1641; train_gene_expr_recon_loss: 108309.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212213.0000; train_optim_loss: 212213.0000; val_kl_reg_loss: 321.5347; val_edge_recon_loss: 128107.0000; val_gene_expr_recon_loss: 107224.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 235653.4531; val_optim_loss: 235653.4531
702
<class 'int'>
702
<class 'int'>
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8669; val_auprc_score: 0.9725; val_best_acc_score: 0.8978; val_best_f1_score: 0.9440; train_kl_reg_loss: 326.4034; train_edge_recon_loss: 101357.3438; train_gene_expr_recon_loss: 106801.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208485.0312; train_optim_loss: 208485.0312; val_kl_reg_loss: 307.5122; val_edge_recon_loss: 107918.1719; val_gene_expr_recon_loss: 106143.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214369.1875; val_optim_loss: 214369.1875
702
<class 'int'>
702
<class 'int'>
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9036; val_auprc_score: 0.9750; val_best_acc_score: 0.9284; val_best_f1_score: 0.9601; train_kl_reg_loss: 313.5181; train_edge_recon_loss: 101000.3750; train_gene_expr_recon_loss: 105703.4844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207017.3750; train_optim_loss: 207017.3750; val_kl_reg_loss: 284.2961; val_edge_recon_loss: 104242.1250; val_gene_expr_recon_loss: 105354.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209881.2812; val_optim_loss: 209881.2812
702
<class 'int'>
702
<class 'int'>
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8787; val_auprc_score: 0.9720; val_best_acc_score: 0.9017; val_best_f1_score: 0.9445; train_kl_reg_loss: 290.8720; train_edge_recon_loss: 105785.3750; train_gene_expr_recon_loss: 104896.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210972.7188; train_optim_loss: 210972.7188; val_kl_reg_loss: 254.9276; val_edge_recon_loss: 113481.7891; val_gene_expr_recon_loss: 104782.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218519.5938; val_optim_loss: 218519.5938
702
<class 'int'>
702
<class 'int'>
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8734; val_auprc_score: 0.9625; val_best_acc_score: 0.9130; val_best_f1_score: 0.9519; train_kl_reg_loss: 259.4852; train_edge_recon_loss: 102053.7266; train_gene_expr_recon_loss: 104329.5234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206642.7344; train_optim_loss: 206642.7344; val_kl_reg_loss: 225.2325; val_edge_recon_loss: 103968.4375; val_gene_expr_recon_loss: 104367.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208561.4062; val_optim_loss: 208561.4062
702
<class 'int'>
702
<class 'int'>
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8531; val_auprc_score: 0.9540; val_best_acc_score: 0.8957; val_best_f1_score: 0.9412; train_kl_reg_loss: 229.9927; train_edge_recon_loss: 101895.0781; train_gene_expr_recon_loss: 103918.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206043.7188; train_optim_loss: 206043.7188; val_kl_reg_loss: 200.3164; val_edge_recon_loss: 118033.4922; val_gene_expr_recon_loss: 104062.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222296.2188; val_optim_loss: 222296.2188
702
<class 'int'>
702
<class 'int'>
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8566; val_auprc_score: 0.9696; val_best_acc_score: 0.9144; val_best_f1_score: 0.9521; train_kl_reg_loss: 204.5237; train_edge_recon_loss: 96024.0078; train_gene_expr_recon_loss: 103612.1328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199840.6562; train_optim_loss: 199840.6562; val_kl_reg_loss: 181.2751; val_edge_recon_loss: 100673.4531; val_gene_expr_recon_loss: 103829.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204684.6562; val_optim_loss: 204684.6562
702
<class 'int'>
702
<class 'int'>
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8428; val_auprc_score: 0.9460; val_best_acc_score: 0.9077; val_best_f1_score: 0.9479; train_kl_reg_loss: 184.6968; train_edge_recon_loss: 103346.6172; train_gene_expr_recon_loss: 103364.5469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206895.8594; train_optim_loss: 206895.8594; val_kl_reg_loss: 167.5487; val_edge_recon_loss: 111286.6953; val_gene_expr_recon_loss: 103646.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215100.6406; val_optim_loss: 215100.6406
702
<class 'int'>
702
<class 'int'>
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8390; val_auprc_score: 0.9545; val_best_acc_score: 0.9087; val_best_f1_score: 0.9487; train_kl_reg_loss: 169.7749; train_edge_recon_loss: 95847.4219; train_gene_expr_recon_loss: 103173.6719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199190.8750; train_optim_loss: 199190.8750; val_kl_reg_loss: 157.9970; val_edge_recon_loss: 106904.5938; val_gene_expr_recon_loss: 103492.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210555.5000; val_optim_loss: 210555.5000
702
<class 'int'>
702
<class 'int'>
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8417; val_auprc_score: 0.9594; val_best_acc_score: 0.9014; val_best_f1_score: 0.9447; train_kl_reg_loss: 161.8008; train_edge_recon_loss: 102195.0078; train_gene_expr_recon_loss: 103018.9453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205375.7500; train_optim_loss: 205375.7500; val_kl_reg_loss: 155.9556; val_edge_recon_loss: 104742.6797; val_gene_expr_recon_loss: 103359.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208258.3750; val_optim_loss: 208258.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

702
<class 'int'>
702
<class 'int'>
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8454; val_auprc_score: 0.9610; val_best_acc_score: 0.8982; val_best_f1_score: 0.9428; train_kl_reg_loss: 160.3578; train_edge_recon_loss: 100027.4609; train_gene_expr_recon_loss: 102869.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203057.0625; train_optim_loss: 203057.0625; val_kl_reg_loss: 157.1513; val_edge_recon_loss: 108405.7422; val_gene_expr_recon_loss: 103345.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211908.3438; val_optim_loss: 211908.3438
702
<class 'int'>
702
<class 'int'>
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8420; val_auprc_score: 0.9606; val_best_acc_score: 0.8989; val_best_f1_score: 0.9435; train_kl_reg_loss: 160.5406; train_edge_recon_loss: 100010.1875; train_gene_expr_recon_loss: 102854.8516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203025.5781; train_optim_loss: 203025.5781; val_kl_reg_loss: 156.9335; val_edge_recon_loss: 106526.9688; val_gene_expr_recon_loss: 103327.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210011.5625; val_optim_loss: 210011.5625
702
<class 'int'>
702
<class 'int'>
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8358; val_auprc_score: 0.9550; val_best_acc_score: 0.9030; val_best_f1_score: 0.9457; train_kl_reg_loss: 160.2886; train_edge_recon_loss: 100185.7656; train_gene_expr_recon_loss: 102826.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203172.1250; train_optim_loss: 203172.1250; val_kl_reg_loss: 157.9439; val_edge_recon_loss: 104636.5156; val_gene_expr_recon_loss: 103306.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208101.2500; val_optim_loss: 208101.2500

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 7 sec.
Using best model state, which was in epoch 14.

--- MODEL EVALUATION ---
Val AUROC score: 0.7830
Val AUPRC score: 0.9479
Val best accuracy score: 0.8959
Val best F1 score: 0.9425
Val gene expr MSE score: 1.5377
Duration of model training in run 1: 0 hours, 0 minutes and 10 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 5553
Number of validation edges: 617
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
702
<class 'int'>
702
<class 'int'>
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9166; val_auprc_score: 0.9811; val_best_acc_score: 0.8955; val_best_f1_score: 0.9390; train_kl_reg_loss: 57.8053; train_edge_recon_loss: 102504.2266; train_gene_expr_recon_loss: 157797.4219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260359.4531; train_optim_loss: 260359.4531; val_kl_reg_loss: 58.7026; val_edge_recon_loss: 124102.1406; val_gene_expr_recon_loss: 136813.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260974.7031; val_optim_loss: 260974.7031
702
<class 'int'>
702
<class 'int'>
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8707; val_auprc_score: 0.9556; val_best_acc_score: 0.8799; val_best_f1_score: 0.9317; train_kl_reg_loss: 60.2169; train_edge_recon_loss: 104272.5391; train_gene_expr_recon_loss: 137840.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242172.8438; train_optim_loss: 242172.8438; val_kl_reg_loss: 79.6976; val_edge_recon_loss: 130538.1172; val_gene_expr_recon_loss: 127627.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258245.7969; val_optim_loss: 258245.7969
702
<class 'int'>
702
<class 'int'>
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8772; val_auprc_score: 0.9576; val_best_acc_score: 0.9086; val_best_f1_score: 0.9478; train_kl_reg_loss: 81.1795; train_edge_recon_loss: 99752.9844; train_gene_expr_recon_loss: 128515.5156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228349.6875; train_optim_loss: 228349.6875; val_kl_reg_loss: 118.4233; val_edge_recon_loss: 114448.8906; val_gene_expr_recon_loss: 121171.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 235739.1719; val_optim_loss: 235739.1719
702
<class 'int'>
702
<class 'int'>
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8924; val_auprc_score: 0.9701; val_best_acc_score: 0.9040; val_best_f1_score: 0.9460; train_kl_reg_loss: 120.5867; train_edge_recon_loss: 101792.5547; train_gene_expr_recon_loss: 121899.6094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 223812.7500; train_optim_loss: 223812.7500; val_kl_reg_loss: 173.9595; val_edge_recon_loss: 102222.5703; val_gene_expr_recon_loss: 116214.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218611.3125; val_optim_loss: 218611.3125
702
<class 'int'>
702
<class 'int'>
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8683; val_auprc_score: 0.9699; val_best_acc_score: 0.8939; val_best_f1_score: 0.9412; train_kl_reg_loss: 177.8241; train_edge_recon_loss: 103637.8594; train_gene_expr_recon_loss: 116846.0703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220661.7500; train_optim_loss: 220661.7500; val_kl_reg_loss: 241.1645; val_edge_recon_loss: 110435.7500; val_gene_expr_recon_loss: 112547.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 223224.6875; val_optim_loss: 223224.6875
702
<class 'int'>
702
<class 'int'>
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8352; val_auprc_score: 0.9677; val_best_acc_score: 0.8960; val_best_f1_score: 0.9438; train_kl_reg_loss: 243.9805; train_edge_recon_loss: 100422.8125; train_gene_expr_recon_loss: 113066.3906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213733.1875; train_optim_loss: 213733.1875; val_kl_reg_loss: 284.5454; val_edge_recon_loss: 97004.4844; val_gene_expr_recon_loss: 109943.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207232.6250; val_optim_loss: 207232.6250
702
<class 'int'>
702
<class 'int'>
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8691; val_auprc_score: 0.9704; val_best_acc_score: 0.8798; val_best_f1_score: 0.9334; train_kl_reg_loss: 289.0530; train_edge_recon_loss: 100186.9766; train_gene_expr_recon_loss: 110403.5703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210879.5938; train_optim_loss: 210879.5938; val_kl_reg_loss: 298.2318; val_edge_recon_loss: 118121.6016; val_gene_expr_recon_loss: 107981.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 226401.2188; val_optim_loss: 226401.2188
702
<class 'int'>
702
<class 'int'>
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8550; val_auprc_score: 0.9668; val_best_acc_score: 0.8855; val_best_f1_score: 0.9360; train_kl_reg_loss: 303.9090; train_edge_recon_loss: 101161.8125; train_gene_expr_recon_loss: 108371.4531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209837.1719; train_optim_loss: 209837.1719; val_kl_reg_loss: 284.6831; val_edge_recon_loss: 118753.9609; val_gene_expr_recon_loss: 106431.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 225470.5781; val_optim_loss: 225470.5781
702
<class 'int'>
702
<class 'int'>
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8637; val_auprc_score: 0.9633; val_best_acc_score: 0.9034; val_best_f1_score: 0.9451; train_kl_reg_loss: 291.1471; train_edge_recon_loss: 103585.4922; train_gene_expr_recon_loss: 106785.0391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210661.6875; train_optim_loss: 210661.6875; val_kl_reg_loss: 259.8370; val_edge_recon_loss: 107539.1953; val_gene_expr_recon_loss: 105267.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213066.0938; val_optim_loss: 213066.0938

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

702
<class 'int'>
702
<class 'int'>
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8982; val_auprc_score: 0.9815; val_best_acc_score: 0.9058; val_best_f1_score: 0.9479; train_kl_reg_loss: 264.9661; train_edge_recon_loss: 99160.7188; train_gene_expr_recon_loss: 105591.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205017.1875; train_optim_loss: 205017.1875; val_kl_reg_loss: 257.2142; val_edge_recon_loss: 104429.5000; val_gene_expr_recon_loss: 105169.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209856.1562; val_optim_loss: 209856.1562
702
<class 'int'>
702
<class 'int'>
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8749; val_auprc_score: 0.9648; val_best_acc_score: 0.8932; val_best_f1_score: 0.9379; train_kl_reg_loss: 261.8325; train_edge_recon_loss: 100965.2578; train_gene_expr_recon_loss: 105499.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206726.8125; train_optim_loss: 206726.8125; val_kl_reg_loss: 252.4214; val_edge_recon_loss: 122154.4141; val_gene_expr_recon_loss: 105073.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227479.9531; val_optim_loss: 227479.9531
702
<class 'int'>
702
<class 'int'>
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8898; val_auprc_score: 0.9746; val_best_acc_score: 0.8854; val_best_f1_score: 0.9356; train_kl_reg_loss: 257.3266; train_edge_recon_loss: 105093.3516; train_gene_expr_recon_loss: 105403.6094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210754.2812; train_optim_loss: 210754.2812; val_kl_reg_loss: 249.6905; val_edge_recon_loss: 124971.7578; val_gene_expr_recon_loss: 104978.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 230199.8594; val_optim_loss: 230199.8594

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 3 sec.
Using best model state, which was in epoch 6.

--- MODEL EVALUATION ---
Val AUROC score: 0.8694
Val AUPRC score: 0.9612
Val best accuracy score: 0.9045
Val best F1 score: 0.9474
Val gene expr MSE score: 2.0767
Duration of model training in run 2: 0 hours, 0 minutes and 4 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 10975
Number of validation edges: 1219
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9246; val_auprc_score: 0.9801; val_best_acc_score: 0.9168; val_best_f1_score: 0.9527; train_kl_reg_loss: 60.2301; train_edge_recon_loss: 101249.5234; train_gene_expr_recon_loss: 143071.9453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 244381.7031; train_optim_loss: 244381.7031; val_kl_reg_loss: 79.7619; val_edge_recon_loss: 115191.8203; val_gene_expr_recon_loss: 131700.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246972.0625; val_optim_loss: 246972.0625
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9338; val_auprc_score: 0.9845; val_best_acc_score: 0.9211; val_best_f1_score: 0.9546; train_kl_reg_loss: 97.9641; train_edge_recon_loss: 101072.3555; train_gene_expr_recon_loss: 121112.5430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 222282.8594; train_optim_loss: 222282.8594; val_kl_reg_loss: 158.0112; val_edge_recon_loss: 99808.4609; val_gene_expr_recon_loss: 120217.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220183.8438; val_optim_loss: 220183.8438
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9221; val_auprc_score: 0.9827; val_best_acc_score: 0.9051; val_best_f1_score: 0.9463; train_kl_reg_loss: 186.1277; train_edge_recon_loss: 96695.7305; train_gene_expr_recon_loss: 112564.7227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209446.5781; train_optim_loss: 209446.5781; val_kl_reg_loss: 255.4377; val_edge_recon_loss: 114695.4922; val_gene_expr_recon_loss: 113546.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228497.1406; val_optim_loss: 228497.1406
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9196; val_auprc_score: 0.9774; val_best_acc_score: 0.9066; val_best_f1_score: 0.9463; train_kl_reg_loss: 269.6306; train_edge_recon_loss: 97639.0469; train_gene_expr_recon_loss: 107533.6055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205442.2812; train_optim_loss: 205442.2812; val_kl_reg_loss: 277.1112; val_edge_recon_loss: 119553.9453; val_gene_expr_recon_loss: 109905.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229736.6719; val_optim_loss: 229736.6719
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9231; val_auprc_score: 0.9837; val_best_acc_score: 0.9118; val_best_f1_score: 0.9482; train_kl_reg_loss: 274.7787; train_edge_recon_loss: 100761.1602; train_gene_expr_recon_loss: 104098.2969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205134.2422; train_optim_loss: 205134.2422; val_kl_reg_loss: 238.5775; val_edge_recon_loss: 115874.3594; val_gene_expr_recon_loss: 107959.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224072.6875; val_optim_loss: 224072.6875
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9060; val_auprc_score: 0.9771; val_best_acc_score: 0.8995; val_best_f1_score: 0.9419; train_kl_reg_loss: 228.1502; train_edge_recon_loss: 99940.2930; train_gene_expr_recon_loss: 101470.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201638.5703; train_optim_loss: 201638.5703; val_kl_reg_loss: 186.6391; val_edge_recon_loss: 116282.2734; val_gene_expr_recon_loss: 106953.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 223422.9062; val_optim_loss: 223422.9062

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9071; val_auprc_score: 0.9797; val_best_acc_score: 0.9066; val_best_f1_score: 0.9460; train_kl_reg_loss: 190.3524; train_edge_recon_loss: 100294.8281; train_gene_expr_recon_loss: 101930.7695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202415.9531; train_optim_loss: 202415.9531; val_kl_reg_loss: 181.4387; val_edge_recon_loss: 111129.2422; val_gene_expr_recon_loss: 106880.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218190.8750; val_optim_loss: 218190.8750
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9074; val_auprc_score: 0.9811; val_best_acc_score: 0.9022; val_best_f1_score: 0.9455; train_kl_reg_loss: 186.8635; train_edge_recon_loss: 99041.4258; train_gene_expr_recon_loss: 101945.3789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201173.6719; train_optim_loss: 201173.6719; val_kl_reg_loss: 176.9665; val_edge_recon_loss: 105390.3750; val_gene_expr_recon_loss: 106798.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 212366.1250; val_optim_loss: 212366.1250
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8988; val_auprc_score: 0.9727; val_best_acc_score: 0.9015; val_best_f1_score: 0.9421; train_kl_reg_loss: 179.7595; train_edge_recon_loss: 103948.0508; train_gene_expr_recon_loss: 101340.7266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205468.5391; train_optim_loss: 205468.5391; val_kl_reg_loss: 172.1392; val_edge_recon_loss: 118578.3438; val_gene_expr_recon_loss: 106712.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 225462.5625; val_optim_loss: 225462.5625
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9008; val_auprc_score: 0.9765; val_best_acc_score: 0.8983; val_best_f1_score: 0.9405; train_kl_reg_loss: 174.8259; train_edge_recon_loss: 103791.6055; train_gene_expr_recon_loss: 101183.3203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205149.7500; train_optim_loss: 205149.7500; val_kl_reg_loss: 166.7045; val_edge_recon_loss: 116283.6641; val_gene_expr_recon_loss: 106623.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 223073.4688; val_optim_loss: 223073.4688
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8844; val_auprc_score: 0.9661; val_best_acc_score: 0.8919; val_best_f1_score: 0.9382; train_kl_reg_loss: 167.0492; train_edge_recon_loss: 99924.8164; train_gene_expr_recon_loss: 100253.5391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200345.3984; train_optim_loss: 200345.3984; val_kl_reg_loss: 161.3049; val_edge_recon_loss: 115115.4375; val_gene_expr_recon_loss: 106533.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221810.0469; val_optim_loss: 221810.0469

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9160; val_auprc_score: 0.9793; val_best_acc_score: 0.9058; val_best_f1_score: 0.9458; train_kl_reg_loss: 164.6085; train_edge_recon_loss: 101052.3867; train_gene_expr_recon_loss: 100374.9297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201591.9297; train_optim_loss: 201591.9297; val_kl_reg_loss: 160.9088; val_edge_recon_loss: 114947.0469; val_gene_expr_recon_loss: 106524.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221632.0938; val_optim_loss: 221632.0938
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9019; val_auprc_score: 0.9770; val_best_acc_score: 0.9117; val_best_f1_score: 0.9500; train_kl_reg_loss: 164.8994; train_edge_recon_loss: 98590.6758; train_gene_expr_recon_loss: 102066.9609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200822.5312; train_optim_loss: 200822.5312; val_kl_reg_loss: 160.9185; val_edge_recon_loss: 100735.8516; val_gene_expr_recon_loss: 106514.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207411.4531; val_optim_loss: 207411.4531
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8992; val_auprc_score: 0.9784; val_best_acc_score: 0.8999; val_best_f1_score: 0.9427; train_kl_reg_loss: 166.2713; train_edge_recon_loss: 103935.1445; train_gene_expr_recon_loss: 102128.2266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206229.6406; train_optim_loss: 206229.6406; val_kl_reg_loss: 160.8214; val_edge_recon_loss: 112332.4141; val_gene_expr_recon_loss: 106504.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218998.2188; val_optim_loss: 218998.2188
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8994; val_auprc_score: 0.9721; val_best_acc_score: 0.9043; val_best_f1_score: 0.9450; train_kl_reg_loss: 163.2269; train_edge_recon_loss: 101982.8398; train_gene_expr_recon_loss: 101001.6914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203147.7578; train_optim_loss: 203147.7578; val_kl_reg_loss: 159.9788; val_edge_recon_loss: 113652.5547; val_gene_expr_recon_loss: 106495.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220307.6406; val_optim_loss: 220307.6406
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9043; val_auprc_score: 0.9767; val_best_acc_score: 0.9016; val_best_f1_score: 0.9444; train_kl_reg_loss: 164.7735; train_edge_recon_loss: 98329.6602; train_gene_expr_recon_loss: 100992.3828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199486.8203; train_optim_loss: 199486.8203; val_kl_reg_loss: 158.9949; val_edge_recon_loss: 105509.5859; val_gene_expr_recon_loss: 106485.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 212153.7188; val_optim_loss: 212153.7188

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9125; val_auprc_score: 0.9795; val_best_acc_score: 0.9065; val_best_f1_score: 0.9461; train_kl_reg_loss: 161.2620; train_edge_recon_loss: 101494.4258; train_gene_expr_recon_loss: 99295.5469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200951.2344; train_optim_loss: 200951.2344; val_kl_reg_loss: 159.9768; val_edge_recon_loss: 114373.3359; val_gene_expr_recon_loss: 106484.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221017.4375; val_optim_loss: 221017.4375
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9032; val_auprc_score: 0.9755; val_best_acc_score: 0.9021; val_best_f1_score: 0.9446; train_kl_reg_loss: 162.3174; train_edge_recon_loss: 102284.5039; train_gene_expr_recon_loss: 99947.0703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202393.8906; train_optim_loss: 202393.8906; val_kl_reg_loss: 160.0748; val_edge_recon_loss: 104303.9062; val_gene_expr_recon_loss: 106483.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210947.0938; val_optim_loss: 210947.0938
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9101; val_auprc_score: 0.9787; val_best_acc_score: 0.9079; val_best_f1_score: 0.9469; train_kl_reg_loss: 162.9190; train_edge_recon_loss: 103927.2188; train_gene_expr_recon_loss: 100088.2656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204178.3984; train_optim_loss: 204178.3984; val_kl_reg_loss: 158.9602; val_edge_recon_loss: 114707.3984; val_gene_expr_recon_loss: 106482.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221348.4062; val_optim_loss: 221348.4062

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 8 sec.
Using best model state, which was in epoch 13.

--- MODEL EVALUATION ---
Val AUROC score: 0.9169
Val AUPRC score: 0.9829
Val best accuracy score: 0.9138
Val best F1 score: 0.9507
Val gene expr MSE score: 1.8426
Duration of model training in run 3: 0 hours, 0 minutes and 9 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 10975
Number of validation edges: 1219
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9342; val_auprc_score: 0.9779; val_best_acc_score: 0.9353; val_best_f1_score: 0.9626; train_kl_reg_loss: 59.0351; train_edge_recon_loss: 101810.8906; train_gene_expr_recon_loss: 141564.8828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 243434.8047; train_optim_loss: 243434.8047; val_kl_reg_loss: 79.6176; val_edge_recon_loss: 112125.5938; val_gene_expr_recon_loss: 128600.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240805.4531; val_optim_loss: 240805.4531
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9401; val_auprc_score: 0.9833; val_best_acc_score: 0.9299; val_best_f1_score: 0.9592; train_kl_reg_loss: 99.9711; train_edge_recon_loss: 104899.7461; train_gene_expr_recon_loss: 123631.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228631.5312; train_optim_loss: 228631.5312; val_kl_reg_loss: 163.8273; val_edge_recon_loss: 122295.7656; val_gene_expr_recon_loss: 117338.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 239798.5625; val_optim_loss: 239798.5625
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9252; val_auprc_score: 0.9763; val_best_acc_score: 0.9083; val_best_f1_score: 0.9485; train_kl_reg_loss: 193.6519; train_edge_recon_loss: 100132.3594; train_gene_expr_recon_loss: 113004.7031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213330.7109; train_optim_loss: 213330.7109; val_kl_reg_loss: 261.7113; val_edge_recon_loss: 117408.9219; val_gene_expr_recon_loss: 110604.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228275.0000; val_optim_loss: 228275.0000
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9377; val_auprc_score: 0.9872; val_best_acc_score: 0.9137; val_best_f1_score: 0.9512; train_kl_reg_loss: 275.4016; train_edge_recon_loss: 98875.7539; train_gene_expr_recon_loss: 107561.5742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206712.7266; train_optim_loss: 206712.7266; val_kl_reg_loss: 282.5051; val_edge_recon_loss: 115625.4062; val_gene_expr_recon_loss: 106902.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222810.0000; val_optim_loss: 222810.0000
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9182; val_auprc_score: 0.9805; val_best_acc_score: 0.9130; val_best_f1_score: 0.9500; train_kl_reg_loss: 279.3422; train_edge_recon_loss: 101205.8164; train_gene_expr_recon_loss: 102741.8477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204227.0078; train_optim_loss: 204227.0078; val_kl_reg_loss: 254.8257; val_edge_recon_loss: 109640.2266; val_gene_expr_recon_loss: 104888.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214783.5938; val_optim_loss: 214783.5938
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9067; val_auprc_score: 0.9747; val_best_acc_score: 0.9053; val_best_f1_score: 0.9455; train_kl_reg_loss: 247.2446; train_edge_recon_loss: 105477.2383; train_gene_expr_recon_loss: 103473.6992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209198.1875; train_optim_loss: 209198.1875; val_kl_reg_loss: 211.3337; val_edge_recon_loss: 123840.6094; val_gene_expr_recon_loss: 103817.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227869.3281; val_optim_loss: 227869.3281
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9006; val_auprc_score: 0.9742; val_best_acc_score: 0.9037; val_best_f1_score: 0.9454; train_kl_reg_loss: 201.6833; train_edge_recon_loss: 103805.9453; train_gene_expr_recon_loss: 99628.1445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203635.7812; train_optim_loss: 203635.7812; val_kl_reg_loss: 175.7030; val_edge_recon_loss: 110414.1875; val_gene_expr_recon_loss: 103243.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213833.4688; val_optim_loss: 213833.4688
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8978; val_auprc_score: 0.9680; val_best_acc_score: 0.9094; val_best_f1_score: 0.9480; train_kl_reg_loss: 171.5867; train_edge_recon_loss: 104548.5000; train_gene_expr_recon_loss: 100561.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205281.8047; train_optim_loss: 205281.8047; val_kl_reg_loss: 152.3493; val_edge_recon_loss: 118065.3906; val_gene_expr_recon_loss: 102893.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221110.8750; val_optim_loss: 221110.8750
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8950; val_auprc_score: 0.9745; val_best_acc_score: 0.9200; val_best_f1_score: 0.9546; train_kl_reg_loss: 149.2452; train_edge_recon_loss: 100618.7109; train_gene_expr_recon_loss: 99708.4180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200476.3750; train_optim_loss: 200476.3750; val_kl_reg_loss: 142.3907; val_edge_recon_loss: 105560.6641; val_gene_expr_recon_loss: 102642.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208345.0938; val_optim_loss: 208345.0938
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8616; val_auprc_score: 0.9673; val_best_acc_score: 0.9063; val_best_f1_score: 0.9469; train_kl_reg_loss: 141.4493; train_edge_recon_loss: 101073.8984; train_gene_expr_recon_loss: 99815.4570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201030.8125; train_optim_loss: 201030.8125; val_kl_reg_loss: 146.9762; val_edge_recon_loss: 102946.5234; val_gene_expr_recon_loss: 102436.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205530.0625; val_optim_loss: 205530.0625
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8769; val_auprc_score: 0.9692; val_best_acc_score: 0.9153; val_best_f1_score: 0.9511; train_kl_reg_loss: 151.6530; train_edge_recon_loss: 99453.8125; train_gene_expr_recon_loss: 99812.5156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199417.9766; train_optim_loss: 199417.9766; val_kl_reg_loss: 163.6054; val_edge_recon_loss: 102543.8906; val_gene_expr_recon_loss: 102239.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204946.7656; val_optim_loss: 204946.7656
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8778; val_auprc_score: 0.9643; val_best_acc_score: 0.9037; val_best_f1_score: 0.9448; train_kl_reg_loss: 170.2944; train_edge_recon_loss: 101261.3398; train_gene_expr_recon_loss: 99978.6836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201410.3125; train_optim_loss: 201410.3125; val_kl_reg_loss: 188.3485; val_edge_recon_loss: 106274.9531; val_gene_expr_recon_loss: 102011.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208474.8438; val_optim_loss: 208474.8438
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8588; val_auprc_score: 0.9688; val_best_acc_score: 0.8929; val_best_f1_score: 0.9402; train_kl_reg_loss: 195.9620; train_edge_recon_loss: 99018.3594; train_gene_expr_recon_loss: 99636.8555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198851.1797; train_optim_loss: 198851.1797; val_kl_reg_loss: 230.9721; val_edge_recon_loss: 101372.9141; val_gene_expr_recon_loss: 101764.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 203368.0312; val_optim_loss: 203368.0312
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8537; val_auprc_score: 0.9642; val_best_acc_score: 0.9015; val_best_f1_score: 0.9447; train_kl_reg_loss: 240.8356; train_edge_recon_loss: 101506.6680; train_gene_expr_recon_loss: 99169.0547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200916.5625; train_optim_loss: 200916.5625; val_kl_reg_loss: 296.1882; val_edge_recon_loss: 96967.7188; val_gene_expr_recon_loss: 101513.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198777.7344; val_optim_loss: 198777.7344
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8431; val_auprc_score: 0.9558; val_best_acc_score: 0.8978; val_best_f1_score: 0.9430; train_kl_reg_loss: 319.1078; train_edge_recon_loss: 99631.1328; train_gene_expr_recon_loss: 97590.5391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197540.7812; train_optim_loss: 197540.7812; val_kl_reg_loss: 390.8442; val_edge_recon_loss: 94339.9531; val_gene_expr_recon_loss: 101263.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195994.1875; val_optim_loss: 195994.1875
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8081; val_auprc_score: 0.9539; val_best_acc_score: 0.8897; val_best_f1_score: 0.9384; train_kl_reg_loss: 418.9844; train_edge_recon_loss: 99225.8242; train_gene_expr_recon_loss: 99063.7461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198708.5547; train_optim_loss: 198708.5547; val_kl_reg_loss: 507.3546; val_edge_recon_loss: 94560.1328; val_gene_expr_recon_loss: 101005.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196073.0938; val_optim_loss: 196073.0938
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8361; val_auprc_score: 0.9627; val_best_acc_score: 0.8931; val_best_f1_score: 0.9402; train_kl_reg_loss: 534.9886; train_edge_recon_loss: 94225.8086; train_gene_expr_recon_loss: 98296.9453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193057.7422; train_optim_loss: 193057.7422; val_kl_reg_loss: 680.2278; val_edge_recon_loss: 93091.0469; val_gene_expr_recon_loss: 100752.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194523.5938; val_optim_loss: 194523.5938
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8357; val_auprc_score: 0.9589; val_best_acc_score: 0.8939; val_best_f1_score: 0.9410; train_kl_reg_loss: 740.9496; train_edge_recon_loss: 92328.2734; train_gene_expr_recon_loss: 98572.4531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191641.6797; train_optim_loss: 191641.6797; val_kl_reg_loss: 917.1457; val_edge_recon_loss: 91130.8984; val_gene_expr_recon_loss: 100511.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192559.9844; val_optim_loss: 192559.9844
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8483; val_auprc_score: 0.9580; val_best_acc_score: 0.8918; val_best_f1_score: 0.9376; train_kl_reg_loss: 985.2144; train_edge_recon_loss: 93985.5859; train_gene_expr_recon_loss: 98552.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193522.8672; train_optim_loss: 193522.8672; val_kl_reg_loss: 1209.4706; val_edge_recon_loss: 96095.3750; val_gene_expr_recon_loss: 100305.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197610.5938; val_optim_loss: 197610.5938
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8444; val_auprc_score: 0.9640; val_best_acc_score: 0.8937; val_best_f1_score: 0.9402; train_kl_reg_loss: 1306.3214; train_edge_recon_loss: 91800.7031; train_gene_expr_recon_loss: 97971.4453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191078.4688; train_optim_loss: 191078.4688; val_kl_reg_loss: 1533.4478; val_edge_recon_loss: 93638.9297; val_gene_expr_recon_loss: 100128.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195301.3125; val_optim_loss: 195301.3125
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8437; val_auprc_score: 0.9611; val_best_acc_score: 0.8954; val_best_f1_score: 0.9413; train_kl_reg_loss: 1614.7972; train_edge_recon_loss: 89319.0508; train_gene_expr_recon_loss: 96211.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187145.3828; train_optim_loss: 187145.3828; val_kl_reg_loss: 1764.3552; val_edge_recon_loss: 86672.7344; val_gene_expr_recon_loss: 99919.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188356.8125; val_optim_loss: 188356.8125
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8497; val_auprc_score: 0.9634; val_best_acc_score: 0.8873; val_best_f1_score: 0.9361; train_kl_reg_loss: 1848.0727; train_edge_recon_loss: 87155.9531; train_gene_expr_recon_loss: 98025.2344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187029.2656; train_optim_loss: 187029.2656; val_kl_reg_loss: 1974.9807; val_edge_recon_loss: 92593.3281; val_gene_expr_recon_loss: 99877.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194445.4688; val_optim_loss: 194445.4688
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8451; val_auprc_score: 0.9643; val_best_acc_score: 0.8954; val_best_f1_score: 0.9420; train_kl_reg_loss: 2044.3989; train_edge_recon_loss: 84489.7773; train_gene_expr_recon_loss: 97057.9297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183592.1094; train_optim_loss: 183592.1094; val_kl_reg_loss: 2135.8877; val_edge_recon_loss: 85024.0469; val_gene_expr_recon_loss: 99657.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186817.7812; val_optim_loss: 186817.7812
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8704; val_auprc_score: 0.9733; val_best_acc_score: 0.9024; val_best_f1_score: 0.9458; train_kl_reg_loss: 2201.0808; train_edge_recon_loss: 81419.4375; train_gene_expr_recon_loss: 97059.8594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180680.3750; train_optim_loss: 180680.3750; val_kl_reg_loss: 2212.3899; val_edge_recon_loss: 75906.3359; val_gene_expr_recon_loss: 99518.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177636.8125; val_optim_loss: 177636.8125
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8954; val_auprc_score: 0.9703; val_best_acc_score: 0.9009; val_best_f1_score: 0.9426; train_kl_reg_loss: 2256.2720; train_edge_recon_loss: 79994.9297; train_gene_expr_recon_loss: 97280.9023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179532.1016; train_optim_loss: 179532.1016; val_kl_reg_loss: 2223.8604; val_edge_recon_loss: 91272.7344; val_gene_expr_recon_loss: 99449.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192946.1562; val_optim_loss: 192946.1562
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8810; val_auprc_score: 0.9730; val_best_acc_score: 0.9028; val_best_f1_score: 0.9451; train_kl_reg_loss: 2268.3331; train_edge_recon_loss: 81626.3633; train_gene_expr_recon_loss: 97259.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181154.2031; train_optim_loss: 181154.2031; val_kl_reg_loss: 2211.0342; val_edge_recon_loss: 83361.8984; val_gene_expr_recon_loss: 99295.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184868.0156; val_optim_loss: 184868.0156
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8968; val_auprc_score: 0.9790; val_best_acc_score: 0.9054; val_best_f1_score: 0.9467; train_kl_reg_loss: 2250.3634; train_edge_recon_loss: 81014.9688; train_gene_expr_recon_loss: 96269.8203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179535.1484; train_optim_loss: 179535.1484; val_kl_reg_loss: 2181.9890; val_edge_recon_loss: 77982.9297; val_gene_expr_recon_loss: 99131.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179296.3750; val_optim_loss: 179296.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8871; val_auprc_score: 0.9726; val_best_acc_score: 0.9014; val_best_f1_score: 0.9434; train_kl_reg_loss: 2223.4670; train_edge_recon_loss: 80463.5195; train_gene_expr_recon_loss: 97158.4688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179845.4531; train_optim_loss: 179845.4531; val_kl_reg_loss: 2177.7756; val_edge_recon_loss: 86135.3672; val_gene_expr_recon_loss: 99110.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187424.0000; val_optim_loss: 187424.0000
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8959; val_auprc_score: 0.9738; val_best_acc_score: 0.9045; val_best_f1_score: 0.9451; train_kl_reg_loss: 2221.1433; train_edge_recon_loss: 81897.8594; train_gene_expr_recon_loss: 96245.7266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180364.7266; train_optim_loss: 180364.7266; val_kl_reg_loss: 2159.7087; val_edge_recon_loss: 85883.5234; val_gene_expr_recon_loss: 99079.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187122.5938; val_optim_loss: 187122.5938
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8671; val_auprc_score: 0.9653; val_best_acc_score: 0.9097; val_best_f1_score: 0.9488; train_kl_reg_loss: 2187.8551; train_edge_recon_loss: 81740.3750; train_gene_expr_recon_loss: 95840.8633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179769.0938; train_optim_loss: 179769.0938; val_kl_reg_loss: 2152.8750; val_edge_recon_loss: 82011.1094; val_gene_expr_recon_loss: 99046.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183210.4844; val_optim_loss: 183210.4844

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 13 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.8704
Val AUPRC score: 0.9718
Val best accuracy score: 0.8931
Val best F1 score: 0.9394
Val gene expr MSE score: 1.3057
Duration of model training in run 4: 0 hours, 0 minutes and 14 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 16450
Number of validation edges: 1827
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9434; val_auprc_score: 0.9849; val_best_acc_score: 0.9226; val_best_f1_score: 0.9565; train_kl_reg_loss: 63.7550; train_edge_recon_loss: 122520.0208; train_gene_expr_recon_loss: 143024.1120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265607.8854; train_optim_loss: 265607.8854; val_kl_reg_loss: 94.5781; val_edge_recon_loss: 113503.6953; val_gene_expr_recon_loss: 120584.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234183.0938; val_optim_loss: 234183.0938
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9369; val_auprc_score: 0.9840; val_best_acc_score: 0.9186; val_best_f1_score: 0.9548; train_kl_reg_loss: 136.7966; train_edge_recon_loss: 93795.6120; train_gene_expr_recon_loss: 117456.3984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211388.8021; train_optim_loss: 211388.8021; val_kl_reg_loss: 221.1194; val_edge_recon_loss: 108895.2344; val_gene_expr_recon_loss: 108780.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217897.2031; val_optim_loss: 217897.2031
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9312; val_auprc_score: 0.9778; val_best_acc_score: 0.8937; val_best_f1_score: 0.9407; train_kl_reg_loss: 280.4271; train_edge_recon_loss: 100759.2161; train_gene_expr_recon_loss: 107649.6068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208689.2552; train_optim_loss: 208689.2552; val_kl_reg_loss: 348.8164; val_edge_recon_loss: 124905.8203; val_gene_expr_recon_loss: 103152.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228407.1875; val_optim_loss: 228407.1875
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9318; val_auprc_score: 0.9763; val_best_acc_score: 0.9076; val_best_f1_score: 0.9481; train_kl_reg_loss: 377.6712; train_edge_recon_loss: 102802.3385; train_gene_expr_recon_loss: 103698.5521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206878.5677; train_optim_loss: 206878.5677; val_kl_reg_loss: 375.0228; val_edge_recon_loss: 121399.3828; val_gene_expr_recon_loss: 100788.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222563.2812; val_optim_loss: 222563.2812
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9124; val_auprc_score: 0.9755; val_best_acc_score: 0.9082; val_best_f1_score: 0.9481; train_kl_reg_loss: 368.7023; train_edge_recon_loss: 94915.1875; train_gene_expr_recon_loss: 101323.3724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196607.2604; train_optim_loss: 196607.2604; val_kl_reg_loss: 337.3389; val_edge_recon_loss: 115230.1406; val_gene_expr_recon_loss: 99639.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215207.2344; val_optim_loss: 215207.2344
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9193; val_auprc_score: 0.9754; val_best_acc_score: 0.9105; val_best_f1_score: 0.9495; train_kl_reg_loss: 321.3754; train_edge_recon_loss: 105665.8984; train_gene_expr_recon_loss: 100548.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206535.5260; train_optim_loss: 206535.5260; val_kl_reg_loss: 268.2817; val_edge_recon_loss: 116995.0469; val_gene_expr_recon_loss: 98988.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216251.8750; val_optim_loss: 216251.8750
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9128; val_auprc_score: 0.9770; val_best_acc_score: 0.9126; val_best_f1_score: 0.9497; train_kl_reg_loss: 248.6745; train_edge_recon_loss: 118212.2969; train_gene_expr_recon_loss: 100189.0234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 218649.9948; train_optim_loss: 218649.9948; val_kl_reg_loss: 206.3864; val_edge_recon_loss: 117313.9453; val_gene_expr_recon_loss: 98558.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216078.5781; val_optim_loss: 216078.5781
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9115; val_auprc_score: 0.9764; val_best_acc_score: 0.9015; val_best_f1_score: 0.9432; train_kl_reg_loss: 195.0091; train_edge_recon_loss: 97776.3724; train_gene_expr_recon_loss: 99582.1953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197553.5729; train_optim_loss: 197553.5729; val_kl_reg_loss: 165.6134; val_edge_recon_loss: 119812.9297; val_gene_expr_recon_loss: 98210.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218189.5000; val_optim_loss: 218189.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9102; val_auprc_score: 0.9774; val_best_acc_score: 0.9146; val_best_f1_score: 0.9519; train_kl_reg_loss: 168.5649; train_edge_recon_loss: 102709.8125; train_gene_expr_recon_loss: 99120.7578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201999.1354; train_optim_loss: 201999.1354; val_kl_reg_loss: 163.1464; val_edge_recon_loss: 112806.8594; val_gene_expr_recon_loss: 98169.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211139.8906; val_optim_loss: 211139.8906
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9064; val_auprc_score: 0.9759; val_best_acc_score: 0.9154; val_best_f1_score: 0.9528; train_kl_reg_loss: 165.0214; train_edge_recon_loss: 102195.4271; train_gene_expr_recon_loss: 99384.3516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201744.8021; train_optim_loss: 201744.8021; val_kl_reg_loss: 160.0870; val_edge_recon_loss: 104755.0469; val_gene_expr_recon_loss: 98115.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 203030.9844; val_optim_loss: 203030.9844
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9297; val_auprc_score: 0.9843; val_best_acc_score: 0.9120; val_best_f1_score: 0.9501; train_kl_reg_loss: 163.0271; train_edge_recon_loss: 96568.1719; train_gene_expr_recon_loss: 99556.9010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196288.0990; train_optim_loss: 196288.0990; val_kl_reg_loss: 158.8614; val_edge_recon_loss: 113450.3594; val_gene_expr_recon_loss: 98053.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211663.1250; val_optim_loss: 211663.1250
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9074; val_auprc_score: 0.9779; val_best_acc_score: 0.9150; val_best_f1_score: 0.9514; train_kl_reg_loss: 160.0223; train_edge_recon_loss: 99510.6562; train_gene_expr_recon_loss: 99195.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198866.2604; train_optim_loss: 198866.2604; val_kl_reg_loss: 156.9801; val_edge_recon_loss: 111701.3750; val_gene_expr_recon_loss: 97988.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209846.3750; val_optim_loss: 209846.3750
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9129; val_auprc_score: 0.9768; val_best_acc_score: 0.9204; val_best_f1_score: 0.9551; train_kl_reg_loss: 159.2456; train_edge_recon_loss: 99433.1875; train_gene_expr_recon_loss: 99386.7240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198979.1562; train_optim_loss: 198979.1562; val_kl_reg_loss: 156.2519; val_edge_recon_loss: 106100.2266; val_gene_expr_recon_loss: 97921.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204178.3125; val_optim_loss: 204178.3125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9160; val_auprc_score: 0.9790; val_best_acc_score: 0.9138; val_best_f1_score: 0.9513; train_kl_reg_loss: 159.1833; train_edge_recon_loss: 102743.7891; train_gene_expr_recon_loss: 99252.8151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202155.7917; train_optim_loss: 202155.7917; val_kl_reg_loss: 156.9515; val_edge_recon_loss: 110071.6484; val_gene_expr_recon_loss: 97915.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208143.8750; val_optim_loss: 208143.8750
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9166; val_auprc_score: 0.9778; val_best_acc_score: 0.9159; val_best_f1_score: 0.9526; train_kl_reg_loss: 159.7142; train_edge_recon_loss: 103289.9401; train_gene_expr_recon_loss: 98960.9948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202410.6510; train_optim_loss: 202410.6510; val_kl_reg_loss: 156.5196; val_edge_recon_loss: 108284.5312; val_gene_expr_recon_loss: 97908.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206349.5625; val_optim_loss: 206349.5625
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9168; val_auprc_score: 0.9797; val_best_acc_score: 0.9097; val_best_f1_score: 0.9483; train_kl_reg_loss: 159.4841; train_edge_recon_loss: 102803.4479; train_gene_expr_recon_loss: 99451.5208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202414.4531; train_optim_loss: 202414.4531; val_kl_reg_loss: 155.6733; val_edge_recon_loss: 117886.3828; val_gene_expr_recon_loss: 97901.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215943.6875; val_optim_loss: 215943.6875

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 9 sec.
Using best model state, which was in epoch 10.

--- MODEL EVALUATION ---
Val AUROC score: 0.9228
Val AUPRC score: 0.9812
Val best accuracy score: 0.9187
Val best F1 score: 0.9545
Val gene expr MSE score: 1.3048
Duration of model training in run 5: 0 hours, 0 minutes and 10 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 16450
Number of validation edges: 1827
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9299; val_auprc_score: 0.9775; val_best_acc_score: 0.9253; val_best_f1_score: 0.9561; train_kl_reg_loss: 52.7893; train_edge_recon_loss: 92733.3464; train_gene_expr_recon_loss: 139003.6536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 231789.7917; train_optim_loss: 231789.7917; val_kl_reg_loss: 92.2795; val_edge_recon_loss: 120640.3047; val_gene_expr_recon_loss: 117009.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237741.9375; val_optim_loss: 237741.9375
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9408; val_auprc_score: 0.9854; val_best_acc_score: 0.9129; val_best_f1_score: 0.9511; train_kl_reg_loss: 136.3886; train_edge_recon_loss: 114187.3411; train_gene_expr_recon_loss: 114773.6484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229097.3750; train_optim_loss: 229097.3750; val_kl_reg_loss: 212.7800; val_edge_recon_loss: 115988.4688; val_gene_expr_recon_loss: 105354.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221555.5469; val_optim_loss: 221555.5469
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9277; val_auprc_score: 0.9800; val_best_acc_score: 0.9016; val_best_f1_score: 0.9452; train_kl_reg_loss: 249.8081; train_edge_recon_loss: 102992.4193; train_gene_expr_recon_loss: 104916.9661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208159.1927; train_optim_loss: 208159.1927; val_kl_reg_loss: 324.2623; val_edge_recon_loss: 115815.6953; val_gene_expr_recon_loss: 100363.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216503.4688; val_optim_loss: 216503.4688
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9308; val_auprc_score: 0.9763; val_best_acc_score: 0.9006; val_best_f1_score: 0.9435; train_kl_reg_loss: 361.0444; train_edge_recon_loss: 103871.4557; train_gene_expr_recon_loss: 101235.7318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205468.2344; train_optim_loss: 205468.2344; val_kl_reg_loss: 361.4981; val_edge_recon_loss: 127820.8906; val_gene_expr_recon_loss: 98501.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 226684.1875; val_optim_loss: 226684.1875
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9187; val_auprc_score: 0.9749; val_best_acc_score: 0.9131; val_best_f1_score: 0.9501; train_kl_reg_loss: 343.8254; train_edge_recon_loss: 94659.1042; train_gene_expr_recon_loss: 99457.8620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194460.7969; train_optim_loss: 194460.7969; val_kl_reg_loss: 294.8805; val_edge_recon_loss: 120054.3359; val_gene_expr_recon_loss: 97716.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218066.1562; val_optim_loss: 218066.1562
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9347; val_auprc_score: 0.9837; val_best_acc_score: 0.9178; val_best_f1_score: 0.9531; train_kl_reg_loss: 273.6526; train_edge_recon_loss: 107314.8984; train_gene_expr_recon_loss: 98787.2109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206375.7656; train_optim_loss: 206375.7656; val_kl_reg_loss: 224.0241; val_edge_recon_loss: 118573.0078; val_gene_expr_recon_loss: 97303.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216100.6562; val_optim_loss: 216100.6562
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9193; val_auprc_score: 0.9739; val_best_acc_score: 0.9166; val_best_f1_score: 0.9526; train_kl_reg_loss: 207.7248; train_edge_recon_loss: 99971.7734; train_gene_expr_recon_loss: 98463.1927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198642.6927; train_optim_loss: 198642.6927; val_kl_reg_loss: 171.0661; val_edge_recon_loss: 111702.9766; val_gene_expr_recon_loss: 97004.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208878.2969; val_optim_loss: 208878.2969
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9204; val_auprc_score: 0.9818; val_best_acc_score: 0.9136; val_best_f1_score: 0.9510; train_kl_reg_loss: 163.5809; train_edge_recon_loss: 102705.6432; train_gene_expr_recon_loss: 98280.3958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201149.6198; train_optim_loss: 201149.6198; val_kl_reg_loss: 142.4845; val_edge_recon_loss: 108431.3906; val_gene_expr_recon_loss: 96723.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205297.5781; val_optim_loss: 205297.5781
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9049; val_auprc_score: 0.9743; val_best_acc_score: 0.9119; val_best_f1_score: 0.9501; train_kl_reg_loss: 139.8707; train_edge_recon_loss: 111633.1667; train_gene_expr_recon_loss: 98204.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209977.0729; train_optim_loss: 209977.0729; val_kl_reg_loss: 126.6020; val_edge_recon_loss: 110097.1016; val_gene_expr_recon_loss: 96448.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206672.3125; val_optim_loss: 206672.3125
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9180; val_auprc_score: 0.9818; val_best_acc_score: 0.9187; val_best_f1_score: 0.9537; train_kl_reg_loss: 127.7807; train_edge_recon_loss: 102834.5807; train_gene_expr_recon_loss: 97505.5365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200467.9062; train_optim_loss: 200467.9062; val_kl_reg_loss: 121.4767; val_edge_recon_loss: 106192.8750; val_gene_expr_recon_loss: 96195.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202509.3594; val_optim_loss: 202509.3594
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9137; val_auprc_score: 0.9821; val_best_acc_score: 0.9210; val_best_f1_score: 0.9555; train_kl_reg_loss: 123.5428; train_edge_recon_loss: 101674.9766; train_gene_expr_recon_loss: 97615.5286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199414.0521; train_optim_loss: 199414.0521; val_kl_reg_loss: 123.2055; val_edge_recon_loss: 100034.4688; val_gene_expr_recon_loss: 95975.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196133.2344; val_optim_loss: 196133.2344
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9081; val_auprc_score: 0.9743; val_best_acc_score: 0.9199; val_best_f1_score: 0.9541; train_kl_reg_loss: 129.2944; train_edge_recon_loss: 95062.0286; train_gene_expr_recon_loss: 97567.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192759.1302; train_optim_loss: 192759.1302; val_kl_reg_loss: 135.3430; val_edge_recon_loss: 110213.7266; val_gene_expr_recon_loss: 95782.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206131.3438; val_optim_loss: 206131.3438
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8794; val_auprc_score: 0.9646; val_best_acc_score: 0.9035; val_best_f1_score: 0.9448; train_kl_reg_loss: 142.3048; train_edge_recon_loss: 100804.2161; train_gene_expr_recon_loss: 97524.1120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198470.6302; train_optim_loss: 198470.6302; val_kl_reg_loss: 153.4783; val_edge_recon_loss: 112482.2969; val_gene_expr_recon_loss: 95609.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208244.7969; val_optim_loss: 208244.7969
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8487; val_auprc_score: 0.9610; val_best_acc_score: 0.9040; val_best_f1_score: 0.9462; train_kl_reg_loss: 163.9700; train_edge_recon_loss: 108503.4401; train_gene_expr_recon_loss: 97346.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206013.8750; train_optim_loss: 206013.8750; val_kl_reg_loss: 180.8317; val_edge_recon_loss: 99969.8828; val_gene_expr_recon_loss: 95438.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195589.0312; val_optim_loss: 195589.0312
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8707; val_auprc_score: 0.9697; val_best_acc_score: 0.9048; val_best_f1_score: 0.9463; train_kl_reg_loss: 193.9574; train_edge_recon_loss: 89964.0833; train_gene_expr_recon_loss: 96816.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186974.1615; train_optim_loss: 186974.1615; val_kl_reg_loss: 220.1606; val_edge_recon_loss: 102585.9219; val_gene_expr_recon_loss: 95264.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198070.9844; val_optim_loss: 198070.9844
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8699; val_auprc_score: 0.9684; val_best_acc_score: 0.9002; val_best_f1_score: 0.9436; train_kl_reg_loss: 233.2816; train_edge_recon_loss: 110668.6328; train_gene_expr_recon_loss: 96986.9010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207888.8177; train_optim_loss: 207888.8177; val_kl_reg_loss: 259.3553; val_edge_recon_loss: 104648.8516; val_gene_expr_recon_loss: 95078.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 199986.3750; val_optim_loss: 199986.3750
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8170; val_auprc_score: 0.9570; val_best_acc_score: 0.8918; val_best_f1_score: 0.9403; train_kl_reg_loss: 276.9261; train_edge_recon_loss: 113253.7109; train_gene_expr_recon_loss: 96211.7057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209742.3438; train_optim_loss: 209742.3438; val_kl_reg_loss: 292.8217; val_edge_recon_loss: 99225.0703; val_gene_expr_recon_loss: 94886.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194404.4688; val_optim_loss: 194404.4688
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8699; val_auprc_score: 0.9716; val_best_acc_score: 0.8976; val_best_f1_score: 0.9432; train_kl_reg_loss: 308.6955; train_edge_recon_loss: 98950.2969; train_gene_expr_recon_loss: 96447.4948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195706.4896; train_optim_loss: 195706.4896; val_kl_reg_loss: 323.2669; val_edge_recon_loss: 95205.8594; val_gene_expr_recon_loss: 94698.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190228.0312; val_optim_loss: 190228.0312
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8416; val_auprc_score: 0.9611; val_best_acc_score: 0.8919; val_best_f1_score: 0.9404; train_kl_reg_loss: 345.2363; train_edge_recon_loss: 96979.0026; train_gene_expr_recon_loss: 95999.5182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193323.7604; train_optim_loss: 193323.7604; val_kl_reg_loss: 374.3619; val_edge_recon_loss: 97397.2109; val_gene_expr_recon_loss: 94497.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192269.2188; val_optim_loss: 192269.2188
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8336; val_auprc_score: 0.9627; val_best_acc_score: 0.8950; val_best_f1_score: 0.9426; train_kl_reg_loss: 400.5434; train_edge_recon_loss: 86453.1198; train_gene_expr_recon_loss: 95857.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182710.8177; train_optim_loss: 182710.8177; val_kl_reg_loss: 451.3459; val_edge_recon_loss: 90933.1250; val_gene_expr_recon_loss: 94310.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185694.7500; val_optim_loss: 185694.7500
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8363; val_auprc_score: 0.9551; val_best_acc_score: 0.8765; val_best_f1_score: 0.9306; train_kl_reg_loss: 492.7267; train_edge_recon_loss: 108329.6510; train_gene_expr_recon_loss: 95919.1979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204741.5781; train_optim_loss: 204741.5781; val_kl_reg_loss: 522.4307; val_edge_recon_loss: 105573.1875; val_gene_expr_recon_loss: 94142.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200237.6562; val_optim_loss: 200237.6562
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8273; val_auprc_score: 0.9565; val_best_acc_score: 0.8772; val_best_f1_score: 0.9313; train_kl_reg_loss: 570.3836; train_edge_recon_loss: 100922.2083; train_gene_expr_recon_loss: 95094.1276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196586.7188; train_optim_loss: 196586.7188; val_kl_reg_loss: 609.8208; val_edge_recon_loss: 102450.2656; val_gene_expr_recon_loss: 94053.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197113.7812; val_optim_loss: 197113.7812
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8257; val_auprc_score: 0.9551; val_best_acc_score: 0.8826; val_best_f1_score: 0.9347; train_kl_reg_loss: 660.3369; train_edge_recon_loss: 95331.1120; train_gene_expr_recon_loss: 95303.5547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191295.0000; train_optim_loss: 191295.0000; val_kl_reg_loss: 716.2739; val_edge_recon_loss: 98673.5859; val_gene_expr_recon_loss: 93876.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193266.7031; val_optim_loss: 193266.7031

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8221; val_auprc_score: 0.9587; val_best_acc_score: 0.8858; val_best_f1_score: 0.9366; train_kl_reg_loss: 736.8832; train_edge_recon_loss: 97365.2396; train_gene_expr_recon_loss: 94714.8490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192816.9688; train_optim_loss: 192816.9688; val_kl_reg_loss: 724.5933; val_edge_recon_loss: 95661.2031; val_gene_expr_recon_loss: 93862.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190248.0625; val_optim_loss: 190248.0625
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8304; val_auprc_score: 0.9629; val_best_acc_score: 0.8936; val_best_f1_score: 0.9415; train_kl_reg_loss: 740.7006; train_edge_recon_loss: 94581.3281; train_gene_expr_recon_loss: 95216.1536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190538.1771; train_optim_loss: 190538.1771; val_kl_reg_loss: 735.4845; val_edge_recon_loss: 89015.3438; val_gene_expr_recon_loss: 93831.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183582.4844; val_optim_loss: 183582.4844
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8253; val_auprc_score: 0.9603; val_best_acc_score: 0.8915; val_best_f1_score: 0.9402; train_kl_reg_loss: 759.3686; train_edge_recon_loss: 94336.0807; train_gene_expr_recon_loss: 95392.9479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190488.3958; train_optim_loss: 190488.3958; val_kl_reg_loss: 742.0457; val_edge_recon_loss: 91113.4844; val_gene_expr_recon_loss: 93798.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185653.6562; val_optim_loss: 185653.6562
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8406; val_auprc_score: 0.9636; val_best_acc_score: 0.8786; val_best_f1_score: 0.9331; train_kl_reg_loss: 763.9662; train_edge_recon_loss: 91146.0938; train_gene_expr_recon_loss: 95000.1536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186910.2135; train_optim_loss: 186910.2135; val_kl_reg_loss: 753.9824; val_edge_recon_loss: 95811.1250; val_gene_expr_recon_loss: 93766.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190331.6250; val_optim_loss: 190331.6250
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8406; val_auprc_score: 0.9613; val_best_acc_score: 0.8866; val_best_f1_score: 0.9375; train_kl_reg_loss: 764.6956; train_edge_recon_loss: 80123.2799; train_gene_expr_recon_loss: 95144.6901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176032.6615; train_optim_loss: 176032.6615; val_kl_reg_loss: 761.8315; val_edge_recon_loss: 92322.7812; val_gene_expr_recon_loss: 93739.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186824.4062; val_optim_loss: 186824.4062

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8528; val_auprc_score: 0.9644; val_best_acc_score: 0.8857; val_best_f1_score: 0.9363; train_kl_reg_loss: 775.7531; train_edge_recon_loss: 104960.1354; train_gene_expr_recon_loss: 94977.4844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200713.3698; train_optim_loss: 200713.3698; val_kl_reg_loss: 760.0316; val_edge_recon_loss: 95766.4688; val_gene_expr_recon_loss: 93737.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190263.7031; val_optim_loss: 190263.7031
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8400; val_auprc_score: 0.9618; val_best_acc_score: 0.8914; val_best_f1_score: 0.9394; train_kl_reg_loss: 772.3269; train_edge_recon_loss: 90001.0365; train_gene_expr_recon_loss: 95001.7318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185775.0990; train_optim_loss: 185775.0990; val_kl_reg_loss: 761.5900; val_edge_recon_loss: 92681.6875; val_gene_expr_recon_loss: 93734.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187177.5781; val_optim_loss: 187177.5781
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8366; val_auprc_score: 0.9686; val_best_acc_score: 0.8913; val_best_f1_score: 0.9410; train_kl_reg_loss: 780.3369; train_edge_recon_loss: 93548.9714; train_gene_expr_recon_loss: 94834.4193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189163.7292; train_optim_loss: 189163.7292; val_kl_reg_loss: 762.0771; val_edge_recon_loss: 82900.5938; val_gene_expr_recon_loss: 93730.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177393.5000; val_optim_loss: 177393.5000
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8475; val_auprc_score: 0.9618; val_best_acc_score: 0.8905; val_best_f1_score: 0.9388; train_kl_reg_loss: 779.6605; train_edge_recon_loss: 89793.8333; train_gene_expr_recon_loss: 94803.2526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185376.7500; train_optim_loss: 185376.7500; val_kl_reg_loss: 762.6584; val_edge_recon_loss: 90012.3984; val_gene_expr_recon_loss: 93727.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184502.6562; val_optim_loss: 184502.6562
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8456; val_auprc_score: 0.9634; val_best_acc_score: 0.8908; val_best_f1_score: 0.9394; train_kl_reg_loss: 782.1317; train_edge_recon_loss: 89544.0234; train_gene_expr_recon_loss: 94959.0130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185285.1719; train_optim_loss: 185285.1719; val_kl_reg_loss: 763.4402; val_edge_recon_loss: 91149.1875; val_gene_expr_recon_loss: 93724.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185637.0938; val_optim_loss: 185637.0938
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.8289; val_auprc_score: 0.9507; val_best_acc_score: 0.8877; val_best_f1_score: 0.9376; train_kl_reg_loss: 780.6868; train_edge_recon_loss: 106568.0599; train_gene_expr_recon_loss: 94858.2891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202207.0365; train_optim_loss: 202207.0365; val_kl_reg_loss: 763.1018; val_edge_recon_loss: 93266.4297; val_gene_expr_recon_loss: 93721.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187750.9688; val_optim_loss: 187750.9688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.8437; val_auprc_score: 0.9630; val_best_acc_score: 0.8920; val_best_f1_score: 0.9394; train_kl_reg_loss: 771.5020; train_edge_recon_loss: 87236.5938; train_gene_expr_recon_loss: 95088.1224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183096.2188; train_optim_loss: 183096.2188; val_kl_reg_loss: 763.5940; val_edge_recon_loss: 94167.8672; val_gene_expr_recon_loss: 93721.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188652.6562; val_optim_loss: 188652.6562
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.8575; val_auprc_score: 0.9654; val_best_acc_score: 0.8886; val_best_f1_score: 0.9382; train_kl_reg_loss: 780.5898; train_edge_recon_loss: 82997.6354; train_gene_expr_recon_loss: 95207.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178985.9115; train_optim_loss: 178985.9115; val_kl_reg_loss: 759.7313; val_edge_recon_loss: 92073.2500; val_gene_expr_recon_loss: 93720.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186553.9531; val_optim_loss: 186553.9531
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.8452; val_auprc_score: 0.9604; val_best_acc_score: 0.8938; val_best_f1_score: 0.9409; train_kl_reg_loss: 779.6394; train_edge_recon_loss: 107157.8464; train_gene_expr_recon_loss: 95106.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203043.8281; train_optim_loss: 203043.8281; val_kl_reg_loss: 763.4955; val_edge_recon_loss: 90546.4609; val_gene_expr_recon_loss: 93720.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185030.6875; val_optim_loss: 185030.6875

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 23 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.8363
Val AUPRC score: 0.9641
Val best accuracy score: 0.8910
Val best F1 score: 0.9394
Val gene expr MSE score: 1.2223
Duration of model training in run 6: 0 hours, 0 minutes and 24 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 21883
Number of validation edges: 2431
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9441; val_auprc_score: 0.9840; val_best_acc_score: 0.9349; val_best_f1_score: 0.9626; train_kl_reg_loss: 60.4038; train_edge_recon_loss: 101830.5182; train_gene_expr_recon_loss: 140726.5547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242617.4792; train_optim_loss: 242617.4792; val_kl_reg_loss: 114.0600; val_edge_recon_loss: 119169.4297; val_gene_expr_recon_loss: 116406.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 235689.6562; val_optim_loss: 235689.6562
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9380; val_auprc_score: 0.9796; val_best_acc_score: 0.8980; val_best_f1_score: 0.9435; train_kl_reg_loss: 179.7882; train_edge_recon_loss: 99554.4740; train_gene_expr_recon_loss: 114785.0755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214519.3385; train_optim_loss: 214519.3385; val_kl_reg_loss: 285.3634; val_edge_recon_loss: 116264.8984; val_gene_expr_recon_loss: 104758.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221308.4375; val_optim_loss: 221308.4375
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9235; val_auprc_score: 0.9774; val_best_acc_score: 0.9137; val_best_f1_score: 0.9519; train_kl_reg_loss: 319.9348; train_edge_recon_loss: 103372.7292; train_gene_expr_recon_loss: 105833.2604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209525.9271; train_optim_loss: 209525.9271; val_kl_reg_loss: 312.7331; val_edge_recon_loss: 109164.6172; val_gene_expr_recon_loss: 100077.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209554.7188; val_optim_loss: 209554.7188
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9241; val_auprc_score: 0.9752; val_best_acc_score: 0.9186; val_best_f1_score: 0.9525; train_kl_reg_loss: 304.6462; train_edge_recon_loss: 102229.2500; train_gene_expr_recon_loss: 101900.2943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204434.1927; train_optim_loss: 204434.1927; val_kl_reg_loss: 243.6315; val_edge_recon_loss: 121265.4688; val_gene_expr_recon_loss: 98163.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 219672.1562; val_optim_loss: 219672.1562
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9073; val_auprc_score: 0.9703; val_best_acc_score: 0.9079; val_best_f1_score: 0.9470; train_kl_reg_loss: 229.2870; train_edge_recon_loss: 104276.8750; train_gene_expr_recon_loss: 100359.4870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204865.6510; train_optim_loss: 204865.6510; val_kl_reg_loss: 178.0220; val_edge_recon_loss: 118017.7031; val_gene_expr_recon_loss: 97258.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215454.4375; val_optim_loss: 215454.4375
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9008; val_auprc_score: 0.9726; val_best_acc_score: 0.9136; val_best_f1_score: 0.9505; train_kl_reg_loss: 173.2451; train_edge_recon_loss: 103695.1302; train_gene_expr_recon_loss: 99670.2109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203538.5885; train_optim_loss: 203538.5885; val_kl_reg_loss: 151.8621; val_edge_recon_loss: 110651.2109; val_gene_expr_recon_loss: 96613.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207417.0000; val_optim_loss: 207417.0000
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8856; val_auprc_score: 0.9675; val_best_acc_score: 0.9022; val_best_f1_score: 0.9435; train_kl_reg_loss: 160.5816; train_edge_recon_loss: 102331.0286; train_gene_expr_recon_loss: 98821.1849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201312.7917; train_optim_loss: 201312.7917; val_kl_reg_loss: 165.4641; val_edge_recon_loss: 116235.8047; val_gene_expr_recon_loss: 96106.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 212508.1250; val_optim_loss: 212508.1250
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8984; val_auprc_score: 0.9768; val_best_acc_score: 0.9138; val_best_f1_score: 0.9513; train_kl_reg_loss: 184.5936; train_edge_recon_loss: 101659.4714; train_gene_expr_recon_loss: 98581.1719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200425.2396; train_optim_loss: 200425.2396; val_kl_reg_loss: 200.6825; val_edge_recon_loss: 94742.4219; val_gene_expr_recon_loss: 95710.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190653.8125; val_optim_loss: 190653.8125
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8575; val_auprc_score: 0.9627; val_best_acc_score: 0.8970; val_best_f1_score: 0.9425; train_kl_reg_loss: 227.1841; train_edge_recon_loss: 99925.6667; train_gene_expr_recon_loss: 98280.7370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198433.5833; train_optim_loss: 198433.5833; val_kl_reg_loss: 254.0718; val_edge_recon_loss: 95970.2734; val_gene_expr_recon_loss: 95362.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191586.4219; val_optim_loss: 191586.4219
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8487; val_auprc_score: 0.9632; val_best_acc_score: 0.8893; val_best_f1_score: 0.9385; train_kl_reg_loss: 293.3614; train_edge_recon_loss: 100639.0703; train_gene_expr_recon_loss: 97710.0495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198642.4792; train_optim_loss: 198642.4792; val_kl_reg_loss: 337.9639; val_edge_recon_loss: 96246.1797; val_gene_expr_recon_loss: 95029.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191613.1562; val_optim_loss: 191613.1562
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8729; val_auprc_score: 0.9684; val_best_acc_score: 0.8914; val_best_f1_score: 0.9389; train_kl_reg_loss: 402.8572; train_edge_recon_loss: 98113.1146; train_gene_expr_recon_loss: 97425.3568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195941.3281; train_optim_loss: 195941.3281; val_kl_reg_loss: 484.2735; val_edge_recon_loss: 96139.9609; val_gene_expr_recon_loss: 94700.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191325.1250; val_optim_loss: 191325.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8498; val_auprc_score: 0.9582; val_best_acc_score: 0.8894; val_best_f1_score: 0.9379; train_kl_reg_loss: 514.4667; train_edge_recon_loss: 95220.3516; train_gene_expr_recon_loss: 97304.3594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193039.1771; train_optim_loss: 193039.1771; val_kl_reg_loss: 502.7127; val_edge_recon_loss: 95367.4766; val_gene_expr_recon_loss: 94665.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190535.8438; val_optim_loss: 190535.8438
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8590; val_auprc_score: 0.9631; val_best_acc_score: 0.8807; val_best_f1_score: 0.9326; train_kl_reg_loss: 533.0022; train_edge_recon_loss: 96247.0833; train_gene_expr_recon_loss: 97155.1615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193935.2500; train_optim_loss: 193935.2500; val_kl_reg_loss: 516.0081; val_edge_recon_loss: 101798.7969; val_gene_expr_recon_loss: 94624.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196939.1562; val_optim_loss: 196939.1562
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8604; val_auprc_score: 0.9666; val_best_acc_score: 0.8933; val_best_f1_score: 0.9405; train_kl_reg_loss: 548.5332; train_edge_recon_loss: 94807.7344; train_gene_expr_recon_loss: 97233.8255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192590.0938; train_optim_loss: 192590.0938; val_kl_reg_loss: 534.9628; val_edge_recon_loss: 91229.6406; val_gene_expr_recon_loss: 94581.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186345.6250; val_optim_loss: 186345.6250
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8598; val_auprc_score: 0.9658; val_best_acc_score: 0.8822; val_best_f1_score: 0.9335; train_kl_reg_loss: 565.7582; train_edge_recon_loss: 95887.7552; train_gene_expr_recon_loss: 97049.3958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193502.9062; train_optim_loss: 193502.9062; val_kl_reg_loss: 550.2292; val_edge_recon_loss: 98768.7500; val_gene_expr_recon_loss: 94537.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193855.9844; val_optim_loss: 193855.9844
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8562; val_auprc_score: 0.9659; val_best_acc_score: 0.8845; val_best_f1_score: 0.9355; train_kl_reg_loss: 584.0577; train_edge_recon_loss: 94969.9688; train_gene_expr_recon_loss: 96998.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192552.9792; train_optim_loss: 192552.9792; val_kl_reg_loss: 570.7405; val_edge_recon_loss: 95880.7578; val_gene_expr_recon_loss: 94494.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190946.0938; val_optim_loss: 190946.0938
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8538; val_auprc_score: 0.9656; val_best_acc_score: 0.8970; val_best_f1_score: 0.9427; train_kl_reg_loss: 608.6379; train_edge_recon_loss: 93548.6823; train_gene_expr_recon_loss: 96871.7604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191029.0781; train_optim_loss: 191029.0781; val_kl_reg_loss: 597.8401; val_edge_recon_loss: 87273.8594; val_gene_expr_recon_loss: 94451.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182323.6562; val_optim_loss: 182323.6562
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8530; val_auprc_score: 0.9606; val_best_acc_score: 0.8928; val_best_f1_score: 0.9399; train_kl_reg_loss: 634.3922; train_edge_recon_loss: 95306.1562; train_gene_expr_recon_loss: 97299.7109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193240.2500; train_optim_loss: 193240.2500; val_kl_reg_loss: 624.2372; val_edge_recon_loss: 90798.1953; val_gene_expr_recon_loss: 94410.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185833.2188; val_optim_loss: 185833.2188
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8465; val_auprc_score: 0.9631; val_best_acc_score: 0.8880; val_best_f1_score: 0.9374; train_kl_reg_loss: 662.7353; train_edge_recon_loss: 94635.0599; train_gene_expr_recon_loss: 96987.2526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192285.0469; train_optim_loss: 192285.0469; val_kl_reg_loss: 654.1149; val_edge_recon_loss: 92038.2891; val_gene_expr_recon_loss: 94370.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187063.1875; val_optim_loss: 187063.1875
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8572; val_auprc_score: 0.9653; val_best_acc_score: 0.8899; val_best_f1_score: 0.9384; train_kl_reg_loss: 691.6656; train_edge_recon_loss: 95386.9896; train_gene_expr_recon_loss: 96741.0182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192819.6667; train_optim_loss: 192819.6667; val_kl_reg_loss: 686.7526; val_edge_recon_loss: 91718.7578; val_gene_expr_recon_loss: 94332.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186737.5469; val_optim_loss: 186737.5469

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8633; val_auprc_score: 0.9688; val_best_acc_score: 0.8862; val_best_f1_score: 0.9368; train_kl_reg_loss: 713.7559; train_edge_recon_loss: 93237.4740; train_gene_expr_recon_loss: 96810.9922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190762.2188; train_optim_loss: 190762.2188; val_kl_reg_loss: 689.8638; val_edge_recon_loss: 91118.8281; val_gene_expr_recon_loss: 94328.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186136.9688; val_optim_loss: 186136.9688
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8756; val_auprc_score: 0.9710; val_best_acc_score: 0.8938; val_best_f1_score: 0.9409; train_kl_reg_loss: 719.9882; train_edge_recon_loss: 93801.3932; train_gene_expr_recon_loss: 96290.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190811.7865; train_optim_loss: 190811.7865; val_kl_reg_loss: 693.7153; val_edge_recon_loss: 87709.9922; val_gene_expr_recon_loss: 94324.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182727.9688; val_optim_loss: 182727.9688
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8669; val_auprc_score: 0.9698; val_best_acc_score: 0.8933; val_best_f1_score: 0.9405; train_kl_reg_loss: 724.0963; train_edge_recon_loss: 91591.4557; train_gene_expr_recon_loss: 96791.4036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189106.9583; train_optim_loss: 189106.9583; val_kl_reg_loss: 697.3833; val_edge_recon_loss: 87750.9453; val_gene_expr_recon_loss: 94320.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182768.8750; val_optim_loss: 182768.8750

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 16 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
Val AUROC score: 0.8577
Val AUPRC score: 0.9657
Val best accuracy score: 0.8836
Val best F1 score: 0.9349
Val gene expr MSE score: 1.2323
Duration of model training in run 7: 0 hours, 0 minutes and 17 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 21883
Number of validation edges: 2431
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9286; val_auprc_score: 0.9822; val_best_acc_score: 0.9185; val_best_f1_score: 0.9536; train_kl_reg_loss: 63.6191; train_edge_recon_loss: 102981.3021; train_gene_expr_recon_loss: 142000.6771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 245045.5938; train_optim_loss: 245045.5938; val_kl_reg_loss: 127.8743; val_edge_recon_loss: 116354.6641; val_gene_expr_recon_loss: 119128.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 235610.9375; val_optim_loss: 235610.9375
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9341; val_auprc_score: 0.9828; val_best_acc_score: 0.8881; val_best_f1_score: 0.9385; train_kl_reg_loss: 200.7666; train_edge_recon_loss: 102632.4635; train_gene_expr_recon_loss: 115078.9948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217912.2292; train_optim_loss: 217912.2292; val_kl_reg_loss: 319.4001; val_edge_recon_loss: 114414.6328; val_gene_expr_recon_loss: 106825.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221559.3438; val_optim_loss: 221559.3438
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9179; val_auprc_score: 0.9766; val_best_acc_score: 0.8960; val_best_f1_score: 0.9419; train_kl_reg_loss: 361.1677; train_edge_recon_loss: 103405.5495; train_gene_expr_recon_loss: 105637.9661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209404.6823; train_optim_loss: 209404.6823; val_kl_reg_loss: 384.9514; val_edge_recon_loss: 119214.4219; val_gene_expr_recon_loss: 101429.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221028.4062; val_optim_loss: 221028.4062
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9218; val_auprc_score: 0.9793; val_best_acc_score: 0.9109; val_best_f1_score: 0.9497; train_kl_reg_loss: 387.4189; train_edge_recon_loss: 100839.5417; train_gene_expr_recon_loss: 101404.4557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202631.4167; train_optim_loss: 202631.4167; val_kl_reg_loss: 333.5632; val_edge_recon_loss: 111654.3359; val_gene_expr_recon_loss: 99115.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211103.5938; val_optim_loss: 211103.5938
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9028; val_auprc_score: 0.9723; val_best_acc_score: 0.9092; val_best_f1_score: 0.9470; train_kl_reg_loss: 314.2853; train_edge_recon_loss: 101453.4844; train_gene_expr_recon_loss: 99417.9010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201185.6719; train_optim_loss: 201185.6719; val_kl_reg_loss: 246.7914; val_edge_recon_loss: 118228.3125; val_gene_expr_recon_loss: 98072.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216547.3906; val_optim_loss: 216547.3906
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8885; val_auprc_score: 0.9640; val_best_acc_score: 0.8983; val_best_f1_score: 0.9416; train_kl_reg_loss: 232.0846; train_edge_recon_loss: 102217.7969; train_gene_expr_recon_loss: 98645.5964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201095.4740; train_optim_loss: 201095.4740; val_kl_reg_loss: 193.9090; val_edge_recon_loss: 118219.4219; val_gene_expr_recon_loss: 97401.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215814.7500; val_optim_loss: 215814.7500
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8723; val_auprc_score: 0.9661; val_best_acc_score: 0.8987; val_best_f1_score: 0.9419; train_kl_reg_loss: 192.7406; train_edge_recon_loss: 100897.9531; train_gene_expr_recon_loss: 97968.4714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199059.1667; train_optim_loss: 199059.1667; val_kl_reg_loss: 184.0044; val_edge_recon_loss: 114410.8438; val_gene_expr_recon_loss: 96906.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211501.5000; val_optim_loss: 211501.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8689; val_auprc_score: 0.9645; val_best_acc_score: 0.9062; val_best_f1_score: 0.9465; train_kl_reg_loss: 188.9456; train_edge_recon_loss: 101283.9297; train_gene_expr_recon_loss: 97786.1771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199259.0573; train_optim_loss: 199259.0573; val_kl_reg_loss: 184.7805; val_edge_recon_loss: 104895.4375; val_gene_expr_recon_loss: 96854.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201935.0312; val_optim_loss: 201935.0312
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8911; val_auprc_score: 0.9752; val_best_acc_score: 0.9076; val_best_f1_score: 0.9475; train_kl_reg_loss: 189.6747; train_edge_recon_loss: 101105.5859; train_gene_expr_recon_loss: 97429.4922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198724.7500; train_optim_loss: 198724.7500; val_kl_reg_loss: 183.7829; val_edge_recon_loss: 105604.9844; val_gene_expr_recon_loss: 96789.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202578.1250; val_optim_loss: 202578.1250
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8831; val_auprc_score: 0.9670; val_best_acc_score: 0.8980; val_best_f1_score: 0.9412; train_kl_reg_loss: 188.7891; train_edge_recon_loss: 101823.7109; train_gene_expr_recon_loss: 97326.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199339.4688; train_optim_loss: 199339.4688; val_kl_reg_loss: 184.4900; val_edge_recon_loss: 110955.4141; val_gene_expr_recon_loss: 96715.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207854.9062; val_optim_loss: 207854.9062
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8736; val_auprc_score: 0.9693; val_best_acc_score: 0.9006; val_best_f1_score: 0.9438; train_kl_reg_loss: 188.9573; train_edge_recon_loss: 100862.9740; train_gene_expr_recon_loss: 97394.5182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198446.4583; train_optim_loss: 198446.4583; val_kl_reg_loss: 184.6700; val_edge_recon_loss: 105964.8281; val_gene_expr_recon_loss: 96635.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202785.2969; val_optim_loss: 202785.2969

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8826; val_auprc_score: 0.9719; val_best_acc_score: 0.8983; val_best_f1_score: 0.9423; train_kl_reg_loss: 189.2307; train_edge_recon_loss: 100566.6484; train_gene_expr_recon_loss: 97341.7630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198097.6406; train_optim_loss: 198097.6406; val_kl_reg_loss: 184.7191; val_edge_recon_loss: 105447.4531; val_gene_expr_recon_loss: 96627.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202259.7969; val_optim_loss: 202259.7969
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8973; val_auprc_score: 0.9744; val_best_acc_score: 0.9063; val_best_f1_score: 0.9460; train_kl_reg_loss: 188.6013; train_edge_recon_loss: 99529.0078; train_gene_expr_recon_loss: 97426.2682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197143.8802; train_optim_loss: 197143.8802; val_kl_reg_loss: 183.9873; val_edge_recon_loss: 110527.3516; val_gene_expr_recon_loss: 96619.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207330.3906; val_optim_loss: 207330.3906
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8685; val_auprc_score: 0.9663; val_best_acc_score: 0.9045; val_best_f1_score: 0.9458; train_kl_reg_loss: 189.2132; train_edge_recon_loss: 100020.0130; train_gene_expr_recon_loss: 97163.7057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197372.9323; train_optim_loss: 197372.9323; val_kl_reg_loss: 185.2630; val_edge_recon_loss: 102096.7109; val_gene_expr_recon_loss: 96610.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198892.2969; val_optim_loss: 198892.2969
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8704; val_auprc_score: 0.9705; val_best_acc_score: 0.8960; val_best_f1_score: 0.9407; train_kl_reg_loss: 188.8083; train_edge_recon_loss: 100692.4401; train_gene_expr_recon_loss: 97385.0573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198266.3021; train_optim_loss: 198266.3021; val_kl_reg_loss: 184.4420; val_edge_recon_loss: 108673.0938; val_gene_expr_recon_loss: 96601.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205458.9375; val_optim_loss: 205458.9375
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8906; val_auprc_score: 0.9736; val_best_acc_score: 0.9101; val_best_f1_score: 0.9487; train_kl_reg_loss: 189.2483; train_edge_recon_loss: 102573.8880; train_gene_expr_recon_loss: 97097.0651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199860.1979; train_optim_loss: 199860.1979; val_kl_reg_loss: 184.3693; val_edge_recon_loss: 103052.6016; val_gene_expr_recon_loss: 96592.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 199829.2812; val_optim_loss: 199829.2812
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8929; val_auprc_score: 0.9743; val_best_acc_score: 0.9016; val_best_f1_score: 0.9435; train_kl_reg_loss: 189.6464; train_edge_recon_loss: 101605.1875; train_gene_expr_recon_loss: 97371.4323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199166.2708; train_optim_loss: 199166.2708; val_kl_reg_loss: 184.5543; val_edge_recon_loss: 110114.2500; val_gene_expr_recon_loss: 96583.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206881.8750; val_optim_loss: 206881.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8887; val_auprc_score: 0.9742; val_best_acc_score: 0.8984; val_best_f1_score: 0.9416; train_kl_reg_loss: 189.4478; train_edge_recon_loss: 100486.1120; train_gene_expr_recon_loss: 97646.7552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198322.3125; train_optim_loss: 198322.3125; val_kl_reg_loss: 185.2844; val_edge_recon_loss: 111380.5938; val_gene_expr_recon_loss: 96582.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208147.9844; val_optim_loss: 208147.9844
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8752; val_auprc_score: 0.9671; val_best_acc_score: 0.9025; val_best_f1_score: 0.9440; train_kl_reg_loss: 189.3582; train_edge_recon_loss: 99489.6745; train_gene_expr_recon_loss: 97566.2760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197245.3021; train_optim_loss: 197245.3021; val_kl_reg_loss: 184.2823; val_edge_recon_loss: 109392.8672; val_gene_expr_recon_loss: 96581.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206158.3125; val_optim_loss: 206158.3125
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8838; val_auprc_score: 0.9694; val_best_acc_score: 0.9006; val_best_f1_score: 0.9434; train_kl_reg_loss: 189.3999; train_edge_recon_loss: 99288.2057; train_gene_expr_recon_loss: 97228.7578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196706.3646; train_optim_loss: 196706.3646; val_kl_reg_loss: 184.8173; val_edge_recon_loss: 104113.0312; val_gene_expr_recon_loss: 96580.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200878.0625; val_optim_loss: 200878.0625

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 13 sec.
Using best model state, which was in epoch 14.

--- MODEL EVALUATION ---
Val AUROC score: 0.8647
Val AUPRC score: 0.9575
Val best accuracy score: 0.9000
Val best F1 score: 0.9426
Val gene expr MSE score: 1.4159
Duration of model training in run 8: 0 hours, 0 minutes and 14 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 27378
Number of validation edges: 3041
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9379; val_auprc_score: 0.9756; val_best_acc_score: 0.9052; val_best_f1_score: 0.9466; train_kl_reg_loss: 69.6227; train_edge_recon_loss: 101029.0430; train_gene_expr_recon_loss: 136334.4648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237433.1367; train_optim_loss: 237433.1367; val_kl_reg_loss: 162.9797; val_edge_recon_loss: 119673.8984; val_gene_expr_recon_loss: 117642.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237479.7188; val_optim_loss: 237479.7188
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9157; val_auprc_score: 0.9751; val_best_acc_score: 0.8838; val_best_f1_score: 0.9359; train_kl_reg_loss: 263.9706; train_edge_recon_loss: 103379.9121; train_gene_expr_recon_loss: 108027.3887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211671.2734; train_optim_loss: 211671.2734; val_kl_reg_loss: 370.6204; val_edge_recon_loss: 117722.0625; val_gene_expr_recon_loss: 105942.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224035.2500; val_optim_loss: 224035.2500
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9219; val_auprc_score: 0.9753; val_best_acc_score: 0.9046; val_best_f1_score: 0.9457; train_kl_reg_loss: 370.8443; train_edge_recon_loss: 103673.6113; train_gene_expr_recon_loss: 101358.4727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205402.9297; train_optim_loss: 205402.9297; val_kl_reg_loss: 324.3766; val_edge_recon_loss: 122861.0000; val_gene_expr_recon_loss: 102289.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 225474.8438; val_optim_loss: 225474.8438
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9134; val_auprc_score: 0.9794; val_best_acc_score: 0.9124; val_best_f1_score: 0.9504; train_kl_reg_loss: 282.4221; train_edge_recon_loss: 101421.6680; train_gene_expr_recon_loss: 98754.2539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200458.3398; train_optim_loss: 200458.3398; val_kl_reg_loss: 202.2712; val_edge_recon_loss: 109789.4141; val_gene_expr_recon_loss: 100974.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210965.6875; val_optim_loss: 210965.6875
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8924; val_auprc_score: 0.9722; val_best_acc_score: 0.8992; val_best_f1_score: 0.9421; train_kl_reg_loss: 179.4153; train_edge_recon_loss: 100973.3555; train_gene_expr_recon_loss: 96582.9551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197735.7266; train_optim_loss: 197735.7266; val_kl_reg_loss: 151.8207; val_edge_recon_loss: 116651.4219; val_gene_expr_recon_loss: 100265.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217068.7031; val_optim_loss: 217068.7031
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8807; val_auprc_score: 0.9688; val_best_acc_score: 0.9003; val_best_f1_score: 0.9432; train_kl_reg_loss: 155.4886; train_edge_recon_loss: 100221.6055; train_gene_expr_recon_loss: 96610.7832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196987.8711; train_optim_loss: 196987.8711; val_kl_reg_loss: 163.2256; val_edge_recon_loss: 106733.0547; val_gene_expr_recon_loss: 99728.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206624.7656; val_optim_loss: 206624.7656
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8725; val_auprc_score: 0.9686; val_best_acc_score: 0.8892; val_best_f1_score: 0.9383; train_kl_reg_loss: 180.3565; train_edge_recon_loss: 100097.6172; train_gene_expr_recon_loss: 96018.2871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196296.2656; train_optim_loss: 196296.2656; val_kl_reg_loss: 204.4239; val_edge_recon_loss: 105203.9453; val_gene_expr_recon_loss: 99250.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204659.1875; val_optim_loss: 204659.1875
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8618; val_auprc_score: 0.9659; val_best_acc_score: 0.8894; val_best_f1_score: 0.9381; train_kl_reg_loss: 246.1071; train_edge_recon_loss: 99621.4629; train_gene_expr_recon_loss: 95724.6582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195592.2305; train_optim_loss: 195592.2305; val_kl_reg_loss: 287.3661; val_edge_recon_loss: 99262.7969; val_gene_expr_recon_loss: 98800.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198351.0938; val_optim_loss: 198351.0938
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8531; val_auprc_score: 0.9597; val_best_acc_score: 0.8825; val_best_f1_score: 0.9343; train_kl_reg_loss: 343.9418; train_edge_recon_loss: 99467.4238; train_gene_expr_recon_loss: 96148.7148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195960.0781; train_optim_loss: 195960.0781; val_kl_reg_loss: 437.1219; val_edge_recon_loss: 101016.8359; val_gene_expr_recon_loss: 98349.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 199803.4062; val_optim_loss: 199803.4062
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8441; val_auprc_score: 0.9594; val_best_acc_score: 0.8877; val_best_f1_score: 0.9374; train_kl_reg_loss: 523.8363; train_edge_recon_loss: 95288.6875; train_gene_expr_recon_loss: 93674.8848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189487.4062; train_optim_loss: 189487.4062; val_kl_reg_loss: 650.7122; val_edge_recon_loss: 93966.3438; val_gene_expr_recon_loss: 97970.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192587.4688; val_optim_loss: 192587.4688
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8523; val_auprc_score: 0.9541; val_best_acc_score: 0.8854; val_best_f1_score: 0.9350; train_kl_reg_loss: 792.1595; train_edge_recon_loss: 92765.0996; train_gene_expr_recon_loss: 94843.9238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188401.1797; train_optim_loss: 188401.1797; val_kl_reg_loss: 1023.5351; val_edge_recon_loss: 93077.7266; val_gene_expr_recon_loss: 97648.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191750.2500; val_optim_loss: 191750.2500
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8694; val_auprc_score: 0.9645; val_best_acc_score: 0.9023; val_best_f1_score: 0.9440; train_kl_reg_loss: 1215.0224; train_edge_recon_loss: 87134.9570; train_gene_expr_recon_loss: 94771.8496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183121.8320; train_optim_loss: 183121.8320; val_kl_reg_loss: 1494.7102; val_edge_recon_loss: 88512.6016; val_gene_expr_recon_loss: 97445.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187452.9219; val_optim_loss: 187452.9219
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8708; val_auprc_score: 0.9635; val_best_acc_score: 0.9054; val_best_f1_score: 0.9467; train_kl_reg_loss: 1704.2208; train_edge_recon_loss: 82993.3242; train_gene_expr_recon_loss: 94278.8203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178976.3633; train_optim_loss: 178976.3633; val_kl_reg_loss: 2018.0389; val_edge_recon_loss: 85025.7812; val_gene_expr_recon_loss: 97256.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184300.7500; val_optim_loss: 184300.7500
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8688; val_auprc_score: 0.9650; val_best_acc_score: 0.9045; val_best_f1_score: 0.9462; train_kl_reg_loss: 2125.1574; train_edge_recon_loss: 85281.1113; train_gene_expr_recon_loss: 94491.0918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181897.3594; train_optim_loss: 181897.3594; val_kl_reg_loss: 2242.3652; val_edge_recon_loss: 84115.0625; val_gene_expr_recon_loss: 96923.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183281.3438; val_optim_loss: 183281.3438
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8760; val_auprc_score: 0.9690; val_best_acc_score: 0.9118; val_best_f1_score: 0.9498; train_kl_reg_loss: 2275.4970; train_edge_recon_loss: 82833.9219; train_gene_expr_recon_loss: 93653.6426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178763.0586; train_optim_loss: 178763.0586; val_kl_reg_loss: 2226.0918; val_edge_recon_loss: 83603.9141; val_gene_expr_recon_loss: 96738.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182568.1875; val_optim_loss: 182568.1875
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8794; val_auprc_score: 0.9687; val_best_acc_score: 0.9171; val_best_f1_score: 0.9532; train_kl_reg_loss: 2177.8913; train_edge_recon_loss: 83428.2812; train_gene_expr_recon_loss: 94080.9023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179687.0742; train_optim_loss: 179687.0742; val_kl_reg_loss: 2063.5852; val_edge_recon_loss: 79273.5312; val_gene_expr_recon_loss: 96494.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177831.5000; val_optim_loss: 177831.5000
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9043; val_auprc_score: 0.9723; val_best_acc_score: 0.9242; val_best_f1_score: 0.9563; train_kl_reg_loss: 2003.8362; train_edge_recon_loss: 83461.8223; train_gene_expr_recon_loss: 93305.1113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178770.7734; train_optim_loss: 178770.7734; val_kl_reg_loss: 1886.9719; val_edge_recon_loss: 82242.1719; val_gene_expr_recon_loss: 96261.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180390.7812; val_optim_loss: 180390.7812
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8956; val_auprc_score: 0.9697; val_best_acc_score: 0.9239; val_best_f1_score: 0.9565; train_kl_reg_loss: 1843.9613; train_edge_recon_loss: 81609.4531; train_gene_expr_recon_loss: 93322.6680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176776.0820; train_optim_loss: 176776.0820; val_kl_reg_loss: 1767.8090; val_edge_recon_loss: 84604.0938; val_gene_expr_recon_loss: 96079.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182451.7656; val_optim_loss: 182451.7656
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8988; val_auprc_score: 0.9707; val_best_acc_score: 0.9319; val_best_f1_score: 0.9609; train_kl_reg_loss: 1758.4454; train_edge_recon_loss: 79052.1562; train_gene_expr_recon_loss: 92905.1094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173715.7109; train_optim_loss: 173715.7109; val_kl_reg_loss: 1749.8181; val_edge_recon_loss: 78760.3906; val_gene_expr_recon_loss: 95910.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176420.6094; val_optim_loss: 176420.6094
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8946; val_auprc_score: 0.9644; val_best_acc_score: 0.9279; val_best_f1_score: 0.9585; train_kl_reg_loss: 1756.7292; train_edge_recon_loss: 77620.4375; train_gene_expr_recon_loss: 92798.7090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172175.8789; train_optim_loss: 172175.8789; val_kl_reg_loss: 1779.5836; val_edge_recon_loss: 87240.3672; val_gene_expr_recon_loss: 95763.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184783.6406; val_optim_loss: 184783.6406
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9054; val_auprc_score: 0.9728; val_best_acc_score: 0.9286; val_best_f1_score: 0.9594; train_kl_reg_loss: 1800.0067; train_edge_recon_loss: 81939.7207; train_gene_expr_recon_loss: 92703.6758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176443.4023; train_optim_loss: 176443.4023; val_kl_reg_loss: 1838.4204; val_edge_recon_loss: 80645.9531; val_gene_expr_recon_loss: 95660.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178145.1250; val_optim_loss: 178145.1250
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9080; val_auprc_score: 0.9710; val_best_acc_score: 0.9365; val_best_f1_score: 0.9635; train_kl_reg_loss: 1848.5897; train_edge_recon_loss: 80707.4512; train_gene_expr_recon_loss: 93163.2676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175719.3086; train_optim_loss: 175719.3086; val_kl_reg_loss: 1859.7686; val_edge_recon_loss: 82636.2266; val_gene_expr_recon_loss: 95540.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180036.5625; val_optim_loss: 180036.5625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9066; val_auprc_score: 0.9676; val_best_acc_score: 0.9337; val_best_f1_score: 0.9619; train_kl_reg_loss: 1855.0354; train_edge_recon_loss: 80612.7266; train_gene_expr_recon_loss: 91892.6152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174360.3789; train_optim_loss: 174360.3789; val_kl_reg_loss: 1860.0217; val_edge_recon_loss: 81781.3438; val_gene_expr_recon_loss: 95515.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179157.3438; val_optim_loss: 179157.3438
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9024; val_auprc_score: 0.9669; val_best_acc_score: 0.9304; val_best_f1_score: 0.9605; train_kl_reg_loss: 1856.7491; train_edge_recon_loss: 77988.6582; train_gene_expr_recon_loss: 92504.3301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172349.7344; train_optim_loss: 172349.7344; val_kl_reg_loss: 1859.3496; val_edge_recon_loss: 81090.6484; val_gene_expr_recon_loss: 95485.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178435.5938; val_optim_loss: 178435.5938
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9068; val_auprc_score: 0.9739; val_best_acc_score: 0.9327; val_best_f1_score: 0.9616; train_kl_reg_loss: 1862.9254; train_edge_recon_loss: 79658.7285; train_gene_expr_recon_loss: 92826.7207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174348.3711; train_optim_loss: 174348.3711; val_kl_reg_loss: 1861.1117; val_edge_recon_loss: 79635.4922; val_gene_expr_recon_loss: 95459.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176955.8438; val_optim_loss: 176955.8438

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 21 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.8856
Val AUPRC score: 0.9679
Val best accuracy score: 0.9272
Val best F1 score: 0.9588
Val gene expr MSE score: 1.3428
Duration of model training in run 9: 0 hours, 0 minutes and 22 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 27378
Number of validation edges: 3041
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9427; val_auprc_score: 0.9830; val_best_acc_score: 0.9124; val_best_f1_score: 0.9505; train_kl_reg_loss: 78.2626; train_edge_recon_loss: 102270.0957; train_gene_expr_recon_loss: 137568.4395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 239916.7969; train_optim_loss: 239916.7969; val_kl_reg_loss: 173.7095; val_edge_recon_loss: 119498.1562; val_gene_expr_recon_loss: 117133.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 236805.1406; val_optim_loss: 236805.1406
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9288; val_auprc_score: 0.9814; val_best_acc_score: 0.8917; val_best_f1_score: 0.9395; train_kl_reg_loss: 254.5712; train_edge_recon_loss: 101721.7578; train_gene_expr_recon_loss: 109603.1445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211579.4688; train_optim_loss: 211579.4688; val_kl_reg_loss: 312.6552; val_edge_recon_loss: 121012.5234; val_gene_expr_recon_loss: 105304.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 226629.9844; val_optim_loss: 226629.9844
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9091; val_auprc_score: 0.9726; val_best_acc_score: 0.9060; val_best_f1_score: 0.9466; train_kl_reg_loss: 291.2645; train_edge_recon_loss: 100128.6934; train_gene_expr_recon_loss: 102197.5723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202617.5273; train_optim_loss: 202617.5273; val_kl_reg_loss: 238.2103; val_edge_recon_loss: 110406.9219; val_gene_expr_recon_loss: 101334.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211979.6562; val_optim_loss: 211979.6562
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9148; val_auprc_score: 0.9767; val_best_acc_score: 0.9051; val_best_f1_score: 0.9449; train_kl_reg_loss: 212.7582; train_edge_recon_loss: 101941.3848; train_gene_expr_recon_loss: 98503.9199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200658.0664; train_optim_loss: 200658.0664; val_kl_reg_loss: 174.2795; val_edge_recon_loss: 120535.7969; val_gene_expr_recon_loss: 99980.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220690.9219; val_optim_loss: 220690.9219
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8811; val_auprc_score: 0.9658; val_best_acc_score: 0.9052; val_best_f1_score: 0.9459; train_kl_reg_loss: 165.9247; train_edge_recon_loss: 101199.6992; train_gene_expr_recon_loss: 98185.9121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199551.5391; train_optim_loss: 199551.5391; val_kl_reg_loss: 167.3612; val_edge_recon_loss: 108425.1953; val_gene_expr_recon_loss: 99150.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207742.5938; val_optim_loss: 207742.5938
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8786; val_auprc_score: 0.9710; val_best_acc_score: 0.8931; val_best_f1_score: 0.9400; train_kl_reg_loss: 182.2797; train_edge_recon_loss: 100002.0195; train_gene_expr_recon_loss: 96379.3594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196563.6562; train_optim_loss: 196563.6562; val_kl_reg_loss: 211.8665; val_edge_recon_loss: 104037.7578; val_gene_expr_recon_loss: 98539.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202789.2500; val_optim_loss: 202789.2500
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8620; val_auprc_score: 0.9686; val_best_acc_score: 0.8917; val_best_f1_score: 0.9392; train_kl_reg_loss: 237.4910; train_edge_recon_loss: 97934.3809; train_gene_expr_recon_loss: 96451.1602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194623.0352; train_optim_loss: 194623.0352; val_kl_reg_loss: 300.5701; val_edge_recon_loss: 99916.3906; val_gene_expr_recon_loss: 98023.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198240.4219; val_optim_loss: 198240.4219
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8629; val_auprc_score: 0.9648; val_best_acc_score: 0.8991; val_best_f1_score: 0.9433; train_kl_reg_loss: 353.0951; train_edge_recon_loss: 97893.7246; train_gene_expr_recon_loss: 96176.2461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194423.0625; train_optim_loss: 194423.0625; val_kl_reg_loss: 469.1035; val_edge_recon_loss: 90390.7578; val_gene_expr_recon_loss: 97607.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188466.8750; val_optim_loss: 188466.8750
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8387; val_auprc_score: 0.9586; val_best_acc_score: 0.8819; val_best_f1_score: 0.9355; train_kl_reg_loss: 552.4863; train_edge_recon_loss: 95514.1797; train_gene_expr_recon_loss: 94881.2285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190947.8945; train_optim_loss: 190947.8945; val_kl_reg_loss: 726.2472; val_edge_recon_loss: 92274.8438; val_gene_expr_recon_loss: 97244.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190245.1875; val_optim_loss: 190245.1875
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8635; val_auprc_score: 0.9657; val_best_acc_score: 0.8913; val_best_f1_score: 0.9395; train_kl_reg_loss: 837.3248; train_edge_recon_loss: 93308.3555; train_gene_expr_recon_loss: 95837.5273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189983.2109; train_optim_loss: 189983.2109; val_kl_reg_loss: 1027.9814; val_edge_recon_loss: 90688.5000; val_gene_expr_recon_loss: 96987.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188704.3125; val_optim_loss: 188704.3125
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8767; val_auprc_score: 0.9682; val_best_acc_score: 0.9069; val_best_f1_score: 0.9459; train_kl_reg_loss: 1147.6280; train_edge_recon_loss: 88633.1934; train_gene_expr_recon_loss: 94985.5020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184766.3242; train_optim_loss: 184766.3242; val_kl_reg_loss: 1340.4026; val_edge_recon_loss: 86522.0625; val_gene_expr_recon_loss: 96805.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184667.5625; val_optim_loss: 184667.5625
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8738; val_auprc_score: 0.9609; val_best_acc_score: 0.9067; val_best_f1_score: 0.9470; train_kl_reg_loss: 1534.1643; train_edge_recon_loss: 86123.0020; train_gene_expr_recon_loss: 93547.8008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181204.9727; train_optim_loss: 181204.9727; val_kl_reg_loss: 1854.5266; val_edge_recon_loss: 86974.9609; val_gene_expr_recon_loss: 96676.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185505.7188; val_optim_loss: 185505.7188
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8815; val_auprc_score: 0.9715; val_best_acc_score: 0.9126; val_best_f1_score: 0.9510; train_kl_reg_loss: 2037.6791; train_edge_recon_loss: 83632.0254; train_gene_expr_recon_loss: 94596.4219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180266.1211; train_optim_loss: 180266.1211; val_kl_reg_loss: 2259.0503; val_edge_recon_loss: 79719.5547; val_gene_expr_recon_loss: 96294.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178272.8438; val_optim_loss: 178272.8438
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8821; val_auprc_score: 0.9693; val_best_acc_score: 0.9208; val_best_f1_score: 0.9550; train_kl_reg_loss: 2326.9429; train_edge_recon_loss: 83394.8613; train_gene_expr_recon_loss: 93231.2363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178953.0430; train_optim_loss: 178953.0430; val_kl_reg_loss: 2325.2717; val_edge_recon_loss: 81659.3984; val_gene_expr_recon_loss: 95921.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179906.0312; val_optim_loss: 179906.0312
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9122; val_auprc_score: 0.9776; val_best_acc_score: 0.9279; val_best_f1_score: 0.9585; train_kl_reg_loss: 2307.9709; train_edge_recon_loss: 81237.1211; train_gene_expr_recon_loss: 93405.4551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176950.5469; train_optim_loss: 176950.5469; val_kl_reg_loss: 2174.5518; val_edge_recon_loss: 81786.7656; val_gene_expr_recon_loss: 95695.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179656.9062; val_optim_loss: 179656.9062
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8989; val_auprc_score: 0.9740; val_best_acc_score: 0.9343; val_best_f1_score: 0.9626; train_kl_reg_loss: 2078.8416; train_edge_recon_loss: 81393.3535; train_gene_expr_recon_loss: 94101.6992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177573.8945; train_optim_loss: 177573.8945; val_kl_reg_loss: 1901.0322; val_edge_recon_loss: 78509.3750; val_gene_expr_recon_loss: 95442.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175852.7188; val_optim_loss: 175852.7188
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9174; val_auprc_score: 0.9795; val_best_acc_score: 0.9331; val_best_f1_score: 0.9614; train_kl_reg_loss: 1846.3190; train_edge_recon_loss: 80388.7617; train_gene_expr_recon_loss: 93986.7363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176221.8125; train_optim_loss: 176221.8125; val_kl_reg_loss: 1736.0905; val_edge_recon_loss: 82643.8359; val_gene_expr_recon_loss: 95289.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179669.5000; val_optim_loss: 179669.5000
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9115; val_auprc_score: 0.9749; val_best_acc_score: 0.9368; val_best_f1_score: 0.9643; train_kl_reg_loss: 1730.1731; train_edge_recon_loss: 80870.2910; train_gene_expr_recon_loss: 93532.7090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176133.1680; train_optim_loss: 176133.1680; val_kl_reg_loss: 1715.4910; val_edge_recon_loss: 75639.5781; val_gene_expr_recon_loss: 95133.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172488.3281; val_optim_loss: 172488.3281
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9054; val_auprc_score: 0.9708; val_best_acc_score: 0.9371; val_best_f1_score: 0.9642; train_kl_reg_loss: 1758.6385; train_edge_recon_loss: 77961.1035; train_gene_expr_recon_loss: 93123.0469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172842.7852; train_optim_loss: 172842.7852; val_kl_reg_loss: 1795.6537; val_edge_recon_loss: 76073.2656; val_gene_expr_recon_loss: 94985.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172854.4688; val_optim_loss: 172854.4688
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9110; val_auprc_score: 0.9725; val_best_acc_score: 0.9317; val_best_f1_score: 0.9606; train_kl_reg_loss: 1848.3686; train_edge_recon_loss: 81021.7383; train_gene_expr_recon_loss: 93311.9336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176182.0391; train_optim_loss: 176182.0391; val_kl_reg_loss: 1864.2268; val_edge_recon_loss: 82084.8281; val_gene_expr_recon_loss: 94793.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178742.8125; val_optim_loss: 178742.8125
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9276; val_auprc_score: 0.9744; val_best_acc_score: 0.9430; val_best_f1_score: 0.9673; train_kl_reg_loss: 1901.5488; train_edge_recon_loss: 78903.1641; train_gene_expr_recon_loss: 93219.0293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174023.7422; train_optim_loss: 174023.7422; val_kl_reg_loss: 1929.6770; val_edge_recon_loss: 75040.5703; val_gene_expr_recon_loss: 94592.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171563.0625; val_optim_loss: 171563.0625
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9127; val_auprc_score: 0.9745; val_best_acc_score: 0.9377; val_best_f1_score: 0.9647; train_kl_reg_loss: 1943.6020; train_edge_recon_loss: 79976.8008; train_gene_expr_recon_loss: 92817.3496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174737.7578; train_optim_loss: 174737.7578; val_kl_reg_loss: 1913.0316; val_edge_recon_loss: 77878.2422; val_gene_expr_recon_loss: 94407.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174198.5000; val_optim_loss: 174198.5000
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9133; val_auprc_score: 0.9785; val_best_acc_score: 0.9376; val_best_f1_score: 0.9646; train_kl_reg_loss: 1907.6648; train_edge_recon_loss: 81644.9297; train_gene_expr_recon_loss: 92876.0723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176428.6641; train_optim_loss: 176428.6641; val_kl_reg_loss: 1860.4800; val_edge_recon_loss: 75635.1719; val_gene_expr_recon_loss: 94350.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171845.8125; val_optim_loss: 171845.8125
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9135; val_auprc_score: 0.9700; val_best_acc_score: 0.9400; val_best_f1_score: 0.9657; train_kl_reg_loss: 1853.0487; train_edge_recon_loss: 78810.9082; train_gene_expr_recon_loss: 93281.2793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173945.2383; train_optim_loss: 173945.2383; val_kl_reg_loss: 1816.9348; val_edge_recon_loss: 80371.6250; val_gene_expr_recon_loss: 94193.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176382.0625; val_optim_loss: 176382.0625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9205; val_auprc_score: 0.9737; val_best_acc_score: 0.9389; val_best_f1_score: 0.9648; train_kl_reg_loss: 1832.9701; train_edge_recon_loss: 79982.5234; train_gene_expr_recon_loss: 92727.4707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174542.9688; train_optim_loss: 174542.9688; val_kl_reg_loss: 1805.4446; val_edge_recon_loss: 83996.4062; val_gene_expr_recon_loss: 94170.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179972.1562; val_optim_loss: 179972.1562
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9212; val_auprc_score: 0.9743; val_best_acc_score: 0.9367; val_best_f1_score: 0.9631; train_kl_reg_loss: 1810.4438; train_edge_recon_loss: 81570.2422; train_gene_expr_recon_loss: 92193.8496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175574.5391; train_optim_loss: 175574.5391; val_kl_reg_loss: 1802.4031; val_edge_recon_loss: 84101.3906; val_gene_expr_recon_loss: 94155.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180059.7188; val_optim_loss: 180059.7188
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9244; val_auprc_score: 0.9817; val_best_acc_score: 0.9448; val_best_f1_score: 0.9685; train_kl_reg_loss: 1826.8324; train_edge_recon_loss: 79283.2871; train_gene_expr_recon_loss: 92148.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173259.0820; train_optim_loss: 173259.0820; val_kl_reg_loss: 1809.3464; val_edge_recon_loss: 74494.4922; val_gene_expr_recon_loss: 94138.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170442.5312; val_optim_loss: 170442.5312
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9261; val_auprc_score: 0.9790; val_best_acc_score: 0.9393; val_best_f1_score: 0.9647; train_kl_reg_loss: 1822.7379; train_edge_recon_loss: 79035.7051; train_gene_expr_recon_loss: 91785.4023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172643.8477; train_optim_loss: 172643.8477; val_kl_reg_loss: 1818.9021; val_edge_recon_loss: 82377.4141; val_gene_expr_recon_loss: 94107.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178304.2812; val_optim_loss: 178304.2812
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9298; val_auprc_score: 0.9807; val_best_acc_score: 0.9456; val_best_f1_score: 0.9690; train_kl_reg_loss: 1827.0288; train_edge_recon_loss: 79399.4609; train_gene_expr_recon_loss: 91911.0977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173137.5898; train_optim_loss: 173137.5898; val_kl_reg_loss: 1818.8660; val_edge_recon_loss: 74356.6641; val_gene_expr_recon_loss: 94077.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170253.0312; val_optim_loss: 170253.0312
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9081; val_auprc_score: 0.9662; val_best_acc_score: 0.9404; val_best_f1_score: 0.9658; train_kl_reg_loss: 1829.6295; train_edge_recon_loss: 79786.7637; train_gene_expr_recon_loss: 92257.5020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173873.8945; train_optim_loss: 173873.8945; val_kl_reg_loss: 1824.3433; val_edge_recon_loss: 79389.6250; val_gene_expr_recon_loss: 94056.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175270.1875; val_optim_loss: 175270.1875
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9078; val_auprc_score: 0.9736; val_best_acc_score: 0.9391; val_best_f1_score: 0.9650; train_kl_reg_loss: 1832.6928; train_edge_recon_loss: 79794.6660; train_gene_expr_recon_loss: 92186.6680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173814.0273; train_optim_loss: 173814.0273; val_kl_reg_loss: 1826.1226; val_edge_recon_loss: 80571.9375; val_gene_expr_recon_loss: 94038.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176436.6875; val_optim_loss: 176436.6875
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9115; val_auprc_score: 0.9714; val_best_acc_score: 0.9422; val_best_f1_score: 0.9667; train_kl_reg_loss: 1849.0136; train_edge_recon_loss: 80674.4766; train_gene_expr_recon_loss: 92489.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175013.4102; train_optim_loss: 175013.4102; val_kl_reg_loss: 1829.5012; val_edge_recon_loss: 77376.7109; val_gene_expr_recon_loss: 94025.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173231.5625; val_optim_loss: 173231.5625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9084; val_auprc_score: 0.9691; val_best_acc_score: 0.9352; val_best_f1_score: 0.9625; train_kl_reg_loss: 1839.7776; train_edge_recon_loss: 81190.6367; train_gene_expr_recon_loss: 92013.6387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175044.0547; train_optim_loss: 175044.0547; val_kl_reg_loss: 1826.3303; val_edge_recon_loss: 85517.1719; val_gene_expr_recon_loss: 94023.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181367.2188; val_optim_loss: 181367.2188
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9212; val_auprc_score: 0.9747; val_best_acc_score: 0.9409; val_best_f1_score: 0.9659; train_kl_reg_loss: 1843.6238; train_edge_recon_loss: 79541.3359; train_gene_expr_recon_loss: 91685.0879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173070.0430; train_optim_loss: 173070.0430; val_kl_reg_loss: 1829.9561; val_edge_recon_loss: 79661.5312; val_gene_expr_recon_loss: 94022.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175513.6094; val_optim_loss: 175513.6094
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
702
<class 'int'>
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9230; val_auprc_score: 0.9714; val_best_acc_score: 0.9375; val_best_f1_score: 0.9637; train_kl_reg_loss: 1841.8843; train_edge_recon_loss: 78753.8242; train_gene_expr_recon_loss: 92114.4941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172710.1992; train_optim_loss: 172710.1992; val_kl_reg_loss: 1829.8430; val_edge_recon_loss: 83553.2656; val_gene_expr_recon_loss: 94020.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179403.7188; val_optim_loss: 179403.7188

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 31 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
Val AUROC score: 0.9290
Val AUPRC score: 0.9744
Val best accuracy score: 0.9422
Val best F1 score: 0.9670
Val gene expr MSE score: 1.2745
Duration of model training in run 10: 0 hours, 0 minutes and 33 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
First script finished. Launching follow up script.
Run timestamp: 01062023_143552.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_10pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-attention_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-attention', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 10989
Number of validation edges: 1220
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9042; val_auprc_score: 0.9790; val_best_acc_score: 0.9066; val_best_f1_score: 0.9468; train_kl_reg_loss: 55.1031; train_edge_recon_loss: 103764.6992; train_gene_expr_recon_loss: 141338.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 245158.3984; train_optim_loss: 245158.3984; val_kl_reg_loss: 81.4713; val_edge_recon_loss: 110508.0781; val_gene_expr_recon_loss: 123552.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234141.8438; val_optim_loss: 234141.8438
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8852; val_auprc_score: 0.9706; val_best_acc_score: 0.8925; val_best_f1_score: 0.9383; train_kl_reg_loss: 104.5419; train_edge_recon_loss: 104026.1406; train_gene_expr_recon_loss: 120732.3945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224863.0781; train_optim_loss: 224863.0781; val_kl_reg_loss: 170.9759; val_edge_recon_loss: 117131.4922; val_gene_expr_recon_loss: 112929.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 230232.3438; val_optim_loss: 230232.3438
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8983; val_auprc_score: 0.9798; val_best_acc_score: 0.8806; val_best_f1_score: 0.9334; train_kl_reg_loss: 202.2508; train_edge_recon_loss: 103227.6094; train_gene_expr_recon_loss: 111454.3281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214884.1875; train_optim_loss: 214884.1875; val_kl_reg_loss: 266.2972; val_edge_recon_loss: 117942.9375; val_gene_expr_recon_loss: 106713.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224922.7812; val_optim_loss: 224922.7812
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8774; val_auprc_score: 0.9652; val_best_acc_score: 0.8858; val_best_f1_score: 0.9349; train_kl_reg_loss: 283.0683; train_edge_recon_loss: 102812.1641; train_gene_expr_recon_loss: 105908.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209004.0703; train_optim_loss: 209004.0703; val_kl_reg_loss: 279.7302; val_edge_recon_loss: 127277.2109; val_gene_expr_recon_loss: 103341.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 230898.3750; val_optim_loss: 230898.3750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8923; val_auprc_score: 0.9765; val_best_acc_score: 0.8844; val_best_f1_score: 0.9343; train_kl_reg_loss: 277.9634; train_edge_recon_loss: 100018.4688; train_gene_expr_recon_loss: 102786.0352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203082.4688; train_optim_loss: 203082.4688; val_kl_reg_loss: 242.1829; val_edge_recon_loss: 121493.4922; val_gene_expr_recon_loss: 101477.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 223213.0938; val_optim_loss: 223213.0938
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8630; val_auprc_score: 0.9683; val_best_acc_score: 0.8952; val_best_f1_score: 0.9421; train_kl_reg_loss: 236.1479; train_edge_recon_loss: 103291.8828; train_gene_expr_recon_loss: 99781.8711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203309.8984; train_optim_loss: 203309.8984; val_kl_reg_loss: 197.8292; val_edge_recon_loss: 103086.1719; val_gene_expr_recon_loss: 100473.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 203757.7344; val_optim_loss: 203757.7344
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8695; val_auprc_score: 0.9643; val_best_acc_score: 0.8777; val_best_f1_score: 0.9303; train_kl_reg_loss: 197.2554; train_edge_recon_loss: 100254.3203; train_gene_expr_recon_loss: 100781.9141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201233.4922; train_optim_loss: 201233.4922; val_kl_reg_loss: 170.7806; val_edge_recon_loss: 120964.9453; val_gene_expr_recon_loss: 99927.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221063.5156; val_optim_loss: 221063.5156
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8426; val_auprc_score: 0.9610; val_best_acc_score: 0.8852; val_best_f1_score: 0.9364; train_kl_reg_loss: 173.9011; train_edge_recon_loss: 101259.6758; train_gene_expr_recon_loss: 99251.4922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200685.0625; train_optim_loss: 200685.0625; val_kl_reg_loss: 171.6493; val_edge_recon_loss: 106991.0078; val_gene_expr_recon_loss: 99576.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206738.9375; val_optim_loss: 206738.9375
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8250; val_auprc_score: 0.9574; val_best_acc_score: 0.8855; val_best_f1_score: 0.9357; train_kl_reg_loss: 185.8059; train_edge_recon_loss: 96853.0938; train_gene_expr_recon_loss: 99340.1016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196379.0000; train_optim_loss: 196379.0000; val_kl_reg_loss: 206.6092; val_edge_recon_loss: 103240.5547; val_gene_expr_recon_loss: 99297.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202744.1562; val_optim_loss: 202744.1562
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7914; val_auprc_score: 0.9513; val_best_acc_score: 0.8924; val_best_f1_score: 0.9405; train_kl_reg_loss: 232.5988; train_edge_recon_loss: 95483.5508; train_gene_expr_recon_loss: 99542.2461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195258.3984; train_optim_loss: 195258.3984; val_kl_reg_loss: 287.1494; val_edge_recon_loss: 92559.2656; val_gene_expr_recon_loss: 99027.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191873.6875; val_optim_loss: 191873.6875
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8108; val_auprc_score: 0.9586; val_best_acc_score: 0.8926; val_best_f1_score: 0.9408; train_kl_reg_loss: 326.7116; train_edge_recon_loss: 94132.8633; train_gene_expr_recon_loss: 98035.7852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192495.3594; train_optim_loss: 192495.3594; val_kl_reg_loss: 418.6234; val_edge_recon_loss: 93760.0547; val_gene_expr_recon_loss: 98750.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192928.7344; val_optim_loss: 192928.7344
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8356; val_auprc_score: 0.9631; val_best_acc_score: 0.9000; val_best_f1_score: 0.9443; train_kl_reg_loss: 482.7527; train_edge_recon_loss: 93944.9336; train_gene_expr_recon_loss: 99150.4141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193578.1094; train_optim_loss: 193578.1094; val_kl_reg_loss: 601.0513; val_edge_recon_loss: 90759.2969; val_gene_expr_recon_loss: 98469.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189830.2812; val_optim_loss: 189830.2812
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8137; val_auprc_score: 0.9586; val_best_acc_score: 0.8887; val_best_f1_score: 0.9382; train_kl_reg_loss: 687.8372; train_edge_recon_loss: 92059.7734; train_gene_expr_recon_loss: 98350.5195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191098.1250; train_optim_loss: 191098.1250; val_kl_reg_loss: 842.8535; val_edge_recon_loss: 92152.5625; val_gene_expr_recon_loss: 98168.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191163.4375; val_optim_loss: 191163.4375
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7993; val_auprc_score: 0.9533; val_best_acc_score: 0.8789; val_best_f1_score: 0.9328; train_kl_reg_loss: 934.6589; train_edge_recon_loss: 91460.6953; train_gene_expr_recon_loss: 98418.4570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190813.8125; train_optim_loss: 190813.8125; val_kl_reg_loss: 1099.8799; val_edge_recon_loss: 94854.1172; val_gene_expr_recon_loss: 97871.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193825.2188; val_optim_loss: 193825.2188
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8035; val_auprc_score: 0.9553; val_best_acc_score: 0.8818; val_best_f1_score: 0.9350; train_kl_reg_loss: 1219.1075; train_edge_recon_loss: 97392.6484; train_gene_expr_recon_loss: 97469.4336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196081.1875; train_optim_loss: 196081.1875; val_kl_reg_loss: 1404.6587; val_edge_recon_loss: 90919.3125; val_gene_expr_recon_loss: 97615.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189939.3125; val_optim_loss: 189939.3125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7981; val_auprc_score: 0.9530; val_best_acc_score: 0.8937; val_best_f1_score: 0.9411; train_kl_reg_loss: 1466.1953; train_edge_recon_loss: 89722.8516; train_gene_expr_recon_loss: 98009.6484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189198.6875; train_optim_loss: 189198.6875; val_kl_reg_loss: 1438.3940; val_edge_recon_loss: 87942.0312; val_gene_expr_recon_loss: 97586.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186967.2656; val_optim_loss: 186967.2656
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8170; val_auprc_score: 0.9571; val_best_acc_score: 0.8809; val_best_f1_score: 0.9335; train_kl_reg_loss: 1507.1833; train_edge_recon_loss: 90464.5391; train_gene_expr_recon_loss: 98044.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190015.8438; train_optim_loss: 190015.8438; val_kl_reg_loss: 1456.7622; val_edge_recon_loss: 94822.6953; val_gene_expr_recon_loss: 97553.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193832.5625; val_optim_loss: 193832.5625
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8158; val_auprc_score: 0.9570; val_best_acc_score: 0.8898; val_best_f1_score: 0.9388; train_kl_reg_loss: 1511.0410; train_edge_recon_loss: 93013.3359; train_gene_expr_recon_loss: 97008.4922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191532.8750; train_optim_loss: 191532.8750; val_kl_reg_loss: 1481.4634; val_edge_recon_loss: 90877.8047; val_gene_expr_recon_loss: 97515.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189874.3125; val_optim_loss: 189874.3125
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8376; val_auprc_score: 0.9633; val_best_acc_score: 0.9041; val_best_f1_score: 0.9465; train_kl_reg_loss: 1533.6716; train_edge_recon_loss: 89872.1172; train_gene_expr_recon_loss: 96892.8867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188298.6719; train_optim_loss: 188298.6719; val_kl_reg_loss: 1516.3163; val_edge_recon_loss: 80664.8516; val_gene_expr_recon_loss: 97475.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179656.9375; val_optim_loss: 179656.9375
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8106; val_auprc_score: 0.9617; val_best_acc_score: 0.8911; val_best_f1_score: 0.9399; train_kl_reg_loss: 1559.1448; train_edge_recon_loss: 91902.3398; train_gene_expr_recon_loss: 97862.4570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191323.9453; train_optim_loss: 191323.9453; val_kl_reg_loss: 1521.0619; val_edge_recon_loss: 85917.1641; val_gene_expr_recon_loss: 97436.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184874.6875; val_optim_loss: 184874.6875
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8109; val_auprc_score: 0.9509; val_best_acc_score: 0.8774; val_best_f1_score: 0.9312; train_kl_reg_loss: 1563.3463; train_edge_recon_loss: 92065.7773; train_gene_expr_recon_loss: 96036.0547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189665.1797; train_optim_loss: 189665.1797; val_kl_reg_loss: 1538.0277; val_edge_recon_loss: 98829.1250; val_gene_expr_recon_loss: 97397.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197765.1406; val_optim_loss: 197765.1406
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.7762; val_auprc_score: 0.9537; val_best_acc_score: 0.8852; val_best_f1_score: 0.9374; train_kl_reg_loss: 1585.8842; train_edge_recon_loss: 91242.3828; train_gene_expr_recon_loss: 97255.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190083.4531; train_optim_loss: 190083.4531; val_kl_reg_loss: 1561.9930; val_edge_recon_loss: 87568.5859; val_gene_expr_recon_loss: 97360.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186491.1875; val_optim_loss: 186491.1875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8069; val_auprc_score: 0.9608; val_best_acc_score: 0.9031; val_best_f1_score: 0.9471; train_kl_reg_loss: 1595.0394; train_edge_recon_loss: 91007.2305; train_gene_expr_recon_loss: 96909.2930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189511.5625; train_optim_loss: 189511.5625; val_kl_reg_loss: 1562.2856; val_edge_recon_loss: 79339.4453; val_gene_expr_recon_loss: 97356.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178258.5938; val_optim_loss: 178258.5938
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.7950; val_auprc_score: 0.9452; val_best_acc_score: 0.8821; val_best_f1_score: 0.9345; train_kl_reg_loss: 1596.8544; train_edge_recon_loss: 92819.5820; train_gene_expr_recon_loss: 96857.3789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191273.8125; train_optim_loss: 191273.8125; val_kl_reg_loss: 1568.5352; val_edge_recon_loss: 92926.7734; val_gene_expr_recon_loss: 97353.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191848.3750; val_optim_loss: 191848.3750
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8071; val_auprc_score: 0.9542; val_best_acc_score: 0.8923; val_best_f1_score: 0.9406; train_kl_reg_loss: 1604.9542; train_edge_recon_loss: 91126.5039; train_gene_expr_recon_loss: 97458.5469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190190.0078; train_optim_loss: 190190.0078; val_kl_reg_loss: 1560.3572; val_edge_recon_loss: 85811.7891; val_gene_expr_recon_loss: 97349.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184721.4062; val_optim_loss: 184721.4062
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.7928; val_auprc_score: 0.9460; val_best_acc_score: 0.8742; val_best_f1_score: 0.9301; train_kl_reg_loss: 1593.5381; train_edge_recon_loss: 88510.8555; train_gene_expr_recon_loss: 96852.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186956.7578; train_optim_loss: 186956.7578; val_kl_reg_loss: 1551.6273; val_edge_recon_loss: 95855.3125; val_gene_expr_recon_loss: 97345.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194752.3906; val_optim_loss: 194752.3906

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8201; val_auprc_score: 0.9565; val_best_acc_score: 0.8851; val_best_f1_score: 0.9359; train_kl_reg_loss: 1609.5609; train_edge_recon_loss: 88494.5234; train_gene_expr_recon_loss: 96500.2969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186604.3828; train_optim_loss: 186604.3828; val_kl_reg_loss: 1566.1259; val_edge_recon_loss: 89896.9844; val_gene_expr_recon_loss: 97345.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188808.1562; val_optim_loss: 188808.1562
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.7975; val_auprc_score: 0.9576; val_best_acc_score: 0.8843; val_best_f1_score: 0.9363; train_kl_reg_loss: 1599.6805; train_edge_recon_loss: 91391.5742; train_gene_expr_recon_loss: 97166.1055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190157.3594; train_optim_loss: 190157.3594; val_kl_reg_loss: 1548.7310; val_edge_recon_loss: 88942.1641; val_gene_expr_recon_loss: 97344.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187835.5625; val_optim_loss: 187835.5625
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.7740; val_auprc_score: 0.9444; val_best_acc_score: 0.8817; val_best_f1_score: 0.9354; train_kl_reg_loss: 1597.2148; train_edge_recon_loss: 87549.7734; train_gene_expr_recon_loss: 96310.8555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185457.8438; train_optim_loss: 185457.8438; val_kl_reg_loss: 1554.2854; val_edge_recon_loss: 92001.0156; val_gene_expr_recon_loss: 97344.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190899.5938; val_optim_loss: 190899.5938

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 14 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
Val AUROC score: 0.7965
Val AUPRC score: 0.9456
Val best accuracy score: 0.8781
Val best F1 score: 0.9319
Val gene expr MSE score: 1.4245
Duration of model training in run 1: 0 hours, 0 minutes and 18 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 10989
Number of validation edges: 1220
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9014; val_auprc_score: 0.9746; val_best_acc_score: 0.8900; val_best_f1_score: 0.9381; train_kl_reg_loss: 57.8858; train_edge_recon_loss: 101149.4883; train_gene_expr_recon_loss: 143051.8203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 244259.1953; train_optim_loss: 244259.1953; val_kl_reg_loss: 76.2494; val_edge_recon_loss: 120465.3594; val_gene_expr_recon_loss: 124311.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244853.0312; val_optim_loss: 244853.0312
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9050; val_auprc_score: 0.9803; val_best_acc_score: 0.8870; val_best_f1_score: 0.9358; train_kl_reg_loss: 95.8962; train_edge_recon_loss: 104336.6914; train_gene_expr_recon_loss: 120708.6953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 225141.2812; train_optim_loss: 225141.2812; val_kl_reg_loss: 162.6320; val_edge_recon_loss: 118021.1641; val_gene_expr_recon_loss: 113293.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 231477.2188; val_optim_loss: 231477.2188
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8913; val_auprc_score: 0.9776; val_best_acc_score: 0.8809; val_best_f1_score: 0.9342; train_kl_reg_loss: 199.5382; train_edge_recon_loss: 101260.2969; train_gene_expr_recon_loss: 111331.7305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212791.5625; train_optim_loss: 212791.5625; val_kl_reg_loss: 277.0923; val_edge_recon_loss: 120379.0938; val_gene_expr_recon_loss: 106862.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227519.1562; val_optim_loss: 227519.1562
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9104; val_auprc_score: 0.9794; val_best_acc_score: 0.8969; val_best_f1_score: 0.9432; train_kl_reg_loss: 292.7081; train_edge_recon_loss: 99904.4727; train_gene_expr_recon_loss: 105703.2695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205900.4531; train_optim_loss: 205900.4531; val_kl_reg_loss: 292.4776; val_edge_recon_loss: 110463.1094; val_gene_expr_recon_loss: 103504.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214260.4375; val_optim_loss: 214260.4375
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8865; val_auprc_score: 0.9738; val_best_acc_score: 0.9095; val_best_f1_score: 0.9495; train_kl_reg_loss: 292.1869; train_edge_recon_loss: 101467.7891; train_gene_expr_recon_loss: 103519.6289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205279.6016; train_optim_loss: 205279.6016; val_kl_reg_loss: 253.5117; val_edge_recon_loss: 103992.2656; val_gene_expr_recon_loss: 101670.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205916.3750; val_optim_loss: 205916.3750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8998; val_auprc_score: 0.9785; val_best_acc_score: 0.8990; val_best_f1_score: 0.9428; train_kl_reg_loss: 250.2101; train_edge_recon_loss: 101114.1875; train_gene_expr_recon_loss: 101218.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202582.4297; train_optim_loss: 202582.4297; val_kl_reg_loss: 210.0289; val_edge_recon_loss: 117783.6172; val_gene_expr_recon_loss: 100768.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218761.6875; val_optim_loss: 218761.6875
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8897; val_auprc_score: 0.9764; val_best_acc_score: 0.9059; val_best_f1_score: 0.9473; train_kl_reg_loss: 207.8715; train_edge_recon_loss: 102923.4453; train_gene_expr_recon_loss: 100569.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203701.2656; train_optim_loss: 203701.2656; val_kl_reg_loss: 177.1143; val_edge_recon_loss: 105303.7734; val_gene_expr_recon_loss: 100331.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205812.5625; val_optim_loss: 205812.5625
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8927; val_auprc_score: 0.9737; val_best_acc_score: 0.9003; val_best_f1_score: 0.9431; train_kl_reg_loss: 175.8756; train_edge_recon_loss: 100618.9258; train_gene_expr_recon_loss: 100556.0195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201350.8125; train_optim_loss: 201350.8125; val_kl_reg_loss: 158.5501; val_edge_recon_loss: 116221.3047; val_gene_expr_recon_loss: 100051.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216431.1250; val_optim_loss: 216431.1250
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8695; val_auprc_score: 0.9662; val_best_acc_score: 0.8934; val_best_f1_score: 0.9403; train_kl_reg_loss: 160.7150; train_edge_recon_loss: 103491.0234; train_gene_expr_recon_loss: 99753.4531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203405.1953; train_optim_loss: 203405.1953; val_kl_reg_loss: 153.6614; val_edge_recon_loss: 106718.5312; val_gene_expr_recon_loss: 99794.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206666.5625; val_optim_loss: 206666.5625
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8712; val_auprc_score: 0.9647; val_best_acc_score: 0.9038; val_best_f1_score: 0.9451; train_kl_reg_loss: 159.4093; train_edge_recon_loss: 99173.0039; train_gene_expr_recon_loss: 99931.7070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199264.1250; train_optim_loss: 199264.1250; val_kl_reg_loss: 172.2813; val_edge_recon_loss: 110053.0547; val_gene_expr_recon_loss: 99530.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209755.6562; val_optim_loss: 209755.6562

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8781; val_auprc_score: 0.9757; val_best_acc_score: 0.9016; val_best_f1_score: 0.9451; train_kl_reg_loss: 179.0461; train_edge_recon_loss: 97150.1445; train_gene_expr_recon_loss: 99926.8945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197256.0859; train_optim_loss: 197256.0859; val_kl_reg_loss: 176.5923; val_edge_recon_loss: 101362.5781; val_gene_expr_recon_loss: 99496.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201036.0000; val_optim_loss: 201036.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8578; val_auprc_score: 0.9676; val_best_acc_score: 0.8873; val_best_f1_score: 0.9370; train_kl_reg_loss: 181.9158; train_edge_recon_loss: 101031.4531; train_gene_expr_recon_loss: 99836.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201049.7344; train_optim_loss: 201049.7344; val_kl_reg_loss: 180.0700; val_edge_recon_loss: 108805.7422; val_gene_expr_recon_loss: 99451.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208437.2031; val_optim_loss: 208437.2031
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8483; val_auprc_score: 0.9592; val_best_acc_score: 0.8955; val_best_f1_score: 0.9410; train_kl_reg_loss: 184.9735; train_edge_recon_loss: 102568.4453; train_gene_expr_recon_loss: 98896.4883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201649.9141; train_optim_loss: 201649.9141; val_kl_reg_loss: 184.1232; val_edge_recon_loss: 106048.0469; val_gene_expr_recon_loss: 99396.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205628.8125; val_optim_loss: 205628.8125
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8469; val_auprc_score: 0.9670; val_best_acc_score: 0.9022; val_best_f1_score: 0.9458; train_kl_reg_loss: 189.4958; train_edge_recon_loss: 100317.4062; train_gene_expr_recon_loss: 99012.7617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199519.6641; train_optim_loss: 199519.6641; val_kl_reg_loss: 188.8605; val_edge_recon_loss: 94967.3047; val_gene_expr_recon_loss: 99335.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194491.5000; val_optim_loss: 194491.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8577; val_auprc_score: 0.9691; val_best_acc_score: 0.8912; val_best_f1_score: 0.9388; train_kl_reg_loss: 193.8794; train_edge_recon_loss: 101085.4922; train_gene_expr_recon_loss: 98730.3516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200009.7188; train_optim_loss: 200009.7188; val_kl_reg_loss: 194.5142; val_edge_recon_loss: 105947.0703; val_gene_expr_recon_loss: 99269.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205411.3125; val_optim_loss: 205411.3125
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8169; val_auprc_score: 0.9540; val_best_acc_score: 0.9032; val_best_f1_score: 0.9462; train_kl_reg_loss: 197.0906; train_edge_recon_loss: 99264.2539; train_gene_expr_recon_loss: 98548.4727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198009.8125; train_optim_loss: 198009.8125; val_kl_reg_loss: 200.8697; val_edge_recon_loss: 94919.9922; val_gene_expr_recon_loss: 99201.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194322.2812; val_optim_loss: 194322.2812
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8515; val_auprc_score: 0.9679; val_best_acc_score: 0.8979; val_best_f1_score: 0.9428; train_kl_reg_loss: 205.0268; train_edge_recon_loss: 95210.8789; train_gene_expr_recon_loss: 99553.9922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194969.9062; train_optim_loss: 194969.9062; val_kl_reg_loss: 205.1300; val_edge_recon_loss: 97679.4922; val_gene_expr_recon_loss: 99132.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197016.6250; val_optim_loss: 197016.6250
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8385; val_auprc_score: 0.9616; val_best_acc_score: 0.8875; val_best_f1_score: 0.9364; train_kl_reg_loss: 210.7947; train_edge_recon_loss: 98201.5781; train_gene_expr_recon_loss: 99622.8477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198035.2188; train_optim_loss: 198035.2188; val_kl_reg_loss: 211.3461; val_edge_recon_loss: 107246.8359; val_gene_expr_recon_loss: 99062.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206521.0312; val_optim_loss: 206521.0312
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8665; val_auprc_score: 0.9696; val_best_acc_score: 0.9056; val_best_f1_score: 0.9473; train_kl_reg_loss: 216.6821; train_edge_recon_loss: 96679.0312; train_gene_expr_recon_loss: 99372.7305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196268.4453; train_optim_loss: 196268.4453; val_kl_reg_loss: 219.6696; val_edge_recon_loss: 91063.9531; val_gene_expr_recon_loss: 98994.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190278.4688; val_optim_loss: 190278.4688
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8320; val_auprc_score: 0.9588; val_best_acc_score: 0.8861; val_best_f1_score: 0.9358; train_kl_reg_loss: 226.5145; train_edge_recon_loss: 96778.5352; train_gene_expr_recon_loss: 99751.3047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196756.3516; train_optim_loss: 196756.3516; val_kl_reg_loss: 228.2722; val_edge_recon_loss: 105908.1953; val_gene_expr_recon_loss: 98928.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205064.9688; val_optim_loss: 205064.9688
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8324; val_auprc_score: 0.9597; val_best_acc_score: 0.8954; val_best_f1_score: 0.9413; train_kl_reg_loss: 234.7518; train_edge_recon_loss: 98105.3164; train_gene_expr_recon_loss: 99417.2930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197757.3594; train_optim_loss: 197757.3594; val_kl_reg_loss: 237.8828; val_edge_recon_loss: 97613.3516; val_gene_expr_recon_loss: 98864.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196715.7812; val_optim_loss: 196715.7812
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8414; val_auprc_score: 0.9640; val_best_acc_score: 0.8835; val_best_f1_score: 0.9353; train_kl_reg_loss: 243.3501; train_edge_recon_loss: 97791.3086; train_gene_expr_recon_loss: 98709.9766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196744.6406; train_optim_loss: 196744.6406; val_kl_reg_loss: 246.5509; val_edge_recon_loss: 102665.5078; val_gene_expr_recon_loss: 98803.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201715.2188; val_optim_loss: 201715.2188

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8344; val_auprc_score: 0.9661; val_best_acc_score: 0.9092; val_best_f1_score: 0.9501; train_kl_reg_loss: 253.2414; train_edge_recon_loss: 98048.3555; train_gene_expr_recon_loss: 98235.2344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196536.8281; train_optim_loss: 196536.8281; val_kl_reg_loss: 251.2784; val_edge_recon_loss: 85951.2344; val_gene_expr_recon_loss: 98797.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184999.6406; val_optim_loss: 184999.6406
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8156; val_auprc_score: 0.9588; val_best_acc_score: 0.8774; val_best_f1_score: 0.9322; train_kl_reg_loss: 252.6649; train_edge_recon_loss: 97749.5938; train_gene_expr_recon_loss: 99298.6992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197300.9531; train_optim_loss: 197300.9531; val_kl_reg_loss: 247.0197; val_edge_recon_loss: 105612.7266; val_gene_expr_recon_loss: 98791.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204650.8750; val_optim_loss: 204650.8750
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8193; val_auprc_score: 0.9521; val_best_acc_score: 0.8852; val_best_f1_score: 0.9347; train_kl_reg_loss: 256.0788; train_edge_recon_loss: 97004.0430; train_gene_expr_recon_loss: 98736.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195996.7422; train_optim_loss: 195996.7422; val_kl_reg_loss: 252.0193; val_edge_recon_loss: 109973.2266; val_gene_expr_recon_loss: 98785.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209010.3281; val_optim_loss: 209010.3281
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8216; val_auprc_score: 0.9591; val_best_acc_score: 0.8838; val_best_f1_score: 0.9358; train_kl_reg_loss: 252.0017; train_edge_recon_loss: 100207.8086; train_gene_expr_recon_loss: 98570.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199030.1719; train_optim_loss: 199030.1719; val_kl_reg_loss: 251.5128; val_edge_recon_loss: 102350.6953; val_gene_expr_recon_loss: 98778.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201381.1875; val_optim_loss: 201381.1875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8457; val_auprc_score: 0.9599; val_best_acc_score: 0.8929; val_best_f1_score: 0.9394; train_kl_reg_loss: 259.2444; train_edge_recon_loss: 97321.1367; train_gene_expr_recon_loss: 99642.1055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197222.4922; train_optim_loss: 197222.4922; val_kl_reg_loss: 252.1202; val_edge_recon_loss: 99130.2734; val_gene_expr_recon_loss: 98778.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198160.7500; val_optim_loss: 198160.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8181; val_auprc_score: 0.9506; val_best_acc_score: 0.8972; val_best_f1_score: 0.9421; train_kl_reg_loss: 256.0456; train_edge_recon_loss: 96238.9883; train_gene_expr_recon_loss: 99210.9961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195706.0312; train_optim_loss: 195706.0312; val_kl_reg_loss: 250.1721; val_edge_recon_loss: 99966.4375; val_gene_expr_recon_loss: 98777.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198994.3750; val_optim_loss: 198994.3750
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8572; val_auprc_score: 0.9701; val_best_acc_score: 0.8993; val_best_f1_score: 0.9442; train_kl_reg_loss: 254.1488; train_edge_recon_loss: 101688.2539; train_gene_expr_recon_loss: 98739.2930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200681.6953; train_optim_loss: 200681.6953; val_kl_reg_loss: 251.9816; val_edge_recon_loss: 94049.7578; val_gene_expr_recon_loss: 98777.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193078.8906; val_optim_loss: 193078.8906

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 13 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
Val AUROC score: 0.8577
Val AUPRC score: 0.9625
Val best accuracy score: 0.8884
Val best F1 score: 0.9375
Val gene expr MSE score: 1.3847
Duration of model training in run 2: 0 hours, 0 minutes and 14 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 21600
Number of validation edges: 2400
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9631; val_auprc_score: 0.9920; val_best_acc_score: 0.9429; val_best_f1_score: 0.9675; train_kl_reg_loss: 54.7853; train_edge_recon_loss: 100463.5156; train_gene_expr_recon_loss: 137419.9818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237938.2812; train_optim_loss: 237938.2812; val_kl_reg_loss: 104.0884; val_edge_recon_loss: 113436.8047; val_gene_expr_recon_loss: 114981.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228522.1094; val_optim_loss: 228522.1094
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9692; val_auprc_score: 0.9918; val_best_acc_score: 0.9327; val_best_f1_score: 0.9622; train_kl_reg_loss: 165.6836; train_edge_recon_loss: 102863.9349; train_gene_expr_recon_loss: 111970.5651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215000.1875; train_optim_loss: 215000.1875; val_kl_reg_loss: 272.6718; val_edge_recon_loss: 112100.3516; val_gene_expr_recon_loss: 103022.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215395.4375; val_optim_loss: 215395.4375
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9592; val_auprc_score: 0.9880; val_best_acc_score: 0.9288; val_best_f1_score: 0.9589; train_kl_reg_loss: 306.4040; train_edge_recon_loss: 102958.1667; train_gene_expr_recon_loss: 102437.8828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205702.4583; train_optim_loss: 205702.4583; val_kl_reg_loss: 291.9292; val_edge_recon_loss: 125078.7344; val_gene_expr_recon_loss: 98227.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 223597.6562; val_optim_loss: 223597.6562
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9554; val_auprc_score: 0.9882; val_best_acc_score: 0.9255; val_best_f1_score: 0.9577; train_kl_reg_loss: 277.2669; train_edge_recon_loss: 99369.1458; train_gene_expr_recon_loss: 99188.2552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198834.6719; train_optim_loss: 198834.6719; val_kl_reg_loss: 208.0175; val_edge_recon_loss: 111128.4375; val_gene_expr_recon_loss: 96361.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207698.2031; val_optim_loss: 207698.2031
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9356; val_auprc_score: 0.9849; val_best_acc_score: 0.9175; val_best_f1_score: 0.9524; train_kl_reg_loss: 194.7718; train_edge_recon_loss: 101922.7474; train_gene_expr_recon_loss: 97452.0755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199569.5938; train_optim_loss: 199569.5938; val_kl_reg_loss: 154.7905; val_edge_recon_loss: 113793.0938; val_gene_expr_recon_loss: 95641.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209589.4688; val_optim_loss: 209589.4688
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8973; val_auprc_score: 0.9780; val_best_acc_score: 0.9100; val_best_f1_score: 0.9494; train_kl_reg_loss: 158.4573; train_edge_recon_loss: 99506.9818; train_gene_expr_recon_loss: 96486.3724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196151.8125; train_optim_loss: 196151.8125; val_kl_reg_loss: 160.8326; val_edge_recon_loss: 101659.8984; val_gene_expr_recon_loss: 95138.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196959.6250; val_optim_loss: 196959.6250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8749; val_auprc_score: 0.9722; val_best_acc_score: 0.9001; val_best_f1_score: 0.9435; train_kl_reg_loss: 191.1085; train_edge_recon_loss: 100301.4740; train_gene_expr_recon_loss: 96492.5729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196985.1562; train_optim_loss: 196985.1562; val_kl_reg_loss: 253.7100; val_edge_recon_loss: 103565.5938; val_gene_expr_recon_loss: 94612.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198432.0312; val_optim_loss: 198432.0312
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8506; val_auprc_score: 0.9654; val_best_acc_score: 0.8962; val_best_f1_score: 0.9425; train_kl_reg_loss: 325.3815; train_edge_recon_loss: 96903.6589; train_gene_expr_recon_loss: 95683.1068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192912.1458; train_optim_loss: 192912.1458; val_kl_reg_loss: 457.5962; val_edge_recon_loss: 96732.4297; val_gene_expr_recon_loss: 94117.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191307.3438; val_optim_loss: 191307.3438
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8218; val_auprc_score: 0.9558; val_best_acc_score: 0.8902; val_best_f1_score: 0.9390; train_kl_reg_loss: 576.1627; train_edge_recon_loss: 94483.1875; train_gene_expr_recon_loss: 95831.7005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190891.0417; train_optim_loss: 190891.0417; val_kl_reg_loss: 748.6367; val_edge_recon_loss: 98629.3047; val_gene_expr_recon_loss: 93676.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193054.1875; val_optim_loss: 193054.1875
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8243; val_auprc_score: 0.9592; val_best_acc_score: 0.8981; val_best_f1_score: 0.9437; train_kl_reg_loss: 881.2057; train_edge_recon_loss: 93100.3021; train_gene_expr_recon_loss: 95301.3906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189282.9010; train_optim_loss: 189282.9010; val_kl_reg_loss: 1086.9431; val_edge_recon_loss: 88209.4297; val_gene_expr_recon_loss: 93322.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182619.1406; val_optim_loss: 182619.1406
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8346; val_auprc_score: 0.9625; val_best_acc_score: 0.8955; val_best_f1_score: 0.9417; train_kl_reg_loss: 1260.9423; train_edge_recon_loss: 92990.2760; train_gene_expr_recon_loss: 94942.3411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189193.5573; train_optim_loss: 189193.5573; val_kl_reg_loss: 1485.6611; val_edge_recon_loss: 91951.4531; val_gene_expr_recon_loss: 92987.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186424.9688; val_optim_loss: 186424.9688
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8330; val_auprc_score: 0.9622; val_best_acc_score: 0.8912; val_best_f1_score: 0.9396; train_kl_reg_loss: 1653.0633; train_edge_recon_loss: 90995.6589; train_gene_expr_recon_loss: 94353.9635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187002.6875; train_optim_loss: 187002.6875; val_kl_reg_loss: 1798.0819; val_edge_recon_loss: 91665.6641; val_gene_expr_recon_loss: 92694.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186158.1406; val_optim_loss: 186158.1406
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8663; val_auprc_score: 0.9688; val_best_acc_score: 0.9037; val_best_f1_score: 0.9460; train_kl_reg_loss: 1950.5275; train_edge_recon_loss: 89106.3047; train_gene_expr_recon_loss: 94335.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185392.3958; train_optim_loss: 185392.3958; val_kl_reg_loss: 2023.6941; val_edge_recon_loss: 85313.0703; val_gene_expr_recon_loss: 92465.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179802.6562; val_optim_loss: 179802.6562
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8536; val_auprc_score: 0.9686; val_best_acc_score: 0.9033; val_best_f1_score: 0.9462; train_kl_reg_loss: 2152.5979; train_edge_recon_loss: 86626.8229; train_gene_expr_recon_loss: 93307.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182086.4271; train_optim_loss: 182086.4271; val_kl_reg_loss: 2214.6670; val_edge_recon_loss: 82252.2578; val_gene_expr_recon_loss: 92277.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176744.5000; val_optim_loss: 176744.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8852; val_auprc_score: 0.9717; val_best_acc_score: 0.9081; val_best_f1_score: 0.9484; train_kl_reg_loss: 2357.2188; train_edge_recon_loss: 85059.5182; train_gene_expr_recon_loss: 93520.5911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180937.3281; train_optim_loss: 180937.3281; val_kl_reg_loss: 2425.8198; val_edge_recon_loss: 82245.2344; val_gene_expr_recon_loss: 92189.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176860.6875; val_optim_loss: 176860.6875
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8997; val_auprc_score: 0.9743; val_best_acc_score: 0.9131; val_best_f1_score: 0.9505; train_kl_reg_loss: 2531.1493; train_edge_recon_loss: 83450.5260; train_gene_expr_recon_loss: 93435.3620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179417.0312; train_optim_loss: 179417.0312; val_kl_reg_loss: 2518.2197; val_edge_recon_loss: 82443.5156; val_gene_expr_recon_loss: 91981.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176943.3750; val_optim_loss: 176943.3750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9005; val_auprc_score: 0.9781; val_best_acc_score: 0.9172; val_best_f1_score: 0.9536; train_kl_reg_loss: 2657.8835; train_edge_recon_loss: 83707.8177; train_gene_expr_recon_loss: 92905.9557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179271.6615; train_optim_loss: 179271.6615; val_kl_reg_loss: 2593.0383; val_edge_recon_loss: 76540.6406; val_gene_expr_recon_loss: 91774.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170908.0156; val_optim_loss: 170908.0156
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8988; val_auprc_score: 0.9746; val_best_acc_score: 0.9178; val_best_f1_score: 0.9538; train_kl_reg_loss: 2692.4041; train_edge_recon_loss: 82762.4141; train_gene_expr_recon_loss: 93382.2734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178837.0938; train_optim_loss: 178837.0938; val_kl_reg_loss: 2614.4463; val_edge_recon_loss: 76318.2656; val_gene_expr_recon_loss: 91570.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170503.0938; val_optim_loss: 170503.0938
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9120; val_auprc_score: 0.9765; val_best_acc_score: 0.9186; val_best_f1_score: 0.9534; train_kl_reg_loss: 2670.1833; train_edge_recon_loss: 81634.5807; train_gene_expr_recon_loss: 93090.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177395.4688; train_optim_loss: 177395.4688; val_kl_reg_loss: 2508.4417; val_edge_recon_loss: 83097.1328; val_gene_expr_recon_loss: 91419.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177025.3125; val_optim_loss: 177025.3125
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9161; val_auprc_score: 0.9761; val_best_acc_score: 0.9280; val_best_f1_score: 0.9583; train_kl_reg_loss: 2530.3610; train_edge_recon_loss: 82660.9870; train_gene_expr_recon_loss: 92297.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177488.5260; train_optim_loss: 177488.5260; val_kl_reg_loss: 2380.5059; val_edge_recon_loss: 83684.5859; val_gene_expr_recon_loss: 91265.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177331.0781; val_optim_loss: 177331.0781
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9392; val_auprc_score: 0.9831; val_best_acc_score: 0.9359; val_best_f1_score: 0.9628; train_kl_reg_loss: 2395.0614; train_edge_recon_loss: 81382.2109; train_gene_expr_recon_loss: 92502.2344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176279.5052; train_optim_loss: 176279.5052; val_kl_reg_loss: 2213.0884; val_edge_recon_loss: 77899.9141; val_gene_expr_recon_loss: 91135.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171248.9688; val_optim_loss: 171248.9688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9163; val_auprc_score: 0.9767; val_best_acc_score: 0.9255; val_best_f1_score: 0.9571; train_kl_reg_loss: 2271.0840; train_edge_recon_loss: 81859.4271; train_gene_expr_recon_loss: 92359.0026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176489.5104; train_optim_loss: 176489.5104; val_kl_reg_loss: 2201.6145; val_edge_recon_loss: 82540.9844; val_gene_expr_recon_loss: 91119.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175862.5625; val_optim_loss: 175862.5625
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9234; val_auprc_score: 0.9752; val_best_acc_score: 0.9296; val_best_f1_score: 0.9591; train_kl_reg_loss: 2255.9132; train_edge_recon_loss: 79093.9297; train_gene_expr_recon_loss: 92512.5130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173862.3594; train_optim_loss: 173862.3594; val_kl_reg_loss: 2180.7861; val_edge_recon_loss: 84391.8906; val_gene_expr_recon_loss: 91103.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177675.7188; val_optim_loss: 177675.7188
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9301; val_auprc_score: 0.9787; val_best_acc_score: 0.9374; val_best_f1_score: 0.9641; train_kl_reg_loss: 2233.8407; train_edge_recon_loss: 81171.6536; train_gene_expr_recon_loss: 92502.2734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175907.7656; train_optim_loss: 175907.7656; val_kl_reg_loss: 2157.4849; val_edge_recon_loss: 74751.3281; val_gene_expr_recon_loss: 91086.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167995.3750; val_optim_loss: 167995.3750
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9274; val_auprc_score: 0.9798; val_best_acc_score: 0.9363; val_best_f1_score: 0.9635; train_kl_reg_loss: 2214.1652; train_edge_recon_loss: 81520.8516; train_gene_expr_recon_loss: 92212.2630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175947.2760; train_optim_loss: 175947.2760; val_kl_reg_loss: 2145.8848; val_edge_recon_loss: 78253.6797; val_gene_expr_recon_loss: 91068.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171468.5312; val_optim_loss: 171468.5312
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9214; val_auprc_score: 0.9777; val_best_acc_score: 0.9298; val_best_f1_score: 0.9593; train_kl_reg_loss: 2192.6109; train_edge_recon_loss: 78943.2995; train_gene_expr_recon_loss: 91951.6536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173087.5573; train_optim_loss: 173087.5573; val_kl_reg_loss: 2128.2910; val_edge_recon_loss: 81395.9688; val_gene_expr_recon_loss: 91050.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174574.9062; val_optim_loss: 174574.9062
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9289; val_auprc_score: 0.9815; val_best_acc_score: 0.9326; val_best_f1_score: 0.9609; train_kl_reg_loss: 2184.6695; train_edge_recon_loss: 82557.9141; train_gene_expr_recon_loss: 92804.0182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177546.6042; train_optim_loss: 177546.6042; val_kl_reg_loss: 2120.4858; val_edge_recon_loss: 82256.7734; val_gene_expr_recon_loss: 91032.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175409.2969; val_optim_loss: 175409.2969

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9223; val_auprc_score: 0.9795; val_best_acc_score: 0.9344; val_best_f1_score: 0.9623; train_kl_reg_loss: 2180.7607; train_edge_recon_loss: 78939.6979; train_gene_expr_recon_loss: 92307.5052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173427.9635; train_optim_loss: 173427.9635; val_kl_reg_loss: 2119.9229; val_edge_recon_loss: 75759.1328; val_gene_expr_recon_loss: 91029.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168909.0000; val_optim_loss: 168909.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9107; val_auprc_score: 0.9792; val_best_acc_score: 0.9267; val_best_f1_score: 0.9581; train_kl_reg_loss: 2176.1118; train_edge_recon_loss: 79110.0339; train_gene_expr_recon_loss: 92180.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173466.4323; train_optim_loss: 173466.4323; val_kl_reg_loss: 2117.6252; val_edge_recon_loss: 79447.8125; val_gene_expr_recon_loss: 91027.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172593.2812; val_optim_loss: 172593.2812
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9369; val_auprc_score: 0.9853; val_best_acc_score: 0.9274; val_best_f1_score: 0.9576; train_kl_reg_loss: 2178.7738; train_edge_recon_loss: 79951.6224; train_gene_expr_recon_loss: 92202.0417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174332.4375; train_optim_loss: 174332.4375; val_kl_reg_loss: 2115.7695; val_edge_recon_loss: 86407.3047; val_gene_expr_recon_loss: 91026.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179549.2656; val_optim_loss: 179549.2656

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 22 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9348
Val AUPRC score: 0.9803
Val best accuracy score: 0.9318
Val best F1 score: 0.9605
Val gene expr MSE score: 1.0702
Duration of model training in run 3: 0 hours, 0 minutes and 23 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 21600
Number of validation edges: 2400
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9465; val_auprc_score: 0.9799; val_best_acc_score: 0.9286; val_best_f1_score: 0.9597; train_kl_reg_loss: 66.5041; train_edge_recon_loss: 102547.0911; train_gene_expr_recon_loss: 137195.2995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 239808.9010; train_optim_loss: 239808.9010; val_kl_reg_loss: 117.8341; val_edge_recon_loss: 113469.2266; val_gene_expr_recon_loss: 116476.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 230063.6562; val_optim_loss: 230063.6562
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9557; val_auprc_score: 0.9896; val_best_acc_score: 0.9076; val_best_f1_score: 0.9480; train_kl_reg_loss: 187.4368; train_edge_recon_loss: 99644.1510; train_gene_expr_recon_loss: 113642.2604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213473.8490; train_optim_loss: 213473.8490; val_kl_reg_loss: 301.8021; val_edge_recon_loss: 122737.8438; val_gene_expr_recon_loss: 104792.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227832.4219; val_optim_loss: 227832.4219
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9465; val_auprc_score: 0.9864; val_best_acc_score: 0.9124; val_best_f1_score: 0.9502; train_kl_reg_loss: 343.5457; train_edge_recon_loss: 104937.4323; train_gene_expr_recon_loss: 103514.0911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208795.0729; train_optim_loss: 208795.0729; val_kl_reg_loss: 343.1342; val_edge_recon_loss: 123449.1016; val_gene_expr_recon_loss: 99779.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 223572.0625; val_optim_loss: 223572.0625
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9447; val_auprc_score: 0.9884; val_best_acc_score: 0.9200; val_best_f1_score: 0.9534; train_kl_reg_loss: 342.2552; train_edge_recon_loss: 99426.7760; train_gene_expr_recon_loss: 100006.2240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199775.2500; train_optim_loss: 199775.2500; val_kl_reg_loss: 283.2709; val_edge_recon_loss: 112015.0000; val_gene_expr_recon_loss: 97687.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209986.2500; val_optim_loss: 209986.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9379; val_auprc_score: 0.9839; val_best_acc_score: 0.9142; val_best_f1_score: 0.9501; train_kl_reg_loss: 271.2369; train_edge_recon_loss: 101548.1953; train_gene_expr_recon_loss: 98080.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199899.8490; train_optim_loss: 199899.8490; val_kl_reg_loss: 214.9023; val_edge_recon_loss: 112500.0469; val_gene_expr_recon_loss: 96745.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209460.7812; val_optim_loss: 209460.7812
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9073; val_auprc_score: 0.9745; val_best_acc_score: 0.9064; val_best_f1_score: 0.9467; train_kl_reg_loss: 213.2524; train_edge_recon_loss: 103264.0781; train_gene_expr_recon_loss: 97437.5052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200914.8385; train_optim_loss: 200914.8385; val_kl_reg_loss: 188.8954; val_edge_recon_loss: 103946.4453; val_gene_expr_recon_loss: 96145.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200281.2031; val_optim_loss: 200281.2031
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8613; val_auprc_score: 0.9695; val_best_acc_score: 0.8933; val_best_f1_score: 0.9407; train_kl_reg_loss: 207.3397; train_edge_recon_loss: 98246.6719; train_gene_expr_recon_loss: 96626.3776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195080.3906; train_optim_loss: 195080.3906; val_kl_reg_loss: 234.3893; val_edge_recon_loss: 102852.8594; val_gene_expr_recon_loss: 95662.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198749.3594; val_optim_loss: 198749.3594
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8492; val_auprc_score: 0.9667; val_best_acc_score: 0.8894; val_best_f1_score: 0.9381; train_kl_reg_loss: 291.2053; train_edge_recon_loss: 97627.9661; train_gene_expr_recon_loss: 96726.8646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194646.0365; train_optim_loss: 194646.0365; val_kl_reg_loss: 375.5943; val_edge_recon_loss: 102409.7109; val_gene_expr_recon_loss: 95240.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198025.5625; val_optim_loss: 198025.5625
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8358; val_auprc_score: 0.9615; val_best_acc_score: 0.8832; val_best_f1_score: 0.9349; train_kl_reg_loss: 469.4684; train_edge_recon_loss: 96458.8490; train_gene_expr_recon_loss: 95655.8802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192584.1979; train_optim_loss: 192584.1979; val_kl_reg_loss: 599.5187; val_edge_recon_loss: 102194.8594; val_gene_expr_recon_loss: 94845.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197640.1562; val_optim_loss: 197640.1562
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8407; val_auprc_score: 0.9650; val_best_acc_score: 0.8860; val_best_f1_score: 0.9366; train_kl_reg_loss: 728.4858; train_edge_recon_loss: 92899.3307; train_gene_expr_recon_loss: 95422.7682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189050.5885; train_optim_loss: 189050.5885; val_kl_reg_loss: 905.7994; val_edge_recon_loss: 97172.5156; val_gene_expr_recon_loss: 94505.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192584.2812; val_optim_loss: 192584.2812
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8301; val_auprc_score: 0.9634; val_best_acc_score: 0.8863; val_best_f1_score: 0.9373; train_kl_reg_loss: 1075.3148; train_edge_recon_loss: 94498.2526; train_gene_expr_recon_loss: 94958.1719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190531.7396; train_optim_loss: 190531.7396; val_kl_reg_loss: 1283.2048; val_edge_recon_loss: 92890.1641; val_gene_expr_recon_loss: 94202.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188376.3438; val_optim_loss: 188376.3438
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8365; val_auprc_score: 0.9610; val_best_acc_score: 0.8862; val_best_f1_score: 0.9368; train_kl_reg_loss: 1475.9892; train_edge_recon_loss: 92294.0703; train_gene_expr_recon_loss: 94590.0391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188360.0990; train_optim_loss: 188360.0990; val_kl_reg_loss: 1653.5698; val_edge_recon_loss: 96111.7734; val_gene_expr_recon_loss: 93869.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191634.5625; val_optim_loss: 191634.5625
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8432; val_auprc_score: 0.9639; val_best_acc_score: 0.8946; val_best_f1_score: 0.9414; train_kl_reg_loss: 1822.2702; train_edge_recon_loss: 91963.5130; train_gene_expr_recon_loss: 93918.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187703.8646; train_optim_loss: 187703.8646; val_kl_reg_loss: 1918.3428; val_edge_recon_loss: 88321.5312; val_gene_expr_recon_loss: 93625.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183864.9062; val_optim_loss: 183864.9062
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8585; val_auprc_score: 0.9690; val_best_acc_score: 0.8965; val_best_f1_score: 0.9423; train_kl_reg_loss: 2071.5935; train_edge_recon_loss: 89623.2604; train_gene_expr_recon_loss: 94294.9609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185989.8073; train_optim_loss: 185989.8073; val_kl_reg_loss: 2114.7959; val_edge_recon_loss: 88775.5781; val_gene_expr_recon_loss: 93389.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184279.9844; val_optim_loss: 184279.9844
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8648; val_auprc_score: 0.9694; val_best_acc_score: 0.9037; val_best_f1_score: 0.9463; train_kl_reg_loss: 2226.8534; train_edge_recon_loss: 88123.3958; train_gene_expr_recon_loss: 93923.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184274.2031; train_optim_loss: 184274.2031; val_kl_reg_loss: 2218.9185; val_edge_recon_loss: 84358.5000; val_gene_expr_recon_loss: 93194.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179771.8438; val_optim_loss: 179771.8438
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8881; val_auprc_score: 0.9760; val_best_acc_score: 0.9143; val_best_f1_score: 0.9519; train_kl_reg_loss: 2325.8902; train_edge_recon_loss: 85008.3698; train_gene_expr_recon_loss: 93642.3177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180976.5781; train_optim_loss: 180976.5781; val_kl_reg_loss: 2269.2300; val_edge_recon_loss: 77392.1797; val_gene_expr_recon_loss: 93066.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172728.0000; val_optim_loss: 172728.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8922; val_auprc_score: 0.9743; val_best_acc_score: 0.9034; val_best_f1_score: 0.9459; train_kl_reg_loss: 2384.6104; train_edge_recon_loss: 81819.0703; train_gene_expr_recon_loss: 93445.2734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177648.9583; train_optim_loss: 177648.9583; val_kl_reg_loss: 2380.2761; val_edge_recon_loss: 85047.4766; val_gene_expr_recon_loss: 92966.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180394.3438; val_optim_loss: 180394.3438
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8937; val_auprc_score: 0.9709; val_best_acc_score: 0.9166; val_best_f1_score: 0.9525; train_kl_reg_loss: 2475.0759; train_edge_recon_loss: 82145.9896; train_gene_expr_recon_loss: 93774.2083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178395.2708; train_optim_loss: 178395.2708; val_kl_reg_loss: 2403.9565; val_edge_recon_loss: 80649.0703; val_gene_expr_recon_loss: 92791.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175844.2344; val_optim_loss: 175844.2344
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9195; val_auprc_score: 0.9826; val_best_acc_score: 0.9183; val_best_f1_score: 0.9533; train_kl_reg_loss: 2526.7515; train_edge_recon_loss: 81142.2839; train_gene_expr_recon_loss: 93491.3385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177160.3750; train_optim_loss: 177160.3750; val_kl_reg_loss: 2443.1465; val_edge_recon_loss: 82599.5781; val_gene_expr_recon_loss: 92625.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177668.2812; val_optim_loss: 177668.2812

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9217; val_auprc_score: 0.9827; val_best_acc_score: 0.9207; val_best_f1_score: 0.9545; train_kl_reg_loss: 2518.2073; train_edge_recon_loss: 80142.8828; train_gene_expr_recon_loss: 93129.8646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175790.9531; train_optim_loss: 175790.9531; val_kl_reg_loss: 2419.4915; val_edge_recon_loss: 81389.4297; val_gene_expr_recon_loss: 92602.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176411.7969; val_optim_loss: 176411.7969
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9039; val_auprc_score: 0.9747; val_best_acc_score: 0.9163; val_best_f1_score: 0.9527; train_kl_reg_loss: 2493.5750; train_edge_recon_loss: 82687.2630; train_gene_expr_recon_loss: 92675.3073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177856.1458; train_optim_loss: 177856.1458; val_kl_reg_loss: 2409.0508; val_edge_recon_loss: 80969.1875; val_gene_expr_recon_loss: 92584.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175962.8125; val_optim_loss: 175962.8125
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8928; val_auprc_score: 0.9682; val_best_acc_score: 0.9115; val_best_f1_score: 0.9496; train_kl_reg_loss: 2469.0961; train_edge_recon_loss: 81562.4245; train_gene_expr_recon_loss: 93253.1927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177284.7135; train_optim_loss: 177284.7135; val_kl_reg_loss: 2381.6494; val_edge_recon_loss: 86197.9688; val_gene_expr_recon_loss: 92568.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181148.5938; val_optim_loss: 181148.5938

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 15 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
Val AUROC score: 0.8677
Val AUPRC score: 0.9667
Val best accuracy score: 0.9066
Val best F1 score: 0.9468
Val gene expr MSE score: 1.1938
Duration of model training in run 4: 0 hours, 0 minutes and 16 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 32379
Number of validation edges: 3597
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9624; val_auprc_score: 0.9904; val_best_acc_score: 0.9377; val_best_f1_score: 0.9646; train_kl_reg_loss: 81.7219; train_edge_recon_loss: 101531.2129; train_gene_expr_recon_loss: 130108.5781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 231721.5156; train_optim_loss: 231721.5156; val_kl_reg_loss: 169.4038; val_edge_recon_loss: 115553.4531; val_gene_expr_recon_loss: 111859.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227582.6250; val_optim_loss: 227582.6250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9578; val_auprc_score: 0.9908; val_best_acc_score: 0.9186; val_best_f1_score: 0.9538; train_kl_reg_loss: 247.7004; train_edge_recon_loss: 101144.9453; train_gene_expr_recon_loss: 105833.7324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207226.3828; train_optim_loss: 207226.3828; val_kl_reg_loss: 289.1791; val_edge_recon_loss: 122800.1016; val_gene_expr_recon_loss: 101605.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224694.9062; val_optim_loss: 224694.9062
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9499; val_auprc_score: 0.9880; val_best_acc_score: 0.9251; val_best_f1_score: 0.9562; train_kl_reg_loss: 281.5266; train_edge_recon_loss: 100432.1758; train_gene_expr_recon_loss: 98515.1758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199228.8750; train_optim_loss: 199228.8750; val_kl_reg_loss: 224.2643; val_edge_recon_loss: 109551.7891; val_gene_expr_recon_loss: 98718.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208494.9375; val_optim_loss: 208494.9375
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9196; val_auprc_score: 0.9791; val_best_acc_score: 0.9114; val_best_f1_score: 0.9490; train_kl_reg_loss: 203.2257; train_edge_recon_loss: 100227.9609; train_gene_expr_recon_loss: 97003.5957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197434.7852; train_optim_loss: 197434.7852; val_kl_reg_loss: 168.1687; val_edge_recon_loss: 104997.2266; val_gene_expr_recon_loss: 97745.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202911.0312; val_optim_loss: 202911.0312
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8718; val_auprc_score: 0.9721; val_best_acc_score: 0.8994; val_best_f1_score: 0.9439; train_kl_reg_loss: 193.4750; train_edge_recon_loss: 98244.5664; train_gene_expr_recon_loss: 96065.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194503.9883; train_optim_loss: 194503.9883; val_kl_reg_loss: 244.3134; val_edge_recon_loss: 96950.1953; val_gene_expr_recon_loss: 97071.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194265.8125; val_optim_loss: 194265.8125
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8471; val_auprc_score: 0.9665; val_best_acc_score: 0.8896; val_best_f1_score: 0.9389; train_kl_reg_loss: 343.1652; train_edge_recon_loss: 97654.1426; train_gene_expr_recon_loss: 95229.7637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193227.0703; train_optim_loss: 193227.0703; val_kl_reg_loss: 504.9182; val_edge_recon_loss: 98549.7812; val_gene_expr_recon_loss: 96472.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195526.7656; val_optim_loss: 195526.7656
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8599; val_auprc_score: 0.9683; val_best_acc_score: 0.8978; val_best_f1_score: 0.9432; train_kl_reg_loss: 672.8240; train_edge_recon_loss: 96041.2559; train_gene_expr_recon_loss: 94700.5410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191414.6172; train_optim_loss: 191414.6172; val_kl_reg_loss: 890.4587; val_edge_recon_loss: 91736.5234; val_gene_expr_recon_loss: 95933.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188560.0469; val_optim_loss: 188560.0469
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8543; val_auprc_score: 0.9701; val_best_acc_score: 0.9037; val_best_f1_score: 0.9466; train_kl_reg_loss: 1101.0471; train_edge_recon_loss: 93308.0684; train_gene_expr_recon_loss: 93896.1992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188305.3125; train_optim_loss: 188305.3125; val_kl_reg_loss: 1363.0632; val_edge_recon_loss: 86414.2266; val_gene_expr_recon_loss: 95495.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183272.5938; val_optim_loss: 183272.5938
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8614; val_auprc_score: 0.9710; val_best_acc_score: 0.9014; val_best_f1_score: 0.9456; train_kl_reg_loss: 1597.0205; train_edge_recon_loss: 89755.3496; train_gene_expr_recon_loss: 94021.6074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185373.9766; train_optim_loss: 185373.9766; val_kl_reg_loss: 1742.2231; val_edge_recon_loss: 82371.7734; val_gene_expr_recon_loss: 95117.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179231.0312; val_optim_loss: 179231.0312
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8613; val_auprc_score: 0.9657; val_best_acc_score: 0.8967; val_best_f1_score: 0.9424; train_kl_reg_loss: 1911.1484; train_edge_recon_loss: 90436.2969; train_gene_expr_recon_loss: 93442.3301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185789.7734; train_optim_loss: 185789.7734; val_kl_reg_loss: 1972.0605; val_edge_recon_loss: 88241.1641; val_gene_expr_recon_loss: 94876.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185089.6562; val_optim_loss: 185089.6562
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8714; val_auprc_score: 0.9702; val_best_acc_score: 0.9088; val_best_f1_score: 0.9490; train_kl_reg_loss: 2086.4193; train_edge_recon_loss: 85690.6426; train_gene_expr_recon_loss: 93084.8711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180861.9336; train_optim_loss: 180861.9336; val_kl_reg_loss: 2096.6582; val_edge_recon_loss: 84048.7500; val_gene_expr_recon_loss: 94722.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180868.0312; val_optim_loss: 180868.0312
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8991; val_auprc_score: 0.9701; val_best_acc_score: 0.9091; val_best_f1_score: 0.9489; train_kl_reg_loss: 2276.0526; train_edge_recon_loss: 85312.3887; train_gene_expr_recon_loss: 93048.1934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180636.6289; train_optim_loss: 180636.6289; val_kl_reg_loss: 2349.8860; val_edge_recon_loss: 85078.4219; val_gene_expr_recon_loss: 94512.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181941.1406; val_optim_loss: 181941.1406

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9098; val_auprc_score: 0.9799; val_best_acc_score: 0.9184; val_best_f1_score: 0.9539; train_kl_reg_loss: 2430.2353; train_edge_recon_loss: 84052.3613; train_gene_expr_recon_loss: 92969.5723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179452.1719; train_optim_loss: 179452.1719; val_kl_reg_loss: 2382.5312; val_edge_recon_loss: 79407.6562; val_gene_expr_recon_loss: 94480.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176270.6250; val_optim_loss: 176270.6250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8900; val_auprc_score: 0.9724; val_best_acc_score: 0.9164; val_best_f1_score: 0.9530; train_kl_reg_loss: 2459.5829; train_edge_recon_loss: 81090.7324; train_gene_expr_recon_loss: 92728.8926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176279.2070; train_optim_loss: 176279.2070; val_kl_reg_loss: 2410.3931; val_edge_recon_loss: 80740.5000; val_gene_expr_recon_loss: 94448.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177598.8906; val_optim_loss: 177598.8906
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9049; val_auprc_score: 0.9733; val_best_acc_score: 0.9132; val_best_f1_score: 0.9508; train_kl_reg_loss: 2477.6726; train_edge_recon_loss: 83801.0762; train_gene_expr_recon_loss: 92833.8027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179112.5586; train_optim_loss: 179112.5586; val_kl_reg_loss: 2406.9424; val_edge_recon_loss: 83477.7969; val_gene_expr_recon_loss: 94397.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180281.9531; val_optim_loss: 180281.9531
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9071; val_auprc_score: 0.9780; val_best_acc_score: 0.9199; val_best_f1_score: 0.9549; train_kl_reg_loss: 2478.1795; train_edge_recon_loss: 81401.5449; train_gene_expr_recon_loss: 93066.7109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176946.4336; train_optim_loss: 176946.4336; val_kl_reg_loss: 2400.2336; val_edge_recon_loss: 78554.4297; val_gene_expr_recon_loss: 94343.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175298.4688; val_optim_loss: 175298.4688
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9090; val_auprc_score: 0.9762; val_best_acc_score: 0.9147; val_best_f1_score: 0.9516; train_kl_reg_loss: 2459.8604; train_edge_recon_loss: 85055.7266; train_gene_expr_recon_loss: 93077.5020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180593.0938; train_optim_loss: 180593.0938; val_kl_reg_loss: 2382.7891; val_edge_recon_loss: 82418.7422; val_gene_expr_recon_loss: 94303.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179104.7500; val_optim_loss: 179104.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9193; val_auprc_score: 0.9795; val_best_acc_score: 0.9190; val_best_f1_score: 0.9536; train_kl_reg_loss: 2457.1281; train_edge_recon_loss: 82049.0898; train_gene_expr_recon_loss: 93035.1934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177541.4141; train_optim_loss: 177541.4141; val_kl_reg_loss: 2376.7070; val_edge_recon_loss: 82809.1641; val_gene_expr_recon_loss: 94269.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179455.2969; val_optim_loss: 179455.2969
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8993; val_auprc_score: 0.9784; val_best_acc_score: 0.9115; val_best_f1_score: 0.9505; train_kl_reg_loss: 2439.8984; train_edge_recon_loss: 83252.6738; train_gene_expr_recon_loss: 92658.5078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178351.0820; train_optim_loss: 178351.0820; val_kl_reg_loss: 2366.5610; val_edge_recon_loss: 82006.7109; val_gene_expr_recon_loss: 94237.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178610.3750; val_optim_loss: 178610.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9093; val_auprc_score: 0.9791; val_best_acc_score: 0.9181; val_best_f1_score: 0.9537; train_kl_reg_loss: 2431.2272; train_edge_recon_loss: 80196.6133; train_gene_expr_recon_loss: 92646.9492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175274.7812; train_optim_loss: 175274.7812; val_kl_reg_loss: 2366.5996; val_edge_recon_loss: 80828.9453; val_gene_expr_recon_loss: 94234.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177429.5781; val_optim_loss: 177429.5781
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9057; val_auprc_score: 0.9775; val_best_acc_score: 0.9231; val_best_f1_score: 0.9567; train_kl_reg_loss: 2434.0374; train_edge_recon_loss: 83545.7012; train_gene_expr_recon_loss: 92599.1133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178578.8555; train_optim_loss: 178578.8555; val_kl_reg_loss: 2370.5869; val_edge_recon_loss: 76503.4297; val_gene_expr_recon_loss: 94231.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173105.0312; val_optim_loss: 173105.0312
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9055; val_auprc_score: 0.9738; val_best_acc_score: 0.9138; val_best_f1_score: 0.9508; train_kl_reg_loss: 2430.8824; train_edge_recon_loss: 80922.1270; train_gene_expr_recon_loss: 92590.5410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175943.5508; train_optim_loss: 175943.5508; val_kl_reg_loss: 2363.4097; val_edge_recon_loss: 86694.0391; val_gene_expr_recon_loss: 94228.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183285.5000; val_optim_loss: 183285.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9004; val_auprc_score: 0.9734; val_best_acc_score: 0.9179; val_best_f1_score: 0.9537; train_kl_reg_loss: 2427.5946; train_edge_recon_loss: 80124.0254; train_gene_expr_recon_loss: 92731.3809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175282.9961; train_optim_loss: 175282.9961; val_kl_reg_loss: 2356.2739; val_edge_recon_loss: 80157.8984; val_gene_expr_recon_loss: 94225.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176739.3438; val_optim_loss: 176739.3438
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9023; val_auprc_score: 0.9775; val_best_acc_score: 0.9236; val_best_f1_score: 0.9567; train_kl_reg_loss: 2433.2390; train_edge_recon_loss: 80521.2461; train_gene_expr_recon_loss: 92891.5098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175845.9922; train_optim_loss: 175845.9922; val_kl_reg_loss: 2358.5112; val_edge_recon_loss: 78974.7109; val_gene_expr_recon_loss: 94222.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175555.7500; val_optim_loss: 175555.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9100; val_auprc_score: 0.9788; val_best_acc_score: 0.9193; val_best_f1_score: 0.9545; train_kl_reg_loss: 2420.7072; train_edge_recon_loss: 81126.9688; train_gene_expr_recon_loss: 92528.2520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176075.9336; train_optim_loss: 176075.9336; val_kl_reg_loss: 2354.8252; val_edge_recon_loss: 79518.2734; val_gene_expr_recon_loss: 94222.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176095.3750; val_optim_loss: 176095.3750
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9207; val_auprc_score: 0.9818; val_best_acc_score: 0.9187; val_best_f1_score: 0.9539; train_kl_reg_loss: 2427.9739; train_edge_recon_loss: 83293.9355; train_gene_expr_recon_loss: 92670.7793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178392.6914; train_optim_loss: 178392.6914; val_kl_reg_loss: 2361.4368; val_edge_recon_loss: 81423.9219; val_gene_expr_recon_loss: 94222.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178007.3750; val_optim_loss: 178007.3750
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8983; val_auprc_score: 0.9729; val_best_acc_score: 0.9195; val_best_f1_score: 0.9544; train_kl_reg_loss: 2423.9898; train_edge_recon_loss: 82748.2676; train_gene_expr_recon_loss: 92625.8594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177798.1172; train_optim_loss: 177798.1172; val_kl_reg_loss: 2357.2607; val_edge_recon_loss: 79888.5078; val_gene_expr_recon_loss: 94221.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176467.5000; val_optim_loss: 176467.5000

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 27 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9047
Val AUPRC score: 0.9791
Val best accuracy score: 0.9175
Val best F1 score: 0.9534
Val gene expr MSE score: 1.2309
Duration of model training in run 5: 0 hours, 0 minutes and 28 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 32379
Number of validation edges: 3597
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9613; val_auprc_score: 0.9890; val_best_acc_score: 0.9421; val_best_f1_score: 0.9667; train_kl_reg_loss: 64.0784; train_edge_recon_loss: 103181.9004; train_gene_expr_recon_loss: 129891.6270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 233137.6055; train_optim_loss: 233137.6055; val_kl_reg_loss: 138.2939; val_edge_recon_loss: 112964.4922; val_gene_expr_recon_loss: 108097.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221199.9375; val_optim_loss: 221199.9375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9541; val_auprc_score: 0.9889; val_best_acc_score: 0.9309; val_best_f1_score: 0.9610; train_kl_reg_loss: 208.0405; train_edge_recon_loss: 101486.6523; train_gene_expr_recon_loss: 106392.1973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208086.8945; train_optim_loss: 208086.8945; val_kl_reg_loss: 259.1020; val_edge_recon_loss: 107641.2734; val_gene_expr_recon_loss: 98122.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206022.3906; val_optim_loss: 206022.3906
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9490; val_auprc_score: 0.9867; val_best_acc_score: 0.9142; val_best_f1_score: 0.9504; train_kl_reg_loss: 246.9687; train_edge_recon_loss: 102445.1074; train_gene_expr_recon_loss: 99620.7852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202312.8594; train_optim_loss: 202312.8594; val_kl_reg_loss: 201.2534; val_edge_recon_loss: 115608.1875; val_gene_expr_recon_loss: 94978.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210788.0625; val_optim_loss: 210788.0625
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8905; val_auprc_score: 0.9771; val_best_acc_score: 0.9017; val_best_f1_score: 0.9446; train_kl_reg_loss: 199.6151; train_edge_recon_loss: 100112.5371; train_gene_expr_recon_loss: 97134.8379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197446.9922; train_optim_loss: 197446.9922; val_kl_reg_loss: 217.1243; val_edge_recon_loss: 101986.7578; val_gene_expr_recon_loss: 93821.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196025.4062; val_optim_loss: 196025.4062
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8452; val_auprc_score: 0.9655; val_best_acc_score: 0.8883; val_best_f1_score: 0.9376; train_kl_reg_loss: 287.3289; train_edge_recon_loss: 99021.9141; train_gene_expr_recon_loss: 96341.9297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195651.1719; train_optim_loss: 195651.1719; val_kl_reg_loss: 438.5505; val_edge_recon_loss: 98263.8359; val_gene_expr_recon_loss: 93137.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191839.6562; val_optim_loss: 191839.6562
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8266; val_auprc_score: 0.9590; val_best_acc_score: 0.8892; val_best_f1_score: 0.9382; train_kl_reg_loss: 599.5431; train_edge_recon_loss: 96113.5312; train_gene_expr_recon_loss: 95929.0410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192642.1172; train_optim_loss: 192642.1172; val_kl_reg_loss: 889.0378; val_edge_recon_loss: 93770.5938; val_gene_expr_recon_loss: 92517.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187177.2812; val_optim_loss: 187177.2812
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8349; val_auprc_score: 0.9650; val_best_acc_score: 0.8886; val_best_f1_score: 0.9380; train_kl_reg_loss: 1129.0755; train_edge_recon_loss: 93886.0449; train_gene_expr_recon_loss: 94689.5586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189704.6836; train_optim_loss: 189704.6836; val_kl_reg_loss: 1498.7728; val_edge_recon_loss: 93166.6328; val_gene_expr_recon_loss: 92005.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186671.2188; val_optim_loss: 186671.2188
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8399; val_auprc_score: 0.9673; val_best_acc_score: 0.8908; val_best_f1_score: 0.9396; train_kl_reg_loss: 1737.3925; train_edge_recon_loss: 90258.8477; train_gene_expr_recon_loss: 94355.1426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186351.3828; train_optim_loss: 186351.3828; val_kl_reg_loss: 2040.8000; val_edge_recon_loss: 87852.2891; val_gene_expr_recon_loss: 91624.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181517.2188; val_optim_loss: 181517.2188
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8628; val_auprc_score: 0.9670; val_best_acc_score: 0.9005; val_best_f1_score: 0.9445; train_kl_reg_loss: 2218.0574; train_edge_recon_loss: 88668.4141; train_gene_expr_recon_loss: 93785.4941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184671.9688; train_optim_loss: 184671.9688; val_kl_reg_loss: 2366.1611; val_edge_recon_loss: 83864.2969; val_gene_expr_recon_loss: 91321.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177551.9375; val_optim_loss: 177551.9375
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8559; val_auprc_score: 0.9630; val_best_acc_score: 0.8981; val_best_f1_score: 0.9429; train_kl_reg_loss: 2464.7286; train_edge_recon_loss: 88071.0352; train_gene_expr_recon_loss: 93913.3613; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184449.1289; train_optim_loss: 184449.1289; val_kl_reg_loss: 2530.0483; val_edge_recon_loss: 85944.9688; val_gene_expr_recon_loss: 91147.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179622.7031; val_optim_loss: 179622.7031
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8814; val_auprc_score: 0.9667; val_best_acc_score: 0.9007; val_best_f1_score: 0.9432; train_kl_reg_loss: 2536.3210; train_edge_recon_loss: 82162.4141; train_gene_expr_recon_loss: 93340.0215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178038.7539; train_optim_loss: 178038.7539; val_kl_reg_loss: 2506.6968; val_edge_recon_loss: 89600.7969; val_gene_expr_recon_loss: 91013.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183120.8750; val_optim_loss: 183120.8750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8857; val_auprc_score: 0.9687; val_best_acc_score: 0.9083; val_best_f1_score: 0.9477; train_kl_reg_loss: 2530.4868; train_edge_recon_loss: 81859.1562; train_gene_expr_recon_loss: 93403.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177792.8008; train_optim_loss: 177792.8008; val_kl_reg_loss: 2497.6035; val_edge_recon_loss: 86620.9453; val_gene_expr_recon_loss: 90810.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179928.9375; val_optim_loss: 179928.9375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9031; val_auprc_score: 0.9792; val_best_acc_score: 0.9178; val_best_f1_score: 0.9533; train_kl_reg_loss: 2522.9226; train_edge_recon_loss: 82393.1895; train_gene_expr_recon_loss: 93284.2461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178200.3594; train_optim_loss: 178200.3594; val_kl_reg_loss: 2480.9985; val_edge_recon_loss: 77800.3750; val_gene_expr_recon_loss: 90779.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171060.4062; val_optim_loss: 171060.4062
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9064; val_auprc_score: 0.9784; val_best_acc_score: 0.9168; val_best_f1_score: 0.9525; train_kl_reg_loss: 2503.6854; train_edge_recon_loss: 80917.7422; train_gene_expr_recon_loss: 92896.8828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176318.3125; train_optim_loss: 176318.3125; val_kl_reg_loss: 2469.7927; val_edge_recon_loss: 80021.4844; val_gene_expr_recon_loss: 90741.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173232.5781; val_optim_loss: 173232.5781
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8993; val_auprc_score: 0.9744; val_best_acc_score: 0.9159; val_best_f1_score: 0.9518; train_kl_reg_loss: 2490.0155; train_edge_recon_loss: 82631.6797; train_gene_expr_recon_loss: 92866.9277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177988.6250; train_optim_loss: 177988.6250; val_kl_reg_loss: 2463.1604; val_edge_recon_loss: 82814.0781; val_gene_expr_recon_loss: 90700.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175977.5000; val_optim_loss: 175977.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9046; val_auprc_score: 0.9795; val_best_acc_score: 0.9207; val_best_f1_score: 0.9550; train_kl_reg_loss: 2494.2716; train_edge_recon_loss: 83399.5078; train_gene_expr_recon_loss: 92911.2793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178805.0547; train_optim_loss: 178805.0547; val_kl_reg_loss: 2459.6001; val_edge_recon_loss: 77516.3672; val_gene_expr_recon_loss: 90658.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170634.1562; val_optim_loss: 170634.1562
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8972; val_auprc_score: 0.9717; val_best_acc_score: 0.9086; val_best_f1_score: 0.9475; train_kl_reg_loss: 2482.3944; train_edge_recon_loss: 83583.9766; train_gene_expr_recon_loss: 92687.7070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178754.0781; train_optim_loss: 178754.0781; val_kl_reg_loss: 2439.0386; val_edge_recon_loss: 87570.9141; val_gene_expr_recon_loss: 90622.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180632.4375; val_optim_loss: 180632.4375
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9176; val_auprc_score: 0.9810; val_best_acc_score: 0.9128; val_best_f1_score: 0.9497; train_kl_reg_loss: 2461.1088; train_edge_recon_loss: 79960.9570; train_gene_expr_recon_loss: 92814.3809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175236.4453; train_optim_loss: 175236.4453; val_kl_reg_loss: 2420.5295; val_edge_recon_loss: 86545.7734; val_gene_expr_recon_loss: 90592.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179558.7500; val_optim_loss: 179558.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8973; val_auprc_score: 0.9778; val_best_acc_score: 0.9130; val_best_f1_score: 0.9510; train_kl_reg_loss: 2447.1985; train_edge_recon_loss: 82502.1719; train_gene_expr_recon_loss: 92816.1719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177765.5430; train_optim_loss: 177765.5430; val_kl_reg_loss: 2407.4526; val_edge_recon_loss: 79454.9844; val_gene_expr_recon_loss: 90561.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172424.0625; val_optim_loss: 172424.0625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9172; val_auprc_score: 0.9802; val_best_acc_score: 0.9203; val_best_f1_score: 0.9545; train_kl_reg_loss: 2439.5970; train_edge_recon_loss: 81901.1543; train_gene_expr_recon_loss: 92719.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177060.5508; train_optim_loss: 177060.5508; val_kl_reg_loss: 2404.4912; val_edge_recon_loss: 78761.6172; val_gene_expr_recon_loss: 90558.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171724.8750; val_optim_loss: 171724.8750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9047; val_auprc_score: 0.9771; val_best_acc_score: 0.9224; val_best_f1_score: 0.9557; train_kl_reg_loss: 2441.8008; train_edge_recon_loss: 82609.8965; train_gene_expr_recon_loss: 92593.8379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177645.5391; train_optim_loss: 177645.5391; val_kl_reg_loss: 2406.4365; val_edge_recon_loss: 78797.5547; val_gene_expr_recon_loss: 90555.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171759.9531; val_optim_loss: 171759.9531
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9074; val_auprc_score: 0.9804; val_best_acc_score: 0.9214; val_best_f1_score: 0.9555; train_kl_reg_loss: 2439.1843; train_edge_recon_loss: 81319.7070; train_gene_expr_recon_loss: 92798.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176557.7695; train_optim_loss: 176557.7695; val_kl_reg_loss: 2408.7607; val_edge_recon_loss: 76211.3594; val_gene_expr_recon_loss: 90553.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169173.4688; val_optim_loss: 169173.4688
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9101; val_auprc_score: 0.9759; val_best_acc_score: 0.9150; val_best_f1_score: 0.9514; train_kl_reg_loss: 2438.4166; train_edge_recon_loss: 81328.7734; train_gene_expr_recon_loss: 92792.7930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176559.9883; train_optim_loss: 176559.9883; val_kl_reg_loss: 2405.0500; val_edge_recon_loss: 84739.4766; val_gene_expr_recon_loss: 90550.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177695.3750; val_optim_loss: 177695.3750
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9044; val_auprc_score: 0.9775; val_best_acc_score: 0.9196; val_best_f1_score: 0.9541; train_kl_reg_loss: 2433.7604; train_edge_recon_loss: 80341.2949; train_gene_expr_recon_loss: 92832.0820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175607.1328; train_optim_loss: 175607.1328; val_kl_reg_loss: 2402.4377; val_edge_recon_loss: 80219.4141; val_gene_expr_recon_loss: 90548.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173170.0312; val_optim_loss: 173170.0312
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9037; val_auprc_score: 0.9746; val_best_acc_score: 0.9185; val_best_f1_score: 0.9530; train_kl_reg_loss: 2432.9222; train_edge_recon_loss: 81727.8809; train_gene_expr_recon_loss: 92739.6133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176900.4102; train_optim_loss: 176900.4102; val_kl_reg_loss: 2396.2979; val_edge_recon_loss: 83238.4531; val_gene_expr_recon_loss: 90545.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176180.2031; val_optim_loss: 176180.2031

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9042; val_auprc_score: 0.9724; val_best_acc_score: 0.9176; val_best_f1_score: 0.9525; train_kl_reg_loss: 2434.4977; train_edge_recon_loss: 82435.9043; train_gene_expr_recon_loss: 92609.7305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177480.1367; train_optim_loss: 177480.1367; val_kl_reg_loss: 2400.9363; val_edge_recon_loss: 84351.8516; val_gene_expr_recon_loss: 90545.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177297.9688; val_optim_loss: 177297.9688
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9020; val_auprc_score: 0.9747; val_best_acc_score: 0.9160; val_best_f1_score: 0.9519; train_kl_reg_loss: 2431.8427; train_edge_recon_loss: 82309.7324; train_gene_expr_recon_loss: 92847.5371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177589.1094; train_optim_loss: 177589.1094; val_kl_reg_loss: 2402.0059; val_edge_recon_loss: 84603.4219; val_gene_expr_recon_loss: 90544.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177550.3594; val_optim_loss: 177550.3594
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9060; val_auprc_score: 0.9793; val_best_acc_score: 0.9202; val_best_f1_score: 0.9548; train_kl_reg_loss: 2437.4894; train_edge_recon_loss: 82011.5039; train_gene_expr_recon_loss: 92928.8516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177377.8438; train_optim_loss: 177377.8438; val_kl_reg_loss: 2403.1077; val_edge_recon_loss: 78521.6953; val_gene_expr_recon_loss: 90544.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171469.5000; val_optim_loss: 171469.5000

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 28 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
Val AUROC score: 0.9018
Val AUPRC score: 0.9753
Val best accuracy score: 0.9151
Val best F1 score: 0.9512
Val gene expr MSE score: 1.1008
Duration of model training in run 6: 0 hours, 0 minutes and 29 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 43113
Number of validation edges: 4790
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9620; val_auprc_score: 0.9897; val_best_acc_score: 0.9059; val_best_f1_score: 0.9471; train_kl_reg_loss: 109.6394; train_edge_recon_loss: 101455.6576; train_gene_expr_recon_loss: 123951.6198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 225516.9141; train_optim_loss: 225516.9141; val_kl_reg_loss: 270.9609; val_edge_recon_loss: 123289.2969; val_gene_expr_recon_loss: 107533.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 231093.3750; val_optim_loss: 231093.3750
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9521; val_auprc_score: 0.9863; val_best_acc_score: 0.9356; val_best_f1_score: 0.9626; train_kl_reg_loss: 268.6185; train_edge_recon_loss: 99721.3828; train_gene_expr_recon_loss: 100653.5417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200643.5391; train_optim_loss: 200643.5391; val_kl_reg_loss: 207.8320; val_edge_recon_loss: 109910.5000; val_gene_expr_recon_loss: 99781.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209899.4375; val_optim_loss: 209899.4375
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9054; val_auprc_score: 0.9785; val_best_acc_score: 0.9040; val_best_f1_score: 0.9455; train_kl_reg_loss: 171.5741; train_edge_recon_loss: 101348.5495; train_gene_expr_recon_loss: 95267.7656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196787.8906; train_optim_loss: 196787.8906; val_kl_reg_loss: 170.7122; val_edge_recon_loss: 106587.8438; val_gene_expr_recon_loss: 98247.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205006.0000; val_optim_loss: 205006.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8595; val_auprc_score: 0.9694; val_best_acc_score: 0.8871; val_best_f1_score: 0.9374; train_kl_reg_loss: 247.4320; train_edge_recon_loss: 98043.0208; train_gene_expr_recon_loss: 94440.0599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192730.5156; train_optim_loss: 192730.5156; val_kl_reg_loss: 419.2632; val_edge_recon_loss: 100207.7266; val_gene_expr_recon_loss: 97376.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198003.8438; val_optim_loss: 198003.8438
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8552; val_auprc_score: 0.9681; val_best_acc_score: 0.8970; val_best_f1_score: 0.9428; train_kl_reg_loss: 600.7595; train_edge_recon_loss: 94833.1120; train_gene_expr_recon_loss: 93547.6797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188981.5469; train_optim_loss: 188981.5469; val_kl_reg_loss: 945.1937; val_edge_recon_loss: 90647.4766; val_gene_expr_recon_loss: 96565.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188158.0938; val_optim_loss: 188158.0938
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8455; val_auprc_score: 0.9638; val_best_acc_score: 0.8948; val_best_f1_score: 0.9416; train_kl_reg_loss: 1206.7240; train_edge_recon_loss: 93225.4010; train_gene_expr_recon_loss: 92854.8008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187286.9245; train_optim_loss: 187286.9245; val_kl_reg_loss: 1632.1790; val_edge_recon_loss: 87802.2500; val_gene_expr_recon_loss: 95924.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185358.5156; val_optim_loss: 185358.5156
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8599; val_auprc_score: 0.9659; val_best_acc_score: 0.8955; val_best_f1_score: 0.9408; train_kl_reg_loss: 1784.0043; train_edge_recon_loss: 88065.9375; train_gene_expr_recon_loss: 91925.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181775.2500; train_optim_loss: 181775.2500; val_kl_reg_loss: 2005.4092; val_edge_recon_loss: 92137.9609; val_gene_expr_recon_loss: 95477.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189621.0312; val_optim_loss: 189621.0312
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8797; val_auprc_score: 0.9678; val_best_acc_score: 0.9057; val_best_f1_score: 0.9473; train_kl_reg_loss: 2056.4504; train_edge_recon_loss: 85368.7018; train_gene_expr_recon_loss: 91549.4831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178974.6354; train_optim_loss: 178974.6354; val_kl_reg_loss: 2312.7368; val_edge_recon_loss: 81999.8594; val_gene_expr_recon_loss: 95177.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179489.9688; val_optim_loss: 179489.9688
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9016; val_auprc_score: 0.9768; val_best_acc_score: 0.9189; val_best_f1_score: 0.9540; train_kl_reg_loss: 2443.3639; train_edge_recon_loss: 84059.0599; train_gene_expr_recon_loss: 91187.6081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177690.0312; train_optim_loss: 177690.0312; val_kl_reg_loss: 2725.6997; val_edge_recon_loss: 82405.1562; val_gene_expr_recon_loss: 94800.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179931.6875; val_optim_loss: 179931.6875
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9096; val_auprc_score: 0.9767; val_best_acc_score: 0.9280; val_best_f1_score: 0.9592; train_kl_reg_loss: 2729.3252; train_edge_recon_loss: 82399.8828; train_gene_expr_recon_loss: 91180.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176309.3359; train_optim_loss: 176309.3359; val_kl_reg_loss: 2692.2334; val_edge_recon_loss: 78850.5078; val_gene_expr_recon_loss: 94481.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176024.6250; val_optim_loss: 176024.6250
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9224; val_auprc_score: 0.9810; val_best_acc_score: 0.9366; val_best_f1_score: 0.9637; train_kl_reg_loss: 2497.5645; train_edge_recon_loss: 80934.6953; train_gene_expr_recon_loss: 91253.7005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174685.9609; train_optim_loss: 174685.9609; val_kl_reg_loss: 2270.1372; val_edge_recon_loss: 78592.2656; val_gene_expr_recon_loss: 94190.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175052.4062; val_optim_loss: 175052.4062
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9378; val_auprc_score: 0.9857; val_best_acc_score: 0.9418; val_best_f1_score: 0.9667; train_kl_reg_loss: 2112.9622; train_edge_recon_loss: 80173.0794; train_gene_expr_recon_loss: 90653.3086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172939.3464; train_optim_loss: 172939.3464; val_kl_reg_loss: 1972.0968; val_edge_recon_loss: 76687.2422; val_gene_expr_recon_loss: 93924.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172584.0625; val_optim_loss: 172584.0625
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9441; val_auprc_score: 0.9878; val_best_acc_score: 0.9421; val_best_f1_score: 0.9668; train_kl_reg_loss: 1903.6794; train_edge_recon_loss: 80399.0794; train_gene_expr_recon_loss: 90175.5026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172478.2604; train_optim_loss: 172478.2604; val_kl_reg_loss: 1902.0613; val_edge_recon_loss: 76955.2969; val_gene_expr_recon_loss: 93679.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172537.1250; val_optim_loss: 172537.1250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9425; val_auprc_score: 0.9841; val_best_acc_score: 0.9465; val_best_f1_score: 0.9692; train_kl_reg_loss: 1926.1187; train_edge_recon_loss: 79720.0117; train_gene_expr_recon_loss: 89952.9479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171599.0781; train_optim_loss: 171599.0781; val_kl_reg_loss: 1971.9011; val_edge_recon_loss: 80104.8125; val_gene_expr_recon_loss: 93399.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175476.3750; val_optim_loss: 175476.3750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9420; val_auprc_score: 0.9834; val_best_acc_score: 0.9434; val_best_f1_score: 0.9676; train_kl_reg_loss: 1960.7041; train_edge_recon_loss: 78314.4557; train_gene_expr_recon_loss: 90022.1641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170297.3255; train_optim_loss: 170297.3255; val_kl_reg_loss: 1951.2910; val_edge_recon_loss: 80812.6250; val_gene_expr_recon_loss: 93144.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175908.1719; val_optim_loss: 175908.1719
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9486; val_auprc_score: 0.9844; val_best_acc_score: 0.9464; val_best_f1_score: 0.9691; train_kl_reg_loss: 1927.0603; train_edge_recon_loss: 79826.4440; train_gene_expr_recon_loss: 90186.1367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171939.6432; train_optim_loss: 171939.6432; val_kl_reg_loss: 1903.7495; val_edge_recon_loss: 82347.3594; val_gene_expr_recon_loss: 92941.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177192.7656; val_optim_loss: 177192.7656

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9422; val_auprc_score: 0.9844; val_best_acc_score: 0.9495; val_best_f1_score: 0.9711; train_kl_reg_loss: 1897.6968; train_edge_recon_loss: 79893.6523; train_gene_expr_recon_loss: 89252.1615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171043.5104; train_optim_loss: 171043.5104; val_kl_reg_loss: 1897.2935; val_edge_recon_loss: 76282.7734; val_gene_expr_recon_loss: 92910.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171090.8438; val_optim_loss: 171090.8438
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9398; val_auprc_score: 0.9852; val_best_acc_score: 0.9469; val_best_f1_score: 0.9695; train_kl_reg_loss: 1886.4838; train_edge_recon_loss: 79410.0430; train_gene_expr_recon_loss: 88975.5508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170272.0755; train_optim_loss: 170272.0755; val_kl_reg_loss: 1889.2075; val_edge_recon_loss: 78151.3984; val_gene_expr_recon_loss: 92878.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172918.8125; val_optim_loss: 172918.8125
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9433; val_auprc_score: 0.9841; val_best_acc_score: 0.9510; val_best_f1_score: 0.9718; train_kl_reg_loss: 1886.5102; train_edge_recon_loss: 78415.3190; train_gene_expr_recon_loss: 88960.2448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169262.0781; train_optim_loss: 169262.0781; val_kl_reg_loss: 1893.7384; val_edge_recon_loss: 77827.5156; val_gene_expr_recon_loss: 92846.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172567.2656; val_optim_loss: 172567.2656
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9535; val_auprc_score: 0.9889; val_best_acc_score: 0.9508; val_best_f1_score: 0.9719; train_kl_reg_loss: 1885.7628; train_edge_recon_loss: 78479.1432; train_gene_expr_recon_loss: 89426.8177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169791.7240; train_optim_loss: 169791.7240; val_kl_reg_loss: 1895.8278; val_edge_recon_loss: 77087.5469; val_gene_expr_recon_loss: 92817.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171801.3281; val_optim_loss: 171801.3281

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9519; val_auprc_score: 0.9882; val_best_acc_score: 0.9510; val_best_f1_score: 0.9721; train_kl_reg_loss: 1891.5642; train_edge_recon_loss: 78277.6367; train_gene_expr_recon_loss: 89181.8229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169351.0234; train_optim_loss: 169351.0234; val_kl_reg_loss: 1899.6885; val_edge_recon_loss: 74833.8203; val_gene_expr_recon_loss: 92815.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169549.3125; val_optim_loss: 169549.3125
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9445; val_auprc_score: 0.9856; val_best_acc_score: 0.9480; val_best_f1_score: 0.9701; train_kl_reg_loss: 1895.7667; train_edge_recon_loss: 79245.9870; train_gene_expr_recon_loss: 89174.1042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170315.8594; train_optim_loss: 170315.8594; val_kl_reg_loss: 1898.7766; val_edge_recon_loss: 80746.8359; val_gene_expr_recon_loss: 92813.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175459.4219; val_optim_loss: 175459.4219
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9353; val_auprc_score: 0.9819; val_best_acc_score: 0.9499; val_best_f1_score: 0.9712; train_kl_reg_loss: 1890.1949; train_edge_recon_loss: 79913.8307; train_gene_expr_recon_loss: 89118.3268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170922.3542; train_optim_loss: 170922.3542; val_kl_reg_loss: 1898.8757; val_edge_recon_loss: 80003.5938; val_gene_expr_recon_loss: 92811.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174714.2812; val_optim_loss: 174714.2812
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9516; val_auprc_score: 0.9887; val_best_acc_score: 0.9483; val_best_f1_score: 0.9704; train_kl_reg_loss: 1895.6585; train_edge_recon_loss: 78993.1354; train_gene_expr_recon_loss: 89546.1185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170434.9115; train_optim_loss: 170434.9115; val_kl_reg_loss: 1898.1990; val_edge_recon_loss: 78176.0625; val_gene_expr_recon_loss: 92809.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172884.0625; val_optim_loss: 172884.0625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9520; val_auprc_score: 0.9881; val_best_acc_score: 0.9537; val_best_f1_score: 0.9733; train_kl_reg_loss: 1892.2326; train_edge_recon_loss: 77891.6367; train_gene_expr_recon_loss: 89087.6237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168871.4922; train_optim_loss: 168871.4922; val_kl_reg_loss: 1898.4146; val_edge_recon_loss: 76467.2031; val_gene_expr_recon_loss: 92809.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171175.1875; val_optim_loss: 171175.1875
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9478; val_auprc_score: 0.9835; val_best_acc_score: 0.9488; val_best_f1_score: 0.9705; train_kl_reg_loss: 1891.5099; train_edge_recon_loss: 78587.3685; train_gene_expr_recon_loss: 89815.4727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170294.3464; train_optim_loss: 170294.3464; val_kl_reg_loss: 1897.1903; val_edge_recon_loss: 78939.3984; val_gene_expr_recon_loss: 92809.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173645.9062; val_optim_loss: 173645.9062
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9423; val_auprc_score: 0.9849; val_best_acc_score: 0.9486; val_best_f1_score: 0.9704; train_kl_reg_loss: 1895.4544; train_edge_recon_loss: 79963.1289; train_gene_expr_recon_loss: 89488.7201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171347.3021; train_optim_loss: 171347.3021; val_kl_reg_loss: 1897.4171; val_edge_recon_loss: 79524.0859; val_gene_expr_recon_loss: 92809.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174230.5781; val_optim_loss: 174230.5781

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 36 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9453
Val AUPRC score: 0.9852
Val best accuracy score: 0.9482
Val best F1 score: 0.9700
Val gene expr MSE score: 1.1629
Duration of model training in run 7: 0 hours, 0 minutes and 37 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 43113
Number of validation edges: 4790
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9613; val_auprc_score: 0.9884; val_best_acc_score: 0.9127; val_best_f1_score: 0.9507; train_kl_reg_loss: 105.8678; train_edge_recon_loss: 102669.0417; train_gene_expr_recon_loss: 122618.0469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 225392.9531; train_optim_loss: 225392.9531; val_kl_reg_loss: 224.3681; val_edge_recon_loss: 122911.3438; val_gene_expr_recon_loss: 101921.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 225056.9688; val_optim_loss: 225056.9688
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9476; val_auprc_score: 0.9879; val_best_acc_score: 0.9244; val_best_f1_score: 0.9554; train_kl_reg_loss: 221.0957; train_edge_recon_loss: 102503.2630; train_gene_expr_recon_loss: 100422.2305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203146.5938; train_optim_loss: 203146.5938; val_kl_reg_loss: 165.3742; val_edge_recon_loss: 113413.6953; val_gene_expr_recon_loss: 94920.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208499.2812; val_optim_loss: 208499.2812
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8819; val_auprc_score: 0.9691; val_best_acc_score: 0.9081; val_best_f1_score: 0.9479; train_kl_reg_loss: 161.5783; train_edge_recon_loss: 98961.0169; train_gene_expr_recon_loss: 95525.4180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194648.0130; train_optim_loss: 194648.0130; val_kl_reg_loss: 191.5187; val_edge_recon_loss: 103363.7734; val_gene_expr_recon_loss: 93224.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196780.2344; val_optim_loss: 196780.2344
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8508; val_auprc_score: 0.9661; val_best_acc_score: 0.8921; val_best_f1_score: 0.9403; train_kl_reg_loss: 308.5324; train_edge_recon_loss: 98091.7773; train_gene_expr_recon_loss: 94616.6823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193016.9896; train_optim_loss: 193016.9896; val_kl_reg_loss: 529.5764; val_edge_recon_loss: 95266.4297; val_gene_expr_recon_loss: 92260.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188056.5938; val_optim_loss: 188056.5938
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8528; val_auprc_score: 0.9655; val_best_acc_score: 0.8979; val_best_f1_score: 0.9433; train_kl_reg_loss: 811.8289; train_edge_recon_loss: 94408.8776; train_gene_expr_recon_loss: 93701.0182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188921.7214; train_optim_loss: 188921.7214; val_kl_reg_loss: 1234.7537; val_edge_recon_loss: 88760.6094; val_gene_expr_recon_loss: 91518.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181513.9844; val_optim_loss: 181513.9844
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8665; val_auprc_score: 0.9730; val_best_acc_score: 0.8994; val_best_f1_score: 0.9442; train_kl_reg_loss: 1613.0881; train_edge_recon_loss: 91459.4245; train_gene_expr_recon_loss: 92892.6445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185965.1589; train_optim_loss: 185965.1589; val_kl_reg_loss: 1966.8875; val_edge_recon_loss: 85569.1484; val_gene_expr_recon_loss: 90985.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178521.5781; val_optim_loss: 178521.5781
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8821; val_auprc_score: 0.9734; val_best_acc_score: 0.9141; val_best_f1_score: 0.9520; train_kl_reg_loss: 2137.4097; train_edge_recon_loss: 88181.1393; train_gene_expr_recon_loss: 92624.5846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182943.1328; train_optim_loss: 182943.1328; val_kl_reg_loss: 2220.7605; val_edge_recon_loss: 78286.3906; val_gene_expr_recon_loss: 90646.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171153.2031; val_optim_loss: 171153.2031
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9043; val_auprc_score: 0.9747; val_best_acc_score: 0.9158; val_best_f1_score: 0.9525; train_kl_reg_loss: 2368.8895; train_edge_recon_loss: 85589.9414; train_gene_expr_recon_loss: 93258.6081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181217.4375; train_optim_loss: 181217.4375; val_kl_reg_loss: 2397.2158; val_edge_recon_loss: 81925.8516; val_gene_expr_recon_loss: 90374.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174697.1250; val_optim_loss: 174697.1250
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8999; val_auprc_score: 0.9725; val_best_acc_score: 0.9173; val_best_f1_score: 0.9531; train_kl_reg_loss: 2477.6430; train_edge_recon_loss: 82352.3568; train_gene_expr_recon_loss: 92557.2695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177387.2708; train_optim_loss: 177387.2708; val_kl_reg_loss: 2453.7825; val_edge_recon_loss: 85393.6172; val_gene_expr_recon_loss: 89990.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177837.8750; val_optim_loss: 177837.8750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9166; val_auprc_score: 0.9806; val_best_acc_score: 0.9236; val_best_f1_score: 0.9567; train_kl_reg_loss: 2433.2699; train_edge_recon_loss: 81573.5078; train_gene_expr_recon_loss: 91837.1367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175843.9167; train_optim_loss: 175843.9167; val_kl_reg_loss: 2267.8530; val_edge_recon_loss: 82990.2188; val_gene_expr_recon_loss: 89703.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174961.4062; val_optim_loss: 174961.4062

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9185; val_auprc_score: 0.9791; val_best_acc_score: 0.9332; val_best_f1_score: 0.9619; train_kl_reg_loss: 2276.9356; train_edge_recon_loss: 80364.2435; train_gene_expr_recon_loss: 91496.2917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174137.4766; train_optim_loss: 174137.4766; val_kl_reg_loss: 2232.1084; val_edge_recon_loss: 79412.6875; val_gene_expr_recon_loss: 89658.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171303.5781; val_optim_loss: 171303.5781
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9302; val_auprc_score: 0.9828; val_best_acc_score: 0.9326; val_best_f1_score: 0.9611; train_kl_reg_loss: 2242.6600; train_edge_recon_loss: 81985.7174; train_gene_expr_recon_loss: 91731.6276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175960.0052; train_optim_loss: 175960.0052; val_kl_reg_loss: 2196.5466; val_edge_recon_loss: 82105.5469; val_gene_expr_recon_loss: 89612.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173914.2812; val_optim_loss: 173914.2812
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9307; val_auprc_score: 0.9809; val_best_acc_score: 0.9297; val_best_f1_score: 0.9599; train_kl_reg_loss: 2205.5288; train_edge_recon_loss: 80947.1953; train_gene_expr_recon_loss: 91667.5182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174820.2396; train_optim_loss: 174820.2396; val_kl_reg_loss: 2157.0088; val_edge_recon_loss: 82668.1875; val_gene_expr_recon_loss: 89573.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174398.7344; val_optim_loss: 174398.7344

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 17 sec.
Using best model state, which was in epoch 7.

--- MODEL EVALUATION ---
Val AUROC score: 0.8781
Val AUPRC score: 0.9694
Val best accuracy score: 0.8997
Val best F1 score: 0.9440
Val gene expr MSE score: 1.2143
Duration of model training in run 8: 0 hours, 0 minutes and 18 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 53901
Number of validation edges: 5988
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9534; val_auprc_score: 0.9879; val_best_acc_score: 0.9044; val_best_f1_score: 0.9472; train_kl_reg_loss: 129.9370; train_edge_recon_loss: 100295.9565; train_gene_expr_recon_loss: 120231.3940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220657.2857; train_optim_loss: 220657.2857; val_kl_reg_loss: 295.3206; val_edge_recon_loss: 112474.0547; val_gene_expr_recon_loss: 102535.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215305.0938; val_optim_loss: 215305.0938
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9364; val_auprc_score: 0.9822; val_best_acc_score: 0.9161; val_best_f1_score: 0.9504; train_kl_reg_loss: 276.9446; train_edge_recon_loss: 101016.7132; train_gene_expr_recon_loss: 98098.1272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199391.7835; train_optim_loss: 199391.7835; val_kl_reg_loss: 202.5298; val_edge_recon_loss: 109506.1094; val_gene_expr_recon_loss: 97060.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206768.6562; val_optim_loss: 206768.6562
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8783; val_auprc_score: 0.9733; val_best_acc_score: 0.8992; val_best_f1_score: 0.9428; train_kl_reg_loss: 203.4297; train_edge_recon_loss: 100397.3527; train_gene_expr_recon_loss: 95337.1674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195937.9509; train_optim_loss: 195937.9509; val_kl_reg_loss: 288.3748; val_edge_recon_loss: 94729.9688; val_gene_expr_recon_loss: 95687.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190705.5625; val_optim_loss: 190705.5625
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8495; val_auprc_score: 0.9652; val_best_acc_score: 0.8893; val_best_f1_score: 0.9383; train_kl_reg_loss: 505.4135; train_edge_recon_loss: 97002.8594; train_gene_expr_recon_loss: 93867.1987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191375.4754; train_optim_loss: 191375.4754; val_kl_reg_loss: 889.2004; val_edge_recon_loss: 96164.8516; val_gene_expr_recon_loss: 94635.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191689.7500; val_optim_loss: 191689.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8450; val_auprc_score: 0.9660; val_best_acc_score: 0.8955; val_best_f1_score: 0.9416; train_kl_reg_loss: 1281.1353; train_edge_recon_loss: 92164.4810; train_gene_expr_recon_loss: 93027.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186472.8638; train_optim_loss: 186472.8638; val_kl_reg_loss: 1740.8524; val_edge_recon_loss: 91105.8672; val_gene_expr_recon_loss: 93882.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186729.0938; val_optim_loss: 186729.0938
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8675; val_auprc_score: 0.9674; val_best_acc_score: 0.9053; val_best_f1_score: 0.9465; train_kl_reg_loss: 1929.7558; train_edge_recon_loss: 88155.1585; train_gene_expr_recon_loss: 92552.5212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182637.4353; train_optim_loss: 182637.4353; val_kl_reg_loss: 2155.3433; val_edge_recon_loss: 86304.6250; val_gene_expr_recon_loss: 93511.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181971.5312; val_optim_loss: 181971.5312
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8912; val_auprc_score: 0.9763; val_best_acc_score: 0.9171; val_best_f1_score: 0.9534; train_kl_reg_loss: 2325.1373; train_edge_recon_loss: 84678.7355; train_gene_expr_recon_loss: 92081.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179084.9978; train_optim_loss: 179084.9978; val_kl_reg_loss: 2560.2603; val_edge_recon_loss: 80320.5156; val_gene_expr_recon_loss: 93134.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176015.2188; val_optim_loss: 176015.2188
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9081; val_auprc_score: 0.9778; val_best_acc_score: 0.9206; val_best_f1_score: 0.9551; train_kl_reg_loss: 2614.8315; train_edge_recon_loss: 82139.1797; train_gene_expr_recon_loss: 91698.4420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176452.4554; train_optim_loss: 176452.4554; val_kl_reg_loss: 2524.4194; val_edge_recon_loss: 80695.3359; val_gene_expr_recon_loss: 92775.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175995.0000; val_optim_loss: 175995.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9219; val_auprc_score: 0.9795; val_best_acc_score: 0.9300; val_best_f1_score: 0.9598; train_kl_reg_loss: 2336.8673; train_edge_recon_loss: 80660.4944; train_gene_expr_recon_loss: 91246.6864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174244.0469; train_optim_loss: 174244.0469; val_kl_reg_loss: 2053.8613; val_edge_recon_loss: 79418.2031; val_gene_expr_recon_loss: 92411.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173883.5156; val_optim_loss: 173883.5156
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9283; val_auprc_score: 0.9820; val_best_acc_score: 0.9346; val_best_f1_score: 0.9626; train_kl_reg_loss: 1931.4948; train_edge_recon_loss: 80944.7121; train_gene_expr_recon_loss: 91054.4408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173930.6451; train_optim_loss: 173930.6451; val_kl_reg_loss: 1821.2058; val_edge_recon_loss: 79310.4453; val_gene_expr_recon_loss: 92143.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173275.0156; val_optim_loss: 173275.0156
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9295; val_auprc_score: 0.9806; val_best_acc_score: 0.9380; val_best_f1_score: 0.9644; train_kl_reg_loss: 1872.6271; train_edge_recon_loss: 80179.4799; train_gene_expr_recon_loss: 90329.5748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172381.6830; train_optim_loss: 172381.6830; val_kl_reg_loss: 1918.0859; val_edge_recon_loss: 79379.2266; val_gene_expr_recon_loss: 91860.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173158.2031; val_optim_loss: 173158.2031
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9432; val_auprc_score: 0.9839; val_best_acc_score: 0.9412; val_best_f1_score: 0.9662; train_kl_reg_loss: 1949.8706; train_edge_recon_loss: 79861.4129; train_gene_expr_recon_loss: 90556.8973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172368.1808; train_optim_loss: 172368.1808; val_kl_reg_loss: 1900.3335; val_edge_recon_loss: 80654.2344; val_gene_expr_recon_loss: 91599.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174153.9375; val_optim_loss: 174153.9375
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9394; val_auprc_score: 0.9814; val_best_acc_score: 0.9430; val_best_f1_score: 0.9669; train_kl_reg_loss: 1886.0460; train_edge_recon_loss: 79850.7556; train_gene_expr_recon_loss: 90384.3013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172121.1049; train_optim_loss: 172121.1049; val_kl_reg_loss: 1813.9290; val_edge_recon_loss: 84600.1016; val_gene_expr_recon_loss: 91335.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177749.3438; val_optim_loss: 177749.3438
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9436; val_auprc_score: 0.9836; val_best_acc_score: 0.9478; val_best_f1_score: 0.9699; train_kl_reg_loss: 1840.9198; train_edge_recon_loss: 79736.6708; train_gene_expr_recon_loss: 90059.3002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171636.8884; train_optim_loss: 171636.8884; val_kl_reg_loss: 1856.7578; val_edge_recon_loss: 79059.3828; val_gene_expr_recon_loss: 91089.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172005.5938; val_optim_loss: 172005.5938
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9494; val_auprc_score: 0.9883; val_best_acc_score: 0.9545; val_best_f1_score: 0.9739; train_kl_reg_loss: 1889.6251; train_edge_recon_loss: 79040.2801; train_gene_expr_recon_loss: 89625.1987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170555.1049; train_optim_loss: 170555.1049; val_kl_reg_loss: 1866.9425; val_edge_recon_loss: 75174.8047; val_gene_expr_recon_loss: 90840.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167882.2344; val_optim_loss: 167882.2344
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9524; val_auprc_score: 0.9869; val_best_acc_score: 0.9526; val_best_f1_score: 0.9727; train_kl_reg_loss: 1860.6283; train_edge_recon_loss: 78278.7109; train_gene_expr_recon_loss: 89258.2835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169397.6250; train_optim_loss: 169397.6250; val_kl_reg_loss: 1827.8806; val_edge_recon_loss: 77782.2109; val_gene_expr_recon_loss: 90659.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170269.8438; val_optim_loss: 170269.8438
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9515; val_auprc_score: 0.9873; val_best_acc_score: 0.9555; val_best_f1_score: 0.9743; train_kl_reg_loss: 1850.4683; train_edge_recon_loss: 78135.0022; train_gene_expr_recon_loss: 89354.4420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169339.9152; train_optim_loss: 169339.9152; val_kl_reg_loss: 1830.7444; val_edge_recon_loss: 78015.7422; val_gene_expr_recon_loss: 90469.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170316.0312; val_optim_loss: 170316.0312
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9567; val_auprc_score: 0.9885; val_best_acc_score: 0.9541; val_best_f1_score: 0.9734; train_kl_reg_loss: 1858.0508; train_edge_recon_loss: 78901.6016; train_gene_expr_recon_loss: 89251.1629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170010.8170; train_optim_loss: 170010.8170; val_kl_reg_loss: 1825.4760; val_edge_recon_loss: 80250.0547; val_gene_expr_recon_loss: 90308.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172383.6094; val_optim_loss: 172383.6094

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9577; val_auprc_score: 0.9888; val_best_acc_score: 0.9533; val_best_f1_score: 0.9729; train_kl_reg_loss: 1844.3726; train_edge_recon_loss: 78385.3359; train_gene_expr_recon_loss: 89103.4621; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169333.1674; train_optim_loss: 169333.1674; val_kl_reg_loss: 1820.3911; val_edge_recon_loss: 80791.4062; val_gene_expr_recon_loss: 90280.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172892.1875; val_optim_loss: 172892.1875
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9499; val_auprc_score: 0.9876; val_best_acc_score: 0.9504; val_best_f1_score: 0.9713; train_kl_reg_loss: 1839.6815; train_edge_recon_loss: 79269.5290; train_gene_expr_recon_loss: 89146.4196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170255.6317; train_optim_loss: 170255.6317; val_kl_reg_loss: 1819.1365; val_edge_recon_loss: 81502.8828; val_gene_expr_recon_loss: 90256.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173578.9375; val_optim_loss: 173578.9375
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9539; val_auprc_score: 0.9860; val_best_acc_score: 0.9554; val_best_f1_score: 0.9741; train_kl_reg_loss: 1836.3381; train_edge_recon_loss: 78970.7489; train_gene_expr_recon_loss: 88790.8136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169597.9062; train_optim_loss: 169597.9062; val_kl_reg_loss: 1816.3632; val_edge_recon_loss: 79396.5938; val_gene_expr_recon_loss: 90238.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171451.0000; val_optim_loss: 171451.0000

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 34 sec.
Using best model state, which was in epoch 15.

--- MODEL EVALUATION ---
Val AUROC score: 0.9553
Val AUPRC score: 0.9871
Val best accuracy score: 0.9531
Val best F1 score: 0.9729
Val gene expr MSE score: 1.1315
Duration of model training in run 9: 0 hours, 0 minutes and 35 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 53901
Number of validation edges: 5988
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9592; val_auprc_score: 0.9884; val_best_acc_score: 0.8992; val_best_f1_score: 0.9439; train_kl_reg_loss: 131.6743; train_edge_recon_loss: 102873.4051; train_gene_expr_recon_loss: 120518.4721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 223523.5536; train_optim_loss: 223523.5536; val_kl_reg_loss: 298.9571; val_edge_recon_loss: 120397.2344; val_gene_expr_recon_loss: 101513.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222210.0938; val_optim_loss: 222210.0938
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9443; val_auprc_score: 0.9866; val_best_acc_score: 0.9198; val_best_f1_score: 0.9531; train_kl_reg_loss: 272.3019; train_edge_recon_loss: 101946.3761; train_gene_expr_recon_loss: 98855.7489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201074.4263; train_optim_loss: 201074.4263; val_kl_reg_loss: 201.2097; val_edge_recon_loss: 112030.6641; val_gene_expr_recon_loss: 95993.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208225.1875; val_optim_loss: 208225.1875
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8831; val_auprc_score: 0.9709; val_best_acc_score: 0.9022; val_best_f1_score: 0.9448; train_kl_reg_loss: 194.8891; train_edge_recon_loss: 101010.0089; train_gene_expr_recon_loss: 95566.5179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196771.4152; train_optim_loss: 196771.4152; val_kl_reg_loss: 248.8343; val_edge_recon_loss: 98877.0312; val_gene_expr_recon_loss: 94419.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193545.5312; val_optim_loss: 193545.5312
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8397; val_auprc_score: 0.9643; val_best_acc_score: 0.8859; val_best_f1_score: 0.9369; train_kl_reg_loss: 418.4870; train_edge_recon_loss: 97182.0625; train_gene_expr_recon_loss: 94041.0614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191641.6094; train_optim_loss: 191641.6094; val_kl_reg_loss: 719.1096; val_edge_recon_loss: 96744.1953; val_gene_expr_recon_loss: 93337.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190800.7500; val_optim_loss: 190800.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8457; val_auprc_score: 0.9660; val_best_acc_score: 0.8942; val_best_f1_score: 0.9406; train_kl_reg_loss: 1028.3706; train_edge_recon_loss: 93012.5781; train_gene_expr_recon_loss: 93329.8996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187370.8482; train_optim_loss: 187370.8482; val_kl_reg_loss: 1465.5542; val_edge_recon_loss: 90923.3359; val_gene_expr_recon_loss: 92528.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184917.7188; val_optim_loss: 184917.7188
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8587; val_auprc_score: 0.9652; val_best_acc_score: 0.9025; val_best_f1_score: 0.9452; train_kl_reg_loss: 1704.3358; train_edge_recon_loss: 90850.3906; train_gene_expr_recon_loss: 92635.0837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185189.8103; train_optim_loss: 185189.8103; val_kl_reg_loss: 1928.3472; val_edge_recon_loss: 87494.5469; val_gene_expr_recon_loss: 92095.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181518.3750; val_optim_loss: 181518.3750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8799; val_auprc_score: 0.9707; val_best_acc_score: 0.9042; val_best_f1_score: 0.9461; train_kl_reg_loss: 2075.8267; train_edge_recon_loss: 84996.6250; train_gene_expr_recon_loss: 91868.3047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178940.7567; train_optim_loss: 178940.7567; val_kl_reg_loss: 2348.1323; val_edge_recon_loss: 87284.3672; val_gene_expr_recon_loss: 91829.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181462.3125; val_optim_loss: 181462.3125
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8997; val_auprc_score: 0.9759; val_best_acc_score: 0.9191; val_best_f1_score: 0.9542; train_kl_reg_loss: 2472.3720; train_edge_recon_loss: 82518.4821; train_gene_expr_recon_loss: 92213.5592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177204.4129; train_optim_loss: 177204.4129; val_kl_reg_loss: 2620.6543; val_edge_recon_loss: 82263.3047; val_gene_expr_recon_loss: 91333.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176217.1562; val_optim_loss: 176217.1562
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9104; val_auprc_score: 0.9771; val_best_acc_score: 0.9283; val_best_f1_score: 0.9593; train_kl_reg_loss: 2515.7828; train_edge_recon_loss: 81749.2779; train_gene_expr_recon_loss: 91102.6529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175367.7121; train_optim_loss: 175367.7121; val_kl_reg_loss: 2312.9639; val_edge_recon_loss: 78841.6484; val_gene_expr_recon_loss: 90994.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172149.0625; val_optim_loss: 172149.0625
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9293; val_auprc_score: 0.9813; val_best_acc_score: 0.9380; val_best_f1_score: 0.9643; train_kl_reg_loss: 2129.8478; train_edge_recon_loss: 82249.4375; train_gene_expr_recon_loss: 91208.8616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175588.1473; train_optim_loss: 175588.1473; val_kl_reg_loss: 1963.8911; val_edge_recon_loss: 80965.2344; val_gene_expr_recon_loss: 90703.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173632.7188; val_optim_loss: 173632.7188
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9354; val_auprc_score: 0.9807; val_best_acc_score: 0.9396; val_best_f1_score: 0.9654; train_kl_reg_loss: 1912.8299; train_edge_recon_loss: 80447.5201; train_gene_expr_recon_loss: 91021.9074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173382.2612; train_optim_loss: 173382.2612; val_kl_reg_loss: 1888.8146; val_edge_recon_loss: 81222.8750; val_gene_expr_recon_loss: 90377.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173489.0781; val_optim_loss: 173489.0781
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9444; val_auprc_score: 0.9838; val_best_acc_score: 0.9483; val_best_f1_score: 0.9703; train_kl_reg_loss: 1904.4744; train_edge_recon_loss: 78892.6295; train_gene_expr_recon_loss: 90720.7891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171517.8906; train_optim_loss: 171517.8906; val_kl_reg_loss: 1902.0110; val_edge_recon_loss: 78209.3281; val_gene_expr_recon_loss: 90096.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170207.7969; val_optim_loss: 170207.7969
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9516; val_auprc_score: 0.9885; val_best_acc_score: 0.9491; val_best_f1_score: 0.9708; train_kl_reg_loss: 1911.6140; train_edge_recon_loss: 80196.8571; train_gene_expr_recon_loss: 90276.9676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172385.4353; train_optim_loss: 172385.4353; val_kl_reg_loss: 1906.0588; val_edge_recon_loss: 75429.1172; val_gene_expr_recon_loss: 89802.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167138.0938; val_optim_loss: 167138.0938
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9428; val_auprc_score: 0.9854; val_best_acc_score: 0.9458; val_best_f1_score: 0.9689; train_kl_reg_loss: 1888.2613; train_edge_recon_loss: 78997.1585; train_gene_expr_recon_loss: 90378.9732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171264.3906; train_optim_loss: 171264.3906; val_kl_reg_loss: 1843.9810; val_edge_recon_loss: 78613.7500; val_gene_expr_recon_loss: 89527.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169985.1250; val_optim_loss: 169985.1250
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9464; val_auprc_score: 0.9848; val_best_acc_score: 0.9503; val_best_f1_score: 0.9714; train_kl_reg_loss: 1860.3353; train_edge_recon_loss: 79852.6161; train_gene_expr_recon_loss: 89636.7846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171349.7388; train_optim_loss: 171349.7388; val_kl_reg_loss: 1836.2996; val_edge_recon_loss: 77723.6484; val_gene_expr_recon_loss: 89322.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168882.2500; val_optim_loss: 168882.2500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9481; val_auprc_score: 0.9825; val_best_acc_score: 0.9524; val_best_f1_score: 0.9727; train_kl_reg_loss: 1850.3924; train_edge_recon_loss: 79216.0290; train_gene_expr_recon_loss: 89703.9487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170770.3705; train_optim_loss: 170770.3705; val_kl_reg_loss: 1835.5977; val_edge_recon_loss: 78270.8438; val_gene_expr_recon_loss: 89109.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169215.9375; val_optim_loss: 169215.9375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9485; val_auprc_score: 0.9854; val_best_acc_score: 0.9510; val_best_f1_score: 0.9716; train_kl_reg_loss: 1853.0969; train_edge_recon_loss: 78677.1283; train_gene_expr_recon_loss: 89329.6775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169859.9040; train_optim_loss: 169859.9040; val_kl_reg_loss: 1840.9360; val_edge_recon_loss: 80139.3281; val_gene_expr_recon_loss: 89084.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171064.7500; val_optim_loss: 171064.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9441; val_auprc_score: 0.9826; val_best_acc_score: 0.9494; val_best_f1_score: 0.9708; train_kl_reg_loss: 1856.2174; train_edge_recon_loss: 78585.2467; train_gene_expr_recon_loss: 89449.0692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169890.5357; train_optim_loss: 169890.5357; val_kl_reg_loss: 1840.5112; val_edge_recon_loss: 78971.8359; val_gene_expr_recon_loss: 89050.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169862.3750; val_optim_loss: 169862.3750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9531; val_auprc_score: 0.9871; val_best_acc_score: 0.9542; val_best_f1_score: 0.9738; train_kl_reg_loss: 1854.6044; train_edge_recon_loss: 78970.0167; train_gene_expr_recon_loss: 89470.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170294.8013; train_optim_loss: 170294.8013; val_kl_reg_loss: 1834.4397; val_edge_recon_loss: 76377.5078; val_gene_expr_recon_loss: 89024.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167236.1250; val_optim_loss: 167236.1250

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 31 sec.
Using best model state, which was in epoch 13.

--- MODEL EVALUATION ---
Val AUROC score: 0.9525
Val AUPRC score: 0.9876
Val best accuracy score: 0.9459
Val best F1 score: 0.9688
Val gene expr MSE score: 1.0354
Duration of model training in run 10: 0 hours, 0 minutes and 32 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
First script finished. Launching follow up script.
Run timestamp: 01062023_144339.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_25pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-attention_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-attention', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 27455
Number of validation edges: 3050
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9282; val_auprc_score: 0.9843; val_best_acc_score: 0.9040; val_best_f1_score: 0.9448; train_kl_reg_loss: 68.9659; train_edge_recon_loss: 100306.8809; train_gene_expr_recon_loss: 125360.2520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 225736.0977; train_optim_loss: 225736.0977; val_kl_reg_loss: 149.3485; val_edge_recon_loss: 113549.7344; val_gene_expr_recon_loss: 109566.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 223265.3438; val_optim_loss: 223265.3438
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9423; val_auprc_score: 0.9886; val_best_acc_score: 0.9159; val_best_f1_score: 0.9520; train_kl_reg_loss: 209.7783; train_edge_recon_loss: 100809.1152; train_gene_expr_recon_loss: 104880.9902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205899.8828; train_optim_loss: 205899.8828; val_kl_reg_loss: 234.5193; val_edge_recon_loss: 116845.9453; val_gene_expr_recon_loss: 100758.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217839.4062; val_optim_loss: 217839.4062
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9278; val_auprc_score: 0.9850; val_best_acc_score: 0.9191; val_best_f1_score: 0.9540; train_kl_reg_loss: 214.6813; train_edge_recon_loss: 101703.6172; train_gene_expr_recon_loss: 99176.9512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201095.2500; train_optim_loss: 201095.2500; val_kl_reg_loss: 161.3456; val_edge_recon_loss: 108603.3594; val_gene_expr_recon_loss: 98303.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207068.1875; val_optim_loss: 207068.1875
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8968; val_auprc_score: 0.9775; val_best_acc_score: 0.9076; val_best_f1_score: 0.9480; train_kl_reg_loss: 151.6370; train_edge_recon_loss: 102681.1445; train_gene_expr_recon_loss: 97697.3047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200530.0898; train_optim_loss: 200530.0898; val_kl_reg_loss: 140.7324; val_edge_recon_loss: 102598.6562; val_gene_expr_recon_loss: 97512.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200251.4375; val_optim_loss: 200251.4375
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8715; val_auprc_score: 0.9708; val_best_acc_score: 0.9011; val_best_f1_score: 0.9436; train_kl_reg_loss: 167.2790; train_edge_recon_loss: 100319.9297; train_gene_expr_recon_loss: 96982.8145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197470.0234; train_optim_loss: 197470.0234; val_kl_reg_loss: 224.0022; val_edge_recon_loss: 101341.0938; val_gene_expr_recon_loss: 96998.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198563.1406; val_optim_loss: 198563.1406
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8437; val_auprc_score: 0.9583; val_best_acc_score: 0.8856; val_best_f1_score: 0.9356; train_kl_reg_loss: 310.6459; train_edge_recon_loss: 98237.8066; train_gene_expr_recon_loss: 96236.5879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194785.0430; train_optim_loss: 194785.0430; val_kl_reg_loss: 479.5299; val_edge_recon_loss: 99698.5781; val_gene_expr_recon_loss: 96468.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196646.9375; val_optim_loss: 196646.9375
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8412; val_auprc_score: 0.9617; val_best_acc_score: 0.8917; val_best_f1_score: 0.9388; train_kl_reg_loss: 678.1953; train_edge_recon_loss: 93332.6621; train_gene_expr_recon_loss: 95799.3027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189810.1602; train_optim_loss: 189810.1602; val_kl_reg_loss: 1024.5585; val_edge_recon_loss: 91659.0078; val_gene_expr_recon_loss: 95945.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188628.7812; val_optim_loss: 188628.7812
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8839; val_auprc_score: 0.9737; val_best_acc_score: 0.8918; val_best_f1_score: 0.9388; train_kl_reg_loss: 1356.8505; train_edge_recon_loss: 89750.8242; train_gene_expr_recon_loss: 95203.3105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186310.9844; train_optim_loss: 186310.9844; val_kl_reg_loss: 1820.2012; val_edge_recon_loss: 85586.4141; val_gene_expr_recon_loss: 95481.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182888.1562; val_optim_loss: 182888.1562
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8600; val_auprc_score: 0.9680; val_best_acc_score: 0.8941; val_best_f1_score: 0.9408; train_kl_reg_loss: 2137.5306; train_edge_recon_loss: 85573.8750; train_gene_expr_recon_loss: 94747.0215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182458.4258; train_optim_loss: 182458.4258; val_kl_reg_loss: 2471.2886; val_edge_recon_loss: 85124.2812; val_gene_expr_recon_loss: 95057.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182653.4062; val_optim_loss: 182653.4062
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8893; val_auprc_score: 0.9745; val_best_acc_score: 0.8999; val_best_f1_score: 0.9438; train_kl_reg_loss: 2703.3410; train_edge_recon_loss: 85535.7344; train_gene_expr_recon_loss: 94223.3711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182462.4492; train_optim_loss: 182462.4492; val_kl_reg_loss: 2879.4980; val_edge_recon_loss: 82694.6172; val_gene_expr_recon_loss: 94900.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180474.2188; val_optim_loss: 180474.2188
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8853; val_auprc_score: 0.9748; val_best_acc_score: 0.9062; val_best_f1_score: 0.9474; train_kl_reg_loss: 2946.0583; train_edge_recon_loss: 81467.2480; train_gene_expr_recon_loss: 94018.2891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178431.5938; train_optim_loss: 178431.5938; val_kl_reg_loss: 2840.4854; val_edge_recon_loss: 78438.1719; val_gene_expr_recon_loss: 94550.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175829.0938; val_optim_loss: 175829.0938
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9037; val_auprc_score: 0.9784; val_best_acc_score: 0.9049; val_best_f1_score: 0.9455; train_kl_reg_loss: 2897.4431; train_edge_recon_loss: 80524.2715; train_gene_expr_recon_loss: 93708.0273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177129.7422; train_optim_loss: 177129.7422; val_kl_reg_loss: 2757.3062; val_edge_recon_loss: 83363.2422; val_gene_expr_recon_loss: 94297.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180418.3125; val_optim_loss: 180418.3125
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9017; val_auprc_score: 0.9754; val_best_acc_score: 0.9111; val_best_f1_score: 0.9495; train_kl_reg_loss: 2741.9626; train_edge_recon_loss: 81441.4805; train_gene_expr_recon_loss: 93516.1406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177699.5820; train_optim_loss: 177699.5820; val_kl_reg_loss: 2571.8516; val_edge_recon_loss: 81983.0156; val_gene_expr_recon_loss: 94022.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178577.6406; val_optim_loss: 178577.6406
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9162; val_auprc_score: 0.9805; val_best_acc_score: 0.9104; val_best_f1_score: 0.9485; train_kl_reg_loss: 2564.3275; train_edge_recon_loss: 81603.8457; train_gene_expr_recon_loss: 93196.9336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177365.1094; train_optim_loss: 177365.1094; val_kl_reg_loss: 2412.2358; val_edge_recon_loss: 84207.8047; val_gene_expr_recon_loss: 93784.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180404.8906; val_optim_loss: 180404.8906

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9277; val_auprc_score: 0.9842; val_best_acc_score: 0.9166; val_best_f1_score: 0.9524; train_kl_reg_loss: 2472.7921; train_edge_recon_loss: 81546.4570; train_gene_expr_recon_loss: 93374.2246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177393.4766; train_optim_loss: 177393.4766; val_kl_reg_loss: 2401.8821; val_edge_recon_loss: 82013.9922; val_gene_expr_recon_loss: 93759.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178175.0312; val_optim_loss: 178175.0312
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9152; val_auprc_score: 0.9789; val_best_acc_score: 0.9146; val_best_f1_score: 0.9509; train_kl_reg_loss: 2457.0225; train_edge_recon_loss: 81195.3672; train_gene_expr_recon_loss: 93176.4141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176828.8047; train_optim_loss: 176828.8047; val_kl_reg_loss: 2389.1909; val_edge_recon_loss: 83265.7578; val_gene_expr_recon_loss: 93730.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179385.2500; val_optim_loss: 179385.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9133; val_auprc_score: 0.9798; val_best_acc_score: 0.9109; val_best_f1_score: 0.9491; train_kl_reg_loss: 2446.1653; train_edge_recon_loss: 81600.4863; train_gene_expr_recon_loss: 93143.0527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177189.7031; train_optim_loss: 177189.7031; val_kl_reg_loss: 2390.1169; val_edge_recon_loss: 82262.2891; val_gene_expr_recon_loss: 93701.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178353.5469; val_optim_loss: 178353.5469

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 18 sec.
Using best model state, which was in epoch 11.

--- MODEL EVALUATION ---
Val AUROC score: 0.8953
Val AUPRC score: 0.9774
Val best accuracy score: 0.9039
Val best F1 score: 0.9454
Val gene expr MSE score: 1.3048
Duration of model training in run 1: 0 hours, 0 minutes and 23 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 27455
Number of validation edges: 3050
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9332; val_auprc_score: 0.9874; val_best_acc_score: 0.9125; val_best_f1_score: 0.9500; train_kl_reg_loss: 72.4854; train_edge_recon_loss: 103280.9199; train_gene_expr_recon_loss: 127190.2383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 230543.6406; train_optim_loss: 230543.6406; val_kl_reg_loss: 180.0290; val_edge_recon_loss: 114965.6797; val_gene_expr_recon_loss: 109307.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224453.6719; val_optim_loss: 224453.6719
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9300; val_auprc_score: 0.9845; val_best_acc_score: 0.9057; val_best_f1_score: 0.9474; train_kl_reg_loss: 267.3677; train_edge_recon_loss: 101781.3555; train_gene_expr_recon_loss: 106037.4531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208086.1758; train_optim_loss: 208086.1758; val_kl_reg_loss: 300.1100; val_edge_recon_loss: 114646.0312; val_gene_expr_recon_loss: 99796.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214742.4844; val_optim_loss: 214742.4844
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9468; val_auprc_score: 0.9898; val_best_acc_score: 0.9233; val_best_f1_score: 0.9560; train_kl_reg_loss: 266.9905; train_edge_recon_loss: 100959.9629; train_gene_expr_recon_loss: 99552.6426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200779.5938; train_optim_loss: 200779.5938; val_kl_reg_loss: 187.5109; val_edge_recon_loss: 112728.1328; val_gene_expr_recon_loss: 96845.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209760.7188; val_optim_loss: 209760.7188
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9001; val_auprc_score: 0.9772; val_best_acc_score: 0.9098; val_best_f1_score: 0.9494; train_kl_reg_loss: 170.3384; train_edge_recon_loss: 102143.7227; train_gene_expr_recon_loss: 97510.7520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199824.8203; train_optim_loss: 199824.8203; val_kl_reg_loss: 140.0308; val_edge_recon_loss: 105413.9453; val_gene_expr_recon_loss: 95824.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201378.0000; val_optim_loss: 201378.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8712; val_auprc_score: 0.9721; val_best_acc_score: 0.9026; val_best_f1_score: 0.9449; train_kl_reg_loss: 150.0839; train_edge_recon_loss: 102353.1191; train_gene_expr_recon_loss: 96489.9297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198993.1289; train_optim_loss: 198993.1289; val_kl_reg_loss: 174.3459; val_edge_recon_loss: 99929.2266; val_gene_expr_recon_loss: 95241.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195344.8750; val_optim_loss: 195344.8750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8573; val_auprc_score: 0.9675; val_best_acc_score: 0.8880; val_best_f1_score: 0.9367; train_kl_reg_loss: 223.4079; train_edge_recon_loss: 100493.9199; train_gene_expr_recon_loss: 96158.2539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196875.5781; train_optim_loss: 196875.5781; val_kl_reg_loss: 311.2218; val_edge_recon_loss: 100402.4922; val_gene_expr_recon_loss: 94693.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195407.0625; val_optim_loss: 195407.0625
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8296; val_auprc_score: 0.9637; val_best_acc_score: 0.8930; val_best_f1_score: 0.9403; train_kl_reg_loss: 419.2235; train_edge_recon_loss: 95306.0566; train_gene_expr_recon_loss: 95322.3535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191047.6367; train_optim_loss: 191047.6367; val_kl_reg_loss: 615.5809; val_edge_recon_loss: 90100.4531; val_gene_expr_recon_loss: 94109.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184825.1094; val_optim_loss: 184825.1094
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8362; val_auprc_score: 0.9640; val_best_acc_score: 0.8946; val_best_f1_score: 0.9416; train_kl_reg_loss: 815.8022; train_edge_recon_loss: 92483.1230; train_gene_expr_recon_loss: 94907.8633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188206.7891; train_optim_loss: 188206.7891; val_kl_reg_loss: 1160.2402; val_edge_recon_loss: 86823.3438; val_gene_expr_recon_loss: 93604.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181588.3906; val_optim_loss: 181588.3906
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8580; val_auprc_score: 0.9681; val_best_acc_score: 0.8939; val_best_f1_score: 0.9402; train_kl_reg_loss: 1458.5944; train_edge_recon_loss: 89593.8281; train_gene_expr_recon_loss: 94506.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185558.6719; train_optim_loss: 185558.6719; val_kl_reg_loss: 1871.0300; val_edge_recon_loss: 84734.1641; val_gene_expr_recon_loss: 93231.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179837.0000; val_optim_loss: 179837.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8574; val_auprc_score: 0.9671; val_best_acc_score: 0.8971; val_best_f1_score: 0.9422; train_kl_reg_loss: 2150.3799; train_edge_recon_loss: 84724.6445; train_gene_expr_recon_loss: 93905.3730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180780.3984; train_optim_loss: 180780.3984; val_kl_reg_loss: 2382.9856; val_edge_recon_loss: 84099.0547; val_gene_expr_recon_loss: 92754.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179236.2812; val_optim_loss: 179236.2812
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8736; val_auprc_score: 0.9708; val_best_acc_score: 0.8979; val_best_f1_score: 0.9426; train_kl_reg_loss: 2614.4924; train_edge_recon_loss: 84753.6230; train_gene_expr_recon_loss: 93571.5508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180939.6641; train_optim_loss: 180939.6641; val_kl_reg_loss: 2719.7393; val_edge_recon_loss: 84353.1641; val_gene_expr_recon_loss: 92551.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179624.7812; val_optim_loss: 179624.7812
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8842; val_auprc_score: 0.9721; val_best_acc_score: 0.9013; val_best_f1_score: 0.9443; train_kl_reg_loss: 2817.5265; train_edge_recon_loss: 82547.4766; train_gene_expr_recon_loss: 93256.3535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178621.3594; train_optim_loss: 178621.3594; val_kl_reg_loss: 2722.4160; val_edge_recon_loss: 83209.8203; val_gene_expr_recon_loss: 92207.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178140.1562; val_optim_loss: 178140.1562
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8859; val_auprc_score: 0.9754; val_best_acc_score: 0.9070; val_best_f1_score: 0.9481; train_kl_reg_loss: 2777.6816; train_edge_recon_loss: 82534.3145; train_gene_expr_recon_loss: 92997.1816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178309.1797; train_optim_loss: 178309.1797; val_kl_reg_loss: 2630.5586; val_edge_recon_loss: 80285.0312; val_gene_expr_recon_loss: 91900.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174816.4688; val_optim_loss: 174816.4688
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9145; val_auprc_score: 0.9805; val_best_acc_score: 0.9059; val_best_f1_score: 0.9464; train_kl_reg_loss: 2672.2156; train_edge_recon_loss: 81511.0176; train_gene_expr_recon_loss: 92619.2871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176802.5156; train_optim_loss: 176802.5156; val_kl_reg_loss: 2499.7141; val_edge_recon_loss: 85320.2188; val_gene_expr_recon_loss: 91632.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179452.9062; val_optim_loss: 179452.9062
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9098; val_auprc_score: 0.9789; val_best_acc_score: 0.9123; val_best_f1_score: 0.9501; train_kl_reg_loss: 2517.5873; train_edge_recon_loss: 79897.3086; train_gene_expr_recon_loss: 92360.0703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174774.9727; train_optim_loss: 174774.9727; val_kl_reg_loss: 2378.0493; val_edge_recon_loss: 85101.4844; val_gene_expr_recon_loss: 91367.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178847.4844; val_optim_loss: 178847.4844
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9212; val_auprc_score: 0.9811; val_best_acc_score: 0.9182; val_best_f1_score: 0.9533; train_kl_reg_loss: 2412.2405; train_edge_recon_loss: 80789.4766; train_gene_expr_recon_loss: 91922.3984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175124.1172; train_optim_loss: 175124.1172; val_kl_reg_loss: 2271.7773; val_edge_recon_loss: 83773.5781; val_gene_expr_recon_loss: 91139.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177185.2188; val_optim_loss: 177185.2188

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9192; val_auprc_score: 0.9804; val_best_acc_score: 0.9172; val_best_f1_score: 0.9524; train_kl_reg_loss: 2337.0307; train_edge_recon_loss: 79418.0781; train_gene_expr_recon_loss: 92086.1523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173841.2578; train_optim_loss: 173841.2578; val_kl_reg_loss: 2260.7524; val_edge_recon_loss: 84934.9609; val_gene_expr_recon_loss: 91115.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178311.1875; val_optim_loss: 178311.1875
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9309; val_auprc_score: 0.9844; val_best_acc_score: 0.9244; val_best_f1_score: 0.9571; train_kl_reg_loss: 2334.1824; train_edge_recon_loss: 79801.2148; train_gene_expr_recon_loss: 92094.5566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174229.9570; train_optim_loss: 174229.9570; val_kl_reg_loss: 2258.4565; val_edge_recon_loss: 76479.1406; val_gene_expr_recon_loss: 91089.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169827.1562; val_optim_loss: 169827.1562
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9423; val_auprc_score: 0.9869; val_best_acc_score: 0.9294; val_best_f1_score: 0.9593; train_kl_reg_loss: 2315.7717; train_edge_recon_loss: 80505.5957; train_gene_expr_recon_loss: 91709.5977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174530.9609; train_optim_loss: 174530.9609; val_kl_reg_loss: 2256.0762; val_edge_recon_loss: 79588.6250; val_gene_expr_recon_loss: 91064.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172909.3438; val_optim_loss: 172909.3438
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9263; val_auprc_score: 0.9832; val_best_acc_score: 0.9175; val_best_f1_score: 0.9526; train_kl_reg_loss: 2316.3740; train_edge_recon_loss: 79956.5488; train_gene_expr_recon_loss: 91965.2891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174238.2109; train_optim_loss: 174238.2109; val_kl_reg_loss: 2243.3184; val_edge_recon_loss: 83849.4922; val_gene_expr_recon_loss: 91038.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177130.9062; val_optim_loss: 177130.9062
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9302; val_auprc_score: 0.9834; val_best_acc_score: 0.9232; val_best_f1_score: 0.9563; train_kl_reg_loss: 2302.2192; train_edge_recon_loss: 81056.8164; train_gene_expr_recon_loss: 91715.0820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175074.1133; train_optim_loss: 175074.1133; val_kl_reg_loss: 2238.4741; val_edge_recon_loss: 79443.1328; val_gene_expr_recon_loss: 91015.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172696.6562; val_optim_loss: 172696.6562

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9433; val_auprc_score: 0.9840; val_best_acc_score: 0.9283; val_best_f1_score: 0.9585; train_kl_reg_loss: 2302.0998; train_edge_recon_loss: 81574.4629; train_gene_expr_recon_loss: 91838.3086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175714.8711; train_optim_loss: 175714.8711; val_kl_reg_loss: 2233.3135; val_edge_recon_loss: 79458.6641; val_gene_expr_recon_loss: 91012.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172704.4219; val_optim_loss: 172704.4219
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9337; val_auprc_score: 0.9863; val_best_acc_score: 0.9204; val_best_f1_score: 0.9548; train_kl_reg_loss: 2301.7468; train_edge_recon_loss: 81918.8535; train_gene_expr_recon_loss: 91846.8711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176067.4688; train_optim_loss: 176067.4688; val_kl_reg_loss: 2234.7930; val_edge_recon_loss: 80243.4531; val_gene_expr_recon_loss: 91009.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173488.0312; val_optim_loss: 173488.0312
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9427; val_auprc_score: 0.9877; val_best_acc_score: 0.9295; val_best_f1_score: 0.9595; train_kl_reg_loss: 2302.1081; train_edge_recon_loss: 80518.0586; train_gene_expr_recon_loss: 91803.7148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174623.8828; train_optim_loss: 174623.8828; val_kl_reg_loss: 2233.6709; val_edge_recon_loss: 78822.7500; val_gene_expr_recon_loss: 91007.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172063.5000; val_optim_loss: 172063.5000

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 23 sec.
Using best model state, which was in epoch 18.

--- MODEL EVALUATION ---
Val AUROC score: 0.9243
Val AUPRC score: 0.9844
Val best accuracy score: 0.9222
Val best F1 score: 0.9560
Val gene expr MSE score: 1.1314
Duration of model training in run 2: 0 hours, 0 minutes and 24 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 53693
Number of validation edges: 5965
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9757; val_auprc_score: 0.9948; val_best_acc_score: 0.9489; val_best_f1_score: 0.9706; train_kl_reg_loss: 127.4489; train_edge_recon_loss: 102668.0904; train_gene_expr_recon_loss: 116364.3717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219159.9085; train_optim_loss: 219159.9085; val_kl_reg_loss: 257.5113; val_edge_recon_loss: 117657.7109; val_gene_expr_recon_loss: 100564.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218479.6719; val_optim_loss: 218479.6719
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9586; val_auprc_score: 0.9915; val_best_acc_score: 0.9333; val_best_f1_score: 0.9612; train_kl_reg_loss: 203.9065; train_edge_recon_loss: 102240.8571; train_gene_expr_recon_loss: 97416.0525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199860.8147; train_optim_loss: 199860.8147; val_kl_reg_loss: 132.6087; val_edge_recon_loss: 107981.6719; val_gene_expr_recon_loss: 95908.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204022.3906; val_optim_loss: 204022.3906
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9029; val_auprc_score: 0.9772; val_best_acc_score: 0.9091; val_best_f1_score: 0.9484; train_kl_reg_loss: 166.9551; train_edge_recon_loss: 99289.8705; train_gene_expr_recon_loss: 95141.8906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194598.7165; train_optim_loss: 194598.7165; val_kl_reg_loss: 281.5639; val_edge_recon_loss: 96944.1484; val_gene_expr_recon_loss: 94876.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192102.7031; val_optim_loss: 192102.7031
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8691; val_auprc_score: 0.9713; val_best_acc_score: 0.8982; val_best_f1_score: 0.9429; train_kl_reg_loss: 526.5908; train_edge_recon_loss: 95404.5100; train_gene_expr_recon_loss: 94118.7042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190049.8080; train_optim_loss: 190049.8080; val_kl_reg_loss: 987.0631; val_edge_recon_loss: 90388.9688; val_gene_expr_recon_loss: 93877.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185253.2188; val_optim_loss: 185253.2188
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8961; val_auprc_score: 0.9776; val_best_acc_score: 0.9061; val_best_f1_score: 0.9466; train_kl_reg_loss: 1539.0547; train_edge_recon_loss: 89975.8337; train_gene_expr_recon_loss: 93173.3516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184688.2388; train_optim_loss: 184688.2388; val_kl_reg_loss: 2223.2153; val_edge_recon_loss: 81421.1484; val_gene_expr_recon_loss: 92980.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176624.6562; val_optim_loss: 176624.6562
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9027; val_auprc_score: 0.9799; val_best_acc_score: 0.9081; val_best_f1_score: 0.9484; train_kl_reg_loss: 2597.7830; train_edge_recon_loss: 83351.8237; train_gene_expr_recon_loss: 92316.7779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178266.3817; train_optim_loss: 178266.3817; val_kl_reg_loss: 2854.3311; val_edge_recon_loss: 81415.7812; val_gene_expr_recon_loss: 92481.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176751.7188; val_optim_loss: 176751.7188
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9183; val_auprc_score: 0.9821; val_best_acc_score: 0.9128; val_best_f1_score: 0.9505; train_kl_reg_loss: 2854.4421; train_edge_recon_loss: 82617.0603; train_gene_expr_recon_loss: 91761.0971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177232.5982; train_optim_loss: 177232.5982; val_kl_reg_loss: 2693.7832; val_edge_recon_loss: 82387.7656; val_gene_expr_recon_loss: 91993.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177075.2188; val_optim_loss: 177075.2188
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9382; val_auprc_score: 0.9845; val_best_acc_score: 0.9295; val_best_f1_score: 0.9597; train_kl_reg_loss: 2570.0943; train_edge_recon_loss: 80519.6607; train_gene_expr_recon_loss: 91595.1763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174684.9353; train_optim_loss: 174684.9353; val_kl_reg_loss: 2344.1614; val_edge_recon_loss: 80368.7578; val_gene_expr_recon_loss: 91619.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174332.2812; val_optim_loss: 174332.2812
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9520; val_auprc_score: 0.9875; val_best_acc_score: 0.9381; val_best_f1_score: 0.9643; train_kl_reg_loss: 2257.1608; train_edge_recon_loss: 80106.1864; train_gene_expr_recon_loss: 91012.9676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173376.3147; train_optim_loss: 173376.3147; val_kl_reg_loss: 2159.3169; val_edge_recon_loss: 80800.3828; val_gene_expr_recon_loss: 91302.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174262.5625; val_optim_loss: 174262.5625
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9621; val_auprc_score: 0.9919; val_best_acc_score: 0.9478; val_best_f1_score: 0.9701; train_kl_reg_loss: 2193.1016; train_edge_recon_loss: 79595.7042; train_gene_expr_recon_loss: 90656.6339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172445.4420; train_optim_loss: 172445.4420; val_kl_reg_loss: 2172.1260; val_edge_recon_loss: 76491.3047; val_gene_expr_recon_loss: 91004.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169667.8125; val_optim_loss: 169667.8125
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9670; val_auprc_score: 0.9914; val_best_acc_score: 0.9545; val_best_f1_score: 0.9738; train_kl_reg_loss: 2223.4686; train_edge_recon_loss: 78256.7567; train_gene_expr_recon_loss: 90479.7913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170960.0179; train_optim_loss: 170960.0179; val_kl_reg_loss: 2179.8101; val_edge_recon_loss: 76074.0547; val_gene_expr_recon_loss: 90736.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168990.0625; val_optim_loss: 168990.0625
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9661; val_auprc_score: 0.9916; val_best_acc_score: 0.9555; val_best_f1_score: 0.9744; train_kl_reg_loss: 2179.0480; train_edge_recon_loss: 78291.6596; train_gene_expr_recon_loss: 90231.3047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170702.0112; train_optim_loss: 170702.0112; val_kl_reg_loss: 2103.7371; val_edge_recon_loss: 77665.6484; val_gene_expr_recon_loss: 90464.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170233.6562; val_optim_loss: 170233.6562
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9683; val_auprc_score: 0.9927; val_best_acc_score: 0.9568; val_best_f1_score: 0.9752; train_kl_reg_loss: 2112.7147; train_edge_recon_loss: 78682.1518; train_gene_expr_recon_loss: 89860.5011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170655.3683; train_optim_loss: 170655.3683; val_kl_reg_loss: 2053.5928; val_edge_recon_loss: 76106.3828; val_gene_expr_recon_loss: 90212.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168372.5156; val_optim_loss: 168372.5156
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9753; val_auprc_score: 0.9945; val_best_acc_score: 0.9593; val_best_f1_score: 0.9765; train_kl_reg_loss: 2093.9769; train_edge_recon_loss: 78062.6328; train_gene_expr_recon_loss: 89585.6395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169742.2500; train_optim_loss: 169742.2500; val_kl_reg_loss: 2078.8818; val_edge_recon_loss: 77455.4766; val_gene_expr_recon_loss: 89963.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169497.7188; val_optim_loss: 169497.7188
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9631; val_auprc_score: 0.9889; val_best_acc_score: 0.9604; val_best_f1_score: 0.9774; train_kl_reg_loss: 2108.1564; train_edge_recon_loss: 77752.0301; train_gene_expr_recon_loss: 89521.3527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169381.5379; train_optim_loss: 169381.5379; val_kl_reg_loss: 2041.5271; val_edge_recon_loss: 74453.3672; val_gene_expr_recon_loss: 89737.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166231.9219; val_optim_loss: 166231.9219
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9725; val_auprc_score: 0.9924; val_best_acc_score: 0.9595; val_best_f1_score: 0.9765; train_kl_reg_loss: 2036.8359; train_edge_recon_loss: 78013.7098; train_gene_expr_recon_loss: 89094.7087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169145.2522; train_optim_loss: 169145.2522; val_kl_reg_loss: 1996.8844; val_edge_recon_loss: 81387.6719; val_gene_expr_recon_loss: 89508.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172893.0625; val_optim_loss: 172893.0625
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9774; val_auprc_score: 0.9947; val_best_acc_score: 0.9642; val_best_f1_score: 0.9791; train_kl_reg_loss: 2042.3912; train_edge_recon_loss: 78734.8672; train_gene_expr_recon_loss: 89034.5993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169811.8594; train_optim_loss: 169811.8594; val_kl_reg_loss: 2026.4889; val_edge_recon_loss: 78127.5703; val_gene_expr_recon_loss: 89290.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169444.3750; val_optim_loss: 169444.3750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9774; val_auprc_score: 0.9952; val_best_acc_score: 0.9626; val_best_f1_score: 0.9784; train_kl_reg_loss: 2031.3821; train_edge_recon_loss: 78760.5379; train_gene_expr_recon_loss: 88656.7935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169448.7121; train_optim_loss: 169448.7121; val_kl_reg_loss: 1955.1200; val_edge_recon_loss: 77473.6406; val_gene_expr_recon_loss: 89109.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168538.6094; val_optim_loss: 168538.6094

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9747; val_auprc_score: 0.9936; val_best_acc_score: 0.9636; val_best_f1_score: 0.9788; train_kl_reg_loss: 1991.4737; train_edge_recon_loss: 78582.0904; train_gene_expr_recon_loss: 88740.6016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169314.1629; train_optim_loss: 169314.1629; val_kl_reg_loss: 1959.1853; val_edge_recon_loss: 78080.4688; val_gene_expr_recon_loss: 89073.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169113.4688; val_optim_loss: 169113.4688
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9739; val_auprc_score: 0.9940; val_best_acc_score: 0.9638; val_best_f1_score: 0.9788; train_kl_reg_loss: 1996.6422; train_edge_recon_loss: 77463.5268; train_gene_expr_recon_loss: 88682.3973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168142.5692; train_optim_loss: 168142.5692; val_kl_reg_loss: 1972.8823; val_edge_recon_loss: 80808.5859; val_gene_expr_recon_loss: 89049.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171830.8750; val_optim_loss: 171830.8750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9762; val_auprc_score: 0.9948; val_best_acc_score: 0.9642; val_best_f1_score: 0.9792; train_kl_reg_loss: 2008.7036; train_edge_recon_loss: 79070.2132; train_gene_expr_recon_loss: 88504.6674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169583.5848; train_optim_loss: 169583.5848; val_kl_reg_loss: 1982.1306; val_edge_recon_loss: 77422.2734; val_gene_expr_recon_loss: 89029.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168433.4062; val_optim_loss: 168433.4062

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 37 sec.
Using best model state, which was in epoch 15.

--- MODEL EVALUATION ---
Val AUROC score: 0.9768
Val AUPRC score: 0.9948
Val best accuracy score: 0.9604
Val best F1 score: 0.9771
Val gene expr MSE score: 1.0390
Duration of model training in run 3: 0 hours, 0 minutes and 39 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 53693
Number of validation edges: 5965
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9790; val_auprc_score: 0.9955; val_best_acc_score: 0.9490; val_best_f1_score: 0.9708; train_kl_reg_loss: 145.7290; train_edge_recon_loss: 101815.2746; train_gene_expr_recon_loss: 118197.3761; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220158.3795; train_optim_loss: 220158.3795; val_kl_reg_loss: 270.8277; val_edge_recon_loss: 115498.7578; val_gene_expr_recon_loss: 100449.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216219.5312; val_optim_loss: 216219.5312
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9705; val_auprc_score: 0.9940; val_best_acc_score: 0.9405; val_best_f1_score: 0.9658; train_kl_reg_loss: 211.9411; train_edge_recon_loss: 100643.7299; train_gene_expr_recon_loss: 98495.8337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199351.5045; train_optim_loss: 199351.5045; val_kl_reg_loss: 133.0712; val_edge_recon_loss: 109141.4141; val_gene_expr_recon_loss: 95258.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204533.1719; val_optim_loss: 204533.1719
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9266; val_auprc_score: 0.9845; val_best_acc_score: 0.9184; val_best_f1_score: 0.9536; train_kl_reg_loss: 146.1778; train_edge_recon_loss: 101536.3705; train_gene_expr_recon_loss: 95571.0045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197253.5491; train_optim_loss: 197253.5491; val_kl_reg_loss: 196.9488; val_edge_recon_loss: 99246.7812; val_gene_expr_recon_loss: 93876.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193320.4688; val_optim_loss: 193320.4688
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8810; val_auprc_score: 0.9744; val_best_acc_score: 0.8975; val_best_f1_score: 0.9418; train_kl_reg_loss: 349.6997; train_edge_recon_loss: 97791.2143; train_gene_expr_recon_loss: 94091.3516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192232.2612; train_optim_loss: 192232.2612; val_kl_reg_loss: 658.8784; val_edge_recon_loss: 95327.6562; val_gene_expr_recon_loss: 92751.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188737.7656; val_optim_loss: 188737.7656
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8804; val_auprc_score: 0.9723; val_best_acc_score: 0.8982; val_best_f1_score: 0.9422; train_kl_reg_loss: 1181.7752; train_edge_recon_loss: 91249.3973; train_gene_expr_recon_loss: 93249.1473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185680.3214; train_optim_loss: 185680.3214; val_kl_reg_loss: 1956.5393; val_edge_recon_loss: 89393.7188; val_gene_expr_recon_loss: 92022.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183372.3438; val_optim_loss: 183372.3438
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9012; val_auprc_score: 0.9767; val_best_acc_score: 0.9060; val_best_f1_score: 0.9468; train_kl_reg_loss: 2510.9736; train_edge_recon_loss: 84522.8382; train_gene_expr_recon_loss: 92662.8996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179696.7098; train_optim_loss: 179696.7098; val_kl_reg_loss: 2891.6240; val_edge_recon_loss: 83792.3906; val_gene_expr_recon_loss: 91463.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178147.1250; val_optim_loss: 178147.1250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9297; val_auprc_score: 0.9838; val_best_acc_score: 0.9215; val_best_f1_score: 0.9554; train_kl_reg_loss: 2917.4067; train_edge_recon_loss: 81641.1663; train_gene_expr_recon_loss: 91916.3917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176474.9643; train_optim_loss: 176474.9643; val_kl_reg_loss: 2725.9736; val_edge_recon_loss: 80796.6562; val_gene_expr_recon_loss: 90965.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174487.9688; val_optim_loss: 174487.9688
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9386; val_auprc_score: 0.9844; val_best_acc_score: 0.9286; val_best_f1_score: 0.9589; train_kl_reg_loss: 2645.6064; train_edge_recon_loss: 79402.1384; train_gene_expr_recon_loss: 91473.8371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173521.5759; train_optim_loss: 173521.5759; val_kl_reg_loss: 2397.5898; val_edge_recon_loss: 82615.1250; val_gene_expr_recon_loss: 90546.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175559.2500; val_optim_loss: 175559.2500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9458; val_auprc_score: 0.9873; val_best_acc_score: 0.9353; val_best_f1_score: 0.9629; train_kl_reg_loss: 2332.1321; train_edge_recon_loss: 79126.4978; train_gene_expr_recon_loss: 91132.7656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172591.3973; train_optim_loss: 172591.3973; val_kl_reg_loss: 2179.5986; val_edge_recon_loss: 82605.0469; val_gene_expr_recon_loss: 90179.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174964.2500; val_optim_loss: 174964.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9586; val_auprc_score: 0.9903; val_best_acc_score: 0.9460; val_best_f1_score: 0.9687; train_kl_reg_loss: 2182.8186; train_edge_recon_loss: 79567.4978; train_gene_expr_recon_loss: 90617.1484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172367.4665; train_optim_loss: 172367.4665; val_kl_reg_loss: 2114.2114; val_edge_recon_loss: 83454.6797; val_gene_expr_recon_loss: 89829.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175398.6562; val_optim_loss: 175398.6562

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9596; val_auprc_score: 0.9910; val_best_acc_score: 0.9440; val_best_f1_score: 0.9677; train_kl_reg_loss: 2149.1960; train_edge_recon_loss: 78730.6875; train_gene_expr_recon_loss: 90580.5525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171460.4375; train_optim_loss: 171460.4375; val_kl_reg_loss: 2107.5005; val_edge_recon_loss: 80287.8828; val_gene_expr_recon_loss: 89788.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172183.4375; val_optim_loss: 172183.4375
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9587; val_auprc_score: 0.9895; val_best_acc_score: 0.9471; val_best_f1_score: 0.9696; train_kl_reg_loss: 2151.3556; train_edge_recon_loss: 79946.2779; train_gene_expr_recon_loss: 90594.9810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172692.6161; train_optim_loss: 172692.6161; val_kl_reg_loss: 2112.0620; val_edge_recon_loss: 78348.5234; val_gene_expr_recon_loss: 89758.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170218.9219; val_optim_loss: 170218.9219
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9624; val_auprc_score: 0.9918; val_best_acc_score: 0.9523; val_best_f1_score: 0.9726; train_kl_reg_loss: 2152.7822; train_edge_recon_loss: 79504.8025; train_gene_expr_recon_loss: 90614.6004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172272.1853; train_optim_loss: 172272.1853; val_kl_reg_loss: 2111.4114; val_edge_recon_loss: 75749.3047; val_gene_expr_recon_loss: 89719.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167580.5625; val_optim_loss: 167580.5625
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9612; val_auprc_score: 0.9893; val_best_acc_score: 0.9520; val_best_f1_score: 0.9720; train_kl_reg_loss: 2160.9202; train_edge_recon_loss: 78206.1518; train_gene_expr_recon_loss: 90669.8895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171036.9643; train_optim_loss: 171036.9643; val_kl_reg_loss: 2121.9292; val_edge_recon_loss: 77753.4062; val_gene_expr_recon_loss: 89685.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169561.0938; val_optim_loss: 169561.0938
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9627; val_auprc_score: 0.9899; val_best_acc_score: 0.9509; val_best_f1_score: 0.9717; train_kl_reg_loss: 2158.7063; train_edge_recon_loss: 78705.7355; train_gene_expr_recon_loss: 90521.2757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171385.7143; train_optim_loss: 171385.7143; val_kl_reg_loss: 2122.4741; val_edge_recon_loss: 78938.3359; val_gene_expr_recon_loss: 89657.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170718.5625; val_optim_loss: 170718.5625
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9614; val_auprc_score: 0.9900; val_best_acc_score: 0.9510; val_best_f1_score: 0.9719; train_kl_reg_loss: 2161.7199; train_edge_recon_loss: 78422.5112; train_gene_expr_recon_loss: 90364.8058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170949.0335; train_optim_loss: 170949.0335; val_kl_reg_loss: 2126.9312; val_edge_recon_loss: 77506.1484; val_gene_expr_recon_loss: 89625.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169258.3438; val_optim_loss: 169258.3438

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9582; val_auprc_score: 0.9884; val_best_acc_score: 0.9507; val_best_f1_score: 0.9716; train_kl_reg_loss: 2161.7608; train_edge_recon_loss: 79316.6060; train_gene_expr_recon_loss: 90254.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171733.1696; train_optim_loss: 171733.1696; val_kl_reg_loss: 2124.1082; val_edge_recon_loss: 75532.5469; val_gene_expr_recon_loss: 89621.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167278.3438; val_optim_loss: 167278.3438
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9623; val_auprc_score: 0.9916; val_best_acc_score: 0.9517; val_best_f1_score: 0.9723; train_kl_reg_loss: 2163.3366; train_edge_recon_loss: 78113.0335; train_gene_expr_recon_loss: 90300.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170576.4665; train_optim_loss: 170576.4665; val_kl_reg_loss: 2119.6646; val_edge_recon_loss: 75210.7109; val_gene_expr_recon_loss: 89618.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166948.6875; val_optim_loss: 166948.6875
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9562; val_auprc_score: 0.9890; val_best_acc_score: 0.9488; val_best_f1_score: 0.9704; train_kl_reg_loss: 2162.1418; train_edge_recon_loss: 79028.8583; train_gene_expr_recon_loss: 90568.4632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171759.4621; train_optim_loss: 171759.4621; val_kl_reg_loss: 2123.0444; val_edge_recon_loss: 79547.4609; val_gene_expr_recon_loss: 89615.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171285.5781; val_optim_loss: 171285.5781
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9580; val_auprc_score: 0.9911; val_best_acc_score: 0.9489; val_best_f1_score: 0.9707; train_kl_reg_loss: 2162.6199; train_edge_recon_loss: 78270.4051; train_gene_expr_recon_loss: 90250.6752; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170683.6987; train_optim_loss: 170683.6987; val_kl_reg_loss: 2120.0923; val_edge_recon_loss: 77160.3359; val_gene_expr_recon_loss: 89611.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168892.2812; val_optim_loss: 168892.2812
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9582; val_auprc_score: 0.9903; val_best_acc_score: 0.9499; val_best_f1_score: 0.9712; train_kl_reg_loss: 2163.1290; train_edge_recon_loss: 78262.7210; train_gene_expr_recon_loss: 90459.8214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170885.6719; train_optim_loss: 170885.6719; val_kl_reg_loss: 2121.0005; val_edge_recon_loss: 78303.2812; val_gene_expr_recon_loss: 89608.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170032.7812; val_optim_loss: 170032.7812

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9632; val_auprc_score: 0.9915; val_best_acc_score: 0.9537; val_best_f1_score: 0.9733; train_kl_reg_loss: 2161.6925; train_edge_recon_loss: 79349.6116; train_gene_expr_recon_loss: 90303.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171814.7634; train_optim_loss: 171814.7634; val_kl_reg_loss: 2120.0029; val_edge_recon_loss: 78374.5938; val_gene_expr_recon_loss: 89608.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170102.7188; val_optim_loss: 170102.7188
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9530; val_auprc_score: 0.9890; val_best_acc_score: 0.9456; val_best_f1_score: 0.9688; train_kl_reg_loss: 2161.0512; train_edge_recon_loss: 78197.1183; train_gene_expr_recon_loss: 90428.6775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170786.8482; train_optim_loss: 170786.8482; val_kl_reg_loss: 2117.5354; val_edge_recon_loss: 78771.6719; val_gene_expr_recon_loss: 89607.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170496.9375; val_optim_loss: 170496.9375
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9660; val_auprc_score: 0.9919; val_best_acc_score: 0.9522; val_best_f1_score: 0.9722; train_kl_reg_loss: 2161.9824; train_edge_recon_loss: 78323.4888; train_gene_expr_recon_loss: 90404.0435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170889.5134; train_optim_loss: 170889.5134; val_kl_reg_loss: 2119.4336; val_edge_recon_loss: 80285.6172; val_gene_expr_recon_loss: 89607.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172012.4062; val_optim_loss: 172012.4062

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 42 sec.
Using best model state, which was in epoch 18.

--- MODEL EVALUATION ---
Val AUROC score: 0.9684
Val AUPRC score: 0.9913
Val best accuracy score: 0.9510
Val best F1 score: 0.9719
Val gene expr MSE score: 1.1080
Duration of model training in run 4: 0 hours, 0 minutes and 44 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 80320
Number of validation edges: 8924
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9770; val_auprc_score: 0.9933; val_best_acc_score: 0.9548; val_best_f1_score: 0.9738; train_kl_reg_loss: 162.3478; train_edge_recon_loss: 102746.7016; train_gene_expr_recon_loss: 111799.5242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214708.5750; train_optim_loss: 214708.5750; val_kl_reg_loss: 225.7073; val_edge_recon_loss: 118708.1328; val_gene_expr_recon_loss: 95563.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214496.8594; val_optim_loss: 214496.8594
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9213; val_auprc_score: 0.9829; val_best_acc_score: 0.9127; val_best_f1_score: 0.9502; train_kl_reg_loss: 170.7796; train_edge_recon_loss: 101468.2312; train_gene_expr_recon_loss: 94112.2695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195751.2797; train_optim_loss: 195751.2797; val_kl_reg_loss: 174.6525; val_edge_recon_loss: 110010.5117; val_gene_expr_recon_loss: 92996.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 203181.3984; val_optim_loss: 203181.3984
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8727; val_auprc_score: 0.9706; val_best_acc_score: 0.8952; val_best_f1_score: 0.9412; train_kl_reg_loss: 417.2519; train_edge_recon_loss: 97268.7469; train_gene_expr_recon_loss: 92560.6227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190246.6234; train_optim_loss: 190246.6234; val_kl_reg_loss: 915.1157; val_edge_recon_loss: 92938.0781; val_gene_expr_recon_loss: 91748.1602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185601.3594; val_optim_loss: 185601.3594
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9136; val_auprc_score: 0.9822; val_best_acc_score: 0.9078; val_best_f1_score: 0.9478; train_kl_reg_loss: 1608.5297; train_edge_recon_loss: 88270.5883; train_gene_expr_recon_loss: 91328.2977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181207.4172; train_optim_loss: 181207.4172; val_kl_reg_loss: 2428.3430; val_edge_recon_loss: 83184.4805; val_gene_expr_recon_loss: 90801.5273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176414.3516; val_optim_loss: 176414.3516
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9395; val_auprc_score: 0.9856; val_best_acc_score: 0.9246; val_best_f1_score: 0.9567; train_kl_reg_loss: 2666.6236; train_edge_recon_loss: 82808.7102; train_gene_expr_recon_loss: 90547.0547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176022.3891; train_optim_loss: 176022.3891; val_kl_reg_loss: 2706.8423; val_edge_recon_loss: 81100.3047; val_gene_expr_recon_loss: 90122.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173929.4922; val_optim_loss: 173929.4922
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9608; val_auprc_score: 0.9912; val_best_acc_score: 0.9482; val_best_f1_score: 0.9702; train_kl_reg_loss: 2558.5855; train_edge_recon_loss: 80928.6812; train_gene_expr_recon_loss: 90070.4461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173557.7125; train_optim_loss: 173557.7125; val_kl_reg_loss: 2312.9897; val_edge_recon_loss: 74604.2695; val_gene_expr_recon_loss: 89615.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166532.5234; val_optim_loss: 166532.5234
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9648; val_auprc_score: 0.9925; val_best_acc_score: 0.9561; val_best_f1_score: 0.9748; train_kl_reg_loss: 2178.3516; train_edge_recon_loss: 79087.1797; train_gene_expr_recon_loss: 89510.3828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170775.9125; train_optim_loss: 170775.9125; val_kl_reg_loss: 2072.0198; val_edge_recon_loss: 75598.6680; val_gene_expr_recon_loss: 89251.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166922.0469; val_optim_loss: 166922.0469
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9676; val_auprc_score: 0.9921; val_best_acc_score: 0.9596; val_best_f1_score: 0.9765; train_kl_reg_loss: 2174.0619; train_edge_recon_loss: 78691.0883; train_gene_expr_recon_loss: 89187.9320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170053.0844; train_optim_loss: 170053.0844; val_kl_reg_loss: 2223.3896; val_edge_recon_loss: 82797.8750; val_gene_expr_recon_loss: 88851.5664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173872.8281; val_optim_loss: 173872.8281
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9728; val_auprc_score: 0.9930; val_best_acc_score: 0.9633; val_best_f1_score: 0.9787; train_kl_reg_loss: 2172.3293; train_edge_recon_loss: 77945.8727; train_gene_expr_recon_loss: 88848.7234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168966.9234; train_optim_loss: 168966.9234; val_kl_reg_loss: 2016.5299; val_edge_recon_loss: 76286.7656; val_gene_expr_recon_loss: 88537.6523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166840.9531; val_optim_loss: 166840.9531

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9690; val_auprc_score: 0.9924; val_best_acc_score: 0.9620; val_best_f1_score: 0.9780; train_kl_reg_loss: 2050.0161; train_edge_recon_loss: 78467.9625; train_gene_expr_recon_loss: 88659.2422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169177.2172; train_optim_loss: 169177.2172; val_kl_reg_loss: 2016.9102; val_edge_recon_loss: 81666.2227; val_gene_expr_recon_loss: 88507.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172190.3281; val_optim_loss: 172190.3281
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9724; val_auprc_score: 0.9933; val_best_acc_score: 0.9620; val_best_f1_score: 0.9780; train_kl_reg_loss: 2053.7826; train_edge_recon_loss: 78226.3172; train_gene_expr_recon_loss: 88612.0898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168892.1875; train_optim_loss: 168892.1875; val_kl_reg_loss: 2025.2182; val_edge_recon_loss: 75740.8242; val_gene_expr_recon_loss: 88466.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166232.8359; val_optim_loss: 166232.8359
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9714; val_auprc_score: 0.9937; val_best_acc_score: 0.9628; val_best_f1_score: 0.9786; train_kl_reg_loss: 2066.3495; train_edge_recon_loss: 78703.7258; train_gene_expr_recon_loss: 88724.7664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169494.8406; train_optim_loss: 169494.8406; val_kl_reg_loss: 2048.0162; val_edge_recon_loss: 74269.7812; val_gene_expr_recon_loss: 88436.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164754.7188; val_optim_loss: 164754.7188
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9770; val_auprc_score: 0.9938; val_best_acc_score: 0.9642; val_best_f1_score: 0.9790; train_kl_reg_loss: 2075.5001; train_edge_recon_loss: 78419.2758; train_gene_expr_recon_loss: 88498.9438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168993.7219; train_optim_loss: 168993.7219; val_kl_reg_loss: 2048.7003; val_edge_recon_loss: 79679.9023; val_gene_expr_recon_loss: 88401.8242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170130.4219; val_optim_loss: 170130.4219
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9723; val_auprc_score: 0.9934; val_best_acc_score: 0.9649; val_best_f1_score: 0.9797; train_kl_reg_loss: 2077.1341; train_edge_recon_loss: 79417.7422; train_gene_expr_recon_loss: 88556.5984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170051.4781; train_optim_loss: 170051.4781; val_kl_reg_loss: 2048.1541; val_edge_recon_loss: 73723.1719; val_gene_expr_recon_loss: 88373.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164145.0625; val_optim_loss: 164145.0625
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9737; val_auprc_score: 0.9938; val_best_acc_score: 0.9608; val_best_f1_score: 0.9772; train_kl_reg_loss: 2079.8043; train_edge_recon_loss: 78671.3164; train_gene_expr_recon_loss: 88599.9039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169351.0219; train_optim_loss: 169351.0219; val_kl_reg_loss: 2044.2435; val_edge_recon_loss: 77639.8242; val_gene_expr_recon_loss: 88340.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168024.5938; val_optim_loss: 168024.5938
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9750; val_auprc_score: 0.9918; val_best_acc_score: 0.9647; val_best_f1_score: 0.9794; train_kl_reg_loss: 2069.5641; train_edge_recon_loss: 78590.9688; train_gene_expr_recon_loss: 88554.1086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169214.6391; train_optim_loss: 169214.6391; val_kl_reg_loss: 2032.1526; val_edge_recon_loss: 77095.6172; val_gene_expr_recon_loss: 88311.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167439.3594; val_optim_loss: 167439.3594
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9746; val_auprc_score: 0.9933; val_best_acc_score: 0.9648; val_best_f1_score: 0.9794; train_kl_reg_loss: 2062.2723; train_edge_recon_loss: 78128.9203; train_gene_expr_recon_loss: 88378.5781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168569.7703; train_optim_loss: 168569.7703; val_kl_reg_loss: 2029.2543; val_edge_recon_loss: 82523.0156; val_gene_expr_recon_loss: 88280.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172833.2422; val_optim_loss: 172833.2422

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9769; val_auprc_score: 0.9945; val_best_acc_score: 0.9641; val_best_f1_score: 0.9792; train_kl_reg_loss: 2058.8763; train_edge_recon_loss: 78021.0281; train_gene_expr_recon_loss: 88288.0875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168367.9891; train_optim_loss: 168367.9891; val_kl_reg_loss: 2024.5071; val_edge_recon_loss: 80802.1797; val_gene_expr_recon_loss: 88277.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171103.9375; val_optim_loss: 171103.9375
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9775; val_auprc_score: 0.9941; val_best_acc_score: 0.9638; val_best_f1_score: 0.9790; train_kl_reg_loss: 2060.0163; train_edge_recon_loss: 77987.3102; train_gene_expr_recon_loss: 88309.3219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168356.6484; train_optim_loss: 168356.6484; val_kl_reg_loss: 2034.2569; val_edge_recon_loss: 75227.2109; val_gene_expr_recon_loss: 88273.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165535.1172; val_optim_loss: 165535.1172
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9779; val_auprc_score: 0.9952; val_best_acc_score: 0.9630; val_best_f1_score: 0.9785; train_kl_reg_loss: 2057.7266; train_edge_recon_loss: 78591.5234; train_gene_expr_recon_loss: 88301.5336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168950.7859; train_optim_loss: 168950.7859; val_kl_reg_loss: 2028.0642; val_edge_recon_loss: 76164.3242; val_gene_expr_recon_loss: 88270.3633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166462.7500; val_optim_loss: 166462.7500

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 54 sec.
Using best model state, which was in epoch 14.

--- MODEL EVALUATION ---
Val AUROC score: 0.9752
Val AUPRC score: 0.9934
Val best accuracy score: 0.9657
Val best F1 score: 0.9801
Val gene expr MSE score: 1.0483
Duration of model training in run 5: 0 hours, 0 minutes and 56 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 80320
Number of validation edges: 8924
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9800; val_auprc_score: 0.9949; val_best_acc_score: 0.9569; val_best_f1_score: 0.9752; train_kl_reg_loss: 170.2546; train_edge_recon_loss: 102183.7953; train_gene_expr_recon_loss: 111004.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213358.3953; train_optim_loss: 213358.3953; val_kl_reg_loss: 232.4819; val_edge_recon_loss: 116028.1289; val_gene_expr_recon_loss: 97327.9883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213588.5938; val_optim_loss: 213588.5938
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9332; val_auprc_score: 0.9853; val_best_acc_score: 0.9233; val_best_f1_score: 0.9558; train_kl_reg_loss: 168.7217; train_edge_recon_loss: 101713.1758; train_gene_expr_recon_loss: 94714.4320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196596.3297; train_optim_loss: 196596.3297; val_kl_reg_loss: 162.1884; val_edge_recon_loss: 106072.3477; val_gene_expr_recon_loss: 94521.3242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200755.8594; val_optim_loss: 200755.8594
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8921; val_auprc_score: 0.9768; val_best_acc_score: 0.8978; val_best_f1_score: 0.9422; train_kl_reg_loss: 383.3523; train_edge_recon_loss: 96312.9148; train_gene_expr_recon_loss: 92872.4906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189568.7563; train_optim_loss: 189568.7563; val_kl_reg_loss: 828.1780; val_edge_recon_loss: 86025.2695; val_gene_expr_recon_loss: 93270.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180123.9688; val_optim_loss: 180123.9688
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9029; val_auprc_score: 0.9781; val_best_acc_score: 0.9080; val_best_f1_score: 0.9480; train_kl_reg_loss: 1605.9890; train_edge_recon_loss: 87846.2750; train_gene_expr_recon_loss: 91541.0055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180993.2687; train_optim_loss: 180993.2687; val_kl_reg_loss: 2555.0469; val_edge_recon_loss: 82672.2656; val_gene_expr_recon_loss: 92443.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177671.1719; val_optim_loss: 177671.1719
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9229; val_auprc_score: 0.9819; val_best_acc_score: 0.9150; val_best_f1_score: 0.9516; train_kl_reg_loss: 2907.5513; train_edge_recon_loss: 81580.5805; train_gene_expr_recon_loss: 90914.0172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175402.1500; train_optim_loss: 175402.1500; val_kl_reg_loss: 2819.9547; val_edge_recon_loss: 81784.0078; val_gene_expr_recon_loss: 91811.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176415.2500; val_optim_loss: 176415.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9541; val_auprc_score: 0.9904; val_best_acc_score: 0.9409; val_best_f1_score: 0.9658; train_kl_reg_loss: 2605.2771; train_edge_recon_loss: 80326.9266; train_gene_expr_recon_loss: 90389.2219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173321.4297; train_optim_loss: 173321.4297; val_kl_reg_loss: 2286.5200; val_edge_recon_loss: 78588.8711; val_gene_expr_recon_loss: 91320.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172195.7266; val_optim_loss: 172195.7266
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9671; val_auprc_score: 0.9923; val_best_acc_score: 0.9525; val_best_f1_score: 0.9725; train_kl_reg_loss: 2269.6137; train_edge_recon_loss: 78234.5188; train_gene_expr_recon_loss: 89993.5719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170497.7031; train_optim_loss: 170497.7031; val_kl_reg_loss: 2217.9607; val_edge_recon_loss: 78610.5586; val_gene_expr_recon_loss: 90905.3398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171733.8594; val_optim_loss: 171733.8594
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9666; val_auprc_score: 0.9918; val_best_acc_score: 0.9586; val_best_f1_score: 0.9761; train_kl_reg_loss: 2195.0461; train_edge_recon_loss: 77906.6133; train_gene_expr_recon_loss: 89619.3070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169720.9656; train_optim_loss: 169720.9656; val_kl_reg_loss: 2082.7644; val_edge_recon_loss: 82882.9883; val_gene_expr_recon_loss: 90508.1523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175473.8984; val_optim_loss: 175473.8984
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9738; val_auprc_score: 0.9933; val_best_acc_score: 0.9644; val_best_f1_score: 0.9795; train_kl_reg_loss: 2068.6916; train_edge_recon_loss: 78167.7961; train_gene_expr_recon_loss: 89071.7000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169308.1875; train_optim_loss: 169308.1875; val_kl_reg_loss: 2029.1995; val_edge_recon_loss: 72430.3086; val_gene_expr_recon_loss: 90143.3867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164602.8906; val_optim_loss: 164602.8906
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9739; val_auprc_score: 0.9941; val_best_acc_score: 0.9650; val_best_f1_score: 0.9798; train_kl_reg_loss: 2050.8795; train_edge_recon_loss: 78370.8875; train_gene_expr_recon_loss: 88724.5492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169146.3141; train_optim_loss: 169146.3141; val_kl_reg_loss: 2024.6814; val_edge_recon_loss: 78277.9688; val_gene_expr_recon_loss: 89803.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170105.9219; val_optim_loss: 170105.9219
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9798; val_auprc_score: 0.9943; val_best_acc_score: 0.9694; val_best_f1_score: 0.9821; train_kl_reg_loss: 2036.9519; train_edge_recon_loss: 77684.5203; train_gene_expr_recon_loss: 88533.7742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168255.2453; train_optim_loss: 168255.2453; val_kl_reg_loss: 1985.7324; val_edge_recon_loss: 77069.1914; val_gene_expr_recon_loss: 89480.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168535.7500; val_optim_loss: 168535.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9773; val_auprc_score: 0.9945; val_best_acc_score: 0.9667; val_best_f1_score: 0.9806; train_kl_reg_loss: 2006.2928; train_edge_recon_loss: 78523.5898; train_gene_expr_recon_loss: 88173.4805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168703.3641; train_optim_loss: 168703.3641; val_kl_reg_loss: 1978.0020; val_edge_recon_loss: 78343.7695; val_gene_expr_recon_loss: 89183.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169505.0391; val_optim_loss: 169505.0391

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9824; val_auprc_score: 0.9962; val_best_acc_score: 0.9689; val_best_f1_score: 0.9819; train_kl_reg_loss: 2002.8794; train_edge_recon_loss: 77138.4383; train_gene_expr_recon_loss: 87854.3227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166995.6437; train_optim_loss: 166995.6437; val_kl_reg_loss: 1973.7595; val_edge_recon_loss: 78935.9922; val_gene_expr_recon_loss: 89148.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170058.1250; val_optim_loss: 170058.1250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9791; val_auprc_score: 0.9939; val_best_acc_score: 0.9678; val_best_f1_score: 0.9812; train_kl_reg_loss: 2000.4281; train_edge_recon_loss: 77730.1750; train_gene_expr_recon_loss: 87952.6797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167683.2828; train_optim_loss: 167683.2828; val_kl_reg_loss: 1961.8809; val_edge_recon_loss: 75101.1875; val_gene_expr_recon_loss: 89113.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166176.6953; val_optim_loss: 166176.6953
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9766; val_auprc_score: 0.9939; val_best_acc_score: 0.9693; val_best_f1_score: 0.9821; train_kl_reg_loss: 1983.9751; train_edge_recon_loss: 78184.8813; train_gene_expr_recon_loss: 88001.2680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168170.1234; train_optim_loss: 168170.1234; val_kl_reg_loss: 1960.0646; val_edge_recon_loss: 77405.1406; val_gene_expr_recon_loss: 89084.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168449.4844; val_optim_loss: 168449.4844

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 40 sec.
Using best model state, which was in epoch 9.

--- MODEL EVALUATION ---
Val AUROC score: 0.9748
Val AUPRC score: 0.9933
Val best accuracy score: 0.9645
Val best F1 score: 0.9793
Val gene expr MSE score: 1.0748
Duration of model training in run 6: 0 hours, 0 minutes and 42 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 106920
Number of validation edges: 11879
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9716; val_auprc_score: 0.9933; val_best_acc_score: 0.9438; val_best_f1_score: 0.9672; train_kl_reg_loss: 214.7292; train_edge_recon_loss: 101516.1462; train_gene_expr_recon_loss: 108242.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209973.4710; train_optim_loss: 209973.4710; val_kl_reg_loss: 209.5645; val_edge_recon_loss: 110775.2266; val_gene_expr_recon_loss: 96235.1914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207219.9844; val_optim_loss: 207219.9844
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8931; val_auprc_score: 0.9755; val_best_acc_score: 0.8978; val_best_f1_score: 0.9420; train_kl_reg_loss: 212.0642; train_edge_recon_loss: 100507.5033; train_gene_expr_recon_loss: 93697.1892; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194416.7545; train_optim_loss: 194416.7545; val_kl_reg_loss: 384.4401; val_edge_recon_loss: 99783.9219; val_gene_expr_recon_loss: 92950.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193118.4688; val_optim_loss: 193118.4688
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8851; val_auprc_score: 0.9753; val_best_acc_score: 0.9014; val_best_f1_score: 0.9448; train_kl_reg_loss: 1042.3306; train_edge_recon_loss: 91120.0965; train_gene_expr_recon_loss: 91682.4163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183844.8426; train_optim_loss: 183844.8426; val_kl_reg_loss: 2259.2385; val_edge_recon_loss: 84767.4961; val_gene_expr_recon_loss: 92873.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179900.4609; val_optim_loss: 179900.4609
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9159; val_auprc_score: 0.9813; val_best_acc_score: 0.9081; val_best_f1_score: 0.9475; train_kl_reg_loss: 2679.2352; train_edge_recon_loss: 82699.5653; train_gene_expr_recon_loss: 90850.9548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176229.7556; train_optim_loss: 176229.7556; val_kl_reg_loss: 2712.6064; val_edge_recon_loss: 85129.6875; val_gene_expr_recon_loss: 91258.6680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179100.9688; val_optim_loss: 179100.9688
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9507; val_auprc_score: 0.9893; val_best_acc_score: 0.9426; val_best_f1_score: 0.9671; train_kl_reg_loss: 2422.0452; train_edge_recon_loss: 80508.7171; train_gene_expr_recon_loss: 90020.6306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172951.3929; train_optim_loss: 172951.3929; val_kl_reg_loss: 2163.1787; val_edge_recon_loss: 79442.2383; val_gene_expr_recon_loss: 89919.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171524.5234; val_optim_loss: 171524.5234
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9622; val_auprc_score: 0.9898; val_best_acc_score: 0.9519; val_best_f1_score: 0.9721; train_kl_reg_loss: 2133.3712; train_edge_recon_loss: 79635.2020; train_gene_expr_recon_loss: 89498.5636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171267.1350; train_optim_loss: 171267.1350; val_kl_reg_loss: 2114.1229; val_edge_recon_loss: 78632.6289; val_gene_expr_recon_loss: 90660.8242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171407.5781; val_optim_loss: 171407.5781
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9712; val_auprc_score: 0.9931; val_best_acc_score: 0.9610; val_best_f1_score: 0.9773; train_kl_reg_loss: 2082.1075; train_edge_recon_loss: 77889.0324; train_gene_expr_recon_loss: 88879.8739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168851.0145; train_optim_loss: 168851.0145; val_kl_reg_loss: 2018.1517; val_edge_recon_loss: 77905.0547; val_gene_expr_recon_loss: 89616.0508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169539.2578; val_optim_loss: 169539.2578
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9690; val_auprc_score: 0.9915; val_best_acc_score: 0.9613; val_best_f1_score: 0.9776; train_kl_reg_loss: 2011.1281; train_edge_recon_loss: 78239.9470; train_gene_expr_recon_loss: 88506.0413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168757.1194; train_optim_loss: 168757.1194; val_kl_reg_loss: 1984.9309; val_edge_recon_loss: 77521.2227; val_gene_expr_recon_loss: 88658.3477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168164.5078; val_optim_loss: 168164.5078
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9715; val_auprc_score: 0.9929; val_best_acc_score: 0.9620; val_best_f1_score: 0.9778; train_kl_reg_loss: 1990.7822; train_edge_recon_loss: 77760.5742; train_gene_expr_recon_loss: 88125.6780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167877.0357; train_optim_loss: 167877.0357; val_kl_reg_loss: 1959.9031; val_edge_recon_loss: 81232.1680; val_gene_expr_recon_loss: 87585.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170777.6016; val_optim_loss: 170777.6016
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9761; val_auprc_score: 0.9931; val_best_acc_score: 0.9634; val_best_f1_score: 0.9788; train_kl_reg_loss: 2002.3646; train_edge_recon_loss: 78315.8276; train_gene_expr_recon_loss: 87899.6998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168217.8917; train_optim_loss: 168217.8917; val_kl_reg_loss: 1944.5149; val_edge_recon_loss: 78003.8008; val_gene_expr_recon_loss: 88557.8789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168506.1875; val_optim_loss: 168506.1875
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9734; val_auprc_score: 0.9933; val_best_acc_score: 0.9676; val_best_f1_score: 0.9812; train_kl_reg_loss: 1956.4971; train_edge_recon_loss: 79203.2411; train_gene_expr_recon_loss: 87410.9676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168570.7076; train_optim_loss: 168570.7076; val_kl_reg_loss: 1929.4280; val_edge_recon_loss: 74659.3672; val_gene_expr_recon_loss: 87997.1289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164585.9219; val_optim_loss: 164585.9219
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9767; val_auprc_score: 0.9938; val_best_acc_score: 0.9698; val_best_f1_score: 0.9825; train_kl_reg_loss: 1959.7643; train_edge_recon_loss: 77705.5324; train_gene_expr_recon_loss: 87258.9972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166924.2913; train_optim_loss: 166924.2913; val_kl_reg_loss: 1932.5782; val_edge_recon_loss: 75974.0234; val_gene_expr_recon_loss: 88252.9023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166159.5000; val_optim_loss: 166159.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9760; val_auprc_score: 0.9943; val_best_acc_score: 0.9693; val_best_f1_score: 0.9822; train_kl_reg_loss: 1944.9382; train_edge_recon_loss: 77350.5446; train_gene_expr_recon_loss: 86975.5446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166271.0257; train_optim_loss: 166271.0257; val_kl_reg_loss: 1923.7500; val_edge_recon_loss: 77897.9648; val_gene_expr_recon_loss: 87397.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167218.8281; val_optim_loss: 167218.8281
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9788; val_auprc_score: 0.9949; val_best_acc_score: 0.9707; val_best_f1_score: 0.9831; train_kl_reg_loss: 1945.4034; train_edge_recon_loss: 78015.5458; train_gene_expr_recon_loss: 86778.7695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166739.7176; train_optim_loss: 166739.7176; val_kl_reg_loss: 1930.7731; val_edge_recon_loss: 77396.5469; val_gene_expr_recon_loss: 86832.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166160.1016; val_optim_loss: 166160.1016

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9752; val_auprc_score: 0.9935; val_best_acc_score: 0.9688; val_best_f1_score: 0.9820; train_kl_reg_loss: 1946.4874; train_edge_recon_loss: 78608.6535; train_gene_expr_recon_loss: 86462.7243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167017.8650; train_optim_loss: 167017.8650; val_kl_reg_loss: 1918.8269; val_edge_recon_loss: 75080.6602; val_gene_expr_recon_loss: 87424.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164423.9453; val_optim_loss: 164423.9453
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9795; val_auprc_score: 0.9940; val_best_acc_score: 0.9720; val_best_f1_score: 0.9838; train_kl_reg_loss: 1940.9085; train_edge_recon_loss: 78613.0251; train_gene_expr_recon_loss: 86536.7372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167090.6696; train_optim_loss: 167090.6696; val_kl_reg_loss: 1922.0654; val_edge_recon_loss: 74984.9688; val_gene_expr_recon_loss: 87652.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164559.6641; val_optim_loss: 164559.6641
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9776; val_auprc_score: 0.9940; val_best_acc_score: 0.9694; val_best_f1_score: 0.9823; train_kl_reg_loss: 1933.8514; train_edge_recon_loss: 76745.0485; train_gene_expr_recon_loss: 86366.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165045.2812; train_optim_loss: 165045.2812; val_kl_reg_loss: 1903.7164; val_edge_recon_loss: 77602.6211; val_gene_expr_recon_loss: 87213.8008; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166720.1328; val_optim_loss: 166720.1328
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9767; val_auprc_score: 0.9931; val_best_acc_score: 0.9715; val_best_f1_score: 0.9835; train_kl_reg_loss: 1918.6336; train_edge_recon_loss: 76873.8058; train_gene_expr_recon_loss: 86284.8772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165077.3170; train_optim_loss: 165077.3170; val_kl_reg_loss: 1896.6576; val_edge_recon_loss: 78565.6328; val_gene_expr_recon_loss: 87620.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168082.9844; val_optim_loss: 168082.9844

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9794; val_auprc_score: 0.9943; val_best_acc_score: 0.9731; val_best_f1_score: 0.9843; train_kl_reg_loss: 1922.7189; train_edge_recon_loss: 77657.6836; train_gene_expr_recon_loss: 86365.0022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165945.4040; train_optim_loss: 165945.4040; val_kl_reg_loss: 1891.2800; val_edge_recon_loss: 77425.2461; val_gene_expr_recon_loss: 86333.7930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165650.3281; val_optim_loss: 165650.3281
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9817; val_auprc_score: 0.9947; val_best_acc_score: 0.9713; val_best_f1_score: 0.9833; train_kl_reg_loss: 1924.3182; train_edge_recon_loss: 77508.7400; train_gene_expr_recon_loss: 86488.8806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165921.9375; train_optim_loss: 165921.9375; val_kl_reg_loss: 1899.0966; val_edge_recon_loss: 78306.3125; val_gene_expr_recon_loss: 87504.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167709.5312; val_optim_loss: 167709.5312
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9748; val_auprc_score: 0.9938; val_best_acc_score: 0.9693; val_best_f1_score: 0.9822; train_kl_reg_loss: 1923.2426; train_edge_recon_loss: 77444.9302; train_gene_expr_recon_loss: 86267.2612; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165635.4319; train_optim_loss: 165635.4319; val_kl_reg_loss: 1902.2230; val_edge_recon_loss: 77918.1016; val_gene_expr_recon_loss: 87079.1523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166899.4688; val_optim_loss: 166899.4688

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 18 sec.
Using best model state, which was in epoch 15.

--- MODEL EVALUATION ---
Val AUROC score: 0.9769
Val AUPRC score: 0.9932
Val best accuracy score: 0.9694
Val best F1 score: 0.9823
Val gene expr MSE score: 0.9569
Duration of model training in run 7: 0 hours, 1 minutes and 20 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 106920
Number of validation edges: 11879
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9728; val_auprc_score: 0.9930; val_best_acc_score: 0.9431; val_best_f1_score: 0.9663; train_kl_reg_loss: 184.3310; train_edge_recon_loss: 102283.0586; train_gene_expr_recon_loss: 105599.5798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208066.9654; train_optim_loss: 208066.9654; val_kl_reg_loss: 182.5384; val_edge_recon_loss: 113927.0391; val_gene_expr_recon_loss: 92723.1602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206832.7344; val_optim_loss: 206832.7344
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8888; val_auprc_score: 0.9747; val_best_acc_score: 0.9012; val_best_f1_score: 0.9442; train_kl_reg_loss: 220.2649; train_edge_recon_loss: 99383.0971; train_gene_expr_recon_loss: 93073.5642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192676.9263; train_optim_loss: 192676.9263; val_kl_reg_loss: 482.5729; val_edge_recon_loss: 94376.4883; val_gene_expr_recon_loss: 91109.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185968.7344; val_optim_loss: 185968.7344
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9078; val_auprc_score: 0.9795; val_best_acc_score: 0.9106; val_best_f1_score: 0.9489; train_kl_reg_loss: 1236.4559; train_edge_recon_loss: 90898.3331; train_gene_expr_recon_loss: 91298.5173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183433.3092; train_optim_loss: 183433.3092; val_kl_reg_loss: 2264.8656; val_edge_recon_loss: 84262.7461; val_gene_expr_recon_loss: 89979.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176506.8281; val_optim_loss: 176506.8281
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9401; val_auprc_score: 0.9871; val_best_acc_score: 0.9302; val_best_f1_score: 0.9599; train_kl_reg_loss: 2640.3857; train_edge_recon_loss: 82776.6021; train_gene_expr_recon_loss: 90482.0910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175899.0781; train_optim_loss: 175899.0781; val_kl_reg_loss: 2613.4261; val_edge_recon_loss: 78987.0586; val_gene_expr_recon_loss: 88472.1055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170072.5938; val_optim_loss: 170072.5938
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9593; val_auprc_score: 0.9902; val_best_acc_score: 0.9452; val_best_f1_score: 0.9685; train_kl_reg_loss: 2411.7209; train_edge_recon_loss: 79948.2835; train_gene_expr_recon_loss: 89552.7885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171912.7924; train_optim_loss: 171912.7924; val_kl_reg_loss: 2120.1926; val_edge_recon_loss: 78197.0195; val_gene_expr_recon_loss: 88841.7695; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169158.9844; val_optim_loss: 169158.9844
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9674; val_auprc_score: 0.9920; val_best_acc_score: 0.9561; val_best_f1_score: 0.9746; train_kl_reg_loss: 2132.7956; train_edge_recon_loss: 79856.2327; train_gene_expr_recon_loss: 89142.5067; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171131.5368; train_optim_loss: 171131.5368; val_kl_reg_loss: 2197.0725; val_edge_recon_loss: 76604.9570; val_gene_expr_recon_loss: 87269.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166071.3828; val_optim_loss: 166071.3828
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9671; val_auprc_score: 0.9924; val_best_acc_score: 0.9590; val_best_f1_score: 0.9763; train_kl_reg_loss: 2194.3487; train_edge_recon_loss: 78560.3253; train_gene_expr_recon_loss: 88451.1981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169205.8717; train_optim_loss: 169205.8717; val_kl_reg_loss: 2072.6479; val_edge_recon_loss: 78554.8242; val_gene_expr_recon_loss: 87564.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168192.3594; val_optim_loss: 168192.3594
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9752; val_auprc_score: 0.9924; val_best_acc_score: 0.9651; val_best_f1_score: 0.9797; train_kl_reg_loss: 2068.5050; train_edge_recon_loss: 78800.3248; train_gene_expr_recon_loss: 88106.4749; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168975.3036; train_optim_loss: 168975.3036; val_kl_reg_loss: 2014.4678; val_edge_recon_loss: 77534.1406; val_gene_expr_recon_loss: 87349.5273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166898.1406; val_optim_loss: 166898.1406
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9729; val_auprc_score: 0.9927; val_best_acc_score: 0.9666; val_best_f1_score: 0.9806; train_kl_reg_loss: 1978.1244; train_edge_recon_loss: 77373.8493; train_gene_expr_recon_loss: 87726.0971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167078.0692; train_optim_loss: 167078.0692; val_kl_reg_loss: 2001.8920; val_edge_recon_loss: 77495.5312; val_gene_expr_recon_loss: 87021.5586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166518.9844; val_optim_loss: 166518.9844

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9753; val_auprc_score: 0.9937; val_best_acc_score: 0.9679; val_best_f1_score: 0.9813; train_kl_reg_loss: 2023.8995; train_edge_recon_loss: 77362.2316; train_gene_expr_recon_loss: 87464.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166850.5569; train_optim_loss: 166850.5569; val_kl_reg_loss: 1991.5189; val_edge_recon_loss: 76992.3906; val_gene_expr_recon_loss: 86122.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165106.7578; val_optim_loss: 165106.7578
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9738; val_auprc_score: 0.9936; val_best_acc_score: 0.9684; val_best_f1_score: 0.9817; train_kl_reg_loss: 2003.3288; train_edge_recon_loss: 77412.9392; train_gene_expr_recon_loss: 87386.5731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166802.8404; train_optim_loss: 166802.8404; val_kl_reg_loss: 1962.5131; val_edge_recon_loss: 76312.0156; val_gene_expr_recon_loss: 86098.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164373.4297; val_optim_loss: 164373.4297
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9768; val_auprc_score: 0.9933; val_best_acc_score: 0.9673; val_best_f1_score: 0.9809; train_kl_reg_loss: 1993.2650; train_edge_recon_loss: 77679.9699; train_gene_expr_recon_loss: 87332.0430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167005.2779; train_optim_loss: 167005.2779; val_kl_reg_loss: 1954.2354; val_edge_recon_loss: 80362.5000; val_gene_expr_recon_loss: 86053.3242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168370.0625; val_optim_loss: 168370.0625
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9742; val_auprc_score: 0.9935; val_best_acc_score: 0.9673; val_best_f1_score: 0.9810; train_kl_reg_loss: 1984.7217; train_edge_recon_loss: 77323.9978; train_gene_expr_recon_loss: 87461.4732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166770.1908; train_optim_loss: 166770.1908; val_kl_reg_loss: 1960.7169; val_edge_recon_loss: 77977.6914; val_gene_expr_recon_loss: 86944.3164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166882.7344; val_optim_loss: 166882.7344
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9764; val_auprc_score: 0.9927; val_best_acc_score: 0.9703; val_best_f1_score: 0.9827; train_kl_reg_loss: 1983.7731; train_edge_recon_loss: 76796.5564; train_gene_expr_recon_loss: 87346.0480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166126.3772; train_optim_loss: 166126.3772; val_kl_reg_loss: 1954.1837; val_edge_recon_loss: 77178.5508; val_gene_expr_recon_loss: 86608.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165740.9688; val_optim_loss: 165740.9688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9758; val_auprc_score: 0.9937; val_best_acc_score: 0.9685; val_best_f1_score: 0.9817; train_kl_reg_loss: 1979.9898; train_edge_recon_loss: 77393.2584; train_gene_expr_recon_loss: 87211.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166584.3415; train_optim_loss: 166584.3415; val_kl_reg_loss: 1949.6612; val_edge_recon_loss: 77788.8125; val_gene_expr_recon_loss: 85633.5977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165372.0703; val_optim_loss: 165372.0703
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9790; val_auprc_score: 0.9950; val_best_acc_score: 0.9712; val_best_f1_score: 0.9833; train_kl_reg_loss: 1979.2538; train_edge_recon_loss: 77400.4651; train_gene_expr_recon_loss: 87221.3465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166601.0647; train_optim_loss: 166601.0647; val_kl_reg_loss: 1956.9635; val_edge_recon_loss: 75148.7773; val_gene_expr_recon_loss: 86264.5898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163370.3281; val_optim_loss: 163370.3281
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9743; val_auprc_score: 0.9930; val_best_acc_score: 0.9677; val_best_f1_score: 0.9813; train_kl_reg_loss: 1981.0524; train_edge_recon_loss: 77706.0759; train_gene_expr_recon_loss: 87270.3354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166957.4598; train_optim_loss: 166957.4598; val_kl_reg_loss: 1949.3756; val_edge_recon_loss: 75882.4414; val_gene_expr_recon_loss: 86412.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164244.3750; val_optim_loss: 164244.3750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9765; val_auprc_score: 0.9945; val_best_acc_score: 0.9671; val_best_f1_score: 0.9809; train_kl_reg_loss: 1981.4541; train_edge_recon_loss: 77532.6708; train_gene_expr_recon_loss: 87310.2015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166824.3281; train_optim_loss: 166824.3281; val_kl_reg_loss: 1953.6655; val_edge_recon_loss: 79569.3359; val_gene_expr_recon_loss: 85724.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167247.8672; val_optim_loss: 167247.8672
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9787; val_auprc_score: 0.9949; val_best_acc_score: 0.9700; val_best_f1_score: 0.9826; train_kl_reg_loss: 1982.5524; train_edge_recon_loss: 77956.8170; train_gene_expr_recon_loss: 87270.6462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167210.0167; train_optim_loss: 167210.0167; val_kl_reg_loss: 1956.9873; val_edge_recon_loss: 77527.0586; val_gene_expr_recon_loss: 86092.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165576.4531; val_optim_loss: 165576.4531

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9762; val_auprc_score: 0.9933; val_best_acc_score: 0.9689; val_best_f1_score: 0.9819; train_kl_reg_loss: 1983.0904; train_edge_recon_loss: 78735.1624; train_gene_expr_recon_loss: 87308.1116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168026.3605; train_optim_loss: 168026.3605; val_kl_reg_loss: 1953.5575; val_edge_recon_loss: 78655.8594; val_gene_expr_recon_loss: 86201.9023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166811.3281; val_optim_loss: 166811.3281
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9748; val_auprc_score: 0.9911; val_best_acc_score: 0.9689; val_best_f1_score: 0.9818; train_kl_reg_loss: 1981.9950; train_edge_recon_loss: 77929.3929; train_gene_expr_recon_loss: 87229.8544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167141.2411; train_optim_loss: 167141.2411; val_kl_reg_loss: 1956.8220; val_edge_recon_loss: 78960.3008; val_gene_expr_recon_loss: 86514.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167431.2656; val_optim_loss: 167431.2656
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9752; val_auprc_score: 0.9937; val_best_acc_score: 0.9694; val_best_f1_score: 0.9822; train_kl_reg_loss: 1982.1499; train_edge_recon_loss: 77560.0971; train_gene_expr_recon_loss: 87150.7383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166692.9844; train_optim_loss: 166692.9844; val_kl_reg_loss: 1955.9807; val_edge_recon_loss: 76591.3516; val_gene_expr_recon_loss: 86029.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164576.5078; val_optim_loss: 164576.5078

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 23 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
Val AUROC score: 0.9773
Val AUPRC score: 0.9946
Val best accuracy score: 0.9682
Val best F1 score: 0.9816
Val gene expr MSE score: 0.9578
Duration of model training in run 8: 0 hours, 1 minutes and 25 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 133545
Number of validation edges: 14838
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9475; val_auprc_score: 0.9890; val_best_acc_score: 0.9261; val_best_f1_score: 0.9577; train_kl_reg_loss: 160.1242; train_edge_recon_loss: 102188.7027; train_gene_expr_recon_loss: 103876.3833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206225.2096; train_optim_loss: 206225.2096; val_kl_reg_loss: 135.4847; val_edge_recon_loss: 104145.2891; val_gene_expr_recon_loss: 92604.7305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196885.5078; val_optim_loss: 196885.5078
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8865; val_auprc_score: 0.9751; val_best_acc_score: 0.9036; val_best_f1_score: 0.9457; train_kl_reg_loss: 553.2056; train_edge_recon_loss: 96092.5983; train_gene_expr_recon_loss: 91529.2100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188175.0129; train_optim_loss: 188175.0129; val_kl_reg_loss: 1587.0335; val_edge_recon_loss: 87618.1719; val_gene_expr_recon_loss: 90327.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179532.9297; val_optim_loss: 179532.9297
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9203; val_auprc_score: 0.9829; val_best_acc_score: 0.9174; val_best_f1_score: 0.9531; train_kl_reg_loss: 2574.7413; train_edge_recon_loss: 83554.5483; train_gene_expr_recon_loss: 89816.1425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175945.4311; train_optim_loss: 175945.4311; val_kl_reg_loss: 2719.4601; val_edge_recon_loss: 80966.6953; val_gene_expr_recon_loss: 89450.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173136.6094; val_optim_loss: 173136.6094
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9602; val_auprc_score: 0.9909; val_best_acc_score: 0.9499; val_best_f1_score: 0.9711; train_kl_reg_loss: 2348.0699; train_edge_recon_loss: 80988.3084; train_gene_expr_recon_loss: 89030.6618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172367.0377; train_optim_loss: 172367.0377; val_kl_reg_loss: 2089.3594; val_edge_recon_loss: 78038.1250; val_gene_expr_recon_loss: 88717.2305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168844.7109; val_optim_loss: 168844.7109
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9711; val_auprc_score: 0.9928; val_best_acc_score: 0.9596; val_best_f1_score: 0.9765; train_kl_reg_loss: 2151.7735; train_edge_recon_loss: 79517.6016; train_gene_expr_recon_loss: 88187.0818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169856.4559; train_optim_loss: 169856.4559; val_kl_reg_loss: 2052.7804; val_edge_recon_loss: 77457.1992; val_gene_expr_recon_loss: 87759.8086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167269.7891; val_optim_loss: 167269.7891
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9723; val_auprc_score: 0.9928; val_best_acc_score: 0.9660; val_best_f1_score: 0.9803; train_kl_reg_loss: 2041.0153; train_edge_recon_loss: 78049.3897; train_gene_expr_recon_loss: 87710.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167800.9678; train_optim_loss: 167800.9678; val_kl_reg_loss: 1999.1628; val_edge_recon_loss: 77150.6289; val_gene_expr_recon_loss: 87636.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166786.4062; val_optim_loss: 166786.4062
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9736; val_auprc_score: 0.9924; val_best_acc_score: 0.9673; val_best_f1_score: 0.9811; train_kl_reg_loss: 1990.1799; train_edge_recon_loss: 77347.6631; train_gene_expr_recon_loss: 87231.4044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166569.2482; train_optim_loss: 166569.2482; val_kl_reg_loss: 1962.7386; val_edge_recon_loss: 75806.7930; val_gene_expr_recon_loss: 86942.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164712.0625; val_optim_loss: 164712.0625
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9774; val_auprc_score: 0.9948; val_best_acc_score: 0.9687; val_best_f1_score: 0.9819; train_kl_reg_loss: 1955.8604; train_edge_recon_loss: 77876.0947; train_gene_expr_recon_loss: 86704.8341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166536.7923; train_optim_loss: 166536.7923; val_kl_reg_loss: 1930.1269; val_edge_recon_loss: 77435.1133; val_gene_expr_recon_loss: 86476.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165841.6719; val_optim_loss: 165841.6719
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9755; val_auprc_score: 0.9929; val_best_acc_score: 0.9704; val_best_f1_score: 0.9829; train_kl_reg_loss: 1954.1494; train_edge_recon_loss: 78061.4798; train_gene_expr_recon_loss: 86342.4223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166358.0524; train_optim_loss: 166358.0524; val_kl_reg_loss: 1910.1787; val_edge_recon_loss: 76329.1797; val_gene_expr_recon_loss: 86024.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164263.7109; val_optim_loss: 164263.7109
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9773; val_auprc_score: 0.9941; val_best_acc_score: 0.9720; val_best_f1_score: 0.9837; train_kl_reg_loss: 1920.1544; train_edge_recon_loss: 77105.1461; train_gene_expr_recon_loss: 85958.4651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164983.7656; train_optim_loss: 164983.7656; val_kl_reg_loss: 1924.3760; val_edge_recon_loss: 78429.2734; val_gene_expr_recon_loss: 85834.2227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166187.8672; val_optim_loss: 166187.8672
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9822; val_auprc_score: 0.9949; val_best_acc_score: 0.9733; val_best_f1_score: 0.9844; train_kl_reg_loss: 1913.0811; train_edge_recon_loss: 77257.5703; train_gene_expr_recon_loss: 85646.5565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164817.2096; train_optim_loss: 164817.2096; val_kl_reg_loss: 1887.2910; val_edge_recon_loss: 77895.7578; val_gene_expr_recon_loss: 85497.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165280.1406; val_optim_loss: 165280.1406
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9806; val_auprc_score: 0.9941; val_best_acc_score: 0.9724; val_best_f1_score: 0.9840; train_kl_reg_loss: 1893.4452; train_edge_recon_loss: 76905.6530; train_gene_expr_recon_loss: 85332.3828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164131.4798; train_optim_loss: 164131.4798; val_kl_reg_loss: 1856.2393; val_edge_recon_loss: 76729.7305; val_gene_expr_recon_loss: 84964.0273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163550.0000; val_optim_loss: 163550.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9809; val_auprc_score: 0.9952; val_best_acc_score: 0.9742; val_best_f1_score: 0.9850; train_kl_reg_loss: 1894.8663; train_edge_recon_loss: 76289.9513; train_gene_expr_recon_loss: 85144.5483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163329.3676; train_optim_loss: 163329.3676; val_kl_reg_loss: 1832.6411; val_edge_recon_loss: 76983.1680; val_gene_expr_recon_loss: 84917.4102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163733.2188; val_optim_loss: 163733.2188
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9829; val_auprc_score: 0.9953; val_best_acc_score: 0.9732; val_best_f1_score: 0.9844; train_kl_reg_loss: 1883.2097; train_edge_recon_loss: 76973.3966; train_gene_expr_recon_loss: 84720.8621; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163577.4678; train_optim_loss: 163577.4678; val_kl_reg_loss: 1855.2384; val_edge_recon_loss: 75961.8281; val_gene_expr_recon_loss: 84765.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162582.8281; val_optim_loss: 162582.8281
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9811; val_auprc_score: 0.9943; val_best_acc_score: 0.9750; val_best_f1_score: 0.9855; train_kl_reg_loss: 1879.2828; train_edge_recon_loss: 77317.9292; train_gene_expr_recon_loss: 84615.4536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163812.6673; train_optim_loss: 163812.6673; val_kl_reg_loss: 1876.5970; val_edge_recon_loss: 77782.7539; val_gene_expr_recon_loss: 84494.9258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164154.2812; val_optim_loss: 164154.2812
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9849; val_auprc_score: 0.9964; val_best_acc_score: 0.9769; val_best_f1_score: 0.9866; train_kl_reg_loss: 1884.2736; train_edge_recon_loss: 77234.7817; train_gene_expr_recon_loss: 84465.0211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163584.0772; train_optim_loss: 163584.0772; val_kl_reg_loss: 1831.4416; val_edge_recon_loss: 75548.4141; val_gene_expr_recon_loss: 84197.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161577.7891; val_optim_loss: 161577.7891
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9863; val_auprc_score: 0.9963; val_best_acc_score: 0.9767; val_best_f1_score: 0.9865; train_kl_reg_loss: 1867.3860; train_edge_recon_loss: 77205.5119; train_gene_expr_recon_loss: 84214.3176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163287.2151; train_optim_loss: 163287.2151; val_kl_reg_loss: 1838.4592; val_edge_recon_loss: 76480.6172; val_gene_expr_recon_loss: 84052.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162371.6953; val_optim_loss: 162371.6953
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9818; val_auprc_score: 0.9950; val_best_acc_score: 0.9754; val_best_f1_score: 0.9857; train_kl_reg_loss: 1877.4227; train_edge_recon_loss: 76953.3892; train_gene_expr_recon_loss: 84118.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162948.8428; train_optim_loss: 162948.8428; val_kl_reg_loss: 1829.6761; val_edge_recon_loss: 77115.0703; val_gene_expr_recon_loss: 84080.9258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163025.6719; val_optim_loss: 163025.6719
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9811; val_auprc_score: 0.9948; val_best_acc_score: 0.9767; val_best_f1_score: 0.9864; train_kl_reg_loss: 1866.8811; train_edge_recon_loss: 76362.8525; train_gene_expr_recon_loss: 83828.5478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162058.2794; train_optim_loss: 162058.2794; val_kl_reg_loss: 1864.5195; val_edge_recon_loss: 78008.1758; val_gene_expr_recon_loss: 83836.9570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163709.6562; val_optim_loss: 163709.6562

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9837; val_auprc_score: 0.9954; val_best_acc_score: 0.9775; val_best_f1_score: 0.9868; train_kl_reg_loss: 1883.6028; train_edge_recon_loss: 76557.6857; train_gene_expr_recon_loss: 83663.3506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162104.6388; train_optim_loss: 162104.6388; val_kl_reg_loss: 1854.6473; val_edge_recon_loss: 78248.1367; val_gene_expr_recon_loss: 83862.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163965.2656; val_optim_loss: 163965.2656
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9853; val_auprc_score: 0.9966; val_best_acc_score: 0.9758; val_best_f1_score: 0.9859; train_kl_reg_loss: 1873.5489; train_edge_recon_loss: 76914.7808; train_gene_expr_recon_loss: 83763.9876; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162552.3171; train_optim_loss: 162552.3171; val_kl_reg_loss: 1857.2103; val_edge_recon_loss: 77481.3320; val_gene_expr_recon_loss: 83783.7383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163122.2812; val_optim_loss: 163122.2812
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9818; val_auprc_score: 0.9952; val_best_acc_score: 0.9774; val_best_f1_score: 0.9869; train_kl_reg_loss: 1874.1292; train_edge_recon_loss: 77007.3424; train_gene_expr_recon_loss: 83697.2863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162578.7564; train_optim_loss: 162578.7564; val_kl_reg_loss: 1845.8414; val_edge_recon_loss: 74933.0312; val_gene_expr_recon_loss: 83852.1445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160631.0156; val_optim_loss: 160631.0156
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9807; val_auprc_score: 0.9940; val_best_acc_score: 0.9755; val_best_f1_score: 0.9858; train_kl_reg_loss: 1867.3838; train_edge_recon_loss: 76731.0437; train_gene_expr_recon_loss: 83659.0703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162257.4963; train_optim_loss: 162257.4963; val_kl_reg_loss: 1850.4677; val_edge_recon_loss: 76798.0234; val_gene_expr_recon_loss: 83807.9023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162456.3984; val_optim_loss: 162456.3984
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9845; val_auprc_score: 0.9959; val_best_acc_score: 0.9776; val_best_f1_score: 0.9871; train_kl_reg_loss: 1875.0490; train_edge_recon_loss: 76874.0184; train_gene_expr_recon_loss: 83626.6544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162375.7206; train_optim_loss: 162375.7206; val_kl_reg_loss: 1854.2502; val_edge_recon_loss: 74205.9688; val_gene_expr_recon_loss: 83636.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159696.7422; val_optim_loss: 159696.7422
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9815; val_auprc_score: 0.9937; val_best_acc_score: 0.9774; val_best_f1_score: 0.9868; train_kl_reg_loss: 1876.6594; train_edge_recon_loss: 77666.2918; train_gene_expr_recon_loss: 83649.9835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163192.9347; train_optim_loss: 163192.9347; val_kl_reg_loss: 1859.1432; val_edge_recon_loss: 76670.0977; val_gene_expr_recon_loss: 83505.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162034.6328; val_optim_loss: 162034.6328
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9849; val_auprc_score: 0.9950; val_best_acc_score: 0.9784; val_best_f1_score: 0.9874; train_kl_reg_loss: 1868.3277; train_edge_recon_loss: 77419.3860; train_gene_expr_recon_loss: 83724.9407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163012.6553; train_optim_loss: 163012.6553; val_kl_reg_loss: 1843.0653; val_edge_recon_loss: 75654.0703; val_gene_expr_recon_loss: 83518.8320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161015.9688; val_optim_loss: 161015.9688
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9847; val_auprc_score: 0.9960; val_best_acc_score: 0.9776; val_best_f1_score: 0.9870; train_kl_reg_loss: 1869.9883; train_edge_recon_loss: 77559.4839; train_gene_expr_recon_loss: 83617.5427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163047.0129; train_optim_loss: 163047.0129; val_kl_reg_loss: 1848.1973; val_edge_recon_loss: 75848.0078; val_gene_expr_recon_loss: 83466.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161162.7891; val_optim_loss: 161162.7891

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9823; val_auprc_score: 0.9934; val_best_acc_score: 0.9774; val_best_f1_score: 0.9868; train_kl_reg_loss: 1870.7442; train_edge_recon_loss: 77373.7220; train_gene_expr_recon_loss: 83639.3589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162883.8254; train_optim_loss: 162883.8254; val_kl_reg_loss: 1850.7484; val_edge_recon_loss: 78650.5664; val_gene_expr_recon_loss: 83682.6992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164184.0156; val_optim_loss: 164184.0156
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9842; val_auprc_score: 0.9958; val_best_acc_score: 0.9778; val_best_f1_score: 0.9871; train_kl_reg_loss: 1868.5942; train_edge_recon_loss: 76340.1636; train_gene_expr_recon_loss: 83518.8529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161727.6121; train_optim_loss: 161727.6121; val_kl_reg_loss: 1846.1083; val_edge_recon_loss: 77540.5312; val_gene_expr_recon_loss: 83644.0977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163030.7344; val_optim_loss: 163030.7344
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9836; val_auprc_score: 0.9950; val_best_acc_score: 0.9786; val_best_f1_score: 0.9876; train_kl_reg_loss: 1864.5053; train_edge_recon_loss: 76721.8718; train_gene_expr_recon_loss: 83516.0731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162102.4485; train_optim_loss: 162102.4485; val_kl_reg_loss: 1845.2051; val_edge_recon_loss: 75657.6250; val_gene_expr_recon_loss: 83587.6367; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161090.4688; val_optim_loss: 161090.4688

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 28 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9801
Val AUPRC score: 0.9940
Val best accuracy score: 0.9768
Val best F1 score: 0.9865
Val gene expr MSE score: 0.8976
Duration of model training in run 9: 0 hours, 2 minutes and 30 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 133545
Number of validation edges: 14838
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9558; val_auprc_score: 0.9903; val_best_acc_score: 0.9308; val_best_f1_score: 0.9602; train_kl_reg_loss: 175.3957; train_edge_recon_loss: 102120.8442; train_gene_expr_recon_loss: 103362.8451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205659.0846; train_optim_loss: 205659.0846; val_kl_reg_loss: 140.2856; val_edge_recon_loss: 109320.6992; val_gene_expr_recon_loss: 91837.2070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201298.1953; val_optim_loss: 201298.1953
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8804; val_auprc_score: 0.9733; val_best_acc_score: 0.9002; val_best_f1_score: 0.9440; train_kl_reg_loss: 443.4771; train_edge_recon_loss: 97012.4577; train_gene_expr_recon_loss: 90863.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188319.2730; train_optim_loss: 188319.2730; val_kl_reg_loss: 1358.6331; val_edge_recon_loss: 89701.8672; val_gene_expr_recon_loss: 89704.4727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180764.9688; val_optim_loss: 180764.9688
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9180; val_auprc_score: 0.9813; val_best_acc_score: 0.9118; val_best_f1_score: 0.9501; train_kl_reg_loss: 2495.9803; train_edge_recon_loss: 84790.6259; train_gene_expr_recon_loss: 89321.3534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176607.9596; train_optim_loss: 176607.9596; val_kl_reg_loss: 2814.0872; val_edge_recon_loss: 83195.9492; val_gene_expr_recon_loss: 88941.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174951.1719; val_optim_loss: 174951.1719
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9624; val_auprc_score: 0.9907; val_best_acc_score: 0.9515; val_best_f1_score: 0.9720; train_kl_reg_loss: 2367.5615; train_edge_recon_loss: 81049.5965; train_gene_expr_recon_loss: 88444.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171861.8235; train_optim_loss: 171861.8235; val_kl_reg_loss: 2089.2336; val_edge_recon_loss: 79829.2656; val_gene_expr_recon_loss: 88108.9727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170027.4766; val_optim_loss: 170027.4766
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9729; val_auprc_score: 0.9928; val_best_acc_score: 0.9629; val_best_f1_score: 0.9784; train_kl_reg_loss: 2099.0169; train_edge_recon_loss: 78577.9288; train_gene_expr_recon_loss: 87860.5060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168537.4504; train_optim_loss: 168537.4504; val_kl_reg_loss: 2028.1622; val_edge_recon_loss: 78656.7969; val_gene_expr_recon_loss: 87276.8555; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167961.8203; val_optim_loss: 167961.8203
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9784; val_auprc_score: 0.9943; val_best_acc_score: 0.9681; val_best_f1_score: 0.9815; train_kl_reg_loss: 2018.1176; train_edge_recon_loss: 78352.8001; train_gene_expr_recon_loss: 87134.6163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167505.5322; train_optim_loss: 167505.5322; val_kl_reg_loss: 1996.1797; val_edge_recon_loss: 76707.2305; val_gene_expr_recon_loss: 86995.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165698.6562; val_optim_loss: 165698.6562
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9766; val_auprc_score: 0.9928; val_best_acc_score: 0.9690; val_best_f1_score: 0.9819; train_kl_reg_loss: 1968.1100; train_edge_recon_loss: 77599.8153; train_gene_expr_recon_loss: 86705.6480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166273.5726; train_optim_loss: 166273.5726; val_kl_reg_loss: 1956.4766; val_edge_recon_loss: 78380.5938; val_gene_expr_recon_loss: 86584.4023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166921.4766; val_optim_loss: 166921.4766
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9776; val_auprc_score: 0.9933; val_best_acc_score: 0.9700; val_best_f1_score: 0.9826; train_kl_reg_loss: 1971.2504; train_edge_recon_loss: 77687.2091; train_gene_expr_recon_loss: 86248.9246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165907.3833; train_optim_loss: 165907.3833; val_kl_reg_loss: 1944.8456; val_edge_recon_loss: 77539.8242; val_gene_expr_recon_loss: 86020.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165505.0078; val_optim_loss: 165505.0078
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9755; val_auprc_score: 0.9928; val_best_acc_score: 0.9705; val_best_f1_score: 0.9829; train_kl_reg_loss: 1929.5657; train_edge_recon_loss: 77672.8180; train_gene_expr_recon_loss: 85769.9237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165372.3070; train_optim_loss: 165372.3070; val_kl_reg_loss: 1907.1216; val_edge_recon_loss: 77003.8867; val_gene_expr_recon_loss: 85712.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164623.6328; val_optim_loss: 164623.6328
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9790; val_auprc_score: 0.9939; val_best_acc_score: 0.9717; val_best_f1_score: 0.9836; train_kl_reg_loss: 1933.6778; train_edge_recon_loss: 77356.8539; train_gene_expr_recon_loss: 85434.7941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164725.3254; train_optim_loss: 164725.3254; val_kl_reg_loss: 1892.8508; val_edge_recon_loss: 76491.9883; val_gene_expr_recon_loss: 85503.5742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163888.4219; val_optim_loss: 163888.4219
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9809; val_auprc_score: 0.9935; val_best_acc_score: 0.9751; val_best_f1_score: 0.9856; train_kl_reg_loss: 1907.5094; train_edge_recon_loss: 77526.0579; train_gene_expr_recon_loss: 85087.7482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164521.3143; train_optim_loss: 164521.3143; val_kl_reg_loss: 1872.7126; val_edge_recon_loss: 73593.9141; val_gene_expr_recon_loss: 85054.7148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160521.3359; val_optim_loss: 160521.3359
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9797; val_auprc_score: 0.9946; val_best_acc_score: 0.9721; val_best_f1_score: 0.9837; train_kl_reg_loss: 1894.3239; train_edge_recon_loss: 77039.3961; train_gene_expr_recon_loss: 84872.9403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163806.6599; train_optim_loss: 163806.6599; val_kl_reg_loss: 1836.1594; val_edge_recon_loss: 80571.6523; val_gene_expr_recon_loss: 84763.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167171.6250; val_optim_loss: 167171.6250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9772; val_auprc_score: 0.9933; val_best_acc_score: 0.9746; val_best_f1_score: 0.9853; train_kl_reg_loss: 1895.3130; train_edge_recon_loss: 77557.5850; train_gene_expr_recon_loss: 84579.9485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164032.8474; train_optim_loss: 164032.8474; val_kl_reg_loss: 1852.5201; val_edge_recon_loss: 75980.1055; val_gene_expr_recon_loss: 84474.1758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162306.8047; val_optim_loss: 162306.8047
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9814; val_auprc_score: 0.9943; val_best_acc_score: 0.9757; val_best_f1_score: 0.9859; train_kl_reg_loss: 1882.1023; train_edge_recon_loss: 76971.1255; train_gene_expr_recon_loss: 84416.9265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163270.1535; train_optim_loss: 163270.1535; val_kl_reg_loss: 1896.6248; val_edge_recon_loss: 75728.6328; val_gene_expr_recon_loss: 84451.1445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162076.3984; val_optim_loss: 162076.3984

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9840; val_auprc_score: 0.9955; val_best_acc_score: 0.9761; val_best_f1_score: 0.9862; train_kl_reg_loss: 1908.1343; train_edge_recon_loss: 76377.3690; train_gene_expr_recon_loss: 84235.6475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162521.1498; train_optim_loss: 162521.1498; val_kl_reg_loss: 1877.9792; val_edge_recon_loss: 75267.2617; val_gene_expr_recon_loss: 84245.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161391.1250; val_optim_loss: 161391.1250
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9840; val_auprc_score: 0.9946; val_best_acc_score: 0.9777; val_best_f1_score: 0.9870; train_kl_reg_loss: 1882.9790; train_edge_recon_loss: 78074.3681; train_gene_expr_recon_loss: 84250.1949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164207.5423; train_optim_loss: 164207.5423; val_kl_reg_loss: 1856.8174; val_edge_recon_loss: 76745.4531; val_gene_expr_recon_loss: 84394.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162997.2344; val_optim_loss: 162997.2344
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9816; val_auprc_score: 0.9944; val_best_acc_score: 0.9750; val_best_f1_score: 0.9854; train_kl_reg_loss: 1885.8457; train_edge_recon_loss: 76798.3548; train_gene_expr_recon_loss: 84077.9278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162762.1314; train_optim_loss: 162762.1314; val_kl_reg_loss: 1863.0110; val_edge_recon_loss: 77657.9258; val_gene_expr_recon_loss: 84156.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163677.1797; val_optim_loss: 163677.1797

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 22 sec.
Using best model state, which was in epoch 11.

--- MODEL EVALUATION ---
Val AUROC score: 0.9813
Val AUPRC score: 0.9954
Val best accuracy score: 0.9728
Val best F1 score: 0.9842
Val gene expr MSE score: 0.9276
Duration of model training in run 10: 0 hours, 1 minutes and 24 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
First script finished. Launching follow up script.
Run timestamp: 01062023_145828.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_50pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-attention_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-attention', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 54907
Number of validation edges: 6100
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9593; val_auprc_score: 0.9924; val_best_acc_score: 0.9162; val_best_f1_score: 0.9529; train_kl_reg_loss: 157.9993; train_edge_recon_loss: 101534.1540; train_gene_expr_recon_loss: 120606.3929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 222298.5469; train_optim_loss: 222298.5469; val_kl_reg_loss: 303.2657; val_edge_recon_loss: 114057.0469; val_gene_expr_recon_loss: 105229.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 219589.8281; val_optim_loss: 219589.8281
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9546; val_auprc_score: 0.9889; val_best_acc_score: 0.9357; val_best_f1_score: 0.9629; train_kl_reg_loss: 246.3899; train_edge_recon_loss: 101157.7712; train_gene_expr_recon_loss: 102654.0804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204058.2411; train_optim_loss: 204058.2411; val_kl_reg_loss: 153.0983; val_edge_recon_loss: 109855.3203; val_gene_expr_recon_loss: 101443.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211452.1719; val_optim_loss: 211452.1719
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9404; val_auprc_score: 0.9880; val_best_acc_score: 0.9301; val_best_f1_score: 0.9604; train_kl_reg_loss: 158.6937; train_edge_recon_loss: 99971.0670; train_gene_expr_recon_loss: 100508.5703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200638.3281; train_optim_loss: 200638.3281; val_kl_reg_loss: 218.2569; val_edge_recon_loss: 91845.9531; val_gene_expr_recon_loss: 100353.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192417.2812; val_optim_loss: 192417.2812
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8836; val_auprc_score: 0.9731; val_best_acc_score: 0.9126; val_best_f1_score: 0.9501; train_kl_reg_loss: 444.0824; train_edge_recon_loss: 95361.5993; train_gene_expr_recon_loss: 99504.8371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195310.5201; train_optim_loss: 195310.5201; val_kl_reg_loss: 905.0387; val_edge_recon_loss: 85026.5078; val_gene_expr_recon_loss: 99290.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185222.4375; val_optim_loss: 185222.4375
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8881; val_auprc_score: 0.9736; val_best_acc_score: 0.9094; val_best_f1_score: 0.9478; train_kl_reg_loss: 1687.4788; train_edge_recon_loss: 85982.0167; train_gene_expr_recon_loss: 98322.2913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185991.7902; train_optim_loss: 185991.7902; val_kl_reg_loss: 2623.3086; val_edge_recon_loss: 84615.0547; val_gene_expr_recon_loss: 98287.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185525.5625; val_optim_loss: 185525.5625
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8955; val_auprc_score: 0.9763; val_best_acc_score: 0.9125; val_best_f1_score: 0.9500; train_kl_reg_loss: 3086.6561; train_edge_recon_loss: 83320.2221; train_gene_expr_recon_loss: 97185.2355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183592.1161; train_optim_loss: 183592.1161; val_kl_reg_loss: 3167.0498; val_edge_recon_loss: 83163.6641; val_gene_expr_recon_loss: 97421.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183752.3750; val_optim_loss: 183752.3750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9035; val_auprc_score: 0.9775; val_best_acc_score: 0.9129; val_best_f1_score: 0.9505; train_kl_reg_loss: 3013.7953; train_edge_recon_loss: 81386.0781; train_gene_expr_recon_loss: 96788.6228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181188.4955; train_optim_loss: 181188.4955; val_kl_reg_loss: 2516.5515; val_edge_recon_loss: 83334.3203; val_gene_expr_recon_loss: 96901.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182752.7812; val_optim_loss: 182752.7812
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9192; val_auprc_score: 0.9820; val_best_acc_score: 0.9229; val_best_f1_score: 0.9565; train_kl_reg_loss: 2304.7024; train_edge_recon_loss: 82182.5458; train_gene_expr_recon_loss: 96073.9085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180561.1562; train_optim_loss: 180561.1562; val_kl_reg_loss: 1965.3054; val_edge_recon_loss: 76854.7969; val_gene_expr_recon_loss: 96459.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175279.6406; val_optim_loss: 175279.6406
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9370; val_auprc_score: 0.9857; val_best_acc_score: 0.9240; val_best_f1_score: 0.9563; train_kl_reg_loss: 1966.4483; train_edge_recon_loss: 81855.4074; train_gene_expr_recon_loss: 95715.5156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179537.3683; train_optim_loss: 179537.3683; val_kl_reg_loss: 1933.2373; val_edge_recon_loss: 82802.5312; val_gene_expr_recon_loss: 96027.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180763.4375; val_optim_loss: 180763.4375
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9538; val_auprc_score: 0.9894; val_best_acc_score: 0.9362; val_best_f1_score: 0.9632; train_kl_reg_loss: 2077.9307; train_edge_recon_loss: 79560.1897; train_gene_expr_recon_loss: 95346.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176984.3996; train_optim_loss: 176984.3996; val_kl_reg_loss: 2138.2104; val_edge_recon_loss: 79144.0781; val_gene_expr_recon_loss: 95607.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176889.6406; val_optim_loss: 176889.6406
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9598; val_auprc_score: 0.9916; val_best_acc_score: 0.9432; val_best_f1_score: 0.9675; train_kl_reg_loss: 2230.9973; train_edge_recon_loss: 78993.5859; train_gene_expr_recon_loss: 94848.7400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176073.3237; train_optim_loss: 176073.3237; val_kl_reg_loss: 2193.1807; val_edge_recon_loss: 75398.8672; val_gene_expr_recon_loss: 95243.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172835.7812; val_optim_loss: 172835.7812
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9561; val_auprc_score: 0.9895; val_best_acc_score: 0.9454; val_best_f1_score: 0.9685; train_kl_reg_loss: 2222.4031; train_edge_recon_loss: 78060.6708; train_gene_expr_recon_loss: 94712.6529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174995.7277; train_optim_loss: 174995.7277; val_kl_reg_loss: 2150.3555; val_edge_recon_loss: 77771.3203; val_gene_expr_recon_loss: 94854.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174776.6562; val_optim_loss: 174776.6562
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9628; val_auprc_score: 0.9921; val_best_acc_score: 0.9465; val_best_f1_score: 0.9694; train_kl_reg_loss: 2160.3954; train_edge_recon_loss: 77711.9888; train_gene_expr_recon_loss: 94040.1362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173912.5201; train_optim_loss: 173912.5201; val_kl_reg_loss: 2052.6265; val_edge_recon_loss: 76572.6719; val_gene_expr_recon_loss: 94485.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173110.5312; val_optim_loss: 173110.5312
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9694; val_auprc_score: 0.9929; val_best_acc_score: 0.9519; val_best_f1_score: 0.9721; train_kl_reg_loss: 2085.5774; train_edge_recon_loss: 77211.5971; train_gene_expr_recon_loss: 93833.5112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173130.6853; train_optim_loss: 173130.6853; val_kl_reg_loss: 2054.1814; val_edge_recon_loss: 80212.2109; val_gene_expr_recon_loss: 94165.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176431.9375; val_optim_loss: 176431.9375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9711; val_auprc_score: 0.9925; val_best_acc_score: 0.9535; val_best_f1_score: 0.9730; train_kl_reg_loss: 2110.1712; train_edge_recon_loss: 78282.1194; train_gene_expr_recon_loss: 93700.3594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174092.6518; train_optim_loss: 174092.6518; val_kl_reg_loss: 2056.5442; val_edge_recon_loss: 80002.6562; val_gene_expr_recon_loss: 94129.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176188.6250; val_optim_loss: 176188.6250
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9699; val_auprc_score: 0.9933; val_best_acc_score: 0.9521; val_best_f1_score: 0.9722; train_kl_reg_loss: 2109.4873; train_edge_recon_loss: 78009.9185; train_gene_expr_recon_loss: 93464.5949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173584.0000; train_optim_loss: 173584.0000; val_kl_reg_loss: 2065.1504; val_edge_recon_loss: 80564.1562; val_gene_expr_recon_loss: 94093.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176722.5000; val_optim_loss: 176722.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9740; val_auprc_score: 0.9939; val_best_acc_score: 0.9544; val_best_f1_score: 0.9736; train_kl_reg_loss: 2120.8943; train_edge_recon_loss: 78389.9978; train_gene_expr_recon_loss: 93629.6507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174140.5424; train_optim_loss: 174140.5424; val_kl_reg_loss: 2063.2568; val_edge_recon_loss: 79568.7031; val_gene_expr_recon_loss: 94060.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175692.6875; val_optim_loss: 175692.6875

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 35 sec.
Using best model state, which was in epoch 11.

--- MODEL EVALUATION ---
Val AUROC score: 0.9562
Val AUPRC score: 0.9892
Val best accuracy score: 0.9445
Val best F1 score: 0.9680
Val gene expr MSE score: 1.2539
Duration of model training in run 1: 0 hours, 0 minutes and 41 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 54907
Number of validation edges: 6100
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9566; val_auprc_score: 0.9913; val_best_acc_score: 0.9311; val_best_f1_score: 0.9601; train_kl_reg_loss: 133.4399; train_edge_recon_loss: 101513.0725; train_gene_expr_recon_loss: 120269.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 221915.8906; train_optim_loss: 221915.8906; val_kl_reg_loss: 215.5489; val_edge_recon_loss: 117863.8828; val_gene_expr_recon_loss: 104456.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222536.2812; val_optim_loss: 222536.2812
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9468; val_auprc_score: 0.9884; val_best_acc_score: 0.9341; val_best_f1_score: 0.9622; train_kl_reg_loss: 169.1357; train_edge_recon_loss: 101258.5234; train_gene_expr_recon_loss: 103360.0926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204787.7500; train_optim_loss: 204787.7500; val_kl_reg_loss: 138.3450; val_edge_recon_loss: 103467.7734; val_gene_expr_recon_loss: 100581.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204187.4688; val_optim_loss: 204187.4688
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9094; val_auprc_score: 0.9796; val_best_acc_score: 0.9147; val_best_f1_score: 0.9517; train_kl_reg_loss: 226.2067; train_edge_recon_loss: 97752.9018; train_gene_expr_recon_loss: 101178.7545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199157.8571; train_optim_loss: 199157.8571; val_kl_reg_loss: 427.2795; val_edge_recon_loss: 90933.9453; val_gene_expr_recon_loss: 99291.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190652.5000; val_optim_loss: 190652.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8752; val_auprc_score: 0.9686; val_best_acc_score: 0.9106; val_best_f1_score: 0.9491; train_kl_reg_loss: 917.3606; train_edge_recon_loss: 89565.1183; train_gene_expr_recon_loss: 99772.5033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190254.9821; train_optim_loss: 190254.9821; val_kl_reg_loss: 1808.2003; val_edge_recon_loss: 84470.9688; val_gene_expr_recon_loss: 98141.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184420.5312; val_optim_loss: 184420.5312
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8949; val_auprc_score: 0.9756; val_best_acc_score: 0.9130; val_best_f1_score: 0.9503; train_kl_reg_loss: 2558.5308; train_edge_recon_loss: 85180.5904; train_gene_expr_recon_loss: 98646.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186385.3594; train_optim_loss: 186385.3594; val_kl_reg_loss: 3091.7104; val_edge_recon_loss: 83935.8281; val_gene_expr_recon_loss: 97053.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184081.3750; val_optim_loss: 184081.3750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8970; val_auprc_score: 0.9767; val_best_acc_score: 0.9128; val_best_f1_score: 0.9506; train_kl_reg_loss: 3171.8742; train_edge_recon_loss: 82414.2835; train_gene_expr_recon_loss: 97710.3080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183296.4665; train_optim_loss: 183296.4665; val_kl_reg_loss: 2831.6289; val_edge_recon_loss: 82392.1328; val_gene_expr_recon_loss: 96322.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181546.2656; val_optim_loss: 181546.2656
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9185; val_auprc_score: 0.9822; val_best_acc_score: 0.9134; val_best_f1_score: 0.9506; train_kl_reg_loss: 2599.5440; train_edge_recon_loss: 81352.3884; train_gene_expr_recon_loss: 97192.6161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181144.5491; train_optim_loss: 181144.5491; val_kl_reg_loss: 2134.8325; val_edge_recon_loss: 84705.1016; val_gene_expr_recon_loss: 95774.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182614.7500; val_optim_loss: 182614.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9301; val_auprc_score: 0.9849; val_best_acc_score: 0.9231; val_best_f1_score: 0.9561; train_kl_reg_loss: 2055.6051; train_edge_recon_loss: 80305.7946; train_gene_expr_recon_loss: 96729.3806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179090.7835; train_optim_loss: 179090.7835; val_kl_reg_loss: 1900.4979; val_edge_recon_loss: 79065.1094; val_gene_expr_recon_loss: 95327.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176293.4062; val_optim_loss: 176293.4062
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9433; val_auprc_score: 0.9869; val_best_acc_score: 0.9339; val_best_f1_score: 0.9618; train_kl_reg_loss: 2014.2141; train_edge_recon_loss: 80100.7879; train_gene_expr_recon_loss: 96157.4263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178272.4330; train_optim_loss: 178272.4330; val_kl_reg_loss: 2058.8767; val_edge_recon_loss: 80042.3828; val_gene_expr_recon_loss: 94933.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177034.4375; val_optim_loss: 177034.4375
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9480; val_auprc_score: 0.9884; val_best_acc_score: 0.9328; val_best_f1_score: 0.9613; train_kl_reg_loss: 2196.9472; train_edge_recon_loss: 78759.5156; train_gene_expr_recon_loss: 95677.6618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176634.1272; train_optim_loss: 176634.1272; val_kl_reg_loss: 2183.1348; val_edge_recon_loss: 81380.8281; val_gene_expr_recon_loss: 94572.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178136.3125; val_optim_loss: 178136.3125
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9554; val_auprc_score: 0.9902; val_best_acc_score: 0.9357; val_best_f1_score: 0.9629; train_kl_reg_loss: 2258.6132; train_edge_recon_loss: 79311.3538; train_gene_expr_recon_loss: 95316.2935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176886.2589; train_optim_loss: 176886.2589; val_kl_reg_loss: 2173.2607; val_edge_recon_loss: 79778.1875; val_gene_expr_recon_loss: 94223.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176175.4219; val_optim_loss: 176175.4219
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9576; val_auprc_score: 0.9901; val_best_acc_score: 0.9426; val_best_f1_score: 0.9670; train_kl_reg_loss: 2200.5529; train_edge_recon_loss: 78557.2835; train_gene_expr_recon_loss: 94945.1272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175702.9665; train_optim_loss: 175702.9665; val_kl_reg_loss: 2075.0278; val_edge_recon_loss: 75822.5000; val_gene_expr_recon_loss: 93891.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171788.9062; val_optim_loss: 171788.9062
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9603; val_auprc_score: 0.9908; val_best_acc_score: 0.9446; val_best_f1_score: 0.9681; train_kl_reg_loss: 2132.9485; train_edge_recon_loss: 78448.4598; train_gene_expr_recon_loss: 94817.7232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175399.1295; train_optim_loss: 175399.1295; val_kl_reg_loss: 2072.4556; val_edge_recon_loss: 75546.5469; val_gene_expr_recon_loss: 93562.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171181.3906; val_optim_loss: 171181.3906
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9657; val_auprc_score: 0.9926; val_best_acc_score: 0.9492; val_best_f1_score: 0.9705; train_kl_reg_loss: 2158.9807; train_edge_recon_loss: 77914.5257; train_gene_expr_recon_loss: 94408.2288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174481.7344; train_optim_loss: 174481.7344; val_kl_reg_loss: 2077.6670; val_edge_recon_loss: 77148.6484; val_gene_expr_recon_loss: 93247.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172473.5938; val_optim_loss: 172473.5938
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9692; val_auprc_score: 0.9926; val_best_acc_score: 0.9507; val_best_f1_score: 0.9716; train_kl_reg_loss: 2116.0822; train_edge_recon_loss: 78140.5268; train_gene_expr_recon_loss: 94147.0134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174403.6205; train_optim_loss: 174403.6205; val_kl_reg_loss: 2038.8447; val_edge_recon_loss: 75060.9844; val_gene_expr_recon_loss: 92961.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170061.1250; val_optim_loss: 170061.1250
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9659; val_auprc_score: 0.9925; val_best_acc_score: 0.9506; val_best_f1_score: 0.9715; train_kl_reg_loss: 2083.3234; train_edge_recon_loss: 77668.3482; train_gene_expr_recon_loss: 93771.0603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173522.7321; train_optim_loss: 173522.7321; val_kl_reg_loss: 2011.5129; val_edge_recon_loss: 77045.7891; val_gene_expr_recon_loss: 92702.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171759.5938; val_optim_loss: 171759.5938
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9659; val_auprc_score: 0.9922; val_best_acc_score: 0.9515; val_best_f1_score: 0.9719; train_kl_reg_loss: 2088.3154; train_edge_recon_loss: 78439.9308; train_gene_expr_recon_loss: 93664.4297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174192.6741; train_optim_loss: 174192.6741; val_kl_reg_loss: 2044.7737; val_edge_recon_loss: 79735.6484; val_gene_expr_recon_loss: 92443.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174224.1875; val_optim_loss: 174224.1875
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9770; val_auprc_score: 0.9955; val_best_acc_score: 0.9556; val_best_f1_score: 0.9742; train_kl_reg_loss: 2092.5880; train_edge_recon_loss: 76287.7210; train_gene_expr_recon_loss: 93289.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171669.4955; train_optim_loss: 171669.4955; val_kl_reg_loss: 1989.0458; val_edge_recon_loss: 79046.3828; val_gene_expr_recon_loss: 92221.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173256.6562; val_optim_loss: 173256.6562

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9704; val_auprc_score: 0.9934; val_best_acc_score: 0.9531; val_best_f1_score: 0.9726; train_kl_reg_loss: 2053.9587; train_edge_recon_loss: 78199.8761; train_gene_expr_recon_loss: 93155.3304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173409.1607; train_optim_loss: 173409.1607; val_kl_reg_loss: 1984.8785; val_edge_recon_loss: 80127.7891; val_gene_expr_recon_loss: 92190.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174303.5938; val_optim_loss: 174303.5938
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9733; val_auprc_score: 0.9944; val_best_acc_score: 0.9593; val_best_f1_score: 0.9764; train_kl_reg_loss: 2056.6374; train_edge_recon_loss: 78342.0391; train_gene_expr_recon_loss: 93098.0748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173496.7500; train_optim_loss: 173496.7500; val_kl_reg_loss: 1991.1113; val_edge_recon_loss: 75533.1250; val_gene_expr_recon_loss: 92163.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169688.1875; val_optim_loss: 169688.1875
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9749; val_auprc_score: 0.9945; val_best_acc_score: 0.9551; val_best_f1_score: 0.9738; train_kl_reg_loss: 2070.2482; train_edge_recon_loss: 78596.2321; train_gene_expr_recon_loss: 93127.3337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173793.8125; train_optim_loss: 173793.8125; val_kl_reg_loss: 2011.1714; val_edge_recon_loss: 79877.2969; val_gene_expr_recon_loss: 92133.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174021.9688; val_optim_loss: 174021.9688
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9717; val_auprc_score: 0.9939; val_best_acc_score: 0.9532; val_best_f1_score: 0.9728; train_kl_reg_loss: 2088.8327; train_edge_recon_loss: 77482.4665; train_gene_expr_recon_loss: 93189.8839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172761.1853; train_optim_loss: 172761.1853; val_kl_reg_loss: 2022.5752; val_edge_recon_loss: 78960.4844; val_gene_expr_recon_loss: 92106.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173089.5781; val_optim_loss: 173089.5781
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9757; val_auprc_score: 0.9953; val_best_acc_score: 0.9563; val_best_f1_score: 0.9748; train_kl_reg_loss: 2085.4593; train_edge_recon_loss: 77377.4654; train_gene_expr_recon_loss: 93109.7288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172572.6540; train_optim_loss: 172572.6540; val_kl_reg_loss: 2010.3463; val_edge_recon_loss: 75695.2266; val_gene_expr_recon_loss: 92081.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169787.5000; val_optim_loss: 169787.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9725; val_auprc_score: 0.9942; val_best_acc_score: 0.9565; val_best_f1_score: 0.9750; train_kl_reg_loss: 2081.8209; train_edge_recon_loss: 77632.6585; train_gene_expr_recon_loss: 92999.6853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172714.1629; train_optim_loss: 172714.1629; val_kl_reg_loss: 2013.3456; val_edge_recon_loss: 75135.6250; val_gene_expr_recon_loss: 92079.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169228.1406; val_optim_loss: 169228.1406
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9739; val_auprc_score: 0.9946; val_best_acc_score: 0.9537; val_best_f1_score: 0.9730; train_kl_reg_loss: 2082.8847; train_edge_recon_loss: 77764.0725; train_gene_expr_recon_loss: 93007.1384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172854.0982; train_optim_loss: 172854.0982; val_kl_reg_loss: 2010.2806; val_edge_recon_loss: 80567.5938; val_gene_expr_recon_loss: 92076.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174654.0625; val_optim_loss: 174654.0625
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9725; val_auprc_score: 0.9930; val_best_acc_score: 0.9552; val_best_f1_score: 0.9739; train_kl_reg_loss: 2081.7789; train_edge_recon_loss: 78713.1987; train_gene_expr_recon_loss: 92950.8616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173745.8393; train_optim_loss: 173745.8393; val_kl_reg_loss: 2011.4417; val_edge_recon_loss: 78824.0156; val_gene_expr_recon_loss: 92073.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172908.9688; val_optim_loss: 172908.9688
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9701; val_auprc_score: 0.9938; val_best_acc_score: 0.9531; val_best_f1_score: 0.9730; train_kl_reg_loss: 2082.5199; train_edge_recon_loss: 77544.0156; train_gene_expr_recon_loss: 93062.1004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172688.6362; train_optim_loss: 172688.6362; val_kl_reg_loss: 2014.3650; val_edge_recon_loss: 77278.0938; val_gene_expr_recon_loss: 92070.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171363.4375; val_optim_loss: 171363.4375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9745; val_auprc_score: 0.9946; val_best_acc_score: 0.9580; val_best_f1_score: 0.9757; train_kl_reg_loss: 2083.0756; train_edge_recon_loss: 77524.9074; train_gene_expr_recon_loss: 93037.3114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172645.2946; train_optim_loss: 172645.2946; val_kl_reg_loss: 2010.6174; val_edge_recon_loss: 76957.8750; val_gene_expr_recon_loss: 92070.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171039.2188; val_optim_loss: 171039.2188
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9700; val_auprc_score: 0.9937; val_best_acc_score: 0.9529; val_best_f1_score: 0.9728; train_kl_reg_loss: 2083.1636; train_edge_recon_loss: 77625.2154; train_gene_expr_recon_loss: 92852.7779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172561.1585; train_optim_loss: 172561.1585; val_kl_reg_loss: 2014.0205; val_edge_recon_loss: 77627.9609; val_gene_expr_recon_loss: 92070.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171712.4688; val_optim_loss: 171712.4688
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9708; val_auprc_score: 0.9931; val_best_acc_score: 0.9555; val_best_f1_score: 0.9741; train_kl_reg_loss: 2083.0831; train_edge_recon_loss: 77556.1373; train_gene_expr_recon_loss: 92982.8304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172622.0513; train_optim_loss: 172622.0513; val_kl_reg_loss: 2012.5740; val_edge_recon_loss: 79063.3125; val_gene_expr_recon_loss: 92070.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173146.1250; val_optim_loss: 173146.1250

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 1 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9757
Val AUPRC score: 0.9949
Val best accuracy score: 0.9569
Val best F1 score: 0.9750
Val gene expr MSE score: 1.0859
Duration of model training in run 2: 0 hours, 1 minutes and 2 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 107073
Number of validation edges: 11897
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9741; val_auprc_score: 0.9937; val_best_acc_score: 0.9506; val_best_f1_score: 0.9714; train_kl_reg_loss: 167.0143; train_edge_recon_loss: 101036.8951; train_gene_expr_recon_loss: 110685.8951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211889.8036; train_optim_loss: 211889.8036; val_kl_reg_loss: 148.6333; val_edge_recon_loss: 106825.5156; val_gene_expr_recon_loss: 98259.4648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205233.6094; val_optim_loss: 205233.6094
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8879; val_auprc_score: 0.9746; val_best_acc_score: 0.9139; val_best_f1_score: 0.9507; train_kl_reg_loss: 398.9566; train_edge_recon_loss: 96772.4146; train_gene_expr_recon_loss: 98066.1423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195237.5134; train_optim_loss: 195237.5134; val_kl_reg_loss: 1316.9271; val_edge_recon_loss: 86232.1172; val_gene_expr_recon_loss: 96463.0117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184012.0547; val_optim_loss: 184012.0547
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9110; val_auprc_score: 0.9803; val_best_acc_score: 0.9187; val_best_f1_score: 0.9536; train_kl_reg_loss: 2644.8066; train_edge_recon_loss: 83832.2578; train_gene_expr_recon_loss: 95757.6127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182234.6763; train_optim_loss: 182234.6763; val_kl_reg_loss: 3052.3785; val_edge_recon_loss: 80217.1016; val_gene_expr_recon_loss: 94598.4102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177867.8906; val_optim_loss: 177867.8906
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9378; val_auprc_score: 0.9865; val_best_acc_score: 0.9246; val_best_f1_score: 0.9565; train_kl_reg_loss: 2468.8335; train_edge_recon_loss: 82135.9269; train_gene_expr_recon_loss: 94567.7282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179172.4900; train_optim_loss: 179172.4900; val_kl_reg_loss: 1901.7990; val_edge_recon_loss: 82081.1758; val_gene_expr_recon_loss: 92983.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176965.9766; val_optim_loss: 176965.9766
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9636; val_auprc_score: 0.9923; val_best_acc_score: 0.9451; val_best_f1_score: 0.9680; train_kl_reg_loss: 1978.6486; train_edge_recon_loss: 80047.0698; train_gene_expr_recon_loss: 93639.7517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175665.4721; train_optim_loss: 175665.4721; val_kl_reg_loss: 2097.0458; val_edge_recon_loss: 82235.3398; val_gene_expr_recon_loss: 92907.4883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177239.8750; val_optim_loss: 177239.8750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9690; val_auprc_score: 0.9928; val_best_acc_score: 0.9494; val_best_f1_score: 0.9706; train_kl_reg_loss: 2156.1612; train_edge_recon_loss: 79548.7729; train_gene_expr_recon_loss: 92753.7930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174458.7299; train_optim_loss: 174458.7299; val_kl_reg_loss: 2110.3740; val_edge_recon_loss: 80349.4219; val_gene_expr_recon_loss: 92448.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174908.4531; val_optim_loss: 174908.4531
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9730; val_auprc_score: 0.9935; val_best_acc_score: 0.9550; val_best_f1_score: 0.9738; train_kl_reg_loss: 2133.0865; train_edge_recon_loss: 78438.8917; train_gene_expr_recon_loss: 92376.6479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172948.6261; train_optim_loss: 172948.6261; val_kl_reg_loss: 2111.3518; val_edge_recon_loss: 78974.0078; val_gene_expr_recon_loss: 90645.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171730.6328; val_optim_loss: 171730.6328
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9734; val_auprc_score: 0.9929; val_best_acc_score: 0.9592; val_best_f1_score: 0.9763; train_kl_reg_loss: 2121.4134; train_edge_recon_loss: 77214.9643; train_gene_expr_recon_loss: 91601.7595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170938.1384; train_optim_loss: 170938.1384; val_kl_reg_loss: 2013.1467; val_edge_recon_loss: 77989.1602; val_gene_expr_recon_loss: 90913.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170915.3672; val_optim_loss: 170915.3672
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9805; val_auprc_score: 0.9955; val_best_acc_score: 0.9661; val_best_f1_score: 0.9803; train_kl_reg_loss: 2031.1357; train_edge_recon_loss: 77821.8471; train_gene_expr_recon_loss: 91087.0491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170940.0324; train_optim_loss: 170940.0324; val_kl_reg_loss: 2064.7446; val_edge_recon_loss: 74975.4570; val_gene_expr_recon_loss: 91427.2539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168467.4609; val_optim_loss: 168467.4609
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9841; val_auprc_score: 0.9964; val_best_acc_score: 0.9693; val_best_f1_score: 0.9821; train_kl_reg_loss: 2076.3074; train_edge_recon_loss: 78389.1713; train_gene_expr_recon_loss: 90768.8683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171234.3471; train_optim_loss: 171234.3471; val_kl_reg_loss: 1996.3571; val_edge_recon_loss: 76359.0898; val_gene_expr_recon_loss: 90521.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168876.8594; val_optim_loss: 168876.8594
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9847; val_auprc_score: 0.9962; val_best_acc_score: 0.9701; val_best_f1_score: 0.9826; train_kl_reg_loss: 2040.5227; train_edge_recon_loss: 77824.0575; train_gene_expr_recon_loss: 90367.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170231.9900; train_optim_loss: 170231.9900; val_kl_reg_loss: 1958.2053; val_edge_recon_loss: 76143.9727; val_gene_expr_recon_loss: 89380.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167482.8594; val_optim_loss: 167482.8594
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9846; val_auprc_score: 0.9968; val_best_acc_score: 0.9714; val_best_f1_score: 0.9834; train_kl_reg_loss: 2025.1063; train_edge_recon_loss: 78251.4369; train_gene_expr_recon_loss: 90008.6585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170285.2065; train_optim_loss: 170285.2065; val_kl_reg_loss: 1979.7155; val_edge_recon_loss: 76816.7383; val_gene_expr_recon_loss: 89066.8555; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167863.3047; val_optim_loss: 167863.3047
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9838; val_auprc_score: 0.9955; val_best_acc_score: 0.9719; val_best_f1_score: 0.9836; train_kl_reg_loss: 1982.3844; train_edge_recon_loss: 77280.2143; train_gene_expr_recon_loss: 89650.7840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168913.3862; train_optim_loss: 168913.3862; val_kl_reg_loss: 1996.0114; val_edge_recon_loss: 79171.0469; val_gene_expr_recon_loss: 89694.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170861.1797; val_optim_loss: 170861.1797
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9834; val_auprc_score: 0.9957; val_best_acc_score: 0.9710; val_best_f1_score: 0.9830; train_kl_reg_loss: 2022.4874; train_edge_recon_loss: 77339.2969; train_gene_expr_recon_loss: 89504.5396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168866.3237; train_optim_loss: 168866.3237; val_kl_reg_loss: 1947.9229; val_edge_recon_loss: 79227.6211; val_gene_expr_recon_loss: 88651.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169827.4922; val_optim_loss: 169827.4922

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9845; val_auprc_score: 0.9952; val_best_acc_score: 0.9719; val_best_f1_score: 0.9836; train_kl_reg_loss: 1996.7478; train_edge_recon_loss: 77518.1378; train_gene_expr_recon_loss: 89132.2773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168647.1652; train_optim_loss: 168647.1652; val_kl_reg_loss: 1969.8621; val_edge_recon_loss: 78893.0039; val_gene_expr_recon_loss: 88836.1680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169699.0312; val_optim_loss: 169699.0312
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9849; val_auprc_score: 0.9967; val_best_acc_score: 0.9722; val_best_f1_score: 0.9838; train_kl_reg_loss: 2005.3512; train_edge_recon_loss: 77895.7461; train_gene_expr_recon_loss: 89227.7824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169128.8795; train_optim_loss: 169128.8795; val_kl_reg_loss: 1962.0076; val_edge_recon_loss: 77269.2227; val_gene_expr_recon_loss: 88639.1914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167870.4219; val_optim_loss: 167870.4219
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9867; val_auprc_score: 0.9971; val_best_acc_score: 0.9734; val_best_f1_score: 0.9845; train_kl_reg_loss: 2001.6152; train_edge_recon_loss: 77607.8917; train_gene_expr_recon_loss: 89237.1484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168846.6540; train_optim_loss: 168846.6540; val_kl_reg_loss: 1968.4042; val_edge_recon_loss: 76699.7656; val_gene_expr_recon_loss: 89107.5352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167775.7031; val_optim_loss: 167775.7031

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 8 sec.
Using best model state, which was in epoch 11.

--- MODEL EVALUATION ---
Val AUROC score: 0.9834
Val AUPRC score: 0.9958
Val best accuracy score: 0.9700
Val best F1 score: 0.9825
Val gene expr MSE score: 1.0520
Duration of model training in run 3: 0 hours, 1 minutes and 10 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 107073
Number of validation edges: 11897
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9725; val_auprc_score: 0.9936; val_best_acc_score: 0.9484; val_best_f1_score: 0.9700; train_kl_reg_loss: 195.5666; train_edge_recon_loss: 101846.3583; train_gene_expr_recon_loss: 111243.7857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213285.7109; train_optim_loss: 213285.7109; val_kl_reg_loss: 195.8242; val_edge_recon_loss: 108288.3750; val_gene_expr_recon_loss: 99699.3867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208183.5938; val_optim_loss: 208183.5938
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8914; val_auprc_score: 0.9745; val_best_acc_score: 0.9117; val_best_f1_score: 0.9496; train_kl_reg_loss: 335.0295; train_edge_recon_loss: 96639.1657; train_gene_expr_recon_loss: 98365.2796; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195339.4743; train_optim_loss: 195339.4743; val_kl_reg_loss: 1006.7462; val_edge_recon_loss: 86346.4727; val_gene_expr_recon_loss: 97540.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184893.3750; val_optim_loss: 184893.3750
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9043; val_auprc_score: 0.9784; val_best_acc_score: 0.9086; val_best_f1_score: 0.9479; train_kl_reg_loss: 2367.8934; train_edge_recon_loss: 84706.6367; train_gene_expr_recon_loss: 96378.9096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183453.4386; train_optim_loss: 183453.4386; val_kl_reg_loss: 3046.0376; val_edge_recon_loss: 86014.0586; val_gene_expr_recon_loss: 95686.9492; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184747.0391; val_optim_loss: 184747.0391
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9357; val_auprc_score: 0.9874; val_best_acc_score: 0.9199; val_best_f1_score: 0.9540; train_kl_reg_loss: 2465.0821; train_edge_recon_loss: 82428.9018; train_gene_expr_recon_loss: 94842.4068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179736.3929; train_optim_loss: 179736.3929; val_kl_reg_loss: 1880.8218; val_edge_recon_loss: 79981.7422; val_gene_expr_recon_loss: 95184.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177047.5000; val_optim_loss: 177047.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9564; val_auprc_score: 0.9907; val_best_acc_score: 0.9335; val_best_f1_score: 0.9617; train_kl_reg_loss: 1891.0234; train_edge_recon_loss: 80673.2310; train_gene_expr_recon_loss: 94119.9927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176684.2478; train_optim_loss: 176684.2478; val_kl_reg_loss: 2078.5470; val_edge_recon_loss: 80114.5156; val_gene_expr_recon_loss: 93183.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175376.4922; val_optim_loss: 175376.4922
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9691; val_auprc_score: 0.9933; val_best_acc_score: 0.9489; val_best_f1_score: 0.9704; train_kl_reg_loss: 2192.7629; train_edge_recon_loss: 79953.5061; train_gene_expr_recon_loss: 93409.8705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175556.1362; train_optim_loss: 175556.1362; val_kl_reg_loss: 2135.8970; val_edge_recon_loss: 78118.8203; val_gene_expr_recon_loss: 92597.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172851.9688; val_optim_loss: 172851.9688
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9752; val_auprc_score: 0.9944; val_best_acc_score: 0.9545; val_best_f1_score: 0.9735; train_kl_reg_loss: 2104.4993; train_edge_recon_loss: 78620.1066; train_gene_expr_recon_loss: 92780.0268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173504.6317; train_optim_loss: 173504.6317; val_kl_reg_loss: 2079.0730; val_edge_recon_loss: 77954.7812; val_gene_expr_recon_loss: 92519.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172553.3594; val_optim_loss: 172553.3594
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9792; val_auprc_score: 0.9955; val_best_acc_score: 0.9595; val_best_f1_score: 0.9765; train_kl_reg_loss: 2085.2241; train_edge_recon_loss: 77727.9241; train_gene_expr_recon_loss: 91938.2930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171751.4397; train_optim_loss: 171751.4397; val_kl_reg_loss: 2039.9669; val_edge_recon_loss: 78326.6719; val_gene_expr_recon_loss: 91796.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172163.3281; val_optim_loss: 172163.3281
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9804; val_auprc_score: 0.9952; val_best_acc_score: 0.9629; val_best_f1_score: 0.9784; train_kl_reg_loss: 2074.3604; train_edge_recon_loss: 76836.0469; train_gene_expr_recon_loss: 91403.1975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170313.6060; train_optim_loss: 170313.6060; val_kl_reg_loss: 2038.6732; val_edge_recon_loss: 79894.3828; val_gene_expr_recon_loss: 91633.6055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173566.6562; val_optim_loss: 173566.6562
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9801; val_auprc_score: 0.9951; val_best_acc_score: 0.9650; val_best_f1_score: 0.9796; train_kl_reg_loss: 2060.3712; train_edge_recon_loss: 78505.2081; train_gene_expr_recon_loss: 90990.0586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171555.6395; train_optim_loss: 171555.6395; val_kl_reg_loss: 2042.9994; val_edge_recon_loss: 79773.0664; val_gene_expr_recon_loss: 90883.4414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172699.5078; val_optim_loss: 172699.5078
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9809; val_auprc_score: 0.9954; val_best_acc_score: 0.9674; val_best_f1_score: 0.9811; train_kl_reg_loss: 2040.7630; train_edge_recon_loss: 76163.9023; train_gene_expr_recon_loss: 90753.0251; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168957.6897; train_optim_loss: 168957.6897; val_kl_reg_loss: 2011.8981; val_edge_recon_loss: 75326.7656; val_gene_expr_recon_loss: 90787.1836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168125.8438; val_optim_loss: 168125.8438
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9829; val_auprc_score: 0.9955; val_best_acc_score: 0.9703; val_best_f1_score: 0.9827; train_kl_reg_loss: 2045.2498; train_edge_recon_loss: 77791.9939; train_gene_expr_recon_loss: 90348.1613; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170185.4062; train_optim_loss: 170185.4062; val_kl_reg_loss: 1994.3855; val_edge_recon_loss: 76446.7852; val_gene_expr_recon_loss: 90212.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168653.1797; val_optim_loss: 168653.1797
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9815; val_auprc_score: 0.9960; val_best_acc_score: 0.9718; val_best_f1_score: 0.9837; train_kl_reg_loss: 2008.8835; train_edge_recon_loss: 76263.1490; train_gene_expr_recon_loss: 89826.3398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168098.3728; train_optim_loss: 168098.3728; val_kl_reg_loss: 1983.7094; val_edge_recon_loss: 76986.8203; val_gene_expr_recon_loss: 89941.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168912.3594; val_optim_loss: 168912.3594
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9847; val_auprc_score: 0.9962; val_best_acc_score: 0.9730; val_best_f1_score: 0.9844; train_kl_reg_loss: 2027.0240; train_edge_recon_loss: 76976.9626; train_gene_expr_recon_loss: 89649.5848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168653.5725; train_optim_loss: 168653.5725; val_kl_reg_loss: 1979.0315; val_edge_recon_loss: 74636.1250; val_gene_expr_recon_loss: 89209.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165824.3281; val_optim_loss: 165824.3281
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9835; val_auprc_score: 0.9963; val_best_acc_score: 0.9735; val_best_f1_score: 0.9846; train_kl_reg_loss: 2008.3768; train_edge_recon_loss: 76670.2093; train_gene_expr_recon_loss: 89332.1847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168010.7701; train_optim_loss: 168010.7701; val_kl_reg_loss: 1976.1259; val_edge_recon_loss: 77058.2383; val_gene_expr_recon_loss: 88900.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167934.9844; val_optim_loss: 167934.9844
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9881; val_auprc_score: 0.9967; val_best_acc_score: 0.9744; val_best_f1_score: 0.9851; train_kl_reg_loss: 2002.4243; train_edge_recon_loss: 76689.7377; train_gene_expr_recon_loss: 89170.0670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167862.2288; train_optim_loss: 167862.2288; val_kl_reg_loss: 2003.7574; val_edge_recon_loss: 78158.9102; val_gene_expr_recon_loss: 89475.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169637.9453; val_optim_loss: 169637.9453
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9871; val_auprc_score: 0.9972; val_best_acc_score: 0.9749; val_best_f1_score: 0.9854; train_kl_reg_loss: 1990.4987; train_edge_recon_loss: 77034.3008; train_gene_expr_recon_loss: 89087.2734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168112.0759; train_optim_loss: 168112.0759; val_kl_reg_loss: 1978.2394; val_edge_recon_loss: 76378.7969; val_gene_expr_recon_loss: 89218.2461; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167575.2812; val_optim_loss: 167575.2812

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9866; val_auprc_score: 0.9969; val_best_acc_score: 0.9739; val_best_f1_score: 0.9847; train_kl_reg_loss: 1991.7948; train_edge_recon_loss: 75798.2665; train_gene_expr_recon_loss: 88965.2573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166755.3170; train_optim_loss: 166755.3170; val_kl_reg_loss: 1945.6415; val_edge_recon_loss: 78154.6641; val_gene_expr_recon_loss: 89036.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169136.8750; val_optim_loss: 169136.8750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9846; val_auprc_score: 0.9955; val_best_acc_score: 0.9767; val_best_f1_score: 0.9865; train_kl_reg_loss: 1979.6658; train_edge_recon_loss: 77053.8387; train_gene_expr_recon_loss: 88849.3783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167882.8850; train_optim_loss: 167882.8850; val_kl_reg_loss: 1946.4213; val_edge_recon_loss: 74605.3359; val_gene_expr_recon_loss: 88785.9258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165337.6875; val_optim_loss: 165337.6875
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9880; val_auprc_score: 0.9974; val_best_acc_score: 0.9750; val_best_f1_score: 0.9854; train_kl_reg_loss: 1979.5336; train_edge_recon_loss: 76707.0179; train_gene_expr_recon_loss: 88783.4704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167470.0234; train_optim_loss: 167470.0234; val_kl_reg_loss: 1948.7266; val_edge_recon_loss: 77409.7461; val_gene_expr_recon_loss: 89025.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168383.9141; val_optim_loss: 168383.9141
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9854; val_auprc_score: 0.9961; val_best_acc_score: 0.9746; val_best_f1_score: 0.9851; train_kl_reg_loss: 1972.9699; train_edge_recon_loss: 75589.5497; train_gene_expr_recon_loss: 88774.8717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166337.3917; train_optim_loss: 166337.3917; val_kl_reg_loss: 1941.9147; val_edge_recon_loss: 79041.5977; val_gene_expr_recon_loss: 89369.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170353.0469; val_optim_loss: 170353.0469
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9852; val_auprc_score: 0.9965; val_best_acc_score: 0.9762; val_best_f1_score: 0.9861; train_kl_reg_loss: 1968.1380; train_edge_recon_loss: 77769.1752; train_gene_expr_recon_loss: 88803.8041; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168541.1183; train_optim_loss: 168541.1183; val_kl_reg_loss: 1943.9141; val_edge_recon_loss: 76651.7070; val_gene_expr_recon_loss: 88614.6523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167210.2734; val_optim_loss: 167210.2734

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9879; val_auprc_score: 0.9973; val_best_acc_score: 0.9757; val_best_f1_score: 0.9858; train_kl_reg_loss: 1979.7474; train_edge_recon_loss: 76699.9135; train_gene_expr_recon_loss: 88858.3315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167537.9944; train_optim_loss: 167537.9944; val_kl_reg_loss: 1942.5011; val_edge_recon_loss: 76444.2070; val_gene_expr_recon_loss: 88724.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167111.0938; val_optim_loss: 167111.0938
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9854; val_auprc_score: 0.9967; val_best_acc_score: 0.9739; val_best_f1_score: 0.9848; train_kl_reg_loss: 1978.9624; train_edge_recon_loss: 75598.8348; train_gene_expr_recon_loss: 88771.3331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166349.1295; train_optim_loss: 166349.1295; val_kl_reg_loss: 1954.1348; val_edge_recon_loss: 75028.0781; val_gene_expr_recon_loss: 88731.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165713.3906; val_optim_loss: 165713.3906
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9874; val_auprc_score: 0.9967; val_best_acc_score: 0.9740; val_best_f1_score: 0.9849; train_kl_reg_loss: 1976.2169; train_edge_recon_loss: 76710.3058; train_gene_expr_recon_loss: 88721.3973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167407.9219; train_optim_loss: 167407.9219; val_kl_reg_loss: 1939.0024; val_edge_recon_loss: 76629.9609; val_gene_expr_recon_loss: 88555.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167123.9922; val_optim_loss: 167123.9922

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 40 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9880
Val AUPRC score: 0.9956
Val best accuracy score: 0.9763
Val best F1 score: 0.9862
Val gene expr MSE score: 1.0088
Duration of model training in run 4: 0 hours, 1 minutes and 42 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 159885
Number of validation edges: 17764
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9498; val_auprc_score: 0.9891; val_best_acc_score: 0.9282; val_best_f1_score: 0.9587; train_kl_reg_loss: 152.0294; train_edge_recon_loss: 101592.3008; train_gene_expr_recon_loss: 105904.1066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207648.4359; train_optim_loss: 207648.4359; val_kl_reg_loss: 277.7070; val_edge_recon_loss: 94593.9505; val_gene_expr_recon_loss: 96455.5052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191327.1667; val_optim_loss: 191327.1667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9116; val_auprc_score: 0.9801; val_best_acc_score: 0.9134; val_best_f1_score: 0.9507; train_kl_reg_loss: 1927.7068; train_edge_recon_loss: 86521.7777; train_gene_expr_recon_loss: 95956.9523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184406.4336; train_optim_loss: 184406.4336; val_kl_reg_loss: 2971.3190; val_edge_recon_loss: 84854.3385; val_gene_expr_recon_loss: 94234.3932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182060.0521; val_optim_loss: 182060.0521
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9564; val_auprc_score: 0.9904; val_best_acc_score: 0.9397; val_best_f1_score: 0.9653; train_kl_reg_loss: 2225.6796; train_edge_recon_loss: 81774.2859; train_gene_expr_recon_loss: 94323.2715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178323.2375; train_optim_loss: 178323.2375; val_kl_reg_loss: 1866.7422; val_edge_recon_loss: 79202.1979; val_gene_expr_recon_loss: 92796.2057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173865.1458; val_optim_loss: 173865.1458
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9743; val_auprc_score: 0.9939; val_best_acc_score: 0.9550; val_best_f1_score: 0.9737; train_kl_reg_loss: 2084.1365; train_edge_recon_loss: 79412.3332; train_gene_expr_recon_loss: 93032.8328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174529.3031; train_optim_loss: 174529.3031; val_kl_reg_loss: 2091.4192; val_edge_recon_loss: 79444.4115; val_gene_expr_recon_loss: 91630.8542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173166.6875; val_optim_loss: 173166.6875
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9808; val_auprc_score: 0.9948; val_best_acc_score: 0.9643; val_best_f1_score: 0.9792; train_kl_reg_loss: 2080.4986; train_edge_recon_loss: 78009.9059; train_gene_expr_recon_loss: 92166.0270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172256.4312; train_optim_loss: 172256.4312; val_kl_reg_loss: 1990.9598; val_edge_recon_loss: 76915.4531; val_gene_expr_recon_loss: 90750.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169657.4062; val_optim_loss: 169657.4062
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9837; val_auprc_score: 0.9961; val_best_acc_score: 0.9705; val_best_f1_score: 0.9829; train_kl_reg_loss: 2034.6034; train_edge_recon_loss: 77218.4855; train_gene_expr_recon_loss: 91222.5945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170475.6789; train_optim_loss: 170475.6789; val_kl_reg_loss: 1985.8276; val_edge_recon_loss: 76115.1927; val_gene_expr_recon_loss: 90203.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168304.2500; val_optim_loss: 168304.2500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9856; val_auprc_score: 0.9969; val_best_acc_score: 0.9722; val_best_f1_score: 0.9839; train_kl_reg_loss: 2004.7084; train_edge_recon_loss: 77299.8957; train_gene_expr_recon_loss: 90515.1785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169819.7844; train_optim_loss: 169819.7844; val_kl_reg_loss: 1948.5122; val_edge_recon_loss: 76299.7448; val_gene_expr_recon_loss: 89488.0052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167736.2604; val_optim_loss: 167736.2604
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9887; val_auprc_score: 0.9975; val_best_acc_score: 0.9758; val_best_f1_score: 0.9859; train_kl_reg_loss: 1991.5638; train_edge_recon_loss: 77151.6660; train_gene_expr_recon_loss: 89906.7117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169049.9422; train_optim_loss: 169049.9422; val_kl_reg_loss: 1969.5031; val_edge_recon_loss: 78874.5286; val_gene_expr_recon_loss: 89495.2865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170339.3125; val_optim_loss: 170339.3125
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9880; val_auprc_score: 0.9974; val_best_acc_score: 0.9768; val_best_f1_score: 0.9864; train_kl_reg_loss: 1976.7332; train_edge_recon_loss: 77160.1879; train_gene_expr_recon_loss: 89555.3633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168692.2836; train_optim_loss: 168692.2836; val_kl_reg_loss: 1956.7932; val_edge_recon_loss: 77841.6458; val_gene_expr_recon_loss: 88626.2370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168424.6771; val_optim_loss: 168424.6771
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9837; val_auprc_score: 0.9954; val_best_acc_score: 0.9754; val_best_f1_score: 0.9857; train_kl_reg_loss: 1967.2362; train_edge_recon_loss: 77376.9012; train_gene_expr_recon_loss: 89092.5301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168436.6664; train_optim_loss: 168436.6664; val_kl_reg_loss: 1906.2992; val_edge_recon_loss: 77533.7995; val_gene_expr_recon_loss: 88031.6120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167471.7135; val_optim_loss: 167471.7135
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9892; val_auprc_score: 0.9977; val_best_acc_score: 0.9789; val_best_f1_score: 0.9877; train_kl_reg_loss: 1951.9018; train_edge_recon_loss: 76403.0418; train_gene_expr_recon_loss: 88809.0809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167164.0250; train_optim_loss: 167164.0250; val_kl_reg_loss: 1916.5671; val_edge_recon_loss: 77411.1406; val_gene_expr_recon_loss: 88127.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167454.9896; val_optim_loss: 167454.9896
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9871; val_auprc_score: 0.9970; val_best_acc_score: 0.9784; val_best_f1_score: 0.9874; train_kl_reg_loss: 1950.3143; train_edge_recon_loss: 76785.8926; train_gene_expr_recon_loss: 88708.2402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167444.4469; train_optim_loss: 167444.4469; val_kl_reg_loss: 1913.9447; val_edge_recon_loss: 78038.8568; val_gene_expr_recon_loss: 87516.3620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167469.1667; val_optim_loss: 167469.1667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9877; val_auprc_score: 0.9972; val_best_acc_score: 0.9788; val_best_f1_score: 0.9876; train_kl_reg_loss: 1938.1698; train_edge_recon_loss: 77454.8129; train_gene_expr_recon_loss: 88360.1906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167753.1703; train_optim_loss: 167753.1703; val_kl_reg_loss: 1917.0709; val_edge_recon_loss: 76294.6745; val_gene_expr_recon_loss: 87436.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165648.6510; val_optim_loss: 165648.6510
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9884; val_auprc_score: 0.9973; val_best_acc_score: 0.9802; val_best_f1_score: 0.9885; train_kl_reg_loss: 1943.0678; train_edge_recon_loss: 77690.4605; train_gene_expr_recon_loss: 88065.5617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167699.0914; train_optim_loss: 167699.0914; val_kl_reg_loss: 1885.6354; val_edge_recon_loss: 76610.0312; val_gene_expr_recon_loss: 87086.5729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165582.2396; val_optim_loss: 165582.2396
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9892; val_auprc_score: 0.9976; val_best_acc_score: 0.9795; val_best_f1_score: 0.9881; train_kl_reg_loss: 1924.6433; train_edge_recon_loss: 76660.7730; train_gene_expr_recon_loss: 87902.5945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166488.0117; train_optim_loss: 166488.0117; val_kl_reg_loss: 1927.5271; val_edge_recon_loss: 77601.9948; val_gene_expr_recon_loss: 86883.0260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166412.5521; val_optim_loss: 166412.5521
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9870; val_auprc_score: 0.9965; val_best_acc_score: 0.9797; val_best_f1_score: 0.9882; train_kl_reg_loss: 1933.0384; train_edge_recon_loss: 77380.0512; train_gene_expr_recon_loss: 87550.1375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166863.2273; train_optim_loss: 166863.2273; val_kl_reg_loss: 1887.9485; val_edge_recon_loss: 77426.4870; val_gene_expr_recon_loss: 87089.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166404.0990; val_optim_loss: 166404.0990
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9895; val_auprc_score: 0.9960; val_best_acc_score: 0.9818; val_best_f1_score: 0.9894; train_kl_reg_loss: 1923.5174; train_edge_recon_loss: 76872.9199; train_gene_expr_recon_loss: 87458.3371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166254.7758; train_optim_loss: 166254.7758; val_kl_reg_loss: 1870.1033; val_edge_recon_loss: 75548.3958; val_gene_expr_recon_loss: 86848.3385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164266.8385; val_optim_loss: 164266.8385
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9889; val_auprc_score: 0.9971; val_best_acc_score: 0.9804; val_best_f1_score: 0.9886; train_kl_reg_loss: 1917.6037; train_edge_recon_loss: 76606.8660; train_gene_expr_recon_loss: 87214.7051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165739.1750; train_optim_loss: 165739.1750; val_kl_reg_loss: 1891.2171; val_edge_recon_loss: 76705.3568; val_gene_expr_recon_loss: 86600.8177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165197.3958; val_optim_loss: 165197.3958
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9884; val_auprc_score: 0.9974; val_best_acc_score: 0.9816; val_best_f1_score: 0.9893; train_kl_reg_loss: 1916.5078; train_edge_recon_loss: 77386.6559; train_gene_expr_recon_loss: 87067.8387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166371.0016; train_optim_loss: 166371.0016; val_kl_reg_loss: 1887.6354; val_edge_recon_loss: 73625.4974; val_gene_expr_recon_loss: 86337.8229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161850.9531; val_optim_loss: 161850.9531
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9897; val_auprc_score: 0.9971; val_best_acc_score: 0.9823; val_best_f1_score: 0.9897; train_kl_reg_loss: 1918.2425; train_edge_recon_loss: 76102.8727; train_gene_expr_recon_loss: 87009.0352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165030.1516; train_optim_loss: 165030.1516; val_kl_reg_loss: 1907.8301; val_edge_recon_loss: 77225.9531; val_gene_expr_recon_loss: 86195.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165329.6198; val_optim_loss: 165329.6198
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9889; val_auprc_score: 0.9966; val_best_acc_score: 0.9815; val_best_f1_score: 0.9892; train_kl_reg_loss: 1919.8277; train_edge_recon_loss: 76491.8637; train_gene_expr_recon_loss: 86949.9051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165361.5945; train_optim_loss: 165361.5945; val_kl_reg_loss: 1928.0358; val_edge_recon_loss: 75097.5339; val_gene_expr_recon_loss: 86379.2604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163404.8281; val_optim_loss: 163404.8281
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9909; val_auprc_score: 0.9977; val_best_acc_score: 0.9831; val_best_f1_score: 0.9902; train_kl_reg_loss: 1920.5424; train_edge_recon_loss: 77000.4152; train_gene_expr_recon_loss: 86675.3992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165596.3563; train_optim_loss: 165596.3563; val_kl_reg_loss: 1883.7527; val_edge_recon_loss: 75949.0208; val_gene_expr_recon_loss: 86042.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163875.3125; val_optim_loss: 163875.3125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9894; val_auprc_score: 0.9968; val_best_acc_score: 0.9822; val_best_f1_score: 0.9897; train_kl_reg_loss: 1912.4901; train_edge_recon_loss: 76782.5379; train_gene_expr_recon_loss: 86501.5773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165196.6070; train_optim_loss: 165196.6070; val_kl_reg_loss: 1884.2149; val_edge_recon_loss: 73338.8542; val_gene_expr_recon_loss: 86018.2370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161241.3021; val_optim_loss: 161241.3021
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9892; val_auprc_score: 0.9974; val_best_acc_score: 0.9809; val_best_f1_score: 0.9889; train_kl_reg_loss: 1915.0512; train_edge_recon_loss: 76490.9617; train_gene_expr_recon_loss: 86481.5637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164887.5758; train_optim_loss: 164887.5758; val_kl_reg_loss: 1887.0750; val_edge_recon_loss: 76653.2214; val_gene_expr_recon_loss: 85602.7135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164143.0104; val_optim_loss: 164143.0104
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9898; val_auprc_score: 0.9973; val_best_acc_score: 0.9820; val_best_f1_score: 0.9896; train_kl_reg_loss: 1912.9263; train_edge_recon_loss: 76272.7980; train_gene_expr_recon_loss: 86483.2070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164668.9320; train_optim_loss: 164668.9320; val_kl_reg_loss: 1883.2068; val_edge_recon_loss: 75243.1224; val_gene_expr_recon_loss: 85901.4427; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163027.7708; val_optim_loss: 163027.7708
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9904; val_auprc_score: 0.9974; val_best_acc_score: 0.9824; val_best_f1_score: 0.9898; train_kl_reg_loss: 1909.1946; train_edge_recon_loss: 76163.0816; train_gene_expr_recon_loss: 86371.1617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164443.4375; train_optim_loss: 164443.4375; val_kl_reg_loss: 1879.5540; val_edge_recon_loss: 76691.9766; val_gene_expr_recon_loss: 85512.7396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164084.2708; val_optim_loss: 164084.2708

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9902; val_auprc_score: 0.9971; val_best_acc_score: 0.9818; val_best_f1_score: 0.9893; train_kl_reg_loss: 1903.3536; train_edge_recon_loss: 76749.8875; train_gene_expr_recon_loss: 86374.3004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165027.5422; train_optim_loss: 165027.5422; val_kl_reg_loss: 1876.7961; val_edge_recon_loss: 75593.7109; val_gene_expr_recon_loss: 85653.5182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163124.0208; val_optim_loss: 163124.0208
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9894; val_auprc_score: 0.9974; val_best_acc_score: 0.9825; val_best_f1_score: 0.9898; train_kl_reg_loss: 1905.1175; train_edge_recon_loss: 76132.9785; train_gene_expr_recon_loss: 86295.8238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164333.9172; train_optim_loss: 164333.9172; val_kl_reg_loss: 1882.5938; val_edge_recon_loss: 75170.0885; val_gene_expr_recon_loss: 86018.9427; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163071.6302; val_optim_loss: 163071.6302
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9917; val_auprc_score: 0.9981; val_best_acc_score: 0.9828; val_best_f1_score: 0.9900; train_kl_reg_loss: 1909.0944; train_edge_recon_loss: 76183.1867; train_gene_expr_recon_loss: 86469.5520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164561.8336; train_optim_loss: 164561.8336; val_kl_reg_loss: 1883.7795; val_edge_recon_loss: 75047.2604; val_gene_expr_recon_loss: 85800.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162731.2396; val_optim_loss: 162731.2396

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 9 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
Val AUROC score: 0.9910
Val AUPRC score: 0.9978
Val best accuracy score: 0.9824
Val best F1 score: 0.9897
Val gene expr MSE score: 0.9024
Duration of model training in run 5: 0 hours, 3 minutes and 12 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 159885
Number of validation edges: 17764
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9600; val_auprc_score: 0.9919; val_best_acc_score: 0.9375; val_best_f1_score: 0.9638; train_kl_reg_loss: 154.6994; train_edge_recon_loss: 101412.4680; train_gene_expr_recon_loss: 104855.7785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206422.9461; train_optim_loss: 206422.9461; val_kl_reg_loss: 189.9675; val_edge_recon_loss: 94796.5026; val_gene_expr_recon_loss: 97627.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192614.2396; val_optim_loss: 192614.2396
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9164; val_auprc_score: 0.9820; val_best_acc_score: 0.9189; val_best_f1_score: 0.9539; train_kl_reg_loss: 1644.4315; train_edge_recon_loss: 88471.9316; train_gene_expr_recon_loss: 95243.8352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185360.1984; train_optim_loss: 185360.1984; val_kl_reg_loss: 3120.6292; val_edge_recon_loss: 81526.2135; val_gene_expr_recon_loss: 95535.1849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180182.0260; val_optim_loss: 180182.0260
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9504; val_auprc_score: 0.9879; val_best_acc_score: 0.9323; val_best_f1_score: 0.9609; train_kl_reg_loss: 2328.1826; train_edge_recon_loss: 82171.3590; train_gene_expr_recon_loss: 93339.7309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177839.2727; train_optim_loss: 177839.2727; val_kl_reg_loss: 1833.4063; val_edge_recon_loss: 81603.3177; val_gene_expr_recon_loss: 94262.7135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177699.4323; val_optim_loss: 177699.4323
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9723; val_auprc_score: 0.9939; val_best_acc_score: 0.9566; val_best_f1_score: 0.9749; train_kl_reg_loss: 2068.7934; train_edge_recon_loss: 79697.7031; train_gene_expr_recon_loss: 92432.9129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174199.4070; train_optim_loss: 174199.4070; val_kl_reg_loss: 2109.2881; val_edge_recon_loss: 77855.8672; val_gene_expr_recon_loss: 93260.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173225.2812; val_optim_loss: 173225.2812
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9791; val_auprc_score: 0.9953; val_best_acc_score: 0.9612; val_best_f1_score: 0.9775; train_kl_reg_loss: 2104.5027; train_edge_recon_loss: 77963.4461; train_gene_expr_recon_loss: 91572.8609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171640.8102; train_optim_loss: 171640.8102; val_kl_reg_loss: 2018.0402; val_edge_recon_loss: 76965.2917; val_gene_expr_recon_loss: 92245.2370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171228.5677; val_optim_loss: 171228.5677
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9835; val_auprc_score: 0.9961; val_best_acc_score: 0.9684; val_best_f1_score: 0.9816; train_kl_reg_loss: 2024.5393; train_edge_recon_loss: 79034.8441; train_gene_expr_recon_loss: 90673.7848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171733.1656; train_optim_loss: 171733.1656; val_kl_reg_loss: 2029.3998; val_edge_recon_loss: 77106.2917; val_gene_expr_recon_loss: 91439.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170575.2188; val_optim_loss: 170575.2188
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9833; val_auprc_score: 0.9954; val_best_acc_score: 0.9724; val_best_f1_score: 0.9839; train_kl_reg_loss: 2000.0279; train_edge_recon_loss: 77582.4113; train_gene_expr_recon_loss: 90002.8719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169585.3109; train_optim_loss: 169585.3109; val_kl_reg_loss: 2003.3926; val_edge_recon_loss: 77488.5339; val_gene_expr_recon_loss: 90622.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170114.0156; val_optim_loss: 170114.0156
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9867; val_auprc_score: 0.9966; val_best_acc_score: 0.9755; val_best_f1_score: 0.9857; train_kl_reg_loss: 1995.7705; train_edge_recon_loss: 77397.3434; train_gene_expr_recon_loss: 89465.4520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168858.5648; train_optim_loss: 168858.5648; val_kl_reg_loss: 1986.1946; val_edge_recon_loss: 76395.0417; val_gene_expr_recon_loss: 90405.7604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168787.0000; val_optim_loss: 168787.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9885; val_auprc_score: 0.9973; val_best_acc_score: 0.9778; val_best_f1_score: 0.9870; train_kl_reg_loss: 1984.4002; train_edge_recon_loss: 76897.2812; train_gene_expr_recon_loss: 89092.7238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167974.4070; train_optim_loss: 167974.4070; val_kl_reg_loss: 1938.7931; val_edge_recon_loss: 76806.0859; val_gene_expr_recon_loss: 90158.9948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168903.8750; val_optim_loss: 168903.8750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9865; val_auprc_score: 0.9965; val_best_acc_score: 0.9774; val_best_f1_score: 0.9869; train_kl_reg_loss: 1952.4661; train_edge_recon_loss: 77530.3746; train_gene_expr_recon_loss: 88696.6508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168179.4898; train_optim_loss: 168179.4898; val_kl_reg_loss: 1908.7262; val_edge_recon_loss: 75048.9974; val_gene_expr_recon_loss: 89838.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166796.7188; val_optim_loss: 166796.7188
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9859; val_auprc_score: 0.9963; val_best_acc_score: 0.9778; val_best_f1_score: 0.9871; train_kl_reg_loss: 1962.5967; train_edge_recon_loss: 76903.9539; train_gene_expr_recon_loss: 88348.4285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167214.9797; train_optim_loss: 167214.9797; val_kl_reg_loss: 1944.0536; val_edge_recon_loss: 75786.9375; val_gene_expr_recon_loss: 89406.1068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167137.0938; val_optim_loss: 167137.0938
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9861; val_auprc_score: 0.9957; val_best_acc_score: 0.9792; val_best_f1_score: 0.9879; train_kl_reg_loss: 1948.4154; train_edge_recon_loss: 77082.0262; train_gene_expr_recon_loss: 88053.0500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167083.4930; train_optim_loss: 167083.4930; val_kl_reg_loss: 1942.5282; val_edge_recon_loss: 77194.0625; val_gene_expr_recon_loss: 89163.9974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168300.5885; val_optim_loss: 168300.5885
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9893; val_auprc_score: 0.9974; val_best_acc_score: 0.9817; val_best_f1_score: 0.9893; train_kl_reg_loss: 1937.7422; train_edge_recon_loss: 76880.9301; train_gene_expr_recon_loss: 87814.4816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166633.1531; train_optim_loss: 166633.1531; val_kl_reg_loss: 1893.1518; val_edge_recon_loss: 77215.3802; val_gene_expr_recon_loss: 89358.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168466.8646; val_optim_loss: 168466.8646

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9878; val_auprc_score: 0.9960; val_best_acc_score: 0.9792; val_best_f1_score: 0.9878; train_kl_reg_loss: 1927.8457; train_edge_recon_loss: 76517.0723; train_gene_expr_recon_loss: 87627.0965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166072.0117; train_optim_loss: 166072.0117; val_kl_reg_loss: 1911.4470; val_edge_recon_loss: 79706.4896; val_gene_expr_recon_loss: 88655.6745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170273.6146; val_optim_loss: 170273.6146
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9859; val_auprc_score: 0.9968; val_best_acc_score: 0.9794; val_best_f1_score: 0.9880; train_kl_reg_loss: 1927.9969; train_edge_recon_loss: 76463.6457; train_gene_expr_recon_loss: 87597.3496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165988.9898; train_optim_loss: 165988.9898; val_kl_reg_loss: 1902.7747; val_edge_recon_loss: 77452.8984; val_gene_expr_recon_loss: 88774.9349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168130.6094; val_optim_loss: 168130.6094
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9902; val_auprc_score: 0.9976; val_best_acc_score: 0.9809; val_best_f1_score: 0.9889; train_kl_reg_loss: 1926.1837; train_edge_recon_loss: 76828.7652; train_gene_expr_recon_loss: 87325.0867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166080.0375; train_optim_loss: 166080.0375; val_kl_reg_loss: 1908.2168; val_edge_recon_loss: 76215.0807; val_gene_expr_recon_loss: 88537.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166660.7240; val_optim_loss: 166660.7240
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9877; val_auprc_score: 0.9970; val_best_acc_score: 0.9798; val_best_f1_score: 0.9883; train_kl_reg_loss: 1927.7444; train_edge_recon_loss: 76654.3242; train_gene_expr_recon_loss: 87434.1082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166016.1766; train_optim_loss: 166016.1766; val_kl_reg_loss: 1903.5181; val_edge_recon_loss: 75523.9948; val_gene_expr_recon_loss: 88657.4870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166085.0000; val_optim_loss: 166085.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9877; val_auprc_score: 0.9965; val_best_acc_score: 0.9807; val_best_f1_score: 0.9888; train_kl_reg_loss: 1932.4815; train_edge_recon_loss: 77299.6984; train_gene_expr_recon_loss: 87467.1438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166699.3227; train_optim_loss: 166699.3227; val_kl_reg_loss: 1907.0050; val_edge_recon_loss: 73528.3255; val_gene_expr_recon_loss: 88331.9792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163767.3021; val_optim_loss: 163767.3021
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9875; val_auprc_score: 0.9970; val_best_acc_score: 0.9785; val_best_f1_score: 0.9875; train_kl_reg_loss: 1930.3324; train_edge_recon_loss: 76577.8469; train_gene_expr_recon_loss: 87533.0918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166041.2711; train_optim_loss: 166041.2711; val_kl_reg_loss: 1901.8783; val_edge_recon_loss: 77028.2969; val_gene_expr_recon_loss: 88684.0964; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167614.2760; val_optim_loss: 167614.2760
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9881; val_auprc_score: 0.9971; val_best_acc_score: 0.9799; val_best_f1_score: 0.9883; train_kl_reg_loss: 1923.0232; train_edge_recon_loss: 76695.8516; train_gene_expr_recon_loss: 87344.9785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165963.8555; train_optim_loss: 165963.8555; val_kl_reg_loss: 1903.3926; val_edge_recon_loss: 75499.6406; val_gene_expr_recon_loss: 87932.9271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165335.9583; val_optim_loss: 165335.9583
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9885; val_auprc_score: 0.9968; val_best_acc_score: 0.9814; val_best_f1_score: 0.9892; train_kl_reg_loss: 1928.6876; train_edge_recon_loss: 77065.9000; train_gene_expr_recon_loss: 87387.8293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166382.4156; train_optim_loss: 166382.4156; val_kl_reg_loss: 1896.4263; val_edge_recon_loss: 74845.3177; val_gene_expr_recon_loss: 88400.5729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165142.3125; val_optim_loss: 165142.3125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9875; val_auprc_score: 0.9971; val_best_acc_score: 0.9796; val_best_f1_score: 0.9881; train_kl_reg_loss: 1917.5056; train_edge_recon_loss: 76591.9785; train_gene_expr_recon_loss: 87372.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165881.6977; train_optim_loss: 165881.6977; val_kl_reg_loss: 1899.8090; val_edge_recon_loss: 75326.5755; val_gene_expr_recon_loss: 88916.6510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166143.0365; val_optim_loss: 166143.0365
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9905; val_auprc_score: 0.9977; val_best_acc_score: 0.9803; val_best_f1_score: 0.9885; train_kl_reg_loss: 1922.1194; train_edge_recon_loss: 76520.5922; train_gene_expr_recon_loss: 87424.2176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165866.9281; train_optim_loss: 165866.9281; val_kl_reg_loss: 1902.1884; val_edge_recon_loss: 76282.8620; val_gene_expr_recon_loss: 88802.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166987.4062; val_optim_loss: 166987.4062
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9876; val_auprc_score: 0.9972; val_best_acc_score: 0.9787; val_best_f1_score: 0.9876; train_kl_reg_loss: 1924.5398; train_edge_recon_loss: 76444.1855; train_gene_expr_recon_loss: 87352.2391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165720.9656; train_optim_loss: 165720.9656; val_kl_reg_loss: 1903.3146; val_edge_recon_loss: 75487.3438; val_gene_expr_recon_loss: 88482.4818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165873.1406; val_optim_loss: 165873.1406

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 32 sec.
Using best model state, which was in epoch 18.

--- MODEL EVALUATION ---
Val AUROC score: 0.9888
Val AUPRC score: 0.9970
Val best accuracy score: 0.9813
Val best F1 score: 0.9891
Val gene expr MSE score: 1.0106
Duration of model training in run 6: 0 hours, 2 minutes and 35 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 212411
Number of validation edges: 23601
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9030; val_auprc_score: 0.9782; val_best_acc_score: 0.9139; val_best_f1_score: 0.9508; train_kl_reg_loss: 250.8689; train_edge_recon_loss: 98830.7377; train_gene_expr_recon_loss: 103072.8053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202154.4117; train_optim_loss: 202154.4117; val_kl_reg_loss: 1129.9309; val_edge_recon_loss: 87171.9375; val_gene_expr_recon_loss: 95858.2552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184160.1146; val_optim_loss: 184160.1146
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9362; val_auprc_score: 0.9857; val_best_acc_score: 0.9260; val_best_f1_score: 0.9576; train_kl_reg_loss: 2474.0121; train_edge_recon_loss: 83819.2614; train_gene_expr_recon_loss: 93763.8798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180057.1532; train_optim_loss: 180057.1532; val_kl_reg_loss: 1910.3007; val_edge_recon_loss: 81103.4557; val_gene_expr_recon_loss: 93493.1224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176506.8802; val_optim_loss: 176506.8802
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9783; val_auprc_score: 0.9953; val_best_acc_score: 0.9616; val_best_f1_score: 0.9777; train_kl_reg_loss: 2018.5783; train_edge_recon_loss: 79595.4952; train_gene_expr_recon_loss: 92123.3741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173737.4483; train_optim_loss: 173737.4483; val_kl_reg_loss: 2058.7403; val_edge_recon_loss: 77475.5859; val_gene_expr_recon_loss: 92371.8776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171906.2031; val_optim_loss: 171906.2031
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9808; val_auprc_score: 0.9956; val_best_acc_score: 0.9697; val_best_f1_score: 0.9824; train_kl_reg_loss: 2035.1123; train_edge_recon_loss: 77692.7566; train_gene_expr_recon_loss: 91219.3798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170947.2494; train_optim_loss: 170947.2494; val_kl_reg_loss: 1970.8491; val_edge_recon_loss: 75842.7135; val_gene_expr_recon_loss: 91572.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169386.1823; val_optim_loss: 169386.1823
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9832; val_auprc_score: 0.9958; val_best_acc_score: 0.9711; val_best_f1_score: 0.9832; train_kl_reg_loss: 1999.7387; train_edge_recon_loss: 78111.4928; train_gene_expr_recon_loss: 89887.2440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169998.4772; train_optim_loss: 169998.4772; val_kl_reg_loss: 1986.8611; val_edge_recon_loss: 76871.7005; val_gene_expr_recon_loss: 90332.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169191.1667; val_optim_loss: 169191.1667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9860; val_auprc_score: 0.9966; val_best_acc_score: 0.9736; val_best_f1_score: 0.9847; train_kl_reg_loss: 1984.6153; train_edge_recon_loss: 77370.9099; train_gene_expr_recon_loss: 89434.5823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168790.1082; train_optim_loss: 168790.1082; val_kl_reg_loss: 1925.7321; val_edge_recon_loss: 76883.4375; val_gene_expr_recon_loss: 89648.9505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168458.1146; val_optim_loss: 168458.1146
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9862; val_auprc_score: 0.9957; val_best_acc_score: 0.9767; val_best_f1_score: 0.9864; train_kl_reg_loss: 1962.0805; train_edge_recon_loss: 76785.3209; train_gene_expr_recon_loss: 88587.1019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167334.5024; train_optim_loss: 167334.5024; val_kl_reg_loss: 1933.2749; val_edge_recon_loss: 77731.7344; val_gene_expr_recon_loss: 89340.1771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169005.1823; val_optim_loss: 169005.1823
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9862; val_auprc_score: 0.9962; val_best_acc_score: 0.9766; val_best_f1_score: 0.9864; train_kl_reg_loss: 1953.5242; train_edge_recon_loss: 77736.3999; train_gene_expr_recon_loss: 88472.7728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168162.6965; train_optim_loss: 168162.6965; val_kl_reg_loss: 1896.9254; val_edge_recon_loss: 76307.2786; val_gene_expr_recon_loss: 88439.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166643.9583; val_optim_loss: 166643.9583
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9862; val_auprc_score: 0.9965; val_best_acc_score: 0.9782; val_best_f1_score: 0.9873; train_kl_reg_loss: 1941.9126; train_edge_recon_loss: 76831.3341; train_gene_expr_recon_loss: 87810.0231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166583.2680; train_optim_loss: 166583.2680; val_kl_reg_loss: 1959.0597; val_edge_recon_loss: 76110.5938; val_gene_expr_recon_loss: 88370.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166439.7292; val_optim_loss: 166439.7292
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9885; val_auprc_score: 0.9967; val_best_acc_score: 0.9788; val_best_f1_score: 0.9877; train_kl_reg_loss: 1928.4340; train_edge_recon_loss: 76486.5805; train_gene_expr_recon_loss: 87687.5604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166102.5757; train_optim_loss: 166102.5757; val_kl_reg_loss: 1893.2651; val_edge_recon_loss: 76826.0156; val_gene_expr_recon_loss: 88185.5521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166904.8333; val_optim_loss: 166904.8333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9880; val_auprc_score: 0.9964; val_best_acc_score: 0.9787; val_best_f1_score: 0.9876; train_kl_reg_loss: 1924.5733; train_edge_recon_loss: 76654.3239; train_gene_expr_recon_loss: 87410.3693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165989.2686; train_optim_loss: 165989.2686; val_kl_reg_loss: 1921.6849; val_edge_recon_loss: 77153.0990; val_gene_expr_recon_loss: 87690.3385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166765.1250; val_optim_loss: 166765.1250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9882; val_auprc_score: 0.9968; val_best_acc_score: 0.9793; val_best_f1_score: 0.9880; train_kl_reg_loss: 1912.3525; train_edge_recon_loss: 76750.2001; train_gene_expr_recon_loss: 86982.2788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165644.8287; train_optim_loss: 165644.8287; val_kl_reg_loss: 1872.9103; val_edge_recon_loss: 76062.3307; val_gene_expr_recon_loss: 87766.0599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165701.2969; val_optim_loss: 165701.2969
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9882; val_auprc_score: 0.9967; val_best_acc_score: 0.9788; val_best_f1_score: 0.9877; train_kl_reg_loss: 1915.7705; train_edge_recon_loss: 76709.2512; train_gene_expr_recon_loss: 86972.7488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165597.7704; train_optim_loss: 165597.7704; val_kl_reg_loss: 1914.5355; val_edge_recon_loss: 75400.2917; val_gene_expr_recon_loss: 87194.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164509.7656; val_optim_loss: 164509.7656
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9867; val_auprc_score: 0.9963; val_best_acc_score: 0.9800; val_best_f1_score: 0.9883; train_kl_reg_loss: 1911.1542; train_edge_recon_loss: 76702.0688; train_gene_expr_recon_loss: 86626.8927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165240.1154; train_optim_loss: 165240.1154; val_kl_reg_loss: 1931.0142; val_edge_recon_loss: 77633.6719; val_gene_expr_recon_loss: 87221.6432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166786.3333; val_optim_loss: 166786.3333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9901; val_auprc_score: 0.9975; val_best_acc_score: 0.9809; val_best_f1_score: 0.9889; train_kl_reg_loss: 1906.5438; train_edge_recon_loss: 76633.3957; train_gene_expr_recon_loss: 86415.0757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164955.0144; train_optim_loss: 164955.0144; val_kl_reg_loss: 1869.9253; val_edge_recon_loss: 76526.6484; val_gene_expr_recon_loss: 87076.4661; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165473.0417; val_optim_loss: 165473.0417
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9886; val_auprc_score: 0.9971; val_best_acc_score: 0.9803; val_best_f1_score: 0.9885; train_kl_reg_loss: 1908.9590; train_edge_recon_loss: 77063.2233; train_gene_expr_recon_loss: 86015.8176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164987.9994; train_optim_loss: 164987.9994; val_kl_reg_loss: 1877.3875; val_edge_recon_loss: 76789.9818; val_gene_expr_recon_loss: 86737.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165404.8750; val_optim_loss: 165404.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9894; val_auprc_score: 0.9972; val_best_acc_score: 0.9811; val_best_f1_score: 0.9890; train_kl_reg_loss: 1898.3902; train_edge_recon_loss: 76539.4958; train_gene_expr_recon_loss: 86021.8504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164459.7380; train_optim_loss: 164459.7380; val_kl_reg_loss: 1884.1895; val_edge_recon_loss: 75000.7240; val_gene_expr_recon_loss: 86856.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163741.1615; val_optim_loss: 163741.1615
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9893; val_auprc_score: 0.9974; val_best_acc_score: 0.9814; val_best_f1_score: 0.9892; train_kl_reg_loss: 1898.4557; train_edge_recon_loss: 76309.0505; train_gene_expr_recon_loss: 85858.7692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164066.2752; train_optim_loss: 164066.2752; val_kl_reg_loss: 1884.2924; val_edge_recon_loss: 76192.2422; val_gene_expr_recon_loss: 86518.6693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164595.2031; val_optim_loss: 164595.2031
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9883; val_auprc_score: 0.9966; val_best_acc_score: 0.9807; val_best_f1_score: 0.9887; train_kl_reg_loss: 1897.5867; train_edge_recon_loss: 77006.3089; train_gene_expr_recon_loss: 85878.1280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164782.0240; train_optim_loss: 164782.0240; val_kl_reg_loss: 1880.8462; val_edge_recon_loss: 78009.8724; val_gene_expr_recon_loss: 86375.9740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166266.6927; val_optim_loss: 166266.6927
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9909; val_auprc_score: 0.9977; val_best_acc_score: 0.9828; val_best_f1_score: 0.9899; train_kl_reg_loss: 1911.1806; train_edge_recon_loss: 76662.8525; train_gene_expr_recon_loss: 86020.3050; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164594.3395; train_optim_loss: 164594.3395; val_kl_reg_loss: 1887.2701; val_edge_recon_loss: 76693.6094; val_gene_expr_recon_loss: 86590.7318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165171.6094; val_optim_loss: 165171.6094

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9882; val_auprc_score: 0.9968; val_best_acc_score: 0.9807; val_best_f1_score: 0.9887; train_kl_reg_loss: 1901.0853; train_edge_recon_loss: 76030.8813; train_gene_expr_recon_loss: 85942.7614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163874.7284; train_optim_loss: 163874.7284; val_kl_reg_loss: 1882.7153; val_edge_recon_loss: 76369.5807; val_gene_expr_recon_loss: 86566.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164818.3177; val_optim_loss: 164818.3177
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9885; val_auprc_score: 0.9961; val_best_acc_score: 0.9807; val_best_f1_score: 0.9887; train_kl_reg_loss: 1898.6554; train_edge_recon_loss: 76233.6950; train_gene_expr_recon_loss: 85847.5355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163979.8852; train_optim_loss: 163979.8852; val_kl_reg_loss: 1883.4111; val_edge_recon_loss: 77376.9583; val_gene_expr_recon_loss: 86368.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165629.3333; val_optim_loss: 165629.3333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9920; val_auprc_score: 0.9983; val_best_acc_score: 0.9818; val_best_f1_score: 0.9894; train_kl_reg_loss: 1900.7170; train_edge_recon_loss: 76892.4315; train_gene_expr_recon_loss: 85768.2671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164561.4165; train_optim_loss: 164561.4165; val_kl_reg_loss: 1885.0169; val_edge_recon_loss: 75376.9453; val_gene_expr_recon_loss: 86597.4193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163859.3854; val_optim_loss: 163859.3854

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 24 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
Val AUROC score: 0.9900
Val AUPRC score: 0.9973
Val best accuracy score: 0.9821
Val best F1 score: 0.9896
Val gene expr MSE score: 0.9545
Duration of model training in run 7: 0 hours, 3 minutes and 27 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 212411
Number of validation edges: 23601
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9056; val_auprc_score: 0.9793; val_best_acc_score: 0.9176; val_best_f1_score: 0.9532; train_kl_reg_loss: 235.0273; train_edge_recon_loss: 99550.1211; train_gene_expr_recon_loss: 103361.9288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203147.0751; train_optim_loss: 203147.0751; val_kl_reg_loss: 1004.2180; val_edge_recon_loss: 86398.8568; val_gene_expr_recon_loss: 96009.8542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183412.9323; val_optim_loss: 183412.9323
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9334; val_auprc_score: 0.9858; val_best_acc_score: 0.9222; val_best_f1_score: 0.9555; train_kl_reg_loss: 2457.2909; train_edge_recon_loss: 83239.2831; train_gene_expr_recon_loss: 94652.5664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180349.1394; train_optim_loss: 180349.1394; val_kl_reg_loss: 1951.8743; val_edge_recon_loss: 81887.2083; val_gene_expr_recon_loss: 94195.5964; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178034.6823; val_optim_loss: 178034.6823
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9746; val_auprc_score: 0.9938; val_best_acc_score: 0.9557; val_best_f1_score: 0.9743; train_kl_reg_loss: 1969.7132; train_edge_recon_loss: 80316.3513; train_gene_expr_recon_loss: 92938.2650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175224.3305; train_optim_loss: 175224.3305; val_kl_reg_loss: 2045.1141; val_edge_recon_loss: 77867.3880; val_gene_expr_recon_loss: 92990.9557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172903.4583; val_optim_loss: 172903.4583
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9825; val_auprc_score: 0.9962; val_best_acc_score: 0.9674; val_best_f1_score: 0.9811; train_kl_reg_loss: 2049.0283; train_edge_recon_loss: 77544.1148; train_gene_expr_recon_loss: 91311.1064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170904.2470; train_optim_loss: 170904.2470; val_kl_reg_loss: 1967.2386; val_edge_recon_loss: 76219.9714; val_gene_expr_recon_loss: 92095.8698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170283.0781; val_optim_loss: 170283.0781
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9841; val_auprc_score: 0.9961; val_best_acc_score: 0.9713; val_best_f1_score: 0.9834; train_kl_reg_loss: 1998.6547; train_edge_recon_loss: 77642.9787; train_gene_expr_recon_loss: 90406.1752; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170047.8077; train_optim_loss: 170047.8077; val_kl_reg_loss: 1991.0533; val_edge_recon_loss: 75678.2578; val_gene_expr_recon_loss: 90884.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168554.0104; val_optim_loss: 168554.0104
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9861; val_auprc_score: 0.9967; val_best_acc_score: 0.9739; val_best_f1_score: 0.9848; train_kl_reg_loss: 1971.3950; train_edge_recon_loss: 77680.6490; train_gene_expr_recon_loss: 90108.4730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169760.5180; train_optim_loss: 169760.5180; val_kl_reg_loss: 1964.0149; val_edge_recon_loss: 75904.5417; val_gene_expr_recon_loss: 90524.1589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168392.7188; val_optim_loss: 168392.7188
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9848; val_auprc_score: 0.9964; val_best_acc_score: 0.9746; val_best_f1_score: 0.9852; train_kl_reg_loss: 1968.6346; train_edge_recon_loss: 77034.9642; train_gene_expr_recon_loss: 89469.3693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168472.9675; train_optim_loss: 168472.9675; val_kl_reg_loss: 1925.9820; val_edge_recon_loss: 77253.7370; val_gene_expr_recon_loss: 90002.7865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169182.5104; val_optim_loss: 169182.5104
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9860; val_auprc_score: 0.9958; val_best_acc_score: 0.9768; val_best_f1_score: 0.9865; train_kl_reg_loss: 1939.0301; train_edge_recon_loss: 76969.9195; train_gene_expr_recon_loss: 88869.4703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167778.4189; train_optim_loss: 167778.4189; val_kl_reg_loss: 1952.0601; val_edge_recon_loss: 77288.0521; val_gene_expr_recon_loss: 89820.7839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169060.8906; val_optim_loss: 169060.8906
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9849; val_auprc_score: 0.9959; val_best_acc_score: 0.9771; val_best_f1_score: 0.9867; train_kl_reg_loss: 1936.5804; train_edge_recon_loss: 76994.5078; train_gene_expr_recon_loss: 88511.9570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167443.0463; train_optim_loss: 167443.0463; val_kl_reg_loss: 1916.0687; val_edge_recon_loss: 76380.8307; val_gene_expr_recon_loss: 88865.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167162.7760; val_optim_loss: 167162.7760
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9890; val_auprc_score: 0.9970; val_best_acc_score: 0.9782; val_best_f1_score: 0.9872; train_kl_reg_loss: 1922.7548; train_edge_recon_loss: 76959.7320; train_gene_expr_recon_loss: 88189.8191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167072.3059; train_optim_loss: 167072.3059; val_kl_reg_loss: 1865.9065; val_edge_recon_loss: 77823.0990; val_gene_expr_recon_loss: 88499.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168188.8594; val_optim_loss: 168188.8594
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9890; val_auprc_score: 0.9972; val_best_acc_score: 0.9793; val_best_f1_score: 0.9879; train_kl_reg_loss: 1913.7849; train_edge_recon_loss: 77029.5700; train_gene_expr_recon_loss: 87936.4781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166879.8335; train_optim_loss: 166879.8335; val_kl_reg_loss: 1910.9170; val_edge_recon_loss: 76587.3984; val_gene_expr_recon_loss: 88430.8568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166929.1771; val_optim_loss: 166929.1771
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9881; val_auprc_score: 0.9969; val_best_acc_score: 0.9804; val_best_f1_score: 0.9886; train_kl_reg_loss: 1908.2830; train_edge_recon_loss: 76371.5475; train_gene_expr_recon_loss: 87568.8813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165848.7109; train_optim_loss: 165848.7109; val_kl_reg_loss: 1873.8328; val_edge_recon_loss: 75615.8906; val_gene_expr_recon_loss: 88466.6771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165956.3958; val_optim_loss: 165956.3958
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9892; val_auprc_score: 0.9971; val_best_acc_score: 0.9811; val_best_f1_score: 0.9890; train_kl_reg_loss: 1903.3044; train_edge_recon_loss: 76502.0766; train_gene_expr_recon_loss: 87301.3858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165706.7674; train_optim_loss: 165706.7674; val_kl_reg_loss: 1907.4724; val_edge_recon_loss: 76263.5365; val_gene_expr_recon_loss: 88214.2005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166385.2083; val_optim_loss: 166385.2083
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9891; val_auprc_score: 0.9970; val_best_acc_score: 0.9805; val_best_f1_score: 0.9887; train_kl_reg_loss: 1902.6779; train_edge_recon_loss: 76485.2620; train_gene_expr_recon_loss: 86928.3858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165316.3251; train_optim_loss: 165316.3251; val_kl_reg_loss: 1899.6684; val_edge_recon_loss: 75878.2552; val_gene_expr_recon_loss: 88067.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165845.8802; val_optim_loss: 165845.8802
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9883; val_auprc_score: 0.9963; val_best_acc_score: 0.9816; val_best_f1_score: 0.9892; train_kl_reg_loss: 1899.9001; train_edge_recon_loss: 75742.5261; train_gene_expr_recon_loss: 86739.5562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164381.9802; train_optim_loss: 164381.9802; val_kl_reg_loss: 1876.0641; val_edge_recon_loss: 79051.4453; val_gene_expr_recon_loss: 87812.7292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168740.2448; val_optim_loss: 168740.2448
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9903; val_auprc_score: 0.9977; val_best_acc_score: 0.9830; val_best_f1_score: 0.9901; train_kl_reg_loss: 1905.7828; train_edge_recon_loss: 76410.9282; train_gene_expr_recon_loss: 86449.9288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164766.6418; train_optim_loss: 164766.6418; val_kl_reg_loss: 1884.8337; val_edge_recon_loss: 73977.3073; val_gene_expr_recon_loss: 87346.4557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163208.5938; val_optim_loss: 163208.5938
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9904; val_auprc_score: 0.9976; val_best_acc_score: 0.9827; val_best_f1_score: 0.9900; train_kl_reg_loss: 1907.7109; train_edge_recon_loss: 76613.1704; train_gene_expr_recon_loss: 86540.1001; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165060.9820; train_optim_loss: 165060.9820; val_kl_reg_loss: 1872.4302; val_edge_recon_loss: 75666.0052; val_gene_expr_recon_loss: 87361.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164900.2083; val_optim_loss: 164900.2083
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9903; val_auprc_score: 0.9968; val_best_acc_score: 0.9821; val_best_f1_score: 0.9896; train_kl_reg_loss: 1903.0175; train_edge_recon_loss: 77104.0962; train_gene_expr_recon_loss: 86046.3398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165053.4537; train_optim_loss: 165053.4537; val_kl_reg_loss: 1884.9676; val_edge_recon_loss: 76703.2734; val_gene_expr_recon_loss: 87117.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165706.0677; val_optim_loss: 165706.0677
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9904; val_auprc_score: 0.9975; val_best_acc_score: 0.9829; val_best_f1_score: 0.9900; train_kl_reg_loss: 1900.7637; train_edge_recon_loss: 76406.5309; train_gene_expr_recon_loss: 86112.0349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164419.3287; train_optim_loss: 164419.3287; val_kl_reg_loss: 1902.9913; val_edge_recon_loss: 75842.0938; val_gene_expr_recon_loss: 86831.4193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164576.5000; val_optim_loss: 164576.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9891; val_auprc_score: 0.9964; val_best_acc_score: 0.9831; val_best_f1_score: 0.9901; train_kl_reg_loss: 1902.2336; train_edge_recon_loss: 76494.4050; train_gene_expr_recon_loss: 85960.8537; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164357.4910; train_optim_loss: 164357.4910; val_kl_reg_loss: 1867.3894; val_edge_recon_loss: 76488.3411; val_gene_expr_recon_loss: 86813.9245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165169.6562; val_optim_loss: 165169.6562
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9913; val_auprc_score: 0.9980; val_best_acc_score: 0.9842; val_best_f1_score: 0.9908; train_kl_reg_loss: 1901.6457; train_edge_recon_loss: 76434.3855; train_gene_expr_recon_loss: 85705.9315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164041.9615; train_optim_loss: 164041.9615; val_kl_reg_loss: 1887.5738; val_edge_recon_loss: 75750.5573; val_gene_expr_recon_loss: 86745.8385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164383.9688; val_optim_loss: 164383.9688
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9893; val_auprc_score: 0.9969; val_best_acc_score: 0.9821; val_best_f1_score: 0.9896; train_kl_reg_loss: 1898.4229; train_edge_recon_loss: 76264.1289; train_gene_expr_recon_loss: 85915.2987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164077.8516; train_optim_loss: 164077.8516; val_kl_reg_loss: 1885.5340; val_edge_recon_loss: 76571.6380; val_gene_expr_recon_loss: 86941.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165398.3906; val_optim_loss: 165398.3906

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 13 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
Val AUROC score: 0.9905
Val AUPRC score: 0.9975
Val best accuracy score: 0.9814
Val best F1 score: 0.9891
Val gene expr MSE score: 0.9695
Duration of model training in run 8: 0 hours, 3 minutes and 17 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 265201
Number of validation edges: 29466
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8939; val_auprc_score: 0.9765; val_best_acc_score: 0.9170; val_best_f1_score: 0.9527; train_kl_reg_loss: 527.5510; train_edge_recon_loss: 96843.6309; train_gene_expr_recon_loss: 101388.2588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198759.4422; train_optim_loss: 198759.4422; val_kl_reg_loss: 2583.9020; val_edge_recon_loss: 81097.6953; val_gene_expr_recon_loss: 93727.2070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177408.8047; val_optim_loss: 177408.8047
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9594; val_auprc_score: 0.9913; val_best_acc_score: 0.9401; val_best_f1_score: 0.9656; train_kl_reg_loss: 2384.2044; train_edge_recon_loss: 82156.3795; train_gene_expr_recon_loss: 92789.4188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177330.0019; train_optim_loss: 177330.0019; val_kl_reg_loss: 1984.8742; val_edge_recon_loss: 80202.7129; val_gene_expr_recon_loss: 91408.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173596.4023; val_optim_loss: 173596.4023
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9810; val_auprc_score: 0.9949; val_best_acc_score: 0.9678; val_best_f1_score: 0.9813; train_kl_reg_loss: 2067.9826; train_edge_recon_loss: 78773.2637; train_gene_expr_recon_loss: 91045.6269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171886.8712; train_optim_loss: 171886.8712; val_kl_reg_loss: 2015.8475; val_edge_recon_loss: 77319.8438; val_gene_expr_recon_loss: 90192.9180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169528.6094; val_optim_loss: 169528.6094
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9818; val_auprc_score: 0.9952; val_best_acc_score: 0.9737; val_best_f1_score: 0.9847; train_kl_reg_loss: 1989.5276; train_edge_recon_loss: 77517.1776; train_gene_expr_recon_loss: 89838.5668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169345.2732; train_optim_loss: 169345.2732; val_kl_reg_loss: 1977.5504; val_edge_recon_loss: 77552.7891; val_gene_expr_recon_loss: 88654.8613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168185.2031; val_optim_loss: 168185.2031
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9841; val_auprc_score: 0.9962; val_best_acc_score: 0.9772; val_best_f1_score: 0.9867; train_kl_reg_loss: 1957.1335; train_edge_recon_loss: 77308.5019; train_gene_expr_recon_loss: 88838.2377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168103.8717; train_optim_loss: 168103.8717; val_kl_reg_loss: 1912.4450; val_edge_recon_loss: 76564.0742; val_gene_expr_recon_loss: 88241.5801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166718.1016; val_optim_loss: 166718.1016
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9834; val_auprc_score: 0.9949; val_best_acc_score: 0.9773; val_best_f1_score: 0.9868; train_kl_reg_loss: 1941.5471; train_edge_recon_loss: 76909.1132; train_gene_expr_recon_loss: 88207.6352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167058.2936; train_optim_loss: 167058.2936; val_kl_reg_loss: 1875.9882; val_edge_recon_loss: 76829.1992; val_gene_expr_recon_loss: 87606.2012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166311.3945; val_optim_loss: 166311.3945
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9901; val_auprc_score: 0.9975; val_best_acc_score: 0.9798; val_best_f1_score: 0.9882; train_kl_reg_loss: 1927.9297; train_edge_recon_loss: 77136.5315; train_gene_expr_recon_loss: 87663.3040; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166727.7670; train_optim_loss: 166727.7670; val_kl_reg_loss: 1886.1615; val_edge_recon_loss: 77619.3145; val_gene_expr_recon_loss: 86962.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166467.4844; val_optim_loss: 166467.4844
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9856; val_auprc_score: 0.9957; val_best_acc_score: 0.9786; val_best_f1_score: 0.9875; train_kl_reg_loss: 1912.2335; train_edge_recon_loss: 76818.8565; train_gene_expr_recon_loss: 87196.7088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165927.7997; train_optim_loss: 165927.7997; val_kl_reg_loss: 1910.1670; val_edge_recon_loss: 79251.6309; val_gene_expr_recon_loss: 86718.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167880.0742; val_optim_loss: 167880.0742
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9872; val_auprc_score: 0.9963; val_best_acc_score: 0.9810; val_best_f1_score: 0.9889; train_kl_reg_loss: 1904.2183; train_edge_recon_loss: 76486.6115; train_gene_expr_recon_loss: 86872.3788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165263.2088; train_optim_loss: 165263.2088; val_kl_reg_loss: 1900.7103; val_edge_recon_loss: 78612.3848; val_gene_expr_recon_loss: 86128.5684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166641.6641; val_optim_loss: 166641.6641

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9874; val_auprc_score: 0.9962; val_best_acc_score: 0.9808; val_best_f1_score: 0.9888; train_kl_reg_loss: 1905.9848; train_edge_recon_loss: 76822.7950; train_gene_expr_recon_loss: 86568.4785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165297.2595; train_optim_loss: 165297.2595; val_kl_reg_loss: 1885.4284; val_edge_recon_loss: 75454.2871; val_gene_expr_recon_loss: 86226.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163566.4531; val_optim_loss: 163566.4531
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9880; val_auprc_score: 0.9968; val_best_acc_score: 0.9814; val_best_f1_score: 0.9892; train_kl_reg_loss: 1901.2999; train_edge_recon_loss: 76628.9174; train_gene_expr_recon_loss: 86503.8755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165034.0928; train_optim_loss: 165034.0928; val_kl_reg_loss: 1879.2060; val_edge_recon_loss: 75601.3008; val_gene_expr_recon_loss: 85809.2539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163289.7656; val_optim_loss: 163289.7656
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9878; val_auprc_score: 0.9966; val_best_acc_score: 0.9817; val_best_f1_score: 0.9893; train_kl_reg_loss: 1898.4153; train_edge_recon_loss: 76403.9877; train_gene_expr_recon_loss: 86384.3258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164686.7259; train_optim_loss: 164686.7259; val_kl_reg_loss: 1890.6869; val_edge_recon_loss: 76832.8418; val_gene_expr_recon_loss: 86183.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164907.3789; val_optim_loss: 164907.3789
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9879; val_auprc_score: 0.9966; val_best_acc_score: 0.9817; val_best_f1_score: 0.9894; train_kl_reg_loss: 1897.0310; train_edge_recon_loss: 76313.6586; train_gene_expr_recon_loss: 86407.2410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164617.9328; train_optim_loss: 164617.9328; val_kl_reg_loss: 1885.1936; val_edge_recon_loss: 75213.8770; val_gene_expr_recon_loss: 86058.1113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163157.1797; val_optim_loss: 163157.1797
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9880; val_auprc_score: 0.9965; val_best_acc_score: 0.9811; val_best_f1_score: 0.9890; train_kl_reg_loss: 1895.9207; train_edge_recon_loss: 76726.1146; train_gene_expr_recon_loss: 86323.8561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164945.8906; train_optim_loss: 164945.8906; val_kl_reg_loss: 1882.3054; val_edge_recon_loss: 77032.8223; val_gene_expr_recon_loss: 85844.2988; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164759.4258; val_optim_loss: 164759.4258
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9871; val_auprc_score: 0.9963; val_best_acc_score: 0.9803; val_best_f1_score: 0.9885; train_kl_reg_loss: 1899.6710; train_edge_recon_loss: 76705.0613; train_gene_expr_recon_loss: 86336.6650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164941.3982; train_optim_loss: 164941.3982; val_kl_reg_loss: 1892.3511; val_edge_recon_loss: 76923.7754; val_gene_expr_recon_loss: 86024.8945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164841.0195; val_optim_loss: 164841.0195
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9895; val_auprc_score: 0.9975; val_best_acc_score: 0.9827; val_best_f1_score: 0.9900; train_kl_reg_loss: 1900.2373; train_edge_recon_loss: 76975.0208; train_gene_expr_recon_loss: 86237.2566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165112.5137; train_optim_loss: 165112.5137; val_kl_reg_loss: 1888.5781; val_edge_recon_loss: 75382.0137; val_gene_expr_recon_loss: 85929.3496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163199.9414; val_optim_loss: 163199.9414

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9885; val_auprc_score: 0.9966; val_best_acc_score: 0.9822; val_best_f1_score: 0.9896; train_kl_reg_loss: 1900.6964; train_edge_recon_loss: 75977.4384; train_gene_expr_recon_loss: 86319.6257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164197.7599; train_optim_loss: 164197.7599; val_kl_reg_loss: 1884.7423; val_edge_recon_loss: 77279.6250; val_gene_expr_recon_loss: 86075.2637; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165239.6328; val_optim_loss: 165239.6328
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9879; val_auprc_score: 0.9967; val_best_acc_score: 0.9808; val_best_f1_score: 0.9888; train_kl_reg_loss: 1899.8714; train_edge_recon_loss: 76437.7533; train_gene_expr_recon_loss: 86290.9233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164628.5464; train_optim_loss: 164628.5464; val_kl_reg_loss: 1886.0002; val_edge_recon_loss: 78530.0723; val_gene_expr_recon_loss: 85642.8574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166058.9297; val_optim_loss: 166058.9297
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9882; val_auprc_score: 0.9967; val_best_acc_score: 0.9816; val_best_f1_score: 0.9892; train_kl_reg_loss: 1898.6903; train_edge_recon_loss: 76479.5722; train_gene_expr_recon_loss: 86370.5303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164748.7945; train_optim_loss: 164748.7945; val_kl_reg_loss: 1882.8410; val_edge_recon_loss: 77876.2773; val_gene_expr_recon_loss: 86131.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165891.0469; val_optim_loss: 165891.0469

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 47 sec.
Using best model state, which was in epoch 13.

--- MODEL EVALUATION ---
Val AUROC score: 0.9896
Val AUPRC score: 0.9966
Val best accuracy score: 0.9819
Val best F1 score: 0.9895
Val gene expr MSE score: 0.9797
Duration of model training in run 9: 0 hours, 3 minutes and 52 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 265201
Number of validation edges: 29466
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9036; val_auprc_score: 0.9784; val_best_acc_score: 0.9145; val_best_f1_score: 0.9514; train_kl_reg_loss: 381.5684; train_edge_recon_loss: 97792.5230; train_gene_expr_recon_loss: 101164.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199338.7547; train_optim_loss: 199338.7547; val_kl_reg_loss: 2005.1239; val_edge_recon_loss: 85812.5957; val_gene_expr_recon_loss: 94247.7539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182065.4727; val_optim_loss: 182065.4727
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9584; val_auprc_score: 0.9910; val_best_acc_score: 0.9379; val_best_f1_score: 0.9643; train_kl_reg_loss: 2249.3015; train_edge_recon_loss: 82215.4411; train_gene_expr_recon_loss: 93180.6375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177645.3812; train_optim_loss: 177645.3812; val_kl_reg_loss: 1936.2292; val_edge_recon_loss: 77674.9199; val_gene_expr_recon_loss: 91906.2012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171517.3516; val_optim_loss: 171517.3516
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9804; val_auprc_score: 0.9944; val_best_acc_score: 0.9656; val_best_f1_score: 0.9800; train_kl_reg_loss: 2046.7444; train_edge_recon_loss: 78909.0656; train_gene_expr_recon_loss: 91582.1378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172537.9465; train_optim_loss: 172537.9465; val_kl_reg_loss: 2005.1900; val_edge_recon_loss: 78000.9688; val_gene_expr_recon_loss: 90637.0879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170643.2461; val_optim_loss: 170643.2461
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9820; val_auprc_score: 0.9947; val_best_acc_score: 0.9729; val_best_f1_score: 0.9842; train_kl_reg_loss: 1979.5536; train_edge_recon_loss: 77474.8913; train_gene_expr_recon_loss: 90297.8783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169752.3234; train_optim_loss: 169752.3234; val_kl_reg_loss: 1961.4254; val_edge_recon_loss: 77017.2617; val_gene_expr_recon_loss: 89316.4043; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168295.0898; val_optim_loss: 168295.0898
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9857; val_auprc_score: 0.9960; val_best_acc_score: 0.9770; val_best_f1_score: 0.9866; train_kl_reg_loss: 1963.4835; train_edge_recon_loss: 77137.0921; train_gene_expr_recon_loss: 89360.9621; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168461.5365; train_optim_loss: 168461.5365; val_kl_reg_loss: 1928.0414; val_edge_recon_loss: 76775.5215; val_gene_expr_recon_loss: 88493.2773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167196.8438; val_optim_loss: 167196.8438
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9874; val_auprc_score: 0.9966; val_best_acc_score: 0.9781; val_best_f1_score: 0.9873; train_kl_reg_loss: 1946.5340; train_edge_recon_loss: 77131.9034; train_gene_expr_recon_loss: 88600.0630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167678.5014; train_optim_loss: 167678.5014; val_kl_reg_loss: 1919.1611; val_edge_recon_loss: 76191.8438; val_gene_expr_recon_loss: 88089.5371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166200.5430; val_optim_loss: 166200.5430
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9853; val_auprc_score: 0.9957; val_best_acc_score: 0.9794; val_best_f1_score: 0.9881; train_kl_reg_loss: 1928.4686; train_edge_recon_loss: 76829.5952; train_gene_expr_recon_loss: 88089.8509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166847.9162; train_optim_loss: 166847.9162; val_kl_reg_loss: 1898.0889; val_edge_recon_loss: 75956.3965; val_gene_expr_recon_loss: 87908.0723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165762.5508; val_optim_loss: 165762.5508
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9885; val_auprc_score: 0.9967; val_best_acc_score: 0.9803; val_best_f1_score: 0.9885; train_kl_reg_loss: 1915.2467; train_edge_recon_loss: 77143.4756; train_gene_expr_recon_loss: 87597.0147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166655.7377; train_optim_loss: 166655.7377; val_kl_reg_loss: 1903.0991; val_edge_recon_loss: 76821.6348; val_gene_expr_recon_loss: 87187.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165912.3672; val_optim_loss: 165912.3672
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9871; val_auprc_score: 0.9966; val_best_acc_score: 0.9812; val_best_f1_score: 0.9891; train_kl_reg_loss: 1906.0189; train_edge_recon_loss: 76574.5810; train_gene_expr_recon_loss: 87209.2940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165689.8939; train_optim_loss: 165689.8939; val_kl_reg_loss: 1902.7974; val_edge_recon_loss: 74353.7656; val_gene_expr_recon_loss: 86951.4180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163207.9805; val_optim_loss: 163207.9805
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9891; val_auprc_score: 0.9970; val_best_acc_score: 0.9815; val_best_f1_score: 0.9892; train_kl_reg_loss: 1908.2349; train_edge_recon_loss: 76585.1941; train_gene_expr_recon_loss: 86892.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165385.7647; train_optim_loss: 165385.7647; val_kl_reg_loss: 1891.7352; val_edge_recon_loss: 76176.4141; val_gene_expr_recon_loss: 86592.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164660.6406; val_optim_loss: 164660.6406
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9882; val_auprc_score: 0.9966; val_best_acc_score: 0.9816; val_best_f1_score: 0.9892; train_kl_reg_loss: 1909.3339; train_edge_recon_loss: 76518.3040; train_gene_expr_recon_loss: 86641.2251; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165068.8617; train_optim_loss: 165068.8617; val_kl_reg_loss: 1899.3880; val_edge_recon_loss: 77823.8438; val_gene_expr_recon_loss: 86208.7285; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165931.9609; val_optim_loss: 165931.9609
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9894; val_auprc_score: 0.9971; val_best_acc_score: 0.9835; val_best_f1_score: 0.9904; train_kl_reg_loss: 1907.0000; train_edge_recon_loss: 76419.9264; train_gene_expr_recon_loss: 86412.8596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164739.7869; train_optim_loss: 164739.7869; val_kl_reg_loss: 1871.6367; val_edge_recon_loss: 75034.4883; val_gene_expr_recon_loss: 85670.8145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162576.9414; val_optim_loss: 162576.9414
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9891; val_auprc_score: 0.9970; val_best_acc_score: 0.9827; val_best_f1_score: 0.9900; train_kl_reg_loss: 1899.6020; train_edge_recon_loss: 76895.2921; train_gene_expr_recon_loss: 86153.2375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164948.1316; train_optim_loss: 164948.1316; val_kl_reg_loss: 1883.3000; val_edge_recon_loss: 74949.3281; val_gene_expr_recon_loss: 85817.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162649.8125; val_optim_loss: 162649.8125
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9881; val_auprc_score: 0.9959; val_best_acc_score: 0.9833; val_best_f1_score: 0.9902; train_kl_reg_loss: 1900.4465; train_edge_recon_loss: 76350.1842; train_gene_expr_recon_loss: 85898.3925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164149.0241; train_optim_loss: 164149.0241; val_kl_reg_loss: 1896.2666; val_edge_recon_loss: 78294.6895; val_gene_expr_recon_loss: 85604.3965; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165795.3555; val_optim_loss: 165795.3555
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9898; val_auprc_score: 0.9971; val_best_acc_score: 0.9838; val_best_f1_score: 0.9905; train_kl_reg_loss: 1894.2378; train_edge_recon_loss: 76566.1615; train_gene_expr_recon_loss: 85648.9479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164109.3475; train_optim_loss: 164109.3475; val_kl_reg_loss: 1907.7805; val_edge_recon_loss: 75772.0723; val_gene_expr_recon_loss: 85503.1660; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163183.0156; val_optim_loss: 163183.0156

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9898; val_auprc_score: 0.9968; val_best_acc_score: 0.9838; val_best_f1_score: 0.9905; train_kl_reg_loss: 1900.8598; train_edge_recon_loss: 76881.2981; train_gene_expr_recon_loss: 85481.5429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164263.7003; train_optim_loss: 164263.7003; val_kl_reg_loss: 1884.7104; val_edge_recon_loss: 77924.2031; val_gene_expr_recon_loss: 85479.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165288.8125; val_optim_loss: 165288.8125
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9898; val_auprc_score: 0.9971; val_best_acc_score: 0.9836; val_best_f1_score: 0.9905; train_kl_reg_loss: 1896.4378; train_edge_recon_loss: 76462.9964; train_gene_expr_recon_loss: 85393.0301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163752.4635; train_optim_loss: 163752.4635; val_kl_reg_loss: 1878.9610; val_edge_recon_loss: 74902.3770; val_gene_expr_recon_loss: 85309.1523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162090.4883; val_optim_loss: 162090.4883
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9888; val_auprc_score: 0.9964; val_best_acc_score: 0.9841; val_best_f1_score: 0.9908; train_kl_reg_loss: 1893.3955; train_edge_recon_loss: 76111.4995; train_gene_expr_recon_loss: 85408.3778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163413.2732; train_optim_loss: 163413.2732; val_kl_reg_loss: 1879.9536; val_edge_recon_loss: 76026.1602; val_gene_expr_recon_loss: 85219.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163125.7422; val_optim_loss: 163125.7422
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9888; val_auprc_score: 0.9965; val_best_acc_score: 0.9831; val_best_f1_score: 0.9901; train_kl_reg_loss: 1889.9092; train_edge_recon_loss: 76460.4122; train_gene_expr_recon_loss: 85400.8035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163751.1250; train_optim_loss: 163751.1250; val_kl_reg_loss: 1874.9684; val_edge_recon_loss: 76437.1055; val_gene_expr_recon_loss: 85296.5527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163608.6250; val_optim_loss: 163608.6250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9905; val_auprc_score: 0.9975; val_best_acc_score: 0.9852; val_best_f1_score: 0.9914; train_kl_reg_loss: 1891.4135; train_edge_recon_loss: 76318.1674; train_gene_expr_recon_loss: 85383.0322; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163592.6146; train_optim_loss: 163592.6146; val_kl_reg_loss: 1871.5168; val_edge_recon_loss: 74803.8086; val_gene_expr_recon_loss: 84970.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161645.8789; val_optim_loss: 161645.8789
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9896; val_auprc_score: 0.9967; val_best_acc_score: 0.9850; val_best_f1_score: 0.9913; train_kl_reg_loss: 1886.7122; train_edge_recon_loss: 76680.5987; train_gene_expr_recon_loss: 85392.9027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163960.2140; train_optim_loss: 163960.2140; val_kl_reg_loss: 1884.8293; val_edge_recon_loss: 75213.5215; val_gene_expr_recon_loss: 85237.6367; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162335.9883; val_optim_loss: 162335.9883
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9895; val_auprc_score: 0.9970; val_best_acc_score: 0.9841; val_best_f1_score: 0.9907; train_kl_reg_loss: 1895.1042; train_edge_recon_loss: 75883.2012; train_gene_expr_recon_loss: 85334.7543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163113.0592; train_optim_loss: 163113.0592; val_kl_reg_loss: 1860.7820; val_edge_recon_loss: 76788.5527; val_gene_expr_recon_loss: 85198.5059; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163847.8438; val_optim_loss: 163847.8438
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9902; val_auprc_score: 0.9967; val_best_acc_score: 0.9848; val_best_f1_score: 0.9911; train_kl_reg_loss: 1887.4032; train_edge_recon_loss: 76310.1584; train_gene_expr_recon_loss: 85282.5497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163480.1127; train_optim_loss: 163480.1127; val_kl_reg_loss: 1877.5109; val_edge_recon_loss: 76815.1113; val_gene_expr_recon_loss: 85347.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164040.1445; val_optim_loss: 164040.1445

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9910; val_auprc_score: 0.9977; val_best_acc_score: 0.9850; val_best_f1_score: 0.9913; train_kl_reg_loss: 1889.8419; train_edge_recon_loss: 76201.5097; train_gene_expr_recon_loss: 85243.9285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163335.2808; train_optim_loss: 163335.2808; val_kl_reg_loss: 1872.6560; val_edge_recon_loss: 74455.8730; val_gene_expr_recon_loss: 85127.4941; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161456.0195; val_optim_loss: 161456.0195
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9918; val_auprc_score: 0.9981; val_best_acc_score: 0.9843; val_best_f1_score: 0.9909; train_kl_reg_loss: 1889.2758; train_edge_recon_loss: 76641.2867; train_gene_expr_recon_loss: 85232.6361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163763.1989; train_optim_loss: 163763.1989; val_kl_reg_loss: 1876.2944; val_edge_recon_loss: 76286.8438; val_gene_expr_recon_loss: 84918.6660; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163081.8047; val_optim_loss: 163081.8047
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9904; val_auprc_score: 0.9974; val_best_acc_score: 0.9837; val_best_f1_score: 0.9905; train_kl_reg_loss: 1890.0393; train_edge_recon_loss: 76557.2161; train_gene_expr_recon_loss: 85260.8963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163708.1510; train_optim_loss: 163708.1510; val_kl_reg_loss: 1875.8989; val_edge_recon_loss: 75008.8223; val_gene_expr_recon_loss: 85079.8945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161964.6172; val_optim_loss: 161964.6172
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9894; val_auprc_score: 0.9963; val_best_acc_score: 0.9848; val_best_f1_score: 0.9911; train_kl_reg_loss: 1891.6384; train_edge_recon_loss: 76639.7029; train_gene_expr_recon_loss: 85234.5616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163765.9029; train_optim_loss: 163765.9029; val_kl_reg_loss: 1875.6463; val_edge_recon_loss: 76245.7051; val_gene_expr_recon_loss: 85107.5508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163228.9023; val_optim_loss: 163228.9023

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9891; val_auprc_score: 0.9965; val_best_acc_score: 0.9846; val_best_f1_score: 0.9910; train_kl_reg_loss: 1890.0423; train_edge_recon_loss: 76363.5563; train_gene_expr_recon_loss: 85170.9548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163424.5535; train_optim_loss: 163424.5535; val_kl_reg_loss: 1876.4380; val_edge_recon_loss: 76185.8496; val_gene_expr_recon_loss: 84905.3008; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162967.5898; val_optim_loss: 162967.5898
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9895; val_auprc_score: 0.9969; val_best_acc_score: 0.9849; val_best_f1_score: 0.9912; train_kl_reg_loss: 1890.1977; train_edge_recon_loss: 76553.2758; train_gene_expr_recon_loss: 85281.5653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163725.0412; train_optim_loss: 163725.0412; val_kl_reg_loss: 1876.4191; val_edge_recon_loss: 74432.3359; val_gene_expr_recon_loss: 85298.3496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161607.1055; val_optim_loss: 161607.1055
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9899; val_auprc_score: 0.9968; val_best_acc_score: 0.9838; val_best_f1_score: 0.9906; train_kl_reg_loss: 1890.0506; train_edge_recon_loss: 76735.1958; train_gene_expr_recon_loss: 85255.1674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163880.4124; train_optim_loss: 163880.4124; val_kl_reg_loss: 1875.1564; val_edge_recon_loss: 75358.4258; val_gene_expr_recon_loss: 85305.4199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162539.0000; val_optim_loss: 162539.0000

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 2 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9910
Val AUPRC score: 0.9980
Val best accuracy score: 0.9836
Val best F1 score: 0.9904
Val gene expr MSE score: 0.9050
Duration of model training in run 10: 0 hours, 6 minutes and 7 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
