First script finished. Launching follow up script.
Run timestamp: 02062023_065414.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '8192', '8192', '4096', '4096', '2048', '2048', '1024', '1024', '1024', '1024', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-attention_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-attention', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9658; val_auprc_score: 0.9919; val_best_acc_score: 0.9409; val_best_f1_score: 0.9658; train_kl_reg_loss: 167.9269; train_edge_recon_loss: 101650.5809; train_gene_expr_recon_loss: 113512.5910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215331.0982; train_optim_loss: 215331.0982; val_kl_reg_loss: 147.3168; val_edge_recon_loss: 107342.4531; val_gene_expr_recon_loss: 103106.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210596.2812; val_optim_loss: 210596.2812
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9140; val_auprc_score: 0.9808; val_best_acc_score: 0.9126; val_best_f1_score: 0.9503; train_kl_reg_loss: 510.3682; train_edge_recon_loss: 93867.7963; train_gene_expr_recon_loss: 101792.4950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196170.6596; train_optim_loss: 196170.6596; val_kl_reg_loss: 1722.2170; val_edge_recon_loss: 81978.7266; val_gene_expr_recon_loss: 101408.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185109.0469; val_optim_loss: 185109.0469
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9267; val_auprc_score: 0.9839; val_best_acc_score: 0.9206; val_best_f1_score: 0.9544; train_kl_reg_loss: 2979.4257; train_edge_recon_loss: 81830.9972; train_gene_expr_recon_loss: 99511.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184321.6362; train_optim_loss: 184321.6362; val_kl_reg_loss: 3116.1152; val_edge_recon_loss: 81030.6094; val_gene_expr_recon_loss: 99499.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183645.9688; val_optim_loss: 183645.9688
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9375; val_auprc_score: 0.9863; val_best_acc_score: 0.9258; val_best_f1_score: 0.9572; train_kl_reg_loss: 2555.1829; train_edge_recon_loss: 80022.3594; train_gene_expr_recon_loss: 98090.7238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180668.2690; train_optim_loss: 180668.2690; val_kl_reg_loss: 2042.9820; val_edge_recon_loss: 81388.2461; val_gene_expr_recon_loss: 97630.8164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181062.0391; val_optim_loss: 181062.0391
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9511; val_auprc_score: 0.9901; val_best_acc_score: 0.9351; val_best_f1_score: 0.9630; train_kl_reg_loss: 2200.8206; train_edge_recon_loss: 78216.6356; train_gene_expr_recon_loss: 97084.2472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177501.7042; train_optim_loss: 177501.7042; val_kl_reg_loss: 2256.3380; val_edge_recon_loss: 76889.3203; val_gene_expr_recon_loss: 96637.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175783.6250; val_optim_loss: 175783.6250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9597; val_auprc_score: 0.9912; val_best_acc_score: 0.9390; val_best_f1_score: 0.9648; train_kl_reg_loss: 2239.0006; train_edge_recon_loss: 78444.4336; train_gene_expr_recon_loss: 96350.2919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177033.7288; train_optim_loss: 177033.7288; val_kl_reg_loss: 2076.4727; val_edge_recon_loss: 79426.1016; val_gene_expr_recon_loss: 95954.0898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177456.6641; val_optim_loss: 177456.6641
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9694; val_auprc_score: 0.9938; val_best_acc_score: 0.9489; val_best_f1_score: 0.9704; train_kl_reg_loss: 2148.0086; train_edge_recon_loss: 78495.6289; train_gene_expr_recon_loss: 95573.8901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176217.5301; train_optim_loss: 176217.5301; val_kl_reg_loss: 2108.9221; val_edge_recon_loss: 78733.9609; val_gene_expr_recon_loss: 95505.6680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176348.5547; val_optim_loss: 176348.5547
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9721; val_auprc_score: 0.9945; val_best_acc_score: 0.9534; val_best_f1_score: 0.9729; train_kl_reg_loss: 2141.2908; train_edge_recon_loss: 77469.6724; train_gene_expr_recon_loss: 94947.7997; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174558.7634; train_optim_loss: 174558.7634; val_kl_reg_loss: 2038.8145; val_edge_recon_loss: 78005.4961; val_gene_expr_recon_loss: 94764.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174808.9297; val_optim_loss: 174808.9297
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9747; val_auprc_score: 0.9941; val_best_acc_score: 0.9569; val_best_f1_score: 0.9750; train_kl_reg_loss: 2139.5230; train_edge_recon_loss: 77966.5965; train_gene_expr_recon_loss: 94425.7009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174531.8214; train_optim_loss: 174531.8214; val_kl_reg_loss: 2065.4946; val_edge_recon_loss: 77000.0508; val_gene_expr_recon_loss: 94334.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173399.6719; val_optim_loss: 173399.6719
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9757; val_auprc_score: 0.9946; val_best_acc_score: 0.9591; val_best_f1_score: 0.9762; train_kl_reg_loss: 2119.2121; train_edge_recon_loss: 77745.4157; train_gene_expr_recon_loss: 93917.7662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173782.3962; train_optim_loss: 173782.3962; val_kl_reg_loss: 2047.4075; val_edge_recon_loss: 78123.2969; val_gene_expr_recon_loss: 94785.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174956.3906; val_optim_loss: 174956.3906
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9731; val_auprc_score: 0.9934; val_best_acc_score: 0.9604; val_best_f1_score: 0.9770; train_kl_reg_loss: 2108.7227; train_edge_recon_loss: 77221.2846; train_gene_expr_recon_loss: 93570.9788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172900.9866; train_optim_loss: 172900.9866; val_kl_reg_loss: 2043.5406; val_edge_recon_loss: 78812.1797; val_gene_expr_recon_loss: 93574.8164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174430.5469; val_optim_loss: 174430.5469
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9778; val_auprc_score: 0.9954; val_best_acc_score: 0.9608; val_best_f1_score: 0.9773; train_kl_reg_loss: 2104.6294; train_edge_recon_loss: 76995.2121; train_gene_expr_recon_loss: 93225.4581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172325.3013; train_optim_loss: 172325.3013; val_kl_reg_loss: 1997.5165; val_edge_recon_loss: 79482.9766; val_gene_expr_recon_loss: 93077.0664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174557.5547; val_optim_loss: 174557.5547

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9787; val_auprc_score: 0.9950; val_best_acc_score: 0.9644; val_best_f1_score: 0.9794; train_kl_reg_loss: 2074.7658; train_edge_recon_loss: 77417.0179; train_gene_expr_recon_loss: 92995.7104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172487.4922; train_optim_loss: 172487.4922; val_kl_reg_loss: 2021.3284; val_edge_recon_loss: 77111.9688; val_gene_expr_recon_loss: 93348.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172482.1719; val_optim_loss: 172482.1719
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9751; val_auprc_score: 0.9941; val_best_acc_score: 0.9601; val_best_f1_score: 0.9769; train_kl_reg_loss: 2083.1619; train_edge_recon_loss: 76778.4230; train_gene_expr_recon_loss: 92988.5820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171850.1674; train_optim_loss: 171850.1674; val_kl_reg_loss: 2022.5332; val_edge_recon_loss: 79347.5664; val_gene_expr_recon_loss: 93457.2539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174827.3516; val_optim_loss: 174827.3516
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9755; val_auprc_score: 0.9937; val_best_acc_score: 0.9631; val_best_f1_score: 0.9785; train_kl_reg_loss: 2083.9798; train_edge_recon_loss: 77819.7266; train_gene_expr_recon_loss: 92787.7455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172691.4509; train_optim_loss: 172691.4509; val_kl_reg_loss: 2029.5556; val_edge_recon_loss: 77730.7930; val_gene_expr_recon_loss: 93808.8477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173569.2031; val_optim_loss: 173569.2031
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9771; val_auprc_score: 0.9946; val_best_acc_score: 0.9628; val_best_f1_score: 0.9784; train_kl_reg_loss: 2076.5360; train_edge_recon_loss: 77384.3404; train_gene_expr_recon_loss: 92915.7193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172376.5949; train_optim_loss: 172376.5949; val_kl_reg_loss: 2006.7771; val_edge_recon_loss: 77983.4219; val_gene_expr_recon_loss: 93051.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173041.3984; val_optim_loss: 173041.3984

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9788; val_auprc_score: 0.9951; val_best_acc_score: 0.9624; val_best_f1_score: 0.9782; train_kl_reg_loss: 2073.0393; train_edge_recon_loss: 76479.6311; train_gene_expr_recon_loss: 92851.3080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171403.9777; train_optim_loss: 171403.9777; val_kl_reg_loss: 2010.0045; val_edge_recon_loss: 76538.7500; val_gene_expr_recon_loss: 93111.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171660.5547; val_optim_loss: 171660.5547
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9800; val_auprc_score: 0.9957; val_best_acc_score: 0.9643; val_best_f1_score: 0.9792; train_kl_reg_loss: 2075.1689; train_edge_recon_loss: 75822.1501; train_gene_expr_recon_loss: 92932.7015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170830.0190; train_optim_loss: 170830.0190; val_kl_reg_loss: 2003.8342; val_edge_recon_loss: 77222.1211; val_gene_expr_recon_loss: 93235.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172461.1875; val_optim_loss: 172461.1875
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9790; val_auprc_score: 0.9946; val_best_acc_score: 0.9636; val_best_f1_score: 0.9789; train_kl_reg_loss: 2073.3558; train_edge_recon_loss: 77660.7896; train_gene_expr_recon_loss: 92834.6094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172568.7578; train_optim_loss: 172568.7578; val_kl_reg_loss: 2007.8781; val_edge_recon_loss: 76713.5859; val_gene_expr_recon_loss: 93377.2070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172098.6719; val_optim_loss: 172098.6719
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9776; val_auprc_score: 0.9951; val_best_acc_score: 0.9622; val_best_f1_score: 0.9780; train_kl_reg_loss: 2072.9383; train_edge_recon_loss: 77386.7238; train_gene_expr_recon_loss: 92844.0128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172303.6741; train_optim_loss: 172303.6741; val_kl_reg_loss: 2012.0725; val_edge_recon_loss: 78289.1094; val_gene_expr_recon_loss: 93108.2305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173409.4141; val_optim_loss: 173409.4141

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9786; val_auprc_score: 0.9952; val_best_acc_score: 0.9620; val_best_f1_score: 0.9780; train_kl_reg_loss: 2072.1074; train_edge_recon_loss: 77677.8041; train_gene_expr_recon_loss: 92832.7478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172582.6596; train_optim_loss: 172582.6596; val_kl_reg_loss: 2010.2977; val_edge_recon_loss: 77845.9688; val_gene_expr_recon_loss: 93274.3633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173130.6250; val_optim_loss: 173130.6250
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9774; val_auprc_score: 0.9948; val_best_acc_score: 0.9626; val_best_f1_score: 0.9783; train_kl_reg_loss: 2073.8155; train_edge_recon_loss: 76523.4029; train_gene_expr_recon_loss: 92912.0642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171509.2846; train_optim_loss: 171509.2846; val_kl_reg_loss: 2011.1761; val_edge_recon_loss: 76484.4336; val_gene_expr_recon_loss: 93068.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171564.3672; val_optim_loss: 171564.3672
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9794; val_auprc_score: 0.9951; val_best_acc_score: 0.9625; val_best_f1_score: 0.9782; train_kl_reg_loss: 2074.0770; train_edge_recon_loss: 76429.0686; train_gene_expr_recon_loss: 92943.7444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171446.8895; train_optim_loss: 171446.8895; val_kl_reg_loss: 1999.8383; val_edge_recon_loss: 79189.7266; val_gene_expr_recon_loss: 92972.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174162.2500; val_optim_loss: 174162.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9783; val_auprc_score: 0.9953; val_best_acc_score: 0.9623; val_best_f1_score: 0.9781; train_kl_reg_loss: 2073.3266; train_edge_recon_loss: 77128.5893; train_gene_expr_recon_loss: 92900.8599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172102.7768; train_optim_loss: 172102.7768; val_kl_reg_loss: 2006.3566; val_edge_recon_loss: 78035.9961; val_gene_expr_recon_loss: 93427.7773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173470.1328; val_optim_loss: 173470.1328
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9812; val_auprc_score: 0.9949; val_best_acc_score: 0.9646; val_best_f1_score: 0.9794; train_kl_reg_loss: 2073.6370; train_edge_recon_loss: 76892.9570; train_gene_expr_recon_loss: 92856.6596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171823.2533; train_optim_loss: 171823.2533; val_kl_reg_loss: 2006.7065; val_edge_recon_loss: 77394.0508; val_gene_expr_recon_loss: 92667.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172068.2812; val_optim_loss: 172068.2812

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9763; val_auprc_score: 0.9945; val_best_acc_score: 0.9634; val_best_f1_score: 0.9788; train_kl_reg_loss: 2072.6004; train_edge_recon_loss: 76721.6512; train_gene_expr_recon_loss: 92861.0430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171655.2924; train_optim_loss: 171655.2924; val_kl_reg_loss: 2004.5711; val_edge_recon_loss: 77257.6992; val_gene_expr_recon_loss: 92916.3320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172178.6016; val_optim_loss: 172178.6016
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9766; val_auprc_score: 0.9942; val_best_acc_score: 0.9647; val_best_f1_score: 0.9795; train_kl_reg_loss: 2070.9252; train_edge_recon_loss: 76708.4565; train_gene_expr_recon_loss: 92782.9213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171562.3036; train_optim_loss: 171562.3036; val_kl_reg_loss: 2010.0915; val_edge_recon_loss: 75821.6992; val_gene_expr_recon_loss: 93681.1836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171512.9844; val_optim_loss: 171512.9844
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9809; val_auprc_score: 0.9950; val_best_acc_score: 0.9634; val_best_f1_score: 0.9786; train_kl_reg_loss: 2072.0343; train_edge_recon_loss: 77066.0837; train_gene_expr_recon_loss: 92790.4643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171928.5815; train_optim_loss: 171928.5815; val_kl_reg_loss: 2011.3496; val_edge_recon_loss: 78671.1914; val_gene_expr_recon_loss: 92876.1602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173558.7031; val_optim_loss: 173558.7031
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9793; val_auprc_score: 0.9951; val_best_acc_score: 0.9639; val_best_f1_score: 0.9790; train_kl_reg_loss: 2072.3617; train_edge_recon_loss: 77144.1752; train_gene_expr_recon_loss: 92840.6892; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172057.2254; train_optim_loss: 172057.2254; val_kl_reg_loss: 2007.9576; val_edge_recon_loss: 77522.2422; val_gene_expr_recon_loss: 92946.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172476.6875; val_optim_loss: 172476.6875
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9764; val_auprc_score: 0.9941; val_best_acc_score: 0.9617; val_best_f1_score: 0.9778; train_kl_reg_loss: 2072.4365; train_edge_recon_loss: 76756.2338; train_gene_expr_recon_loss: 92824.2801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171652.9498; train_optim_loss: 171652.9498; val_kl_reg_loss: 2007.4811; val_edge_recon_loss: 77952.3984; val_gene_expr_recon_loss: 93068.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173027.8828; val_optim_loss: 173027.8828

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000004e-08.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9802; val_auprc_score: 0.9958; val_best_acc_score: 0.9647; val_best_f1_score: 0.9795; train_kl_reg_loss: 2072.2251; train_edge_recon_loss: 77260.0748; train_gene_expr_recon_loss: 92859.6289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172191.9286; train_optim_loss: 172191.9286; val_kl_reg_loss: 2009.0879; val_edge_recon_loss: 76477.2773; val_gene_expr_recon_loss: 92996.8242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171483.1875; val_optim_loss: 171483.1875
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9780; val_auprc_score: 0.9949; val_best_acc_score: 0.9638; val_best_f1_score: 0.9790; train_kl_reg_loss: 2072.8880; train_edge_recon_loss: 76986.2165; train_gene_expr_recon_loss: 92941.2210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172000.3270; train_optim_loss: 172000.3270; val_kl_reg_loss: 2006.0815; val_edge_recon_loss: 77052.6289; val_gene_expr_recon_loss: 92744.2227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171802.9375; val_optim_loss: 171802.9375
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9793; val_auprc_score: 0.9956; val_best_acc_score: 0.9628; val_best_f1_score: 0.9785; train_kl_reg_loss: 2072.8177; train_edge_recon_loss: 77881.6183; train_gene_expr_recon_loss: 92853.9068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172808.3415; train_optim_loss: 172808.3415; val_kl_reg_loss: 2002.0279; val_edge_recon_loss: 76593.0898; val_gene_expr_recon_loss: 92817.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171412.5312; val_optim_loss: 171412.5312
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9788; val_auprc_score: 0.9950; val_best_acc_score: 0.9638; val_best_f1_score: 0.9790; train_kl_reg_loss: 2071.4433; train_edge_recon_loss: 76774.5681; train_gene_expr_recon_loss: 92881.1959; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171727.2076; train_optim_loss: 171727.2076; val_kl_reg_loss: 2011.6564; val_edge_recon_loss: 76233.6797; val_gene_expr_recon_loss: 92900.6992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171146.0391; val_optim_loss: 171146.0391
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9767; val_auprc_score: 0.9944; val_best_acc_score: 0.9642; val_best_f1_score: 0.9793; train_kl_reg_loss: 2072.1324; train_edge_recon_loss: 76746.0084; train_gene_expr_recon_loss: 92818.2243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171636.3650; train_optim_loss: 171636.3650; val_kl_reg_loss: 2009.5286; val_edge_recon_loss: 74559.4492; val_gene_expr_recon_loss: 93472.5039; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170041.4766; val_optim_loss: 170041.4766
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9767; val_auprc_score: 0.9941; val_best_acc_score: 0.9629; val_best_f1_score: 0.9784; train_kl_reg_loss: 2072.9159; train_edge_recon_loss: 76675.7137; train_gene_expr_recon_loss: 92870.7522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171619.3817; train_optim_loss: 171619.3817; val_kl_reg_loss: 2007.2932; val_edge_recon_loss: 78594.6133; val_gene_expr_recon_loss: 93264.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173866.6406; val_optim_loss: 173866.6406
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9812; val_auprc_score: 0.9961; val_best_acc_score: 0.9623; val_best_f1_score: 0.9780; train_kl_reg_loss: 2071.2860; train_edge_recon_loss: 77344.5329; train_gene_expr_recon_loss: 92860.3571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172276.1741; train_optim_loss: 172276.1741; val_kl_reg_loss: 2003.2445; val_edge_recon_loss: 78360.8164; val_gene_expr_recon_loss: 92635.0352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172999.0938; val_optim_loss: 172999.0938
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9754; val_auprc_score: 0.9940; val_best_acc_score: 0.9604; val_best_f1_score: 0.9771; train_kl_reg_loss: 2072.8799; train_edge_recon_loss: 77131.6200; train_gene_expr_recon_loss: 92878.1300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172082.6283; train_optim_loss: 172082.6283; val_kl_reg_loss: 2007.7005; val_edge_recon_loss: 76403.6836; val_gene_expr_recon_loss: 92898.1680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171309.5547; val_optim_loss: 171309.5547

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000005e-09.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9791; val_auprc_score: 0.9955; val_best_acc_score: 0.9621; val_best_f1_score: 0.9780; train_kl_reg_loss: 2071.6416; train_edge_recon_loss: 76547.7522; train_gene_expr_recon_loss: 92819.7723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171439.1652; train_optim_loss: 171439.1652; val_kl_reg_loss: 2011.0256; val_edge_recon_loss: 77638.9102; val_gene_expr_recon_loss: 92873.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172523.1562; val_optim_loss: 172523.1562
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9790; val_auprc_score: 0.9936; val_best_acc_score: 0.9621; val_best_f1_score: 0.9779; train_kl_reg_loss: 2073.2278; train_edge_recon_loss: 76903.7494; train_gene_expr_recon_loss: 92871.6959; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171848.6730; train_optim_loss: 171848.6730; val_kl_reg_loss: 2007.5072; val_edge_recon_loss: 79394.3867; val_gene_expr_recon_loss: 93203.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174605.7188; val_optim_loss: 174605.7188
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9741; val_auprc_score: 0.9941; val_best_acc_score: 0.9578; val_best_f1_score: 0.9756; train_kl_reg_loss: 2071.2868; train_edge_recon_loss: 77094.3253; train_gene_expr_recon_loss: 92868.7288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172034.3415; train_optim_loss: 172034.3415; val_kl_reg_loss: 2001.8417; val_edge_recon_loss: 78129.2500; val_gene_expr_recon_loss: 92794.0352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172925.1328; val_optim_loss: 172925.1328

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 9 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9751
Val AUPRC score: 0.9936
Val best accuracy score: 0.9628
Val best F1 score: 0.9786
Val gene expr MSE score: 1.1202
Duration of model training in run 1: 0 hours, 4 minutes and 17 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9679; val_auprc_score: 0.9936; val_best_acc_score: 0.9404; val_best_f1_score: 0.9653; train_kl_reg_loss: 163.2392; train_edge_recon_loss: 101383.4129; train_gene_expr_recon_loss: 111863.7427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213410.3951; train_optim_loss: 213410.3951; val_kl_reg_loss: 120.8684; val_edge_recon_loss: 107153.6484; val_gene_expr_recon_loss: 102902.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210176.7734; val_optim_loss: 210176.7734
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9209; val_auprc_score: 0.9814; val_best_acc_score: 0.9207; val_best_f1_score: 0.9545; train_kl_reg_loss: 513.9976; train_edge_recon_loss: 93905.5151; train_gene_expr_recon_loss: 102231.2645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196650.7746; train_optim_loss: 196650.7746; val_kl_reg_loss: 1838.1715; val_edge_recon_loss: 81724.7891; val_gene_expr_recon_loss: 101617.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185180.8906; val_optim_loss: 185180.8906
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9269; val_auprc_score: 0.9840; val_best_acc_score: 0.9228; val_best_f1_score: 0.9557; train_kl_reg_loss: 3132.4044; train_edge_recon_loss: 80018.6724; train_gene_expr_recon_loss: 99857.5831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183008.6607; train_optim_loss: 183008.6607; val_kl_reg_loss: 3192.7131; val_edge_recon_loss: 81492.7070; val_gene_expr_recon_loss: 98566.4336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183251.8594; val_optim_loss: 183251.8594
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9445; val_auprc_score: 0.9878; val_best_acc_score: 0.9298; val_best_f1_score: 0.9595; train_kl_reg_loss: 2574.5334; train_edge_recon_loss: 78764.5787; train_gene_expr_recon_loss: 98297.4939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179636.6049; train_optim_loss: 179636.6049; val_kl_reg_loss: 2035.9376; val_edge_recon_loss: 80541.5586; val_gene_expr_recon_loss: 97789.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180367.1172; val_optim_loss: 180367.1172
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9579; val_auprc_score: 0.9912; val_best_acc_score: 0.9392; val_best_f1_score: 0.9647; train_kl_reg_loss: 2182.0039; train_edge_recon_loss: 79076.7266; train_gene_expr_recon_loss: 97266.0859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178524.8158; train_optim_loss: 178524.8158; val_kl_reg_loss: 2266.3268; val_edge_recon_loss: 80597.2344; val_gene_expr_recon_loss: 97055.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179918.7500; val_optim_loss: 179918.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9614; val_auprc_score: 0.9918; val_best_acc_score: 0.9455; val_best_f1_score: 0.9686; train_kl_reg_loss: 2229.1439; train_edge_recon_loss: 78534.8410; train_gene_expr_recon_loss: 96497.8610; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177261.8460; train_optim_loss: 177261.8460; val_kl_reg_loss: 2089.8831; val_edge_recon_loss: 79346.4609; val_gene_expr_recon_loss: 96124.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177560.6406; val_optim_loss: 177560.6406
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9675; val_auprc_score: 0.9927; val_best_acc_score: 0.9530; val_best_f1_score: 0.9729; train_kl_reg_loss: 2179.6755; train_edge_recon_loss: 77117.3728; train_gene_expr_recon_loss: 95766.6177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175063.6663; train_optim_loss: 175063.6663; val_kl_reg_loss: 2143.2488; val_edge_recon_loss: 75671.2305; val_gene_expr_recon_loss: 95894.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173708.7578; val_optim_loss: 173708.7578
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9757; val_auprc_score: 0.9948; val_best_acc_score: 0.9562; val_best_f1_score: 0.9747; train_kl_reg_loss: 2146.8791; train_edge_recon_loss: 77523.5960; train_gene_expr_recon_loss: 95302.1099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174972.5859; train_optim_loss: 174972.5859; val_kl_reg_loss: 2083.0906; val_edge_recon_loss: 76768.6172; val_gene_expr_recon_loss: 94498.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173350.5469; val_optim_loss: 173350.5469
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9740; val_auprc_score: 0.9941; val_best_acc_score: 0.9602; val_best_f1_score: 0.9770; train_kl_reg_loss: 2152.7325; train_edge_recon_loss: 77455.9922; train_gene_expr_recon_loss: 94715.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174324.5056; train_optim_loss: 174324.5056; val_kl_reg_loss: 2094.2522; val_edge_recon_loss: 77282.0195; val_gene_expr_recon_loss: 94379.1211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173755.3906; val_optim_loss: 173755.3906
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9793; val_auprc_score: 0.9956; val_best_acc_score: 0.9634; val_best_f1_score: 0.9788; train_kl_reg_loss: 2115.5572; train_edge_recon_loss: 77293.9269; train_gene_expr_recon_loss: 94396.4989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173805.9833; train_optim_loss: 173805.9833; val_kl_reg_loss: 2060.3361; val_edge_recon_loss: 74943.5195; val_gene_expr_recon_loss: 93779.0977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170782.9531; val_optim_loss: 170782.9531
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9759; val_auprc_score: 0.9939; val_best_acc_score: 0.9614; val_best_f1_score: 0.9776; train_kl_reg_loss: 2105.8378; train_edge_recon_loss: 76857.0123; train_gene_expr_recon_loss: 93986.9118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172949.7634; train_optim_loss: 172949.7634; val_kl_reg_loss: 2017.7030; val_edge_recon_loss: 78082.9570; val_gene_expr_recon_loss: 93291.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173392.6484; val_optim_loss: 173392.6484
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9774; val_auprc_score: 0.9938; val_best_acc_score: 0.9625; val_best_f1_score: 0.9782; train_kl_reg_loss: 2081.9309; train_edge_recon_loss: 77000.7545; train_gene_expr_recon_loss: 93428.8627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172511.5458; train_optim_loss: 172511.5458; val_kl_reg_loss: 2038.6375; val_edge_recon_loss: 78428.6680; val_gene_expr_recon_loss: 93163.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173630.7812; val_optim_loss: 173630.7812
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9787; val_auprc_score: 0.9943; val_best_acc_score: 0.9622; val_best_f1_score: 0.9780; train_kl_reg_loss: 2054.5586; train_edge_recon_loss: 76281.0028; train_gene_expr_recon_loss: 93127.9983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171463.5592; train_optim_loss: 171463.5592; val_kl_reg_loss: 2015.6116; val_edge_recon_loss: 78834.2344; val_gene_expr_recon_loss: 93007.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173857.0000; val_optim_loss: 173857.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9787; val_auprc_score: 0.9949; val_best_acc_score: 0.9630; val_best_f1_score: 0.9785; train_kl_reg_loss: 2050.8198; train_edge_recon_loss: 76384.3181; train_gene_expr_recon_loss: 93003.9788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171439.1161; train_optim_loss: 171439.1161; val_kl_reg_loss: 1989.1404; val_edge_recon_loss: 77059.3164; val_gene_expr_recon_loss: 93048.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172097.1406; val_optim_loss: 172097.1406
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9793; val_auprc_score: 0.9954; val_best_acc_score: 0.9642; val_best_f1_score: 0.9792; train_kl_reg_loss: 2049.7927; train_edge_recon_loss: 76702.7807; train_gene_expr_recon_loss: 92964.7154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171717.2902; train_optim_loss: 171717.2902; val_kl_reg_loss: 1992.6125; val_edge_recon_loss: 77481.5469; val_gene_expr_recon_loss: 93113.8867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172588.0469; val_optim_loss: 172588.0469
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9790; val_auprc_score: 0.9952; val_best_acc_score: 0.9630; val_best_f1_score: 0.9784; train_kl_reg_loss: 2040.5953; train_edge_recon_loss: 76691.1574; train_gene_expr_recon_loss: 92981.4883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171713.2388; train_optim_loss: 171713.2388; val_kl_reg_loss: 1986.7731; val_edge_recon_loss: 78920.8164; val_gene_expr_recon_loss: 92882.5508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173790.1406; val_optim_loss: 173790.1406

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 33 sec.
Using best model state, which was in epoch 10.

--- MODEL EVALUATION ---
Val AUROC score: 0.9776
Val AUPRC score: 0.9951
Val best accuracy score: 0.9621
Val best F1 score: 0.9779
Val gene expr MSE score: 1.1539
Duration of model training in run 2: 0 hours, 1 minutes and 36 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 214020
Number of validation edges: 23779
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9444; val_auprc_score: 0.9883; val_best_acc_score: 0.9312; val_best_f1_score: 0.9604; train_kl_reg_loss: 1300.0311; train_edge_recon_loss: 91884.6660; train_gene_expr_recon_loss: 101344.5874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194529.2836; train_optim_loss: 194529.2836; val_kl_reg_loss: 2369.1792; val_edge_recon_loss: 80268.4375; val_gene_expr_recon_loss: 96091.8763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178729.4948; val_optim_loss: 178729.4948
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9765; val_auprc_score: 0.9944; val_best_acc_score: 0.9591; val_best_f1_score: 0.9762; train_kl_reg_loss: 2147.3234; train_edge_recon_loss: 78681.6411; train_gene_expr_recon_loss: 94292.3629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175121.3269; train_optim_loss: 175121.3269; val_kl_reg_loss: 2119.6142; val_edge_recon_loss: 78200.0221; val_gene_expr_recon_loss: 94315.3841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174635.0208; val_optim_loss: 174635.0208
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9836; val_auprc_score: 0.9963; val_best_acc_score: 0.9686; val_best_f1_score: 0.9819; train_kl_reg_loss: 2078.0435; train_edge_recon_loss: 77770.8118; train_gene_expr_recon_loss: 92457.5548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172306.4104; train_optim_loss: 172306.4104; val_kl_reg_loss: 2034.1111; val_edge_recon_loss: 75365.7669; val_gene_expr_recon_loss: 92414.9128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169814.7891; val_optim_loss: 169814.7891
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9858; val_auprc_score: 0.9968; val_best_acc_score: 0.9705; val_best_f1_score: 0.9828; train_kl_reg_loss: 2048.0745; train_edge_recon_loss: 77096.8034; train_gene_expr_recon_loss: 91242.8471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170387.7249; train_optim_loss: 170387.7249; val_kl_reg_loss: 1971.4000; val_edge_recon_loss: 78071.3633; val_gene_expr_recon_loss: 91511.1081; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171553.8698; val_optim_loss: 171553.8698
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9857; val_auprc_score: 0.9956; val_best_acc_score: 0.9729; val_best_f1_score: 0.9842; train_kl_reg_loss: 1996.1116; train_edge_recon_loss: 76640.7749; train_gene_expr_recon_loss: 90387.3180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169024.2046; train_optim_loss: 169024.2046; val_kl_reg_loss: 1951.8071; val_edge_recon_loss: 78019.6523; val_gene_expr_recon_loss: 91052.7826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171024.2448; val_optim_loss: 171024.2448
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9882; val_auprc_score: 0.9969; val_best_acc_score: 0.9767; val_best_f1_score: 0.9864; train_kl_reg_loss: 1972.0977; train_edge_recon_loss: 76910.0927; train_gene_expr_recon_loss: 89681.6278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168563.8187; train_optim_loss: 168563.8187; val_kl_reg_loss: 1920.0483; val_edge_recon_loss: 76895.3971; val_gene_expr_recon_loss: 90117.5677; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168933.0130; val_optim_loss: 168933.0130
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9893; val_auprc_score: 0.9976; val_best_acc_score: 0.9779; val_best_f1_score: 0.9872; train_kl_reg_loss: 1955.2566; train_edge_recon_loss: 76568.9348; train_gene_expr_recon_loss: 89238.1159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167762.3060; train_optim_loss: 167762.3060; val_kl_reg_loss: 1927.4921; val_edge_recon_loss: 75388.0013; val_gene_expr_recon_loss: 89824.3568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167139.8438; val_optim_loss: 167139.8438
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9905; val_auprc_score: 0.9980; val_best_acc_score: 0.9793; val_best_f1_score: 0.9879; train_kl_reg_loss: 1959.0990; train_edge_recon_loss: 76680.9228; train_gene_expr_recon_loss: 88847.6467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167487.6675; train_optim_loss: 167487.6675; val_kl_reg_loss: 1906.4625; val_edge_recon_loss: 75546.9805; val_gene_expr_recon_loss: 89591.6745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167045.1172; val_optim_loss: 167045.1172
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9900; val_auprc_score: 0.9974; val_best_acc_score: 0.9792; val_best_f1_score: 0.9878; train_kl_reg_loss: 1962.9845; train_edge_recon_loss: 77056.0780; train_gene_expr_recon_loss: 88504.1294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167523.1925; train_optim_loss: 167523.1925; val_kl_reg_loss: 1935.6822; val_edge_recon_loss: 77434.3984; val_gene_expr_recon_loss: 88991.6615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168361.7396; val_optim_loss: 168361.7396
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9899; val_auprc_score: 0.9975; val_best_acc_score: 0.9804; val_best_f1_score: 0.9886; train_kl_reg_loss: 1956.2289; train_edge_recon_loss: 77023.8760; train_gene_expr_recon_loss: 87982.7432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166962.8496; train_optim_loss: 166962.8496; val_kl_reg_loss: 1909.6427; val_edge_recon_loss: 76501.5716; val_gene_expr_recon_loss: 88387.1654; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166798.3854; val_optim_loss: 166798.3854
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9913; val_auprc_score: 0.9976; val_best_acc_score: 0.9816; val_best_f1_score: 0.9893; train_kl_reg_loss: 1949.9847; train_edge_recon_loss: 75953.0656; train_gene_expr_recon_loss: 87666.3249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165569.3756; train_optim_loss: 165569.3756; val_kl_reg_loss: 1903.5617; val_edge_recon_loss: 76823.0885; val_gene_expr_recon_loss: 88815.4870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167542.1354; val_optim_loss: 167542.1354
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9909; val_auprc_score: 0.9971; val_best_acc_score: 0.9817; val_best_f1_score: 0.9893; train_kl_reg_loss: 1947.0095; train_edge_recon_loss: 76565.1508; train_gene_expr_recon_loss: 87487.3639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165999.5251; train_optim_loss: 165999.5251; val_kl_reg_loss: 1963.0115; val_edge_recon_loss: 75060.3112; val_gene_expr_recon_loss: 88378.0495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165401.3724; val_optim_loss: 165401.3724
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9908; val_auprc_score: 0.9972; val_best_acc_score: 0.9822; val_best_f1_score: 0.9896; train_kl_reg_loss: 1951.7443; train_edge_recon_loss: 76221.8177; train_gene_expr_recon_loss: 87138.5884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165312.1509; train_optim_loss: 165312.1509; val_kl_reg_loss: 1922.5848; val_edge_recon_loss: 77083.1927; val_gene_expr_recon_loss: 88579.2409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167585.0208; val_optim_loss: 167585.0208
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9929; val_auprc_score: 0.9985; val_best_acc_score: 0.9830; val_best_f1_score: 0.9901; train_kl_reg_loss: 1948.5337; train_edge_recon_loss: 75412.9506; train_gene_expr_recon_loss: 86815.2389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164176.7235; train_optim_loss: 164176.7235; val_kl_reg_loss: 1932.3271; val_edge_recon_loss: 76373.0234; val_gene_expr_recon_loss: 87376.4753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165681.8255; val_optim_loss: 165681.8255
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9911; val_auprc_score: 0.9975; val_best_acc_score: 0.9826; val_best_f1_score: 0.9898; train_kl_reg_loss: 1954.4773; train_edge_recon_loss: 76483.9082; train_gene_expr_recon_loss: 86693.8010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165132.1872; train_optim_loss: 165132.1872; val_kl_reg_loss: 1911.8195; val_edge_recon_loss: 76219.9206; val_gene_expr_recon_loss: 87721.3568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165853.0964; val_optim_loss: 165853.0964

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9925; val_auprc_score: 0.9983; val_best_acc_score: 0.9829; val_best_f1_score: 0.9901; train_kl_reg_loss: 1945.1706; train_edge_recon_loss: 75952.2062; train_gene_expr_recon_loss: 86433.2904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164330.6680; train_optim_loss: 164330.6680; val_kl_reg_loss: 1909.3771; val_edge_recon_loss: 75658.9102; val_gene_expr_recon_loss: 87407.4805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164975.7682; val_optim_loss: 164975.7682
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9911; val_auprc_score: 0.9973; val_best_acc_score: 0.9833; val_best_f1_score: 0.9903; train_kl_reg_loss: 1944.5256; train_edge_recon_loss: 76078.8353; train_gene_expr_recon_loss: 86392.3408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164415.7028; train_optim_loss: 164415.7028; val_kl_reg_loss: 1917.2562; val_edge_recon_loss: 75944.6953; val_gene_expr_recon_loss: 86651.3698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164513.3203; val_optim_loss: 164513.3203
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9922; val_auprc_score: 0.9973; val_best_acc_score: 0.9833; val_best_f1_score: 0.9902; train_kl_reg_loss: 1946.2169; train_edge_recon_loss: 76306.2686; train_gene_expr_recon_loss: 86355.3669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164607.8538; train_optim_loss: 164607.8538; val_kl_reg_loss: 1899.4931; val_edge_recon_loss: 77647.4414; val_gene_expr_recon_loss: 86552.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166099.5260; val_optim_loss: 166099.5260
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9921; val_auprc_score: 0.9983; val_best_acc_score: 0.9832; val_best_f1_score: 0.9902; train_kl_reg_loss: 1943.7399; train_edge_recon_loss: 76168.0010; train_gene_expr_recon_loss: 86320.7011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164432.4413; train_optim_loss: 164432.4413; val_kl_reg_loss: 1909.9035; val_edge_recon_loss: 75414.3646; val_gene_expr_recon_loss: 87291.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164616.0755; val_optim_loss: 164616.0755
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9919; val_auprc_score: 0.9976; val_best_acc_score: 0.9832; val_best_f1_score: 0.9902; train_kl_reg_loss: 1946.0788; train_edge_recon_loss: 76703.3620; train_gene_expr_recon_loss: 86292.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164942.0775; train_optim_loss: 164942.0775; val_kl_reg_loss: 1913.7858; val_edge_recon_loss: 75195.5482; val_gene_expr_recon_loss: 87598.0951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164707.4271; val_optim_loss: 164707.4271

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9932; val_auprc_score: 0.9985; val_best_acc_score: 0.9845; val_best_f1_score: 0.9909; train_kl_reg_loss: 1943.1481; train_edge_recon_loss: 75750.4207; train_gene_expr_recon_loss: 86283.5879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163977.1577; train_optim_loss: 163977.1577; val_kl_reg_loss: 1913.6106; val_edge_recon_loss: 76413.8984; val_gene_expr_recon_loss: 86515.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164843.3776; val_optim_loss: 164843.3776
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9919; val_auprc_score: 0.9978; val_best_acc_score: 0.9832; val_best_f1_score: 0.9902; train_kl_reg_loss: 1946.0064; train_edge_recon_loss: 76230.9851; train_gene_expr_recon_loss: 86248.2045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164425.1975; train_optim_loss: 164425.1975; val_kl_reg_loss: 1917.6081; val_edge_recon_loss: 76300.2591; val_gene_expr_recon_loss: 87369.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165587.1953; val_optim_loss: 165587.1953
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9921; val_auprc_score: 0.9976; val_best_acc_score: 0.9833; val_best_f1_score: 0.9902; train_kl_reg_loss: 1945.8960; train_edge_recon_loss: 75858.6787; train_gene_expr_recon_loss: 86249.4065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164053.9811; train_optim_loss: 164053.9811; val_kl_reg_loss: 1910.5915; val_edge_recon_loss: 77420.8880; val_gene_expr_recon_loss: 87146.8229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166478.3047; val_optim_loss: 166478.3047

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 31 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
Val AUROC score: 0.9927
Val AUPRC score: 0.9982
Val best accuracy score: 0.9839
Val best F1 score: 0.9906
Val gene expr MSE score: 0.9259
Duration of model training in run 3: 0 hours, 6 minutes and 37 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 214020
Number of validation edges: 23779
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9446; val_auprc_score: 0.9885; val_best_acc_score: 0.9324; val_best_f1_score: 0.9611; train_kl_reg_loss: 1308.3429; train_edge_recon_loss: 91409.2556; train_gene_expr_recon_loss: 102055.8785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194773.4764; train_optim_loss: 194773.4764; val_kl_reg_loss: 2452.0452; val_edge_recon_loss: 79482.7096; val_gene_expr_recon_loss: 96395.6693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178330.4245; val_optim_loss: 178330.4245
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9767; val_auprc_score: 0.9951; val_best_acc_score: 0.9602; val_best_f1_score: 0.9768; train_kl_reg_loss: 2152.1448; train_edge_recon_loss: 78860.3163; train_gene_expr_recon_loss: 94821.7642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175834.2249; train_optim_loss: 175834.2249; val_kl_reg_loss: 2032.1295; val_edge_recon_loss: 78101.7891; val_gene_expr_recon_loss: 92710.2617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172844.1823; val_optim_loss: 172844.1823
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9832; val_auprc_score: 0.9956; val_best_acc_score: 0.9703; val_best_f1_score: 0.9826; train_kl_reg_loss: 2095.6498; train_edge_recon_loss: 77639.7028; train_gene_expr_recon_loss: 92708.1732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172443.5245; train_optim_loss: 172443.5245; val_kl_reg_loss: 1999.3991; val_edge_recon_loss: 78213.3255; val_gene_expr_recon_loss: 91871.3763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172084.1042; val_optim_loss: 172084.1042
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9854; val_auprc_score: 0.9965; val_best_acc_score: 0.9736; val_best_f1_score: 0.9847; train_kl_reg_loss: 2036.5960; train_edge_recon_loss: 77035.3408; train_gene_expr_recon_loss: 91600.3467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170672.2830; train_optim_loss: 170672.2830; val_kl_reg_loss: 1976.6502; val_edge_recon_loss: 76642.1432; val_gene_expr_recon_loss: 90624.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169243.1250; val_optim_loss: 169243.1250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9874; val_auprc_score: 0.9971; val_best_acc_score: 0.9749; val_best_f1_score: 0.9854; train_kl_reg_loss: 1994.6941; train_edge_recon_loss: 76699.6170; train_gene_expr_recon_loss: 90740.3927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169434.7040; train_optim_loss: 169434.7040; val_kl_reg_loss: 1928.9879; val_edge_recon_loss: 77460.3659; val_gene_expr_recon_loss: 89274.8932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168664.2474; val_optim_loss: 168664.2474
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9899; val_auprc_score: 0.9976; val_best_acc_score: 0.9779; val_best_f1_score: 0.9871; train_kl_reg_loss: 1967.3719; train_edge_recon_loss: 76834.2873; train_gene_expr_recon_loss: 90010.0264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168811.6857; train_optim_loss: 168811.6857; val_kl_reg_loss: 1918.4634; val_edge_recon_loss: 76163.9362; val_gene_expr_recon_loss: 89456.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167538.8516; val_optim_loss: 167538.8516
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9896; val_auprc_score: 0.9976; val_best_acc_score: 0.9794; val_best_f1_score: 0.9880; train_kl_reg_loss: 1962.5162; train_edge_recon_loss: 76525.7361; train_gene_expr_recon_loss: 89478.6095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167966.8617; train_optim_loss: 167966.8617; val_kl_reg_loss: 1929.3924; val_edge_recon_loss: 77142.4440; val_gene_expr_recon_loss: 88436.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167508.1719; val_optim_loss: 167508.1719
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9901; val_auprc_score: 0.9977; val_best_acc_score: 0.9803; val_best_f1_score: 0.9885; train_kl_reg_loss: 1948.1301; train_edge_recon_loss: 76180.9584; train_gene_expr_recon_loss: 88964.0744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167093.1616; train_optim_loss: 167093.1616; val_kl_reg_loss: 1894.4109; val_edge_recon_loss: 76757.8802; val_gene_expr_recon_loss: 88146.4232; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166798.7214; val_optim_loss: 166798.7214
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9902; val_auprc_score: 0.9975; val_best_acc_score: 0.9811; val_best_f1_score: 0.9889; train_kl_reg_loss: 1951.5924; train_edge_recon_loss: 76434.8762; train_gene_expr_recon_loss: 88649.7121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167036.1810; train_optim_loss: 167036.1810; val_kl_reg_loss: 1934.3627; val_edge_recon_loss: 75489.1758; val_gene_expr_recon_loss: 87603.7956; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165027.3333; val_optim_loss: 165027.3333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9913; val_auprc_score: 0.9977; val_best_acc_score: 0.9815; val_best_f1_score: 0.9892; train_kl_reg_loss: 1946.5821; train_edge_recon_loss: 76143.4769; train_gene_expr_recon_loss: 88221.4030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166311.4623; train_optim_loss: 166311.4623; val_kl_reg_loss: 1884.2134; val_edge_recon_loss: 77986.2318; val_gene_expr_recon_loss: 87213.0716; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167083.5156; val_optim_loss: 167083.5156
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9919; val_auprc_score: 0.9979; val_best_acc_score: 0.9820; val_best_f1_score: 0.9895; train_kl_reg_loss: 1945.5136; train_edge_recon_loss: 76345.0553; train_gene_expr_recon_loss: 87906.4518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166197.0198; train_optim_loss: 166197.0198; val_kl_reg_loss: 1872.0659; val_edge_recon_loss: 76631.8971; val_gene_expr_recon_loss: 87333.8880; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165837.8516; val_optim_loss: 165837.8516
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9926; val_auprc_score: 0.9983; val_best_acc_score: 0.9844; val_best_f1_score: 0.9909; train_kl_reg_loss: 1949.5038; train_edge_recon_loss: 76363.0674; train_gene_expr_recon_loss: 87638.9441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165951.5147; train_optim_loss: 165951.5147; val_kl_reg_loss: 1912.0464; val_edge_recon_loss: 75924.0807; val_gene_expr_recon_loss: 87738.2995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165574.4271; val_optim_loss: 165574.4271

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9921; val_auprc_score: 0.9981; val_best_acc_score: 0.9831; val_best_f1_score: 0.9902; train_kl_reg_loss: 1947.5765; train_edge_recon_loss: 77016.1421; train_gene_expr_recon_loss: 87326.2167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166289.9369; train_optim_loss: 166289.9369; val_kl_reg_loss: 1909.0720; val_edge_recon_loss: 75872.5964; val_gene_expr_recon_loss: 86716.3346; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164498.0000; val_optim_loss: 164498.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9937; val_auprc_score: 0.9985; val_best_acc_score: 0.9838; val_best_f1_score: 0.9905; train_kl_reg_loss: 1942.4061; train_edge_recon_loss: 76178.7123; train_gene_expr_recon_loss: 87283.5584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165404.6760; train_optim_loss: 165404.6760; val_kl_reg_loss: 1898.5379; val_edge_recon_loss: 75951.1992; val_gene_expr_recon_loss: 87384.3034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165234.0365; val_optim_loss: 165234.0365
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9936; val_auprc_score: 0.9985; val_best_acc_score: 0.9841; val_best_f1_score: 0.9908; train_kl_reg_loss: 1940.7507; train_edge_recon_loss: 76027.2758; train_gene_expr_recon_loss: 87200.9867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165169.0124; train_optim_loss: 165169.0124; val_kl_reg_loss: 1906.6866; val_edge_recon_loss: 75043.9661; val_gene_expr_recon_loss: 87121.7669; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164072.4219; val_optim_loss: 164072.4219
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9913; val_auprc_score: 0.9980; val_best_acc_score: 0.9824; val_best_f1_score: 0.9897; train_kl_reg_loss: 1938.6747; train_edge_recon_loss: 76147.3628; train_gene_expr_recon_loss: 87226.2183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165312.2556; train_optim_loss: 165312.2556; val_kl_reg_loss: 1905.2045; val_edge_recon_loss: 78047.5469; val_gene_expr_recon_loss: 86243.2096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166195.9635; val_optim_loss: 166195.9635
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9926; val_auprc_score: 0.9983; val_best_acc_score: 0.9840; val_best_f1_score: 0.9907; train_kl_reg_loss: 1936.7225; train_edge_recon_loss: 76122.8545; train_gene_expr_recon_loss: 87233.0408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165292.6185; train_optim_loss: 165292.6185; val_kl_reg_loss: 1890.0280; val_edge_recon_loss: 75110.5573; val_gene_expr_recon_loss: 86915.2773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163915.8620; val_optim_loss: 163915.8620
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9925; val_auprc_score: 0.9975; val_best_acc_score: 0.9825; val_best_f1_score: 0.9898; train_kl_reg_loss: 1939.6513; train_edge_recon_loss: 76212.7494; train_gene_expr_recon_loss: 87180.6251; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165333.0271; train_optim_loss: 165333.0271; val_kl_reg_loss: 1901.2526; val_edge_recon_loss: 76476.4440; val_gene_expr_recon_loss: 86489.7760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164867.4740; val_optim_loss: 164867.4740
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9935; val_auprc_score: 0.9985; val_best_acc_score: 0.9833; val_best_f1_score: 0.9902; train_kl_reg_loss: 1935.9523; train_edge_recon_loss: 75494.7300; train_gene_expr_recon_loss: 87262.1579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164692.8402; train_optim_loss: 164692.8402; val_kl_reg_loss: 1895.1244; val_edge_recon_loss: 77244.1589; val_gene_expr_recon_loss: 86122.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165262.0885; val_optim_loss: 165262.0885
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9922; val_auprc_score: 0.9982; val_best_acc_score: 0.9832; val_best_f1_score: 0.9902; train_kl_reg_loss: 1934.6707; train_edge_recon_loss: 75991.3477; train_gene_expr_recon_loss: 87115.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165041.8644; train_optim_loss: 165041.8644; val_kl_reg_loss: 1887.6714; val_edge_recon_loss: 76006.5352; val_gene_expr_recon_loss: 86026.7982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163921.0052; val_optim_loss: 163921.0052

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9927; val_auprc_score: 0.9978; val_best_acc_score: 0.9850; val_best_f1_score: 0.9913; train_kl_reg_loss: 1930.4896; train_edge_recon_loss: 76089.1688; train_gene_expr_recon_loss: 87047.0162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165066.6742; train_optim_loss: 165066.6742; val_kl_reg_loss: 1897.4421; val_edge_recon_loss: 75508.6771; val_gene_expr_recon_loss: 86761.1862; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164167.3047; val_optim_loss: 164167.3047
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9935; val_auprc_score: 0.9985; val_best_acc_score: 0.9845; val_best_f1_score: 0.9909; train_kl_reg_loss: 1936.0875; train_edge_recon_loss: 76311.7155; train_gene_expr_recon_loss: 87010.8205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165258.6232; train_optim_loss: 165258.6232; val_kl_reg_loss: 1902.1443; val_edge_recon_loss: 76688.3255; val_gene_expr_recon_loss: 86355.2240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164945.6927; val_optim_loss: 164945.6927
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9913; val_auprc_score: 0.9980; val_best_acc_score: 0.9838; val_best_f1_score: 0.9906; train_kl_reg_loss: 1937.8838; train_edge_recon_loss: 75343.5363; train_gene_expr_recon_loss: 87163.5889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164445.0080; train_optim_loss: 164445.0080; val_kl_reg_loss: 1900.7059; val_edge_recon_loss: 76444.7786; val_gene_expr_recon_loss: 86403.8216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164749.3047; val_optim_loss: 164749.3047

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 13 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
Val AUROC score: 0.9917
Val AUPRC score: 0.9980
Val best accuracy score: 0.9831
Val best F1 score: 0.9901
Val gene expr MSE score: 0.9079
Duration of model training in run 4: 0 hours, 6 minutes and 20 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 319410
Number of validation edges: 35490
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9849; val_auprc_score: 0.9965; val_best_acc_score: 0.9711; val_best_f1_score: 0.9831; train_kl_reg_loss: 1720.5793; train_edge_recon_loss: 83989.1567; train_gene_expr_recon_loss: 96308.1412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182017.8769; train_optim_loss: 182017.8769; val_kl_reg_loss: 1995.9873; val_edge_recon_loss: 76661.6797; val_gene_expr_recon_loss: 92605.5590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171263.2248; val_optim_loss: 171263.2248
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9870; val_auprc_score: 0.9968; val_best_acc_score: 0.9752; val_best_f1_score: 0.9855; train_kl_reg_loss: 2024.1062; train_edge_recon_loss: 77222.1565; train_gene_expr_recon_loss: 90452.4603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169698.7231; train_optim_loss: 169698.7231; val_kl_reg_loss: 1958.8793; val_edge_recon_loss: 77502.6953; val_gene_expr_recon_loss: 90329.6554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169791.2292; val_optim_loss: 169791.2292
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9923; val_auprc_score: 0.9981; val_best_acc_score: 0.9798; val_best_f1_score: 0.9883; train_kl_reg_loss: 1959.3533; train_edge_recon_loss: 76919.9254; train_gene_expr_recon_loss: 88977.8036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167857.0829; train_optim_loss: 167857.0829; val_kl_reg_loss: 1960.8364; val_edge_recon_loss: 75813.6736; val_gene_expr_recon_loss: 88893.5052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166668.0156; val_optim_loss: 166668.0156
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9900; val_auprc_score: 0.9972; val_best_acc_score: 0.9813; val_best_f1_score: 0.9891; train_kl_reg_loss: 1938.6455; train_edge_recon_loss: 76182.5713; train_gene_expr_recon_loss: 87832.7157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165953.9325; train_optim_loss: 165953.9325; val_kl_reg_loss: 1921.7966; val_edge_recon_loss: 75956.0616; val_gene_expr_recon_loss: 87911.3051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165789.1641; val_optim_loss: 165789.1641
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9931; val_auprc_score: 0.9984; val_best_acc_score: 0.9849; val_best_f1_score: 0.9912; train_kl_reg_loss: 1933.3254; train_edge_recon_loss: 76459.4117; train_gene_expr_recon_loss: 87009.5987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165402.3358; train_optim_loss: 165402.3358; val_kl_reg_loss: 1949.1327; val_edge_recon_loss: 75063.4466; val_gene_expr_recon_loss: 87260.6706; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164273.2509; val_optim_loss: 164273.2509
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9925; val_auprc_score: 0.9975; val_best_acc_score: 0.9847; val_best_f1_score: 0.9910; train_kl_reg_loss: 1935.4760; train_edge_recon_loss: 76145.4651; train_gene_expr_recon_loss: 86358.5321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164439.4737; train_optim_loss: 164439.4737; val_kl_reg_loss: 1907.7794; val_edge_recon_loss: 76859.5582; val_gene_expr_recon_loss: 86831.3247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165598.6606; val_optim_loss: 165598.6606
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9936; val_auprc_score: 0.9978; val_best_acc_score: 0.9851; val_best_f1_score: 0.9913; train_kl_reg_loss: 1936.6816; train_edge_recon_loss: 76380.0197; train_gene_expr_recon_loss: 85959.7325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164276.4332; train_optim_loss: 164276.4332; val_kl_reg_loss: 1890.3821; val_edge_recon_loss: 77053.1215; val_gene_expr_recon_loss: 86733.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165676.8628; val_optim_loss: 165676.8628
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9948; val_auprc_score: 0.9987; val_best_acc_score: 0.9862; val_best_f1_score: 0.9920; train_kl_reg_loss: 1938.6131; train_edge_recon_loss: 75927.2811; train_gene_expr_recon_loss: 85500.4497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163366.3441; train_optim_loss: 163366.3441; val_kl_reg_loss: 1968.5988; val_edge_recon_loss: 75964.5473; val_gene_expr_recon_loss: 85902.5317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163835.6771; val_optim_loss: 163835.6771
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9937; val_auprc_score: 0.9985; val_best_acc_score: 0.9856; val_best_f1_score: 0.9916; train_kl_reg_loss: 1946.7083; train_edge_recon_loss: 76645.5818; train_gene_expr_recon_loss: 85037.0763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163629.3659; train_optim_loss: 163629.3659; val_kl_reg_loss: 1943.8126; val_edge_recon_loss: 77504.9041; val_gene_expr_recon_loss: 85339.0451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164787.7622; val_optim_loss: 164787.7622
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9944; val_auprc_score: 0.9987; val_best_acc_score: 0.9871; val_best_f1_score: 0.9924; train_kl_reg_loss: 1948.5007; train_edge_recon_loss: 75840.2700; train_gene_expr_recon_loss: 84728.8656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162517.6362; train_optim_loss: 162517.6362; val_kl_reg_loss: 1929.7355; val_edge_recon_loss: 76248.6220; val_gene_expr_recon_loss: 85023.6853; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163202.0434; val_optim_loss: 163202.0434
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9949; val_auprc_score: 0.9985; val_best_acc_score: 0.9870; val_best_f1_score: 0.9924; train_kl_reg_loss: 1957.3166; train_edge_recon_loss: 76532.3018; train_gene_expr_recon_loss: 84436.5903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162926.2091; train_optim_loss: 162926.2091; val_kl_reg_loss: 1933.6340; val_edge_recon_loss: 76080.2504; val_gene_expr_recon_loss: 84609.7899; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162623.6736; val_optim_loss: 162623.6736
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9946; val_auprc_score: 0.9981; val_best_acc_score: 0.9867; val_best_f1_score: 0.9922; train_kl_reg_loss: 1958.4972; train_edge_recon_loss: 75668.2298; train_gene_expr_recon_loss: 84067.5879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161694.3149; train_optim_loss: 161694.3149; val_kl_reg_loss: 1925.2148; val_edge_recon_loss: 77753.6003; val_gene_expr_recon_loss: 84528.7496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164207.5660; val_optim_loss: 164207.5660
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9956; val_auprc_score: 0.9989; val_best_acc_score: 0.9879; val_best_f1_score: 0.9929; train_kl_reg_loss: 1968.3486; train_edge_recon_loss: 76123.8697; train_gene_expr_recon_loss: 83940.1530; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162032.3720; train_optim_loss: 162032.3720; val_kl_reg_loss: 1957.5415; val_edge_recon_loss: 76675.8164; val_gene_expr_recon_loss: 84536.4371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163169.7960; val_optim_loss: 163169.7960
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9946; val_auprc_score: 0.9987; val_best_acc_score: 0.9874; val_best_f1_score: 0.9927; train_kl_reg_loss: 1970.2960; train_edge_recon_loss: 75793.4658; train_gene_expr_recon_loss: 83653.5271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161417.2893; train_optim_loss: 161417.2893; val_kl_reg_loss: 1938.6022; val_edge_recon_loss: 75744.8418; val_gene_expr_recon_loss: 84142.0560; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161825.4991; val_optim_loss: 161825.4991
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9956; val_auprc_score: 0.9989; val_best_acc_score: 0.9889; val_best_f1_score: 0.9935; train_kl_reg_loss: 1972.7394; train_edge_recon_loss: 75904.4291; train_gene_expr_recon_loss: 83380.2029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161257.3712; train_optim_loss: 161257.3712; val_kl_reg_loss: 1953.3923; val_edge_recon_loss: 75209.1940; val_gene_expr_recon_loss: 84253.3355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161415.9236; val_optim_loss: 161415.9236
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9963; val_auprc_score: 0.9992; val_best_acc_score: 0.9890; val_best_f1_score: 0.9936; train_kl_reg_loss: 1977.4822; train_edge_recon_loss: 75603.1377; train_gene_expr_recon_loss: 83228.7004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160809.3203; train_optim_loss: 160809.3203; val_kl_reg_loss: 1984.0312; val_edge_recon_loss: 75053.2409; val_gene_expr_recon_loss: 83815.4527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160852.7231; val_optim_loss: 160852.7231
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9950; val_auprc_score: 0.9988; val_best_acc_score: 0.9884; val_best_f1_score: 0.9932; train_kl_reg_loss: 1988.1250; train_edge_recon_loss: 75886.5364; train_gene_expr_recon_loss: 83069.3839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160944.0448; train_optim_loss: 160944.0448; val_kl_reg_loss: 1973.4459; val_edge_recon_loss: 75555.0334; val_gene_expr_recon_loss: 83383.0738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160911.5530; val_optim_loss: 160911.5530
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9947; val_auprc_score: 0.9985; val_best_acc_score: 0.9886; val_best_f1_score: 0.9934; train_kl_reg_loss: 1991.2868; train_edge_recon_loss: 75775.5898; train_gene_expr_recon_loss: 82899.6827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160666.5590; train_optim_loss: 160666.5590; val_kl_reg_loss: 1961.5888; val_edge_recon_loss: 75592.4410; val_gene_expr_recon_loss: 83418.9232; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160972.9514; val_optim_loss: 160972.9514
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9963; val_auprc_score: 0.9989; val_best_acc_score: 0.9893; val_best_f1_score: 0.9938; train_kl_reg_loss: 1996.7282; train_edge_recon_loss: 75716.8201; train_gene_expr_recon_loss: 82727.0302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160440.5780; train_optim_loss: 160440.5780; val_kl_reg_loss: 1990.8399; val_edge_recon_loss: 76188.7756; val_gene_expr_recon_loss: 83330.5994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161510.2144; val_optim_loss: 161510.2144

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9962; val_auprc_score: 0.9992; val_best_acc_score: 0.9892; val_best_f1_score: 0.9937; train_kl_reg_loss: 1997.6821; train_edge_recon_loss: 75882.9350; train_gene_expr_recon_loss: 82448.7119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160329.3288; train_optim_loss: 160329.3288; val_kl_reg_loss: 1964.9782; val_edge_recon_loss: 75421.1211; val_gene_expr_recon_loss: 83202.7982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160588.8984; val_optim_loss: 160588.8984
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9952; val_auprc_score: 0.9986; val_best_acc_score: 0.9891; val_best_f1_score: 0.9937; train_kl_reg_loss: 1990.0991; train_edge_recon_loss: 75652.1216; train_gene_expr_recon_loss: 82309.3036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159951.5243; train_optim_loss: 159951.5243; val_kl_reg_loss: 1972.0032; val_edge_recon_loss: 75972.1437; val_gene_expr_recon_loss: 83191.7635; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161135.9115; val_optim_loss: 161135.9115
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9958; val_auprc_score: 0.9989; val_best_acc_score: 0.9888; val_best_f1_score: 0.9935; train_kl_reg_loss: 1990.2426; train_edge_recon_loss: 75616.9621; train_gene_expr_recon_loss: 82325.9435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159933.1485; train_optim_loss: 159933.1485; val_kl_reg_loss: 1960.8003; val_edge_recon_loss: 75257.0577; val_gene_expr_recon_loss: 83042.2513; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160260.1076; val_optim_loss: 160260.1076
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9959; val_auprc_score: 0.9988; val_best_acc_score: 0.9886; val_best_f1_score: 0.9934; train_kl_reg_loss: 1993.3899; train_edge_recon_loss: 76116.3428; train_gene_expr_recon_loss: 82286.1154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160395.8480; train_optim_loss: 160395.8480; val_kl_reg_loss: 1975.9111; val_edge_recon_loss: 75453.0074; val_gene_expr_recon_loss: 83201.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160630.0026; val_optim_loss: 160630.0026
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9961; val_auprc_score: 0.9989; val_best_acc_score: 0.9899; val_best_f1_score: 0.9941; train_kl_reg_loss: 1991.8201; train_edge_recon_loss: 75526.2533; train_gene_expr_recon_loss: 82250.2658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159768.3386; train_optim_loss: 159768.3386; val_kl_reg_loss: 1960.5860; val_edge_recon_loss: 76119.2548; val_gene_expr_recon_loss: 82926.6276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161006.4714; val_optim_loss: 161006.4714
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9960; val_auprc_score: 0.9985; val_best_acc_score: 0.9896; val_best_f1_score: 0.9939; train_kl_reg_loss: 1992.4865; train_edge_recon_loss: 76040.8961; train_gene_expr_recon_loss: 82181.3394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160214.7233; train_optim_loss: 160214.7233; val_kl_reg_loss: 1969.1929; val_edge_recon_loss: 74546.4627; val_gene_expr_recon_loss: 82830.5104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159346.1667; val_optim_loss: 159346.1667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9963; val_auprc_score: 0.9992; val_best_acc_score: 0.9895; val_best_f1_score: 0.9938; train_kl_reg_loss: 1993.5185; train_edge_recon_loss: 75617.0290; train_gene_expr_recon_loss: 82214.2684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159824.8154; train_optim_loss: 159824.8154; val_kl_reg_loss: 1973.8423; val_edge_recon_loss: 75587.1970; val_gene_expr_recon_loss: 83197.2053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160758.2439; val_optim_loss: 160758.2439
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9970; val_auprc_score: 0.9993; val_best_acc_score: 0.9899; val_best_f1_score: 0.9941; train_kl_reg_loss: 1992.7578; train_edge_recon_loss: 75973.4470; train_gene_expr_recon_loss: 82121.3783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160087.5834; train_optim_loss: 160087.5834; val_kl_reg_loss: 1970.1125; val_edge_recon_loss: 74877.9913; val_gene_expr_recon_loss: 82912.5885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159760.6910; val_optim_loss: 159760.6910
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9953; val_auprc_score: 0.9983; val_best_acc_score: 0.9893; val_best_f1_score: 0.9938; train_kl_reg_loss: 1993.7836; train_edge_recon_loss: 75996.9172; train_gene_expr_recon_loss: 82135.7553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160126.4553; train_optim_loss: 160126.4553; val_kl_reg_loss: 1978.0064; val_edge_recon_loss: 74405.5139; val_gene_expr_recon_loss: 83229.2925; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159612.8116; val_optim_loss: 159612.8116

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9958; val_auprc_score: 0.9987; val_best_acc_score: 0.9894; val_best_f1_score: 0.9938; train_kl_reg_loss: 1997.3578; train_edge_recon_loss: 75646.9831; train_gene_expr_recon_loss: 82123.5405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159767.8818; train_optim_loss: 159767.8818; val_kl_reg_loss: 1969.3893; val_edge_recon_loss: 75494.8819; val_gene_expr_recon_loss: 83050.1936; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160514.4635; val_optim_loss: 160514.4635
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9960; val_auprc_score: 0.9990; val_best_acc_score: 0.9897; val_best_f1_score: 0.9940; train_kl_reg_loss: 1993.5171; train_edge_recon_loss: 75722.3577; train_gene_expr_recon_loss: 82082.5807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159798.4560; train_optim_loss: 159798.4560; val_kl_reg_loss: 1967.4452; val_edge_recon_loss: 76496.7669; val_gene_expr_recon_loss: 82880.7708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161344.9809; val_optim_loss: 161344.9809
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9964; val_auprc_score: 0.9991; val_best_acc_score: 0.9901; val_best_f1_score: 0.9942; train_kl_reg_loss: 1992.1460; train_edge_recon_loss: 75698.5546; train_gene_expr_recon_loss: 82109.5744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159800.2749; train_optim_loss: 159800.2749; val_kl_reg_loss: 1968.0922; val_edge_recon_loss: 75210.3624; val_gene_expr_recon_loss: 82832.6033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160011.0582; val_optim_loss: 160011.0582

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 19 min 48 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9950
Val AUPRC score: 0.9984
Val best accuracy score: 0.9890
Val best F1 score: 0.9936
Val gene expr MSE score: 0.8240
Duration of model training in run 5: 0 hours, 19 minutes and 59 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 319410
Number of validation edges: 35490
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9812; val_auprc_score: 0.9959; val_best_acc_score: 0.9660; val_best_f1_score: 0.9803; train_kl_reg_loss: 1755.5966; train_edge_recon_loss: 83382.6371; train_gene_expr_recon_loss: 95906.9202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181045.1527; train_optim_loss: 181045.1527; val_kl_reg_loss: 2025.0162; val_edge_recon_loss: 77324.5651; val_gene_expr_recon_loss: 91082.4210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170432.0009; val_optim_loss: 170432.0009
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9902; val_auprc_score: 0.9975; val_best_acc_score: 0.9753; val_best_f1_score: 0.9856; train_kl_reg_loss: 2002.9969; train_edge_recon_loss: 77688.5723; train_gene_expr_recon_loss: 90352.2767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170043.8456; train_optim_loss: 170043.8456; val_kl_reg_loss: 1893.0847; val_edge_recon_loss: 76633.4635; val_gene_expr_recon_loss: 89307.5543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167834.1024; val_optim_loss: 167834.1024
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9890; val_auprc_score: 0.9971; val_best_acc_score: 0.9784; val_best_f1_score: 0.9874; train_kl_reg_loss: 1955.4048; train_edge_recon_loss: 76851.1517; train_gene_expr_recon_loss: 88828.8501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167635.4068; train_optim_loss: 167635.4068; val_kl_reg_loss: 1916.8022; val_edge_recon_loss: 76319.1363; val_gene_expr_recon_loss: 87919.9935; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166155.9323; val_optim_loss: 166155.9323
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9920; val_auprc_score: 0.9980; val_best_acc_score: 0.9809; val_best_f1_score: 0.9889; train_kl_reg_loss: 1942.5901; train_edge_recon_loss: 76638.0259; train_gene_expr_recon_loss: 87792.4097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166373.0265; train_optim_loss: 166373.0265; val_kl_reg_loss: 1922.1716; val_edge_recon_loss: 75392.2691; val_gene_expr_recon_loss: 87432.4479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164746.8863; val_optim_loss: 164746.8863
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9921; val_auprc_score: 0.9976; val_best_acc_score: 0.9829; val_best_f1_score: 0.9900; train_kl_reg_loss: 1932.9069; train_edge_recon_loss: 76400.2720; train_gene_expr_recon_loss: 86996.9132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165330.0915; train_optim_loss: 165330.0915; val_kl_reg_loss: 1903.3747; val_edge_recon_loss: 76671.5885; val_gene_expr_recon_loss: 86496.0100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165070.9740; val_optim_loss: 165070.9740
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9929; val_auprc_score: 0.9981; val_best_acc_score: 0.9848; val_best_f1_score: 0.9911; train_kl_reg_loss: 1931.0732; train_edge_recon_loss: 75871.7852; train_gene_expr_recon_loss: 86396.8774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164199.7359; train_optim_loss: 164199.7359; val_kl_reg_loss: 1903.5365; val_edge_recon_loss: 76375.1775; val_gene_expr_recon_loss: 85838.0842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164116.7969; val_optim_loss: 164116.7969
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9933; val_auprc_score: 0.9981; val_best_acc_score: 0.9860; val_best_f1_score: 0.9919; train_kl_reg_loss: 1935.1739; train_edge_recon_loss: 76435.4516; train_gene_expr_recon_loss: 85846.7335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164217.3591; train_optim_loss: 164217.3591; val_kl_reg_loss: 1862.0642; val_edge_recon_loss: 74451.2400; val_gene_expr_recon_loss: 85469.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161782.5712; val_optim_loss: 161782.5712
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9936; val_auprc_score: 0.9978; val_best_acc_score: 0.9869; val_best_f1_score: 0.9923; train_kl_reg_loss: 1938.2652; train_edge_recon_loss: 76122.7959; train_gene_expr_recon_loss: 85424.8390; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163485.9001; train_optim_loss: 163485.9001; val_kl_reg_loss: 1886.9716; val_edge_recon_loss: 75495.8485; val_gene_expr_recon_loss: 85113.4497; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162496.2674; val_optim_loss: 162496.2674
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9942; val_auprc_score: 0.9985; val_best_acc_score: 0.9870; val_best_f1_score: 0.9924; train_kl_reg_loss: 1943.5498; train_edge_recon_loss: 76047.0014; train_gene_expr_recon_loss: 85076.0903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163066.6411; train_optim_loss: 163066.6411; val_kl_reg_loss: 1950.4135; val_edge_recon_loss: 75194.8086; val_gene_expr_recon_loss: 84685.0451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161830.2682; val_optim_loss: 161830.2682
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9938; val_auprc_score: 0.9982; val_best_acc_score: 0.9866; val_best_f1_score: 0.9922; train_kl_reg_loss: 1949.0998; train_edge_recon_loss: 75934.5191; train_gene_expr_recon_loss: 84675.2215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162558.8403; train_optim_loss: 162558.8403; val_kl_reg_loss: 1924.5714; val_edge_recon_loss: 75285.2487; val_gene_expr_recon_loss: 84464.3025; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161674.1241; val_optim_loss: 161674.1241
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9945; val_auprc_score: 0.9986; val_best_acc_score: 0.9879; val_best_f1_score: 0.9930; train_kl_reg_loss: 1949.3591; train_edge_recon_loss: 75881.3610; train_gene_expr_recon_loss: 84341.1376; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162171.8580; train_optim_loss: 162171.8580; val_kl_reg_loss: 1927.7535; val_edge_recon_loss: 75596.7396; val_gene_expr_recon_loss: 83900.9010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161425.3932; val_optim_loss: 161425.3932
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9950; val_auprc_score: 0.9988; val_best_acc_score: 0.9876; val_best_f1_score: 0.9928; train_kl_reg_loss: 1956.1521; train_edge_recon_loss: 75423.7723; train_gene_expr_recon_loss: 84183.4759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161563.4000; train_optim_loss: 161563.4000; val_kl_reg_loss: 1934.1780; val_edge_recon_loss: 77071.7283; val_gene_expr_recon_loss: 83736.9887; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162742.8924; val_optim_loss: 162742.8924
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9952; val_auprc_score: 0.9987; val_best_acc_score: 0.9881; val_best_f1_score: 0.9930; train_kl_reg_loss: 1964.3881; train_edge_recon_loss: 75766.6539; train_gene_expr_recon_loss: 83787.4438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161518.4862; train_optim_loss: 161518.4862; val_kl_reg_loss: 1951.5905; val_edge_recon_loss: 76358.7491; val_gene_expr_recon_loss: 83584.1124; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161894.4497; val_optim_loss: 161894.4497
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9953; val_auprc_score: 0.9987; val_best_acc_score: 0.9883; val_best_f1_score: 0.9931; train_kl_reg_loss: 1972.8911; train_edge_recon_loss: 76264.0430; train_gene_expr_recon_loss: 83501.6873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161738.6211; train_optim_loss: 161738.6211; val_kl_reg_loss: 1943.9033; val_edge_recon_loss: 76658.6636; val_gene_expr_recon_loss: 83563.8021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162166.3715; val_optim_loss: 162166.3715

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9956; val_auprc_score: 0.9988; val_best_acc_score: 0.9883; val_best_f1_score: 0.9932; train_kl_reg_loss: 1972.8760; train_edge_recon_loss: 76033.6089; train_gene_expr_recon_loss: 83271.0017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161277.4872; train_optim_loss: 161277.4872; val_kl_reg_loss: 1942.9590; val_edge_recon_loss: 75252.8433; val_gene_expr_recon_loss: 83111.2717; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160307.0747; val_optim_loss: 160307.0747
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9948; val_auprc_score: 0.9982; val_best_acc_score: 0.9886; val_best_f1_score: 0.9934; train_kl_reg_loss: 1968.9954; train_edge_recon_loss: 76108.2420; train_gene_expr_recon_loss: 83165.2622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161242.5001; train_optim_loss: 161242.5001; val_kl_reg_loss: 1951.6762; val_edge_recon_loss: 75368.4418; val_gene_expr_recon_loss: 83098.3424; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160418.4627; val_optim_loss: 160418.4627
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9961; val_auprc_score: 0.9991; val_best_acc_score: 0.9893; val_best_f1_score: 0.9937; train_kl_reg_loss: 1969.6908; train_edge_recon_loss: 75869.1211; train_gene_expr_recon_loss: 83167.4311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161006.2432; train_optim_loss: 161006.2432; val_kl_reg_loss: 1946.5150; val_edge_recon_loss: 76036.4792; val_gene_expr_recon_loss: 82936.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160919.0773; val_optim_loss: 160919.0773
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9938; val_auprc_score: 0.9981; val_best_acc_score: 0.9878; val_best_f1_score: 0.9929; train_kl_reg_loss: 1962.3622; train_edge_recon_loss: 75590.0741; train_gene_expr_recon_loss: 83117.4070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160669.8429; train_optim_loss: 160669.8429; val_kl_reg_loss: 1942.3201; val_edge_recon_loss: 76497.9340; val_gene_expr_recon_loss: 82791.7444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161231.9991; val_optim_loss: 161231.9991

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9951; val_auprc_score: 0.9989; val_best_acc_score: 0.9886; val_best_f1_score: 0.9933; train_kl_reg_loss: 1966.6476; train_edge_recon_loss: 76022.7277; train_gene_expr_recon_loss: 83033.2600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161022.6355; train_optim_loss: 161022.6355; val_kl_reg_loss: 1948.8244; val_edge_recon_loss: 74952.8498; val_gene_expr_recon_loss: 82858.8694; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159760.5425; val_optim_loss: 159760.5425
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9955; val_auprc_score: 0.9990; val_best_acc_score: 0.9887; val_best_f1_score: 0.9934; train_kl_reg_loss: 1967.0604; train_edge_recon_loss: 75670.1088; train_gene_expr_recon_loss: 83002.3319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160639.5025; train_optim_loss: 160639.5025; val_kl_reg_loss: 1946.6891; val_edge_recon_loss: 75861.0660; val_gene_expr_recon_loss: 82900.7144; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160708.4705; val_optim_loss: 160708.4705
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9954; val_auprc_score: 0.9990; val_best_acc_score: 0.9877; val_best_f1_score: 0.9928; train_kl_reg_loss: 1967.8305; train_edge_recon_loss: 76213.8305; train_gene_expr_recon_loss: 82975.3948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161157.0556; train_optim_loss: 161157.0556; val_kl_reg_loss: 1942.6566; val_edge_recon_loss: 77247.4674; val_gene_expr_recon_loss: 83008.8689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162198.9931; val_optim_loss: 162198.9931
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9954; val_auprc_score: 0.9984; val_best_acc_score: 0.9889; val_best_f1_score: 0.9935; train_kl_reg_loss: 1965.9306; train_edge_recon_loss: 75959.9084; train_gene_expr_recon_loss: 83067.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160992.9500; train_optim_loss: 160992.9500; val_kl_reg_loss: 1943.3476; val_edge_recon_loss: 76905.7270; val_gene_expr_recon_loss: 82820.9757; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161670.0512; val_optim_loss: 161670.0512

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9954; val_auprc_score: 0.9989; val_best_acc_score: 0.9886; val_best_f1_score: 0.9933; train_kl_reg_loss: 1966.7831; train_edge_recon_loss: 75353.6146; train_gene_expr_recon_loss: 83034.4706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160354.8685; train_optim_loss: 160354.8685; val_kl_reg_loss: 1945.0891; val_edge_recon_loss: 75600.6654; val_gene_expr_recon_loss: 83070.1740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160615.9271; val_optim_loss: 160615.9271
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9955; val_auprc_score: 0.9988; val_best_acc_score: 0.9888; val_best_f1_score: 0.9934; train_kl_reg_loss: 1966.2016; train_edge_recon_loss: 76280.9033; train_gene_expr_recon_loss: 83050.3719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161297.4776; train_optim_loss: 161297.4776; val_kl_reg_loss: 1944.7451; val_edge_recon_loss: 78491.4653; val_gene_expr_recon_loss: 83037.4049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163473.6137; val_optim_loss: 163473.6137
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9956; val_auprc_score: 0.9991; val_best_acc_score: 0.9890; val_best_f1_score: 0.9936; train_kl_reg_loss: 1965.8401; train_edge_recon_loss: 75449.7537; train_gene_expr_recon_loss: 83027.6313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160443.2253; train_optim_loss: 160443.2253; val_kl_reg_loss: 1943.5165; val_edge_recon_loss: 75827.1046; val_gene_expr_recon_loss: 82926.4336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160697.0538; val_optim_loss: 160697.0538

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 15 min 25 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9956
Val AUPRC score: 0.9991
Val best accuracy score: 0.9890
Val best F1 score: 0.9936
Val gene expr MSE score: 0.8161
Duration of model training in run 6: 0 hours, 15 minutes and 39 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 424361
Number of validation edges: 47151
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9889; val_auprc_score: 0.9971; val_best_acc_score: 0.9776; val_best_f1_score: 0.9869; train_kl_reg_loss: 1877.6025; train_edge_recon_loss: 80137.8509; train_gene_expr_recon_loss: 92167.1986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174182.6518; train_optim_loss: 174182.6518; val_kl_reg_loss: 1948.8437; val_edge_recon_loss: 75522.9216; val_gene_expr_recon_loss: 88972.0602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166443.8241; val_optim_loss: 166443.8241
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9920; val_auprc_score: 0.9980; val_best_acc_score: 0.9824; val_best_f1_score: 0.9897; train_kl_reg_loss: 1929.6401; train_edge_recon_loss: 76324.9881; train_gene_expr_recon_loss: 87587.7394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165842.3675; train_optim_loss: 165842.3675; val_kl_reg_loss: 1919.3054; val_edge_recon_loss: 77063.2410; val_gene_expr_recon_loss: 87247.4533; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166229.9993; val_optim_loss: 166229.9993
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9920; val_auprc_score: 0.9981; val_best_acc_score: 0.9845; val_best_f1_score: 0.9910; train_kl_reg_loss: 1926.2844; train_edge_recon_loss: 76285.0553; train_gene_expr_recon_loss: 86033.3883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164244.7282; train_optim_loss: 164244.7282; val_kl_reg_loss: 1897.6818; val_edge_recon_loss: 75705.1057; val_gene_expr_recon_loss: 86059.8002; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163662.5871; val_optim_loss: 163662.5871
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9933; val_auprc_score: 0.9980; val_best_acc_score: 0.9868; val_best_f1_score: 0.9923; train_kl_reg_loss: 1928.0112; train_edge_recon_loss: 75642.3546; train_gene_expr_recon_loss: 85075.3167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162645.6830; train_optim_loss: 162645.6830; val_kl_reg_loss: 1926.1097; val_edge_recon_loss: 75800.5689; val_gene_expr_recon_loss: 85466.9719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163193.6513; val_optim_loss: 163193.6513
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9940; val_auprc_score: 0.9985; val_best_acc_score: 0.9867; val_best_f1_score: 0.9923; train_kl_reg_loss: 1945.4310; train_edge_recon_loss: 76036.5580; train_gene_expr_recon_loss: 84440.0104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162421.9990; train_optim_loss: 162421.9990; val_kl_reg_loss: 1903.1556; val_edge_recon_loss: 76021.5312; val_gene_expr_recon_loss: 84647.1401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162571.8278; val_optim_loss: 162571.8278
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9947; val_auprc_score: 0.9985; val_best_acc_score: 0.9878; val_best_f1_score: 0.9929; train_kl_reg_loss: 1945.4700; train_edge_recon_loss: 76037.5859; train_gene_expr_recon_loss: 83826.7079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161809.7643; train_optim_loss: 161809.7643; val_kl_reg_loss: 1912.7801; val_edge_recon_loss: 75435.0229; val_gene_expr_recon_loss: 84627.3813; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161975.1845; val_optim_loss: 161975.1845
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9947; val_auprc_score: 0.9983; val_best_acc_score: 0.9887; val_best_f1_score: 0.9934; train_kl_reg_loss: 1954.8493; train_edge_recon_loss: 75820.5376; train_gene_expr_recon_loss: 83408.8463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161184.2330; train_optim_loss: 161184.2330; val_kl_reg_loss: 1926.7087; val_edge_recon_loss: 76991.8321; val_gene_expr_recon_loss: 83832.7691; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162751.3105; val_optim_loss: 162751.3105
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9953; val_auprc_score: 0.9989; val_best_acc_score: 0.9888; val_best_f1_score: 0.9934; train_kl_reg_loss: 1966.1359; train_edge_recon_loss: 75779.2178; train_gene_expr_recon_loss: 83020.3018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160765.6557; train_optim_loss: 160765.6557; val_kl_reg_loss: 1917.5092; val_edge_recon_loss: 77502.9865; val_gene_expr_recon_loss: 83143.6087; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162564.1054; val_optim_loss: 162564.1054
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9958; val_auprc_score: 0.9984; val_best_acc_score: 0.9896; val_best_f1_score: 0.9939; train_kl_reg_loss: 1973.1461; train_edge_recon_loss: 75779.3486; train_gene_expr_recon_loss: 82658.6395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160411.1342; train_optim_loss: 160411.1342; val_kl_reg_loss: 1944.3831; val_edge_recon_loss: 75741.2527; val_gene_expr_recon_loss: 83363.5969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161049.2330; val_optim_loss: 161049.2330
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9957; val_auprc_score: 0.9986; val_best_acc_score: 0.9899; val_best_f1_score: 0.9941; train_kl_reg_loss: 1982.3017; train_edge_recon_loss: 75595.6977; train_gene_expr_recon_loss: 82437.6472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160015.6473; train_optim_loss: 160015.6473; val_kl_reg_loss: 1962.9047; val_edge_recon_loss: 76662.6553; val_gene_expr_recon_loss: 83520.0500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162145.6094; val_optim_loss: 162145.6094
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9957; val_auprc_score: 0.9988; val_best_acc_score: 0.9903; val_best_f1_score: 0.9943; train_kl_reg_loss: 1984.8438; train_edge_recon_loss: 75929.4611; train_gene_expr_recon_loss: 82224.1589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160138.4633; train_optim_loss: 160138.4633; val_kl_reg_loss: 1976.2870; val_edge_recon_loss: 75305.7975; val_gene_expr_recon_loss: 83168.6498; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160450.7357; val_optim_loss: 160450.7357
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9961; val_auprc_score: 0.9990; val_best_acc_score: 0.9906; val_best_f1_score: 0.9945; train_kl_reg_loss: 1994.2135; train_edge_recon_loss: 75757.1385; train_gene_expr_recon_loss: 82027.0388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159778.3907; train_optim_loss: 159778.3907; val_kl_reg_loss: 1946.8522; val_edge_recon_loss: 75917.9801; val_gene_expr_recon_loss: 82485.7146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160350.5462; val_optim_loss: 160350.5462
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9962; val_auprc_score: 0.9990; val_best_acc_score: 0.9906; val_best_f1_score: 0.9945; train_kl_reg_loss: 2004.9922; train_edge_recon_loss: 76055.6333; train_gene_expr_recon_loss: 81895.0858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159955.7116; train_optim_loss: 159955.7116; val_kl_reg_loss: 1979.5885; val_edge_recon_loss: 75435.8025; val_gene_expr_recon_loss: 82377.5309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159792.9205; val_optim_loss: 159792.9205
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9961; val_auprc_score: 0.9990; val_best_acc_score: 0.9910; val_best_f1_score: 0.9948; train_kl_reg_loss: 2003.5099; train_edge_recon_loss: 75629.1494; train_gene_expr_recon_loss: 81685.2078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159317.8669; train_optim_loss: 159317.8669; val_kl_reg_loss: 1956.8331; val_edge_recon_loss: 73882.3695; val_gene_expr_recon_loss: 82057.5062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157896.7081; val_optim_loss: 157896.7081
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9965; val_auprc_score: 0.9987; val_best_acc_score: 0.9906; val_best_f1_score: 0.9945; train_kl_reg_loss: 2010.8801; train_edge_recon_loss: 75411.7491; train_gene_expr_recon_loss: 81625.4684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159048.0972; train_optim_loss: 159048.0972; val_kl_reg_loss: 2011.4184; val_edge_recon_loss: 75495.6012; val_gene_expr_recon_loss: 82361.9338; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159868.9531; val_optim_loss: 159868.9531
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9956; val_auprc_score: 0.9985; val_best_acc_score: 0.9909; val_best_f1_score: 0.9947; train_kl_reg_loss: 2018.1156; train_edge_recon_loss: 75817.2087; train_gene_expr_recon_loss: 81355.0530; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159190.3774; train_optim_loss: 159190.3774; val_kl_reg_loss: 2035.1132; val_edge_recon_loss: 74812.3682; val_gene_expr_recon_loss: 81824.1011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158671.5824; val_optim_loss: 158671.5824
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9964; val_auprc_score: 0.9989; val_best_acc_score: 0.9910; val_best_f1_score: 0.9947; train_kl_reg_loss: 2025.4672; train_edge_recon_loss: 75838.0567; train_gene_expr_recon_loss: 81266.0348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159129.5587; train_optim_loss: 159129.5587; val_kl_reg_loss: 2010.6904; val_edge_recon_loss: 76026.9191; val_gene_expr_recon_loss: 82192.6185; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160230.2271; val_optim_loss: 160230.2271

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9969; val_auprc_score: 0.9993; val_best_acc_score: 0.9915; val_best_f1_score: 0.9951; train_kl_reg_loss: 2034.1543; train_edge_recon_loss: 75888.5749; train_gene_expr_recon_loss: 80889.3691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158812.0982; train_optim_loss: 158812.0982; val_kl_reg_loss: 2009.5141; val_edge_recon_loss: 76120.1943; val_gene_expr_recon_loss: 81322.7309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159452.4375; val_optim_loss: 159452.4375
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9954; val_auprc_score: 0.9986; val_best_acc_score: 0.9908; val_best_f1_score: 0.9946; train_kl_reg_loss: 2025.4205; train_edge_recon_loss: 75384.3239; train_gene_expr_recon_loss: 80727.4307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158137.1750; train_optim_loss: 158137.1750; val_kl_reg_loss: 2003.0529; val_edge_recon_loss: 75127.5943; val_gene_expr_recon_loss: 81530.8085; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158661.4555; val_optim_loss: 158661.4555
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9968; val_auprc_score: 0.9989; val_best_acc_score: 0.9922; val_best_f1_score: 0.9955; train_kl_reg_loss: 2022.7967; train_edge_recon_loss: 75640.6137; train_gene_expr_recon_loss: 80730.6152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158394.0255; train_optim_loss: 158394.0255; val_kl_reg_loss: 2005.0167; val_edge_recon_loss: 76228.8845; val_gene_expr_recon_loss: 81294.7375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159528.6386; val_optim_loss: 159528.6386

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 26 min 45 sec.
Using best model state, which was in epoch 14.

--- MODEL EVALUATION ---
Val AUROC score: 0.9951
Val AUPRC score: 0.9987
Val best accuracy score: 0.9904
Val best F1 score: 0.9944
Val gene expr MSE score: 0.8425
Duration of model training in run 7: 0 hours, 27 minutes and 13 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 424361
Number of validation edges: 47151
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9892; val_auprc_score: 0.9971; val_best_acc_score: 0.9795; val_best_f1_score: 0.9881; train_kl_reg_loss: 1889.8697; train_edge_recon_loss: 80534.8411; train_gene_expr_recon_loss: 92703.3010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175128.0122; train_optim_loss: 175128.0122; val_kl_reg_loss: 1944.2249; val_edge_recon_loss: 75670.6763; val_gene_expr_recon_loss: 89562.0066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167176.9086; val_optim_loss: 167176.9086
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9921; val_auprc_score: 0.9983; val_best_acc_score: 0.9834; val_best_f1_score: 0.9903; train_kl_reg_loss: 1938.5175; train_edge_recon_loss: 76516.2348; train_gene_expr_recon_loss: 87924.6710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166379.4235; train_optim_loss: 166379.4235; val_kl_reg_loss: 1913.2514; val_edge_recon_loss: 75626.9290; val_gene_expr_recon_loss: 87455.5974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164995.7779; val_optim_loss: 164995.7779
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9935; val_auprc_score: 0.9985; val_best_acc_score: 0.9849; val_best_f1_score: 0.9912; train_kl_reg_loss: 1926.8147; train_edge_recon_loss: 76330.2553; train_gene_expr_recon_loss: 86352.0014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164609.0715; train_optim_loss: 164609.0715; val_kl_reg_loss: 1895.9858; val_edge_recon_loss: 75705.4107; val_gene_expr_recon_loss: 86380.9887; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163982.3836; val_optim_loss: 163982.3836
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9930; val_auprc_score: 0.9981; val_best_acc_score: 0.9863; val_best_f1_score: 0.9920; train_kl_reg_loss: 1930.8829; train_edge_recon_loss: 75910.7747; train_gene_expr_recon_loss: 85291.3690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163133.0263; train_optim_loss: 163133.0263; val_kl_reg_loss: 1914.3579; val_edge_recon_loss: 76773.5341; val_gene_expr_recon_loss: 85202.3175; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163890.2098; val_optim_loss: 163890.2098
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9941; val_auprc_score: 0.9987; val_best_acc_score: 0.9873; val_best_f1_score: 0.9926; train_kl_reg_loss: 1943.1886; train_edge_recon_loss: 76289.1381; train_gene_expr_recon_loss: 84599.1605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162831.4875; train_optim_loss: 162831.4875; val_kl_reg_loss: 1922.6074; val_edge_recon_loss: 75387.8590; val_gene_expr_recon_loss: 84668.4023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161978.8687; val_optim_loss: 161978.8687
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9955; val_auprc_score: 0.9990; val_best_acc_score: 0.9885; val_best_f1_score: 0.9933; train_kl_reg_loss: 1950.2809; train_edge_recon_loss: 75986.5888; train_gene_expr_recon_loss: 83977.9498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161914.8194; train_optim_loss: 161914.8194; val_kl_reg_loss: 1918.4315; val_edge_recon_loss: 75026.5237; val_gene_expr_recon_loss: 84249.1225; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161194.0788; val_optim_loss: 161194.0788
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9950; val_auprc_score: 0.9986; val_best_acc_score: 0.9888; val_best_f1_score: 0.9935; train_kl_reg_loss: 1955.4217; train_edge_recon_loss: 75848.0585; train_gene_expr_recon_loss: 83519.6959; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161323.1759; train_optim_loss: 161323.1759; val_kl_reg_loss: 1958.7241; val_edge_recon_loss: 75609.7586; val_gene_expr_recon_loss: 83939.6423; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161508.1257; val_optim_loss: 161508.1257
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9959; val_auprc_score: 0.9986; val_best_acc_score: 0.9902; val_best_f1_score: 0.9943; train_kl_reg_loss: 1967.5217; train_edge_recon_loss: 75462.1468; train_gene_expr_recon_loss: 83140.2578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160569.9261; train_optim_loss: 160569.9261; val_kl_reg_loss: 1946.9137; val_edge_recon_loss: 76359.0236; val_gene_expr_recon_loss: 83458.2874; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161764.2251; val_optim_loss: 161764.2251
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9953; val_auprc_score: 0.9986; val_best_acc_score: 0.9896; val_best_f1_score: 0.9939; train_kl_reg_loss: 1974.0136; train_edge_recon_loss: 75445.0398; train_gene_expr_recon_loss: 82837.4088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160256.4621; train_optim_loss: 160256.4621; val_kl_reg_loss: 1933.2564; val_edge_recon_loss: 75538.5693; val_gene_expr_recon_loss: 82751.9781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160223.8045; val_optim_loss: 160223.8045
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9958; val_auprc_score: 0.9989; val_best_acc_score: 0.9895; val_best_f1_score: 0.9939; train_kl_reg_loss: 1978.8976; train_edge_recon_loss: 75977.1577; train_gene_expr_recon_loss: 82578.8248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160534.8802; train_optim_loss: 160534.8802; val_kl_reg_loss: 1973.5841; val_edge_recon_loss: 75599.6451; val_gene_expr_recon_loss: 82860.9914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160434.2211; val_optim_loss: 160434.2211
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9949; val_auprc_score: 0.9987; val_best_acc_score: 0.9901; val_best_f1_score: 0.9942; train_kl_reg_loss: 1989.0642; train_edge_recon_loss: 75694.2615; train_gene_expr_recon_loss: 82363.6360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160046.9615; train_optim_loss: 160046.9615; val_kl_reg_loss: 1952.9137; val_edge_recon_loss: 75940.7651; val_gene_expr_recon_loss: 82709.1255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160602.8049; val_optim_loss: 160602.8049
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9947; val_auprc_score: 0.9984; val_best_acc_score: 0.9905; val_best_f1_score: 0.9944; train_kl_reg_loss: 1995.2673; train_edge_recon_loss: 75639.0639; train_gene_expr_recon_loss: 82159.3335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159793.6648; train_optim_loss: 159793.6648; val_kl_reg_loss: 1967.5715; val_edge_recon_loss: 75685.2140; val_gene_expr_recon_loss: 82390.9377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160043.7247; val_optim_loss: 160043.7247
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9961; val_auprc_score: 0.9989; val_best_acc_score: 0.9902; val_best_f1_score: 0.9943; train_kl_reg_loss: 2002.3930; train_edge_recon_loss: 75701.1218; train_gene_expr_recon_loss: 81877.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159581.2337; train_optim_loss: 159581.2337; val_kl_reg_loss: 1963.2892; val_edge_recon_loss: 76152.7197; val_gene_expr_recon_loss: 82604.2576; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160720.2676; val_optim_loss: 160720.2676
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9956; val_auprc_score: 0.9986; val_best_acc_score: 0.9906; val_best_f1_score: 0.9945; train_kl_reg_loss: 2007.8120; train_edge_recon_loss: 75801.1930; train_gene_expr_recon_loss: 81745.0190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159554.0240; train_optim_loss: 159554.0240; val_kl_reg_loss: 2029.2755; val_edge_recon_loss: 76353.5643; val_gene_expr_recon_loss: 82571.5964; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160954.4362; val_optim_loss: 160954.4362
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9951; val_auprc_score: 0.9985; val_best_acc_score: 0.9906; val_best_f1_score: 0.9945; train_kl_reg_loss: 2015.4192; train_edge_recon_loss: 75671.8051; train_gene_expr_recon_loss: 81643.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159330.3022; train_optim_loss: 159330.3022; val_kl_reg_loss: 1997.6092; val_edge_recon_loss: 75465.3024; val_gene_expr_recon_loss: 82211.1729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159674.0851; val_optim_loss: 159674.0851
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9966; val_auprc_score: 0.9988; val_best_acc_score: 0.9914; val_best_f1_score: 0.9950; train_kl_reg_loss: 2023.2764; train_edge_recon_loss: 75986.6216; train_gene_expr_recon_loss: 81421.9525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159431.8503; train_optim_loss: 159431.8503; val_kl_reg_loss: 1994.5708; val_edge_recon_loss: 76194.8029; val_gene_expr_recon_loss: 82359.9663; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160549.3401; val_optim_loss: 160549.3401
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9959; val_auprc_score: 0.9989; val_best_acc_score: 0.9908; val_best_f1_score: 0.9946; train_kl_reg_loss: 2026.9782; train_edge_recon_loss: 75974.0316; train_gene_expr_recon_loss: 81377.3124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159378.3222; train_optim_loss: 159378.3222; val_kl_reg_loss: 1992.2382; val_edge_recon_loss: 74668.9193; val_gene_expr_recon_loss: 82191.5472; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158852.7048; val_optim_loss: 158852.7048
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9967; val_auprc_score: 0.9990; val_best_acc_score: 0.9922; val_best_f1_score: 0.9954; train_kl_reg_loss: 2032.5144; train_edge_recon_loss: 75820.3601; train_gene_expr_recon_loss: 81207.0071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159059.8813; train_optim_loss: 159059.8813; val_kl_reg_loss: 2026.3566; val_edge_recon_loss: 74194.2623; val_gene_expr_recon_loss: 82559.0520; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158779.6725; val_optim_loss: 158779.6725
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9966; val_auprc_score: 0.9988; val_best_acc_score: 0.9917; val_best_f1_score: 0.9952; train_kl_reg_loss: 2038.3564; train_edge_recon_loss: 75697.2627; train_gene_expr_recon_loss: 81135.7941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158871.4127; train_optim_loss: 158871.4127; val_kl_reg_loss: 2050.9481; val_edge_recon_loss: 73151.5872; val_gene_expr_recon_loss: 81826.8108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157029.3467; val_optim_loss: 157029.3467
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9964; val_auprc_score: 0.9987; val_best_acc_score: 0.9914; val_best_f1_score: 0.9949; train_kl_reg_loss: 2042.7267; train_edge_recon_loss: 75368.9151; train_gene_expr_recon_loss: 80887.3794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158299.0213; train_optim_loss: 158299.0213; val_kl_reg_loss: 2039.2974; val_edge_recon_loss: 75913.5189; val_gene_expr_recon_loss: 81992.3328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159945.1486; val_optim_loss: 159945.1486
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9968; val_auprc_score: 0.9992; val_best_acc_score: 0.9914; val_best_f1_score: 0.9950; train_kl_reg_loss: 2048.8697; train_edge_recon_loss: 75780.2623; train_gene_expr_recon_loss: 80960.0871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158789.2191; train_optim_loss: 158789.2191; val_kl_reg_loss: 2009.2436; val_edge_recon_loss: 75079.2827; val_gene_expr_recon_loss: 81485.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158573.6669; val_optim_loss: 158573.6669
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9962; val_auprc_score: 0.9989; val_best_acc_score: 0.9913; val_best_f1_score: 0.9949; train_kl_reg_loss: 2054.6974; train_edge_recon_loss: 75525.8522; train_gene_expr_recon_loss: 80712.1619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158292.7114; train_optim_loss: 158292.7114; val_kl_reg_loss: 2050.2376; val_edge_recon_loss: 76626.6848; val_gene_expr_recon_loss: 81543.6346; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160220.5568; val_optim_loss: 160220.5568

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9967; val_auprc_score: 0.9991; val_best_acc_score: 0.9918; val_best_f1_score: 0.9952; train_kl_reg_loss: 2063.4034; train_edge_recon_loss: 75340.7735; train_gene_expr_recon_loss: 80385.2132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157789.3901; train_optim_loss: 157789.3901; val_kl_reg_loss: 2040.6840; val_edge_recon_loss: 76787.2950; val_gene_expr_recon_loss: 81393.5966; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160221.5761; val_optim_loss: 160221.5761
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9963; val_auprc_score: 0.9986; val_best_acc_score: 0.9922; val_best_f1_score: 0.9955; train_kl_reg_loss: 2057.6323; train_edge_recon_loss: 75871.0445; train_gene_expr_recon_loss: 80328.1541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158256.8306; train_optim_loss: 158256.8306; val_kl_reg_loss: 2041.6505; val_edge_recon_loss: 75320.8646; val_gene_expr_recon_loss: 80796.7914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158159.3055; val_optim_loss: 158159.3055
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9965; val_auprc_score: 0.9989; val_best_acc_score: 0.9918; val_best_f1_score: 0.9952; train_kl_reg_loss: 2052.0742; train_edge_recon_loss: 75426.4135; train_gene_expr_recon_loss: 80270.6482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157749.1361; train_optim_loss: 157749.1361; val_kl_reg_loss: 2033.8940; val_edge_recon_loss: 75959.7843; val_gene_expr_recon_loss: 81371.3029; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159364.9814; val_optim_loss: 159364.9814

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 35 min 35 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9958
Val AUPRC score: 0.9983
Val best accuracy score: 0.9909
Val best F1 score: 0.9947
Val gene expr MSE score: 0.8310
Duration of model training in run 8: 0 hours, 36 minutes and 3 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 529546
Number of validation edges: 58838
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9882; val_auprc_score: 0.9970; val_best_acc_score: 0.9775; val_best_f1_score: 0.9869; train_kl_reg_loss: 1871.1919; train_edge_recon_loss: 79740.1239; train_gene_expr_recon_loss: 92112.2998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173723.6151; train_optim_loss: 173723.6151; val_kl_reg_loss: 1876.9720; val_edge_recon_loss: 77231.5300; val_gene_expr_recon_loss: 88444.0218; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167552.5248; val_optim_loss: 167552.5248
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9916; val_auprc_score: 0.9979; val_best_acc_score: 0.9832; val_best_f1_score: 0.9902; train_kl_reg_loss: 1920.4900; train_edge_recon_loss: 76588.9673; train_gene_expr_recon_loss: 87430.2001; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165939.6574; train_optim_loss: 165939.6574; val_kl_reg_loss: 1914.1127; val_edge_recon_loss: 76285.0785; val_gene_expr_recon_loss: 86271.6901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164470.8809; val_optim_loss: 164470.8809
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9937; val_auprc_score: 0.9984; val_best_acc_score: 0.9861; val_best_f1_score: 0.9919; train_kl_reg_loss: 1921.0695; train_edge_recon_loss: 76030.6360; train_gene_expr_recon_loss: 85782.8674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163734.5731; train_optim_loss: 163734.5731; val_kl_reg_loss: 1901.3887; val_edge_recon_loss: 74891.4237; val_gene_expr_recon_loss: 84959.4692; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161752.2818; val_optim_loss: 161752.2818
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9935; val_auprc_score: 0.9982; val_best_acc_score: 0.9868; val_best_f1_score: 0.9923; train_kl_reg_loss: 1932.7582; train_edge_recon_loss: 76019.9397; train_gene_expr_recon_loss: 84721.7571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162674.4551; train_optim_loss: 162674.4551; val_kl_reg_loss: 1920.4394; val_edge_recon_loss: 75033.1616; val_gene_expr_recon_loss: 84306.7259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161260.3281; val_optim_loss: 161260.3281
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9938; val_auprc_score: 0.9982; val_best_acc_score: 0.9881; val_best_f1_score: 0.9930; train_kl_reg_loss: 1946.7665; train_edge_recon_loss: 76500.5673; train_gene_expr_recon_loss: 84028.9829; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162476.3161; train_optim_loss: 162476.3161; val_kl_reg_loss: 1959.0521; val_edge_recon_loss: 76099.3733; val_gene_expr_recon_loss: 83584.0116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161642.4372; val_optim_loss: 161642.4372
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9946; val_auprc_score: 0.9984; val_best_acc_score: 0.9884; val_best_f1_score: 0.9933; train_kl_reg_loss: 1951.8342; train_edge_recon_loss: 75644.8280; train_gene_expr_recon_loss: 83468.1175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161064.7798; train_optim_loss: 161064.7798; val_kl_reg_loss: 1940.2140; val_edge_recon_loss: 74168.3875; val_gene_expr_recon_loss: 82952.0070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159060.6091; val_optim_loss: 159060.6091
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9944; val_auprc_score: 0.9984; val_best_acc_score: 0.9889; val_best_f1_score: 0.9935; train_kl_reg_loss: 1956.7065; train_edge_recon_loss: 75916.8663; train_gene_expr_recon_loss: 83015.5487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160889.1216; train_optim_loss: 160889.1216; val_kl_reg_loss: 1985.7441; val_edge_recon_loss: 75571.4697; val_gene_expr_recon_loss: 82746.3109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160303.5242; val_optim_loss: 160303.5242
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9956; val_auprc_score: 0.9990; val_best_acc_score: 0.9900; val_best_f1_score: 0.9942; train_kl_reg_loss: 1969.1820; train_edge_recon_loss: 75872.8697; train_gene_expr_recon_loss: 82695.0026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160537.0545; train_optim_loss: 160537.0545; val_kl_reg_loss: 1947.5231; val_edge_recon_loss: 75779.0834; val_gene_expr_recon_loss: 82463.8800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160190.4865; val_optim_loss: 160190.4865
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9953; val_auprc_score: 0.9985; val_best_acc_score: 0.9904; val_best_f1_score: 0.9944; train_kl_reg_loss: 1974.0429; train_edge_recon_loss: 75504.6333; train_gene_expr_recon_loss: 82426.1334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159904.8094; train_optim_loss: 159904.8094; val_kl_reg_loss: 1957.8585; val_edge_recon_loss: 75217.5286; val_gene_expr_recon_loss: 82247.1942; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159422.5808; val_optim_loss: 159422.5808

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9953; val_auprc_score: 0.9982; val_best_acc_score: 0.9903; val_best_f1_score: 0.9943; train_kl_reg_loss: 1979.9444; train_edge_recon_loss: 75817.8984; train_gene_expr_recon_loss: 81842.6851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159640.5279; train_optim_loss: 159640.5279; val_kl_reg_loss: 1960.8973; val_edge_recon_loss: 76001.1998; val_gene_expr_recon_loss: 81735.7573; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159697.8540; val_optim_loss: 159697.8540
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9950; val_auprc_score: 0.9984; val_best_acc_score: 0.9903; val_best_f1_score: 0.9943; train_kl_reg_loss: 1976.0984; train_edge_recon_loss: 75631.2423; train_gene_expr_recon_loss: 81764.1491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159371.4897; train_optim_loss: 159371.4897; val_kl_reg_loss: 1961.5530; val_edge_recon_loss: 75755.9426; val_gene_expr_recon_loss: 81789.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159507.0186; val_optim_loss: 159507.0186
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9951; val_auprc_score: 0.9987; val_best_acc_score: 0.9895; val_best_f1_score: 0.9939; train_kl_reg_loss: 1975.1013; train_edge_recon_loss: 75537.2147; train_gene_expr_recon_loss: 81709.9520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159222.2678; train_optim_loss: 159222.2678; val_kl_reg_loss: 1952.1388; val_edge_recon_loss: 76122.9314; val_gene_expr_recon_loss: 81694.8746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159769.9442; val_optim_loss: 159769.9442

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 21 min 18 sec.
Using best model state, which was in epoch 6.

--- MODEL EVALUATION ---
Val AUROC score: 0.9947
Val AUPRC score: 0.9983
Val best accuracy score: 0.9885
Val best F1 score: 0.9933
Val gene expr MSE score: 0.8939
Duration of model training in run 9: 0 hours, 21 minutes and 49 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 529546
Number of validation edges: 58838
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9901; val_auprc_score: 0.9978; val_best_acc_score: 0.9794; val_best_f1_score: 0.9880; train_kl_reg_loss: 1872.3774; train_edge_recon_loss: 79607.4356; train_gene_expr_recon_loss: 91097.7952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172577.6082; train_optim_loss: 172577.6082; val_kl_reg_loss: 1898.6120; val_edge_recon_loss: 76563.3626; val_gene_expr_recon_loss: 87508.9631; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165970.9383; val_optim_loss: 165970.9383
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9923; val_auprc_score: 0.9981; val_best_acc_score: 0.9835; val_best_f1_score: 0.9904; train_kl_reg_loss: 1923.5522; train_edge_recon_loss: 76505.0265; train_gene_expr_recon_loss: 86551.9670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164980.5458; train_optim_loss: 164980.5458; val_kl_reg_loss: 1912.3504; val_edge_recon_loss: 75844.2616; val_gene_expr_recon_loss: 85660.9169; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163417.5283; val_optim_loss: 163417.5283
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9939; val_auprc_score: 0.9983; val_best_acc_score: 0.9862; val_best_f1_score: 0.9920; train_kl_reg_loss: 1924.5098; train_edge_recon_loss: 75991.4135; train_gene_expr_recon_loss: 85197.2024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163113.1258; train_optim_loss: 163113.1258; val_kl_reg_loss: 1878.6527; val_edge_recon_loss: 75661.3393; val_gene_expr_recon_loss: 84616.0279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162156.0218; val_optim_loss: 162156.0218
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9941; val_auprc_score: 0.9986; val_best_acc_score: 0.9868; val_best_f1_score: 0.9923; train_kl_reg_loss: 1932.5511; train_edge_recon_loss: 76117.2482; train_gene_expr_recon_loss: 84277.8504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162327.6498; train_optim_loss: 162327.6498; val_kl_reg_loss: 1887.9647; val_edge_recon_loss: 75475.1898; val_gene_expr_recon_loss: 83865.9690; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161229.1239; val_optim_loss: 161229.1239
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9942; val_auprc_score: 0.9982; val_best_acc_score: 0.9884; val_best_f1_score: 0.9932; train_kl_reg_loss: 1940.9671; train_edge_recon_loss: 75978.7283; train_gene_expr_recon_loss: 83692.1321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161611.8275; train_optim_loss: 161611.8275; val_kl_reg_loss: 1981.7087; val_edge_recon_loss: 75318.5628; val_gene_expr_recon_loss: 83226.4414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160526.7134; val_optim_loss: 160526.7134
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9952; val_auprc_score: 0.9988; val_best_acc_score: 0.9894; val_best_f1_score: 0.9938; train_kl_reg_loss: 1955.5622; train_edge_recon_loss: 76026.1822; train_gene_expr_recon_loss: 83230.8529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161212.5975; train_optim_loss: 161212.5975; val_kl_reg_loss: 1948.7192; val_edge_recon_loss: 75553.1549; val_gene_expr_recon_loss: 82974.6704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160476.5461; val_optim_loss: 160476.5461
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9945; val_auprc_score: 0.9984; val_best_acc_score: 0.9885; val_best_f1_score: 0.9933; train_kl_reg_loss: 1958.4359; train_edge_recon_loss: 75665.7160; train_gene_expr_recon_loss: 82816.3916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160440.5431; train_optim_loss: 160440.5431; val_kl_reg_loss: 1935.2940; val_edge_recon_loss: 76448.5705; val_gene_expr_recon_loss: 82640.8893; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161024.7530; val_optim_loss: 161024.7530
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9955; val_auprc_score: 0.9987; val_best_acc_score: 0.9905; val_best_f1_score: 0.9944; train_kl_reg_loss: 1968.9915; train_edge_recon_loss: 75770.2286; train_gene_expr_recon_loss: 82513.7301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160252.9505; train_optim_loss: 160252.9505; val_kl_reg_loss: 1995.9252; val_edge_recon_loss: 75793.5983; val_gene_expr_recon_loss: 82274.0714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160063.5940; val_optim_loss: 160063.5940
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9955; val_auprc_score: 0.9989; val_best_acc_score: 0.9908; val_best_f1_score: 0.9946; train_kl_reg_loss: 1979.6327; train_edge_recon_loss: 76132.4015; train_gene_expr_recon_loss: 82269.0699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160381.1044; train_optim_loss: 160381.1044; val_kl_reg_loss: 1913.9380; val_edge_recon_loss: 74645.8404; val_gene_expr_recon_loss: 82128.6385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158688.4173; val_optim_loss: 158688.4173
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9958; val_auprc_score: 0.9988; val_best_acc_score: 0.9911; val_best_f1_score: 0.9948; train_kl_reg_loss: 1983.5568; train_edge_recon_loss: 75532.1678; train_gene_expr_recon_loss: 82030.2112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159545.9361; train_optim_loss: 159545.9361; val_kl_reg_loss: 1967.2032; val_edge_recon_loss: 76368.6790; val_gene_expr_recon_loss: 81894.0540; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160229.9372; val_optim_loss: 160229.9372
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9953; val_auprc_score: 0.9985; val_best_acc_score: 0.9906; val_best_f1_score: 0.9945; train_kl_reg_loss: 1991.5030; train_edge_recon_loss: 75855.1637; train_gene_expr_recon_loss: 81815.4782; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159662.1451; train_optim_loss: 159662.1451; val_kl_reg_loss: 2012.3739; val_edge_recon_loss: 75609.7594; val_gene_expr_recon_loss: 81721.4805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159343.6131; val_optim_loss: 159343.6131
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9951; val_auprc_score: 0.9987; val_best_acc_score: 0.9912; val_best_f1_score: 0.9948; train_kl_reg_loss: 2000.4949; train_edge_recon_loss: 75561.3062; train_gene_expr_recon_loss: 81626.1962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159187.9972; train_optim_loss: 159187.9972; val_kl_reg_loss: 1998.7901; val_edge_recon_loss: 76578.7764; val_gene_expr_recon_loss: 81540.3429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160117.9092; val_optim_loss: 160117.9092

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9964; val_auprc_score: 0.9987; val_best_acc_score: 0.9919; val_best_f1_score: 0.9953; train_kl_reg_loss: 2007.9885; train_edge_recon_loss: 75506.4484; train_gene_expr_recon_loss: 81113.0297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158627.4665; train_optim_loss: 158627.4665; val_kl_reg_loss: 1992.2645; val_edge_recon_loss: 75195.7750; val_gene_expr_recon_loss: 81219.8681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158407.9073; val_optim_loss: 158407.9073
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9964; val_auprc_score: 0.9988; val_best_acc_score: 0.9917; val_best_f1_score: 0.9952; train_kl_reg_loss: 2001.7256; train_edge_recon_loss: 75443.4315; train_gene_expr_recon_loss: 81039.4932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158484.6506; train_optim_loss: 158484.6506; val_kl_reg_loss: 1986.7118; val_edge_recon_loss: 75958.7466; val_gene_expr_recon_loss: 81253.9112; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159199.3704; val_optim_loss: 159199.3704
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9962; val_auprc_score: 0.9989; val_best_acc_score: 0.9920; val_best_f1_score: 0.9953; train_kl_reg_loss: 1995.5112; train_edge_recon_loss: 75834.0035; train_gene_expr_recon_loss: 81003.3762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158832.8907; train_optim_loss: 158832.8907; val_kl_reg_loss: 1984.9978; val_edge_recon_loss: 75369.2767; val_gene_expr_recon_loss: 81121.6130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158475.8879; val_optim_loss: 158475.8879
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9964; val_auprc_score: 0.9991; val_best_acc_score: 0.9916; val_best_f1_score: 0.9951; train_kl_reg_loss: 1994.5881; train_edge_recon_loss: 75657.3940; train_gene_expr_recon_loss: 80985.8376; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158637.8196; train_optim_loss: 158637.8196; val_kl_reg_loss: 1996.0304; val_edge_recon_loss: 75124.8213; val_gene_expr_recon_loss: 81069.6785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158190.5302; val_optim_loss: 158190.5302
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9949; val_auprc_score: 0.9976; val_best_acc_score: 0.9922; val_best_f1_score: 0.9955; train_kl_reg_loss: 1997.1588; train_edge_recon_loss: 75575.9926; train_gene_expr_recon_loss: 80906.7926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158479.9439; train_optim_loss: 158479.9439; val_kl_reg_loss: 1986.6327; val_edge_recon_loss: 75131.8994; val_gene_expr_recon_loss: 81086.5461; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158205.0776; val_optim_loss: 158205.0776
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9958; val_auprc_score: 0.9985; val_best_acc_score: 0.9919; val_best_f1_score: 0.9953; train_kl_reg_loss: 1996.8851; train_edge_recon_loss: 76022.7980; train_gene_expr_recon_loss: 80915.2659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158934.9489; train_optim_loss: 158934.9489; val_kl_reg_loss: 1984.2315; val_edge_recon_loss: 75296.6837; val_gene_expr_recon_loss: 81056.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158337.4157; val_optim_loss: 158337.4157
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9958; val_auprc_score: 0.9988; val_best_acc_score: 0.9916; val_best_f1_score: 0.9951; train_kl_reg_loss: 1998.9006; train_edge_recon_loss: 75889.5420; train_gene_expr_recon_loss: 80891.9350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158780.3774; train_optim_loss: 158780.3774; val_kl_reg_loss: 1967.5832; val_edge_recon_loss: 74887.4165; val_gene_expr_recon_loss: 81105.6245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157960.6239; val_optim_loss: 157960.6239
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9952; val_auprc_score: 0.9982; val_best_acc_score: 0.9918; val_best_f1_score: 0.9952; train_kl_reg_loss: 1999.7823; train_edge_recon_loss: 75917.9386; train_gene_expr_recon_loss: 80854.4996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158772.2209; train_optim_loss: 158772.2209; val_kl_reg_loss: 1990.8225; val_edge_recon_loss: 75083.7247; val_gene_expr_recon_loss: 81049.9643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158124.5116; val_optim_loss: 158124.5116
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9962; val_auprc_score: 0.9988; val_best_acc_score: 0.9921; val_best_f1_score: 0.9954; train_kl_reg_loss: 1996.5026; train_edge_recon_loss: 75827.3493; train_gene_expr_recon_loss: 80832.2265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158656.0783; train_optim_loss: 158656.0783; val_kl_reg_loss: 1987.3304; val_edge_recon_loss: 75447.4379; val_gene_expr_recon_loss: 81050.4727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158485.2406; val_optim_loss: 158485.2406
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9968; val_auprc_score: 0.9992; val_best_acc_score: 0.9923; val_best_f1_score: 0.9955; train_kl_reg_loss: 1997.0334; train_edge_recon_loss: 75666.4825; train_gene_expr_recon_loss: 80847.6989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158511.2149; train_optim_loss: 158511.2149; val_kl_reg_loss: 1991.0258; val_edge_recon_loss: 74269.2354; val_gene_expr_recon_loss: 80907.1126; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157167.3739; val_optim_loss: 157167.3739
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9959; val_auprc_score: 0.9987; val_best_acc_score: 0.9918; val_best_f1_score: 0.9952; train_kl_reg_loss: 1997.1047; train_edge_recon_loss: 75850.5453; train_gene_expr_recon_loss: 80815.9975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158663.6479; train_optim_loss: 158663.6479; val_kl_reg_loss: 1980.2608; val_edge_recon_loss: 74291.1416; val_gene_expr_recon_loss: 81003.0392; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157274.4434; val_optim_loss: 157274.4434
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9958; val_auprc_score: 0.9988; val_best_acc_score: 0.9915; val_best_f1_score: 0.9951; train_kl_reg_loss: 1998.8656; train_edge_recon_loss: 75952.2803; train_gene_expr_recon_loss: 80783.8265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158734.9725; train_optim_loss: 158734.9725; val_kl_reg_loss: 1994.6075; val_edge_recon_loss: 75927.7569; val_gene_expr_recon_loss: 80987.1207; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158909.4855; val_optim_loss: 158909.4855
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9962; val_auprc_score: 0.9988; val_best_acc_score: 0.9925; val_best_f1_score: 0.9956; train_kl_reg_loss: 1999.5930; train_edge_recon_loss: 75776.8145; train_gene_expr_recon_loss: 80785.5836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158561.9910; train_optim_loss: 158561.9910; val_kl_reg_loss: 1988.6342; val_edge_recon_loss: 75217.5873; val_gene_expr_recon_loss: 80953.0944; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158159.3155; val_optim_loss: 158159.3155

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9963; val_auprc_score: 0.9989; val_best_acc_score: 0.9925; val_best_f1_score: 0.9956; train_kl_reg_loss: 2001.9767; train_edge_recon_loss: 75605.5493; train_gene_expr_recon_loss: 80708.2534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158315.7793; train_optim_loss: 158315.7793; val_kl_reg_loss: 1982.8103; val_edge_recon_loss: 75337.8138; val_gene_expr_recon_loss: 80949.7726; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158270.3963; val_optim_loss: 158270.3963
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9958; val_auprc_score: 0.9987; val_best_acc_score: 0.9918; val_best_f1_score: 0.9952; train_kl_reg_loss: 1999.5319; train_edge_recon_loss: 75558.9112; train_gene_expr_recon_loss: 80682.8026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158241.2455; train_optim_loss: 158241.2455; val_kl_reg_loss: 1987.4691; val_edge_recon_loss: 75185.1559; val_gene_expr_recon_loss: 80919.6596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158092.2853; val_optim_loss: 158092.2853
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9975; val_auprc_score: 0.9994; val_best_acc_score: 0.9924; val_best_f1_score: 0.9956; train_kl_reg_loss: 2000.6908; train_edge_recon_loss: 75860.2052; train_gene_expr_recon_loss: 80703.2800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158564.1761; train_optim_loss: 158564.1761; val_kl_reg_loss: 1989.1925; val_edge_recon_loss: 75192.2639; val_gene_expr_recon_loss: 80999.1936; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158180.6506; val_optim_loss: 158180.6506

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 49 min 21 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
Val AUROC score: 0.9961
Val AUPRC score: 0.9990
Val best accuracy score: 0.9925
Val best F1 score: 0.9956
Val gene expr MSE score: 0.8302
Duration of model training in run 10: 0 hours, 49 minutes and 49 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
First script finished. Launching follow up script.
Run timestamp: 02062023_101541.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '8192', '8192', '4096', '4096', '2048', '2048', '1024', '1024', '1024', '1024', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_1pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-attention_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-attention', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 1132
Number of validation edges: 125
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7932; val_auprc_score: 0.9572; val_best_acc_score: 0.8759; val_best_f1_score: 0.9302; train_kl_reg_loss: 65.3801; train_edge_recon_loss: 89887.5625; train_gene_expr_recon_loss: 160679.7031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 250632.6562; train_optim_loss: 250632.6562; val_kl_reg_loss: 66.3677; val_edge_recon_loss: 107525.3672; val_gene_expr_recon_loss: 141818.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 249410.3438; val_optim_loss: 249410.3438
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8337; val_auprc_score: 0.9615; val_best_acc_score: 0.8784; val_best_f1_score: 0.9308; train_kl_reg_loss: 69.8206; train_edge_recon_loss: 102362.9375; train_gene_expr_recon_loss: 139324.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241757.6562; train_optim_loss: 241757.6562; val_kl_reg_loss: 88.8587; val_edge_recon_loss: 121180.3828; val_gene_expr_recon_loss: 132642.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 253911.6250; val_optim_loss: 253911.6250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7984; val_auprc_score: 0.9607; val_best_acc_score: 0.9021; val_best_f1_score: 0.9462; train_kl_reg_loss: 91.2871; train_edge_recon_loss: 100984.8594; train_gene_expr_recon_loss: 129690.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 230766.9531; train_optim_loss: 230766.9531; val_kl_reg_loss: 121.4507; val_edge_recon_loss: 99480.8750; val_gene_expr_recon_loss: 125893.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 225495.6719; val_optim_loss: 225495.6719
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9212; val_auprc_score: 0.9916; val_best_acc_score: 0.9058; val_best_f1_score: 0.9506; train_kl_reg_loss: 128.4947; train_edge_recon_loss: 106542.7969; train_gene_expr_recon_loss: 122735.0469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229406.3438; train_optim_loss: 229406.3438; val_kl_reg_loss: 174.7016; val_edge_recon_loss: 74805.0234; val_gene_expr_recon_loss: 120576.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195556.0312; val_optim_loss: 195556.0312
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7531; val_auprc_score: 0.8866; val_best_acc_score: 0.8431; val_best_f1_score: 0.9098; train_kl_reg_loss: 184.2703; train_edge_recon_loss: 105884.3750; train_gene_expr_recon_loss: 117249.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 223318.2500; train_optim_loss: 223318.2500; val_kl_reg_loss: 231.4579; val_edge_recon_loss: 146587.4844; val_gene_expr_recon_loss: 116470.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263289.4062; val_optim_loss: 263289.4062
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7263; val_auprc_score: 0.8945; val_best_acc_score: 0.8514; val_best_f1_score: 0.9173; train_kl_reg_loss: 245.3659; train_edge_recon_loss: 98847.5312; train_gene_expr_recon_loss: 113039.0156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212131.9062; train_optim_loss: 212131.9062; val_kl_reg_loss: 282.5665; val_edge_recon_loss: 124748.9531; val_gene_expr_recon_loss: 113413.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238445.2188; val_optim_loss: 238445.2188
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7256; val_auprc_score: 0.9244; val_best_acc_score: 0.8446; val_best_f1_score: 0.9158; train_kl_reg_loss: 304.0008; train_edge_recon_loss: 107413.9844; train_gene_expr_recon_loss: 109840.4141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217558.4062; train_optim_loss: 217558.4062; val_kl_reg_loss: 320.9847; val_edge_recon_loss: 125173.3906; val_gene_expr_recon_loss: 111223.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 236717.8438; val_optim_loss: 236717.8438

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7336; val_auprc_score: 0.9517; val_best_acc_score: 0.8803; val_best_f1_score: 0.9363; train_kl_reg_loss: 337.6827; train_edge_recon_loss: 90403.5859; train_gene_expr_recon_loss: 107551.6953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198292.9688; train_optim_loss: 198292.9688; val_kl_reg_loss: 320.4568; val_edge_recon_loss: 96426.5625; val_gene_expr_recon_loss: 111042.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207789.4688; val_optim_loss: 207789.4688
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.6811; val_auprc_score: 0.9063; val_best_acc_score: 0.8699; val_best_f1_score: 0.9294; train_kl_reg_loss: 338.7776; train_edge_recon_loss: 100002.8984; train_gene_expr_recon_loss: 107329.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207671.2500; train_optim_loss: 207671.2500; val_kl_reg_loss: 312.4194; val_edge_recon_loss: 115480.3906; val_gene_expr_recon_loss: 110866.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 226659.6250; val_optim_loss: 226659.6250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7382; val_auprc_score: 0.9029; val_best_acc_score: 0.8400; val_best_f1_score: 0.9124; train_kl_reg_loss: 335.3821; train_edge_recon_loss: 102304.3359; train_gene_expr_recon_loss: 107120.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209759.7812; train_optim_loss: 209759.7812; val_kl_reg_loss: 315.4549; val_edge_recon_loss: 133906.4062; val_gene_expr_recon_loss: 110695.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244917.6250; val_optim_loss: 244917.6250

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 5 sec.
Using best model state, which was in epoch 4.

--- MODEL EVALUATION ---
Val AUROC score: 0.8460
Val AUPRC score: 0.9668
Val best accuracy score: 0.8897
Val best F1 score: 0.9394
Val gene expr MSE score: 2.6982
Duration of model training in run 1: 0 hours, 0 minutes and 10 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 1132
Number of validation edges: 125
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8465; val_auprc_score: 0.9694; val_best_acc_score: 0.8904; val_best_f1_score: 0.9398; train_kl_reg_loss: 57.5188; train_edge_recon_loss: 92923.7969; train_gene_expr_recon_loss: 158605.5156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 251586.8281; train_optim_loss: 251586.8281; val_kl_reg_loss: 60.4735; val_edge_recon_loss: 110041.3281; val_gene_expr_recon_loss: 145642.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 255744.5000; val_optim_loss: 255744.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.6930; val_auprc_score: 0.9072; val_best_acc_score: 0.8523; val_best_f1_score: 0.9191; train_kl_reg_loss: 62.4885; train_edge_recon_loss: 100126.5156; train_gene_expr_recon_loss: 139018.8594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 239207.8750; train_optim_loss: 239207.8750; val_kl_reg_loss: 80.5008; val_edge_recon_loss: 126839.7422; val_gene_expr_recon_loss: 136324.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263244.7812; val_optim_loss: 263244.7812
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7293; val_auprc_score: 0.9191; val_best_acc_score: 0.8951; val_best_f1_score: 0.9434; train_kl_reg_loss: 83.1317; train_edge_recon_loss: 104719.0938; train_gene_expr_recon_loss: 129967.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 234770.1562; train_optim_loss: 234770.1562; val_kl_reg_loss: 116.9855; val_edge_recon_loss: 99432.2188; val_gene_expr_recon_loss: 129437.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228986.2031; val_optim_loss: 228986.2031
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7600; val_auprc_score: 0.9411; val_best_acc_score: 0.8581; val_best_f1_score: 0.9225; train_kl_reg_loss: 120.2198; train_edge_recon_loss: 103655.8984; train_gene_expr_recon_loss: 123134.5391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226910.6562; train_optim_loss: 226910.6562; val_kl_reg_loss: 166.3532; val_edge_recon_loss: 124050.6484; val_gene_expr_recon_loss: 123988.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248205.8750; val_optim_loss: 248205.8750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8413; val_auprc_score: 0.9608; val_best_acc_score: 0.8725; val_best_f1_score: 0.9283; train_kl_reg_loss: 169.6408; train_edge_recon_loss: 105140.8281; train_gene_expr_recon_loss: 117650.7031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 222961.1719; train_optim_loss: 222961.1719; val_kl_reg_loss: 224.3160; val_edge_recon_loss: 128477.9609; val_gene_expr_recon_loss: 119750.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248453.1406; val_optim_loss: 248453.1406
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7231; val_auprc_score: 0.9153; val_best_acc_score: 0.8716; val_best_f1_score: 0.9294; train_kl_reg_loss: 232.2678; train_edge_recon_loss: 105135.0000; train_gene_expr_recon_loss: 113371.1406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 218738.4062; train_optim_loss: 218738.4062; val_kl_reg_loss: 285.0057; val_edge_recon_loss: 124344.6094; val_gene_expr_recon_loss: 116601.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241231.4375; val_optim_loss: 241231.4375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7729; val_auprc_score: 0.9317; val_best_acc_score: 0.9161; val_best_f1_score: 0.9542; train_kl_reg_loss: 297.2810; train_edge_recon_loss: 96973.5703; train_gene_expr_recon_loss: 110121.8594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207392.7188; train_optim_loss: 207392.7188; val_kl_reg_loss: 290.4812; val_edge_recon_loss: 99929.1875; val_gene_expr_recon_loss: 116341.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216561.2969; val_optim_loss: 216561.2969
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8413; val_auprc_score: 0.9551; val_best_acc_score: 0.8973; val_best_f1_score: 0.9434; train_kl_reg_loss: 302.7484; train_edge_recon_loss: 99882.5703; train_gene_expr_recon_loss: 109871.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210056.5312; train_optim_loss: 210056.5312; val_kl_reg_loss: 295.6692; val_edge_recon_loss: 114591.1484; val_gene_expr_recon_loss: 116092.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 230978.8438; val_optim_loss: 230978.8438
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7636; val_auprc_score: 0.9234; val_best_acc_score: 0.8639; val_best_f1_score: 0.9259; train_kl_reg_loss: 302.4500; train_edge_recon_loss: 102624.5859; train_gene_expr_recon_loss: 109630.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212557.1250; train_optim_loss: 212557.1250; val_kl_reg_loss: 291.8470; val_edge_recon_loss: 120179.0859; val_gene_expr_recon_loss: 115851.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 236322.5625; val_optim_loss: 236322.5625
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.6495; val_auprc_score: 0.8839; val_best_acc_score: 0.8591; val_best_f1_score: 0.9225; train_kl_reg_loss: 303.1691; train_edge_recon_loss: 101874.7656; train_gene_expr_recon_loss: 109365.3594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211543.2969; train_optim_loss: 211543.2969; val_kl_reg_loss: 291.5602; val_edge_recon_loss: 129187.9688; val_gene_expr_recon_loss: 115619.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245099.0312; val_optim_loss: 245099.0312

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7748; val_auprc_score: 0.9364; val_best_acc_score: 0.9103; val_best_f1_score: 0.9502; train_kl_reg_loss: 305.6460; train_edge_recon_loss: 110304.1562; train_gene_expr_recon_loss: 109145.3828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219755.1875; train_optim_loss: 219755.1875; val_kl_reg_loss: 291.8787; val_edge_recon_loss: 110170.2266; val_gene_expr_recon_loss: 115596.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 226058.9219; val_optim_loss: 226058.9219
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8120; val_auprc_score: 0.9550; val_best_acc_score: 0.9034; val_best_f1_score: 0.9466; train_kl_reg_loss: 303.3400; train_edge_recon_loss: 93494.7578; train_gene_expr_recon_loss: 109072.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202870.3125; train_optim_loss: 202870.3125; val_kl_reg_loss: 291.0885; val_edge_recon_loss: 110139.1094; val_gene_expr_recon_loss: 115574.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 226004.5469; val_optim_loss: 226004.5469
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7754; val_auprc_score: 0.9159; val_best_acc_score: 0.8904; val_best_f1_score: 0.9394; train_kl_reg_loss: 303.6870; train_edge_recon_loss: 103031.3125; train_gene_expr_recon_loss: 109106.9922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212442.0000; train_optim_loss: 212442.0000; val_kl_reg_loss: 291.4852; val_edge_recon_loss: 114799.2031; val_gene_expr_recon_loss: 115552.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 230642.7969; val_optim_loss: 230642.7969

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 2 sec.
Using best model state, which was in epoch 7.

--- MODEL EVALUATION ---
Val AUROC score: 0.7745
Val AUPRC score: 0.9211
Val best accuracy score: 0.8776
Val best F1 score: 0.9328
Val gene expr MSE score: 2.3613
Duration of model training in run 2: 0 hours, 0 minutes and 3 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 2243
Number of validation edges: 249
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8647; val_auprc_score: 0.9568; val_best_acc_score: 0.9031; val_best_f1_score: 0.9466; train_kl_reg_loss: 55.4429; train_edge_recon_loss: 101540.2344; train_gene_expr_recon_loss: 159452.5781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261048.2500; train_optim_loss: 261048.2500; val_kl_reg_loss: 65.0335; val_edge_recon_loss: 106895.2812; val_gene_expr_recon_loss: 132416.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 239376.4219; val_optim_loss: 239376.4219
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8283; val_auprc_score: 0.9668; val_best_acc_score: 0.8858; val_best_f1_score: 0.9379; train_kl_reg_loss: 63.8541; train_edge_recon_loss: 97292.2109; train_gene_expr_recon_loss: 139263.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 236619.8438; train_optim_loss: 236619.8438; val_kl_reg_loss: 89.8160; val_edge_recon_loss: 109258.7578; val_gene_expr_recon_loss: 122074.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 231423.1562; val_optim_loss: 231423.1562
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8896; val_auprc_score: 0.9709; val_best_acc_score: 0.8897; val_best_f1_score: 0.9382; train_kl_reg_loss: 88.6955; train_edge_recon_loss: 101179.0469; train_gene_expr_recon_loss: 129218.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 230486.0312; train_optim_loss: 230486.0312; val_kl_reg_loss: 131.2474; val_edge_recon_loss: 112276.7812; val_gene_expr_recon_loss: 115060.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227468.8906; val_optim_loss: 227468.8906
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8556; val_auprc_score: 0.9550; val_best_acc_score: 0.8851; val_best_f1_score: 0.9339; train_kl_reg_loss: 130.2847; train_edge_recon_loss: 95701.5391; train_gene_expr_recon_loss: 122030.3906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217862.2188; train_optim_loss: 217862.2188; val_kl_reg_loss: 195.3165; val_edge_recon_loss: 127128.8359; val_gene_expr_recon_loss: 109667.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 236991.8125; val_optim_loss: 236991.8125
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8337; val_auprc_score: 0.9491; val_best_acc_score: 0.8750; val_best_f1_score: 0.9290; train_kl_reg_loss: 192.9834; train_edge_recon_loss: 104916.8984; train_gene_expr_recon_loss: 116437.1094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 221547.0000; train_optim_loss: 221547.0000; val_kl_reg_loss: 271.4165; val_edge_recon_loss: 127656.3672; val_gene_expr_recon_loss: 105583.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 233511.6562; val_optim_loss: 233511.6562
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8040; val_auprc_score: 0.9496; val_best_acc_score: 0.8528; val_best_f1_score: 0.9173; train_kl_reg_loss: 267.8646; train_edge_recon_loss: 99293.5469; train_gene_expr_recon_loss: 112104.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211665.5312; train_optim_loss: 211665.5312; val_kl_reg_loss: 361.0198; val_edge_recon_loss: 134898.9531; val_gene_expr_recon_loss: 102645.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237905.1250; val_optim_loss: 237905.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8047; val_auprc_score: 0.9351; val_best_acc_score: 0.8439; val_best_f1_score: 0.9134; train_kl_reg_loss: 352.4487; train_edge_recon_loss: 103415.5547; train_gene_expr_recon_loss: 109004.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212772.1875; train_optim_loss: 212772.1875; val_kl_reg_loss: 364.7441; val_edge_recon_loss: 139226.9062; val_gene_expr_recon_loss: 102410.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 242001.8125; val_optim_loss: 242001.8125
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8032; val_auprc_score: 0.9224; val_best_acc_score: 0.8771; val_best_f1_score: 0.9313; train_kl_reg_loss: 359.2626; train_edge_recon_loss: 104183.7344; train_gene_expr_recon_loss: 108652.3203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213195.3125; train_optim_loss: 213195.3125; val_kl_reg_loss: 367.6084; val_edge_recon_loss: 120817.7500; val_gene_expr_recon_loss: 102186.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 223371.5156; val_optim_loss: 223371.5156
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8363; val_auprc_score: 0.9604; val_best_acc_score: 0.8644; val_best_f1_score: 0.9257; train_kl_reg_loss: 361.6439; train_edge_recon_loss: 97817.7344; train_gene_expr_recon_loss: 108458.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206637.9688; train_optim_loss: 206637.9688; val_kl_reg_loss: 367.8562; val_edge_recon_loss: 125305.4297; val_gene_expr_recon_loss: 101970.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227643.6250; val_optim_loss: 227643.6250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8447; val_auprc_score: 0.9521; val_best_acc_score: 0.8601; val_best_f1_score: 0.9239; train_kl_reg_loss: 361.5858; train_edge_recon_loss: 106197.7812; train_gene_expr_recon_loss: 108205.1094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214764.4688; train_optim_loss: 214764.4688; val_kl_reg_loss: 368.0955; val_edge_recon_loss: 121028.4922; val_gene_expr_recon_loss: 101761.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 223158.4375; val_optim_loss: 223158.4375
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7835; val_auprc_score: 0.9254; val_best_acc_score: 0.8490; val_best_f1_score: 0.9156; train_kl_reg_loss: 360.7878; train_edge_recon_loss: 102797.8438; train_gene_expr_recon_loss: 108005.5781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211164.2188; train_optim_loss: 211164.2188; val_kl_reg_loss: 362.8846; val_edge_recon_loss: 132497.1094; val_gene_expr_recon_loss: 101560.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234420.4219; val_optim_loss: 234420.4219
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7995; val_auprc_score: 0.9499; val_best_acc_score: 0.8625; val_best_f1_score: 0.9257; train_kl_reg_loss: 356.9023; train_edge_recon_loss: 110794.2578; train_gene_expr_recon_loss: 107771.4297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 218922.5938; train_optim_loss: 218922.5938; val_kl_reg_loss: 359.0349; val_edge_recon_loss: 116374.7422; val_gene_expr_recon_loss: 101365.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218099.2656; val_optim_loss: 218099.2656
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7678; val_auprc_score: 0.9445; val_best_acc_score: 0.8865; val_best_f1_score: 0.9396; train_kl_reg_loss: 354.6425; train_edge_recon_loss: 101701.8438; train_gene_expr_recon_loss: 107562.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209619.2031; train_optim_loss: 209619.2031; val_kl_reg_loss: 356.7905; val_edge_recon_loss: 94421.2344; val_gene_expr_recon_loss: 101176.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195954.4375; val_optim_loss: 195954.4375
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7928; val_auprc_score: 0.9320; val_best_acc_score: 0.8586; val_best_f1_score: 0.9202; train_kl_reg_loss: 351.0435; train_edge_recon_loss: 100728.8516; train_gene_expr_recon_loss: 107331.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208411.6250; train_optim_loss: 208411.6250; val_kl_reg_loss: 349.6791; val_edge_recon_loss: 129837.5000; val_gene_expr_recon_loss: 100993.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 231180.7500; val_optim_loss: 231180.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8031; val_auprc_score: 0.9465; val_best_acc_score: 0.8785; val_best_f1_score: 0.9343; train_kl_reg_loss: 346.5375; train_edge_recon_loss: 97071.7344; train_gene_expr_recon_loss: 107159.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204577.7188; train_optim_loss: 204577.7188; val_kl_reg_loss: 346.8157; val_edge_recon_loss: 108959.3203; val_gene_expr_recon_loss: 100817.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210123.2188; val_optim_loss: 210123.2188
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7841; val_auprc_score: 0.9325; val_best_acc_score: 0.8625; val_best_f1_score: 0.9257; train_kl_reg_loss: 339.8378; train_edge_recon_loss: 102587.1328; train_gene_expr_recon_loss: 106917.6484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209844.6250; train_optim_loss: 209844.6250; val_kl_reg_loss: 343.5182; val_edge_recon_loss: 116420.0000; val_gene_expr_recon_loss: 100646.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217409.7344; val_optim_loss: 217409.7344

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8196; val_auprc_score: 0.9452; val_best_acc_score: 0.8664; val_best_f1_score: 0.9251; train_kl_reg_loss: 335.4631; train_edge_recon_loss: 101641.4766; train_gene_expr_recon_loss: 106775.9766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208752.9062; train_optim_loss: 208752.9062; val_kl_reg_loss: 342.6206; val_edge_recon_loss: 118422.2656; val_gene_expr_recon_loss: 100629.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 219394.3750; val_optim_loss: 219394.3750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8573; val_auprc_score: 0.9512; val_best_acc_score: 0.8696; val_best_f1_score: 0.9251; train_kl_reg_loss: 333.8544; train_edge_recon_loss: 100380.8906; train_gene_expr_recon_loss: 106737.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207452.0000; train_optim_loss: 207452.0000; val_kl_reg_loss: 339.0887; val_edge_recon_loss: 133815.9219; val_gene_expr_recon_loss: 100612.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234767.9375; val_optim_loss: 234767.9375
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8059; val_auprc_score: 0.9520; val_best_acc_score: 0.8780; val_best_f1_score: 0.9343; train_kl_reg_loss: 335.3257; train_edge_recon_loss: 101378.4219; train_gene_expr_recon_loss: 106757.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208471.0625; train_optim_loss: 208471.0625; val_kl_reg_loss: 343.3873; val_edge_recon_loss: 106411.1406; val_gene_expr_recon_loss: 100596.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207351.0625; val_optim_loss: 207351.0625

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 5 sec.
Using best model state, which was in epoch 13.

--- MODEL EVALUATION ---
Val AUROC score: 0.7669
Val AUPRC score: 0.9307
Val best accuracy score: 0.8462
Val best F1 score: 0.9135
Val gene expr MSE score: 1.8162
Duration of model training in run 3: 0 hours, 0 minutes and 7 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 2243
Number of validation edges: 249
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8100; val_auprc_score: 0.9295; val_best_acc_score: 0.9135; val_best_f1_score: 0.9520; train_kl_reg_loss: 50.2220; train_edge_recon_loss: 96568.4766; train_gene_expr_recon_loss: 163758.3594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260377.0625; train_optim_loss: 260377.0625; val_kl_reg_loss: 57.9052; val_edge_recon_loss: 107809.9062; val_gene_expr_recon_loss: 142076.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 249944.0938; val_optim_loss: 249944.0938
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8410; val_auprc_score: 0.9522; val_best_acc_score: 0.8759; val_best_f1_score: 0.9310; train_kl_reg_loss: 58.8547; train_edge_recon_loss: 93008.8125; train_gene_expr_recon_loss: 140224.6094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 233292.2812; train_optim_loss: 233292.2812; val_kl_reg_loss: 84.6130; val_edge_recon_loss: 112253.4531; val_gene_expr_recon_loss: 132234.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244572.7188; val_optim_loss: 244572.7188
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7441; val_auprc_score: 0.9202; val_best_acc_score: 0.8846; val_best_f1_score: 0.9379; train_kl_reg_loss: 86.0685; train_edge_recon_loss: 100357.3984; train_gene_expr_recon_loss: 130030.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 230473.9375; train_optim_loss: 230473.9375; val_kl_reg_loss: 131.4342; val_edge_recon_loss: 103684.8984; val_gene_expr_recon_loss: 125344.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229160.4531; val_optim_loss: 229160.4531
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8089; val_auprc_score: 0.9333; val_best_acc_score: 0.8591; val_best_f1_score: 0.9198; train_kl_reg_loss: 134.8122; train_edge_recon_loss: 101399.6250; train_gene_expr_recon_loss: 123008.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224543.2188; train_optim_loss: 224543.2188; val_kl_reg_loss: 202.4203; val_edge_recon_loss: 132348.5000; val_gene_expr_recon_loss: 119913.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 252464.0938; val_optim_loss: 252464.0938
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8314; val_auprc_score: 0.9621; val_best_acc_score: 0.8789; val_best_f1_score: 0.9343; train_kl_reg_loss: 205.5730; train_edge_recon_loss: 103635.5000; train_gene_expr_recon_loss: 117385.8594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 221226.9375; train_optim_loss: 221226.9375; val_kl_reg_loss: 282.7829; val_edge_recon_loss: 111368.7578; val_gene_expr_recon_loss: 115663.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227314.6562; val_optim_loss: 227314.6562
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7873; val_auprc_score: 0.9573; val_best_acc_score: 0.9004; val_best_f1_score: 0.9462; train_kl_reg_loss: 290.7814; train_edge_recon_loss: 103358.4844; train_gene_expr_recon_loss: 112970.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216619.4844; train_optim_loss: 216619.4844; val_kl_reg_loss: 371.7872; val_edge_recon_loss: 91975.3203; val_gene_expr_recon_loss: 112476.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204823.1250; val_optim_loss: 204823.1250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8332; val_auprc_score: 0.9484; val_best_acc_score: 0.8605; val_best_f1_score: 0.9213; train_kl_reg_loss: 378.1544; train_edge_recon_loss: 100732.1719; train_gene_expr_recon_loss: 109640.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210751.0156; train_optim_loss: 210751.0156; val_kl_reg_loss: 435.0057; val_edge_recon_loss: 138952.7656; val_gene_expr_recon_loss: 110148.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 249536.6250; val_optim_loss: 249536.6250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8437; val_auprc_score: 0.9607; val_best_acc_score: 0.8905; val_best_f1_score: 0.9405; train_kl_reg_loss: 446.4043; train_edge_recon_loss: 104563.0391; train_gene_expr_recon_loss: 107262.4141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212271.8594; train_optim_loss: 212271.8594; val_kl_reg_loss: 469.8921; val_edge_recon_loss: 96924.2734; val_gene_expr_recon_loss: 108414.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205808.5156; val_optim_loss: 205808.5156
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7701; val_auprc_score: 0.9050; val_best_acc_score: 0.8405; val_best_f1_score: 0.9121; train_kl_reg_loss: 483.9488; train_edge_recon_loss: 110670.1094; train_gene_expr_recon_loss: 105414.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216568.4062; train_optim_loss: 216568.4062; val_kl_reg_loss: 485.4915; val_edge_recon_loss: 139448.7344; val_gene_expr_recon_loss: 107117.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 247051.3438; val_optim_loss: 247051.3438

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8389; val_auprc_score: 0.9713; val_best_acc_score: 0.8975; val_best_f1_score: 0.9437; train_kl_reg_loss: 497.7261; train_edge_recon_loss: 96315.4688; train_gene_expr_recon_loss: 104042.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200855.5312; train_optim_loss: 200855.5312; val_kl_reg_loss: 489.7426; val_edge_recon_loss: 96742.3203; val_gene_expr_recon_loss: 107006.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204238.6406; val_optim_loss: 204238.6406
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7754; val_auprc_score: 0.9244; val_best_acc_score: 0.8828; val_best_f1_score: 0.9361; train_kl_reg_loss: 494.6490; train_edge_recon_loss: 99675.0156; train_gene_expr_recon_loss: 103947.1641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204116.8281; train_optim_loss: 204116.8281; val_kl_reg_loss: 475.8575; val_edge_recon_loss: 113319.8438; val_gene_expr_recon_loss: 106897.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220693.0938; val_optim_loss: 220693.0938
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7743; val_auprc_score: 0.9040; val_best_acc_score: 0.8482; val_best_f1_score: 0.9135; train_kl_reg_loss: 487.8095; train_edge_recon_loss: 98969.8516; train_gene_expr_recon_loss: 103829.6328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203287.2969; train_optim_loss: 203287.2969; val_kl_reg_loss: 466.6674; val_edge_recon_loss: 143299.1250; val_gene_expr_recon_loss: 106789.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 250555.7188; val_optim_loss: 250555.7188
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8040; val_auprc_score: 0.9255; val_best_acc_score: 0.8840; val_best_f1_score: 0.9344; train_kl_reg_loss: 482.0450; train_edge_recon_loss: 106686.7812; train_gene_expr_recon_loss: 103707.6797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210876.5000; train_optim_loss: 210876.5000; val_kl_reg_loss: 456.5005; val_edge_recon_loss: 120558.5469; val_gene_expr_recon_loss: 106685.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227700.0781; val_optim_loss: 227700.0781

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7891; val_auprc_score: 0.9369; val_best_acc_score: 0.8767; val_best_f1_score: 0.9326; train_kl_reg_loss: 470.2182; train_edge_recon_loss: 105491.2969; train_gene_expr_recon_loss: 103602.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209564.4375; train_optim_loss: 209564.4375; val_kl_reg_loss: 459.1396; val_edge_recon_loss: 118036.1797; val_gene_expr_recon_loss: 106674.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 225169.9688; val_optim_loss: 225169.9688
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8000; val_auprc_score: 0.9161; val_best_acc_score: 0.8729; val_best_f1_score: 0.9291; train_kl_reg_loss: 468.7047; train_edge_recon_loss: 104543.9688; train_gene_expr_recon_loss: 103569.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208582.0312; train_optim_loss: 208582.0312; val_kl_reg_loss: 448.1262; val_edge_recon_loss: 134175.6875; val_gene_expr_recon_loss: 106664.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241288.0312; val_optim_loss: 241288.0312
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8281; val_auprc_score: 0.9353; val_best_acc_score: 0.8707; val_best_f1_score: 0.9272; train_kl_reg_loss: 467.4388; train_edge_recon_loss: 99904.0156; train_gene_expr_recon_loss: 103586.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203958.4062; train_optim_loss: 203958.4062; val_kl_reg_loss: 451.2547; val_edge_recon_loss: 122839.3125; val_gene_expr_recon_loss: 106653.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229944.3125; val_optim_loss: 229944.3125

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 5 sec.
Using best model state, which was in epoch 10.

--- MODEL EVALUATION ---
Val AUROC score: 0.7984
Val AUPRC score: 0.9369
Val best accuracy score: 0.8737
Val best F1 score: 0.9293
Val gene expr MSE score: 1.8595
Duration of model training in run 4: 0 hours, 0 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 3438
Number of validation edges: 382
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8452; val_auprc_score: 0.9627; val_best_acc_score: 0.9229; val_best_f1_score: 0.9583; train_kl_reg_loss: 51.6043; train_edge_recon_loss: 101713.5508; train_gene_expr_recon_loss: 153990.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 255755.6250; train_optim_loss: 255755.6250; val_kl_reg_loss: 76.5235; val_edge_recon_loss: 84861.9766; val_gene_expr_recon_loss: 124464.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209402.9219; val_optim_loss: 209402.9219
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8238; val_auprc_score: 0.9464; val_best_acc_score: 0.8884; val_best_f1_score: 0.9377; train_kl_reg_loss: 91.9672; train_edge_recon_loss: 98082.3789; train_gene_expr_recon_loss: 128425.8203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226600.1719; train_optim_loss: 226600.1719; val_kl_reg_loss: 155.2142; val_edge_recon_loss: 104228.6016; val_gene_expr_recon_loss: 112544.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216928.4844; val_optim_loss: 216928.4844
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7996; val_auprc_score: 0.9365; val_best_acc_score: 0.8731; val_best_f1_score: 0.9282; train_kl_reg_loss: 180.1453; train_edge_recon_loss: 96283.7227; train_gene_expr_recon_loss: 116327.1367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212791.0000; train_optim_loss: 212791.0000; val_kl_reg_loss: 266.9003; val_edge_recon_loss: 132130.8125; val_gene_expr_recon_loss: 105163.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237561.5625; val_optim_loss: 237561.5625
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7407; val_auprc_score: 0.9111; val_best_acc_score: 0.8736; val_best_f1_score: 0.9305; train_kl_reg_loss: 294.1231; train_edge_recon_loss: 96380.1016; train_gene_expr_recon_loss: 109018.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205693.1328; train_optim_loss: 205693.1328; val_kl_reg_loss: 365.1298; val_edge_recon_loss: 111010.5938; val_gene_expr_recon_loss: 100877.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 212253.6406; val_optim_loss: 212253.6406
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8219; val_auprc_score: 0.9478; val_best_acc_score: 0.8756; val_best_f1_score: 0.9328; train_kl_reg_loss: 372.2100; train_edge_recon_loss: 101045.5039; train_gene_expr_recon_loss: 104505.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205922.7188; train_optim_loss: 205922.7188; val_kl_reg_loss: 385.7193; val_edge_recon_loss: 109148.7266; val_gene_expr_recon_loss: 98579.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208114.1250; val_optim_loss: 208114.1250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7807; val_auprc_score: 0.9499; val_best_acc_score: 0.8652; val_best_f1_score: 0.9272; train_kl_reg_loss: 377.2923; train_edge_recon_loss: 99567.3086; train_gene_expr_recon_loss: 102279.6602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202224.2578; train_optim_loss: 202224.2578; val_kl_reg_loss: 347.2121; val_edge_recon_loss: 113693.0781; val_gene_expr_recon_loss: 97337.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211377.6094; val_optim_loss: 211377.6094
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7340; val_auprc_score: 0.8985; val_best_acc_score: 0.8714; val_best_f1_score: 0.9284; train_kl_reg_loss: 330.9703; train_edge_recon_loss: 99776.9414; train_gene_expr_recon_loss: 100938.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201046.8672; train_optim_loss: 201046.8672; val_kl_reg_loss: 284.9282; val_edge_recon_loss: 120817.3672; val_gene_expr_recon_loss: 96647.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217750.1250; val_optim_loss: 217750.1250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7661; val_auprc_score: 0.9268; val_best_acc_score: 0.8667; val_best_f1_score: 0.9252; train_kl_reg_loss: 267.5158; train_edge_recon_loss: 100669.0508; train_gene_expr_recon_loss: 99915.8867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200852.4531; train_optim_loss: 200852.4531; val_kl_reg_loss: 223.1632; val_edge_recon_loss: 118140.8906; val_gene_expr_recon_loss: 96229.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214593.5312; val_optim_loss: 214593.5312

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7463; val_auprc_score: 0.9198; val_best_acc_score: 0.8578; val_best_f1_score: 0.9216; train_kl_reg_loss: 219.7375; train_edge_recon_loss: 104567.5156; train_gene_expr_recon_loss: 99650.0742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204437.3203; train_optim_loss: 204437.3203; val_kl_reg_loss: 219.8253; val_edge_recon_loss: 119482.5000; val_gene_expr_recon_loss: 96186.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215888.7500; val_optim_loss: 215888.7500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7984; val_auprc_score: 0.9455; val_best_acc_score: 0.8814; val_best_f1_score: 0.9343; train_kl_reg_loss: 213.8537; train_edge_recon_loss: 103646.6250; train_gene_expr_recon_loss: 99483.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203344.1016; train_optim_loss: 203344.1016; val_kl_reg_loss: 211.5259; val_edge_recon_loss: 111883.1406; val_gene_expr_recon_loss: 96127.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208221.7500; val_optim_loss: 208221.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7811; val_auprc_score: 0.9590; val_best_acc_score: 0.9011; val_best_f1_score: 0.9467; train_kl_reg_loss: 207.4631; train_edge_recon_loss: 101004.8164; train_gene_expr_recon_loss: 99442.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200654.4844; train_optim_loss: 200654.4844; val_kl_reg_loss: 205.7595; val_edge_recon_loss: 93265.5781; val_gene_expr_recon_loss: 96055.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189526.3438; val_optim_loss: 189526.3438
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7443; val_auprc_score: 0.9296; val_best_acc_score: 0.8836; val_best_f1_score: 0.9365; train_kl_reg_loss: 201.6740; train_edge_recon_loss: 101118.2969; train_gene_expr_recon_loss: 99358.4766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200678.4531; train_optim_loss: 200678.4531; val_kl_reg_loss: 199.7272; val_edge_recon_loss: 100224.7891; val_gene_expr_recon_loss: 95975.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196399.7344; val_optim_loss: 196399.7344
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7540; val_auprc_score: 0.9076; val_best_acc_score: 0.8590; val_best_f1_score: 0.9216; train_kl_reg_loss: 196.3645; train_edge_recon_loss: 108024.5742; train_gene_expr_recon_loss: 99333.6211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207554.5547; train_optim_loss: 207554.5547; val_kl_reg_loss: 194.2135; val_edge_recon_loss: 123490.3359; val_gene_expr_recon_loss: 95890.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 219574.8125; val_optim_loss: 219574.8125
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8067; val_auprc_score: 0.9276; val_best_acc_score: 0.8659; val_best_f1_score: 0.9261; train_kl_reg_loss: 190.7305; train_edge_recon_loss: 103153.1953; train_gene_expr_recon_loss: 99124.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202468.7734; train_optim_loss: 202468.7734; val_kl_reg_loss: 189.8839; val_edge_recon_loss: 122977.7422; val_gene_expr_recon_loss: 95801.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218968.7812; val_optim_loss: 218968.7812

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7984; val_auprc_score: 0.9364; val_best_acc_score: 0.8731; val_best_f1_score: 0.9306; train_kl_reg_loss: 187.2068; train_edge_recon_loss: 100209.5469; train_gene_expr_recon_loss: 98997.2070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199393.9688; train_optim_loss: 199393.9688; val_kl_reg_loss: 188.8022; val_edge_recon_loss: 115050.6250; val_gene_expr_recon_loss: 95791.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211031.2969; val_optim_loss: 211031.2969
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7343; val_auprc_score: 0.9171; val_best_acc_score: 0.8431; val_best_f1_score: 0.9139; train_kl_reg_loss: 187.3004; train_edge_recon_loss: 104645.7031; train_gene_expr_recon_loss: 99105.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203938.7891; train_optim_loss: 203938.7891; val_kl_reg_loss: 188.6458; val_edge_recon_loss: 132191.4219; val_gene_expr_recon_loss: 95782.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228162.2500; val_optim_loss: 228162.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.7861; val_auprc_score: 0.9297; val_best_acc_score: 0.8673; val_best_f1_score: 0.9272; train_kl_reg_loss: 185.8211; train_edge_recon_loss: 99621.3672; train_gene_expr_recon_loss: 98931.8320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198739.0156; train_optim_loss: 198739.0156; val_kl_reg_loss: 186.9021; val_edge_recon_loss: 118773.6953; val_gene_expr_recon_loss: 95772.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214732.8125; val_optim_loss: 214732.8125

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 6 sec.
Using best model state, which was in epoch 11.

--- MODEL EVALUATION ---
Val AUROC score: 0.7448
Val AUPRC score: 0.9264
Val best accuracy score: 0.8606
Val best F1 score: 0.9231
Val gene expr MSE score: 1.2693
Duration of model training in run 5: 0 hours, 0 minutes and 7 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 3438
Number of validation edges: 382
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8219; val_auprc_score: 0.9554; val_best_acc_score: 0.8993; val_best_f1_score: 0.9435; train_kl_reg_loss: 66.1795; train_edge_recon_loss: 107401.3711; train_gene_expr_recon_loss: 154884.9297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262352.4844; train_optim_loss: 262352.4844; val_kl_reg_loss: 94.3026; val_edge_recon_loss: 99821.2734; val_gene_expr_recon_loss: 122649.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222565.2188; val_optim_loss: 222565.2188
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7699; val_auprc_score: 0.9280; val_best_acc_score: 0.8697; val_best_f1_score: 0.9287; train_kl_reg_loss: 117.0899; train_edge_recon_loss: 95408.0625; train_gene_expr_recon_loss: 126661.5195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 222186.6719; train_optim_loss: 222186.6719; val_kl_reg_loss: 195.4741; val_edge_recon_loss: 113793.9062; val_gene_expr_recon_loss: 110622.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224612.0625; val_optim_loss: 224612.0625
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8424; val_auprc_score: 0.9510; val_best_acc_score: 0.8717; val_best_f1_score: 0.9287; train_kl_reg_loss: 238.1706; train_edge_recon_loss: 96677.6953; train_gene_expr_recon_loss: 114792.0547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211707.9141; train_optim_loss: 211707.9141; val_kl_reg_loss: 348.1310; val_edge_recon_loss: 124644.0078; val_gene_expr_recon_loss: 103355.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228347.8906; val_optim_loss: 228347.8906
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7882; val_auprc_score: 0.9474; val_best_acc_score: 0.8776; val_best_f1_score: 0.9340; train_kl_reg_loss: 393.5053; train_edge_recon_loss: 99594.6523; train_gene_expr_recon_loss: 107898.6680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207886.8203; train_optim_loss: 207886.8203; val_kl_reg_loss: 449.0976; val_edge_recon_loss: 108024.2578; val_gene_expr_recon_loss: 99272.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207746.2812; val_optim_loss: 207746.2812
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7955; val_auprc_score: 0.9565; val_best_acc_score: 0.8742; val_best_f1_score: 0.9298; train_kl_reg_loss: 466.9272; train_edge_recon_loss: 102228.0664; train_gene_expr_recon_loss: 104264.4023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206959.3984; train_optim_loss: 206959.3984; val_kl_reg_loss: 441.5658; val_edge_recon_loss: 114037.3984; val_gene_expr_recon_loss: 96932.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211411.7188; val_optim_loss: 211411.7188
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7710; val_auprc_score: 0.9370; val_best_acc_score: 0.8606; val_best_f1_score: 0.9231; train_kl_reg_loss: 437.9849; train_edge_recon_loss: 97240.3125; train_gene_expr_recon_loss: 101730.7852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199409.0781; train_optim_loss: 199409.0781; val_kl_reg_loss: 369.0182; val_edge_recon_loss: 124296.8438; val_gene_expr_recon_loss: 95675.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220341.0938; val_optim_loss: 220341.0938
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7217; val_auprc_score: 0.9303; val_best_acc_score: 0.8828; val_best_f1_score: 0.9374; train_kl_reg_loss: 364.9114; train_edge_recon_loss: 110348.4062; train_gene_expr_recon_loss: 100886.4492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211599.7656; train_optim_loss: 211599.7656; val_kl_reg_loss: 296.9667; val_edge_recon_loss: 97607.4375; val_gene_expr_recon_loss: 94969.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192874.2812; val_optim_loss: 192874.2812
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7527; val_auprc_score: 0.9224; val_best_acc_score: 0.8977; val_best_f1_score: 0.9438; train_kl_reg_loss: 287.7693; train_edge_recon_loss: 106265.9258; train_gene_expr_recon_loss: 99232.8359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205786.5312; train_optim_loss: 205786.5312; val_kl_reg_loss: 236.0410; val_edge_recon_loss: 102222.7969; val_gene_expr_recon_loss: 94471.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196930.5938; val_optim_loss: 196930.5938
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7098; val_auprc_score: 0.9087; val_best_acc_score: 0.8694; val_best_f1_score: 0.9294; train_kl_reg_loss: 233.6640; train_edge_recon_loss: 106687.9258; train_gene_expr_recon_loss: 100001.6484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206923.2422; train_optim_loss: 206923.2422; val_kl_reg_loss: 201.8571; val_edge_recon_loss: 109804.4922; val_gene_expr_recon_loss: 94030.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204036.5781; val_optim_loss: 204036.5781
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7822; val_auprc_score: 0.9242; val_best_acc_score: 0.8739; val_best_f1_score: 0.9278; train_kl_reg_loss: 198.2290; train_edge_recon_loss: 95556.3672; train_gene_expr_recon_loss: 99171.9727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194926.5703; train_optim_loss: 194926.5703; val_kl_reg_loss: 175.0069; val_edge_recon_loss: 117822.4453; val_gene_expr_recon_loss: 93637.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211634.5469; val_optim_loss: 211634.5469

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7902; val_auprc_score: 0.9355; val_best_acc_score: 0.8742; val_best_f1_score: 0.9288; train_kl_reg_loss: 178.2436; train_edge_recon_loss: 98301.5039; train_gene_expr_recon_loss: 98548.2266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197027.9688; train_optim_loss: 197027.9688; val_kl_reg_loss: 173.4071; val_edge_recon_loss: 120363.7188; val_gene_expr_recon_loss: 93593.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214130.8750; val_optim_loss: 214130.8750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7188; val_auprc_score: 0.8946; val_best_acc_score: 0.8700; val_best_f1_score: 0.9278; train_kl_reg_loss: 177.1642; train_edge_recon_loss: 99950.2930; train_gene_expr_recon_loss: 97963.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198090.4922; train_optim_loss: 198090.4922; val_kl_reg_loss: 171.9774; val_edge_recon_loss: 121671.1484; val_gene_expr_recon_loss: 93542.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215385.1719; val_optim_loss: 215385.1719
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7913; val_auprc_score: 0.9445; val_best_acc_score: 0.8849; val_best_f1_score: 0.9358; train_kl_reg_loss: 174.8638; train_edge_recon_loss: 99571.9102; train_gene_expr_recon_loss: 97883.1992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197629.9688; train_optim_loss: 197629.9688; val_kl_reg_loss: 168.3856; val_edge_recon_loss: 105070.6094; val_gene_expr_recon_loss: 93482.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198721.6875; val_optim_loss: 198721.6875

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 4 sec.
Using best model state, which was in epoch 7.

--- MODEL EVALUATION ---
Val AUROC score: 0.7695
Val AUPRC score: 0.9224
Val best accuracy score: 0.8673
Val best F1 score: 0.9272
Val gene expr MSE score: 1.3341
Duration of model training in run 6: 0 hours, 0 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 4621
Number of validation edges: 513
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7891; val_auprc_score: 0.9365; val_best_acc_score: 0.8393; val_best_f1_score: 0.9120; train_kl_reg_loss: 89.9297; train_edge_recon_loss: 103627.2063; train_gene_expr_recon_loss: 135692.4453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 239409.5844; train_optim_loss: 239409.5844; val_kl_reg_loss: 200.6374; val_edge_recon_loss: 134961.5625; val_gene_expr_recon_loss: 116502.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 251664.9688; val_optim_loss: 251664.9688
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8025; val_auprc_score: 0.9478; val_best_acc_score: 0.8543; val_best_f1_score: 0.9184; train_kl_reg_loss: 310.2292; train_edge_recon_loss: 100751.9141; train_gene_expr_recon_loss: 108740.2844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209802.4281; train_optim_loss: 209802.4281; val_kl_reg_loss: 416.5392; val_edge_recon_loss: 129406.2891; val_gene_expr_recon_loss: 104811.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234633.9531; val_optim_loss: 234633.9531
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7348; val_auprc_score: 0.9219; val_best_acc_score: 0.8834; val_best_f1_score: 0.9363; train_kl_reg_loss: 384.9243; train_edge_recon_loss: 100565.6062; train_gene_expr_recon_loss: 101291.0641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202241.5969; train_optim_loss: 202241.5969; val_kl_reg_loss: 311.2229; val_edge_recon_loss: 106726.5703; val_gene_expr_recon_loss: 101669.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208706.9688; val_optim_loss: 208706.9688
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7393; val_auprc_score: 0.9457; val_best_acc_score: 0.8988; val_best_f1_score: 0.9464; train_kl_reg_loss: 242.4971; train_edge_recon_loss: 103441.3750; train_gene_expr_recon_loss: 100286.1969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203970.0688; train_optim_loss: 203970.0688; val_kl_reg_loss: 170.6373; val_edge_recon_loss: 83184.3906; val_gene_expr_recon_loss: 100722.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184077.8438; val_optim_loss: 184077.8438
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7365; val_auprc_score: 0.9304; val_best_acc_score: 0.8777; val_best_f1_score: 0.9330; train_kl_reg_loss: 141.7179; train_edge_recon_loss: 103874.7156; train_gene_expr_recon_loss: 96656.9563; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200673.3937; train_optim_loss: 200673.3937; val_kl_reg_loss: 127.7963; val_edge_recon_loss: 107419.6953; val_gene_expr_recon_loss: 100064.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207611.8125; val_optim_loss: 207611.8125
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7584; val_auprc_score: 0.9355; val_best_acc_score: 0.8801; val_best_f1_score: 0.9348; train_kl_reg_loss: 125.2995; train_edge_recon_loss: 98610.4672; train_gene_expr_recon_loss: 97086.9156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195822.6812; train_optim_loss: 195822.6812; val_kl_reg_loss: 139.1841; val_edge_recon_loss: 100161.8359; val_gene_expr_recon_loss: 99467.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 199768.8438; val_optim_loss: 199768.8438
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7635; val_auprc_score: 0.9233; val_best_acc_score: 0.8362; val_best_f1_score: 0.9066; train_kl_reg_loss: 147.9461; train_edge_recon_loss: 100020.5594; train_gene_expr_recon_loss: 96329.7578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196498.2594; train_optim_loss: 196498.2594; val_kl_reg_loss: 171.3619; val_edge_recon_loss: 138023.8281; val_gene_expr_recon_loss: 99052.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237247.9062; val_optim_loss: 237247.9062

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7058; val_auprc_score: 0.9088; val_best_acc_score: 0.8742; val_best_f1_score: 0.9316; train_kl_reg_loss: 164.8117; train_edge_recon_loss: 97996.8766; train_gene_expr_recon_loss: 95192.9922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193354.6781; train_optim_loss: 193354.6781; val_kl_reg_loss: 176.0809; val_edge_recon_loss: 103038.5938; val_gene_expr_recon_loss: 98996.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202210.6719; val_optim_loss: 202210.6719
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7768; val_auprc_score: 0.9449; val_best_acc_score: 0.8779; val_best_f1_score: 0.9330; train_kl_reg_loss: 165.6954; train_edge_recon_loss: 105515.1313; train_gene_expr_recon_loss: 94962.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200643.3281; train_optim_loss: 200643.3281; val_kl_reg_loss: 179.2348; val_edge_recon_loss: 102587.2266; val_gene_expr_recon_loss: 98918.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201684.6406; val_optim_loss: 201684.6406
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7208; val_auprc_score: 0.9311; val_best_acc_score: 0.8674; val_best_f1_score: 0.9284; train_kl_reg_loss: 169.7205; train_edge_recon_loss: 100596.3188; train_gene_expr_recon_loss: 97088.1734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197854.2094; train_optim_loss: 197854.2094; val_kl_reg_loss: 181.4708; val_edge_recon_loss: 106896.4297; val_gene_expr_recon_loss: 98831.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205908.9844; val_optim_loss: 205908.9844

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 5 sec.
Using best model state, which was in epoch 4.

--- MODEL EVALUATION ---
Val AUROC score: 0.7353
Val AUPRC score: 0.9194
Val best accuracy score: 0.8642
Val best F1 score: 0.9259
Val gene expr MSE score: 1.6171
Duration of model training in run 7: 0 hours, 0 minutes and 7 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 4621
Number of validation edges: 513
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7843; val_auprc_score: 0.9381; val_best_acc_score: 0.8704; val_best_f1_score: 0.9283; train_kl_reg_loss: 88.9608; train_edge_recon_loss: 102116.1234; train_gene_expr_recon_loss: 136349.8453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 238554.9375; train_optim_loss: 238554.9375; val_kl_reg_loss: 214.5787; val_edge_recon_loss: 119123.5859; val_gene_expr_recon_loss: 123207.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 242545.5312; val_optim_loss: 242545.5312
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7409; val_auprc_score: 0.9315; val_best_acc_score: 0.8810; val_best_f1_score: 0.9361; train_kl_reg_loss: 336.8191; train_edge_recon_loss: 100822.5547; train_gene_expr_recon_loss: 108269.8234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209429.1969; train_optim_loss: 209429.1969; val_kl_reg_loss: 465.3929; val_edge_recon_loss: 103194.6172; val_gene_expr_recon_loss: 112502.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216162.9688; val_optim_loss: 216162.9688
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7391; val_auprc_score: 0.9207; val_best_acc_score: 0.8562; val_best_f1_score: 0.9218; train_kl_reg_loss: 430.3444; train_edge_recon_loss: 102123.2625; train_gene_expr_recon_loss: 101810.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204364.5438; train_optim_loss: 204364.5438; val_kl_reg_loss: 316.6787; val_edge_recon_loss: 122377.8906; val_gene_expr_recon_loss: 109722.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 232417.2969; val_optim_loss: 232417.2969
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7530; val_auprc_score: 0.9221; val_best_acc_score: 0.8848; val_best_f1_score: 0.9363; train_kl_reg_loss: 248.7276; train_edge_recon_loss: 96703.7203; train_gene_expr_recon_loss: 100091.0422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197043.4906; train_optim_loss: 197043.4906; val_kl_reg_loss: 166.6224; val_edge_recon_loss: 113155.3594; val_gene_expr_recon_loss: 108702.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222024.7812; val_optim_loss: 222024.7812
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7040; val_auprc_score: 0.9212; val_best_acc_score: 0.8818; val_best_f1_score: 0.9361; train_kl_reg_loss: 145.8545; train_edge_recon_loss: 100139.5375; train_gene_expr_recon_loss: 97477.0266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197762.4188; train_optim_loss: 197762.4188; val_kl_reg_loss: 121.7753; val_edge_recon_loss: 104870.6094; val_gene_expr_recon_loss: 107855.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 212847.6406; val_optim_loss: 212847.6406
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7133; val_auprc_score: 0.9175; val_best_acc_score: 0.8834; val_best_f1_score: 0.9370; train_kl_reg_loss: 124.4489; train_edge_recon_loss: 101636.5281; train_gene_expr_recon_loss: 96573.8141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198334.7938; train_optim_loss: 198334.7938; val_kl_reg_loss: 122.0743; val_edge_recon_loss: 103186.4844; val_gene_expr_recon_loss: 107260.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210568.9375; val_optim_loss: 210568.9375
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.6730; val_auprc_score: 0.8922; val_best_acc_score: 0.8769; val_best_f1_score: 0.9327; train_kl_reg_loss: 129.5932; train_edge_recon_loss: 99703.0984; train_gene_expr_recon_loss: 96862.2125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196694.9031; train_optim_loss: 196694.9031; val_kl_reg_loss: 128.3897; val_edge_recon_loss: 111470.6562; val_gene_expr_recon_loss: 106857.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218456.0625; val_optim_loss: 218456.0625
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7324; val_auprc_score: 0.9432; val_best_acc_score: 0.8812; val_best_f1_score: 0.9359; train_kl_reg_loss: 151.0902; train_edge_recon_loss: 101180.4172; train_gene_expr_recon_loss: 96234.2906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197565.8000; train_optim_loss: 197565.8000; val_kl_reg_loss: 158.2952; val_edge_recon_loss: 97667.0156; val_gene_expr_recon_loss: 106562.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204387.3438; val_optim_loss: 204387.3438
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7265; val_auprc_score: 0.9066; val_best_acc_score: 0.8670; val_best_f1_score: 0.9264; train_kl_reg_loss: 198.9907; train_edge_recon_loss: 100035.1922; train_gene_expr_recon_loss: 96204.6297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196438.8094; train_optim_loss: 196438.8094; val_kl_reg_loss: 205.2717; val_edge_recon_loss: 113854.3594; val_gene_expr_recon_loss: 106471.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220531.0938; val_optim_loss: 220531.0938
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.6634; val_auprc_score: 0.8997; val_best_acc_score: 0.8680; val_best_f1_score: 0.9270; train_kl_reg_loss: 282.8985; train_edge_recon_loss: 99146.5797; train_gene_expr_recon_loss: 94637.8141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194067.3000; train_optim_loss: 194067.3000; val_kl_reg_loss: 311.0550; val_edge_recon_loss: 111345.4766; val_gene_expr_recon_loss: 106215.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217871.7656; val_optim_loss: 217871.7656
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7941; val_auprc_score: 0.9255; val_best_acc_score: 0.8940; val_best_f1_score: 0.9409; train_kl_reg_loss: 428.8327; train_edge_recon_loss: 96952.7828; train_gene_expr_recon_loss: 95516.8109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192898.4250; train_optim_loss: 192898.4250; val_kl_reg_loss: 491.3112; val_edge_recon_loss: 90507.4062; val_gene_expr_recon_loss: 105979.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196978.5312; val_optim_loss: 196978.5312
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.6435; val_auprc_score: 0.8888; val_best_acc_score: 0.8789; val_best_f1_score: 0.9330; train_kl_reg_loss: 681.5290; train_edge_recon_loss: 95095.2328; train_gene_expr_recon_loss: 97843.9937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193620.7563; train_optim_loss: 193620.7563; val_kl_reg_loss: 715.5305; val_edge_recon_loss: 102288.3594; val_gene_expr_recon_loss: 105847.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208851.1250; val_optim_loss: 208851.1250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7117; val_auprc_score: 0.9171; val_best_acc_score: 0.8791; val_best_f1_score: 0.9335; train_kl_reg_loss: 885.0241; train_edge_recon_loss: 94341.6297; train_gene_expr_recon_loss: 94571.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189797.8344; train_optim_loss: 189797.8344; val_kl_reg_loss: 938.4957; val_edge_recon_loss: 101912.7891; val_gene_expr_recon_loss: 105403.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208254.9531; val_optim_loss: 208254.9531
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7104; val_auprc_score: 0.9091; val_best_acc_score: 0.8693; val_best_f1_score: 0.9275; train_kl_reg_loss: 1132.1862; train_edge_recon_loss: 97048.4344; train_gene_expr_recon_loss: 94558.2891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192738.9094; train_optim_loss: 192738.9094; val_kl_reg_loss: 1182.1987; val_edge_recon_loss: 105387.9062; val_gene_expr_recon_loss: 105219.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211790.0625; val_optim_loss: 211790.0625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7316; val_auprc_score: 0.9285; val_best_acc_score: 0.8862; val_best_f1_score: 0.9385; train_kl_reg_loss: 1257.8619; train_edge_recon_loss: 94746.5813; train_gene_expr_recon_loss: 93922.0813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189926.5250; train_optim_loss: 189926.5250; val_kl_reg_loss: 1189.2908; val_edge_recon_loss: 82009.2578; val_gene_expr_recon_loss: 105167.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188366.3438; val_optim_loss: 188366.3438
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7931; val_auprc_score: 0.9421; val_best_acc_score: 0.8863; val_best_f1_score: 0.9364; train_kl_reg_loss: 1265.1093; train_edge_recon_loss: 92254.9203; train_gene_expr_recon_loss: 95383.2844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188903.3188; train_optim_loss: 188903.3188; val_kl_reg_loss: 1189.5681; val_edge_recon_loss: 92219.0781; val_gene_expr_recon_loss: 105110.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198518.7500; val_optim_loss: 198518.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.7931; val_auprc_score: 0.9488; val_best_acc_score: 0.8891; val_best_f1_score: 0.9379; train_kl_reg_loss: 1312.1601; train_edge_recon_loss: 90330.2656; train_gene_expr_recon_loss: 94542.9172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186185.3469; train_optim_loss: 186185.3469; val_kl_reg_loss: 1172.3330; val_edge_recon_loss: 92332.2969; val_gene_expr_recon_loss: 105067.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198572.0156; val_optim_loss: 198572.0156
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.7211; val_auprc_score: 0.9004; val_best_acc_score: 0.8539; val_best_f1_score: 0.9173; train_kl_reg_loss: 1264.2765; train_edge_recon_loss: 92065.0734; train_gene_expr_recon_loss: 94651.2359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187980.5844; train_optim_loss: 187980.5844; val_kl_reg_loss: 1150.1328; val_edge_recon_loss: 118113.8047; val_gene_expr_recon_loss: 105043.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224307.5312; val_optim_loss: 224307.5312

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.7721; val_auprc_score: 0.9316; val_best_acc_score: 0.8922; val_best_f1_score: 0.9402; train_kl_reg_loss: 1250.3870; train_edge_recon_loss: 95426.3750; train_gene_expr_recon_loss: 94213.1781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190889.9406; train_optim_loss: 190889.9406; val_kl_reg_loss: 1153.1335; val_edge_recon_loss: 88074.9297; val_gene_expr_recon_loss: 105039.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194267.4844; val_optim_loss: 194267.4844
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.7592; val_auprc_score: 0.9260; val_best_acc_score: 0.8881; val_best_f1_score: 0.9385; train_kl_reg_loss: 1295.2918; train_edge_recon_loss: 90247.0766; train_gene_expr_recon_loss: 94834.5578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186376.9250; train_optim_loss: 186376.9250; val_kl_reg_loss: 1149.0099; val_edge_recon_loss: 86872.4141; val_gene_expr_recon_loss: 105034.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193056.2031; val_optim_loss: 193056.2031
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.7539; val_auprc_score: 0.9196; val_best_acc_score: 0.8852; val_best_f1_score: 0.9359; train_kl_reg_loss: 1250.6111; train_edge_recon_loss: 92974.2937; train_gene_expr_recon_loss: 94040.0750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188264.9813; train_optim_loss: 188264.9813; val_kl_reg_loss: 1158.0499; val_edge_recon_loss: 91222.9766; val_gene_expr_recon_loss: 105031.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197412.4062; val_optim_loss: 197412.4062

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 11 sec.
Using best model state, which was in epoch 15.

--- MODEL EVALUATION ---
Val AUROC score: 0.7362
Val AUPRC score: 0.9368
Val best accuracy score: 0.8827
Val best F1 score: 0.9359
Val gene expr MSE score: 1.7266
Duration of model training in run 8: 0 hours, 0 minutes and 13 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 5804
Number of validation edges: 644
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7845; val_auprc_score: 0.9208; val_best_acc_score: 0.8512; val_best_f1_score: 0.9173; train_kl_reg_loss: 111.1718; train_edge_recon_loss: 96771.8945; train_gene_expr_recon_loss: 130515.0365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227398.1042; train_optim_loss: 227398.1042; val_kl_reg_loss: 271.7899; val_edge_recon_loss: 134820.6562; val_gene_expr_recon_loss: 113812.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248904.9531; val_optim_loss: 248904.9531
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7048; val_auprc_score: 0.8966; val_best_acc_score: 0.8685; val_best_f1_score: 0.9275; train_kl_reg_loss: 411.2166; train_edge_recon_loss: 102532.9831; train_gene_expr_recon_loss: 105139.6615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208083.8594; train_optim_loss: 208083.8594; val_kl_reg_loss: 395.2715; val_edge_recon_loss: 116910.6016; val_gene_expr_recon_loss: 105167.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222473.6250; val_optim_loss: 222473.6250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7090; val_auprc_score: 0.9024; val_best_acc_score: 0.8609; val_best_f1_score: 0.9230; train_kl_reg_loss: 307.3612; train_edge_recon_loss: 104524.6419; train_gene_expr_recon_loss: 99707.0365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204539.0391; train_optim_loss: 204539.0391; val_kl_reg_loss: 171.1613; val_edge_recon_loss: 123478.6719; val_gene_expr_recon_loss: 103076.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 226725.9062; val_optim_loss: 226725.9062
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7500; val_auprc_score: 0.9106; val_best_acc_score: 0.8654; val_best_f1_score: 0.9262; train_kl_reg_loss: 142.7256; train_edge_recon_loss: 103240.0326; train_gene_expr_recon_loss: 98254.4622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201637.2214; train_optim_loss: 201637.2214; val_kl_reg_loss: 107.7162; val_edge_recon_loss: 117664.6875; val_gene_expr_recon_loss: 101937.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 219709.9375; val_optim_loss: 219709.9375
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7030; val_auprc_score: 0.9068; val_best_acc_score: 0.8740; val_best_f1_score: 0.9307; train_kl_reg_loss: 117.3794; train_edge_recon_loss: 100445.1341; train_gene_expr_recon_loss: 98021.6354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198584.1536; train_optim_loss: 198584.1536; val_kl_reg_loss: 112.8417; val_edge_recon_loss: 111884.3438; val_gene_expr_recon_loss: 101195.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213193.1562; val_optim_loss: 213193.1562
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6858; val_auprc_score: 0.8982; val_best_acc_score: 0.8671; val_best_f1_score: 0.9270; train_kl_reg_loss: 129.2132; train_edge_recon_loss: 101861.0573; train_gene_expr_recon_loss: 96515.4596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198505.7292; train_optim_loss: 198505.7292; val_kl_reg_loss: 126.4900; val_edge_recon_loss: 115220.9531; val_gene_expr_recon_loss: 100481.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215828.5000; val_optim_loss: 215828.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7774; val_auprc_score: 0.9344; val_best_acc_score: 0.8781; val_best_f1_score: 0.9332; train_kl_reg_loss: 157.1520; train_edge_recon_loss: 97619.3828; train_gene_expr_recon_loss: 95795.6159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193572.1484; train_optim_loss: 193572.1484; val_kl_reg_loss: 177.1810; val_edge_recon_loss: 106170.1328; val_gene_expr_recon_loss: 99959.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206306.7500; val_optim_loss: 206306.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7177; val_auprc_score: 0.9114; val_best_acc_score: 0.8747; val_best_f1_score: 0.9312; train_kl_reg_loss: 255.0999; train_edge_recon_loss: 100782.3828; train_gene_expr_recon_loss: 95803.5417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196841.0286; train_optim_loss: 196841.0286; val_kl_reg_loss: 325.3114; val_edge_recon_loss: 107632.8047; val_gene_expr_recon_loss: 99693.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207651.9062; val_optim_loss: 207651.9062
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.6959; val_auprc_score: 0.9085; val_best_acc_score: 0.8768; val_best_f1_score: 0.9326; train_kl_reg_loss: 445.4742; train_edge_recon_loss: 93752.3242; train_gene_expr_recon_loss: 95046.3021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189244.1042; train_optim_loss: 189244.1042; val_kl_reg_loss: 500.5905; val_edge_recon_loss: 102798.8594; val_gene_expr_recon_loss: 99319.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202618.6250; val_optim_loss: 202618.6250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7758; val_auprc_score: 0.9493; val_best_acc_score: 0.8881; val_best_f1_score: 0.9394; train_kl_reg_loss: 624.6639; train_edge_recon_loss: 92948.8750; train_gene_expr_recon_loss: 95423.7214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188997.2630; train_optim_loss: 188997.2630; val_kl_reg_loss: 645.8987; val_edge_recon_loss: 85161.5000; val_gene_expr_recon_loss: 98861.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184669.0625; val_optim_loss: 184669.0625
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7135; val_auprc_score: 0.9183; val_best_acc_score: 0.8852; val_best_f1_score: 0.9374; train_kl_reg_loss: 797.5599; train_edge_recon_loss: 98533.7318; train_gene_expr_recon_loss: 94891.8568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194223.1536; train_optim_loss: 194223.1536; val_kl_reg_loss: 792.8890; val_edge_recon_loss: 93550.0938; val_gene_expr_recon_loss: 98664.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193007.5312; val_optim_loss: 193007.5312
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7299; val_auprc_score: 0.9118; val_best_acc_score: 0.8775; val_best_f1_score: 0.9324; train_kl_reg_loss: 951.2319; train_edge_recon_loss: 91253.9714; train_gene_expr_recon_loss: 94134.0885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186339.2943; train_optim_loss: 186339.2943; val_kl_reg_loss: 949.7047; val_edge_recon_loss: 95393.1875; val_gene_expr_recon_loss: 98477.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194820.8594; val_optim_loss: 194820.8594
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.6986; val_auprc_score: 0.9134; val_best_acc_score: 0.8752; val_best_f1_score: 0.9317; train_kl_reg_loss: 1163.9643; train_edge_recon_loss: 95279.5378; train_gene_expr_recon_loss: 93974.3971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190417.8984; train_optim_loss: 190417.8984; val_kl_reg_loss: 1145.3289; val_edge_recon_loss: 99475.7344; val_gene_expr_recon_loss: 98278.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198899.3125; val_optim_loss: 198899.3125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7320; val_auprc_score: 0.9185; val_best_acc_score: 0.8755; val_best_f1_score: 0.9318; train_kl_reg_loss: 1260.8282; train_edge_recon_loss: 93406.2721; train_gene_expr_recon_loss: 93827.1237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188494.2214; train_optim_loss: 188494.2214; val_kl_reg_loss: 1143.2174; val_edge_recon_loss: 96799.4766; val_gene_expr_recon_loss: 98250.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196192.9062; val_optim_loss: 196192.9062
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.6841; val_auprc_score: 0.8711; val_best_acc_score: 0.8524; val_best_f1_score: 0.9170; train_kl_reg_loss: 1269.7297; train_edge_recon_loss: 91876.5391; train_gene_expr_recon_loss: 93494.3268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186640.5990; train_optim_loss: 186640.5990; val_kl_reg_loss: 1145.5271; val_edge_recon_loss: 121652.8203; val_gene_expr_recon_loss: 98222.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221020.5938; val_optim_loss: 221020.5938
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7405; val_auprc_score: 0.9330; val_best_acc_score: 0.8928; val_best_f1_score: 0.9420; train_kl_reg_loss: 1273.3340; train_edge_recon_loss: 98262.1771; train_gene_expr_recon_loss: 93572.2161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193107.7266; train_optim_loss: 193107.7266; val_kl_reg_loss: 1128.3022; val_edge_recon_loss: 81695.1172; val_gene_expr_recon_loss: 98187.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181010.4375; val_optim_loss: 181010.4375
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.7603; val_auprc_score: 0.9330; val_best_acc_score: 0.8790; val_best_f1_score: 0.9334; train_kl_reg_loss: 1253.9858; train_edge_recon_loss: 93008.5690; train_gene_expr_recon_loss: 94171.7708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188434.3255; train_optim_loss: 188434.3255; val_kl_reg_loss: 1120.1755; val_edge_recon_loss: 91717.2500; val_gene_expr_recon_loss: 98157.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190995.1250; val_optim_loss: 190995.1250
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.7555; val_auprc_score: 0.9267; val_best_acc_score: 0.8827; val_best_f1_score: 0.9346; train_kl_reg_loss: 1229.5477; train_edge_recon_loss: 91213.1732; train_gene_expr_recon_loss: 93389.3138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185832.0365; train_optim_loss: 185832.0365; val_kl_reg_loss: 1122.1237; val_edge_recon_loss: 92633.3359; val_gene_expr_recon_loss: 98132.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191888.3438; val_optim_loss: 191888.3438
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.7126; val_auprc_score: 0.9148; val_best_acc_score: 0.8722; val_best_f1_score: 0.9292; train_kl_reg_loss: 1218.2991; train_edge_recon_loss: 89879.1784; train_gene_expr_recon_loss: 93922.2630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185019.7396; train_optim_loss: 185019.7396; val_kl_reg_loss: 1123.7992; val_edge_recon_loss: 101237.7188; val_gene_expr_recon_loss: 98117.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200479.4688; val_optim_loss: 200479.4688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.7523; val_auprc_score: 0.9224; val_best_acc_score: 0.8780; val_best_f1_score: 0.9327; train_kl_reg_loss: 1226.0942; train_edge_recon_loss: 97184.9714; train_gene_expr_recon_loss: 93818.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192229.5964; train_optim_loss: 192229.5964; val_kl_reg_loss: 1116.4888; val_edge_recon_loss: 92997.2734; val_gene_expr_recon_loss: 98115.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192229.0625; val_optim_loss: 192229.0625
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.7732; val_auprc_score: 0.9279; val_best_acc_score: 0.8912; val_best_f1_score: 0.9395; train_kl_reg_loss: 1225.8611; train_edge_recon_loss: 91391.0599; train_gene_expr_recon_loss: 94339.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186955.9193; train_optim_loss: 186955.9193; val_kl_reg_loss: 1127.8346; val_edge_recon_loss: 87629.4219; val_gene_expr_recon_loss: 98113.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186870.3438; val_optim_loss: 186870.3438
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.7029; val_auprc_score: 0.9238; val_best_acc_score: 0.8730; val_best_f1_score: 0.9306; train_kl_reg_loss: 1229.9311; train_edge_recon_loss: 93340.0443; train_gene_expr_recon_loss: 93323.0286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187893.0052; train_optim_loss: 187893.0052; val_kl_reg_loss: 1127.5859; val_edge_recon_loss: 95685.0312; val_gene_expr_recon_loss: 98111.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194923.9688; val_optim_loss: 194923.9688

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 9 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
Val AUROC score: 0.7497
Val AUPRC score: 0.9184
Val best accuracy score: 0.8527
Val best F1 score: 0.9183
Val gene expr MSE score: 1.4036
Duration of model training in run 9: 0 hours, 0 minutes and 10 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 5804
Number of validation edges: 644
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7335; val_auprc_score: 0.9107; val_best_acc_score: 0.8628; val_best_f1_score: 0.9252; train_kl_reg_loss: 118.1347; train_edge_recon_loss: 99150.3867; train_gene_expr_recon_loss: 133586.1328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 232854.6510; train_optim_loss: 232854.6510; val_kl_reg_loss: 311.7404; val_edge_recon_loss: 121715.6406; val_gene_expr_recon_loss: 109246.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 231273.4375; val_optim_loss: 231273.4375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7376; val_auprc_score: 0.9122; val_best_acc_score: 0.8497; val_best_f1_score: 0.9173; train_kl_reg_loss: 415.5804; train_edge_recon_loss: 104218.5990; train_gene_expr_recon_loss: 106264.6784; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210898.8594; train_optim_loss: 210898.8594; val_kl_reg_loss: 428.0766; val_edge_recon_loss: 128009.4688; val_gene_expr_recon_loss: 99113.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227550.7188; val_optim_loss: 227550.7188
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7139; val_auprc_score: 0.9108; val_best_acc_score: 0.8722; val_best_f1_score: 0.9301; train_kl_reg_loss: 347.4300; train_edge_recon_loss: 98572.8281; train_gene_expr_recon_loss: 99517.3958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198437.6510; train_optim_loss: 198437.6510; val_kl_reg_loss: 243.3916; val_edge_recon_loss: 114291.7188; val_gene_expr_recon_loss: 96320.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210855.1719; val_optim_loss: 210855.1719
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6804; val_auprc_score: 0.8892; val_best_acc_score: 0.8544; val_best_f1_score: 0.9198; train_kl_reg_loss: 196.7073; train_edge_recon_loss: 103687.3411; train_gene_expr_recon_loss: 97857.5508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201741.6016; train_optim_loss: 201741.6016; val_kl_reg_loss: 157.9538; val_edge_recon_loss: 128879.0078; val_gene_expr_recon_loss: 95184.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224221.5938; val_optim_loss: 224221.5938
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6917; val_auprc_score: 0.9046; val_best_acc_score: 0.8765; val_best_f1_score: 0.9321; train_kl_reg_loss: 147.8496; train_edge_recon_loss: 100055.8893; train_gene_expr_recon_loss: 96677.0039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196880.7422; train_optim_loss: 196880.7422; val_kl_reg_loss: 153.1630; val_edge_recon_loss: 111911.5312; val_gene_expr_recon_loss: 94422.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206487.3438; val_optim_loss: 206487.3438
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7466; val_auprc_score: 0.9251; val_best_acc_score: 0.8902; val_best_f1_score: 0.9400; train_kl_reg_loss: 145.3971; train_edge_recon_loss: 102698.2982; train_gene_expr_recon_loss: 96318.9896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199162.6875; train_optim_loss: 199162.6875; val_kl_reg_loss: 156.1258; val_edge_recon_loss: 99355.3438; val_gene_expr_recon_loss: 93932.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193443.6406; val_optim_loss: 193443.6406
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7769; val_auprc_score: 0.9424; val_best_acc_score: 0.8911; val_best_f1_score: 0.9407; train_kl_reg_loss: 152.1482; train_edge_recon_loss: 99908.5195; train_gene_expr_recon_loss: 95508.0339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195568.7005; train_optim_loss: 195568.7005; val_kl_reg_loss: 183.2454; val_edge_recon_loss: 95253.0312; val_gene_expr_recon_loss: 93564.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189001.2500; val_optim_loss: 189001.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7295; val_auprc_score: 0.9200; val_best_acc_score: 0.8675; val_best_f1_score: 0.9264; train_kl_reg_loss: 219.7241; train_edge_recon_loss: 96355.9779; train_gene_expr_recon_loss: 95056.9870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191632.6927; train_optim_loss: 191632.6927; val_kl_reg_loss: 327.2567; val_edge_recon_loss: 112797.7734; val_gene_expr_recon_loss: 93140.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206265.4375; val_optim_loss: 206265.4375
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7032; val_auprc_score: 0.9228; val_best_acc_score: 0.8788; val_best_f1_score: 0.9338; train_kl_reg_loss: 398.7868; train_edge_recon_loss: 99461.0273; train_gene_expr_recon_loss: 93956.5195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193816.3307; train_optim_loss: 193816.3307; val_kl_reg_loss: 557.6455; val_edge_recon_loss: 97660.7656; val_gene_expr_recon_loss: 92711.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190929.4531; val_optim_loss: 190929.4531
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7257; val_auprc_score: 0.9228; val_best_acc_score: 0.8831; val_best_f1_score: 0.9350; train_kl_reg_loss: 597.4438; train_edge_recon_loss: 95158.3060; train_gene_expr_recon_loss: 94069.3763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189825.1224; train_optim_loss: 189825.1224; val_kl_reg_loss: 754.6016; val_edge_recon_loss: 95178.7109; val_gene_expr_recon_loss: 92339.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188272.9688; val_optim_loss: 188272.9688
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7112; val_auprc_score: 0.9147; val_best_acc_score: 0.8763; val_best_f1_score: 0.9314; train_kl_reg_loss: 829.8517; train_edge_recon_loss: 92978.4453; train_gene_expr_recon_loss: 93950.3112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187758.6094; train_optim_loss: 187758.6094; val_kl_reg_loss: 1010.4297; val_edge_recon_loss: 102369.4688; val_gene_expr_recon_loss: 91968.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195348.3125; val_optim_loss: 195348.3125
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7414; val_auprc_score: 0.9220; val_best_acc_score: 0.8977; val_best_f1_score: 0.9440; train_kl_reg_loss: 1025.9579; train_edge_recon_loss: 94977.5534; train_gene_expr_recon_loss: 93348.1016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189351.6172; train_optim_loss: 189351.6172; val_kl_reg_loss: 1185.7400; val_edge_recon_loss: 83141.6953; val_gene_expr_recon_loss: 91720.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176047.5000; val_optim_loss: 176047.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7395; val_auprc_score: 0.9196; val_best_acc_score: 0.8747; val_best_f1_score: 0.9304; train_kl_reg_loss: 1190.2751; train_edge_recon_loss: 93320.7487; train_gene_expr_recon_loss: 93983.0013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188494.0182; train_optim_loss: 188494.0182; val_kl_reg_loss: 1337.5989; val_edge_recon_loss: 104536.8672; val_gene_expr_recon_loss: 91468.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197343.1250; val_optim_loss: 197343.1250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7664; val_auprc_score: 0.9373; val_best_acc_score: 0.8883; val_best_f1_score: 0.9387; train_kl_reg_loss: 1256.1897; train_edge_recon_loss: 94975.9102; train_gene_expr_recon_loss: 92751.7448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188983.8464; train_optim_loss: 188983.8464; val_kl_reg_loss: 1228.3435; val_edge_recon_loss: 89191.4141; val_gene_expr_recon_loss: 91335.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181755.4375; val_optim_loss: 181755.4375
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7583; val_auprc_score: 0.9152; val_best_acc_score: 0.8955; val_best_f1_score: 0.9420; train_kl_reg_loss: 1090.8752; train_edge_recon_loss: 94577.8346; train_gene_expr_recon_loss: 93473.4115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189142.1198; train_optim_loss: 189142.1198; val_kl_reg_loss: 1079.3391; val_edge_recon_loss: 90787.5859; val_gene_expr_recon_loss: 91202.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183069.6406; val_optim_loss: 183069.6406

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7544; val_auprc_score: 0.9278; val_best_acc_score: 0.8895; val_best_f1_score: 0.9394; train_kl_reg_loss: 1022.5916; train_edge_recon_loss: 93748.8073; train_gene_expr_recon_loss: 93165.6328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187937.0339; train_optim_loss: 187937.0339; val_kl_reg_loss: 1079.4829; val_edge_recon_loss: 90710.1562; val_gene_expr_recon_loss: 91179.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182968.6875; val_optim_loss: 182968.6875
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.7725; val_auprc_score: 0.9158; val_best_acc_score: 0.8821; val_best_f1_score: 0.9339; train_kl_reg_loss: 1021.1253; train_edge_recon_loss: 90731.1393; train_gene_expr_recon_loss: 93145.0716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184897.3333; train_optim_loss: 184897.3333; val_kl_reg_loss: 1082.5157; val_edge_recon_loss: 99194.0625; val_gene_expr_recon_loss: 91148.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191424.8438; val_optim_loss: 191424.8438
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.7403; val_auprc_score: 0.9257; val_best_acc_score: 0.8805; val_best_f1_score: 0.9343; train_kl_reg_loss: 1034.8496; train_edge_recon_loss: 90149.5911; train_gene_expr_recon_loss: 92973.8867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184158.3281; train_optim_loss: 184158.3281; val_kl_reg_loss: 1079.2919; val_edge_recon_loss: 93325.7891; val_gene_expr_recon_loss: 91111.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185517.0625; val_optim_loss: 185517.0625

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 11 sec.
Using best model state, which was in epoch 12.

--- MODEL EVALUATION ---
Val AUROC score: 0.7564
Val AUPRC score: 0.9403
Val best accuracy score: 0.9203
Val best F1 score: 0.9567
Val gene expr MSE score: 1.2377
Duration of model training in run 10: 0 hours, 0 minutes and 12 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
First script finished. Launching follow up script.
Run timestamp: 02062023_101923.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '8192', '8192', '4096', '4096', '2048', '2048', '1024', '1024', '1024', '1024', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_5pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-attention_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-attention', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 5553
Number of validation edges: 617
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8724; val_auprc_score: 0.9598; val_best_acc_score: 0.8759; val_best_f1_score: 0.9307; train_kl_reg_loss: 57.9207; train_edge_recon_loss: 99104.7656; train_gene_expr_recon_loss: 158768.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 257931.3750; train_optim_loss: 257931.3750; val_kl_reg_loss: 67.2361; val_edge_recon_loss: 114467.3125; val_gene_expr_recon_loss: 144399.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258934.1719; val_optim_loss: 258934.1719
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8728; val_auprc_score: 0.9610; val_best_acc_score: 0.8760; val_best_f1_score: 0.9278; train_kl_reg_loss: 66.9832; train_edge_recon_loss: 97850.3984; train_gene_expr_recon_loss: 138927.7656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 236845.1562; train_optim_loss: 236845.1562; val_kl_reg_loss: 95.7516; val_edge_recon_loss: 131513.0156; val_gene_expr_recon_loss: 134363.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265971.9375; val_optim_loss: 265971.9375
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8802; val_auprc_score: 0.9758; val_best_acc_score: 0.8693; val_best_f1_score: 0.9268; train_kl_reg_loss: 94.7170; train_edge_recon_loss: 104597.0781; train_gene_expr_recon_loss: 129382.7734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 234074.5625; train_optim_loss: 234074.5625; val_kl_reg_loss: 142.6501; val_edge_recon_loss: 119713.3984; val_gene_expr_recon_loss: 126990.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246846.5625; val_optim_loss: 246846.5625
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8626; val_auprc_score: 0.9583; val_best_acc_score: 0.8616; val_best_f1_score: 0.9225; train_kl_reg_loss: 140.6354; train_edge_recon_loss: 100370.5312; train_gene_expr_recon_loss: 122343.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 222854.5000; train_optim_loss: 222854.5000; val_kl_reg_loss: 205.0173; val_edge_recon_loss: 123339.9844; val_gene_expr_recon_loss: 121188.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244733.3438; val_optim_loss: 244733.3438
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8803; val_auprc_score: 0.9735; val_best_acc_score: 0.8855; val_best_f1_score: 0.9370; train_kl_reg_loss: 203.6000; train_edge_recon_loss: 98291.3516; train_gene_expr_recon_loss: 116838.5547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215333.5000; train_optim_loss: 215333.5000; val_kl_reg_loss: 277.9426; val_edge_recon_loss: 110494.3516; val_gene_expr_recon_loss: 116796.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227568.9375; val_optim_loss: 227568.9375
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8886; val_auprc_score: 0.9757; val_best_acc_score: 0.8910; val_best_f1_score: 0.9394; train_kl_reg_loss: 275.7886; train_edge_recon_loss: 103459.8984; train_gene_expr_recon_loss: 112661.6797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216397.3750; train_optim_loss: 216397.3750; val_kl_reg_loss: 329.5801; val_edge_recon_loss: 118622.4609; val_gene_expr_recon_loss: 113617.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 232569.1094; val_optim_loss: 232569.1094
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8756; val_auprc_score: 0.9770; val_best_acc_score: 0.8802; val_best_f1_score: 0.9343; train_kl_reg_loss: 327.5048; train_edge_recon_loss: 100190.0078; train_gene_expr_recon_loss: 109557.0391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210074.5625; train_optim_loss: 210074.5625; val_kl_reg_loss: 350.8358; val_edge_recon_loss: 112467.8984; val_gene_expr_recon_loss: 111222.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224041.2812; val_optim_loss: 224041.2812
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8557; val_auprc_score: 0.9577; val_best_acc_score: 0.8694; val_best_f1_score: 0.9268; train_kl_reg_loss: 346.7464; train_edge_recon_loss: 101783.8047; train_gene_expr_recon_loss: 107254.3906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209384.9375; train_optim_loss: 209384.9375; val_kl_reg_loss: 344.9258; val_edge_recon_loss: 128087.0703; val_gene_expr_recon_loss: 109367.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237799.9062; val_optim_loss: 237799.9062
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8638; val_auprc_score: 0.9686; val_best_acc_score: 0.8818; val_best_f1_score: 0.9343; train_kl_reg_loss: 337.9967; train_edge_recon_loss: 102123.1172; train_gene_expr_recon_loss: 105473.8203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207934.9375; train_optim_loss: 207934.9375; val_kl_reg_loss: 316.4544; val_edge_recon_loss: 112892.5703; val_gene_expr_recon_loss: 107986.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221195.9688; val_optim_loss: 221195.9688
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8728; val_auprc_score: 0.9647; val_best_acc_score: 0.8881; val_best_f1_score: 0.9362; train_kl_reg_loss: 313.9047; train_edge_recon_loss: 102830.5234; train_gene_expr_recon_loss: 104168.8594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207313.2812; train_optim_loss: 207313.2812; val_kl_reg_loss: 280.8634; val_edge_recon_loss: 116816.1719; val_gene_expr_recon_loss: 107011.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224108.1250; val_optim_loss: 224108.1250
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8864; val_auprc_score: 0.9775; val_best_acc_score: 0.8978; val_best_f1_score: 0.9423; train_kl_reg_loss: 279.6222; train_edge_recon_loss: 97408.7109; train_gene_expr_recon_loss: 103249.6953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200938.0312; train_optim_loss: 200938.0312; val_kl_reg_loss: 249.9129; val_edge_recon_loss: 114888.7969; val_gene_expr_recon_loss: 106343.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221482.6250; val_optim_loss: 221482.6250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8710; val_auprc_score: 0.9762; val_best_acc_score: 0.8787; val_best_f1_score: 0.9319; train_kl_reg_loss: 247.7384; train_edge_recon_loss: 96378.2344; train_gene_expr_recon_loss: 102605.9141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199231.8906; train_optim_loss: 199231.8906; val_kl_reg_loss: 221.1258; val_edge_recon_loss: 109979.9766; val_gene_expr_recon_loss: 105884.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216085.4688; val_optim_loss: 216085.4688
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8362; val_auprc_score: 0.9635; val_best_acc_score: 0.8866; val_best_f1_score: 0.9369; train_kl_reg_loss: 219.9742; train_edge_recon_loss: 100192.2734; train_gene_expr_recon_loss: 102180.8984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202593.1562; train_optim_loss: 202593.1562; val_kl_reg_loss: 198.5964; val_edge_recon_loss: 106190.2734; val_gene_expr_recon_loss: 105554.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211943.2031; val_optim_loss: 211943.2031
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8661; val_auprc_score: 0.9594; val_best_acc_score: 0.8760; val_best_f1_score: 0.9281; train_kl_reg_loss: 198.0121; train_edge_recon_loss: 100618.1875; train_gene_expr_recon_loss: 101868.8516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202685.0625; train_optim_loss: 202685.0625; val_kl_reg_loss: 182.1489; val_edge_recon_loss: 128971.6797; val_gene_expr_recon_loss: 105298.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234452.2500; val_optim_loss: 234452.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8877; val_auprc_score: 0.9691; val_best_acc_score: 0.8898; val_best_f1_score: 0.9359; train_kl_reg_loss: 181.0146; train_edge_recon_loss: 99358.5156; train_gene_expr_recon_loss: 101637.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201176.9062; train_optim_loss: 201176.9062; val_kl_reg_loss: 171.0356; val_edge_recon_loss: 121988.5391; val_gene_expr_recon_loss: 105085.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227244.7188; val_optim_loss: 227244.7188
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8566; val_auprc_score: 0.9611; val_best_acc_score: 0.8801; val_best_f1_score: 0.9341; train_kl_reg_loss: 169.2381; train_edge_recon_loss: 100611.6562; train_gene_expr_recon_loss: 101449.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202230.3281; train_optim_loss: 202230.3281; val_kl_reg_loss: 163.8349; val_edge_recon_loss: 106217.2188; val_gene_expr_recon_loss: 104898.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211279.1719; val_optim_loss: 211279.1719
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8568; val_auprc_score: 0.9624; val_best_acc_score: 0.8950; val_best_f1_score: 0.9405; train_kl_reg_loss: 162.9935; train_edge_recon_loss: 95684.5469; train_gene_expr_recon_loss: 101261.2422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197108.7812; train_optim_loss: 197108.7812; val_kl_reg_loss: 161.7739; val_edge_recon_loss: 110570.2266; val_gene_expr_recon_loss: 104729.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215461.2500; val_optim_loss: 215461.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8565; val_auprc_score: 0.9605; val_best_acc_score: 0.8907; val_best_f1_score: 0.9381; train_kl_reg_loss: 159.8762; train_edge_recon_loss: 106270.7578; train_gene_expr_recon_loss: 101099.3047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207529.9375; train_optim_loss: 207529.9375; val_kl_reg_loss: 161.5185; val_edge_recon_loss: 108844.8281; val_gene_expr_recon_loss: 104573.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213580.0938; val_optim_loss: 213580.0938
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8552; val_auprc_score: 0.9688; val_best_acc_score: 0.8887; val_best_f1_score: 0.9370; train_kl_reg_loss: 161.4386; train_edge_recon_loss: 101464.6484; train_gene_expr_recon_loss: 100979.3281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202605.4062; train_optim_loss: 202605.4062; val_kl_reg_loss: 165.2864; val_edge_recon_loss: 104904.0625; val_gene_expr_recon_loss: 104428.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209498.1875; val_optim_loss: 209498.1875
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8171; val_auprc_score: 0.9525; val_best_acc_score: 0.8826; val_best_f1_score: 0.9336; train_kl_reg_loss: 165.0944; train_edge_recon_loss: 102941.6094; train_gene_expr_recon_loss: 100831.3281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203938.0312; train_optim_loss: 203938.0312; val_kl_reg_loss: 173.0000; val_edge_recon_loss: 110012.6562; val_gene_expr_recon_loss: 104292.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214477.8750; val_optim_loss: 214477.8750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8511; val_auprc_score: 0.9646; val_best_acc_score: 0.8890; val_best_f1_score: 0.9362; train_kl_reg_loss: 172.3590; train_edge_recon_loss: 99147.8281; train_gene_expr_recon_loss: 100711.2891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200031.4688; train_optim_loss: 200031.4688; val_kl_reg_loss: 182.3133; val_edge_recon_loss: 113762.7812; val_gene_expr_recon_loss: 104162.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218107.4688; val_optim_loss: 218107.4688
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8644; val_auprc_score: 0.9687; val_best_acc_score: 0.8784; val_best_f1_score: 0.9313; train_kl_reg_loss: 181.8244; train_edge_recon_loss: 99515.7500; train_gene_expr_recon_loss: 100576.7266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200274.3125; train_optim_loss: 200274.3125; val_kl_reg_loss: 195.5482; val_edge_recon_loss: 111563.8047; val_gene_expr_recon_loss: 104036.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215795.3750; val_optim_loss: 215795.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8148; val_auprc_score: 0.9468; val_best_acc_score: 0.8845; val_best_f1_score: 0.9331; train_kl_reg_loss: 194.6761; train_edge_recon_loss: 101212.5078; train_gene_expr_recon_loss: 100435.4922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201842.6875; train_optim_loss: 201842.6875; val_kl_reg_loss: 196.9736; val_edge_recon_loss: 116298.9844; val_gene_expr_recon_loss: 104022.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220518.0000; val_optim_loss: 220518.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.7919; val_auprc_score: 0.9292; val_best_acc_score: 0.8846; val_best_f1_score: 0.9341; train_kl_reg_loss: 194.8949; train_edge_recon_loss: 95842.8281; train_gene_expr_recon_loss: 100422.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196460.3906; train_optim_loss: 196460.3906; val_kl_reg_loss: 198.8517; val_edge_recon_loss: 110200.7500; val_gene_expr_recon_loss: 104005.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214404.8750; val_optim_loss: 214404.8750
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8530; val_auprc_score: 0.9622; val_best_acc_score: 0.8992; val_best_f1_score: 0.9436; train_kl_reg_loss: 196.6614; train_edge_recon_loss: 101586.8594; train_gene_expr_recon_loss: 100396.6953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202180.2188; train_optim_loss: 202180.2188; val_kl_reg_loss: 199.2023; val_edge_recon_loss: 96521.5312; val_gene_expr_recon_loss: 103986.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200706.8125; val_optim_loss: 200706.8125
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8401; val_auprc_score: 0.9681; val_best_acc_score: 0.9003; val_best_f1_score: 0.9445; train_kl_reg_loss: 198.3909; train_edge_recon_loss: 100444.3594; train_gene_expr_recon_loss: 100386.3594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201029.1094; train_optim_loss: 201029.1094; val_kl_reg_loss: 202.2743; val_edge_recon_loss: 94547.8750; val_gene_expr_recon_loss: 103964.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198714.9688; val_optim_loss: 198714.9688
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8157; val_auprc_score: 0.9410; val_best_acc_score: 0.8918; val_best_f1_score: 0.9392; train_kl_reg_loss: 199.6399; train_edge_recon_loss: 98345.8125; train_gene_expr_recon_loss: 100367.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198913.1406; train_optim_loss: 198913.1406; val_kl_reg_loss: 203.3560; val_edge_recon_loss: 102435.9375; val_gene_expr_recon_loss: 103941.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206581.0625; val_optim_loss: 206581.0625
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8091; val_auprc_score: 0.9429; val_best_acc_score: 0.8968; val_best_f1_score: 0.9414; train_kl_reg_loss: 201.6785; train_edge_recon_loss: 99924.0000; train_gene_expr_recon_loss: 100333.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200458.7500; train_optim_loss: 200458.7500; val_kl_reg_loss: 203.8147; val_edge_recon_loss: 104597.3984; val_gene_expr_recon_loss: 103917.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208718.4062; val_optim_loss: 208718.4062
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8052; val_auprc_score: 0.9370; val_best_acc_score: 0.8720; val_best_f1_score: 0.9266; train_kl_reg_loss: 203.5729; train_edge_recon_loss: 99915.8359; train_gene_expr_recon_loss: 100300.9844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200420.3906; train_optim_loss: 200420.3906; val_kl_reg_loss: 207.0216; val_edge_recon_loss: 121009.1328; val_gene_expr_recon_loss: 103891.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 225107.6250; val_optim_loss: 225107.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8228; val_auprc_score: 0.9456; val_best_acc_score: 0.8694; val_best_f1_score: 0.9254; train_kl_reg_loss: 204.8967; train_edge_recon_loss: 105565.2891; train_gene_expr_recon_loss: 100284.4297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206054.6250; train_optim_loss: 206054.6250; val_kl_reg_loss: 206.1993; val_edge_recon_loss: 123285.1875; val_gene_expr_recon_loss: 103888.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227380.1719; val_optim_loss: 227380.1719
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8428; val_auprc_score: 0.9538; val_best_acc_score: 0.8918; val_best_f1_score: 0.9384; train_kl_reg_loss: 204.3428; train_edge_recon_loss: 105295.4766; train_gene_expr_recon_loss: 100273.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205773.4844; train_optim_loss: 205773.4844; val_kl_reg_loss: 205.0925; val_edge_recon_loss: 108806.3516; val_gene_expr_recon_loss: 103885.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 212897.3750; val_optim_loss: 212897.3750
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8442; val_auprc_score: 0.9664; val_best_acc_score: 0.8966; val_best_f1_score: 0.9421; train_kl_reg_loss: 205.1535; train_edge_recon_loss: 97773.2578; train_gene_expr_recon_loss: 100274.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198253.2188; train_optim_loss: 198253.2188; val_kl_reg_loss: 207.4143; val_edge_recon_loss: 96659.0547; val_gene_expr_recon_loss: 103883.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200749.4688; val_optim_loss: 200749.4688

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 12 sec.
Using best model state, which was in epoch 26.

--- MODEL EVALUATION ---
Val AUROC score: 0.8628
Val AUPRC score: 0.9685
Val best accuracy score: 0.9048
Val best F1 score: 0.9465
Val gene expr MSE score: 1.5756
Duration of model training in run 1: 0 hours, 0 minutes and 17 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 5553
Number of validation edges: 617
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9017; val_auprc_score: 0.9759; val_best_acc_score: 0.9027; val_best_f1_score: 0.9445; train_kl_reg_loss: 52.9676; train_edge_recon_loss: 102064.3125; train_gene_expr_recon_loss: 154795.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 256912.3594; train_optim_loss: 256912.3594; val_kl_reg_loss: 57.2660; val_edge_recon_loss: 126650.7344; val_gene_expr_recon_loss: 132855.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259563.4375; val_optim_loss: 259563.4375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8870; val_auprc_score: 0.9741; val_best_acc_score: 0.8860; val_best_f1_score: 0.9363; train_kl_reg_loss: 58.8324; train_edge_recon_loss: 100211.2500; train_gene_expr_recon_loss: 137663.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237933.4375; train_optim_loss: 237933.4375; val_kl_reg_loss: 79.1657; val_edge_recon_loss: 118858.8438; val_gene_expr_recon_loss: 124566.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243504.9531; val_optim_loss: 243504.9531
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8827; val_auprc_score: 0.9719; val_best_acc_score: 0.8946; val_best_f1_score: 0.9406; train_kl_reg_loss: 81.4842; train_edge_recon_loss: 102673.8359; train_gene_expr_recon_loss: 129168.6484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 231923.9688; train_optim_loss: 231923.9688; val_kl_reg_loss: 119.5067; val_edge_recon_loss: 113780.7578; val_gene_expr_recon_loss: 118513.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 232413.7812; val_optim_loss: 232413.7812
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8553; val_auprc_score: 0.9588; val_best_acc_score: 0.8929; val_best_f1_score: 0.9397; train_kl_reg_loss: 122.4117; train_edge_recon_loss: 106197.3359; train_gene_expr_recon_loss: 122798.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229118.3125; train_optim_loss: 229118.3125; val_kl_reg_loss: 171.2900; val_edge_recon_loss: 112818.0547; val_gene_expr_recon_loss: 113766.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 226755.7812; val_optim_loss: 226755.7812
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8742; val_auprc_score: 0.9674; val_best_acc_score: 0.8745; val_best_f1_score: 0.9292; train_kl_reg_loss: 176.1438; train_edge_recon_loss: 102138.6172; train_gene_expr_recon_loss: 117778.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220093.1562; train_optim_loss: 220093.1562; val_kl_reg_loss: 224.5319; val_edge_recon_loss: 133432.1875; val_gene_expr_recon_loss: 110117.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243774.0156; val_optim_loss: 243774.0156
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8777; val_auprc_score: 0.9753; val_best_acc_score: 0.8912; val_best_f1_score: 0.9408; train_kl_reg_loss: 230.0924; train_edge_recon_loss: 101941.6797; train_gene_expr_recon_loss: 113863.5078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216035.2812; train_optim_loss: 216035.2812; val_kl_reg_loss: 254.0644; val_edge_recon_loss: 102801.1172; val_gene_expr_recon_loss: 107384.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210440.1562; val_optim_loss: 210440.1562
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8598; val_auprc_score: 0.9608; val_best_acc_score: 0.8869; val_best_f1_score: 0.9369; train_kl_reg_loss: 263.0538; train_edge_recon_loss: 105207.2266; train_gene_expr_recon_loss: 110952.1016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216422.3750; train_optim_loss: 216422.3750; val_kl_reg_loss: 259.1681; val_edge_recon_loss: 118789.6719; val_gene_expr_recon_loss: 105315.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224364.2500; val_optim_loss: 224364.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8706; val_auprc_score: 0.9737; val_best_acc_score: 0.9020; val_best_f1_score: 0.9461; train_kl_reg_loss: 267.0993; train_edge_recon_loss: 102338.2422; train_gene_expr_recon_loss: 108714.9297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211320.2812; train_optim_loss: 211320.2812; val_kl_reg_loss: 241.5274; val_edge_recon_loss: 98431.6953; val_gene_expr_recon_loss: 103720.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202393.3750; val_optim_loss: 202393.3750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8869; val_auprc_score: 0.9705; val_best_acc_score: 0.8906; val_best_f1_score: 0.9379; train_kl_reg_loss: 249.7151; train_edge_recon_loss: 100242.7031; train_gene_expr_recon_loss: 106989.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207482.3906; train_optim_loss: 207482.3906; val_kl_reg_loss: 218.5774; val_edge_recon_loss: 114822.2266; val_gene_expr_recon_loss: 102510.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217551.2188; val_optim_loss: 217551.2188
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8976; val_auprc_score: 0.9750; val_best_acc_score: 0.9042; val_best_f1_score: 0.9455; train_kl_reg_loss: 225.1129; train_edge_recon_loss: 97328.9219; train_gene_expr_recon_loss: 105706.8516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203260.8750; train_optim_loss: 203260.8750; val_kl_reg_loss: 196.9970; val_edge_recon_loss: 121653.4453; val_gene_expr_recon_loss: 101614.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 223465.0156; val_optim_loss: 223465.0156
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8958; val_auprc_score: 0.9727; val_best_acc_score: 0.8973; val_best_f1_score: 0.9402; train_kl_reg_loss: 203.1626; train_edge_recon_loss: 101674.7422; train_gene_expr_recon_loss: 104719.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206597.8125; train_optim_loss: 206597.8125; val_kl_reg_loss: 178.4160; val_edge_recon_loss: 128516.6172; val_gene_expr_recon_loss: 100960.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229655.9375; val_optim_loss: 229655.9375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8871; val_auprc_score: 0.9639; val_best_acc_score: 0.8858; val_best_f1_score: 0.9313; train_kl_reg_loss: 184.3384; train_edge_recon_loss: 101725.7188; train_gene_expr_recon_loss: 104012.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205922.5156; train_optim_loss: 205922.5156; val_kl_reg_loss: 177.4822; val_edge_recon_loss: 132905.7344; val_gene_expr_recon_loss: 100904.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 233988.1250; val_optim_loss: 233988.1250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8568; val_auprc_score: 0.9619; val_best_acc_score: 0.8887; val_best_f1_score: 0.9377; train_kl_reg_loss: 182.8329; train_edge_recon_loss: 104668.0078; train_gene_expr_recon_loss: 103944.2266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208795.0625; train_optim_loss: 208795.0625; val_kl_reg_loss: 177.5813; val_edge_recon_loss: 119018.3984; val_gene_expr_recon_loss: 100848.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220044.1250; val_optim_loss: 220044.1250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8675; val_auprc_score: 0.9530; val_best_acc_score: 0.8895; val_best_f1_score: 0.9375; train_kl_reg_loss: 180.6293; train_edge_recon_loss: 101088.5391; train_gene_expr_recon_loss: 103894.4297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205163.5938; train_optim_loss: 205163.5938; val_kl_reg_loss: 174.7286; val_edge_recon_loss: 122405.7188; val_gene_expr_recon_loss: 100790.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 223370.9688; val_optim_loss: 223370.9688

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 4 sec.
Using best model state, which was in epoch 8.

--- MODEL EVALUATION ---
Val AUROC score: 0.8821
Val AUPRC score: 0.9751
Val best accuracy score: 0.8978
Val best F1 score: 0.9425
Val gene expr MSE score: 1.6764
Duration of model training in run 2: 0 hours, 0 minutes and 5 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 10975
Number of validation edges: 1219
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9595; val_auprc_score: 0.9908; val_best_acc_score: 0.9332; val_best_f1_score: 0.9603; train_kl_reg_loss: 61.8171; train_edge_recon_loss: 101702.6484; train_gene_expr_recon_loss: 140542.4922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242306.9583; train_optim_loss: 242306.9583; val_kl_reg_loss: 122.4624; val_edge_recon_loss: 120267.4297; val_gene_expr_recon_loss: 123930.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244320.0312; val_optim_loss: 244320.0312
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9460; val_auprc_score: 0.9848; val_best_acc_score: 0.8963; val_best_f1_score: 0.9421; train_kl_reg_loss: 190.6393; train_edge_recon_loss: 102341.6484; train_gene_expr_recon_loss: 116871.2109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219403.5052; train_optim_loss: 219403.5052; val_kl_reg_loss: 333.2417; val_edge_recon_loss: 121926.3672; val_gene_expr_recon_loss: 110687.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 232946.6250; val_optim_loss: 232946.6250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9481; val_auprc_score: 0.9904; val_best_acc_score: 0.9093; val_best_f1_score: 0.9493; train_kl_reg_loss: 370.9762; train_edge_recon_loss: 99310.7604; train_gene_expr_recon_loss: 105879.1901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205560.9271; train_optim_loss: 205560.9271; val_kl_reg_loss: 391.0916; val_edge_recon_loss: 114383.9844; val_gene_expr_recon_loss: 105164.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 219939.0938; val_optim_loss: 219939.0938
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8977; val_auprc_score: 0.9735; val_best_acc_score: 0.9167; val_best_f1_score: 0.9525; train_kl_reg_loss: 369.8097; train_edge_recon_loss: 101344.2161; train_gene_expr_recon_loss: 102885.9036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204599.9323; train_optim_loss: 204599.9323; val_kl_reg_loss: 307.8466; val_edge_recon_loss: 110677.9062; val_gene_expr_recon_loss: 103034.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214020.4688; val_optim_loss: 214020.4688
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9290; val_auprc_score: 0.9803; val_best_acc_score: 0.9169; val_best_f1_score: 0.9523; train_kl_reg_loss: 271.8367; train_edge_recon_loss: 100817.8125; train_gene_expr_recon_loss: 100385.0677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201474.7188; train_optim_loss: 201474.7188; val_kl_reg_loss: 206.4399; val_edge_recon_loss: 115477.2109; val_gene_expr_recon_loss: 102307.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217991.3125; val_optim_loss: 217991.3125
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9130; val_auprc_score: 0.9817; val_best_acc_score: 0.9232; val_best_f1_score: 0.9571; train_kl_reg_loss: 185.3396; train_edge_recon_loss: 101864.0703; train_gene_expr_recon_loss: 100475.1328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202524.5417; train_optim_loss: 202524.5417; val_kl_reg_loss: 149.4941; val_edge_recon_loss: 101483.1562; val_gene_expr_recon_loss: 101864.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 203497.6250; val_optim_loss: 203497.6250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8983; val_auprc_score: 0.9718; val_best_acc_score: 0.9197; val_best_f1_score: 0.9546; train_kl_reg_loss: 144.1548; train_edge_recon_loss: 101817.7448; train_gene_expr_recon_loss: 99583.7943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201545.6927; train_optim_loss: 201545.6927; val_kl_reg_loss: 137.2186; val_edge_recon_loss: 104153.2656; val_gene_expr_recon_loss: 101441.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205732.3906; val_optim_loss: 205732.3906
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8870; val_auprc_score: 0.9665; val_best_acc_score: 0.9193; val_best_f1_score: 0.9536; train_kl_reg_loss: 143.6072; train_edge_recon_loss: 104238.3880; train_gene_expr_recon_loss: 99394.9948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203777.0000; train_optim_loss: 203777.0000; val_kl_reg_loss: 156.3737; val_edge_recon_loss: 107905.6797; val_gene_expr_recon_loss: 101079.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209141.0625; val_optim_loss: 209141.0625
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8908; val_auprc_score: 0.9739; val_best_acc_score: 0.9165; val_best_f1_score: 0.9527; train_kl_reg_loss: 167.5095; train_edge_recon_loss: 101583.6354; train_gene_expr_recon_loss: 99180.8151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200931.9583; train_optim_loss: 200931.9583; val_kl_reg_loss: 193.6090; val_edge_recon_loss: 99802.7812; val_gene_expr_recon_loss: 100741.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200737.9375; val_optim_loss: 200737.9375
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8717; val_auprc_score: 0.9670; val_best_acc_score: 0.8896; val_best_f1_score: 0.9375; train_kl_reg_loss: 215.3123; train_edge_recon_loss: 100075.3516; train_gene_expr_recon_loss: 98414.6458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198705.3073; train_optim_loss: 198705.3073; val_kl_reg_loss: 258.1446; val_edge_recon_loss: 105619.7969; val_gene_expr_recon_loss: 100415.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206293.1562; val_optim_loss: 206293.1562
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8533; val_auprc_score: 0.9691; val_best_acc_score: 0.8997; val_best_f1_score: 0.9447; train_kl_reg_loss: 292.7720; train_edge_recon_loss: 99670.2292; train_gene_expr_recon_loss: 98148.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198111.5000; train_optim_loss: 198111.5000; val_kl_reg_loss: 375.3398; val_edge_recon_loss: 91926.1094; val_gene_expr_recon_loss: 100097.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192399.0156; val_optim_loss: 192399.0156
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8169; val_auprc_score: 0.9468; val_best_acc_score: 0.8862; val_best_f1_score: 0.9365; train_kl_reg_loss: 441.6544; train_edge_recon_loss: 92400.6823; train_gene_expr_recon_loss: 98419.3151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191261.6510; train_optim_loss: 191261.6510; val_kl_reg_loss: 593.5449; val_edge_recon_loss: 99325.2578; val_gene_expr_recon_loss: 99783.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 199701.8125; val_optim_loss: 199701.8125
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8673; val_auprc_score: 0.9753; val_best_acc_score: 0.9092; val_best_f1_score: 0.9504; train_kl_reg_loss: 701.3041; train_edge_recon_loss: 95128.3724; train_gene_expr_recon_loss: 97773.3880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193603.0625; train_optim_loss: 193603.0625; val_kl_reg_loss: 909.1586; val_edge_recon_loss: 80197.7656; val_gene_expr_recon_loss: 99476.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180583.8750; val_optim_loss: 180583.8750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8753; val_auprc_score: 0.9716; val_best_acc_score: 0.9010; val_best_f1_score: 0.9439; train_kl_reg_loss: 1046.5664; train_edge_recon_loss: 95425.9557; train_gene_expr_recon_loss: 97652.9557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194125.4792; train_optim_loss: 194125.4792; val_kl_reg_loss: 1307.4739; val_edge_recon_loss: 88516.6562; val_gene_expr_recon_loss: 99224.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189048.8438; val_optim_loss: 189048.8438
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8896; val_auprc_score: 0.9739; val_best_acc_score: 0.8969; val_best_f1_score: 0.9422; train_kl_reg_loss: 1462.0451; train_edge_recon_loss: 91053.5573; train_gene_expr_recon_loss: 96671.8255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189187.4271; train_optim_loss: 189187.4271; val_kl_reg_loss: 1672.0912; val_edge_recon_loss: 86731.4062; val_gene_expr_recon_loss: 98952.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187355.8906; val_optim_loss: 187355.8906
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8796; val_auprc_score: 0.9651; val_best_acc_score: 0.9039; val_best_f1_score: 0.9438; train_kl_reg_loss: 1794.8530; train_edge_recon_loss: 84289.8594; train_gene_expr_recon_loss: 97026.1198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183110.8385; train_optim_loss: 183110.8385; val_kl_reg_loss: 1956.6230; val_edge_recon_loss: 87835.6406; val_gene_expr_recon_loss: 98871.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188663.5000; val_optim_loss: 188663.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8845; val_auprc_score: 0.9746; val_best_acc_score: 0.9101; val_best_f1_score: 0.9485; train_kl_reg_loss: 1989.6132; train_edge_recon_loss: 82934.3438; train_gene_expr_recon_loss: 96624.4479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181548.4062; train_optim_loss: 181548.4062; val_kl_reg_loss: 1973.5128; val_edge_recon_loss: 79877.6016; val_gene_expr_recon_loss: 98817.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180668.5312; val_optim_loss: 180668.5312
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8812; val_auprc_score: 0.9718; val_best_acc_score: 0.9035; val_best_f1_score: 0.9453; train_kl_reg_loss: 1993.4082; train_edge_recon_loss: 84349.6250; train_gene_expr_recon_loss: 96675.9661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183019.0000; train_optim_loss: 183019.0000; val_kl_reg_loss: 1966.9146; val_edge_recon_loss: 78881.6094; val_gene_expr_recon_loss: 98748.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179596.5625; val_optim_loss: 179596.5625
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8803; val_auprc_score: 0.9712; val_best_acc_score: 0.9010; val_best_f1_score: 0.9438; train_kl_reg_loss: 2000.8359; train_edge_recon_loss: 83788.3359; train_gene_expr_recon_loss: 97673.0469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183462.2188; train_optim_loss: 183462.2188; val_kl_reg_loss: 1970.1466; val_edge_recon_loss: 87048.2812; val_gene_expr_recon_loss: 98698.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187716.8281; val_optim_loss: 187716.8281
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8837; val_auprc_score: 0.9689; val_best_acc_score: 0.9028; val_best_f1_score: 0.9447; train_kl_reg_loss: 2000.9600; train_edge_recon_loss: 82478.5521; train_gene_expr_recon_loss: 96812.7552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181292.2656; train_optim_loss: 181292.2656; val_kl_reg_loss: 1976.9729; val_edge_recon_loss: 88019.1172; val_gene_expr_recon_loss: 98654.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188650.5938; val_optim_loss: 188650.5938
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8670; val_auprc_score: 0.9641; val_best_acc_score: 0.8915; val_best_f1_score: 0.9390; train_kl_reg_loss: 1996.6895; train_edge_recon_loss: 82854.8932; train_gene_expr_recon_loss: 96629.8021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181481.3854; train_optim_loss: 181481.3854; val_kl_reg_loss: 1971.1367; val_edge_recon_loss: 89128.0078; val_gene_expr_recon_loss: 98614.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189713.3125; val_optim_loss: 189713.3125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8791; val_auprc_score: 0.9699; val_best_acc_score: 0.9078; val_best_f1_score: 0.9472; train_kl_reg_loss: 1993.7982; train_edge_recon_loss: 81972.0286; train_gene_expr_recon_loss: 95741.0208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179706.8490; train_optim_loss: 179706.8490; val_kl_reg_loss: 1965.3138; val_edge_recon_loss: 82071.6172; val_gene_expr_recon_loss: 98610.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182647.2812; val_optim_loss: 182647.2812
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8802; val_auprc_score: 0.9684; val_best_acc_score: 0.9060; val_best_f1_score: 0.9466; train_kl_reg_loss: 1991.8528; train_edge_recon_loss: 83053.2969; train_gene_expr_recon_loss: 96415.2396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181460.3906; train_optim_loss: 181460.3906; val_kl_reg_loss: 1966.6155; val_edge_recon_loss: 84470.6953; val_gene_expr_recon_loss: 98606.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185043.9062; val_optim_loss: 185043.9062
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8818; val_auprc_score: 0.9748; val_best_acc_score: 0.9006; val_best_f1_score: 0.9445; train_kl_reg_loss: 1986.9741; train_edge_recon_loss: 83399.8464; train_gene_expr_recon_loss: 96745.8073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182132.6302; train_optim_loss: 182132.6302; val_kl_reg_loss: 1967.3503; val_edge_recon_loss: 80373.8516; val_gene_expr_recon_loss: 98603.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180944.2500; val_optim_loss: 180944.2500

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 12 sec.
Using best model state, which was in epoch 18.

--- MODEL EVALUATION ---
Val AUROC score: 0.8922
Val AUPRC score: 0.9753
Val best accuracy score: 0.8984
Val best F1 score: 0.9409
Val gene expr MSE score: 1.2574
Duration of model training in run 3: 0 hours, 0 minutes and 13 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 10975
Number of validation edges: 1219
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9229; val_auprc_score: 0.9738; val_best_acc_score: 0.9178; val_best_f1_score: 0.9539; train_kl_reg_loss: 67.8270; train_edge_recon_loss: 99561.4635; train_gene_expr_recon_loss: 138907.2604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 238536.5469; train_optim_loss: 238536.5469; val_kl_reg_loss: 128.5394; val_edge_recon_loss: 107945.6562; val_gene_expr_recon_loss: 117542.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 225616.9844; val_optim_loss: 225616.9844
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9213; val_auprc_score: 0.9794; val_best_acc_score: 0.8863; val_best_f1_score: 0.9362; train_kl_reg_loss: 205.9604; train_edge_recon_loss: 103529.4167; train_gene_expr_recon_loss: 115253.9948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 218989.3698; train_optim_loss: 218989.3698; val_kl_reg_loss: 369.8543; val_edge_recon_loss: 124798.8516; val_gene_expr_recon_loss: 106139.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 231307.8125; val_optim_loss: 231307.8125
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9283; val_auprc_score: 0.9852; val_best_acc_score: 0.8990; val_best_f1_score: 0.9437; train_kl_reg_loss: 427.0758; train_edge_recon_loss: 101047.2448; train_gene_expr_recon_loss: 105960.2552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207434.5729; train_optim_loss: 207434.5729; val_kl_reg_loss: 433.3058; val_edge_recon_loss: 111599.3984; val_gene_expr_recon_loss: 101749.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213782.5625; val_optim_loss: 213782.5625
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9265; val_auprc_score: 0.9745; val_best_acc_score: 0.9159; val_best_f1_score: 0.9513; train_kl_reg_loss: 408.9302; train_edge_recon_loss: 99734.2682; train_gene_expr_recon_loss: 102403.6172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202546.8125; train_optim_loss: 202546.8125; val_kl_reg_loss: 303.9930; val_edge_recon_loss: 115522.3516; val_gene_expr_recon_loss: 100057.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215883.7031; val_optim_loss: 215883.7031
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9109; val_auprc_score: 0.9796; val_best_acc_score: 0.9069; val_best_f1_score: 0.9465; train_kl_reg_loss: 270.7656; train_edge_recon_loss: 104475.7786; train_gene_expr_recon_loss: 102089.4688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206836.0156; train_optim_loss: 206836.0156; val_kl_reg_loss: 195.7022; val_edge_recon_loss: 114351.7500; val_gene_expr_recon_loss: 99576.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214123.5469; val_optim_loss: 214123.5469
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9003; val_auprc_score: 0.9711; val_best_acc_score: 0.9003; val_best_f1_score: 0.9435; train_kl_reg_loss: 180.4340; train_edge_recon_loss: 101049.0026; train_gene_expr_recon_loss: 100984.4948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202213.9323; train_optim_loss: 202213.9323; val_kl_reg_loss: 149.0790; val_edge_recon_loss: 115600.1016; val_gene_expr_recon_loss: 99297.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215046.6875; val_optim_loss: 215046.6875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9136; val_auprc_score: 0.9843; val_best_acc_score: 0.9060; val_best_f1_score: 0.9475; train_kl_reg_loss: 150.5947; train_edge_recon_loss: 99351.3620; train_gene_expr_recon_loss: 100100.7292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199602.6875; train_optim_loss: 199602.6875; val_kl_reg_loss: 147.6251; val_edge_recon_loss: 100711.7812; val_gene_expr_recon_loss: 99249.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200108.8438; val_optim_loss: 200108.8438
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8916; val_auprc_score: 0.9656; val_best_acc_score: 0.8980; val_best_f1_score: 0.9423; train_kl_reg_loss: 150.0042; train_edge_recon_loss: 100484.9870; train_gene_expr_recon_loss: 100553.2995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201188.2917; train_optim_loss: 201188.2917; val_kl_reg_loss: 147.2713; val_edge_recon_loss: 117608.1406; val_gene_expr_recon_loss: 99172.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216928.0938; val_optim_loss: 216928.0938
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9012; val_auprc_score: 0.9634; val_best_acc_score: 0.9030; val_best_f1_score: 0.9447; train_kl_reg_loss: 150.1804; train_edge_recon_loss: 103086.5469; train_gene_expr_recon_loss: 100568.5026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203805.2292; train_optim_loss: 203805.2292; val_kl_reg_loss: 147.5821; val_edge_recon_loss: 113251.5391; val_gene_expr_recon_loss: 99077.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 212476.9688; val_optim_loss: 212476.9688
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9029; val_auprc_score: 0.9783; val_best_acc_score: 0.9082; val_best_f1_score: 0.9478; train_kl_reg_loss: 149.1863; train_edge_recon_loss: 102605.7422; train_gene_expr_recon_loss: 100301.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203056.0938; train_optim_loss: 203056.0938; val_kl_reg_loss: 148.8922; val_edge_recon_loss: 100998.0938; val_gene_expr_recon_loss: 98975.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200122.3438; val_optim_loss: 200122.3438

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8798; val_auprc_score: 0.9619; val_best_acc_score: 0.9014; val_best_f1_score: 0.9428; train_kl_reg_loss: 148.9763; train_edge_recon_loss: 102431.4115; train_gene_expr_recon_loss: 100037.3906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202617.7760; train_optim_loss: 202617.7760; val_kl_reg_loss: 148.3487; val_edge_recon_loss: 117113.5156; val_gene_expr_recon_loss: 98964.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216226.5000; val_optim_loss: 216226.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8746; val_auprc_score: 0.9627; val_best_acc_score: 0.9013; val_best_f1_score: 0.9432; train_kl_reg_loss: 150.1173; train_edge_recon_loss: 99606.6432; train_gene_expr_recon_loss: 100126.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199882.9635; train_optim_loss: 199882.9635; val_kl_reg_loss: 147.5557; val_edge_recon_loss: 111756.6875; val_gene_expr_recon_loss: 98953.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210857.4688; val_optim_loss: 210857.4688
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8952; val_auprc_score: 0.9734; val_best_acc_score: 0.8981; val_best_f1_score: 0.9413; train_kl_reg_loss: 149.4947; train_edge_recon_loss: 103085.8490; train_gene_expr_recon_loss: 100424.5339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203659.8854; train_optim_loss: 203659.8854; val_kl_reg_loss: 148.1436; val_edge_recon_loss: 113983.0234; val_gene_expr_recon_loss: 98941.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213072.4062; val_optim_loss: 213072.4062

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 6 sec.
Using best model state, which was in epoch 7.

--- MODEL EVALUATION ---
Val AUROC score: 0.9032
Val AUPRC score: 0.9743
Val best accuracy score: 0.9003
Val best F1 score: 0.9427
Val gene expr MSE score: 1.4258
Duration of model training in run 4: 0 hours, 0 minutes and 7 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 16450
Number of validation edges: 1827
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9128; val_auprc_score: 0.9667; val_best_acc_score: 0.8863; val_best_f1_score: 0.9366; train_kl_reg_loss: 223.5115; train_edge_recon_loss: 100945.3637; train_gene_expr_recon_loss: 120748.5052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 221917.3802; train_optim_loss: 221917.3802; val_kl_reg_loss: 420.4796; val_edge_recon_loss: 124817.1484; val_gene_expr_recon_loss: 102009.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227247.5156; val_optim_loss: 227247.5156
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9311; val_auprc_score: 0.9836; val_best_acc_score: 0.9157; val_best_f1_score: 0.9519; train_kl_reg_loss: 313.5102; train_edge_recon_loss: 98344.7609; train_gene_expr_recon_loss: 101035.0425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199693.3142; train_optim_loss: 199693.3142; val_kl_reg_loss: 180.8794; val_edge_recon_loss: 112205.5703; val_gene_expr_recon_loss: 98452.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210838.8125; val_optim_loss: 210838.8125
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9051; val_auprc_score: 0.9787; val_best_acc_score: 0.9075; val_best_f1_score: 0.9479; train_kl_reg_loss: 176.3207; train_edge_recon_loss: 104101.8594; train_gene_expr_recon_loss: 98788.0286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203066.2118; train_optim_loss: 203066.2118; val_kl_reg_loss: 171.0082; val_edge_recon_loss: 108432.3516; val_gene_expr_recon_loss: 97444.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206047.3906; val_optim_loss: 206047.3906
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8826; val_auprc_score: 0.9688; val_best_acc_score: 0.9002; val_best_f1_score: 0.9440; train_kl_reg_loss: 169.2846; train_edge_recon_loss: 105246.3811; train_gene_expr_recon_loss: 98275.9826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203691.6493; train_optim_loss: 203691.6493; val_kl_reg_loss: 168.9454; val_edge_recon_loss: 104215.3203; val_gene_expr_recon_loss: 96855.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201239.7031; val_optim_loss: 201239.7031
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8712; val_auprc_score: 0.9700; val_best_acc_score: 0.8984; val_best_f1_score: 0.9431; train_kl_reg_loss: 212.8158; train_edge_recon_loss: 98317.3299; train_gene_expr_recon_loss: 97514.9323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196045.0781; train_optim_loss: 196045.0781; val_kl_reg_loss: 284.4724; val_edge_recon_loss: 94985.1094; val_gene_expr_recon_loss: 96249.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191519.2500; val_optim_loss: 191519.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8343; val_auprc_score: 0.9566; val_best_acc_score: 0.8851; val_best_f1_score: 0.9368; train_kl_reg_loss: 419.8500; train_edge_recon_loss: 96050.5286; train_gene_expr_recon_loss: 96726.5330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193196.9149; train_optim_loss: 193196.9149; val_kl_reg_loss: 601.8287; val_edge_recon_loss: 91526.6406; val_gene_expr_recon_loss: 95579.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187707.6562; val_optim_loss: 187707.6562
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8677; val_auprc_score: 0.9681; val_best_acc_score: 0.8950; val_best_f1_score: 0.9411; train_kl_reg_loss: 943.2395; train_edge_recon_loss: 91599.8863; train_gene_expr_recon_loss: 95950.7031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188493.8247; train_optim_loss: 188493.8247; val_kl_reg_loss: 1292.2482; val_edge_recon_loss: 89014.3750; val_gene_expr_recon_loss: 95154.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185461.4688; val_optim_loss: 185461.4688
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8720; val_auprc_score: 0.9643; val_best_acc_score: 0.9087; val_best_f1_score: 0.9488; train_kl_reg_loss: 1536.3174; train_edge_recon_loss: 86768.4905; train_gene_expr_recon_loss: 95814.0903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184118.8976; train_optim_loss: 184118.8976; val_kl_reg_loss: 1652.6057; val_edge_recon_loss: 81275.2812; val_gene_expr_recon_loss: 94918.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177846.7188; val_optim_loss: 177846.7188
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8849; val_auprc_score: 0.9724; val_best_acc_score: 0.9096; val_best_f1_score: 0.9489; train_kl_reg_loss: 1886.0304; train_edge_recon_loss: 84156.8472; train_gene_expr_recon_loss: 95389.3663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181432.2431; train_optim_loss: 181432.2431; val_kl_reg_loss: 1955.4052; val_edge_recon_loss: 81726.1016; val_gene_expr_recon_loss: 94349.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178030.5938; val_optim_loss: 178030.5938
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9060; val_auprc_score: 0.9731; val_best_acc_score: 0.9269; val_best_f1_score: 0.9587; train_kl_reg_loss: 2071.3671; train_edge_recon_loss: 81646.0842; train_gene_expr_recon_loss: 94579.1736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178296.6250; train_optim_loss: 178296.6250; val_kl_reg_loss: 1997.6387; val_edge_recon_loss: 79360.2812; val_gene_expr_recon_loss: 93926.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175284.3594; val_optim_loss: 175284.3594
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9040; val_auprc_score: 0.9700; val_best_acc_score: 0.9300; val_best_f1_score: 0.9599; train_kl_reg_loss: 2078.9416; train_edge_recon_loss: 79160.2413; train_gene_expr_recon_loss: 94636.4019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175875.5833; train_optim_loss: 175875.5833; val_kl_reg_loss: 2012.7064; val_edge_recon_loss: 78005.7969; val_gene_expr_recon_loss: 93757.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173776.2812; val_optim_loss: 173776.2812
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9054; val_auprc_score: 0.9741; val_best_acc_score: 0.9364; val_best_f1_score: 0.9640; train_kl_reg_loss: 2026.2598; train_edge_recon_loss: 79729.2708; train_gene_expr_recon_loss: 93997.8602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175753.3941; train_optim_loss: 175753.3941; val_kl_reg_loss: 1918.2925; val_edge_recon_loss: 72468.0312; val_gene_expr_recon_loss: 93498.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167885.2031; val_optim_loss: 167885.2031
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9181; val_auprc_score: 0.9766; val_best_acc_score: 0.9307; val_best_f1_score: 0.9606; train_kl_reg_loss: 1924.7111; train_edge_recon_loss: 77064.0378; train_gene_expr_recon_loss: 93985.0295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172973.7778; train_optim_loss: 172973.7778; val_kl_reg_loss: 1854.1067; val_edge_recon_loss: 79610.6484; val_gene_expr_recon_loss: 93238.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174703.0938; val_optim_loss: 174703.0938
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9078; val_auprc_score: 0.9700; val_best_acc_score: 0.9243; val_best_f1_score: 0.9563; train_kl_reg_loss: 1909.6808; train_edge_recon_loss: 81759.6363; train_gene_expr_recon_loss: 93914.0694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177583.3872; train_optim_loss: 177583.3872; val_kl_reg_loss: 1871.1257; val_edge_recon_loss: 87537.1719; val_gene_expr_recon_loss: 93099.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182507.8906; val_optim_loss: 182507.8906
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9222; val_auprc_score: 0.9819; val_best_acc_score: 0.9286; val_best_f1_score: 0.9588; train_kl_reg_loss: 1971.8709; train_edge_recon_loss: 76615.9089; train_gene_expr_recon_loss: 93466.0564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172053.8368; train_optim_loss: 172053.8368; val_kl_reg_loss: 1954.3374; val_edge_recon_loss: 82280.9766; val_gene_expr_recon_loss: 93055.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177290.8750; val_optim_loss: 177290.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9144; val_auprc_score: 0.9706; val_best_acc_score: 0.9336; val_best_f1_score: 0.9618; train_kl_reg_loss: 1976.2518; train_edge_recon_loss: 80451.9106; train_gene_expr_recon_loss: 93541.8385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175970.0035; train_optim_loss: 175970.0035; val_kl_reg_loss: 1876.6079; val_edge_recon_loss: 82626.8047; val_gene_expr_recon_loss: 92851.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177354.9062; val_optim_loss: 177354.9062
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9329; val_auprc_score: 0.9818; val_best_acc_score: 0.9363; val_best_f1_score: 0.9634; train_kl_reg_loss: 1920.2175; train_edge_recon_loss: 80107.0278; train_gene_expr_recon_loss: 93298.7049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175325.9497; train_optim_loss: 175325.9497; val_kl_reg_loss: 1858.1522; val_edge_recon_loss: 80434.5703; val_gene_expr_recon_loss: 92839.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175131.9531; val_optim_loss: 175131.9531
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9088; val_auprc_score: 0.9742; val_best_acc_score: 0.9353; val_best_f1_score: 0.9625; train_kl_reg_loss: 1915.1289; train_edge_recon_loss: 79277.0573; train_gene_expr_recon_loss: 93345.0807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174537.2674; train_optim_loss: 174537.2674; val_kl_reg_loss: 1859.2488; val_edge_recon_loss: 84579.7969; val_gene_expr_recon_loss: 92790.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179229.9688; val_optim_loss: 179229.9688

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 13 sec.
Using best model state, which was in epoch 12.

--- MODEL EVALUATION ---
Val AUROC score: 0.9233
Val AUPRC score: 0.9816
Val best accuracy score: 0.9298
Val best F1 score: 0.9594
Val gene expr MSE score: 1.0919
Duration of model training in run 5: 0 hours, 0 minutes and 15 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 16450
Number of validation edges: 1827
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9477; val_auprc_score: 0.9843; val_best_acc_score: 0.8982; val_best_f1_score: 0.9433; train_kl_reg_loss: 218.9153; train_edge_recon_loss: 101665.8273; train_gene_expr_recon_loss: 118500.9731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220385.7205; train_optim_loss: 220385.7205; val_kl_reg_loss: 416.9535; val_edge_recon_loss: 121222.1953; val_gene_expr_recon_loss: 103200.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224839.1875; val_optim_loss: 224839.1875
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9293; val_auprc_score: 0.9806; val_best_acc_score: 0.9190; val_best_f1_score: 0.9534; train_kl_reg_loss: 298.7364; train_edge_recon_loss: 101781.9939; train_gene_expr_recon_loss: 99835.5660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201916.2934; train_optim_loss: 201916.2934; val_kl_reg_loss: 170.2379; val_edge_recon_loss: 115569.7734; val_gene_expr_recon_loss: 99732.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215472.4844; val_optim_loss: 215472.4844
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9239; val_auprc_score: 0.9830; val_best_acc_score: 0.9106; val_best_f1_score: 0.9487; train_kl_reg_loss: 158.3290; train_edge_recon_loss: 101899.4705; train_gene_expr_recon_loss: 98242.2595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200300.0608; train_optim_loss: 200300.0608; val_kl_reg_loss: 167.2621; val_edge_recon_loss: 109462.2188; val_gene_expr_recon_loss: 98888.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208518.4688; val_optim_loss: 208518.4688
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8712; val_auprc_score: 0.9706; val_best_acc_score: 0.9038; val_best_f1_score: 0.9452; train_kl_reg_loss: 183.5802; train_edge_recon_loss: 93937.4444; train_gene_expr_recon_loss: 97281.4887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191402.5139; train_optim_loss: 191402.5139; val_kl_reg_loss: 217.5471; val_edge_recon_loss: 101407.9062; val_gene_expr_recon_loss: 98212.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 199837.4688; val_optim_loss: 199837.4688
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8302; val_auprc_score: 0.9638; val_best_acc_score: 0.8914; val_best_f1_score: 0.9399; train_kl_reg_loss: 273.9971; train_edge_recon_loss: 97983.6753; train_gene_expr_recon_loss: 96626.2674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194883.9392; train_optim_loss: 194883.9392; val_kl_reg_loss: 392.7039; val_edge_recon_loss: 92893.1016; val_gene_expr_recon_loss: 97536.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190822.7500; val_optim_loss: 190822.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8263; val_auprc_score: 0.9510; val_best_acc_score: 0.8793; val_best_f1_score: 0.9327; train_kl_reg_loss: 503.0475; train_edge_recon_loss: 96713.9931; train_gene_expr_recon_loss: 96036.5304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193253.5712; train_optim_loss: 193253.5712; val_kl_reg_loss: 675.4767; val_edge_recon_loss: 98351.8594; val_gene_expr_recon_loss: 96962.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195989.7188; val_optim_loss: 195989.7188
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8656; val_auprc_score: 0.9651; val_best_acc_score: 0.8989; val_best_f1_score: 0.9425; train_kl_reg_loss: 810.8089; train_edge_recon_loss: 94052.7153; train_gene_expr_recon_loss: 95155.7179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190019.2431; train_optim_loss: 190019.2431; val_kl_reg_loss: 1032.6659; val_edge_recon_loss: 82103.8281; val_gene_expr_recon_loss: 96475.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179611.6875; val_optim_loss: 179611.6875
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8914; val_auprc_score: 0.9764; val_best_acc_score: 0.9031; val_best_f1_score: 0.9452; train_kl_reg_loss: 1309.7332; train_edge_recon_loss: 85092.6606; train_gene_expr_recon_loss: 94819.3446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181221.7378; train_optim_loss: 181221.7378; val_kl_reg_loss: 1758.1505; val_edge_recon_loss: 85292.7422; val_gene_expr_recon_loss: 96138.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183189.1250; val_optim_loss: 183189.1250
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8737; val_auprc_score: 0.9721; val_best_acc_score: 0.9075; val_best_f1_score: 0.9482; train_kl_reg_loss: 1950.2030; train_edge_recon_loss: 83864.5286; train_gene_expr_recon_loss: 94349.8620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180164.5955; train_optim_loss: 180164.5955; val_kl_reg_loss: 2072.4036; val_edge_recon_loss: 77904.2969; val_gene_expr_recon_loss: 95699.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175675.8438; val_optim_loss: 175675.8438
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8727; val_auprc_score: 0.9638; val_best_acc_score: 0.9131; val_best_f1_score: 0.9514; train_kl_reg_loss: 2025.7390; train_edge_recon_loss: 85352.9175; train_gene_expr_recon_loss: 93942.3872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181321.0417; train_optim_loss: 181321.0417; val_kl_reg_loss: 1947.2725; val_edge_recon_loss: 81637.4844; val_gene_expr_recon_loss: 95290.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178875.4062; val_optim_loss: 178875.4062
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9035; val_auprc_score: 0.9768; val_best_acc_score: 0.9194; val_best_f1_score: 0.9544; train_kl_reg_loss: 1872.2431; train_edge_recon_loss: 82557.4792; train_gene_expr_recon_loss: 93705.1780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178134.8958; train_optim_loss: 178134.8958; val_kl_reg_loss: 1818.0618; val_edge_recon_loss: 79209.9062; val_gene_expr_recon_loss: 94967.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175995.6562; val_optim_loss: 175995.6562
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8922; val_auprc_score: 0.9678; val_best_acc_score: 0.9126; val_best_f1_score: 0.9505; train_kl_reg_loss: 1793.9951; train_edge_recon_loss: 85825.4748; train_gene_expr_recon_loss: 93669.0365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181288.5052; train_optim_loss: 181288.5052; val_kl_reg_loss: 1797.6611; val_edge_recon_loss: 81810.5234; val_gene_expr_recon_loss: 94636.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178245.0000; val_optim_loss: 178245.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9026; val_auprc_score: 0.9735; val_best_acc_score: 0.9168; val_best_f1_score: 0.9523; train_kl_reg_loss: 1783.1877; train_edge_recon_loss: 77440.3151; train_gene_expr_recon_loss: 93044.8429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172268.3455; train_optim_loss: 172268.3455; val_kl_reg_loss: 1784.0322; val_edge_recon_loss: 80692.7812; val_gene_expr_recon_loss: 94565.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177042.4688; val_optim_loss: 177042.4688
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9084; val_auprc_score: 0.9785; val_best_acc_score: 0.9239; val_best_f1_score: 0.9564; train_kl_reg_loss: 1787.6951; train_edge_recon_loss: 81167.4080; train_gene_expr_recon_loss: 93462.7552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176417.8576; train_optim_loss: 176417.8576; val_kl_reg_loss: 1795.8242; val_edge_recon_loss: 80038.7656; val_gene_expr_recon_loss: 94526.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176361.2812; val_optim_loss: 176361.2812
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8810; val_auprc_score: 0.9571; val_best_acc_score: 0.9181; val_best_f1_score: 0.9532; train_kl_reg_loss: 1789.0527; train_edge_recon_loss: 85619.3490; train_gene_expr_recon_loss: 92925.4505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180333.8542; train_optim_loss: 180333.8542; val_kl_reg_loss: 1813.9736; val_edge_recon_loss: 84869.4766; val_gene_expr_recon_loss: 94499.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181183.2812; val_optim_loss: 181183.2812

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 10 sec.
Using best model state, which was in epoch 9.

--- MODEL EVALUATION ---
Val AUROC score: 0.8765
Val AUPRC score: 0.9624
Val best accuracy score: 0.8961
Val best F1 score: 0.9411
Val gene expr MSE score: 1.2444
Duration of model training in run 6: 0 hours, 0 minutes and 12 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 21883
Number of validation edges: 2431
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8925; val_auprc_score: 0.9709; val_best_acc_score: 0.9113; val_best_f1_score: 0.9497; train_kl_reg_loss: 194.6887; train_edge_recon_loss: 99194.0568; train_gene_expr_recon_loss: 108021.1385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207409.8849; train_optim_loss: 207409.8849; val_kl_reg_loss: 129.9305; val_edge_recon_loss: 106810.1562; val_gene_expr_recon_loss: 100833.5365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207773.6250; val_optim_loss: 207773.6250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8398; val_auprc_score: 0.9563; val_best_acc_score: 0.8845; val_best_f1_score: 0.9358; train_kl_reg_loss: 258.3207; train_edge_recon_loss: 99079.1200; train_gene_expr_recon_loss: 97241.2809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196578.7202; train_optim_loss: 196578.7202; val_kl_reg_loss: 516.8378; val_edge_recon_loss: 97153.1068; val_gene_expr_recon_loss: 99361.2057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197031.1510; val_optim_loss: 197031.1510
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8848; val_auprc_score: 0.9696; val_best_acc_score: 0.9100; val_best_f1_score: 0.9497; train_kl_reg_loss: 984.8410; train_edge_recon_loss: 92080.3718; train_gene_expr_recon_loss: 95360.4119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188425.6229; train_optim_loss: 188425.6229; val_kl_reg_loss: 1873.2085; val_edge_recon_loss: 81782.9583; val_gene_expr_recon_loss: 97611.0130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181267.1771; val_optim_loss: 181267.1771
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9073; val_auprc_score: 0.9717; val_best_acc_score: 0.9296; val_best_f1_score: 0.9601; train_kl_reg_loss: 2103.0438; train_edge_recon_loss: 85292.6609; train_gene_expr_recon_loss: 94313.3935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181709.0980; train_optim_loss: 181709.0980; val_kl_reg_loss: 1811.0340; val_edge_recon_loss: 81394.5755; val_gene_expr_recon_loss: 95960.1615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179165.7708; val_optim_loss: 179165.7708
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9106; val_auprc_score: 0.9748; val_best_acc_score: 0.9371; val_best_f1_score: 0.9640; train_kl_reg_loss: 1809.4323; train_edge_recon_loss: 80952.3775; train_gene_expr_recon_loss: 93708.5444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176470.3537; train_optim_loss: 176470.3537; val_kl_reg_loss: 1882.6044; val_edge_recon_loss: 76422.0911; val_gene_expr_recon_loss: 96056.4245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174361.1198; val_optim_loss: 174361.1198
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9212; val_auprc_score: 0.9761; val_best_acc_score: 0.9405; val_best_f1_score: 0.9659; train_kl_reg_loss: 1873.7502; train_edge_recon_loss: 81158.8324; train_gene_expr_recon_loss: 92804.1154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175836.6989; train_optim_loss: 175836.6989; val_kl_reg_loss: 1837.6371; val_edge_recon_loss: 75774.7552; val_gene_expr_recon_loss: 97132.8698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174745.2656; val_optim_loss: 174745.2656
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9476; val_auprc_score: 0.9869; val_best_acc_score: 0.9515; val_best_f1_score: 0.9721; train_kl_reg_loss: 1818.5150; train_edge_recon_loss: 81471.1538; train_gene_expr_recon_loss: 92282.8171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175572.4844; train_optim_loss: 175572.4844; val_kl_reg_loss: 1871.7611; val_edge_recon_loss: 75138.7604; val_gene_expr_recon_loss: 96084.0651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173094.5833; val_optim_loss: 173094.5833
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9400; val_auprc_score: 0.9832; val_best_acc_score: 0.9479; val_best_f1_score: 0.9697; train_kl_reg_loss: 1876.5758; train_edge_recon_loss: 80356.4134; train_gene_expr_recon_loss: 92079.5703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174312.5604; train_optim_loss: 174312.5604; val_kl_reg_loss: 1856.7329; val_edge_recon_loss: 83678.8255; val_gene_expr_recon_loss: 96501.1302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182036.6823; val_optim_loss: 182036.6823
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9444; val_auprc_score: 0.9824; val_best_acc_score: 0.9531; val_best_f1_score: 0.9728; train_kl_reg_loss: 1840.2509; train_edge_recon_loss: 79646.6289; train_gene_expr_recon_loss: 91816.2539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173303.1349; train_optim_loss: 173303.1349; val_kl_reg_loss: 1862.1757; val_edge_recon_loss: 79931.3672; val_gene_expr_recon_loss: 92758.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174552.3750; val_optim_loss: 174552.3750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9472; val_auprc_score: 0.9861; val_best_acc_score: 0.9580; val_best_f1_score: 0.9759; train_kl_reg_loss: 1827.5028; train_edge_recon_loss: 78358.8363; train_gene_expr_recon_loss: 91357.3917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171543.7301; train_optim_loss: 171543.7301; val_kl_reg_loss: 1855.0311; val_edge_recon_loss: 76746.9701; val_gene_expr_recon_loss: 95248.2396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173850.2396; val_optim_loss: 173850.2396

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9326; val_auprc_score: 0.9825; val_best_acc_score: 0.9483; val_best_f1_score: 0.9704; train_kl_reg_loss: 1837.4100; train_edge_recon_loss: 79191.1357; train_gene_expr_recon_loss: 91168.1076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172196.6541; train_optim_loss: 172196.6541; val_kl_reg_loss: 1859.8315; val_edge_recon_loss: 77870.8854; val_gene_expr_recon_loss: 94792.8620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174523.5781; val_optim_loss: 174523.5781
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9413; val_auprc_score: 0.9800; val_best_acc_score: 0.9477; val_best_f1_score: 0.9697; train_kl_reg_loss: 1847.6236; train_edge_recon_loss: 78633.1539; train_gene_expr_recon_loss: 90775.7244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171256.5000; train_optim_loss: 171256.5000; val_kl_reg_loss: 1847.0691; val_edge_recon_loss: 77746.5547; val_gene_expr_recon_loss: 93753.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173347.2031; val_optim_loss: 173347.2031
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9230; val_auprc_score: 0.9688; val_best_acc_score: 0.9473; val_best_f1_score: 0.9693; train_kl_reg_loss: 1838.7076; train_edge_recon_loss: 77978.0245; train_gene_expr_recon_loss: 90743.8974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170560.6293; train_optim_loss: 170560.6293; val_kl_reg_loss: 1842.8669; val_edge_recon_loss: 85252.9167; val_gene_expr_recon_loss: 92609.7214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179705.5052; val_optim_loss: 179705.5052

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 32 sec.
Using best model state, which was in epoch 7.

--- MODEL EVALUATION ---
Val AUROC score: 0.9339
Val AUPRC score: 0.9829
Val best accuracy score: 0.9470
Val best F1 score: 0.9698
Val gene expr MSE score: 1.2193
Duration of model training in run 7: 0 hours, 0 minutes and 35 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 21883
Number of validation edges: 2431
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8972; val_auprc_score: 0.9712; val_best_acc_score: 0.9071; val_best_f1_score: 0.9467; train_kl_reg_loss: 191.9602; train_edge_recon_loss: 101971.4453; train_gene_expr_recon_loss: 108667.8732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210831.2798; train_optim_loss: 210831.2798; val_kl_reg_loss: 97.8777; val_edge_recon_loss: 113761.7656; val_gene_expr_recon_loss: 93338.2135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207197.8594; val_optim_loss: 207197.8594
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8340; val_auprc_score: 0.9584; val_best_acc_score: 0.8867; val_best_f1_score: 0.9372; train_kl_reg_loss: 214.3445; train_edge_recon_loss: 98462.8370; train_gene_expr_recon_loss: 97823.3232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196500.5050; train_optim_loss: 196500.5050; val_kl_reg_loss: 443.6135; val_edge_recon_loss: 94272.2604; val_gene_expr_recon_loss: 92846.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187562.5833; val_optim_loss: 187562.5833
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8735; val_auprc_score: 0.9702; val_best_acc_score: 0.8939; val_best_f1_score: 0.9406; train_kl_reg_loss: 1039.6406; train_edge_recon_loss: 93028.5199; train_gene_expr_recon_loss: 96329.1914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190397.3516; train_optim_loss: 190397.3516; val_kl_reg_loss: 1689.9246; val_edge_recon_loss: 86575.7109; val_gene_expr_recon_loss: 92556.1849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180821.8229; val_optim_loss: 180821.8229
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9073; val_auprc_score: 0.9732; val_best_acc_score: 0.9214; val_best_f1_score: 0.9550; train_kl_reg_loss: 1965.1926; train_edge_recon_loss: 83910.8072; train_gene_expr_recon_loss: 95329.0621; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181205.0625; train_optim_loss: 181205.0625; val_kl_reg_loss: 1866.4338; val_edge_recon_loss: 75293.8542; val_gene_expr_recon_loss: 92454.5990; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169614.8854; val_optim_loss: 169614.8854
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9135; val_auprc_score: 0.9721; val_best_acc_score: 0.9302; val_best_f1_score: 0.9601; train_kl_reg_loss: 1823.1612; train_edge_recon_loss: 80768.5199; train_gene_expr_recon_loss: 94457.5245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177049.2067; train_optim_loss: 177049.2067; val_kl_reg_loss: 1798.2476; val_edge_recon_loss: 81349.6380; val_gene_expr_recon_loss: 91515.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174663.2604; val_optim_loss: 174663.2604
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9107; val_auprc_score: 0.9670; val_best_acc_score: 0.9375; val_best_f1_score: 0.9640; train_kl_reg_loss: 1832.6204; train_edge_recon_loss: 79825.3533; train_gene_expr_recon_loss: 94079.6893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175737.6626; train_optim_loss: 175737.6626; val_kl_reg_loss: 1833.5447; val_edge_recon_loss: 85932.7995; val_gene_expr_recon_loss: 91798.7995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179565.1406; val_optim_loss: 179565.1406
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9241; val_auprc_score: 0.9772; val_best_acc_score: 0.9394; val_best_f1_score: 0.9653; train_kl_reg_loss: 1833.8965; train_edge_recon_loss: 78557.3928; train_gene_expr_recon_loss: 93708.1520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174099.4411; train_optim_loss: 174099.4411; val_kl_reg_loss: 1827.0493; val_edge_recon_loss: 81043.2656; val_gene_expr_recon_loss: 89170.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172040.8750; val_optim_loss: 172040.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9236; val_auprc_score: 0.9767; val_best_acc_score: 0.9380; val_best_f1_score: 0.9643; train_kl_reg_loss: 1851.2003; train_edge_recon_loss: 77861.2294; train_gene_expr_recon_loss: 92796.6619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172509.0902; train_optim_loss: 172509.0902; val_kl_reg_loss: 1838.3142; val_edge_recon_loss: 85171.1536; val_gene_expr_recon_loss: 89461.1771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176470.6510; val_optim_loss: 176470.6510
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9315; val_auprc_score: 0.9810; val_best_acc_score: 0.9450; val_best_f1_score: 0.9683; train_kl_reg_loss: 1851.3972; train_edge_recon_loss: 80239.8821; train_gene_expr_recon_loss: 92617.7869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174709.0661; train_optim_loss: 174709.0661; val_kl_reg_loss: 1821.1946; val_edge_recon_loss: 76959.5859; val_gene_expr_recon_loss: 89450.0885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168230.8646; val_optim_loss: 168230.8646
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9269; val_auprc_score: 0.9802; val_best_acc_score: 0.9528; val_best_f1_score: 0.9729; train_kl_reg_loss: 1848.7571; train_edge_recon_loss: 78621.8981; train_gene_expr_recon_loss: 92906.3540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173377.0099; train_optim_loss: 173377.0099; val_kl_reg_loss: 1851.9889; val_edge_recon_loss: 76562.5339; val_gene_expr_recon_loss: 90014.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168429.1875; val_optim_loss: 168429.1875
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9299; val_auprc_score: 0.9820; val_best_acc_score: 0.9409; val_best_f1_score: 0.9660; train_kl_reg_loss: 1862.8517; train_edge_recon_loss: 78072.6325; train_gene_expr_recon_loss: 93081.8338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173017.3168; train_optim_loss: 173017.3168; val_kl_reg_loss: 1856.9400; val_edge_recon_loss: 79666.8411; val_gene_expr_recon_loss: 89462.1302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170985.9115; val_optim_loss: 170985.9115
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9296; val_auprc_score: 0.9771; val_best_acc_score: 0.9405; val_best_f1_score: 0.9657; train_kl_reg_loss: 1851.9054; train_edge_recon_loss: 78867.4212; train_gene_expr_recon_loss: 92425.5923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173144.9190; train_optim_loss: 173144.9190; val_kl_reg_loss: 1833.7952; val_edge_recon_loss: 79540.9818; val_gene_expr_recon_loss: 89894.3307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171269.1042; val_optim_loss: 171269.1042

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9401; val_auprc_score: 0.9792; val_best_acc_score: 0.9450; val_best_f1_score: 0.9684; train_kl_reg_loss: 1843.5616; train_edge_recon_loss: 78974.9308; train_gene_expr_recon_loss: 92697.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173515.5391; train_optim_loss: 173515.5391; val_kl_reg_loss: 1823.6632; val_edge_recon_loss: 76607.5286; val_gene_expr_recon_loss: 88182.0052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166613.1979; val_optim_loss: 166613.1979
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9156; val_auprc_score: 0.9742; val_best_acc_score: 0.9434; val_best_f1_score: 0.9676; train_kl_reg_loss: 1846.6824; train_edge_recon_loss: 77223.5405; train_gene_expr_recon_loss: 92513.1161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171583.3395; train_optim_loss: 171583.3395; val_kl_reg_loss: 1827.0040; val_edge_recon_loss: 79441.1667; val_gene_expr_recon_loss: 89413.9896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170682.1615; val_optim_loss: 170682.1615
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9402; val_auprc_score: 0.9820; val_best_acc_score: 0.9502; val_best_f1_score: 0.9713; train_kl_reg_loss: 1843.6872; train_edge_recon_loss: 79029.8169; train_gene_expr_recon_loss: 92570.8867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173444.3913; train_optim_loss: 173444.3913; val_kl_reg_loss: 1842.0551; val_edge_recon_loss: 77939.8646; val_gene_expr_recon_loss: 89947.1901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169729.1146; val_optim_loss: 169729.1146
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9234; val_auprc_score: 0.9759; val_best_acc_score: 0.9473; val_best_f1_score: 0.9697; train_kl_reg_loss: 1847.4991; train_edge_recon_loss: 79638.3793; train_gene_expr_recon_loss: 92573.4471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174059.3260; train_optim_loss: 174059.3260; val_kl_reg_loss: 1830.9571; val_edge_recon_loss: 78306.0729; val_gene_expr_recon_loss: 88492.4505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168629.4844; val_optim_loss: 168629.4844

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9206; val_auprc_score: 0.9756; val_best_acc_score: 0.9402; val_best_f1_score: 0.9655; train_kl_reg_loss: 1851.1674; train_edge_recon_loss: 77970.2269; train_gene_expr_recon_loss: 92448.8690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172270.2649; train_optim_loss: 172270.2649; val_kl_reg_loss: 1837.1259; val_edge_recon_loss: 82966.9974; val_gene_expr_recon_loss: 89815.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174619.5990; val_optim_loss: 174619.5990
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9240; val_auprc_score: 0.9731; val_best_acc_score: 0.9444; val_best_f1_score: 0.9680; train_kl_reg_loss: 1850.5524; train_edge_recon_loss: 78148.5064; train_gene_expr_recon_loss: 92673.4865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172672.5469; train_optim_loss: 172672.5469; val_kl_reg_loss: 1826.0603; val_edge_recon_loss: 81193.6771; val_gene_expr_recon_loss: 88988.2760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172008.0156; val_optim_loss: 172008.0156
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9358; val_auprc_score: 0.9811; val_best_acc_score: 0.9443; val_best_f1_score: 0.9676; train_kl_reg_loss: 1849.2476; train_edge_recon_loss: 79998.6708; train_gene_expr_recon_loss: 92616.2514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174464.1705; train_optim_loss: 174464.1705; val_kl_reg_loss: 1828.6036; val_edge_recon_loss: 85284.2031; val_gene_expr_recon_loss: 89429.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176542.2656; val_optim_loss: 176542.2656

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 41 sec.
Using best model state, which was in epoch 13.

--- MODEL EVALUATION ---
Val AUROC score: 0.9232
Val AUPRC score: 0.9775
Val best accuracy score: 0.9419
Val best F1 score: 0.9667
Val gene expr MSE score: 0.9852
Duration of model training in run 8: 0 hours, 0 minutes and 43 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 27378
Number of validation edges: 3041
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8826; val_auprc_score: 0.9694; val_best_acc_score: 0.9064; val_best_f1_score: 0.9473; train_kl_reg_loss: 231.4778; train_edge_recon_loss: 100598.6968; train_gene_expr_recon_loss: 106261.8585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207092.0324; train_optim_loss: 207092.0324; val_kl_reg_loss: 142.4546; val_edge_recon_loss: 111817.4635; val_gene_expr_recon_loss: 96795.9870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208755.8958; val_optim_loss: 208755.8958
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8294; val_auprc_score: 0.9564; val_best_acc_score: 0.8887; val_best_f1_score: 0.9385; train_kl_reg_loss: 286.6164; train_edge_recon_loss: 99147.4395; train_gene_expr_recon_loss: 96320.4977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195754.5527; train_optim_loss: 195754.5527; val_kl_reg_loss: 630.7539; val_edge_recon_loss: 92473.5104; val_gene_expr_recon_loss: 94758.1693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187862.4375; val_optim_loss: 187862.4375
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8847; val_auprc_score: 0.9685; val_best_acc_score: 0.9073; val_best_f1_score: 0.9467; train_kl_reg_loss: 1392.7045; train_edge_recon_loss: 88235.4850; train_gene_expr_recon_loss: 94923.6872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184551.8767; train_optim_loss: 184551.8767; val_kl_reg_loss: 2043.7096; val_edge_recon_loss: 86136.1562; val_gene_expr_recon_loss: 93535.6120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181715.4740; val_optim_loss: 181715.4740
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9132; val_auprc_score: 0.9771; val_best_acc_score: 0.9269; val_best_f1_score: 0.9583; train_kl_reg_loss: 1859.0161; train_edge_recon_loss: 82147.3053; train_gene_expr_recon_loss: 93871.2231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177877.5457; train_optim_loss: 177877.5457; val_kl_reg_loss: 1637.6862; val_edge_recon_loss: 82176.7839; val_gene_expr_recon_loss: 92820.3177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176634.7865; val_optim_loss: 176634.7865
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9109; val_auprc_score: 0.9721; val_best_acc_score: 0.9342; val_best_f1_score: 0.9623; train_kl_reg_loss: 1778.8939; train_edge_recon_loss: 80702.5599; train_gene_expr_recon_loss: 93598.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176080.3281; train_optim_loss: 176080.3281; val_kl_reg_loss: 1846.5575; val_edge_recon_loss: 82373.8854; val_gene_expr_recon_loss: 92309.2552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176529.6927; val_optim_loss: 176529.6927
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9302; val_auprc_score: 0.9812; val_best_acc_score: 0.9485; val_best_f1_score: 0.9706; train_kl_reg_loss: 1803.1213; train_edge_recon_loss: 78589.4676; train_gene_expr_recon_loss: 92553.7486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172946.3385; train_optim_loss: 172946.3385; val_kl_reg_loss: 1801.6304; val_edge_recon_loss: 74010.4323; val_gene_expr_recon_loss: 91179.6927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166991.7552; val_optim_loss: 166991.7552
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9273; val_auprc_score: 0.9809; val_best_acc_score: 0.9422; val_best_f1_score: 0.9669; train_kl_reg_loss: 1830.8330; train_edge_recon_loss: 79607.0842; train_gene_expr_recon_loss: 92122.8736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173560.7911; train_optim_loss: 173560.7911; val_kl_reg_loss: 1838.2390; val_edge_recon_loss: 79183.1823; val_gene_expr_recon_loss: 91175.3646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172196.7865; val_optim_loss: 172196.7865
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9268; val_auprc_score: 0.9765; val_best_acc_score: 0.9537; val_best_f1_score: 0.9734; train_kl_reg_loss: 1830.2192; train_edge_recon_loss: 79474.4204; train_gene_expr_recon_loss: 91872.2266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173176.8652; train_optim_loss: 173176.8652; val_kl_reg_loss: 1802.8577; val_edge_recon_loss: 77610.0703; val_gene_expr_recon_loss: 91169.0286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170581.9583; val_optim_loss: 170581.9583
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9182; val_auprc_score: 0.9761; val_best_acc_score: 0.9403; val_best_f1_score: 0.9658; train_kl_reg_loss: 1785.4466; train_edge_recon_loss: 79638.9670; train_gene_expr_recon_loss: 91301.0911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172725.5029; train_optim_loss: 172725.5029; val_kl_reg_loss: 1837.2239; val_edge_recon_loss: 80827.8021; val_gene_expr_recon_loss: 91053.7786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173718.8021; val_optim_loss: 173718.8021

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9332; val_auprc_score: 0.9804; val_best_acc_score: 0.9465; val_best_f1_score: 0.9693; train_kl_reg_loss: 1839.2101; train_edge_recon_loss: 80357.2879; train_gene_expr_recon_loss: 91136.5165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173333.0162; train_optim_loss: 173333.0162; val_kl_reg_loss: 1803.9638; val_edge_recon_loss: 79933.1042; val_gene_expr_recon_loss: 90455.3620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172192.4271; val_optim_loss: 172192.4271
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9321; val_auprc_score: 0.9851; val_best_acc_score: 0.9507; val_best_f1_score: 0.9720; train_kl_reg_loss: 1809.2579; train_edge_recon_loss: 79341.1612; train_gene_expr_recon_loss: 90699.2326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171849.6505; train_optim_loss: 171849.6505; val_kl_reg_loss: 1779.4952; val_edge_recon_loss: 74936.3021; val_gene_expr_recon_loss: 90457.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167173.1510; val_optim_loss: 167173.1510
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9367; val_auprc_score: 0.9792; val_best_acc_score: 0.9499; val_best_f1_score: 0.9712; train_kl_reg_loss: 1788.7503; train_edge_recon_loss: 77741.1347; train_gene_expr_recon_loss: 91065.7862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170595.6707; train_optim_loss: 170595.6707; val_kl_reg_loss: 1776.6858; val_edge_recon_loss: 79165.7292; val_gene_expr_recon_loss: 90674.5521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171616.9635; val_optim_loss: 171616.9635

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 32 sec.
Using best model state, which was in epoch 6.

--- MODEL EVALUATION ---
Val AUROC score: 0.9116
Val AUPRC score: 0.9755
Val best accuracy score: 0.9355
Val best F1 score: 0.9629
Val gene expr MSE score: 1.1716
Duration of model training in run 9: 0 hours, 0 minutes and 34 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 27378
Number of validation edges: 3041
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8816; val_auprc_score: 0.9681; val_best_acc_score: 0.9016; val_best_f1_score: 0.9439; train_kl_reg_loss: 211.7451; train_edge_recon_loss: 98880.4352; train_gene_expr_recon_loss: 106603.8134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205695.9948; train_optim_loss: 205695.9948; val_kl_reg_loss: 164.8419; val_edge_recon_loss: 114306.8255; val_gene_expr_recon_loss: 97525.9974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211997.6667; val_optim_loss: 211997.6667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8722; val_auprc_score: 0.9669; val_best_acc_score: 0.8888; val_best_f1_score: 0.9378; train_kl_reg_loss: 330.0569; train_edge_recon_loss: 96963.6016; train_gene_expr_recon_loss: 95786.1733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193079.8328; train_optim_loss: 193079.8328; val_kl_reg_loss: 680.9134; val_edge_recon_loss: 95056.7214; val_gene_expr_recon_loss: 95880.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191618.0833; val_optim_loss: 191618.0833
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8815; val_auprc_score: 0.9651; val_best_acc_score: 0.9263; val_best_f1_score: 0.9581; train_kl_reg_loss: 1549.7254; train_edge_recon_loss: 84584.9742; train_gene_expr_recon_loss: 94494.9369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180629.6360; train_optim_loss: 180629.6360; val_kl_reg_loss: 2118.8056; val_edge_recon_loss: 82331.1380; val_gene_expr_recon_loss: 94736.1458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179186.0833; val_optim_loss: 179186.0833
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9167; val_auprc_score: 0.9764; val_best_acc_score: 0.9405; val_best_f1_score: 0.9663; train_kl_reg_loss: 1916.2690; train_edge_recon_loss: 81560.0619; train_gene_expr_recon_loss: 93220.9647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176697.2957; train_optim_loss: 176697.2957; val_kl_reg_loss: 1841.9359; val_edge_recon_loss: 77689.3646; val_gene_expr_recon_loss: 94139.5885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173670.8854; val_optim_loss: 173670.8854
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9111; val_auprc_score: 0.9694; val_best_acc_score: 0.9368; val_best_f1_score: 0.9639; train_kl_reg_loss: 1808.4925; train_edge_recon_loss: 81034.3767; train_gene_expr_recon_loss: 92686.8698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175529.7367; train_optim_loss: 175529.7367; val_kl_reg_loss: 1789.3139; val_edge_recon_loss: 79409.5000; val_gene_expr_recon_loss: 93041.6354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174240.4583; val_optim_loss: 174240.4583
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9313; val_auprc_score: 0.9794; val_best_acc_score: 0.9440; val_best_f1_score: 0.9678; train_kl_reg_loss: 1872.0298; train_edge_recon_loss: 78872.4280; train_gene_expr_recon_loss: 92090.6979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172835.1562; train_optim_loss: 172835.1562; val_kl_reg_loss: 1852.8383; val_edge_recon_loss: 77621.9609; val_gene_expr_recon_loss: 92771.9271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172246.7292; val_optim_loss: 172246.7292
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9112; val_auprc_score: 0.9749; val_best_acc_score: 0.9418; val_best_f1_score: 0.9673; train_kl_reg_loss: 1817.1453; train_edge_recon_loss: 78342.0486; train_gene_expr_recon_loss: 91761.3938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171920.5862; train_optim_loss: 171920.5862; val_kl_reg_loss: 1762.0271; val_edge_recon_loss: 75185.1094; val_gene_expr_recon_loss: 92626.9193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169574.0573; val_optim_loss: 169574.0573
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9385; val_auprc_score: 0.9838; val_best_acc_score: 0.9485; val_best_f1_score: 0.9701; train_kl_reg_loss: 1832.9247; train_edge_recon_loss: 80896.0275; train_gene_expr_recon_loss: 91200.4352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173929.3895; train_optim_loss: 173929.3895; val_kl_reg_loss: 1766.7154; val_edge_recon_loss: 81157.2344; val_gene_expr_recon_loss: 91975.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174899.2604; val_optim_loss: 174899.2604
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9450; val_auprc_score: 0.9865; val_best_acc_score: 0.9526; val_best_f1_score: 0.9728; train_kl_reg_loss: 1828.1582; train_edge_recon_loss: 78374.4864; train_gene_expr_recon_loss: 90758.6073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170961.2523; train_optim_loss: 170961.2523; val_kl_reg_loss: 1743.9922; val_edge_recon_loss: 74607.6380; val_gene_expr_recon_loss: 91928.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168279.7604; val_optim_loss: 168279.7604
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9325; val_auprc_score: 0.9835; val_best_acc_score: 0.9531; val_best_f1_score: 0.9735; train_kl_reg_loss: 1807.0834; train_edge_recon_loss: 79194.2297; train_gene_expr_recon_loss: 90535.8336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171537.1458; train_optim_loss: 171537.1458; val_kl_reg_loss: 1672.4566; val_edge_recon_loss: 71690.9010; val_gene_expr_recon_loss: 91385.2943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164748.6510; val_optim_loss: 164748.6510
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9308; val_auprc_score: 0.9786; val_best_acc_score: 0.9471; val_best_f1_score: 0.9697; train_kl_reg_loss: 1805.4970; train_edge_recon_loss: 78336.9933; train_gene_expr_recon_loss: 90274.5023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170416.9936; train_optim_loss: 170416.9936; val_kl_reg_loss: 1770.4632; val_edge_recon_loss: 79315.3255; val_gene_expr_recon_loss: 91577.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172663.5000; val_optim_loss: 172663.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9374; val_auprc_score: 0.9779; val_best_acc_score: 0.9565; val_best_f1_score: 0.9752; train_kl_reg_loss: 1780.7993; train_edge_recon_loss: 79132.1629; train_gene_expr_recon_loss: 90157.7989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171070.7593; train_optim_loss: 171070.7593; val_kl_reg_loss: 1759.1441; val_edge_recon_loss: 73984.2682; val_gene_expr_recon_loss: 90956.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166699.9844; val_optim_loss: 166699.9844
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9197; val_auprc_score: 0.9742; val_best_acc_score: 0.9462; val_best_f1_score: 0.9692; train_kl_reg_loss: 1814.9492; train_edge_recon_loss: 79492.7729; train_gene_expr_recon_loss: 90233.0911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171540.8131; train_optim_loss: 171540.8131; val_kl_reg_loss: 1760.2674; val_edge_recon_loss: 80583.2760; val_gene_expr_recon_loss: 90713.7370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173057.2812; val_optim_loss: 173057.2812

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9265; val_auprc_score: 0.9771; val_best_acc_score: 0.9507; val_best_f1_score: 0.9714; train_kl_reg_loss: 1781.2569; train_edge_recon_loss: 80319.0836; train_gene_expr_recon_loss: 89553.8602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171654.2014; train_optim_loss: 171654.2014; val_kl_reg_loss: 1736.5434; val_edge_recon_loss: 78300.6901; val_gene_expr_recon_loss: 90815.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170852.5052; val_optim_loss: 170852.5052
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9452; val_auprc_score: 0.9829; val_best_acc_score: 0.9495; val_best_f1_score: 0.9706; train_kl_reg_loss: 1791.1261; train_edge_recon_loss: 79411.8212; train_gene_expr_recon_loss: 89391.0191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170593.9676; train_optim_loss: 170593.9676; val_kl_reg_loss: 1768.7905; val_edge_recon_loss: 82508.7474; val_gene_expr_recon_loss: 90330.0755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174607.6146; val_optim_loss: 174607.6146
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9353; val_auprc_score: 0.9807; val_best_acc_score: 0.9518; val_best_f1_score: 0.9724; train_kl_reg_loss: 1810.2228; train_edge_recon_loss: 78213.8417; train_gene_expr_recon_loss: 89203.6733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169227.7378; train_optim_loss: 169227.7378; val_kl_reg_loss: 1772.3548; val_edge_recon_loss: 77963.5625; val_gene_expr_recon_loss: 90706.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170442.3802; val_optim_loss: 170442.3802

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 40 sec.
Using best model state, which was in epoch 10.

--- MODEL EVALUATION ---
Val AUROC score: 0.9261
Val AUPRC score: 0.9807
Val best accuracy score: 0.9502
Val best F1 score: 0.9713
Val gene expr MSE score: 1.1550
Duration of model training in run 10: 0 hours, 0 minutes and 43 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
First script finished. Launching follow up script.
Run timestamp: 02062023_102614.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '8192', '8192', '4096', '4096', '2048', '2048', '1024', '1024', '1024', '1024', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_10pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-attention_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-attention', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 10989
Number of validation edges: 1220
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9267; val_auprc_score: 0.9863; val_best_acc_score: 0.9131; val_best_f1_score: 0.9513; train_kl_reg_loss: 54.9569; train_edge_recon_loss: 100394.8398; train_gene_expr_recon_loss: 142983.1406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 243432.9375; train_optim_loss: 243432.9375; val_kl_reg_loss: 74.0653; val_edge_recon_loss: 106729.3984; val_gene_expr_recon_loss: 127093.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 233897.1562; val_optim_loss: 233897.1562
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9136; val_auprc_score: 0.9784; val_best_acc_score: 0.8997; val_best_f1_score: 0.9425; train_kl_reg_loss: 96.3086; train_edge_recon_loss: 100330.8594; train_gene_expr_recon_loss: 122665.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 223092.5078; train_optim_loss: 223092.5078; val_kl_reg_loss: 167.0605; val_edge_recon_loss: 118980.8750; val_gene_expr_recon_loss: 115137.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234285.4688; val_optim_loss: 234285.4688
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9006; val_auprc_score: 0.9808; val_best_acc_score: 0.8995; val_best_f1_score: 0.9421; train_kl_reg_loss: 208.7433; train_edge_recon_loss: 102344.4062; train_gene_expr_recon_loss: 112216.1836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214769.3281; train_optim_loss: 214769.3281; val_kl_reg_loss: 287.0771; val_edge_recon_loss: 109319.3281; val_gene_expr_recon_loss: 107938.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217544.9531; val_optim_loss: 217544.9531
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8974; val_auprc_score: 0.9753; val_best_acc_score: 0.8978; val_best_f1_score: 0.9411; train_kl_reg_loss: 311.9973; train_edge_recon_loss: 102053.1523; train_gene_expr_recon_loss: 105397.5156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207762.6719; train_optim_loss: 207762.6719; val_kl_reg_loss: 323.6282; val_edge_recon_loss: 112029.3906; val_gene_expr_recon_loss: 104166.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216519.9688; val_optim_loss: 216519.9688
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9022; val_auprc_score: 0.9791; val_best_acc_score: 0.8957; val_best_f1_score: 0.9414; train_kl_reg_loss: 324.4848; train_edge_recon_loss: 104525.2930; train_gene_expr_recon_loss: 101212.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206062.7031; train_optim_loss: 206062.7031; val_kl_reg_loss: 288.6079; val_edge_recon_loss: 115613.2109; val_gene_expr_recon_loss: 102158.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218060.7812; val_optim_loss: 218060.7812
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8775; val_auprc_score: 0.9712; val_best_acc_score: 0.8802; val_best_f1_score: 0.9328; train_kl_reg_loss: 285.7454; train_edge_recon_loss: 100345.1367; train_gene_expr_recon_loss: 100488.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201119.6250; train_optim_loss: 201119.6250; val_kl_reg_loss: 230.1642; val_edge_recon_loss: 118419.5234; val_gene_expr_recon_loss: 101154.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 219804.5312; val_optim_loss: 219804.5312
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8865; val_auprc_score: 0.9737; val_best_acc_score: 0.8916; val_best_f1_score: 0.9391; train_kl_reg_loss: 226.7449; train_edge_recon_loss: 104352.5781; train_gene_expr_recon_loss: 99029.5234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203608.8516; train_optim_loss: 203608.8516; val_kl_reg_loss: 182.5651; val_edge_recon_loss: 116834.2344; val_gene_expr_recon_loss: 100652.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217669.3438; val_optim_loss: 217669.3438

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8905; val_auprc_score: 0.9755; val_best_acc_score: 0.8978; val_best_f1_score: 0.9427; train_kl_reg_loss: 189.2989; train_edge_recon_loss: 100313.8047; train_gene_expr_recon_loss: 99969.1211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200472.2266; train_optim_loss: 200472.2266; val_kl_reg_loss: 179.8603; val_edge_recon_loss: 111323.2891; val_gene_expr_recon_loss: 100604.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 212107.3125; val_optim_loss: 212107.3125
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9028; val_auprc_score: 0.9717; val_best_acc_score: 0.8994; val_best_f1_score: 0.9426; train_kl_reg_loss: 187.0627; train_edge_recon_loss: 103791.1953; train_gene_expr_recon_loss: 99517.2266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203495.4844; train_optim_loss: 203495.4844; val_kl_reg_loss: 176.3447; val_edge_recon_loss: 120637.8516; val_gene_expr_recon_loss: 100539.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221353.8125; val_optim_loss: 221353.8125
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8905; val_auprc_score: 0.9765; val_best_acc_score: 0.9027; val_best_f1_score: 0.9450; train_kl_reg_loss: 183.3340; train_edge_recon_loss: 100985.3711; train_gene_expr_recon_loss: 99853.4883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201022.1953; train_optim_loss: 201022.1953; val_kl_reg_loss: 173.1082; val_edge_recon_loss: 110747.7188; val_gene_expr_recon_loss: 100463.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211383.9844; val_optim_loss: 211383.9844
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8718; val_auprc_score: 0.9680; val_best_acc_score: 0.8906; val_best_f1_score: 0.9383; train_kl_reg_loss: 177.7000; train_edge_recon_loss: 97302.2422; train_gene_expr_recon_loss: 99401.3711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196881.3125; train_optim_loss: 196881.3125; val_kl_reg_loss: 169.6741; val_edge_recon_loss: 114201.2891; val_gene_expr_recon_loss: 100378.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214749.0469; val_optim_loss: 214749.0469
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8860; val_auprc_score: 0.9730; val_best_acc_score: 0.8928; val_best_f1_score: 0.9402; train_kl_reg_loss: 174.9918; train_edge_recon_loss: 101010.8672; train_gene_expr_recon_loss: 98929.4414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200115.3047; train_optim_loss: 200115.3047; val_kl_reg_loss: 166.9757; val_edge_recon_loss: 110111.5859; val_gene_expr_recon_loss: 100288.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210566.7500; val_optim_loss: 210566.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8659; val_auprc_score: 0.9623; val_best_acc_score: 0.8809; val_best_f1_score: 0.9328; train_kl_reg_loss: 172.9260; train_edge_recon_loss: 99949.5547; train_gene_expr_recon_loss: 99509.9258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199632.4062; train_optim_loss: 199632.4062; val_kl_reg_loss: 164.4164; val_edge_recon_loss: 122080.9688; val_gene_expr_recon_loss: 100196.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222441.9844; val_optim_loss: 222441.9844
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8625; val_auprc_score: 0.9667; val_best_acc_score: 0.9024; val_best_f1_score: 0.9459; train_kl_reg_loss: 171.2006; train_edge_recon_loss: 103515.0625; train_gene_expr_recon_loss: 99864.1055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203550.3672; train_optim_loss: 203550.3672; val_kl_reg_loss: 163.0287; val_edge_recon_loss: 103284.9531; val_gene_expr_recon_loss: 100104.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 203552.8438; val_optim_loss: 203552.8438
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9055; val_auprc_score: 0.9810; val_best_acc_score: 0.9059; val_best_f1_score: 0.9470; train_kl_reg_loss: 169.1112; train_edge_recon_loss: 103480.7852; train_gene_expr_recon_loss: 99720.3555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203370.2500; train_optim_loss: 203370.2500; val_kl_reg_loss: 161.5474; val_edge_recon_loss: 107003.1094; val_gene_expr_recon_loss: 100014.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207179.0938; val_optim_loss: 207179.0938
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9006; val_auprc_score: 0.9785; val_best_acc_score: 0.9108; val_best_f1_score: 0.9495; train_kl_reg_loss: 169.2284; train_edge_recon_loss: 97766.7305; train_gene_expr_recon_loss: 98479.9414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196415.9062; train_optim_loss: 196415.9062; val_kl_reg_loss: 161.7406; val_edge_recon_loss: 105429.5312; val_gene_expr_recon_loss: 99926.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205518.0781; val_optim_loss: 205518.0781
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8936; val_auprc_score: 0.9752; val_best_acc_score: 0.9034; val_best_f1_score: 0.9456; train_kl_reg_loss: 167.3094; train_edge_recon_loss: 100896.9766; train_gene_expr_recon_loss: 98320.8672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199385.1562; train_optim_loss: 199385.1562; val_kl_reg_loss: 160.7672; val_edge_recon_loss: 104808.6719; val_gene_expr_recon_loss: 99842.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204812.2812; val_optim_loss: 204812.2812

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8634; val_auprc_score: 0.9655; val_best_acc_score: 0.8969; val_best_f1_score: 0.9426; train_kl_reg_loss: 169.6152; train_edge_recon_loss: 102856.6836; train_gene_expr_recon_loss: 99563.1445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202589.4531; train_optim_loss: 202589.4531; val_kl_reg_loss: 162.2784; val_edge_recon_loss: 106795.6484; val_gene_expr_recon_loss: 99834.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206792.5938; val_optim_loss: 206792.5938
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8926; val_auprc_score: 0.9739; val_best_acc_score: 0.9058; val_best_f1_score: 0.9467; train_kl_reg_loss: 166.8496; train_edge_recon_loss: 100636.6250; train_gene_expr_recon_loss: 97496.5859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198300.0625; train_optim_loss: 198300.0625; val_kl_reg_loss: 162.1611; val_edge_recon_loss: 105333.7266; val_gene_expr_recon_loss: 99826.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205322.3750; val_optim_loss: 205322.3750
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8917; val_auprc_score: 0.9737; val_best_acc_score: 0.9049; val_best_f1_score: 0.9467; train_kl_reg_loss: 166.5949; train_edge_recon_loss: 101601.4648; train_gene_expr_recon_loss: 98152.6602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199920.7188; train_optim_loss: 199920.7188; val_kl_reg_loss: 161.7461; val_edge_recon_loss: 107859.9531; val_gene_expr_recon_loss: 99818.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207840.0000; val_optim_loss: 207840.0000

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 12 sec.
Using best model state, which was in epoch 14.

--- MODEL EVALUATION ---
Val AUROC score: 0.8789
Val AUPRC score: 0.9723
Val best accuracy score: 0.8956
Val best F1 score: 0.9415
Val gene expr MSE score: 1.5519
Duration of model training in run 1: 0 hours, 0 minutes and 18 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 10989
Number of validation edges: 1220
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9185; val_auprc_score: 0.9807; val_best_acc_score: 0.9008; val_best_f1_score: 0.9445; train_kl_reg_loss: 49.5319; train_edge_recon_loss: 100401.2734; train_gene_expr_recon_loss: 144546.5703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 244997.3828; train_optim_loss: 244997.3828; val_kl_reg_loss: 62.3422; val_edge_recon_loss: 108715.7422; val_gene_expr_recon_loss: 123100.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 231879.0781; val_optim_loss: 231879.0781
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8807; val_auprc_score: 0.9754; val_best_acc_score: 0.9059; val_best_f1_score: 0.9479; train_kl_reg_loss: 81.2105; train_edge_recon_loss: 103538.8086; train_gene_expr_recon_loss: 122026.6328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 225646.6562; train_optim_loss: 225646.6562; val_kl_reg_loss: 136.9910; val_edge_recon_loss: 102741.6797; val_gene_expr_recon_loss: 112135.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215014.5781; val_optim_loss: 215014.5781
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8981; val_auprc_score: 0.9783; val_best_acc_score: 0.8912; val_best_f1_score: 0.9387; train_kl_reg_loss: 165.5380; train_edge_recon_loss: 106135.9023; train_gene_expr_recon_loss: 110745.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217046.5234; train_optim_loss: 217046.5234; val_kl_reg_loss: 227.4269; val_edge_recon_loss: 118599.3203; val_gene_expr_recon_loss: 105670.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224497.3594; val_optim_loss: 224497.3594
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9127; val_auprc_score: 0.9822; val_best_acc_score: 0.8947; val_best_f1_score: 0.9397; train_kl_reg_loss: 246.3231; train_edge_recon_loss: 101848.3750; train_gene_expr_recon_loss: 105544.0430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207638.7422; train_optim_loss: 207638.7422; val_kl_reg_loss: 252.2927; val_edge_recon_loss: 121679.4297; val_gene_expr_recon_loss: 102100.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224032.2969; val_optim_loss: 224032.2969
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8873; val_auprc_score: 0.9734; val_best_acc_score: 0.8918; val_best_f1_score: 0.9396; train_kl_reg_loss: 252.9285; train_edge_recon_loss: 97326.7578; train_gene_expr_recon_loss: 102461.5820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200041.2656; train_optim_loss: 200041.2656; val_kl_reg_loss: 218.8078; val_edge_recon_loss: 110461.3828; val_gene_expr_recon_loss: 100192.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210872.2500; val_optim_loss: 210872.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8911; val_auprc_score: 0.9780; val_best_acc_score: 0.8839; val_best_f1_score: 0.9346; train_kl_reg_loss: 214.4203; train_edge_recon_loss: 102088.8398; train_gene_expr_recon_loss: 102315.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204618.4375; train_optim_loss: 204618.4375; val_kl_reg_loss: 180.1807; val_edge_recon_loss: 114922.8359; val_gene_expr_recon_loss: 99213.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214316.3125; val_optim_loss: 214316.3125
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8752; val_auprc_score: 0.9645; val_best_acc_score: 0.8890; val_best_f1_score: 0.9372; train_kl_reg_loss: 176.0850; train_edge_recon_loss: 99887.9844; train_gene_expr_recon_loss: 99445.7773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199509.8438; train_optim_loss: 199509.8438; val_kl_reg_loss: 161.5039; val_edge_recon_loss: 117081.9375; val_gene_expr_recon_loss: 98693.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215936.4375; val_optim_loss: 215936.4375
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8539; val_auprc_score: 0.9677; val_best_acc_score: 0.8881; val_best_f1_score: 0.9370; train_kl_reg_loss: 166.2873; train_edge_recon_loss: 93492.0664; train_gene_expr_recon_loss: 100462.3789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194120.7344; train_optim_loss: 194120.7344; val_kl_reg_loss: 173.0774; val_edge_recon_loss: 103439.7422; val_gene_expr_recon_loss: 98351.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201964.5156; val_optim_loss: 201964.5156
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8348; val_auprc_score: 0.9615; val_best_acc_score: 0.8789; val_best_f1_score: 0.9329; train_kl_reg_loss: 185.1573; train_edge_recon_loss: 100474.0547; train_gene_expr_recon_loss: 99343.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200002.8594; train_optim_loss: 200002.8594; val_kl_reg_loss: 220.6702; val_edge_recon_loss: 104676.8906; val_gene_expr_recon_loss: 98058.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202956.2500; val_optim_loss: 202956.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8082; val_auprc_score: 0.9551; val_best_acc_score: 0.8735; val_best_f1_score: 0.9306; train_kl_reg_loss: 239.7183; train_edge_recon_loss: 99345.8008; train_gene_expr_recon_loss: 98991.8867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198577.4062; train_optim_loss: 198577.4062; val_kl_reg_loss: 310.7547; val_edge_recon_loss: 104799.9531; val_gene_expr_recon_loss: 97773.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202884.3594; val_optim_loss: 202884.3594
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8013; val_auprc_score: 0.9578; val_best_acc_score: 0.8769; val_best_f1_score: 0.9332; train_kl_reg_loss: 343.5114; train_edge_recon_loss: 99841.0625; train_gene_expr_recon_loss: 98302.9844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198487.5625; train_optim_loss: 198487.5625; val_kl_reg_loss: 440.4044; val_edge_recon_loss: 94591.1797; val_gene_expr_recon_loss: 97485.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192517.0312; val_optim_loss: 192517.0312
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8187; val_auprc_score: 0.9619; val_best_acc_score: 0.8785; val_best_f1_score: 0.9329; train_kl_reg_loss: 486.4842; train_edge_recon_loss: 94778.2617; train_gene_expr_recon_loss: 98020.9258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193285.6719; train_optim_loss: 193285.6719; val_kl_reg_loss: 618.3530; val_edge_recon_loss: 94761.3672; val_gene_expr_recon_loss: 97195.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192575.1250; val_optim_loss: 192575.1250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8174; val_auprc_score: 0.9552; val_best_acc_score: 0.8806; val_best_f1_score: 0.9338; train_kl_reg_loss: 671.0697; train_edge_recon_loss: 93275.8203; train_gene_expr_recon_loss: 98200.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192147.2266; train_optim_loss: 192147.2266; val_kl_reg_loss: 850.4412; val_edge_recon_loss: 94438.6953; val_gene_expr_recon_loss: 96914.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192203.2500; val_optim_loss: 192203.2500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8206; val_auprc_score: 0.9577; val_best_acc_score: 0.8809; val_best_f1_score: 0.9333; train_kl_reg_loss: 931.2359; train_edge_recon_loss: 91156.0156; train_gene_expr_recon_loss: 98091.8633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190179.1172; train_optim_loss: 190179.1172; val_kl_reg_loss: 1125.5776; val_edge_recon_loss: 93523.1172; val_gene_expr_recon_loss: 96647.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191295.6875; val_optim_loss: 191295.6875
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7972; val_auprc_score: 0.9500; val_best_acc_score: 0.8653; val_best_f1_score: 0.9256; train_kl_reg_loss: 1209.0381; train_edge_recon_loss: 91581.6484; train_gene_expr_recon_loss: 96895.0547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189685.7422; train_optim_loss: 189685.7422; val_kl_reg_loss: 1446.6443; val_edge_recon_loss: 99908.8906; val_gene_expr_recon_loss: 96390.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197746.1875; val_optim_loss: 197746.1875
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7906; val_auprc_score: 0.9492; val_best_acc_score: 0.8705; val_best_f1_score: 0.9286; train_kl_reg_loss: 1531.7095; train_edge_recon_loss: 88160.4961; train_gene_expr_recon_loss: 97045.8672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186738.0703; train_optim_loss: 186738.0703; val_kl_reg_loss: 1778.5549; val_edge_recon_loss: 96914.1797; val_gene_expr_recon_loss: 96140.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194833.5625; val_optim_loss: 194833.5625
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8016; val_auprc_score: 0.9552; val_best_acc_score: 0.8817; val_best_f1_score: 0.9349; train_kl_reg_loss: 1856.0548; train_edge_recon_loss: 86735.8047; train_gene_expr_recon_loss: 96913.6758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185505.5391; train_optim_loss: 185505.5391; val_kl_reg_loss: 2066.8523; val_edge_recon_loss: 91508.3047; val_gene_expr_recon_loss: 95913.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189489.0000; val_optim_loss: 189489.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8387; val_auprc_score: 0.9607; val_best_acc_score: 0.8890; val_best_f1_score: 0.9387; train_kl_reg_loss: 2157.1602; train_edge_recon_loss: 86773.0391; train_gene_expr_recon_loss: 97360.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186290.4219; train_optim_loss: 186290.4219; val_kl_reg_loss: 2314.1021; val_edge_recon_loss: 84066.8828; val_gene_expr_recon_loss: 95717.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182098.7344; val_optim_loss: 182098.7344
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8131; val_auprc_score: 0.9518; val_best_acc_score: 0.8861; val_best_f1_score: 0.9368; train_kl_reg_loss: 2365.4670; train_edge_recon_loss: 87535.5000; train_gene_expr_recon_loss: 96538.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186439.6875; train_optim_loss: 186439.6875; val_kl_reg_loss: 2462.4485; val_edge_recon_loss: 88449.7188; val_gene_expr_recon_loss: 95565.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186477.4375; val_optim_loss: 186477.4375
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8335; val_auprc_score: 0.9622; val_best_acc_score: 0.8823; val_best_f1_score: 0.9339; train_kl_reg_loss: 2489.9982; train_edge_recon_loss: 87053.4727; train_gene_expr_recon_loss: 95733.8672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185277.3359; train_optim_loss: 185277.3359; val_kl_reg_loss: 2578.8225; val_edge_recon_loss: 90108.8672; val_gene_expr_recon_loss: 95435.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188123.3281; val_optim_loss: 188123.3281
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8400; val_auprc_score: 0.9562; val_best_acc_score: 0.8876; val_best_f1_score: 0.9381; train_kl_reg_loss: 2620.5120; train_edge_recon_loss: 82204.1445; train_gene_expr_recon_loss: 96652.5977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181477.2656; train_optim_loss: 181477.2656; val_kl_reg_loss: 2702.1914; val_edge_recon_loss: 82463.7656; val_gene_expr_recon_loss: 95376.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180542.0781; val_optim_loss: 180542.0781
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8605; val_auprc_score: 0.9671; val_best_acc_score: 0.8934; val_best_f1_score: 0.9392; train_kl_reg_loss: 2709.0522; train_edge_recon_loss: 86107.9648; train_gene_expr_recon_loss: 95475.1484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184292.1641; train_optim_loss: 184292.1641; val_kl_reg_loss: 2668.9204; val_edge_recon_loss: 84335.6719; val_gene_expr_recon_loss: 95216.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182221.1875; val_optim_loss: 182221.1875
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8605; val_auprc_score: 0.9651; val_best_acc_score: 0.8852; val_best_f1_score: 0.9357; train_kl_reg_loss: 2692.8069; train_edge_recon_loss: 81607.9766; train_gene_expr_recon_loss: 95812.7109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180113.5000; train_optim_loss: 180113.5000; val_kl_reg_loss: 2678.7886; val_edge_recon_loss: 87356.5156; val_gene_expr_recon_loss: 95140.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185175.3125; val_optim_loss: 185175.3125
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8564; val_auprc_score: 0.9660; val_best_acc_score: 0.8871; val_best_f1_score: 0.9361; train_kl_reg_loss: 2699.3320; train_edge_recon_loss: 84478.3242; train_gene_expr_recon_loss: 96391.4336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183569.0859; train_optim_loss: 183569.0859; val_kl_reg_loss: 2650.8330; val_edge_recon_loss: 91049.7578; val_gene_expr_recon_loss: 95009.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188710.4062; val_optim_loss: 188710.4062

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8602; val_auprc_score: 0.9693; val_best_acc_score: 0.9051; val_best_f1_score: 0.9473; train_kl_reg_loss: 2660.1450; train_edge_recon_loss: 81719.9336; train_gene_expr_recon_loss: 94748.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179128.4219; train_optim_loss: 179128.4219; val_kl_reg_loss: 2632.8013; val_edge_recon_loss: 75156.5156; val_gene_expr_recon_loss: 94986.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172775.7656; val_optim_loss: 172775.7656
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8451; val_auprc_score: 0.9634; val_best_acc_score: 0.9018; val_best_f1_score: 0.9452; train_kl_reg_loss: 2687.8906; train_edge_recon_loss: 81614.1094; train_gene_expr_recon_loss: 96393.8359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180695.8359; train_optim_loss: 180695.8359; val_kl_reg_loss: 2626.1165; val_edge_recon_loss: 79745.0938; val_gene_expr_recon_loss: 94956.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177327.3438; val_optim_loss: 177327.3438
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8468; val_auprc_score: 0.9566; val_best_acc_score: 0.8863; val_best_f1_score: 0.9365; train_kl_reg_loss: 2654.9124; train_edge_recon_loss: 85164.6953; train_gene_expr_recon_loss: 96228.6523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184048.2500; train_optim_loss: 184048.2500; val_kl_reg_loss: 2609.2942; val_edge_recon_loss: 86961.0312; val_gene_expr_recon_loss: 94923.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184494.2812; val_optim_loss: 184494.2812
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8577; val_auprc_score: 0.9637; val_best_acc_score: 0.8910; val_best_f1_score: 0.9390; train_kl_reg_loss: 2609.2780; train_edge_recon_loss: 82883.9414; train_gene_expr_recon_loss: 95435.9414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180929.1641; train_optim_loss: 180929.1641; val_kl_reg_loss: 2577.9185; val_edge_recon_loss: 85359.3203; val_gene_expr_recon_loss: 94895.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182832.8125; val_optim_loss: 182832.8125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8622; val_auprc_score: 0.9704; val_best_acc_score: 0.8947; val_best_f1_score: 0.9414; train_kl_reg_loss: 2604.0962; train_edge_recon_loss: 80176.3789; train_gene_expr_recon_loss: 94962.6406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177743.1172; train_optim_loss: 177743.1172; val_kl_reg_loss: 2584.5547; val_edge_recon_loss: 82400.6875; val_gene_expr_recon_loss: 94892.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179878.1250; val_optim_loss: 179878.1250
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8758; val_auprc_score: 0.9643; val_best_acc_score: 0.8904; val_best_f1_score: 0.9376; train_kl_reg_loss: 2592.2219; train_edge_recon_loss: 81428.6797; train_gene_expr_recon_loss: 95895.4531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179916.3594; train_optim_loss: 179916.3594; val_kl_reg_loss: 2573.9004; val_edge_recon_loss: 84483.4844; val_gene_expr_recon_loss: 94890.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181947.6562; val_optim_loss: 181947.6562
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8774; val_auprc_score: 0.9702; val_best_acc_score: 0.8841; val_best_f1_score: 0.9342; train_kl_reg_loss: 2615.4774; train_edge_recon_loss: 82112.7734; train_gene_expr_recon_loss: 95999.2227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180727.4688; train_optim_loss: 180727.4688; val_kl_reg_loss: 2574.0591; val_edge_recon_loss: 90362.9375; val_gene_expr_recon_loss: 94887.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187824.4688; val_optim_loss: 187824.4688

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 16 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.8622
Val AUPRC score: 0.9682
Val best accuracy score: 0.8962
Val best F1 score: 0.9419
Val gene expr MSE score: 1.2371
Duration of model training in run 2: 0 hours, 0 minutes and 17 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 21600
Number of validation edges: 2400
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9709; val_auprc_score: 0.9944; val_best_acc_score: 0.9314; val_best_f1_score: 0.9613; train_kl_reg_loss: 116.9956; train_edge_recon_loss: 101498.1836; train_gene_expr_recon_loss: 125229.9596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226845.1406; train_optim_loss: 226845.1406; val_kl_reg_loss: 288.6131; val_edge_recon_loss: 113755.9609; val_gene_expr_recon_loss: 106837.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220881.6875; val_optim_loss: 220881.6875
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9501; val_auprc_score: 0.9879; val_best_acc_score: 0.9196; val_best_f1_score: 0.9540; train_kl_reg_loss: 299.9760; train_edge_recon_loss: 101874.3997; train_gene_expr_recon_loss: 100989.9492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203164.3229; train_optim_loss: 203164.3229; val_kl_reg_loss: 215.2114; val_edge_recon_loss: 111199.5469; val_gene_expr_recon_loss: 99623.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211038.2500; val_optim_loss: 211038.2500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9059; val_auprc_score: 0.9754; val_best_acc_score: 0.9090; val_best_f1_score: 0.9479; train_kl_reg_loss: 175.9538; train_edge_recon_loss: 102375.1367; train_gene_expr_recon_loss: 97348.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199899.1250; train_optim_loss: 199899.1250; val_kl_reg_loss: 162.8405; val_edge_recon_loss: 107005.0781; val_gene_expr_recon_loss: 98498.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205665.9375; val_optim_loss: 205665.9375
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8615; val_auprc_score: 0.9708; val_best_acc_score: 0.9047; val_best_f1_score: 0.9467; train_kl_reg_loss: 230.2517; train_edge_recon_loss: 97282.0859; train_gene_expr_recon_loss: 96170.2214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193682.5573; train_optim_loss: 193682.5573; val_kl_reg_loss: 393.0638; val_edge_recon_loss: 91467.9609; val_gene_expr_recon_loss: 97643.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189504.7188; val_optim_loss: 189504.7188
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8339; val_auprc_score: 0.9619; val_best_acc_score: 0.8912; val_best_f1_score: 0.9400; train_kl_reg_loss: 600.6479; train_edge_recon_loss: 95590.9987; train_gene_expr_recon_loss: 95082.6055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191274.2500; train_optim_loss: 191274.2500; val_kl_reg_loss: 944.6023; val_edge_recon_loss: 92710.7734; val_gene_expr_recon_loss: 96657.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190312.4844; val_optim_loss: 190312.4844
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8314; val_auprc_score: 0.9563; val_best_acc_score: 0.8893; val_best_f1_score: 0.9384; train_kl_reg_loss: 1204.5114; train_edge_recon_loss: 90787.8125; train_gene_expr_recon_loss: 94526.1693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186518.4896; train_optim_loss: 186518.4896; val_kl_reg_loss: 1602.1334; val_edge_recon_loss: 93875.4922; val_gene_expr_recon_loss: 95922.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191400.5938; val_optim_loss: 191400.5938
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8416; val_auprc_score: 0.9599; val_best_acc_score: 0.8910; val_best_f1_score: 0.9394; train_kl_reg_loss: 1835.4586; train_edge_recon_loss: 85387.4714; train_gene_expr_recon_loss: 93723.9049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180946.8333; train_optim_loss: 180946.8333; val_kl_reg_loss: 2137.8877; val_edge_recon_loss: 88166.5234; val_gene_expr_recon_loss: 95511.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185815.6250; val_optim_loss: 185815.6250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8482; val_auprc_score: 0.9661; val_best_acc_score: 0.8987; val_best_f1_score: 0.9436; train_kl_reg_loss: 2257.2682; train_edge_recon_loss: 87072.1341; train_gene_expr_recon_loss: 93233.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182563.3099; train_optim_loss: 182563.3099; val_kl_reg_loss: 2508.2905; val_edge_recon_loss: 85475.9766; val_gene_expr_recon_loss: 95282.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183267.2500; val_optim_loss: 183267.2500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8805; val_auprc_score: 0.9717; val_best_acc_score: 0.9054; val_best_f1_score: 0.9467; train_kl_reg_loss: 2547.0859; train_edge_recon_loss: 84494.5560; train_gene_expr_recon_loss: 93142.2552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180183.9010; train_optim_loss: 180183.9010; val_kl_reg_loss: 2649.1313; val_edge_recon_loss: 81862.3047; val_gene_expr_recon_loss: 94746.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179257.9062; val_optim_loss: 179257.9062
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8782; val_auprc_score: 0.9709; val_best_acc_score: 0.9010; val_best_f1_score: 0.9445; train_kl_reg_loss: 2621.4136; train_edge_recon_loss: 83555.8503; train_gene_expr_recon_loss: 92781.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178959.0182; train_optim_loss: 178959.0182; val_kl_reg_loss: 2525.9517; val_edge_recon_loss: 86232.7188; val_gene_expr_recon_loss: 94366.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183125.0625; val_optim_loss: 183125.0625
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9192; val_auprc_score: 0.9795; val_best_acc_score: 0.9155; val_best_f1_score: 0.9521; train_kl_reg_loss: 2490.7237; train_edge_recon_loss: 80135.7943; train_gene_expr_recon_loss: 92278.7826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174905.3021; train_optim_loss: 174905.3021; val_kl_reg_loss: 2333.7229; val_edge_recon_loss: 82380.1719; val_gene_expr_recon_loss: 94085.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178799.8594; val_optim_loss: 178799.8594
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9049; val_auprc_score: 0.9782; val_best_acc_score: 0.9216; val_best_f1_score: 0.9558; train_kl_reg_loss: 2263.2002; train_edge_recon_loss: 80780.2760; train_gene_expr_recon_loss: 92373.2279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175416.7057; train_optim_loss: 175416.7057; val_kl_reg_loss: 2106.1450; val_edge_recon_loss: 80076.2344; val_gene_expr_recon_loss: 93751.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175934.0938; val_optim_loss: 175934.0938
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9262; val_auprc_score: 0.9827; val_best_acc_score: 0.9340; val_best_f1_score: 0.9623; train_kl_reg_loss: 2077.8332; train_edge_recon_loss: 83602.4375; train_gene_expr_recon_loss: 91776.3594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177456.6250; train_optim_loss: 177456.6250; val_kl_reg_loss: 1999.7950; val_edge_recon_loss: 75779.3125; val_gene_expr_recon_loss: 93490.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171269.9062; val_optim_loss: 171269.9062
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9186; val_auprc_score: 0.9769; val_best_acc_score: 0.9289; val_best_f1_score: 0.9593; train_kl_reg_loss: 2020.7380; train_edge_recon_loss: 79894.7083; train_gene_expr_recon_loss: 91690.7044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173606.1510; train_optim_loss: 173606.1510; val_kl_reg_loss: 1986.8264; val_edge_recon_loss: 81091.6562; val_gene_expr_recon_loss: 93307.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176386.0000; val_optim_loss: 176386.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9332; val_auprc_score: 0.9851; val_best_acc_score: 0.9408; val_best_f1_score: 0.9662; train_kl_reg_loss: 2002.6923; train_edge_recon_loss: 82048.7591; train_gene_expr_recon_loss: 91211.8477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175263.3047; train_optim_loss: 175263.3047; val_kl_reg_loss: 1969.1809; val_edge_recon_loss: 74048.4141; val_gene_expr_recon_loss: 93056.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169073.9688; val_optim_loss: 169073.9688
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9293; val_auprc_score: 0.9727; val_best_acc_score: 0.9383; val_best_f1_score: 0.9641; train_kl_reg_loss: 1994.9164; train_edge_recon_loss: 76226.5417; train_gene_expr_recon_loss: 91010.4648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169231.9271; train_optim_loss: 169231.9271; val_kl_reg_loss: 1964.0343; val_edge_recon_loss: 83082.9141; val_gene_expr_recon_loss: 92852.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177899.7188; val_optim_loss: 177899.7188
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9320; val_auprc_score: 0.9835; val_best_acc_score: 0.9436; val_best_f1_score: 0.9681; train_kl_reg_loss: 1985.6573; train_edge_recon_loss: 78429.2604; train_gene_expr_recon_loss: 90850.6068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171265.5234; train_optim_loss: 171265.5234; val_kl_reg_loss: 1947.4885; val_edge_recon_loss: 74568.1172; val_gene_expr_recon_loss: 92673.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169188.8125; val_optim_loss: 169188.8125
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9467; val_auprc_score: 0.9865; val_best_acc_score: 0.9459; val_best_f1_score: 0.9686; train_kl_reg_loss: 1972.6252; train_edge_recon_loss: 79548.9375; train_gene_expr_recon_loss: 90843.8151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172365.3776; train_optim_loss: 172365.3776; val_kl_reg_loss: 1921.5748; val_edge_recon_loss: 83934.3125; val_gene_expr_recon_loss: 92517.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178373.2812; val_optim_loss: 178373.2812

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9369; val_auprc_score: 0.9842; val_best_acc_score: 0.9431; val_best_f1_score: 0.9672; train_kl_reg_loss: 1955.0953; train_edge_recon_loss: 79292.6966; train_gene_expr_recon_loss: 90508.3021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171756.0938; train_optim_loss: 171756.0938; val_kl_reg_loss: 1931.5966; val_edge_recon_loss: 80402.2188; val_gene_expr_recon_loss: 92482.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174816.5625; val_optim_loss: 174816.5625
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9514; val_auprc_score: 0.9883; val_best_acc_score: 0.9489; val_best_f1_score: 0.9706; train_kl_reg_loss: 1957.6276; train_edge_recon_loss: 80148.1172; train_gene_expr_recon_loss: 90322.6146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172428.3568; train_optim_loss: 172428.3568; val_kl_reg_loss: 1931.6011; val_edge_recon_loss: 75625.4375; val_gene_expr_recon_loss: 92456.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170013.8125; val_optim_loss: 170013.8125
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9353; val_auprc_score: 0.9841; val_best_acc_score: 0.9409; val_best_f1_score: 0.9660; train_kl_reg_loss: 1951.2664; train_edge_recon_loss: 78071.4206; train_gene_expr_recon_loss: 90624.4245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170647.1120; train_optim_loss: 170647.1120; val_kl_reg_loss: 1925.9462; val_edge_recon_loss: 82754.0469; val_gene_expr_recon_loss: 92435.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177115.3281; val_optim_loss: 177115.3281

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 19 sec.
Using best model state, which was in epoch 15.

--- MODEL EVALUATION ---
Val AUROC score: 0.9259
Val AUPRC score: 0.9834
Val best accuracy score: 0.9349
Val best F1 score: 0.9629
Val gene expr MSE score: 1.1103
Duration of model training in run 3: 0 hours, 0 minutes and 20 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 21600
Number of validation edges: 2400
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9699; val_auprc_score: 0.9936; val_best_acc_score: 0.9184; val_best_f1_score: 0.9544; train_kl_reg_loss: 130.7879; train_edge_recon_loss: 101616.0430; train_gene_expr_recon_loss: 124265.5755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226012.4089; train_optim_loss: 226012.4089; val_kl_reg_loss: 321.6243; val_edge_recon_loss: 115595.9766; val_gene_expr_recon_loss: 106854.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222772.2969; val_optim_loss: 222772.2969
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9416; val_auprc_score: 0.9838; val_best_acc_score: 0.9275; val_best_f1_score: 0.9578; train_kl_reg_loss: 303.5658; train_edge_recon_loss: 103504.3464; train_gene_expr_recon_loss: 101197.6068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205005.5182; train_optim_loss: 205005.5182; val_kl_reg_loss: 210.5037; val_edge_recon_loss: 112058.6016; val_gene_expr_recon_loss: 99978.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 212247.3438; val_optim_loss: 212247.3438
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9216; val_auprc_score: 0.9785; val_best_acc_score: 0.9115; val_best_f1_score: 0.9498; train_kl_reg_loss: 177.0358; train_edge_recon_loss: 101364.0677; train_gene_expr_recon_loss: 97621.8294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199162.9349; train_optim_loss: 199162.9349; val_kl_reg_loss: 147.4120; val_edge_recon_loss: 107108.2422; val_gene_expr_recon_loss: 98741.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205997.3281; val_optim_loss: 205997.3281
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8675; val_auprc_score: 0.9692; val_best_acc_score: 0.8959; val_best_f1_score: 0.9415; train_kl_reg_loss: 176.5989; train_edge_recon_loss: 99014.1315; train_gene_expr_recon_loss: 96218.8659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195409.5964; train_optim_loss: 195409.5964; val_kl_reg_loss: 251.2485; val_edge_recon_loss: 100342.8438; val_gene_expr_recon_loss: 97919.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198513.3281; val_optim_loss: 198513.3281
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8093; val_auprc_score: 0.9580; val_best_acc_score: 0.8840; val_best_f1_score: 0.9358; train_kl_reg_loss: 392.4908; train_edge_recon_loss: 97782.0039; train_gene_expr_recon_loss: 95243.3216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193417.8177; train_optim_loss: 193417.8177; val_kl_reg_loss: 627.8606; val_edge_recon_loss: 98668.4609; val_gene_expr_recon_loss: 97153.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196449.8125; val_optim_loss: 196449.8125
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8187; val_auprc_score: 0.9537; val_best_acc_score: 0.8865; val_best_f1_score: 0.9363; train_kl_reg_loss: 890.8479; train_edge_recon_loss: 95500.1914; train_gene_expr_recon_loss: 94955.4714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191346.5104; train_optim_loss: 191346.5104; val_kl_reg_loss: 1251.3022; val_edge_recon_loss: 96475.9453; val_gene_expr_recon_loss: 96565.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194292.5625; val_optim_loss: 194292.5625
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8249; val_auprc_score: 0.9594; val_best_acc_score: 0.8924; val_best_f1_score: 0.9402; train_kl_reg_loss: 1550.4047; train_edge_recon_loss: 90814.5091; train_gene_expr_recon_loss: 94016.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186381.0990; train_optim_loss: 186381.0990; val_kl_reg_loss: 1805.0726; val_edge_recon_loss: 88696.4688; val_gene_expr_recon_loss: 95982.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186483.9375; val_optim_loss: 186483.9375
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8704; val_auprc_score: 0.9717; val_best_acc_score: 0.9029; val_best_f1_score: 0.9461; train_kl_reg_loss: 1953.2306; train_edge_recon_loss: 89192.9180; train_gene_expr_recon_loss: 93798.0495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184944.1953; train_optim_loss: 184944.1953; val_kl_reg_loss: 2057.1660; val_edge_recon_loss: 80202.3438; val_gene_expr_recon_loss: 95659.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177919.2500; val_optim_loss: 177919.2500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8999; val_auprc_score: 0.9788; val_best_acc_score: 0.9005; val_best_f1_score: 0.9439; train_kl_reg_loss: 2226.3273; train_edge_recon_loss: 84461.1211; train_gene_expr_recon_loss: 93291.1133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179978.5625; train_optim_loss: 179978.5625; val_kl_reg_loss: 2334.6853; val_edge_recon_loss: 82882.5781; val_gene_expr_recon_loss: 95348.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180565.2812; val_optim_loss: 180565.2812
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8931; val_auprc_score: 0.9744; val_best_acc_score: 0.9113; val_best_f1_score: 0.9502; train_kl_reg_loss: 2499.4536; train_edge_recon_loss: 81687.3893; train_gene_expr_recon_loss: 93075.9258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177262.7682; train_optim_loss: 177262.7682; val_kl_reg_loss: 2562.2349; val_edge_recon_loss: 80121.9297; val_gene_expr_recon_loss: 94993.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177677.1562; val_optim_loss: 177677.1562
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8981; val_auprc_score: 0.9737; val_best_acc_score: 0.9221; val_best_f1_score: 0.9556; train_kl_reg_loss: 2586.3747; train_edge_recon_loss: 82291.0560; train_gene_expr_recon_loss: 92931.6211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177809.0547; train_optim_loss: 177809.0547; val_kl_reg_loss: 2484.2993; val_edge_recon_loss: 81790.9688; val_gene_expr_recon_loss: 94707.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178983.0000; val_optim_loss: 178983.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9353; val_auprc_score: 0.9862; val_best_acc_score: 0.9368; val_best_f1_score: 0.9641; train_kl_reg_loss: 2407.1886; train_edge_recon_loss: 80789.7917; train_gene_expr_recon_loss: 92526.5534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175723.5339; train_optim_loss: 175723.5339; val_kl_reg_loss: 2229.1821; val_edge_recon_loss: 73393.5859; val_gene_expr_recon_loss: 94462.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170085.4062; val_optim_loss: 170085.4062
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9221; val_auprc_score: 0.9812; val_best_acc_score: 0.9304; val_best_f1_score: 0.9601; train_kl_reg_loss: 2169.9642; train_edge_recon_loss: 78727.4388; train_gene_expr_recon_loss: 92317.2604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173214.6641; train_optim_loss: 173214.6641; val_kl_reg_loss: 2040.4077; val_edge_recon_loss: 82104.7500; val_gene_expr_recon_loss: 94222.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178367.8438; val_optim_loss: 178367.8438
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9231; val_auprc_score: 0.9756; val_best_acc_score: 0.9354; val_best_f1_score: 0.9628; train_kl_reg_loss: 2023.5512; train_edge_recon_loss: 79373.0560; train_gene_expr_recon_loss: 92070.4661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173467.0729; train_optim_loss: 173467.0729; val_kl_reg_loss: 1965.1670; val_edge_recon_loss: 80630.1484; val_gene_expr_recon_loss: 93940.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176536.0312; val_optim_loss: 176536.0312
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9362; val_auprc_score: 0.9852; val_best_acc_score: 0.9390; val_best_f1_score: 0.9652; train_kl_reg_loss: 2001.2775; train_edge_recon_loss: 80987.5078; train_gene_expr_recon_loss: 91669.9206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174658.7005; train_optim_loss: 174658.7005; val_kl_reg_loss: 1996.2415; val_edge_recon_loss: 75338.0781; val_gene_expr_recon_loss: 93694.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171029.1875; val_optim_loss: 171029.1875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9415; val_auprc_score: 0.9862; val_best_acc_score: 0.9351; val_best_f1_score: 0.9623; train_kl_reg_loss: 2016.4665; train_edge_recon_loss: 78379.3385; train_gene_expr_recon_loss: 91402.2786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171798.0859; train_optim_loss: 171798.0859; val_kl_reg_loss: 1994.4041; val_edge_recon_loss: 85640.3594; val_gene_expr_recon_loss: 93666.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181301.4688; val_optim_loss: 181301.4688
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9419; val_auprc_score: 0.9859; val_best_acc_score: 0.9448; val_best_f1_score: 0.9681; train_kl_reg_loss: 2024.5664; train_edge_recon_loss: 77537.5404; train_gene_expr_recon_loss: 91728.4036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171290.5104; train_optim_loss: 171290.5104; val_kl_reg_loss: 1991.7144; val_edge_recon_loss: 78963.4844; val_gene_expr_recon_loss: 93638.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174593.4844; val_optim_loss: 174593.4844
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9348; val_auprc_score: 0.9845; val_best_acc_score: 0.9377; val_best_f1_score: 0.9644; train_kl_reg_loss: 2019.1427; train_edge_recon_loss: 80560.9922; train_gene_expr_recon_loss: 91448.9974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174029.1354; train_optim_loss: 174029.1354; val_kl_reg_loss: 1994.3843; val_edge_recon_loss: 79661.4375; val_gene_expr_recon_loss: 93606.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175262.0312; val_optim_loss: 175262.0312

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 15 sec.
Using best model state, which was in epoch 12.

--- MODEL EVALUATION ---
Val AUROC score: 0.9203
Val AUPRC score: 0.9799
Val best accuracy score: 0.9279
Val best F1 score: 0.9587
Val gene expr MSE score: 1.1603
Duration of model training in run 4: 0 hours, 0 minutes and 16 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 32379
Number of validation edges: 3597
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9381; val_auprc_score: 0.9865; val_best_acc_score: 0.9208; val_best_f1_score: 0.9544; train_kl_reg_loss: 228.8088; train_edge_recon_loss: 102465.6455; train_gene_expr_recon_loss: 108072.3394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210766.7930; train_optim_loss: 210766.7930; val_kl_reg_loss: 181.8093; val_edge_recon_loss: 111386.8555; val_gene_expr_recon_loss: 96958.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208527.5156; val_optim_loss: 208527.5156
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8552; val_auprc_score: 0.9672; val_best_acc_score: 0.8890; val_best_f1_score: 0.9384; train_kl_reg_loss: 330.2427; train_edge_recon_loss: 98398.2993; train_gene_expr_recon_loss: 95438.3193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194166.8613; train_optim_loss: 194166.8613; val_kl_reg_loss: 767.8811; val_edge_recon_loss: 94316.7305; val_gene_expr_recon_loss: 94545.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189629.9766; val_optim_loss: 189629.9766
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8685; val_auprc_score: 0.9714; val_best_acc_score: 0.8975; val_best_f1_score: 0.9425; train_kl_reg_loss: 1389.1046; train_edge_recon_loss: 90580.6055; train_gene_expr_recon_loss: 93271.3350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185241.0439; train_optim_loss: 185241.0439; val_kl_reg_loss: 1682.7073; val_edge_recon_loss: 89560.4570; val_gene_expr_recon_loss: 92746.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183989.7266; val_optim_loss: 183989.7266
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9082; val_auprc_score: 0.9768; val_best_acc_score: 0.9153; val_best_f1_score: 0.9518; train_kl_reg_loss: 1806.2701; train_edge_recon_loss: 85805.0752; train_gene_expr_recon_loss: 92625.9297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180237.2754; train_optim_loss: 180237.2754; val_kl_reg_loss: 2008.8149; val_edge_recon_loss: 84373.1758; val_gene_expr_recon_loss: 92673.3555; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179055.3516; val_optim_loss: 179055.3516
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9316; val_auprc_score: 0.9837; val_best_acc_score: 0.9319; val_best_f1_score: 0.9609; train_kl_reg_loss: 2262.9838; train_edge_recon_loss: 80218.1768; train_gene_expr_recon_loss: 91993.0244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174474.1836; train_optim_loss: 174474.1836; val_kl_reg_loss: 2174.7991; val_edge_recon_loss: 78912.7148; val_gene_expr_recon_loss: 91871.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172959.4219; val_optim_loss: 172959.4219
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9323; val_auprc_score: 0.9810; val_best_acc_score: 0.9413; val_best_f1_score: 0.9665; train_kl_reg_loss: 2020.5484; train_edge_recon_loss: 78936.3110; train_gene_expr_recon_loss: 91423.2124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172380.0713; train_optim_loss: 172380.0713; val_kl_reg_loss: 1849.8781; val_edge_recon_loss: 78315.5312; val_gene_expr_recon_loss: 91233.7852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171399.1953; val_optim_loss: 171399.1953
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9440; val_auprc_score: 0.9833; val_best_acc_score: 0.9449; val_best_f1_score: 0.9680; train_kl_reg_loss: 1933.4197; train_edge_recon_loss: 78749.4873; train_gene_expr_recon_loss: 90723.4653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171406.3750; train_optim_loss: 171406.3750; val_kl_reg_loss: 1935.6872; val_edge_recon_loss: 82098.3633; val_gene_expr_recon_loss: 90611.8477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174645.8906; val_optim_loss: 174645.8906
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9503; val_auprc_score: 0.9870; val_best_acc_score: 0.9522; val_best_f1_score: 0.9725; train_kl_reg_loss: 1926.6089; train_edge_recon_loss: 79054.6748; train_gene_expr_recon_loss: 90326.0923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171307.3779; train_optim_loss: 171307.3779; val_kl_reg_loss: 1828.3013; val_edge_recon_loss: 75903.0625; val_gene_expr_recon_loss: 89894.2773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167625.6406; val_optim_loss: 167625.6406
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9542; val_auprc_score: 0.9878; val_best_acc_score: 0.9528; val_best_f1_score: 0.9729; train_kl_reg_loss: 1894.4364; train_edge_recon_loss: 78498.6196; train_gene_expr_recon_loss: 90029.5698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170422.6250; train_optim_loss: 170422.6250; val_kl_reg_loss: 1890.4620; val_edge_recon_loss: 76481.8242; val_gene_expr_recon_loss: 90947.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169319.8906; val_optim_loss: 169319.8906
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9543; val_auprc_score: 0.9884; val_best_acc_score: 0.9558; val_best_f1_score: 0.9744; train_kl_reg_loss: 1893.7394; train_edge_recon_loss: 80885.3975; train_gene_expr_recon_loss: 89593.8857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172373.0234; train_optim_loss: 172373.0234; val_kl_reg_loss: 1822.8285; val_edge_recon_loss: 78230.3242; val_gene_expr_recon_loss: 90190.3398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170243.4922; val_optim_loss: 170243.4922
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9447; val_auprc_score: 0.9824; val_best_acc_score: 0.9499; val_best_f1_score: 0.9711; train_kl_reg_loss: 1889.4397; train_edge_recon_loss: 77445.7676; train_gene_expr_recon_loss: 89401.5444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168736.7500; train_optim_loss: 168736.7500; val_kl_reg_loss: 1899.0844; val_edge_recon_loss: 78524.8555; val_gene_expr_recon_loss: 90623.4492; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171047.3828; val_optim_loss: 171047.3828

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9526; val_auprc_score: 0.9863; val_best_acc_score: 0.9543; val_best_f1_score: 0.9739; train_kl_reg_loss: 1928.4283; train_edge_recon_loss: 78090.5596; train_gene_expr_recon_loss: 89109.3369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169128.3252; train_optim_loss: 169128.3252; val_kl_reg_loss: 1882.9188; val_edge_recon_loss: 74672.6484; val_gene_expr_recon_loss: 89632.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166187.8750; val_optim_loss: 166187.8750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9566; val_auprc_score: 0.9895; val_best_acc_score: 0.9600; val_best_f1_score: 0.9769; train_kl_reg_loss: 1920.9602; train_edge_recon_loss: 79688.5386; train_gene_expr_recon_loss: 89157.3213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170766.8213; train_optim_loss: 170766.8213; val_kl_reg_loss: 1876.2512; val_edge_recon_loss: 74788.0781; val_gene_expr_recon_loss: 90305.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166969.8516; val_optim_loss: 166969.8516
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9532; val_auprc_score: 0.9881; val_best_acc_score: 0.9507; val_best_f1_score: 0.9717; train_kl_reg_loss: 1906.9626; train_edge_recon_loss: 77434.3955; train_gene_expr_recon_loss: 89052.7280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168394.0869; train_optim_loss: 168394.0869; val_kl_reg_loss: 1870.6439; val_edge_recon_loss: 78862.7852; val_gene_expr_recon_loss: 89520.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170253.4844; val_optim_loss: 170253.4844
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9540; val_auprc_score: 0.9860; val_best_acc_score: 0.9526; val_best_f1_score: 0.9726; train_kl_reg_loss: 1901.4790; train_edge_recon_loss: 78719.4902; train_gene_expr_recon_loss: 89134.9839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169755.9512; train_optim_loss: 169755.9512; val_kl_reg_loss: 1863.1122; val_edge_recon_loss: 80814.9609; val_gene_expr_recon_loss: 89727.4570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172405.5312; val_optim_loss: 172405.5312

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9460; val_auprc_score: 0.9844; val_best_acc_score: 0.9501; val_best_f1_score: 0.9713; train_kl_reg_loss: 1906.2771; train_edge_recon_loss: 78287.6748; train_gene_expr_recon_loss: 88707.0576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168901.0098; train_optim_loss: 168901.0098; val_kl_reg_loss: 1865.8643; val_edge_recon_loss: 80278.3398; val_gene_expr_recon_loss: 89538.5820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171682.7812; val_optim_loss: 171682.7812
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9570; val_auprc_score: 0.9883; val_best_acc_score: 0.9533; val_best_f1_score: 0.9730; train_kl_reg_loss: 1904.7963; train_edge_recon_loss: 78644.1011; train_gene_expr_recon_loss: 88814.2993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169363.1963; train_optim_loss: 169363.1963; val_kl_reg_loss: 1875.1960; val_edge_recon_loss: 80471.9180; val_gene_expr_recon_loss: 89695.8945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172043.0078; val_optim_loss: 172043.0078
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9528; val_auprc_score: 0.9878; val_best_acc_score: 0.9514; val_best_f1_score: 0.9721; train_kl_reg_loss: 1904.5167; train_edge_recon_loss: 78054.4829; train_gene_expr_recon_loss: 88992.6147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168951.6143; train_optim_loss: 168951.6143; val_kl_reg_loss: 1873.0721; val_edge_recon_loss: 78714.0977; val_gene_expr_recon_loss: 89598.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170185.6719; val_optim_loss: 170185.6719

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 27 sec.
Using best model state, which was in epoch 12.

--- MODEL EVALUATION ---
Val AUROC score: 0.9649
Val AUPRC score: 0.9920
Val best accuracy score: 0.9551
Val best F1 score: 0.9742
Val gene expr MSE score: 0.9655
Duration of model training in run 5: 0 hours, 0 minutes and 28 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 32379
Number of validation edges: 3597
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9483; val_auprc_score: 0.9878; val_best_acc_score: 0.9291; val_best_f1_score: 0.9588; train_kl_reg_loss: 212.3220; train_edge_recon_loss: 102291.0229; train_gene_expr_recon_loss: 108830.6182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211333.9619; train_optim_loss: 211333.9619; val_kl_reg_loss: 164.1231; val_edge_recon_loss: 114464.7383; val_gene_expr_recon_loss: 96618.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211247.6406; val_optim_loss: 211247.6406
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8478; val_auprc_score: 0.9646; val_best_acc_score: 0.8889; val_best_f1_score: 0.9384; train_kl_reg_loss: 274.1423; train_edge_recon_loss: 101556.3530; train_gene_expr_recon_loss: 95491.1914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197321.6885; train_optim_loss: 197321.6885; val_kl_reg_loss: 692.1803; val_edge_recon_loss: 97756.4336; val_gene_expr_recon_loss: 94564.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193013.5781; val_optim_loss: 193013.5781
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8452; val_auprc_score: 0.9631; val_best_acc_score: 0.8999; val_best_f1_score: 0.9443; train_kl_reg_loss: 1317.5116; train_edge_recon_loss: 92913.9419; train_gene_expr_recon_loss: 93477.5244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187708.9775; train_optim_loss: 187708.9775; val_kl_reg_loss: 1842.9011; val_edge_recon_loss: 85990.2031; val_gene_expr_recon_loss: 93624.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181457.3281; val_optim_loss: 181457.3281
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8950; val_auprc_score: 0.9752; val_best_acc_score: 0.9178; val_best_f1_score: 0.9536; train_kl_reg_loss: 1993.0746; train_edge_recon_loss: 86276.9243; train_gene_expr_recon_loss: 92605.2817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180875.2832; train_optim_loss: 180875.2832; val_kl_reg_loss: 2109.6893; val_edge_recon_loss: 78641.9141; val_gene_expr_recon_loss: 93431.8633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174183.4688; val_optim_loss: 174183.4688
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9175; val_auprc_score: 0.9797; val_best_acc_score: 0.9278; val_best_f1_score: 0.9586; train_kl_reg_loss: 2269.6821; train_edge_recon_loss: 81489.1694; train_gene_expr_recon_loss: 92056.9927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175815.8457; train_optim_loss: 175815.8457; val_kl_reg_loss: 2246.9700; val_edge_recon_loss: 78577.6445; val_gene_expr_recon_loss: 92057.6289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172882.2422; val_optim_loss: 172882.2422
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9393; val_auprc_score: 0.9873; val_best_acc_score: 0.9430; val_best_f1_score: 0.9674; train_kl_reg_loss: 2075.5919; train_edge_recon_loss: 79406.5962; train_gene_expr_recon_loss: 91266.3174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172748.5068; train_optim_loss: 172748.5068; val_kl_reg_loss: 1938.5978; val_edge_recon_loss: 76835.6914; val_gene_expr_recon_loss: 91365.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170140.2812; val_optim_loss: 170140.2812
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9360; val_auprc_score: 0.9836; val_best_acc_score: 0.9457; val_best_f1_score: 0.9688; train_kl_reg_loss: 1984.2416; train_edge_recon_loss: 81564.2305; train_gene_expr_recon_loss: 90764.7524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174313.2236; train_optim_loss: 174313.2236; val_kl_reg_loss: 1960.2244; val_edge_recon_loss: 79548.2617; val_gene_expr_recon_loss: 91101.5586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172610.0469; val_optim_loss: 172610.0469
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9443; val_auprc_score: 0.9833; val_best_acc_score: 0.9485; val_best_f1_score: 0.9702; train_kl_reg_loss: 1926.3611; train_edge_recon_loss: 79046.4985; train_gene_expr_recon_loss: 90068.8218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171041.6816; train_optim_loss: 171041.6816; val_kl_reg_loss: 1915.4509; val_edge_recon_loss: 80516.1953; val_gene_expr_recon_loss: 91284.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173716.1484; val_optim_loss: 173716.1484
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9549; val_auprc_score: 0.9862; val_best_acc_score: 0.9515; val_best_f1_score: 0.9717; train_kl_reg_loss: 1946.6299; train_edge_recon_loss: 78102.7358; train_gene_expr_recon_loss: 89952.8584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170002.2256; train_optim_loss: 170002.2256; val_kl_reg_loss: 1903.3506; val_edge_recon_loss: 83841.3789; val_gene_expr_recon_loss: 90303.0273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176047.7578; val_optim_loss: 176047.7578

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9536; val_auprc_score: 0.9893; val_best_acc_score: 0.9548; val_best_f1_score: 0.9739; train_kl_reg_loss: 1920.1986; train_edge_recon_loss: 79944.3506; train_gene_expr_recon_loss: 89986.8364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171851.3857; train_optim_loss: 171851.3857; val_kl_reg_loss: 1901.3186; val_edge_recon_loss: 78770.7539; val_gene_expr_recon_loss: 90317.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170989.9297; val_optim_loss: 170989.9297
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9403; val_auprc_score: 0.9831; val_best_acc_score: 0.9479; val_best_f1_score: 0.9702; train_kl_reg_loss: 1921.8167; train_edge_recon_loss: 78949.7183; train_gene_expr_recon_loss: 89661.5400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170533.0723; train_optim_loss: 170533.0723; val_kl_reg_loss: 1905.0357; val_edge_recon_loss: 79388.8086; val_gene_expr_recon_loss: 90774.0352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172067.8750; val_optim_loss: 172067.8750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9496; val_auprc_score: 0.9848; val_best_acc_score: 0.9562; val_best_f1_score: 0.9747; train_kl_reg_loss: 1914.0775; train_edge_recon_loss: 78711.3096; train_gene_expr_recon_loss: 89547.4272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170172.8115; train_optim_loss: 170172.8115; val_kl_reg_loss: 1880.0399; val_edge_recon_loss: 79427.4570; val_gene_expr_recon_loss: 89921.4414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171228.9375; val_optim_loss: 171228.9375

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 19 sec.
Using best model state, which was in epoch 6.

--- MODEL EVALUATION ---
Val AUROC score: 0.9397
Val AUPRC score: 0.9839
Val best accuracy score: 0.9448
Val best F1 score: 0.9682
Val gene expr MSE score: 1.1577
Duration of model training in run 6: 0 hours, 0 minutes and 21 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 43113
Number of validation edges: 4790
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8523; val_auprc_score: 0.9684; val_best_acc_score: 0.8947; val_best_f1_score: 0.9417; train_kl_reg_loss: 311.6653; train_edge_recon_loss: 101661.0294; train_gene_expr_recon_loss: 99722.0238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201694.7177; train_optim_loss: 201694.7177; val_kl_reg_loss: 940.1865; val_edge_recon_loss: 91876.2109; val_gene_expr_recon_loss: 93444.5875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186260.9844; val_optim_loss: 186260.9844
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8948; val_auprc_score: 0.9746; val_best_acc_score: 0.9103; val_best_f1_score: 0.9496; train_kl_reg_loss: 1655.6427; train_edge_recon_loss: 88234.2326; train_gene_expr_recon_loss: 92183.7033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182073.5792; train_optim_loss: 182073.5792; val_kl_reg_loss: 2191.5214; val_edge_recon_loss: 84240.8203; val_gene_expr_recon_loss: 91650.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178082.5125; val_optim_loss: 178082.5125
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9369; val_auprc_score: 0.9819; val_best_acc_score: 0.9387; val_best_f1_score: 0.9648; train_kl_reg_loss: 2021.9921; train_edge_recon_loss: 80793.5071; train_gene_expr_recon_loss: 90936.3374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173751.8358; train_optim_loss: 173751.8358; val_kl_reg_loss: 1903.3845; val_edge_recon_loss: 82595.7359; val_gene_expr_recon_loss: 90938.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175438.0750; val_optim_loss: 175438.0750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9500; val_auprc_score: 0.9875; val_best_acc_score: 0.9474; val_best_f1_score: 0.9697; train_kl_reg_loss: 1895.6985; train_edge_recon_loss: 78990.3290; train_gene_expr_recon_loss: 89795.6475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170681.6755; train_optim_loss: 170681.6755; val_kl_reg_loss: 1975.5125; val_edge_recon_loss: 78609.1656; val_gene_expr_recon_loss: 89825.4359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170410.1094; val_optim_loss: 170410.1094
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9521; val_auprc_score: 0.9865; val_best_acc_score: 0.9545; val_best_f1_score: 0.9740; train_kl_reg_loss: 1905.9835; train_edge_recon_loss: 79558.6226; train_gene_expr_recon_loss: 89071.4629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170536.0687; train_optim_loss: 170536.0687; val_kl_reg_loss: 1901.7054; val_edge_recon_loss: 74649.2500; val_gene_expr_recon_loss: 88943.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165494.0125; val_optim_loss: 165494.0125
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9551; val_auprc_score: 0.9879; val_best_acc_score: 0.9571; val_best_f1_score: 0.9752; train_kl_reg_loss: 1877.6427; train_edge_recon_loss: 79553.8875; train_gene_expr_recon_loss: 88604.2622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170035.7918; train_optim_loss: 170035.7918; val_kl_reg_loss: 1841.0075; val_edge_recon_loss: 76303.4953; val_gene_expr_recon_loss: 88659.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166804.1969; val_optim_loss: 166804.1969
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9470; val_auprc_score: 0.9843; val_best_acc_score: 0.9545; val_best_f1_score: 0.9738; train_kl_reg_loss: 1862.6746; train_edge_recon_loss: 76081.1339; train_gene_expr_recon_loss: 88202.4455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166146.2547; train_optim_loss: 166146.2547; val_kl_reg_loss: 1860.4940; val_edge_recon_loss: 77552.0266; val_gene_expr_recon_loss: 88208.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167620.7062; val_optim_loss: 167620.7062
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9531; val_auprc_score: 0.9851; val_best_acc_score: 0.9571; val_best_f1_score: 0.9754; train_kl_reg_loss: 1855.8921; train_edge_recon_loss: 78834.8755; train_gene_expr_recon_loss: 87933.1535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168623.9215; train_optim_loss: 168623.9215; val_kl_reg_loss: 1856.5635; val_edge_recon_loss: 76992.9438; val_gene_expr_recon_loss: 88423.8453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167273.3531; val_optim_loss: 167273.3531

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9563; val_auprc_score: 0.9856; val_best_acc_score: 0.9587; val_best_f1_score: 0.9762; train_kl_reg_loss: 1856.7831; train_edge_recon_loss: 79532.5289; train_gene_expr_recon_loss: 87426.8305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168816.1424; train_optim_loss: 168816.1424; val_kl_reg_loss: 1854.2376; val_edge_recon_loss: 77387.7609; val_gene_expr_recon_loss: 87612.1859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166854.1812; val_optim_loss: 166854.1812
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9551; val_auprc_score: 0.9880; val_best_acc_score: 0.9563; val_best_f1_score: 0.9748; train_kl_reg_loss: 1872.5441; train_edge_recon_loss: 78079.8857; train_gene_expr_recon_loss: 87023.3023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166975.7333; train_optim_loss: 166975.7333; val_kl_reg_loss: 1869.7396; val_edge_recon_loss: 79813.0813; val_gene_expr_recon_loss: 87448.8188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169131.6437; val_optim_loss: 169131.6437
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9660; val_auprc_score: 0.9911; val_best_acc_score: 0.9633; val_best_f1_score: 0.9791; train_kl_reg_loss: 1870.4992; train_edge_recon_loss: 77874.9598; train_gene_expr_recon_loss: 87160.8972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166906.3550; train_optim_loss: 166906.3550; val_kl_reg_loss: 1864.6625; val_edge_recon_loss: 73129.0094; val_gene_expr_recon_loss: 87440.2688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162433.9438; val_optim_loss: 162433.9438
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9623; val_auprc_score: 0.9895; val_best_acc_score: 0.9608; val_best_f1_score: 0.9773; train_kl_reg_loss: 1864.4896; train_edge_recon_loss: 78368.2243; train_gene_expr_recon_loss: 87124.3837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167357.0959; train_optim_loss: 167357.0959; val_kl_reg_loss: 1846.0326; val_edge_recon_loss: 77929.7266; val_gene_expr_recon_loss: 87570.4812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167346.2344; val_optim_loss: 167346.2344
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9620; val_auprc_score: 0.9875; val_best_acc_score: 0.9607; val_best_f1_score: 0.9771; train_kl_reg_loss: 1847.9712; train_edge_recon_loss: 78573.6232; train_gene_expr_recon_loss: 87038.0718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167459.6653; train_optim_loss: 167459.6653; val_kl_reg_loss: 1857.1209; val_edge_recon_loss: 79185.1344; val_gene_expr_recon_loss: 87433.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168475.5906; val_optim_loss: 168475.5906
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9640; val_auprc_score: 0.9911; val_best_acc_score: 0.9622; val_best_f1_score: 0.9782; train_kl_reg_loss: 1852.3929; train_edge_recon_loss: 78353.5836; train_gene_expr_recon_loss: 86945.7420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167151.7188; train_optim_loss: 167151.7188; val_kl_reg_loss: 1837.7648; val_edge_recon_loss: 76776.2531; val_gene_expr_recon_loss: 87360.5031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165974.5187; val_optim_loss: 165974.5187

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9586; val_auprc_score: 0.9884; val_best_acc_score: 0.9591; val_best_f1_score: 0.9763; train_kl_reg_loss: 1841.1322; train_edge_recon_loss: 78314.5416; train_gene_expr_recon_loss: 87060.7373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167216.4121; train_optim_loss: 167216.4121; val_kl_reg_loss: 1844.5257; val_edge_recon_loss: 79051.0172; val_gene_expr_recon_loss: 87244.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168140.5187; val_optim_loss: 168140.5187
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9589; val_auprc_score: 0.9868; val_best_acc_score: 0.9595; val_best_f1_score: 0.9764; train_kl_reg_loss: 1844.8950; train_edge_recon_loss: 77561.7634; train_gene_expr_recon_loss: 87064.8848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166471.5436; train_optim_loss: 166471.5436; val_kl_reg_loss: 1845.8361; val_edge_recon_loss: 81799.7406; val_gene_expr_recon_loss: 86890.1844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170535.7625; val_optim_loss: 170535.7625
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9631; val_auprc_score: 0.9896; val_best_acc_score: 0.9601; val_best_f1_score: 0.9769; train_kl_reg_loss: 1846.5864; train_edge_recon_loss: 78605.6140; train_gene_expr_recon_loss: 86989.1432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167441.3441; train_optim_loss: 167441.3441; val_kl_reg_loss: 1842.8225; val_edge_recon_loss: 79614.8828; val_gene_expr_recon_loss: 86840.1156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168297.8188; val_optim_loss: 168297.8188

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 45 sec.
Using best model state, which was in epoch 11.

--- MODEL EVALUATION ---
Val AUROC score: 0.9659
Val AUPRC score: 0.9922
Val best accuracy score: 0.9584
Val best F1 score: 0.9760
Val gene expr MSE score: 0.9726
Duration of model training in run 7: 0 hours, 0 minutes and 47 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 43113
Number of validation edges: 4790
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8392; val_auprc_score: 0.9628; val_best_acc_score: 0.8919; val_best_f1_score: 0.9398; train_kl_reg_loss: 329.6281; train_edge_recon_loss: 98642.3636; train_gene_expr_recon_loss: 99622.3003; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198594.2929; train_optim_loss: 198594.2929; val_kl_reg_loss: 1085.8738; val_edge_recon_loss: 91010.8484; val_gene_expr_recon_loss: 92169.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184265.9594; val_optim_loss: 184265.9594
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9098; val_auprc_score: 0.9784; val_best_acc_score: 0.9240; val_best_f1_score: 0.9568; train_kl_reg_loss: 1814.9469; train_edge_recon_loss: 86152.1688; train_gene_expr_recon_loss: 92054.9164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180022.0327; train_optim_loss: 180022.0327; val_kl_reg_loss: 2376.2060; val_edge_recon_loss: 79668.1578; val_gene_expr_recon_loss: 90705.7781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172750.1406; val_optim_loss: 172750.1406
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9365; val_auprc_score: 0.9846; val_best_acc_score: 0.9463; val_best_f1_score: 0.9691; train_kl_reg_loss: 2051.1688; train_edge_recon_loss: 79752.0778; train_gene_expr_recon_loss: 90890.2714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172693.5178; train_optim_loss: 172693.5178; val_kl_reg_loss: 1925.6684; val_edge_recon_loss: 78081.6359; val_gene_expr_recon_loss: 89831.5672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169838.8687; val_optim_loss: 169838.8687
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9456; val_auprc_score: 0.9862; val_best_acc_score: 0.9482; val_best_f1_score: 0.9701; train_kl_reg_loss: 1890.9768; train_edge_recon_loss: 79499.7742; train_gene_expr_recon_loss: 89809.1125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171199.8637; train_optim_loss: 171199.8637; val_kl_reg_loss: 1863.5327; val_edge_recon_loss: 79640.5953; val_gene_expr_recon_loss: 89151.2844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170655.4125; val_optim_loss: 170655.4125
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9451; val_auprc_score: 0.9836; val_best_acc_score: 0.9503; val_best_f1_score: 0.9714; train_kl_reg_loss: 1895.6228; train_edge_recon_loss: 79158.2384; train_gene_expr_recon_loss: 89225.0256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170278.8877; train_optim_loss: 170278.8877; val_kl_reg_loss: 1895.8626; val_edge_recon_loss: 80802.5188; val_gene_expr_recon_loss: 88261.7281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170960.1094; val_optim_loss: 170960.1094
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9649; val_auprc_score: 0.9918; val_best_acc_score: 0.9596; val_best_f1_score: 0.9768; train_kl_reg_loss: 1887.8627; train_edge_recon_loss: 77672.4847; train_gene_expr_recon_loss: 88670.4301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168230.7769; train_optim_loss: 168230.7769; val_kl_reg_loss: 1950.1004; val_edge_recon_loss: 77281.8687; val_gene_expr_recon_loss: 87937.9469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167169.9156; val_optim_loss: 167169.9156
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9615; val_auprc_score: 0.9894; val_best_acc_score: 0.9565; val_best_f1_score: 0.9750; train_kl_reg_loss: 1872.9487; train_edge_recon_loss: 80365.9682; train_gene_expr_recon_loss: 88113.7560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170352.6733; train_optim_loss: 170352.6733; val_kl_reg_loss: 1855.6627; val_edge_recon_loss: 79593.2437; val_gene_expr_recon_loss: 87593.6609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169042.5625; val_optim_loss: 169042.5625
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9600; val_auprc_score: 0.9883; val_best_acc_score: 0.9589; val_best_f1_score: 0.9762; train_kl_reg_loss: 1874.7424; train_edge_recon_loss: 77466.9782; train_gene_expr_recon_loss: 87894.0750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167235.7947; train_optim_loss: 167235.7947; val_kl_reg_loss: 1807.8877; val_edge_recon_loss: 80102.8375; val_gene_expr_recon_loss: 87500.9500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169411.6781; val_optim_loss: 169411.6781
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9620; val_auprc_score: 0.9903; val_best_acc_score: 0.9636; val_best_f1_score: 0.9789; train_kl_reg_loss: 1866.6361; train_edge_recon_loss: 78404.3797; train_gene_expr_recon_loss: 87541.0841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167812.1021; train_optim_loss: 167812.1021; val_kl_reg_loss: 1821.0690; val_edge_recon_loss: 79148.1641; val_gene_expr_recon_loss: 86493.5641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167462.7969; val_optim_loss: 167462.7969

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9704; val_auprc_score: 0.9934; val_best_acc_score: 0.9643; val_best_f1_score: 0.9795; train_kl_reg_loss: 1838.8845; train_edge_recon_loss: 79035.5838; train_gene_expr_recon_loss: 86954.6128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167829.0814; train_optim_loss: 167829.0814; val_kl_reg_loss: 1826.3839; val_edge_recon_loss: 74865.8188; val_gene_expr_recon_loss: 86764.3562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163456.5625; val_optim_loss: 163456.5625
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9627; val_auprc_score: 0.9889; val_best_acc_score: 0.9668; val_best_f1_score: 0.9807; train_kl_reg_loss: 1847.6360; train_edge_recon_loss: 78008.8358; train_gene_expr_recon_loss: 86733.6619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166590.1355; train_optim_loss: 166590.1355; val_kl_reg_loss: 1836.9104; val_edge_recon_loss: 77760.8609; val_gene_expr_recon_loss: 86486.0172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166083.7906; val_optim_loss: 166083.7906
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9568; val_auprc_score: 0.9857; val_best_acc_score: 0.9607; val_best_f1_score: 0.9773; train_kl_reg_loss: 1857.9739; train_edge_recon_loss: 78549.8205; train_gene_expr_recon_loss: 86802.1334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167209.9284; train_optim_loss: 167209.9284; val_kl_reg_loss: 1841.1458; val_edge_recon_loss: 79852.8156; val_gene_expr_recon_loss: 86946.5250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168640.4875; val_optim_loss: 168640.4875
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9527; val_auprc_score: 0.9845; val_best_acc_score: 0.9605; val_best_f1_score: 0.9773; train_kl_reg_loss: 1853.5279; train_edge_recon_loss: 77968.8201; train_gene_expr_recon_loss: 86834.0750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166656.4230; train_optim_loss: 166656.4230; val_kl_reg_loss: 1827.7514; val_edge_recon_loss: 78983.3516; val_gene_expr_recon_loss: 86464.0250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167275.1313; val_optim_loss: 167275.1313

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9622; val_auprc_score: 0.9910; val_best_acc_score: 0.9652; val_best_f1_score: 0.9800; train_kl_reg_loss: 1846.5477; train_edge_recon_loss: 78712.0276; train_gene_expr_recon_loss: 86738.0694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167296.6450; train_optim_loss: 167296.6450; val_kl_reg_loss: 1831.7968; val_edge_recon_loss: 76358.6469; val_gene_expr_recon_loss: 86761.1359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164951.5781; val_optim_loss: 164951.5781
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9626; val_auprc_score: 0.9881; val_best_acc_score: 0.9676; val_best_f1_score: 0.9814; train_kl_reg_loss: 1847.8011; train_edge_recon_loss: 78147.6176; train_gene_expr_recon_loss: 86790.2429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166785.6621; train_optim_loss: 166785.6621; val_kl_reg_loss: 1828.1387; val_edge_recon_loss: 74159.9625; val_gene_expr_recon_loss: 86262.8734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162250.9781; val_optim_loss: 162250.9781
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9567; val_auprc_score: 0.9875; val_best_acc_score: 0.9641; val_best_f1_score: 0.9794; train_kl_reg_loss: 1847.1051; train_edge_recon_loss: 77629.2020; train_gene_expr_recon_loss: 86684.5492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166160.8561; train_optim_loss: 166160.8561; val_kl_reg_loss: 1836.1932; val_edge_recon_loss: 77656.1328; val_gene_expr_recon_loss: 86019.3641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165511.6906; val_optim_loss: 165511.6906
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9666; val_auprc_score: 0.9897; val_best_acc_score: 0.9646; val_best_f1_score: 0.9795; train_kl_reg_loss: 1850.1326; train_edge_recon_loss: 77535.5251; train_gene_expr_recon_loss: 86815.7943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166201.4542; train_optim_loss: 166201.4542; val_kl_reg_loss: 1834.2368; val_edge_recon_loss: 80134.9563; val_gene_expr_recon_loss: 86512.5656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168481.7594; val_optim_loss: 168481.7594
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9605; val_auprc_score: 0.9897; val_best_acc_score: 0.9599; val_best_f1_score: 0.9769; train_kl_reg_loss: 1847.2677; train_edge_recon_loss: 79063.9891; train_gene_expr_recon_loss: 86561.5205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167472.7758; train_optim_loss: 167472.7758; val_kl_reg_loss: 1829.9406; val_edge_recon_loss: 80347.6703; val_gene_expr_recon_loss: 87165.9344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169343.5438; val_optim_loss: 169343.5438

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9628; val_auprc_score: 0.9899; val_best_acc_score: 0.9642; val_best_f1_score: 0.9794; train_kl_reg_loss: 1848.5708; train_edge_recon_loss: 78082.4911; train_gene_expr_recon_loss: 86751.5425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166682.6025; train_optim_loss: 166682.6025; val_kl_reg_loss: 1832.6274; val_edge_recon_loss: 76811.5828; val_gene_expr_recon_loss: 86466.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165110.7625; val_optim_loss: 165110.7625
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9652; val_auprc_score: 0.9902; val_best_acc_score: 0.9634; val_best_f1_score: 0.9789; train_kl_reg_loss: 1846.0181; train_edge_recon_loss: 76965.5420; train_gene_expr_recon_loss: 86776.3585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165587.9179; train_optim_loss: 165587.9179; val_kl_reg_loss: 1831.1271; val_edge_recon_loss: 78623.0547; val_gene_expr_recon_loss: 86542.9937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166997.1781; val_optim_loss: 166997.1781
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9642; val_auprc_score: 0.9910; val_best_acc_score: 0.9655; val_best_f1_score: 0.9802; train_kl_reg_loss: 1846.4511; train_edge_recon_loss: 79564.8214; train_gene_expr_recon_loss: 86755.7106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168166.9833; train_optim_loss: 168166.9833; val_kl_reg_loss: 1829.7653; val_edge_recon_loss: 75837.4578; val_gene_expr_recon_loss: 86774.6344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164441.8594; val_optim_loss: 164441.8594

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 55 sec.
Using best model state, which was in epoch 15.

--- MODEL EVALUATION ---
Val AUROC score: 0.9711
Val AUPRC score: 0.9929
Val best accuracy score: 0.9656
Val best F1 score: 0.9802
Val gene expr MSE score: 0.9122
Duration of model training in run 8: 0 hours, 0 minutes and 57 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 53901
Number of validation edges: 5988
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8576; val_auprc_score: 0.9662; val_best_acc_score: 0.8981; val_best_f1_score: 0.9430; train_kl_reg_loss: 571.4383; train_edge_recon_loss: 98320.3446; train_gene_expr_recon_loss: 99056.8865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197948.6686; train_optim_loss: 197948.6686; val_kl_reg_loss: 1784.0263; val_edge_recon_loss: 89821.0729; val_gene_expr_recon_loss: 92738.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184343.1432; val_optim_loss: 184343.1432
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9293; val_auprc_score: 0.9813; val_best_acc_score: 0.9343; val_best_f1_score: 0.9627; train_kl_reg_loss: 1960.4935; train_edge_recon_loss: 84135.8635; train_gene_expr_recon_loss: 91495.8343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177592.1910; train_optim_loss: 177592.1910; val_kl_reg_loss: 1918.8699; val_edge_recon_loss: 79296.9688; val_gene_expr_recon_loss: 91153.1276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172368.9635; val_optim_loss: 172368.9635
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9444; val_auprc_score: 0.9835; val_best_acc_score: 0.9515; val_best_f1_score: 0.9721; train_kl_reg_loss: 1878.5010; train_edge_recon_loss: 79749.7491; train_gene_expr_recon_loss: 89975.4959; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171603.7453; train_optim_loss: 171603.7453; val_kl_reg_loss: 1813.0785; val_edge_recon_loss: 78916.2552; val_gene_expr_recon_loss: 89319.5365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170048.8672; val_optim_loss: 170048.8672
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9523; val_auprc_score: 0.9875; val_best_acc_score: 0.9542; val_best_f1_score: 0.9735; train_kl_reg_loss: 1848.0740; train_edge_recon_loss: 78685.4519; train_gene_expr_recon_loss: 89191.8264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169725.3514; train_optim_loss: 169725.3514; val_kl_reg_loss: 1794.6372; val_edge_recon_loss: 81047.4805; val_gene_expr_recon_loss: 88912.2747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171754.3932; val_optim_loss: 171754.3932
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9546; val_auprc_score: 0.9873; val_best_acc_score: 0.9612; val_best_f1_score: 0.9777; train_kl_reg_loss: 1822.6126; train_edge_recon_loss: 78709.0220; train_gene_expr_recon_loss: 88215.7818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168747.4163; train_optim_loss: 168747.4163; val_kl_reg_loss: 1847.1613; val_edge_recon_loss: 76934.5749; val_gene_expr_recon_loss: 88164.5820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166946.3177; val_optim_loss: 166946.3177
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9562; val_auprc_score: 0.9862; val_best_acc_score: 0.9574; val_best_f1_score: 0.9753; train_kl_reg_loss: 1841.9876; train_edge_recon_loss: 79215.9705; train_gene_expr_recon_loss: 87817.7269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168875.6848; train_optim_loss: 168875.6848; val_kl_reg_loss: 1798.3699; val_edge_recon_loss: 80582.5456; val_gene_expr_recon_loss: 88398.0977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170779.0156; val_optim_loss: 170779.0156
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9556; val_auprc_score: 0.9858; val_best_acc_score: 0.9587; val_best_f1_score: 0.9763; train_kl_reg_loss: 1839.8719; train_edge_recon_loss: 79047.3572; train_gene_expr_recon_loss: 87482.1585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168369.3886; train_optim_loss: 168369.3886; val_kl_reg_loss: 1755.2397; val_edge_recon_loss: 77569.2799; val_gene_expr_recon_loss: 87281.8711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166606.3932; val_optim_loss: 166606.3932
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9561; val_auprc_score: 0.9876; val_best_acc_score: 0.9636; val_best_f1_score: 0.9789; train_kl_reg_loss: 1873.4056; train_edge_recon_loss: 77737.0531; train_gene_expr_recon_loss: 86969.7874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166580.2462; train_optim_loss: 166580.2462; val_kl_reg_loss: 1805.3054; val_edge_recon_loss: 77724.0599; val_gene_expr_recon_loss: 87509.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167038.4740; val_optim_loss: 167038.4740
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9583; val_auprc_score: 0.9874; val_best_acc_score: 0.9652; val_best_f1_score: 0.9800; train_kl_reg_loss: 1841.4486; train_edge_recon_loss: 77233.2843; train_gene_expr_recon_loss: 86564.2158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165638.9490; train_optim_loss: 165638.9490; val_kl_reg_loss: 1872.1884; val_edge_recon_loss: 75187.3971; val_gene_expr_recon_loss: 86778.6367; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163838.2188; val_optim_loss: 163838.2188
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9643; val_auprc_score: 0.9895; val_best_acc_score: 0.9656; val_best_f1_score: 0.9800; train_kl_reg_loss: 1854.3428; train_edge_recon_loss: 77279.1366; train_gene_expr_recon_loss: 86332.7612; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165466.2417; train_optim_loss: 165466.2417; val_kl_reg_loss: 1839.1127; val_edge_recon_loss: 79493.7370; val_gene_expr_recon_loss: 86698.9154; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168031.7630; val_optim_loss: 168031.7630
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9682; val_auprc_score: 0.9918; val_best_acc_score: 0.9684; val_best_f1_score: 0.9818; train_kl_reg_loss: 1852.7412; train_edge_recon_loss: 77787.4296; train_gene_expr_recon_loss: 86017.8194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165657.9903; train_optim_loss: 165657.9903; val_kl_reg_loss: 1846.0483; val_edge_recon_loss: 74036.1732; val_gene_expr_recon_loss: 86127.7305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162009.9531; val_optim_loss: 162009.9531
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9625; val_auprc_score: 0.9889; val_best_acc_score: 0.9681; val_best_f1_score: 0.9815; train_kl_reg_loss: 1861.1920; train_edge_recon_loss: 76612.5279; train_gene_expr_recon_loss: 85833.7681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164307.4853; train_optim_loss: 164307.4853; val_kl_reg_loss: 1794.5672; val_edge_recon_loss: 78930.0508; val_gene_expr_recon_loss: 86035.0729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166759.6927; val_optim_loss: 166759.6927
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9699; val_auprc_score: 0.9900; val_best_acc_score: 0.9733; val_best_f1_score: 0.9846; train_kl_reg_loss: 1850.0533; train_edge_recon_loss: 78590.1580; train_gene_expr_recon_loss: 85481.4378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165921.6501; train_optim_loss: 165921.6501; val_kl_reg_loss: 1833.8895; val_edge_recon_loss: 74775.8372; val_gene_expr_recon_loss: 85738.1927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162347.9167; val_optim_loss: 162347.9167
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9621; val_auprc_score: 0.9866; val_best_acc_score: 0.9686; val_best_f1_score: 0.9818; train_kl_reg_loss: 1850.5828; train_edge_recon_loss: 76827.8138; train_gene_expr_recon_loss: 85226.3249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163904.7217; train_optim_loss: 163904.7217; val_kl_reg_loss: 1824.6240; val_edge_recon_loss: 76385.9518; val_gene_expr_recon_loss: 85542.8893; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163753.4688; val_optim_loss: 163753.4688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9670; val_auprc_score: 0.9923; val_best_acc_score: 0.9693; val_best_f1_score: 0.9822; train_kl_reg_loss: 1840.8542; train_edge_recon_loss: 76697.0427; train_gene_expr_recon_loss: 84805.5451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163343.4419; train_optim_loss: 163343.4419; val_kl_reg_loss: 1838.8543; val_edge_recon_loss: 76286.8932; val_gene_expr_recon_loss: 84897.1458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163022.8932; val_optim_loss: 163022.8932
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9683; val_auprc_score: 0.9887; val_best_acc_score: 0.9718; val_best_f1_score: 0.9837; train_kl_reg_loss: 1850.8651; train_edge_recon_loss: 76865.5025; train_gene_expr_recon_loss: 84699.5912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163415.9593; train_optim_loss: 163415.9593; val_kl_reg_loss: 1826.2792; val_edge_recon_loss: 77129.1237; val_gene_expr_recon_loss: 85056.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164011.7292; val_optim_loss: 164011.7292
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9703; val_auprc_score: 0.9925; val_best_acc_score: 0.9716; val_best_f1_score: 0.9836; train_kl_reg_loss: 1847.6129; train_edge_recon_loss: 77804.2043; train_gene_expr_recon_loss: 84584.8760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164236.6928; train_optim_loss: 164236.6928; val_kl_reg_loss: 1835.5735; val_edge_recon_loss: 72912.9727; val_gene_expr_recon_loss: 84861.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159609.6276; val_optim_loss: 159609.6276
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9617; val_auprc_score: 0.9861; val_best_acc_score: 0.9681; val_best_f1_score: 0.9814; train_kl_reg_loss: 1851.8499; train_edge_recon_loss: 77684.8143; train_gene_expr_recon_loss: 84636.4932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164173.1583; train_optim_loss: 164173.1583; val_kl_reg_loss: 1836.6616; val_edge_recon_loss: 79204.1992; val_gene_expr_recon_loss: 84866.0716; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165906.9323; val_optim_loss: 165906.9323
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9579; val_auprc_score: 0.9867; val_best_acc_score: 0.9678; val_best_f1_score: 0.9813; train_kl_reg_loss: 1849.1455; train_edge_recon_loss: 78401.2468; train_gene_expr_recon_loss: 84547.1191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164797.5112; train_optim_loss: 164797.5112; val_kl_reg_loss: 1836.7465; val_edge_recon_loss: 77196.2656; val_gene_expr_recon_loss: 85199.4648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164232.4714; val_optim_loss: 164232.4714
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9660; val_auprc_score: 0.9903; val_best_acc_score: 0.9715; val_best_f1_score: 0.9834; train_kl_reg_loss: 1846.5918; train_edge_recon_loss: 76496.0514; train_gene_expr_recon_loss: 84438.4646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162781.1073; train_optim_loss: 162781.1073; val_kl_reg_loss: 1827.4844; val_edge_recon_loss: 78128.0339; val_gene_expr_recon_loss: 84777.6823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164733.2005; val_optim_loss: 164733.2005

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9621; val_auprc_score: 0.9868; val_best_acc_score: 0.9689; val_best_f1_score: 0.9819; train_kl_reg_loss: 1845.1208; train_edge_recon_loss: 77374.0292; train_gene_expr_recon_loss: 84419.9718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163639.1215; train_optim_loss: 163639.1215; val_kl_reg_loss: 1833.7954; val_edge_recon_loss: 79077.4948; val_gene_expr_recon_loss: 84734.8229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165646.1094; val_optim_loss: 165646.1094
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9661; val_auprc_score: 0.9879; val_best_acc_score: 0.9697; val_best_f1_score: 0.9823; train_kl_reg_loss: 1850.1664; train_edge_recon_loss: 76989.0864; train_gene_expr_recon_loss: 84512.0958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163351.3496; train_optim_loss: 163351.3496; val_kl_reg_loss: 1835.7497; val_edge_recon_loss: 79225.3841; val_gene_expr_recon_loss: 84975.2839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166036.4167; val_optim_loss: 166036.4167
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9605; val_auprc_score: 0.9885; val_best_acc_score: 0.9678; val_best_f1_score: 0.9813; train_kl_reg_loss: 1850.0134; train_edge_recon_loss: 76878.7171; train_gene_expr_recon_loss: 84589.0646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163317.7951; train_optim_loss: 163317.7951; val_kl_reg_loss: 1836.2566; val_edge_recon_loss: 79179.5065; val_gene_expr_recon_loss: 84796.4336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165812.1953; val_optim_loss: 165812.1953

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 20 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
Val AUROC score: 0.9719
Val AUPRC score: 0.9927
Val best accuracy score: 0.9731
Val best F1 score: 0.9844
Val gene expr MSE score: 0.9082
Duration of model training in run 9: 0 hours, 1 minutes and 23 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 53901
Number of validation edges: 5988
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8508; val_auprc_score: 0.9656; val_best_acc_score: 0.8990; val_best_f1_score: 0.9437; train_kl_reg_loss: 523.8661; train_edge_recon_loss: 98246.0874; train_gene_expr_recon_loss: 97798.9578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196568.9104; train_optim_loss: 196568.9104; val_kl_reg_loss: 1712.3596; val_edge_recon_loss: 89498.0755; val_gene_expr_recon_loss: 92087.0560; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183297.4922; val_optim_loss: 183297.4922
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9197; val_auprc_score: 0.9794; val_best_acc_score: 0.9284; val_best_f1_score: 0.9593; train_kl_reg_loss: 2041.9694; train_edge_recon_loss: 83992.3948; train_gene_expr_recon_loss: 91376.9808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177411.3458; train_optim_loss: 177411.3458; val_kl_reg_loss: 1854.4406; val_edge_recon_loss: 80172.5794; val_gene_expr_recon_loss: 90868.6276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172895.6484; val_optim_loss: 172895.6484
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9422; val_auprc_score: 0.9844; val_best_acc_score: 0.9457; val_best_f1_score: 0.9689; train_kl_reg_loss: 1863.2450; train_edge_recon_loss: 79046.6795; train_gene_expr_recon_loss: 89924.7889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170834.7146; train_optim_loss: 170834.7146; val_kl_reg_loss: 1813.6601; val_edge_recon_loss: 78780.0117; val_gene_expr_recon_loss: 89207.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169801.5339; val_optim_loss: 169801.5339
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9521; val_auprc_score: 0.9870; val_best_acc_score: 0.9547; val_best_f1_score: 0.9738; train_kl_reg_loss: 1816.2175; train_edge_recon_loss: 80179.3182; train_gene_expr_recon_loss: 88969.3160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170964.8499; train_optim_loss: 170964.8499; val_kl_reg_loss: 1790.5141; val_edge_recon_loss: 77270.0273; val_gene_expr_recon_loss: 88916.9909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167977.5365; val_optim_loss: 167977.5365
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9534; val_auprc_score: 0.9847; val_best_acc_score: 0.9539; val_best_f1_score: 0.9733; train_kl_reg_loss: 1838.0647; train_edge_recon_loss: 79022.2019; train_gene_expr_recon_loss: 88295.6554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169155.9219; train_optim_loss: 169155.9219; val_kl_reg_loss: 1856.1991; val_edge_recon_loss: 80764.7513; val_gene_expr_recon_loss: 88458.7305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171079.6849; val_optim_loss: 171079.6849
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9566; val_auprc_score: 0.9874; val_best_acc_score: 0.9531; val_best_f1_score: 0.9731; train_kl_reg_loss: 1835.8742; train_edge_recon_loss: 78763.7590; train_gene_expr_recon_loss: 87807.2291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168406.8614; train_optim_loss: 168406.8614; val_kl_reg_loss: 1895.5995; val_edge_recon_loss: 78950.0065; val_gene_expr_recon_loss: 87502.4674; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168348.0729; val_optim_loss: 168348.0729
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9590; val_auprc_score: 0.9874; val_best_acc_score: 0.9631; val_best_f1_score: 0.9788; train_kl_reg_loss: 1828.2271; train_edge_recon_loss: 78124.6783; train_gene_expr_recon_loss: 87451.1713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167404.0769; train_optim_loss: 167404.0769; val_kl_reg_loss: 1800.8596; val_edge_recon_loss: 74244.9661; val_gene_expr_recon_loss: 87554.0013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163599.8281; val_optim_loss: 163599.8281
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9598; val_auprc_score: 0.9878; val_best_acc_score: 0.9622; val_best_f1_score: 0.9782; train_kl_reg_loss: 1800.2266; train_edge_recon_loss: 78223.4490; train_gene_expr_recon_loss: 86985.4452; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167009.1218; train_optim_loss: 167009.1218; val_kl_reg_loss: 1796.8833; val_edge_recon_loss: 77503.2292; val_gene_expr_recon_loss: 86775.6224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166075.7344; val_optim_loss: 166075.7344
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9627; val_auprc_score: 0.9879; val_best_acc_score: 0.9666; val_best_f1_score: 0.9808; train_kl_reg_loss: 1824.6377; train_edge_recon_loss: 78917.0625; train_gene_expr_recon_loss: 86603.7929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167345.4920; train_optim_loss: 167345.4920; val_kl_reg_loss: 1739.8990; val_edge_recon_loss: 76131.6133; val_gene_expr_recon_loss: 86269.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164140.8880; val_optim_loss: 164140.8880
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9629; val_auprc_score: 0.9903; val_best_acc_score: 0.9651; val_best_f1_score: 0.9800; train_kl_reg_loss: 1827.8192; train_edge_recon_loss: 78660.6502; train_gene_expr_recon_loss: 86281.7560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166770.2258; train_optim_loss: 166770.2258; val_kl_reg_loss: 1793.8253; val_edge_recon_loss: 73734.2422; val_gene_expr_recon_loss: 86123.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161652.0443; val_optim_loss: 161652.0443
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9626; val_auprc_score: 0.9884; val_best_acc_score: 0.9668; val_best_f1_score: 0.9808; train_kl_reg_loss: 1824.8694; train_edge_recon_loss: 77696.4315; train_gene_expr_recon_loss: 85824.7423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165346.0433; train_optim_loss: 165346.0433; val_kl_reg_loss: 1815.2821; val_edge_recon_loss: 76589.9362; val_gene_expr_recon_loss: 85715.0964; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164120.3151; val_optim_loss: 164120.3151
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9633; val_auprc_score: 0.9875; val_best_acc_score: 0.9691; val_best_f1_score: 0.9821; train_kl_reg_loss: 1822.6008; train_edge_recon_loss: 75784.4063; train_gene_expr_recon_loss: 85582.2114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163189.2190; train_optim_loss: 163189.2190; val_kl_reg_loss: 1822.8575; val_edge_recon_loss: 76626.6745; val_gene_expr_recon_loss: 86034.3815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164483.9141; val_optim_loss: 164483.9141
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9616; val_auprc_score: 0.9879; val_best_acc_score: 0.9663; val_best_f1_score: 0.9805; train_kl_reg_loss: 1820.9150; train_edge_recon_loss: 79181.7142; train_gene_expr_recon_loss: 85414.5749; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166417.2052; train_optim_loss: 166417.2052; val_kl_reg_loss: 1809.3877; val_edge_recon_loss: 80308.7773; val_gene_expr_recon_loss: 85794.8763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167913.0417; val_optim_loss: 167913.0417

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9616; val_auprc_score: 0.9891; val_best_acc_score: 0.9687; val_best_f1_score: 0.9819; train_kl_reg_loss: 1831.7291; train_edge_recon_loss: 77604.4402; train_gene_expr_recon_loss: 85022.7768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164458.9455; train_optim_loss: 164458.9455; val_kl_reg_loss: 1841.1661; val_edge_recon_loss: 77240.0052; val_gene_expr_recon_loss: 85017.7747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164098.9453; val_optim_loss: 164098.9453
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9638; val_auprc_score: 0.9880; val_best_acc_score: 0.9685; val_best_f1_score: 0.9817; train_kl_reg_loss: 1864.1902; train_edge_recon_loss: 77550.2252; train_gene_expr_recon_loss: 84853.1396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164267.5537; train_optim_loss: 164267.5537; val_kl_reg_loss: 1832.2140; val_edge_recon_loss: 79535.6680; val_gene_expr_recon_loss: 85108.2630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166476.1458; val_optim_loss: 166476.1458
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9676; val_auprc_score: 0.9919; val_best_acc_score: 0.9669; val_best_f1_score: 0.9809; train_kl_reg_loss: 1842.9227; train_edge_recon_loss: 78402.7154; train_gene_expr_recon_loss: 84852.7703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165098.4071; train_optim_loss: 165098.4071; val_kl_reg_loss: 1830.1795; val_edge_recon_loss: 77312.6745; val_gene_expr_recon_loss: 85022.3633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164165.2161; val_optim_loss: 164165.2161

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 56 sec.
Using best model state, which was in epoch 10.

--- MODEL EVALUATION ---
Val AUROC score: 0.9672
Val AUPRC score: 0.9905
Val best accuracy score: 0.9677
Val best F1 score: 0.9814
Val gene expr MSE score: 0.9401
Duration of model training in run 10: 0 hours, 0 minutes and 58 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
First script finished. Launching follow up script.
Run timestamp: 02062023_103610.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '8192', '8192', '4096', '4096', '2048', '2048', '1024', '1024', '1024', '1024', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_25pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-attention_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-attention', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 27455
Number of validation edges: 3050
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9284; val_auprc_score: 0.9835; val_best_acc_score: 0.9020; val_best_f1_score: 0.9434; train_kl_reg_loss: 65.4817; train_edge_recon_loss: 101883.5332; train_gene_expr_recon_loss: 124968.2832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226917.2969; train_optim_loss: 226917.2969; val_kl_reg_loss: 154.6065; val_edge_recon_loss: 117582.4453; val_gene_expr_recon_loss: 109792.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227529.5000; val_optim_loss: 227529.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9331; val_auprc_score: 0.9851; val_best_acc_score: 0.9175; val_best_f1_score: 0.9527; train_kl_reg_loss: 217.2019; train_edge_recon_loss: 101856.7812; train_gene_expr_recon_loss: 105636.1641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207710.1484; train_optim_loss: 207710.1484; val_kl_reg_loss: 238.8677; val_edge_recon_loss: 116036.4844; val_gene_expr_recon_loss: 101244.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217519.6250; val_optim_loss: 217519.6250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9284; val_auprc_score: 0.9822; val_best_acc_score: 0.9156; val_best_f1_score: 0.9515; train_kl_reg_loss: 208.5592; train_edge_recon_loss: 103787.8047; train_gene_expr_recon_loss: 99842.6953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203839.0547; train_optim_loss: 203839.0547; val_kl_reg_loss: 154.0899; val_edge_recon_loss: 112730.8750; val_gene_expr_recon_loss: 98619.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211504.5625; val_optim_loss: 211504.5625
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9170; val_auprc_score: 0.9822; val_best_acc_score: 0.9206; val_best_f1_score: 0.9544; train_kl_reg_loss: 146.5785; train_edge_recon_loss: 102170.4980; train_gene_expr_recon_loss: 97926.7656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200243.8438; train_optim_loss: 200243.8438; val_kl_reg_loss: 144.0896; val_edge_recon_loss: 102534.1484; val_gene_expr_recon_loss: 97723.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200401.3125; val_optim_loss: 200401.3125
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8799; val_auprc_score: 0.9696; val_best_acc_score: 0.9071; val_best_f1_score: 0.9472; train_kl_reg_loss: 171.1523; train_edge_recon_loss: 98462.1738; train_gene_expr_recon_loss: 97054.2637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195687.5898; train_optim_loss: 195687.5898; val_kl_reg_loss: 236.5033; val_edge_recon_loss: 102508.2109; val_gene_expr_recon_loss: 97212.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 199956.8125; val_optim_loss: 199956.8125
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8714; val_auprc_score: 0.9699; val_best_acc_score: 0.8992; val_best_f1_score: 0.9432; train_kl_reg_loss: 322.5607; train_edge_recon_loss: 98229.2188; train_gene_expr_recon_loss: 96471.3867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195023.1680; train_optim_loss: 195023.1680; val_kl_reg_loss: 495.2149; val_edge_recon_loss: 96171.0078; val_gene_expr_recon_loss: 96651.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193317.7500; val_optim_loss: 193317.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8703; val_auprc_score: 0.9695; val_best_acc_score: 0.8884; val_best_f1_score: 0.9363; train_kl_reg_loss: 693.2544; train_edge_recon_loss: 93571.9629; train_gene_expr_recon_loss: 95832.8418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190098.0625; train_optim_loss: 190098.0625; val_kl_reg_loss: 1060.3870; val_edge_recon_loss: 97584.2422; val_gene_expr_recon_loss: 96050.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194694.6875; val_optim_loss: 194694.6875
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8795; val_auprc_score: 0.9706; val_best_acc_score: 0.9040; val_best_f1_score: 0.9457; train_kl_reg_loss: 1366.9562; train_edge_recon_loss: 87687.2832; train_gene_expr_recon_loss: 95416.8262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184471.0703; train_optim_loss: 184471.0703; val_kl_reg_loss: 1849.1951; val_edge_recon_loss: 87159.8125; val_gene_expr_recon_loss: 95576.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184585.1562; val_optim_loss: 184585.1562
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8809; val_auprc_score: 0.9713; val_best_acc_score: 0.9009; val_best_f1_score: 0.9440; train_kl_reg_loss: 2150.2681; train_edge_recon_loss: 84524.2383; train_gene_expr_recon_loss: 94969.9180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181644.4258; train_optim_loss: 181644.4258; val_kl_reg_loss: 2532.3623; val_edge_recon_loss: 87050.6641; val_gene_expr_recon_loss: 95186.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184769.5156; val_optim_loss: 184769.5156
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8675; val_auprc_score: 0.9704; val_best_acc_score: 0.8987; val_best_f1_score: 0.9432; train_kl_reg_loss: 2750.0011; train_edge_recon_loss: 82607.5527; train_gene_expr_recon_loss: 94469.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179827.4727; train_optim_loss: 179827.4727; val_kl_reg_loss: 2991.1914; val_edge_recon_loss: 82868.7734; val_gene_expr_recon_loss: 95015.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180875.8750; val_optim_loss: 180875.8750
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9097; val_auprc_score: 0.9802; val_best_acc_score: 0.9073; val_best_f1_score: 0.9473; train_kl_reg_loss: 3027.6242; train_edge_recon_loss: 82952.7168; train_gene_expr_recon_loss: 94366.4551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180346.7969; train_optim_loss: 180346.7969; val_kl_reg_loss: 2982.4341; val_edge_recon_loss: 82974.7188; val_gene_expr_recon_loss: 94639.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180596.4688; val_optim_loss: 180596.4688
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9060; val_auprc_score: 0.9796; val_best_acc_score: 0.9106; val_best_f1_score: 0.9495; train_kl_reg_loss: 2997.7684; train_edge_recon_loss: 79681.0762; train_gene_expr_recon_loss: 93886.3809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176565.2305; train_optim_loss: 176565.2305; val_kl_reg_loss: 2869.3755; val_edge_recon_loss: 81055.0312; val_gene_expr_recon_loss: 94356.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178281.3750; val_optim_loss: 178281.3750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9173; val_auprc_score: 0.9822; val_best_acc_score: 0.9161; val_best_f1_score: 0.9519; train_kl_reg_loss: 2801.0428; train_edge_recon_loss: 81341.8145; train_gene_expr_recon_loss: 93683.6348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177826.4961; train_optim_loss: 177826.4961; val_kl_reg_loss: 2601.5156; val_edge_recon_loss: 81324.0469; val_gene_expr_recon_loss: 94120.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178046.3125; val_optim_loss: 178046.3125
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9368; val_auprc_score: 0.9843; val_best_acc_score: 0.9237; val_best_f1_score: 0.9560; train_kl_reg_loss: 2552.5580; train_edge_recon_loss: 81199.8730; train_gene_expr_recon_loss: 93477.4961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177229.9297; train_optim_loss: 177229.9297; val_kl_reg_loss: 2400.2944; val_edge_recon_loss: 80200.8281; val_gene_expr_recon_loss: 93900.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176501.7188; val_optim_loss: 176501.7188
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9286; val_auprc_score: 0.9830; val_best_acc_score: 0.9227; val_best_f1_score: 0.9553; train_kl_reg_loss: 2359.9163; train_edge_recon_loss: 80314.7324; train_gene_expr_recon_loss: 93515.8398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176190.4922; train_optim_loss: 176190.4922; val_kl_reg_loss: 2239.7053; val_edge_recon_loss: 83418.2656; val_gene_expr_recon_loss: 93710.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179368.1875; val_optim_loss: 179368.1875
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9371; val_auprc_score: 0.9865; val_best_acc_score: 0.9307; val_best_f1_score: 0.9602; train_kl_reg_loss: 2243.0883; train_edge_recon_loss: 78517.5977; train_gene_expr_recon_loss: 92971.2773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173731.9688; train_optim_loss: 173731.9688; val_kl_reg_loss: 2202.8320; val_edge_recon_loss: 76067.3750; val_gene_expr_recon_loss: 93535.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171805.9219; val_optim_loss: 171805.9219
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9311; val_auprc_score: 0.9811; val_best_acc_score: 0.9374; val_best_f1_score: 0.9642; train_kl_reg_loss: 2225.3783; train_edge_recon_loss: 81994.2031; train_gene_expr_recon_loss: 92984.6582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177204.2383; train_optim_loss: 177204.2383; val_kl_reg_loss: 2195.3464; val_edge_recon_loss: 77975.7891; val_gene_expr_recon_loss: 93358.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173530.1094; val_optim_loss: 173530.1094
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9523; val_auprc_score: 0.9873; val_best_acc_score: 0.9320; val_best_f1_score: 0.9604; train_kl_reg_loss: 2242.0992; train_edge_recon_loss: 78701.1738; train_gene_expr_recon_loss: 92518.1016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173461.3750; train_optim_loss: 173461.3750; val_kl_reg_loss: 2221.1562; val_edge_recon_loss: 84913.9531; val_gene_expr_recon_loss: 93191.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180326.3750; val_optim_loss: 180326.3750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9525; val_auprc_score: 0.9902; val_best_acc_score: 0.9475; val_best_f1_score: 0.9701; train_kl_reg_loss: 2249.2650; train_edge_recon_loss: 78134.0078; train_gene_expr_recon_loss: 92723.1426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173106.4141; train_optim_loss: 173106.4141; val_kl_reg_loss: 2202.6333; val_edge_recon_loss: 72083.4922; val_gene_expr_recon_loss: 93036.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167322.2500; val_optim_loss: 167322.2500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9574; val_auprc_score: 0.9909; val_best_acc_score: 0.9452; val_best_f1_score: 0.9684; train_kl_reg_loss: 2228.8373; train_edge_recon_loss: 77747.2656; train_gene_expr_recon_loss: 92499.8965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172476.0039; train_optim_loss: 172476.0039; val_kl_reg_loss: 2181.5232; val_edge_recon_loss: 77518.1172; val_gene_expr_recon_loss: 92864.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172563.8750; val_optim_loss: 172563.8750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9485; val_auprc_score: 0.9880; val_best_acc_score: 0.9387; val_best_f1_score: 0.9647; train_kl_reg_loss: 2211.4862; train_edge_recon_loss: 78978.5020; train_gene_expr_recon_loss: 92291.3652; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173481.3516; train_optim_loss: 173481.3516; val_kl_reg_loss: 2167.1411; val_edge_recon_loss: 79625.1797; val_gene_expr_recon_loss: 92720.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174512.7500; val_optim_loss: 174512.7500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9504; val_auprc_score: 0.9882; val_best_acc_score: 0.9490; val_best_f1_score: 0.9708; train_kl_reg_loss: 2180.1422; train_edge_recon_loss: 78820.2441; train_gene_expr_recon_loss: 91951.7246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172952.1133; train_optim_loss: 172952.1133; val_kl_reg_loss: 2130.4006; val_edge_recon_loss: 75706.2734; val_gene_expr_recon_loss: 92553.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170390.5312; val_optim_loss: 170390.5312

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9362; val_auprc_score: 0.9818; val_best_acc_score: 0.9497; val_best_f1_score: 0.9711; train_kl_reg_loss: 2160.8829; train_edge_recon_loss: 77479.8320; train_gene_expr_recon_loss: 91869.4473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171510.1602; train_optim_loss: 171510.1602; val_kl_reg_loss: 2128.9670; val_edge_recon_loss: 76588.3516; val_gene_expr_recon_loss: 92534.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171251.4531; val_optim_loss: 171251.4531
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9535; val_auprc_score: 0.9868; val_best_acc_score: 0.9419; val_best_f1_score: 0.9665; train_kl_reg_loss: 2159.9418; train_edge_recon_loss: 78713.6074; train_gene_expr_recon_loss: 91907.1504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172780.7031; train_optim_loss: 172780.7031; val_kl_reg_loss: 2124.8389; val_edge_recon_loss: 80397.1328; val_gene_expr_recon_loss: 92518.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175040.2812; val_optim_loss: 175040.2812
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9633; val_auprc_score: 0.9923; val_best_acc_score: 0.9459; val_best_f1_score: 0.9690; train_kl_reg_loss: 2161.3434; train_edge_recon_loss: 77827.6230; train_gene_expr_recon_loss: 91781.1074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171770.0742; train_optim_loss: 171770.0742; val_kl_reg_loss: 2128.5664; val_edge_recon_loss: 76031.3828; val_gene_expr_recon_loss: 92507.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170667.2500; val_optim_loss: 170667.2500

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 28 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9430
Val AUPRC score: 0.9827
Val best accuracy score: 0.9383
Val best F1 score: 0.9645
Val gene expr MSE score: 1.1851
Duration of model training in run 1: 0 hours, 0 minutes and 34 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 27455
Number of validation edges: 3050
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9330; val_auprc_score: 0.9845; val_best_acc_score: 0.9079; val_best_f1_score: 0.9467; train_kl_reg_loss: 79.2441; train_edge_recon_loss: 102755.5391; train_gene_expr_recon_loss: 129016.1465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 231850.9297; train_optim_loss: 231850.9297; val_kl_reg_loss: 163.4562; val_edge_recon_loss: 118158.0156; val_gene_expr_recon_loss: 111449.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229770.6094; val_optim_loss: 229770.6094
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9357; val_auprc_score: 0.9873; val_best_acc_score: 0.9023; val_best_f1_score: 0.9420; train_kl_reg_loss: 252.1959; train_edge_recon_loss: 102741.0332; train_gene_expr_recon_loss: 106378.1992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209371.4297; train_optim_loss: 209371.4297; val_kl_reg_loss: 292.3210; val_edge_recon_loss: 122468.7969; val_gene_expr_recon_loss: 101259.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224020.4375; val_optim_loss: 224020.4375
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9231; val_auprc_score: 0.9806; val_best_acc_score: 0.9080; val_best_f1_score: 0.9469; train_kl_reg_loss: 283.6748; train_edge_recon_loss: 100428.1797; train_gene_expr_recon_loss: 99244.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199956.1055; train_optim_loss: 199956.1055; val_kl_reg_loss: 215.3333; val_edge_recon_loss: 113350.4688; val_gene_expr_recon_loss: 98500.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 212066.3125; val_optim_loss: 212066.3125
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9116; val_auprc_score: 0.9800; val_best_acc_score: 0.9092; val_best_f1_score: 0.9477; train_kl_reg_loss: 195.4797; train_edge_recon_loss: 101760.2539; train_gene_expr_recon_loss: 97492.3516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199448.0859; train_optim_loss: 199448.0859; val_kl_reg_loss: 147.1018; val_edge_recon_loss: 116170.9922; val_gene_expr_recon_loss: 97644.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213962.1562; val_optim_loss: 213962.1562
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8959; val_auprc_score: 0.9763; val_best_acc_score: 0.9107; val_best_f1_score: 0.9495; train_kl_reg_loss: 150.2926; train_edge_recon_loss: 100582.3848; train_gene_expr_recon_loss: 96611.2422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197343.9180; train_optim_loss: 197343.9180; val_kl_reg_loss: 144.3826; val_edge_recon_loss: 103745.4531; val_gene_expr_recon_loss: 97075.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200965.1875; val_optim_loss: 200965.1875
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8575; val_auprc_score: 0.9655; val_best_acc_score: 0.8940; val_best_f1_score: 0.9397; train_kl_reg_loss: 172.0859; train_edge_recon_loss: 101659.8086; train_gene_expr_recon_loss: 96191.2266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198023.1250; train_optim_loss: 198023.1250; val_kl_reg_loss: 206.2938; val_edge_recon_loss: 104856.0938; val_gene_expr_recon_loss: 96547.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201609.4062; val_optim_loss: 201609.4062
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8455; val_auprc_score: 0.9652; val_best_acc_score: 0.8838; val_best_f1_score: 0.9346; train_kl_reg_loss: 270.5035; train_edge_recon_loss: 99627.6660; train_gene_expr_recon_loss: 95600.5957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195498.7656; train_optim_loss: 195498.7656; val_kl_reg_loss: 359.6336; val_edge_recon_loss: 101260.4297; val_gene_expr_recon_loss: 95987.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197607.6562; val_optim_loss: 197607.6562
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8071; val_auprc_score: 0.9556; val_best_acc_score: 0.8857; val_best_f1_score: 0.9360; train_kl_reg_loss: 494.0130; train_edge_recon_loss: 94449.4707; train_gene_expr_recon_loss: 95056.7949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190000.2773; train_optim_loss: 190000.2773; val_kl_reg_loss: 679.2841; val_edge_recon_loss: 94402.9688; val_gene_expr_recon_loss: 95509.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190591.7656; val_optim_loss: 190591.7656
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8320; val_auprc_score: 0.9605; val_best_acc_score: 0.8873; val_best_f1_score: 0.9373; train_kl_reg_loss: 921.1482; train_edge_recon_loss: 91702.6758; train_gene_expr_recon_loss: 94808.0508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187431.8750; train_optim_loss: 187431.8750; val_kl_reg_loss: 1198.9810; val_edge_recon_loss: 91889.1250; val_gene_expr_recon_loss: 95057.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188145.5312; val_optim_loss: 188145.5312
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8413; val_auprc_score: 0.9622; val_best_acc_score: 0.8829; val_best_f1_score: 0.9343; train_kl_reg_loss: 1507.5019; train_edge_recon_loss: 91273.7500; train_gene_expr_recon_loss: 94111.6484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186892.8984; train_optim_loss: 186892.8984; val_kl_reg_loss: 1842.6326; val_edge_recon_loss: 92324.8828; val_gene_expr_recon_loss: 94704.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188871.7812; val_optim_loss: 188871.7812
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8482; val_auprc_score: 0.9671; val_best_acc_score: 0.8908; val_best_f1_score: 0.9394; train_kl_reg_loss: 2197.8209; train_edge_recon_loss: 88620.9570; train_gene_expr_recon_loss: 93876.2402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184695.0117; train_optim_loss: 184695.0117; val_kl_reg_loss: 2494.1919; val_edge_recon_loss: 85114.7109; val_gene_expr_recon_loss: 94477.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182086.6875; val_optim_loss: 182086.6875
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8810; val_auprc_score: 0.9747; val_best_acc_score: 0.9011; val_best_f1_score: 0.9447; train_kl_reg_loss: 2694.6470; train_edge_recon_loss: 82743.5078; train_gene_expr_recon_loss: 93519.3926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178957.5508; train_optim_loss: 178957.5508; val_kl_reg_loss: 2701.7190; val_edge_recon_loss: 81088.2969; val_gene_expr_recon_loss: 94207.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177997.5312; val_optim_loss: 177997.5312
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9026; val_auprc_score: 0.9786; val_best_acc_score: 0.9004; val_best_f1_score: 0.9442; train_kl_reg_loss: 2883.6033; train_edge_recon_loss: 84157.2480; train_gene_expr_recon_loss: 93494.1973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180535.0430; train_optim_loss: 180535.0430; val_kl_reg_loss: 2817.1838; val_edge_recon_loss: 84432.9219; val_gene_expr_recon_loss: 94045.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181295.8594; val_optim_loss: 181295.8594
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8918; val_auprc_score: 0.9763; val_best_acc_score: 0.9010; val_best_f1_score: 0.9443; train_kl_reg_loss: 2841.5510; train_edge_recon_loss: 81496.0723; train_gene_expr_recon_loss: 93083.2070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177420.8320; train_optim_loss: 177420.8320; val_kl_reg_loss: 2645.4092; val_edge_recon_loss: 83809.2266; val_gene_expr_recon_loss: 93763.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180218.5938; val_optim_loss: 180218.5938
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9048; val_auprc_score: 0.9758; val_best_acc_score: 0.9106; val_best_f1_score: 0.9492; train_kl_reg_loss: 2728.6824; train_edge_recon_loss: 78995.3418; train_gene_expr_recon_loss: 92970.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174694.0586; train_optim_loss: 174694.0586; val_kl_reg_loss: 2535.1460; val_edge_recon_loss: 83890.4453; val_gene_expr_recon_loss: 93527.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179953.4688; val_optim_loss: 179953.4688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9058; val_auprc_score: 0.9797; val_best_acc_score: 0.9120; val_best_f1_score: 0.9505; train_kl_reg_loss: 2620.4034; train_edge_recon_loss: 82385.3164; train_gene_expr_recon_loss: 92786.6426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177792.3633; train_optim_loss: 177792.3633; val_kl_reg_loss: 2511.8655; val_edge_recon_loss: 80529.7969; val_gene_expr_recon_loss: 93492.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176534.3750; val_optim_loss: 176534.3750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9154; val_auprc_score: 0.9819; val_best_acc_score: 0.9117; val_best_f1_score: 0.9503; train_kl_reg_loss: 2594.0798; train_edge_recon_loss: 80262.4473; train_gene_expr_recon_loss: 92751.9297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175608.4570; train_optim_loss: 175608.4570; val_kl_reg_loss: 2492.1785; val_edge_recon_loss: 80501.0469; val_gene_expr_recon_loss: 93460.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176453.7812; val_optim_loss: 176453.7812
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9218; val_auprc_score: 0.9818; val_best_acc_score: 0.9141; val_best_f1_score: 0.9512; train_kl_reg_loss: 2574.1522; train_edge_recon_loss: 80428.2539; train_gene_expr_recon_loss: 92855.3691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175857.7695; train_optim_loss: 175857.7695; val_kl_reg_loss: 2477.9927; val_edge_recon_loss: 80268.6094; val_gene_expr_recon_loss: 93429.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176176.3750; val_optim_loss: 176176.3750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9083; val_auprc_score: 0.9804; val_best_acc_score: 0.9170; val_best_f1_score: 0.9533; train_kl_reg_loss: 2558.6352; train_edge_recon_loss: 81215.1562; train_gene_expr_recon_loss: 92804.7949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176578.5859; train_optim_loss: 176578.5859; val_kl_reg_loss: 2472.0630; val_edge_recon_loss: 78834.2656; val_gene_expr_recon_loss: 93394.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174700.3594; val_optim_loss: 174700.3594
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9215; val_auprc_score: 0.9805; val_best_acc_score: 0.9148; val_best_f1_score: 0.9518; train_kl_reg_loss: 2554.8879; train_edge_recon_loss: 78910.6562; train_gene_expr_recon_loss: 92685.3457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174150.8906; train_optim_loss: 174150.8906; val_kl_reg_loss: 2467.3303; val_edge_recon_loss: 81851.6250; val_gene_expr_recon_loss: 93362.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177680.9688; val_optim_loss: 177680.9688
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9180; val_auprc_score: 0.9817; val_best_acc_score: 0.9159; val_best_f1_score: 0.9525; train_kl_reg_loss: 2556.8668; train_edge_recon_loss: 82450.8184; train_gene_expr_recon_loss: 92711.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177719.2188; train_optim_loss: 177719.2188; val_kl_reg_loss: 2468.8657; val_edge_recon_loss: 80375.5078; val_gene_expr_recon_loss: 93333.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176178.2188; val_optim_loss: 176178.2188
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9218; val_auprc_score: 0.9801; val_best_acc_score: 0.9189; val_best_f1_score: 0.9538; train_kl_reg_loss: 2548.7429; train_edge_recon_loss: 79886.5469; train_gene_expr_recon_loss: 92526.9102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174962.1992; train_optim_loss: 174962.1992; val_kl_reg_loss: 2445.9702; val_edge_recon_loss: 81657.6172; val_gene_expr_recon_loss: 93305.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177408.8125; val_optim_loss: 177408.8125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9153; val_auprc_score: 0.9798; val_best_acc_score: 0.9100; val_best_f1_score: 0.9482; train_kl_reg_loss: 2535.0214; train_edge_recon_loss: 81564.9629; train_gene_expr_recon_loss: 92661.4141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176761.4023; train_optim_loss: 176761.4023; val_kl_reg_loss: 2442.9792; val_edge_recon_loss: 85551.2266; val_gene_expr_recon_loss: 93302.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181296.5938; val_optim_loss: 181296.5938
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9237; val_auprc_score: 0.9832; val_best_acc_score: 0.9244; val_best_f1_score: 0.9572; train_kl_reg_loss: 2538.8846; train_edge_recon_loss: 81514.3555; train_gene_expr_recon_loss: 92728.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176781.2734; train_optim_loss: 176781.2734; val_kl_reg_loss: 2456.1816; val_edge_recon_loss: 77007.6328; val_gene_expr_recon_loss: 93299.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172763.2812; val_optim_loss: 172763.2812
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9159; val_auprc_score: 0.9811; val_best_acc_score: 0.9128; val_best_f1_score: 0.9507; train_kl_reg_loss: 2537.3770; train_edge_recon_loss: 81538.6738; train_gene_expr_recon_loss: 92662.6699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176738.7188; train_optim_loss: 176738.7188; val_kl_reg_loss: 2447.2412; val_edge_recon_loss: 82608.5234; val_gene_expr_recon_loss: 93296.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178352.2500; val_optim_loss: 178352.2500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9297; val_auprc_score: 0.9840; val_best_acc_score: 0.9230; val_best_f1_score: 0.9563; train_kl_reg_loss: 2530.0535; train_edge_recon_loss: 82231.9707; train_gene_expr_recon_loss: 92504.4980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177266.5234; train_optim_loss: 177266.5234; val_kl_reg_loss: 2447.9141; val_edge_recon_loss: 77465.8906; val_gene_expr_recon_loss: 93293.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173207.4062; val_optim_loss: 173207.4062
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9180; val_auprc_score: 0.9817; val_best_acc_score: 0.9142; val_best_f1_score: 0.9514; train_kl_reg_loss: 2534.5916; train_edge_recon_loss: 80633.1367; train_gene_expr_recon_loss: 92395.1973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175562.9297; train_optim_loss: 175562.9297; val_kl_reg_loss: 2453.9209; val_edge_recon_loss: 83081.2266; val_gene_expr_recon_loss: 93290.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178825.9844; val_optim_loss: 178825.9844

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9234; val_auprc_score: 0.9816; val_best_acc_score: 0.9202; val_best_f1_score: 0.9548; train_kl_reg_loss: 2530.8137; train_edge_recon_loss: 81481.9277; train_gene_expr_recon_loss: 92387.7402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176400.4805; train_optim_loss: 176400.4805; val_kl_reg_loss: 2440.9077; val_edge_recon_loss: 78741.2891; val_gene_expr_recon_loss: 93290.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174472.7656; val_optim_loss: 174472.7656
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9234; val_auprc_score: 0.9811; val_best_acc_score: 0.9170; val_best_f1_score: 0.9525; train_kl_reg_loss: 2536.6368; train_edge_recon_loss: 79002.5801; train_gene_expr_recon_loss: 92701.5195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174240.7344; train_optim_loss: 174240.7344; val_kl_reg_loss: 2449.4341; val_edge_recon_loss: 82375.2031; val_gene_expr_recon_loss: 93290.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178114.9531; val_optim_loss: 178114.9531
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9148; val_auprc_score: 0.9815; val_best_acc_score: 0.9184; val_best_f1_score: 0.9541; train_kl_reg_loss: 2539.2069; train_edge_recon_loss: 81120.5312; train_gene_expr_recon_loss: 92717.6895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176377.4297; train_optim_loss: 176377.4297; val_kl_reg_loss: 2451.4551; val_edge_recon_loss: 78701.6797; val_gene_expr_recon_loss: 93290.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174443.1719; val_optim_loss: 174443.1719

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 35 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9269
Val AUPRC score: 0.9839
Val best accuracy score: 0.9198
Val best F1 score: 0.9545
Val gene expr MSE score: 1.2217
Duration of model training in run 2: 0 hours, 0 minutes and 36 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 53693
Number of validation edges: 5965
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9690; val_auprc_score: 0.9926; val_best_acc_score: 0.9444; val_best_f1_score: 0.9681; train_kl_reg_loss: 176.9199; train_edge_recon_loss: 102493.4838; train_gene_expr_recon_loss: 107658.9163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210329.3214; train_optim_loss: 210329.3214; val_kl_reg_loss: 146.0144; val_edge_recon_loss: 105247.2930; val_gene_expr_recon_loss: 95361.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200754.7422; val_optim_loss: 200754.7422
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8907; val_auprc_score: 0.9768; val_best_acc_score: 0.8980; val_best_f1_score: 0.9426; train_kl_reg_loss: 178.6890; train_edge_recon_loss: 99020.9615; train_gene_expr_recon_loss: 95256.5552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194456.2065; train_optim_loss: 194456.2065; val_kl_reg_loss: 371.1253; val_edge_recon_loss: 96395.1523; val_gene_expr_recon_loss: 93183.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189950.1406; val_optim_loss: 189950.1406
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8882; val_auprc_score: 0.9734; val_best_acc_score: 0.8955; val_best_f1_score: 0.9407; train_kl_reg_loss: 1058.1244; train_edge_recon_loss: 90689.4314; train_gene_expr_recon_loss: 93668.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185415.6328; train_optim_loss: 185415.6328; val_kl_reg_loss: 2090.5151; val_edge_recon_loss: 88659.1211; val_gene_expr_recon_loss: 93568.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184318.2500; val_optim_loss: 184318.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9225; val_auprc_score: 0.9813; val_best_acc_score: 0.9121; val_best_f1_score: 0.9496; train_kl_reg_loss: 2612.1104; train_edge_recon_loss: 82784.5022; train_gene_expr_recon_loss: 92562.9420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177959.5547; train_optim_loss: 177959.5547; val_kl_reg_loss: 2587.2900; val_edge_recon_loss: 83688.9180; val_gene_expr_recon_loss: 91572.4883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177848.7031; val_optim_loss: 177848.7031
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9476; val_auprc_score: 0.9871; val_best_acc_score: 0.9317; val_best_f1_score: 0.9605; train_kl_reg_loss: 2398.7127; train_edge_recon_loss: 81665.9280; train_gene_expr_recon_loss: 91727.4855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175792.1228; train_optim_loss: 175792.1228; val_kl_reg_loss: 2122.7277; val_edge_recon_loss: 81820.8594; val_gene_expr_recon_loss: 89619.6289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173563.2188; val_optim_loss: 173563.2188
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9559; val_auprc_score: 0.9885; val_best_acc_score: 0.9442; val_best_f1_score: 0.9677; train_kl_reg_loss: 2157.7654; train_edge_recon_loss: 78732.2902; train_gene_expr_recon_loss: 90996.6217; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171886.6786; train_optim_loss: 171886.6786; val_kl_reg_loss: 2125.5040; val_edge_recon_loss: 79926.7695; val_gene_expr_recon_loss: 90304.5195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172356.7891; val_optim_loss: 172356.7891
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9692; val_auprc_score: 0.9932; val_best_acc_score: 0.9559; val_best_f1_score: 0.9745; train_kl_reg_loss: 2110.9178; train_edge_recon_loss: 79634.2165; train_gene_expr_recon_loss: 90491.3410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172236.4743; train_optim_loss: 172236.4743; val_kl_reg_loss: 2037.2510; val_edge_recon_loss: 77971.4883; val_gene_expr_recon_loss: 89546.6133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169555.3516; val_optim_loss: 169555.3516
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9706; val_auprc_score: 0.9928; val_best_acc_score: 0.9611; val_best_f1_score: 0.9776; train_kl_reg_loss: 2064.4237; train_edge_recon_loss: 78302.1339; train_gene_expr_recon_loss: 90029.7472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170396.3047; train_optim_loss: 170396.3047; val_kl_reg_loss: 2055.4505; val_edge_recon_loss: 77597.7266; val_gene_expr_recon_loss: 89420.3945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169073.5703; val_optim_loss: 169073.5703
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9701; val_auprc_score: 0.9925; val_best_acc_score: 0.9654; val_best_f1_score: 0.9800; train_kl_reg_loss: 2081.0740; train_edge_recon_loss: 78488.7344; train_gene_expr_recon_loss: 89736.3744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170306.1830; train_optim_loss: 170306.1830; val_kl_reg_loss: 2000.4454; val_edge_recon_loss: 76671.9727; val_gene_expr_recon_loss: 89166.1367; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167838.5547; val_optim_loss: 167838.5547
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9720; val_auprc_score: 0.9914; val_best_acc_score: 0.9680; val_best_f1_score: 0.9816; train_kl_reg_loss: 2020.0698; train_edge_recon_loss: 77666.5759; train_gene_expr_recon_loss: 89446.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169132.8292; train_optim_loss: 169132.8292; val_kl_reg_loss: 2023.8304; val_edge_recon_loss: 73045.2422; val_gene_expr_recon_loss: 89729.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164798.2500; val_optim_loss: 164798.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9737; val_auprc_score: 0.9924; val_best_acc_score: 0.9674; val_best_f1_score: 0.9812; train_kl_reg_loss: 2043.5531; train_edge_recon_loss: 78695.4487; train_gene_expr_recon_loss: 88985.8728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169724.8750; train_optim_loss: 169724.8750; val_kl_reg_loss: 1989.7396; val_edge_recon_loss: 75774.0234; val_gene_expr_recon_loss: 88440.3164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166204.0781; val_optim_loss: 166204.0781
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9803; val_auprc_score: 0.9941; val_best_acc_score: 0.9717; val_best_f1_score: 0.9835; train_kl_reg_loss: 1990.0885; train_edge_recon_loss: 78011.4922; train_gene_expr_recon_loss: 88743.5301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168745.1094; train_optim_loss: 168745.1094; val_kl_reg_loss: 2003.5810; val_edge_recon_loss: 77185.4062; val_gene_expr_recon_loss: 87083.7930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166272.7812; val_optim_loss: 166272.7812
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9802; val_auprc_score: 0.9958; val_best_acc_score: 0.9706; val_best_f1_score: 0.9830; train_kl_reg_loss: 2017.6330; train_edge_recon_loss: 78763.3499; train_gene_expr_recon_loss: 88307.5575; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169088.5413; train_optim_loss: 169088.5413; val_kl_reg_loss: 1980.8892; val_edge_recon_loss: 75240.3984; val_gene_expr_recon_loss: 87434.9336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164656.2188; val_optim_loss: 164656.2188
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9824; val_auprc_score: 0.9962; val_best_acc_score: 0.9741; val_best_f1_score: 0.9850; train_kl_reg_loss: 1987.8933; train_edge_recon_loss: 77068.0502; train_gene_expr_recon_loss: 88082.4040; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167138.3471; train_optim_loss: 167138.3471; val_kl_reg_loss: 1948.0089; val_edge_recon_loss: 74346.1992; val_gene_expr_recon_loss: 88740.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165034.4375; val_optim_loss: 165034.4375
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9809; val_auprc_score: 0.9958; val_best_acc_score: 0.9708; val_best_f1_score: 0.9829; train_kl_reg_loss: 1977.2105; train_edge_recon_loss: 77568.4665; train_gene_expr_recon_loss: 87859.6903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167405.3650; train_optim_loss: 167405.3650; val_kl_reg_loss: 1911.7817; val_edge_recon_loss: 79082.6445; val_gene_expr_recon_loss: 86596.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167591.0000; val_optim_loss: 167591.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9780; val_auprc_score: 0.9948; val_best_acc_score: 0.9732; val_best_f1_score: 0.9844; train_kl_reg_loss: 1947.0796; train_edge_recon_loss: 76223.3968; train_gene_expr_recon_loss: 87840.5340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166011.0100; train_optim_loss: 166011.0100; val_kl_reg_loss: 1898.4838; val_edge_recon_loss: 76669.7539; val_gene_expr_recon_loss: 87771.5039; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166339.7422; val_optim_loss: 166339.7422

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9787; val_auprc_score: 0.9939; val_best_acc_score: 0.9715; val_best_f1_score: 0.9834; train_kl_reg_loss: 1943.0001; train_edge_recon_loss: 78568.7896; train_gene_expr_recon_loss: 87663.7344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168175.5234; train_optim_loss: 168175.5234; val_kl_reg_loss: 1923.0533; val_edge_recon_loss: 78696.2070; val_gene_expr_recon_loss: 87049.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167669.0000; val_optim_loss: 167669.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9837; val_auprc_score: 0.9964; val_best_acc_score: 0.9714; val_best_f1_score: 0.9833; train_kl_reg_loss: 1946.1763; train_edge_recon_loss: 75788.8435; train_gene_expr_recon_loss: 87545.6267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165280.6484; train_optim_loss: 165280.6484; val_kl_reg_loss: 1901.2727; val_edge_recon_loss: 80692.6445; val_gene_expr_recon_loss: 87205.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169799.1250; val_optim_loss: 169799.1250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9814; val_auprc_score: 0.9963; val_best_acc_score: 0.9742; val_best_f1_score: 0.9851; train_kl_reg_loss: 1947.0161; train_edge_recon_loss: 77968.3700; train_gene_expr_recon_loss: 87427.7941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167343.1797; train_optim_loss: 167343.1797; val_kl_reg_loss: 1925.1938; val_edge_recon_loss: 73298.1641; val_gene_expr_recon_loss: 86913.0508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162136.4062; val_optim_loss: 162136.4062
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9824; val_auprc_score: 0.9956; val_best_acc_score: 0.9718; val_best_f1_score: 0.9835; train_kl_reg_loss: 1949.2032; train_edge_recon_loss: 77584.4314; train_gene_expr_recon_loss: 87422.3460; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166955.9788; train_optim_loss: 166955.9788; val_kl_reg_loss: 1900.2106; val_edge_recon_loss: 79497.9180; val_gene_expr_recon_loss: 86530.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167928.4766; val_optim_loss: 167928.4766
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9789; val_auprc_score: 0.9947; val_best_acc_score: 0.9718; val_best_f1_score: 0.9836; train_kl_reg_loss: 1946.8150; train_edge_recon_loss: 75199.6448; train_gene_expr_recon_loss: 87422.6624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164569.1228; train_optim_loss: 164569.1228; val_kl_reg_loss: 1923.6151; val_edge_recon_loss: 75060.6758; val_gene_expr_recon_loss: 87738.1992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164722.4844; val_optim_loss: 164722.4844
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9761; val_auprc_score: 0.9931; val_best_acc_score: 0.9726; val_best_f1_score: 0.9842; train_kl_reg_loss: 1940.6184; train_edge_recon_loss: 77536.8862; train_gene_expr_recon_loss: 87463.1775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166940.6797; train_optim_loss: 166940.6797; val_kl_reg_loss: 1910.0533; val_edge_recon_loss: 73085.9805; val_gene_expr_recon_loss: 88222.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163218.4375; val_optim_loss: 163218.4375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9772; val_auprc_score: 0.9929; val_best_acc_score: 0.9723; val_best_f1_score: 0.9839; train_kl_reg_loss: 1933.6381; train_edge_recon_loss: 78005.5681; train_gene_expr_recon_loss: 87371.9788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167311.1830; train_optim_loss: 167311.1830; val_kl_reg_loss: 1905.4507; val_edge_recon_loss: 78511.6836; val_gene_expr_recon_loss: 87686.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168103.8203; val_optim_loss: 168103.8203
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9823; val_auprc_score: 0.9949; val_best_acc_score: 0.9744; val_best_f1_score: 0.9850; train_kl_reg_loss: 1934.0460; train_edge_recon_loss: 76702.3845; train_gene_expr_recon_loss: 87260.8912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165897.3214; train_optim_loss: 165897.3214; val_kl_reg_loss: 1904.7022; val_edge_recon_loss: 78641.4102; val_gene_expr_recon_loss: 86605.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167151.9844; val_optim_loss: 167151.9844
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9760; val_auprc_score: 0.9936; val_best_acc_score: 0.9704; val_best_f1_score: 0.9827; train_kl_reg_loss: 1937.4662; train_edge_recon_loss: 77781.9810; train_gene_expr_recon_loss: 87444.3387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167163.7835; train_optim_loss: 167163.7835; val_kl_reg_loss: 1902.8890; val_edge_recon_loss: 80704.2109; val_gene_expr_recon_loss: 86627.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169234.7812; val_optim_loss: 169234.7812

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 0 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9797
Val AUPRC score: 0.9957
Val best accuracy score: 0.9718
Val best F1 score: 0.9835
Val gene expr MSE score: 0.9253
Duration of model training in run 3: 0 hours, 1 minutes and 1 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 53693
Number of validation edges: 5965
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9568; val_auprc_score: 0.9915; val_best_acc_score: 0.9274; val_best_f1_score: 0.9580; train_kl_reg_loss: 164.6709; train_edge_recon_loss: 102316.4542; train_gene_expr_recon_loss: 105565.3767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208046.5011; train_optim_loss: 208046.5011; val_kl_reg_loss: 135.5214; val_edge_recon_loss: 111534.9219; val_gene_expr_recon_loss: 97761.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209432.0000; val_optim_loss: 209432.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8669; val_auprc_score: 0.9717; val_best_acc_score: 0.8940; val_best_f1_score: 0.9407; train_kl_reg_loss: 253.0201; train_edge_recon_loss: 98884.0698; train_gene_expr_recon_loss: 94391.0480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193528.1373; train_optim_loss: 193528.1373; val_kl_reg_loss: 617.7509; val_edge_recon_loss: 92262.4180; val_gene_expr_recon_loss: 95090.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187970.8828; val_optim_loss: 187970.8828
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8887; val_auprc_score: 0.9756; val_best_acc_score: 0.9020; val_best_f1_score: 0.9447; train_kl_reg_loss: 1523.0331; train_edge_recon_loss: 89610.2578; train_gene_expr_recon_loss: 92997.9051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184131.1975; train_optim_loss: 184131.1975; val_kl_reg_loss: 2585.7067; val_edge_recon_loss: 82891.9414; val_gene_expr_recon_loss: 94753.1914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180230.8359; val_optim_loss: 180230.8359
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9232; val_auprc_score: 0.9838; val_best_acc_score: 0.9131; val_best_f1_score: 0.9501; train_kl_reg_loss: 2780.8789; train_edge_recon_loss: 83553.9994; train_gene_expr_recon_loss: 91912.4174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178247.2958; train_optim_loss: 178247.2958; val_kl_reg_loss: 2704.1680; val_edge_recon_loss: 84633.0391; val_gene_expr_recon_loss: 93564.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180901.8828; val_optim_loss: 180901.8828
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9546; val_auprc_score: 0.9897; val_best_acc_score: 0.9367; val_best_f1_score: 0.9638; train_kl_reg_loss: 2408.6365; train_edge_recon_loss: 80742.2796; train_gene_expr_recon_loss: 91369.6267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174520.5435; train_optim_loss: 174520.5435; val_kl_reg_loss: 2214.0271; val_edge_recon_loss: 74335.0117; val_gene_expr_recon_loss: 92171.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168720.0625; val_optim_loss: 168720.0625
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9689; val_auprc_score: 0.9922; val_best_acc_score: 0.9505; val_best_f1_score: 0.9715; train_kl_reg_loss: 2230.8275; train_edge_recon_loss: 78964.7815; train_gene_expr_recon_loss: 90754.9849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171950.5960; train_optim_loss: 171950.5960; val_kl_reg_loss: 2187.5065; val_edge_recon_loss: 76026.4023; val_gene_expr_recon_loss: 91598.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169812.2891; val_optim_loss: 169812.2891
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9668; val_auprc_score: 0.9921; val_best_acc_score: 0.9560; val_best_f1_score: 0.9745; train_kl_reg_loss: 2166.7331; train_edge_recon_loss: 79218.4381; train_gene_expr_recon_loss: 90207.8242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171592.9955; train_optim_loss: 171592.9955; val_kl_reg_loss: 2100.2122; val_edge_recon_loss: 76566.4805; val_gene_expr_recon_loss: 91411.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170078.3203; val_optim_loss: 170078.3203
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9734; val_auprc_score: 0.9924; val_best_acc_score: 0.9599; val_best_f1_score: 0.9767; train_kl_reg_loss: 2127.4221; train_edge_recon_loss: 79127.3075; train_gene_expr_recon_loss: 89833.6590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171088.3884; train_optim_loss: 171088.3884; val_kl_reg_loss: 2098.5563; val_edge_recon_loss: 77394.3125; val_gene_expr_recon_loss: 91627.5898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171120.4609; val_optim_loss: 171120.4609

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9753; val_auprc_score: 0.9940; val_best_acc_score: 0.9589; val_best_f1_score: 0.9759; train_kl_reg_loss: 2114.2882; train_edge_recon_loss: 78629.6166; train_gene_expr_recon_loss: 89475.0815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170218.9877; train_optim_loss: 170218.9877; val_kl_reg_loss: 2061.9818; val_edge_recon_loss: 82964.8594; val_gene_expr_recon_loss: 91441.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176468.2031; val_optim_loss: 176468.2031
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9743; val_auprc_score: 0.9935; val_best_acc_score: 0.9629; val_best_f1_score: 0.9785; train_kl_reg_loss: 2089.6824; train_edge_recon_loss: 78752.4780; train_gene_expr_recon_loss: 89451.0965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170293.2556; train_optim_loss: 170293.2556; val_kl_reg_loss: 2049.2615; val_edge_recon_loss: 77489.0547; val_gene_expr_recon_loss: 90493.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170032.1016; val_optim_loss: 170032.1016
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9781; val_auprc_score: 0.9944; val_best_acc_score: 0.9627; val_best_f1_score: 0.9785; train_kl_reg_loss: 2076.1645; train_edge_recon_loss: 78698.6144; train_gene_expr_recon_loss: 89372.4604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170147.2388; train_optim_loss: 170147.2388; val_kl_reg_loss: 2054.9500; val_edge_recon_loss: 73904.4648; val_gene_expr_recon_loss: 91733.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167693.0469; val_optim_loss: 167693.0469
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9719; val_auprc_score: 0.9924; val_best_acc_score: 0.9635; val_best_f1_score: 0.9789; train_kl_reg_loss: 2075.8973; train_edge_recon_loss: 77561.6194; train_gene_expr_recon_loss: 89199.8956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168837.4118; train_optim_loss: 168837.4118; val_kl_reg_loss: 2050.6067; val_edge_recon_loss: 75629.5195; val_gene_expr_recon_loss: 91254.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168934.2969; val_optim_loss: 168934.2969
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9730; val_auprc_score: 0.9916; val_best_acc_score: 0.9640; val_best_f1_score: 0.9790; train_kl_reg_loss: 2072.5090; train_edge_recon_loss: 77616.5737; train_gene_expr_recon_loss: 89237.6289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168926.7132; train_optim_loss: 168926.7132; val_kl_reg_loss: 2034.0388; val_edge_recon_loss: 78097.7695; val_gene_expr_recon_loss: 91529.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171660.9766; val_optim_loss: 171660.9766
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9726; val_auprc_score: 0.9928; val_best_acc_score: 0.9609; val_best_f1_score: 0.9774; train_kl_reg_loss: 2074.7932; train_edge_recon_loss: 77558.8527; train_gene_expr_recon_loss: 89496.5195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169130.1641; train_optim_loss: 169130.1641; val_kl_reg_loss: 2030.2802; val_edge_recon_loss: 76397.2578; val_gene_expr_recon_loss: 91058.7070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169486.2422; val_optim_loss: 169486.2422

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9726; val_auprc_score: 0.9942; val_best_acc_score: 0.9593; val_best_f1_score: 0.9766; train_kl_reg_loss: 2071.6585; train_edge_recon_loss: 78385.4604; train_gene_expr_recon_loss: 89155.9386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169613.0580; train_optim_loss: 169613.0580; val_kl_reg_loss: 2034.1169; val_edge_recon_loss: 77749.0234; val_gene_expr_recon_loss: 90876.7773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170659.9219; val_optim_loss: 170659.9219
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9736; val_auprc_score: 0.9940; val_best_acc_score: 0.9618; val_best_f1_score: 0.9778; train_kl_reg_loss: 2072.3254; train_edge_recon_loss: 78424.6802; train_gene_expr_recon_loss: 89320.0949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169817.1016; train_optim_loss: 169817.1016; val_kl_reg_loss: 2045.6984; val_edge_recon_loss: 78723.9375; val_gene_expr_recon_loss: 90853.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171622.8047; val_optim_loss: 171622.8047
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9685; val_auprc_score: 0.9920; val_best_acc_score: 0.9581; val_best_f1_score: 0.9759; train_kl_reg_loss: 2072.4302; train_edge_recon_loss: 78888.4911; train_gene_expr_recon_loss: 89221.8231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170182.7444; train_optim_loss: 170182.7444; val_kl_reg_loss: 2031.5327; val_edge_recon_loss: 76151.7734; val_gene_expr_recon_loss: 91329.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169512.9219; val_optim_loss: 169512.9219

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 59 sec.
Using best model state, which was in epoch 11.

--- MODEL EVALUATION ---
Val AUROC score: 0.9695
Val AUPRC score: 0.9910
Val best accuracy score: 0.9612
Val best F1 score: 0.9777
Val gene expr MSE score: 1.1123
Duration of model training in run 4: 0 hours, 1 minutes and 1 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 80320
Number of validation edges: 8924
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8918; val_auprc_score: 0.9768; val_best_acc_score: 0.9021; val_best_f1_score: 0.9448; train_kl_reg_loss: 256.1778; train_edge_recon_loss: 98106.9768; train_gene_expr_recon_loss: 97909.6619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196272.8164; train_optim_loss: 196272.8164; val_kl_reg_loss: 789.1179; val_edge_recon_loss: 90505.3656; val_gene_expr_recon_loss: 93371.7641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184666.2469; val_optim_loss: 184666.2469
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9459; val_auprc_score: 0.9877; val_best_acc_score: 0.9357; val_best_f1_score: 0.9630; train_kl_reg_loss: 2225.2220; train_edge_recon_loss: 84300.6598; train_gene_expr_recon_loss: 90605.6256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177131.5082; train_optim_loss: 177131.5082; val_kl_reg_loss: 2296.7973; val_edge_recon_loss: 81383.2266; val_gene_expr_recon_loss: 91480.8953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175160.9156; val_optim_loss: 175160.9156
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9642; val_auprc_score: 0.9919; val_best_acc_score: 0.9567; val_best_f1_score: 0.9751; train_kl_reg_loss: 2179.5587; train_edge_recon_loss: 79409.7371; train_gene_expr_recon_loss: 88877.7973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170467.0930; train_optim_loss: 170467.0930; val_kl_reg_loss: 2081.7429; val_edge_recon_loss: 77526.4344; val_gene_expr_recon_loss: 89798.6891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169406.8656; val_optim_loss: 169406.8656
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9749; val_auprc_score: 0.9927; val_best_acc_score: 0.9660; val_best_f1_score: 0.9802; train_kl_reg_loss: 2023.8785; train_edge_recon_loss: 78714.1992; train_gene_expr_recon_loss: 87819.3838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168557.4617; train_optim_loss: 168557.4617; val_kl_reg_loss: 1991.7567; val_edge_recon_loss: 78740.0891; val_gene_expr_recon_loss: 89569.4187; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170301.2594; val_optim_loss: 170301.2594
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9811; val_auprc_score: 0.9958; val_best_acc_score: 0.9697; val_best_f1_score: 0.9825; train_kl_reg_loss: 1989.1170; train_edge_recon_loss: 78182.4715; train_gene_expr_recon_loss: 87124.6734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167296.2617; train_optim_loss: 167296.2617; val_kl_reg_loss: 1960.4069; val_edge_recon_loss: 78544.4125; val_gene_expr_recon_loss: 88393.7672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168898.5875; val_optim_loss: 168898.5875
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9748; val_auprc_score: 0.9924; val_best_acc_score: 0.9661; val_best_f1_score: 0.9804; train_kl_reg_loss: 1986.8403; train_edge_recon_loss: 78056.6159; train_gene_expr_recon_loss: 86336.3439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166379.8008; train_optim_loss: 166379.8008; val_kl_reg_loss: 1924.0872; val_edge_recon_loss: 78864.2078; val_gene_expr_recon_loss: 87913.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168701.4281; val_optim_loss: 168701.4281
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9823; val_auprc_score: 0.9953; val_best_acc_score: 0.9696; val_best_f1_score: 0.9823; train_kl_reg_loss: 1931.7793; train_edge_recon_loss: 77854.0607; train_gene_expr_recon_loss: 86116.4811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165902.3211; train_optim_loss: 165902.3211; val_kl_reg_loss: 1938.7225; val_edge_recon_loss: 78298.5984; val_gene_expr_recon_loss: 87086.7922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167324.1156; val_optim_loss: 167324.1156
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9808; val_auprc_score: 0.9952; val_best_acc_score: 0.9732; val_best_f1_score: 0.9845; train_kl_reg_loss: 1944.0226; train_edge_recon_loss: 76661.2811; train_gene_expr_recon_loss: 85573.9199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164179.2246; train_optim_loss: 164179.2246; val_kl_reg_loss: 1911.5125; val_edge_recon_loss: 75567.5391; val_gene_expr_recon_loss: 86833.4797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164312.5312; val_optim_loss: 164312.5312
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9815; val_auprc_score: 0.9957; val_best_acc_score: 0.9752; val_best_f1_score: 0.9856; train_kl_reg_loss: 1933.7283; train_edge_recon_loss: 77468.0006; train_gene_expr_recon_loss: 85094.9092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164496.6391; train_optim_loss: 164496.6391; val_kl_reg_loss: 1870.0914; val_edge_recon_loss: 74051.7422; val_gene_expr_recon_loss: 86616.1266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162537.9594; val_optim_loss: 162537.9594
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9776; val_auprc_score: 0.9945; val_best_acc_score: 0.9725; val_best_f1_score: 0.9841; train_kl_reg_loss: 1915.7998; train_edge_recon_loss: 78059.4758; train_gene_expr_recon_loss: 84819.4777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164794.7516; train_optim_loss: 164794.7516; val_kl_reg_loss: 1876.9926; val_edge_recon_loss: 75696.4797; val_gene_expr_recon_loss: 85953.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163526.5312; val_optim_loss: 163526.5312
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9797; val_auprc_score: 0.9935; val_best_acc_score: 0.9742; val_best_f1_score: 0.9851; train_kl_reg_loss: 1906.0112; train_edge_recon_loss: 77210.1764; train_gene_expr_recon_loss: 84675.5867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163791.7746; train_optim_loss: 163791.7746; val_kl_reg_loss: 1880.6455; val_edge_recon_loss: 74972.2578; val_gene_expr_recon_loss: 86457.1594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163310.0625; val_optim_loss: 163310.0625
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9799; val_auprc_score: 0.9923; val_best_acc_score: 0.9754; val_best_f1_score: 0.9857; train_kl_reg_loss: 1901.4504; train_edge_recon_loss: 76697.4789; train_gene_expr_recon_loss: 84247.6383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162846.5668; train_optim_loss: 162846.5668; val_kl_reg_loss: 1906.5751; val_edge_recon_loss: 76056.5031; val_gene_expr_recon_loss: 86052.2859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164015.3594; val_optim_loss: 164015.3594

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9836; val_auprc_score: 0.9950; val_best_acc_score: 0.9747; val_best_f1_score: 0.9852; train_kl_reg_loss: 1919.0089; train_edge_recon_loss: 76583.7355; train_gene_expr_recon_loss: 83941.1547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162443.8980; train_optim_loss: 162443.8980; val_kl_reg_loss: 1881.1927; val_edge_recon_loss: 80395.3047; val_gene_expr_recon_loss: 85604.5766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167881.0719; val_optim_loss: 167881.0719
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9773; val_auprc_score: 0.9914; val_best_acc_score: 0.9747; val_best_f1_score: 0.9853; train_kl_reg_loss: 1892.7563; train_edge_recon_loss: 76984.1678; train_gene_expr_recon_loss: 83782.3850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162659.3098; train_optim_loss: 162659.3098; val_kl_reg_loss: 1872.7951; val_edge_recon_loss: 77459.0578; val_gene_expr_recon_loss: 85776.4234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165108.2781; val_optim_loss: 165108.2781
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9853; val_auprc_score: 0.9956; val_best_acc_score: 0.9766; val_best_f1_score: 0.9864; train_kl_reg_loss: 1899.8214; train_edge_recon_loss: 76905.2635; train_gene_expr_recon_loss: 83771.6740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162576.7594; train_optim_loss: 162576.7594; val_kl_reg_loss: 1879.5745; val_edge_recon_loss: 76861.7031; val_gene_expr_recon_loss: 85661.2453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164402.5187; val_optim_loss: 164402.5187

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 9 sec.
Using best model state, which was in epoch 9.

--- MODEL EVALUATION ---
Val AUROC score: 0.9822
Val AUPRC score: 0.9963
Val best accuracy score: 0.9728
Val best F1 score: 0.9844
Val gene expr MSE score: 0.9470
Duration of model training in run 5: 0 hours, 1 minutes and 12 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 80320
Number of validation edges: 8924
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8680; val_auprc_score: 0.9723; val_best_acc_score: 0.8929; val_best_f1_score: 0.9401; train_kl_reg_loss: 256.0044; train_edge_recon_loss: 99444.8721; train_gene_expr_recon_loss: 97927.4854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197628.3605; train_optim_loss: 197628.3605; val_kl_reg_loss: 763.4577; val_edge_recon_loss: 89990.9422; val_gene_expr_recon_loss: 91684.1234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182438.5250; val_optim_loss: 182438.5250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9497; val_auprc_score: 0.9873; val_best_acc_score: 0.9358; val_best_f1_score: 0.9628; train_kl_reg_loss: 2157.2170; train_edge_recon_loss: 85325.4461; train_gene_expr_recon_loss: 90491.6117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177974.2738; train_optim_loss: 177974.2738; val_kl_reg_loss: 2249.9152; val_edge_recon_loss: 82653.3438; val_gene_expr_recon_loss: 89327.8844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174231.1406; val_optim_loss: 174231.1406
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9708; val_auprc_score: 0.9936; val_best_acc_score: 0.9591; val_best_f1_score: 0.9765; train_kl_reg_loss: 2158.9610; train_edge_recon_loss: 78769.6242; train_gene_expr_recon_loss: 88996.8387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169925.4250; train_optim_loss: 169925.4250; val_kl_reg_loss: 2083.1935; val_edge_recon_loss: 76163.0578; val_gene_expr_recon_loss: 88271.3547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166517.6094; val_optim_loss: 166517.6094
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9729; val_auprc_score: 0.9923; val_best_acc_score: 0.9636; val_best_f1_score: 0.9789; train_kl_reg_loss: 2062.7185; train_edge_recon_loss: 78697.5920; train_gene_expr_recon_loss: 87834.8887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168595.1988; train_optim_loss: 168595.1988; val_kl_reg_loss: 1992.8803; val_edge_recon_loss: 78088.5031; val_gene_expr_recon_loss: 86975.7906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167057.1750; val_optim_loss: 167057.1750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9771; val_auprc_score: 0.9943; val_best_acc_score: 0.9687; val_best_f1_score: 0.9818; train_kl_reg_loss: 2005.7612; train_edge_recon_loss: 77315.6338; train_gene_expr_recon_loss: 87162.0732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166483.4672; train_optim_loss: 166483.4672; val_kl_reg_loss: 1969.8542; val_edge_recon_loss: 78392.8344; val_gene_expr_recon_loss: 86276.3016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166638.9906; val_optim_loss: 166638.9906
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9768; val_auprc_score: 0.9935; val_best_acc_score: 0.9708; val_best_f1_score: 0.9831; train_kl_reg_loss: 1973.8719; train_edge_recon_loss: 76962.1221; train_gene_expr_recon_loss: 86462.6617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165398.6559; train_optim_loss: 165398.6559; val_kl_reg_loss: 1880.6651; val_edge_recon_loss: 75943.6062; val_gene_expr_recon_loss: 85748.1906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163572.4594; val_optim_loss: 163572.4594
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9779; val_auprc_score: 0.9929; val_best_acc_score: 0.9699; val_best_f1_score: 0.9826; train_kl_reg_loss: 1941.9814; train_edge_recon_loss: 76827.3553; train_gene_expr_recon_loss: 85837.7463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164607.0840; train_optim_loss: 164607.0840; val_kl_reg_loss: 1910.2775; val_edge_recon_loss: 77763.8953; val_gene_expr_recon_loss: 85130.7297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164804.9062; val_optim_loss: 164804.9062
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9777; val_auprc_score: 0.9937; val_best_acc_score: 0.9737; val_best_f1_score: 0.9847; train_kl_reg_loss: 1945.3449; train_edge_recon_loss: 78080.2420; train_gene_expr_recon_loss: 85486.9871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165512.5734; train_optim_loss: 165512.5734; val_kl_reg_loss: 1932.4172; val_edge_recon_loss: 77630.8672; val_gene_expr_recon_loss: 85552.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165115.3594; val_optim_loss: 165115.3594
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9827; val_auprc_score: 0.9946; val_best_acc_score: 0.9745; val_best_f1_score: 0.9852; train_kl_reg_loss: 1920.7913; train_edge_recon_loss: 76937.2473; train_gene_expr_recon_loss: 85083.4512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163941.4902; train_optim_loss: 163941.4902; val_kl_reg_loss: 1900.6650; val_edge_recon_loss: 78401.7609; val_gene_expr_recon_loss: 84865.9328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165168.3563; val_optim_loss: 165168.3563

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9836; val_auprc_score: 0.9946; val_best_acc_score: 0.9749; val_best_f1_score: 0.9854; train_kl_reg_loss: 1929.1460; train_edge_recon_loss: 76652.4771; train_gene_expr_recon_loss: 84979.9377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163561.5602; train_optim_loss: 163561.5602; val_kl_reg_loss: 1897.6000; val_edge_recon_loss: 76403.4703; val_gene_expr_recon_loss: 84345.6203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162646.6875; val_optim_loss: 162646.6875
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9824; val_auprc_score: 0.9961; val_best_acc_score: 0.9738; val_best_f1_score: 0.9849; train_kl_reg_loss: 1913.6072; train_edge_recon_loss: 76070.1736; train_gene_expr_recon_loss: 84537.6604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162521.4406; train_optim_loss: 162521.4406; val_kl_reg_loss: 1889.7983; val_edge_recon_loss: 75412.5437; val_gene_expr_recon_loss: 84225.0172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161527.3594; val_optim_loss: 161527.3594
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9842; val_auprc_score: 0.9958; val_best_acc_score: 0.9767; val_best_f1_score: 0.9864; train_kl_reg_loss: 1907.8871; train_edge_recon_loss: 77220.4217; train_gene_expr_recon_loss: 84689.4811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163817.7898; train_optim_loss: 163817.7898; val_kl_reg_loss: 1886.2648; val_edge_recon_loss: 76466.3859; val_gene_expr_recon_loss: 84426.7250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162779.3687; val_optim_loss: 162779.3687
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9829; val_auprc_score: 0.9949; val_best_acc_score: 0.9738; val_best_f1_score: 0.9847; train_kl_reg_loss: 1900.2779; train_edge_recon_loss: 75788.4811; train_gene_expr_recon_loss: 84595.4977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162284.2559; train_optim_loss: 162284.2559; val_kl_reg_loss: 1876.6565; val_edge_recon_loss: 77800.5984; val_gene_expr_recon_loss: 84925.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164602.3781; val_optim_loss: 164602.3781
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9826; val_auprc_score: 0.9942; val_best_acc_score: 0.9745; val_best_f1_score: 0.9851; train_kl_reg_loss: 1910.3846; train_edge_recon_loss: 77336.7189; train_gene_expr_recon_loss: 84552.4980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163799.6012; train_optim_loss: 163799.6012; val_kl_reg_loss: 1893.9860; val_edge_recon_loss: 78867.7109; val_gene_expr_recon_loss: 84185.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164946.9937; val_optim_loss: 164946.9937

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9802; val_auprc_score: 0.9943; val_best_acc_score: 0.9758; val_best_f1_score: 0.9858; train_kl_reg_loss: 1915.0835; train_edge_recon_loss: 77673.2518; train_gene_expr_recon_loss: 84565.1959; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164153.5309; train_optim_loss: 164153.5309; val_kl_reg_loss: 1891.5565; val_edge_recon_loss: 81577.9469; val_gene_expr_recon_loss: 84317.6859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167787.1875; val_optim_loss: 167787.1875
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9824; val_auprc_score: 0.9943; val_best_acc_score: 0.9761; val_best_f1_score: 0.9861; train_kl_reg_loss: 1911.5589; train_edge_recon_loss: 76834.1975; train_gene_expr_recon_loss: 84413.3506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163159.1074; train_optim_loss: 163159.1074; val_kl_reg_loss: 1887.5441; val_edge_recon_loss: 76334.2656; val_gene_expr_recon_loss: 84040.5844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162262.3937; val_optim_loss: 162262.3937
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9837; val_auprc_score: 0.9955; val_best_acc_score: 0.9766; val_best_f1_score: 0.9865; train_kl_reg_loss: 1911.8703; train_edge_recon_loss: 77936.5584; train_gene_expr_recon_loss: 84519.7311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164368.1617; train_optim_loss: 164368.1617; val_kl_reg_loss: 1889.5207; val_edge_recon_loss: 73621.1906; val_gene_expr_recon_loss: 84648.4703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160159.1844; val_optim_loss: 160159.1844
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9820; val_auprc_score: 0.9946; val_best_acc_score: 0.9739; val_best_f1_score: 0.9849; train_kl_reg_loss: 1909.9049; train_edge_recon_loss: 76423.8633; train_gene_expr_recon_loss: 84507.0268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162840.7945; train_optim_loss: 162840.7945; val_kl_reg_loss: 1889.2271; val_edge_recon_loss: 76621.1344; val_gene_expr_recon_loss: 84461.8406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162972.1969; val_optim_loss: 162972.1969
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9832; val_auprc_score: 0.9954; val_best_acc_score: 0.9780; val_best_f1_score: 0.9872; train_kl_reg_loss: 1912.1041; train_edge_recon_loss: 78771.3514; train_gene_expr_recon_loss: 84504.1385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165187.5934; train_optim_loss: 165187.5934; val_kl_reg_loss: 1895.2422; val_edge_recon_loss: 74265.1109; val_gene_expr_recon_loss: 84519.7563; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160680.1094; val_optim_loss: 160680.1094
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9803; val_auprc_score: 0.9941; val_best_acc_score: 0.9744; val_best_f1_score: 0.9849; train_kl_reg_loss: 1914.7456; train_edge_recon_loss: 76236.4173; train_gene_expr_recon_loss: 84599.9600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162751.1238; train_optim_loss: 162751.1238; val_kl_reg_loss: 1894.6493; val_edge_recon_loss: 79856.4234; val_gene_expr_recon_loss: 84247.8484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165998.9219; val_optim_loss: 165998.9219

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9826; val_auprc_score: 0.9943; val_best_acc_score: 0.9740; val_best_f1_score: 0.9849; train_kl_reg_loss: 1913.7748; train_edge_recon_loss: 76146.5764; train_gene_expr_recon_loss: 84516.2592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162576.6113; train_optim_loss: 162576.6113; val_kl_reg_loss: 1891.5659; val_edge_recon_loss: 77983.3781; val_gene_expr_recon_loss: 84637.2906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164512.2313; val_optim_loss: 164512.2313
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9803; val_auprc_score: 0.9946; val_best_acc_score: 0.9760; val_best_f1_score: 0.9861; train_kl_reg_loss: 1911.6824; train_edge_recon_loss: 76331.4660; train_gene_expr_recon_loss: 84561.8576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162805.0059; train_optim_loss: 162805.0059; val_kl_reg_loss: 1892.9373; val_edge_recon_loss: 76921.3047; val_gene_expr_recon_loss: 84567.9641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163382.2094; val_optim_loss: 163382.2094
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9837; val_auprc_score: 0.9952; val_best_acc_score: 0.9736; val_best_f1_score: 0.9846; train_kl_reg_loss: 1910.3589; train_edge_recon_loss: 76935.5520; train_gene_expr_recon_loss: 84552.9111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163398.8203; train_optim_loss: 163398.8203; val_kl_reg_loss: 1889.0383; val_edge_recon_loss: 77278.2609; val_gene_expr_recon_loss: 84795.6922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163962.9906; val_optim_loss: 163962.9906

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 46 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
Val AUROC score: 0.9840
Val AUPRC score: 0.9962
Val best accuracy score: 0.9758
Val best F1 score: 0.9860
Val gene expr MSE score: 0.8443
Duration of model training in run 6: 0 hours, 1 minutes and 49 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 106920
Number of validation edges: 11879
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9565; val_auprc_score: 0.9877; val_best_acc_score: 0.9458; val_best_f1_score: 0.9684; train_kl_reg_loss: 1274.4737; train_edge_recon_loss: 90934.2476; train_gene_expr_recon_loss: 92942.1166; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185150.8387; train_optim_loss: 185150.8387; val_kl_reg_loss: 2030.6062; val_edge_recon_loss: 83666.0228; val_gene_expr_recon_loss: 90555.0560; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176251.6849; val_optim_loss: 176251.6849
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9727; val_auprc_score: 0.9934; val_best_acc_score: 0.9630; val_best_f1_score: 0.9786; train_kl_reg_loss: 2008.2245; train_edge_recon_loss: 78711.1549; train_gene_expr_recon_loss: 87667.9404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168387.3198; train_optim_loss: 168387.3198; val_kl_reg_loss: 1967.8489; val_edge_recon_loss: 78980.2012; val_gene_expr_recon_loss: 88431.3685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169379.4180; val_optim_loss: 169379.4180
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9799; val_auprc_score: 0.9945; val_best_acc_score: 0.9717; val_best_f1_score: 0.9836; train_kl_reg_loss: 1949.1705; train_edge_recon_loss: 77946.0647; train_gene_expr_recon_loss: 86149.4830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166044.7183; train_optim_loss: 166044.7183; val_kl_reg_loss: 1955.0761; val_edge_recon_loss: 76098.3516; val_gene_expr_recon_loss: 87452.7148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165506.1445; val_optim_loss: 165506.1445
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9815; val_auprc_score: 0.9944; val_best_acc_score: 0.9740; val_best_f1_score: 0.9850; train_kl_reg_loss: 1907.9152; train_edge_recon_loss: 76847.2104; train_gene_expr_recon_loss: 85108.4379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163863.5647; train_optim_loss: 163863.5647; val_kl_reg_loss: 1883.4097; val_edge_recon_loss: 74591.4147; val_gene_expr_recon_loss: 86459.3021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162934.1276; val_optim_loss: 162934.1276
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9829; val_auprc_score: 0.9953; val_best_acc_score: 0.9755; val_best_f1_score: 0.9858; train_kl_reg_loss: 1893.1247; train_edge_recon_loss: 77301.6779; train_gene_expr_recon_loss: 84357.6392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163552.4420; train_optim_loss: 163552.4420; val_kl_reg_loss: 1886.1053; val_edge_recon_loss: 76191.9948; val_gene_expr_recon_loss: 85987.2695; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164065.3750; val_optim_loss: 164065.3750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9833; val_auprc_score: 0.9962; val_best_acc_score: 0.9782; val_best_f1_score: 0.9874; train_kl_reg_loss: 1887.8056; train_edge_recon_loss: 77526.3208; train_gene_expr_recon_loss: 83752.6208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163166.7475; train_optim_loss: 163166.7475; val_kl_reg_loss: 1858.7678; val_edge_recon_loss: 76280.6393; val_gene_expr_recon_loss: 85249.1992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163388.6055; val_optim_loss: 163388.6055
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9858; val_auprc_score: 0.9966; val_best_acc_score: 0.9779; val_best_f1_score: 0.9871; train_kl_reg_loss: 1882.1172; train_edge_recon_loss: 77026.3814; train_gene_expr_recon_loss: 83285.6464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162194.1443; train_optim_loss: 162194.1443; val_kl_reg_loss: 1876.7816; val_edge_recon_loss: 78977.7728; val_gene_expr_recon_loss: 84929.5755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165784.1328; val_optim_loss: 165784.1328

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9842; val_auprc_score: 0.9955; val_best_acc_score: 0.9786; val_best_f1_score: 0.9876; train_kl_reg_loss: 1882.4609; train_edge_recon_loss: 76686.4537; train_gene_expr_recon_loss: 82679.3141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161248.2287; train_optim_loss: 161248.2287; val_kl_reg_loss: 1858.2450; val_edge_recon_loss: 75855.4460; val_gene_expr_recon_loss: 84654.7741; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162368.4635; val_optim_loss: 162368.4635
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9831; val_auprc_score: 0.9956; val_best_acc_score: 0.9775; val_best_f1_score: 0.9869; train_kl_reg_loss: 1867.1874; train_edge_recon_loss: 76273.8626; train_gene_expr_recon_loss: 82544.3065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160685.3565; train_optim_loss: 160685.3565; val_kl_reg_loss: 1861.3170; val_edge_recon_loss: 78402.7546; val_gene_expr_recon_loss: 84495.6960; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164759.7682; val_optim_loss: 164759.7682
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9822; val_auprc_score: 0.9940; val_best_acc_score: 0.9782; val_best_f1_score: 0.9874; train_kl_reg_loss: 1873.2475; train_edge_recon_loss: 76776.5170; train_gene_expr_recon_loss: 82500.9106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161150.6759; train_optim_loss: 161150.6759; val_kl_reg_loss: 1861.5839; val_edge_recon_loss: 75727.6491; val_gene_expr_recon_loss: 84236.3503; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161825.5846; val_optim_loss: 161825.5846
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9845; val_auprc_score: 0.9956; val_best_acc_score: 0.9774; val_best_f1_score: 0.9868; train_kl_reg_loss: 1880.2225; train_edge_recon_loss: 76985.3540; train_gene_expr_recon_loss: 82471.6385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161337.2150; train_optim_loss: 161337.2150; val_kl_reg_loss: 1864.2847; val_edge_recon_loss: 78793.8158; val_gene_expr_recon_loss: 84340.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164998.3086; val_optim_loss: 164998.3086
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9843; val_auprc_score: 0.9962; val_best_acc_score: 0.9785; val_best_f1_score: 0.9875; train_kl_reg_loss: 1873.0406; train_edge_recon_loss: 76901.5253; train_gene_expr_recon_loss: 82413.2580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161187.8237; train_optim_loss: 161187.8237; val_kl_reg_loss: 1875.0906; val_edge_recon_loss: 76894.4727; val_gene_expr_recon_loss: 84255.5794; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163025.1458; val_optim_loss: 163025.1458
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9840; val_auprc_score: 0.9951; val_best_acc_score: 0.9790; val_best_f1_score: 0.9878; train_kl_reg_loss: 1881.5034; train_edge_recon_loss: 76754.7233; train_gene_expr_recon_loss: 82400.1914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161036.4176; train_optim_loss: 161036.4176; val_kl_reg_loss: 1854.5689; val_edge_recon_loss: 76078.8112; val_gene_expr_recon_loss: 84077.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162010.6654; val_optim_loss: 162010.6654

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9847; val_auprc_score: 0.9947; val_best_acc_score: 0.9798; val_best_f1_score: 0.9882; train_kl_reg_loss: 1868.0631; train_edge_recon_loss: 76731.1952; train_gene_expr_recon_loss: 82299.3874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160898.6452; train_optim_loss: 160898.6452; val_kl_reg_loss: 1858.7506; val_edge_recon_loss: 78207.0332; val_gene_expr_recon_loss: 84198.6758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164264.4596; val_optim_loss: 164264.4596
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9851; val_auprc_score: 0.9962; val_best_acc_score: 0.9781; val_best_f1_score: 0.9873; train_kl_reg_loss: 1873.3871; train_edge_recon_loss: 76632.9827; train_gene_expr_recon_loss: 82290.0565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160796.4257; train_optim_loss: 160796.4257; val_kl_reg_loss: 1865.6783; val_edge_recon_loss: 76852.7539; val_gene_expr_recon_loss: 84200.1758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162918.6081; val_optim_loss: 162918.6081
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9848; val_auprc_score: 0.9957; val_best_acc_score: 0.9788; val_best_f1_score: 0.9877; train_kl_reg_loss: 1879.0890; train_edge_recon_loss: 77504.2663; train_gene_expr_recon_loss: 82266.5709; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161649.9251; train_optim_loss: 161649.9251; val_kl_reg_loss: 1864.3593; val_edge_recon_loss: 75621.7389; val_gene_expr_recon_loss: 84193.6035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161679.7005; val_optim_loss: 161679.7005
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9856; val_auprc_score: 0.9963; val_best_acc_score: 0.9800; val_best_f1_score: 0.9883; train_kl_reg_loss: 1879.4221; train_edge_recon_loss: 77123.1914; train_gene_expr_recon_loss: 82265.3117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161267.9254; train_optim_loss: 161267.9254; val_kl_reg_loss: 1864.7196; val_edge_recon_loss: 76761.8815; val_gene_expr_recon_loss: 84221.7194; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162848.3203; val_optim_loss: 162848.3203
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9843; val_auprc_score: 0.9954; val_best_acc_score: 0.9786; val_best_f1_score: 0.9876; train_kl_reg_loss: 1876.4890; train_edge_recon_loss: 77742.7884; train_gene_expr_recon_loss: 82248.6107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161867.8882; train_optim_loss: 161867.8882; val_kl_reg_loss: 1865.0723; val_edge_recon_loss: 75801.9440; val_gene_expr_recon_loss: 84170.1979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161837.2161; val_optim_loss: 161837.2161
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9858; val_auprc_score: 0.9960; val_best_acc_score: 0.9774; val_best_f1_score: 0.9868; train_kl_reg_loss: 1875.0916; train_edge_recon_loss: 76523.6459; train_gene_expr_recon_loss: 82280.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160678.8744; train_optim_loss: 160678.8744; val_kl_reg_loss: 1865.0241; val_edge_recon_loss: 77028.1061; val_gene_expr_recon_loss: 84174.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163068.0430; val_optim_loss: 163068.0430

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9845; val_auprc_score: 0.9955; val_best_acc_score: 0.9787; val_best_f1_score: 0.9875; train_kl_reg_loss: 1875.5491; train_edge_recon_loss: 77094.8888; train_gene_expr_recon_loss: 82267.5644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161238.0027; train_optim_loss: 161238.0027; val_kl_reg_loss: 1864.2337; val_edge_recon_loss: 78316.6107; val_gene_expr_recon_loss: 84091.7546; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164272.5977; val_optim_loss: 164272.5977
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9847; val_auprc_score: 0.9961; val_best_acc_score: 0.9781; val_best_f1_score: 0.9873; train_kl_reg_loss: 1875.2605; train_edge_recon_loss: 76979.5458; train_gene_expr_recon_loss: 82243.4469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161098.2534; train_optim_loss: 161098.2534; val_kl_reg_loss: 1861.6711; val_edge_recon_loss: 76657.8997; val_gene_expr_recon_loss: 84246.2148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162765.7891; val_optim_loss: 162765.7891
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9830; val_auprc_score: 0.9938; val_best_acc_score: 0.9813; val_best_f1_score: 0.9891; train_kl_reg_loss: 1874.7718; train_edge_recon_loss: 76073.4297; train_gene_expr_recon_loss: 82257.1131; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160205.3150; train_optim_loss: 160205.3150; val_kl_reg_loss: 1862.3470; val_edge_recon_loss: 75343.9036; val_gene_expr_recon_loss: 84117.4355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161323.6849; val_optim_loss: 161323.6849
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9841; val_auprc_score: 0.9959; val_best_acc_score: 0.9788; val_best_f1_score: 0.9877; train_kl_reg_loss: 1875.0070; train_edge_recon_loss: 76955.1353; train_gene_expr_recon_loss: 82262.9084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161093.0513; train_optim_loss: 161093.0513; val_kl_reg_loss: 1863.8540; val_edge_recon_loss: 76531.2708; val_gene_expr_recon_loss: 84293.3464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162688.4727; val_optim_loss: 162688.4727
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9868; val_auprc_score: 0.9963; val_best_acc_score: 0.9794; val_best_f1_score: 0.9880; train_kl_reg_loss: 1874.9430; train_edge_recon_loss: 77351.2491; train_gene_expr_recon_loss: 82247.1734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161473.3661; train_optim_loss: 161473.3661; val_kl_reg_loss: 1861.5898; val_edge_recon_loss: 76209.1003; val_gene_expr_recon_loss: 84123.8464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162194.5339; val_optim_loss: 162194.5339
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9855; val_auprc_score: 0.9947; val_best_acc_score: 0.9790; val_best_f1_score: 0.9878; train_kl_reg_loss: 1874.7069; train_edge_recon_loss: 76371.4650; train_gene_expr_recon_loss: 82245.7098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160491.8815; train_optim_loss: 160491.8815; val_kl_reg_loss: 1862.3895; val_edge_recon_loss: 77075.9173; val_gene_expr_recon_loss: 84258.1777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163196.4844; val_optim_loss: 163196.4844

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9851; val_auprc_score: 0.9946; val_best_acc_score: 0.9790; val_best_f1_score: 0.9877; train_kl_reg_loss: 1874.8965; train_edge_recon_loss: 76041.4837; train_gene_expr_recon_loss: 82257.3324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160173.7121; train_optim_loss: 160173.7121; val_kl_reg_loss: 1862.1186; val_edge_recon_loss: 77486.2969; val_gene_expr_recon_loss: 84131.3893; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163479.8073; val_optim_loss: 163479.8073
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9876; val_auprc_score: 0.9967; val_best_acc_score: 0.9793; val_best_f1_score: 0.9879; train_kl_reg_loss: 1874.7186; train_edge_recon_loss: 76445.8489; train_gene_expr_recon_loss: 82242.3735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160562.9409; train_optim_loss: 160562.9409; val_kl_reg_loss: 1862.9462; val_edge_recon_loss: 79416.6608; val_gene_expr_recon_loss: 84119.3939; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165398.9974; val_optim_loss: 165398.9974
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9860; val_auprc_score: 0.9966; val_best_acc_score: 0.9799; val_best_f1_score: 0.9883; train_kl_reg_loss: 1874.4433; train_edge_recon_loss: 76698.7310; train_gene_expr_recon_loss: 82265.0031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160838.1769; train_optim_loss: 160838.1769; val_kl_reg_loss: 1860.4217; val_edge_recon_loss: 76033.1315; val_gene_expr_recon_loss: 84036.8464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161930.3997; val_optim_loss: 161930.3997

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 19 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
Val AUROC score: 0.9872
Val AUPRC score: 0.9969
Val best accuracy score: 0.9804
Val best F1 score: 0.9886
Val gene expr MSE score: 0.8318
Duration of model training in run 7: 0 hours, 5 minutes and 25 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 106920
Number of validation edges: 11879
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9607; val_auprc_score: 0.9899; val_best_acc_score: 0.9487; val_best_f1_score: 0.9704; train_kl_reg_loss: 1330.0135; train_edge_recon_loss: 90773.3292; train_gene_expr_recon_loss: 92962.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185065.7481; train_optim_loss: 185065.7481; val_kl_reg_loss: 2147.9949; val_edge_recon_loss: 81806.3678; val_gene_expr_recon_loss: 91241.5098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175195.8737; val_optim_loss: 175195.8737
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9747; val_auprc_score: 0.9921; val_best_acc_score: 0.9663; val_best_f1_score: 0.9805; train_kl_reg_loss: 2045.5849; train_edge_recon_loss: 78681.9863; train_gene_expr_recon_loss: 87593.8383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168321.4095; train_optim_loss: 168321.4095; val_kl_reg_loss: 1965.5316; val_edge_recon_loss: 78307.6855; val_gene_expr_recon_loss: 89027.7943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169301.0143; val_optim_loss: 169301.0143
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9779; val_auprc_score: 0.9946; val_best_acc_score: 0.9699; val_best_f1_score: 0.9825; train_kl_reg_loss: 1960.8839; train_edge_recon_loss: 78220.2786; train_gene_expr_recon_loss: 86046.5364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166227.6988; train_optim_loss: 166227.6988; val_kl_reg_loss: 1942.3228; val_edge_recon_loss: 78113.1699; val_gene_expr_recon_loss: 87821.4102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167876.9049; val_optim_loss: 167876.9049
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9820; val_auprc_score: 0.9952; val_best_acc_score: 0.9752; val_best_f1_score: 0.9857; train_kl_reg_loss: 1936.4868; train_edge_recon_loss: 77417.0248; train_gene_expr_recon_loss: 85039.6690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164393.1804; train_optim_loss: 164393.1804; val_kl_reg_loss: 1940.4345; val_edge_recon_loss: 74422.5326; val_gene_expr_recon_loss: 87118.0260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163480.9935; val_optim_loss: 163480.9935
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9814; val_auprc_score: 0.9940; val_best_acc_score: 0.9761; val_best_f1_score: 0.9861; train_kl_reg_loss: 1897.5756; train_edge_recon_loss: 77223.9996; train_gene_expr_recon_loss: 84300.8667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163422.4418; train_optim_loss: 163422.4418; val_kl_reg_loss: 1838.1997; val_edge_recon_loss: 75993.9473; val_gene_expr_recon_loss: 86451.9323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164284.0781; val_optim_loss: 164284.0781
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9820; val_auprc_score: 0.9949; val_best_acc_score: 0.9765; val_best_f1_score: 0.9864; train_kl_reg_loss: 1877.8400; train_edge_recon_loss: 76804.3903; train_gene_expr_recon_loss: 83672.3062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162354.5369; train_optim_loss: 162354.5369; val_kl_reg_loss: 1842.6795; val_edge_recon_loss: 75884.3568; val_gene_expr_recon_loss: 85842.7051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163569.7409; val_optim_loss: 163569.7409
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9809; val_auprc_score: 0.9939; val_best_acc_score: 0.9767; val_best_f1_score: 0.9864; train_kl_reg_loss: 1887.6869; train_edge_recon_loss: 76720.8078; train_gene_expr_recon_loss: 83170.6504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161779.1454; train_optim_loss: 161779.1454; val_kl_reg_loss: 1914.1936; val_edge_recon_loss: 79431.2728; val_gene_expr_recon_loss: 85165.4232; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166510.8880; val_optim_loss: 166510.8880

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9825; val_auprc_score: 0.9948; val_best_acc_score: 0.9774; val_best_f1_score: 0.9869; train_kl_reg_loss: 1893.7542; train_edge_recon_loss: 76849.7402; train_gene_expr_recon_loss: 82622.2094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161365.7024; train_optim_loss: 161365.7024; val_kl_reg_loss: 1874.7141; val_edge_recon_loss: 75753.2507; val_gene_expr_recon_loss: 85074.3724; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162702.3398; val_optim_loss: 162702.3398
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9834; val_auprc_score: 0.9952; val_best_acc_score: 0.9776; val_best_f1_score: 0.9870; train_kl_reg_loss: 1899.2331; train_edge_recon_loss: 77409.4824; train_gene_expr_recon_loss: 82469.8365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161778.5524; train_optim_loss: 161778.5524; val_kl_reg_loss: 1882.7413; val_edge_recon_loss: 76383.4206; val_gene_expr_recon_loss: 85146.1048; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163412.2669; val_optim_loss: 163412.2669
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9871; val_auprc_score: 0.9971; val_best_acc_score: 0.9808; val_best_f1_score: 0.9888; train_kl_reg_loss: 1884.1054; train_edge_recon_loss: 76833.8461; train_gene_expr_recon_loss: 82410.8382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161128.7909; train_optim_loss: 161128.7909; val_kl_reg_loss: 1854.6014; val_edge_recon_loss: 73576.5381; val_gene_expr_recon_loss: 84788.5905; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160219.7292; val_optim_loss: 160219.7292
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9814; val_auprc_score: 0.9948; val_best_acc_score: 0.9793; val_best_f1_score: 0.9880; train_kl_reg_loss: 1879.9296; train_edge_recon_loss: 76533.9251; train_gene_expr_recon_loss: 82362.2157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160776.0702; train_optim_loss: 160776.0702; val_kl_reg_loss: 1874.1866; val_edge_recon_loss: 74494.8893; val_gene_expr_recon_loss: 84755.7773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161124.8516; val_optim_loss: 161124.8516
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9845; val_auprc_score: 0.9960; val_best_acc_score: 0.9783; val_best_f1_score: 0.9873; train_kl_reg_loss: 1878.5748; train_edge_recon_loss: 76009.8358; train_gene_expr_recon_loss: 82311.4298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160199.8400; train_optim_loss: 160199.8400; val_kl_reg_loss: 1868.7156; val_edge_recon_loss: 76481.3060; val_gene_expr_recon_loss: 84736.7539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163086.7747; val_optim_loss: 163086.7747
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9846; val_auprc_score: 0.9955; val_best_acc_score: 0.9779; val_best_f1_score: 0.9871; train_kl_reg_loss: 1891.7192; train_edge_recon_loss: 76969.1273; train_gene_expr_recon_loss: 82274.9906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161135.8378; train_optim_loss: 161135.8378; val_kl_reg_loss: 1871.5636; val_edge_recon_loss: 76382.8053; val_gene_expr_recon_loss: 84555.2279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162809.5964; val_optim_loss: 162809.5964

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9822; val_auprc_score: 0.9944; val_best_acc_score: 0.9789; val_best_f1_score: 0.9877; train_kl_reg_loss: 1882.1670; train_edge_recon_loss: 76511.7580; train_gene_expr_recon_loss: 82225.1340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160619.0585; train_optim_loss: 160619.0585; val_kl_reg_loss: 1869.8786; val_edge_recon_loss: 76286.1237; val_gene_expr_recon_loss: 84485.8268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162641.8320; val_optim_loss: 162641.8320
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9866; val_auprc_score: 0.9954; val_best_acc_score: 0.9797; val_best_f1_score: 0.9882; train_kl_reg_loss: 1879.8613; train_edge_recon_loss: 77030.7192; train_gene_expr_recon_loss: 82213.0110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161123.5929; train_optim_loss: 161123.5929; val_kl_reg_loss: 1866.7772; val_edge_recon_loss: 73578.6582; val_gene_expr_recon_loss: 84713.3522; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160158.7852; val_optim_loss: 160158.7852
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9826; val_auprc_score: 0.9940; val_best_acc_score: 0.9781; val_best_f1_score: 0.9872; train_kl_reg_loss: 1879.3850; train_edge_recon_loss: 75915.9938; train_gene_expr_recon_loss: 82211.1109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160006.4902; train_optim_loss: 160006.4902; val_kl_reg_loss: 1866.8146; val_edge_recon_loss: 77301.2878; val_gene_expr_recon_loss: 84713.3294; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163881.4297; val_optim_loss: 163881.4297
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9872; val_auprc_score: 0.9964; val_best_acc_score: 0.9787; val_best_f1_score: 0.9876; train_kl_reg_loss: 1881.6766; train_edge_recon_loss: 76693.8268; train_gene_expr_recon_loss: 82179.8635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160755.3668; train_optim_loss: 160755.3668; val_kl_reg_loss: 1867.2924; val_edge_recon_loss: 76034.3138; val_gene_expr_recon_loss: 84557.0742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162458.6849; val_optim_loss: 162458.6849
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9818; val_auprc_score: 0.9930; val_best_acc_score: 0.9776; val_best_f1_score: 0.9870; train_kl_reg_loss: 1882.5053; train_edge_recon_loss: 77312.0911; train_gene_expr_recon_loss: 82178.8074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161373.4028; train_optim_loss: 161373.4028; val_kl_reg_loss: 1869.3210; val_edge_recon_loss: 76682.5762; val_gene_expr_recon_loss: 84760.5820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163312.4818; val_optim_loss: 163312.4818

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9853; val_auprc_score: 0.9951; val_best_acc_score: 0.9800; val_best_f1_score: 0.9883; train_kl_reg_loss: 1880.8707; train_edge_recon_loss: 76218.7461; train_gene_expr_recon_loss: 82167.1469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160266.7643; train_optim_loss: 160266.7643; val_kl_reg_loss: 1868.2989; val_edge_recon_loss: 77759.2975; val_gene_expr_recon_loss: 84726.0436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164353.6419; val_optim_loss: 164353.6419
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9853; val_auprc_score: 0.9965; val_best_acc_score: 0.9788; val_best_f1_score: 0.9876; train_kl_reg_loss: 1881.2131; train_edge_recon_loss: 76813.7593; train_gene_expr_recon_loss: 82148.1369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160843.1098; train_optim_loss: 160843.1098; val_kl_reg_loss: 1868.8151; val_edge_recon_loss: 78461.9642; val_gene_expr_recon_loss: 84589.6061; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164920.3828; val_optim_loss: 164920.3828
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9844; val_auprc_score: 0.9962; val_best_acc_score: 0.9783; val_best_f1_score: 0.9874; train_kl_reg_loss: 1880.6334; train_edge_recon_loss: 75823.1786; train_gene_expr_recon_loss: 82162.9728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159866.7860; train_optim_loss: 159866.7860; val_kl_reg_loss: 1868.9468; val_edge_recon_loss: 76193.2812; val_gene_expr_recon_loss: 84847.0247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162909.2552; val_optim_loss: 162909.2552

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 12 sec.
Using best model state, which was in epoch 15.

--- MODEL EVALUATION ---
Val AUROC score: 0.9843
Val AUPRC score: 0.9946
Val best accuracy score: 0.9786
Val best F1 score: 0.9875
Val gene expr MSE score: 0.8950
Duration of model training in run 8: 0 hours, 3 minutes and 18 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 133545
Number of validation edges: 14838
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9707; val_auprc_score: 0.9919; val_best_acc_score: 0.9622; val_best_f1_score: 0.9782; train_kl_reg_loss: 1508.0986; train_edge_recon_loss: 88548.1292; train_gene_expr_recon_loss: 92393.4742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182449.7019; train_optim_loss: 182449.7019; val_kl_reg_loss: 2002.0401; val_edge_recon_loss: 75874.0745; val_gene_expr_recon_loss: 86574.3823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164450.4958; val_optim_loss: 164450.4958
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9750; val_auprc_score: 0.9927; val_best_acc_score: 0.9690; val_best_f1_score: 0.9821; train_kl_reg_loss: 1943.2364; train_edge_recon_loss: 78112.9417; train_gene_expr_recon_loss: 87561.2090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167617.3868; train_optim_loss: 167617.3868; val_kl_reg_loss: 1923.3453; val_edge_recon_loss: 78500.1354; val_gene_expr_recon_loss: 84599.3286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165022.8073; val_optim_loss: 165022.8073
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9800; val_auprc_score: 0.9949; val_best_acc_score: 0.9731; val_best_f1_score: 0.9844; train_kl_reg_loss: 1909.6493; train_edge_recon_loss: 78626.9905; train_gene_expr_recon_loss: 86060.8322; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166597.4726; train_optim_loss: 166597.4726; val_kl_reg_loss: 1859.8161; val_edge_recon_loss: 76981.1500; val_gene_expr_recon_loss: 84003.9281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162844.8937; val_optim_loss: 162844.8937
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9802; val_auprc_score: 0.9940; val_best_acc_score: 0.9764; val_best_f1_score: 0.9863; train_kl_reg_loss: 1883.3628; train_edge_recon_loss: 77331.1347; train_gene_expr_recon_loss: 85083.2406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164297.7385; train_optim_loss: 164297.7385; val_kl_reg_loss: 1849.9738; val_edge_recon_loss: 76302.6969; val_gene_expr_recon_loss: 83214.1026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161366.7771; val_optim_loss: 161366.7771
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9834; val_auprc_score: 0.9949; val_best_acc_score: 0.9769; val_best_f1_score: 0.9866; train_kl_reg_loss: 1865.8691; train_edge_recon_loss: 76980.1228; train_gene_expr_recon_loss: 84240.4448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163086.4362; train_optim_loss: 163086.4362; val_kl_reg_loss: 1849.3845; val_edge_recon_loss: 76892.8755; val_gene_expr_recon_loss: 82162.9740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160905.2313; val_optim_loss: 160905.2313
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9810; val_auprc_score: 0.9950; val_best_acc_score: 0.9762; val_best_f1_score: 0.9862; train_kl_reg_loss: 1872.9820; train_edge_recon_loss: 76769.5064; train_gene_expr_recon_loss: 83641.3918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162283.8799; train_optim_loss: 162283.8799; val_kl_reg_loss: 1774.8117; val_edge_recon_loss: 77364.5909; val_gene_expr_recon_loss: 81979.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161118.9031; val_optim_loss: 161118.9031
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9844; val_auprc_score: 0.9952; val_best_acc_score: 0.9775; val_best_f1_score: 0.9868; train_kl_reg_loss: 1868.5944; train_edge_recon_loss: 77254.3724; train_gene_expr_recon_loss: 83013.3805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162136.3469; train_optim_loss: 162136.3469; val_kl_reg_loss: 1886.5402; val_edge_recon_loss: 79167.0229; val_gene_expr_recon_loss: 80554.1307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161607.6938; val_optim_loss: 161607.6938
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9861; val_auprc_score: 0.9962; val_best_acc_score: 0.9818; val_best_f1_score: 0.9894; train_kl_reg_loss: 1876.6800; train_edge_recon_loss: 77720.8931; train_gene_expr_recon_loss: 82480.7762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162078.3485; train_optim_loss: 162078.3485; val_kl_reg_loss: 1897.6951; val_edge_recon_loss: 74804.6281; val_gene_expr_recon_loss: 80434.2781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157136.6000; val_optim_loss: 157136.6000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9887; val_auprc_score: 0.9969; val_best_acc_score: 0.9828; val_best_f1_score: 0.9900; train_kl_reg_loss: 1884.0293; train_edge_recon_loss: 77701.2482; train_gene_expr_recon_loss: 82089.6440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161674.9219; train_optim_loss: 161674.9219; val_kl_reg_loss: 1867.1794; val_edge_recon_loss: 75756.5219; val_gene_expr_recon_loss: 80883.9516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158507.6542; val_optim_loss: 158507.6542
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9844; val_auprc_score: 0.9945; val_best_acc_score: 0.9804; val_best_f1_score: 0.9886; train_kl_reg_loss: 1877.5113; train_edge_recon_loss: 76132.7407; train_gene_expr_recon_loss: 81746.1078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159756.3600; train_optim_loss: 159756.3600; val_kl_reg_loss: 1846.0906; val_edge_recon_loss: 75503.7802; val_gene_expr_recon_loss: 80862.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158212.6594; val_optim_loss: 158212.6594
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9861; val_auprc_score: 0.9959; val_best_acc_score: 0.9807; val_best_f1_score: 0.9888; train_kl_reg_loss: 1886.9169; train_edge_recon_loss: 76314.4154; train_gene_expr_recon_loss: 81568.7356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159770.0681; train_optim_loss: 159770.0681; val_kl_reg_loss: 1877.8700; val_edge_recon_loss: 76474.4807; val_gene_expr_recon_loss: 79965.9229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158318.2729; val_optim_loss: 158318.2729

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9827; val_auprc_score: 0.9935; val_best_acc_score: 0.9808; val_best_f1_score: 0.9888; train_kl_reg_loss: 1893.0692; train_edge_recon_loss: 76083.4830; train_gene_expr_recon_loss: 80863.9391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158840.4914; train_optim_loss: 158840.4914; val_kl_reg_loss: 1868.8773; val_edge_recon_loss: 75295.8198; val_gene_expr_recon_loss: 78948.2432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156112.9427; val_optim_loss: 156112.9427
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9850; val_auprc_score: 0.9958; val_best_acc_score: 0.9824; val_best_f1_score: 0.9897; train_kl_reg_loss: 1883.4104; train_edge_recon_loss: 75717.2553; train_gene_expr_recon_loss: 80848.0475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158448.7135; train_optim_loss: 158448.7135; val_kl_reg_loss: 1859.0903; val_edge_recon_loss: 75583.6745; val_gene_expr_recon_loss: 78763.3422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156206.1083; val_optim_loss: 156206.1083
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9853; val_auprc_score: 0.9957; val_best_acc_score: 0.9797; val_best_f1_score: 0.9881; train_kl_reg_loss: 1888.6048; train_edge_recon_loss: 76550.0247; train_gene_expr_recon_loss: 80778.9757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159217.6047; train_optim_loss: 159217.6047; val_kl_reg_loss: 1871.3332; val_edge_recon_loss: 78459.3859; val_gene_expr_recon_loss: 79223.7964; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159554.5135; val_optim_loss: 159554.5135
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9853; val_auprc_score: 0.9957; val_best_acc_score: 0.9809; val_best_f1_score: 0.9889; train_kl_reg_loss: 1890.4730; train_edge_recon_loss: 75881.3399; train_gene_expr_recon_loss: 80735.7310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158507.5437; train_optim_loss: 158507.5437; val_kl_reg_loss: 1866.9753; val_edge_recon_loss: 76848.3122; val_gene_expr_recon_loss: 79592.0474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158307.3365; val_optim_loss: 158307.3365

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9853; val_auprc_score: 0.9956; val_best_acc_score: 0.9811; val_best_f1_score: 0.9890; train_kl_reg_loss: 1885.8723; train_edge_recon_loss: 76671.6701; train_gene_expr_recon_loss: 80701.1082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159258.6497; train_optim_loss: 159258.6497; val_kl_reg_loss: 1866.8759; val_edge_recon_loss: 76536.2594; val_gene_expr_recon_loss: 79402.2125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157805.3479; val_optim_loss: 157805.3479
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9844; val_auprc_score: 0.9956; val_best_acc_score: 0.9809; val_best_f1_score: 0.9889; train_kl_reg_loss: 1888.7532; train_edge_recon_loss: 76668.3398; train_gene_expr_recon_loss: 80633.4321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159190.5243; train_optim_loss: 159190.5243; val_kl_reg_loss: 1869.9651; val_edge_recon_loss: 76421.7531; val_gene_expr_recon_loss: 79422.2286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157713.9458; val_optim_loss: 157713.9458
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9881; val_auprc_score: 0.9967; val_best_acc_score: 0.9815; val_best_f1_score: 0.9892; train_kl_reg_loss: 1885.5840; train_edge_recon_loss: 76562.0395; train_gene_expr_recon_loss: 80650.3638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159097.9862; train_optim_loss: 159097.9862; val_kl_reg_loss: 1865.6346; val_edge_recon_loss: 76405.6359; val_gene_expr_recon_loss: 79401.6286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157672.8990; val_optim_loss: 157672.8990

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 39 sec.
Using best model state, which was in epoch 12.

--- MODEL EVALUATION ---
Val AUROC score: 0.9872
Val AUPRC score: 0.9960
Val best accuracy score: 0.9825
Val best F1 score: 0.9898
Val gene expr MSE score: 0.7881
Duration of model training in run 9: 0 hours, 4 minutes and 46 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 133545
Number of validation edges: 14838
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9655; val_auprc_score: 0.9915; val_best_acc_score: 0.9565; val_best_f1_score: 0.9750; train_kl_reg_loss: 1522.4852; train_edge_recon_loss: 87568.5468; train_gene_expr_recon_loss: 91586.7988; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180677.8312; train_optim_loss: 180677.8312; val_kl_reg_loss: 2034.3985; val_edge_recon_loss: 76447.1349; val_gene_expr_recon_loss: 89406.2099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167887.7437; val_optim_loss: 167887.7437
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9763; val_auprc_score: 0.9936; val_best_acc_score: 0.9706; val_best_f1_score: 0.9829; train_kl_reg_loss: 1965.1672; train_edge_recon_loss: 78151.8581; train_gene_expr_recon_loss: 86604.9213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166721.9473; train_optim_loss: 166721.9473; val_kl_reg_loss: 1948.1164; val_edge_recon_loss: 78207.0401; val_gene_expr_recon_loss: 86706.5589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166861.7156; val_optim_loss: 166861.7156
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9788; val_auprc_score: 0.9943; val_best_acc_score: 0.9732; val_best_f1_score: 0.9844; train_kl_reg_loss: 1906.1000; train_edge_recon_loss: 77381.9650; train_gene_expr_recon_loss: 85231.2619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164519.3269; train_optim_loss: 164519.3269; val_kl_reg_loss: 1939.2757; val_edge_recon_loss: 78090.8818; val_gene_expr_recon_loss: 84575.7990; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164605.9562; val_optim_loss: 164605.9562
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9826; val_auprc_score: 0.9949; val_best_acc_score: 0.9754; val_best_f1_score: 0.9857; train_kl_reg_loss: 1881.6154; train_edge_recon_loss: 76891.3286; train_gene_expr_recon_loss: 84283.6737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163056.6176; train_optim_loss: 163056.6176; val_kl_reg_loss: 1896.0834; val_edge_recon_loss: 77064.5995; val_gene_expr_recon_loss: 84500.9974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163461.6812; val_optim_loss: 163461.6812
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9855; val_auprc_score: 0.9961; val_best_acc_score: 0.9787; val_best_f1_score: 0.9875; train_kl_reg_loss: 1860.3000; train_edge_recon_loss: 76681.6794; train_gene_expr_recon_loss: 83691.1583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162233.1372; train_optim_loss: 162233.1372; val_kl_reg_loss: 1889.9660; val_edge_recon_loss: 78411.6536; val_gene_expr_recon_loss: 83955.8526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164257.4729; val_optim_loss: 164257.4729
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9840; val_auprc_score: 0.9952; val_best_acc_score: 0.9792; val_best_f1_score: 0.9878; train_kl_reg_loss: 1871.8885; train_edge_recon_loss: 77153.4503; train_gene_expr_recon_loss: 82983.5469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162008.8867; train_optim_loss: 162008.8867; val_kl_reg_loss: 1846.2693; val_edge_recon_loss: 78243.9797; val_gene_expr_recon_loss: 83922.2479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164012.5010; val_optim_loss: 164012.5010
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9845; val_auprc_score: 0.9957; val_best_acc_score: 0.9788; val_best_f1_score: 0.9877; train_kl_reg_loss: 1873.1900; train_edge_recon_loss: 76558.6961; train_gene_expr_recon_loss: 82633.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161065.5352; train_optim_loss: 161065.5352; val_kl_reg_loss: 1854.4257; val_edge_recon_loss: 75932.8766; val_gene_expr_recon_loss: 82208.4365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159995.7375; val_optim_loss: 159995.7375
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9846; val_auprc_score: 0.9955; val_best_acc_score: 0.9802; val_best_f1_score: 0.9885; train_kl_reg_loss: 1878.9676; train_edge_recon_loss: 76985.0683; train_gene_expr_recon_loss: 82097.6844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160961.7199; train_optim_loss: 160961.7199; val_kl_reg_loss: 1867.4798; val_edge_recon_loss: 74801.1057; val_gene_expr_recon_loss: 83156.4031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159824.9885; val_optim_loss: 159824.9885
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9839; val_auprc_score: 0.9951; val_best_acc_score: 0.9794; val_best_f1_score: 0.9880; train_kl_reg_loss: 1869.3156; train_edge_recon_loss: 76166.7414; train_gene_expr_recon_loss: 81624.4091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159660.4667; train_optim_loss: 159660.4667; val_kl_reg_loss: 1876.3138; val_edge_recon_loss: 76057.4885; val_gene_expr_recon_loss: 82425.9969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160359.7979; val_optim_loss: 160359.7979
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9870; val_auprc_score: 0.9956; val_best_acc_score: 0.9801; val_best_f1_score: 0.9884; train_kl_reg_loss: 1883.0033; train_edge_recon_loss: 76939.8044; train_gene_expr_recon_loss: 81398.5314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160221.3384; train_optim_loss: 160221.3384; val_kl_reg_loss: 1829.5937; val_edge_recon_loss: 78003.0167; val_gene_expr_recon_loss: 81737.5344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161570.1437; val_optim_loss: 161570.1437
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9844; val_auprc_score: 0.9951; val_best_acc_score: 0.9806; val_best_f1_score: 0.9887; train_kl_reg_loss: 1882.3078; train_edge_recon_loss: 76339.1630; train_gene_expr_recon_loss: 81130.6675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159352.1394; train_optim_loss: 159352.1394; val_kl_reg_loss: 1855.4603; val_edge_recon_loss: 75932.0698; val_gene_expr_recon_loss: 82350.6109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160138.1417; val_optim_loss: 160138.1417

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9884; val_auprc_score: 0.9971; val_best_acc_score: 0.9809; val_best_f1_score: 0.9889; train_kl_reg_loss: 1887.9554; train_edge_recon_loss: 76104.0443; train_gene_expr_recon_loss: 80702.1267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158694.1264; train_optim_loss: 158694.1264; val_kl_reg_loss: 1867.3987; val_edge_recon_loss: 75338.0182; val_gene_expr_recon_loss: 81246.4641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158451.8792; val_optim_loss: 158451.8792
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9823; val_auprc_score: 0.9937; val_best_acc_score: 0.9798; val_best_f1_score: 0.9883; train_kl_reg_loss: 1888.1023; train_edge_recon_loss: 76297.8012; train_gene_expr_recon_loss: 80346.9814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158532.8847; train_optim_loss: 158532.8847; val_kl_reg_loss: 1874.2991; val_edge_recon_loss: 77165.9120; val_gene_expr_recon_loss: 81650.1453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160690.3573; val_optim_loss: 160690.3573
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9875; val_auprc_score: 0.9964; val_best_acc_score: 0.9822; val_best_f1_score: 0.9896; train_kl_reg_loss: 1879.8034; train_edge_recon_loss: 76852.6660; train_gene_expr_recon_loss: 80404.8667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159137.3360; train_optim_loss: 159137.3360; val_kl_reg_loss: 1860.7482; val_edge_recon_loss: 76160.9349; val_gene_expr_recon_loss: 81838.8927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159860.5771; val_optim_loss: 159860.5771
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9851; val_auprc_score: 0.9956; val_best_acc_score: 0.9802; val_best_f1_score: 0.9885; train_kl_reg_loss: 1886.0585; train_edge_recon_loss: 76915.9280; train_gene_expr_recon_loss: 80240.2565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159042.2434; train_optim_loss: 159042.2434; val_kl_reg_loss: 1866.4179; val_edge_recon_loss: 76337.5133; val_gene_expr_recon_loss: 81067.0969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159271.0260; val_optim_loss: 159271.0260

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9853; val_auprc_score: 0.9954; val_best_acc_score: 0.9811; val_best_f1_score: 0.9890; train_kl_reg_loss: 1875.4757; train_edge_recon_loss: 76659.5120; train_gene_expr_recon_loss: 80313.5235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158848.5111; train_optim_loss: 158848.5111; val_kl_reg_loss: 1866.9237; val_edge_recon_loss: 74512.5052; val_gene_expr_recon_loss: 81338.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157717.6229; val_optim_loss: 157717.6229
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9852; val_auprc_score: 0.9946; val_best_acc_score: 0.9804; val_best_f1_score: 0.9886; train_kl_reg_loss: 1878.4015; train_edge_recon_loss: 76115.9968; train_gene_expr_recon_loss: 80276.4816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158270.8800; train_optim_loss: 158270.8800; val_kl_reg_loss: 1863.4299; val_edge_recon_loss: 76717.3844; val_gene_expr_recon_loss: 81097.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159678.2000; val_optim_loss: 159678.2000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9868; val_auprc_score: 0.9961; val_best_acc_score: 0.9809; val_best_f1_score: 0.9889; train_kl_reg_loss: 1879.6496; train_edge_recon_loss: 75987.2965; train_gene_expr_recon_loss: 80198.9577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158065.9037; train_optim_loss: 158065.9037; val_kl_reg_loss: 1864.6518; val_edge_recon_loss: 75883.3396; val_gene_expr_recon_loss: 81373.9161; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159121.9073; val_optim_loss: 159121.9073
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9851; val_auprc_score: 0.9955; val_best_acc_score: 0.9821; val_best_f1_score: 0.9896; train_kl_reg_loss: 1880.4873; train_edge_recon_loss: 75905.9133; train_gene_expr_recon_loss: 80273.2833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158059.6840; train_optim_loss: 158059.6840; val_kl_reg_loss: 1868.0181; val_edge_recon_loss: 74780.1281; val_gene_expr_recon_loss: 81218.7161; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157866.8625; val_optim_loss: 157866.8625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9862; val_auprc_score: 0.9964; val_best_acc_score: 0.9808; val_best_f1_score: 0.9888; train_kl_reg_loss: 1880.1731; train_edge_recon_loss: 76510.9583; train_gene_expr_recon_loss: 80153.7198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158544.8508; train_optim_loss: 158544.8508; val_kl_reg_loss: 1864.2604; val_edge_recon_loss: 76345.0906; val_gene_expr_recon_loss: 81364.4479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159573.8010; val_optim_loss: 159573.8010
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9881; val_auprc_score: 0.9967; val_best_acc_score: 0.9807; val_best_f1_score: 0.9888; train_kl_reg_loss: 1880.4644; train_edge_recon_loss: 75437.2557; train_gene_expr_recon_loss: 80189.3662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157507.0854; train_optim_loss: 157507.0854; val_kl_reg_loss: 1866.4801; val_edge_recon_loss: 76024.2755; val_gene_expr_recon_loss: 81329.5786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159220.3312; val_optim_loss: 159220.3312
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9874; val_auprc_score: 0.9966; val_best_acc_score: 0.9819; val_best_f1_score: 0.9895; train_kl_reg_loss: 1880.4860; train_edge_recon_loss: 76627.1368; train_gene_expr_recon_loss: 80261.8378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158769.4603; train_optim_loss: 158769.4603; val_kl_reg_loss: 1871.9334; val_edge_recon_loss: 76257.8458; val_gene_expr_recon_loss: 81576.2073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159705.9875; val_optim_loss: 159705.9875

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 31 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
Val AUROC score: 0.9839
Val AUPRC score: 0.9951
Val best accuracy score: 0.9797
Val best F1 score: 0.9882
Val gene expr MSE score: 0.8354
Duration of model training in run 10: 0 hours, 4 minutes and 37 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
First script finished. Launching follow up script.
Run timestamp: 02062023_110752.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '8192', '8192', '4096', '4096', '2048', '2048', '1024', '1024', '1024', '1024', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_50pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-attention_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-attention', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 54907
Number of validation edges: 6100
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9587; val_auprc_score: 0.9893; val_best_acc_score: 0.9337; val_best_f1_score: 0.9619; train_kl_reg_loss: 141.7171; train_edge_recon_loss: 101686.2801; train_gene_expr_recon_loss: 121151.9699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 222979.9665; train_optim_loss: 222979.9665; val_kl_reg_loss: 247.9933; val_edge_recon_loss: 115538.5781; val_gene_expr_recon_loss: 106297.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222084.1875; val_optim_loss: 222084.1875
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9483; val_auprc_score: 0.9897; val_best_acc_score: 0.9366; val_best_f1_score: 0.9637; train_kl_reg_loss: 190.3069; train_edge_recon_loss: 101771.7333; train_gene_expr_recon_loss: 103423.3080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205385.3482; train_optim_loss: 205385.3482; val_kl_reg_loss: 140.7208; val_edge_recon_loss: 102730.4062; val_gene_expr_recon_loss: 102016.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204887.2656; val_optim_loss: 204887.2656
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9144; val_auprc_score: 0.9798; val_best_acc_score: 0.9189; val_best_f1_score: 0.9536; train_kl_reg_loss: 199.3938; train_edge_recon_loss: 99438.0580; train_gene_expr_recon_loss: 100835.6942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200473.1451; train_optim_loss: 200473.1451; val_kl_reg_loss: 360.4684; val_edge_recon_loss: 94200.2969; val_gene_expr_recon_loss: 100563.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195123.9062; val_optim_loss: 195123.9062
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8779; val_auprc_score: 0.9716; val_best_acc_score: 0.9104; val_best_f1_score: 0.9489; train_kl_reg_loss: 789.7869; train_edge_recon_loss: 89366.5078; train_gene_expr_recon_loss: 99531.5670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189687.8616; train_optim_loss: 189687.8616; val_kl_reg_loss: 1644.7203; val_edge_recon_loss: 83355.8672; val_gene_expr_recon_loss: 99320.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184321.2656; val_optim_loss: 184321.2656
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8848; val_auprc_score: 0.9738; val_best_acc_score: 0.9098; val_best_f1_score: 0.9489; train_kl_reg_loss: 2460.0994; train_edge_recon_loss: 84635.7645; train_gene_expr_recon_loss: 98189.3739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185285.2366; train_optim_loss: 185285.2366; val_kl_reg_loss: 3162.4287; val_edge_recon_loss: 81482.0312; val_gene_expr_recon_loss: 98136.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182780.6875; val_optim_loss: 182780.6875
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8954; val_auprc_score: 0.9760; val_best_acc_score: 0.9131; val_best_f1_score: 0.9505; train_kl_reg_loss: 3269.7307; train_edge_recon_loss: 82002.7388; train_gene_expr_recon_loss: 97247.9475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182520.4174; train_optim_loss: 182520.4174; val_kl_reg_loss: 3000.8652; val_edge_recon_loss: 82070.0156; val_gene_expr_recon_loss: 97376.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182447.1094; val_optim_loss: 182447.1094
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9098; val_auprc_score: 0.9802; val_best_acc_score: 0.9097; val_best_f1_score: 0.9484; train_kl_reg_loss: 2722.4133; train_edge_recon_loss: 81741.7388; train_gene_expr_recon_loss: 96654.0681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181118.2210; train_optim_loss: 181118.2210; val_kl_reg_loss: 2253.9170; val_edge_recon_loss: 84185.1953; val_gene_expr_recon_loss: 96841.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183281.0938; val_optim_loss: 183281.0938
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9255; val_auprc_score: 0.9838; val_best_acc_score: 0.9192; val_best_f1_score: 0.9538; train_kl_reg_loss: 2094.9984; train_edge_recon_loss: 81310.1194; train_gene_expr_recon_loss: 96277.8493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179682.9665; train_optim_loss: 179682.9665; val_kl_reg_loss: 1914.0435; val_edge_recon_loss: 82329.1719; val_gene_expr_recon_loss: 96417.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180660.4062; val_optim_loss: 180660.4062
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9406; val_auprc_score: 0.9870; val_best_acc_score: 0.9273; val_best_f1_score: 0.9581; train_kl_reg_loss: 1989.3791; train_edge_recon_loss: 81879.9978; train_gene_expr_recon_loss: 95729.4955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179598.8728; train_optim_loss: 179598.8728; val_kl_reg_loss: 2034.1373; val_edge_recon_loss: 82961.7891; val_gene_expr_recon_loss: 96039.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181035.6562; val_optim_loss: 181035.6562
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9521; val_auprc_score: 0.9902; val_best_acc_score: 0.9347; val_best_f1_score: 0.9622; train_kl_reg_loss: 2157.9155; train_edge_recon_loss: 79296.8460; train_gene_expr_recon_loss: 95302.4721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176757.2344; train_optim_loss: 176757.2344; val_kl_reg_loss: 2185.7903; val_edge_recon_loss: 81831.4219; val_gene_expr_recon_loss: 95670.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179688.1094; val_optim_loss: 179688.1094
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9549; val_auprc_score: 0.9907; val_best_acc_score: 0.9405; val_best_f1_score: 0.9659; train_kl_reg_loss: 2223.7178; train_edge_recon_loss: 77909.5033; train_gene_expr_recon_loss: 95074.1685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175207.3906; train_optim_loss: 175207.3906; val_kl_reg_loss: 2150.1636; val_edge_recon_loss: 78003.1719; val_gene_expr_recon_loss: 95352.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175505.7812; val_optim_loss: 175505.7812
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9623; val_auprc_score: 0.9907; val_best_acc_score: 0.9456; val_best_f1_score: 0.9689; train_kl_reg_loss: 2189.8421; train_edge_recon_loss: 78093.3170; train_gene_expr_recon_loss: 94779.9330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175063.0938; train_optim_loss: 175063.0938; val_kl_reg_loss: 2155.5168; val_edge_recon_loss: 76286.4688; val_gene_expr_recon_loss: 95015.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173457.6562; val_optim_loss: 173457.6562
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9664; val_auprc_score: 0.9930; val_best_acc_score: 0.9473; val_best_f1_score: 0.9696; train_kl_reg_loss: 2210.7920; train_edge_recon_loss: 78940.9252; train_gene_expr_recon_loss: 94366.5402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175518.2589; train_optim_loss: 175518.2589; val_kl_reg_loss: 2165.0161; val_edge_recon_loss: 77192.3828; val_gene_expr_recon_loss: 94672.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174030.0312; val_optim_loss: 174030.0312
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9605; val_auprc_score: 0.9906; val_best_acc_score: 0.9495; val_best_f1_score: 0.9707; train_kl_reg_loss: 2185.3478; train_edge_recon_loss: 78051.8583; train_gene_expr_recon_loss: 94007.1440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174244.3460; train_optim_loss: 174244.3460; val_kl_reg_loss: 2090.4495; val_edge_recon_loss: 77465.6484; val_gene_expr_recon_loss: 94358.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173914.1875; val_optim_loss: 173914.1875
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9663; val_auprc_score: 0.9925; val_best_acc_score: 0.9494; val_best_f1_score: 0.9709; train_kl_reg_loss: 2106.3693; train_edge_recon_loss: 78426.5011; train_gene_expr_recon_loss: 93734.3516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174267.2210; train_optim_loss: 174267.2210; val_kl_reg_loss: 2060.0662; val_edge_recon_loss: 75107.2422; val_gene_expr_recon_loss: 94081.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171249.0312; val_optim_loss: 171249.0312
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9690; val_auprc_score: 0.9932; val_best_acc_score: 0.9504; val_best_f1_score: 0.9713; train_kl_reg_loss: 2113.9775; train_edge_recon_loss: 78666.4230; train_gene_expr_recon_loss: 93472.8471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174253.2500; train_optim_loss: 174253.2500; val_kl_reg_loss: 2082.0481; val_edge_recon_loss: 79548.1797; val_gene_expr_recon_loss: 93822.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175453.0781; val_optim_loss: 175453.0781
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9688; val_auprc_score: 0.9929; val_best_acc_score: 0.9567; val_best_f1_score: 0.9749; train_kl_reg_loss: 2128.7197; train_edge_recon_loss: 77309.1172; train_gene_expr_recon_loss: 93274.9029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172712.7388; train_optim_loss: 172712.7388; val_kl_reg_loss: 2095.2568; val_edge_recon_loss: 77025.5391; val_gene_expr_recon_loss: 93587.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172708.1250; val_optim_loss: 172708.1250
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9672; val_auprc_score: 0.9916; val_best_acc_score: 0.9534; val_best_f1_score: 0.9731; train_kl_reg_loss: 2115.5865; train_edge_recon_loss: 78416.7132; train_gene_expr_recon_loss: 92817.3761; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173349.6741; train_optim_loss: 173349.6741; val_kl_reg_loss: 2062.7456; val_edge_recon_loss: 78400.0391; val_gene_expr_recon_loss: 93358.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173820.9375; val_optim_loss: 173820.9375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9677; val_auprc_score: 0.9913; val_best_acc_score: 0.9531; val_best_f1_score: 0.9727; train_kl_reg_loss: 2104.5422; train_edge_recon_loss: 78110.1362; train_gene_expr_recon_loss: 92801.6027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173016.2835; train_optim_loss: 173016.2835; val_kl_reg_loss: 2057.6016; val_edge_recon_loss: 81714.6406; val_gene_expr_recon_loss: 93334.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177106.8281; val_optim_loss: 177106.8281
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9700; val_auprc_score: 0.9931; val_best_acc_score: 0.9549; val_best_f1_score: 0.9736; train_kl_reg_loss: 2099.8213; train_edge_recon_loss: 77524.0156; train_gene_expr_recon_loss: 92676.9208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172300.7567; train_optim_loss: 172300.7567; val_kl_reg_loss: 2060.5142; val_edge_recon_loss: 81123.2500; val_gene_expr_recon_loss: 93310.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176494.3125; val_optim_loss: 176494.3125
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9716; val_auprc_score: 0.9924; val_best_acc_score: 0.9562; val_best_f1_score: 0.9746; train_kl_reg_loss: 2108.2330; train_edge_recon_loss: 78471.3292; train_gene_expr_recon_loss: 92778.7299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173358.2924; train_optim_loss: 173358.2924; val_kl_reg_loss: 2067.5840; val_edge_recon_loss: 77811.1250; val_gene_expr_recon_loss: 93283.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173162.4062; val_optim_loss: 173162.4062

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 5 sec.
Using best model state, which was in epoch 15.

--- MODEL EVALUATION ---
Val AUROC score: 0.9700
Val AUPRC score: 0.9923
Val best accuracy score: 0.9525
Val best F1 score: 0.9725
Val gene expr MSE score: 1.1741
Duration of model training in run 1: 0 hours, 1 minutes and 12 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 54907
Number of validation edges: 6100
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9579; val_auprc_score: 0.9919; val_best_acc_score: 0.9369; val_best_f1_score: 0.9638; train_kl_reg_loss: 146.4754; train_edge_recon_loss: 102139.2132; train_gene_expr_recon_loss: 119631.6283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 221917.3192; train_optim_loss: 221917.3192; val_kl_reg_loss: 255.9044; val_edge_recon_loss: 112757.5781; val_gene_expr_recon_loss: 103859.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216872.6875; val_optim_loss: 216872.6875
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9577; val_auprc_score: 0.9912; val_best_acc_score: 0.9385; val_best_f1_score: 0.9646; train_kl_reg_loss: 200.8966; train_edge_recon_loss: 100847.2299; train_gene_expr_recon_loss: 102538.1775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203586.3036; train_optim_loss: 203586.3036; val_kl_reg_loss: 135.0042; val_edge_recon_loss: 108839.8984; val_gene_expr_recon_loss: 100207.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209182.4688; val_optim_loss: 209182.4688
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9325; val_auprc_score: 0.9855; val_best_acc_score: 0.9240; val_best_f1_score: 0.9563; train_kl_reg_loss: 181.9191; train_edge_recon_loss: 99864.0781; train_gene_expr_recon_loss: 100653.0636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200699.0580; train_optim_loss: 200699.0580; val_kl_reg_loss: 325.8946; val_edge_recon_loss: 94566.0234; val_gene_expr_recon_loss: 99136.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194028.1250; val_optim_loss: 194028.1250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8841; val_auprc_score: 0.9726; val_best_acc_score: 0.9065; val_best_f1_score: 0.9470; train_kl_reg_loss: 729.2412; train_edge_recon_loss: 91967.1674; train_gene_expr_recon_loss: 99577.3571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192273.7679; train_optim_loss: 192273.7679; val_kl_reg_loss: 1567.2363; val_edge_recon_loss: 84374.4141; val_gene_expr_recon_loss: 98131.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184072.8594; val_optim_loss: 184072.8594
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8931; val_auprc_score: 0.9741; val_best_acc_score: 0.9074; val_best_f1_score: 0.9471; train_kl_reg_loss: 2374.4431; train_edge_recon_loss: 83397.1842; train_gene_expr_recon_loss: 98502.6406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184274.2679; train_optim_loss: 184274.2679; val_kl_reg_loss: 3060.5498; val_edge_recon_loss: 82763.5078; val_gene_expr_recon_loss: 96972.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182796.6562; val_optim_loss: 182796.6562
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9163; val_auprc_score: 0.9808; val_best_acc_score: 0.9126; val_best_f1_score: 0.9500; train_kl_reg_loss: 3188.5609; train_edge_recon_loss: 82215.0223; train_gene_expr_recon_loss: 97325.5781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182729.1629; train_optim_loss: 182729.1629; val_kl_reg_loss: 2959.0620; val_edge_recon_loss: 79722.0859; val_gene_expr_recon_loss: 96303.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178985.0938; val_optim_loss: 178985.0938
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9098; val_auprc_score: 0.9808; val_best_acc_score: 0.9059; val_best_f1_score: 0.9465; train_kl_reg_loss: 2726.5190; train_edge_recon_loss: 80717.3192; train_gene_expr_recon_loss: 96944.5949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180388.4308; train_optim_loss: 180388.4308; val_kl_reg_loss: 2262.6670; val_edge_recon_loss: 84541.6172; val_gene_expr_recon_loss: 95828.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182632.5938; val_optim_loss: 182632.5938
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9324; val_auprc_score: 0.9846; val_best_acc_score: 0.9187; val_best_f1_score: 0.9532; train_kl_reg_loss: 2128.2124; train_edge_recon_loss: 81135.1440; train_gene_expr_recon_loss: 96397.4509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179660.8103; train_optim_loss: 179660.8103; val_kl_reg_loss: 1937.9985; val_edge_recon_loss: 83045.6328; val_gene_expr_recon_loss: 95410.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180394.2656; val_optim_loss: 180394.2656
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9469; val_auprc_score: 0.9880; val_best_acc_score: 0.9272; val_best_f1_score: 0.9579; train_kl_reg_loss: 2028.9313; train_edge_recon_loss: 80951.1696; train_gene_expr_recon_loss: 96002.0882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178982.1897; train_optim_loss: 178982.1897; val_kl_reg_loss: 2075.9856; val_edge_recon_loss: 79004.4453; val_gene_expr_recon_loss: 94998.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176078.9375; val_optim_loss: 176078.9375
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9507; val_auprc_score: 0.9889; val_best_acc_score: 0.9320; val_best_f1_score: 0.9606; train_kl_reg_loss: 2202.2297; train_edge_recon_loss: 79133.7232; train_gene_expr_recon_loss: 95652.8895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176988.8438; train_optim_loss: 176988.8438; val_kl_reg_loss: 2213.5464; val_edge_recon_loss: 81373.1172; val_gene_expr_recon_loss: 94637.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178223.8125; val_optim_loss: 178223.8125
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9630; val_auprc_score: 0.9930; val_best_acc_score: 0.9406; val_best_f1_score: 0.9660; train_kl_reg_loss: 2285.8650; train_edge_recon_loss: 79460.4297; train_gene_expr_recon_loss: 95283.9386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177030.2299; train_optim_loss: 177030.2299; val_kl_reg_loss: 2213.0603; val_edge_recon_loss: 77494.3984; val_gene_expr_recon_loss: 94279.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173987.0000; val_optim_loss: 173987.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9655; val_auprc_score: 0.9929; val_best_acc_score: 0.9438; val_best_f1_score: 0.9675; train_kl_reg_loss: 2244.1774; train_edge_recon_loss: 79624.7254; train_gene_expr_recon_loss: 94896.4565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176765.3594; train_optim_loss: 176765.3594; val_kl_reg_loss: 2173.9883; val_edge_recon_loss: 79075.6719; val_gene_expr_recon_loss: 93911.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175161.0938; val_optim_loss: 175161.0938
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9651; val_auprc_score: 0.9911; val_best_acc_score: 0.9476; val_best_f1_score: 0.9697; train_kl_reg_loss: 2188.4448; train_edge_recon_loss: 78272.0324; train_gene_expr_recon_loss: 94527.9129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174988.3906; train_optim_loss: 174988.3906; val_kl_reg_loss: 2104.6526; val_edge_recon_loss: 78593.7969; val_gene_expr_recon_loss: 93558.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174256.7500; val_optim_loss: 174256.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9685; val_auprc_score: 0.9930; val_best_acc_score: 0.9520; val_best_f1_score: 0.9723; train_kl_reg_loss: 2131.8293; train_edge_recon_loss: 77356.3393; train_gene_expr_recon_loss: 94144.3471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173632.5112; train_optim_loss: 173632.5112; val_kl_reg_loss: 2063.7295; val_edge_recon_loss: 75903.2031; val_gene_expr_recon_loss: 93242.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171209.0625; val_optim_loss: 171209.0625
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9687; val_auprc_score: 0.9930; val_best_acc_score: 0.9521; val_best_f1_score: 0.9723; train_kl_reg_loss: 2130.5587; train_edge_recon_loss: 77543.0982; train_gene_expr_recon_loss: 93884.5513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173558.2054; train_optim_loss: 173558.2054; val_kl_reg_loss: 2084.2222; val_edge_recon_loss: 77714.1094; val_gene_expr_recon_loss: 92934.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172732.6250; val_optim_loss: 172732.6250
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9707; val_auprc_score: 0.9933; val_best_acc_score: 0.9532; val_best_f1_score: 0.9728; train_kl_reg_loss: 2153.1300; train_edge_recon_loss: 77308.5000; train_gene_expr_recon_loss: 93457.9654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172919.5915; train_optim_loss: 172919.5915; val_kl_reg_loss: 2091.4160; val_edge_recon_loss: 79794.8594; val_gene_expr_recon_loss: 92652.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174538.3438; val_optim_loss: 174538.3438
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9720; val_auprc_score: 0.9930; val_best_acc_score: 0.9565; val_best_f1_score: 0.9748; train_kl_reg_loss: 2139.8807; train_edge_recon_loss: 78518.5982; train_gene_expr_recon_loss: 93306.0670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173964.5446; train_optim_loss: 173964.5446; val_kl_reg_loss: 2082.5637; val_edge_recon_loss: 78096.7344; val_gene_expr_recon_loss: 92389.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172568.3906; val_optim_loss: 172568.3906

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9742; val_auprc_score: 0.9941; val_best_acc_score: 0.9559; val_best_f1_score: 0.9744; train_kl_reg_loss: 2138.1824; train_edge_recon_loss: 78567.5681; train_gene_expr_recon_loss: 93148.9643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173854.7143; train_optim_loss: 173854.7143; val_kl_reg_loss: 2078.7410; val_edge_recon_loss: 78798.1562; val_gene_expr_recon_loss: 92360.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173237.8438; val_optim_loss: 173237.8438
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9717; val_auprc_score: 0.9924; val_best_acc_score: 0.9595; val_best_f1_score: 0.9767; train_kl_reg_loss: 2128.9316; train_edge_recon_loss: 77665.8147; train_gene_expr_recon_loss: 93139.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172933.9621; train_optim_loss: 172933.9621; val_kl_reg_loss: 2068.5125; val_edge_recon_loss: 74867.1094; val_gene_expr_recon_loss: 92332.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169267.7031; val_optim_loss: 169267.7031
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9703; val_auprc_score: 0.9924; val_best_acc_score: 0.9538; val_best_f1_score: 0.9731; train_kl_reg_loss: 2122.7399; train_edge_recon_loss: 78549.8594; train_gene_expr_recon_loss: 92973.1373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173645.7344; train_optim_loss: 173645.7344; val_kl_reg_loss: 2067.5002; val_edge_recon_loss: 80562.1406; val_gene_expr_recon_loss: 92304.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174934.1875; val_optim_loss: 174934.1875
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9723; val_auprc_score: 0.9931; val_best_acc_score: 0.9558; val_best_f1_score: 0.9742; train_kl_reg_loss: 2120.2726; train_edge_recon_loss: 78005.0413; train_gene_expr_recon_loss: 93039.3873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173164.6987; train_optim_loss: 173164.6987; val_kl_reg_loss: 2063.8374; val_edge_recon_loss: 80188.4297; val_gene_expr_recon_loss: 92277.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174530.2188; val_optim_loss: 174530.2188
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9751; val_auprc_score: 0.9942; val_best_acc_score: 0.9569; val_best_f1_score: 0.9752; train_kl_reg_loss: 2113.0626; train_edge_recon_loss: 76686.8426; train_gene_expr_recon_loss: 93009.5558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171809.4643; train_optim_loss: 171809.4643; val_kl_reg_loss: 2049.8125; val_edge_recon_loss: 75553.0547; val_gene_expr_recon_loss: 92253.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169856.0938; val_optim_loss: 169856.0938

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9769; val_auprc_score: 0.9950; val_best_acc_score: 0.9605; val_best_f1_score: 0.9772; train_kl_reg_loss: 2107.0554; train_edge_recon_loss: 77417.2712; train_gene_expr_recon_loss: 92951.9643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172476.2924; train_optim_loss: 172476.2924; val_kl_reg_loss: 2052.7864; val_edge_recon_loss: 76228.3906; val_gene_expr_recon_loss: 92250.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170531.9375; val_optim_loss: 170531.9375
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9723; val_auprc_score: 0.9942; val_best_acc_score: 0.9569; val_best_f1_score: 0.9751; train_kl_reg_loss: 2103.8149; train_edge_recon_loss: 78210.3873; train_gene_expr_recon_loss: 92874.6429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173188.8460; train_optim_loss: 173188.8460; val_kl_reg_loss: 2051.7896; val_edge_recon_loss: 76969.0156; val_gene_expr_recon_loss: 92248.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171269.0000; val_optim_loss: 171269.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9708; val_auprc_score: 0.9931; val_best_acc_score: 0.9551; val_best_f1_score: 0.9739; train_kl_reg_loss: 2105.7521; train_edge_recon_loss: 77581.3315; train_gene_expr_recon_loss: 92808.6987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172495.7857; train_optim_loss: 172495.7857; val_kl_reg_loss: 2051.4507; val_edge_recon_loss: 78308.6406; val_gene_expr_recon_loss: 92245.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172605.6562; val_optim_loss: 172605.6562

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 56 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9692
Val AUPRC score: 0.9931
Val best accuracy score: 0.9561
Val best F1 score: 0.9749
Val gene expr MSE score: 1.1232
Duration of model training in run 2: 0 hours, 0 minutes and 58 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 107073
Number of validation edges: 11897
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9237; val_auprc_score: 0.9846; val_best_acc_score: 0.9173; val_best_f1_score: 0.9528; train_kl_reg_loss: 194.4933; train_edge_recon_loss: 101177.6395; train_gene_expr_recon_loss: 104234.6516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205606.7847; train_optim_loss: 205606.7847; val_kl_reg_loss: 465.1470; val_edge_recon_loss: 89027.1250; val_gene_expr_recon_loss: 98067.8307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187560.1042; val_optim_loss: 187560.1042
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9117; val_auprc_score: 0.9807; val_best_acc_score: 0.9146; val_best_f1_score: 0.9513; train_kl_reg_loss: 2238.8800; train_edge_recon_loss: 84604.6878; train_gene_expr_recon_loss: 95650.9659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182494.5312; train_optim_loss: 182494.5312; val_kl_reg_loss: 2396.7203; val_edge_recon_loss: 84539.2318; val_gene_expr_recon_loss: 95014.2943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181950.2396; val_optim_loss: 181950.2396
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9552; val_auprc_score: 0.9905; val_best_acc_score: 0.9376; val_best_f1_score: 0.9640; train_kl_reg_loss: 2051.4317; train_edge_recon_loss: 81725.3273; train_gene_expr_recon_loss: 93650.3915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177427.1493; train_optim_loss: 177427.1493; val_kl_reg_loss: 2089.6868; val_edge_recon_loss: 79984.8958; val_gene_expr_recon_loss: 93599.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175674.0000; val_optim_loss: 175674.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9703; val_auprc_score: 0.9932; val_best_acc_score: 0.9506; val_best_f1_score: 0.9715; train_kl_reg_loss: 2108.9581; train_edge_recon_loss: 78673.4499; train_gene_expr_recon_loss: 92929.2373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173711.6453; train_optim_loss: 173711.6453; val_kl_reg_loss: 2034.4102; val_edge_recon_loss: 77577.8203; val_gene_expr_recon_loss: 92652.7552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172264.9896; val_optim_loss: 172264.9896
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9731; val_auprc_score: 0.9936; val_best_acc_score: 0.9566; val_best_f1_score: 0.9747; train_kl_reg_loss: 2072.0430; train_edge_recon_loss: 78180.1403; train_gene_expr_recon_loss: 91446.8857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171699.0694; train_optim_loss: 171699.0694; val_kl_reg_loss: 2004.4367; val_edge_recon_loss: 78635.9089; val_gene_expr_recon_loss: 92134.6042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172774.9531; val_optim_loss: 172774.9531
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9813; val_auprc_score: 0.9957; val_best_acc_score: 0.9679; val_best_f1_score: 0.9814; train_kl_reg_loss: 2034.4646; train_edge_recon_loss: 77208.2645; train_gene_expr_recon_loss: 90897.4789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170140.2083; train_optim_loss: 170140.2083; val_kl_reg_loss: 1988.6059; val_edge_recon_loss: 75128.8151; val_gene_expr_recon_loss: 91456.5911; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168574.0156; val_optim_loss: 168574.0156
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9789; val_auprc_score: 0.9949; val_best_acc_score: 0.9675; val_best_f1_score: 0.9810; train_kl_reg_loss: 2010.0009; train_edge_recon_loss: 78068.9604; train_gene_expr_recon_loss: 90039.9557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170118.9184; train_optim_loss: 170118.9184; val_kl_reg_loss: 2010.6052; val_edge_recon_loss: 78973.2995; val_gene_expr_recon_loss: 90812.6589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171796.5625; val_optim_loss: 171796.5625
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9865; val_auprc_score: 0.9966; val_best_acc_score: 0.9743; val_best_f1_score: 0.9849; train_kl_reg_loss: 2023.2385; train_edge_recon_loss: 77512.4219; train_gene_expr_recon_loss: 89649.0561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169184.7170; train_optim_loss: 169184.7170; val_kl_reg_loss: 1954.8118; val_edge_recon_loss: 78877.5755; val_gene_expr_recon_loss: 90148.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170980.9740; val_optim_loss: 170980.9740
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9844; val_auprc_score: 0.9958; val_best_acc_score: 0.9736; val_best_f1_score: 0.9846; train_kl_reg_loss: 1989.6418; train_edge_recon_loss: 77563.6635; train_gene_expr_recon_loss: 89105.4734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168658.7795; train_optim_loss: 168658.7795; val_kl_reg_loss: 1956.8247; val_edge_recon_loss: 77760.3620; val_gene_expr_recon_loss: 90059.2630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169776.4479; val_optim_loss: 169776.4479

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9859; val_auprc_score: 0.9965; val_best_acc_score: 0.9745; val_best_f1_score: 0.9853; train_kl_reg_loss: 1965.5228; train_edge_recon_loss: 77000.9323; train_gene_expr_recon_loss: 89112.3220; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168078.7778; train_optim_loss: 168078.7778; val_kl_reg_loss: 1947.5795; val_edge_recon_loss: 75108.0859; val_gene_expr_recon_loss: 89839.7214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166895.3906; val_optim_loss: 166895.3906
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9852; val_auprc_score: 0.9957; val_best_acc_score: 0.9739; val_best_f1_score: 0.9849; train_kl_reg_loss: 1978.6164; train_edge_recon_loss: 77880.6033; train_gene_expr_recon_loss: 88792.7700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168651.9896; train_optim_loss: 168651.9896; val_kl_reg_loss: 1946.3293; val_edge_recon_loss: 76572.6953; val_gene_expr_recon_loss: 89232.9635; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167751.9896; val_optim_loss: 167751.9896
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9840; val_auprc_score: 0.9963; val_best_acc_score: 0.9741; val_best_f1_score: 0.9849; train_kl_reg_loss: 1979.4632; train_edge_recon_loss: 77660.9748; train_gene_expr_recon_loss: 89089.0952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168729.5330; train_optim_loss: 168729.5330; val_kl_reg_loss: 1938.9627; val_edge_recon_loss: 76431.9818; val_gene_expr_recon_loss: 89415.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167786.4010; val_optim_loss: 167786.4010
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9836; val_auprc_score: 0.9957; val_best_acc_score: 0.9729; val_best_f1_score: 0.9843; train_kl_reg_loss: 1965.9395; train_edge_recon_loss: 77992.8709; train_gene_expr_recon_loss: 88509.1771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168467.9867; train_optim_loss: 168467.9867; val_kl_reg_loss: 1938.5359; val_edge_recon_loss: 76801.8073; val_gene_expr_recon_loss: 89605.2526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168345.5938; val_optim_loss: 168345.5938

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9864; val_auprc_score: 0.9973; val_best_acc_score: 0.9744; val_best_f1_score: 0.9852; train_kl_reg_loss: 1965.8485; train_edge_recon_loss: 76229.8571; train_gene_expr_recon_loss: 88656.8267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166852.5341; train_optim_loss: 166852.5341; val_kl_reg_loss: 1936.4889; val_edge_recon_loss: 75404.0859; val_gene_expr_recon_loss: 89663.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167004.5104; val_optim_loss: 167004.5104
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9867; val_auprc_score: 0.9971; val_best_acc_score: 0.9744; val_best_f1_score: 0.9851; train_kl_reg_loss: 1962.6178; train_edge_recon_loss: 77377.1629; train_gene_expr_recon_loss: 88781.7390; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168121.5197; train_optim_loss: 168121.5197; val_kl_reg_loss: 1929.2018; val_edge_recon_loss: 77274.4036; val_gene_expr_recon_loss: 89237.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168440.7760; val_optim_loss: 168440.7760
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9829; val_auprc_score: 0.9960; val_best_acc_score: 0.9750; val_best_f1_score: 0.9854; train_kl_reg_loss: 1962.9832; train_edge_recon_loss: 77379.5148; train_gene_expr_recon_loss: 88736.4514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168078.9508; train_optim_loss: 168078.9508; val_kl_reg_loss: 1932.7115; val_edge_recon_loss: 76734.7526; val_gene_expr_recon_loss: 89519.1901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168186.6510; val_optim_loss: 168186.6510

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 26 sec.
Using best model state, which was in epoch 10.

--- MODEL EVALUATION ---
Val AUROC score: 0.9835
Val AUPRC score: 0.9956
Val best accuracy score: 0.9745
Val best F1 score: 0.9852
Val gene expr MSE score: 1.0217
Duration of model training in run 3: 0 hours, 1 minutes and 29 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 107073
Number of validation edges: 11897
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9288; val_auprc_score: 0.9846; val_best_acc_score: 0.9205; val_best_f1_score: 0.9546; train_kl_reg_loss: 198.4638; train_edge_recon_loss: 99703.6985; train_gene_expr_recon_loss: 105660.3171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205562.4792; train_optim_loss: 205562.4792; val_kl_reg_loss: 519.1886; val_edge_recon_loss: 89421.3828; val_gene_expr_recon_loss: 96731.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186672.4896; val_optim_loss: 186672.4896
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9266; val_auprc_score: 0.9843; val_best_acc_score: 0.9203; val_best_f1_score: 0.9544; train_kl_reg_loss: 2239.9793; train_edge_recon_loss: 84491.8796; train_gene_expr_recon_loss: 96795.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183527.8316; train_optim_loss: 183527.8316; val_kl_reg_loss: 2215.6844; val_edge_recon_loss: 82736.7526; val_gene_expr_recon_loss: 94396.1823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179348.6198; val_optim_loss: 179348.6198
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9645; val_auprc_score: 0.9920; val_best_acc_score: 0.9439; val_best_f1_score: 0.9675; train_kl_reg_loss: 2062.9267; train_edge_recon_loss: 81177.6817; train_gene_expr_recon_loss: 94802.0651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178042.6730; train_optim_loss: 178042.6730; val_kl_reg_loss: 2132.5715; val_edge_recon_loss: 80901.1406; val_gene_expr_recon_loss: 92638.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175672.4844; val_optim_loss: 175672.4844
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9748; val_auprc_score: 0.9940; val_best_acc_score: 0.9546; val_best_f1_score: 0.9737; train_kl_reg_loss: 2112.2883; train_edge_recon_loss: 79134.5359; train_gene_expr_recon_loss: 93342.8979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174589.7216; train_optim_loss: 174589.7216; val_kl_reg_loss: 2061.4449; val_edge_recon_loss: 78862.6641; val_gene_expr_recon_loss: 91511.4036; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172435.5104; val_optim_loss: 172435.5104
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9791; val_auprc_score: 0.9952; val_best_acc_score: 0.9633; val_best_f1_score: 0.9787; train_kl_reg_loss: 2068.7550; train_edge_recon_loss: 78112.3542; train_gene_expr_recon_loss: 92264.7063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172445.8154; train_optim_loss: 172445.8154; val_kl_reg_loss: 1995.6720; val_edge_recon_loss: 77150.7656; val_gene_expr_recon_loss: 90767.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169914.0260; val_optim_loss: 169914.0260
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9815; val_auprc_score: 0.9951; val_best_acc_score: 0.9691; val_best_f1_score: 0.9821; train_kl_reg_loss: 2045.8803; train_edge_recon_loss: 77440.9554; train_gene_expr_recon_loss: 91580.2005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171067.0365; train_optim_loss: 171067.0365; val_kl_reg_loss: 2020.1181; val_edge_recon_loss: 77052.0443; val_gene_expr_recon_loss: 90236.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169308.5417; val_optim_loss: 169308.5417
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9868; val_auprc_score: 0.9973; val_best_acc_score: 0.9721; val_best_f1_score: 0.9837; train_kl_reg_loss: 2026.7734; train_edge_recon_loss: 77851.7862; train_gene_expr_recon_loss: 91098.8351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170977.3941; train_optim_loss: 170977.3941; val_kl_reg_loss: 1993.7300; val_edge_recon_loss: 77839.9844; val_gene_expr_recon_loss: 89282.7604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169116.4740; val_optim_loss: 169116.4740
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9835; val_auprc_score: 0.9958; val_best_acc_score: 0.9726; val_best_f1_score: 0.9840; train_kl_reg_loss: 2022.6877; train_edge_recon_loss: 77133.9502; train_gene_expr_recon_loss: 90407.8313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169564.4682; train_optim_loss: 169564.4682; val_kl_reg_loss: 1967.4091; val_edge_recon_loss: 78468.9583; val_gene_expr_recon_loss: 89052.5677; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169488.9375; val_optim_loss: 169488.9375
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9860; val_auprc_score: 0.9965; val_best_acc_score: 0.9767; val_best_f1_score: 0.9864; train_kl_reg_loss: 1990.5849; train_edge_recon_loss: 75676.6780; train_gene_expr_recon_loss: 90152.8539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167820.1163; train_optim_loss: 167820.1163; val_kl_reg_loss: 1924.7223; val_edge_recon_loss: 77587.7031; val_gene_expr_recon_loss: 88647.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168159.7031; val_optim_loss: 168159.7031
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9863; val_auprc_score: 0.9970; val_best_acc_score: 0.9734; val_best_f1_score: 0.9845; train_kl_reg_loss: 1998.7710; train_edge_recon_loss: 77167.1366; train_gene_expr_recon_loss: 89589.4878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168755.3947; train_optim_loss: 168755.3947; val_kl_reg_loss: 1950.1760; val_edge_recon_loss: 77573.6615; val_gene_expr_recon_loss: 88266.2240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167790.0521; val_optim_loss: 167790.0521
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9855; val_auprc_score: 0.9959; val_best_acc_score: 0.9760; val_best_f1_score: 0.9861; train_kl_reg_loss: 1970.7114; train_edge_recon_loss: 76958.6360; train_gene_expr_recon_loss: 89306.6386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168235.9878; train_optim_loss: 168235.9878; val_kl_reg_loss: 1912.1529; val_edge_recon_loss: 75616.6432; val_gene_expr_recon_loss: 88046.0208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165574.8177; val_optim_loss: 165574.8177
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9864; val_auprc_score: 0.9969; val_best_acc_score: 0.9757; val_best_f1_score: 0.9859; train_kl_reg_loss: 1956.8768; train_edge_recon_loss: 76079.7439; train_gene_expr_recon_loss: 88843.3432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166879.9624; train_optim_loss: 166879.9624; val_kl_reg_loss: 1893.7913; val_edge_recon_loss: 77608.9141; val_gene_expr_recon_loss: 87567.4479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167070.1510; val_optim_loss: 167070.1510
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9862; val_auprc_score: 0.9956; val_best_acc_score: 0.9769; val_best_f1_score: 0.9865; train_kl_reg_loss: 1953.6455; train_edge_recon_loss: 77158.6513; train_gene_expr_recon_loss: 88623.2546; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167735.5509; train_optim_loss: 167735.5509; val_kl_reg_loss: 1931.0079; val_edge_recon_loss: 76992.7318; val_gene_expr_recon_loss: 87156.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166080.1562; val_optim_loss: 166080.1562
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9884; val_auprc_score: 0.9966; val_best_acc_score: 0.9781; val_best_f1_score: 0.9873; train_kl_reg_loss: 1965.2934; train_edge_recon_loss: 77018.3513; train_gene_expr_recon_loss: 88568.0940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167551.7390; train_optim_loss: 167551.7390; val_kl_reg_loss: 1905.2661; val_edge_recon_loss: 76691.6250; val_gene_expr_recon_loss: 87175.8411; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165772.7396; val_optim_loss: 165772.7396

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9883; val_auprc_score: 0.9973; val_best_acc_score: 0.9798; val_best_f1_score: 0.9882; train_kl_reg_loss: 1945.0653; train_edge_recon_loss: 75979.3202; train_gene_expr_recon_loss: 88139.7468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166064.1308; train_optim_loss: 166064.1308; val_kl_reg_loss: 1914.4299; val_edge_recon_loss: 76552.2656; val_gene_expr_recon_loss: 86911.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165377.7292; val_optim_loss: 165377.7292
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9888; val_auprc_score: 0.9965; val_best_acc_score: 0.9782; val_best_f1_score: 0.9873; train_kl_reg_loss: 1940.1889; train_edge_recon_loss: 75824.4187; train_gene_expr_recon_loss: 88349.1389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166113.7459; train_optim_loss: 166113.7459; val_kl_reg_loss: 1896.5494; val_edge_recon_loss: 76950.5130; val_gene_expr_recon_loss: 86849.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165696.3958; val_optim_loss: 165696.3958
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9893; val_auprc_score: 0.9978; val_best_acc_score: 0.9801; val_best_f1_score: 0.9884; train_kl_reg_loss: 1934.0361; train_edge_recon_loss: 76227.7402; train_gene_expr_recon_loss: 88057.4664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166219.2436; train_optim_loss: 166219.2436; val_kl_reg_loss: 1901.3715; val_edge_recon_loss: 76132.4427; val_gene_expr_recon_loss: 86856.4635; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164890.2760; val_optim_loss: 164890.2760
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9865; val_auprc_score: 0.9965; val_best_acc_score: 0.9779; val_best_f1_score: 0.9871; train_kl_reg_loss: 1939.4731; train_edge_recon_loss: 76826.5171; train_gene_expr_recon_loss: 88271.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167037.1562; train_optim_loss: 167037.1562; val_kl_reg_loss: 1907.7069; val_edge_recon_loss: 76703.2448; val_gene_expr_recon_loss: 86843.8646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165454.8125; val_optim_loss: 165454.8125
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9838; val_auprc_score: 0.9958; val_best_acc_score: 0.9772; val_best_f1_score: 0.9867; train_kl_reg_loss: 1933.9117; train_edge_recon_loss: 75740.6664; train_gene_expr_recon_loss: 87835.6001; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165510.1782; train_optim_loss: 165510.1782; val_kl_reg_loss: 1899.4586; val_edge_recon_loss: 77031.3776; val_gene_expr_recon_loss: 86940.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165871.7656; val_optim_loss: 165871.7656
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9857; val_auprc_score: 0.9966; val_best_acc_score: 0.9786; val_best_f1_score: 0.9875; train_kl_reg_loss: 1930.6961; train_edge_recon_loss: 76059.2127; train_gene_expr_recon_loss: 88063.4002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166053.3090; train_optim_loss: 166053.3090; val_kl_reg_loss: 1894.2404; val_edge_recon_loss: 76267.4167; val_gene_expr_recon_loss: 87077.4479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165239.1042; val_optim_loss: 165239.1042

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9885; val_auprc_score: 0.9972; val_best_acc_score: 0.9795; val_best_f1_score: 0.9881; train_kl_reg_loss: 1933.3196; train_edge_recon_loss: 75921.4864; train_gene_expr_recon_loss: 87936.5694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165791.3773; train_optim_loss: 165791.3773; val_kl_reg_loss: 1898.0573; val_edge_recon_loss: 74451.4974; val_gene_expr_recon_loss: 86813.1302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163162.6875; val_optim_loss: 163162.6875
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9881; val_auprc_score: 0.9972; val_best_acc_score: 0.9791; val_best_f1_score: 0.9878; train_kl_reg_loss: 1933.6330; train_edge_recon_loss: 75886.6777; train_gene_expr_recon_loss: 87905.1137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165725.4236; train_optim_loss: 165725.4236; val_kl_reg_loss: 1896.0990; val_edge_recon_loss: 76392.1771; val_gene_expr_recon_loss: 86737.8802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165026.1510; val_optim_loss: 165026.1510
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9881; val_auprc_score: 0.9972; val_best_acc_score: 0.9789; val_best_f1_score: 0.9877; train_kl_reg_loss: 1935.5898; train_edge_recon_loss: 76778.7251; train_gene_expr_recon_loss: 88156.1010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166870.4172; train_optim_loss: 166870.4172; val_kl_reg_loss: 1901.5132; val_edge_recon_loss: 75368.4219; val_gene_expr_recon_loss: 86668.2005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163938.1354; val_optim_loss: 163938.1354
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9887; val_auprc_score: 0.9974; val_best_acc_score: 0.9799; val_best_f1_score: 0.9883; train_kl_reg_loss: 1936.4659; train_edge_recon_loss: 75782.5046; train_gene_expr_recon_loss: 88029.5637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165748.5353; train_optim_loss: 165748.5353; val_kl_reg_loss: 1897.8832; val_edge_recon_loss: 75920.7812; val_gene_expr_recon_loss: 86725.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164543.7292; val_optim_loss: 164543.7292

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9859; val_auprc_score: 0.9968; val_best_acc_score: 0.9768; val_best_f1_score: 0.9865; train_kl_reg_loss: 1935.9310; train_edge_recon_loss: 76405.6181; train_gene_expr_recon_loss: 88116.7636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166458.3113; train_optim_loss: 166458.3113; val_kl_reg_loss: 1898.5460; val_edge_recon_loss: 77371.5052; val_gene_expr_recon_loss: 86734.7135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166004.7708; val_optim_loss: 166004.7708
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9867; val_auprc_score: 0.9964; val_best_acc_score: 0.9773; val_best_f1_score: 0.9868; train_kl_reg_loss: 1935.4389; train_edge_recon_loss: 76582.0318; train_gene_expr_recon_loss: 88055.1548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166572.6267; train_optim_loss: 166572.6267; val_kl_reg_loss: 1898.4491; val_edge_recon_loss: 77636.2188; val_gene_expr_recon_loss: 86957.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166491.7552; val_optim_loss: 166491.7552
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9897; val_auprc_score: 0.9977; val_best_acc_score: 0.9805; val_best_f1_score: 0.9886; train_kl_reg_loss: 1936.9073; train_edge_recon_loss: 77377.6551; train_gene_expr_recon_loss: 87973.3883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167287.9502; train_optim_loss: 167287.9502; val_kl_reg_loss: 1898.4672; val_edge_recon_loss: 75369.2083; val_gene_expr_recon_loss: 87051.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164318.8854; val_optim_loss: 164318.8854

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 44 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9881
Val AUPRC score: 0.9974
Val best accuracy score: 0.9786
Val best F1 score: 0.9876
Val gene expr MSE score: 0.9343
Duration of model training in run 4: 0 hours, 2 minutes and 48 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 159885
Number of validation edges: 17764
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9605; val_auprc_score: 0.9912; val_best_acc_score: 0.9424; val_best_f1_score: 0.9666; train_kl_reg_loss: 1411.3572; train_edge_recon_loss: 89828.2366; train_gene_expr_recon_loss: 98360.0823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189599.6768; train_optim_loss: 189599.6768; val_kl_reg_loss: 1931.4769; val_edge_recon_loss: 80927.7752; val_gene_expr_recon_loss: 92944.7300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175803.9861; val_optim_loss: 175803.9861
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9845; val_auprc_score: 0.9968; val_best_acc_score: 0.9703; val_best_f1_score: 0.9828; train_kl_reg_loss: 2039.3290; train_edge_recon_loss: 78001.3489; train_gene_expr_recon_loss: 91831.3953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171872.0736; train_optim_loss: 171872.0736; val_kl_reg_loss: 1989.8824; val_edge_recon_loss: 75828.8012; val_gene_expr_recon_loss: 90376.7726; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168195.4601; val_optim_loss: 168195.4601
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9865; val_auprc_score: 0.9970; val_best_acc_score: 0.9736; val_best_f1_score: 0.9846; train_kl_reg_loss: 2012.7978; train_edge_recon_loss: 77693.3072; train_gene_expr_recon_loss: 89985.5391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169691.6450; train_optim_loss: 169691.6450; val_kl_reg_loss: 2012.7627; val_edge_recon_loss: 77460.7734; val_gene_expr_recon_loss: 89032.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168506.3715; val_optim_loss: 168506.3715
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9876; val_auprc_score: 0.9971; val_best_acc_score: 0.9772; val_best_f1_score: 0.9867; train_kl_reg_loss: 1989.7377; train_edge_recon_loss: 76552.3774; train_gene_expr_recon_loss: 88933.8152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167475.9298; train_optim_loss: 167475.9298; val_kl_reg_loss: 1904.5161; val_edge_recon_loss: 77132.3212; val_gene_expr_recon_loss: 88288.1389; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167324.9757; val_optim_loss: 167324.9757
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9883; val_auprc_score: 0.9971; val_best_acc_score: 0.9780; val_best_f1_score: 0.9872; train_kl_reg_loss: 1955.2454; train_edge_recon_loss: 77179.7544; train_gene_expr_recon_loss: 88001.3420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167136.3420; train_optim_loss: 167136.3420; val_kl_reg_loss: 1864.9014; val_edge_recon_loss: 76303.8125; val_gene_expr_recon_loss: 87293.1207; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165461.8316; val_optim_loss: 165461.8316
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9879; val_auprc_score: 0.9974; val_best_acc_score: 0.9797; val_best_f1_score: 0.9882; train_kl_reg_loss: 1927.3596; train_edge_recon_loss: 76400.9748; train_gene_expr_recon_loss: 87523.4203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165851.7544; train_optim_loss: 165851.7544; val_kl_reg_loss: 1896.2290; val_edge_recon_loss: 74175.8837; val_gene_expr_recon_loss: 86975.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163048.0990; val_optim_loss: 163048.0990
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9903; val_auprc_score: 0.9976; val_best_acc_score: 0.9814; val_best_f1_score: 0.9891; train_kl_reg_loss: 1919.2996; train_edge_recon_loss: 76730.8570; train_gene_expr_recon_loss: 87032.9076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165683.0645; train_optim_loss: 165683.0645; val_kl_reg_loss: 1969.5773; val_edge_recon_loss: 76140.5929; val_gene_expr_recon_loss: 86347.7248; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164457.8993; val_optim_loss: 164457.8993
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9892; val_auprc_score: 0.9973; val_best_acc_score: 0.9812; val_best_f1_score: 0.9890; train_kl_reg_loss: 1919.0407; train_edge_recon_loss: 76390.1291; train_gene_expr_recon_loss: 86524.8903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164834.0599; train_optim_loss: 164834.0599; val_kl_reg_loss: 1937.7459; val_edge_recon_loss: 77052.9609; val_gene_expr_recon_loss: 86570.6267; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165561.3351; val_optim_loss: 165561.3351
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9912; val_auprc_score: 0.9981; val_best_acc_score: 0.9823; val_best_f1_score: 0.9897; train_kl_reg_loss: 1916.0706; train_edge_recon_loss: 76616.1406; train_gene_expr_recon_loss: 86192.8790; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164725.0896; train_optim_loss: 164725.0896; val_kl_reg_loss: 1895.9513; val_edge_recon_loss: 74699.6936; val_gene_expr_recon_loss: 85843.4071; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162439.0521; val_optim_loss: 162439.0521
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9907; val_auprc_score: 0.9968; val_best_acc_score: 0.9837; val_best_f1_score: 0.9905; train_kl_reg_loss: 1916.3856; train_edge_recon_loss: 76944.8941; train_gene_expr_recon_loss: 85893.2965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164754.5756; train_optim_loss: 164754.5756; val_kl_reg_loss: 1895.9873; val_edge_recon_loss: 75590.9974; val_gene_expr_recon_loss: 85344.5660; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162831.5503; val_optim_loss: 162831.5503
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9895; val_auprc_score: 0.9965; val_best_acc_score: 0.9830; val_best_f1_score: 0.9901; train_kl_reg_loss: 1917.3860; train_edge_recon_loss: 76319.6754; train_gene_expr_recon_loss: 85503.6369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163740.6978; train_optim_loss: 163740.6978; val_kl_reg_loss: 1912.2255; val_edge_recon_loss: 75536.8099; val_gene_expr_recon_loss: 84946.0165; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162395.0521; val_optim_loss: 162395.0521
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9909; val_auprc_score: 0.9965; val_best_acc_score: 0.9845; val_best_f1_score: 0.9909; train_kl_reg_loss: 1921.4660; train_edge_recon_loss: 75894.2567; train_gene_expr_recon_loss: 85166.5554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162982.2771; train_optim_loss: 162982.2771; val_kl_reg_loss: 1915.5413; val_edge_recon_loss: 77376.9757; val_gene_expr_recon_loss: 85215.5339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164508.0521; val_optim_loss: 164508.0521
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9920; val_auprc_score: 0.9974; val_best_acc_score: 0.9845; val_best_f1_score: 0.9909; train_kl_reg_loss: 1913.2861; train_edge_recon_loss: 76031.0347; train_gene_expr_recon_loss: 84968.8025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162913.1232; train_optim_loss: 162913.1232; val_kl_reg_loss: 1907.9554; val_edge_recon_loss: 76700.0790; val_gene_expr_recon_loss: 84562.1693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163170.2031; val_optim_loss: 163170.2031
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9926; val_auprc_score: 0.9980; val_best_acc_score: 0.9851; val_best_f1_score: 0.9912; train_kl_reg_loss: 1918.5096; train_edge_recon_loss: 76351.4083; train_gene_expr_recon_loss: 84831.6535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163101.5698; train_optim_loss: 163101.5698; val_kl_reg_loss: 1903.0104; val_edge_recon_loss: 77126.4931; val_gene_expr_recon_loss: 84380.1398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163409.6389; val_optim_loss: 163409.6389

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9913; val_auprc_score: 0.9979; val_best_acc_score: 0.9841; val_best_f1_score: 0.9907; train_kl_reg_loss: 1926.2072; train_edge_recon_loss: 75702.4897; train_gene_expr_recon_loss: 84459.0508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162087.7474; train_optim_loss: 162087.7474; val_kl_reg_loss: 1887.3631; val_edge_recon_loss: 75725.4323; val_gene_expr_recon_loss: 84052.0729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161664.8681; val_optim_loss: 161664.8681
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9904; val_auprc_score: 0.9976; val_best_acc_score: 0.9834; val_best_f1_score: 0.9903; train_kl_reg_loss: 1920.0205; train_edge_recon_loss: 76277.2781; train_gene_expr_recon_loss: 84213.2277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162410.5259; train_optim_loss: 162410.5259; val_kl_reg_loss: 1902.5085; val_edge_recon_loss: 75741.5356; val_gene_expr_recon_loss: 83631.3976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161275.4427; val_optim_loss: 161275.4427
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9926; val_auprc_score: 0.9980; val_best_acc_score: 0.9854; val_best_f1_score: 0.9915; train_kl_reg_loss: 1926.3722; train_edge_recon_loss: 76208.1765; train_gene_expr_recon_loss: 84244.8023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162379.3515; train_optim_loss: 162379.3515; val_kl_reg_loss: 1892.2947; val_edge_recon_loss: 76556.6068; val_gene_expr_recon_loss: 83940.1502; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162389.0521; val_optim_loss: 162389.0521
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9914; val_auprc_score: 0.9966; val_best_acc_score: 0.9844; val_best_f1_score: 0.9909; train_kl_reg_loss: 1914.6802; train_edge_recon_loss: 76531.8175; train_gene_expr_recon_loss: 84269.6132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162716.1112; train_optim_loss: 162716.1112; val_kl_reg_loss: 1898.7152; val_edge_recon_loss: 76468.9523; val_gene_expr_recon_loss: 83807.6502; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162175.3177; val_optim_loss: 162175.3177
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9939; val_auprc_score: 0.9982; val_best_acc_score: 0.9869; val_best_f1_score: 0.9924; train_kl_reg_loss: 1921.7762; train_edge_recon_loss: 76652.4482; train_gene_expr_recon_loss: 84126.2449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162700.4693; train_optim_loss: 162700.4693; val_kl_reg_loss: 1899.3789; val_edge_recon_loss: 75143.2361; val_gene_expr_recon_loss: 83802.4679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160845.0851; val_optim_loss: 160845.0851
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9918; val_auprc_score: 0.9977; val_best_acc_score: 0.9851; val_best_f1_score: 0.9913; train_kl_reg_loss: 1917.9352; train_edge_recon_loss: 75726.7092; train_gene_expr_recon_loss: 84006.8736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161651.5176; train_optim_loss: 161651.5176; val_kl_reg_loss: 1888.3657; val_edge_recon_loss: 76879.2543; val_gene_expr_recon_loss: 83805.3707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162572.9878; val_optim_loss: 162572.9878
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9920; val_auprc_score: 0.9977; val_best_acc_score: 0.9851; val_best_f1_score: 0.9913; train_kl_reg_loss: 1918.6300; train_edge_recon_loss: 76261.7847; train_gene_expr_recon_loss: 84082.5515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162262.9662; train_optim_loss: 162262.9662; val_kl_reg_loss: 1890.4746; val_edge_recon_loss: 74987.3793; val_gene_expr_recon_loss: 84035.2170; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160913.0694; val_optim_loss: 160913.0694
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9911; val_auprc_score: 0.9974; val_best_acc_score: 0.9837; val_best_f1_score: 0.9905; train_kl_reg_loss: 1911.9650; train_edge_recon_loss: 75966.1780; train_gene_expr_recon_loss: 84102.0403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161980.1835; train_optim_loss: 161980.1835; val_kl_reg_loss: 1897.8614; val_edge_recon_loss: 75876.2413; val_gene_expr_recon_loss: 83644.4288; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161418.5295; val_optim_loss: 161418.5295

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9918; val_auprc_score: 0.9981; val_best_acc_score: 0.9847; val_best_f1_score: 0.9911; train_kl_reg_loss: 1921.8275; train_edge_recon_loss: 76263.8024; train_gene_expr_recon_loss: 83952.0160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162137.6462; train_optim_loss: 162137.6462; val_kl_reg_loss: 1895.2421; val_edge_recon_loss: 75207.2283; val_gene_expr_recon_loss: 83835.0347; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160937.5069; val_optim_loss: 160937.5069
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9910; val_auprc_score: 0.9975; val_best_acc_score: 0.9841; val_best_f1_score: 0.9908; train_kl_reg_loss: 1916.6042; train_edge_recon_loss: 76028.6491; train_gene_expr_recon_loss: 84029.5321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161974.7856; train_optim_loss: 161974.7856; val_kl_reg_loss: 1892.8882; val_edge_recon_loss: 75846.9418; val_gene_expr_recon_loss: 84017.6155; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161757.4444; val_optim_loss: 161757.4444
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9906; val_auprc_score: 0.9972; val_best_acc_score: 0.9845; val_best_f1_score: 0.9909; train_kl_reg_loss: 1915.8520; train_edge_recon_loss: 76470.6015; train_gene_expr_recon_loss: 84042.1619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162428.6157; train_optim_loss: 162428.6157; val_kl_reg_loss: 1894.0208; val_edge_recon_loss: 76917.3837; val_gene_expr_recon_loss: 83855.2387; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162666.6441; val_optim_loss: 162666.6441

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 14 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9918
Val AUPRC score: 0.9972
Val best accuracy score: 0.9855
Val best F1 score: 0.9915
Val gene expr MSE score: 0.8384
Duration of model training in run 5: 0 hours, 5 minutes and 20 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 159885
Number of validation edges: 17764
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9465; val_auprc_score: 0.9880; val_best_acc_score: 0.9300; val_best_f1_score: 0.9596; train_kl_reg_loss: 1403.2993; train_edge_recon_loss: 90043.4357; train_gene_expr_recon_loss: 97558.1214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189004.8570; train_optim_loss: 189004.8570; val_kl_reg_loss: 2013.5170; val_edge_recon_loss: 82005.9913; val_gene_expr_recon_loss: 92565.0208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176584.5295; val_optim_loss: 176584.5295
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9811; val_auprc_score: 0.9953; val_best_acc_score: 0.9636; val_best_f1_score: 0.9789; train_kl_reg_loss: 2046.4480; train_edge_recon_loss: 78811.2242; train_gene_expr_recon_loss: 91775.7843; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172633.4577; train_optim_loss: 172633.4577; val_kl_reg_loss: 2013.9227; val_edge_recon_loss: 77229.1476; val_gene_expr_recon_loss: 90581.6892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169824.7604; val_optim_loss: 169824.7604
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9864; val_auprc_score: 0.9969; val_best_acc_score: 0.9739; val_best_f1_score: 0.9848; train_kl_reg_loss: 2009.0254; train_edge_recon_loss: 77174.3873; train_gene_expr_recon_loss: 89956.5620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169139.9747; train_optim_loss: 169139.9747; val_kl_reg_loss: 1945.8448; val_edge_recon_loss: 76036.2951; val_gene_expr_recon_loss: 89061.9479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167044.0851; val_optim_loss: 167044.0851
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9872; val_auprc_score: 0.9968; val_best_acc_score: 0.9752; val_best_f1_score: 0.9855; train_kl_reg_loss: 1971.1342; train_edge_recon_loss: 76985.9318; train_gene_expr_recon_loss: 88763.1198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167720.1857; train_optim_loss: 167720.1857; val_kl_reg_loss: 1950.4654; val_edge_recon_loss: 77570.4002; val_gene_expr_recon_loss: 87893.9974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167414.8646; val_optim_loss: 167414.8646
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9868; val_auprc_score: 0.9966; val_best_acc_score: 0.9774; val_best_f1_score: 0.9868; train_kl_reg_loss: 1950.1660; train_edge_recon_loss: 76463.0127; train_gene_expr_recon_loss: 87998.9873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166412.1661; train_optim_loss: 166412.1661; val_kl_reg_loss: 1890.7703; val_edge_recon_loss: 78619.4566; val_gene_expr_recon_loss: 87623.7240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168133.9497; val_optim_loss: 168133.9497
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9873; val_auprc_score: 0.9969; val_best_acc_score: 0.9808; val_best_f1_score: 0.9888; train_kl_reg_loss: 1931.3898; train_edge_recon_loss: 76006.2968; train_gene_expr_recon_loss: 87505.9385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165443.6252; train_optim_loss: 165443.6252; val_kl_reg_loss: 1935.5887; val_edge_recon_loss: 76745.1502; val_gene_expr_recon_loss: 87097.2622; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165778.0000; val_optim_loss: 165778.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9910; val_auprc_score: 0.9982; val_best_acc_score: 0.9803; val_best_f1_score: 0.9886; train_kl_reg_loss: 1917.3581; train_edge_recon_loss: 76270.0818; train_gene_expr_recon_loss: 86936.4795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165123.9191; train_optim_loss: 165123.9191; val_kl_reg_loss: 1910.1550; val_edge_recon_loss: 76032.4427; val_gene_expr_recon_loss: 86791.5738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164734.1771; val_optim_loss: 164734.1771
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9903; val_auprc_score: 0.9973; val_best_acc_score: 0.9825; val_best_f1_score: 0.9898; train_kl_reg_loss: 1922.8893; train_edge_recon_loss: 76540.3721; train_gene_expr_recon_loss: 86531.1392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164994.4003; train_optim_loss: 164994.4003; val_kl_reg_loss: 1837.8898; val_edge_recon_loss: 76651.7109; val_gene_expr_recon_loss: 85817.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164307.0087; val_optim_loss: 164307.0087
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9910; val_auprc_score: 0.9980; val_best_acc_score: 0.9813; val_best_f1_score: 0.9891; train_kl_reg_loss: 1915.6838; train_edge_recon_loss: 76912.7368; train_gene_expr_recon_loss: 86121.8524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164950.2723; train_optim_loss: 164950.2723; val_kl_reg_loss: 1848.1543; val_edge_recon_loss: 77260.6181; val_gene_expr_recon_loss: 86016.7196; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165125.4913; val_optim_loss: 165125.4913
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9893; val_auprc_score: 0.9973; val_best_acc_score: 0.9822; val_best_f1_score: 0.9897; train_kl_reg_loss: 1924.3171; train_edge_recon_loss: 76994.7146; train_gene_expr_recon_loss: 85655.6346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164574.6661; train_optim_loss: 164574.6661; val_kl_reg_loss: 1918.3590; val_edge_recon_loss: 75900.5460; val_gene_expr_recon_loss: 85247.7118; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163066.6163; val_optim_loss: 163066.6163
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9890; val_auprc_score: 0.9967; val_best_acc_score: 0.9838; val_best_f1_score: 0.9906; train_kl_reg_loss: 1913.4533; train_edge_recon_loss: 76296.7819; train_gene_expr_recon_loss: 85372.3150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163582.5494; train_optim_loss: 163582.5494; val_kl_reg_loss: 1874.5800; val_edge_recon_loss: 74899.5972; val_gene_expr_recon_loss: 85119.3880; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161893.5642; val_optim_loss: 161893.5642
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9892; val_auprc_score: 0.9968; val_best_acc_score: 0.9836; val_best_f1_score: 0.9904; train_kl_reg_loss: 1925.8387; train_edge_recon_loss: 76893.8375; train_gene_expr_recon_loss: 85197.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164016.8760; train_optim_loss: 164016.8760; val_kl_reg_loss: 1942.4358; val_edge_recon_loss: 76701.2083; val_gene_expr_recon_loss: 84847.7040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163491.3490; val_optim_loss: 163491.3490
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9907; val_auprc_score: 0.9975; val_best_acc_score: 0.9844; val_best_f1_score: 0.9909; train_kl_reg_loss: 1921.6241; train_edge_recon_loss: 76708.6241; train_gene_expr_recon_loss: 84840.2517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163470.5000; train_optim_loss: 163470.5000; val_kl_reg_loss: 1900.4773; val_edge_recon_loss: 76033.4314; val_gene_expr_recon_loss: 84567.0304; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162500.9427; val_optim_loss: 162500.9427
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9907; val_auprc_score: 0.9974; val_best_acc_score: 0.9847; val_best_f1_score: 0.9911; train_kl_reg_loss: 1919.5222; train_edge_recon_loss: 76335.5944; train_gene_expr_recon_loss: 84507.6529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162762.7694; train_optim_loss: 162762.7694; val_kl_reg_loss: 1908.5735; val_edge_recon_loss: 76893.1059; val_gene_expr_recon_loss: 84357.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163158.9514; val_optim_loss: 163158.9514

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9923; val_auprc_score: 0.9979; val_best_acc_score: 0.9852; val_best_f1_score: 0.9914; train_kl_reg_loss: 1921.9178; train_edge_recon_loss: 76390.9635; train_gene_expr_recon_loss: 84252.9273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162565.8081; train_optim_loss: 162565.8081; val_kl_reg_loss: 1903.9710; val_edge_recon_loss: 74395.2648; val_gene_expr_recon_loss: 84216.8073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160516.0399; val_optim_loss: 160516.0399
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9941; val_auprc_score: 0.9987; val_best_acc_score: 0.9865; val_best_f1_score: 0.9922; train_kl_reg_loss: 1921.3795; train_edge_recon_loss: 75908.6045; train_gene_expr_recon_loss: 84128.4196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161958.4037; train_optim_loss: 161958.4037; val_kl_reg_loss: 1898.1977; val_edge_recon_loss: 73934.8984; val_gene_expr_recon_loss: 84164.5434; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159997.6389; val_optim_loss: 159997.6389
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9907; val_auprc_score: 0.9965; val_best_acc_score: 0.9848; val_best_f1_score: 0.9911; train_kl_reg_loss: 1920.9399; train_edge_recon_loss: 75668.3229; train_gene_expr_recon_loss: 84218.1428; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161807.4057; train_optim_loss: 161807.4057; val_kl_reg_loss: 1901.1675; val_edge_recon_loss: 75225.8346; val_gene_expr_recon_loss: 84211.1380; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161338.1389; val_optim_loss: 161338.1389
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9922; val_auprc_score: 0.9982; val_best_acc_score: 0.9850; val_best_f1_score: 0.9912; train_kl_reg_loss: 1925.6404; train_edge_recon_loss: 75821.1444; train_gene_expr_recon_loss: 84121.8714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161868.6559; train_optim_loss: 161868.6559; val_kl_reg_loss: 1910.9264; val_edge_recon_loss: 76993.6953; val_gene_expr_recon_loss: 83743.1589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162647.7760; val_optim_loss: 162647.7760
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9916; val_auprc_score: 0.9972; val_best_acc_score: 0.9856; val_best_f1_score: 0.9916; train_kl_reg_loss: 1925.0457; train_edge_recon_loss: 76672.7362; train_gene_expr_recon_loss: 84203.9216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162801.7043; train_optim_loss: 162801.7043; val_kl_reg_loss: 1889.6281; val_edge_recon_loss: 77171.3290; val_gene_expr_recon_loss: 83994.3932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163055.3472; val_optim_loss: 163055.3472

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9927; val_auprc_score: 0.9982; val_best_acc_score: 0.9863; val_best_f1_score: 0.9920; train_kl_reg_loss: 1916.0329; train_edge_recon_loss: 76346.7441; train_gene_expr_recon_loss: 84117.3862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162380.1628; train_optim_loss: 162380.1628; val_kl_reg_loss: 1895.9800; val_edge_recon_loss: 75551.9045; val_gene_expr_recon_loss: 84006.4783; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161454.3611; val_optim_loss: 161454.3611
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9905; val_auprc_score: 0.9975; val_best_acc_score: 0.9854; val_best_f1_score: 0.9915; train_kl_reg_loss: 1918.9524; train_edge_recon_loss: 75833.1016; train_gene_expr_recon_loss: 84029.1774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161781.2320; train_optim_loss: 161781.2320; val_kl_reg_loss: 1895.8426; val_edge_recon_loss: 73755.6684; val_gene_expr_recon_loss: 83988.8941; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159640.4045; val_optim_loss: 159640.4045
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9925; val_auprc_score: 0.9982; val_best_acc_score: 0.9855; val_best_f1_score: 0.9915; train_kl_reg_loss: 1917.8151; train_edge_recon_loss: 75989.3603; train_gene_expr_recon_loss: 84060.9207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161968.0949; train_optim_loss: 161968.0949; val_kl_reg_loss: 1896.5300; val_edge_recon_loss: 75425.7474; val_gene_expr_recon_loss: 84130.9592; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161453.2361; val_optim_loss: 161453.2361
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9928; val_auprc_score: 0.9979; val_best_acc_score: 0.9855; val_best_f1_score: 0.9916; train_kl_reg_loss: 1921.2323; train_edge_recon_loss: 76653.8385; train_gene_expr_recon_loss: 83985.3634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162560.4333; train_optim_loss: 162560.4333; val_kl_reg_loss: 1898.7530; val_edge_recon_loss: 73787.9492; val_gene_expr_recon_loss: 84156.9401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159843.6424; val_optim_loss: 159843.6424
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9927; val_auprc_score: 0.9979; val_best_acc_score: 0.9854; val_best_f1_score: 0.9915; train_kl_reg_loss: 1923.9185; train_edge_recon_loss: 76070.0927; train_gene_expr_recon_loss: 84027.9416; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162021.9529; train_optim_loss: 162021.9529; val_kl_reg_loss: 1898.7587; val_edge_recon_loss: 77229.3273; val_gene_expr_recon_loss: 83870.5130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162998.6024; val_optim_loss: 162998.6024

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9915; val_auprc_score: 0.9973; val_best_acc_score: 0.9853; val_best_f1_score: 0.9915; train_kl_reg_loss: 1923.5644; train_edge_recon_loss: 76754.6596; train_gene_expr_recon_loss: 84159.2719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162837.4955; train_optim_loss: 162837.4955; val_kl_reg_loss: 1899.4978; val_edge_recon_loss: 74595.7795; val_gene_expr_recon_loss: 83867.4332; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160362.7101; val_optim_loss: 160362.7101
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9928; val_auprc_score: 0.9982; val_best_acc_score: 0.9857; val_best_f1_score: 0.9917; train_kl_reg_loss: 1923.1777; train_edge_recon_loss: 75829.6478; train_gene_expr_recon_loss: 84043.5030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161796.3289; train_optim_loss: 161796.3289; val_kl_reg_loss: 1899.0275; val_edge_recon_loss: 75210.4609; val_gene_expr_recon_loss: 83944.8724; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161054.3611; val_optim_loss: 161054.3611
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9926; val_auprc_score: 0.9982; val_best_acc_score: 0.9854; val_best_f1_score: 0.9915; train_kl_reg_loss: 1922.7478; train_edge_recon_loss: 76278.6170; train_gene_expr_recon_loss: 84047.9489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162249.3133; train_optim_loss: 162249.3133; val_kl_reg_loss: 1899.6491; val_edge_recon_loss: 75812.8021; val_gene_expr_recon_loss: 84295.4523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162007.9045; val_optim_loss: 162007.9045

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 23 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9927
Val AUPRC score: 0.9979
Val best accuracy score: 0.9860
Val best F1 score: 0.9918
Val gene expr MSE score: 0.8630
Duration of model training in run 6: 0 hours, 5 minutes and 28 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 212411
Number of validation edges: 23601
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9833; val_auprc_score: 0.9959; val_best_acc_score: 0.9720; val_best_f1_score: 0.9837; train_kl_reg_loss: 1713.4550; train_edge_recon_loss: 83913.8723; train_gene_expr_recon_loss: 93785.4273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179412.7547; train_optim_loss: 179412.7547; val_kl_reg_loss: 1958.8664; val_edge_recon_loss: 75423.1851; val_gene_expr_recon_loss: 90560.3509; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167942.4010; val_optim_loss: 167942.4010
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9872; val_auprc_score: 0.9969; val_best_acc_score: 0.9774; val_best_f1_score: 0.9868; train_kl_reg_loss: 1961.7617; train_edge_recon_loss: 76937.8456; train_gene_expr_recon_loss: 88506.4069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167406.0143; train_optim_loss: 167406.0143; val_kl_reg_loss: 1913.4092; val_edge_recon_loss: 76309.8989; val_gene_expr_recon_loss: 88541.5251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166764.8327; val_optim_loss: 166764.8327
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9881; val_auprc_score: 0.9966; val_best_acc_score: 0.9808; val_best_f1_score: 0.9889; train_kl_reg_loss: 1923.0358; train_edge_recon_loss: 77478.4780; train_gene_expr_recon_loss: 86917.4864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166319.0003; train_optim_loss: 166319.0003; val_kl_reg_loss: 1879.1666; val_edge_recon_loss: 75686.3698; val_gene_expr_recon_loss: 87127.8486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164693.3841; val_optim_loss: 164693.3841
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9895; val_auprc_score: 0.9976; val_best_acc_score: 0.9813; val_best_f1_score: 0.9891; train_kl_reg_loss: 1910.8783; train_edge_recon_loss: 76498.1807; train_gene_expr_recon_loss: 86052.0433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164461.1025; train_optim_loss: 164461.1025; val_kl_reg_loss: 1859.7549; val_edge_recon_loss: 76746.2646; val_gene_expr_recon_loss: 86473.5889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165079.6094; val_optim_loss: 165079.6094
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9892; val_auprc_score: 0.9963; val_best_acc_score: 0.9831; val_best_f1_score: 0.9902; train_kl_reg_loss: 1908.3810; train_edge_recon_loss: 76308.3307; train_gene_expr_recon_loss: 85278.3671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163495.0786; train_optim_loss: 163495.0786; val_kl_reg_loss: 1879.7959; val_edge_recon_loss: 77579.4137; val_gene_expr_recon_loss: 85764.6478; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165223.8587; val_optim_loss: 165223.8587
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9911; val_auprc_score: 0.9975; val_best_acc_score: 0.9841; val_best_f1_score: 0.9907; train_kl_reg_loss: 1912.2672; train_edge_recon_loss: 76428.4295; train_gene_expr_recon_loss: 84665.1208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163005.8170; train_optim_loss: 163005.8170; val_kl_reg_loss: 1862.4882; val_edge_recon_loss: 76445.9089; val_gene_expr_recon_loss: 85101.0527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163409.4518; val_optim_loss: 163409.4518
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9926; val_auprc_score: 0.9979; val_best_acc_score: 0.9854; val_best_f1_score: 0.9915; train_kl_reg_loss: 1911.2262; train_edge_recon_loss: 76178.3404; train_gene_expr_recon_loss: 84052.6757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162142.2422; train_optim_loss: 162142.2422; val_kl_reg_loss: 1912.7628; val_edge_recon_loss: 74163.7866; val_gene_expr_recon_loss: 84967.0495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161043.5996; val_optim_loss: 161043.5996
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9914; val_auprc_score: 0.9974; val_best_acc_score: 0.9849; val_best_f1_score: 0.9912; train_kl_reg_loss: 1916.7708; train_edge_recon_loss: 76029.8175; train_gene_expr_recon_loss: 83767.7037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161714.2918; train_optim_loss: 161714.2918; val_kl_reg_loss: 1884.6481; val_edge_recon_loss: 74900.9536; val_gene_expr_recon_loss: 84299.9414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161085.5449; val_optim_loss: 161085.5449
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9913; val_auprc_score: 0.9976; val_best_acc_score: 0.9861; val_best_f1_score: 0.9919; train_kl_reg_loss: 1923.3364; train_edge_recon_loss: 76133.0717; train_gene_expr_recon_loss: 83179.4672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161235.8758; train_optim_loss: 161235.8758; val_kl_reg_loss: 1878.9987; val_edge_recon_loss: 75360.4183; val_gene_expr_recon_loss: 84207.3226; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161446.7383; val_optim_loss: 161446.7383
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9905; val_auprc_score: 0.9964; val_best_acc_score: 0.9842; val_best_f1_score: 0.9907; train_kl_reg_loss: 1930.1569; train_edge_recon_loss: 76637.4854; train_gene_expr_recon_loss: 83089.0574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161656.6996; train_optim_loss: 161656.6996; val_kl_reg_loss: 1911.1475; val_edge_recon_loss: 77524.4525; val_gene_expr_recon_loss: 83840.4788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163276.0788; val_optim_loss: 163276.0788

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9931; val_auprc_score: 0.9977; val_best_acc_score: 0.9869; val_best_f1_score: 0.9923; train_kl_reg_loss: 1933.4037; train_edge_recon_loss: 76116.5748; train_gene_expr_recon_loss: 82342.5949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160392.5723; train_optim_loss: 160392.5723; val_kl_reg_loss: 1922.2743; val_edge_recon_loss: 75759.0881; val_gene_expr_recon_loss: 83144.5563; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160825.9180; val_optim_loss: 160825.9180
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9925; val_auprc_score: 0.9978; val_best_acc_score: 0.9867; val_best_f1_score: 0.9922; train_kl_reg_loss: 1928.0291; train_edge_recon_loss: 76096.0813; train_gene_expr_recon_loss: 82207.3449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160231.4555; train_optim_loss: 160231.4555; val_kl_reg_loss: 1911.0671; val_edge_recon_loss: 76087.7223; val_gene_expr_recon_loss: 83111.5485; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161110.3379; val_optim_loss: 161110.3379
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9892; val_auprc_score: 0.9966; val_best_acc_score: 0.9864; val_best_f1_score: 0.9921; train_kl_reg_loss: 1923.5233; train_edge_recon_loss: 75903.6177; train_gene_expr_recon_loss: 82351.0776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160178.2188; train_optim_loss: 160178.2188; val_kl_reg_loss: 1890.1479; val_edge_recon_loss: 74603.6016; val_gene_expr_recon_loss: 83135.7484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159629.4974; val_optim_loss: 159629.4974
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9888; val_auprc_score: 0.9961; val_best_acc_score: 0.9853; val_best_f1_score: 0.9915; train_kl_reg_loss: 1925.9243; train_edge_recon_loss: 76331.0848; train_gene_expr_recon_loss: 82199.7297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160456.7395; train_optim_loss: 160456.7395; val_kl_reg_loss: 1909.3176; val_edge_recon_loss: 76627.5765; val_gene_expr_recon_loss: 83039.4489; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161576.3438; val_optim_loss: 161576.3438
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9940; val_auprc_score: 0.9981; val_best_acc_score: 0.9877; val_best_f1_score: 0.9928; train_kl_reg_loss: 1926.9633; train_edge_recon_loss: 75611.3922; train_gene_expr_recon_loss: 82175.8701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159714.2256; train_optim_loss: 159714.2256; val_kl_reg_loss: 1891.9106; val_edge_recon_loss: 76560.9548; val_gene_expr_recon_loss: 83134.0153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161586.8796; val_optim_loss: 161586.8796
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9942; val_auprc_score: 0.9986; val_best_acc_score: 0.9875; val_best_f1_score: 0.9927; train_kl_reg_loss: 1929.9897; train_edge_recon_loss: 76295.1434; train_gene_expr_recon_loss: 82181.4967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160406.6306; train_optim_loss: 160406.6306; val_kl_reg_loss: 1909.2618; val_edge_recon_loss: 76394.5801; val_gene_expr_recon_loss: 83391.8063; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161695.6484; val_optim_loss: 161695.6484

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9924; val_auprc_score: 0.9979; val_best_acc_score: 0.9870; val_best_f1_score: 0.9924; train_kl_reg_loss: 1927.2491; train_edge_recon_loss: 76672.0743; train_gene_expr_recon_loss: 82102.5157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160701.8381; train_optim_loss: 160701.8381; val_kl_reg_loss: 1905.3213; val_edge_recon_loss: 74873.5055; val_gene_expr_recon_loss: 83202.3955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159981.2201; val_optim_loss: 159981.2201
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9929; val_auprc_score: 0.9978; val_best_acc_score: 0.9872; val_best_f1_score: 0.9925; train_kl_reg_loss: 1925.7670; train_edge_recon_loss: 75875.8546; train_gene_expr_recon_loss: 82166.1934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159967.8150; train_optim_loss: 159967.8150; val_kl_reg_loss: 1904.9243; val_edge_recon_loss: 76724.9368; val_gene_expr_recon_loss: 82781.9010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161411.7637; val_optim_loss: 161411.7637
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9932; val_auprc_score: 0.9980; val_best_acc_score: 0.9874; val_best_f1_score: 0.9927; train_kl_reg_loss: 1928.4831; train_edge_recon_loss: 76091.3936; train_gene_expr_recon_loss: 82089.2463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160109.1228; train_optim_loss: 160109.1228; val_kl_reg_loss: 1908.4520; val_edge_recon_loss: 74960.0332; val_gene_expr_recon_loss: 82943.6201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159812.1068; val_optim_loss: 159812.1068

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 8 min 40 sec.
Using best model state, which was in epoch 13.

--- MODEL EVALUATION ---
Val AUROC score: 0.9921
Val AUPRC score: 0.9979
Val best accuracy score: 0.9865
Val best F1 score: 0.9921
Val gene expr MSE score: 0.8696
Duration of model training in run 7: 0 hours, 8 minutes and 49 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 212411
Number of validation edges: 23601
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9848; val_auprc_score: 0.9967; val_best_acc_score: 0.9690; val_best_f1_score: 0.9820; train_kl_reg_loss: 1680.6256; train_edge_recon_loss: 83527.7920; train_gene_expr_recon_loss: 94087.9142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179296.3317; train_optim_loss: 179296.3317; val_kl_reg_loss: 1907.7393; val_edge_recon_loss: 75186.6895; val_gene_expr_recon_loss: 89094.8701; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166189.2969; val_optim_loss: 166189.2969
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9861; val_auprc_score: 0.9961; val_best_acc_score: 0.9784; val_best_f1_score: 0.9875; train_kl_reg_loss: 1961.5898; train_edge_recon_loss: 77031.9639; train_gene_expr_recon_loss: 88630.7185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167624.2725; train_optim_loss: 167624.2725; val_kl_reg_loss: 1914.6106; val_edge_recon_loss: 75357.6564; val_gene_expr_recon_loss: 86911.1240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164183.3893; val_optim_loss: 164183.3893
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9858; val_auprc_score: 0.9959; val_best_acc_score: 0.9797; val_best_f1_score: 0.9882; train_kl_reg_loss: 1923.7559; train_edge_recon_loss: 76815.0427; train_gene_expr_recon_loss: 87109.5457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165848.3441; train_optim_loss: 165848.3441; val_kl_reg_loss: 1958.7937; val_edge_recon_loss: 77032.4020; val_gene_expr_recon_loss: 85653.3796; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164644.5755; val_optim_loss: 164644.5755
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9888; val_auprc_score: 0.9967; val_best_acc_score: 0.9824; val_best_f1_score: 0.9898; train_kl_reg_loss: 1911.5551; train_edge_recon_loss: 76546.4194; train_gene_expr_recon_loss: 86190.1925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164648.1672; train_optim_loss: 164648.1672; val_kl_reg_loss: 1886.8735; val_edge_recon_loss: 75265.7915; val_gene_expr_recon_loss: 84839.1982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161991.8626; val_optim_loss: 161991.8626
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9897; val_auprc_score: 0.9970; val_best_acc_score: 0.9838; val_best_f1_score: 0.9906; train_kl_reg_loss: 1916.7372; train_edge_recon_loss: 76040.4126; train_gene_expr_recon_loss: 85279.2514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163236.4009; train_optim_loss: 163236.4009; val_kl_reg_loss: 1872.0620; val_edge_recon_loss: 74246.3813; val_gene_expr_recon_loss: 84139.8929; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160258.3359; val_optim_loss: 160258.3359
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9904; val_auprc_score: 0.9968; val_best_acc_score: 0.9850; val_best_f1_score: 0.9912; train_kl_reg_loss: 1912.7558; train_edge_recon_loss: 76621.1980; train_gene_expr_recon_loss: 84853.5631; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163387.5168; train_optim_loss: 163387.5168; val_kl_reg_loss: 1889.3306; val_edge_recon_loss: 76744.3626; val_gene_expr_recon_loss: 83525.6826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162159.3757; val_optim_loss: 162159.3757
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9919; val_auprc_score: 0.9976; val_best_acc_score: 0.9854; val_best_f1_score: 0.9915; train_kl_reg_loss: 1919.0001; train_edge_recon_loss: 75968.7794; train_gene_expr_recon_loss: 84167.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162054.8249; train_optim_loss: 162054.8249; val_kl_reg_loss: 1881.6158; val_edge_recon_loss: 76347.7419; val_gene_expr_recon_loss: 83084.8763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161314.2344; val_optim_loss: 161314.2344
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9925; val_auprc_score: 0.9977; val_best_acc_score: 0.9858; val_best_f1_score: 0.9917; train_kl_reg_loss: 1928.8844; train_edge_recon_loss: 76434.6742; train_gene_expr_recon_loss: 83788.7243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162152.2837; train_optim_loss: 162152.2837; val_kl_reg_loss: 1910.4459; val_edge_recon_loss: 75349.1465; val_gene_expr_recon_loss: 82901.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160160.6341; val_optim_loss: 160160.6341
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9929; val_auprc_score: 0.9981; val_best_acc_score: 0.9855; val_best_f1_score: 0.9915; train_kl_reg_loss: 1920.7710; train_edge_recon_loss: 75941.3039; train_gene_expr_recon_loss: 83467.8510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161329.9265; train_optim_loss: 161329.9265; val_kl_reg_loss: 1896.1162; val_edge_recon_loss: 78389.6406; val_gene_expr_recon_loss: 82503.3382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162789.0951; val_optim_loss: 162789.0951
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9924; val_auprc_score: 0.9978; val_best_acc_score: 0.9870; val_best_f1_score: 0.9924; train_kl_reg_loss: 1931.6478; train_edge_recon_loss: 75708.1975; train_gene_expr_recon_loss: 83135.5095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160775.3554; train_optim_loss: 160775.3554; val_kl_reg_loss: 1902.4587; val_edge_recon_loss: 78686.4984; val_gene_expr_recon_loss: 82254.3568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162843.3151; val_optim_loss: 162843.3151
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9928; val_auprc_score: 0.9971; val_best_acc_score: 0.9869; val_best_f1_score: 0.9923; train_kl_reg_loss: 1932.6381; train_edge_recon_loss: 75923.0210; train_gene_expr_recon_loss: 82856.1045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160711.7643; train_optim_loss: 160711.7643; val_kl_reg_loss: 1913.2140; val_edge_recon_loss: 77172.4285; val_gene_expr_recon_loss: 81948.7839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161034.4264; val_optim_loss: 161034.4264

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9925; val_auprc_score: 0.9980; val_best_acc_score: 0.9871; val_best_f1_score: 0.9925; train_kl_reg_loss: 1947.6523; train_edge_recon_loss: 75776.1734; train_gene_expr_recon_loss: 82202.4559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159926.2813; train_optim_loss: 159926.2813; val_kl_reg_loss: 1907.6392; val_edge_recon_loss: 75273.1201; val_gene_expr_recon_loss: 81368.4840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158549.2448; val_optim_loss: 158549.2448
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9937; val_auprc_score: 0.9979; val_best_acc_score: 0.9878; val_best_f1_score: 0.9929; train_kl_reg_loss: 1932.2956; train_edge_recon_loss: 75900.1198; train_gene_expr_recon_loss: 82200.5948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160033.0093; train_optim_loss: 160033.0093; val_kl_reg_loss: 1925.4629; val_edge_recon_loss: 76934.2637; val_gene_expr_recon_loss: 81242.1999; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160101.9245; val_optim_loss: 160101.9245
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9922; val_auprc_score: 0.9970; val_best_acc_score: 0.9874; val_best_f1_score: 0.9927; train_kl_reg_loss: 1935.0333; train_edge_recon_loss: 75900.3027; train_gene_expr_recon_loss: 82189.7780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160025.1137; train_optim_loss: 160025.1137; val_kl_reg_loss: 1919.0717; val_edge_recon_loss: 76342.6940; val_gene_expr_recon_loss: 81048.1201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159309.8841; val_optim_loss: 159309.8841
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9935; val_auprc_score: 0.9984; val_best_acc_score: 0.9879; val_best_f1_score: 0.9929; train_kl_reg_loss: 1928.1007; train_edge_recon_loss: 75811.9251; train_gene_expr_recon_loss: 82122.8967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159862.9226; train_optim_loss: 159862.9226; val_kl_reg_loss: 1904.9163; val_edge_recon_loss: 75908.4842; val_gene_expr_recon_loss: 81803.2487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159616.6497; val_optim_loss: 159616.6497

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9934; val_auprc_score: 0.9977; val_best_acc_score: 0.9875; val_best_f1_score: 0.9927; train_kl_reg_loss: 1929.0638; train_edge_recon_loss: 75913.3700; train_gene_expr_recon_loss: 82087.4685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159929.9020; train_optim_loss: 159929.9020; val_kl_reg_loss: 1909.6076; val_edge_recon_loss: 74162.2725; val_gene_expr_recon_loss: 81613.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157685.4746; val_optim_loss: 157685.4746
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9930; val_auprc_score: 0.9980; val_best_acc_score: 0.9880; val_best_f1_score: 0.9930; train_kl_reg_loss: 1931.3284; train_edge_recon_loss: 76282.6688; train_gene_expr_recon_loss: 82006.4699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160220.4676; train_optim_loss: 160220.4676; val_kl_reg_loss: 1910.9853; val_edge_recon_loss: 77531.2793; val_gene_expr_recon_loss: 80953.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160395.5221; val_optim_loss: 160395.5221
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9926; val_auprc_score: 0.9981; val_best_acc_score: 0.9872; val_best_f1_score: 0.9925; train_kl_reg_loss: 1932.4250; train_edge_recon_loss: 76235.3733; train_gene_expr_recon_loss: 81972.7708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160140.5688; train_optim_loss: 160140.5688; val_kl_reg_loss: 1909.2061; val_edge_recon_loss: 76773.1963; val_gene_expr_recon_loss: 81464.5592; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160146.9609; val_optim_loss: 160146.9609
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9931; val_auprc_score: 0.9981; val_best_acc_score: 0.9881; val_best_f1_score: 0.9930; train_kl_reg_loss: 1931.8452; train_edge_recon_loss: 75753.9023; train_gene_expr_recon_loss: 82018.5964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159704.3433; train_optim_loss: 159704.3433; val_kl_reg_loss: 1914.3753; val_edge_recon_loss: 75023.1152; val_gene_expr_recon_loss: 81461.5566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158399.0456; val_optim_loss: 158399.0456

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9937; val_auprc_score: 0.9981; val_best_acc_score: 0.9878; val_best_f1_score: 0.9928; train_kl_reg_loss: 1933.3389; train_edge_recon_loss: 76224.5076; train_gene_expr_recon_loss: 81978.8643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160136.7106; train_optim_loss: 160136.7106; val_kl_reg_loss: 1912.0569; val_edge_recon_loss: 76537.0799; val_gene_expr_recon_loss: 81418.8070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159867.9414; val_optim_loss: 159867.9414
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9927; val_auprc_score: 0.9982; val_best_acc_score: 0.9885; val_best_f1_score: 0.9933; train_kl_reg_loss: 1932.8755; train_edge_recon_loss: 75864.2610; train_gene_expr_recon_loss: 81982.1857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159779.3227; train_optim_loss: 159779.3227; val_kl_reg_loss: 1912.6206; val_edge_recon_loss: 74591.3600; val_gene_expr_recon_loss: 81258.2259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157762.2064; val_optim_loss: 157762.2064
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9905; val_auprc_score: 0.9972; val_best_acc_score: 0.9872; val_best_f1_score: 0.9925; train_kl_reg_loss: 1931.8301; train_edge_recon_loss: 75659.3286; train_gene_expr_recon_loss: 81961.6710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159552.8296; train_optim_loss: 159552.8296; val_kl_reg_loss: 1910.3350; val_edge_recon_loss: 76309.1733; val_gene_expr_recon_loss: 81001.5042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159221.0124; val_optim_loss: 159221.0124

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 10 min 16 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
Val AUROC score: 0.9932
Val AUPRC score: 0.9978
Val best accuracy score: 0.9882
Val best F1 score: 0.9931
Val gene expr MSE score: 0.8152
Duration of model training in run 8: 0 hours, 10 minutes and 26 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 265201
Number of validation edges: 29466
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9852; val_auprc_score: 0.9962; val_best_acc_score: 0.9739; val_best_f1_score: 0.9848; train_kl_reg_loss: 1739.4363; train_edge_recon_loss: 81881.6677; train_gene_expr_recon_loss: 92850.2451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176471.3488; train_optim_loss: 176471.3488; val_kl_reg_loss: 2003.6385; val_edge_recon_loss: 76171.2500; val_gene_expr_recon_loss: 88918.6673; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167093.5577; val_optim_loss: 167093.5577
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9869; val_auprc_score: 0.9962; val_best_acc_score: 0.9799; val_best_f1_score: 0.9883; train_kl_reg_loss: 1946.5057; train_edge_recon_loss: 77610.3322; train_gene_expr_recon_loss: 87813.0020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167369.8404; train_optim_loss: 167369.8404; val_kl_reg_loss: 1962.7398; val_edge_recon_loss: 76984.5089; val_gene_expr_recon_loss: 86731.8844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165679.1315; val_optim_loss: 165679.1315
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9888; val_auprc_score: 0.9969; val_best_acc_score: 0.9824; val_best_f1_score: 0.9898; train_kl_reg_loss: 1904.8987; train_edge_recon_loss: 76246.7438; train_gene_expr_recon_loss: 86307.0701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164458.7126; train_optim_loss: 164458.7126; val_kl_reg_loss: 1830.9358; val_edge_recon_loss: 75554.9119; val_gene_expr_recon_loss: 85617.3675; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163003.2155; val_optim_loss: 163003.2155
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9866; val_auprc_score: 0.9955; val_best_acc_score: 0.9811; val_best_f1_score: 0.9890; train_kl_reg_loss: 1900.4772; train_edge_recon_loss: 76374.1260; train_gene_expr_recon_loss: 85267.4057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163542.0089; train_optim_loss: 163542.0089; val_kl_reg_loss: 1926.2252; val_edge_recon_loss: 77908.7352; val_gene_expr_recon_loss: 84746.9652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164581.9262; val_optim_loss: 164581.9262
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9894; val_auprc_score: 0.9973; val_best_acc_score: 0.9834; val_best_f1_score: 0.9903; train_kl_reg_loss: 1902.0051; train_edge_recon_loss: 76450.3057; train_gene_expr_recon_loss: 84499.1594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162851.4700; train_optim_loss: 162851.4700; val_kl_reg_loss: 1873.2088; val_edge_recon_loss: 77021.0544; val_gene_expr_recon_loss: 83719.2204; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162613.4833; val_optim_loss: 162613.4833
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9897; val_auprc_score: 0.9970; val_best_acc_score: 0.9851; val_best_f1_score: 0.9913; train_kl_reg_loss: 1905.1841; train_edge_recon_loss: 76344.5180; train_gene_expr_recon_loss: 83864.5445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162114.2466; train_optim_loss: 162114.2466; val_kl_reg_loss: 1881.4934; val_edge_recon_loss: 75652.2604; val_gene_expr_recon_loss: 83686.9189; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161220.6724; val_optim_loss: 161220.6724
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9914; val_auprc_score: 0.9975; val_best_acc_score: 0.9861; val_best_f1_score: 0.9919; train_kl_reg_loss: 1905.4550; train_edge_recon_loss: 75868.0189; train_gene_expr_recon_loss: 83416.1292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161189.6027; train_optim_loss: 161189.6027; val_kl_reg_loss: 1915.3587; val_edge_recon_loss: 77029.6094; val_gene_expr_recon_loss: 83259.6805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162204.6487; val_optim_loss: 162204.6487
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9920; val_auprc_score: 0.9976; val_best_acc_score: 0.9874; val_best_f1_score: 0.9926; train_kl_reg_loss: 1920.9492; train_edge_recon_loss: 76652.9538; train_gene_expr_recon_loss: 82937.4010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161511.3041; train_optim_loss: 161511.3041; val_kl_reg_loss: 1935.0458; val_edge_recon_loss: 75014.0684; val_gene_expr_recon_loss: 82760.8968; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159710.0108; val_optim_loss: 159710.0108
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9920; val_auprc_score: 0.9976; val_best_acc_score: 0.9868; val_best_f1_score: 0.9923; train_kl_reg_loss: 1924.7838; train_edge_recon_loss: 75977.2445; train_gene_expr_recon_loss: 82579.6959; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160481.7242; train_optim_loss: 160481.7242; val_kl_reg_loss: 1910.4649; val_edge_recon_loss: 75702.6765; val_gene_expr_recon_loss: 82223.9310; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159837.0727; val_optim_loss: 159837.0727
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9918; val_auprc_score: 0.9977; val_best_acc_score: 0.9861; val_best_f1_score: 0.9919; train_kl_reg_loss: 1933.7975; train_edge_recon_loss: 76149.3930; train_gene_expr_recon_loss: 82288.0503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160371.2406; train_optim_loss: 160371.2406; val_kl_reg_loss: 1920.9735; val_edge_recon_loss: 76447.3559; val_gene_expr_recon_loss: 82341.0552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160709.3831; val_optim_loss: 160709.3831
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9925; val_auprc_score: 0.9973; val_best_acc_score: 0.9879; val_best_f1_score: 0.9929; train_kl_reg_loss: 1934.4973; train_edge_recon_loss: 75679.1716; train_gene_expr_recon_loss: 82108.7403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159722.4093; train_optim_loss: 159722.4093; val_kl_reg_loss: 1958.6944; val_edge_recon_loss: 76027.4857; val_gene_expr_recon_loss: 82261.0480; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160247.2290; val_optim_loss: 160247.2290

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9928; val_auprc_score: 0.9981; val_best_acc_score: 0.9879; val_best_f1_score: 0.9929; train_kl_reg_loss: 1949.9180; train_edge_recon_loss: 76061.3637; train_gene_expr_recon_loss: 81456.6053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159467.8874; train_optim_loss: 159467.8874; val_kl_reg_loss: 1940.4958; val_edge_recon_loss: 76628.8812; val_gene_expr_recon_loss: 81370.8758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159940.2511; val_optim_loss: 159940.2511
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9929; val_auprc_score: 0.9981; val_best_acc_score: 0.9878; val_best_f1_score: 0.9929; train_kl_reg_loss: 1943.0860; train_edge_recon_loss: 75382.5122; train_gene_expr_recon_loss: 81385.1774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158710.7749; train_optim_loss: 158710.7749; val_kl_reg_loss: 1928.2555; val_edge_recon_loss: 75717.2062; val_gene_expr_recon_loss: 81321.9933; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158967.4553; val_optim_loss: 158967.4553
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9913; val_auprc_score: 0.9977; val_best_acc_score: 0.9872; val_best_f1_score: 0.9925; train_kl_reg_loss: 1933.3625; train_edge_recon_loss: 75676.9508; train_gene_expr_recon_loss: 81382.7891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158993.1021; train_optim_loss: 158993.1021; val_kl_reg_loss: 1919.2085; val_edge_recon_loss: 75300.7239; val_gene_expr_recon_loss: 81364.5504; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158584.4828; val_optim_loss: 158584.4828
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9932; val_auprc_score: 0.9979; val_best_acc_score: 0.9879; val_best_f1_score: 0.9929; train_kl_reg_loss: 1937.6807; train_edge_recon_loss: 76030.2071; train_gene_expr_recon_loss: 81266.8098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159234.6977; train_optim_loss: 159234.6977; val_kl_reg_loss: 1927.4131; val_edge_recon_loss: 77536.8411; val_gene_expr_recon_loss: 81519.9782; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160984.2317; val_optim_loss: 160984.2317
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9915; val_auprc_score: 0.9969; val_best_acc_score: 0.9872; val_best_f1_score: 0.9925; train_kl_reg_loss: 1935.8230; train_edge_recon_loss: 76051.3669; train_gene_expr_recon_loss: 81275.8903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159263.0800; train_optim_loss: 159263.0800; val_kl_reg_loss: 1922.1074; val_edge_recon_loss: 76362.0997; val_gene_expr_recon_loss: 81316.7950; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159601.0011; val_optim_loss: 159601.0011
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9910; val_auprc_score: 0.9970; val_best_acc_score: 0.9883; val_best_f1_score: 0.9932; train_kl_reg_loss: 1930.4834; train_edge_recon_loss: 75760.9104; train_gene_expr_recon_loss: 81257.0636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158948.4573; train_optim_loss: 158948.4573; val_kl_reg_loss: 1921.5745; val_edge_recon_loss: 75483.5199; val_gene_expr_recon_loss: 81250.5682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158655.6633; val_optim_loss: 158655.6633

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9925; val_auprc_score: 0.9981; val_best_acc_score: 0.9884; val_best_f1_score: 0.9932; train_kl_reg_loss: 1935.8319; train_edge_recon_loss: 75979.6300; train_gene_expr_recon_loss: 81113.1127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159028.5745; train_optim_loss: 159028.5745; val_kl_reg_loss: 1918.1051; val_edge_recon_loss: 75129.7108; val_gene_expr_recon_loss: 81254.3866; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158302.2037; val_optim_loss: 158302.2037
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9931; val_auprc_score: 0.9982; val_best_acc_score: 0.9878; val_best_f1_score: 0.9929; train_kl_reg_loss: 1935.8647; train_edge_recon_loss: 76080.9080; train_gene_expr_recon_loss: 81191.5951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159208.3675; train_optim_loss: 159208.3675; val_kl_reg_loss: 1918.4777; val_edge_recon_loss: 74746.2039; val_gene_expr_recon_loss: 81238.0113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157902.6918; val_optim_loss: 157902.6918
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9936; val_auprc_score: 0.9983; val_best_acc_score: 0.9889; val_best_f1_score: 0.9935; train_kl_reg_loss: 1934.1236; train_edge_recon_loss: 75543.8054; train_gene_expr_recon_loss: 81171.3837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158649.3131; train_optim_loss: 158649.3131; val_kl_reg_loss: 1916.1552; val_edge_recon_loss: 75424.8508; val_gene_expr_recon_loss: 81151.8817; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158492.8869; val_optim_loss: 158492.8869
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9923; val_auprc_score: 0.9979; val_best_acc_score: 0.9879; val_best_f1_score: 0.9929; train_kl_reg_loss: 1932.8612; train_edge_recon_loss: 76028.7522; train_gene_expr_recon_loss: 81149.8336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159111.4469; train_optim_loss: 159111.4469; val_kl_reg_loss: 1915.2057; val_edge_recon_loss: 74909.8324; val_gene_expr_recon_loss: 81330.0673; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158155.1061; val_optim_loss: 158155.1061
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9925; val_auprc_score: 0.9977; val_best_acc_score: 0.9882; val_best_f1_score: 0.9931; train_kl_reg_loss: 1933.6771; train_edge_recon_loss: 76188.3141; train_gene_expr_recon_loss: 81159.0540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159281.0451; train_optim_loss: 159281.0451; val_kl_reg_loss: 1917.0090; val_edge_recon_loss: 77149.4925; val_gene_expr_recon_loss: 81246.1134; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160312.6153; val_optim_loss: 160312.6153

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9916; val_auprc_score: 0.9974; val_best_acc_score: 0.9876; val_best_f1_score: 0.9928; train_kl_reg_loss: 1933.8926; train_edge_recon_loss: 76402.0093; train_gene_expr_recon_loss: 81136.0615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159471.9634; train_optim_loss: 159471.9634; val_kl_reg_loss: 1917.2538; val_edge_recon_loss: 75196.6603; val_gene_expr_recon_loss: 81380.0690; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158493.9828; val_optim_loss: 158493.9828
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9944; val_auprc_score: 0.9984; val_best_acc_score: 0.9878; val_best_f1_score: 0.9929; train_kl_reg_loss: 1933.8966; train_edge_recon_loss: 75613.0914; train_gene_expr_recon_loss: 81097.3402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158644.3279; train_optim_loss: 158644.3279; val_kl_reg_loss: 1916.6124; val_edge_recon_loss: 76828.0180; val_gene_expr_recon_loss: 81298.8486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160043.4784; val_optim_loss: 160043.4784
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9912; val_auprc_score: 0.9970; val_best_acc_score: 0.9876; val_best_f1_score: 0.9928; train_kl_reg_loss: 1934.0824; train_edge_recon_loss: 75619.2860; train_gene_expr_recon_loss: 81107.2479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158660.6164; train_optim_loss: 158660.6164; val_kl_reg_loss: 1916.1888; val_edge_recon_loss: 75556.9235; val_gene_expr_recon_loss: 81001.1827; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158474.2947; val_optim_loss: 158474.2947

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 15 min 15 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9920
Val AUPRC score: 0.9972
Val best accuracy score: 0.9888
Val best F1 score: 0.9934
Val gene expr MSE score: 0.8104
Duration of model training in run 9: 0 hours, 15 minutes and 28 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 265201
Number of validation edges: 29466
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9846; val_auprc_score: 0.9955; val_best_acc_score: 0.9755; val_best_f1_score: 0.9857; train_kl_reg_loss: 1746.9663; train_edge_recon_loss: 83367.1867; train_gene_expr_recon_loss: 92665.4866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177779.6397; train_optim_loss: 177779.6397; val_kl_reg_loss: 1982.8152; val_edge_recon_loss: 77910.9429; val_gene_expr_recon_loss: 87572.7403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167466.4989; val_optim_loss: 167466.4989
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9888; val_auprc_score: 0.9973; val_best_acc_score: 0.9803; val_best_f1_score: 0.9885; train_kl_reg_loss: 1937.5895; train_edge_recon_loss: 76876.9555; train_gene_expr_recon_loss: 87857.4127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166671.9576; train_optim_loss: 166671.9576; val_kl_reg_loss: 1903.0490; val_edge_recon_loss: 77419.4380; val_gene_expr_recon_loss: 86111.6994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165434.1870; val_optim_loss: 165434.1870
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9888; val_auprc_score: 0.9969; val_best_acc_score: 0.9822; val_best_f1_score: 0.9896; train_kl_reg_loss: 1909.4640; train_edge_recon_loss: 77075.0175; train_gene_expr_recon_loss: 86264.0450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165248.5262; train_optim_loss: 165248.5262; val_kl_reg_loss: 1936.5662; val_edge_recon_loss: 77611.5528; val_gene_expr_recon_loss: 84453.6129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164001.7328; val_optim_loss: 164001.7328
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9888; val_auprc_score: 0.9962; val_best_acc_score: 0.9835; val_best_f1_score: 0.9904; train_kl_reg_loss: 1905.9238; train_edge_recon_loss: 76541.6344; train_gene_expr_recon_loss: 85312.8153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163760.3738; train_optim_loss: 163760.3738; val_kl_reg_loss: 1926.8593; val_edge_recon_loss: 75043.6944; val_gene_expr_recon_loss: 83903.2104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160873.7645; val_optim_loss: 160873.7645
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9901; val_auprc_score: 0.9965; val_best_acc_score: 0.9844; val_best_f1_score: 0.9909; train_kl_reg_loss: 1910.8624; train_edge_recon_loss: 76637.5273; train_gene_expr_recon_loss: 84489.9928; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163038.3831; train_optim_loss: 163038.3831; val_kl_reg_loss: 1922.7532; val_edge_recon_loss: 77364.4046; val_gene_expr_recon_loss: 83192.2363; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162479.3949; val_optim_loss: 162479.3949
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9895; val_auprc_score: 0.9973; val_best_acc_score: 0.9847; val_best_f1_score: 0.9911; train_kl_reg_loss: 1906.9671; train_edge_recon_loss: 75980.1380; train_gene_expr_recon_loss: 83907.6132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161794.7180; train_optim_loss: 161794.7180; val_kl_reg_loss: 1907.6461; val_edge_recon_loss: 77203.5124; val_gene_expr_recon_loss: 82613.2775; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161724.4348; val_optim_loss: 161724.4348
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9914; val_auprc_score: 0.9977; val_best_acc_score: 0.9854; val_best_f1_score: 0.9915; train_kl_reg_loss: 1916.4480; train_edge_recon_loss: 76032.2645; train_gene_expr_recon_loss: 83396.6152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161345.3275; train_optim_loss: 161345.3275; val_kl_reg_loss: 1917.9462; val_edge_recon_loss: 76152.1328; val_gene_expr_recon_loss: 82414.2214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160484.3017; val_optim_loss: 160484.3017
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9930; val_auprc_score: 0.9979; val_best_acc_score: 0.9872; val_best_f1_score: 0.9926; train_kl_reg_loss: 1924.0688; train_edge_recon_loss: 76779.4226; train_gene_expr_recon_loss: 82991.7593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161695.2501; train_optim_loss: 161695.2501; val_kl_reg_loss: 1888.1751; val_edge_recon_loss: 76012.8680; val_gene_expr_recon_loss: 81860.3389; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159761.3809; val_optim_loss: 159761.3809
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9922; val_auprc_score: 0.9977; val_best_acc_score: 0.9866; val_best_f1_score: 0.9922; train_kl_reg_loss: 1924.5775; train_edge_recon_loss: 76311.4362; train_gene_expr_recon_loss: 82636.4449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160872.4581; train_optim_loss: 160872.4581; val_kl_reg_loss: 1846.9084; val_edge_recon_loss: 75431.0286; val_gene_expr_recon_loss: 81716.4768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158994.4116; val_optim_loss: 158994.4116
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9904; val_auprc_score: 0.9971; val_best_acc_score: 0.9869; val_best_f1_score: 0.9923; train_kl_reg_loss: 1925.9627; train_edge_recon_loss: 75552.4563; train_gene_expr_recon_loss: 82384.5400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159862.9590; train_optim_loss: 159862.9590; val_kl_reg_loss: 1887.3797; val_edge_recon_loss: 76227.3004; val_gene_expr_recon_loss: 81396.6630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159511.3432; val_optim_loss: 159511.3432
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9917; val_auprc_score: 0.9975; val_best_acc_score: 0.9879; val_best_f1_score: 0.9930; train_kl_reg_loss: 1938.4389; train_edge_recon_loss: 76160.5005; train_gene_expr_recon_loss: 82042.0630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160141.0019; train_optim_loss: 160141.0019; val_kl_reg_loss: 1926.9147; val_edge_recon_loss: 75589.2694; val_gene_expr_recon_loss: 80924.8909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158441.0770; val_optim_loss: 158441.0770
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9919; val_auprc_score: 0.9977; val_best_acc_score: 0.9878; val_best_f1_score: 0.9929; train_kl_reg_loss: 1937.4357; train_edge_recon_loss: 75886.5239; train_gene_expr_recon_loss: 81908.8933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159732.8530; train_optim_loss: 159732.8530; val_kl_reg_loss: 1908.8953; val_edge_recon_loss: 75893.8702; val_gene_expr_recon_loss: 80616.0439; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158418.8087; val_optim_loss: 158418.8087
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9924; val_auprc_score: 0.9974; val_best_acc_score: 0.9884; val_best_f1_score: 0.9932; train_kl_reg_loss: 1946.4593; train_edge_recon_loss: 75861.3805; train_gene_expr_recon_loss: 81674.1330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159481.9725; train_optim_loss: 159481.9725; val_kl_reg_loss: 1954.1779; val_edge_recon_loss: 76471.0172; val_gene_expr_recon_loss: 80517.5100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158942.7069; val_optim_loss: 158942.7069
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9927; val_auprc_score: 0.9981; val_best_acc_score: 0.9883; val_best_f1_score: 0.9932; train_kl_reg_loss: 1951.0806; train_edge_recon_loss: 75251.3569; train_gene_expr_recon_loss: 81438.2577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158640.6959; train_optim_loss: 158640.6959; val_kl_reg_loss: 1940.9178; val_edge_recon_loss: 77050.9399; val_gene_expr_recon_loss: 80307.0676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159298.9262; val_optim_loss: 159298.9262
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9922; val_auprc_score: 0.9980; val_best_acc_score: 0.9890; val_best_f1_score: 0.9936; train_kl_reg_loss: 1954.7398; train_edge_recon_loss: 76189.5460; train_gene_expr_recon_loss: 81213.1597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159357.4458; train_optim_loss: 159357.4458; val_kl_reg_loss: 1937.4338; val_edge_recon_loss: 73915.5207; val_gene_expr_recon_loss: 80552.5657; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156405.5205; val_optim_loss: 156405.5205
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9933; val_auprc_score: 0.9981; val_best_acc_score: 0.9892; val_best_f1_score: 0.9937; train_kl_reg_loss: 1960.0919; train_edge_recon_loss: 75797.2224; train_gene_expr_recon_loss: 81142.3721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158899.6864; train_optim_loss: 158899.6864; val_kl_reg_loss: 1970.5631; val_edge_recon_loss: 75092.5453; val_gene_expr_recon_loss: 80290.9682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157354.0760; val_optim_loss: 157354.0760
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9935; val_auprc_score: 0.9982; val_best_acc_score: 0.9891; val_best_f1_score: 0.9936; train_kl_reg_loss: 1963.6139; train_edge_recon_loss: 75948.4360; train_gene_expr_recon_loss: 80915.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158827.2317; train_optim_loss: 158827.2317; val_kl_reg_loss: 1940.5149; val_edge_recon_loss: 76880.4846; val_gene_expr_recon_loss: 79951.3704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158772.3696; val_optim_loss: 158772.3696
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9928; val_auprc_score: 0.9973; val_best_acc_score: 0.9890; val_best_f1_score: 0.9936; train_kl_reg_loss: 1970.1691; train_edge_recon_loss: 75650.2976; train_gene_expr_recon_loss: 80739.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158359.9666; train_optim_loss: 158359.9666; val_kl_reg_loss: 1954.9986; val_edge_recon_loss: 76188.9564; val_gene_expr_recon_loss: 79873.4965; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158017.4526; val_optim_loss: 158017.4526

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9938; val_auprc_score: 0.9978; val_best_acc_score: 0.9898; val_best_f1_score: 0.9940; train_kl_reg_loss: 1978.0292; train_edge_recon_loss: 75406.7928; train_gene_expr_recon_loss: 80303.2055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157688.0274; train_optim_loss: 157688.0274; val_kl_reg_loss: 1958.4153; val_edge_recon_loss: 75481.1185; val_gene_expr_recon_loss: 79729.9666; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157169.4995; val_optim_loss: 157169.4995
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9929; val_auprc_score: 0.9981; val_best_acc_score: 0.9900; val_best_f1_score: 0.9942; train_kl_reg_loss: 1975.5458; train_edge_recon_loss: 75622.7494; train_gene_expr_recon_loss: 80197.0143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157795.3095; train_optim_loss: 157795.3095; val_kl_reg_loss: 1970.0955; val_edge_recon_loss: 75160.6721; val_gene_expr_recon_loss: 79743.0172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156873.7845; val_optim_loss: 156873.7845
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9930; val_auprc_score: 0.9974; val_best_acc_score: 0.9893; val_best_f1_score: 0.9938; train_kl_reg_loss: 1974.6407; train_edge_recon_loss: 75880.6047; train_gene_expr_recon_loss: 80169.7493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158024.9945; train_optim_loss: 158024.9945; val_kl_reg_loss: 1955.2012; val_edge_recon_loss: 75039.3909; val_gene_expr_recon_loss: 79480.3761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156474.9698; val_optim_loss: 156474.9698

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 12 min 57 sec.
Using best model state, which was in epoch 15.

--- MODEL EVALUATION ---
Val AUROC score: 0.9912
Val AUPRC score: 0.9967
Val best accuracy score: 0.9881
Val best F1 score: 0.9930
Val gene expr MSE score: 0.8234
Duration of model training in run 10: 0 hours, 13 minutes and 10 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
