Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9662; val_auprc_score: 0.9874; val_best_acc_score: 0.9421; val_best_f1_score: 0.9635; train_kl_reg_loss: 26022.3728; train_edge_recon_loss: 1326389.3329; train_cat_covariates_contrastive_loss: 642599.5537; train_gene_expr_recon_loss: 1856133.9447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3851145.2065; train_optim_loss: 3851145.2065; val_kl_reg_loss: 26333.4185; val_edge_recon_loss: 1344063.9800; val_cat_covariates_contrastive_loss: 643577.2896; val_gene_expr_recon_loss: 1877666.6307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3891641.3092; val_optim_loss: 3891641.3092
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9638; val_auprc_score: 0.9833; val_best_acc_score: 0.9431; val_best_f1_score: 0.9629; train_kl_reg_loss: 24841.8975; train_edge_recon_loss: 1311170.6066; train_cat_covariates_contrastive_loss: 635530.7562; train_gene_expr_recon_loss: 1822794.0634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3794337.3222; train_optim_loss: 3794337.3222; val_kl_reg_loss: 24781.7621; val_edge_recon_loss: 1339680.4408; val_cat_covariates_contrastive_loss: 635379.4604; val_gene_expr_recon_loss: 1850965.2395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3850806.9065; val_optim_loss: 3850806.9065
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9648; val_auprc_score: 0.9878; val_best_acc_score: 0.9402; val_best_f1_score: 0.9624; train_kl_reg_loss: 26328.0407; train_edge_recon_loss: 1324282.4303; train_cat_covariates_contrastive_loss: 642570.1178; train_gene_expr_recon_loss: 1854731.1925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3847911.7850; train_optim_loss: 3847911.7850; val_kl_reg_loss: 26687.4716; val_edge_recon_loss: 1351841.3502; val_cat_covariates_contrastive_loss: 642208.2915; val_gene_expr_recon_loss: 1880400.5849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3901137.6985; val_optim_loss: 3901137.6985
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9660; val_auprc_score: 0.9876; val_best_acc_score: 0.9413; val_best_f1_score: 0.9629; train_kl_reg_loss: 26318.9871; train_edge_recon_loss: 1324854.6456; train_cat_covariates_contrastive_loss: 642601.3262; train_gene_expr_recon_loss: 1851115.2375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3844890.1960; train_optim_loss: 3844890.1960; val_kl_reg_loss: 25935.7069; val_edge_recon_loss: 1348154.2662; val_cat_covariates_contrastive_loss: 643319.5415; val_gene_expr_recon_loss: 1876380.7195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3893790.2290; val_optim_loss: 3893790.2290
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9648; val_auprc_score: 0.9839; val_best_acc_score: 0.9427; val_best_f1_score: 0.9625; train_kl_reg_loss: 24747.0644; train_edge_recon_loss: 1307342.8355; train_cat_covariates_contrastive_loss: 635217.9578; train_gene_expr_recon_loss: 1822166.8003; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3789474.6646; train_optim_loss: 3789474.6646; val_kl_reg_loss: 24722.2828; val_edge_recon_loss: 1345182.1832; val_cat_covariates_contrastive_loss: 635632.9394; val_gene_expr_recon_loss: 1850376.5868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3855914.0019; val_optim_loss: 3855914.0019
Run timestamp: 29082023_220440_21.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '8', '--edge_batch_size_list', '512', '--node_batch_size_list', 'None', '--seeds', '1', '--run_index', '2', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_21']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 254146
Number of validation nodes: 28238
Number of training edges: 1162586
Number of validation edges: 129176
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9608; val_auprc_score: 0.9870; val_best_acc_score: 0.9252; val_best_f1_score: 0.9531; train_kl_reg_loss: 18948.4497; train_edge_recon_loss: 1383835.1358; train_cat_covariates_contrastive_loss: 646739.6735; train_gene_expr_recon_loss: 2793859.4313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4843382.6913; train_optim_loss: 4843382.6913; val_kl_reg_loss: 18242.6188; val_edge_recon_loss: 1361991.6798; val_cat_covariates_contrastive_loss: 643056.6161; val_gene_expr_recon_loss: 2505779.9773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4529070.8854; val_optim_loss: 4529070.8854

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9666; val_auprc_score: 0.9878; val_best_acc_score: 0.9423; val_best_f1_score: 0.9636; train_kl_reg_loss: 26055.0049; train_edge_recon_loss: 1324330.7139; train_cat_covariates_contrastive_loss: 642382.6308; train_gene_expr_recon_loss: 1824182.8355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3816951.1837; train_optim_loss: 3816951.1837; val_kl_reg_loss: 26219.7376; val_edge_recon_loss: 1348049.3969; val_cat_covariates_contrastive_loss: 641817.2863; val_gene_expr_recon_loss: 1847391.7395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3863478.1584; val_optim_loss: 3863478.1584
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9651; val_auprc_score: 0.9840; val_best_acc_score: 0.9430; val_best_f1_score: 0.9629; train_kl_reg_loss: 24599.6271; train_edge_recon_loss: 1311915.5797; train_cat_covariates_contrastive_loss: 635174.3203; train_gene_expr_recon_loss: 1822058.2502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3793747.7766; train_optim_loss: 3793747.7766; val_kl_reg_loss: 24480.0506; val_edge_recon_loss: 1331944.5744; val_cat_covariates_contrastive_loss: 635846.7724; val_gene_expr_recon_loss: 1851539.2996; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3843810.6966; val_optim_loss: 3843810.6966
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9652; val_auprc_score: 0.9876; val_best_acc_score: 0.9429; val_best_f1_score: 0.9641; train_kl_reg_loss: 26092.0553; train_edge_recon_loss: 1328169.3729; train_cat_covariates_contrastive_loss: 642207.2623; train_gene_expr_recon_loss: 1818775.3474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3815244.0404; train_optim_loss: 3815244.0404; val_kl_reg_loss: 25934.8789; val_edge_recon_loss: 1331684.0592; val_cat_covariates_contrastive_loss: 642083.0291; val_gene_expr_recon_loss: 1847106.7357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3846808.7023; val_optim_loss: 3846808.7023
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9644; val_auprc_score: 0.9838; val_best_acc_score: 0.9431; val_best_f1_score: 0.9629; train_kl_reg_loss: 24535.3282; train_edge_recon_loss: 1308226.9254; train_cat_covariates_contrastive_loss: 635241.4969; train_gene_expr_recon_loss: 1821305.3837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3789309.1368; train_optim_loss: 3789309.1368; val_kl_reg_loss: 24592.9338; val_edge_recon_loss: 1334382.6269; val_cat_covariates_contrastive_loss: 634995.1818; val_gene_expr_recon_loss: 1850063.6155; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3844034.3531; val_optim_loss: 3844034.3531
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9670; val_auprc_score: 0.9889; val_best_acc_score: 0.9361; val_best_f1_score: 0.9599; train_kl_reg_loss: 20087.2406; train_edge_recon_loss: 1337777.7736; train_cat_covariates_contrastive_loss: 643825.6349; train_gene_expr_recon_loss: 2329401.3061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4331091.9508; train_optim_loss: 4331091.9508; val_kl_reg_loss: 22199.8105; val_edge_recon_loss: 1338838.1700; val_cat_covariates_contrastive_loss: 643558.1351; val_gene_expr_recon_loss: 2209703.5385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4214299.6502; val_optim_loss: 4214299.6502
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9667; val_auprc_score: 0.9881; val_best_acc_score: 0.9432; val_best_f1_score: 0.9642; train_kl_reg_loss: 25949.2483; train_edge_recon_loss: 1324864.1605; train_cat_covariates_contrastive_loss: 642082.6694; train_gene_expr_recon_loss: 1816757.9464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3809654.0240; train_optim_loss: 3809654.0240; val_kl_reg_loss: 26065.8675; val_edge_recon_loss: 1346387.7080; val_cat_covariates_contrastive_loss: 642057.0940; val_gene_expr_recon_loss: 1842469.3349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3856979.9924; val_optim_loss: 3856979.9924
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9659; val_auprc_score: 0.9879; val_best_acc_score: 0.9424; val_best_f1_score: 0.9637; train_kl_reg_loss: 25849.7676; train_edge_recon_loss: 1325742.0862; train_cat_covariates_contrastive_loss: 642001.6225; train_gene_expr_recon_loss: 1815242.8657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3808836.3401; train_optim_loss: 3808836.3401; val_kl_reg_loss: 25842.5819; val_edge_recon_loss: 1341007.0802; val_cat_covariates_contrastive_loss: 642053.9437; val_gene_expr_recon_loss: 1843627.8960; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3852531.5000; val_optim_loss: 3852531.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9662; val_auprc_score: 0.9845; val_best_acc_score: 0.9440; val_best_f1_score: 0.9636; train_kl_reg_loss: 24453.5769; train_edge_recon_loss: 1314161.4210; train_cat_covariates_contrastive_loss: 635042.7135; train_gene_expr_recon_loss: 1820113.0124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3793770.7201; train_optim_loss: 3793770.7201; val_kl_reg_loss: 24615.0158; val_edge_recon_loss: 1331099.8092; val_cat_covariates_contrastive_loss: 635100.5406; val_gene_expr_recon_loss: 1847608.5496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3838423.9218; val_optim_loss: 3838423.9218
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9665; val_auprc_score: 0.9881; val_best_acc_score: 0.9417; val_best_f1_score: 0.9632; train_kl_reg_loss: 25733.4315; train_edge_recon_loss: 1320806.9048; train_cat_covariates_contrastive_loss: 641988.8435; train_gene_expr_recon_loss: 1813371.8577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3801901.0397; train_optim_loss: 3801901.0397; val_kl_reg_loss: 25727.8803; val_edge_recon_loss: 1348640.5506; val_cat_covariates_contrastive_loss: 641594.2276; val_gene_expr_recon_loss: 1841723.6832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3857686.3302; val_optim_loss: 3857686.3302
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9665; val_auprc_score: 0.9884; val_best_acc_score: 0.9385; val_best_f1_score: 0.9614; train_kl_reg_loss: 23124.3944; train_edge_recon_loss: 1334770.8503; train_cat_covariates_contrastive_loss: 643586.5545; train_gene_expr_recon_loss: 2139784.5233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4141266.3224; train_optim_loss: 4141266.3224; val_kl_reg_loss: 23730.4226; val_edge_recon_loss: 1344934.4605; val_cat_covariates_contrastive_loss: 642679.7176; val_gene_expr_recon_loss: 2096990.7871; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4108335.3735; val_optim_loss: 4108335.3735
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9661; val_auprc_score: 0.9845; val_best_acc_score: 0.9427; val_best_f1_score: 0.9626; train_kl_reg_loss: 24461.6613; train_edge_recon_loss: 1310790.8171; train_cat_covariates_contrastive_loss: 635177.2987; train_gene_expr_recon_loss: 1820391.5324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3790821.3080; train_optim_loss: 3790821.3080; val_kl_reg_loss: 24416.5878; val_edge_recon_loss: 1343682.5286; val_cat_covariates_contrastive_loss: 636167.7443; val_gene_expr_recon_loss: 1847818.8903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3852085.7481; val_optim_loss: 3852085.7481
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9665; val_auprc_score: 0.9879; val_best_acc_score: 0.9426; val_best_f1_score: 0.9638; train_kl_reg_loss: 25675.9682; train_edge_recon_loss: 1324487.3949; train_cat_covariates_contrastive_loss: 641755.3269; train_gene_expr_recon_loss: 1813079.5035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3804998.1859; train_optim_loss: 3804998.1859; val_kl_reg_loss: 25758.4477; val_edge_recon_loss: 1344061.3445; val_cat_covariates_contrastive_loss: 642032.8206; val_gene_expr_recon_loss: 1844540.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3856393.3989; val_optim_loss: 3856393.3989
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9639; val_auprc_score: 0.9834; val_best_acc_score: 0.9424; val_best_f1_score: 0.9624; train_kl_reg_loss: 24263.6788; train_edge_recon_loss: 1309507.6353; train_cat_covariates_contrastive_loss: 635155.4559; train_gene_expr_recon_loss: 1818926.3687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3787853.1374; train_optim_loss: 3787853.1374; val_kl_reg_loss: 24393.4962; val_edge_recon_loss: 1346215.9323; val_cat_covariates_contrastive_loss: 634969.5701; val_gene_expr_recon_loss: 1848159.8435; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3853738.8378; val_optim_loss: 3853738.8378

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9672; val_auprc_score: 0.9885; val_best_acc_score: 0.9433; val_best_f1_score: 0.9643; train_kl_reg_loss: 25561.7614; train_edge_recon_loss: 1326202.0547; train_cat_covariates_contrastive_loss: 641834.4724; train_gene_expr_recon_loss: 1809244.0526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3802842.3430; train_optim_loss: 3802842.3430; val_kl_reg_loss: 25590.2720; val_edge_recon_loss: 1343449.1899; val_cat_covariates_contrastive_loss: 641775.9952; val_gene_expr_recon_loss: 1839297.8435; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3850113.2996; val_optim_loss: 3850113.2996
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9675; val_auprc_score: 0.9887; val_best_acc_score: 0.9389; val_best_f1_score: 0.9616; train_kl_reg_loss: 24368.0990; train_edge_recon_loss: 1333286.1163; train_cat_covariates_contrastive_loss: 643226.9356; train_gene_expr_recon_loss: 2066297.2278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4067178.3742; train_optim_loss: 4067178.3742; val_kl_reg_loss: 24882.8805; val_edge_recon_loss: 1343089.8454; val_cat_covariates_contrastive_loss: 642453.9281; val_gene_expr_recon_loss: 2048592.4926; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4059019.1383; val_optim_loss: 4059019.1383
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9672; val_auprc_score: 0.9882; val_best_acc_score: 0.9443; val_best_f1_score: 0.9649; train_kl_reg_loss: 25480.6143; train_edge_recon_loss: 1323641.7867; train_cat_covariates_contrastive_loss: 641782.0587; train_gene_expr_recon_loss: 1809226.3178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3800130.7753; train_optim_loss: 3800130.7753; val_kl_reg_loss: 25595.9656; val_edge_recon_loss: 1340575.3053; val_cat_covariates_contrastive_loss: 641667.1589; val_gene_expr_recon_loss: 1840973.4132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3848811.8569; val_optim_loss: 3848811.8569
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9669; val_auprc_score: 0.9853; val_best_acc_score: 0.9438; val_best_f1_score: 0.9635; train_kl_reg_loss: 24257.5741; train_edge_recon_loss: 1314895.7953; train_cat_covariates_contrastive_loss: 635242.3953; train_gene_expr_recon_loss: 1818023.8016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3792419.5678; train_optim_loss: 3792419.5678; val_kl_reg_loss: 24186.9143; val_edge_recon_loss: 1332593.0191; val_cat_covariates_contrastive_loss: 635640.6360; val_gene_expr_recon_loss: 1846788.1737; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3839208.7385; val_optim_loss: 3839208.7385
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9679; val_auprc_score: 0.9887; val_best_acc_score: 0.9432; val_best_f1_score: 0.9642; train_kl_reg_loss: 25499.8755; train_edge_recon_loss: 1325634.7666; train_cat_covariates_contrastive_loss: 641771.6773; train_gene_expr_recon_loss: 1809148.2887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3802054.6088; train_optim_loss: 3802054.6088; val_kl_reg_loss: 25582.6539; val_edge_recon_loss: 1345212.0840; val_cat_covariates_contrastive_loss: 642361.9585; val_gene_expr_recon_loss: 1841514.0849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3854670.7824; val_optim_loss: 3854670.7824
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9651; val_auprc_score: 0.9839; val_best_acc_score: 0.9427; val_best_f1_score: 0.9627; train_kl_reg_loss: 24209.2715; train_edge_recon_loss: 1311262.6167; train_cat_covariates_contrastive_loss: 635220.0277; train_gene_expr_recon_loss: 1818522.9836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3789214.8959; train_optim_loss: 3789214.8959; val_kl_reg_loss: 24275.5703; val_edge_recon_loss: 1335689.1097; val_cat_covariates_contrastive_loss: 635063.9766; val_gene_expr_recon_loss: 1846809.2281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3841837.8893; val_optim_loss: 3841837.8893
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9687; val_auprc_score: 0.9892; val_best_acc_score: 0.9414; val_best_f1_score: 0.9631; train_kl_reg_loss: 24999.4938; train_edge_recon_loss: 1332502.8949; train_cat_covariates_contrastive_loss: 642942.4551; train_gene_expr_recon_loss: 2030165.1781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4030610.0236; train_optim_loss: 4030610.0236; val_kl_reg_loss: 24238.9937; val_edge_recon_loss: 1340528.4046; val_cat_covariates_contrastive_loss: 643976.8226; val_gene_expr_recon_loss: 2037089.2174; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4045833.4377; val_optim_loss: 4045833.4377
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9673; val_auprc_score: 0.9884; val_best_acc_score: 0.9434; val_best_f1_score: 0.9644; train_kl_reg_loss: 25505.1816; train_edge_recon_loss: 1320767.0955; train_cat_covariates_contrastive_loss: 641639.2131; train_gene_expr_recon_loss: 1808573.6057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3796485.0962; train_optim_loss: 3796485.0962; val_kl_reg_loss: 25613.1614; val_edge_recon_loss: 1337522.2443; val_cat_covariates_contrastive_loss: 641477.8707; val_gene_expr_recon_loss: 1840210.4332; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3844823.7156; val_optim_loss: 3844823.7156

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9643; val_auprc_score: 0.9836; val_best_acc_score: 0.9431; val_best_f1_score: 0.9628; train_kl_reg_loss: 24217.9050; train_edge_recon_loss: 1307797.8198; train_cat_covariates_contrastive_loss: 635168.8514; train_gene_expr_recon_loss: 1814772.2595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3781956.8371; train_optim_loss: 3781956.8371; val_kl_reg_loss: 24332.5517; val_edge_recon_loss: 1332192.6574; val_cat_covariates_contrastive_loss: 634849.3573; val_gene_expr_recon_loss: 1845209.3550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3836583.9160; val_optim_loss: 3836583.9160
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9670; val_auprc_score: 0.9881; val_best_acc_score: 0.9435; val_best_f1_score: 0.9644; train_kl_reg_loss: 25535.6890; train_edge_recon_loss: 1323389.2114; train_cat_covariates_contrastive_loss: 641820.2381; train_gene_expr_recon_loss: 1808425.0033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3799170.1417; train_optim_loss: 3799170.1417; val_kl_reg_loss: 25589.0473; val_edge_recon_loss: 1333355.2128; val_cat_covariates_contrastive_loss: 641558.1546; val_gene_expr_recon_loss: 1840160.1317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3840662.5515; val_optim_loss: 3840662.5515
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9656; val_auprc_score: 0.9875; val_best_acc_score: 0.9426; val_best_f1_score: 0.9639; train_kl_reg_loss: 25519.9096; train_edge_recon_loss: 1321487.8208; train_cat_covariates_contrastive_loss: 641652.5960; train_gene_expr_recon_loss: 1808627.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3797287.3908; train_optim_loss: 3797287.3908; val_kl_reg_loss: 25612.1798; val_edge_recon_loss: 1345007.0802; val_cat_covariates_contrastive_loss: 641259.6932; val_gene_expr_recon_loss: 1839573.4504; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3851452.3950; val_optim_loss: 3851452.3950
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9648; val_auprc_score: 0.9878; val_best_acc_score: 0.9407; val_best_f1_score: 0.9628; train_kl_reg_loss: 25392.1640; train_edge_recon_loss: 1332579.7521; train_cat_covariates_contrastive_loss: 642562.5743; train_gene_expr_recon_loss: 2008072.8491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4008607.3371; train_optim_loss: 4008607.3371; val_kl_reg_loss: 25574.7070; val_edge_recon_loss: 1342000.6685; val_cat_covariates_contrastive_loss: 641189.5818; val_gene_expr_recon_loss: 2008198.9249; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4016963.8775; val_optim_loss: 4016963.8775
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9652; val_auprc_score: 0.9839; val_best_acc_score: 0.9435; val_best_f1_score: 0.9632; train_kl_reg_loss: 24214.3967; train_edge_recon_loss: 1312050.5449; train_cat_covariates_contrastive_loss: 635126.1614; train_gene_expr_recon_loss: 1814830.6506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3786221.7489; train_optim_loss: 3786221.7489; val_kl_reg_loss: 24346.3854; val_edge_recon_loss: 1334739.1174; val_cat_covariates_contrastive_loss: 634950.6827; val_gene_expr_recon_loss: 1844682.3693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3838718.5534; val_optim_loss: 3838718.5534
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9671; val_auprc_score: 0.9883; val_best_acc_score: 0.9444; val_best_f1_score: 0.9650; train_kl_reg_loss: 25560.0446; train_edge_recon_loss: 1323515.0953; train_cat_covariates_contrastive_loss: 641520.4621; train_gene_expr_recon_loss: 1808240.9505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3798836.5491; train_optim_loss: 3798836.5491; val_kl_reg_loss: 25600.2414; val_edge_recon_loss: 1337200.5391; val_cat_covariates_contrastive_loss: 641554.7219; val_gene_expr_recon_loss: 1838376.1632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3842731.6546; val_optim_loss: 3842731.6546
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9644; val_auprc_score: 0.9840; val_best_acc_score: 0.9430; val_best_f1_score: 0.9629; train_kl_reg_loss: 24167.5138; train_edge_recon_loss: 1308545.1963; train_cat_covariates_contrastive_loss: 634933.3935; train_gene_expr_recon_loss: 1814569.0682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3782215.1716; train_optim_loss: 3782215.1716; val_kl_reg_loss: 24182.9302; val_edge_recon_loss: 1334822.0553; val_cat_covariates_contrastive_loss: 635831.5587; val_gene_expr_recon_loss: 1843622.8349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3838459.3855; val_optim_loss: 3838459.3855
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9667; val_auprc_score: 0.9879; val_best_acc_score: 0.9437; val_best_f1_score: 0.9646; train_kl_reg_loss: 25493.2297; train_edge_recon_loss: 1323694.7571; train_cat_covariates_contrastive_loss: 641636.8248; train_gene_expr_recon_loss: 1808940.2433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3799765.0567; train_optim_loss: 3799765.0567; val_kl_reg_loss: 25612.9369; val_edge_recon_loss: 1336970.4742; val_cat_covariates_contrastive_loss: 641433.0988; val_gene_expr_recon_loss: 1839526.3292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3843542.8244; val_optim_loss: 3843542.8244
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9692; val_auprc_score: 0.9891; val_best_acc_score: 0.9437; val_best_f1_score: 0.9645; train_kl_reg_loss: 25722.3128; train_edge_recon_loss: 1333096.7735; train_cat_covariates_contrastive_loss: 642494.7934; train_gene_expr_recon_loss: 1995500.9920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3996814.8736; train_optim_loss: 3996814.8736; val_kl_reg_loss: 25084.2251; val_edge_recon_loss: 1338775.7925; val_cat_covariates_contrastive_loss: 643118.7851; val_gene_expr_recon_loss: 2006986.6650; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4013965.4654; val_optim_loss: 4013965.4654
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9641; val_auprc_score: 0.9837; val_best_acc_score: 0.9432; val_best_f1_score: 0.9630; train_kl_reg_loss: 24121.1224; train_edge_recon_loss: 1308802.4314; train_cat_covariates_contrastive_loss: 635238.9146; train_gene_expr_recon_loss: 1814319.8127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3782482.2795; train_optim_loss: 3782482.2795; val_kl_reg_loss: 24266.8129; val_edge_recon_loss: 1332750.8941; val_cat_covariates_contrastive_loss: 634896.9437; val_gene_expr_recon_loss: 1844526.5353; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3836441.1775; val_optim_loss: 3836441.1775
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9662; val_auprc_score: 0.9879; val_best_acc_score: 0.9424; val_best_f1_score: 0.9637; train_kl_reg_loss: 25499.8057; train_edge_recon_loss: 1321132.5125; train_cat_covariates_contrastive_loss: 641712.7191; train_gene_expr_recon_loss: 1808343.1803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3796688.2181; train_optim_loss: 3796688.2181; val_kl_reg_loss: 25576.7514; val_edge_recon_loss: 1349855.9838; val_cat_covariates_contrastive_loss: 641533.3177; val_gene_expr_recon_loss: 1842710.5487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3859676.5821; val_optim_loss: 3859676.5821

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9665; val_auprc_score: 0.9882; val_best_acc_score: 0.9432; val_best_f1_score: 0.9642; train_kl_reg_loss: 25457.3635; train_edge_recon_loss: 1322552.8912; train_cat_covariates_contrastive_loss: 641660.6171; train_gene_expr_recon_loss: 1807833.6079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3797504.4771; train_optim_loss: 3797504.4771; val_kl_reg_loss: 25535.8962; val_edge_recon_loss: 1338948.8712; val_cat_covariates_contrastive_loss: 641868.7147; val_gene_expr_recon_loss: 1842624.8616; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3848978.3607; val_optim_loss: 3848978.3607
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9633; val_auprc_score: 0.9831; val_best_acc_score: 0.9422; val_best_f1_score: 0.9625; train_kl_reg_loss: 24138.5086; train_edge_recon_loss: 1311625.1449; train_cat_covariates_contrastive_loss: 635066.1898; train_gene_expr_recon_loss: 1813130.8185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3783960.6642; train_optim_loss: 3783960.6642; val_kl_reg_loss: 24275.9418; val_edge_recon_loss: 1331459.9237; val_cat_covariates_contrastive_loss: 634538.8483; val_gene_expr_recon_loss: 1844200.5210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3834475.2252; val_optim_loss: 3834475.2252
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9699; val_auprc_score: 0.9897; val_best_acc_score: 0.9433; val_best_f1_score: 0.9643; train_kl_reg_loss: 25924.8143; train_edge_recon_loss: 1331108.8927; train_cat_covariates_contrastive_loss: 642519.4903; train_gene_expr_recon_loss: 1983086.3251; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3982639.5249; train_optim_loss: 3982639.5249; val_kl_reg_loss: 25161.9098; val_edge_recon_loss: 1340824.3152; val_cat_covariates_contrastive_loss: 642886.9558; val_gene_expr_recon_loss: 2001729.2619; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4010602.4348; val_optim_loss: 4010602.4348
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9679; val_auprc_score: 0.9885; val_best_acc_score: 0.9438; val_best_f1_score: 0.9645; train_kl_reg_loss: 25442.6620; train_edge_recon_loss: 1319886.4215; train_cat_covariates_contrastive_loss: 641749.2772; train_gene_expr_recon_loss: 1807254.6837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3794333.0446; train_optim_loss: 3794333.0446; val_kl_reg_loss: 25538.1269; val_edge_recon_loss: 1341341.0010; val_cat_covariates_contrastive_loss: 641805.6522; val_gene_expr_recon_loss: 1839548.0868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3848232.8607; val_optim_loss: 3848232.8607
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9651; val_auprc_score: 0.9837; val_best_acc_score: 0.9444; val_best_f1_score: 0.9636; train_kl_reg_loss: 24107.2638; train_edge_recon_loss: 1312280.1900; train_cat_covariates_contrastive_loss: 635206.3803; train_gene_expr_recon_loss: 1813760.5902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3785354.4348; train_optim_loss: 3785354.4348; val_kl_reg_loss: 24229.9670; val_edge_recon_loss: 1335987.5439; val_cat_covariates_contrastive_loss: 635318.1999; val_gene_expr_recon_loss: 1847312.6107; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3842848.3187; val_optim_loss: 3842848.3187
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9679; val_auprc_score: 0.9882; val_best_acc_score: 0.9440; val_best_f1_score: 0.9646; train_kl_reg_loss: 25443.5910; train_edge_recon_loss: 1325844.6558; train_cat_covariates_contrastive_loss: 641646.0459; train_gene_expr_recon_loss: 1807861.8700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3800796.1599; train_optim_loss: 3800796.1599; val_kl_reg_loss: 25536.6417; val_edge_recon_loss: 1343633.0887; val_cat_covariates_contrastive_loss: 641925.3845; val_gene_expr_recon_loss: 1840687.6240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3851782.7385; val_optim_loss: 3851782.7385
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9664; val_auprc_score: 0.9880; val_best_acc_score: 0.9430; val_best_f1_score: 0.9640; train_kl_reg_loss: 25422.6033; train_edge_recon_loss: 1321578.3265; train_cat_covariates_contrastive_loss: 641790.7398; train_gene_expr_recon_loss: 1807737.1688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3796528.8371; train_optim_loss: 3796528.8371; val_kl_reg_loss: 25528.7271; val_edge_recon_loss: 1349855.3454; val_cat_covariates_contrastive_loss: 641580.2352; val_gene_expr_recon_loss: 1837126.4723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3854090.7786; val_optim_loss: 3854090.7786
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9641; val_auprc_score: 0.9833; val_best_acc_score: 0.9433; val_best_f1_score: 0.9629; train_kl_reg_loss: 24103.1950; train_edge_recon_loss: 1310826.5529; train_cat_covariates_contrastive_loss: 635171.1153; train_gene_expr_recon_loss: 1812967.3911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3783068.2523; train_optim_loss: 3783068.2523; val_kl_reg_loss: 24238.8967; val_edge_recon_loss: 1345341.5076; val_cat_covariates_contrastive_loss: 634660.8826; val_gene_expr_recon_loss: 1848501.4485; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3852742.7328; val_optim_loss: 3852742.7328
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9699; val_auprc_score: 0.9894; val_best_acc_score: 0.9443; val_best_f1_score: 0.9649; train_kl_reg_loss: 26180.0865; train_edge_recon_loss: 1327986.7831; train_cat_covariates_contrastive_loss: 642478.5176; train_gene_expr_recon_loss: 1978170.8684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3974816.2544; train_optim_loss: 3974816.2544; val_kl_reg_loss: 25732.7931; val_edge_recon_loss: 1350086.1789; val_cat_covariates_contrastive_loss: 643279.4064; val_gene_expr_recon_loss: 1980711.2678; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3999809.6423; val_optim_loss: 3999809.6423

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 463 min 57 sec.
Using best model state, which was in epoch 53.

--- MODEL EVALUATION ---
val AUROC score: 0.9030
val AUPRC score: 0.9516
val best accuracy score: 0.9159
val best F1 score: 0.9461
val target rna MSE score: 0.5404
val source rna MSE score: 0.1117
Val cat covariate0 mean sim diff: 0.0002
Val cat covariate1 mean sim diff: -0.0888
Duration of model training in run 2: 7 hours, 45 minutes and 47 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9647; val_auprc_score: 0.9837; val_best_acc_score: 0.9435; val_best_f1_score: 0.9633; train_kl_reg_loss: 24136.2452; train_edge_recon_loss: 1311390.1475; train_cat_covariates_contrastive_loss: 635014.4771; train_gene_expr_recon_loss: 1813172.1234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3783712.9915; train_optim_loss: 3783712.9915; val_kl_reg_loss: 24150.8142; val_edge_recon_loss: 1331204.6412; val_cat_covariates_contrastive_loss: 635299.9413; val_gene_expr_recon_loss: 1845170.1775; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3835825.5668; val_optim_loss: 3835825.5668
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9659; val_auprc_score: 0.9878; val_best_acc_score: 0.9423; val_best_f1_score: 0.9637; train_kl_reg_loss: 26547.5799; train_edge_recon_loss: 1332361.3790; train_cat_covariates_contrastive_loss: 642411.0418; train_gene_expr_recon_loss: 1968291.6728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3969611.6735; train_optim_loss: 3969611.6735; val_kl_reg_loss: 26565.1350; val_edge_recon_loss: 1348202.6774; val_cat_covariates_contrastive_loss: 641008.1487; val_gene_expr_recon_loss: 1976568.5682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3992344.5247; val_optim_loss: 3992344.5247
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9662; val_auprc_score: 0.9848; val_best_acc_score: 0.9442; val_best_f1_score: 0.9637; train_kl_reg_loss: 24083.4171; train_edge_recon_loss: 1308615.2865; train_cat_covariates_contrastive_loss: 635138.7104; train_gene_expr_recon_loss: 1813993.8501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3781831.2642; train_optim_loss: 3781831.2642; val_kl_reg_loss: 24239.1139; val_edge_recon_loss: 1337642.1813; val_cat_covariates_contrastive_loss: 635080.8073; val_gene_expr_recon_loss: 1845181.1412; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3842143.2385; val_optim_loss: 3842143.2385

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9647; val_auprc_score: 0.9841; val_best_acc_score: 0.9435; val_best_f1_score: 0.9631; train_kl_reg_loss: 24105.2247; train_edge_recon_loss: 1310063.0613; train_cat_covariates_contrastive_loss: 635043.6193; train_gene_expr_recon_loss: 1812614.6699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3781826.5743; train_optim_loss: 3781826.5743; val_kl_reg_loss: 24164.3376; val_edge_recon_loss: 1326991.2739; val_cat_covariates_contrastive_loss: 635447.9294; val_gene_expr_recon_loss: 1844520.6107; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3831124.1450; val_optim_loss: 3831124.1450
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9669; val_auprc_score: 0.9884; val_best_acc_score: 0.9420; val_best_f1_score: 0.9635; train_kl_reg_loss: 26683.0238; train_edge_recon_loss: 1331252.1848; train_cat_covariates_contrastive_loss: 642479.0009; train_gene_expr_recon_loss: 1964553.3656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3964967.5753; train_optim_loss: 3964967.5753; val_kl_reg_loss: 26880.3938; val_edge_recon_loss: 1352642.7747; val_cat_covariates_contrastive_loss: 641796.5343; val_gene_expr_recon_loss: 1975953.7841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3997273.4921; val_optim_loss: 3997273.4921
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9637; val_auprc_score: 0.9833; val_best_acc_score: 0.9425; val_best_f1_score: 0.9626; train_kl_reg_loss: 24062.3257; train_edge_recon_loss: 1311492.5079; train_cat_covariates_contrastive_loss: 634998.6433; train_gene_expr_recon_loss: 1813308.3642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3783861.8449; train_optim_loss: 3783861.8449; val_kl_reg_loss: 24160.2301; val_edge_recon_loss: 1342466.7977; val_cat_covariates_contrastive_loss: 634619.2247; val_gene_expr_recon_loss: 1845125.9800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3846372.2366; val_optim_loss: 3846372.2366
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9644; val_auprc_score: 0.9835; val_best_acc_score: 0.9428; val_best_f1_score: 0.9628; train_kl_reg_loss: 24071.5981; train_edge_recon_loss: 1309807.1640; train_cat_covariates_contrastive_loss: 635033.8038; train_gene_expr_recon_loss: 1813093.6442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3782006.2133; train_optim_loss: 3782006.2133; val_kl_reg_loss: 24169.8708; val_edge_recon_loss: 1340186.7481; val_cat_covariates_contrastive_loss: 635599.4561; val_gene_expr_recon_loss: 1845470.1956; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3845426.2595; val_optim_loss: 3845426.2595
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9684; val_auprc_score: 0.9886; val_best_acc_score: 0.9454; val_best_f1_score: 0.9656; train_kl_reg_loss: 26925.7743; train_edge_recon_loss: 1331358.7345; train_cat_covariates_contrastive_loss: 642599.2171; train_gene_expr_recon_loss: 1957898.9809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3958782.7085; train_optim_loss: 3958782.7085; val_kl_reg_loss: 26804.6368; val_edge_recon_loss: 1349059.6947; val_cat_covariates_contrastive_loss: 642012.4800; val_gene_expr_recon_loss: 1968636.3745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3986513.1927; val_optim_loss: 3986513.1927
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9644; val_auprc_score: 0.9834; val_best_acc_score: 0.9438; val_best_f1_score: 0.9634; train_kl_reg_loss: 24066.5513; train_edge_recon_loss: 1311149.8478; train_cat_covariates_contrastive_loss: 634982.4651; train_gene_expr_recon_loss: 1813706.4511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3783905.3137; train_optim_loss: 3783905.3137; val_kl_reg_loss: 24152.4550; val_edge_recon_loss: 1339948.0181; val_cat_covariates_contrastive_loss: 635244.2352; val_gene_expr_recon_loss: 1844252.5258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3843597.2328; val_optim_loss: 3843597.2328
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9703; val_auprc_score: 0.9896; val_best_acc_score: 0.9455; val_best_f1_score: 0.9657; train_kl_reg_loss: 27129.6025; train_edge_recon_loss: 1333860.9024; train_cat_covariates_contrastive_loss: 642478.1845; train_gene_expr_recon_loss: 1950452.9642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3953921.6553; train_optim_loss: 3953921.6553; val_kl_reg_loss: 26973.9055; val_edge_recon_loss: 1329070.5435; val_cat_covariates_contrastive_loss: 643545.8683; val_gene_expr_recon_loss: 1957343.6581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3956933.9743; val_optim_loss: 3956933.9743
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9646; val_auprc_score: 0.9836; val_best_acc_score: 0.9432; val_best_f1_score: 0.9630; train_kl_reg_loss: 24072.4251; train_edge_recon_loss: 1310058.8198; train_cat_covariates_contrastive_loss: 635107.9609; train_gene_expr_recon_loss: 1813287.3351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3782526.5404; train_optim_loss: 3782526.5404; val_kl_reg_loss: 24154.0303; val_edge_recon_loss: 1334840.5916; val_cat_covariates_contrastive_loss: 635119.9881; val_gene_expr_recon_loss: 1846355.2643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3840469.8798; val_optim_loss: 3840469.8798

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9646; val_auprc_score: 0.9836; val_best_acc_score: 0.9436; val_best_f1_score: 0.9632; train_kl_reg_loss: 24057.4915; train_edge_recon_loss: 1308561.5321; train_cat_covariates_contrastive_loss: 635202.7453; train_gene_expr_recon_loss: 1813452.7872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3781274.5554; train_optim_loss: 3781274.5554; val_kl_reg_loss: 24138.1955; val_edge_recon_loss: 1337931.9084; val_cat_covariates_contrastive_loss: 634953.3187; val_gene_expr_recon_loss: 1843732.3254; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3840755.7500; val_optim_loss: 3840755.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9690; val_auprc_score: 0.9890; val_best_acc_score: 0.9440; val_best_f1_score: 0.9647; train_kl_reg_loss: 27302.6533; train_edge_recon_loss: 1329260.5761; train_cat_covariates_contrastive_loss: 642685.9150; train_gene_expr_recon_loss: 1947232.2158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3946481.3624; train_optim_loss: 3946481.3624; val_kl_reg_loss: 27510.6891; val_edge_recon_loss: 1339568.8730; val_cat_covariates_contrastive_loss: 642433.1314; val_gene_expr_recon_loss: 1953633.2742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3963145.9684; val_optim_loss: 3963145.9684
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9646; val_auprc_score: 0.9836; val_best_acc_score: 0.9432; val_best_f1_score: 0.9629; train_kl_reg_loss: 24057.5893; train_edge_recon_loss: 1310252.9507; train_cat_covariates_contrastive_loss: 635115.8556; train_gene_expr_recon_loss: 1812222.0987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3781648.4924; train_optim_loss: 3781648.4924; val_kl_reg_loss: 24147.1066; val_edge_recon_loss: 1339372.7013; val_cat_covariates_contrastive_loss: 635426.9742; val_gene_expr_recon_loss: 1843214.0716; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3842160.8473; val_optim_loss: 3842160.8473
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9647; val_auprc_score: 0.9839; val_best_acc_score: 0.9436; val_best_f1_score: 0.9634; train_kl_reg_loss: 24059.9893; train_edge_recon_loss: 1308792.8016; train_cat_covariates_contrastive_loss: 635343.1287; train_gene_expr_recon_loss: 1812956.7734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3781152.6924; train_optim_loss: 3781152.6924; val_kl_reg_loss: 24145.9294; val_edge_recon_loss: 1321507.6651; val_cat_covariates_contrastive_loss: 635561.6799; val_gene_expr_recon_loss: 1842211.1031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3823426.3588; val_optim_loss: 3823426.3588
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9693; val_auprc_score: 0.9890; val_best_acc_score: 0.9455; val_best_f1_score: 0.9658; train_kl_reg_loss: 27540.5143; train_edge_recon_loss: 1333285.4482; train_cat_covariates_contrastive_loss: 642628.4680; train_gene_expr_recon_loss: 1944938.8068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3948393.2376; train_optim_loss: 3948393.2376; val_kl_reg_loss: 26721.6613; val_edge_recon_loss: 1338632.8458; val_cat_covariates_contrastive_loss: 643506.6008; val_gene_expr_recon_loss: 1956979.6542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3965840.7628; val_optim_loss: 3965840.7628
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9650; val_auprc_score: 0.9837; val_best_acc_score: 0.9436; val_best_f1_score: 0.9633; train_kl_reg_loss: 24059.1564; train_edge_recon_loss: 1309901.0748; train_cat_covariates_contrastive_loss: 634999.9210; train_gene_expr_recon_loss: 1812847.6263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3781807.7776; train_optim_loss: 3781807.7776; val_kl_reg_loss: 24149.9581; val_edge_recon_loss: 1338919.2405; val_cat_covariates_contrastive_loss: 634966.0272; val_gene_expr_recon_loss: 1843548.6126; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3841583.8454; val_optim_loss: 3841583.8454
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9637; val_auprc_score: 0.9831; val_best_acc_score: 0.9431; val_best_f1_score: 0.9629; train_kl_reg_loss: 24067.6269; train_edge_recon_loss: 1307329.2634; train_cat_covariates_contrastive_loss: 635114.2715; train_gene_expr_recon_loss: 1813264.2958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3779775.4548; train_optim_loss: 3779775.4548; val_kl_reg_loss: 24138.4630; val_edge_recon_loss: 1343996.5477; val_cat_covariates_contrastive_loss: 635316.8950; val_gene_expr_recon_loss: 1843605.1517; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3847057.0649; val_optim_loss: 3847057.0649
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9693; val_auprc_score: 0.9892; val_best_acc_score: 0.9461; val_best_f1_score: 0.9661; train_kl_reg_loss: 27715.7742; train_edge_recon_loss: 1331482.4537; train_cat_covariates_contrastive_loss: 642593.5892; train_gene_expr_recon_loss: 1938061.5129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3939853.3329; train_optim_loss: 3939853.3329; val_kl_reg_loss: 27708.5554; val_edge_recon_loss: 1332094.2129; val_cat_covariates_contrastive_loss: 643123.0835; val_gene_expr_recon_loss: 1949920.8607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3952846.7115; val_optim_loss: 3952846.7115
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9635; val_auprc_score: 0.9831; val_best_acc_score: 0.9435; val_best_f1_score: 0.9634; train_kl_reg_loss: 24069.1266; train_edge_recon_loss: 1310416.5996; train_cat_covariates_contrastive_loss: 635120.7552; train_gene_expr_recon_loss: 1813078.8317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3782685.3127; train_optim_loss: 3782685.3127; val_kl_reg_loss: 24146.6988; val_edge_recon_loss: 1331375.6050; val_cat_covariates_contrastive_loss: 635392.7281; val_gene_expr_recon_loss: 1846211.5525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3837126.5840; val_optim_loss: 3837126.5840
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9699; val_auprc_score: 0.9895; val_best_acc_score: 0.9458; val_best_f1_score: 0.9658; train_kl_reg_loss: 28038.9639; train_edge_recon_loss: 1327879.0787; train_cat_covariates_contrastive_loss: 642728.2595; train_gene_expr_recon_loss: 1936220.4426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3934866.7434; train_optim_loss: 3934866.7434; val_kl_reg_loss: 27806.4860; val_edge_recon_loss: 1336938.9155; val_cat_covariates_contrastive_loss: 642970.9185; val_gene_expr_recon_loss: 1940503.1003; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3948219.4229; val_optim_loss: 3948219.4229
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9637; val_auprc_score: 0.9832; val_best_acc_score: 0.9439; val_best_f1_score: 0.9636; train_kl_reg_loss: 24060.2191; train_edge_recon_loss: 1311595.9583; train_cat_covariates_contrastive_loss: 635176.6766; train_gene_expr_recon_loss: 1812813.9117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3783646.7630; train_optim_loss: 3783646.7630; val_kl_reg_loss: 24158.6466; val_edge_recon_loss: 1334648.9800; val_cat_covariates_contrastive_loss: 634898.1531; val_gene_expr_recon_loss: 1843879.6565; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3837585.4332; val_optim_loss: 3837585.4332

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000004e-08.

Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9639; val_auprc_score: 0.9837; val_best_acc_score: 0.9429; val_best_f1_score: 0.9629; train_kl_reg_loss: 24066.1572; train_edge_recon_loss: 1309622.1025; train_cat_covariates_contrastive_loss: 635128.6024; train_gene_expr_recon_loss: 1812468.2715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3781285.1351; train_optim_loss: 3781285.1351; val_kl_reg_loss: 24163.3703; val_edge_recon_loss: 1326653.5439; val_cat_covariates_contrastive_loss: 634892.9265; val_gene_expr_recon_loss: 1843050.2013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3828760.0286; val_optim_loss: 3828760.0286
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9691; val_auprc_score: 0.9889; val_best_acc_score: 0.9449; val_best_f1_score: 0.9653; train_kl_reg_loss: 28060.0074; train_edge_recon_loss: 1331761.5472; train_cat_covariates_contrastive_loss: 642742.5806; train_gene_expr_recon_loss: 1934522.6477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3937086.7832; train_optim_loss: 3937086.7832; val_kl_reg_loss: 28665.4966; val_edge_recon_loss: 1346470.2712; val_cat_covariates_contrastive_loss: 642508.9496; val_gene_expr_recon_loss: 1954623.1551; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3972267.8646; val_optim_loss: 3972267.8646
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9643; val_auprc_score: 0.9834; val_best_acc_score: 0.9435; val_best_f1_score: 0.9633; train_kl_reg_loss: 24063.0476; train_edge_recon_loss: 1306983.3481; train_cat_covariates_contrastive_loss: 634966.5810; train_gene_expr_recon_loss: 1813070.5562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3779083.5316; train_optim_loss: 3779083.5316; val_kl_reg_loss: 24177.4241; val_edge_recon_loss: 1330389.3511; val_cat_covariates_contrastive_loss: 634669.8807; val_gene_expr_recon_loss: 1846654.2433; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3835890.8931; val_optim_loss: 3835890.8931
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9627; val_auprc_score: 0.9828; val_best_acc_score: 0.9421; val_best_f1_score: 0.9623; train_kl_reg_loss: 24069.8324; train_edge_recon_loss: 1308593.9151; train_cat_covariates_contrastive_loss: 635066.4432; train_gene_expr_recon_loss: 1812743.8923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3780474.0788; train_optim_loss: 3780474.0788; val_kl_reg_loss: 24152.8530; val_edge_recon_loss: 1336535.5830; val_cat_covariates_contrastive_loss: 635335.8602; val_gene_expr_recon_loss: 1844900.8254; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3840925.1202; val_optim_loss: 3840925.1202
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9695; val_auprc_score: 0.9892; val_best_acc_score: 0.9473; val_best_f1_score: 0.9669; train_kl_reg_loss: 28339.1668; train_edge_recon_loss: 1330976.6394; train_cat_covariates_contrastive_loss: 642950.9360; train_gene_expr_recon_loss: 1932134.2657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3934401.0114; train_optim_loss: 3934401.0114; val_kl_reg_loss: 29552.6982; val_edge_recon_loss: 1335512.9555; val_cat_covariates_contrastive_loss: 641762.9202; val_gene_expr_recon_loss: 1945597.2530; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3952425.8320; val_optim_loss: 3952425.8320
Epoch 65/400 |███-----------------| 16.2% val_auroc_score: 0.9647; val_auprc_score: 0.9839; val_best_acc_score: 0.9431; val_best_f1_score: 0.9631; train_kl_reg_loss: 24056.1287; train_edge_recon_loss: 1310579.2657; train_cat_covariates_contrastive_loss: 635239.8206; train_gene_expr_recon_loss: 1812567.6298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3782442.8447; train_optim_loss: 3782442.8447; val_kl_reg_loss: 24137.0793; val_edge_recon_loss: 1335389.4771; val_cat_covariates_contrastive_loss: 635127.5978; val_gene_expr_recon_loss: 1841183.5553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3835837.7233; val_optim_loss: 3835837.7233
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9706; val_auprc_score: 0.9897; val_best_acc_score: 0.9460; val_best_f1_score: 0.9659; train_kl_reg_loss: 28713.0179; train_edge_recon_loss: 1327778.7589; train_cat_covariates_contrastive_loss: 642877.4487; train_gene_expr_recon_loss: 1927791.7447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3927160.9719; train_optim_loss: 3927160.9719; val_kl_reg_loss: 28279.0535; val_edge_recon_loss: 1342412.0049; val_cat_covariates_contrastive_loss: 643284.9657; val_gene_expr_recon_loss: 1934368.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3948344.0958; val_optim_loss: 3948344.0958

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 677 min 31 sec.
Using best model state, which was in epoch 57.

--- MODEL EVALUATION ---
val AUROC score: 0.9428
val AUPRC score: 0.9646
val best accuracy score: 0.9366
val best F1 score: 0.9583
val target rna MSE score: 0.6299
val source rna MSE score: 0.1116
Val cat covariate0 mean sim diff: 0.0003
Val cat covariate1 mean sim diff: -0.0882
Duration of model training in run 2: 11 hours, 20 minutes and 5 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9709; val_auprc_score: 0.9900; val_best_acc_score: 0.9434; val_best_f1_score: 0.9644; train_kl_reg_loss: 131366578.8292; train_edge_recon_loss: 1392171.0224; train_cat_covariates_contrastive_loss: 644230.0003; train_gene_expr_recon_loss: 4903766.2635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 138306755.3830; train_optim_loss: 138306755.3830; val_kl_reg_loss: 36589.1104; val_edge_recon_loss: 1345010.1848; val_cat_covariates_contrastive_loss: 644787.9884; val_gene_expr_recon_loss: 2240736.5820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4267123.8725; val_optim_loss: 4267123.8725

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9726; val_auprc_score: 0.9904; val_best_acc_score: 0.9476; val_best_f1_score: 0.9670; train_kl_reg_loss: 57991.7069; train_edge_recon_loss: 1326811.6581; train_cat_covariates_contrastive_loss: 643648.9335; train_gene_expr_recon_loss: 2176722.3709; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4205174.6649; train_optim_loss: 4205174.6649; val_kl_reg_loss: 32865.9931; val_edge_recon_loss: 1332749.5894; val_cat_covariates_contrastive_loss: 643867.6717; val_gene_expr_recon_loss: 2151580.5464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4161063.7915; val_optim_loss: 4161063.7915
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9723; val_auprc_score: 0.9904; val_best_acc_score: 0.9483; val_best_f1_score: 0.9675; train_kl_reg_loss: 32886.9204; train_edge_recon_loss: 1326420.4564; train_cat_covariates_contrastive_loss: 644252.5295; train_gene_expr_recon_loss: 2110393.3452; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4113953.2529; train_optim_loss: 4113953.2529; val_kl_reg_loss: 33019.0925; val_edge_recon_loss: 1325609.2416; val_cat_covariates_contrastive_loss: 644563.1420; val_gene_expr_recon_loss: 2083491.1497; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4086682.6314; val_optim_loss: 4086682.6314
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9716; val_auprc_score: 0.9899; val_best_acc_score: 0.9484; val_best_f1_score: 0.9674; train_kl_reg_loss: 33117.9987; train_edge_recon_loss: 1327062.0849; train_cat_covariates_contrastive_loss: 644635.3723; train_gene_expr_recon_loss: 2045350.0012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4050165.4607; train_optim_loss: 4050165.4607; val_kl_reg_loss: 33165.2930; val_edge_recon_loss: 1336915.5716; val_cat_covariates_contrastive_loss: 644924.5771; val_gene_expr_recon_loss: 2031343.1334; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4046348.5711; val_optim_loss: 4046348.5711
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9703; val_auprc_score: 0.9895; val_best_acc_score: 0.9478; val_best_f1_score: 0.9671; train_kl_reg_loss: 33277.6956; train_edge_recon_loss: 1327544.5341; train_cat_covariates_contrastive_loss: 644803.1178; train_gene_expr_recon_loss: 1999347.7071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4004973.0537; train_optim_loss: 4004973.0537; val_kl_reg_loss: 33442.4401; val_edge_recon_loss: 1343082.4442; val_cat_covariates_contrastive_loss: 644464.1581; val_gene_expr_recon_loss: 1994962.7925; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4015951.8281; val_optim_loss: 4015951.8281

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 476 min 13 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
val AUROC score: 0.9124
val AUPRC score: 0.9582
val best accuracy score: 0.9186
val best F1 score: 0.9479
val target rna MSE score: 0.5866
val source rna MSE score: 0.1008
Val cat covariate0 mean sim diff: 0.0002
Val cat covariate1 mean sim diff: -0.1004
Duration of model training in run 2: 8 hours, 0 minutes and 40 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
