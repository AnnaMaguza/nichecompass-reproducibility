Run timestamp: 02092023_171325_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '256', '256', '256', '256', '256', '256', '256', '256', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc_subsample_10pct', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 25413
Number of validation nodes: 2824
Number of training edges: 231162
Number of validation edges: 25684
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Run timestamp: 02092023_171351_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '256', '256', '256', '256', '256', '256', '256', '256', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc_subsample_10pct', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 25413
Number of validation nodes: 2824
Number of training edges: 231162
Number of validation edges: 25684
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9381; val_auprc_score: 0.9726; val_best_acc_score: 0.9165; val_best_f1_score: 0.9465; train_kl_reg_loss: 15110.2710; train_edge_recon_loss: 1426778.3122; train_cat_covariates_contrastive_loss: 639645.4237; train_gene_expr_recon_loss: 3104178.3383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5185712.3444; train_optim_loss: 5185712.3444; val_kl_reg_loss: 11135.8726; val_edge_recon_loss: 1351028.5241; val_cat_covariates_contrastive_loss: 634373.7723; val_gene_expr_recon_loss: 2898869.5743; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4895407.7475; val_optim_loss: 4895407.7475
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9380; val_auprc_score: 0.9694; val_best_acc_score: 0.9347; val_best_f1_score: 0.9579; train_kl_reg_loss: 11184.0495; train_edge_recon_loss: 1329453.6860; train_cat_covariates_contrastive_loss: 633423.7051; train_gene_expr_recon_loss: 2832574.6888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4806636.1301; train_optim_loss: 4806636.1301; val_kl_reg_loss: 11428.7051; val_edge_recon_loss: 1329203.9691; val_cat_covariates_contrastive_loss: 633087.7989; val_gene_expr_recon_loss: 2752477.6312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4726198.1238; val_optim_loss: 4726198.1238
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9434; val_auprc_score: 0.9722; val_best_acc_score: 0.9374; val_best_f1_score: 0.9596; train_kl_reg_loss: 12017.5448; train_edge_recon_loss: 1320558.4318; train_cat_covariates_contrastive_loss: 633651.3082; train_gene_expr_recon_loss: 2714708.4599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4680935.7483; train_optim_loss: 4680935.7483; val_kl_reg_loss: 12470.4122; val_edge_recon_loss: 1346078.5891; val_cat_covariates_contrastive_loss: 633956.2092; val_gene_expr_recon_loss: 2655091.4084; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4647596.5842; val_optim_loss: 4647596.5842
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9399; val_auprc_score: 0.9697; val_best_acc_score: 0.9421; val_best_f1_score: 0.9625; train_kl_reg_loss: 13527.4215; train_edge_recon_loss: 1317152.5999; train_cat_covariates_contrastive_loss: 634332.3318; train_gene_expr_recon_loss: 2618430.3433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4583442.6921; train_optim_loss: 4583442.6921; val_kl_reg_loss: 15023.6923; val_edge_recon_loss: 1338337.2042; val_cat_covariates_contrastive_loss: 634356.5656; val_gene_expr_recon_loss: 2558605.4950; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4546322.9505; val_optim_loss: 4546322.9505
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9410; val_auprc_score: 0.9694; val_best_acc_score: 0.9450; val_best_f1_score: 0.9646; train_kl_reg_loss: 15803.5088; train_edge_recon_loss: 1319847.2303; train_cat_covariates_contrastive_loss: 635428.9528; train_gene_expr_recon_loss: 2515649.2362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4486728.9214; train_optim_loss: 4486728.9214; val_kl_reg_loss: 16572.2164; val_edge_recon_loss: 1324321.1572; val_cat_covariates_contrastive_loss: 635288.1188; val_gene_expr_recon_loss: 2470041.4554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4446222.9480; val_optim_loss: 4446222.9480
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9411; val_auprc_score: 0.9699; val_best_acc_score: 0.9437; val_best_f1_score: 0.9637; train_kl_reg_loss: 18165.8140; train_edge_recon_loss: 1319491.5563; train_cat_covariates_contrastive_loss: 636234.1283; train_gene_expr_recon_loss: 2427357.3947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4401248.8931; train_optim_loss: 4401248.8931; val_kl_reg_loss: 19159.4762; val_edge_recon_loss: 1325678.1460; val_cat_covariates_contrastive_loss: 635872.1355; val_gene_expr_recon_loss: 2394700.3614; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4375410.1139; val_optim_loss: 4375410.1139
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9413; val_auprc_score: 0.9693; val_best_acc_score: 0.9460; val_best_f1_score: 0.9651; train_kl_reg_loss: 19912.7292; train_edge_recon_loss: 1315980.1401; train_cat_covariates_contrastive_loss: 637163.6766; train_gene_expr_recon_loss: 2360617.9621; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4333674.5155; train_optim_loss: 4333674.5155; val_kl_reg_loss: 21036.0508; val_edge_recon_loss: 1325658.0186; val_cat_covariates_contrastive_loss: 636667.0551; val_gene_expr_recon_loss: 2347910.0087; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4331271.1460; val_optim_loss: 4331271.1460
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9447; val_auprc_score: 0.9709; val_best_acc_score: 0.9465; val_best_f1_score: 0.9654; train_kl_reg_loss: 21503.6346; train_edge_recon_loss: 1320548.3192; train_cat_covariates_contrastive_loss: 637353.0021; train_gene_expr_recon_loss: 2309168.3933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4288573.3397; train_optim_loss: 4288573.3397; val_kl_reg_loss: 21852.0544; val_edge_recon_loss: 1317547.8428; val_cat_covariates_contrastive_loss: 638195.3663; val_gene_expr_recon_loss: 2306791.7574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4284387.0470; val_optim_loss: 4284387.0470
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9425; val_auprc_score: 0.9693; val_best_acc_score: 0.9476; val_best_f1_score: 0.9661; train_kl_reg_loss: 22506.8765; train_edge_recon_loss: 1314616.7337; train_cat_covariates_contrastive_loss: 637701.7472; train_gene_expr_recon_loss: 2271128.7229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4245954.0814; train_optim_loss: 4245954.0814; val_kl_reg_loss: 23151.4424; val_edge_recon_loss: 1310125.7228; val_cat_covariates_contrastive_loss: 638205.8243; val_gene_expr_recon_loss: 2283073.9158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4254556.8936; val_optim_loss: 4254556.8936
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9424; val_auprc_score: 0.9702; val_best_acc_score: 0.9464; val_best_f1_score: 0.9654; train_kl_reg_loss: 23610.8839; train_edge_recon_loss: 1318134.9676; train_cat_covariates_contrastive_loss: 637793.1116; train_gene_expr_recon_loss: 2235655.4009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4215194.3627; train_optim_loss: 4215194.3627; val_kl_reg_loss: 23545.1931; val_edge_recon_loss: 1325799.6720; val_cat_covariates_contrastive_loss: 638415.5297; val_gene_expr_recon_loss: 2257144.9134; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4244905.2970; val_optim_loss: 4244905.2970
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9441; val_auprc_score: 0.9702; val_best_acc_score: 0.9466; val_best_f1_score: 0.9656; train_kl_reg_loss: 24490.6667; train_edge_recon_loss: 1314816.6772; train_cat_covariates_contrastive_loss: 638069.4039; train_gene_expr_recon_loss: 2209777.2482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4187153.9972; train_optim_loss: 4187153.9972; val_kl_reg_loss: 24035.5873; val_edge_recon_loss: 1320871.6597; val_cat_covariates_contrastive_loss: 638689.2574; val_gene_expr_recon_loss: 2233529.4913; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4217126.0074; val_optim_loss: 4217126.0074
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9451; val_auprc_score: 0.9702; val_best_acc_score: 0.9509; val_best_f1_score: 0.9682; train_kl_reg_loss: 25021.9733; train_edge_recon_loss: 1317827.1502; train_cat_covariates_contrastive_loss: 638396.1661; train_gene_expr_recon_loss: 2202945.8191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4184191.1171; train_optim_loss: 4184191.1171; val_kl_reg_loss: 25979.6495; val_edge_recon_loss: 1311411.5842; val_cat_covariates_contrastive_loss: 640040.1906; val_gene_expr_recon_loss: 2222665.4257; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4200096.8540; val_optim_loss: 4200096.8540
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9384; val_auprc_score: 0.9658; val_best_acc_score: 0.9473; val_best_f1_score: 0.9658; train_kl_reg_loss: 25991.7783; train_edge_recon_loss: 1316126.4147; train_cat_covariates_contrastive_loss: 638872.4663; train_gene_expr_recon_loss: 2174987.2517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4155977.9045; train_optim_loss: 4155977.9045; val_kl_reg_loss: 26133.6880; val_edge_recon_loss: 1334320.9109; val_cat_covariates_contrastive_loss: 638940.2321; val_gene_expr_recon_loss: 2207837.5520; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4207232.3762; val_optim_loss: 4207232.3762
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9416; val_auprc_score: 0.9695; val_best_acc_score: 0.9496; val_best_f1_score: 0.9675; train_kl_reg_loss: 26421.1088; train_edge_recon_loss: 1314715.6755; train_cat_covariates_contrastive_loss: 638783.5484; train_gene_expr_recon_loss: 2158532.6157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4138452.9499; train_optim_loss: 4138452.9499; val_kl_reg_loss: 26155.2812; val_edge_recon_loss: 1319241.8329; val_cat_covariates_contrastive_loss: 639417.8849; val_gene_expr_recon_loss: 2206419.1498; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4191234.1683; val_optim_loss: 4191234.1683
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9387; val_auprc_score: 0.9655; val_best_acc_score: 0.9501; val_best_f1_score: 0.9678; train_kl_reg_loss: 26993.6798; train_edge_recon_loss: 1317708.9434; train_cat_covariates_contrastive_loss: 639386.4541; train_gene_expr_recon_loss: 2143143.4132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4127232.4994; train_optim_loss: 4127232.4994; val_kl_reg_loss: 28151.5709; val_edge_recon_loss: 1311838.0025; val_cat_covariates_contrastive_loss: 638357.9585; val_gene_expr_recon_loss: 2182342.1856; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4160689.7178; val_optim_loss: 4160689.7178
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9405; val_auprc_score: 0.9676; val_best_acc_score: 0.9495; val_best_f1_score: 0.9673; train_kl_reg_loss: 27266.9720; train_edge_recon_loss: 1315574.4093; train_cat_covariates_contrastive_loss: 639274.3911; train_gene_expr_recon_loss: 2142714.9391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4124830.7148; train_optim_loss: 4124830.7148; val_kl_reg_loss: 26536.3538; val_edge_recon_loss: 1326185.5087; val_cat_covariates_contrastive_loss: 641974.5359; val_gene_expr_recon_loss: 2188598.8156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4183295.1980; val_optim_loss: 4183295.1980
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9451; val_auprc_score: 0.9713; val_best_acc_score: 0.9507; val_best_f1_score: 0.9681; train_kl_reg_loss: 27935.8459; train_edge_recon_loss: 1310693.1070; train_cat_covariates_contrastive_loss: 639640.0752; train_gene_expr_recon_loss: 2124252.7596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4102521.7926; train_optim_loss: 4102521.7926; val_kl_reg_loss: 27206.2922; val_edge_recon_loss: 1322952.4233; val_cat_covariates_contrastive_loss: 640185.1238; val_gene_expr_recon_loss: 2176836.6151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4167180.4554; val_optim_loss: 4167180.4554
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9389; val_auprc_score: 0.9666; val_best_acc_score: 0.9496; val_best_f1_score: 0.9674; train_kl_reg_loss: 28116.1145; train_edge_recon_loss: 1313698.2420; train_cat_covariates_contrastive_loss: 639795.1080; train_gene_expr_recon_loss: 2126540.5681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4108150.0374; train_optim_loss: 4108150.0374; val_kl_reg_loss: 30552.3160; val_edge_recon_loss: 1315470.2339; val_cat_covariates_contrastive_loss: 638393.9895; val_gene_expr_recon_loss: 2173931.1807; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4158347.7426; val_optim_loss: 4158347.7426
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9425; val_auprc_score: 0.9696; val_best_acc_score: 0.9505; val_best_f1_score: 0.9681; train_kl_reg_loss: 28704.0286; train_edge_recon_loss: 1316689.0177; train_cat_covariates_contrastive_loss: 639851.7132; train_gene_expr_recon_loss: 2117545.7512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4102790.5080; train_optim_loss: 4102790.5080; val_kl_reg_loss: 28879.6378; val_edge_recon_loss: 1312556.8181; val_cat_covariates_contrastive_loss: 640928.6751; val_gene_expr_recon_loss: 2174141.6844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4156506.8243; val_optim_loss: 4156506.8243
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9400; val_auprc_score: 0.9675; val_best_acc_score: 0.9500; val_best_f1_score: 0.9675; train_kl_reg_loss: 28832.4065; train_edge_recon_loss: 1316633.7577; train_cat_covariates_contrastive_loss: 639933.9473; train_gene_expr_recon_loss: 2119663.2656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4105063.3815; train_optim_loss: 4105063.3815; val_kl_reg_loss: 28990.4231; val_edge_recon_loss: 1333689.6881; val_cat_covariates_contrastive_loss: 640714.3304; val_gene_expr_recon_loss: 2174930.1658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4178324.5891; val_optim_loss: 4178324.5891
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9485; val_auprc_score: 0.9717; val_best_acc_score: 0.9526; val_best_f1_score: 0.9692; train_kl_reg_loss: 29536.3106; train_edge_recon_loss: 1319209.6811; train_cat_covariates_contrastive_loss: 640240.9520; train_gene_expr_recon_loss: 2092064.6267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4081051.5795; train_optim_loss: 4081051.5795; val_kl_reg_loss: 28397.8604; val_edge_recon_loss: 1315452.5619; val_cat_covariates_contrastive_loss: 642514.2240; val_gene_expr_recon_loss: 2171642.0767; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4158006.7351; val_optim_loss: 4158006.7351
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9456; val_auprc_score: 0.9685; val_best_acc_score: 0.9543; val_best_f1_score: 0.9703; train_kl_reg_loss: 29844.4184; train_edge_recon_loss: 1321982.5998; train_cat_covariates_contrastive_loss: 640611.9809; train_gene_expr_recon_loss: 2114346.7357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4106785.7345; train_optim_loss: 4106785.7345; val_kl_reg_loss: 29871.3811; val_edge_recon_loss: 1311508.8304; val_cat_covariates_contrastive_loss: 641010.9530; val_gene_expr_recon_loss: 2161646.8985; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4144038.0520; val_optim_loss: 4144038.0520
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9449; val_auprc_score: 0.9704; val_best_acc_score: 0.9515; val_best_f1_score: 0.9685; train_kl_reg_loss: 30161.9822; train_edge_recon_loss: 1314621.1451; train_cat_covariates_contrastive_loss: 640637.2692; train_gene_expr_recon_loss: 2086424.6512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4071845.0460; train_optim_loss: 4071845.0460; val_kl_reg_loss: 28900.7262; val_edge_recon_loss: 1318297.5860; val_cat_covariates_contrastive_loss: 640385.9542; val_gene_expr_recon_loss: 2197025.5470; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4184609.8069; val_optim_loss: 4184609.8069
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9422; val_auprc_score: 0.9687; val_best_acc_score: 0.9521; val_best_f1_score: 0.9688; train_kl_reg_loss: 30395.1941; train_edge_recon_loss: 1314085.5577; train_cat_covariates_contrastive_loss: 640628.7594; train_gene_expr_recon_loss: 2104224.4462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4089333.9560; train_optim_loss: 4089333.9560; val_kl_reg_loss: 30700.8922; val_edge_recon_loss: 1320800.9295; val_cat_covariates_contrastive_loss: 640820.3682; val_gene_expr_recon_loss: 2163078.2203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4155400.4084; val_optim_loss: 4155400.4084
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9438; val_auprc_score: 0.9688; val_best_acc_score: 0.9521; val_best_f1_score: 0.9688; train_kl_reg_loss: 30869.8066; train_edge_recon_loss: 1309609.7527; train_cat_covariates_contrastive_loss: 640776.1730; train_gene_expr_recon_loss: 2077662.8011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4058918.5296; train_optim_loss: 4058918.5296; val_kl_reg_loss: 30149.6151; val_edge_recon_loss: 1324003.6188; val_cat_covariates_contrastive_loss: 641685.7921; val_gene_expr_recon_loss: 2151591.1399; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4147430.1163; val_optim_loss: 4147430.1163
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9444; val_auprc_score: 0.9694; val_best_acc_score: 0.9502; val_best_f1_score: 0.9675; train_kl_reg_loss: 30661.4490; train_edge_recon_loss: 1315043.6556; train_cat_covariates_contrastive_loss: 640977.6241; train_gene_expr_recon_loss: 2094109.4056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4080792.1368; train_optim_loss: 4080792.1368; val_kl_reg_loss: 30164.4003; val_edge_recon_loss: 1341877.7667; val_cat_covariates_contrastive_loss: 640869.7778; val_gene_expr_recon_loss: 2165289.5792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4178201.5149; val_optim_loss: 4178201.5149

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9447; val_auprc_score: 0.9691; val_best_acc_score: 0.9554; val_best_f1_score: 0.9711; train_kl_reg_loss: 31115.4700; train_edge_recon_loss: 1312966.2375; train_cat_covariates_contrastive_loss: 640912.9970; train_gene_expr_recon_loss: 2035235.3267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4020230.0357; train_optim_loss: 4020230.0357; val_kl_reg_loss: 30819.8695; val_edge_recon_loss: 1311574.0334; val_cat_covariates_contrastive_loss: 641809.8694; val_gene_expr_recon_loss: 2127904.1312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4112107.9109; val_optim_loss: 4112107.9109
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9446; val_auprc_score: 0.9697; val_best_acc_score: 0.9543; val_best_f1_score: 0.9703; train_kl_reg_loss: 31199.1463; train_edge_recon_loss: 1311894.0868; train_cat_covariates_contrastive_loss: 641389.2890; train_gene_expr_recon_loss: 2019654.0051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4004136.5277; train_optim_loss: 4004136.5277; val_kl_reg_loss: 31369.5012; val_edge_recon_loss: 1315990.1399; val_cat_covariates_contrastive_loss: 640974.6757; val_gene_expr_recon_loss: 2123904.5037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4112238.8144; val_optim_loss: 4112238.8144
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9436; val_auprc_score: 0.9697; val_best_acc_score: 0.9558; val_best_f1_score: 0.9714; train_kl_reg_loss: 31288.7255; train_edge_recon_loss: 1306521.8077; train_cat_covariates_contrastive_loss: 641394.8486; train_gene_expr_recon_loss: 2013690.9808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3992896.3610; train_optim_loss: 3992896.3610; val_kl_reg_loss: 32024.2493; val_edge_recon_loss: 1296555.6361; val_cat_covariates_contrastive_loss: 640397.3187; val_gene_expr_recon_loss: 2119928.3515; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4088905.5569; val_optim_loss: 4088905.5569
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9468; val_auprc_score: 0.9699; val_best_acc_score: 0.9557; val_best_f1_score: 0.9712; train_kl_reg_loss: 31295.1250; train_edge_recon_loss: 1305991.5028; train_cat_covariates_contrastive_loss: 641350.9068; train_gene_expr_recon_loss: 2006480.9763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3985118.5105; train_optim_loss: 3985118.5105; val_kl_reg_loss: 31293.5700; val_edge_recon_loss: 1310605.0161; val_cat_covariates_contrastive_loss: 641908.9127; val_gene_expr_recon_loss: 2116339.7983; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4100147.3094; val_optim_loss: 4100147.3094
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9454; val_auprc_score: 0.9707; val_best_acc_score: 0.9560; val_best_f1_score: 0.9715; train_kl_reg_loss: 31293.7695; train_edge_recon_loss: 1310130.6091; train_cat_covariates_contrastive_loss: 641047.8566; train_gene_expr_recon_loss: 2003780.2266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3986252.4651; train_optim_loss: 3986252.4651; val_kl_reg_loss: 31517.5017; val_edge_recon_loss: 1304100.2933; val_cat_covariates_contrastive_loss: 640056.9691; val_gene_expr_recon_loss: 2113723.1188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4089397.8787; val_optim_loss: 4089397.8787
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9447; val_auprc_score: 0.9698; val_best_acc_score: 0.9553; val_best_f1_score: 0.9710; train_kl_reg_loss: 31249.3197; train_edge_recon_loss: 1312087.7785; train_cat_covariates_contrastive_loss: 641082.3821; train_gene_expr_recon_loss: 1998817.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3983236.8375; train_optim_loss: 3983236.8375; val_kl_reg_loss: 31434.7521; val_edge_recon_loss: 1309062.6522; val_cat_covariates_contrastive_loss: 641496.4146; val_gene_expr_recon_loss: 2111529.2859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4093523.1163; val_optim_loss: 4093523.1163
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9441; val_auprc_score: 0.9688; val_best_acc_score: 0.9549; val_best_f1_score: 0.9707; train_kl_reg_loss: 31161.8151; train_edge_recon_loss: 1312349.8883; train_cat_covariates_contrastive_loss: 641397.3401; train_gene_expr_recon_loss: 1996004.3182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3980913.3624; train_optim_loss: 3980913.3624; val_kl_reg_loss: 30765.6141; val_edge_recon_loss: 1304219.1411; val_cat_covariates_contrastive_loss: 641368.3769; val_gene_expr_recon_loss: 2114289.3193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4090642.4530; val_optim_loss: 4090642.4530

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9445; val_auprc_score: 0.9696; val_best_acc_score: 0.9560; val_best_f1_score: 0.9715; train_kl_reg_loss: 31036.5678; train_edge_recon_loss: 1307133.8764; train_cat_covariates_contrastive_loss: 641344.4914; train_gene_expr_recon_loss: 1987742.7596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3967257.7002; train_optim_loss: 3967257.7002; val_kl_reg_loss: 31332.2376; val_edge_recon_loss: 1308842.0396; val_cat_covariates_contrastive_loss: 640734.6411; val_gene_expr_recon_loss: 2110301.2611; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4091210.1980; val_optim_loss: 4091210.1980
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9456; val_auprc_score: 0.9697; val_best_acc_score: 0.9558; val_best_f1_score: 0.9713; train_kl_reg_loss: 31027.4518; train_edge_recon_loss: 1314420.4293; train_cat_covariates_contrastive_loss: 641179.8071; train_gene_expr_recon_loss: 1986979.9023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3973607.5853; train_optim_loss: 3973607.5853; val_kl_reg_loss: 31299.0824; val_edge_recon_loss: 1319132.0743; val_cat_covariates_contrastive_loss: 641484.8236; val_gene_expr_recon_loss: 2108574.5767; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4100490.5668; val_optim_loss: 4100490.5668
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9464; val_auprc_score: 0.9707; val_best_acc_score: 0.9573; val_best_f1_score: 0.9723; train_kl_reg_loss: 31110.5820; train_edge_recon_loss: 1306642.2400; train_cat_covariates_contrastive_loss: 641099.4234; train_gene_expr_recon_loss: 1987329.5388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3966181.7816; train_optim_loss: 3966181.7816; val_kl_reg_loss: 31223.2845; val_edge_recon_loss: 1304108.2847; val_cat_covariates_contrastive_loss: 642007.3181; val_gene_expr_recon_loss: 2107186.7401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4084525.6411; val_optim_loss: 4084525.6411
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9413; val_auprc_score: 0.9677; val_best_acc_score: 0.9545; val_best_f1_score: 0.9705; train_kl_reg_loss: 31014.9715; train_edge_recon_loss: 1307608.9389; train_cat_covariates_contrastive_loss: 641095.3929; train_gene_expr_recon_loss: 1986099.7136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3965819.0227; train_optim_loss: 3965819.0227; val_kl_reg_loss: 31219.6225; val_edge_recon_loss: 1318189.6448; val_cat_covariates_contrastive_loss: 641358.7123; val_gene_expr_recon_loss: 2105148.6213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4095916.5941; val_optim_loss: 4095916.5941
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9475; val_auprc_score: 0.9713; val_best_acc_score: 0.9563; val_best_f1_score: 0.9716; train_kl_reg_loss: 31149.9345; train_edge_recon_loss: 1305749.4619; train_cat_covariates_contrastive_loss: 641236.0646; train_gene_expr_recon_loss: 1986039.0803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3964174.5396; train_optim_loss: 3964174.5396; val_kl_reg_loss: 31273.8954; val_edge_recon_loss: 1309358.6170; val_cat_covariates_contrastive_loss: 641165.5526; val_gene_expr_recon_loss: 2108069.5111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4089867.5891; val_optim_loss: 4089867.5891
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9437; val_auprc_score: 0.9693; val_best_acc_score: 0.9559; val_best_f1_score: 0.9713; train_kl_reg_loss: 31098.1303; train_edge_recon_loss: 1312331.6462; train_cat_covariates_contrastive_loss: 640981.3704; train_gene_expr_recon_loss: 1985384.1833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3969795.3295; train_optim_loss: 3969795.3295; val_kl_reg_loss: 31203.9445; val_edge_recon_loss: 1312679.1485; val_cat_covariates_contrastive_loss: 641159.9412; val_gene_expr_recon_loss: 2112094.7587; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4097137.7797; val_optim_loss: 4097137.7797
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9417; val_auprc_score: 0.9683; val_best_acc_score: 0.9549; val_best_f1_score: 0.9708; train_kl_reg_loss: 31045.3673; train_edge_recon_loss: 1313602.0347; train_cat_covariates_contrastive_loss: 641385.5424; train_gene_expr_recon_loss: 1985067.7209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3971100.6686; train_optim_loss: 3971100.6686; val_kl_reg_loss: 31262.8980; val_edge_recon_loss: 1315420.3700; val_cat_covariates_contrastive_loss: 642011.5755; val_gene_expr_recon_loss: 2108291.3911; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4096986.2525; val_optim_loss: 4096986.2525

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9488; val_auprc_score: 0.9717; val_best_acc_score: 0.9573; val_best_f1_score: 0.9722; train_kl_reg_loss: 31085.5831; train_edge_recon_loss: 1307647.2932; train_cat_covariates_contrastive_loss: 640962.6382; train_gene_expr_recon_loss: 1983941.1617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3963636.6736; train_optim_loss: 3963636.6736; val_kl_reg_loss: 31194.4292; val_edge_recon_loss: 1302919.1151; val_cat_covariates_contrastive_loss: 641418.7692; val_gene_expr_recon_loss: 2109712.3243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4085244.6312; val_optim_loss: 4085244.6312
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9449; val_auprc_score: 0.9689; val_best_acc_score: 0.9558; val_best_f1_score: 0.9712; train_kl_reg_loss: 31023.0844; train_edge_recon_loss: 1313833.3691; train_cat_covariates_contrastive_loss: 640969.0685; train_gene_expr_recon_loss: 1983668.4161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3969493.9388; train_optim_loss: 3969493.9388; val_kl_reg_loss: 31163.5815; val_edge_recon_loss: 1320011.0000; val_cat_covariates_contrastive_loss: 641571.2686; val_gene_expr_recon_loss: 2111263.3267; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4104009.1881; val_optim_loss: 4104009.1881
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9442; val_auprc_score: 0.9698; val_best_acc_score: 0.9563; val_best_f1_score: 0.9716; train_kl_reg_loss: 30971.6343; train_edge_recon_loss: 1301428.2161; train_cat_covariates_contrastive_loss: 640950.3858; train_gene_expr_recon_loss: 1983961.1412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3957311.3787; train_optim_loss: 3957311.3787; val_kl_reg_loss: 31098.9568; val_edge_recon_loss: 1308362.0780; val_cat_covariates_contrastive_loss: 641512.0854; val_gene_expr_recon_loss: 2109901.5916; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4090874.7129; val_optim_loss: 4090874.7129
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9420; val_auprc_score: 0.9675; val_best_acc_score: 0.9537; val_best_f1_score: 0.9700; train_kl_reg_loss: 30982.1758; train_edge_recon_loss: 1303916.2383; train_cat_covariates_contrastive_loss: 641236.6720; train_gene_expr_recon_loss: 1984376.9628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3960512.0518; train_optim_loss: 3960512.0518; val_kl_reg_loss: 31179.9022; val_edge_recon_loss: 1314766.5693; val_cat_covariates_contrastive_loss: 640986.4821; val_gene_expr_recon_loss: 2108739.4592; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4095672.4109; val_optim_loss: 4095672.4109

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 277 min 1 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
val AUROC score: 0.9328
val AUPRC score: 0.9626
val best accuracy score: 0.9505
val best F1 score: 0.9678
val target rna MSE score: 1.5956
val source rna MSE score: 0.0654
Val cat covariate0 mean sim diff: 0.0003
Val cat covariate1 mean sim diff: -0.0978
Duration of model training in run 8: 4 hours, 39 minutes and 0 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 25413
Number of validation nodes: 2824
Number of training edges: 231162
Number of validation edges: 25684
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9240; val_auprc_score: 0.9660; val_best_acc_score: 0.9061; val_best_f1_score: 0.9402; train_kl_reg_loss: 14220.0776; train_edge_recon_loss: 1448965.8983; train_cat_covariates_contrastive_loss: 640624.5163; train_gene_expr_recon_loss: 3113090.7007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5216901.1988; train_optim_loss: 5216901.1988; val_kl_reg_loss: 11974.3496; val_edge_recon_loss: 1372650.5582; val_cat_covariates_contrastive_loss: 632334.4554; val_gene_expr_recon_loss: 2878755.9604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4895715.3267; val_optim_loss: 4895715.3267
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9382; val_auprc_score: 0.9698; val_best_acc_score: 0.9302; val_best_f1_score: 0.9549; train_kl_reg_loss: 11542.2152; train_edge_recon_loss: 1335905.1988; train_cat_covariates_contrastive_loss: 633403.2771; train_gene_expr_recon_loss: 2822293.5941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4803144.2868; train_optim_loss: 4803144.2868; val_kl_reg_loss: 11648.2418; val_edge_recon_loss: 1338276.4499; val_cat_covariates_contrastive_loss: 632537.7847; val_gene_expr_recon_loss: 2729585.9827; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4712048.4455; val_optim_loss: 4712048.4455
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9418; val_auprc_score: 0.9705; val_best_acc_score: 0.9392; val_best_f1_score: 0.9608; train_kl_reg_loss: 12422.2856; train_edge_recon_loss: 1327922.2761; train_cat_covariates_contrastive_loss: 633457.0547; train_gene_expr_recon_loss: 2704976.9042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4678778.5158; train_optim_loss: 4678778.5158; val_kl_reg_loss: 12799.2481; val_edge_recon_loss: 1333413.8577; val_cat_covariates_contrastive_loss: 633463.6355; val_gene_expr_recon_loss: 2634251.9554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4613928.6906; val_optim_loss: 4613928.6906
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9420; val_auprc_score: 0.9709; val_best_acc_score: 0.9439; val_best_f1_score: 0.9637; train_kl_reg_loss: 13875.8306; train_edge_recon_loss: 1315638.8517; train_cat_covariates_contrastive_loss: 634322.6051; train_gene_expr_recon_loss: 2602276.2829; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4566113.5653; train_optim_loss: 4566113.5653; val_kl_reg_loss: 15370.5988; val_edge_recon_loss: 1324713.4604; val_cat_covariates_contrastive_loss: 634035.6714; val_gene_expr_recon_loss: 2525201.2599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4499320.9950; val_optim_loss: 4499320.9950
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9433; val_auprc_score: 0.9703; val_best_acc_score: 0.9424; val_best_f1_score: 0.9628; train_kl_reg_loss: 16128.0949; train_edge_recon_loss: 1319217.6970; train_cat_covariates_contrastive_loss: 635406.4567; train_gene_expr_recon_loss: 2492939.9684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4463692.2157; train_optim_loss: 4463692.2157; val_kl_reg_loss: 17357.5371; val_edge_recon_loss: 1326196.0421; val_cat_covariates_contrastive_loss: 636010.7611; val_gene_expr_recon_loss: 2433308.9257; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4412873.2376; val_optim_loss: 4412873.2376
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9448; val_auprc_score: 0.9710; val_best_acc_score: 0.9474; val_best_f1_score: 0.9661; train_kl_reg_loss: 18330.7983; train_edge_recon_loss: 1320421.9378; train_cat_covariates_contrastive_loss: 636289.4075; train_gene_expr_recon_loss: 2405204.3571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4380246.5072; train_optim_loss: 4380246.5072; val_kl_reg_loss: 18513.7579; val_edge_recon_loss: 1311399.5458; val_cat_covariates_contrastive_loss: 637309.8800; val_gene_expr_recon_loss: 2364847.6609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4332070.8391; val_optim_loss: 4332070.8391
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9432; val_auprc_score: 0.9709; val_best_acc_score: 0.9453; val_best_f1_score: 0.9648; train_kl_reg_loss: 20168.3830; train_edge_recon_loss: 1316150.6402; train_cat_covariates_contrastive_loss: 636897.6007; train_gene_expr_recon_loss: 2338997.4720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4312214.0853; train_optim_loss: 4312214.0853; val_kl_reg_loss: 20580.6148; val_edge_recon_loss: 1306352.2005; val_cat_covariates_contrastive_loss: 637782.9313; val_gene_expr_recon_loss: 2312336.4307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4277052.1856; val_optim_loss: 4277052.1856
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9425; val_auprc_score: 0.9684; val_best_acc_score: 0.9467; val_best_f1_score: 0.9656; train_kl_reg_loss: 21490.5574; train_edge_recon_loss: 1317794.5206; train_cat_covariates_contrastive_loss: 637303.4006; train_gene_expr_recon_loss: 2291808.8541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4268397.3333; train_optim_loss: 4268397.3333; val_kl_reg_loss: 21714.5168; val_edge_recon_loss: 1319735.3601; val_cat_covariates_contrastive_loss: 636895.9988; val_gene_expr_recon_loss: 2276637.7884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4254983.6931; val_optim_loss: 4254983.6931
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9433; val_auprc_score: 0.9703; val_best_acc_score: 0.9472; val_best_f1_score: 0.9659; train_kl_reg_loss: 22743.3586; train_edge_recon_loss: 1316860.3901; train_cat_covariates_contrastive_loss: 637845.5500; train_gene_expr_recon_loss: 2248729.3841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4226178.6849; train_optim_loss: 4226178.6849; val_kl_reg_loss: 22549.6782; val_edge_recon_loss: 1328325.2252; val_cat_covariates_contrastive_loss: 637358.6708; val_gene_expr_recon_loss: 2254207.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4242441.0668; val_optim_loss: 4242441.0668
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9396; val_auprc_score: 0.9671; val_best_acc_score: 0.9463; val_best_f1_score: 0.9653; train_kl_reg_loss: 23733.8108; train_edge_recon_loss: 1317844.8137; train_cat_covariates_contrastive_loss: 638028.7844; train_gene_expr_recon_loss: 2226308.8602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4205916.2636; train_optim_loss: 4205916.2636; val_kl_reg_loss: 24522.5962; val_edge_recon_loss: 1327092.4319; val_cat_covariates_contrastive_loss: 638219.9802; val_gene_expr_recon_loss: 2222582.5408; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4212417.5545; val_optim_loss: 4212417.5545
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9426; val_auprc_score: 0.9693; val_best_acc_score: 0.9481; val_best_f1_score: 0.9666; train_kl_reg_loss: 24706.9194; train_edge_recon_loss: 1318017.0709; train_cat_covariates_contrastive_loss: 638122.1919; train_gene_expr_recon_loss: 2193721.9783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4174568.1548; train_optim_loss: 4174568.1548; val_kl_reg_loss: 23788.7161; val_edge_recon_loss: 1296850.7995; val_cat_covariates_contrastive_loss: 638755.4443; val_gene_expr_recon_loss: 2198823.6745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4158218.6634; val_optim_loss: 4158218.6634
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9440; val_auprc_score: 0.9710; val_best_acc_score: 0.9487; val_best_f1_score: 0.9668; train_kl_reg_loss: 25224.7955; train_edge_recon_loss: 1313235.8931; train_cat_covariates_contrastive_loss: 638351.5003; train_gene_expr_recon_loss: 2179140.0813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4155952.2672; train_optim_loss: 4155952.2672; val_kl_reg_loss: 24142.6355; val_edge_recon_loss: 1327932.4666; val_cat_covariates_contrastive_loss: 639662.8212; val_gene_expr_recon_loss: 2199204.5928; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4190942.5322; val_optim_loss: 4190942.5322
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9419; val_auprc_score: 0.9693; val_best_acc_score: 0.9487; val_best_f1_score: 0.9669; train_kl_reg_loss: 25933.8842; train_edge_recon_loss: 1312749.1751; train_cat_covariates_contrastive_loss: 638523.5048; train_gene_expr_recon_loss: 2157539.4871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4134746.0449; train_optim_loss: 4134746.0449; val_kl_reg_loss: 24692.6388; val_edge_recon_loss: 1316164.7345; val_cat_covariates_contrastive_loss: 638771.6281; val_gene_expr_recon_loss: 2179269.0074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4158898.0124; val_optim_loss: 4158898.0124
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9416; val_auprc_score: 0.9677; val_best_acc_score: 0.9490; val_best_f1_score: 0.9670; train_kl_reg_loss: 26488.8602; train_edge_recon_loss: 1318831.7431; train_cat_covariates_contrastive_loss: 639053.2828; train_gene_expr_recon_loss: 2160420.8764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4144794.7680; train_optim_loss: 4144794.7680; val_kl_reg_loss: 26249.6582; val_edge_recon_loss: 1309681.5978; val_cat_covariates_contrastive_loss: 639478.5384; val_gene_expr_recon_loss: 2169811.1745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4145220.9752; val_optim_loss: 4145220.9752
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9399; val_auprc_score: 0.9676; val_best_acc_score: 0.9499; val_best_f1_score: 0.9677; train_kl_reg_loss: 27009.1613; train_edge_recon_loss: 1313632.3360; train_cat_covariates_contrastive_loss: 639081.0905; train_gene_expr_recon_loss: 2140095.8625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4119818.4416; train_optim_loss: 4119818.4416; val_kl_reg_loss: 27207.9399; val_edge_recon_loss: 1314943.5421; val_cat_covariates_contrastive_loss: 638606.4406; val_gene_expr_recon_loss: 2181447.5903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4162205.5223; val_optim_loss: 4162205.5223
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9405; val_auprc_score: 0.9681; val_best_acc_score: 0.9492; val_best_f1_score: 0.9670; train_kl_reg_loss: 27638.5097; train_edge_recon_loss: 1314954.6143; train_cat_covariates_contrastive_loss: 639120.7991; train_gene_expr_recon_loss: 2124495.8850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4106209.8068; train_optim_loss: 4106209.8068; val_kl_reg_loss: 28841.1717; val_edge_recon_loss: 1332825.1634; val_cat_covariates_contrastive_loss: 637779.7803; val_gene_expr_recon_loss: 2171121.0384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4170567.1559; val_optim_loss: 4170567.1559
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9427; val_auprc_score: 0.9699; val_best_acc_score: 0.9498; val_best_f1_score: 0.9676; train_kl_reg_loss: 27729.6591; train_edge_recon_loss: 1309005.3362; train_cat_covariates_contrastive_loss: 639354.2782; train_gene_expr_recon_loss: 2124818.6150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4100907.8848; train_optim_loss: 4100907.8848; val_kl_reg_loss: 29605.6136; val_edge_recon_loss: 1308794.0408; val_cat_covariates_contrastive_loss: 638623.3595; val_gene_expr_recon_loss: 2233130.1634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4210153.1807; val_optim_loss: 4210153.1807
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9459; val_auprc_score: 0.9717; val_best_acc_score: 0.9505; val_best_f1_score: 0.9680; train_kl_reg_loss: 28315.3543; train_edge_recon_loss: 1317047.1330; train_cat_covariates_contrastive_loss: 639755.1096; train_gene_expr_recon_loss: 2113193.6520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4098311.2456; train_optim_loss: 4098311.2456; val_kl_reg_loss: 27544.4697; val_edge_recon_loss: 1321610.9579; val_cat_covariates_contrastive_loss: 640017.6677; val_gene_expr_recon_loss: 2144501.6287; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4133674.7129; val_optim_loss: 4133674.7129
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9415; val_auprc_score: 0.9685; val_best_acc_score: 0.9500; val_best_f1_score: 0.9676; train_kl_reg_loss: 28827.3740; train_edge_recon_loss: 1314937.8698; train_cat_covariates_contrastive_loss: 639609.5050; train_gene_expr_recon_loss: 2111107.9956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4094482.7428; train_optim_loss: 4094482.7428; val_kl_reg_loss: 29719.1874; val_edge_recon_loss: 1321989.5223; val_cat_covariates_contrastive_loss: 637764.7438; val_gene_expr_recon_loss: 2151202.8688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4140676.3317; val_optim_loss: 4140676.3317
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9432; val_auprc_score: 0.9698; val_best_acc_score: 0.9514; val_best_f1_score: 0.9686; train_kl_reg_loss: 28855.7211; train_edge_recon_loss: 1315939.0375; train_cat_covariates_contrastive_loss: 639882.5497; train_gene_expr_recon_loss: 2112787.5580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4097464.8668; train_optim_loss: 4097464.8668; val_kl_reg_loss: 29928.9508; val_edge_recon_loss: 1311197.5835; val_cat_covariates_contrastive_loss: 639619.1349; val_gene_expr_recon_loss: 2154770.6634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4135516.3465; val_optim_loss: 4135516.3465
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9409; val_auprc_score: 0.9674; val_best_acc_score: 0.9517; val_best_f1_score: 0.9687; train_kl_reg_loss: 29547.5261; train_edge_recon_loss: 1308986.7312; train_cat_covariates_contrastive_loss: 640053.4995; train_gene_expr_recon_loss: 2095816.2775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4074404.0377; train_optim_loss: 4074404.0377; val_kl_reg_loss: 29518.8650; val_edge_recon_loss: 1310373.7933; val_cat_covariates_contrastive_loss: 640088.7605; val_gene_expr_recon_loss: 2150746.3342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4130727.7351; val_optim_loss: 4130727.7351
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9424; val_auprc_score: 0.9682; val_best_acc_score: 0.9535; val_best_f1_score: 0.9698; train_kl_reg_loss: 29514.9788; train_edge_recon_loss: 1316812.2535; train_cat_covariates_contrastive_loss: 639953.0937; train_gene_expr_recon_loss: 2100108.3199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4086388.6509; train_optim_loss: 4086388.6509; val_kl_reg_loss: 30653.8601; val_edge_recon_loss: 1324548.0681; val_cat_covariates_contrastive_loss: 639442.0377; val_gene_expr_recon_loss: 2150683.2017; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4145327.1683; val_optim_loss: 4145327.1683
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9430; val_auprc_score: 0.9695; val_best_acc_score: 0.9518; val_best_f1_score: 0.9688; train_kl_reg_loss: 29774.1163; train_edge_recon_loss: 1311389.7074; train_cat_covariates_contrastive_loss: 640378.4933; train_gene_expr_recon_loss: 2094568.2940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4076110.6113; train_optim_loss: 4076110.6113; val_kl_reg_loss: 30362.3946; val_edge_recon_loss: 1310637.1287; val_cat_covariates_contrastive_loss: 640069.8156; val_gene_expr_recon_loss: 2151732.0322; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4132801.3837; val_optim_loss: 4132801.3837
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9405; val_auprc_score: 0.9679; val_best_acc_score: 0.9521; val_best_f1_score: 0.9691; train_kl_reg_loss: 30376.4765; train_edge_recon_loss: 1314325.1095; train_cat_covariates_contrastive_loss: 640474.0417; train_gene_expr_recon_loss: 2076205.9504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4061381.5770; train_optim_loss: 4061381.5770; val_kl_reg_loss: 30900.3876; val_edge_recon_loss: 1313359.6658; val_cat_covariates_contrastive_loss: 639094.9623; val_gene_expr_recon_loss: 2144309.0730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4127664.0916; val_optim_loss: 4127664.0916
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9436; val_auprc_score: 0.9697; val_best_acc_score: 0.9531; val_best_f1_score: 0.9696; train_kl_reg_loss: 30508.4160; train_edge_recon_loss: 1318302.2294; train_cat_covariates_contrastive_loss: 640534.5834; train_gene_expr_recon_loss: 2089589.7244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4078934.9446; train_optim_loss: 4078934.9446; val_kl_reg_loss: 30797.4510; val_edge_recon_loss: 1307135.9864; val_cat_covariates_contrastive_loss: 640785.1498; val_gene_expr_recon_loss: 2143849.9802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4122568.5767; val_optim_loss: 4122568.5767
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9469; val_auprc_score: 0.9710; val_best_acc_score: 0.9543; val_best_f1_score: 0.9703; train_kl_reg_loss: 30924.1499; train_edge_recon_loss: 1313244.7281; train_cat_covariates_contrastive_loss: 640580.2719; train_gene_expr_recon_loss: 2075403.7392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4060152.8876; train_optim_loss: 4060152.8876; val_kl_reg_loss: 29373.0028; val_edge_recon_loss: 1316653.4480; val_cat_covariates_contrastive_loss: 641474.1881; val_gene_expr_recon_loss: 2136729.3936; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4124230.0297; val_optim_loss: 4124230.0297
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9402; val_auprc_score: 0.9669; val_best_acc_score: 0.9522; val_best_f1_score: 0.9690; train_kl_reg_loss: 30938.8165; train_edge_recon_loss: 1311068.5246; train_cat_covariates_contrastive_loss: 640691.6623; train_gene_expr_recon_loss: 2075142.5832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4057841.5867; train_optim_loss: 4057841.5867; val_kl_reg_loss: 31640.1409; val_edge_recon_loss: 1328011.9691; val_cat_covariates_contrastive_loss: 640013.0223; val_gene_expr_recon_loss: 2139548.4072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4139213.5495; val_optim_loss: 4139213.5495
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9458; val_auprc_score: 0.9700; val_best_acc_score: 0.9539; val_best_f1_score: 0.9701; train_kl_reg_loss: 31298.4584; train_edge_recon_loss: 1314917.3387; train_cat_covariates_contrastive_loss: 640695.9024; train_gene_expr_recon_loss: 2056412.9795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4043324.6805; train_optim_loss: 4043324.6805; val_kl_reg_loss: 30962.2416; val_edge_recon_loss: 1302337.1547; val_cat_covariates_contrastive_loss: 640702.5842; val_gene_expr_recon_loss: 2130943.2673; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4104945.2525; val_optim_loss: 4104945.2525
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9436; val_auprc_score: 0.9694; val_best_acc_score: 0.9546; val_best_f1_score: 0.9706; train_kl_reg_loss: 31366.4586; train_edge_recon_loss: 1311250.0227; train_cat_covariates_contrastive_loss: 640865.2730; train_gene_expr_recon_loss: 2086043.7949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4069525.5507; train_optim_loss: 4069525.5507; val_kl_reg_loss: 31894.1822; val_edge_recon_loss: 1319687.4332; val_cat_covariates_contrastive_loss: 639531.8038; val_gene_expr_recon_loss: 2143721.7215; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4134835.1510; val_optim_loss: 4134835.1510
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9444; val_auprc_score: 0.9704; val_best_acc_score: 0.9544; val_best_f1_score: 0.9705; train_kl_reg_loss: 31739.6581; train_edge_recon_loss: 1310725.1779; train_cat_covariates_contrastive_loss: 641104.4156; train_gene_expr_recon_loss: 2075600.7800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4059170.0277; train_optim_loss: 4059170.0277; val_kl_reg_loss: 33217.5894; val_edge_recon_loss: 1309784.9134; val_cat_covariates_contrastive_loss: 640515.5910; val_gene_expr_recon_loss: 2143682.5829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4127200.6757; val_optim_loss: 4127200.6757
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9457; val_auprc_score: 0.9704; val_best_acc_score: 0.9563; val_best_f1_score: 0.9716; train_kl_reg_loss: 32232.0866; train_edge_recon_loss: 1315695.4443; train_cat_covariates_contrastive_loss: 640947.8862; train_gene_expr_recon_loss: 2058777.7684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4047653.1791; train_optim_loss: 4047653.1791; val_kl_reg_loss: 33161.8525; val_edge_recon_loss: 1314269.9641; val_cat_covariates_contrastive_loss: 638813.9814; val_gene_expr_recon_loss: 2124997.9233; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4111243.7277; val_optim_loss: 4111243.7277
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9454; val_auprc_score: 0.9710; val_best_acc_score: 0.9556; val_best_f1_score: 0.9712; train_kl_reg_loss: 31966.9311; train_edge_recon_loss: 1311577.6423; train_cat_covariates_contrastive_loss: 641107.9182; train_gene_expr_recon_loss: 2069375.9813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4054028.4712; train_optim_loss: 4054028.4712; val_kl_reg_loss: 32701.2351; val_edge_recon_loss: 1316007.3119; val_cat_covariates_contrastive_loss: 640781.7494; val_gene_expr_recon_loss: 2142982.6349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4132472.9381; val_optim_loss: 4132472.9381

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9414; val_auprc_score: 0.9677; val_best_acc_score: 0.9553; val_best_f1_score: 0.9710; train_kl_reg_loss: 31943.7486; train_edge_recon_loss: 1311620.0159; train_cat_covariates_contrastive_loss: 641366.7544; train_gene_expr_recon_loss: 2016181.0986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4001111.6177; train_optim_loss: 4001111.6177; val_kl_reg_loss: 32109.9817; val_edge_recon_loss: 1317583.7772; val_cat_covariates_contrastive_loss: 641322.5668; val_gene_expr_recon_loss: 2105450.5928; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4096466.9356; val_optim_loss: 4096466.9356
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9432; val_auprc_score: 0.9682; val_best_acc_score: 0.9559; val_best_f1_score: 0.9713; train_kl_reg_loss: 32236.3049; train_edge_recon_loss: 1310120.5896; train_cat_covariates_contrastive_loss: 641410.4549; train_gene_expr_recon_loss: 2001440.7799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3985208.1271; train_optim_loss: 3985208.1271; val_kl_reg_loss: 32420.3256; val_edge_recon_loss: 1319687.7017; val_cat_covariates_contrastive_loss: 641435.6157; val_gene_expr_recon_loss: 2102606.9022; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4096150.5569; val_optim_loss: 4096150.5569
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9457; val_auprc_score: 0.9707; val_best_acc_score: 0.9555; val_best_f1_score: 0.9710; train_kl_reg_loss: 32212.3430; train_edge_recon_loss: 1314041.1720; train_cat_covariates_contrastive_loss: 641511.4504; train_gene_expr_recon_loss: 1992994.3945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3980759.3610; train_optim_loss: 3980759.3610; val_kl_reg_loss: 31820.6207; val_edge_recon_loss: 1306977.4734; val_cat_covariates_contrastive_loss: 641843.3447; val_gene_expr_recon_loss: 2098679.9307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4079321.3515; val_optim_loss: 4079321.3515
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9453; val_auprc_score: 0.9698; val_best_acc_score: 0.9560; val_best_f1_score: 0.9713; train_kl_reg_loss: 32208.0135; train_edge_recon_loss: 1313251.4768; train_cat_covariates_contrastive_loss: 641623.6366; train_gene_expr_recon_loss: 1987622.7846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3974705.9103; train_optim_loss: 3974705.9103; val_kl_reg_loss: 32345.7682; val_edge_recon_loss: 1319076.2290; val_cat_covariates_contrastive_loss: 642012.5371; val_gene_expr_recon_loss: 2096272.4802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4089707.0248; val_optim_loss: 4089707.0248
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9432; val_auprc_score: 0.9683; val_best_acc_score: 0.9562; val_best_f1_score: 0.9717; train_kl_reg_loss: 32199.4246; train_edge_recon_loss: 1312996.9257; train_cat_covariates_contrastive_loss: 641254.8662; train_gene_expr_recon_loss: 1984090.0417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3970541.2600; train_optim_loss: 3970541.2600; val_kl_reg_loss: 31848.2318; val_edge_recon_loss: 1310100.2259; val_cat_covariates_contrastive_loss: 641621.6380; val_gene_expr_recon_loss: 2093668.0520; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4077238.1658; val_optim_loss: 4077238.1658
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9427; val_auprc_score: 0.9689; val_best_acc_score: 0.9555; val_best_f1_score: 0.9712; train_kl_reg_loss: 32226.0724; train_edge_recon_loss: 1307567.4314; train_cat_covariates_contrastive_loss: 641391.8884; train_gene_expr_recon_loss: 1979549.7122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3960735.1038; train_optim_loss: 3960735.1038; val_kl_reg_loss: 31934.5032; val_edge_recon_loss: 1309207.9938; val_cat_covariates_contrastive_loss: 641268.6980; val_gene_expr_recon_loss: 2093559.4455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4075970.6485; val_optim_loss: 4075970.6485
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9450; val_auprc_score: 0.9699; val_best_acc_score: 0.9577; val_best_f1_score: 0.9725; train_kl_reg_loss: 32113.7595; train_edge_recon_loss: 1309294.7225; train_cat_covariates_contrastive_loss: 641202.9811; train_gene_expr_recon_loss: 1976273.9942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3958885.4610; train_optim_loss: 3958885.4610; val_kl_reg_loss: 31887.2680; val_edge_recon_loss: 1302281.6720; val_cat_covariates_contrastive_loss: 641291.2469; val_gene_expr_recon_loss: 2096518.8366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4071979.0272; val_optim_loss: 4071979.0272
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9426; val_auprc_score: 0.9686; val_best_acc_score: 0.9537; val_best_f1_score: 0.9697; train_kl_reg_loss: 32129.4495; train_edge_recon_loss: 1312489.6649; train_cat_covariates_contrastive_loss: 641297.8235; train_gene_expr_recon_loss: 1974532.3805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3960449.3148; train_optim_loss: 3960449.3148; val_kl_reg_loss: 31912.3179; val_edge_recon_loss: 1339938.5545; val_cat_covariates_contrastive_loss: 641541.2834; val_gene_expr_recon_loss: 2092039.3527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4105431.5025; val_optim_loss: 4105431.5025
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9462; val_auprc_score: 0.9704; val_best_acc_score: 0.9576; val_best_f1_score: 0.9725; train_kl_reg_loss: 32021.6901; train_edge_recon_loss: 1307200.9279; train_cat_covariates_contrastive_loss: 641526.3940; train_gene_expr_recon_loss: 1970585.4884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3951334.4981; train_optim_loss: 3951334.4981; val_kl_reg_loss: 31768.9161; val_edge_recon_loss: 1309820.4369; val_cat_covariates_contrastive_loss: 640620.1194; val_gene_expr_recon_loss: 2090090.2772; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4072299.7550; val_optim_loss: 4072299.7550
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9458; val_auprc_score: 0.9706; val_best_acc_score: 0.9585; val_best_f1_score: 0.9730; train_kl_reg_loss: 31958.7528; train_edge_recon_loss: 1310135.7272; train_cat_covariates_contrastive_loss: 641446.3947; train_gene_expr_recon_loss: 1968746.6668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3952287.5313; train_optim_loss: 3952287.5313; val_kl_reg_loss: 32240.6257; val_edge_recon_loss: 1301362.1491; val_cat_covariates_contrastive_loss: 640530.8391; val_gene_expr_recon_loss: 2093768.5371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4067902.1559; val_optim_loss: 4067902.1559
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9421; val_auprc_score: 0.9683; val_best_acc_score: 0.9558; val_best_f1_score: 0.9713; train_kl_reg_loss: 31910.2895; train_edge_recon_loss: 1311071.6317; train_cat_covariates_contrastive_loss: 641050.7960; train_gene_expr_recon_loss: 1966836.3612; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3950869.0706; train_optim_loss: 3950869.0706; val_kl_reg_loss: 32100.3330; val_edge_recon_loss: 1310036.4010; val_cat_covariates_contrastive_loss: 640932.8917; val_gene_expr_recon_loss: 2090502.4282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4073572.0520; val_optim_loss: 4073572.0520
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9467; val_auprc_score: 0.9696; val_best_acc_score: 0.9571; val_best_f1_score: 0.9719; train_kl_reg_loss: 31908.1119; train_edge_recon_loss: 1309770.6455; train_cat_covariates_contrastive_loss: 641184.7324; train_gene_expr_recon_loss: 1965930.6498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3948794.1321; train_optim_loss: 3948794.1321; val_kl_reg_loss: 31629.5339; val_edge_recon_loss: 1338146.5099; val_cat_covariates_contrastive_loss: 641078.6374; val_gene_expr_recon_loss: 2092502.1708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4103356.8515; val_optim_loss: 4103356.8515
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9443; val_auprc_score: 0.9685; val_best_acc_score: 0.9571; val_best_f1_score: 0.9721; train_kl_reg_loss: 31697.9788; train_edge_recon_loss: 1311115.1784; train_cat_covariates_contrastive_loss: 641186.8477; train_gene_expr_recon_loss: 1965179.2230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3949179.2309; train_optim_loss: 3949179.2309; val_kl_reg_loss: 31625.1485; val_edge_recon_loss: 1314380.7351; val_cat_covariates_contrastive_loss: 641402.5798; val_gene_expr_recon_loss: 2092844.1485; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4080252.6114; val_optim_loss: 4080252.6114
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9480; val_auprc_score: 0.9709; val_best_acc_score: 0.9577; val_best_f1_score: 0.9724; train_kl_reg_loss: 31574.4123; train_edge_recon_loss: 1308730.3909; train_cat_covariates_contrastive_loss: 641142.8223; train_gene_expr_recon_loss: 1961848.2323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3943295.8591; train_optim_loss: 3943295.8591; val_kl_reg_loss: 31102.0457; val_edge_recon_loss: 1312701.0223; val_cat_covariates_contrastive_loss: 641167.3212; val_gene_expr_recon_loss: 2093331.3923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4078301.7871; val_optim_loss: 4078301.7871

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9455; val_auprc_score: 0.9698; val_best_acc_score: 0.9570; val_best_f1_score: 0.9721; train_kl_reg_loss: 31326.1784; train_edge_recon_loss: 1309534.0021; train_cat_covariates_contrastive_loss: 641104.1582; train_gene_expr_recon_loss: 1955418.7279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3937383.0695; train_optim_loss: 3937383.0695; val_kl_reg_loss: 31572.1206; val_edge_recon_loss: 1306813.3651; val_cat_covariates_contrastive_loss: 641511.5978; val_gene_expr_recon_loss: 2091273.1844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4071170.2673; val_optim_loss: 4071170.2673
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9490; val_auprc_score: 0.9716; val_best_acc_score: 0.9583; val_best_f1_score: 0.9729; train_kl_reg_loss: 31459.6844; train_edge_recon_loss: 1309418.7580; train_cat_covariates_contrastive_loss: 641318.7407; train_gene_expr_recon_loss: 1955281.5511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3937478.7350; train_optim_loss: 3937478.7350; val_kl_reg_loss: 31583.1425; val_edge_recon_loss: 1300830.7587; val_cat_covariates_contrastive_loss: 640747.1671; val_gene_expr_recon_loss: 2094770.7995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4067931.8614; val_optim_loss: 4067931.8614
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9450; val_auprc_score: 0.9698; val_best_acc_score: 0.9568; val_best_f1_score: 0.9719; train_kl_reg_loss: 31523.7492; train_edge_recon_loss: 1310957.0550; train_cat_covariates_contrastive_loss: 640893.5813; train_gene_expr_recon_loss: 1955757.4063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3939131.7901; train_optim_loss: 3939131.7901; val_kl_reg_loss: 31731.6005; val_edge_recon_loss: 1304236.3639; val_cat_covariates_contrastive_loss: 640850.6058; val_gene_expr_recon_loss: 2091577.7871; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4068396.3614; val_optim_loss: 4068396.3614
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9410; val_auprc_score: 0.9676; val_best_acc_score: 0.9548; val_best_f1_score: 0.9706; train_kl_reg_loss: 31537.6675; train_edge_recon_loss: 1304866.5914; train_cat_covariates_contrastive_loss: 640843.7333; train_gene_expr_recon_loss: 1954124.1693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3931372.1595; train_optim_loss: 3931372.1595; val_kl_reg_loss: 31586.0147; val_edge_recon_loss: 1319677.0990; val_cat_covariates_contrastive_loss: 640201.3886; val_gene_expr_recon_loss: 2090068.2178; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4081532.6931; val_optim_loss: 4081532.6931

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 320 min 53 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
val AUROC score: 0.9324
val AUPRC score: 0.9606
val best accuracy score: 0.9529
val best F1 score: 0.9693
val target rna MSE score: 1.6953
val source rna MSE score: 0.0651
Val cat covariate0 mean sim diff: 0.0024
Val cat covariate1 mean sim diff: -0.0962
Duration of model training in run 7: 5 hours, 22 minutes and 48 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 25413
Number of validation nodes: 2824
Number of training edges: 174662
Number of validation edges: 19406
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9333; val_auprc_score: 0.9704; val_best_acc_score: 0.9113; val_best_f1_score: 0.9431; train_kl_reg_loss: 12948.1745; train_edge_recon_loss: 1439534.2430; train_cat_covariates_contrastive_loss: 640451.4281; train_gene_expr_recon_loss: 3154922.2240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5247856.0666; train_optim_loss: 5247856.0666; val_kl_reg_loss: 11416.1496; val_edge_recon_loss: 1355445.9276; val_cat_covariates_contrastive_loss: 632793.2410; val_gene_expr_recon_loss: 2922224.6020; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4921879.9145; val_optim_loss: 4921879.9145
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9410; val_auprc_score: 0.9719; val_best_acc_score: 0.9290; val_best_f1_score: 0.9543; train_kl_reg_loss: 11312.8976; train_edge_recon_loss: 1333732.0657; train_cat_covariates_contrastive_loss: 633250.6607; train_gene_expr_recon_loss: 2873216.1098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4851511.7416; train_optim_loss: 4851511.7416; val_kl_reg_loss: 11582.9444; val_edge_recon_loss: 1335275.2961; val_cat_covariates_contrastive_loss: 632453.7401; val_gene_expr_recon_loss: 2770505.2961; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4749817.2763; val_optim_loss: 4749817.2763
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9377; val_auprc_score: 0.9697; val_best_acc_score: 0.9375; val_best_f1_score: 0.9600; train_kl_reg_loss: 11736.4872; train_edge_recon_loss: 1331660.6805; train_cat_covariates_contrastive_loss: 633173.2728; train_gene_expr_recon_loss: 2759408.4191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4735978.8598; train_optim_loss: 4735978.8598; val_kl_reg_loss: 11827.0124; val_edge_recon_loss: 1314993.7763; val_cat_covariates_contrastive_loss: 633351.4062; val_gene_expr_recon_loss: 2676043.4046; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4636215.6053; val_optim_loss: 4636215.6053
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9373; val_auprc_score: 0.9687; val_best_acc_score: 0.9396; val_best_f1_score: 0.9611; train_kl_reg_loss: 12720.7326; train_edge_recon_loss: 1324896.2383; train_cat_covariates_contrastive_loss: 634136.7579; train_gene_expr_recon_loss: 2669764.4542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4641518.1772; train_optim_loss: 4641518.1772; val_kl_reg_loss: 13457.1620; val_edge_recon_loss: 1324291.6752; val_cat_covariates_contrastive_loss: 633985.9186; val_gene_expr_recon_loss: 2615355.5559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4587090.3092; val_optim_loss: 4587090.3092
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9431; val_auprc_score: 0.9699; val_best_acc_score: 0.9465; val_best_f1_score: 0.9654; train_kl_reg_loss: 14502.9341; train_edge_recon_loss: 1319602.6259; train_cat_covariates_contrastive_loss: 635099.6541; train_gene_expr_recon_loss: 2563702.6362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4532907.8646; train_optim_loss: 4532907.8646; val_kl_reg_loss: 15636.2601; val_edge_recon_loss: 1327420.8372; val_cat_covariates_contrastive_loss: 635523.0715; val_gene_expr_recon_loss: 2495091.2533; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4473671.4243; val_optim_loss: 4473671.4243
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9467; val_auprc_score: 0.9736; val_best_acc_score: 0.9421; val_best_f1_score: 0.9626; train_kl_reg_loss: 16757.3344; train_edge_recon_loss: 1314791.0685; train_cat_covariates_contrastive_loss: 636365.9582; train_gene_expr_recon_loss: 2462763.4568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4430677.8166; train_optim_loss: 4430677.8166; val_kl_reg_loss: 18047.8984; val_edge_recon_loss: 1325361.0666; val_cat_covariates_contrastive_loss: 636885.8972; val_gene_expr_recon_loss: 2398710.3717; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4379005.2336; val_optim_loss: 4379005.2336
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9319; val_auprc_score: 0.9644; val_best_acc_score: 0.9420; val_best_f1_score: 0.9627; train_kl_reg_loss: 18681.5156; train_edge_recon_loss: 1309546.3288; train_cat_covariates_contrastive_loss: 636468.8984; train_gene_expr_recon_loss: 2378580.3016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4343277.0428; train_optim_loss: 4343277.0428; val_kl_reg_loss: 20346.3631; val_edge_recon_loss: 1322049.0493; val_cat_covariates_contrastive_loss: 635908.2887; val_gene_expr_recon_loss: 2341407.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4319711.2105; val_optim_loss: 4319711.2105
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9417; val_auprc_score: 0.9704; val_best_acc_score: 0.9457; val_best_f1_score: 0.9651; train_kl_reg_loss: 20317.1969; train_edge_recon_loss: 1327419.6773; train_cat_covariates_contrastive_loss: 637502.4259; train_gene_expr_recon_loss: 2317287.3122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4302526.6072; train_optim_loss: 4302526.6072; val_kl_reg_loss: 21173.2992; val_edge_recon_loss: 1311276.2878; val_cat_covariates_contrastive_loss: 636466.7262; val_gene_expr_recon_loss: 2289445.6990; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4258362.0099; val_optim_loss: 4258362.0099
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9422; val_auprc_score: 0.9708; val_best_acc_score: 0.9450; val_best_f1_score: 0.9646; train_kl_reg_loss: 21366.8871; train_edge_recon_loss: 1320234.4914; train_cat_covariates_contrastive_loss: 637351.0819; train_gene_expr_recon_loss: 2267554.5042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4246506.9616; train_optim_loss: 4246506.9616; val_kl_reg_loss: 22300.6747; val_edge_recon_loss: 1315919.4918; val_cat_covariates_contrastive_loss: 637169.1480; val_gene_expr_recon_loss: 2248641.5329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4224030.8684; val_optim_loss: 4224030.8684
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9432; val_auprc_score: 0.9708; val_best_acc_score: 0.9461; val_best_f1_score: 0.9651; train_kl_reg_loss: 22434.8424; train_edge_recon_loss: 1320979.8699; train_cat_covariates_contrastive_loss: 637884.3461; train_gene_expr_recon_loss: 2226192.4621; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4207491.5179; train_optim_loss: 4207491.5179; val_kl_reg_loss: 23480.7448; val_edge_recon_loss: 1326923.0000; val_cat_covariates_contrastive_loss: 636626.9992; val_gene_expr_recon_loss: 2224079.6891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4211110.4178; val_optim_loss: 4211110.4178
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9408; val_auprc_score: 0.9680; val_best_acc_score: 0.9493; val_best_f1_score: 0.9672; train_kl_reg_loss: 23120.0181; train_edge_recon_loss: 1315508.9690; train_cat_covariates_contrastive_loss: 637735.2120; train_gene_expr_recon_loss: 2203178.9974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4179543.1918; train_optim_loss: 4179543.1918; val_kl_reg_loss: 24375.5589; val_edge_recon_loss: 1321971.2015; val_cat_covariates_contrastive_loss: 637107.7706; val_gene_expr_recon_loss: 2207976.7286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4191431.2730; val_optim_loss: 4191431.2730
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9348; val_auprc_score: 0.9635; val_best_acc_score: 0.9464; val_best_f1_score: 0.9653; train_kl_reg_loss: 23736.3069; train_edge_recon_loss: 1313094.1052; train_cat_covariates_contrastive_loss: 638569.4886; train_gene_expr_recon_loss: 2171126.8726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4146526.7734; train_optim_loss: 4146526.7734; val_kl_reg_loss: 25458.7311; val_edge_recon_loss: 1341206.8750; val_cat_covariates_contrastive_loss: 636607.0066; val_gene_expr_recon_loss: 2182842.6941; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4186115.3125; val_optim_loss: 4186115.3125
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9389; val_auprc_score: 0.9683; val_best_acc_score: 0.9484; val_best_f1_score: 0.9667; train_kl_reg_loss: 24432.9034; train_edge_recon_loss: 1321871.7489; train_cat_covariates_contrastive_loss: 638116.5017; train_gene_expr_recon_loss: 2154958.3920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4139379.5520; train_optim_loss: 4139379.5520; val_kl_reg_loss: 25469.7036; val_edge_recon_loss: 1315508.5263; val_cat_covariates_contrastive_loss: 637447.8495; val_gene_expr_recon_loss: 2168350.9951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4146777.0559; val_optim_loss: 4146777.0559
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9427; val_auprc_score: 0.9694; val_best_acc_score: 0.9496; val_best_f1_score: 0.9674; train_kl_reg_loss: 24739.8911; train_edge_recon_loss: 1317670.0858; train_cat_covariates_contrastive_loss: 638294.9089; train_gene_expr_recon_loss: 2139395.4471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4120100.3276; train_optim_loss: 4120100.3276; val_kl_reg_loss: 25175.0983; val_edge_recon_loss: 1326727.8898; val_cat_covariates_contrastive_loss: 637569.4663; val_gene_expr_recon_loss: 2175030.1349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4164502.5954; val_optim_loss: 4164502.5954
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9416; val_auprc_score: 0.9686; val_best_acc_score: 0.9495; val_best_f1_score: 0.9673; train_kl_reg_loss: 24977.7449; train_edge_recon_loss: 1316393.4055; train_cat_covariates_contrastive_loss: 638591.1639; train_gene_expr_recon_loss: 2139560.0529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4119522.3686; train_optim_loss: 4119522.3686; val_kl_reg_loss: 25930.8448; val_edge_recon_loss: 1316798.8882; val_cat_covariates_contrastive_loss: 637152.5510; val_gene_expr_recon_loss: 2192285.5543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4172167.8322; val_optim_loss: 4172167.8322
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9434; val_auprc_score: 0.9694; val_best_acc_score: 0.9488; val_best_f1_score: 0.9669; train_kl_reg_loss: 26015.0679; train_edge_recon_loss: 1316155.2466; train_cat_covariates_contrastive_loss: 638663.2318; train_gene_expr_recon_loss: 2122059.1049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4102892.6578; train_optim_loss: 4102892.6578; val_kl_reg_loss: 26414.5298; val_edge_recon_loss: 1323078.6020; val_cat_covariates_contrastive_loss: 638673.5683; val_gene_expr_recon_loss: 2153887.3257; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4142054.0493; val_optim_loss: 4142054.0493
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9402; val_auprc_score: 0.9687; val_best_acc_score: 0.9484; val_best_f1_score: 0.9667; train_kl_reg_loss: 26173.5695; train_edge_recon_loss: 1314479.1870; train_cat_covariates_contrastive_loss: 638989.0584; train_gene_expr_recon_loss: 2112867.5029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4092509.3111; train_optim_loss: 4092509.3111; val_kl_reg_loss: 27764.1245; val_edge_recon_loss: 1319654.4079; val_cat_covariates_contrastive_loss: 637348.5625; val_gene_expr_recon_loss: 2154942.6908; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4139709.7862; val_optim_loss: 4139709.7862
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9437; val_auprc_score: 0.9702; val_best_acc_score: 0.9515; val_best_f1_score: 0.9687; train_kl_reg_loss: 26551.0949; train_edge_recon_loss: 1325025.9131; train_cat_covariates_contrastive_loss: 639116.6975; train_gene_expr_recon_loss: 2086359.7699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4077053.4832; train_optim_loss: 4077053.4832; val_kl_reg_loss: 26795.3729; val_edge_recon_loss: 1301668.5082; val_cat_covariates_contrastive_loss: 638434.2171; val_gene_expr_recon_loss: 2141507.8470; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4108405.9408; val_optim_loss: 4108405.9408
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9445; val_auprc_score: 0.9701; val_best_acc_score: 0.9502; val_best_f1_score: 0.9677; train_kl_reg_loss: 26668.4385; train_edge_recon_loss: 1307333.4899; train_cat_covariates_contrastive_loss: 638853.9846; train_gene_expr_recon_loss: 2097107.3269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4069963.2401; train_optim_loss: 4069963.2401; val_kl_reg_loss: 26906.3549; val_edge_recon_loss: 1336287.6562; val_cat_covariates_contrastive_loss: 639748.6258; val_gene_expr_recon_loss: 2137133.1447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4140075.7664; val_optim_loss: 4140075.7664
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9452; val_auprc_score: 0.9715; val_best_acc_score: 0.9500; val_best_f1_score: 0.9677; train_kl_reg_loss: 27086.8501; train_edge_recon_loss: 1318763.5814; train_cat_covariates_contrastive_loss: 638985.7266; train_gene_expr_recon_loss: 2078051.5386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4062887.6988; train_optim_loss: 4062887.6988; val_kl_reg_loss: 26011.9446; val_edge_recon_loss: 1316441.0148; val_cat_covariates_contrastive_loss: 639253.5863; val_gene_expr_recon_loss: 2148095.2599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4129801.8125; val_optim_loss: 4129801.8125
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9414; val_auprc_score: 0.9683; val_best_acc_score: 0.9504; val_best_f1_score: 0.9679; train_kl_reg_loss: 27171.3531; train_edge_recon_loss: 1307383.5866; train_cat_covariates_contrastive_loss: 639136.1417; train_gene_expr_recon_loss: 2083328.6858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4057019.7690; train_optim_loss: 4057019.7690; val_kl_reg_loss: 28363.8823; val_edge_recon_loss: 1325703.2434; val_cat_covariates_contrastive_loss: 638810.0954; val_gene_expr_recon_loss: 2128040.8289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4120918.0592; val_optim_loss: 4120918.0592
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9434; val_auprc_score: 0.9697; val_best_acc_score: 0.9526; val_best_f1_score: 0.9695; train_kl_reg_loss: 27662.1756; train_edge_recon_loss: 1323875.7960; train_cat_covariates_contrastive_loss: 639194.5921; train_gene_expr_recon_loss: 2072286.4037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4063018.9693; train_optim_loss: 4063018.9693; val_kl_reg_loss: 28849.4150; val_edge_recon_loss: 1292152.4408; val_cat_covariates_contrastive_loss: 637930.0296; val_gene_expr_recon_loss: 2129605.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4088537.2237; val_optim_loss: 4088537.2237
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9430; val_auprc_score: 0.9701; val_best_acc_score: 0.9502; val_best_f1_score: 0.9678; train_kl_reg_loss: 27839.5521; train_edge_recon_loss: 1316157.2952; train_cat_covariates_contrastive_loss: 639385.3491; train_gene_expr_recon_loss: 2050770.4100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4034152.6021; train_optim_loss: 4034152.6021; val_kl_reg_loss: 26910.9884; val_edge_recon_loss: 1321566.0510; val_cat_covariates_contrastive_loss: 640477.3232; val_gene_expr_recon_loss: 2116317.6842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4105272.0789; val_optim_loss: 4105272.0789
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9420; val_auprc_score: 0.9695; val_best_acc_score: 0.9494; val_best_f1_score: 0.9672; train_kl_reg_loss: 27757.6402; train_edge_recon_loss: 1317439.5986; train_cat_covariates_contrastive_loss: 639319.6984; train_gene_expr_recon_loss: 2072780.8441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4057297.7734; train_optim_loss: 4057297.7734; val_kl_reg_loss: 27440.6764; val_edge_recon_loss: 1327990.6793; val_cat_covariates_contrastive_loss: 640367.3701; val_gene_expr_recon_loss: 2129706.0099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4125504.7500; val_optim_loss: 4125504.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9400; val_auprc_score: 0.9673; val_best_acc_score: 0.9507; val_best_f1_score: 0.9681; train_kl_reg_loss: 28622.6956; train_edge_recon_loss: 1309482.8574; train_cat_covariates_contrastive_loss: 639666.5429; train_gene_expr_recon_loss: 2053996.8809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4031768.9777; train_optim_loss: 4031768.9777; val_kl_reg_loss: 28208.0710; val_edge_recon_loss: 1322030.0197; val_cat_covariates_contrastive_loss: 640588.4416; val_gene_expr_recon_loss: 2122838.3766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4113664.9112; val_optim_loss: 4113664.9112
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9502; val_auprc_score: 0.9731; val_best_acc_score: 0.9542; val_best_f1_score: 0.9702; train_kl_reg_loss: 28453.4413; train_edge_recon_loss: 1310743.7068; train_cat_covariates_contrastive_loss: 639610.1825; train_gene_expr_recon_loss: 2061962.3106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4040769.6402; train_optim_loss: 4040769.6402; val_kl_reg_loss: 28786.7886; val_edge_recon_loss: 1309761.7582; val_cat_covariates_contrastive_loss: 639331.8076; val_gene_expr_recon_loss: 2148570.0510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4126450.4079; val_optim_loss: 4126450.4079

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9465; val_auprc_score: 0.9714; val_best_acc_score: 0.9538; val_best_f1_score: 0.9700; train_kl_reg_loss: 28247.9044; train_edge_recon_loss: 1312683.9186; train_cat_covariates_contrastive_loss: 639592.8489; train_gene_expr_recon_loss: 2009239.1087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3989763.7840; train_optim_loss: 3989763.7840; val_kl_reg_loss: 28395.0365; val_edge_recon_loss: 1303966.6242; val_cat_covariates_contrastive_loss: 639754.6324; val_gene_expr_recon_loss: 2102846.2105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4074962.5197; val_optim_loss: 4074962.5197
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9445; val_auprc_score: 0.9686; val_best_acc_score: 0.9519; val_best_f1_score: 0.9687; train_kl_reg_loss: 28568.4511; train_edge_recon_loss: 1316388.1774; train_cat_covariates_contrastive_loss: 639937.5351; train_gene_expr_recon_loss: 1999750.4231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3984644.5842; train_optim_loss: 3984644.5842; val_kl_reg_loss: 28200.6197; val_edge_recon_loss: 1326154.3635; val_cat_covariates_contrastive_loss: 640443.1620; val_gene_expr_recon_loss: 2103433.1743; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4098231.3158; val_optim_loss: 4098231.3158
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9464; val_auprc_score: 0.9711; val_best_acc_score: 0.9553; val_best_f1_score: 0.9711; train_kl_reg_loss: 28523.3788; train_edge_recon_loss: 1313519.4327; train_cat_covariates_contrastive_loss: 639813.6055; train_gene_expr_recon_loss: 1991852.8918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3973709.3031; train_optim_loss: 3973709.3031; val_kl_reg_loss: 28941.6362; val_edge_recon_loss: 1293275.4729; val_cat_covariates_contrastive_loss: 640109.8363; val_gene_expr_recon_loss: 2087098.0230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4049424.9671; val_optim_loss: 4049424.9671
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9424; val_auprc_score: 0.9695; val_best_acc_score: 0.9518; val_best_f1_score: 0.9687; train_kl_reg_loss: 28561.5801; train_edge_recon_loss: 1308416.2939; train_cat_covariates_contrastive_loss: 639734.6506; train_gene_expr_recon_loss: 1987587.1966; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3964299.7273; train_optim_loss: 3964299.7273; val_kl_reg_loss: 28525.9720; val_edge_recon_loss: 1319219.9868; val_cat_covariates_contrastive_loss: 639170.7262; val_gene_expr_recon_loss: 2086504.3914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4073421.0921; val_optim_loss: 4073421.0921
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9442; val_auprc_score: 0.9697; val_best_acc_score: 0.9544; val_best_f1_score: 0.9704; train_kl_reg_loss: 28561.5105; train_edge_recon_loss: 1317005.0869; train_cat_covariates_contrastive_loss: 639799.9429; train_gene_expr_recon_loss: 1981592.5763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3966959.1226; train_optim_loss: 3966959.1226; val_kl_reg_loss: 28733.3550; val_edge_recon_loss: 1308337.1924; val_cat_covariates_contrastive_loss: 639782.3701; val_gene_expr_recon_loss: 2089136.3191; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4065989.2270; val_optim_loss: 4065989.2270
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9413; val_auprc_score: 0.9684; val_best_acc_score: 0.9522; val_best_f1_score: 0.9690; train_kl_reg_loss: 28534.1645; train_edge_recon_loss: 1304605.5689; train_cat_covariates_contrastive_loss: 639543.9346; train_gene_expr_recon_loss: 1980736.0220; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3953419.6830; train_optim_loss: 3953419.6830; val_kl_reg_loss: 28738.6683; val_edge_recon_loss: 1323558.5329; val_cat_covariates_contrastive_loss: 639826.2385; val_gene_expr_recon_loss: 2089775.7582; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4081899.1513; val_optim_loss: 4081899.1513
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9391; val_auprc_score: 0.9662; val_best_acc_score: 0.9532; val_best_f1_score: 0.9695; train_kl_reg_loss: 28399.0604; train_edge_recon_loss: 1310128.7348; train_cat_covariates_contrastive_loss: 639519.0319; train_gene_expr_recon_loss: 1977084.0840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3955130.9085; train_optim_loss: 3955130.9085; val_kl_reg_loss: 28279.3073; val_edge_recon_loss: 1328807.6151; val_cat_covariates_contrastive_loss: 640048.0707; val_gene_expr_recon_loss: 2092843.5526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4089978.5428; val_optim_loss: 4089978.5428

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9436; val_auprc_score: 0.9676; val_best_acc_score: 0.9527; val_best_f1_score: 0.9692; train_kl_reg_loss: 28350.2572; train_edge_recon_loss: 1307533.2020; train_cat_covariates_contrastive_loss: 639843.4776; train_gene_expr_recon_loss: 1968959.8230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3944686.7555; train_optim_loss: 3944686.7555; val_kl_reg_loss: 28539.5901; val_edge_recon_loss: 1333240.4589; val_cat_covariates_contrastive_loss: 639961.6842; val_gene_expr_recon_loss: 2080958.1102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4082699.8454; val_optim_loss: 4082699.8454
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9399; val_auprc_score: 0.9675; val_best_acc_score: 0.9536; val_best_f1_score: 0.9701; train_kl_reg_loss: 28429.7131; train_edge_recon_loss: 1311948.0224; train_cat_covariates_contrastive_loss: 639868.1911; train_gene_expr_recon_loss: 1971185.3552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3951431.2753; train_optim_loss: 3951431.2753; val_kl_reg_loss: 28644.4294; val_edge_recon_loss: 1301204.6053; val_cat_covariates_contrastive_loss: 639367.4819; val_gene_expr_recon_loss: 2089104.7451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4058321.2533; val_optim_loss: 4058321.2533
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9441; val_auprc_score: 0.9696; val_best_acc_score: 0.9554; val_best_f1_score: 0.9711; train_kl_reg_loss: 28346.5994; train_edge_recon_loss: 1306674.7252; train_cat_covariates_contrastive_loss: 639942.0759; train_gene_expr_recon_loss: 1968981.7059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3943945.1025; train_optim_loss: 3943945.1025; val_kl_reg_loss: 28551.0188; val_edge_recon_loss: 1309492.5288; val_cat_covariates_contrastive_loss: 640517.1365; val_gene_expr_recon_loss: 2088697.4737; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4067258.1480; val_optim_loss: 4067258.1480
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9461; val_auprc_score: 0.9709; val_best_acc_score: 0.9557; val_best_f1_score: 0.9713; train_kl_reg_loss: 28445.3590; train_edge_recon_loss: 1309388.0755; train_cat_covariates_contrastive_loss: 639747.9851; train_gene_expr_recon_loss: 1970389.3765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3947970.8020; train_optim_loss: 3947970.8020; val_kl_reg_loss: 28477.8931; val_edge_recon_loss: 1299118.0535; val_cat_covariates_contrastive_loss: 639494.1768; val_gene_expr_recon_loss: 2083966.4852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4051056.5987; val_optim_loss: 4051056.5987

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 145 min 56 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
val AUROC score: 0.9284
val AUPRC score: 0.9599
val best accuracy score: 0.9478
val best F1 score: 0.9660
val target rna MSE score: 1.3958
val source rna MSE score: 0.0720
Val cat covariate0 mean sim diff: -0.0011
Val cat covariate1 mean sim diff: -0.0984
Duration of model training in run 6: 2 hours, 27 minutes and 14 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 25413
Number of validation nodes: 2824
Number of training edges: 174662
Number of validation edges: 19406
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9175; val_auprc_score: 0.9650; val_best_acc_score: 0.8954; val_best_f1_score: 0.9336; train_kl_reg_loss: 15875.4568; train_edge_recon_loss: 1470654.9910; train_cat_covariates_contrastive_loss: 642865.8650; train_gene_expr_recon_loss: 3138738.2163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5268134.5307; train_optim_loss: 5268134.5307; val_kl_reg_loss: 13560.8874; val_edge_recon_loss: 1380719.7130; val_cat_covariates_contrastive_loss: 634422.3462; val_gene_expr_recon_loss: 2905322.6382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4934025.5724; val_optim_loss: 4934025.5724
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9347; val_auprc_score: 0.9701; val_best_acc_score: 0.9243; val_best_f1_score: 0.9514; train_kl_reg_loss: 12762.1736; train_edge_recon_loss: 1348561.0043; train_cat_covariates_contrastive_loss: 636057.3644; train_gene_expr_recon_loss: 2843801.7910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4841182.3309; train_optim_loss: 4841182.3309; val_kl_reg_loss: 12630.6168; val_edge_recon_loss: 1334622.2549; val_cat_covariates_contrastive_loss: 635189.5666; val_gene_expr_recon_loss: 2763923.8586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4746366.3026; val_optim_loss: 4746366.3026
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9379; val_auprc_score: 0.9704; val_best_acc_score: 0.9333; val_best_f1_score: 0.9575; train_kl_reg_loss: 13034.3300; train_edge_recon_loss: 1329328.8761; train_cat_covariates_contrastive_loss: 634498.5608; train_gene_expr_recon_loss: 2736763.0278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4713624.8049; train_optim_loss: 4713624.8049; val_kl_reg_loss: 12852.2005; val_edge_recon_loss: 1316406.3240; val_cat_covariates_contrastive_loss: 636047.7878; val_gene_expr_recon_loss: 2681887.9243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4647194.2434; val_optim_loss: 4647194.2434
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9381; val_auprc_score: 0.9692; val_best_acc_score: 0.9361; val_best_f1_score: 0.9589; train_kl_reg_loss: 13550.0604; train_edge_recon_loss: 1332124.4230; train_cat_covariates_contrastive_loss: 634727.5173; train_gene_expr_recon_loss: 2653339.1665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4633741.1713; train_optim_loss: 4633741.1713; val_kl_reg_loss: 13759.3456; val_edge_recon_loss: 1328697.3873; val_cat_covariates_contrastive_loss: 634770.0271; val_gene_expr_recon_loss: 2596002.9638; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4573229.7434; val_optim_loss: 4573229.7434
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9396; val_auprc_score: 0.9684; val_best_acc_score: 0.9403; val_best_f1_score: 0.9615; train_kl_reg_loss: 14796.4391; train_edge_recon_loss: 1322135.3115; train_cat_covariates_contrastive_loss: 635267.3522; train_gene_expr_recon_loss: 2555725.3183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4527924.4231; train_optim_loss: 4527924.4231; val_kl_reg_loss: 16098.9714; val_edge_recon_loss: 1340798.6135; val_cat_covariates_contrastive_loss: 634727.1308; val_gene_expr_recon_loss: 2503417.5395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4495042.2566; val_optim_loss: 4495042.2566
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9413; val_auprc_score: 0.9693; val_best_acc_score: 0.9425; val_best_f1_score: 0.9627; train_kl_reg_loss: 16536.5063; train_edge_recon_loss: 1324852.9983; train_cat_covariates_contrastive_loss: 636353.5082; train_gene_expr_recon_loss: 2463669.9583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4441412.9758; train_optim_loss: 4441412.9758; val_kl_reg_loss: 17743.5609; val_edge_recon_loss: 1330435.6809; val_cat_covariates_contrastive_loss: 637793.3446; val_gene_expr_recon_loss: 2421222.0493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4407194.6250; val_optim_loss: 4407194.6250
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9428; val_auprc_score: 0.9707; val_best_acc_score: 0.9426; val_best_f1_score: 0.9631; train_kl_reg_loss: 18223.0431; train_edge_recon_loss: 1316875.3621; train_cat_covariates_contrastive_loss: 636896.9289; train_gene_expr_recon_loss: 2384194.9447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4356190.2873; train_optim_loss: 4356190.2873; val_kl_reg_loss: 18022.0564; val_edge_recon_loss: 1328586.5312; val_cat_covariates_contrastive_loss: 638726.6217; val_gene_expr_recon_loss: 2351182.0428; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4336517.2434; val_optim_loss: 4336517.2434
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9432; val_auprc_score: 0.9711; val_best_acc_score: 0.9433; val_best_f1_score: 0.9634; train_kl_reg_loss: 19665.6789; train_edge_recon_loss: 1312337.6486; train_cat_covariates_contrastive_loss: 637145.8217; train_gene_expr_recon_loss: 2325699.8538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4294848.9956; train_optim_loss: 4294848.9956; val_kl_reg_loss: 20657.7003; val_edge_recon_loss: 1328675.2812; val_cat_covariates_contrastive_loss: 636848.4342; val_gene_expr_recon_loss: 2313253.6612; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4299435.0822; val_optim_loss: 4299435.0822
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9428; val_auprc_score: 0.9704; val_best_acc_score: 0.9455; val_best_f1_score: 0.9647; train_kl_reg_loss: 20897.9094; train_edge_recon_loss: 1319529.7911; train_cat_covariates_contrastive_loss: 637743.0418; train_gene_expr_recon_loss: 2277638.4394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4255809.1794; train_optim_loss: 4255809.1794; val_kl_reg_loss: 21688.1907; val_edge_recon_loss: 1329443.3569; val_cat_covariates_contrastive_loss: 640099.9860; val_gene_expr_recon_loss: 2274936.4457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4266167.9836; val_optim_loss: 4266167.9836
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9428; val_auprc_score: 0.9696; val_best_acc_score: 0.9484; val_best_f1_score: 0.9667; train_kl_reg_loss: 22124.1187; train_edge_recon_loss: 1313076.6700; train_cat_covariates_contrastive_loss: 637692.6917; train_gene_expr_recon_loss: 2237468.3033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4210361.7789; train_optim_loss: 4210361.7789; val_kl_reg_loss: 22979.0741; val_edge_recon_loss: 1315210.8553; val_cat_covariates_contrastive_loss: 636468.4145; val_gene_expr_recon_loss: 2235175.0049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4209833.3322; val_optim_loss: 4209833.3322
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9426; val_auprc_score: 0.9687; val_best_acc_score: 0.9478; val_best_f1_score: 0.9661; train_kl_reg_loss: 22827.7751; train_edge_recon_loss: 1312792.6516; train_cat_covariates_contrastive_loss: 637940.6162; train_gene_expr_recon_loss: 2208361.6089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4181922.6457; train_optim_loss: 4181922.6457; val_kl_reg_loss: 23077.5823; val_edge_recon_loss: 1335943.5477; val_cat_covariates_contrastive_loss: 638579.3413; val_gene_expr_recon_loss: 2224130.1530; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4221730.6217; val_optim_loss: 4221730.6217
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9403; val_auprc_score: 0.9681; val_best_acc_score: 0.9481; val_best_f1_score: 0.9665; train_kl_reg_loss: 23647.3841; train_edge_recon_loss: 1314790.0020; train_cat_covariates_contrastive_loss: 638172.1057; train_gene_expr_recon_loss: 2182423.5265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4159033.0231; train_optim_loss: 4159033.0231; val_kl_reg_loss: 24131.7121; val_edge_recon_loss: 1309874.9285; val_cat_covariates_contrastive_loss: 638172.8215; val_gene_expr_recon_loss: 2192979.7615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4165159.2368; val_optim_loss: 4165159.2368
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9372; val_auprc_score: 0.9667; val_best_acc_score: 0.9493; val_best_f1_score: 0.9672; train_kl_reg_loss: 24106.1109; train_edge_recon_loss: 1312187.0079; train_cat_covariates_contrastive_loss: 638450.2719; train_gene_expr_recon_loss: 2168850.2242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4143593.6179; train_optim_loss: 4143593.6179; val_kl_reg_loss: 24859.8987; val_edge_recon_loss: 1336359.7747; val_cat_covariates_contrastive_loss: 637783.7870; val_gene_expr_recon_loss: 2188321.7237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4187325.1941; val_optim_loss: 4187325.1941
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9447; val_auprc_score: 0.9705; val_best_acc_score: 0.9489; val_best_f1_score: 0.9670; train_kl_reg_loss: 24690.8237; train_edge_recon_loss: 1317704.6104; train_cat_covariates_contrastive_loss: 638470.2755; train_gene_expr_recon_loss: 2136448.7562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4117314.4660; train_optim_loss: 4117314.4660; val_kl_reg_loss: 24117.3457; val_edge_recon_loss: 1313128.4507; val_cat_covariates_contrastive_loss: 639246.3257; val_gene_expr_recon_loss: 2181253.7237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4157745.8520; val_optim_loss: 4157745.8520
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9417; val_auprc_score: 0.9679; val_best_acc_score: 0.9491; val_best_f1_score: 0.9669; train_kl_reg_loss: 25086.6554; train_edge_recon_loss: 1313278.3979; train_cat_covariates_contrastive_loss: 638477.2128; train_gene_expr_recon_loss: 2150130.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4126972.4370; train_optim_loss: 4126972.4370; val_kl_reg_loss: 26459.6692; val_edge_recon_loss: 1317548.4095; val_cat_covariates_contrastive_loss: 638170.7533; val_gene_expr_recon_loss: 2188070.2237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4170249.0658; val_optim_loss: 4170249.0658
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9422; val_auprc_score: 0.9678; val_best_acc_score: 0.9484; val_best_f1_score: 0.9665; train_kl_reg_loss: 25693.8251; train_edge_recon_loss: 1319316.8450; train_cat_covariates_contrastive_loss: 638510.3339; train_gene_expr_recon_loss: 2124091.4052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4107612.4074; train_optim_loss: 4107612.4074; val_kl_reg_loss: 26021.9604; val_edge_recon_loss: 1313060.7780; val_cat_covariates_contrastive_loss: 638820.7105; val_gene_expr_recon_loss: 2162676.2401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4140579.6842; val_optim_loss: 4140579.6842
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9473; val_auprc_score: 0.9712; val_best_acc_score: 0.9498; val_best_f1_score: 0.9674; train_kl_reg_loss: 26022.5805; train_edge_recon_loss: 1308170.8963; train_cat_covariates_contrastive_loss: 638852.2706; train_gene_expr_recon_loss: 2104457.6241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4077503.3609; train_optim_loss: 4077503.3609; val_kl_reg_loss: 25970.3242; val_edge_recon_loss: 1330733.4326; val_cat_covariates_contrastive_loss: 639188.1209; val_gene_expr_recon_loss: 2166867.4424; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4162759.3026; val_optim_loss: 4162759.3026
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9421; val_auprc_score: 0.9688; val_best_acc_score: 0.9492; val_best_f1_score: 0.9670; train_kl_reg_loss: 26316.5972; train_edge_recon_loss: 1315441.0947; train_cat_covariates_contrastive_loss: 638846.3707; train_gene_expr_recon_loss: 2093326.9929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4073931.0512; train_optim_loss: 4073931.0512; val_kl_reg_loss: 27767.3026; val_edge_recon_loss: 1327719.7105; val_cat_covariates_contrastive_loss: 637739.7590; val_gene_expr_recon_loss: 2150649.7763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4143876.5164; val_optim_loss: 4143876.5164
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9440; val_auprc_score: 0.9700; val_best_acc_score: 0.9507; val_best_f1_score: 0.9680; train_kl_reg_loss: 26708.8270; train_edge_recon_loss: 1308379.5737; train_cat_covariates_contrastive_loss: 639055.5073; train_gene_expr_recon_loss: 2091239.3501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4065383.2592; train_optim_loss: 4065383.2592; val_kl_reg_loss: 27001.8619; val_edge_recon_loss: 1302778.0625; val_cat_covariates_contrastive_loss: 638668.7541; val_gene_expr_recon_loss: 2144753.4457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4113202.1414; val_optim_loss: 4113202.1414
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9425; val_auprc_score: 0.9690; val_best_acc_score: 0.9495; val_best_f1_score: 0.9671; train_kl_reg_loss: 26816.8628; train_edge_recon_loss: 1310117.9427; train_cat_covariates_contrastive_loss: 638994.8413; train_gene_expr_recon_loss: 2088713.2039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4064642.8492; train_optim_loss: 4064642.8492; val_kl_reg_loss: 27403.8167; val_edge_recon_loss: 1333980.1250; val_cat_covariates_contrastive_loss: 638332.7377; val_gene_expr_recon_loss: 2155390.4934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4155107.1743; val_optim_loss: 4155107.1743
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9417; val_auprc_score: 0.9672; val_best_acc_score: 0.9519; val_best_f1_score: 0.9687; train_kl_reg_loss: 27218.7769; train_edge_recon_loss: 1312573.8974; train_cat_covariates_contrastive_loss: 639172.2692; train_gene_expr_recon_loss: 2083981.0289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4062945.9704; train_optim_loss: 4062945.9704; val_kl_reg_loss: 28076.3803; val_edge_recon_loss: 1326982.2993; val_cat_covariates_contrastive_loss: 638866.2887; val_gene_expr_recon_loss: 2147924.3569; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4141849.3158; val_optim_loss: 4141849.3158
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9419; val_auprc_score: 0.9685; val_best_acc_score: 0.9523; val_best_f1_score: 0.9690; train_kl_reg_loss: 27344.5195; train_edge_recon_loss: 1312980.0070; train_cat_covariates_contrastive_loss: 639255.4962; train_gene_expr_recon_loss: 2084829.3658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4064409.3832; train_optim_loss: 4064409.3832; val_kl_reg_loss: 27616.4033; val_edge_recon_loss: 1326042.1776; val_cat_covariates_contrastive_loss: 639972.3701; val_gene_expr_recon_loss: 2153053.4095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4146684.3454; val_optim_loss: 4146684.3454
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9428; val_auprc_score: 0.9696; val_best_acc_score: 0.9504; val_best_f1_score: 0.9678; train_kl_reg_loss: 27984.6512; train_edge_recon_loss: 1319218.8086; train_cat_covariates_contrastive_loss: 639511.2068; train_gene_expr_recon_loss: 2078095.5869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4064810.2540; train_optim_loss: 4064810.2540; val_kl_reg_loss: 28647.1254; val_edge_recon_loss: 1309733.8487; val_cat_covariates_contrastive_loss: 639405.2122; val_gene_expr_recon_loss: 2141577.5707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4119363.7467; val_optim_loss: 4119363.7467

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9435; val_auprc_score: 0.9693; val_best_acc_score: 0.9517; val_best_f1_score: 0.9687; train_kl_reg_loss: 28227.7141; train_edge_recon_loss: 1303995.0377; train_cat_covariates_contrastive_loss: 639422.1183; train_gene_expr_recon_loss: 2029599.2910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4001244.1654; train_optim_loss: 4001244.1654; val_kl_reg_loss: 28372.4172; val_edge_recon_loss: 1312699.0543; val_cat_covariates_contrastive_loss: 639834.7270; val_gene_expr_recon_loss: 2127595.5230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4108501.7039; val_optim_loss: 4108501.7039
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9421; val_auprc_score: 0.9680; val_best_acc_score: 0.9515; val_best_f1_score: 0.9685; train_kl_reg_loss: 28293.6702; train_edge_recon_loss: 1309963.6676; train_cat_covariates_contrastive_loss: 639732.3498; train_gene_expr_recon_loss: 2014699.4039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3992689.0889; train_optim_loss: 3992689.0889; val_kl_reg_loss: 28604.8778; val_edge_recon_loss: 1329866.4688; val_cat_covariates_contrastive_loss: 639523.7944; val_gene_expr_recon_loss: 2111501.5247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4109496.6678; val_optim_loss: 4109496.6678
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9414; val_auprc_score: 0.9680; val_best_acc_score: 0.9513; val_best_f1_score: 0.9684; train_kl_reg_loss: 28239.3118; train_edge_recon_loss: 1311948.0339; train_cat_covariates_contrastive_loss: 639254.5788; train_gene_expr_recon_loss: 2009760.2753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3989202.1914; train_optim_loss: 3989202.1914; val_kl_reg_loss: 28397.5889; val_edge_recon_loss: 1333519.5428; val_cat_covariates_contrastive_loss: 639761.7171; val_gene_expr_recon_loss: 2112800.3026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4114479.1447; val_optim_loss: 4114479.1447
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9448; val_auprc_score: 0.9698; val_best_acc_score: 0.9560; val_best_f1_score: 0.9715; train_kl_reg_loss: 28268.2736; train_edge_recon_loss: 1316016.9969; train_cat_covariates_contrastive_loss: 639444.9464; train_gene_expr_recon_loss: 2004026.9488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3987757.1698; train_optim_loss: 3987757.1698; val_kl_reg_loss: 28185.8535; val_edge_recon_loss: 1306923.8618; val_cat_covariates_contrastive_loss: 639842.8010; val_gene_expr_recon_loss: 2104381.5658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4079334.0987; val_optim_loss: 4079334.0987
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9444; val_auprc_score: 0.9693; val_best_acc_score: 0.9531; val_best_f1_score: 0.9695; train_kl_reg_loss: 28257.9232; train_edge_recon_loss: 1309821.7883; train_cat_covariates_contrastive_loss: 639566.7437; train_gene_expr_recon_loss: 2001808.8675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3979455.3159; train_optim_loss: 3979455.3159; val_kl_reg_loss: 28020.1766; val_edge_recon_loss: 1327531.1135; val_cat_covariates_contrastive_loss: 639624.8709; val_gene_expr_recon_loss: 2100302.3734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4095478.5428; val_optim_loss: 4095478.5428
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9468; val_auprc_score: 0.9708; val_best_acc_score: 0.9543; val_best_f1_score: 0.9702; train_kl_reg_loss: 28228.5684; train_edge_recon_loss: 1304585.0368; train_cat_covariates_contrastive_loss: 639332.4244; train_gene_expr_recon_loss: 1994431.2762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3966577.3155; train_optim_loss: 3966577.3155; val_kl_reg_loss: 28775.5298; val_edge_recon_loss: 1310275.7706; val_cat_covariates_contrastive_loss: 639109.6817; val_gene_expr_recon_loss: 2109992.8701; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4088153.8388; val_optim_loss: 4088153.8388
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9463; val_auprc_score: 0.9708; val_best_acc_score: 0.9542; val_best_f1_score: 0.9704; train_kl_reg_loss: 28224.1424; train_edge_recon_loss: 1306071.8051; train_cat_covariates_contrastive_loss: 639308.5310; train_gene_expr_recon_loss: 1992150.7227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3965755.2083; train_optim_loss: 3965755.2083; val_kl_reg_loss: 28280.5028; val_edge_recon_loss: 1311991.6168; val_cat_covariates_contrastive_loss: 640178.4836; val_gene_expr_recon_loss: 2096199.7697; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4076650.3750; val_optim_loss: 4076650.3750
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9462; val_auprc_score: 0.9708; val_best_acc_score: 0.9544; val_best_f1_score: 0.9702; train_kl_reg_loss: 28148.1286; train_edge_recon_loss: 1310895.3457; train_cat_covariates_contrastive_loss: 639915.1121; train_gene_expr_recon_loss: 1990815.0911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3969773.6834; train_optim_loss: 3969773.6834; val_kl_reg_loss: 28272.5709; val_edge_recon_loss: 1325904.7500; val_cat_covariates_contrastive_loss: 640566.9811; val_gene_expr_recon_loss: 2093491.5773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4088235.8849; val_optim_loss: 4088235.8849
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9414; val_auprc_score: 0.9685; val_best_acc_score: 0.9525; val_best_f1_score: 0.9691; train_kl_reg_loss: 28091.0341; train_edge_recon_loss: 1311113.5799; train_cat_covariates_contrastive_loss: 639354.9466; train_gene_expr_recon_loss: 1988483.9015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3967043.4623; train_optim_loss: 3967043.4623; val_kl_reg_loss: 27758.7044; val_edge_recon_loss: 1322348.5510; val_cat_covariates_contrastive_loss: 640041.6933; val_gene_expr_recon_loss: 2101156.6546; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4091305.6020; val_optim_loss: 4091305.6020
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9442; val_auprc_score: 0.9682; val_best_acc_score: 0.9540; val_best_f1_score: 0.9701; train_kl_reg_loss: 27964.9330; train_edge_recon_loss: 1317898.8359; train_cat_covariates_contrastive_loss: 639509.8392; train_gene_expr_recon_loss: 1987408.4555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3972782.0648; train_optim_loss: 3972782.0648; val_kl_reg_loss: 27803.7238; val_edge_recon_loss: 1326916.8125; val_cat_covariates_contrastive_loss: 638844.9498; val_gene_expr_recon_loss: 2103547.2286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4097112.6842; val_optim_loss: 4097112.6842
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9421; val_auprc_score: 0.9691; val_best_acc_score: 0.9536; val_best_f1_score: 0.9699; train_kl_reg_loss: 27995.4211; train_edge_recon_loss: 1312627.0392; train_cat_covariates_contrastive_loss: 639592.3162; train_gene_expr_recon_loss: 1983793.3576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3964008.1398; train_optim_loss: 3964008.1398; val_kl_reg_loss: 28257.2053; val_edge_recon_loss: 1310580.1086; val_cat_covariates_contrastive_loss: 638936.5411; val_gene_expr_recon_loss: 2098218.1661; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4075992.0263; val_optim_loss: 4075992.0263
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9421; val_auprc_score: 0.9681; val_best_acc_score: 0.9547; val_best_f1_score: 0.9706; train_kl_reg_loss: 27992.0278; train_edge_recon_loss: 1307305.1134; train_cat_covariates_contrastive_loss: 639137.3140; train_gene_expr_recon_loss: 1982630.4317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3957064.8898; train_optim_loss: 3957064.8898; val_kl_reg_loss: 28169.8464; val_edge_recon_loss: 1309686.1859; val_cat_covariates_contrastive_loss: 639422.6036; val_gene_expr_recon_loss: 2104566.6546; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4081845.2862; val_optim_loss: 4081845.2862
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9413; val_auprc_score: 0.9678; val_best_acc_score: 0.9530; val_best_f1_score: 0.9696; train_kl_reg_loss: 28060.4197; train_edge_recon_loss: 1308046.5556; train_cat_covariates_contrastive_loss: 639536.8062; train_gene_expr_recon_loss: 1983595.5412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3959239.3294; train_optim_loss: 3959239.3294; val_kl_reg_loss: 28018.7407; val_edge_recon_loss: 1316924.5016; val_cat_covariates_contrastive_loss: 639501.9169; val_gene_expr_recon_loss: 2099309.1053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4083754.2829; val_optim_loss: 4083754.2829
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9434; val_auprc_score: 0.9689; val_best_acc_score: 0.9550; val_best_f1_score: 0.9709; train_kl_reg_loss: 28005.1662; train_edge_recon_loss: 1303520.3270; train_cat_covariates_contrastive_loss: 639351.6850; train_gene_expr_recon_loss: 1979044.1925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3949921.3668; train_optim_loss: 3949921.3668; val_kl_reg_loss: 28403.9402; val_edge_recon_loss: 1304328.0049; val_cat_covariates_contrastive_loss: 638451.6694; val_gene_expr_recon_loss: 2096515.6957; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4067699.3322; val_optim_loss: 4067699.3322
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9444; val_auprc_score: 0.9693; val_best_acc_score: 0.9530; val_best_f1_score: 0.9694; train_kl_reg_loss: 27847.0756; train_edge_recon_loss: 1314165.4658; train_cat_covariates_contrastive_loss: 639083.1430; train_gene_expr_recon_loss: 1978513.8278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3959609.5073; train_optim_loss: 3959609.5073; val_kl_reg_loss: 27644.2049; val_edge_recon_loss: 1340871.6497; val_cat_covariates_contrastive_loss: 639215.6086; val_gene_expr_recon_loss: 2097114.9194; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4104846.3816; val_optim_loss: 4104846.3816
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9427; val_auprc_score: 0.9698; val_best_acc_score: 0.9539; val_best_f1_score: 0.9701; train_kl_reg_loss: 27791.5229; train_edge_recon_loss: 1314129.7206; train_cat_covariates_contrastive_loss: 639385.8240; train_gene_expr_recon_loss: 1976315.8300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3957622.8913; train_optim_loss: 3957622.8913; val_kl_reg_loss: 28154.6751; val_edge_recon_loss: 1310609.9079; val_cat_covariates_contrastive_loss: 639075.7862; val_gene_expr_recon_loss: 2097293.5609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4075133.9243; val_optim_loss: 4075133.9243
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9465; val_auprc_score: 0.9708; val_best_acc_score: 0.9564; val_best_f1_score: 0.9718; train_kl_reg_loss: 27691.0918; train_edge_recon_loss: 1316724.2992; train_cat_covariates_contrastive_loss: 639359.1361; train_gene_expr_recon_loss: 1975023.3940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3958797.9169; train_optim_loss: 3958797.9169; val_kl_reg_loss: 27000.4752; val_edge_recon_loss: 1304220.1135; val_cat_covariates_contrastive_loss: 640359.8586; val_gene_expr_recon_loss: 2102520.7237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4074101.1645; val_optim_loss: 4074101.1645
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9424; val_auprc_score: 0.9695; val_best_acc_score: 0.9536; val_best_f1_score: 0.9699; train_kl_reg_loss: 27682.2509; train_edge_recon_loss: 1310674.1999; train_cat_covariates_contrastive_loss: 639114.1395; train_gene_expr_recon_loss: 1972109.4519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3949580.0425; train_optim_loss: 3949580.0425; val_kl_reg_loss: 27738.3447; val_edge_recon_loss: 1301320.8676; val_cat_covariates_contrastive_loss: 638620.9178; val_gene_expr_recon_loss: 2102072.1809; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4069752.3158; val_optim_loss: 4069752.3158

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9416; val_auprc_score: 0.9683; val_best_acc_score: 0.9546; val_best_f1_score: 0.9705; train_kl_reg_loss: 27677.5825; train_edge_recon_loss: 1307866.8419; train_cat_covariates_contrastive_loss: 639131.8033; train_gene_expr_recon_loss: 1967855.8845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3942532.1124; train_optim_loss: 3942532.1124; val_kl_reg_loss: 27684.2772; val_edge_recon_loss: 1301442.6530; val_cat_covariates_contrastive_loss: 638743.2615; val_gene_expr_recon_loss: 2101068.3783; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4068938.5559; val_optim_loss: 4068938.5559
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9432; val_auprc_score: 0.9684; val_best_acc_score: 0.9543; val_best_f1_score: 0.9703; train_kl_reg_loss: 27672.8216; train_edge_recon_loss: 1307832.3378; train_cat_covariates_contrastive_loss: 639084.0846; train_gene_expr_recon_loss: 1968462.2066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3943051.4484; train_optim_loss: 3943051.4484; val_kl_reg_loss: 27740.9423; val_edge_recon_loss: 1316928.8372; val_cat_covariates_contrastive_loss: 638484.3117; val_gene_expr_recon_loss: 2094187.0641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4077341.1645; val_optim_loss: 4077341.1645
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9481; val_auprc_score: 0.9719; val_best_acc_score: 0.9572; val_best_f1_score: 0.9721; train_kl_reg_loss: 27725.1377; train_edge_recon_loss: 1304406.8057; train_cat_covariates_contrastive_loss: 638827.7522; train_gene_expr_recon_loss: 1966348.3241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3937308.0157; train_optim_loss: 3937308.0157; val_kl_reg_loss: 27638.6403; val_edge_recon_loss: 1305578.6793; val_cat_covariates_contrastive_loss: 639186.6324; val_gene_expr_recon_loss: 2099124.9211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4071528.8618; val_optim_loss: 4071528.8618
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9443; val_auprc_score: 0.9701; val_best_acc_score: 0.9549; val_best_f1_score: 0.9707; train_kl_reg_loss: 27614.1965; train_edge_recon_loss: 1304168.6557; train_cat_covariates_contrastive_loss: 639112.3345; train_gene_expr_recon_loss: 1965852.8594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3936748.0501; train_optim_loss: 3936748.0501; val_kl_reg_loss: 27752.3459; val_edge_recon_loss: 1307419.3207; val_cat_covariates_contrastive_loss: 639354.6258; val_gene_expr_recon_loss: 2092215.9260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4066742.2368; val_optim_loss: 4066742.2368
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9450; val_auprc_score: 0.9718; val_best_acc_score: 0.9553; val_best_f1_score: 0.9712; train_kl_reg_loss: 27689.9218; train_edge_recon_loss: 1305866.6360; train_cat_covariates_contrastive_loss: 639329.2824; train_gene_expr_recon_loss: 1966857.0417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3939742.8818; train_optim_loss: 3939742.8818; val_kl_reg_loss: 27750.8922; val_edge_recon_loss: 1283811.1258; val_cat_covariates_contrastive_loss: 638375.1201; val_gene_expr_recon_loss: 2092209.2648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4042146.4112; val_optim_loss: 4042146.4112
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9426; val_auprc_score: 0.9695; val_best_acc_score: 0.9533; val_best_f1_score: 0.9698; train_kl_reg_loss: 27625.1241; train_edge_recon_loss: 1312347.2418; train_cat_covariates_contrastive_loss: 639066.4483; train_gene_expr_recon_loss: 1964958.0835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3943996.8942; train_optim_loss: 3943996.8942; val_kl_reg_loss: 27698.3847; val_edge_recon_loss: 1311585.1299; val_cat_covariates_contrastive_loss: 638883.2722; val_gene_expr_recon_loss: 2092820.4293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4070987.1974; val_optim_loss: 4070987.1974
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9430; val_auprc_score: 0.9687; val_best_acc_score: 0.9546; val_best_f1_score: 0.9706; train_kl_reg_loss: 27692.1449; train_edge_recon_loss: 1307487.7136; train_cat_covariates_contrastive_loss: 639296.8099; train_gene_expr_recon_loss: 1967939.3728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3942416.0395; train_optim_loss: 3942416.0395; val_kl_reg_loss: 27818.1144; val_edge_recon_loss: 1300259.2451; val_cat_covariates_contrastive_loss: 638320.5724; val_gene_expr_recon_loss: 2096810.3947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4063208.3257; val_optim_loss: 4063208.3257
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9444; val_auprc_score: 0.9696; val_best_acc_score: 0.9549; val_best_f1_score: 0.9706; train_kl_reg_loss: 27656.2015; train_edge_recon_loss: 1306893.4493; train_cat_covariates_contrastive_loss: 639057.4965; train_gene_expr_recon_loss: 1963965.7917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3937572.9400; train_optim_loss: 3937572.9400; val_kl_reg_loss: 27538.2542; val_edge_recon_loss: 1308484.9424; val_cat_covariates_contrastive_loss: 638983.4375; val_gene_expr_recon_loss: 2093291.6266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4068298.2467; val_optim_loss: 4068298.2467
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9492; val_auprc_score: 0.9729; val_best_acc_score: 0.9551; val_best_f1_score: 0.9708; train_kl_reg_loss: 27646.1550; train_edge_recon_loss: 1313894.6433; train_cat_covariates_contrastive_loss: 639160.9057; train_gene_expr_recon_loss: 1964793.2877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3945494.9850; train_optim_loss: 3945494.9850; val_kl_reg_loss: 27844.4528; val_edge_recon_loss: 1317199.2812; val_cat_covariates_contrastive_loss: 639420.1201; val_gene_expr_recon_loss: 2098305.4194; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4082769.2697; val_optim_loss: 4082769.2697

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9471; val_auprc_score: 0.9717; val_best_acc_score: 0.9570; val_best_f1_score: 0.9721; train_kl_reg_loss: 27662.8217; train_edge_recon_loss: 1301867.9208; train_cat_covariates_contrastive_loss: 638857.3680; train_gene_expr_recon_loss: 1965479.7932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3933867.9059; train_optim_loss: 3933867.9059; val_kl_reg_loss: 27704.2178; val_edge_recon_loss: 1295085.6184; val_cat_covariates_contrastive_loss: 638684.6127; val_gene_expr_recon_loss: 2092010.7286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4053485.1941; val_optim_loss: 4053485.1941
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9415; val_auprc_score: 0.9682; val_best_acc_score: 0.9521; val_best_f1_score: 0.9690; train_kl_reg_loss: 27637.6741; train_edge_recon_loss: 1308427.6090; train_cat_covariates_contrastive_loss: 638931.1426; train_gene_expr_recon_loss: 1962411.6633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3937408.0908; train_optim_loss: 3937408.0908; val_kl_reg_loss: 27686.7226; val_edge_recon_loss: 1313975.6497; val_cat_covariates_contrastive_loss: 638608.7862; val_gene_expr_recon_loss: 2102668.0477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4082939.2039; val_optim_loss: 4082939.2039
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9450; val_auprc_score: 0.9695; val_best_acc_score: 0.9565; val_best_f1_score: 0.9717; train_kl_reg_loss: 27610.0328; train_edge_recon_loss: 1311128.6876; train_cat_covariates_contrastive_loss: 639343.2664; train_gene_expr_recon_loss: 1961597.7022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3939679.6929; train_optim_loss: 3939679.6929; val_kl_reg_loss: 27663.1284; val_edge_recon_loss: 1320695.8125; val_cat_covariates_contrastive_loss: 639155.2475; val_gene_expr_recon_loss: 2100869.1546; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4088383.3388; val_optim_loss: 4088383.3388
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9426; val_auprc_score: 0.9680; val_best_acc_score: 0.9536; val_best_f1_score: 0.9699; train_kl_reg_loss: 27588.8084; train_edge_recon_loss: 1307951.0840; train_cat_covariates_contrastive_loss: 639235.1923; train_gene_expr_recon_loss: 1965072.1623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3939847.2456; train_optim_loss: 3939847.2456; val_kl_reg_loss: 27624.1435; val_edge_recon_loss: 1313139.7204; val_cat_covariates_contrastive_loss: 638745.1086; val_gene_expr_recon_loss: 2083820.4309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4063329.3750; val_optim_loss: 4063329.3750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 229 min 52 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
val AUROC score: 0.9305
val AUPRC score: 0.9603
val best accuracy score: 0.9505
val best F1 score: 0.9678
val target rna MSE score: 1.5115
val source rna MSE score: 0.0702
Val cat covariate0 mean sim diff: 0.0003
Val cat covariate1 mean sim diff: -0.0886
Duration of model training in run 5: 3 hours, 51 minutes and 10 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 25413
Number of validation nodes: 2824
Number of training edges: 117816
Number of validation edges: 13090
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9006; val_auprc_score: 0.9569; val_best_acc_score: 0.8846; val_best_f1_score: 0.9269; train_kl_reg_loss: 15476.9615; train_edge_recon_loss: 1482356.0979; train_cat_covariates_contrastive_loss: 642580.6091; train_gene_expr_recon_loss: 3193750.7343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5334164.3959; train_optim_loss: 5334164.3959; val_kl_reg_loss: 12726.0829; val_edge_recon_loss: 1407326.0312; val_cat_covariates_contrastive_loss: 632934.4880; val_gene_expr_recon_loss: 2972502.4808; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5025489.1154; val_optim_loss: 5025489.1154
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9331; val_auprc_score: 0.9699; val_best_acc_score: 0.9145; val_best_f1_score: 0.9452; train_kl_reg_loss: 11884.7548; train_edge_recon_loss: 1344253.3164; train_cat_covariates_contrastive_loss: 634740.9447; train_gene_expr_recon_loss: 2907427.6361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4898306.6584; train_optim_loss: 4898306.6584; val_kl_reg_loss: 11165.9034; val_edge_recon_loss: 1330302.7043; val_cat_covariates_contrastive_loss: 634458.0012; val_gene_expr_recon_loss: 2843765.5913; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4819692.2019; val_optim_loss: 4819692.2019
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9376; val_auprc_score: 0.9720; val_best_acc_score: 0.9243; val_best_f1_score: 0.9511; train_kl_reg_loss: 11614.9737; train_edge_recon_loss: 1331168.0682; train_cat_covariates_contrastive_loss: 634278.3392; train_gene_expr_recon_loss: 2810037.8948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4787099.2809; train_optim_loss: 4787099.2809; val_kl_reg_loss: 12035.9973; val_edge_recon_loss: 1350106.1755; val_cat_covariates_contrastive_loss: 634166.8474; val_gene_expr_recon_loss: 2772748.0673; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4769057.0481; val_optim_loss: 4769057.0481
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9394; val_auprc_score: 0.9712; val_best_acc_score: 0.9339; val_best_f1_score: 0.9575; train_kl_reg_loss: 12296.0057; train_edge_recon_loss: 1335313.3422; train_cat_covariates_contrastive_loss: 634787.1914; train_gene_expr_recon_loss: 2739518.1497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4721914.6768; train_optim_loss: 4721914.6768; val_kl_reg_loss: 12702.4657; val_edge_recon_loss: 1323460.9111; val_cat_covariates_contrastive_loss: 634927.7945; val_gene_expr_recon_loss: 2694109.3558; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4665200.5288; val_optim_loss: 4665200.5288
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9359; val_auprc_score: 0.9685; val_best_acc_score: 0.9366; val_best_f1_score: 0.9593; train_kl_reg_loss: 13273.6312; train_edge_recon_loss: 1320990.0876; train_cat_covariates_contrastive_loss: 634253.0870; train_gene_expr_recon_loss: 2672592.2950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4641109.1020; train_optim_loss: 4641109.1020; val_kl_reg_loss: 13945.3267; val_edge_recon_loss: 1339435.9976; val_cat_covariates_contrastive_loss: 635180.2837; val_gene_expr_recon_loss: 2639808.7596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4628370.3750; val_optim_loss: 4628370.3750
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9411; val_auprc_score: 0.9709; val_best_acc_score: 0.9362; val_best_f1_score: 0.9590; train_kl_reg_loss: 14319.7562; train_edge_recon_loss: 1319905.1925; train_cat_covariates_contrastive_loss: 636123.7078; train_gene_expr_recon_loss: 2597261.8216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4567610.4756; train_optim_loss: 4567610.4756; val_kl_reg_loss: 15143.1368; val_edge_recon_loss: 1323418.4880; val_cat_covariates_contrastive_loss: 636341.5493; val_gene_expr_recon_loss: 2557548.2596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4532451.4231; val_optim_loss: 4532451.4231
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9398; val_auprc_score: 0.9698; val_best_acc_score: 0.9396; val_best_f1_score: 0.9609; train_kl_reg_loss: 15743.6655; train_edge_recon_loss: 1321182.8849; train_cat_covariates_contrastive_loss: 636104.0523; train_gene_expr_recon_loss: 2511317.3644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4484347.9566; train_optim_loss: 4484347.9566; val_kl_reg_loss: 16753.7329; val_edge_recon_loss: 1339407.6875; val_cat_covariates_contrastive_loss: 636520.6394; val_gene_expr_recon_loss: 2483473.1346; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4476155.1731; val_optim_loss: 4476155.1731
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9408; val_auprc_score: 0.9706; val_best_acc_score: 0.9414; val_best_f1_score: 0.9622; train_kl_reg_loss: 17089.4855; train_edge_recon_loss: 1318041.2091; train_cat_covariates_contrastive_loss: 636623.2650; train_gene_expr_recon_loss: 2440906.1128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4412660.0792; train_optim_loss: 4412660.0792; val_kl_reg_loss: 17790.9413; val_edge_recon_loss: 1327167.6587; val_cat_covariates_contrastive_loss: 639057.8005; val_gene_expr_recon_loss: 2419115.9904; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4403132.3702; val_optim_loss: 4403132.3702
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9348; val_auprc_score: 0.9664; val_best_acc_score: 0.9406; val_best_f1_score: 0.9618; train_kl_reg_loss: 18451.1894; train_edge_recon_loss: 1318247.7748; train_cat_covariates_contrastive_loss: 636958.4654; train_gene_expr_recon_loss: 2372437.0949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4346094.5304; train_optim_loss: 4346094.5304; val_kl_reg_loss: 19756.8916; val_edge_recon_loss: 1322287.2716; val_cat_covariates_contrastive_loss: 641391.8726; val_gene_expr_recon_loss: 2351346.4712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4334782.5144; val_optim_loss: 4334782.5144
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9320; val_auprc_score: 0.9628; val_best_acc_score: 0.9384; val_best_f1_score: 0.9602; train_kl_reg_loss: 19648.6579; train_edge_recon_loss: 1316165.4128; train_cat_covariates_contrastive_loss: 637286.0713; train_gene_expr_recon_loss: 2321355.6860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4294455.8178; train_optim_loss: 4294455.8178; val_kl_reg_loss: 19918.1843; val_edge_recon_loss: 1346821.3486; val_cat_covariates_contrastive_loss: 638721.1394; val_gene_expr_recon_loss: 2332671.0337; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4338131.6875; val_optim_loss: 4338131.6875
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9314; val_auprc_score: 0.9656; val_best_acc_score: 0.9387; val_best_f1_score: 0.9607; train_kl_reg_loss: 20539.6332; train_edge_recon_loss: 1326693.8406; train_cat_covariates_contrastive_loss: 637464.3210; train_gene_expr_recon_loss: 2275648.7427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4260346.5293; train_optim_loss: 4260346.5293; val_kl_reg_loss: 21278.2084; val_edge_recon_loss: 1317700.4279; val_cat_covariates_contrastive_loss: 637363.1178; val_gene_expr_recon_loss: 2278288.8606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4254630.5865; val_optim_loss: 4254630.5865
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9354; val_auprc_score: 0.9665; val_best_acc_score: 0.9403; val_best_f1_score: 0.9616; train_kl_reg_loss: 21263.7844; train_edge_recon_loss: 1311111.5670; train_cat_covariates_contrastive_loss: 637503.8510; train_gene_expr_recon_loss: 2239768.3566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4209647.5656; train_optim_loss: 4209647.5656; val_kl_reg_loss: 20673.3849; val_edge_recon_loss: 1320141.7812; val_cat_covariates_contrastive_loss: 637980.2091; val_gene_expr_recon_loss: 2274741.2837; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4253536.6490; val_optim_loss: 4253536.6490
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9414; val_auprc_score: 0.9692; val_best_acc_score: 0.9445; val_best_f1_score: 0.9640; train_kl_reg_loss: 21889.9904; train_edge_recon_loss: 1322917.8530; train_cat_covariates_contrastive_loss: 637684.5106; train_gene_expr_recon_loss: 2213606.7427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4196099.0879; train_optim_loss: 4196099.0879; val_kl_reg_loss: 22283.9023; val_edge_recon_loss: 1343781.0457; val_cat_covariates_contrastive_loss: 638141.7500; val_gene_expr_recon_loss: 2242226.0192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4246432.7596; val_optim_loss: 4246432.7596
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9423; val_auprc_score: 0.9688; val_best_acc_score: 0.9468; val_best_f1_score: 0.9657; train_kl_reg_loss: 22827.1484; train_edge_recon_loss: 1328131.4075; train_cat_covariates_contrastive_loss: 637923.8811; train_gene_expr_recon_loss: 2177402.1247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4166284.5548; train_optim_loss: 4166284.5548; val_kl_reg_loss: 22957.2429; val_edge_recon_loss: 1309201.2139; val_cat_covariates_contrastive_loss: 637499.2392; val_gene_expr_recon_loss: 2208582.8822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4178240.5769; val_optim_loss: 4178240.5769
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9417; val_auprc_score: 0.9706; val_best_acc_score: 0.9443; val_best_f1_score: 0.9639; train_kl_reg_loss: 23060.6045; train_edge_recon_loss: 1322048.9246; train_cat_covariates_contrastive_loss: 638293.9709; train_gene_expr_recon_loss: 2161671.3701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4145074.8709; train_optim_loss: 4145074.8709; val_kl_reg_loss: 24373.2736; val_edge_recon_loss: 1330811.9964; val_cat_covariates_contrastive_loss: 638158.1575; val_gene_expr_recon_loss: 2219106.4976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4212449.9327; val_optim_loss: 4212449.9327
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9420; val_auprc_score: 0.9694; val_best_acc_score: 0.9485; val_best_f1_score: 0.9668; train_kl_reg_loss: 23758.3172; train_edge_recon_loss: 1327545.3482; train_cat_covariates_contrastive_loss: 638241.6590; train_gene_expr_recon_loss: 2150954.7424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4140500.0645; train_optim_loss: 4140500.0645; val_kl_reg_loss: 23738.9818; val_edge_recon_loss: 1324046.2957; val_cat_covariates_contrastive_loss: 638015.1707; val_gene_expr_recon_loss: 2200114.4615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4185914.9087; val_optim_loss: 4185914.9087
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9379; val_auprc_score: 0.9679; val_best_acc_score: 0.9456; val_best_f1_score: 0.9648; train_kl_reg_loss: 24169.7896; train_edge_recon_loss: 1309806.5812; train_cat_covariates_contrastive_loss: 638499.5165; train_gene_expr_recon_loss: 2131026.3544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4103502.2511; train_optim_loss: 4103502.2511; val_kl_reg_loss: 25939.1360; val_edge_recon_loss: 1331305.0745; val_cat_covariates_contrastive_loss: 636230.5913; val_gene_expr_recon_loss: 2183497.8894; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4176972.6971; val_optim_loss: 4176972.6971
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9449; val_auprc_score: 0.9716; val_best_acc_score: 0.9459; val_best_f1_score: 0.9650; train_kl_reg_loss: 24464.5771; train_edge_recon_loss: 1320627.2741; train_cat_covariates_contrastive_loss: 638253.8358; train_gene_expr_recon_loss: 2115630.9208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4098976.6117; train_optim_loss: 4098976.6117; val_kl_reg_loss: 24310.9952; val_edge_recon_loss: 1314398.7885; val_cat_covariates_contrastive_loss: 638902.4267; val_gene_expr_recon_loss: 2155320.1442; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4132932.3654; val_optim_loss: 4132932.3654
