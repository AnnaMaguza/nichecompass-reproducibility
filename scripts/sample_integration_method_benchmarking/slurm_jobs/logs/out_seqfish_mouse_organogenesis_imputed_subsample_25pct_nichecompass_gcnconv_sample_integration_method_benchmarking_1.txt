Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9268; val_auprc_score: 0.9827; val_best_acc_score: 0.8511; val_best_f1_score: 0.9196; train_kl_reg_loss: 376267.6026; train_edge_recon_loss: 1199183.4340; train_gene_expr_recon_loss: 49135792.1509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50711243.1698; train_optim_loss: 50711243.1698; val_kl_reg_loss: 355634.2500; val_edge_recon_loss: 1207218.6667; val_gene_expr_recon_loss: 46444930.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48007783.3333; val_optim_loss: 48007783.3333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9240; val_auprc_score: 0.9830; val_best_acc_score: 0.8558; val_best_f1_score: 0.9223; train_kl_reg_loss: 343834.7842; train_edge_recon_loss: 1200506.5943; train_gene_expr_recon_loss: 43493904.0755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45038245.3585; train_optim_loss: 45038245.3585; val_kl_reg_loss: 318905.3750; val_edge_recon_loss: 1175642.0000; val_gene_expr_recon_loss: 40558204.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42052752.6667; val_optim_loss: 42052752.6667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9191; val_auprc_score: 0.9805; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 311109.8355; train_edge_recon_loss: 1197049.2972; train_gene_expr_recon_loss: 41040909.0566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42549067.9245; train_optim_loss: 42549067.9245; val_kl_reg_loss: 308975.6823; val_edge_recon_loss: 1202504.6667; val_gene_expr_recon_loss: 38713962.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40225441.3333; val_optim_loss: 40225441.3333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9151; val_auprc_score: 0.9801; val_best_acc_score: 0.8532; val_best_f1_score: 0.9208; train_kl_reg_loss: 364567.4652; train_edge_recon_loss: 1207623.9670; train_gene_expr_recon_loss: 38100716.7547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39672908.0000; train_optim_loss: 39672908.0000; val_kl_reg_loss: 319167.6823; val_edge_recon_loss: 1197274.7500; val_gene_expr_recon_loss: 37453244.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38969686.6667; val_optim_loss: 38969686.6667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9132; val_auprc_score: 0.9803; val_best_acc_score: 0.8515; val_best_f1_score: 0.9198; train_kl_reg_loss: 353109.7081; train_edge_recon_loss: 1195010.2524; train_gene_expr_recon_loss: 37373691.6981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 38921811.6226; train_optim_loss: 38921811.6226; val_kl_reg_loss: 284669.4844; val_edge_recon_loss: 1207932.6667; val_gene_expr_recon_loss: 37107323.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38599926.0000; val_optim_loss: 38599926.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8593; val_auprc_score: 0.9600; val_best_acc_score: 0.8560; val_best_f1_score: 0.9224; train_kl_reg_loss: 33653968.3069; train_edge_recon_loss: 1165206.3101; train_gene_expr_recon_loss: 231712113.8113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 266531288.6038; train_optim_loss: 266531288.6038; val_kl_reg_loss: 39170147.3333; val_edge_recon_loss: 1169016.3333; val_gene_expr_recon_loss: 140981066.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 181320234.6667; val_optim_loss: 181320234.6667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8329; val_auprc_score: 0.9489; val_best_acc_score: 0.8510; val_best_f1_score: 0.9195; train_kl_reg_loss: 3248312.4127; train_edge_recon_loss: 1192229.4422; train_gene_expr_recon_loss: 126482845.2075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 130923386.7925; train_optim_loss: 130923386.7925; val_kl_reg_loss: 3081358.4167; val_edge_recon_loss: 1211167.2292; val_gene_expr_recon_loss: 58220178.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62512704.0000; val_optim_loss: 62512704.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8407; val_auprc_score: 0.9520; val_best_acc_score: 0.8518; val_best_f1_score: 0.9200; train_kl_reg_loss: 3143497.6934; train_edge_recon_loss: 1189251.6946; train_gene_expr_recon_loss: 54952293.5849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59285043.0943; train_optim_loss: 59285043.0943; val_kl_reg_loss: 2995671.3333; val_edge_recon_loss: 1205694.5417; val_gene_expr_recon_loss: 53588672.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57790037.3333; val_optim_loss: 57790037.3333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8517; val_auprc_score: 0.9569; val_best_acc_score: 0.8561; val_best_f1_score: 0.9225; train_kl_reg_loss: 2939734.4906; train_edge_recon_loss: 1196860.2217; train_gene_expr_recon_loss: 53618308.9057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57754903.5472; train_optim_loss: 57754903.5472; val_kl_reg_loss: 3157321.0417; val_edge_recon_loss: 1170505.0208; val_gene_expr_recon_loss: 53228936.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57556762.6667; val_optim_loss: 57556762.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8435; val_auprc_score: 0.9555; val_best_acc_score: 0.8587; val_best_f1_score: 0.9240; train_kl_reg_loss: 2856950.8208; train_edge_recon_loss: 1192157.7335; train_gene_expr_recon_loss: 53598837.8113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57647946.4906; train_optim_loss: 57647946.4906; val_kl_reg_loss: 2800751.2500; val_edge_recon_loss: 1149325.6875; val_gene_expr_recon_loss: 52976426.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56926504.6667; val_optim_loss: 56926504.6667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8473; val_auprc_score: 0.9550; val_best_acc_score: 0.8545; val_best_f1_score: 0.9216; train_kl_reg_loss: 2825385.0519; train_edge_recon_loss: 1206008.5566; train_gene_expr_recon_loss: 52980411.2453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57011804.6038; train_optim_loss: 57011804.6038; val_kl_reg_loss: 2763285.6250; val_edge_recon_loss: 1184053.7292; val_gene_expr_recon_loss: 52881258.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56828598.0000; val_optim_loss: 56828598.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8488; val_auprc_score: 0.9558; val_best_acc_score: 0.8551; val_best_f1_score: 0.9219; train_kl_reg_loss: 2805157.1840; train_edge_recon_loss: 1189675.7712; train_gene_expr_recon_loss: 52943715.9245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56938548.9057; train_optim_loss: 56938548.9057; val_kl_reg_loss: 2758971.8333; val_edge_recon_loss: 1178357.1875; val_gene_expr_recon_loss: 52870252.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56807581.3333; val_optim_loss: 56807581.3333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8488; val_auprc_score: 0.9562; val_best_acc_score: 0.8560; val_best_f1_score: 0.9224; train_kl_reg_loss: 2783939.2358; train_edge_recon_loss: 1193781.0943; train_gene_expr_recon_loss: 52877417.7358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56855138.1132; train_optim_loss: 56855138.1132; val_kl_reg_loss: 2733921.4167; val_edge_recon_loss: 1170639.3958; val_gene_expr_recon_loss: 52797012.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56701572.6667; val_optim_loss: 56701572.6667
Run timestamp: 26082023_183656_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'celltype_mapped_refined', '--filter_genes', '--n_svg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_imputed_subsample_25pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gcnconv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1490, n_latent: 1480, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1480, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1480, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 106920
Number of validation edges: 11879
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9408; val_auprc_score: 0.9866; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 571494.3570; train_edge_recon_loss: 1097502.8348; train_gene_expr_recon_loss: 145223017.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 146892017.7143; train_optim_loss: 146892017.7143; val_kl_reg_loss: 275141.6875; val_edge_recon_loss: 1201859.0625; val_gene_expr_recon_loss: 61515346.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62992346.0000; val_optim_loss: 62992346.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 56 sec.
Using best model state, which was in epoch 6.

--- MODEL EVALUATION ---
val AUROC score: 0.9098
val AUPRC score: 0.9791
val best accuracy score: 0.8545
val best F1 score: 0.9215
val target rna MSE score: 17.7766
val source rna MSE score: 16.9392
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 8: 0 hours, 3 minutes and 8 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1490, n_latent: 1480, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1480, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1480, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 106920
Number of validation edges: 11879
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9308; val_auprc_score: 0.9832; val_best_acc_score: 0.8511; val_best_f1_score: 0.9195; train_kl_reg_loss: 499797.8369; train_edge_recon_loss: 1146755.9811; train_gene_expr_recon_loss: 89615995.0943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 91262548.9811; train_optim_loss: 91262548.9811; val_kl_reg_loss: 477533.4583; val_edge_recon_loss: 1211055.3958; val_gene_expr_recon_loss: 51215133.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52903722.6667; val_optim_loss: 52903722.6667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9358; val_auprc_score: 0.9841; val_best_acc_score: 0.8509; val_best_f1_score: 0.9194; train_kl_reg_loss: 371190.6027; train_edge_recon_loss: 1180449.7589; train_gene_expr_recon_loss: 59989700.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61541340.2857; train_optim_loss: 61541340.2857; val_kl_reg_loss: 451565.5938; val_edge_recon_loss: 1215781.8750; val_gene_expr_recon_loss: 57566200.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59233548.0000; val_optim_loss: 59233548.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9258; val_auprc_score: 0.9818; val_best_acc_score: 0.8542; val_best_f1_score: 0.9214; train_kl_reg_loss: 470486.9570; train_edge_recon_loss: 1197688.0802; train_gene_expr_recon_loss: 49116561.8113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50784737.0566; train_optim_loss: 50784737.0566; val_kl_reg_loss: 442976.4583; val_edge_recon_loss: 1185628.4375; val_gene_expr_recon_loss: 46677702.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48306308.0000; val_optim_loss: 48306308.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9337; val_auprc_score: 0.9839; val_best_acc_score: 0.8535; val_best_f1_score: 0.9210; train_kl_reg_loss: 482946.4107; train_edge_recon_loss: 1197727.6875; train_gene_expr_recon_loss: 56514033.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58194707.4286; train_optim_loss: 58194707.4286; val_kl_reg_loss: 504456.0000; val_edge_recon_loss: 1182567.5625; val_gene_expr_recon_loss: 55100512.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56787536.0000; val_optim_loss: 56787536.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9341; val_auprc_score: 0.9843; val_best_acc_score: 0.8572; val_best_f1_score: 0.9231; train_kl_reg_loss: 524818.3906; train_edge_recon_loss: 1178764.7991; train_gene_expr_recon_loss: 54888432.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56592014.8571; train_optim_loss: 56592014.8571; val_kl_reg_loss: 544138.8750; val_edge_recon_loss: 1154987.2500; val_gene_expr_recon_loss: 54331604.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56030730.0000; val_optim_loss: 56030730.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9270; val_auprc_score: 0.9830; val_best_acc_score: 0.8551; val_best_f1_score: 0.9219; train_kl_reg_loss: 423847.4440; train_edge_recon_loss: 1204257.0519; train_gene_expr_recon_loss: 43690380.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45318484.4528; train_optim_loss: 45318484.4528; val_kl_reg_loss: 388341.5990; val_edge_recon_loss: 1178027.8125; val_gene_expr_recon_loss: 40768650.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42335019.3333; val_optim_loss: 42335019.3333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9311; val_auprc_score: 0.9823; val_best_acc_score: 0.8518; val_best_f1_score: 0.9200; train_kl_reg_loss: 555530.4286; train_edge_recon_loss: 1192859.1518; train_gene_expr_recon_loss: 53764434.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55512823.7143; train_optim_loss: 55512823.7143; val_kl_reg_loss: 555198.0000; val_edge_recon_loss: 1191714.4375; val_gene_expr_recon_loss: 53178330.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54925242.0000; val_optim_loss: 54925242.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9286; val_auprc_score: 0.9841; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 365912.6291; train_edge_recon_loss: 1188377.8031; train_gene_expr_recon_loss: 39100031.7736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40654322.0377; train_optim_loss: 40654322.0377; val_kl_reg_loss: 332396.8594; val_edge_recon_loss: 1205934.8958; val_gene_expr_recon_loss: 37995633.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39533965.3333; val_optim_loss: 39533965.3333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9279; val_auprc_score: 0.9819; val_best_acc_score: 0.8539; val_best_f1_score: 0.9212; train_kl_reg_loss: 553037.8438; train_edge_recon_loss: 1193340.5357; train_gene_expr_recon_loss: 52683081.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54429459.4286; train_optim_loss: 54429459.4286; val_kl_reg_loss: 541674.1875; val_edge_recon_loss: 1201503.5000; val_gene_expr_recon_loss: 52072752.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53815928.0000; val_optim_loss: 53815928.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8600; val_auprc_score: 0.9559; val_best_acc_score: 0.8501; val_best_f1_score: 0.9190; train_kl_reg_loss: 47869390.3897; train_edge_recon_loss: 1180722.0542; train_gene_expr_recon_loss: 192535001.1321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 241585114.7170; train_optim_loss: 241585114.7170; val_kl_reg_loss: 2250593.2083; val_edge_recon_loss: 1222149.5208; val_gene_expr_recon_loss: 84158649.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 87631392.0000; val_optim_loss: 87631392.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9317; val_auprc_score: 0.9834; val_best_acc_score: 0.8562; val_best_f1_score: 0.9225; train_kl_reg_loss: 536102.2143; train_edge_recon_loss: 1190095.5089; train_gene_expr_recon_loss: 51441482.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53167680.0000; train_optim_loss: 53167680.0000; val_kl_reg_loss: 522992.2969; val_edge_recon_loss: 1157610.8750; val_gene_expr_recon_loss: 50671476.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52352080.0000; val_optim_loss: 52352080.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8018; val_auprc_score: 0.9377; val_best_acc_score: 0.8527; val_best_f1_score: 0.9205; train_kl_reg_loss: 4413265.1698; train_edge_recon_loss: 1181134.2005; train_gene_expr_recon_loss: 126835001.9623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 132429401.5094; train_optim_loss: 132429401.5094; val_kl_reg_loss: 4299260.0000; val_edge_recon_loss: 1196311.0625; val_gene_expr_recon_loss: 55206824.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60702396.0000; val_optim_loss: 60702396.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9270; val_auprc_score: 0.9816; val_best_acc_score: 0.8503; val_best_f1_score: 0.9191; train_kl_reg_loss: 516019.1049; train_edge_recon_loss: 1197951.2768; train_gene_expr_recon_loss: 49911768.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51625738.5714; train_optim_loss: 51625738.5714; val_kl_reg_loss: 501641.0625; val_edge_recon_loss: 1229373.5625; val_gene_expr_recon_loss: 48971692.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50702706.0000; val_optim_loss: 50702706.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9299; val_auprc_score: 0.9832; val_best_acc_score: 0.8542; val_best_f1_score: 0.9214; train_kl_reg_loss: 494963.7746; train_edge_recon_loss: 1188539.0938; train_gene_expr_recon_loss: 48152918.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49836421.4286; train_optim_loss: 49836421.4286; val_kl_reg_loss: 480743.9062; val_edge_recon_loss: 1194577.0000; val_gene_expr_recon_loss: 47164594.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48839914.0000; val_optim_loss: 48839914.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8249; val_auprc_score: 0.9453; val_best_acc_score: 0.8529; val_best_f1_score: 0.9206; train_kl_reg_loss: 3903827.4340; train_edge_recon_loss: 1185904.6274; train_gene_expr_recon_loss: 54997490.2642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60087222.2642; train_optim_loss: 60087222.2642; val_kl_reg_loss: 3429735.6667; val_edge_recon_loss: 1197370.1875; val_gene_expr_recon_loss: 53576316.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58203423.3333; val_optim_loss: 58203423.3333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9249; val_auprc_score: 0.9812; val_best_acc_score: 0.8528; val_best_f1_score: 0.9206; train_kl_reg_loss: 473470.2835; train_edge_recon_loss: 1193504.5893; train_gene_expr_recon_loss: 46342692.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48009667.7143; train_optim_loss: 48009667.7143; val_kl_reg_loss: 460419.9844; val_edge_recon_loss: 1207251.6250; val_gene_expr_recon_loss: 45405150.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47072820.0000; val_optim_loss: 47072820.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8298; val_auprc_score: 0.9476; val_best_acc_score: 0.8544; val_best_f1_score: 0.9215; train_kl_reg_loss: 107112308691.1887; train_edge_recon_loss: 1191056.7300; train_gene_expr_recon_loss: 156177245.8868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 107269674226.1887; train_optim_loss: 107269674226.1887; val_kl_reg_loss: 3161621.1250; val_edge_recon_loss: 1184591.7292; val_gene_expr_recon_loss: 71001336.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 75347550.6667; val_optim_loss: 75347550.6667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9259; val_auprc_score: 0.9820; val_best_acc_score: 0.8526; val_best_f1_score: 0.9205; train_kl_reg_loss: 452944.6049; train_edge_recon_loss: 1181658.8571; train_gene_expr_recon_loss: 44739147.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46373750.8571; train_optim_loss: 46373750.8571; val_kl_reg_loss: 439985.6250; val_edge_recon_loss: 1210487.9375; val_gene_expr_recon_loss: 43949904.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45600378.0000; val_optim_loss: 45600378.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8296; val_auprc_score: 0.9474; val_best_acc_score: 0.8534; val_best_f1_score: 0.9209; train_kl_reg_loss: 3084705.8066; train_edge_recon_loss: 1200823.8679; train_gene_expr_recon_loss: 57224793.2075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61510322.7925; train_optim_loss: 61510322.7925; val_kl_reg_loss: 2962944.9583; val_edge_recon_loss: 1193107.9792; val_gene_expr_recon_loss: 54707917.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58863970.6667; val_optim_loss: 58863970.6667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9304; val_auprc_score: 0.9834; val_best_acc_score: 0.8499; val_best_f1_score: 0.9189; train_kl_reg_loss: 432887.4219; train_edge_recon_loss: 1212260.0179; train_gene_expr_recon_loss: 43495421.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45140569.1429; train_optim_loss: 45140569.1429; val_kl_reg_loss: 419028.5469; val_edge_recon_loss: 1212693.5000; val_gene_expr_recon_loss: 42959972.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44591696.0000; val_optim_loss: 44591696.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8525; val_auprc_score: 0.9539; val_best_acc_score: 0.8511; val_best_f1_score: 0.9195; train_kl_reg_loss: 2933606.8208; train_edge_recon_loss: 1192039.8278; train_gene_expr_recon_loss: 54295878.7170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58421525.4340; train_optim_loss: 58421525.4340; val_kl_reg_loss: 2853811.7500; val_edge_recon_loss: 1210226.5208; val_gene_expr_recon_loss: 53681347.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57745385.3333; val_optim_loss: 57745385.3333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9210; val_auprc_score: 0.9810; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 412728.6317; train_edge_recon_loss: 1199363.6071; train_gene_expr_recon_loss: 42636782.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44248875.4286; train_optim_loss: 44248875.4286; val_kl_reg_loss: 401012.8906; val_edge_recon_loss: 1203077.6875; val_gene_expr_recon_loss: 42264444.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43868536.0000; val_optim_loss: 43868536.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9219; val_auprc_score: 0.9823; val_best_acc_score: 0.8549; val_best_f1_score: 0.9217; train_kl_reg_loss: 393789.5960; train_edge_recon_loss: 1198821.9107; train_gene_expr_recon_loss: 42053467.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43646078.8571; train_optim_loss: 43646078.8571; val_kl_reg_loss: 381001.0938; val_edge_recon_loss: 1202868.3750; val_gene_expr_recon_loss: 41736486.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43320356.0000; val_optim_loss: 43320356.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8391; val_auprc_score: 0.9514; val_best_acc_score: 0.8558; val_best_f1_score: 0.9223; train_kl_reg_loss: 2839083.4434; train_edge_recon_loss: 1196321.7925; train_gene_expr_recon_loss: 53405018.4151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57440423.8491; train_optim_loss: 57440423.8491; val_kl_reg_loss: 2761807.0000; val_edge_recon_loss: 1171373.9375; val_gene_expr_recon_loss: 53298581.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57231762.0000; val_optim_loss: 57231762.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9188; val_auprc_score: 0.9815; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 375181.1362; train_edge_recon_loss: 1199983.4107; train_gene_expr_recon_loss: 41661361.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43236526.2857; train_optim_loss: 43236526.2857; val_kl_reg_loss: 363392.6250; val_edge_recon_loss: 1176138.1875; val_gene_expr_recon_loss: 41447406.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42986936.0000; val_optim_loss: 42986936.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8437; val_auprc_score: 0.9514; val_best_acc_score: 0.8514; val_best_f1_score: 0.9197; train_kl_reg_loss: 2750386.5849; train_edge_recon_loss: 1194739.0024; train_gene_expr_recon_loss: 53239673.2830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57184798.7170; train_optim_loss: 57184798.7170; val_kl_reg_loss: 2667059.0417; val_edge_recon_loss: 1209214.3542; val_gene_expr_recon_loss: 53167296.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57043570.0000; val_optim_loss: 57043570.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9156; val_auprc_score: 0.9808; val_best_acc_score: 0.8545; val_best_f1_score: 0.9216; train_kl_reg_loss: 357980.9018; train_edge_recon_loss: 1207151.2054; train_gene_expr_recon_loss: 41376547.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42941680.0000; train_optim_loss: 42941680.0000; val_kl_reg_loss: 347490.0000; val_edge_recon_loss: 1193182.6875; val_gene_expr_recon_loss: 41220092.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42760764.0000; val_optim_loss: 42760764.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9152; val_auprc_score: 0.9803; val_best_acc_score: 0.8525; val_best_f1_score: 0.9204; train_kl_reg_loss: 349936.8705; train_edge_recon_loss: 1195481.2232; train_gene_expr_recon_loss: 42283956.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43829374.2857; train_optim_loss: 43829374.2857; val_kl_reg_loss: 351047.3906; val_edge_recon_loss: 1209920.8750; val_gene_expr_recon_loss: 41252302.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42813270.0000; val_optim_loss: 42813270.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9207; val_auprc_score: 0.9809; val_best_acc_score: 0.8488; val_best_f1_score: 0.9182; train_kl_reg_loss: 380424.4062; train_edge_recon_loss: 1188620.9464; train_gene_expr_recon_loss: 41371110.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42940155.7143; train_optim_loss: 42940155.7143; val_kl_reg_loss: 360122.4844; val_edge_recon_loss: 1236224.5000; val_gene_expr_recon_loss: 41058298.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42654646.0000; val_optim_loss: 42654646.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9190; val_auprc_score: 0.9815; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 361336.2991; train_edge_recon_loss: 1200568.2054; train_gene_expr_recon_loss: 40960377.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42522282.2857; train_optim_loss: 42522282.2857; val_kl_reg_loss: 352406.3438; val_edge_recon_loss: 1182316.0625; val_gene_expr_recon_loss: 40778928.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42313650.0000; val_optim_loss: 42313650.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9139; val_auprc_score: 0.9799; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 344732.5134; train_edge_recon_loss: 1202425.1875; train_gene_expr_recon_loss: 40745082.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42292240.0000; train_optim_loss: 42292240.0000; val_kl_reg_loss: 330305.5938; val_edge_recon_loss: 1182381.1250; val_gene_expr_recon_loss: 40625296.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42137984.0000; val_optim_loss: 42137984.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9210; val_auprc_score: 0.9813; val_best_acc_score: 0.8532; val_best_f1_score: 0.9208; train_kl_reg_loss: 1323245.4799; train_edge_recon_loss: 1184963.3929; train_gene_expr_recon_loss: 68959145.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 71467352.8571; train_optim_loss: 71467352.8571; val_kl_reg_loss: 348636.0469; val_edge_recon_loss: 1191080.2500; val_gene_expr_recon_loss: 54797854.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56337570.0000; val_optim_loss: 56337570.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 35 sec.
Using best model state, which was in epoch 4.

--- MODEL EVALUATION ---
val AUROC score: 0.9288
val AUPRC score: 0.9843
val best accuracy score: 0.8540
val best F1 score: 0.9212
val target rna MSE score: 29.4114
val source rna MSE score: 50.3982
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 7: 0 hours, 2 minutes and 44 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1490, n_latent: 1480, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1480, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1480, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 80320
Number of validation edges: 8924
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9234; val_auprc_score: 0.9815; val_best_acc_score: 0.8531; val_best_f1_score: 0.9207; train_kl_reg_loss: 3340747.7457; train_edge_recon_loss: 1152069.4703; train_gene_expr_recon_loss: 190333383.3000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 194826201.1000; train_optim_loss: 194826201.1000; val_kl_reg_loss: 453236.8250; val_edge_recon_loss: 1189257.2750; val_gene_expr_recon_loss: 56600017.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58242511.2000; val_optim_loss: 58242511.2000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9125; val_auprc_score: 0.9778; val_best_acc_score: 0.8559; val_best_f1_score: 0.9224; train_kl_reg_loss: 509304.1004; train_edge_recon_loss: 1164276.5491; train_gene_expr_recon_loss: 84270848.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 85944429.7143; train_optim_loss: 85944429.7143; val_kl_reg_loss: 515629.4375; val_edge_recon_loss: 1166222.1250; val_gene_expr_recon_loss: 42455956.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44137808.0000; val_optim_loss: 44137808.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9336; val_auprc_score: 0.9846; val_best_acc_score: 0.8529; val_best_f1_score: 0.9206; train_kl_reg_loss: 469636.8242; train_edge_recon_loss: 1196913.1531; train_gene_expr_recon_loss: 54210848.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55877398.4000; train_optim_loss: 55877398.4000; val_kl_reg_loss: 449923.6688; val_edge_recon_loss: 1206118.6250; val_gene_expr_recon_loss: 52128938.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53784980.0000; val_optim_loss: 53784980.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8994; val_auprc_score: 0.9727; val_best_acc_score: 0.8512; val_best_f1_score: 0.9196; train_kl_reg_loss: 2274778.1629; train_edge_recon_loss: 1170986.7991; train_gene_expr_recon_loss: 133272082.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 136717843.7143; train_optim_loss: 136717843.7143; val_kl_reg_loss: 495676719104.0000; val_edge_recon_loss: 1209683.9375; val_gene_expr_recon_loss: 44976934.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 495722889216.0000; val_optim_loss: 495722889216.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9222; val_auprc_score: 0.9822; val_best_acc_score: 0.8556; val_best_f1_score: 0.9222; train_kl_reg_loss: 435069.0312; train_edge_recon_loss: 1196826.6687; train_gene_expr_recon_loss: 49792181.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51424076.8000; train_optim_loss: 51424076.8000; val_kl_reg_loss: 403532.3937; val_edge_recon_loss: 1168391.5750; val_gene_expr_recon_loss: 47006940.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48578865.6000; val_optim_loss: 48578865.6000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.7644; val_auprc_score: 0.9265; val_best_acc_score: 0.8545; val_best_f1_score: 0.9215; train_kl_reg_loss: 65441258139.0179; train_edge_recon_loss: 1159133.8750; train_gene_expr_recon_loss: 789112400.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 66231529632.0000; train_optim_loss: 66231529632.0000; val_kl_reg_loss: 5170383.2500; val_edge_recon_loss: 1171372.5625; val_gene_expr_recon_loss: 775969568.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 782311328.0000; val_optim_loss: 782311328.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.7584; val_auprc_score: 0.9247; val_best_acc_score: 0.8544; val_best_f1_score: 0.9215; train_kl_reg_loss: 5304864.8214; train_edge_recon_loss: 1196757.2054; train_gene_expr_recon_loss: 772087085.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 778588699.4286; train_optim_loss: 778588699.4286; val_kl_reg_loss: 5325791.2500; val_edge_recon_loss: 1181189.3125; val_gene_expr_recon_loss: 769918560.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 776425536.0000; val_optim_loss: 776425536.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9223; val_auprc_score: 0.9817; val_best_acc_score: 0.8513; val_best_f1_score: 0.9197; train_kl_reg_loss: 382433.2234; train_edge_recon_loss: 1185900.7656; train_gene_expr_recon_loss: 45008803.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46577137.3000; train_optim_loss: 46577137.3000; val_kl_reg_loss: 351517.3063; val_edge_recon_loss: 1207403.6250; val_gene_expr_recon_loss: 43438170.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44997091.2000; val_optim_loss: 44997091.2000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8919; val_auprc_score: 0.9718; val_best_acc_score: 0.8530; val_best_f1_score: 0.9207; train_kl_reg_loss: 896322.2797; train_edge_recon_loss: 1172847.7688; train_gene_expr_recon_loss: 107700870.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 109770040.3000; train_optim_loss: 109770040.3000; val_kl_reg_loss: 1217846.9000; val_edge_recon_loss: 1207277.7750; val_gene_expr_recon_loss: 50687468.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53112592.0000; val_optim_loss: 53112592.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.7534; val_auprc_score: 0.9211; val_best_acc_score: 0.8509; val_best_f1_score: 0.9194; train_kl_reg_loss: 5351973.0000; train_edge_recon_loss: 1187721.2321; train_gene_expr_recon_loss: 769619716.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 776159405.7143; train_optim_loss: 776159405.7143; val_kl_reg_loss: 5302707.0000; val_edge_recon_loss: 1211402.5000; val_gene_expr_recon_loss: 766867552.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 773381664.0000; val_optim_loss: 773381664.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8984; val_auprc_score: 0.9744; val_best_acc_score: 0.8534; val_best_f1_score: 0.9209; train_kl_reg_loss: 1173238.8781; train_edge_recon_loss: 1190987.5000; train_gene_expr_recon_loss: 48597807.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50962034.2000; train_optim_loss: 50962034.2000; val_kl_reg_loss: 1027008.0500; val_edge_recon_loss: 1200117.6250; val_gene_expr_recon_loss: 47733848.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49960974.4000; val_optim_loss: 49960974.4000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.7587; val_auprc_score: 0.9252; val_best_acc_score: 0.8553; val_best_f1_score: 0.9220; train_kl_reg_loss: 5295571.7857; train_edge_recon_loss: 1198981.4554; train_gene_expr_recon_loss: 768774400.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 775268950.8571; train_optim_loss: 775268950.8571; val_kl_reg_loss: 5216358.0000; val_edge_recon_loss: 1168945.4375; val_gene_expr_recon_loss: 767935776.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 774321056.0000; val_optim_loss: 774321056.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8997; val_auprc_score: 0.9746; val_best_acc_score: 0.8494; val_best_f1_score: 0.9186; train_kl_reg_loss: 925191.1562; train_edge_recon_loss: 1195232.6375; train_gene_expr_recon_loss: 47452885.1000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49573309.0000; train_optim_loss: 49573309.0000; val_kl_reg_loss: 802498.8250; val_edge_recon_loss: 1228864.5000; val_gene_expr_recon_loss: 47078776.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49110139.2000; val_optim_loss: 49110139.2000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.7594; val_auprc_score: 0.9239; val_best_acc_score: 0.8525; val_best_f1_score: 0.9204; train_kl_reg_loss: 5205682.7143; train_edge_recon_loss: 1201947.8482; train_gene_expr_recon_loss: 768327648.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 774735277.7143; train_optim_loss: 774735277.7143; val_kl_reg_loss: 5141019.7500; val_edge_recon_loss: 1189676.5625; val_gene_expr_recon_loss: 766756992.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 773087712.0000; val_optim_loss: 773087712.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8946; val_auprc_score: 0.9744; val_best_acc_score: 0.8493; val_best_f1_score: 0.9185; train_kl_reg_loss: 720120.3328; train_edge_recon_loss: 1200784.8313; train_gene_expr_recon_loss: 46965916.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48886821.7000; train_optim_loss: 48886821.7000; val_kl_reg_loss: 621427.8375; val_edge_recon_loss: 1214754.8500; val_gene_expr_recon_loss: 46772063.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48608245.6000; val_optim_loss: 48608245.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8975; val_auprc_score: 0.9754; val_best_acc_score: 0.8506; val_best_f1_score: 0.9192; train_kl_reg_loss: 624603.2250; train_edge_recon_loss: 1184347.1547; train_gene_expr_recon_loss: 46787571.9000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48596522.4000; train_optim_loss: 48596522.4000; val_kl_reg_loss: 607391.7125; val_edge_recon_loss: 1233486.6750; val_gene_expr_recon_loss: 46714510.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48555388.8000; val_optim_loss: 48555388.8000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9023; val_auprc_score: 0.9775; val_best_acc_score: 0.8539; val_best_f1_score: 0.9212; train_kl_reg_loss: 608933.6844; train_edge_recon_loss: 1200078.0156; train_gene_expr_recon_loss: 46746333.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48555345.4000; train_optim_loss: 48555345.4000; val_kl_reg_loss: 592983.0375; val_edge_recon_loss: 1194068.5000; val_gene_expr_recon_loss: 46703683.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48490735.2000; val_optim_loss: 48490735.2000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8994; val_auprc_score: 0.9762; val_best_acc_score: 0.8548; val_best_f1_score: 0.9217; train_kl_reg_loss: 593786.9437; train_edge_recon_loss: 1184808.4625; train_gene_expr_recon_loss: 46712490.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48491085.8000; train_optim_loss: 48491085.8000; val_kl_reg_loss: 575780.4500; val_edge_recon_loss: 1190637.8500; val_gene_expr_recon_loss: 46649189.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48415608.0000; val_optim_loss: 48415608.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8942; val_auprc_score: 0.9757; val_best_acc_score: 0.8556; val_best_f1_score: 0.9222; train_kl_reg_loss: 577086.3422; train_edge_recon_loss: 1193931.5234; train_gene_expr_recon_loss: 46671688.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48442706.6000; train_optim_loss: 48442706.6000; val_kl_reg_loss: 558830.9875; val_edge_recon_loss: 1168261.4000; val_gene_expr_recon_loss: 46523139.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48250230.4000; val_optim_loss: 48250230.4000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 13 sec.
Using best model state, which was in epoch 4.

--- MODEL EVALUATION ---
val AUROC score: 0.9247
val AUPRC score: 0.9820
val best accuracy score: 0.8456
val best F1 score: 0.9163
val target rna MSE score: 40.4286
val source rna MSE score: 62.7416
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 6: 0 hours, 2 minutes and 20 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1490, n_latent: 1480, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1480, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1480, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 80320
Number of validation edges: 8924
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9272; val_auprc_score: 0.9823; val_best_acc_score: 0.8535; val_best_f1_score: 0.9209; train_kl_reg_loss: 3381804.7199; train_edge_recon_loss: 1148947.1156; train_gene_expr_recon_loss: 201540956.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 206071707.4000; train_optim_loss: 206071707.4000; val_kl_reg_loss: 490062.0250; val_edge_recon_loss: 1189762.1750; val_gene_expr_recon_loss: 53136221.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54816044.8000; val_optim_loss: 54816044.8000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9233; val_auprc_score: 0.9810; val_best_acc_score: 0.8516; val_best_f1_score: 0.9199; train_kl_reg_loss: 490128.0242; train_edge_recon_loss: 1184907.5437; train_gene_expr_recon_loss: 50253871.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51928907.4000; train_optim_loss: 51928907.4000; val_kl_reg_loss: 463586.5312; val_edge_recon_loss: 1196543.2500; val_gene_expr_recon_loss: 47789628.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49449756.8000; val_optim_loss: 49449756.8000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9265; val_auprc_score: 0.9831; val_best_acc_score: 0.8553; val_best_f1_score: 0.9220; train_kl_reg_loss: 450569.9234; train_edge_recon_loss: 1197167.5500; train_gene_expr_recon_loss: 44913408.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46561146.0000; train_optim_loss: 46561146.0000; val_kl_reg_loss: 420681.2875; val_edge_recon_loss: 1158335.4500; val_gene_expr_recon_loss: 41781932.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43360949.6000; val_optim_loss: 43360949.6000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9217; val_auprc_score: 0.9815; val_best_acc_score: 0.8573; val_best_f1_score: 0.9232; train_kl_reg_loss: 450804.5664; train_edge_recon_loss: 1202259.7844; train_gene_expr_recon_loss: 39794597.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41447661.2000; train_optim_loss: 41447661.2000; val_kl_reg_loss: 483628.7875; val_edge_recon_loss: 1153986.7250; val_gene_expr_recon_loss: 38513141.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40150757.6000; val_optim_loss: 40150757.6000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9218; val_auprc_score: 0.9815; val_best_acc_score: 0.8564; val_best_f1_score: 0.9227; train_kl_reg_loss: 508357.6594; train_edge_recon_loss: 1208844.2625; train_gene_expr_recon_loss: 37932600.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39649803.0000; train_optim_loss: 39649803.0000; val_kl_reg_loss: 531528.0375; val_edge_recon_loss: 1172895.6000; val_gene_expr_recon_loss: 37607040.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39311464.0000; val_optim_loss: 39311464.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9218; val_auprc_score: 0.9817; val_best_acc_score: 0.8532; val_best_f1_score: 0.9208; train_kl_reg_loss: 511358.4234; train_edge_recon_loss: 1201528.5875; train_gene_expr_recon_loss: 37304821.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39017708.6000; train_optim_loss: 39017708.6000; val_kl_reg_loss: 470190.9062; val_edge_recon_loss: 1211299.9250; val_gene_expr_recon_loss: 37153940.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38835430.4000; val_optim_loss: 38835430.4000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9154; val_auprc_score: 0.9810; val_best_acc_score: 0.8552; val_best_f1_score: 0.9219; train_kl_reg_loss: 445070.6023; train_edge_recon_loss: 1201840.4750; train_gene_expr_recon_loss: 36944506.9000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 38591418.2000; train_optim_loss: 38591418.2000; val_kl_reg_loss: 406714.9437; val_edge_recon_loss: 1155583.9750; val_gene_expr_recon_loss: 36871864.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38434163.2000; val_optim_loss: 38434163.2000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9128; val_auprc_score: 0.9806; val_best_acc_score: 0.8539; val_best_f1_score: 0.9212; train_kl_reg_loss: 386850.8570; train_edge_recon_loss: 1199834.4062; train_gene_expr_recon_loss: 36687213.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 38273898.5000; train_optim_loss: 38273898.5000; val_kl_reg_loss: 352781.1813; val_edge_recon_loss: 1187900.8500; val_gene_expr_recon_loss: 36587405.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38128088.0000; val_optim_loss: 38128088.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9093; val_auprc_score: 0.9792; val_best_acc_score: 0.8486; val_best_f1_score: 0.9181; train_kl_reg_loss: 340423.7836; train_edge_recon_loss: 1193460.4594; train_gene_expr_recon_loss: 36491069.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 38024954.1000; train_optim_loss: 38024954.1000; val_kl_reg_loss: 315169.7188; val_edge_recon_loss: 1209011.1750; val_gene_expr_recon_loss: 36459848.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 37984029.6000; val_optim_loss: 37984029.6000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8466; val_auprc_score: 0.9526; val_best_acc_score: 0.8540; val_best_f1_score: 0.9212; train_kl_reg_loss: 1146169632.2617; train_edge_recon_loss: 1145519.6641; train_gene_expr_recon_loss: 352870708.3000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1500185896.7000; train_optim_loss: 1500185896.7000; val_kl_reg_loss: 2843356.4000; val_edge_recon_loss: 1182118.2000; val_gene_expr_recon_loss: 461127756.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 465153228.8000; val_optim_loss: 465153228.8000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 58 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
val AUROC score: 0.9210
val AUPRC score: 0.9817
val best accuracy score: 0.8515
val best F1 score: 0.9198
val target rna MSE score: 22.8015
val source rna MSE score: 21.3298
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 8: 0 hours, 5 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1490, n_latent: 1480, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1480, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1480, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 106920
Number of validation edges: 11879
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9439; val_auprc_score: 0.9879; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 327121.2774; train_edge_recon_loss: 1061031.9866; train_gene_expr_recon_loss: 181704717.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 183092870.8571; train_optim_loss: 183092870.8571; val_kl_reg_loss: 141636.9844; val_edge_recon_loss: 1204834.8125; val_gene_expr_recon_loss: 64865396.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66211868.0000; val_optim_loss: 66211868.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.7663; val_auprc_score: 0.9282; val_best_acc_score: 0.8561; val_best_f1_score: 0.9225; train_kl_reg_loss: 208625435.9250; train_edge_recon_loss: 1148160.7828; train_gene_expr_recon_loss: 554409726.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 764183329.2000; train_optim_loss: 764183329.2000; val_kl_reg_loss: 5441672.8000; val_edge_recon_loss: 1169001.0750; val_gene_expr_recon_loss: 92601971.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 99212644.8000; val_optim_loss: 99212644.8000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9355; val_auprc_score: 0.9850; val_best_acc_score: 0.8525; val_best_f1_score: 0.9204; train_kl_reg_loss: 232222.4821; train_edge_recon_loss: 1158326.3080; train_gene_expr_recon_loss: 62675576.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 64066126.0000; train_optim_loss: 64066126.0000; val_kl_reg_loss: 255977.0859; val_edge_recon_loss: 1188675.6250; val_gene_expr_recon_loss: 55906036.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57350688.0000; val_optim_loss: 57350688.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.7352; val_auprc_score: 0.9163; val_best_acc_score: 0.8516; val_best_f1_score: 0.9199; train_kl_reg_loss: 23503046237.2625; train_edge_recon_loss: 1182599.9438; train_gene_expr_recon_loss: 180036827.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 23684266035.2000; train_optim_loss: 23684266035.2000; val_kl_reg_loss: 6395762.0000; val_edge_recon_loss: 1215331.7750; val_gene_expr_recon_loss: 67856566.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 75467660.8000; val_optim_loss: 75467660.8000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9329; val_auprc_score: 0.9836; val_best_acc_score: 0.8490; val_best_f1_score: 0.9184; train_kl_reg_loss: 281586.4777; train_edge_recon_loss: 1205861.9196; train_gene_expr_recon_loss: 53054565.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54542013.1429; train_optim_loss: 54542013.1429; val_kl_reg_loss: 297344.4688; val_edge_recon_loss: 1222137.7500; val_gene_expr_recon_loss: 53050290.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54569772.0000; val_optim_loss: 54569772.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.7370; val_auprc_score: 0.9174; val_best_acc_score: 0.8527; val_best_f1_score: 0.9205; train_kl_reg_loss: 53667701.3000; train_edge_recon_loss: 1192861.2219; train_gene_expr_recon_loss: 112569360.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 167429921.8000; train_optim_loss: 167429921.8000; val_kl_reg_loss: 5570989.7000; val_edge_recon_loss: 1188179.5250; val_gene_expr_recon_loss: 61205565.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 67964734.4000; val_optim_loss: 67964734.4000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9275; val_auprc_score: 0.9822; val_best_acc_score: 0.8513; val_best_f1_score: 0.9197; train_kl_reg_loss: 323581.8415; train_edge_recon_loss: 1203506.6339; train_gene_expr_recon_loss: 51955842.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53482930.5714; train_optim_loss: 53482930.5714; val_kl_reg_loss: 341119.6875; val_edge_recon_loss: 1204460.6250; val_gene_expr_recon_loss: 51281904.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52827484.0000; val_optim_loss: 52827484.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.7407; val_auprc_score: 0.9165; val_best_acc_score: 0.8493; val_best_f1_score: 0.9185; train_kl_reg_loss: 5578705.8000; train_edge_recon_loss: 1182974.4312; train_gene_expr_recon_loss: 59961189.1000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 66722869.3000; train_optim_loss: 66722869.3000; val_kl_reg_loss: 5384310.5000; val_edge_recon_loss: 1234390.9000; val_gene_expr_recon_loss: 59599905.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66218607.2000; val_optim_loss: 66218607.2000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9315; val_auprc_score: 0.9835; val_best_acc_score: 0.8533; val_best_f1_score: 0.9208; train_kl_reg_loss: 347322.0714; train_edge_recon_loss: 1185770.1607; train_gene_expr_recon_loss: 50792663.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52325755.7143; train_optim_loss: 52325755.7143; val_kl_reg_loss: 367883.3750; val_edge_recon_loss: 1190276.7500; val_gene_expr_recon_loss: 50424512.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51982672.0000; val_optim_loss: 51982672.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.7587; val_auprc_score: 0.9221; val_best_acc_score: 0.8494; val_best_f1_score: 0.9186; train_kl_reg_loss: 5387151.0125; train_edge_recon_loss: 1192358.9000; train_gene_expr_recon_loss: 59279705.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 65859215.4000; train_optim_loss: 65859215.4000; val_kl_reg_loss: 5213726.8000; val_edge_recon_loss: 1209890.2750; val_gene_expr_recon_loss: 59252211.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 65675828.8000; val_optim_loss: 65675828.8000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9277; val_auprc_score: 0.9824; val_best_acc_score: 0.8532; val_best_f1_score: 0.9208; train_kl_reg_loss: 347255.1607; train_edge_recon_loss: 1205106.6607; train_gene_expr_recon_loss: 50107400.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51659762.2857; train_optim_loss: 51659762.2857; val_kl_reg_loss: 340776.7344; val_edge_recon_loss: 1201184.8125; val_gene_expr_recon_loss: 49863928.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51405890.0000; val_optim_loss: 51405890.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.7467; val_auprc_score: 0.9199; val_best_acc_score: 0.8521; val_best_f1_score: 0.9201; train_kl_reg_loss: 5203348.4625; train_edge_recon_loss: 1193083.6375; train_gene_expr_recon_loss: 58957393.3000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 65353825.5000; train_optim_loss: 65353825.5000; val_kl_reg_loss: 5039313.2000; val_edge_recon_loss: 1198597.7750; val_gene_expr_recon_loss: 59023577.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 65261488.8000; val_optim_loss: 65261488.8000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9321; val_auprc_score: 0.9839; val_best_acc_score: 0.8568; val_best_f1_score: 0.9229; train_kl_reg_loss: 340808.8683; train_edge_recon_loss: 1187513.5000; train_gene_expr_recon_loss: 49538728.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51067050.8571; train_optim_loss: 51067050.8571; val_kl_reg_loss: 335080.2812; val_edge_recon_loss: 1173967.5000; val_gene_expr_recon_loss: 49294076.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50803124.0000; val_optim_loss: 50803124.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.7450; val_auprc_score: 0.9204; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 5031197.8125; train_edge_recon_loss: 1197703.1500; train_gene_expr_recon_loss: 58579339.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 64808240.8000; train_optim_loss: 64808240.8000; val_kl_reg_loss: 4859428.0000; val_edge_recon_loss: 1195020.5250; val_gene_expr_recon_loss: 58305104.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 64359552.8000; val_optim_loss: 64359552.8000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9251; val_auprc_score: 0.9824; val_best_acc_score: 0.8584; val_best_f1_score: 0.9238; train_kl_reg_loss: 333970.4375; train_edge_recon_loss: 1202933.3393; train_gene_expr_recon_loss: 48937278.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50474182.2857; train_optim_loss: 50474182.2857; val_kl_reg_loss: 328482.3438; val_edge_recon_loss: 1158308.3125; val_gene_expr_recon_loss: 48668626.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50155416.0000; val_optim_loss: 50155416.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9304; val_auprc_score: 0.9839; val_best_acc_score: 0.8566; val_best_f1_score: 0.9227; train_kl_reg_loss: 325928.3482; train_edge_recon_loss: 1202379.2857; train_gene_expr_recon_loss: 48275256.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49803562.8571; train_optim_loss: 49803562.8571; val_kl_reg_loss: 321180.3281; val_edge_recon_loss: 1168914.5625; val_gene_expr_recon_loss: 47973692.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49463788.0000; val_optim_loss: 49463788.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9314; val_auprc_score: 0.9835; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 317695.5848; train_edge_recon_loss: 1208907.1161; train_gene_expr_recon_loss: 47532335.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49058938.0000; train_optim_loss: 49058938.0000; val_kl_reg_loss: 330788.3750; val_edge_recon_loss: 1196407.4375; val_gene_expr_recon_loss: 47153438.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48680634.0000; val_optim_loss: 48680634.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9313; val_auprc_score: 0.9842; val_best_acc_score: 0.8560; val_best_f1_score: 0.9224; train_kl_reg_loss: 309142.7165; train_edge_recon_loss: 1188509.5089; train_gene_expr_recon_loss: 46663020.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48160672.8571; train_optim_loss: 48160672.8571; val_kl_reg_loss: 301110.8125; val_edge_recon_loss: 1172999.1250; val_gene_expr_recon_loss: 46229152.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47703262.0000; val_optim_loss: 47703262.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9283; val_auprc_score: 0.9832; val_best_acc_score: 0.8565; val_best_f1_score: 0.9227; train_kl_reg_loss: 302590.0804; train_edge_recon_loss: 1192557.1161; train_gene_expr_recon_loss: 45717187.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47212334.5714; train_optim_loss: 47212334.5714; val_kl_reg_loss: 292270.7812; val_edge_recon_loss: 1171409.5000; val_gene_expr_recon_loss: 45239792.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46703472.0000; val_optim_loss: 46703472.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 8 sec.
Using best model state, which was in epoch 9.

--- MODEL EVALUATION ---
val AUROC score: 0.9107
val AUPRC score: 0.9803
val best accuracy score: 0.8539
val best F1 score: 0.9212
val target rna MSE score: 18.4721
val source rna MSE score: 18.0724
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 5: 0 hours, 3 minutes and 14 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1492, n_latent: 1482, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1482, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1482, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 53693
Number of validation edges: 5965
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9255; val_auprc_score: 0.9834; val_best_acc_score: 0.8585; val_best_f1_score: 0.9239; train_kl_reg_loss: 276590.7953; train_edge_recon_loss: 1114883.4676; train_gene_expr_recon_loss: 89289880.5926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 90681354.8148; train_optim_loss: 90681354.8148; val_kl_reg_loss: 361754.5938; val_edge_recon_loss: 1149853.1667; val_gene_expr_recon_loss: 61443360.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62954968.0000; val_optim_loss: 62954968.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9284; val_auprc_score: 0.9830; val_best_acc_score: 0.8506; val_best_f1_score: 0.9192; train_kl_reg_loss: 304897.2254; train_edge_recon_loss: 1192407.5893; train_gene_expr_recon_loss: 44770447.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46267752.5714; train_optim_loss: 46267752.5714; val_kl_reg_loss: 285224.1719; val_edge_recon_loss: 1219754.6250; val_gene_expr_recon_loss: 44285074.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45790054.0000; val_optim_loss: 45790054.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9220; val_auprc_score: 0.9810; val_best_acc_score: 0.8506; val_best_f1_score: 0.9192; train_kl_reg_loss: 397928.0961; train_edge_recon_loss: 1190906.6204; train_gene_expr_recon_loss: 57511855.4074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59100690.0741; train_optim_loss: 59100690.0741; val_kl_reg_loss: 403111.5729; val_edge_recon_loss: 1213490.7500; val_gene_expr_recon_loss: 55686885.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57303486.6667; val_optim_loss: 57303486.6667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9251; val_auprc_score: 0.9820; val_best_acc_score: 0.8502; val_best_f1_score: 0.9190; train_kl_reg_loss: 284698.8460; train_edge_recon_loss: 1204232.2589; train_gene_expr_recon_loss: 45032957.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46521888.2857; train_optim_loss: 46521888.2857; val_kl_reg_loss: 294403.9375; val_edge_recon_loss: 1227526.4375; val_gene_expr_recon_loss: 43476766.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44998696.0000; val_optim_loss: 44998696.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9275; val_auprc_score: 0.9831; val_best_acc_score: 0.8491; val_best_f1_score: 0.9184; train_kl_reg_loss: 404437.2245; train_edge_recon_loss: 1193917.5602; train_gene_expr_recon_loss: 54745972.5926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56344327.4074; train_optim_loss: 56344327.4074; val_kl_reg_loss: 389958.4688; val_edge_recon_loss: 1224958.6250; val_gene_expr_recon_loss: 54017312.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55632228.0000; val_optim_loss: 55632228.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9266; val_auprc_score: 0.9824; val_best_acc_score: 0.8463; val_best_f1_score: 0.9168; train_kl_reg_loss: 385330.4201; train_edge_recon_loss: 1213251.5602; train_gene_expr_recon_loss: 53000607.4074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54599189.6296; train_optim_loss: 54599189.6296; val_kl_reg_loss: 364363.4688; val_edge_recon_loss: 1250676.6250; val_gene_expr_recon_loss: 52336464.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53951502.6667; val_optim_loss: 53951502.6667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9054; val_auprc_score: 0.9740; val_best_acc_score: 0.8568; val_best_f1_score: 0.9229; train_kl_reg_loss: 618914.6964; train_edge_recon_loss: 1166112.3214; train_gene_expr_recon_loss: 144823652.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 146608679.1429; train_optim_loss: 146608679.1429; val_kl_reg_loss: 896332.2812; val_edge_recon_loss: 1160326.5000; val_gene_expr_recon_loss: 56098784.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58155444.0000; val_optim_loss: 58155444.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9122; val_auprc_score: 0.9768; val_best_acc_score: 0.8504; val_best_f1_score: 0.9192; train_kl_reg_loss: 471220.3993; train_edge_recon_loss: 1191761.6389; train_gene_expr_recon_loss: 57716471.7037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59379453.9259; train_optim_loss: 59379453.9259; val_kl_reg_loss: 764510.4583; val_edge_recon_loss: 1217242.7083; val_gene_expr_recon_loss: 55332328.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57314080.0000; val_optim_loss: 57314080.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8750; val_auprc_score: 0.9623; val_best_acc_score: 0.8535; val_best_f1_score: 0.9210; train_kl_reg_loss: 1177760.8929; train_edge_recon_loss: 1203590.5357; train_gene_expr_recon_loss: 55892423.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58273775.4286; train_optim_loss: 58273775.4286; val_kl_reg_loss: 1389005.4375; val_edge_recon_loss: 1199374.3125; val_gene_expr_recon_loss: 53834054.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56422434.0000; val_optim_loss: 56422434.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9081; val_auprc_score: 0.9754; val_best_acc_score: 0.8534; val_best_f1_score: 0.9209; train_kl_reg_loss: 980318.9769; train_edge_recon_loss: 1193353.6574; train_gene_expr_recon_loss: 53363725.1852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55537398.5185; train_optim_loss: 55537398.5185; val_kl_reg_loss: 1046426.3750; val_edge_recon_loss: 1191961.0000; val_gene_expr_recon_loss: 51641245.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53879632.0000; val_optim_loss: 53879632.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9017; val_auprc_score: 0.9731; val_best_acc_score: 0.8495; val_best_f1_score: 0.9186; train_kl_reg_loss: 1030629.3079; train_edge_recon_loss: 1193143.7407; train_gene_expr_recon_loss: 50066500.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52290273.3333; train_optim_loss: 52290273.3333; val_kl_reg_loss: 964358.2917; val_edge_recon_loss: 1225789.0417; val_gene_expr_recon_loss: 48506029.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50696177.3333; val_optim_loss: 50696177.3333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8645; val_auprc_score: 0.9578; val_best_acc_score: 0.8506; val_best_f1_score: 0.9192; train_kl_reg_loss: 1512447.2946; train_edge_recon_loss: 1200437.0357; train_gene_expr_recon_loss: 53104714.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55817599.1429; train_optim_loss: 55817599.1429; val_kl_reg_loss: 1579189.1875; val_edge_recon_loss: 1213637.3125; val_gene_expr_recon_loss: 52209016.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55001842.0000; val_optim_loss: 55001842.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9008; val_auprc_score: 0.9739; val_best_acc_score: 0.8541; val_best_f1_score: 0.9213; train_kl_reg_loss: 938065.6389; train_edge_recon_loss: 1207912.8889; train_gene_expr_recon_loss: 47184827.8519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49330806.2222; train_optim_loss: 49330806.2222; val_kl_reg_loss: 873969.3542; val_edge_recon_loss: 1185927.2083; val_gene_expr_recon_loss: 46029096.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48088993.3333; val_optim_loss: 48088993.3333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8659; val_auprc_score: 0.9599; val_best_acc_score: 0.8560; val_best_f1_score: 0.9224; train_kl_reg_loss: 1598550.2679; train_edge_recon_loss: 1195488.7589; train_gene_expr_recon_loss: 51648769.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54442808.8571; train_optim_loss: 54442808.8571; val_kl_reg_loss: 1577425.2500; val_edge_recon_loss: 1180900.8750; val_gene_expr_recon_loss: 51320100.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54078426.0000; val_optim_loss: 54078426.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9013; val_auprc_score: 0.9742; val_best_acc_score: 0.8508; val_best_f1_score: 0.9194; train_kl_reg_loss: 848598.7731; train_edge_recon_loss: 1171978.3611; train_gene_expr_recon_loss: 45204379.4074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47224956.7407; train_optim_loss: 47224956.7407; val_kl_reg_loss: 788416.5208; val_edge_recon_loss: 1212267.7917; val_gene_expr_recon_loss: 44491810.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46492496.0000; val_optim_loss: 46492496.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9013; val_auprc_score: 0.9764; val_best_acc_score: 0.8603; val_best_f1_score: 0.9249; train_kl_reg_loss: 766508.0324; train_edge_recon_loss: 1194916.7616; train_gene_expr_recon_loss: 44062960.5926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46024385.3333; train_optim_loss: 46024385.3333; val_kl_reg_loss: 714457.2917; val_edge_recon_loss: 1134420.3333; val_gene_expr_recon_loss: 43711756.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45560634.6667; val_optim_loss: 45560634.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8779; val_auprc_score: 0.9643; val_best_acc_score: 0.8574; val_best_f1_score: 0.9233; train_kl_reg_loss: 1583810.3661; train_edge_recon_loss: 1210755.4911; train_gene_expr_recon_loss: 51119624.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53914190.0000; train_optim_loss: 53914190.0000; val_kl_reg_loss: 1571708.2500; val_edge_recon_loss: 1164247.1875; val_gene_expr_recon_loss: 51158790.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53894746.0000; val_optim_loss: 53894746.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8962; val_auprc_score: 0.9735; val_best_acc_score: 0.8486; val_best_f1_score: 0.9181; train_kl_reg_loss: 694025.7315; train_edge_recon_loss: 1196988.2685; train_gene_expr_recon_loss: 43441309.9259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45332324.0000; train_optim_loss: 45332324.0000; val_kl_reg_loss: 646546.5417; val_edge_recon_loss: 1231287.4167; val_gene_expr_recon_loss: 43244712.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45122545.3333; val_optim_loss: 45122545.3333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8994; val_auprc_score: 0.9758; val_best_acc_score: 0.8524; val_best_f1_score: 0.9203; train_kl_reg_loss: 627896.1088; train_edge_recon_loss: 1210574.6944; train_gene_expr_recon_loss: 43029415.4074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44867886.2222; train_optim_loss: 44867886.2222; val_kl_reg_loss: 584776.6667; val_edge_recon_loss: 1199964.5417; val_gene_expr_recon_loss: 42873950.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44658692.0000; val_optim_loss: 44658692.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8617; val_auprc_score: 0.9574; val_best_acc_score: 0.8518; val_best_f1_score: 0.9200; train_kl_reg_loss: 1579327.6518; train_edge_recon_loss: 1179730.7054; train_gene_expr_recon_loss: 51028675.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53787733.7143; train_optim_loss: 53787733.7143; val_kl_reg_loss: 1562969.8125; val_edge_recon_loss: 1208274.2500; val_gene_expr_recon_loss: 51096376.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53867620.0000; val_optim_loss: 53867620.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8911; val_auprc_score: 0.9749; val_best_acc_score: 0.8572; val_best_f1_score: 0.9231; train_kl_reg_loss: 569122.5394; train_edge_recon_loss: 1193275.6898; train_gene_expr_recon_loss: 42729572.7407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44491971.1111; train_optim_loss: 44491971.1111; val_kl_reg_loss: 530891.2083; val_edge_recon_loss: 1161190.7500; val_gene_expr_recon_loss: 42619862.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44311945.3333; val_optim_loss: 44311945.3333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8632; val_auprc_score: 0.9567; val_best_acc_score: 0.8483; val_best_f1_score: 0.9179; train_kl_reg_loss: 1569343.1339; train_edge_recon_loss: 1197503.0893; train_gene_expr_recon_loss: 50969579.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53736426.0000; train_optim_loss: 53736426.0000; val_kl_reg_loss: 1553252.2500; val_edge_recon_loss: 1233897.6875; val_gene_expr_recon_loss: 51007602.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53794752.0000; val_optim_loss: 53794752.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8962; val_auprc_score: 0.9754; val_best_acc_score: 0.8496; val_best_f1_score: 0.9187; train_kl_reg_loss: 515925.4363; train_edge_recon_loss: 1195282.8380; train_gene_expr_recon_loss: 42488825.0370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44200033.4815; train_optim_loss: 44200033.4815; val_kl_reg_loss: 480836.5625; val_edge_recon_loss: 1224410.7083; val_gene_expr_recon_loss: 42414396.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44119642.6667; val_optim_loss: 44119642.6667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8840; val_auprc_score: 0.9737; val_best_acc_score: 0.8563; val_best_f1_score: 0.9226; train_kl_reg_loss: 467448.3924; train_edge_recon_loss: 1181261.5532; train_gene_expr_recon_loss: 42247194.9630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43895904.7407; train_optim_loss: 43895904.7407; val_kl_reg_loss: 437702.6146; val_edge_recon_loss: 1168827.3750; val_gene_expr_recon_loss: 42192112.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43798642.6667; val_optim_loss: 43798642.6667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8640; val_auprc_score: 0.9590; val_best_acc_score: 0.8542; val_best_f1_score: 0.9214; train_kl_reg_loss: 1561267.2321; train_edge_recon_loss: 1207527.8750; train_gene_expr_recon_loss: 50906154.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53674949.7143; train_optim_loss: 53674949.7143; val_kl_reg_loss: 1551887.3750; val_edge_recon_loss: 1186188.1875; val_gene_expr_recon_loss: 51018724.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53756798.0000; val_optim_loss: 53756798.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8902; val_auprc_score: 0.9759; val_best_acc_score: 0.8536; val_best_f1_score: 0.9210; train_kl_reg_loss: 424699.5428; train_edge_recon_loss: 1214321.2731; train_gene_expr_recon_loss: 42081894.3704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43720914.8148; train_optim_loss: 43720914.8148; val_kl_reg_loss: 395913.3333; val_edge_recon_loss: 1191257.1250; val_gene_expr_recon_loss: 42026034.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43613205.3333; val_optim_loss: 43613205.3333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8829; val_auprc_score: 0.9740; val_best_acc_score: 0.8504; val_best_f1_score: 0.9192; train_kl_reg_loss: 386261.9653; train_edge_recon_loss: 1185343.5602; train_gene_expr_recon_loss: 41889019.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43460625.0370; train_optim_loss: 43460625.0370; val_kl_reg_loss: 360459.9688; val_edge_recon_loss: 1216328.9167; val_gene_expr_recon_loss: 41794856.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43371644.0000; val_optim_loss: 43371644.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8779; val_auprc_score: 0.9745; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 353043.7025; train_edge_recon_loss: 1189431.3380; train_gene_expr_recon_loss: 41737049.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43279524.8889; train_optim_loss: 43279524.8889; val_kl_reg_loss: 329613.3958; val_edge_recon_loss: 1182293.6667; val_gene_expr_recon_loss: 41633118.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43145026.6667; val_optim_loss: 43145026.6667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8714; val_auprc_score: 0.9719; val_best_acc_score: 0.8509; val_best_f1_score: 0.9195; train_kl_reg_loss: 329127.5660; train_edge_recon_loss: 1189108.5556; train_gene_expr_recon_loss: 41542571.4074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43060807.2593; train_optim_loss: 43060807.2593; val_kl_reg_loss: 302128.5625; val_edge_recon_loss: 1210507.8333; val_gene_expr_recon_loss: 41475392.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42988028.0000; val_optim_loss: 42988028.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8538; val_auprc_score: 0.9571; val_best_acc_score: 0.8541; val_best_f1_score: 0.9213; train_kl_reg_loss: 651993825.3403; train_edge_recon_loss: 1143832.1968; train_gene_expr_recon_loss: 468433972.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1121571643.2593; train_optim_loss: 1121571643.2593; val_kl_reg_loss: 2108415.2500; val_edge_recon_loss: 1186347.2083; val_gene_expr_recon_loss: 122347549.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 125642312.0000; val_optim_loss: 125642312.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8210; val_auprc_score: 0.9440; val_best_acc_score: 0.8509; val_best_f1_score: 0.9195; train_kl_reg_loss: 8286690.1296; train_edge_recon_loss: 1187455.2083; train_gene_expr_recon_loss: 194866620.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 204340764.7407; train_optim_loss: 204340764.7407; val_kl_reg_loss: 3552478.6667; val_edge_recon_loss: 1212732.0417; val_gene_expr_recon_loss: 64965360.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 69730570.6667; val_optim_loss: 69730570.6667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8075; val_auprc_score: 0.9429; val_best_acc_score: 0.8599; val_best_f1_score: 0.9247; train_kl_reg_loss: 325642324.6111; train_edge_recon_loss: 1189009.7662; train_gene_expr_recon_loss: 237091531.7037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 563922873.3333; train_optim_loss: 563922873.3333; val_kl_reg_loss: 4134291.0833; val_edge_recon_loss: 1138223.7500; val_gene_expr_recon_loss: 624789760.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 630062272.0000; val_optim_loss: 630062272.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.7349; val_auprc_score: 0.9214; val_best_acc_score: 0.8598; val_best_f1_score: 0.9246; train_kl_reg_loss: 764276453026.8704; train_edge_recon_loss: 1176917.7963; train_gene_expr_recon_loss: 342203776.2963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 764619884475.8518; train_optim_loss: 764619884475.8518; val_kl_reg_loss: 10666234.3333; val_edge_recon_loss: 1139655.7083; val_gene_expr_recon_loss: 100365808.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 112171701.3333; val_optim_loss: 112171701.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.7492; val_auprc_score: 0.9210; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 10880291.9630; train_edge_recon_loss: 1182047.9398; train_gene_expr_recon_loss: 82962412.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 95024752.2963; train_optim_loss: 95024752.2963; val_kl_reg_loss: 10641580.3333; val_edge_recon_loss: 1202205.6250; val_gene_expr_recon_loss: 75141845.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 86985632.0000; val_optim_loss: 86985632.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.7605; val_auprc_score: 0.9290; val_best_acc_score: 0.8604; val_best_f1_score: 0.9249; train_kl_reg_loss: 10750580.2593; train_edge_recon_loss: 1215715.6296; train_gene_expr_recon_loss: 72695060.1481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 84661356.1481; train_optim_loss: 84661356.1481; val_kl_reg_loss: 10471234.6667; val_edge_recon_loss: 1135733.2500; val_gene_expr_recon_loss: 70849528.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 82456493.3333; val_optim_loss: 82456493.3333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.7177; val_auprc_score: 0.9097; val_best_acc_score: 0.8491; val_best_f1_score: 0.9184; train_kl_reg_loss: 10617215.9630; train_edge_recon_loss: 1190878.7639; train_gene_expr_recon_loss: 69541873.1852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 81349968.0000; train_optim_loss: 81349968.0000; val_kl_reg_loss: 10361048.0000; val_edge_recon_loss: 1227792.6667; val_gene_expr_recon_loss: 68498320.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 80087162.6667; val_optim_loss: 80087162.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 7 sec.
Using best model state, which was in epoch 14.

--- MODEL EVALUATION ---
val AUROC score: 0.9282
val AUPRC score: 0.9835
val best accuracy score: 0.8544
val best F1 score: 0.9215
val target rna MSE score: 72.7803
val source rna MSE score: 70.4060
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 7: 0 hours, 4 minutes and 13 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1490, n_latent: 1480, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1480, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1480, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 80320
Number of validation edges: 8924
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9471; val_auprc_score: 0.9883; val_best_acc_score: 0.8526; val_best_f1_score: 0.9204; train_kl_reg_loss: 239920.2855; train_edge_recon_loss: 1061915.8250; train_gene_expr_recon_loss: 104062991.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105364826.8000; train_optim_loss: 105364826.8000; val_kl_reg_loss: 189788.4062; val_edge_recon_loss: 1215077.5625; val_gene_expr_recon_loss: 61560490.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62965356.0000; val_optim_loss: 62965356.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.7441; val_auprc_score: 0.9221; val_best_acc_score: 0.8563; val_best_f1_score: 0.9226; train_kl_reg_loss: 10521377.6667; train_edge_recon_loss: 1209518.5185; train_gene_expr_recon_loss: 67727528.2963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 79458424.2963; train_optim_loss: 79458424.2963; val_kl_reg_loss: 10258738.6667; val_edge_recon_loss: 1168004.6250; val_gene_expr_recon_loss: 67010476.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 78437218.6667; val_optim_loss: 78437218.6667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9407; val_auprc_score: 0.9848; val_best_acc_score: 0.8485; val_best_f1_score: 0.9181; train_kl_reg_loss: 310253.4734; train_edge_recon_loss: 1183021.3500; train_gene_expr_recon_loss: 57775710.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59268984.4000; train_optim_loss: 59268984.4000; val_kl_reg_loss: 428249.7812; val_edge_recon_loss: 1240306.5625; val_gene_expr_recon_loss: 53265132.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54933688.0000; val_optim_loss: 54933688.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9344; val_auprc_score: 0.9830; val_best_acc_score: 0.8535; val_best_f1_score: 0.9209; train_kl_reg_loss: 482436.2094; train_edge_recon_loss: 1190327.4000; train_gene_expr_recon_loss: 54052712.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55725476.4000; train_optim_loss: 55725476.4000; val_kl_reg_loss: 511738.8438; val_edge_recon_loss: 1155518.3750; val_gene_expr_recon_loss: 55638088.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57305346.0000; val_optim_loss: 57305346.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9329; val_auprc_score: 0.9829; val_best_acc_score: 0.8545; val_best_f1_score: 0.9216; train_kl_reg_loss: 542665.7250; train_edge_recon_loss: 1183292.7625; train_gene_expr_recon_loss: 55016912.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56742870.0000; train_optim_loss: 56742870.0000; val_kl_reg_loss: 566287.2812; val_edge_recon_loss: 1135632.8125; val_gene_expr_recon_loss: 54048968.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55750888.0000; val_optim_loss: 55750888.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9327; val_auprc_score: 0.9827; val_best_acc_score: 0.8565; val_best_f1_score: 0.9227; train_kl_reg_loss: 592017.5000; train_edge_recon_loss: 1194369.6250; train_gene_expr_recon_loss: 53985013.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55771400.4000; train_optim_loss: 55771400.4000; val_kl_reg_loss: 601903.9688; val_edge_recon_loss: 1197661.7500; val_gene_expr_recon_loss: 53074834.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54874400.0000; val_optim_loss: 54874400.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9430; val_auprc_score: 0.9853; val_best_acc_score: 0.8552; val_best_f1_score: 0.9219; train_kl_reg_loss: 666467.8812; train_edge_recon_loss: 1199519.7375; train_gene_expr_recon_loss: 52705966.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54571954.0000; train_optim_loss: 54571954.0000; val_kl_reg_loss: 737042.8438; val_edge_recon_loss: 1125085.7500; val_gene_expr_recon_loss: 52248372.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54110502.0000; val_optim_loss: 54110502.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9337; val_auprc_score: 0.9827; val_best_acc_score: 0.8583; val_best_f1_score: 0.9238; train_kl_reg_loss: 796997.5188; train_edge_recon_loss: 1202557.4500; train_gene_expr_recon_loss: 51834562.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53834117.2000; train_optim_loss: 53834117.2000; val_kl_reg_loss: 831644.5000; val_edge_recon_loss: 1156565.5000; val_gene_expr_recon_loss: 51320884.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53309094.0000; val_optim_loss: 53309094.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9330; val_auprc_score: 0.9822; val_best_acc_score: 0.8572; val_best_f1_score: 0.9231; train_kl_reg_loss: 860343.2875; train_edge_recon_loss: 1197332.5250; train_gene_expr_recon_loss: 50909207.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52966884.0000; train_optim_loss: 52966884.0000; val_kl_reg_loss: 862740.8750; val_edge_recon_loss: 1205593.7500; val_gene_expr_recon_loss: 50377768.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52446104.0000; val_optim_loss: 52446104.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 21 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
val AUROC score: 0.8724
val AUPRC score: 0.9727
val best accuracy score: 0.8529
val best F1 score: 0.9206
val target rna MSE score: 20.8233
val source rna MSE score: 16.5083
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 4: 0 hours, 3 minutes and 25 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1492, n_latent: 1482, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1482, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1482, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 53693
Number of validation edges: 5965
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9220; val_auprc_score: 0.9844; val_best_acc_score: 0.8615; val_best_f1_score: 0.9256; train_kl_reg_loss: 437362.8733; train_edge_recon_loss: 1109807.7269; train_gene_expr_recon_loss: 107788646.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 109335816.4444; train_optim_loss: 109335816.4444; val_kl_reg_loss: 335885.0938; val_edge_recon_loss: 1126065.5000; val_gene_expr_recon_loss: 52357833.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53819784.0000; val_optim_loss: 53819784.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9350; val_auprc_score: 0.9822; val_best_acc_score: 0.8527; val_best_f1_score: 0.9205; train_kl_reg_loss: 875745.7500; train_edge_recon_loss: 1194822.0000; train_gene_expr_recon_loss: 49905355.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51975924.0000; train_optim_loss: 51975924.0000; val_kl_reg_loss: 862188.9062; val_edge_recon_loss: 1271715.9375; val_gene_expr_recon_loss: 49318852.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51452758.0000; val_optim_loss: 51452758.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9236; val_auprc_score: 0.9835; val_best_acc_score: 0.8562; val_best_f1_score: 0.9225; train_kl_reg_loss: 358784.3588; train_edge_recon_loss: 1191586.8380; train_gene_expr_recon_loss: 48718128.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50268499.8519; train_optim_loss: 50268499.8519; val_kl_reg_loss: 359739.9479; val_edge_recon_loss: 1170329.8750; val_gene_expr_recon_loss: 46932877.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48462946.6667; val_optim_loss: 48462946.6667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9341; val_auprc_score: 0.9819; val_best_acc_score: 0.8527; val_best_f1_score: 0.9205; train_kl_reg_loss: 867355.5000; train_edge_recon_loss: 1183135.8750; train_gene_expr_recon_loss: 48778696.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50829188.0000; train_optim_loss: 50829188.0000; val_kl_reg_loss: 848473.5000; val_edge_recon_loss: 1151546.5625; val_gene_expr_recon_loss: 48142724.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50142744.0000; val_optim_loss: 50142744.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9247; val_auprc_score: 0.9837; val_best_acc_score: 0.8543; val_best_f1_score: 0.9214; train_kl_reg_loss: 362182.7419; train_edge_recon_loss: 1186119.4907; train_gene_expr_recon_loss: 45731880.1481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47280182.6667; train_optim_loss: 47280182.6667; val_kl_reg_loss: 346582.4167; val_edge_recon_loss: 1183793.4167; val_gene_expr_recon_loss: 44864444.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46394818.6667; val_optim_loss: 46394818.6667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9261; val_auprc_score: 0.9791; val_best_acc_score: 0.8505; val_best_f1_score: 0.9192; train_kl_reg_loss: 851463.8375; train_edge_recon_loss: 1211894.6500; train_gene_expr_recon_loss: 47558812.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49622170.4000; train_optim_loss: 49622170.4000; val_kl_reg_loss: 830340.7500; val_edge_recon_loss: 1191330.8125; val_gene_expr_recon_loss: 46881542.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48903214.0000; val_optim_loss: 48903214.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9152; val_auprc_score: 0.9803; val_best_acc_score: 0.8528; val_best_f1_score: 0.9205; train_kl_reg_loss: 344653.7106; train_edge_recon_loss: 1175688.9074; train_gene_expr_recon_loss: 43951462.3704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45471805.3333; train_optim_loss: 45471805.3333; val_kl_reg_loss: 327387.5938; val_edge_recon_loss: 1197083.7500; val_gene_expr_recon_loss: 43007225.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44531696.0000; val_optim_loss: 44531696.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9257; val_auprc_score: 0.9801; val_best_acc_score: 0.8568; val_best_f1_score: 0.9229; train_kl_reg_loss: 832051.3063; train_edge_recon_loss: 1201481.4750; train_gene_expr_recon_loss: 46273316.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48306849.6000; train_optim_loss: 48306849.6000; val_kl_reg_loss: 810491.3125; val_edge_recon_loss: 1185630.9375; val_gene_expr_recon_loss: 45616696.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47612818.0000; val_optim_loss: 47612818.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9145; val_auprc_score: 0.9805; val_best_acc_score: 0.8453; val_best_f1_score: 0.9161; train_kl_reg_loss: 326300.3981; train_edge_recon_loss: 1190914.1389; train_gene_expr_recon_loss: 41928076.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43445291.2593; train_optim_loss: 43445291.2593; val_kl_reg_loss: 309572.6979; val_edge_recon_loss: 1257826.9167; val_gene_expr_recon_loss: 40765681.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42333081.3333; val_optim_loss: 42333081.3333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9367; val_auprc_score: 0.9836; val_best_acc_score: 0.8545; val_best_f1_score: 0.9215; train_kl_reg_loss: 811936.2375; train_edge_recon_loss: 1189246.1250; train_gene_expr_recon_loss: 45027528.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47028711.2000; train_optim_loss: 47028711.2000; val_kl_reg_loss: 789408.9062; val_edge_recon_loss: 1210387.1250; val_gene_expr_recon_loss: 44418496.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46418292.0000; val_optim_loss: 46418292.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9067; val_auprc_score: 0.9788; val_best_acc_score: 0.8471; val_best_f1_score: 0.9172; train_kl_reg_loss: 323390.3403; train_edge_recon_loss: 1195308.5000; train_gene_expr_recon_loss: 39628141.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41146840.4444; train_optim_loss: 41146840.4444; val_kl_reg_loss: 287386.7292; val_edge_recon_loss: 1244177.7500; val_gene_expr_recon_loss: 38383337.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39914901.3333; val_optim_loss: 39914901.3333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9324; val_auprc_score: 0.9829; val_best_acc_score: 0.8581; val_best_f1_score: 0.9236; train_kl_reg_loss: 792083.7688; train_edge_recon_loss: 1198197.8875; train_gene_expr_recon_loss: 43887023.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45877305.6000; train_optim_loss: 45877305.6000; val_kl_reg_loss: 771019.1250; val_edge_recon_loss: 1116198.8750; val_gene_expr_recon_loss: 43355132.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45242350.0000; val_optim_loss: 45242350.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9108; val_auprc_score: 0.9814; val_best_acc_score: 0.8510; val_best_f1_score: 0.9195; train_kl_reg_loss: 284736.0382; train_edge_recon_loss: 1197259.7963; train_gene_expr_recon_loss: 37339832.2963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 38821828.0000; train_optim_loss: 38821828.0000; val_kl_reg_loss: 265040.2917; val_edge_recon_loss: 1210958.4583; val_gene_expr_recon_loss: 36374006.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 37850005.3333; val_optim_loss: 37850005.3333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9264; val_auprc_score: 0.9805; val_best_acc_score: 0.8540; val_best_f1_score: 0.9212; train_kl_reg_loss: 771778.2688; train_edge_recon_loss: 1184338.5625; train_gene_expr_recon_loss: 42900111.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44856227.6000; train_optim_loss: 44856227.6000; val_kl_reg_loss: 751378.6875; val_edge_recon_loss: 1149569.6875; val_gene_expr_recon_loss: 42479800.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44380748.0000; val_optim_loss: 44380748.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8973; val_auprc_score: 0.9758; val_best_acc_score: 0.8523; val_best_f1_score: 0.9202; train_kl_reg_loss: 329033.6968; train_edge_recon_loss: 1183497.2731; train_gene_expr_recon_loss: 41240476.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42753007.2593; train_optim_loss: 42753007.2593; val_kl_reg_loss: 377672.5625; val_edge_recon_loss: 1201473.6667; val_gene_expr_recon_loss: 35838988.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 37418134.6667; val_optim_loss: 37418134.6667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9300; val_auprc_score: 0.9814; val_best_acc_score: 0.8511; val_best_f1_score: 0.9196; train_kl_reg_loss: 752451.2750; train_edge_recon_loss: 1210351.2375; train_gene_expr_recon_loss: 42105287.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44068089.2000; train_optim_loss: 44068089.2000; val_kl_reg_loss: 731305.2500; val_edge_recon_loss: 1236045.2500; val_gene_expr_recon_loss: 41772908.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43740258.0000; val_optim_loss: 43740258.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8966; val_auprc_score: 0.9768; val_best_acc_score: 0.8551; val_best_f1_score: 0.9219; train_kl_reg_loss: 387156.1979; train_edge_recon_loss: 1192536.8102; train_gene_expr_recon_loss: 34957097.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36536790.5185; train_optim_loss: 36536790.5185; val_kl_reg_loss: 356628.7604; val_edge_recon_loss: 1178037.2083; val_gene_expr_recon_loss: 34366386.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 35901052.0000; val_optim_loss: 35901052.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8853; val_auprc_score: 0.9736; val_best_acc_score: 0.8532; val_best_f1_score: 0.9208; train_kl_reg_loss: 340819.4259; train_edge_recon_loss: 1193538.5833; train_gene_expr_recon_loss: 34576963.4074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36111321.4815; train_optim_loss: 36111321.4815; val_kl_reg_loss: 316184.9167; val_edge_recon_loss: 1192181.2500; val_gene_expr_recon_loss: 34112317.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 35620684.0000; val_optim_loss: 35620684.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9289; val_auprc_score: 0.9816; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 732810.4875; train_edge_recon_loss: 1194485.3500; train_gene_expr_recon_loss: 41475772.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43403068.4000; train_optim_loss: 43403068.4000; val_kl_reg_loss: 713875.8438; val_edge_recon_loss: 1206381.5000; val_gene_expr_recon_loss: 41242352.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43162610.0000; val_optim_loss: 43162610.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8882; val_auprc_score: 0.9745; val_best_acc_score: 0.8506; val_best_f1_score: 0.9192; train_kl_reg_loss: 341729.0972; train_edge_recon_loss: 1191619.5509; train_gene_expr_recon_loss: 33905669.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 35439018.2222; train_optim_loss: 35439018.2222; val_kl_reg_loss: 326814.1250; val_edge_recon_loss: 1215940.6250; val_gene_expr_recon_loss: 33712377.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 35255132.0000; val_optim_loss: 35255132.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9305; val_auprc_score: 0.9828; val_best_acc_score: 0.8571; val_best_f1_score: 0.9230; train_kl_reg_loss: 714155.1687; train_edge_recon_loss: 1200617.3250; train_gene_expr_recon_loss: 40992549.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42907322.4000; train_optim_loss: 42907322.4000; val_kl_reg_loss: 695429.1562; val_edge_recon_loss: 1124388.8125; val_gene_expr_recon_loss: 40833474.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42653292.0000; val_optim_loss: 42653292.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8868; val_auprc_score: 0.9742; val_best_acc_score: 0.8465; val_best_f1_score: 0.9168; train_kl_reg_loss: 328336.2350; train_edge_recon_loss: 1185020.8750; train_gene_expr_recon_loss: 34166481.4815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 35679838.6667; train_optim_loss: 35679838.6667; val_kl_reg_loss: 298574.0938; val_edge_recon_loss: 1246569.5833; val_gene_expr_recon_loss: 34051001.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 35596145.3333; val_optim_loss: 35596145.3333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9232; val_auprc_score: 0.9797; val_best_acc_score: 0.8518; val_best_f1_score: 0.9200; train_kl_reg_loss: 696119.8812; train_edge_recon_loss: 1209018.9375; train_gene_expr_recon_loss: 40645220.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42550359.6000; train_optim_loss: 42550359.6000; val_kl_reg_loss: 676424.6562; val_edge_recon_loss: 1178120.0625; val_gene_expr_recon_loss: 40532338.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42386882.0000; val_optim_loss: 42386882.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8052; val_auprc_score: 0.9385; val_best_acc_score: 0.8506; val_best_f1_score: 0.9192; train_kl_reg_loss: 437013877.5185; train_edge_recon_loss: 1146723.2083; train_gene_expr_recon_loss: 409920436.5926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 848081032.5926; train_optim_loss: 848081032.5926; val_kl_reg_loss: 3415657.5833; val_edge_recon_loss: 1215238.5000; val_gene_expr_recon_loss: 101821890.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 106452786.6667; val_optim_loss: 106452786.6667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9277; val_auprc_score: 0.9818; val_best_acc_score: 0.8536; val_best_f1_score: 0.9210; train_kl_reg_loss: 677734.7438; train_edge_recon_loss: 1192825.2500; train_gene_expr_recon_loss: 40374538.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42245098.4000; train_optim_loss: 42245098.4000; val_kl_reg_loss: 659552.5000; val_edge_recon_loss: 1177650.5000; val_gene_expr_recon_loss: 40297758.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42134962.0000; val_optim_loss: 42134962.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.7888; val_auprc_score: 0.9327; val_best_acc_score: 0.8498; val_best_f1_score: 0.9188; train_kl_reg_loss: 6040442.2593; train_edge_recon_loss: 1183109.6852; train_gene_expr_recon_loss: 102285586.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 109509138.8148; train_optim_loss: 109509138.8148; val_kl_reg_loss: 4648093.5000; val_edge_recon_loss: 1220515.7083; val_gene_expr_recon_loss: 59622880.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 65491488.0000; val_optim_loss: 65491488.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9219; val_auprc_score: 0.9809; val_best_acc_score: 0.8541; val_best_f1_score: 0.9213; train_kl_reg_loss: 660139.5188; train_edge_recon_loss: 1196981.2000; train_gene_expr_recon_loss: 40167505.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42024626.4000; train_optim_loss: 42024626.4000; val_kl_reg_loss: 642557.5000; val_edge_recon_loss: 1251515.3750; val_gene_expr_recon_loss: 40116034.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42010106.0000; val_optim_loss: 42010106.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8007; val_auprc_score: 0.9407; val_best_acc_score: 0.8591; val_best_f1_score: 0.9242; train_kl_reg_loss: 6266698.7407; train_edge_recon_loss: 1192457.6435; train_gene_expr_recon_loss: 93552556.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 101011713.0370; train_optim_loss: 101011713.0370; val_kl_reg_loss: 4344126.6667; val_edge_recon_loss: 1145948.3333; val_gene_expr_recon_loss: 56546029.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62036104.0000; val_optim_loss: 62036104.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9250; val_auprc_score: 0.9812; val_best_acc_score: 0.8493; val_best_f1_score: 0.9185; train_kl_reg_loss: 642967.8063; train_edge_recon_loss: 1202151.4375; train_gene_expr_recon_loss: 39998909.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41844028.4000; train_optim_loss: 41844028.4000; val_kl_reg_loss: 624632.8750; val_edge_recon_loss: 1229825.5000; val_gene_expr_recon_loss: 39969048.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41823506.0000; val_optim_loss: 41823506.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.7861; val_auprc_score: 0.9330; val_best_acc_score: 0.8518; val_best_f1_score: 0.9200; train_kl_reg_loss: 4417245.5370; train_edge_recon_loss: 1166419.2731; train_gene_expr_recon_loss: 56457772.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 62041437.3333; train_optim_loss: 62041437.3333; val_kl_reg_loss: 4299842.6667; val_edge_recon_loss: 1206705.7083; val_gene_expr_recon_loss: 56366656.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61873204.0000; val_optim_loss: 61873204.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9188; val_auprc_score: 0.9805; val_best_acc_score: 0.8535; val_best_f1_score: 0.9209; train_kl_reg_loss: 626225.4812; train_edge_recon_loss: 1198458.8000; train_gene_expr_recon_loss: 39863793.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41688477.6000; train_optim_loss: 41688477.6000; val_kl_reg_loss: 609423.8750; val_edge_recon_loss: 1185431.5000; val_gene_expr_recon_loss: 39843362.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41638218.0000; val_optim_loss: 41638218.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.7812; val_auprc_score: 0.9314; val_best_acc_score: 0.8521; val_best_f1_score: 0.9202; train_kl_reg_loss: 4359963.1667; train_edge_recon_loss: 1187184.0602; train_gene_expr_recon_loss: 56286548.2963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61833695.7037; train_optim_loss: 61833695.7037; val_kl_reg_loss: 4249756.0000; val_edge_recon_loss: 1201258.8333; val_gene_expr_recon_loss: 56244848.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61695864.0000; val_optim_loss: 61695864.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9154; val_auprc_score: 0.9792; val_best_acc_score: 0.8500; val_best_f1_score: 0.9189; train_kl_reg_loss: 610514.9938; train_edge_recon_loss: 1202147.6375; train_gene_expr_recon_loss: 39746767.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41559430.0000; train_optim_loss: 41559430.0000; val_kl_reg_loss: 594255.3125; val_edge_recon_loss: 1204601.8125; val_gene_expr_recon_loss: 39740430.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41539288.0000; val_optim_loss: 41539288.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.7992; val_auprc_score: 0.9371; val_best_acc_score: 0.8523; val_best_f1_score: 0.9202; train_kl_reg_loss: 4313939.8704; train_edge_recon_loss: 1184691.3935; train_gene_expr_recon_loss: 56227356.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61725987.5556; train_optim_loss: 61725987.5556; val_kl_reg_loss: 4205376.3333; val_edge_recon_loss: 1202418.2500; val_gene_expr_recon_loss: 56102281.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61510076.0000; val_optim_loss: 61510076.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8039; val_auprc_score: 0.9381; val_best_acc_score: 0.8513; val_best_f1_score: 0.9197; train_kl_reg_loss: 4268965.6296; train_edge_recon_loss: 1189656.2593; train_gene_expr_recon_loss: 56086761.4815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61545383.4074; train_optim_loss: 61545383.4074; val_kl_reg_loss: 4143829.0000; val_edge_recon_loss: 1209904.6250; val_gene_expr_recon_loss: 55994784.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61348517.3333; val_optim_loss: 61348517.3333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9119; val_auprc_score: 0.9783; val_best_acc_score: 0.8500; val_best_f1_score: 0.9189; train_kl_reg_loss: 594275.4563; train_edge_recon_loss: 1197030.3250; train_gene_expr_recon_loss: 39642164.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41433470.8000; train_optim_loss: 41433470.8000; val_kl_reg_loss: 577829.5938; val_edge_recon_loss: 1170961.1250; val_gene_expr_recon_loss: 39639298.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41388088.0000; val_optim_loss: 41388088.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9119; val_auprc_score: 0.9799; val_best_acc_score: 0.8564; val_best_f1_score: 0.9227; train_kl_reg_loss: 578731.4500; train_edge_recon_loss: 1196698.7750; train_gene_expr_recon_loss: 39542965.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41318395.6000; train_optim_loss: 41318395.6000; val_kl_reg_loss: 563216.0312; val_edge_recon_loss: 1131102.3125; val_gene_expr_recon_loss: 39550980.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41245298.0000; val_optim_loss: 41245298.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9088; val_auprc_score: 0.9791; val_best_acc_score: 0.8529; val_best_f1_score: 0.9206; train_kl_reg_loss: 564605.5437; train_edge_recon_loss: 1197542.6125; train_gene_expr_recon_loss: 39461680.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41223828.8000; train_optim_loss: 41223828.8000; val_kl_reg_loss: 548798.4062; val_edge_recon_loss: 1191652.6875; val_gene_expr_recon_loss: 39468170.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41208622.0000; val_optim_loss: 41208622.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9031; val_auprc_score: 0.9781; val_best_acc_score: 0.8550; val_best_f1_score: 0.9219; train_kl_reg_loss: 549635.2125; train_edge_recon_loss: 1201673.6875; train_gene_expr_recon_loss: 39375447.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41126756.8000; train_optim_loss: 41126756.8000; val_kl_reg_loss: 534866.7188; val_edge_recon_loss: 1098697.4688; val_gene_expr_recon_loss: 39392076.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41025640.0000; val_optim_loss: 41025640.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9018; val_auprc_score: 0.9771; val_best_acc_score: 0.8497; val_best_f1_score: 0.9188; train_kl_reg_loss: 535478.6000; train_edge_recon_loss: 1208040.8625; train_gene_expr_recon_loss: 39299461.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41042981.2000; train_optim_loss: 41042981.2000; val_kl_reg_loss: 521054.4219; val_edge_recon_loss: 1267129.6875; val_gene_expr_recon_loss: 39314204.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41102388.0000; val_optim_loss: 41102388.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8948; val_auprc_score: 0.9778; val_best_acc_score: 0.8593; val_best_f1_score: 0.9243; train_kl_reg_loss: 521631.5344; train_edge_recon_loss: 1201361.5875; train_gene_expr_recon_loss: 39225256.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40948250.0000; train_optim_loss: 40948250.0000; val_kl_reg_loss: 507960.9844; val_edge_recon_loss: 1163257.8125; val_gene_expr_recon_loss: 39247762.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40918980.0000; val_optim_loss: 40918980.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 19 sec.
Using best model state, which was in epoch 11.

--- MODEL EVALUATION ---
val AUROC score: 0.8863
val AUPRC score: 0.9743
val best accuracy score: 0.8519
val best F1 score: 0.9200
val target rna MSE score: 17.3442
val source rna MSE score: 21.3555
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 3: 0 hours, 2 minutes and 24 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1491, n_latent: 1481, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1481, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1481, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 27455
Number of validation edges: 3050
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8822; val_auprc_score: 0.9746; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 298751.1125; train_edge_recon_loss: 1087199.7232; train_gene_expr_recon_loss: 109066798.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 110452750.2857; train_optim_loss: 110452750.2857; val_kl_reg_loss: 287977.1562; val_edge_recon_loss: 1153531.0000; val_gene_expr_recon_loss: 61848380.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 63289888.0000; val_optim_loss: 63289888.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8805; val_auprc_score: 0.9744; val_best_acc_score: 0.8565; val_best_f1_score: 0.9227; train_kl_reg_loss: 356095.9330; train_edge_recon_loss: 1165331.5491; train_gene_expr_recon_loss: 59515941.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61037368.8571; train_optim_loss: 61037368.8571; val_kl_reg_loss: 414195.4844; val_edge_recon_loss: 1167205.8750; val_gene_expr_recon_loss: 56579728.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58161130.0000; val_optim_loss: 58161130.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8990; val_auprc_score: 0.9786; val_best_acc_score: 0.8577; val_best_f1_score: 0.9234; train_kl_reg_loss: 508493.9844; train_edge_recon_loss: 1189581.3125; train_gene_expr_recon_loss: 39158670.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40856745.2000; train_optim_loss: 40856745.2000; val_kl_reg_loss: 495160.3125; val_edge_recon_loss: 1203381.6875; val_gene_expr_recon_loss: 39175022.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40873564.0000; val_optim_loss: 40873564.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8761; val_auprc_score: 0.9711; val_best_acc_score: 0.8482; val_best_f1_score: 0.9178; train_kl_reg_loss: 450776.9955; train_edge_recon_loss: 1188860.3929; train_gene_expr_recon_loss: 54814106.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56453743.1429; train_optim_loss: 56453743.1429; val_kl_reg_loss: 459282.7969; val_edge_recon_loss: 1240179.1875; val_gene_expr_recon_loss: 53635696.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55335158.0000; val_optim_loss: 55335158.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8797; val_auprc_score: 0.9725; val_best_acc_score: 0.8524; val_best_f1_score: 0.9203; train_kl_reg_loss: 480386.0379; train_edge_recon_loss: 1191501.2589; train_gene_expr_recon_loss: 52868821.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54540709.1429; train_optim_loss: 54540709.1429; val_kl_reg_loss: 470656.0156; val_edge_recon_loss: 1203915.9375; val_gene_expr_recon_loss: 52127908.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53802480.0000; val_optim_loss: 53802480.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8974; val_auprc_score: 0.9773; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 495513.7812; train_edge_recon_loss: 1183946.7500; train_gene_expr_recon_loss: 39095913.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40775374.4000; train_optim_loss: 40775374.4000; val_kl_reg_loss: 482470.4844; val_edge_recon_loss: 1264083.1875; val_gene_expr_recon_loss: 39106748.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40853300.0000; val_optim_loss: 40853300.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8804; val_auprc_score: 0.9733; val_best_acc_score: 0.8543; val_best_f1_score: 0.9215; train_kl_reg_loss: 481249.6004; train_edge_recon_loss: 1180454.2589; train_gene_expr_recon_loss: 51589348.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53251053.1429; train_optim_loss: 53251053.1429; val_kl_reg_loss: 464330.0312; val_edge_recon_loss: 1169397.5000; val_gene_expr_recon_loss: 51074548.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52708276.0000; val_optim_loss: 52708276.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8777; val_auprc_score: 0.9726; val_best_acc_score: 0.8512; val_best_f1_score: 0.9196; train_kl_reg_loss: 470234.5379; train_edge_recon_loss: 1181370.0982; train_gene_expr_recon_loss: 50435034.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52086638.2857; train_optim_loss: 52086638.2857; val_kl_reg_loss: 447721.1250; val_edge_recon_loss: 1232885.6875; val_gene_expr_recon_loss: 49760642.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51441248.0000; val_optim_loss: 51441248.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8939; val_auprc_score: 0.9764; val_best_acc_score: 0.8527; val_best_f1_score: 0.9205; train_kl_reg_loss: 482888.6531; train_edge_recon_loss: 1190528.6875; train_gene_expr_recon_loss: 39015012.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40688428.8000; train_optim_loss: 40688428.8000; val_kl_reg_loss: 469417.1250; val_edge_recon_loss: 1189020.6250; val_gene_expr_recon_loss: 39042968.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40701406.0000; val_optim_loss: 40701406.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8691; val_auprc_score: 0.9699; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 453576.2433; train_edge_recon_loss: 1172720.4286; train_gene_expr_recon_loss: 49107929.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50734226.2857; train_optim_loss: 50734226.2857; val_kl_reg_loss: 431197.6406; val_edge_recon_loss: 1195265.1875; val_gene_expr_recon_loss: 48312982.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49939444.0000; val_optim_loss: 49939444.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8826; val_auprc_score: 0.9757; val_best_acc_score: 0.8577; val_best_f1_score: 0.9234; train_kl_reg_loss: 435102.4442; train_edge_recon_loss: 1190711.7232; train_gene_expr_recon_loss: 47595077.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49220891.7143; train_optim_loss: 49220891.7143; val_kl_reg_loss: 412836.3750; val_edge_recon_loss: 1155336.1250; val_gene_expr_recon_loss: 46641656.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48209828.0000; val_optim_loss: 48209828.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8769; val_auprc_score: 0.9724; val_best_acc_score: 0.8482; val_best_f1_score: 0.9178; train_kl_reg_loss: 416397.2054; train_edge_recon_loss: 1188432.4643; train_gene_expr_recon_loss: 45957204.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47562034.8571; train_optim_loss: 47562034.8571; val_kl_reg_loss: 392806.4375; val_edge_recon_loss: 1248881.8750; val_gene_expr_recon_loss: 45098616.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46740304.0000; val_optim_loss: 46740304.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8924; val_auprc_score: 0.9761; val_best_acc_score: 0.8497; val_best_f1_score: 0.9188; train_kl_reg_loss: 470908.7781; train_edge_recon_loss: 1201098.8000; train_gene_expr_recon_loss: 38956752.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40628759.6000; train_optim_loss: 40628759.6000; val_kl_reg_loss: 459422.3438; val_edge_recon_loss: 1216696.7500; val_gene_expr_recon_loss: 38982402.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40658522.0000; val_optim_loss: 40658522.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8739; val_auprc_score: 0.9743; val_best_acc_score: 0.8596; val_best_f1_score: 0.9245; train_kl_reg_loss: 397793.8214; train_edge_recon_loss: 1203828.1518; train_gene_expr_recon_loss: 44374859.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45976481.1429; train_optim_loss: 45976481.1429; val_kl_reg_loss: 375820.9688; val_edge_recon_loss: 1123285.6250; val_gene_expr_recon_loss: 43631204.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45130312.0000; val_optim_loss: 45130312.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8665; val_auprc_score: 0.9698; val_best_acc_score: 0.8496; val_best_f1_score: 0.9187; train_kl_reg_loss: 378401.5603; train_edge_recon_loss: 1236559.1339; train_gene_expr_recon_loss: 43005108.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44620068.8571; train_optim_loss: 44620068.8571; val_kl_reg_loss: 356777.7500; val_edge_recon_loss: 1201090.3125; val_gene_expr_recon_loss: 42392060.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43949928.0000; val_optim_loss: 43949928.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8885; val_auprc_score: 0.9764; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 458945.8500; train_edge_recon_loss: 1196212.7625; train_gene_expr_recon_loss: 38910351.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40565509.6000; train_optim_loss: 40565509.6000; val_kl_reg_loss: 445433.9375; val_edge_recon_loss: 1220853.7500; val_gene_expr_recon_loss: 38912388.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40578676.0000; val_optim_loss: 40578676.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8779; val_auprc_score: 0.9729; val_best_acc_score: 0.8463; val_best_f1_score: 0.9167; train_kl_reg_loss: 358984.3147; train_edge_recon_loss: 1178391.5536; train_gene_expr_recon_loss: 41870948.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43408324.2857; train_optim_loss: 43408324.2857; val_kl_reg_loss: 338548.3750; val_edge_recon_loss: 1256004.6875; val_gene_expr_recon_loss: 41423968.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43018520.0000; val_optim_loss: 43018520.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8565; val_auprc_score: 0.9687; val_best_acc_score: 0.8491; val_best_f1_score: 0.9184; train_kl_reg_loss: 343206.3348; train_edge_recon_loss: 1210041.9911; train_gene_expr_recon_loss: 41020005.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42573253.7143; train_optim_loss: 42573253.7143; val_kl_reg_loss: 326765.3125; val_edge_recon_loss: 1235894.2500; val_gene_expr_recon_loss: 40690162.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42252822.0000; val_optim_loss: 42252822.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8578; val_auprc_score: 0.9629; val_best_acc_score: 0.8503; val_best_f1_score: 0.9191; train_kl_reg_loss: 950321.7902; train_edge_recon_loss: 1150427.2589; train_gene_expr_recon_loss: 152676785.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 154777535.7143; train_optim_loss: 154777535.7143; val_kl_reg_loss: 973115.7812; val_edge_recon_loss: 1209299.6875; val_gene_expr_recon_loss: 54432210.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56614626.0000; val_optim_loss: 56614626.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8864; val_auprc_score: 0.9748; val_best_acc_score: 0.8514; val_best_f1_score: 0.9197; train_kl_reg_loss: 447177.4969; train_edge_recon_loss: 1194065.6875; train_gene_expr_recon_loss: 38834804.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40476048.0000; train_optim_loss: 40476048.0000; val_kl_reg_loss: 435404.9531; val_edge_recon_loss: 1216819.3125; val_gene_expr_recon_loss: 38863900.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40516124.0000; val_optim_loss: 40516124.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8513; val_auprc_score: 0.9582; val_best_acc_score: 0.8524; val_best_f1_score: 0.9203; train_kl_reg_loss: 1643126.8571; train_edge_recon_loss: 1194294.2321; train_gene_expr_recon_loss: 71481199.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 74318620.0000; train_optim_loss: 74318620.0000; val_kl_reg_loss: 2251358.3750; val_edge_recon_loss: 1217084.5625; val_gene_expr_recon_loss: 50858686.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54327130.0000; val_optim_loss: 54327130.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8418; val_auprc_score: 0.9539; val_best_acc_score: 0.8512; val_best_f1_score: 0.9196; train_kl_reg_loss: 2669664.9107; train_edge_recon_loss: 1190509.4375; train_gene_expr_recon_loss: 49874540.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53734714.5714; train_optim_loss: 53734714.5714; val_kl_reg_loss: 2811851.3750; val_edge_recon_loss: 1211135.1250; val_gene_expr_recon_loss: 48008508.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52031494.0000; val_optim_loss: 52031494.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8448; val_auprc_score: 0.9574; val_best_acc_score: 0.8577; val_best_f1_score: 0.9234; train_kl_reg_loss: 2914369.8036; train_edge_recon_loss: 1183060.6518; train_gene_expr_recon_loss: 47480325.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51577756.5714; train_optim_loss: 51577756.5714; val_kl_reg_loss: 2777012.1250; val_edge_recon_loss: 1180488.1875; val_gene_expr_recon_loss: 46989446.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50946948.0000; val_optim_loss: 50946948.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8839; val_auprc_score: 0.9769; val_best_acc_score: 0.8603; val_best_f1_score: 0.9249; train_kl_reg_loss: 436108.6250; train_edge_recon_loss: 1190196.8625; train_gene_expr_recon_loss: 38772462.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40398766.8000; train_optim_loss: 40398766.8000; val_kl_reg_loss: 424628.0781; val_edge_recon_loss: 1144009.1875; val_gene_expr_recon_loss: 38801190.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40369826.0000; val_optim_loss: 40369826.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8299; val_auprc_score: 0.9480; val_best_acc_score: 0.8470; val_best_f1_score: 0.9172; train_kl_reg_loss: 2851601.0536; train_edge_recon_loss: 1192069.7857; train_gene_expr_recon_loss: 46932356.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50976027.1429; train_optim_loss: 50976027.1429; val_kl_reg_loss: 2754451.2500; val_edge_recon_loss: 1227641.5000; val_gene_expr_recon_loss: 46841024.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50823116.0000; val_optim_loss: 50823116.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8309; val_auprc_score: 0.9492; val_best_acc_score: 0.8484; val_best_f1_score: 0.9180; train_kl_reg_loss: 2830451.7857; train_edge_recon_loss: 1175222.2411; train_gene_expr_recon_loss: 46876525.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50882200.0000; train_optim_loss: 50882200.0000; val_kl_reg_loss: 2738613.2500; val_edge_recon_loss: 1217600.6875; val_gene_expr_recon_loss: 46844240.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50800454.0000; val_optim_loss: 50800454.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8815; val_auprc_score: 0.9752; val_best_acc_score: 0.8570; val_best_f1_score: 0.9230; train_kl_reg_loss: 425389.0563; train_edge_recon_loss: 1183829.7625; train_gene_expr_recon_loss: 38716089.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40325308.0000; train_optim_loss: 40325308.0000; val_kl_reg_loss: 413742.8438; val_edge_recon_loss: 1124708.8125; val_gene_expr_recon_loss: 38738204.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40276656.0000; val_optim_loss: 40276656.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8378; val_auprc_score: 0.9558; val_best_acc_score: 0.8604; val_best_f1_score: 0.9249; train_kl_reg_loss: 2800511.6607; train_edge_recon_loss: 1204590.4464; train_gene_expr_recon_loss: 46820852.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50825954.2857; train_optim_loss: 50825954.2857; val_kl_reg_loss: 2698246.8750; val_edge_recon_loss: 1148217.3750; val_gene_expr_recon_loss: 46796060.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50642524.0000; val_optim_loss: 50642524.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8454; val_auprc_score: 0.9576; val_best_acc_score: 0.8589; val_best_f1_score: 0.9241; train_kl_reg_loss: 2770964.2679; train_edge_recon_loss: 1190824.2232; train_gene_expr_recon_loss: 46768089.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50729878.0000; train_optim_loss: 50729878.0000; val_kl_reg_loss: 2667176.5000; val_edge_recon_loss: 1138757.1250; val_gene_expr_recon_loss: 46673492.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50479426.0000; val_optim_loss: 50479426.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8735; val_auprc_score: 0.9729; val_best_acc_score: 0.8516; val_best_f1_score: 0.9199; train_kl_reg_loss: 414563.9500; train_edge_recon_loss: 1204795.6250; train_gene_expr_recon_loss: 38650784.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40270145.2000; train_optim_loss: 40270145.2000; val_kl_reg_loss: 403663.0312; val_edge_recon_loss: 1163750.0000; val_gene_expr_recon_loss: 38684296.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40251710.0000; val_optim_loss: 40251710.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8771; val_auprc_score: 0.9753; val_best_acc_score: 0.8604; val_best_f1_score: 0.9250; train_kl_reg_loss: 404370.8531; train_edge_recon_loss: 1201973.5875; train_gene_expr_recon_loss: 38587815.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40194159.2000; train_optim_loss: 40194159.2000; val_kl_reg_loss: 393787.8125; val_edge_recon_loss: 1105900.0625; val_gene_expr_recon_loss: 38628122.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40127810.0000; val_optim_loss: 40127810.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8729; val_auprc_score: 0.9710; val_best_acc_score: 0.8467; val_best_f1_score: 0.9170; train_kl_reg_loss: 394643.3500; train_edge_recon_loss: 1194795.9750; train_gene_expr_recon_loss: 38544613.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40134053.2000; train_optim_loss: 40134053.2000; val_kl_reg_loss: 383533.8906; val_edge_recon_loss: 1211745.5625; val_gene_expr_recon_loss: 38563814.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40159094.0000; val_optim_loss: 40159094.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8648; val_auprc_score: 0.9705; val_best_acc_score: 0.8503; val_best_f1_score: 0.9191; train_kl_reg_loss: 384928.2969; train_edge_recon_loss: 1207308.2125; train_gene_expr_recon_loss: 38483686.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40075922.8000; train_optim_loss: 40075922.8000; val_kl_reg_loss: 374451.2344; val_edge_recon_loss: 1296020.2500; val_gene_expr_recon_loss: 38515008.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40185478.0000; val_optim_loss: 40185478.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8669; val_auprc_score: 0.9716; val_best_acc_score: 0.8513; val_best_f1_score: 0.9197; train_kl_reg_loss: 375518.8719; train_edge_recon_loss: 1205425.2125; train_gene_expr_recon_loss: 38425997.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40006942.0000; train_optim_loss: 40006942.0000; val_kl_reg_loss: 366182.9531; val_edge_recon_loss: 1224407.5000; val_gene_expr_recon_loss: 38463234.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40053824.0000; val_optim_loss: 40053824.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8652; val_auprc_score: 0.9707; val_best_acc_score: 0.8522; val_best_f1_score: 0.9202; train_kl_reg_loss: 366427.0969; train_edge_recon_loss: 1186442.5375; train_gene_expr_recon_loss: 38378418.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39931287.6000; train_optim_loss: 39931287.6000; val_kl_reg_loss: 357126.7812; val_edge_recon_loss: 1179973.5625; val_gene_expr_recon_loss: 38408712.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39945812.0000; val_optim_loss: 39945812.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 22 sec.
Using best model state, which was in epoch 13.

--- MODEL EVALUATION ---
val AUROC score: 0.8710
val AUPRC score: 0.9714
val best accuracy score: 0.8493
val best F1 score: 0.9185
val target rna MSE score: 40.1299
val source rna MSE score: 55.6349
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 2: 0 hours, 1 minutes and 25 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1491, n_latent: 1481, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1481, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1481, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 27455
Number of validation edges: 3050
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8914; val_auprc_score: 0.9784; val_best_acc_score: 0.8596; val_best_f1_score: 0.9245; train_kl_reg_loss: 559988.6554; train_edge_recon_loss: 1109247.3482; train_gene_expr_recon_loss: 137622702.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 139291937.1429; train_optim_loss: 139291937.1429; val_kl_reg_loss: 325296.0156; val_edge_recon_loss: 1134371.0000; val_gene_expr_recon_loss: 64980796.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66440464.0000; val_optim_loss: 66440464.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8834; val_auprc_score: 0.9746; val_best_acc_score: 0.8577; val_best_f1_score: 0.9234; train_kl_reg_loss: 472394.4353; train_edge_recon_loss: 1217194.6429; train_gene_expr_recon_loss: 60628429.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 62318018.8571; train_optim_loss: 62318018.8571; val_kl_reg_loss: 559850.6562; val_edge_recon_loss: 1164420.0625; val_gene_expr_recon_loss: 58154914.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59879186.0000; val_optim_loss: 59879186.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8668; val_auprc_score: 0.9716; val_best_acc_score: 0.8530; val_best_f1_score: 0.9207; train_kl_reg_loss: 357543.0031; train_edge_recon_loss: 1204848.0125; train_gene_expr_recon_loss: 38312018.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39874409.2000; train_optim_loss: 39874409.2000; val_kl_reg_loss: 349931.6250; val_edge_recon_loss: 1231241.3750; val_gene_expr_recon_loss: 38346348.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39927522.0000; val_optim_loss: 39927522.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8810; val_auprc_score: 0.9724; val_best_acc_score: 0.8534; val_best_f1_score: 0.9209; train_kl_reg_loss: 607741.5938; train_edge_recon_loss: 1201887.2143; train_gene_expr_recon_loss: 56516175.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58325804.5714; train_optim_loss: 58325804.5714; val_kl_reg_loss: 606434.3750; val_edge_recon_loss: 1198124.6250; val_gene_expr_recon_loss: 55275508.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57080068.0000; val_optim_loss: 57080068.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8773; val_auprc_score: 0.9714; val_best_acc_score: 0.8503; val_best_f1_score: 0.9191; train_kl_reg_loss: 627985.6295; train_edge_recon_loss: 1187106.0714; train_gene_expr_recon_loss: 54404651.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56219742.8571; train_optim_loss: 56219742.8571; val_kl_reg_loss: 605740.0000; val_edge_recon_loss: 1204673.3125; val_gene_expr_recon_loss: 53736228.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55546640.0000; val_optim_loss: 55546640.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8914; val_auprc_score: 0.9763; val_best_acc_score: 0.8531; val_best_f1_score: 0.9208; train_kl_reg_loss: 612978.1429; train_edge_recon_loss: 1177365.9911; train_gene_expr_recon_loss: 53169204.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54959549.1429; train_optim_loss: 54959549.1429; val_kl_reg_loss: 579676.8438; val_edge_recon_loss: 1182842.8750; val_gene_expr_recon_loss: 52742788.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54505308.0000; val_optim_loss: 54505308.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.8637; val_auprc_score: 0.9719; val_best_acc_score: 0.8563; val_best_f1_score: 0.9226; train_kl_reg_loss: 3708575.6938; train_edge_recon_loss: 1165846.8625; train_gene_expr_recon_loss: 168881852.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 173756272.8000; train_optim_loss: 173756272.8000; val_kl_reg_loss: 6820176896.0000; val_edge_recon_loss: 1172635.6250; val_gene_expr_recon_loss: 64819850.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6886169344.0000; val_optim_loss: 6886169344.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8682; val_auprc_score: 0.9683; val_best_acc_score: 0.8479; val_best_f1_score: 0.9177; train_kl_reg_loss: 586199.2500; train_edge_recon_loss: 1179502.8929; train_gene_expr_recon_loss: 52143712.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53909413.7143; train_optim_loss: 53909413.7143; val_kl_reg_loss: 556173.5938; val_edge_recon_loss: 1244539.6875; val_gene_expr_recon_loss: 51578052.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53378766.0000; val_optim_loss: 53378766.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8749; val_auprc_score: 0.9711; val_best_acc_score: 0.8470; val_best_f1_score: 0.9172; train_kl_reg_loss: 561681.3259; train_edge_recon_loss: 1205433.0625; train_gene_expr_recon_loss: 50999267.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52766381.7143; train_optim_loss: 52766381.7143; val_kl_reg_loss: 531910.6562; val_edge_recon_loss: 1250265.2500; val_gene_expr_recon_loss: 50361886.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52144062.0000; val_optim_loss: 52144062.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.8563; val_auprc_score: 0.9623; val_best_acc_score: 0.8597; val_best_f1_score: 0.9246; train_kl_reg_loss: 1880999732.2875; train_edge_recon_loss: 1118526.3750; train_gene_expr_recon_loss: 755377952.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2637496202.4000; train_optim_loss: 2637496202.4000; val_kl_reg_loss: 13163832.0000; val_edge_recon_loss: 1190613.3125; val_gene_expr_recon_loss: 158742696.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 173097144.0000; val_optim_loss: 173097144.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8842; val_auprc_score: 0.9731; val_best_acc_score: 0.8453; val_best_f1_score: 0.9162; train_kl_reg_loss: 535149.6786; train_edge_recon_loss: 1214688.8304; train_gene_expr_recon_loss: 49656465.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51406304.2857; train_optim_loss: 51406304.2857; val_kl_reg_loss: 505363.4062; val_edge_recon_loss: 1243689.8750; val_gene_expr_recon_loss: 48975656.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50724710.0000; val_optim_loss: 50724710.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8860; val_auprc_score: 0.9755; val_best_acc_score: 0.8563; val_best_f1_score: 0.9226; train_kl_reg_loss: 508604.6987; train_edge_recon_loss: 1172355.1071; train_gene_expr_recon_loss: 48113520.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49794480.2857; train_optim_loss: 49794480.2857; val_kl_reg_loss: 478753.0469; val_edge_recon_loss: 1186460.0625; val_gene_expr_recon_loss: 47305434.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48970648.0000; val_optim_loss: 48970648.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8763; val_auprc_score: 0.9726; val_best_acc_score: 0.8541; val_best_f1_score: 0.9213; train_kl_reg_loss: 483259.4174; train_edge_recon_loss: 1197172.7768; train_gene_expr_recon_loss: 46514684.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48195116.0000; train_optim_loss: 48195116.0000; val_kl_reg_loss: 454076.2500; val_edge_recon_loss: 1190787.3750; val_gene_expr_recon_loss: 45702908.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47347772.0000; val_optim_loss: 47347772.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.8059; val_auprc_score: 0.9377; val_best_acc_score: 0.8460; val_best_f1_score: 0.9166; train_kl_reg_loss: 19657646.0500; train_edge_recon_loss: 1160219.0125; train_gene_expr_recon_loss: 381619241.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 402437106.4000; train_optim_loss: 402437106.4000; val_kl_reg_loss: 3903323.5000; val_edge_recon_loss: 1229806.8125; val_gene_expr_recon_loss: 101026672.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 106159800.0000; val_optim_loss: 106159800.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8736; val_auprc_score: 0.9701; val_best_acc_score: 0.8416; val_best_f1_score: 0.9140; train_kl_reg_loss: 458585.1362; train_edge_recon_loss: 1174838.3482; train_gene_expr_recon_loss: 45026802.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46660226.2857; train_optim_loss: 46660226.2857; val_kl_reg_loss: 431273.7812; val_edge_recon_loss: 1294543.5000; val_gene_expr_recon_loss: 44344758.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46070574.0000; val_optim_loss: 46070574.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8789; val_auprc_score: 0.9737; val_best_acc_score: 0.8503; val_best_f1_score: 0.9191; train_kl_reg_loss: 434493.9598; train_edge_recon_loss: 1202195.1607; train_gene_expr_recon_loss: 43778322.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45415011.7143; train_optim_loss: 45415011.7143; val_kl_reg_loss: 408070.5781; val_edge_recon_loss: 1240109.3750; val_gene_expr_recon_loss: 43280924.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44929104.0000; val_optim_loss: 44929104.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.7950; val_auprc_score: 0.9365; val_best_acc_score: 0.8533; val_best_f1_score: 0.9209; train_kl_reg_loss: 2112299116.4500; train_edge_recon_loss: 1152122.6875; train_gene_expr_recon_loss: 432239264.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2545690423.2000; train_optim_loss: 2545690423.2000; val_kl_reg_loss: 3790050560.0000; val_edge_recon_loss: 1200885.6250; val_gene_expr_recon_loss: 117198024.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3908449536.0000; val_optim_loss: 3908449536.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8661; val_auprc_score: 0.9713; val_best_acc_score: 0.8536; val_best_f1_score: 0.9210; train_kl_reg_loss: 411744.7321; train_edge_recon_loss: 1180496.7321; train_gene_expr_recon_loss: 42867468.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44459710.0000; train_optim_loss: 44459710.0000; val_kl_reg_loss: 387303.9688; val_edge_recon_loss: 1206903.1875; val_gene_expr_recon_loss: 42528344.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44122552.0000; val_optim_loss: 44122552.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8649; val_auprc_score: 0.9700; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 389349.1205; train_edge_recon_loss: 1203122.5893; train_gene_expr_recon_loss: 42023634.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43616106.2857; train_optim_loss: 43616106.2857; val_kl_reg_loss: 366757.9531; val_edge_recon_loss: 1211213.7500; val_gene_expr_recon_loss: 41741980.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43319952.0000; val_optim_loss: 43319952.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8671; val_auprc_score: 0.9726; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 368687.8527; train_edge_recon_loss: 1188213.6339; train_gene_expr_recon_loss: 41529744.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43086645.4286; train_optim_loss: 43086645.4286; val_kl_reg_loss: 349031.6719; val_edge_recon_loss: 1183365.6250; val_gene_expr_recon_loss: 41391692.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42924090.0000; val_optim_loss: 42924090.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.8033; val_auprc_score: 0.9387; val_best_acc_score: 0.8530; val_best_f1_score: 0.9207; train_kl_reg_loss: 412490807.9500; train_edge_recon_loss: 1175360.2750; train_gene_expr_recon_loss: 257386895.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 671053064.8000; train_optim_loss: 671053064.8000; val_kl_reg_loss: 5672234.2500; val_edge_recon_loss: 1150106.5625; val_gene_expr_recon_loss: 81253484.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 88075824.0000; val_optim_loss: 88075824.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8716; val_auprc_score: 0.9717; val_best_acc_score: 0.8501; val_best_f1_score: 0.9190; train_kl_reg_loss: 349484.9330; train_edge_recon_loss: 1202751.9196; train_gene_expr_recon_loss: 41222403.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42774640.2857; train_optim_loss: 42774640.2857; val_kl_reg_loss: 328679.8438; val_edge_recon_loss: 1238728.1875; val_gene_expr_recon_loss: 41097062.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42664470.0000; val_optim_loss: 42664470.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8528; val_auprc_score: 0.9696; val_best_acc_score: 0.8563; val_best_f1_score: 0.9226; train_kl_reg_loss: 330049.3594; train_edge_recon_loss: 1179537.9821; train_gene_expr_recon_loss: 40979079.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42488667.1429; train_optim_loss: 42488667.1429; val_kl_reg_loss: 311317.0625; val_edge_recon_loss: 1173177.3750; val_gene_expr_recon_loss: 40934334.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42418828.0000; val_optim_loss: 42418828.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.7946; val_auprc_score: 0.9368; val_best_acc_score: 0.8548; val_best_f1_score: 0.9217; train_kl_reg_loss: 5720432.2000; train_edge_recon_loss: 1200400.9750; train_gene_expr_recon_loss: 75227060.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 82147893.6000; train_optim_loss: 82147893.6000; val_kl_reg_loss: 5618862.7500; val_edge_recon_loss: 1205306.8125; val_gene_expr_recon_loss: 70406588.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 77230760.0000; val_optim_loss: 77230760.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8527; val_auprc_score: 0.9675; val_best_acc_score: 0.8560; val_best_f1_score: 0.9224; train_kl_reg_loss: 4158374.8415; train_edge_recon_loss: 1204736.1429; train_gene_expr_recon_loss: 131467555.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 136830668.2857; train_optim_loss: 136830668.2857; val_kl_reg_loss: 11708853248.0000; val_edge_recon_loss: 1183550.1875; val_gene_expr_recon_loss: 44805198.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 11754841600.0000; val_optim_loss: 11754841600.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8283; val_auprc_score: 0.9530; val_best_acc_score: 0.8539; val_best_f1_score: 0.9212; train_kl_reg_loss: 2019133190.5893; train_edge_recon_loss: 1164254.3750; train_gene_expr_recon_loss: 738531799.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2758829276.5714; train_optim_loss: 2758829276.5714; val_kl_reg_loss: 3613129728.0000; val_edge_recon_loss: 1181623.2500; val_gene_expr_recon_loss: 228189552.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3842500864.0000; val_optim_loss: 3842500864.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.7644; val_auprc_score: 0.9291; val_best_acc_score: 0.8575; val_best_f1_score: 0.9233; train_kl_reg_loss: 273425516173.0893; train_edge_recon_loss: 1163151.6562; train_gene_expr_recon_loss: 1012206100.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 274438883675.4286; train_optim_loss: 274438883675.4286; val_kl_reg_loss: 14262825.0000; val_edge_recon_loss: 1155264.0000; val_gene_expr_recon_loss: 802763392.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 818181504.0000; val_optim_loss: 818181504.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.7911; val_auprc_score: 0.9339; val_best_acc_score: 0.8508; val_best_f1_score: 0.9194; train_kl_reg_loss: 5632313.5000; train_edge_recon_loss: 1196266.9500; train_gene_expr_recon_loss: 68697528.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 75526109.6000; train_optim_loss: 75526109.6000; val_kl_reg_loss: 5508834.2500; val_edge_recon_loss: 1189896.9375; val_gene_expr_recon_loss: 67055968.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 73754700.0000; val_optim_loss: 73754700.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.7424; val_auprc_score: 0.9221; val_best_acc_score: 0.8572; val_best_f1_score: 0.9231; train_kl_reg_loss: 24565366087.4286; train_edge_recon_loss: 1193673.5625; train_gene_expr_recon_loss: 810554880.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25377114710.8571; train_optim_loss: 25377114710.8571; val_kl_reg_loss: 10152496.0000; val_edge_recon_loss: 1164347.9375; val_gene_expr_recon_loss: 756985696.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 768302528.0000; val_optim_loss: 768302528.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.7101; val_auprc_score: 0.9143; val_best_acc_score: 0.8592; val_best_f1_score: 0.9242; train_kl_reg_loss: 10471580.5000; train_edge_recon_loss: 1196488.6607; train_gene_expr_recon_loss: 751706102.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 763374171.4286; train_optim_loss: 763374171.4286; val_kl_reg_loss: 10083163.0000; val_edge_recon_loss: 1178602.8125; val_gene_expr_recon_loss: 748613536.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 759875296.0000; val_optim_loss: 759875296.0000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.8012; val_auprc_score: 0.9391; val_best_acc_score: 0.8548; val_best_f1_score: 0.9217; train_kl_reg_loss: 5517419.5000; train_edge_recon_loss: 1182983.2500; train_gene_expr_recon_loss: 65838880.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 72539283.2000; train_optim_loss: 72539283.2000; val_kl_reg_loss: 5386423.7500; val_edge_recon_loss: 1190698.3750; val_gene_expr_recon_loss: 65102540.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 71679664.0000; val_optim_loss: 71679664.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.7212; val_auprc_score: 0.9135; val_best_acc_score: 0.8529; val_best_f1_score: 0.9206; train_kl_reg_loss: 10327944.0000; train_edge_recon_loss: 1202699.4732; train_gene_expr_recon_loss: 744645938.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 756176580.5714; train_optim_loss: 756176580.5714; val_kl_reg_loss: 9920002.0000; val_edge_recon_loss: 1174828.5625; val_gene_expr_recon_loss: 742647488.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 753742336.0000; val_optim_loss: 753742336.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.7259; val_auprc_score: 0.9144; val_best_acc_score: 0.8522; val_best_f1_score: 0.9202; train_kl_reg_loss: 10149450.1429; train_edge_recon_loss: 1178398.3661; train_gene_expr_recon_loss: 739296790.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 750624640.0000; train_optim_loss: 750624640.0000; val_kl_reg_loss: 9708924.5000; val_edge_recon_loss: 1219974.6250; val_gene_expr_recon_loss: 737835360.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 748764256.0000; val_optim_loss: 748764256.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.7194; val_auprc_score: 0.9064; val_best_acc_score: 0.8425; val_best_f1_score: 0.9145; train_kl_reg_loss: 9941331.3571; train_edge_recon_loss: 1198951.2411; train_gene_expr_recon_loss: 732236658.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 743376941.7143; train_optim_loss: 743376941.7143; val_kl_reg_loss: 9551996.0000; val_edge_recon_loss: 1315141.4375; val_gene_expr_recon_loss: 728969952.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 739837088.0000; val_optim_loss: 739837088.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 38 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
val AUROC score: 0.8448
val AUPRC score: 0.9685
val best accuracy score: 0.8626
val best F1 score: 0.9262
val target rna MSE score: 27.9538
val source rna MSE score: 27.6135
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 1: 0 hours, 1 minutes and 42 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 8 min 10 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.8681
val AUPRC score: 0.9727
val best accuracy score: 0.8522
val best F1 score: 0.9202
val target rna MSE score: 15.0589
val source rna MSE score: 12.5882
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 6: 0 hours, 8 minutes and 15 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1490, n_latent: 1480, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1480, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1480, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 80320
Number of validation edges: 8924
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9409; val_auprc_score: 0.9883; val_best_acc_score: 0.8559; val_best_f1_score: 0.9223; train_kl_reg_loss: 6797098.8941; train_edge_recon_loss: 1060957.1250; train_gene_expr_recon_loss: 213404778.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 221262829.6000; train_optim_loss: 221262829.6000; val_kl_reg_loss: 139078.3906; val_edge_recon_loss: 1182285.7500; val_gene_expr_recon_loss: 72448840.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 73770204.0000; val_optim_loss: 73770204.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9373; val_auprc_score: 0.9860; val_best_acc_score: 0.8574; val_best_f1_score: 0.9232; train_kl_reg_loss: 245944.7828; train_edge_recon_loss: 1156602.6000; train_gene_expr_recon_loss: 66033835.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 67436383.2000; train_optim_loss: 67436383.2000; val_kl_reg_loss: 325663.4688; val_edge_recon_loss: 1138107.3125; val_gene_expr_recon_loss: 59698772.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61162542.0000; val_optim_loss: 61162542.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9341; val_auprc_score: 0.9842; val_best_acc_score: 0.8501; val_best_f1_score: 0.9190; train_kl_reg_loss: 355916.8031; train_edge_recon_loss: 1198700.3500; train_gene_expr_recon_loss: 58303821.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59858438.8000; train_optim_loss: 59858438.8000; val_kl_reg_loss: 383747.5156; val_edge_recon_loss: 1236753.6250; val_gene_expr_recon_loss: 55741492.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57361992.0000; val_optim_loss: 57361992.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9282; val_auprc_score: 0.9830; val_best_acc_score: 0.8527; val_best_f1_score: 0.9205; train_kl_reg_loss: 395725.1375; train_edge_recon_loss: 1184905.0875; train_gene_expr_recon_loss: 55223692.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56804322.0000; train_optim_loss: 56804322.0000; val_kl_reg_loss: 393248.8906; val_edge_recon_loss: 1147740.0625; val_gene_expr_recon_loss: 54111150.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55652138.0000; val_optim_loss: 55652138.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9296; val_auprc_score: 0.9832; val_best_acc_score: 0.8554; val_best_f1_score: 0.9220; train_kl_reg_loss: 399911.1250; train_edge_recon_loss: 1198529.0875; train_gene_expr_recon_loss: 53585131.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55183571.6000; train_optim_loss: 55183571.6000; val_kl_reg_loss: 394567.3906; val_edge_recon_loss: 1173394.8125; val_gene_expr_recon_loss: 52978540.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54546502.0000; val_optim_loss: 54546502.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9293; val_auprc_score: 0.9833; val_best_acc_score: 0.8550; val_best_f1_score: 0.9219; train_kl_reg_loss: 399746.7375; train_edge_recon_loss: 1190956.9125; train_gene_expr_recon_loss: 52526889.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54117592.8000; train_optim_loss: 54117592.8000; val_kl_reg_loss: 390922.3281; val_edge_recon_loss: 1189606.3750; val_gene_expr_recon_loss: 52102766.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53683294.0000; val_optim_loss: 53683294.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9316; val_auprc_score: 0.9837; val_best_acc_score: 0.8501; val_best_f1_score: 0.9190; train_kl_reg_loss: 394591.6813; train_edge_recon_loss: 1210863.6625; train_gene_expr_recon_loss: 51690516.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53295972.0000; train_optim_loss: 53295972.0000; val_kl_reg_loss: 385939.4688; val_edge_recon_loss: 1225882.6250; val_gene_expr_recon_loss: 51294544.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52906366.0000; val_optim_loss: 52906366.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9320; val_auprc_score: 0.9836; val_best_acc_score: 0.8493; val_best_f1_score: 0.9185; train_kl_reg_loss: 389082.5563; train_edge_recon_loss: 1186974.0000; train_gene_expr_recon_loss: 50924944.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52501001.2000; train_optim_loss: 52501001.2000; val_kl_reg_loss: 380578.0938; val_edge_recon_loss: 1203768.2500; val_gene_expr_recon_loss: 50530104.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52114450.0000; val_optim_loss: 52114450.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9317; val_auprc_score: 0.9841; val_best_acc_score: 0.8510; val_best_f1_score: 0.9195; train_kl_reg_loss: 383298.1750; train_edge_recon_loss: 1202157.3750; train_gene_expr_recon_loss: 50140200.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51725655.6000; train_optim_loss: 51725655.6000; val_kl_reg_loss: 373697.0000; val_edge_recon_loss: 1181352.5000; val_gene_expr_recon_loss: 49743480.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51298530.0000; val_optim_loss: 51298530.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9301; val_auprc_score: 0.9844; val_best_acc_score: 0.8575; val_best_f1_score: 0.9233; train_kl_reg_loss: 375394.9844; train_edge_recon_loss: 1192586.8000; train_gene_expr_recon_loss: 49302195.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50870176.8000; train_optim_loss: 50870176.8000; val_kl_reg_loss: 364994.2812; val_edge_recon_loss: 1103370.2188; val_gene_expr_recon_loss: 48835856.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50304220.0000; val_optim_loss: 50304220.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9322; val_auprc_score: 0.9848; val_best_acc_score: 0.8554; val_best_f1_score: 0.9221; train_kl_reg_loss: 366990.9375; train_edge_recon_loss: 1192474.9875; train_gene_expr_recon_loss: 48380081.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49939547.2000; train_optim_loss: 49939547.2000; val_kl_reg_loss: 356274.3438; val_edge_recon_loss: 1202394.2500; val_gene_expr_recon_loss: 47885286.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49443954.0000; val_optim_loss: 49443954.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9319; val_auprc_score: 0.9847; val_best_acc_score: 0.8557; val_best_f1_score: 0.9222; train_kl_reg_loss: 357226.3500; train_edge_recon_loss: 1197485.9375; train_gene_expr_recon_loss: 47377307.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48932019.6000; train_optim_loss: 48932019.6000; val_kl_reg_loss: 346723.2031; val_edge_recon_loss: 1186697.3125; val_gene_expr_recon_loss: 46839432.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48372852.0000; val_optim_loss: 48372852.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9269; val_auprc_score: 0.9830; val_best_acc_score: 0.8526; val_best_f1_score: 0.9204; train_kl_reg_loss: 347721.4156; train_edge_recon_loss: 1193730.4500; train_gene_expr_recon_loss: 46343691.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47885143.6000; train_optim_loss: 47885143.6000; val_kl_reg_loss: 336972.1406; val_edge_recon_loss: 1159480.0000; val_gene_expr_recon_loss: 45784608.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47281060.0000; val_optim_loss: 47281060.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9290; val_auprc_score: 0.9842; val_best_acc_score: 0.8554; val_best_f1_score: 0.9221; train_kl_reg_loss: 337747.3656; train_edge_recon_loss: 1187490.7500; train_gene_expr_recon_loss: 45287372.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46812610.8000; train_optim_loss: 46812610.8000; val_kl_reg_loss: 327012.1562; val_edge_recon_loss: 1104687.0000; val_gene_expr_recon_loss: 44741908.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46173608.0000; val_optim_loss: 46173608.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9312; val_auprc_score: 0.9843; val_best_acc_score: 0.8506; val_best_f1_score: 0.9192; train_kl_reg_loss: 342380.7188; train_edge_recon_loss: 1191237.8000; train_gene_expr_recon_loss: 44183151.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45716770.4000; train_optim_loss: 45716770.4000; val_kl_reg_loss: 320821.9531; val_edge_recon_loss: 1256445.3750; val_gene_expr_recon_loss: 43797240.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45374508.0000; val_optim_loss: 45374508.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9246; val_auprc_score: 0.9834; val_best_acc_score: 0.8576; val_best_f1_score: 0.9233; train_kl_reg_loss: 330663.9094; train_edge_recon_loss: 1192297.5625; train_gene_expr_recon_loss: 43378768.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44901730.4000; train_optim_loss: 44901730.4000; val_kl_reg_loss: 332253.5625; val_edge_recon_loss: 1163560.3125; val_gene_expr_recon_loss: 42925428.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44421242.0000; val_optim_loss: 44421242.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9267; val_auprc_score: 0.9837; val_best_acc_score: 0.8560; val_best_f1_score: 0.9224; train_kl_reg_loss: 339566.0438; train_edge_recon_loss: 1197787.0625; train_gene_expr_recon_loss: 42558085.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44095438.8000; train_optim_loss: 44095438.8000; val_kl_reg_loss: 334374.0000; val_edge_recon_loss: 1185239.2500; val_gene_expr_recon_loss: 42171372.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43690986.0000; val_optim_loss: 43690986.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9274; val_auprc_score: 0.9841; val_best_acc_score: 0.8505; val_best_f1_score: 0.9192; train_kl_reg_loss: 336185.8281; train_edge_recon_loss: 1209692.3625; train_gene_expr_recon_loss: 41851878.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43397756.8000; train_optim_loss: 43397756.8000; val_kl_reg_loss: 326245.8125; val_edge_recon_loss: 1224443.3125; val_gene_expr_recon_loss: 41525144.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43075832.0000; val_optim_loss: 43075832.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9184; val_auprc_score: 0.9824; val_best_acc_score: 0.8573; val_best_f1_score: 0.9231; train_kl_reg_loss: 327015.2531; train_edge_recon_loss: 1195592.7375; train_gene_expr_recon_loss: 41278075.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42800682.8000; train_optim_loss: 42800682.8000; val_kl_reg_loss: 316687.8594; val_edge_recon_loss: 1208818.5625; val_gene_expr_recon_loss: 41023962.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42549470.0000; val_optim_loss: 42549470.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9235; val_auprc_score: 0.9822; val_best_acc_score: 0.8470; val_best_f1_score: 0.9172; train_kl_reg_loss: 349880.3187; train_edge_recon_loss: 1196788.8125; train_gene_expr_recon_loss: 40887329.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42433998.8000; train_optim_loss: 42433998.8000; val_kl_reg_loss: 315236.9219; val_edge_recon_loss: 1286368.3125; val_gene_expr_recon_loss: 40646122.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42247728.0000; val_optim_loss: 42247728.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9236; val_auprc_score: 0.9833; val_best_acc_score: 0.8559; val_best_f1_score: 0.9224; train_kl_reg_loss: 336669.1844; train_edge_recon_loss: 1193828.7500; train_gene_expr_recon_loss: 44089533.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45620032.4000; train_optim_loss: 45620032.4000; val_kl_reg_loss: 315713.3281; val_edge_recon_loss: 1203833.5000; val_gene_expr_recon_loss: 42451232.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43970778.0000; val_optim_loss: 43970778.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9223; val_auprc_score: 0.9814; val_best_acc_score: 0.8510; val_best_f1_score: 0.9195; train_kl_reg_loss: 372314.1625; train_edge_recon_loss: 1183609.0750; train_gene_expr_recon_loss: 41919436.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43475360.0000; train_optim_loss: 43475360.0000; val_kl_reg_loss: 405703.4219; val_edge_recon_loss: 1203987.1250; val_gene_expr_recon_loss: 40996050.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42605740.0000; val_optim_loss: 42605740.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9173; val_auprc_score: 0.9798; val_best_acc_score: 0.8499; val_best_f1_score: 0.9189; train_kl_reg_loss: 431947.0906; train_edge_recon_loss: 1190856.2625; train_gene_expr_recon_loss: 40594284.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42217086.8000; train_optim_loss: 42217086.8000; val_kl_reg_loss: 433107.9688; val_edge_recon_loss: 1262875.5625; val_gene_expr_recon_loss: 40255050.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41951034.0000; val_optim_loss: 41951034.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9225; val_auprc_score: 0.9822; val_best_acc_score: 0.8536; val_best_f1_score: 0.9210; train_kl_reg_loss: 430253.6281; train_edge_recon_loss: 1200911.4750; train_gene_expr_recon_loss: 40014813.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41645979.2000; train_optim_loss: 41645979.2000; val_kl_reg_loss: 410821.1406; val_edge_recon_loss: 1199434.2500; val_gene_expr_recon_loss: 39850488.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41460744.0000; val_optim_loss: 41460744.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9154; val_auprc_score: 0.9793; val_best_acc_score: 0.8482; val_best_f1_score: 0.9179; train_kl_reg_loss: 396990.8781; train_edge_recon_loss: 1203638.6500; train_gene_expr_recon_loss: 39722947.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41323576.8000; train_optim_loss: 41323576.8000; val_kl_reg_loss: 368522.0000; val_edge_recon_loss: 1212465.7500; val_gene_expr_recon_loss: 39603852.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41184840.0000; val_optim_loss: 41184840.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9194; val_auprc_score: 0.9818; val_best_acc_score: 0.8545; val_best_f1_score: 0.9215; train_kl_reg_loss: 358418.3937; train_edge_recon_loss: 1192464.4250; train_gene_expr_recon_loss: 39535168.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41086051.2000; train_optim_loss: 41086051.2000; val_kl_reg_loss: 335566.1094; val_edge_recon_loss: 1184780.8750; val_gene_expr_recon_loss: 39467824.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40988170.0000; val_optim_loss: 40988170.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9183; val_auprc_score: 0.9815; val_best_acc_score: 0.8551; val_best_f1_score: 0.9219; train_kl_reg_loss: 327145.3187; train_edge_recon_loss: 1194547.1250; train_gene_expr_recon_loss: 39411347.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40933039.6000; train_optim_loss: 40933039.6000; val_kl_reg_loss: 304618.6562; val_edge_recon_loss: 1225476.4375; val_gene_expr_recon_loss: 39348004.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40878100.0000; val_optim_loss: 40878100.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9102; val_auprc_score: 0.9796; val_best_acc_score: 0.8494; val_best_f1_score: 0.9186; train_kl_reg_loss: 306091.1281; train_edge_recon_loss: 1187707.1250; train_gene_expr_recon_loss: 39297538.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40791336.8000; train_optim_loss: 40791336.8000; val_kl_reg_loss: 285987.2188; val_edge_recon_loss: 1232737.2500; val_gene_expr_recon_loss: 39242706.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40761430.0000; val_optim_loss: 40761430.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9070; val_auprc_score: 0.9747; val_best_acc_score: 0.8476; val_best_f1_score: 0.9175; train_kl_reg_loss: 1904616711.8094; train_edge_recon_loss: 1112911.8875; train_gene_expr_recon_loss: 631579724.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2537309390.8000; train_optim_loss: 2537309390.8000; val_kl_reg_loss: 871841.6250; val_edge_recon_loss: 1204188.8750; val_gene_expr_recon_loss: 103498808.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105574840.0000; val_optim_loss: 105574840.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8468; val_auprc_score: 0.9535; val_best_acc_score: 0.8563; val_best_f1_score: 0.9226; train_kl_reg_loss: 415218790.8250; train_edge_recon_loss: 1190805.8125; train_gene_expr_recon_loss: 320640520.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 737050106.4000; train_optim_loss: 737050106.4000; val_kl_reg_loss: 2240020.1250; val_edge_recon_loss: 1146979.3125; val_gene_expr_recon_loss: 82777164.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 86164164.0000; val_optim_loss: 86164164.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.7530; val_auprc_score: 0.9222; val_best_acc_score: 0.8526; val_best_f1_score: 0.9204; train_kl_reg_loss: 452216090.3250; train_edge_recon_loss: 1175908.7500; train_gene_expr_recon_loss: 384717153.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 838109140.0000; train_optim_loss: 838109140.0000; val_kl_reg_loss: 3888590.0000; val_edge_recon_loss: 1200469.6250; val_gene_expr_recon_loss: 86376712.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 91465772.0000; val_optim_loss: 91465772.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.7576; val_auprc_score: 0.9218; val_best_acc_score: 0.8496; val_best_f1_score: 0.9187; train_kl_reg_loss: 4224807.6750; train_edge_recon_loss: 1194687.8125; train_gene_expr_recon_loss: 102140662.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 107560157.6000; train_optim_loss: 107560157.6000; val_kl_reg_loss: 4352008.0000; val_edge_recon_loss: 1242876.2500; val_gene_expr_recon_loss: 63369778.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 68964660.0000; val_optim_loss: 68964660.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.7479; val_auprc_score: 0.9205; val_best_acc_score: 0.8522; val_best_f1_score: 0.9202; train_kl_reg_loss: 4414226.3000; train_edge_recon_loss: 1191200.6250; train_gene_expr_recon_loss: 61950190.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 67555618.4000; train_optim_loss: 67555618.4000; val_kl_reg_loss: 4319585.0000; val_edge_recon_loss: 1234954.1875; val_gene_expr_recon_loss: 60422224.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 65976764.0000; val_optim_loss: 65976764.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.7515; val_auprc_score: 0.9227; val_best_acc_score: 0.8545; val_best_f1_score: 0.9215; train_kl_reg_loss: 4349180.1000; train_edge_recon_loss: 1196819.3250; train_gene_expr_recon_loss: 59641400.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 65187400.0000; train_optim_loss: 65187400.0000; val_kl_reg_loss: 4243116.7500; val_edge_recon_loss: 1120647.9375; val_gene_expr_recon_loss: 58860554.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 64224318.0000; val_optim_loss: 64224318.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.7542; val_auprc_score: 0.9208; val_best_acc_score: 0.8495; val_best_f1_score: 0.9186; train_kl_reg_loss: 4277069.3000; train_edge_recon_loss: 1180083.4625; train_gene_expr_recon_loss: 58471403.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 63928556.0000; train_optim_loss: 63928556.0000; val_kl_reg_loss: 4184037.1250; val_edge_recon_loss: 1253997.0000; val_gene_expr_recon_loss: 58060744.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 63498780.0000; val_optim_loss: 63498780.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.7568; val_auprc_score: 0.9240; val_best_acc_score: 0.8538; val_best_f1_score: 0.9211; train_kl_reg_loss: 4212642.8000; train_edge_recon_loss: 1201493.9625; train_gene_expr_recon_loss: 57738669.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 63152806.4000; train_optim_loss: 63152806.4000; val_kl_reg_loss: 4126876.8750; val_edge_recon_loss: 1172845.1875; val_gene_expr_recon_loss: 57426888.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62726610.0000; val_optim_loss: 62726610.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 16 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
val AUROC score: 0.9118
val AUPRC score: 0.9797
val best accuracy score: 0.8523
val best F1 score: 0.9203
val target rna MSE score: 21.0379
val source rna MSE score: 21.6444
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 5: 0 hours, 5 minutes and 21 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1492, n_latent: 1482, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1482, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1482, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 53693
Number of validation edges: 5965
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9411; val_auprc_score: 0.9887; val_best_acc_score: 0.8540; val_best_f1_score: 0.9212; train_kl_reg_loss: 275999.7889; train_edge_recon_loss: 1046691.3304; train_gene_expr_recon_loss: 221851440.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 223174136.0000; train_optim_loss: 223174136.0000; val_kl_reg_loss: 142275.7812; val_edge_recon_loss: 1187553.0000; val_gene_expr_recon_loss: 92690144.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 94019976.0000; val_optim_loss: 94019976.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9326; val_auprc_score: 0.9856; val_best_acc_score: 0.8512; val_best_f1_score: 0.9196; train_kl_reg_loss: 194405.9688; train_edge_recon_loss: 1118883.5000; train_gene_expr_recon_loss: 81171940.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 82485230.8571; train_optim_loss: 82485230.8571; val_kl_reg_loss: 297866.4062; val_edge_recon_loss: 1210368.2500; val_gene_expr_recon_loss: 72348224.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 73856456.0000; val_optim_loss: 73856456.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9289; val_auprc_score: 0.9838; val_best_acc_score: 0.8523; val_best_f1_score: 0.9202; train_kl_reg_loss: 317341.8906; train_edge_recon_loss: 1185640.3393; train_gene_expr_recon_loss: 67021041.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 68524024.5714; train_optim_loss: 68524024.5714; val_kl_reg_loss: 373540.0625; val_edge_recon_loss: 1201470.2500; val_gene_expr_recon_loss: 62046248.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 63621260.0000; val_optim_loss: 63621260.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9244; val_auprc_score: 0.9817; val_best_acc_score: 0.8513; val_best_f1_score: 0.9197; train_kl_reg_loss: 426583.3036; train_edge_recon_loss: 1191182.0179; train_gene_expr_recon_loss: 59575210.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61192975.4286; train_optim_loss: 61192975.4286; val_kl_reg_loss: 473780.2188; val_edge_recon_loss: 1209384.7500; val_gene_expr_recon_loss: 58342984.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60026148.0000; val_optim_loss: 60026148.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9211; val_auprc_score: 0.9803; val_best_acc_score: 0.8548; val_best_f1_score: 0.9217; train_kl_reg_loss: 505702.8973; train_edge_recon_loss: 1205266.8214; train_gene_expr_recon_loss: 55910920.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57621890.2857; train_optim_loss: 57621890.2857; val_kl_reg_loss: 517986.7812; val_edge_recon_loss: 1180612.8750; val_gene_expr_recon_loss: 55496512.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57195112.0000; val_optim_loss: 57195112.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9191; val_auprc_score: 0.9803; val_best_acc_score: 0.8561; val_best_f1_score: 0.9224; train_kl_reg_loss: 536655.4911; train_edge_recon_loss: 1185446.7500; train_gene_expr_recon_loss: 54222877.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55944979.4286; train_optim_loss: 55944979.4286; val_kl_reg_loss: 543276.1250; val_edge_recon_loss: 1170636.2500; val_gene_expr_recon_loss: 53428648.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55142560.0000; val_optim_loss: 55142560.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9210; val_auprc_score: 0.9805; val_best_acc_score: 0.8540; val_best_f1_score: 0.9212; train_kl_reg_loss: 563697.1786; train_edge_recon_loss: 1177154.8036; train_gene_expr_recon_loss: 53151163.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54892015.4286; train_optim_loss: 54892015.4286; val_kl_reg_loss: 564037.9375; val_edge_recon_loss: 1187580.2500; val_gene_expr_recon_loss: 52349984.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54101604.0000; val_optim_loss: 54101604.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9227; val_auprc_score: 0.9805; val_best_acc_score: 0.8539; val_best_f1_score: 0.9212; train_kl_reg_loss: 573501.4196; train_edge_recon_loss: 1202716.6071; train_gene_expr_recon_loss: 52270846.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54047064.5714; train_optim_loss: 54047064.5714; val_kl_reg_loss: 562954.1250; val_edge_recon_loss: 1188574.0000; val_gene_expr_recon_loss: 51936288.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53687816.0000; val_optim_loss: 53687816.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9176; val_auprc_score: 0.9789; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 572115.8929; train_edge_recon_loss: 1195263.0000; train_gene_expr_recon_loss: 51698906.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53466285.7143; train_optim_loss: 53466285.7143; val_kl_reg_loss: 560522.3750; val_edge_recon_loss: 1206420.1250; val_gene_expr_recon_loss: 51555252.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53322196.0000; val_optim_loss: 53322196.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9250; val_auprc_score: 0.9820; val_best_acc_score: 0.8570; val_best_f1_score: 0.9230; train_kl_reg_loss: 566932.3839; train_edge_recon_loss: 1188802.9107; train_gene_expr_recon_loss: 51275573.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53031308.5714; train_optim_loss: 53031308.5714; val_kl_reg_loss: 552212.6250; val_edge_recon_loss: 1162633.6250; val_gene_expr_recon_loss: 51159828.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52874676.0000; val_optim_loss: 52874676.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9235; val_auprc_score: 0.9809; val_best_acc_score: 0.8539; val_best_f1_score: 0.9212; train_kl_reg_loss: 558170.1250; train_edge_recon_loss: 1201716.4821; train_gene_expr_recon_loss: 50943609.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52703496.0000; train_optim_loss: 52703496.0000; val_kl_reg_loss: 544170.2500; val_edge_recon_loss: 1188574.0000; val_gene_expr_recon_loss: 50798696.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52531440.0000; val_optim_loss: 52531440.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9173; val_auprc_score: 0.9799; val_best_acc_score: 0.8561; val_best_f1_score: 0.9224; train_kl_reg_loss: 549862.3304; train_edge_recon_loss: 1177658.6250; train_gene_expr_recon_loss: 50606704.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52334225.1429; train_optim_loss: 52334225.1429; val_kl_reg_loss: 534029.8750; val_edge_recon_loss: 1170635.6250; val_gene_expr_recon_loss: 50454680.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52159344.0000; val_optim_loss: 52159344.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9357; val_auprc_score: 0.9843; val_best_acc_score: 0.8489; val_best_f1_score: 0.9183; train_kl_reg_loss: 540034.5625; train_edge_recon_loss: 1212047.4643; train_gene_expr_recon_loss: 50293390.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52045472.5714; train_optim_loss: 52045472.5714; val_kl_reg_loss: 524931.1250; val_edge_recon_loss: 1229089.3750; val_gene_expr_recon_loss: 50145056.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51899076.0000; val_optim_loss: 51899076.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9142; val_auprc_score: 0.9773; val_best_acc_score: 0.8451; val_best_f1_score: 0.9161; train_kl_reg_loss: 530812.7857; train_edge_recon_loss: 1196410.9643; train_gene_expr_recon_loss: 49984000.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51711224.0000; train_optim_loss: 51711224.0000; val_kl_reg_loss: 514747.2500; val_edge_recon_loss: 1259411.1250; val_gene_expr_recon_loss: 49819844.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51594004.0000; val_optim_loss: 51594004.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9307; val_auprc_score: 0.9843; val_best_acc_score: 0.8577; val_best_f1_score: 0.9234; train_kl_reg_loss: 520261.6920; train_edge_recon_loss: 1199113.0536; train_gene_expr_recon_loss: 49650392.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51369767.4286; train_optim_loss: 51369767.4286; val_kl_reg_loss: 504474.0625; val_edge_recon_loss: 1157622.7500; val_gene_expr_recon_loss: 49472780.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51134876.0000; val_optim_loss: 51134876.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9254; val_auprc_score: 0.9809; val_best_acc_score: 0.8467; val_best_f1_score: 0.9170; train_kl_reg_loss: 509907.2411; train_edge_recon_loss: 1203084.2679; train_gene_expr_recon_loss: 49301340.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51014331.4286; train_optim_loss: 51014331.4286; val_kl_reg_loss: 495149.3125; val_edge_recon_loss: 1246727.5000; val_gene_expr_recon_loss: 49134280.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50876156.0000; val_optim_loss: 50876156.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9258; val_auprc_score: 0.9822; val_best_acc_score: 0.8497; val_best_f1_score: 0.9188; train_kl_reg_loss: 499454.8705; train_edge_recon_loss: 1186603.1429; train_gene_expr_recon_loss: 48946196.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50632253.7143; train_optim_loss: 50632253.7143; val_kl_reg_loss: 484748.9062; val_edge_recon_loss: 1222205.1250; val_gene_expr_recon_loss: 48758780.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50465736.0000; val_optim_loss: 50465736.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9267; val_auprc_score: 0.9837; val_best_acc_score: 0.8594; val_best_f1_score: 0.9244; train_kl_reg_loss: 488960.1071; train_edge_recon_loss: 1201235.9464; train_gene_expr_recon_loss: 48556077.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50246274.2857; train_optim_loss: 50246274.2857; val_kl_reg_loss: 473748.9062; val_edge_recon_loss: 1143553.5000; val_gene_expr_recon_loss: 48337848.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49955152.0000; val_optim_loss: 49955152.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9185; val_auprc_score: 0.9804; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 478471.1250; train_edge_recon_loss: 1194561.6250; train_gene_expr_recon_loss: 48140851.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49813884.0000; train_optim_loss: 49813884.0000; val_kl_reg_loss: 464588.5625; val_edge_recon_loss: 1204440.5000; val_gene_expr_recon_loss: 47906272.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49575300.0000; val_optim_loss: 49575300.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9292; val_auprc_score: 0.9845; val_best_acc_score: 0.8552; val_best_f1_score: 0.9219; train_kl_reg_loss: 469016.3214; train_edge_recon_loss: 1209837.2321; train_gene_expr_recon_loss: 47696786.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49375640.5714; train_optim_loss: 49375640.5714; val_kl_reg_loss: 454940.0000; val_edge_recon_loss: 1177621.5000; val_gene_expr_recon_loss: 47451592.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49084152.0000; val_optim_loss: 49084152.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9210; val_auprc_score: 0.9819; val_best_acc_score: 0.8558; val_best_f1_score: 0.9223; train_kl_reg_loss: 458610.4241; train_edge_recon_loss: 1187512.5893; train_gene_expr_recon_loss: 47221311.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48867434.2857; train_optim_loss: 48867434.2857; val_kl_reg_loss: 446526.2188; val_edge_recon_loss: 1172632.0000; val_gene_expr_recon_loss: 46974924.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48594084.0000; val_optim_loss: 48594084.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9255; val_auprc_score: 0.9828; val_best_acc_score: 0.8569; val_best_f1_score: 0.9229; train_kl_reg_loss: 449263.4196; train_edge_recon_loss: 1199445.8214; train_gene_expr_recon_loss: 46720845.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48369555.4286; train_optim_loss: 48369555.4286; val_kl_reg_loss: 436220.1250; val_edge_recon_loss: 1163633.2500; val_gene_expr_recon_loss: 46446528.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48046380.0000; val_optim_loss: 48046380.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9253; val_auprc_score: 0.9832; val_best_acc_score: 0.8567; val_best_f1_score: 0.9228; train_kl_reg_loss: 439439.9152; train_edge_recon_loss: 1201137.9464; train_gene_expr_recon_loss: 46200550.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47841128.0000; train_optim_loss: 47841128.0000; val_kl_reg_loss: 427232.4062; val_edge_recon_loss: 1165634.5000; val_gene_expr_recon_loss: 45918208.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47511076.0000; val_optim_loss: 47511076.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9247; val_auprc_score: 0.9829; val_best_acc_score: 0.8480; val_best_f1_score: 0.9178; train_kl_reg_loss: 430596.3438; train_edge_recon_loss: 1195405.1071; train_gene_expr_recon_loss: 45676541.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47302542.2857; train_optim_loss: 47302542.2857; val_kl_reg_loss: 417279.7812; val_edge_recon_loss: 1235957.6250; val_gene_expr_recon_loss: 45358840.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47012076.0000; val_optim_loss: 47012076.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9129; val_auprc_score: 0.9799; val_best_acc_score: 0.8523; val_best_f1_score: 0.9202; train_kl_reg_loss: 420361.5045; train_edge_recon_loss: 1189029.2500; train_gene_expr_recon_loss: 45099478.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46708869.1429; train_optim_loss: 46708869.1429; val_kl_reg_loss: 407773.3750; val_edge_recon_loss: 1201469.2500; val_gene_expr_recon_loss: 44776976.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46386220.0000; val_optim_loss: 46386220.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9176; val_auprc_score: 0.9807; val_best_acc_score: 0.8486; val_best_f1_score: 0.9181; train_kl_reg_loss: 411468.5179; train_edge_recon_loss: 1185586.8214; train_gene_expr_recon_loss: 44540532.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46137587.4286; train_optim_loss: 46137587.4286; val_kl_reg_loss: 399678.6875; val_edge_recon_loss: 1231050.5000; val_gene_expr_recon_loss: 44234700.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45865428.0000; val_optim_loss: 45865428.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9143; val_auprc_score: 0.9818; val_best_acc_score: 0.8578; val_best_f1_score: 0.9234; train_kl_reg_loss: 402507.3170; train_edge_recon_loss: 1194816.3036; train_gene_expr_recon_loss: 43990800.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45588124.5714; train_optim_loss: 45588124.5714; val_kl_reg_loss: 390339.4062; val_edge_recon_loss: 1156616.2500; val_gene_expr_recon_loss: 43692268.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45239224.0000; val_optim_loss: 45239224.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9175; val_auprc_score: 0.9828; val_best_acc_score: 0.8557; val_best_f1_score: 0.9222; train_kl_reg_loss: 393811.0714; train_edge_recon_loss: 1187508.4464; train_gene_expr_recon_loss: 43462095.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45043414.2857; train_optim_loss: 45043414.2857; val_kl_reg_loss: 381413.7500; val_edge_recon_loss: 1173628.0000; val_gene_expr_recon_loss: 43171944.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44726984.0000; val_optim_loss: 44726984.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9116; val_auprc_score: 0.9801; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 385017.6027; train_edge_recon_loss: 1182024.0357; train_gene_expr_recon_loss: 42961902.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44528944.0000; train_optim_loss: 44528944.0000; val_kl_reg_loss: 374149.3125; val_edge_recon_loss: 1204436.8750; val_gene_expr_recon_loss: 42702984.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44281572.0000; val_optim_loss: 44281572.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9181; val_auprc_score: 0.9824; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 376450.3393; train_edge_recon_loss: 1202861.8393; train_gene_expr_recon_loss: 42485706.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44065018.2857; train_optim_loss: 44065018.2857; val_kl_reg_loss: 365135.0000; val_edge_recon_loss: 1203446.2500; val_gene_expr_recon_loss: 42223368.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43791948.0000; val_optim_loss: 43791948.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9129; val_auprc_score: 0.9821; val_best_acc_score: 0.8564; val_best_f1_score: 0.9227; train_kl_reg_loss: 368210.4375; train_edge_recon_loss: 1185572.4464; train_gene_expr_recon_loss: 42050726.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43604510.2857; train_optim_loss: 43604510.2857; val_kl_reg_loss: 356968.5625; val_edge_recon_loss: 1167631.5000; val_gene_expr_recon_loss: 41801368.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43325968.0000; val_optim_loss: 43325968.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9097; val_auprc_score: 0.9801; val_best_acc_score: 0.8514; val_best_f1_score: 0.9197; train_kl_reg_loss: 360221.1964; train_edge_recon_loss: 1175938.8214; train_gene_expr_recon_loss: 41646560.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43182720.5714; train_optim_loss: 43182720.5714; val_kl_reg_loss: 349603.6562; val_edge_recon_loss: 1208390.3750; val_gene_expr_recon_loss: 41418632.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42976624.0000; val_optim_loss: 42976624.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9104; val_auprc_score: 0.9819; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 352434.0714; train_edge_recon_loss: 1184230.9107; train_gene_expr_recon_loss: 41266487.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42803152.5714; train_optim_loss: 42803152.5714; val_kl_reg_loss: 340738.9375; val_edge_recon_loss: 1189561.2500; val_gene_expr_recon_loss: 41055912.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42586212.0000; val_optim_loss: 42586212.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9101; val_auprc_score: 0.9809; val_best_acc_score: 0.8536; val_best_f1_score: 0.9210; train_kl_reg_loss: 344229.2143; train_edge_recon_loss: 1200662.5893; train_gene_expr_recon_loss: 40931514.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42476406.8571; train_optim_loss: 42476406.8571; val_kl_reg_loss: 334850.1250; val_edge_recon_loss: 1190552.1250; val_gene_expr_recon_loss: 40757556.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42282960.0000; val_optim_loss: 42282960.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8986; val_auprc_score: 0.9790; val_best_acc_score: 0.8578; val_best_f1_score: 0.9234; train_kl_reg_loss: 336964.6473; train_edge_recon_loss: 1207242.6786; train_gene_expr_recon_loss: 40614549.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42158757.1429; train_optim_loss: 42158757.1429; val_kl_reg_loss: 8585062.0000; val_edge_recon_loss: 1156609.5000; val_gene_expr_recon_loss: 40472528.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50214200.0000; val_optim_loss: 50214200.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9203; val_auprc_score: 0.9794; val_best_acc_score: 0.8498; val_best_f1_score: 0.9188; train_kl_reg_loss: 584785428.5000; train_edge_recon_loss: 1097301.4643; train_gene_expr_recon_loss: 720163757.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1306046509.7143; train_optim_loss: 1306046509.7143; val_kl_reg_loss: 993477.0000; val_edge_recon_loss: 1221222.8750; val_gene_expr_recon_loss: 152892608.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 155107312.0000; val_optim_loss: 155107312.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8624; val_auprc_score: 0.9581; val_best_acc_score: 0.8565; val_best_f1_score: 0.9227; train_kl_reg_loss: 1435884.3304; train_edge_recon_loss: 1176419.3036; train_gene_expr_recon_loss: 151620821.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 154233125.7143; train_optim_loss: 154233125.7143; val_kl_reg_loss: 6486691840.0000; val_edge_recon_loss: 1166640.1250; val_gene_expr_recon_loss: 87539152.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6575397888.0000; val_optim_loss: 6575397888.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8435; val_auprc_score: 0.9497; val_best_acc_score: 0.8524; val_best_f1_score: 0.9203; train_kl_reg_loss: 1093453051.3571; train_edge_recon_loss: 1180329.4107; train_gene_expr_recon_loss: 292535697.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1387169082.2857; train_optim_loss: 1387169082.2857; val_kl_reg_loss: 3168106.5000; val_edge_recon_loss: 1200484.5000; val_gene_expr_recon_loss: 76206688.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 80575280.0000; val_optim_loss: 80575280.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8179; val_auprc_score: 0.9414; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 3151350.1071; train_edge_recon_loss: 1179781.0714; train_gene_expr_recon_loss: 100541609.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104872740.5714; train_optim_loss: 104872740.5714; val_kl_reg_loss: 3088524.2500; val_edge_recon_loss: 1206423.1250; val_gene_expr_recon_loss: 68390448.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 72685392.0000; val_optim_loss: 72685392.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8046; val_auprc_score: 0.9366; val_best_acc_score: 0.8501; val_best_f1_score: 0.9190; train_kl_reg_loss: 3142990.5357; train_edge_recon_loss: 1184368.4643; train_gene_expr_recon_loss: 66255581.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 70582940.5714; train_optim_loss: 70582940.5714; val_kl_reg_loss: 3071892.7500; val_edge_recon_loss: 1219254.7500; val_gene_expr_recon_loss: 64261420.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 68552568.0000; val_optim_loss: 68552568.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8114; val_auprc_score: 0.9419; val_best_acc_score: 0.8575; val_best_f1_score: 0.9233; train_kl_reg_loss: 3112340.3929; train_edge_recon_loss: 1195281.0357; train_gene_expr_recon_loss: 62880877.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 67188498.2857; train_optim_loss: 67188498.2857; val_kl_reg_loss: 3036730.5000; val_edge_recon_loss: 1158628.7500; val_gene_expr_recon_loss: 61307480.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 65502840.0000; val_optim_loss: 65502840.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8016; val_auprc_score: 0.9384; val_best_acc_score: 0.8561; val_best_f1_score: 0.9224; train_kl_reg_loss: 3070034.5714; train_edge_recon_loss: 1187492.8393; train_gene_expr_recon_loss: 60243074.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 64500601.7143; train_optim_loss: 64500601.7143; val_kl_reg_loss: 2993599.2500; val_edge_recon_loss: 1170639.0000; val_gene_expr_recon_loss: 59193440.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 63357680.0000; val_optim_loss: 63357680.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 23 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
val AUROC score: 0.9085
val AUPRC score: 0.9799
val best accuracy score: 0.8519
val best F1 score: 0.9200
val target rna MSE score: 48.8108
val source rna MSE score: 70.0982
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 4: 0 hours, 4 minutes and 27 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1492, n_latent: 1482, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1482, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1482, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 53693
Number of validation edges: 5965
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9320; val_auprc_score: 0.9860; val_best_acc_score: 0.8559; val_best_f1_score: 0.9224; train_kl_reg_loss: 335632.6693; train_edge_recon_loss: 1058900.9911; train_gene_expr_recon_loss: 169202870.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 170597404.5714; train_optim_loss: 170597404.5714; val_kl_reg_loss: 364272.5938; val_edge_recon_loss: 1171618.1250; val_gene_expr_recon_loss: 65876704.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 67412592.0000; val_optim_loss: 67412592.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9301; val_auprc_score: 0.9840; val_best_acc_score: 0.8450; val_best_f1_score: 0.9160; train_kl_reg_loss: 278706.4665; train_edge_recon_loss: 1141780.5000; train_gene_expr_recon_loss: 67714721.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 69135208.5714; train_optim_loss: 69135208.5714; val_kl_reg_loss: 353700.2500; val_edge_recon_loss: 1260383.1250; val_gene_expr_recon_loss: 59380984.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60995068.0000; val_optim_loss: 60995068.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9288; val_auprc_score: 0.9817; val_best_acc_score: 0.8473; val_best_f1_score: 0.9173; train_kl_reg_loss: 456051.0848; train_edge_recon_loss: 1185851.9286; train_gene_expr_recon_loss: 58058385.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59700288.0000; train_optim_loss: 59700288.0000; val_kl_reg_loss: 549568.1875; val_edge_recon_loss: 1241837.8750; val_gene_expr_recon_loss: 60316504.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62107912.0000; val_optim_loss: 62107912.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9288; val_auprc_score: 0.9823; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 612382.6607; train_edge_recon_loss: 1178355.0536; train_gene_expr_recon_loss: 56992607.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58783345.1429; train_optim_loss: 58783345.1429; val_kl_reg_loss: 666881.6250; val_edge_recon_loss: 1204442.1250; val_gene_expr_recon_loss: 55795352.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57666676.0000; val_optim_loss: 57666676.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9270; val_auprc_score: 0.9821; val_best_acc_score: 0.8559; val_best_f1_score: 0.9224; train_kl_reg_loss: 717888.2857; train_edge_recon_loss: 1203996.4464; train_gene_expr_recon_loss: 54934998.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56856883.4286; train_optim_loss: 56856883.4286; val_kl_reg_loss: 751119.1875; val_edge_recon_loss: 1171635.8750; val_gene_expr_recon_loss: 54487168.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56409924.0000; val_optim_loss: 56409924.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9258; val_auprc_score: 0.9809; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 785612.5000; train_edge_recon_loss: 1185400.3036; train_gene_expr_recon_loss: 53820907.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55791920.5714; train_optim_loss: 55791920.5714; val_kl_reg_loss: 794709.5000; val_edge_recon_loss: 1204442.5000; val_gene_expr_recon_loss: 53254960.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55254112.0000; val_optim_loss: 55254112.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9098; val_auprc_score: 0.9763; val_best_acc_score: 0.8532; val_best_f1_score: 0.9208; train_kl_reg_loss: 817737.9286; train_edge_recon_loss: 1207490.8036; train_gene_expr_recon_loss: 53171255.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55196484.5714; train_optim_loss: 55196484.5714; val_kl_reg_loss: 812173.6250; val_edge_recon_loss: 1193541.7500; val_gene_expr_recon_loss: 52822824.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54828540.0000; val_optim_loss: 54828540.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9181; val_auprc_score: 0.9778; val_best_acc_score: 0.8473; val_best_f1_score: 0.9173; train_kl_reg_loss: 827239.2411; train_edge_recon_loss: 1180152.1071; train_gene_expr_recon_loss: 52451820.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54459211.4286; train_optim_loss: 54459211.4286; val_kl_reg_loss: 814121.1250; val_edge_recon_loss: 1241838.8750; val_gene_expr_recon_loss: 52049584.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54105544.0000; val_optim_loss: 54105544.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9223; val_auprc_score: 0.9792; val_best_acc_score: 0.8456; val_best_f1_score: 0.9164; train_kl_reg_loss: 826355.4554; train_edge_recon_loss: 1207311.7321; train_gene_expr_recon_loss: 51664144.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53697810.8571; train_optim_loss: 53697810.8571; val_kl_reg_loss: 808933.8750; val_edge_recon_loss: 1255515.1250; val_gene_expr_recon_loss: 51262224.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53326672.0000; val_optim_loss: 53326672.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9305; val_auprc_score: 0.9826; val_best_acc_score: 0.8565; val_best_f1_score: 0.9227; train_kl_reg_loss: 818627.8661; train_edge_recon_loss: 1190777.5714; train_gene_expr_recon_loss: 50853054.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52862460.0000; train_optim_loss: 52862460.0000; val_kl_reg_loss: 797777.6250; val_edge_recon_loss: 1166638.0000; val_gene_expr_recon_loss: 50407576.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52371992.0000; val_optim_loss: 52371992.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9223; val_auprc_score: 0.9791; val_best_acc_score: 0.8484; val_best_f1_score: 0.9180; train_kl_reg_loss: 804942.3036; train_edge_recon_loss: 1171231.9821; train_gene_expr_recon_loss: 49979329.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51955503.4286; train_optim_loss: 51955503.4286; val_kl_reg_loss: 782551.5000; val_edge_recon_loss: 1233018.1250; val_gene_expr_recon_loss: 49512856.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51528424.0000; val_optim_loss: 51528424.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9242; val_auprc_score: 0.9813; val_best_acc_score: 0.8575; val_best_f1_score: 0.9233; train_kl_reg_loss: 789439.1875; train_edge_recon_loss: 1186665.1607; train_gene_expr_recon_loss: 49075133.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51051237.7143; train_optim_loss: 51051237.7143; val_kl_reg_loss: 767391.2500; val_edge_recon_loss: 1158626.6250; val_gene_expr_recon_loss: 48575824.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50501840.0000; val_optim_loss: 50501840.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9214; val_auprc_score: 0.9797; val_best_acc_score: 0.8525; val_best_f1_score: 0.9204; train_kl_reg_loss: 771997.9018; train_edge_recon_loss: 1204079.4107; train_gene_expr_recon_loss: 48109482.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50085559.4286; train_optim_loss: 50085559.4286; val_kl_reg_loss: 750711.1250; val_edge_recon_loss: 1199491.6250; val_gene_expr_recon_loss: 47611632.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49561836.0000; val_optim_loss: 49561836.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9253; val_auprc_score: 0.9807; val_best_acc_score: 0.8461; val_best_f1_score: 0.9166; train_kl_reg_loss: 755647.0714; train_edge_recon_loss: 1188218.1071; train_gene_expr_recon_loss: 47158037.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49101902.2857; train_optim_loss: 49101902.2857; val_kl_reg_loss: 734275.8750; val_edge_recon_loss: 1251612.8750; val_gene_expr_recon_loss: 46659616.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48645504.0000; val_optim_loss: 48645504.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9167; val_auprc_score: 0.9783; val_best_acc_score: 0.8525; val_best_f1_score: 0.9204; train_kl_reg_loss: 737863.2768; train_edge_recon_loss: 1206086.2143; train_gene_expr_recon_loss: 46208193.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48152143.4286; train_optim_loss: 48152143.4286; val_kl_reg_loss: 715431.4375; val_edge_recon_loss: 1199491.5000; val_gene_expr_recon_loss: 45728960.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47643884.0000; val_optim_loss: 47643884.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9202; val_auprc_score: 0.9795; val_best_acc_score: 0.8531; val_best_f1_score: 0.9207; train_kl_reg_loss: 720062.1339; train_edge_recon_loss: 1184975.8571; train_gene_expr_recon_loss: 45323520.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47228558.2857; train_optim_loss: 47228558.2857; val_kl_reg_loss: 697388.8750; val_edge_recon_loss: 1194533.3750; val_gene_expr_recon_loss: 44872320.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46764244.0000; val_optim_loss: 46764244.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9201; val_auprc_score: 0.9794; val_best_acc_score: 0.8531; val_best_f1_score: 0.9207; train_kl_reg_loss: 702724.4643; train_edge_recon_loss: 1190180.6071; train_gene_expr_recon_loss: 44501772.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46394676.5714; train_optim_loss: 46394676.5714; val_kl_reg_loss: 681686.5000; val_edge_recon_loss: 1194533.1250; val_gene_expr_recon_loss: 44116752.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45992972.0000; val_optim_loss: 45992972.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9223; val_auprc_score: 0.9813; val_best_acc_score: 0.8563; val_best_f1_score: 0.9226; train_kl_reg_loss: 685935.6429; train_edge_recon_loss: 1191840.3571; train_gene_expr_recon_loss: 43779628.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45657403.4286; train_optim_loss: 45657403.4286; val_kl_reg_loss: 664217.6250; val_edge_recon_loss: 1168637.3750; val_gene_expr_recon_loss: 43439672.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45272528.0000; val_optim_loss: 45272528.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9227; val_auprc_score: 0.9816; val_best_acc_score: 0.8554; val_best_f1_score: 0.9221; train_kl_reg_loss: 669567.4911; train_edge_recon_loss: 1182425.0536; train_gene_expr_recon_loss: 43156181.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45008174.2857; train_optim_loss: 45008174.2857; val_kl_reg_loss: 649416.8125; val_edge_recon_loss: 1175628.2500; val_gene_expr_recon_loss: 42884428.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44709472.0000; val_optim_loss: 44709472.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9182; val_auprc_score: 0.9795; val_best_acc_score: 0.8535; val_best_f1_score: 0.9210; train_kl_reg_loss: 653169.1429; train_edge_recon_loss: 1177534.0000; train_gene_expr_recon_loss: 42634082.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44464785.7143; train_optim_loss: 44464785.7143; val_kl_reg_loss: 634087.6250; val_edge_recon_loss: 1191554.8750; val_gene_expr_recon_loss: 42406976.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44232620.0000; val_optim_loss: 44232620.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9240; val_auprc_score: 0.9823; val_best_acc_score: 0.8586; val_best_f1_score: 0.9239; train_kl_reg_loss: 637953.9196; train_edge_recon_loss: 1198163.0893; train_gene_expr_recon_loss: 42205096.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44041213.7143; train_optim_loss: 44041213.7143; val_kl_reg_loss: 619110.2500; val_edge_recon_loss: 1149590.6250; val_gene_expr_recon_loss: 42023852.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43792552.0000; val_optim_loss: 43792552.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9183; val_auprc_score: 0.9796; val_best_acc_score: 0.8484; val_best_f1_score: 0.9180; train_kl_reg_loss: 622266.6964; train_edge_recon_loss: 1201969.9107; train_gene_expr_recon_loss: 41837084.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43661321.1429; train_optim_loss: 43661321.1429; val_kl_reg_loss: 602220.7500; val_edge_recon_loss: 1233016.7500; val_gene_expr_recon_loss: 41689960.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43525196.0000; val_optim_loss: 43525196.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9187; val_auprc_score: 0.9803; val_best_acc_score: 0.8524; val_best_f1_score: 0.9203; train_kl_reg_loss: 607307.7946; train_edge_recon_loss: 1215586.0357; train_gene_expr_recon_loss: 41553914.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43376808.5714; train_optim_loss: 43376808.5714; val_kl_reg_loss: 588869.0000; val_edge_recon_loss: 1200481.0000; val_gene_expr_recon_loss: 41439088.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43228440.0000; val_optim_loss: 43228440.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9175; val_auprc_score: 0.9808; val_best_acc_score: 0.8575; val_best_f1_score: 0.9233; train_kl_reg_loss: 592795.1786; train_edge_recon_loss: 1193905.6607; train_gene_expr_recon_loss: 41315349.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43102050.2857; train_optim_loss: 43102050.2857; val_kl_reg_loss: 574112.5000; val_edge_recon_loss: 1158625.0000; val_gene_expr_recon_loss: 41224712.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42957448.0000; val_optim_loss: 42957448.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9171; val_auprc_score: 0.9791; val_best_acc_score: 0.8453; val_best_f1_score: 0.9161; train_kl_reg_loss: 578448.7321; train_edge_recon_loss: 1212066.9643; train_gene_expr_recon_loss: 41120546.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42911061.7143; train_optim_loss: 42911061.7143; val_kl_reg_loss: 561397.7500; val_edge_recon_loss: 1258435.8750; val_gene_expr_recon_loss: 41059040.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42878872.0000; val_optim_loss: 42878872.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9174; val_auprc_score: 0.9807; val_best_acc_score: 0.8514; val_best_f1_score: 0.9197; train_kl_reg_loss: 564534.8482; train_edge_recon_loss: 1191509.7143; train_gene_expr_recon_loss: 40952792.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42708837.7143; train_optim_loss: 42708837.7143; val_kl_reg_loss: 546803.9375; val_edge_recon_loss: 1208395.3750; val_gene_expr_recon_loss: 40903788.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42658988.0000; val_optim_loss: 42658988.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9174; val_auprc_score: 0.9807; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 551023.6875; train_edge_recon_loss: 1188867.0714; train_gene_expr_recon_loss: 40824852.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42564744.0000; train_optim_loss: 42564744.0000; val_kl_reg_loss: 534685.8750; val_edge_recon_loss: 1206417.6250; val_gene_expr_recon_loss: 40783752.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42524856.0000; val_optim_loss: 42524856.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9161; val_auprc_score: 0.9807; val_best_acc_score: 0.8539; val_best_f1_score: 0.9212; train_kl_reg_loss: 537639.8036; train_edge_recon_loss: 1199340.1964; train_gene_expr_recon_loss: 40704518.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42441498.2857; train_optim_loss: 42441498.2857; val_kl_reg_loss: 521660.1875; val_edge_recon_loss: 1188571.6250; val_gene_expr_recon_loss: 40678220.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42388452.0000; val_optim_loss: 42388452.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9196; val_auprc_score: 0.9822; val_best_acc_score: 0.8502; val_best_f1_score: 0.9190; train_kl_reg_loss: 525131.7812; train_edge_recon_loss: 1197792.3036; train_gene_expr_recon_loss: 40597770.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42320694.2857; train_optim_loss: 42320694.2857; val_kl_reg_loss: 509225.8125; val_edge_recon_loss: 1218263.1250; val_gene_expr_recon_loss: 40586396.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42313884.0000; val_optim_loss: 42313884.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9120; val_auprc_score: 0.9791; val_best_acc_score: 0.8480; val_best_f1_score: 0.9178; train_kl_reg_loss: 512449.4420; train_edge_recon_loss: 1213788.3571; train_gene_expr_recon_loss: 40503077.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42229316.0000; train_optim_loss: 42229316.0000; val_kl_reg_loss: 497624.9375; val_edge_recon_loss: 1235956.8750; val_gene_expr_recon_loss: 40495920.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42229500.0000; val_optim_loss: 42229500.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9133; val_auprc_score: 0.9804; val_best_acc_score: 0.8465; val_best_f1_score: 0.9168; train_kl_reg_loss: 500871.1250; train_edge_recon_loss: 1189382.3929; train_gene_expr_recon_loss: 40429446.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42119700.5714; train_optim_loss: 42119700.5714; val_kl_reg_loss: 484567.9688; val_edge_recon_loss: 1248678.6250; val_gene_expr_recon_loss: 40408160.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42141408.0000; val_optim_loss: 42141408.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9094; val_auprc_score: 0.9807; val_best_acc_score: 0.8575; val_best_f1_score: 0.9233; train_kl_reg_loss: 489066.0402; train_edge_recon_loss: 1176259.6786; train_gene_expr_recon_loss: 40354280.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42019606.2857; train_optim_loss: 42019606.2857; val_kl_reg_loss: 473762.8125; val_edge_recon_loss: 1158621.0000; val_gene_expr_recon_loss: 40342448.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41974832.0000; val_optim_loss: 41974832.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9038; val_auprc_score: 0.9788; val_best_acc_score: 0.8545; val_best_f1_score: 0.9215; train_kl_reg_loss: 477722.9420; train_edge_recon_loss: 1187792.0536; train_gene_expr_recon_loss: 40283507.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41949022.2857; train_optim_loss: 41949022.2857; val_kl_reg_loss: 462626.7500; val_edge_recon_loss: 1183594.8750; val_gene_expr_recon_loss: 40272124.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41918344.0000; val_optim_loss: 41918344.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9033; val_auprc_score: 0.9795; val_best_acc_score: 0.8584; val_best_f1_score: 0.9238; train_kl_reg_loss: 466871.4196; train_edge_recon_loss: 1190195.6786; train_gene_expr_recon_loss: 40219698.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41876765.1429; train_optim_loss: 41876765.1429; val_kl_reg_loss: 452272.9688; val_edge_recon_loss: 1151594.6250; val_gene_expr_recon_loss: 40218592.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41822460.0000; val_optim_loss: 41822460.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9007; val_auprc_score: 0.9786; val_best_acc_score: 0.8547; val_best_f1_score: 0.9217; train_kl_reg_loss: 456191.7768; train_edge_recon_loss: 1199272.4821; train_gene_expr_recon_loss: 40156772.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41812236.0000; train_optim_loss: 41812236.0000; val_kl_reg_loss: 442345.7812; val_edge_recon_loss: 1181603.0000; val_gene_expr_recon_loss: 40156448.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41780396.0000; val_optim_loss: 41780396.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8951; val_auprc_score: 0.9775; val_best_acc_score: 0.8567; val_best_f1_score: 0.9228; train_kl_reg_loss: 446040.6161; train_edge_recon_loss: 1216757.5893; train_gene_expr_recon_loss: 40102534.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41765332.5714; train_optim_loss: 41765332.5714; val_kl_reg_loss: 432422.1875; val_edge_recon_loss: 1165629.3750; val_gene_expr_recon_loss: 40103100.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41701152.0000; val_optim_loss: 41701152.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9031; val_auprc_score: 0.9803; val_best_acc_score: 0.8574; val_best_f1_score: 0.9232; train_kl_reg_loss: 435519.0134; train_edge_recon_loss: 1185373.1964; train_gene_expr_recon_loss: 40045856.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41666748.5714; train_optim_loss: 41666748.5714; val_kl_reg_loss: 422903.8750; val_edge_recon_loss: 1159620.2500; val_gene_expr_recon_loss: 40051200.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41633724.0000; val_optim_loss: 41633724.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9042; val_auprc_score: 0.9799; val_best_acc_score: 0.8541; val_best_f1_score: 0.9213; train_kl_reg_loss: 426028.5804; train_edge_recon_loss: 1183733.7857; train_gene_expr_recon_loss: 39983319.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41593081.7143; train_optim_loss: 41593081.7143; val_kl_reg_loss: 413727.6250; val_edge_recon_loss: 1186575.1250; val_gene_expr_recon_loss: 39999876.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41600180.0000; val_optim_loss: 41600180.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9025; val_auprc_score: 0.9797; val_best_acc_score: 0.8559; val_best_f1_score: 0.9224; train_kl_reg_loss: 416697.1875; train_edge_recon_loss: 1203982.4286; train_gene_expr_recon_loss: 39959972.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41580651.4286; train_optim_loss: 41580651.4286; val_kl_reg_loss: 404167.9688; val_edge_recon_loss: 1171624.7500; val_gene_expr_recon_loss: 39950204.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41525996.0000; val_optim_loss: 41525996.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9005; val_auprc_score: 0.9786; val_best_acc_score: 0.8500; val_best_f1_score: 0.9189; train_kl_reg_loss: 407377.6250; train_edge_recon_loss: 1207426.8393; train_gene_expr_recon_loss: 39896200.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41511004.0000; train_optim_loss: 41511004.0000; val_kl_reg_loss: 394949.2812; val_edge_recon_loss: 1220223.6250; val_gene_expr_recon_loss: 39894808.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41509980.0000; val_optim_loss: 41509980.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8893; val_auprc_score: 0.9752; val_best_acc_score: 0.8502; val_best_f1_score: 0.9190; train_kl_reg_loss: 398449.9688; train_edge_recon_loss: 1177314.0714; train_gene_expr_recon_loss: 39850838.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41426602.2857; train_optim_loss: 41426602.2857; val_kl_reg_loss: 386568.7500; val_edge_recon_loss: 1218254.6250; val_gene_expr_recon_loss: 39856620.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41461444.0000; val_optim_loss: 41461444.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8903; val_auprc_score: 0.9769; val_best_acc_score: 0.8548; val_best_f1_score: 0.9217; train_kl_reg_loss: 389875.8795; train_edge_recon_loss: 1218179.8214; train_gene_expr_recon_loss: 39799775.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41407831.4286; train_optim_loss: 41407831.4286; val_kl_reg_loss: 378110.9375; val_edge_recon_loss: 1180598.2500; val_gene_expr_recon_loss: 39818744.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41377452.0000; val_optim_loss: 41377452.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8940; val_auprc_score: 0.9774; val_best_acc_score: 0.8502; val_best_f1_score: 0.9190; train_kl_reg_loss: 380907.7946; train_edge_recon_loss: 1180701.8036; train_gene_expr_recon_loss: 39755169.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41316780.0000; train_optim_loss: 41316780.0000; val_kl_reg_loss: 369900.2812; val_edge_recon_loss: 1218249.1250; val_gene_expr_recon_loss: 39753916.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41342064.0000; val_optim_loss: 41342064.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8911; val_auprc_score: 0.9775; val_best_acc_score: 0.8540; val_best_f1_score: 0.9212; train_kl_reg_loss: 373341.6607; train_edge_recon_loss: 1192691.1250; train_gene_expr_recon_loss: 39708674.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41274707.4286; train_optim_loss: 41274707.4286; val_kl_reg_loss: 362360.0312; val_edge_recon_loss: 1187562.0000; val_gene_expr_recon_loss: 39719604.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41269528.0000; val_optim_loss: 41269528.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8910; val_auprc_score: 0.9778; val_best_acc_score: 0.8512; val_best_f1_score: 0.9196; train_kl_reg_loss: 365050.2500; train_edge_recon_loss: 1196921.3571; train_gene_expr_recon_loss: 39663390.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41225362.2857; train_optim_loss: 41225362.2857; val_kl_reg_loss: 355095.8125; val_edge_recon_loss: 1210355.6250; val_gene_expr_recon_loss: 39680024.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41245476.0000; val_optim_loss: 41245476.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.8868; val_auprc_score: 0.9749; val_best_acc_score: 0.8490; val_best_f1_score: 0.9183; train_kl_reg_loss: 357748.2188; train_edge_recon_loss: 1202362.8750; train_gene_expr_recon_loss: 39619721.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41179832.5714; train_optim_loss: 41179832.5714; val_kl_reg_loss: 346462.3750; val_edge_recon_loss: 1228086.7500; val_gene_expr_recon_loss: 39622636.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41197184.0000; val_optim_loss: 41197184.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.8865; val_auprc_score: 0.9760; val_best_acc_score: 0.8513; val_best_f1_score: 0.9197; train_kl_reg_loss: 350327.1161; train_edge_recon_loss: 1205174.6071; train_gene_expr_recon_loss: 39579907.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41135409.1429; train_optim_loss: 41135409.1429; val_kl_reg_loss: 340458.6875; val_edge_recon_loss: 1209360.2500; val_gene_expr_recon_loss: 39584312.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41134132.0000; val_optim_loss: 41134132.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.8845; val_auprc_score: 0.9763; val_best_acc_score: 0.8528; val_best_f1_score: 0.9205; train_kl_reg_loss: 342763.6384; train_edge_recon_loss: 1176296.5000; train_gene_expr_recon_loss: 39530821.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41049881.1429; train_optim_loss: 41049881.1429; val_kl_reg_loss: 333316.1250; val_edge_recon_loss: 1197482.1250; val_gene_expr_recon_loss: 39562692.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41093492.0000; val_optim_loss: 41093492.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.8854; val_auprc_score: 0.9772; val_best_acc_score: 0.8585; val_best_f1_score: 0.9239; train_kl_reg_loss: 335987.2545; train_edge_recon_loss: 1192381.6429; train_gene_expr_recon_loss: 39504536.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41032905.1429; train_optim_loss: 41032905.1429; val_kl_reg_loss: 325648.0625; val_edge_recon_loss: 1150566.0000; val_gene_expr_recon_loss: 39507044.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40983256.0000; val_optim_loss: 40983256.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.8890; val_auprc_score: 0.9751; val_best_acc_score: 0.8581; val_best_f1_score: 0.9237; train_kl_reg_loss: 1469733537.1027; train_edge_recon_loss: 1149079.6071; train_gene_expr_recon_loss: 544706928.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2015589550.8571; train_optim_loss: 2015589550.8571; val_kl_reg_loss: 29299582976.0000; val_edge_recon_loss: 1153600.8750; val_gene_expr_recon_loss: 485607168.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29786343424.0000; val_optim_loss: 29786343424.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.8725; val_auprc_score: 0.9638; val_best_acc_score: 0.8536; val_best_f1_score: 0.9210; train_kl_reg_loss: 6921115303.1786; train_edge_recon_loss: 1135142.0536; train_gene_expr_recon_loss: 988356685.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7910607181.7143; train_optim_loss: 7910607181.7143; val_kl_reg_loss: 2301445.7500; val_edge_recon_loss: 1190563.3750; val_gene_expr_recon_loss: 337172352.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 340664352.0000; val_optim_loss: 340664352.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.8026; val_auprc_score: 0.9384; val_best_acc_score: 0.8528; val_best_f1_score: 0.9205; train_kl_reg_loss: 1076733304.7857; train_edge_recon_loss: 1192292.9286; train_gene_expr_recon_loss: 512040516.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1589966148.5714; train_optim_loss: 1589966148.5714; val_kl_reg_loss: 4843532.0000; val_edge_recon_loss: 1197511.0000; val_gene_expr_recon_loss: 284301504.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 290342560.0000; val_optim_loss: 290342560.0000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.7997; val_auprc_score: 0.9409; val_best_acc_score: 0.8612; val_best_f1_score: 0.9255; train_kl_reg_loss: 2413244179586.2144; train_edge_recon_loss: 1177000.1250; train_gene_expr_recon_loss: 667222998.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2413912611766.8569; train_optim_loss: 2413912611766.8569; val_kl_reg_loss: 11873943552.0000; val_edge_recon_loss: 1128420.6250; val_gene_expr_recon_loss: 198940608.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12074012672.0000; val_optim_loss: 12074012672.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.7990; val_auprc_score: 0.9355; val_best_acc_score: 0.8503; val_best_f1_score: 0.9191; train_kl_reg_loss: 2378970782.8571; train_edge_recon_loss: 1147008.1250; train_gene_expr_recon_loss: 725541595.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3105659300.5714; train_optim_loss: 3105659300.5714; val_kl_reg_loss: 6137068.0000; val_edge_recon_loss: 1217283.6250; val_gene_expr_recon_loss: 157738624.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 165092976.0000; val_optim_loss: 165092976.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.7894; val_auprc_score: 0.9334; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 6118477.5714; train_edge_recon_loss: 1210970.5179; train_gene_expr_recon_loss: 189831062.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 197160507.4286; train_optim_loss: 197160507.4286; val_kl_reg_loss: 5944742.0000; val_edge_recon_loss: 1203454.8750; val_gene_expr_recon_loss: 126730992.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 133879192.0000; val_optim_loss: 133879192.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.8003; val_auprc_score: 0.9379; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 6006134.5714; train_edge_recon_loss: 1196068.5000; train_gene_expr_recon_loss: 120217220.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 127419424.0000; train_optim_loss: 127419424.0000; val_kl_reg_loss: 5834894.0000; val_edge_recon_loss: 1182607.7500; val_gene_expr_recon_loss: 111961232.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 118978736.0000; val_optim_loss: 118978736.0000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.7959; val_auprc_score: 0.9389; val_best_acc_score: 0.8591; val_best_f1_score: 0.9242; train_kl_reg_loss: 5880421.9286; train_edge_recon_loss: 1181234.5536; train_gene_expr_recon_loss: 104312646.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 111374304.0000; train_optim_loss: 111374304.0000; val_kl_reg_loss: 5693848.0000; val_edge_recon_loss: 1145570.5000; val_gene_expr_recon_loss: 96974112.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 103813528.0000; val_optim_loss: 103813528.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 9 sec.
Using best model state, which was in epoch 49.

--- MODEL EVALUATION ---
val AUROC score: 0.8790
val AUPRC score: 0.9762
val best accuracy score: 0.8586
val best F1 score: 0.9239
val target rna MSE score: 18.6909
val source rna MSE score: 16.2316
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 3: 0 hours, 6 minutes and 13 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1491, n_latent: 1481, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1481, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1481, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 27455
Number of validation edges: 3050
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8936; val_auprc_score: 0.9792; val_best_acc_score: 0.8567; val_best_f1_score: 0.9228; train_kl_reg_loss: 162305.4480; train_edge_recon_loss: 1004291.7812; train_gene_expr_recon_loss: 128458840.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 129625438.0000; train_optim_loss: 129625438.0000; val_kl_reg_loss: 64586.5547; val_edge_recon_loss: 1164992.5000; val_gene_expr_recon_loss: 61945504.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 63175084.0000; val_optim_loss: 63175084.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8909; val_auprc_score: 0.9746; val_best_acc_score: 0.8498; val_best_f1_score: 0.9188; train_kl_reg_loss: 93304.2793; train_edge_recon_loss: 1090215.9844; train_gene_expr_recon_loss: 63564184.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 64747704.0000; train_optim_loss: 64747704.0000; val_kl_reg_loss: 116908.5781; val_edge_recon_loss: 1221344.5000; val_gene_expr_recon_loss: 61089600.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62427852.0000; val_optim_loss: 62427852.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8761; val_auprc_score: 0.9711; val_best_acc_score: 0.8551; val_best_f1_score: 0.9219; train_kl_reg_loss: 169271.2969; train_edge_recon_loss: 1120955.2188; train_gene_expr_recon_loss: 58268765.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59558991.0000; train_optim_loss: 59558991.0000; val_kl_reg_loss: 239055.2500; val_edge_recon_loss: 1178729.5000; val_gene_expr_recon_loss: 59685336.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61103120.0000; val_optim_loss: 61103120.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8852; val_auprc_score: 0.9761; val_best_acc_score: 0.8567; val_best_f1_score: 0.9228; train_kl_reg_loss: 269606.1484; train_edge_recon_loss: 1190725.6562; train_gene_expr_recon_loss: 58200372.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59660704.0000; train_optim_loss: 59660704.0000; val_kl_reg_loss: 275950.0625; val_edge_recon_loss: 1165059.6250; val_gene_expr_recon_loss: 54132112.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55573120.0000; val_optim_loss: 55573120.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8888; val_auprc_score: 0.9741; val_best_acc_score: 0.8503; val_best_f1_score: 0.9191; train_kl_reg_loss: 318749.9766; train_edge_recon_loss: 1173017.7812; train_gene_expr_recon_loss: 55155006.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56646773.0000; train_optim_loss: 56646773.0000; val_kl_reg_loss: 358940.4688; val_edge_recon_loss: 1217506.6250; val_gene_expr_recon_loss: 53771168.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55347616.0000; val_optim_loss: 55347616.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8871; val_auprc_score: 0.9766; val_best_acc_score: 0.8635; val_best_f1_score: 0.9268; train_kl_reg_loss: 393059.9453; train_edge_recon_loss: 1199513.0938; train_gene_expr_recon_loss: 53217389.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54809961.0000; train_optim_loss: 54809961.0000; val_kl_reg_loss: 423514.3750; val_edge_recon_loss: 1109826.2500; val_gene_expr_recon_loss: 53951664.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55485004.0000; val_optim_loss: 55485004.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8779; val_auprc_score: 0.9733; val_best_acc_score: 0.8587; val_best_f1_score: 0.9240; train_kl_reg_loss: 453823.7266; train_edge_recon_loss: 1175248.4375; train_gene_expr_recon_loss: 52868161.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54497233.0000; train_optim_loss: 54497233.0000; val_kl_reg_loss: 470078.2500; val_edge_recon_loss: 1149369.6250; val_gene_expr_recon_loss: 52276384.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53895832.0000; val_optim_loss: 53895832.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8961; val_auprc_score: 0.9764; val_best_acc_score: 0.8529; val_best_f1_score: 0.9206; train_kl_reg_loss: 495354.5469; train_edge_recon_loss: 1203304.5000; train_gene_expr_recon_loss: 52354128.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54052787.0000; train_optim_loss: 54052787.0000; val_kl_reg_loss: 500648.8125; val_edge_recon_loss: 1196236.7500; val_gene_expr_recon_loss: 51881680.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53578564.0000; val_optim_loss: 53578564.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8756; val_auprc_score: 0.9702; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 521823.2734; train_edge_recon_loss: 1196140.4375; train_gene_expr_recon_loss: 51530763.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53248727.0000; train_optim_loss: 53248727.0000; val_kl_reg_loss: 521115.5625; val_edge_recon_loss: 1205921.8750; val_gene_expr_recon_loss: 51379368.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53106404.0000; val_optim_loss: 53106404.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8887; val_auprc_score: 0.9740; val_best_acc_score: 0.8503; val_best_f1_score: 0.9191; train_kl_reg_loss: 539999.1875; train_edge_recon_loss: 1199017.1562; train_gene_expr_recon_loss: 51110576.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52849592.0000; train_optim_loss: 52849592.0000; val_kl_reg_loss: 532857.6250; val_edge_recon_loss: 1217507.8750; val_gene_expr_recon_loss: 50752828.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52503192.0000; val_optim_loss: 52503192.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8824; val_auprc_score: 0.9703; val_best_acc_score: 0.8468; val_best_f1_score: 0.9170; train_kl_reg_loss: 549429.2812; train_edge_recon_loss: 1208688.5312; train_gene_expr_recon_loss: 50603962.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52362079.0000; train_optim_loss: 52362079.0000; val_kl_reg_loss: 539327.8750; val_edge_recon_loss: 1246304.8750; val_gene_expr_recon_loss: 50405104.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52190736.0000; val_optim_loss: 52190736.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8724; val_auprc_score: 0.9704; val_best_acc_score: 0.8575; val_best_f1_score: 0.9233; train_kl_reg_loss: 554369.4219; train_edge_recon_loss: 1189669.9688; train_gene_expr_recon_loss: 50078010.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51822050.0000; train_optim_loss: 51822050.0000; val_kl_reg_loss: 542468.3125; val_edge_recon_loss: 1159185.7500; val_gene_expr_recon_loss: 49939684.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51641336.0000; val_optim_loss: 51641336.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8776; val_auprc_score: 0.9720; val_best_acc_score: 0.8565; val_best_f1_score: 0.9227; train_kl_reg_loss: 555224.2812; train_edge_recon_loss: 1207414.0000; train_gene_expr_recon_loss: 49665426.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51428065.0000; train_optim_loss: 51428065.0000; val_kl_reg_loss: 538735.5000; val_edge_recon_loss: 1167018.7500; val_gene_expr_recon_loss: 49422192.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51127948.0000; val_optim_loss: 51127948.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8765; val_auprc_score: 0.9703; val_best_acc_score: 0.8463; val_best_f1_score: 0.9167; train_kl_reg_loss: 551885.8281; train_edge_recon_loss: 1195146.8438; train_gene_expr_recon_loss: 49232084.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50979116.0000; train_optim_loss: 50979116.0000; val_kl_reg_loss: 535611.6875; val_edge_recon_loss: 1250127.0000; val_gene_expr_recon_loss: 49064800.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50850540.0000; val_optim_loss: 50850540.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8791; val_auprc_score: 0.9731; val_best_acc_score: 0.8563; val_best_f1_score: 0.9226; train_kl_reg_loss: 548125.0469; train_edge_recon_loss: 1218676.6562; train_gene_expr_recon_loss: 48836410.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50603211.0000; train_optim_loss: 50603211.0000; val_kl_reg_loss: 533160.8125; val_edge_recon_loss: 1168974.8750; val_gene_expr_recon_loss: 48689168.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50391304.0000; val_optim_loss: 50391304.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8795; val_auprc_score: 0.9694; val_best_acc_score: 0.8414; val_best_f1_score: 0.9139; train_kl_reg_loss: 543949.9531; train_edge_recon_loss: 1197561.2812; train_gene_expr_recon_loss: 48429712.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50171223.0000; train_optim_loss: 50171223.0000; val_kl_reg_loss: 527716.1875; val_edge_recon_loss: 1289997.2500; val_gene_expr_recon_loss: 48231208.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50048920.0000; val_optim_loss: 50048920.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8741; val_auprc_score: 0.9718; val_best_acc_score: 0.8611; val_best_f1_score: 0.9254; train_kl_reg_loss: 539264.5000; train_edge_recon_loss: 1186062.3438; train_gene_expr_recon_loss: 47989483.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49714809.0000; train_optim_loss: 49714809.0000; val_kl_reg_loss: 522073.0000; val_edge_recon_loss: 1129654.2500; val_gene_expr_recon_loss: 47753984.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49405712.0000; val_optim_loss: 49405712.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8852; val_auprc_score: 0.9715; val_best_acc_score: 0.8470; val_best_f1_score: 0.9172; train_kl_reg_loss: 533064.8906; train_edge_recon_loss: 1201705.0625; train_gene_expr_recon_loss: 47497205.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49231976.0000; train_optim_loss: 49231976.0000; val_kl_reg_loss: 517317.9375; val_edge_recon_loss: 1244392.6250; val_gene_expr_recon_loss: 47304556.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49066268.0000; val_optim_loss: 49066268.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8764; val_auprc_score: 0.9711; val_best_acc_score: 0.8524; val_best_f1_score: 0.9203; train_kl_reg_loss: 526966.9531; train_edge_recon_loss: 1195461.6250; train_gene_expr_recon_loss: 47049807.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48772235.0000; train_optim_loss: 48772235.0000; val_kl_reg_loss: 508812.1250; val_edge_recon_loss: 1200114.2500; val_gene_expr_recon_loss: 46818176.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48527104.0000; val_optim_loss: 48527104.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8794; val_auprc_score: 0.9726; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 519978.3906; train_edge_recon_loss: 1198537.0312; train_gene_expr_recon_loss: 46568843.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48287358.0000; train_optim_loss: 48287358.0000; val_kl_reg_loss: 504195.1562; val_edge_recon_loss: 1203987.2500; val_gene_expr_recon_loss: 46375656.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48083840.0000; val_optim_loss: 48083840.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8677; val_auprc_score: 0.9695; val_best_acc_score: 0.8565; val_best_f1_score: 0.9227; train_kl_reg_loss: 514167.8516; train_edge_recon_loss: 1180368.9688; train_gene_expr_recon_loss: 46103586.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47798123.0000; train_optim_loss: 47798123.0000; val_kl_reg_loss: 497979.0312; val_edge_recon_loss: 1167019.0000; val_gene_expr_recon_loss: 45882196.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47547192.0000; val_optim_loss: 47547192.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8757; val_auprc_score: 0.9734; val_best_acc_score: 0.8626; val_best_f1_score: 0.9262; train_kl_reg_loss: 507881.5938; train_edge_recon_loss: 1188040.3750; train_gene_expr_recon_loss: 45612805.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47308726.0000; train_optim_loss: 47308726.0000; val_kl_reg_loss: 492195.7500; val_edge_recon_loss: 1117771.0000; val_gene_expr_recon_loss: 45403084.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47013052.0000; val_optim_loss: 47013052.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8764; val_auprc_score: 0.9696; val_best_acc_score: 0.8503; val_best_f1_score: 0.9191; train_kl_reg_loss: 501983.3984; train_edge_recon_loss: 1187781.8750; train_gene_expr_recon_loss: 45142700.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46832465.0000; train_optim_loss: 46832465.0000; val_kl_reg_loss: 485793.6875; val_edge_recon_loss: 1217507.8750; val_gene_expr_recon_loss: 44924512.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46627812.0000; val_optim_loss: 46627812.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8778; val_auprc_score: 0.9715; val_best_acc_score: 0.8522; val_best_f1_score: 0.9202; train_kl_reg_loss: 495439.9531; train_edge_recon_loss: 1208734.8750; train_gene_expr_recon_loss: 44665537.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46369712.0000; train_optim_loss: 46369712.0000; val_kl_reg_loss: 478878.6250; val_edge_recon_loss: 1202050.1250; val_gene_expr_recon_loss: 44440872.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46121800.0000; val_optim_loss: 46121800.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8785; val_auprc_score: 0.9727; val_best_acc_score: 0.8563; val_best_f1_score: 0.9226; train_kl_reg_loss: 489358.7031; train_edge_recon_loss: 1185918.7188; train_gene_expr_recon_loss: 44183801.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45859079.0000; train_optim_loss: 45859079.0000; val_kl_reg_loss: 473673.0625; val_edge_recon_loss: 1168973.6250; val_gene_expr_recon_loss: 43964632.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45607280.0000; val_optim_loss: 45607280.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8609; val_auprc_score: 0.9654; val_best_acc_score: 0.8458; val_best_f1_score: 0.9165; train_kl_reg_loss: 483672.9922; train_edge_recon_loss: 1209968.4375; train_gene_expr_recon_loss: 43722502.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45416144.0000; train_optim_loss: 45416144.0000; val_kl_reg_loss: 467885.9688; val_edge_recon_loss: 1253943.0000; val_gene_expr_recon_loss: 43507372.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45229200.0000; val_optim_loss: 45229200.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8762; val_auprc_score: 0.9733; val_best_acc_score: 0.8599; val_best_f1_score: 0.9247; train_kl_reg_loss: 477641.4297; train_edge_recon_loss: 1207665.2812; train_gene_expr_recon_loss: 43259026.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44944333.0000; train_optim_loss: 44944333.0000; val_kl_reg_loss: 462800.5625; val_edge_recon_loss: 1139524.6250; val_gene_expr_recon_loss: 43062340.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44664664.0000; val_optim_loss: 44664664.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8678; val_auprc_score: 0.9675; val_best_acc_score: 0.8493; val_best_f1_score: 0.9185; train_kl_reg_loss: 472222.6250; train_edge_recon_loss: 1211015.7500; train_gene_expr_recon_loss: 42817723.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44500961.0000; train_optim_loss: 44500961.0000; val_kl_reg_loss: 456944.8750; val_edge_recon_loss: 1225209.3750; val_gene_expr_recon_loss: 42627008.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44309164.0000; val_optim_loss: 44309164.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8710; val_auprc_score: 0.9704; val_best_acc_score: 0.8558; val_best_f1_score: 0.9223; train_kl_reg_loss: 466976.3828; train_edge_recon_loss: 1200236.3750; train_gene_expr_recon_loss: 42393615.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44060829.0000; train_optim_loss: 44060829.0000; val_kl_reg_loss: 451825.5000; val_edge_recon_loss: 1172880.6250; val_gene_expr_recon_loss: 42212080.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43836788.0000; val_optim_loss: 43836788.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8681; val_auprc_score: 0.9686; val_best_acc_score: 0.8512; val_best_f1_score: 0.9196; train_kl_reg_loss: 461157.5156; train_edge_recon_loss: 1184834.5312; train_gene_expr_recon_loss: 41987072.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43633064.0000; train_optim_loss: 43633064.0000; val_kl_reg_loss: 446700.3125; val_edge_recon_loss: 1209786.7500; val_gene_expr_recon_loss: 41822764.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43479252.0000; val_optim_loss: 43479252.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8806; val_auprc_score: 0.9708; val_best_acc_score: 0.8463; val_best_f1_score: 0.9167; train_kl_reg_loss: 455716.7969; train_edge_recon_loss: 1196735.6562; train_gene_expr_recon_loss: 41605800.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43258252.0000; train_optim_loss: 43258252.0000; val_kl_reg_loss: 440668.9688; val_edge_recon_loss: 1250123.5000; val_gene_expr_recon_loss: 41450816.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43141608.0000; val_optim_loss: 43141608.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8745; val_auprc_score: 0.9708; val_best_acc_score: 0.8477; val_best_f1_score: 0.9176; train_kl_reg_loss: 450669.7422; train_edge_recon_loss: 1189359.3750; train_gene_expr_recon_loss: 41255489.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42895519.0000; train_optim_loss: 42895519.0000; val_kl_reg_loss: 435739.7812; val_edge_recon_loss: 1238646.7500; val_gene_expr_recon_loss: 41108200.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42782588.0000; val_optim_loss: 42782588.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8744; val_auprc_score: 0.9718; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 445038.3281; train_edge_recon_loss: 1182640.7812; train_gene_expr_recon_loss: 40919246.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42546925.0000; train_optim_loss: 42546925.0000; val_kl_reg_loss: 430751.8750; val_edge_recon_loss: 1205919.1250; val_gene_expr_recon_loss: 40796288.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42432960.0000; val_optim_loss: 42432960.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8691; val_auprc_score: 0.9703; val_best_acc_score: 0.8539; val_best_f1_score: 0.9212; train_kl_reg_loss: 439732.0703; train_edge_recon_loss: 1192048.4062; train_gene_expr_recon_loss: 40606668.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42238449.0000; train_optim_loss: 42238449.0000; val_kl_reg_loss: 425533.2500; val_edge_recon_loss: 1188467.2500; val_gene_expr_recon_loss: 40499704.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42113704.0000; val_optim_loss: 42113704.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8680; val_auprc_score: 0.9701; val_best_acc_score: 0.8560; val_best_f1_score: 0.9224; train_kl_reg_loss: 434641.7422; train_edge_recon_loss: 1177241.0000; train_gene_expr_recon_loss: 40325754.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41937637.0000; train_optim_loss: 41937637.0000; val_kl_reg_loss: 420982.3750; val_edge_recon_loss: 1170925.0000; val_gene_expr_recon_loss: 40235096.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41827004.0000; val_optim_loss: 41827004.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8729; val_auprc_score: 0.9716; val_best_acc_score: 0.8512; val_best_f1_score: 0.9196; train_kl_reg_loss: 429802.5156; train_edge_recon_loss: 1221399.5625; train_gene_expr_recon_loss: 40071216.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41722418.0000; train_optim_loss: 41722418.0000; val_kl_reg_loss: 415881.8125; val_edge_recon_loss: 1209784.7500; val_gene_expr_recon_loss: 39994264.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41619932.0000; val_optim_loss: 41619932.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8765; val_auprc_score: 0.9745; val_best_acc_score: 0.8623; val_best_f1_score: 0.9261; train_kl_reg_loss: 424802.3906; train_edge_recon_loss: 1182016.4688; train_gene_expr_recon_loss: 39831937.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41438756.0000; train_optim_loss: 41438756.0000; val_kl_reg_loss: 411811.3438; val_edge_recon_loss: 1119749.8750; val_gene_expr_recon_loss: 39776636.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41308196.0000; val_optim_loss: 41308196.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8731; val_auprc_score: 0.9737; val_best_acc_score: 0.8599; val_best_f1_score: 0.9247; train_kl_reg_loss: 420071.1875; train_edge_recon_loss: 1168069.0625; train_gene_expr_recon_loss: 39624512.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41212652.0000; train_optim_loss: 41212652.0000; val_kl_reg_loss: 407032.7188; val_edge_recon_loss: 1139521.8750; val_gene_expr_recon_loss: 39573944.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41120500.0000; val_optim_loss: 41120500.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8738; val_auprc_score: 0.9716; val_best_acc_score: 0.8515; val_best_f1_score: 0.9198; train_kl_reg_loss: 415460.7578; train_edge_recon_loss: 1172907.7188; train_gene_expr_recon_loss: 39428207.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41016574.0000; train_optim_loss: 41016574.0000; val_kl_reg_loss: 401943.4688; val_edge_recon_loss: 1207849.8750; val_gene_expr_recon_loss: 39391144.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41000936.0000; val_optim_loss: 41000936.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8682; val_auprc_score: 0.9716; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 410578.3750; train_edge_recon_loss: 1196413.0625; train_gene_expr_recon_loss: 39259099.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40866090.0000; train_optim_loss: 40866090.0000; val_kl_reg_loss: 397964.6250; val_edge_recon_loss: 1182627.7500; val_gene_expr_recon_loss: 39237576.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40818168.0000; val_optim_loss: 40818168.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8652; val_auprc_score: 0.9705; val_best_acc_score: 0.8510; val_best_f1_score: 0.9195; train_kl_reg_loss: 405986.6484; train_edge_recon_loss: 1200272.9375; train_gene_expr_recon_loss: 39108286.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40714546.0000; train_optim_loss: 40714546.0000; val_kl_reg_loss: 393179.0938; val_edge_recon_loss: 1211714.8750; val_gene_expr_recon_loss: 39090660.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40695552.0000; val_optim_loss: 40695552.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8656; val_auprc_score: 0.9700; val_best_acc_score: 0.8539; val_best_f1_score: 0.9212; train_kl_reg_loss: 401071.6250; train_edge_recon_loss: 1189720.9062; train_gene_expr_recon_loss: 38960870.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40551663.0000; train_optim_loss: 40551663.0000; val_kl_reg_loss: 388367.5938; val_edge_recon_loss: 1188463.2500; val_gene_expr_recon_loss: 38923464.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40500296.0000; val_optim_loss: 40500296.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8604; val_auprc_score: 0.9712; val_best_acc_score: 0.8575; val_best_f1_score: 0.9233; train_kl_reg_loss: 396180.2188; train_edge_recon_loss: 1186034.0000; train_gene_expr_recon_loss: 38453998.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40036213.0000; train_optim_loss: 40036213.0000; val_kl_reg_loss: 381859.3125; val_edge_recon_loss: 1159180.1250; val_gene_expr_recon_loss: 38272648.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39813688.0000; val_optim_loss: 39813688.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8617; val_auprc_score: 0.9698; val_best_acc_score: 0.8553; val_best_f1_score: 0.9220; train_kl_reg_loss: 390397.6406; train_edge_recon_loss: 1189442.3125; train_gene_expr_recon_loss: 38397465.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39977305.0000; train_optim_loss: 39977305.0000; val_kl_reg_loss: 379289.9375; val_edge_recon_loss: 1176778.0000; val_gene_expr_recon_loss: 38743616.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40299684.0000; val_optim_loss: 40299684.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8528; val_auprc_score: 0.9647; val_best_acc_score: 0.8458; val_best_f1_score: 0.9165; train_kl_reg_loss: 388907.4062; train_edge_recon_loss: 1179447.5938; train_gene_expr_recon_loss: 38632821.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40201176.0000; train_optim_loss: 40201176.0000; val_kl_reg_loss: 378575.0000; val_edge_recon_loss: 1253931.3750; val_gene_expr_recon_loss: 38646320.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40278828.0000; val_optim_loss: 40278828.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.8597; val_auprc_score: 0.9682; val_best_acc_score: 0.8465; val_best_f1_score: 0.9169; train_kl_reg_loss: 388692.7812; train_edge_recon_loss: 1179825.8125; train_gene_expr_recon_loss: 38526905.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40095423.0000; train_optim_loss: 40095423.0000; val_kl_reg_loss: 378379.1250; val_edge_recon_loss: 1248206.6250; val_gene_expr_recon_loss: 38555348.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40181932.0000; val_optim_loss: 40181932.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.8510; val_auprc_score: 0.9686; val_best_acc_score: 0.8565; val_best_f1_score: 0.9227; train_kl_reg_loss: 386623.6250; train_edge_recon_loss: 1203642.8438; train_gene_expr_recon_loss: 38447929.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40038194.0000; train_optim_loss: 40038194.0000; val_kl_reg_loss: 374568.3125; val_edge_recon_loss: 1167010.2500; val_gene_expr_recon_loss: 38466732.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40008312.0000; val_optim_loss: 40008312.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.8453; val_auprc_score: 0.9654; val_best_acc_score: 0.8503; val_best_f1_score: 0.9191; train_kl_reg_loss: 384053.1719; train_edge_recon_loss: 1213145.4062; train_gene_expr_recon_loss: 38395595.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39992794.0000; train_optim_loss: 39992794.0000; val_kl_reg_loss: 374086.9375; val_edge_recon_loss: 1217498.3750; val_gene_expr_recon_loss: 38459504.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40051088.0000; val_optim_loss: 40051088.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.8564; val_auprc_score: 0.9695; val_best_acc_score: 0.8529; val_best_f1_score: 0.9206; train_kl_reg_loss: 383887.4062; train_edge_recon_loss: 1191761.6875; train_gene_expr_recon_loss: 38386104.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39961753.0000; train_optim_loss: 39961753.0000; val_kl_reg_loss: 373572.5625; val_edge_recon_loss: 1196228.2500; val_gene_expr_recon_loss: 38446616.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40016416.0000; val_optim_loss: 40016416.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.8457; val_auprc_score: 0.9656; val_best_acc_score: 0.8539; val_best_f1_score: 0.9212; train_kl_reg_loss: 383574.6328; train_edge_recon_loss: 1222832.5625; train_gene_expr_recon_loss: 38377004.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39983412.0000; train_optim_loss: 39983412.0000; val_kl_reg_loss: 373957.6875; val_edge_recon_loss: 1188459.2500; val_gene_expr_recon_loss: 38454556.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40016972.0000; val_optim_loss: 40016972.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.8472; val_auprc_score: 0.9647; val_best_acc_score: 0.8484; val_best_f1_score: 0.9180; train_kl_reg_loss: 383002.1953; train_edge_recon_loss: 1204705.7500; train_gene_expr_recon_loss: 38360390.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39948097.0000; train_optim_loss: 39948097.0000; val_kl_reg_loss: 373730.1875; val_edge_recon_loss: 1232883.7500; val_gene_expr_recon_loss: 38450032.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40056648.0000; val_optim_loss: 40056648.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 12 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.8593
val AUPRC score: 0.9691
val best accuracy score: 0.8546
val best F1 score: 0.9216
val target rna MSE score: 5514.5915
val source rna MSE score: 37.1984
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 2: 0 hours, 3 minutes and 15 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1491, n_latent: 1481, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1481, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1481, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 27455
Number of validation edges: 3050
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8967; val_auprc_score: 0.9765; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 331452.5383; train_edge_recon_loss: 1024717.2969; train_gene_expr_recon_loss: 215146728.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 216502898.0000; train_optim_loss: 216502898.0000; val_kl_reg_loss: 116044.8203; val_edge_recon_loss: 1203887.0000; val_gene_expr_recon_loss: 65304600.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66624532.0000; val_optim_loss: 66624532.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8968; val_auprc_score: 0.9783; val_best_acc_score: 0.8596; val_best_f1_score: 0.9245; train_kl_reg_loss: 123866.0156; train_edge_recon_loss: 1078939.1250; train_gene_expr_recon_loss: 74826590.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 76029394.0000; train_optim_loss: 76029394.0000; val_kl_reg_loss: 139696.5781; val_edge_recon_loss: 1141480.3750; val_gene_expr_recon_loss: 68004536.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 69285712.0000; val_optim_loss: 69285712.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8979; val_auprc_score: 0.9770; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 220664.4141; train_edge_recon_loss: 1135968.3125; train_gene_expr_recon_loss: 66783213.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 68139845.0000; train_optim_loss: 68139845.0000; val_kl_reg_loss: 264887.9688; val_edge_recon_loss: 1203982.8750; val_gene_expr_recon_loss: 71207680.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 72676552.0000; val_optim_loss: 72676552.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9000; val_auprc_score: 0.9787; val_best_acc_score: 0.8563; val_best_f1_score: 0.9226; train_kl_reg_loss: 333582.8984; train_edge_recon_loss: 1185149.2500; train_gene_expr_recon_loss: 63945153.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 65463884.0000; train_optim_loss: 65463884.0000; val_kl_reg_loss: 395986.7812; val_edge_recon_loss: 1168973.1250; val_gene_expr_recon_loss: 60136576.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61701536.0000; val_optim_loss: 61701536.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8919; val_auprc_score: 0.9752; val_best_acc_score: 0.8529; val_best_f1_score: 0.9206; train_kl_reg_loss: 443289.4922; train_edge_recon_loss: 1182320.5312; train_gene_expr_recon_loss: 61025509.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 62651119.0000; train_optim_loss: 62651119.0000; val_kl_reg_loss: 485936.8125; val_edge_recon_loss: 1196236.2500; val_gene_expr_recon_loss: 57496548.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59178720.0000; val_optim_loss: 59178720.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8952; val_auprc_score: 0.9749; val_best_acc_score: 0.8498; val_best_f1_score: 0.9188; train_kl_reg_loss: 523888.6719; train_edge_recon_loss: 1220558.2812; train_gene_expr_recon_loss: 57249763.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58994210.0000; train_optim_loss: 58994210.0000; val_kl_reg_loss: 551144.1250; val_edge_recon_loss: 1221361.8750; val_gene_expr_recon_loss: 58096968.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59869472.0000; val_optim_loss: 59869472.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8887; val_auprc_score: 0.9762; val_best_acc_score: 0.8613; val_best_f1_score: 0.9255; train_kl_reg_loss: 584217.5312; train_edge_recon_loss: 1188466.8125; train_gene_expr_recon_loss: 56493055.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58265739.0000; train_optim_loss: 58265739.0000; val_kl_reg_loss: 603282.0000; val_edge_recon_loss: 1127676.5000; val_gene_expr_recon_loss: 54451480.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56182440.0000; val_optim_loss: 56182440.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8866; val_auprc_score: 0.9725; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 633851.5156; train_edge_recon_loss: 1199996.0938; train_gene_expr_recon_loss: 55032452.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56866300.0000; train_optim_loss: 56866300.0000; val_kl_reg_loss: 644541.0000; val_edge_recon_loss: 1203987.6250; val_gene_expr_recon_loss: 54786248.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56634776.0000; val_optim_loss: 56634776.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8931; val_auprc_score: 0.9717; val_best_acc_score: 0.8402; val_best_f1_score: 0.9132; train_kl_reg_loss: 673070.7344; train_edge_recon_loss: 1199554.9062; train_gene_expr_recon_loss: 53938921.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55811547.0000; train_optim_loss: 55811547.0000; val_kl_reg_loss: 679115.3750; val_edge_recon_loss: 1299423.2500; val_gene_expr_recon_loss: 53959448.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55937988.0000; val_optim_loss: 55937988.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8837; val_auprc_score: 0.9709; val_best_acc_score: 0.8486; val_best_f1_score: 0.9181; train_kl_reg_loss: 702868.7188; train_edge_recon_loss: 1192751.9375; train_gene_expr_recon_loss: 53577786.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55473407.0000; train_optim_loss: 55473407.0000; val_kl_reg_loss: 698306.3125; val_edge_recon_loss: 1230977.2500; val_gene_expr_recon_loss: 53047332.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54976616.0000; val_optim_loss: 54976616.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8991; val_auprc_score: 0.9758; val_best_acc_score: 0.8503; val_best_f1_score: 0.9191; train_kl_reg_loss: 722821.2188; train_edge_recon_loss: 1180727.2500; train_gene_expr_recon_loss: 52852640.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54756189.0000; train_optim_loss: 54756189.0000; val_kl_reg_loss: 715416.3125; val_edge_recon_loss: 1217508.6250; val_gene_expr_recon_loss: 52828344.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54761268.0000; val_optim_loss: 54761268.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8916; val_auprc_score: 0.9727; val_best_acc_score: 0.8475; val_best_f1_score: 0.9174; train_kl_reg_loss: 734867.2812; train_edge_recon_loss: 1196182.0312; train_gene_expr_recon_loss: 52499972.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54431021.0000; train_optim_loss: 54431021.0000; val_kl_reg_loss: 721837.4375; val_edge_recon_loss: 1240565.7500; val_gene_expr_recon_loss: 52181784.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54144188.0000; val_optim_loss: 54144188.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8763; val_auprc_score: 0.9681; val_best_acc_score: 0.8503; val_best_f1_score: 0.9191; train_kl_reg_loss: 741068.7656; train_edge_recon_loss: 1195399.0000; train_gene_expr_recon_loss: 52062677.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53999144.0000; train_optim_loss: 53999144.0000; val_kl_reg_loss: 725418.7500; val_edge_recon_loss: 1217509.0000; val_gene_expr_recon_loss: 52061176.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54004104.0000; val_optim_loss: 54004104.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8997; val_auprc_score: 0.9761; val_best_acc_score: 0.8515; val_best_f1_score: 0.9198; train_kl_reg_loss: 743269.1250; train_edge_recon_loss: 1205069.8125; train_gene_expr_recon_loss: 51771628.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53719967.0000; train_optim_loss: 53719967.0000; val_kl_reg_loss: 723771.1250; val_edge_recon_loss: 1207856.3750; val_gene_expr_recon_loss: 51814600.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53746228.0000; val_optim_loss: 53746228.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9014; val_auprc_score: 0.9785; val_best_acc_score: 0.8587; val_best_f1_score: 0.9240; train_kl_reg_loss: 741600.3281; train_edge_recon_loss: 1210902.2812; train_gene_expr_recon_loss: 51615236.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53567738.0000; train_optim_loss: 53567738.0000; val_kl_reg_loss: 721640.2500; val_edge_recon_loss: 1149370.5000; val_gene_expr_recon_loss: 51498140.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53369152.0000; val_optim_loss: 53369152.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8906; val_auprc_score: 0.9749; val_best_acc_score: 0.8618; val_best_f1_score: 0.9258; train_kl_reg_loss: 736738.0000; train_edge_recon_loss: 1192581.7188; train_gene_expr_recon_loss: 51375374.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53304693.0000; train_optim_loss: 53304693.0000; val_kl_reg_loss: 715159.6250; val_edge_recon_loss: 1123718.5000; val_gene_expr_recon_loss: 51359292.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53198172.0000; val_optim_loss: 53198172.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8921; val_auprc_score: 0.9755; val_best_acc_score: 0.8594; val_best_f1_score: 0.9244; train_kl_reg_loss: 729344.7500; train_edge_recon_loss: 1183497.3125; train_gene_expr_recon_loss: 51183505.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53096347.0000; train_optim_loss: 53096347.0000; val_kl_reg_loss: 706483.7500; val_edge_recon_loss: 1143467.1250; val_gene_expr_recon_loss: 51199272.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53049224.0000; val_optim_loss: 53049224.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8927; val_auprc_score: 0.9752; val_best_acc_score: 0.8606; val_best_f1_score: 0.9251; train_kl_reg_loss: 720952.8750; train_edge_recon_loss: 1202232.7188; train_gene_expr_recon_loss: 51040227.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52963413.0000; train_optim_loss: 52963413.0000; val_kl_reg_loss: 698426.2500; val_edge_recon_loss: 1133606.7500; val_gene_expr_recon_loss: 51017548.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52849580.0000; val_optim_loss: 52849580.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8943; val_auprc_score: 0.9738; val_best_acc_score: 0.8472; val_best_f1_score: 0.9173; train_kl_reg_loss: 711179.4219; train_edge_recon_loss: 1212022.8750; train_gene_expr_recon_loss: 50867891.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52791094.0000; train_optim_loss: 52791094.0000; val_kl_reg_loss: 689519.6250; val_edge_recon_loss: 1242479.8750; val_gene_expr_recon_loss: 50893620.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52825620.0000; val_optim_loss: 52825620.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8758; val_auprc_score: 0.9699; val_best_acc_score: 0.8558; val_best_f1_score: 0.9223; train_kl_reg_loss: 703309.6562; train_edge_recon_loss: 1189945.8125; train_gene_expr_recon_loss: 50733762.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52627016.0000; train_optim_loss: 52627016.0000; val_kl_reg_loss: 681409.5625; val_edge_recon_loss: 1172883.2500; val_gene_expr_recon_loss: 50745800.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52600092.0000; val_optim_loss: 52600092.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8812; val_auprc_score: 0.9720; val_best_acc_score: 0.8589; val_best_f1_score: 0.9241; train_kl_reg_loss: 695234.5938; train_edge_recon_loss: 1179537.9688; train_gene_expr_recon_loss: 50592042.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52466814.0000; train_optim_loss: 52466814.0000; val_kl_reg_loss: 672952.3750; val_edge_recon_loss: 1147403.6250; val_gene_expr_recon_loss: 50623716.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52444072.0000; val_optim_loss: 52444072.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9016; val_auprc_score: 0.9782; val_best_acc_score: 0.8599; val_best_f1_score: 0.9247; train_kl_reg_loss: 685575.7344; train_edge_recon_loss: 1187540.7500; train_gene_expr_recon_loss: 50475310.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52348426.0000; train_optim_loss: 52348426.0000; val_kl_reg_loss: 663564.1250; val_edge_recon_loss: 1139525.8750; val_gene_expr_recon_loss: 50493548.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52296640.0000; val_optim_loss: 52296640.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8887; val_auprc_score: 0.9742; val_best_acc_score: 0.8529; val_best_f1_score: 0.9206; train_kl_reg_loss: 676024.4219; train_edge_recon_loss: 1184613.7500; train_gene_expr_recon_loss: 50345881.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52206519.0000; train_optim_loss: 52206519.0000; val_kl_reg_loss: 654559.0000; val_edge_recon_loss: 1196237.1250; val_gene_expr_recon_loss: 50370128.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52220924.0000; val_optim_loss: 52220924.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8960; val_auprc_score: 0.9741; val_best_acc_score: 0.8449; val_best_f1_score: 0.9159; train_kl_reg_loss: 666239.2969; train_edge_recon_loss: 1185161.7188; train_gene_expr_recon_loss: 50211826.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52063226.0000; train_optim_loss: 52063226.0000; val_kl_reg_loss: 645147.6250; val_edge_recon_loss: 1261565.6250; val_gene_expr_recon_loss: 50248256.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52154968.0000; val_optim_loss: 52154968.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8832; val_auprc_score: 0.9730; val_best_acc_score: 0.8543; val_best_f1_score: 0.9215; train_kl_reg_loss: 656388.6094; train_edge_recon_loss: 1178829.3438; train_gene_expr_recon_loss: 50075202.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51910420.0000; train_optim_loss: 51910420.0000; val_kl_reg_loss: 634208.3750; val_edge_recon_loss: 1184579.5000; val_gene_expr_recon_loss: 50104496.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51923284.0000; val_optim_loss: 51923284.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9080; val_auprc_score: 0.9781; val_best_acc_score: 0.8465; val_best_f1_score: 0.9169; train_kl_reg_loss: 646211.0312; train_edge_recon_loss: 1199322.3750; train_gene_expr_recon_loss: 49947301.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51792834.0000; train_optim_loss: 51792834.0000; val_kl_reg_loss: 625666.7500; val_edge_recon_loss: 1248216.3750; val_gene_expr_recon_loss: 49978564.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51852448.0000; val_optim_loss: 51852448.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8909; val_auprc_score: 0.9728; val_best_acc_score: 0.8477; val_best_f1_score: 0.9176; train_kl_reg_loss: 636226.7344; train_edge_recon_loss: 1175169.0938; train_gene_expr_recon_loss: 49814820.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51626217.0000; train_optim_loss: 51626217.0000; val_kl_reg_loss: 615835.3750; val_edge_recon_loss: 1238648.8750; val_gene_expr_recon_loss: 49844424.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51698908.0000; val_optim_loss: 51698908.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8946; val_auprc_score: 0.9758; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 626377.2500; train_edge_recon_loss: 1188727.5625; train_gene_expr_recon_loss: 49676950.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51492055.0000; train_optim_loss: 51492055.0000; val_kl_reg_loss: 604871.8750; val_edge_recon_loss: 1203986.6250; val_gene_expr_recon_loss: 49691728.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51500588.0000; val_optim_loss: 51500588.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8968; val_auprc_score: 0.9770; val_best_acc_score: 0.8553; val_best_f1_score: 0.9220; train_kl_reg_loss: 616234.9219; train_edge_recon_loss: 1194796.7500; train_gene_expr_recon_loss: 49530972.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51342004.0000; train_optim_loss: 51342004.0000; val_kl_reg_loss: 596482.2500; val_edge_recon_loss: 1176785.2500; val_gene_expr_recon_loss: 49551024.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51324292.0000; val_optim_loss: 51324292.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8863; val_auprc_score: 0.9729; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 606960.0469; train_edge_recon_loss: 1196913.1875; train_gene_expr_recon_loss: 49385622.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51189495.0000; train_optim_loss: 51189495.0000; val_kl_reg_loss: 586704.6250; val_edge_recon_loss: 1205921.6250; val_gene_expr_recon_loss: 49402128.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51194756.0000; val_optim_loss: 51194756.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8771; val_auprc_score: 0.9721; val_best_acc_score: 0.8560; val_best_f1_score: 0.9224; train_kl_reg_loss: 597791.5781; train_edge_recon_loss: 1206530.6562; train_gene_expr_recon_loss: 49223399.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51027721.0000; train_optim_loss: 51027721.0000; val_kl_reg_loss: 579954.3750; val_edge_recon_loss: 1170928.8750; val_gene_expr_recon_loss: 49249320.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51000204.0000; val_optim_loss: 51000204.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8917; val_auprc_score: 0.9754; val_best_acc_score: 0.8555; val_best_f1_score: 0.9221; train_kl_reg_loss: 588556.7188; train_edge_recon_loss: 1186617.7500; train_gene_expr_recon_loss: 49058481.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50833654.0000; train_optim_loss: 50833654.0000; val_kl_reg_loss: 568856.0000; val_edge_recon_loss: 1174833.7500; val_gene_expr_recon_loss: 49055872.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50799560.0000; val_optim_loss: 50799560.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8842; val_auprc_score: 0.9739; val_best_acc_score: 0.8522; val_best_f1_score: 0.9202; train_kl_reg_loss: 579702.6562; train_edge_recon_loss: 1194708.5938; train_gene_expr_recon_loss: 48869918.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50644330.0000; train_optim_loss: 50644330.0000; val_kl_reg_loss: 560293.1250; val_edge_recon_loss: 1202050.5000; val_gene_expr_recon_loss: 48866752.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50629096.0000; val_optim_loss: 50629096.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8900; val_auprc_score: 0.9749; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 571004.3438; train_edge_recon_loss: 1186229.7812; train_gene_expr_recon_loss: 48680347.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50437581.0000; train_optim_loss: 50437581.0000; val_kl_reg_loss: 552044.5000; val_edge_recon_loss: 1182631.1250; val_gene_expr_recon_loss: 48673136.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50407812.0000; val_optim_loss: 50407812.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8881; val_auprc_score: 0.9750; val_best_acc_score: 0.8577; val_best_f1_score: 0.9234; train_kl_reg_loss: 562291.7500; train_edge_recon_loss: 1192948.7812; train_gene_expr_recon_loss: 48484843.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50240083.0000; train_optim_loss: 50240083.0000; val_kl_reg_loss: 543173.9375; val_edge_recon_loss: 1157224.0000; val_gene_expr_recon_loss: 48439852.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50140248.0000; val_optim_loss: 50140248.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8888; val_auprc_score: 0.9743; val_best_acc_score: 0.8522; val_best_f1_score: 0.9202; train_kl_reg_loss: 553777.8906; train_edge_recon_loss: 1213370.9375; train_gene_expr_recon_loss: 48252979.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50020128.0000; train_optim_loss: 50020128.0000; val_kl_reg_loss: 535396.8750; val_edge_recon_loss: 1202049.6250; val_gene_expr_recon_loss: 48218040.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49955488.0000; val_optim_loss: 49955488.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8870; val_auprc_score: 0.9745; val_best_acc_score: 0.8493; val_best_f1_score: 0.9185; train_kl_reg_loss: 545544.0156; train_edge_recon_loss: 1179965.7812; train_gene_expr_recon_loss: 48007611.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49733121.0000; train_optim_loss: 49733121.0000; val_kl_reg_loss: 528739.8750; val_edge_recon_loss: 1225209.5000; val_gene_expr_recon_loss: 47981432.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49735380.0000; val_optim_loss: 49735380.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8911; val_auprc_score: 0.9767; val_best_acc_score: 0.8613; val_best_f1_score: 0.9255; train_kl_reg_loss: 537766.4688; train_edge_recon_loss: 1194204.3750; train_gene_expr_recon_loss: 47748294.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49480265.0000; train_optim_loss: 49480265.0000; val_kl_reg_loss: 520085.2500; val_edge_recon_loss: 1127674.7500; val_gene_expr_recon_loss: 47698584.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49346344.0000; val_optim_loss: 49346344.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8704; val_auprc_score: 0.9667; val_best_acc_score: 0.8498; val_best_f1_score: 0.9188; train_kl_reg_loss: 529567.1719; train_edge_recon_loss: 1201522.0000; train_gene_expr_recon_loss: 47470506.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49201595.0000; train_optim_loss: 49201595.0000; val_kl_reg_loss: 513349.2500; val_edge_recon_loss: 1221359.7500; val_gene_expr_recon_loss: 47412800.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49147508.0000; val_optim_loss: 49147508.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8820; val_auprc_score: 0.9723; val_best_acc_score: 0.8527; val_best_f1_score: 0.9205; train_kl_reg_loss: 521735.8516; train_edge_recon_loss: 1191319.8438; train_gene_expr_recon_loss: 47166678.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48879734.0000; train_optim_loss: 48879734.0000; val_kl_reg_loss: 504986.0625; val_edge_recon_loss: 1198173.8750; val_gene_expr_recon_loss: 47084536.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48787696.0000; val_optim_loss: 48787696.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8929; val_auprc_score: 0.9739; val_best_acc_score: 0.8411; val_best_f1_score: 0.9137; train_kl_reg_loss: 513829.8359; train_edge_recon_loss: 1202505.7812; train_gene_expr_recon_loss: 46847177.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48563512.0000; train_optim_loss: 48563512.0000; val_kl_reg_loss: 496437.2500; val_edge_recon_loss: 1291881.6250; val_gene_expr_recon_loss: 46730152.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48518472.0000; val_optim_loss: 48518472.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8817; val_auprc_score: 0.9718; val_best_acc_score: 0.8451; val_best_f1_score: 0.9161; train_kl_reg_loss: 506204.4766; train_edge_recon_loss: 1183521.0938; train_gene_expr_recon_loss: 46504288.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48194013.0000; train_optim_loss: 48194013.0000; val_kl_reg_loss: 488876.9688; val_edge_recon_loss: 1259658.7500; val_gene_expr_recon_loss: 46375984.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48124520.0000; val_optim_loss: 48124520.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8871; val_auprc_score: 0.9745; val_best_acc_score: 0.8491; val_best_f1_score: 0.9184; train_kl_reg_loss: 499078.4922; train_edge_recon_loss: 1192806.0625; train_gene_expr_recon_loss: 46139253.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47831138.0000; train_optim_loss: 47831138.0000; val_kl_reg_loss: 482138.8750; val_edge_recon_loss: 1227131.2500; val_gene_expr_recon_loss: 46000792.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47710064.0000; val_optim_loss: 47710064.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8738; val_auprc_score: 0.9686; val_best_acc_score: 0.8453; val_best_f1_score: 0.9162; train_kl_reg_loss: 492108.9531; train_edge_recon_loss: 1204840.7500; train_gene_expr_recon_loss: 45750587.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47447537.0000; train_optim_loss: 47447537.0000; val_kl_reg_loss: 476594.0000; val_edge_recon_loss: 1257753.3750; val_gene_expr_recon_loss: 45625896.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47360244.0000; val_optim_loss: 47360244.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8752; val_auprc_score: 0.9725; val_best_acc_score: 0.8579; val_best_f1_score: 0.9235; train_kl_reg_loss: 485076.5312; train_edge_recon_loss: 1188315.0625; train_gene_expr_recon_loss: 45357800.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47031192.0000; train_optim_loss: 47031192.0000; val_kl_reg_loss: 468595.5312; val_edge_recon_loss: 1155259.6250; val_gene_expr_recon_loss: 45205056.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46828912.0000; val_optim_loss: 46828912.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.8671; val_auprc_score: 0.9677; val_best_acc_score: 0.8444; val_best_f1_score: 0.9156; train_kl_reg_loss: 477808.0625; train_edge_recon_loss: 1207993.4688; train_gene_expr_recon_loss: 44950798.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46636599.0000; train_optim_loss: 46636599.0000; val_kl_reg_loss: 461484.2500; val_edge_recon_loss: 1265366.2500; val_gene_expr_recon_loss: 44783652.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46510504.0000; val_optim_loss: 46510504.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.8724; val_auprc_score: 0.9696; val_best_acc_score: 0.8484; val_best_f1_score: 0.9180; train_kl_reg_loss: 470262.9141; train_edge_recon_loss: 1191442.9062; train_gene_expr_recon_loss: 44519179.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46180885.0000; train_optim_loss: 46180885.0000; val_kl_reg_loss: 455006.6562; val_edge_recon_loss: 1232891.8750; val_gene_expr_recon_loss: 44338488.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46026388.0000; val_optim_loss: 46026388.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.8726; val_auprc_score: 0.9703; val_best_acc_score: 0.8510; val_best_f1_score: 0.9195; train_kl_reg_loss: 463498.8047; train_edge_recon_loss: 1229097.6875; train_gene_expr_recon_loss: 44078031.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45770628.0000; train_optim_loss: 45770628.0000; val_kl_reg_loss: 447306.1250; val_edge_recon_loss: 1211715.1250; val_gene_expr_recon_loss: 43878376.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45537396.0000; val_optim_loss: 45537396.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.8875; val_auprc_score: 0.9762; val_best_acc_score: 0.8555; val_best_f1_score: 0.9221; train_kl_reg_loss: 456724.3906; train_edge_recon_loss: 1185316.4375; train_gene_expr_recon_loss: 43654435.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45296476.0000; train_optim_loss: 45296476.0000; val_kl_reg_loss: 441628.0000; val_edge_recon_loss: 1174829.5000; val_gene_expr_recon_loss: 43504784.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45121240.0000; val_optim_loss: 45121240.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.8843; val_auprc_score: 0.9722; val_best_acc_score: 0.8491; val_best_f1_score: 0.9184; train_kl_reg_loss: 450225.0547; train_edge_recon_loss: 1217364.8125; train_gene_expr_recon_loss: 43262515.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44930105.0000; train_optim_loss: 44930105.0000; val_kl_reg_loss: 435320.9688; val_edge_recon_loss: 1227128.0000; val_gene_expr_recon_loss: 43084184.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44746632.0000; val_optim_loss: 44746632.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.8745; val_auprc_score: 0.9748; val_best_acc_score: 0.8652; val_best_f1_score: 0.9278; train_kl_reg_loss: 442929.5938; train_edge_recon_loss: 1203101.5625; train_gene_expr_recon_loss: 42838072.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44484103.0000; train_optim_loss: 44484103.0000; val_kl_reg_loss: 428388.3125; val_edge_recon_loss: 1095876.3750; val_gene_expr_recon_loss: 42658624.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44182888.0000; val_optim_loss: 44182888.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.8790; val_auprc_score: 0.9722; val_best_acc_score: 0.8531; val_best_f1_score: 0.9208; train_kl_reg_loss: 436734.8203; train_edge_recon_loss: 1183711.2500; train_gene_expr_recon_loss: 42443912.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44064357.0000; train_optim_loss: 44064357.0000; val_kl_reg_loss: 421579.8750; val_edge_recon_loss: 1194290.1250; val_gene_expr_recon_loss: 42297968.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43913840.0000; val_optim_loss: 43913840.0000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.8720; val_auprc_score: 0.9709; val_best_acc_score: 0.8505; val_best_f1_score: 0.9192; train_kl_reg_loss: 429727.5703; train_edge_recon_loss: 1196708.5938; train_gene_expr_recon_loss: 42078374.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43704811.0000; train_optim_loss: 43704811.0000; val_kl_reg_loss: 415583.5625; val_edge_recon_loss: 1215573.2500; val_gene_expr_recon_loss: 41932072.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43563228.0000; val_optim_loss: 43563228.0000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.8762; val_auprc_score: 0.9737; val_best_acc_score: 0.8570; val_best_f1_score: 0.9230; train_kl_reg_loss: 423562.0078; train_edge_recon_loss: 1188156.8750; train_gene_expr_recon_loss: 41726158.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43337876.0000; train_optim_loss: 43337876.0000; val_kl_reg_loss: 409399.9062; val_edge_recon_loss: 1163096.8750; val_gene_expr_recon_loss: 41567088.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43139584.0000; val_optim_loss: 43139584.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.8780; val_auprc_score: 0.9733; val_best_acc_score: 0.8543; val_best_f1_score: 0.9215; train_kl_reg_loss: 417076.7422; train_edge_recon_loss: 1184413.7188; train_gene_expr_recon_loss: 41216777.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42818268.0000; train_optim_loss: 42818268.0000; val_kl_reg_loss: 403880.3750; val_edge_recon_loss: 1184570.8750; val_gene_expr_recon_loss: 41682856.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43271308.0000; val_optim_loss: 43271308.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.8735; val_auprc_score: 0.9702; val_best_acc_score: 0.8496; val_best_f1_score: 0.9187; train_kl_reg_loss: 2991933085.0078; train_edge_recon_loss: 1096290.1719; train_gene_expr_recon_loss: 749474300.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3742503714.0000; train_optim_loss: 3742503714.0000; val_kl_reg_loss: 1100267.1250; val_edge_recon_loss: 1223282.5000; val_gene_expr_recon_loss: 84412576.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 86736128.0000; val_optim_loss: 86736128.0000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.8777; val_auprc_score: 0.9704; val_best_acc_score: 0.8515; val_best_f1_score: 0.9198; train_kl_reg_loss: 3699506519.7031; train_edge_recon_loss: 1153253.1562; train_gene_expr_recon_loss: 418936960.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4119596656.0000; train_optim_loss: 4119596656.0000; val_kl_reg_loss: 737529.1875; val_edge_recon_loss: 1207855.3750; val_gene_expr_recon_loss: 62901700.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 64847084.0000; val_optim_loss: 64847084.0000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.8555; val_auprc_score: 0.9629; val_best_acc_score: 0.8584; val_best_f1_score: 0.9238; train_kl_reg_loss: 2279261.0156; train_edge_recon_loss: 1166636.0000; train_gene_expr_recon_loss: 332790026.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 336235922.0000; train_optim_loss: 336235922.0000; val_kl_reg_loss: 14395498.0000; val_edge_recon_loss: 1151336.7500; val_gene_expr_recon_loss: 92483040.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 108029872.0000; val_optim_loss: 108029872.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.8453; val_auprc_score: 0.9605; val_best_acc_score: 0.8604; val_best_f1_score: 0.9249; train_kl_reg_loss: 6116586.6250; train_edge_recon_loss: 1092277.0938; train_gene_expr_recon_loss: 693963776.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 701172628.0000; train_optim_loss: 701172628.0000; val_kl_reg_loss: 1209007.7500; val_edge_recon_loss: 1135582.2500; val_gene_expr_recon_loss: 75365104.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 77709696.0000; val_optim_loss: 77709696.0000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.8610; val_auprc_score: 0.9635; val_best_acc_score: 0.8531; val_best_f1_score: 0.9208; train_kl_reg_loss: 1243992.6875; train_edge_recon_loss: 1214753.7812; train_gene_expr_recon_loss: 66769568.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 69228313.0000; train_optim_loss: 69228313.0000; val_kl_reg_loss: 1224196.7500; val_edge_recon_loss: 1194298.7500; val_gene_expr_recon_loss: 57487280.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59905776.0000; val_optim_loss: 59905776.0000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.8409; val_auprc_score: 0.9559; val_best_acc_score: 0.8477; val_best_f1_score: 0.9176; train_kl_reg_loss: 1255390.5000; train_edge_recon_loss: 1195544.0625; train_gene_expr_recon_loss: 55815902.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58266838.0000; train_optim_loss: 58266838.0000; val_kl_reg_loss: 1224691.5000; val_edge_recon_loss: 1238651.6250; val_gene_expr_recon_loss: 55758536.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58221880.0000; val_optim_loss: 58221880.0000
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.8598; val_auprc_score: 0.9634; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 1252532.7500; train_edge_recon_loss: 1218177.9062; train_gene_expr_recon_loss: 55911745.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58382455.0000; train_optim_loss: 58382455.0000; val_kl_reg_loss: 1216610.0000; val_edge_recon_loss: 1182634.1250; val_gene_expr_recon_loss: 56462936.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58862180.0000; val_optim_loss: 58862180.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 55 sec.
Using best model state, which was in epoch 54.

--- MODEL EVALUATION ---
val AUROC score: 0.8784
val AUPRC score: 0.9733
val best accuracy score: 0.8524
val best F1 score: 0.9203
val target rna MSE score: 41.6371
val source rna MSE score: 66.0504
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 1: 0 hours, 3 minutes and 58 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
