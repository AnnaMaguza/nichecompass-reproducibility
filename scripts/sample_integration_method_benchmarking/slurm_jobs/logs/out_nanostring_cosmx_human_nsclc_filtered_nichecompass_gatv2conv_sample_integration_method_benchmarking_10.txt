Run timestamp: 28082023_202348_10.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '8', '--edge_batch_size_list', '512', '--node_batch_size_list', 'None', '--seeds', '1', '--run_index', '2', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc_filtered', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '100000.0', '--contrastive_logits_pos_ratio', '0.03125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_10']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 883, n_cat_covariates_embed_input: 0, n_hidden: 883, n_latent: 1484, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1484, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 883
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1484, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 883

--- INITIALIZING TRAINER ---
Number of training nodes: 254146
Number of validation nodes: 28238
Number of training edges: 1162586
Number of validation edges: 129176
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9698; val_auprc_score: 0.9883; val_best_acc_score: 0.9381; val_best_f1_score: 0.9599; train_kl_reg_loss: 10636.2846; train_edge_recon_loss: 1347198.9534; train_cat_covariates_contrastive_loss: 65016.6159; train_gene_expr_recon_loss: 2186301.5065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3609153.3606; train_optim_loss: 3609153.3606; val_kl_reg_loss: 12027.0557; val_edge_recon_loss: 1342014.3730; val_cat_covariates_contrastive_loss: 65807.3400; val_gene_expr_recon_loss: 1957480.8197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3377329.5879; val_optim_loss: 3377329.5879
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9727; val_auprc_score: 0.9892; val_best_acc_score: 0.9428; val_best_f1_score: 0.9628; train_kl_reg_loss: 14507.7296; train_edge_recon_loss: 1324096.8040; train_cat_covariates_contrastive_loss: 65602.8195; train_gene_expr_recon_loss: 1802975.0187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3207182.3754; train_optim_loss: 3207182.3754; val_kl_reg_loss: 16354.1500; val_edge_recon_loss: 1350956.1013; val_cat_covariates_contrastive_loss: 65918.1825; val_gene_expr_recon_loss: 1705839.0173; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3139067.4545; val_optim_loss: 3139067.4545
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9726; val_auprc_score: 0.9893; val_best_acc_score: 0.9446; val_best_f1_score: 0.9640; train_kl_reg_loss: 17221.4730; train_edge_recon_loss: 1321986.1189; train_cat_covariates_contrastive_loss: 65671.9499; train_gene_expr_recon_loss: 1650372.2591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3055251.8032; train_optim_loss: 3055251.8032; val_kl_reg_loss: 18129.0219; val_edge_recon_loss: 1332829.8355; val_cat_covariates_contrastive_loss: 65576.9834; val_gene_expr_recon_loss: 1619992.7643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3036528.6038; val_optim_loss: 3036528.6038
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9733; val_auprc_score: 0.9893; val_best_acc_score: 0.9456; val_best_f1_score: 0.9646; train_kl_reg_loss: 18363.3131; train_edge_recon_loss: 1321283.1251; train_cat_covariates_contrastive_loss: 65752.4848; train_gene_expr_recon_loss: 1595331.0530; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3000729.9741; train_optim_loss: 3000729.9741; val_kl_reg_loss: 19083.2419; val_edge_recon_loss: 1344274.8019; val_cat_covariates_contrastive_loss: 65765.9474; val_gene_expr_recon_loss: 1585836.8093; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3014960.7905; val_optim_loss: 3014960.7905
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9733; val_auprc_score: 0.9895; val_best_acc_score: 0.9450; val_best_f1_score: 0.9643; train_kl_reg_loss: 19054.9859; train_edge_recon_loss: 1319423.2322; train_cat_covariates_contrastive_loss: 65746.3810; train_gene_expr_recon_loss: 1563796.8853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2968021.4852; train_optim_loss: 2968021.4852; val_kl_reg_loss: 19695.8451; val_edge_recon_loss: 1335863.8953; val_cat_covariates_contrastive_loss: 65424.4337; val_gene_expr_recon_loss: 1560811.2208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2981795.3893; val_optim_loss: 2981795.3893
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9758; val_auprc_score: 0.9906; val_best_acc_score: 0.9467; val_best_f1_score: 0.9653; train_kl_reg_loss: 19532.2025; train_edge_recon_loss: 1320507.1827; train_cat_covariates_contrastive_loss: 65755.1568; train_gene_expr_recon_loss: 1550266.1346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2956060.6779; train_optim_loss: 2956060.6779; val_kl_reg_loss: 19729.5237; val_edge_recon_loss: 1335751.0756; val_cat_covariates_contrastive_loss: 66084.0070; val_gene_expr_recon_loss: 1549071.5232; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2970636.1314; val_optim_loss: 2970636.1314
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9749; val_auprc_score: 0.9901; val_best_acc_score: 0.9469; val_best_f1_score: 0.9655; train_kl_reg_loss: 19959.1417; train_edge_recon_loss: 1320791.8664; train_cat_covariates_contrastive_loss: 65777.7006; train_gene_expr_recon_loss: 1535578.3744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2942107.0794; train_optim_loss: 2942107.0794; val_kl_reg_loss: 20451.6621; val_edge_recon_loss: 1330329.0721; val_cat_covariates_contrastive_loss: 65776.2694; val_gene_expr_recon_loss: 1540173.0939; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2956730.0949; val_optim_loss: 2956730.0949
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9769; val_auprc_score: 0.9910; val_best_acc_score: 0.9494; val_best_f1_score: 0.9671; train_kl_reg_loss: 20255.8385; train_edge_recon_loss: 1318133.8672; train_cat_covariates_contrastive_loss: 65834.7883; train_gene_expr_recon_loss: 1527790.0346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2932014.5301; train_optim_loss: 2932014.5301; val_kl_reg_loss: 20153.2487; val_edge_recon_loss: 1329485.3271; val_cat_covariates_contrastive_loss: 66206.9890; val_gene_expr_recon_loss: 1537361.0232; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2953206.5909; val_optim_loss: 2953206.5909
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9757; val_auprc_score: 0.9906; val_best_acc_score: 0.9479; val_best_f1_score: 0.9661; train_kl_reg_loss: 20470.1040; train_edge_recon_loss: 1318131.6333; train_cat_covariates_contrastive_loss: 65793.9142; train_gene_expr_recon_loss: 1518192.5233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2922588.1744; train_optim_loss: 2922588.1744; val_kl_reg_loss: 20973.5290; val_edge_recon_loss: 1328045.3063; val_cat_covariates_contrastive_loss: 65876.1192; val_gene_expr_recon_loss: 1531910.0509; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2946805.0079; val_optim_loss: 2946805.0079
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9767; val_auprc_score: 0.9908; val_best_acc_score: 0.9494; val_best_f1_score: 0.9670; train_kl_reg_loss: 20812.7363; train_edge_recon_loss: 1319123.5574; train_cat_covariates_contrastive_loss: 65890.7978; train_gene_expr_recon_loss: 1513001.7212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2918828.8122; train_optim_loss: 2918828.8122; val_kl_reg_loss: 20560.0236; val_edge_recon_loss: 1339635.7060; val_cat_covariates_contrastive_loss: 66066.6712; val_gene_expr_recon_loss: 1519204.2060; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2945466.6057; val_optim_loss: 2945466.6057
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9760; val_auprc_score: 0.9904; val_best_acc_score: 0.9488; val_best_f1_score: 0.9667; train_kl_reg_loss: 20912.1955; train_edge_recon_loss: 1315606.5654; train_cat_covariates_contrastive_loss: 65973.0835; train_gene_expr_recon_loss: 1505144.7359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2907636.5821; train_optim_loss: 2907636.5821; val_kl_reg_loss: 20925.3656; val_edge_recon_loss: 1332766.5973; val_cat_covariates_contrastive_loss: 65853.1609; val_gene_expr_recon_loss: 1512116.5455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2931661.6660; val_optim_loss: 2931661.6660
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9775; val_auprc_score: 0.9911; val_best_acc_score: 0.9505; val_best_f1_score: 0.9676; train_kl_reg_loss: 21262.0797; train_edge_recon_loss: 1319945.8859; train_cat_covariates_contrastive_loss: 65977.8397; train_gene_expr_recon_loss: 1504971.9879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2912157.7938; train_optim_loss: 2912157.7938; val_kl_reg_loss: 21273.8208; val_edge_recon_loss: 1350891.8207; val_cat_covariates_contrastive_loss: 66230.4073; val_gene_expr_recon_loss: 1513322.3493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2951718.3992; val_optim_loss: 2951718.3992
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9778; val_auprc_score: 0.9912; val_best_acc_score: 0.9519; val_best_f1_score: 0.9686; train_kl_reg_loss: 21378.6641; train_edge_recon_loss: 1316203.1889; train_cat_covariates_contrastive_loss: 65991.9864; train_gene_expr_recon_loss: 1494041.9020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2897615.7400; train_optim_loss: 2897615.7400; val_kl_reg_loss: 21359.3261; val_edge_recon_loss: 1333250.4659; val_cat_covariates_contrastive_loss: 66068.2947; val_gene_expr_recon_loss: 1508037.0751; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2928715.1660; val_optim_loss: 2928715.1660
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9774; val_auprc_score: 0.9911; val_best_acc_score: 0.9508; val_best_f1_score: 0.9679; train_kl_reg_loss: 21560.9794; train_edge_recon_loss: 1319248.1227; train_cat_covariates_contrastive_loss: 65953.4272; train_gene_expr_recon_loss: 1492475.1881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2899237.7205; train_optim_loss: 2899237.7205; val_kl_reg_loss: 21989.4109; val_edge_recon_loss: 1331621.0035; val_cat_covariates_contrastive_loss: 66059.0102; val_gene_expr_recon_loss: 1508794.8182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2928464.2381; val_optim_loss: 2928464.2381
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9772; val_auprc_score: 0.9910; val_best_acc_score: 0.9506; val_best_f1_score: 0.9679; train_kl_reg_loss: 21772.0406; train_edge_recon_loss: 1319473.8400; train_cat_covariates_contrastive_loss: 66029.0166; train_gene_expr_recon_loss: 1488739.5461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2896014.4500; train_optim_loss: 2896014.4500; val_kl_reg_loss: 21884.5837; val_edge_recon_loss: 1338070.7554; val_cat_covariates_contrastive_loss: 66200.8131; val_gene_expr_recon_loss: 1521941.5119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2948097.6581; val_optim_loss: 2948097.6581
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9784; val_auprc_score: 0.9913; val_best_acc_score: 0.9527; val_best_f1_score: 0.9692; train_kl_reg_loss: 22062.4411; train_edge_recon_loss: 1316374.4391; train_cat_covariates_contrastive_loss: 65967.8918; train_gene_expr_recon_loss: 1487153.2094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2891557.9795; train_optim_loss: 2891557.9795; val_kl_reg_loss: 22239.8292; val_edge_recon_loss: 1332724.2579; val_cat_covariates_contrastive_loss: 66148.7448; val_gene_expr_recon_loss: 1498243.2179; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2919356.0484; val_optim_loss: 2919356.0484
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9787; val_auprc_score: 0.9916; val_best_acc_score: 0.9511; val_best_f1_score: 0.9681; train_kl_reg_loss: 22102.7276; train_edge_recon_loss: 1315982.6249; train_cat_covariates_contrastive_loss: 66053.6925; train_gene_expr_recon_loss: 1483931.0898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2888070.1380; train_optim_loss: 2888070.1380; val_kl_reg_loss: 21785.6826; val_edge_recon_loss: 1337673.2624; val_cat_covariates_contrastive_loss: 66359.8220; val_gene_expr_recon_loss: 1493302.1354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2919120.9022; val_optim_loss: 2919120.9022
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9773; val_auprc_score: 0.9908; val_best_acc_score: 0.9523; val_best_f1_score: 0.9689; train_kl_reg_loss: 22231.2637; train_edge_recon_loss: 1315219.3957; train_cat_covariates_contrastive_loss: 66054.9402; train_gene_expr_recon_loss: 1479642.5193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2883148.1159; train_optim_loss: 2883148.1159; val_kl_reg_loss: 22440.9870; val_edge_recon_loss: 1328837.9387; val_cat_covariates_contrastive_loss: 66041.4919; val_gene_expr_recon_loss: 1487305.6966; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2904626.1146; val_optim_loss: 2904626.1146
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9778; val_auprc_score: 0.9911; val_best_acc_score: 0.9530; val_best_f1_score: 0.9694; train_kl_reg_loss: 22281.8710; train_edge_recon_loss: 1316707.8753; train_cat_covariates_contrastive_loss: 66094.5193; train_gene_expr_recon_loss: 1478333.1793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2883417.4502; train_optim_loss: 2883417.4502; val_kl_reg_loss: 23147.5977; val_edge_recon_loss: 1331894.4615; val_cat_covariates_contrastive_loss: 65863.7691; val_gene_expr_recon_loss: 1501422.0395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2922327.8715; val_optim_loss: 2922327.8715
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9783; val_auprc_score: 0.9913; val_best_acc_score: 0.9528; val_best_f1_score: 0.9692; train_kl_reg_loss: 22435.6088; train_edge_recon_loss: 1315405.1306; train_cat_covariates_contrastive_loss: 66090.6297; train_gene_expr_recon_loss: 1474363.4976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2878294.8702; train_optim_loss: 2878294.8702; val_kl_reg_loss: 22577.1655; val_edge_recon_loss: 1341717.4595; val_cat_covariates_contrastive_loss: 66083.7744; val_gene_expr_recon_loss: 1485679.0741; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2916057.4743; val_optim_loss: 2916057.4743
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9772; val_auprc_score: 0.9908; val_best_acc_score: 0.9521; val_best_f1_score: 0.9688; train_kl_reg_loss: 22443.0065; train_edge_recon_loss: 1313381.3361; train_cat_covariates_contrastive_loss: 66131.5043; train_gene_expr_recon_loss: 1472612.1664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2874568.0132; train_optim_loss: 2874568.0132; val_kl_reg_loss: 22620.5084; val_edge_recon_loss: 1335339.4679; val_cat_covariates_contrastive_loss: 66023.1596; val_gene_expr_recon_loss: 1481896.0010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2905879.1344; val_optim_loss: 2905879.1344
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9796; val_auprc_score: 0.9918; val_best_acc_score: 0.9536; val_best_f1_score: 0.9697; train_kl_reg_loss: 22442.9935; train_edge_recon_loss: 1318673.9452; train_cat_covariates_contrastive_loss: 66071.6028; train_gene_expr_recon_loss: 1471161.5245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2878350.0630; train_optim_loss: 2878350.0630; val_kl_reg_loss: 22166.7279; val_edge_recon_loss: 1336643.2688; val_cat_covariates_contrastive_loss: 66319.2872; val_gene_expr_recon_loss: 1481583.8528; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2906713.1314; val_optim_loss: 2906713.1314

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9792; val_auprc_score: 0.9915; val_best_acc_score: 0.9545; val_best_f1_score: 0.9703; train_kl_reg_loss: 21916.0371; train_edge_recon_loss: 1312998.8828; train_cat_covariates_contrastive_loss: 66146.2406; train_gene_expr_recon_loss: 1442545.6491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2843606.8136; train_optim_loss: 2843606.8136; val_kl_reg_loss: 21987.8774; val_edge_recon_loss: 1321608.1838; val_cat_covariates_contrastive_loss: 66187.0596; val_gene_expr_recon_loss: 1460393.0296; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2870176.1502; val_optim_loss: 2870176.1502
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9803; val_auprc_score: 0.9922; val_best_acc_score: 0.9555; val_best_f1_score: 0.9710; train_kl_reg_loss: 21886.3629; train_edge_recon_loss: 1314307.5965; train_cat_covariates_contrastive_loss: 66164.1535; train_gene_expr_recon_loss: 1437004.2069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2839362.3207; train_optim_loss: 2839362.3207; val_kl_reg_loss: 22040.8048; val_edge_recon_loss: 1325332.0020; val_cat_covariates_contrastive_loss: 66202.7330; val_gene_expr_recon_loss: 1456615.5484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2870191.0860; val_optim_loss: 2870191.0860
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9800; val_auprc_score: 0.9920; val_best_acc_score: 0.9546; val_best_f1_score: 0.9704; train_kl_reg_loss: 21730.3558; train_edge_recon_loss: 1315680.6023; train_cat_covariates_contrastive_loss: 66146.5783; train_gene_expr_recon_loss: 1435355.0307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2838912.5690; train_optim_loss: 2838912.5690; val_kl_reg_loss: 21631.4239; val_edge_recon_loss: 1328025.8029; val_cat_covariates_contrastive_loss: 66331.3799; val_gene_expr_recon_loss: 1454280.6957; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2870269.3024; val_optim_loss: 2870269.3024
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9795; val_auprc_score: 0.9917; val_best_acc_score: 0.9545; val_best_f1_score: 0.9702; train_kl_reg_loss: 21525.8844; train_edge_recon_loss: 1312290.9046; train_cat_covariates_contrastive_loss: 66152.3959; train_gene_expr_recon_loss: 1433490.3211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2833459.5064; train_optim_loss: 2833459.5064; val_kl_reg_loss: 21762.8686; val_edge_recon_loss: 1336159.1705; val_cat_covariates_contrastive_loss: 65999.9468; val_gene_expr_recon_loss: 1453000.1517; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2876922.1383; val_optim_loss: 2876922.1383
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9810; val_auprc_score: 0.9925; val_best_acc_score: 0.9559; val_best_f1_score: 0.9712; train_kl_reg_loss: 21407.2986; train_edge_recon_loss: 1314319.0964; train_cat_covariates_contrastive_loss: 66097.0661; train_gene_expr_recon_loss: 1432548.0465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2834371.5086; train_optim_loss: 2834371.5086; val_kl_reg_loss: 21271.3740; val_edge_recon_loss: 1329097.3938; val_cat_covariates_contrastive_loss: 66281.3846; val_gene_expr_recon_loss: 1452824.9521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2869475.1038; val_optim_loss: 2869475.1038
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9804; val_auprc_score: 0.9920; val_best_acc_score: 0.9560; val_best_f1_score: 0.9713; train_kl_reg_loss: 21311.2716; train_edge_recon_loss: 1315209.9705; train_cat_covariates_contrastive_loss: 66129.9565; train_gene_expr_recon_loss: 1431950.2435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2834601.4414; train_optim_loss: 2834601.4414; val_kl_reg_loss: 21164.8940; val_edge_recon_loss: 1320227.6339; val_cat_covariates_contrastive_loss: 66097.1290; val_gene_expr_recon_loss: 1451518.1700; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2859007.8320; val_optim_loss: 2859007.8320
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9808; val_auprc_score: 0.9922; val_best_acc_score: 0.9564; val_best_f1_score: 0.9716; train_kl_reg_loss: 21217.8512; train_edge_recon_loss: 1312797.1674; train_cat_covariates_contrastive_loss: 66098.8749; train_gene_expr_recon_loss: 1431391.1485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2831505.0441; train_optim_loss: 2831505.0441; val_kl_reg_loss: 21154.8661; val_edge_recon_loss: 1329308.2782; val_cat_covariates_contrastive_loss: 66198.8378; val_gene_expr_recon_loss: 1450299.6344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2866961.6136; val_optim_loss: 2866961.6136
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9796; val_auprc_score: 0.9919; val_best_acc_score: 0.9542; val_best_f1_score: 0.9702; train_kl_reg_loss: 21049.2095; train_edge_recon_loss: 1310612.8974; train_cat_covariates_contrastive_loss: 66088.2089; train_gene_expr_recon_loss: 1430047.2493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2827797.5651; train_optim_loss: 2827797.5651; val_kl_reg_loss: 21124.6393; val_edge_recon_loss: 1328029.8740; val_cat_covariates_contrastive_loss: 66053.3289; val_gene_expr_recon_loss: 1449639.9610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2864847.8073; val_optim_loss: 2864847.8073
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9804; val_auprc_score: 0.9923; val_best_acc_score: 0.9556; val_best_f1_score: 0.9712; train_kl_reg_loss: 20993.2124; train_edge_recon_loss: 1313954.3116; train_cat_covariates_contrastive_loss: 66027.1251; train_gene_expr_recon_loss: 1429880.7768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2830855.4260; train_optim_loss: 2830855.4260; val_kl_reg_loss: 20987.2454; val_edge_recon_loss: 1318363.9753; val_cat_covariates_contrastive_loss: 66211.8863; val_gene_expr_recon_loss: 1448522.6141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2854085.7322; val_optim_loss: 2854085.7322
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9804; val_auprc_score: 0.9919; val_best_acc_score: 0.9560; val_best_f1_score: 0.9712; train_kl_reg_loss: 20931.6380; train_edge_recon_loss: 1311741.2658; train_cat_covariates_contrastive_loss: 66023.6890; train_gene_expr_recon_loss: 1429715.1201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2828411.7136; train_optim_loss: 2828411.7136; val_kl_reg_loss: 20960.7979; val_edge_recon_loss: 1332462.1838; val_cat_covariates_contrastive_loss: 66099.7050; val_gene_expr_recon_loss: 1450960.6052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2870483.2856; val_optim_loss: 2870483.2856
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9797; val_auprc_score: 0.9917; val_best_acc_score: 0.9559; val_best_f1_score: 0.9712; train_kl_reg_loss: 20804.5235; train_edge_recon_loss: 1314079.9728; train_cat_covariates_contrastive_loss: 65984.4178; train_gene_expr_recon_loss: 1427959.5043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2828828.4186; train_optim_loss: 2828828.4186; val_kl_reg_loss: 20988.2019; val_edge_recon_loss: 1321197.3325; val_cat_covariates_contrastive_loss: 65925.4293; val_gene_expr_recon_loss: 1450910.9412; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2859021.8992; val_optim_loss: 2859021.8992
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9796; val_auprc_score: 0.9918; val_best_acc_score: 0.9548; val_best_f1_score: 0.9705; train_kl_reg_loss: 20691.0118; train_edge_recon_loss: 1312922.1733; train_cat_covariates_contrastive_loss: 66020.2719; train_gene_expr_recon_loss: 1427698.5012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2827331.9609; train_optim_loss: 2827331.9609; val_kl_reg_loss: 20704.8159; val_edge_recon_loss: 1334651.3666; val_cat_covariates_contrastive_loss: 66105.6938; val_gene_expr_recon_loss: 1449326.9620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2870788.8379; val_optim_loss: 2870788.8379
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9803; val_auprc_score: 0.9921; val_best_acc_score: 0.9558; val_best_f1_score: 0.9712; train_kl_reg_loss: 20583.5555; train_edge_recon_loss: 1310379.5370; train_cat_covariates_contrastive_loss: 66030.3380; train_gene_expr_recon_loss: 1427565.4055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2824558.8345; train_optim_loss: 2824558.8345; val_kl_reg_loss: 20629.0207; val_edge_recon_loss: 1327176.6877; val_cat_covariates_contrastive_loss: 66136.4333; val_gene_expr_recon_loss: 1448041.5356; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2861983.6749; val_optim_loss: 2861983.6749

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9802; val_auprc_score: 0.9920; val_best_acc_score: 0.9553; val_best_f1_score: 0.9709; train_kl_reg_loss: 20489.4756; train_edge_recon_loss: 1312177.3976; train_cat_covariates_contrastive_loss: 66013.1714; train_gene_expr_recon_loss: 1424239.4477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2822919.4916; train_optim_loss: 2822919.4916; val_kl_reg_loss: 20559.9239; val_edge_recon_loss: 1327376.7989; val_cat_covariates_contrastive_loss: 66000.4319; val_gene_expr_recon_loss: 1446849.3360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2860786.4970; val_optim_loss: 2860786.4970
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9804; val_auprc_score: 0.9921; val_best_acc_score: 0.9566; val_best_f1_score: 0.9716; train_kl_reg_loss: 20498.4378; train_edge_recon_loss: 1311529.8017; train_cat_covariates_contrastive_loss: 66021.3176; train_gene_expr_recon_loss: 1423695.4030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2821744.9585; train_optim_loss: 2821744.9585; val_kl_reg_loss: 20525.2136; val_edge_recon_loss: 1333740.7564; val_cat_covariates_contrastive_loss: 66049.5406; val_gene_expr_recon_loss: 1445765.1754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2866080.6818; val_optim_loss: 2866080.6818
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9808; val_auprc_score: 0.9923; val_best_acc_score: 0.9561; val_best_f1_score: 0.9713; train_kl_reg_loss: 20502.1725; train_edge_recon_loss: 1312139.6998; train_cat_covariates_contrastive_loss: 66006.8005; train_gene_expr_recon_loss: 1423815.4183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2822464.0892; train_optim_loss: 2822464.0892; val_kl_reg_loss: 20526.7109; val_edge_recon_loss: 1327230.5899; val_cat_covariates_contrastive_loss: 66099.2656; val_gene_expr_recon_loss: 1446358.0203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2860214.5810; val_optim_loss: 2860214.5810
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9803; val_auprc_score: 0.9920; val_best_acc_score: 0.9563; val_best_f1_score: 0.9714; train_kl_reg_loss: 20501.1505; train_edge_recon_loss: 1309699.6416; train_cat_covariates_contrastive_loss: 65978.1725; train_gene_expr_recon_loss: 1423391.3867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2819570.3528; train_optim_loss: 2819570.3528; val_kl_reg_loss: 20590.0456; val_edge_recon_loss: 1333147.6369; val_cat_covariates_contrastive_loss: 66045.7021; val_gene_expr_recon_loss: 1446992.5311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2866775.9170; val_optim_loss: 2866775.9170

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 754 min 44 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
val AUROC score: 0.9634
val AUPRC score: 0.9810
val best accuracy score: 0.9500
val best F1 score: 0.9673
val target rna MSE score: 0.3558
val source rna MSE score: 0.0465
Val cat covariate0 mean sim diff: -0.0003
Val cat covariate1 mean sim diff: -0.0896
Duration of model training in run 2: 12 hours, 38 minutes and 53 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
