First script finished. Launching follow up script.
Run timestamp: 02062023_065414.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '2048', '2048', '1024', '1024', '512', '512', '256', '256', '128', '128', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'Main_molecular_cell_type', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', 'batch9', 'batch10', 'batch11', 'batch12', 'batch13', 'batch14', 'batch15', 'batch16', 'batch17', 'batch18', 'batch19', 'batch20', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 982152
Number of validation nodes: 109128
Number of training edges: 2342808
Number of validation edges: 260312
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9663; val_auprc_score: 0.9962; val_best_acc_score: 0.9773; val_best_f1_score: 0.9878; train_kl_reg_loss: 2095.8679; train_edge_recon_loss: 40750.0709; train_gene_expr_recon_loss: 108395.8553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 151241.7938; train_optim_loss: 151241.7938; val_kl_reg_loss: 2075.2894; val_edge_recon_loss: 40424.1915; val_gene_expr_recon_loss: 103365.2156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145864.6968; val_optim_loss: 145864.6968
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9705; val_auprc_score: 0.9967; val_best_acc_score: 0.9787; val_best_f1_score: 0.9885; train_kl_reg_loss: 2250.8048; train_edge_recon_loss: 40047.8180; train_gene_expr_recon_loss: 101324.7333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143623.3561; train_optim_loss: 143623.3561; val_kl_reg_loss: 2271.8539; val_edge_recon_loss: 41356.3626; val_gene_expr_recon_loss: 99365.9835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142994.1990; val_optim_loss: 142994.1990
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9708; val_auprc_score: 0.9969; val_best_acc_score: 0.9799; val_best_f1_score: 0.9892; train_kl_reg_loss: 2360.8272; train_edge_recon_loss: 40025.3311; train_gene_expr_recon_loss: 98706.4551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141092.6134; train_optim_loss: 141092.6134; val_kl_reg_loss: 2331.3046; val_edge_recon_loss: 40523.1320; val_gene_expr_recon_loss: 97571.3832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140425.8196; val_optim_loss: 140425.8196
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9740; val_auprc_score: 0.9972; val_best_acc_score: 0.9799; val_best_f1_score: 0.9892; train_kl_reg_loss: 2425.2345; train_edge_recon_loss: 40041.1108; train_gene_expr_recon_loss: 97509.0859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139975.4314; train_optim_loss: 139975.4314; val_kl_reg_loss: 2396.2276; val_edge_recon_loss: 41417.5394; val_gene_expr_recon_loss: 96859.3862; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140673.1530; val_optim_loss: 140673.1530
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9732; val_auprc_score: 0.9971; val_best_acc_score: 0.9803; val_best_f1_score: 0.9894; train_kl_reg_loss: 2467.1192; train_edge_recon_loss: 40068.0788; train_gene_expr_recon_loss: 96758.1596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139293.3576; train_optim_loss: 139293.3576; val_kl_reg_loss: 2412.5682; val_edge_recon_loss: 41068.5386; val_gene_expr_recon_loss: 96191.3428; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139672.4501; val_optim_loss: 139672.4501
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9751; val_auprc_score: 0.9974; val_best_acc_score: 0.9807; val_best_f1_score: 0.9896; train_kl_reg_loss: 2498.7238; train_edge_recon_loss: 39945.4965; train_gene_expr_recon_loss: 96288.1204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138732.3405; train_optim_loss: 138732.3405; val_kl_reg_loss: 2451.8193; val_edge_recon_loss: 40842.6700; val_gene_expr_recon_loss: 95813.8868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139108.3762; val_optim_loss: 139108.3762
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9753; val_auprc_score: 0.9974; val_best_acc_score: 0.9810; val_best_f1_score: 0.9898; train_kl_reg_loss: 2521.9440; train_edge_recon_loss: 39996.3667; train_gene_expr_recon_loss: 95917.1142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138435.4249; train_optim_loss: 138435.4249; val_kl_reg_loss: 2465.3172; val_edge_recon_loss: 41284.6487; val_gene_expr_recon_loss: 95558.0494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139308.0154; val_optim_loss: 139308.0154
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9754; val_auprc_score: 0.9974; val_best_acc_score: 0.9813; val_best_f1_score: 0.9899; train_kl_reg_loss: 2540.7379; train_edge_recon_loss: 39952.9285; train_gene_expr_recon_loss: 95630.9160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138124.5824; train_optim_loss: 138124.5824; val_kl_reg_loss: 2557.6690; val_edge_recon_loss: 40764.8539; val_gene_expr_recon_loss: 95254.4099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138576.9332; val_optim_loss: 138576.9332
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9747; val_auprc_score: 0.9974; val_best_acc_score: 0.9815; val_best_f1_score: 0.9901; train_kl_reg_loss: 2559.4008; train_edge_recon_loss: 39936.0344; train_gene_expr_recon_loss: 95414.4020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137909.8372; train_optim_loss: 137909.8372; val_kl_reg_loss: 2560.4719; val_edge_recon_loss: 40485.7560; val_gene_expr_recon_loss: 95059.2202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138105.4490; val_optim_loss: 138105.4490
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9756; val_auprc_score: 0.9974; val_best_acc_score: 0.9819; val_best_f1_score: 0.9903; train_kl_reg_loss: 2573.0642; train_edge_recon_loss: 40096.2062; train_gene_expr_recon_loss: 95281.7213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137950.9917; train_optim_loss: 137950.9917; val_kl_reg_loss: 2571.6768; val_edge_recon_loss: 40635.5317; val_gene_expr_recon_loss: 94910.1088; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138117.3173; val_optim_loss: 138117.3173
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9763; val_auprc_score: 0.9974; val_best_acc_score: 0.9821; val_best_f1_score: 0.9904; train_kl_reg_loss: 2583.1521; train_edge_recon_loss: 40048.1767; train_gene_expr_recon_loss: 95101.8338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137733.1626; train_optim_loss: 137733.1626; val_kl_reg_loss: 2546.7909; val_edge_recon_loss: 41055.7750; val_gene_expr_recon_loss: 94879.9097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138482.4757; val_optim_loss: 138482.4757
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9759; val_auprc_score: 0.9975; val_best_acc_score: 0.9818; val_best_f1_score: 0.9903; train_kl_reg_loss: 2592.2240; train_edge_recon_loss: 40086.3997; train_gene_expr_recon_loss: 95037.5982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137716.2221; train_optim_loss: 137716.2221; val_kl_reg_loss: 2545.3603; val_edge_recon_loss: 40575.8286; val_gene_expr_recon_loss: 94756.2310; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137877.4193; val_optim_loss: 137877.4193
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9771; val_auprc_score: 0.9976; val_best_acc_score: 0.9819; val_best_f1_score: 0.9903; train_kl_reg_loss: 2600.9690; train_edge_recon_loss: 39792.7500; train_gene_expr_recon_loss: 94968.2430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137361.9619; train_optim_loss: 137361.9619; val_kl_reg_loss: 2535.4851; val_edge_recon_loss: 41064.3459; val_gene_expr_recon_loss: 94668.8900; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138268.7217; val_optim_loss: 138268.7217
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9773; val_auprc_score: 0.9976; val_best_acc_score: 0.9824; val_best_f1_score: 0.9906; train_kl_reg_loss: 2607.3688; train_edge_recon_loss: 40020.4739; train_gene_expr_recon_loss: 94873.8561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137501.6989; train_optim_loss: 137501.6989; val_kl_reg_loss: 2561.8647; val_edge_recon_loss: 41513.8340; val_gene_expr_recon_loss: 94536.6896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138612.3885; val_optim_loss: 138612.3885
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9761; val_auprc_score: 0.9975; val_best_acc_score: 0.9828; val_best_f1_score: 0.9908; train_kl_reg_loss: 2613.6053; train_edge_recon_loss: 39849.6020; train_gene_expr_recon_loss: 94809.4321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137272.6396; train_optim_loss: 137272.6396; val_kl_reg_loss: 2564.2935; val_edge_recon_loss: 40499.0849; val_gene_expr_recon_loss: 94563.2082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137626.5869; val_optim_loss: 137626.5869
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9782; val_auprc_score: 0.9977; val_best_acc_score: 0.9824; val_best_f1_score: 0.9906; train_kl_reg_loss: 2621.3124; train_edge_recon_loss: 39860.9230; train_gene_expr_recon_loss: 94735.9600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137218.1955; train_optim_loss: 137218.1955; val_kl_reg_loss: 2578.9771; val_edge_recon_loss: 40994.8697; val_gene_expr_recon_loss: 94495.5085; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138069.3552; val_optim_loss: 138069.3552
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9777; val_auprc_score: 0.9976; val_best_acc_score: 0.9834; val_best_f1_score: 0.9911; train_kl_reg_loss: 2624.0538; train_edge_recon_loss: 39865.8355; train_gene_expr_recon_loss: 94708.7345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137198.6237; train_optim_loss: 137198.6237; val_kl_reg_loss: 2614.6299; val_edge_recon_loss: 40535.4453; val_gene_expr_recon_loss: 94443.7112; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137593.7866; val_optim_loss: 137593.7866
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9774; val_auprc_score: 0.9976; val_best_acc_score: 0.9827; val_best_f1_score: 0.9907; train_kl_reg_loss: 2629.7082; train_edge_recon_loss: 39893.3627; train_gene_expr_recon_loss: 94656.9210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137179.9917; train_optim_loss: 137179.9917; val_kl_reg_loss: 2569.3015; val_edge_recon_loss: 40899.9689; val_gene_expr_recon_loss: 94429.6559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137898.9264; val_optim_loss: 137898.9264
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9783; val_auprc_score: 0.9977; val_best_acc_score: 0.9824; val_best_f1_score: 0.9905; train_kl_reg_loss: 2638.2287; train_edge_recon_loss: 39718.4428; train_gene_expr_recon_loss: 94626.2628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136982.9342; train_optim_loss: 136982.9342; val_kl_reg_loss: 2580.5817; val_edge_recon_loss: 41531.1812; val_gene_expr_recon_loss: 94469.2447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138581.0078; val_optim_loss: 138581.0078
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9776; val_auprc_score: 0.9976; val_best_acc_score: 0.9834; val_best_f1_score: 0.9911; train_kl_reg_loss: 2636.5511; train_edge_recon_loss: 39722.3324; train_gene_expr_recon_loss: 94575.4992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136934.3827; train_optim_loss: 136934.3827; val_kl_reg_loss: 2603.0811; val_edge_recon_loss: 41008.3778; val_gene_expr_recon_loss: 94385.7101; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137997.1696; val_optim_loss: 137997.1696

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9781; val_auprc_score: 0.9977; val_best_acc_score: 0.9835; val_best_f1_score: 0.9911; train_kl_reg_loss: 2603.1495; train_edge_recon_loss: 39814.4479; train_gene_expr_recon_loss: 94241.7286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136659.3259; train_optim_loss: 136659.3259; val_kl_reg_loss: 2548.9738; val_edge_recon_loss: 40348.7522; val_gene_expr_recon_loss: 94199.9494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137097.6757; val_optim_loss: 137097.6757
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9792; val_auprc_score: 0.9978; val_best_acc_score: 0.9838; val_best_f1_score: 0.9913; train_kl_reg_loss: 2595.9827; train_edge_recon_loss: 39752.9505; train_gene_expr_recon_loss: 94225.5844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136574.5177; train_optim_loss: 136574.5177; val_kl_reg_loss: 2546.3419; val_edge_recon_loss: 40683.5552; val_gene_expr_recon_loss: 94053.7463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137283.6440; val_optim_loss: 137283.6440
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9789; val_auprc_score: 0.9978; val_best_acc_score: 0.9837; val_best_f1_score: 0.9912; train_kl_reg_loss: 2592.2449; train_edge_recon_loss: 39597.3719; train_gene_expr_recon_loss: 94205.1525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136394.7692; train_optim_loss: 136394.7692; val_kl_reg_loss: 2553.6183; val_edge_recon_loss: 40725.1343; val_gene_expr_recon_loss: 94061.2014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137339.9547; val_optim_loss: 137339.9547
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9784; val_auprc_score: 0.9976; val_best_acc_score: 0.9837; val_best_f1_score: 0.9912; train_kl_reg_loss: 2593.6236; train_edge_recon_loss: 39690.4881; train_gene_expr_recon_loss: 94198.7435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136482.8551; train_optim_loss: 136482.8551; val_kl_reg_loss: 2529.4524; val_edge_recon_loss: 40826.1793; val_gene_expr_recon_loss: 94067.9012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137423.5330; val_optim_loss: 137423.5330

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9785; val_auprc_score: 0.9976; val_best_acc_score: 0.9837; val_best_f1_score: 0.9912; train_kl_reg_loss: 2585.7767; train_edge_recon_loss: 39687.7111; train_gene_expr_recon_loss: 94120.6165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136394.1042; train_optim_loss: 136394.1042; val_kl_reg_loss: 2545.0818; val_edge_recon_loss: 40996.9785; val_gene_expr_recon_loss: 93990.7964; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137532.8566; val_optim_loss: 137532.8566
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9795; val_auprc_score: 0.9978; val_best_acc_score: 0.9841; val_best_f1_score: 0.9915; train_kl_reg_loss: 2588.1089; train_edge_recon_loss: 39782.9397; train_gene_expr_recon_loss: 94134.8319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136505.8803; train_optim_loss: 136505.8803; val_kl_reg_loss: 2547.7491; val_edge_recon_loss: 40533.4980; val_gene_expr_recon_loss: 94036.7300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137117.9769; val_optim_loss: 137117.9769
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9789; val_auprc_score: 0.9978; val_best_acc_score: 0.9840; val_best_f1_score: 0.9914; train_kl_reg_loss: 2588.3580; train_edge_recon_loss: 39789.2199; train_gene_expr_recon_loss: 94141.9642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136519.5424; train_optim_loss: 136519.5424; val_kl_reg_loss: 2545.7912; val_edge_recon_loss: 40694.5150; val_gene_expr_recon_loss: 94061.5086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137301.8145; val_optim_loss: 137301.8145

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 150 min 26 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9792
Val AUPRC score: 0.9978
Val best accuracy score: 0.9836
Val best F1 score: 0.9912
Val gene expr MSE score: 0.7609
Duration of model training in run 1: 2 hours, 32 minutes and 22 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 982152
Number of validation nodes: 109128
Number of training edges: 2342808
Number of validation edges: 260312
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9669; val_auprc_score: 0.9963; val_best_acc_score: 0.9764; val_best_f1_score: 0.9873; train_kl_reg_loss: 2101.2175; train_edge_recon_loss: 40860.6353; train_gene_expr_recon_loss: 108395.2373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 151357.0903; train_optim_loss: 151357.0903; val_kl_reg_loss: 2139.7948; val_edge_recon_loss: 40667.7442; val_gene_expr_recon_loss: 103378.6075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146186.1469; val_optim_loss: 146186.1469
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9705; val_auprc_score: 0.9967; val_best_acc_score: 0.9782; val_best_f1_score: 0.9883; train_kl_reg_loss: 2256.3804; train_edge_recon_loss: 40075.8886; train_gene_expr_recon_loss: 101244.5199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143576.7887; train_optim_loss: 143576.7887; val_kl_reg_loss: 2285.8378; val_edge_recon_loss: 41179.8584; val_gene_expr_recon_loss: 99607.1553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143072.8510; val_optim_loss: 143072.8510
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9723; val_auprc_score: 0.9970; val_best_acc_score: 0.9788; val_best_f1_score: 0.9886; train_kl_reg_loss: 2354.1449; train_edge_recon_loss: 40036.2548; train_gene_expr_recon_loss: 98649.6653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141040.0648; train_optim_loss: 141040.0648; val_kl_reg_loss: 2355.2794; val_edge_recon_loss: 41524.9135; val_gene_expr_recon_loss: 97894.2190; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141774.4116; val_optim_loss: 141774.4116
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9727; val_auprc_score: 0.9971; val_best_acc_score: 0.9799; val_best_f1_score: 0.9892; train_kl_reg_loss: 2422.1891; train_edge_recon_loss: 39997.0402; train_gene_expr_recon_loss: 97397.8463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139817.0753; train_optim_loss: 139817.0753; val_kl_reg_loss: 2392.1959; val_edge_recon_loss: 40862.8629; val_gene_expr_recon_loss: 96975.4871; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140230.5458; val_optim_loss: 140230.5458
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9728; val_auprc_score: 0.9971; val_best_acc_score: 0.9800; val_best_f1_score: 0.9893; train_kl_reg_loss: 2466.5691; train_edge_recon_loss: 39880.2372; train_gene_expr_recon_loss: 96679.8725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139026.6790; train_optim_loss: 139026.6790; val_kl_reg_loss: 2508.9543; val_edge_recon_loss: 41292.3101; val_gene_expr_recon_loss: 96365.4878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140166.7517; val_optim_loss: 140166.7517
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9740; val_auprc_score: 0.9972; val_best_acc_score: 0.9810; val_best_f1_score: 0.9898; train_kl_reg_loss: 2499.0140; train_edge_recon_loss: 39932.8449; train_gene_expr_recon_loss: 96223.5909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138655.4500; train_optim_loss: 138655.4500; val_kl_reg_loss: 2486.5664; val_edge_recon_loss: 40696.0962; val_gene_expr_recon_loss: 95987.5667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139170.2295; val_optim_loss: 139170.2295
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9735; val_auprc_score: 0.9972; val_best_acc_score: 0.9808; val_best_f1_score: 0.9897; train_kl_reg_loss: 2524.2008; train_edge_recon_loss: 40019.5697; train_gene_expr_recon_loss: 95838.7985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138382.5692; train_optim_loss: 138382.5692; val_kl_reg_loss: 2470.4514; val_edge_recon_loss: 40830.0298; val_gene_expr_recon_loss: 95729.7219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139030.2031; val_optim_loss: 139030.2031
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9756; val_auprc_score: 0.9973; val_best_acc_score: 0.9815; val_best_f1_score: 0.9900; train_kl_reg_loss: 2541.3189; train_edge_recon_loss: 39893.0063; train_gene_expr_recon_loss: 95585.7452; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138020.0704; train_optim_loss: 138020.0704; val_kl_reg_loss: 2558.1179; val_edge_recon_loss: 41461.2022; val_gene_expr_recon_loss: 95513.5253; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139532.8452; val_optim_loss: 139532.8452
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9755; val_auprc_score: 0.9974; val_best_acc_score: 0.9813; val_best_f1_score: 0.9900; train_kl_reg_loss: 2554.9396; train_edge_recon_loss: 40008.9791; train_gene_expr_recon_loss: 95388.7970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137952.7158; train_optim_loss: 137952.7158; val_kl_reg_loss: 2583.4007; val_edge_recon_loss: 40693.4982; val_gene_expr_recon_loss: 95373.4120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138650.3109; val_optim_loss: 138650.3109
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9761; val_auprc_score: 0.9974; val_best_acc_score: 0.9818; val_best_f1_score: 0.9902; train_kl_reg_loss: 2568.7223; train_edge_recon_loss: 39880.5924; train_gene_expr_recon_loss: 95228.5457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137677.8605; train_optim_loss: 137677.8605; val_kl_reg_loss: 2580.9892; val_edge_recon_loss: 41060.8158; val_gene_expr_recon_loss: 95214.4832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138856.2885; val_optim_loss: 138856.2885
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9743; val_auprc_score: 0.9972; val_best_acc_score: 0.9819; val_best_f1_score: 0.9903; train_kl_reg_loss: 2580.2966; train_edge_recon_loss: 39814.2845; train_gene_expr_recon_loss: 95119.7528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137514.3339; train_optim_loss: 137514.3339; val_kl_reg_loss: 2506.2746; val_edge_recon_loss: 40600.6856; val_gene_expr_recon_loss: 95105.8736; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138212.8347; val_optim_loss: 138212.8347
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9760; val_auprc_score: 0.9975; val_best_acc_score: 0.9819; val_best_f1_score: 0.9903; train_kl_reg_loss: 2590.0518; train_edge_recon_loss: 40025.9507; train_gene_expr_recon_loss: 95021.7701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137637.7726; train_optim_loss: 137637.7726; val_kl_reg_loss: 2507.5034; val_edge_recon_loss: 40684.9941; val_gene_expr_recon_loss: 94964.0848; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138156.5825; val_optim_loss: 138156.5825
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9758; val_auprc_score: 0.9974; val_best_acc_score: 0.9820; val_best_f1_score: 0.9903; train_kl_reg_loss: 2593.8801; train_edge_recon_loss: 39968.9293; train_gene_expr_recon_loss: 94931.0617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137493.8711; train_optim_loss: 137493.8711; val_kl_reg_loss: 2623.7957; val_edge_recon_loss: 40756.1176; val_gene_expr_recon_loss: 94919.0835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138298.9968; val_optim_loss: 138298.9968
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9765; val_auprc_score: 0.9975; val_best_acc_score: 0.9827; val_best_f1_score: 0.9907; train_kl_reg_loss: 2604.7123; train_edge_recon_loss: 39906.7425; train_gene_expr_recon_loss: 94860.2384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137371.6933; train_optim_loss: 137371.6933; val_kl_reg_loss: 2531.0106; val_edge_recon_loss: 40967.3082; val_gene_expr_recon_loss: 94852.1038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138350.4219; val_optim_loss: 138350.4219
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9760; val_auprc_score: 0.9975; val_best_acc_score: 0.9833; val_best_f1_score: 0.9910; train_kl_reg_loss: 2609.5078; train_edge_recon_loss: 39873.3609; train_gene_expr_recon_loss: 94777.1026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137259.9714; train_optim_loss: 137259.9714; val_kl_reg_loss: 2540.3031; val_edge_recon_loss: 40246.6511; val_gene_expr_recon_loss: 94830.5284; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137617.4833; val_optim_loss: 137617.4833
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9780; val_auprc_score: 0.9977; val_best_acc_score: 0.9826; val_best_f1_score: 0.9907; train_kl_reg_loss: 2615.8972; train_edge_recon_loss: 39814.9989; train_gene_expr_recon_loss: 94744.4817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137175.3778; train_optim_loss: 137175.3778; val_kl_reg_loss: 2548.0303; val_edge_recon_loss: 41252.9978; val_gene_expr_recon_loss: 94747.4920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138548.5198; val_optim_loss: 138548.5198
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9779; val_auprc_score: 0.9976; val_best_acc_score: 0.9823; val_best_f1_score: 0.9905; train_kl_reg_loss: 2623.1222; train_edge_recon_loss: 39919.2579; train_gene_expr_recon_loss: 94679.5986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137221.9788; train_optim_loss: 137221.9788; val_kl_reg_loss: 2590.0796; val_edge_recon_loss: 40948.7627; val_gene_expr_recon_loss: 94725.7839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138264.6260; val_optim_loss: 138264.6260
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9779; val_auprc_score: 0.9977; val_best_acc_score: 0.9826; val_best_f1_score: 0.9906; train_kl_reg_loss: 2628.9863; train_edge_recon_loss: 39748.9516; train_gene_expr_recon_loss: 94615.9036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136993.8415; train_optim_loss: 136993.8415; val_kl_reg_loss: 2576.8208; val_edge_recon_loss: 41360.8704; val_gene_expr_recon_loss: 94712.5244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138650.2146; val_optim_loss: 138650.2146

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9774; val_auprc_score: 0.9976; val_best_acc_score: 0.9830; val_best_f1_score: 0.9909; train_kl_reg_loss: 2591.3675; train_edge_recon_loss: 39777.5193; train_gene_expr_recon_loss: 94309.1268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136678.0135; train_optim_loss: 136678.0135; val_kl_reg_loss: 2527.3685; val_edge_recon_loss: 41002.2949; val_gene_expr_recon_loss: 94433.5320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137963.1959; val_optim_loss: 137963.1959
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9782; val_auprc_score: 0.9977; val_best_acc_score: 0.9834; val_best_f1_score: 0.9910; train_kl_reg_loss: 2586.6673; train_edge_recon_loss: 39833.9103; train_gene_expr_recon_loss: 94246.7066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136667.2840; train_optim_loss: 136667.2840; val_kl_reg_loss: 2531.1335; val_edge_recon_loss: 40739.5265; val_gene_expr_recon_loss: 94394.5475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137665.2070; val_optim_loss: 137665.2070
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9796; val_auprc_score: 0.9979; val_best_acc_score: 0.9836; val_best_f1_score: 0.9912; train_kl_reg_loss: 2587.1690; train_edge_recon_loss: 39689.9548; train_gene_expr_recon_loss: 94240.7142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136517.8380; train_optim_loss: 136517.8380; val_kl_reg_loss: 2551.4709; val_edge_recon_loss: 40453.6437; val_gene_expr_recon_loss: 94363.4344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137368.5489; val_optim_loss: 137368.5489
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9785; val_auprc_score: 0.9978; val_best_acc_score: 0.9832; val_best_f1_score: 0.9910; train_kl_reg_loss: 2585.2643; train_edge_recon_loss: 39687.4515; train_gene_expr_recon_loss: 94211.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136484.3646; train_optim_loss: 136484.3646; val_kl_reg_loss: 2544.0706; val_edge_recon_loss: 40731.1160; val_gene_expr_recon_loss: 94311.8762; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137587.0624; val_optim_loss: 137587.0624
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9788; val_auprc_score: 0.9977; val_best_acc_score: 0.9837; val_best_f1_score: 0.9912; train_kl_reg_loss: 2586.5182; train_edge_recon_loss: 39752.0889; train_gene_expr_recon_loss: 94242.9858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136581.5929; train_optim_loss: 136581.5929; val_kl_reg_loss: 2557.8535; val_edge_recon_loss: 40925.1033; val_gene_expr_recon_loss: 94300.0714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137783.0278; val_optim_loss: 137783.0278
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9785; val_auprc_score: 0.9977; val_best_acc_score: 0.9836; val_best_f1_score: 0.9912; train_kl_reg_loss: 2584.6994; train_edge_recon_loss: 39616.8170; train_gene_expr_recon_loss: 94199.2863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136400.8030; train_optim_loss: 136400.8030; val_kl_reg_loss: 2545.3993; val_edge_recon_loss: 40749.6500; val_gene_expr_recon_loss: 94260.6971; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137555.7462; val_optim_loss: 137555.7462

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9792; val_auprc_score: 0.9978; val_best_acc_score: 0.9837; val_best_f1_score: 0.9912; train_kl_reg_loss: 2582.7808; train_edge_recon_loss: 39745.6208; train_gene_expr_recon_loss: 94125.3577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136453.7591; train_optim_loss: 136453.7591; val_kl_reg_loss: 2540.1740; val_edge_recon_loss: 40690.6439; val_gene_expr_recon_loss: 94317.5848; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137548.4020; val_optim_loss: 137548.4020
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9787; val_auprc_score: 0.9978; val_best_acc_score: 0.9837; val_best_f1_score: 0.9912; train_kl_reg_loss: 2581.2570; train_edge_recon_loss: 39669.2614; train_gene_expr_recon_loss: 94131.3931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136381.9114; train_optim_loss: 136381.9114; val_kl_reg_loss: 2538.0605; val_edge_recon_loss: 40479.6566; val_gene_expr_recon_loss: 94302.9336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137320.6509; val_optim_loss: 137320.6509
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9783; val_auprc_score: 0.9977; val_best_acc_score: 0.9835; val_best_f1_score: 0.9912; train_kl_reg_loss: 2579.0568; train_edge_recon_loss: 39747.5432; train_gene_expr_recon_loss: 94114.8838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136441.4838; train_optim_loss: 136441.4838; val_kl_reg_loss: 2528.8397; val_edge_recon_loss: 40634.3126; val_gene_expr_recon_loss: 94380.6261; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137543.7783; val_optim_loss: 137543.7783
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9795; val_auprc_score: 0.9979; val_best_acc_score: 0.9836; val_best_f1_score: 0.9912; train_kl_reg_loss: 2579.6963; train_edge_recon_loss: 39785.2273; train_gene_expr_recon_loss: 94114.0171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136478.9407; train_optim_loss: 136478.9407; val_kl_reg_loss: 2528.7528; val_edge_recon_loss: 40658.4833; val_gene_expr_recon_loss: 94313.4512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137500.6871; val_optim_loss: 137500.6871
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9778; val_auprc_score: 0.9976; val_best_acc_score: 0.9831; val_best_f1_score: 0.9909; train_kl_reg_loss: 2579.7242; train_edge_recon_loss: 39717.2995; train_gene_expr_recon_loss: 94133.6124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136430.6361; train_optim_loss: 136430.6361; val_kl_reg_loss: 2541.0807; val_edge_recon_loss: 40966.4975; val_gene_expr_recon_loss: 94353.5003; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137861.0778; val_optim_loss: 137861.0778

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9789; val_auprc_score: 0.9978; val_best_acc_score: 0.9835; val_best_f1_score: 0.9911; train_kl_reg_loss: 2581.0577; train_edge_recon_loss: 39571.2294; train_gene_expr_recon_loss: 94107.7605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136260.0477; train_optim_loss: 136260.0477; val_kl_reg_loss: 2532.7983; val_edge_recon_loss: 40966.7375; val_gene_expr_recon_loss: 94288.7729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137788.3083; val_optim_loss: 137788.3083
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9786; val_auprc_score: 0.9978; val_best_acc_score: 0.9837; val_best_f1_score: 0.9913; train_kl_reg_loss: 2578.6770; train_edge_recon_loss: 39669.2283; train_gene_expr_recon_loss: 94129.8848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136377.7899; train_optim_loss: 136377.7899; val_kl_reg_loss: 2534.5823; val_edge_recon_loss: 40436.3508; val_gene_expr_recon_loss: 94315.2040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137286.1368; val_optim_loss: 137286.1368
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9785; val_auprc_score: 0.9977; val_best_acc_score: 0.9835; val_best_f1_score: 0.9911; train_kl_reg_loss: 2579.7944; train_edge_recon_loss: 39810.2953; train_gene_expr_recon_loss: 94133.8978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136523.9876; train_optim_loss: 136523.9876; val_kl_reg_loss: 2534.3897; val_edge_recon_loss: 40840.3631; val_gene_expr_recon_loss: 94258.7013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137633.4540; val_optim_loss: 137633.4540
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9796; val_auprc_score: 0.9979; val_best_acc_score: 0.9839; val_best_f1_score: 0.9913; train_kl_reg_loss: 2579.9446; train_edge_recon_loss: 39818.6058; train_gene_expr_recon_loss: 94108.9416; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136507.4923; train_optim_loss: 136507.4923; val_kl_reg_loss: 2535.9952; val_edge_recon_loss: 40472.5189; val_gene_expr_recon_loss: 94296.8763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137305.3898; val_optim_loss: 137305.3898
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9786; val_auprc_score: 0.9977; val_best_acc_score: 0.9834; val_best_f1_score: 0.9910; train_kl_reg_loss: 2580.2293; train_edge_recon_loss: 39680.4498; train_gene_expr_recon_loss: 94123.5467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136384.2259; train_optim_loss: 136384.2259; val_kl_reg_loss: 2535.6633; val_edge_recon_loss: 40882.7609; val_gene_expr_recon_loss: 94322.7702; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137741.1942; val_optim_loss: 137741.1942

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9789; val_auprc_score: 0.9977; val_best_acc_score: 0.9836; val_best_f1_score: 0.9912; train_kl_reg_loss: 2580.4883; train_edge_recon_loss: 39785.7849; train_gene_expr_recon_loss: 94129.2804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136495.5534; train_optim_loss: 136495.5534; val_kl_reg_loss: 2535.2769; val_edge_recon_loss: 40965.2174; val_gene_expr_recon_loss: 94364.0872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137864.5823; val_optim_loss: 137864.5823
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9797; val_auprc_score: 0.9979; val_best_acc_score: 0.9838; val_best_f1_score: 0.9913; train_kl_reg_loss: 2580.3911; train_edge_recon_loss: 39714.0432; train_gene_expr_recon_loss: 94098.0598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136392.4940; train_optim_loss: 136392.4940; val_kl_reg_loss: 2535.5037; val_edge_recon_loss: 40567.1677; val_gene_expr_recon_loss: 94325.1994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137427.8710; val_optim_loss: 137427.8710
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9794; val_auprc_score: 0.9979; val_best_acc_score: 0.9834; val_best_f1_score: 0.9911; train_kl_reg_loss: 2580.1661; train_edge_recon_loss: 39600.3565; train_gene_expr_recon_loss: 94122.4351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136302.9579; train_optim_loss: 136302.9579; val_kl_reg_loss: 2535.4547; val_edge_recon_loss: 40832.6939; val_gene_expr_recon_loss: 94288.9370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137657.0859; val_optim_loss: 137657.0859

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 214 min 24 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9785
Val AUPRC score: 0.9977
Val best accuracy score: 0.9834
Val best F1 score: 0.9911
Val gene expr MSE score: 0.7640
Duration of model training in run 2: 3 hours, 36 minutes and 12 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 982152
Number of validation nodes: 109128
Number of training edges: 4503608
Number of validation edges: 500400
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9865; val_auprc_score: 0.9986; val_best_acc_score: 0.9864; val_best_f1_score: 0.9927; train_kl_reg_loss: 2143.9675; train_edge_recon_loss: 40169.6207; train_gene_expr_recon_loss: 105545.9221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 147859.5103; train_optim_loss: 147859.5103; val_kl_reg_loss: 2197.4234; val_edge_recon_loss: 39669.6467; val_gene_expr_recon_loss: 101871.2078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143738.2777; val_optim_loss: 143738.2777
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9891; val_auprc_score: 0.9989; val_best_acc_score: 0.9879; val_best_f1_score: 0.9935; train_kl_reg_loss: 2294.5900; train_edge_recon_loss: 39751.0051; train_gene_expr_recon_loss: 101035.2144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143080.8095; train_optim_loss: 143080.8095; val_kl_reg_loss: 2338.6695; val_edge_recon_loss: 39907.5730; val_gene_expr_recon_loss: 100218.9321; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142465.1748; val_optim_loss: 142465.1748
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9894; val_auprc_score: 0.9989; val_best_acc_score: 0.9883; val_best_f1_score: 0.9937; train_kl_reg_loss: 2373.9607; train_edge_recon_loss: 39748.4124; train_gene_expr_recon_loss: 100013.1563; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142135.5294; train_optim_loss: 142135.5294; val_kl_reg_loss: 2407.2919; val_edge_recon_loss: 39567.7578; val_gene_expr_recon_loss: 99601.6274; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141576.6773; val_optim_loss: 141576.6773
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9898; val_auprc_score: 0.9990; val_best_acc_score: 0.9887; val_best_f1_score: 0.9939; train_kl_reg_loss: 2428.0197; train_edge_recon_loss: 39780.6816; train_gene_expr_recon_loss: 99525.8462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141734.5475; train_optim_loss: 141734.5475; val_kl_reg_loss: 2361.0910; val_edge_recon_loss: 40034.5427; val_gene_expr_recon_loss: 99333.7630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141729.3971; val_optim_loss: 141729.3971
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9898; val_auprc_score: 0.9990; val_best_acc_score: 0.9889; val_best_f1_score: 0.9940; train_kl_reg_loss: 2463.2771; train_edge_recon_loss: 39661.7752; train_gene_expr_recon_loss: 99203.4748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141328.5271; train_optim_loss: 141328.5271; val_kl_reg_loss: 2440.8787; val_edge_recon_loss: 39625.7238; val_gene_expr_recon_loss: 98987.6004; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141054.2031; val_optim_loss: 141054.2031
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9902; val_auprc_score: 0.9990; val_best_acc_score: 0.9892; val_best_f1_score: 0.9942; train_kl_reg_loss: 2487.5122; train_edge_recon_loss: 39689.6193; train_gene_expr_recon_loss: 99025.6244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141202.7559; train_optim_loss: 141202.7559; val_kl_reg_loss: 2489.7419; val_edge_recon_loss: 39908.7321; val_gene_expr_recon_loss: 98877.0379; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141275.5120; val_optim_loss: 141275.5120
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9903; val_auprc_score: 0.9990; val_best_acc_score: 0.9891; val_best_f1_score: 0.9941; train_kl_reg_loss: 2507.6923; train_edge_recon_loss: 39630.6344; train_gene_expr_recon_loss: 98863.0237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141001.3505; train_optim_loss: 141001.3505; val_kl_reg_loss: 2521.6120; val_edge_recon_loss: 39648.0765; val_gene_expr_recon_loss: 98800.2071; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140969.8956; val_optim_loss: 140969.8956
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9906; val_auprc_score: 0.9990; val_best_acc_score: 0.9894; val_best_f1_score: 0.9943; train_kl_reg_loss: 2522.4149; train_edge_recon_loss: 39667.6399; train_gene_expr_recon_loss: 98760.8204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140950.8752; train_optim_loss: 140950.8752; val_kl_reg_loss: 2477.7348; val_edge_recon_loss: 40168.7647; val_gene_expr_recon_loss: 98696.4601; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141342.9592; val_optim_loss: 141342.9592
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9904; val_auprc_score: 0.9991; val_best_acc_score: 0.9897; val_best_f1_score: 0.9945; train_kl_reg_loss: 2534.0392; train_edge_recon_loss: 39662.6758; train_gene_expr_recon_loss: 98667.0979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140863.8128; train_optim_loss: 140863.8128; val_kl_reg_loss: 2507.2305; val_edge_recon_loss: 39312.8661; val_gene_expr_recon_loss: 98572.4393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140392.5360; val_optim_loss: 140392.5360
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9905; val_auprc_score: 0.9990; val_best_acc_score: 0.9895; val_best_f1_score: 0.9943; train_kl_reg_loss: 2544.2488; train_edge_recon_loss: 39713.5864; train_gene_expr_recon_loss: 98589.9627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140847.7980; train_optim_loss: 140847.7980; val_kl_reg_loss: 2546.0882; val_edge_recon_loss: 39745.7157; val_gene_expr_recon_loss: 98542.3081; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140834.1121; val_optim_loss: 140834.1121
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9901; val_auprc_score: 0.9990; val_best_acc_score: 0.9895; val_best_f1_score: 0.9944; train_kl_reg_loss: 2552.0730; train_edge_recon_loss: 39479.9594; train_gene_expr_recon_loss: 98562.5551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140594.5876; train_optim_loss: 140594.5876; val_kl_reg_loss: 2570.7373; val_edge_recon_loss: 39413.4331; val_gene_expr_recon_loss: 98442.3539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140426.5244; val_optim_loss: 140426.5244
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9906; val_auprc_score: 0.9991; val_best_acc_score: 0.9895; val_best_f1_score: 0.9944; train_kl_reg_loss: 2556.2921; train_edge_recon_loss: 39519.7610; train_gene_expr_recon_loss: 98487.2227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140563.2758; train_optim_loss: 140563.2758; val_kl_reg_loss: 2492.3406; val_edge_recon_loss: 39605.4397; val_gene_expr_recon_loss: 98470.5144; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140568.2947; val_optim_loss: 140568.2947

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9914; val_auprc_score: 0.9991; val_best_acc_score: 0.9899; val_best_f1_score: 0.9946; train_kl_reg_loss: 2518.6292; train_edge_recon_loss: 39534.3133; train_gene_expr_recon_loss: 98061.8700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140114.8125; train_optim_loss: 140114.8125; val_kl_reg_loss: 2493.7210; val_edge_recon_loss: 39624.9207; val_gene_expr_recon_loss: 98046.7332; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140165.3750; val_optim_loss: 140165.3750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9912; val_auprc_score: 0.9991; val_best_acc_score: 0.9899; val_best_f1_score: 0.9946; train_kl_reg_loss: 2516.3604; train_edge_recon_loss: 39515.1327; train_gene_expr_recon_loss: 97989.8004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140021.2937; train_optim_loss: 140021.2937; val_kl_reg_loss: 2489.0828; val_edge_recon_loss: 39536.7974; val_gene_expr_recon_loss: 97938.9377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139964.8179; val_optim_loss: 139964.8179
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9911; val_auprc_score: 0.9991; val_best_acc_score: 0.9900; val_best_f1_score: 0.9946; train_kl_reg_loss: 2517.1557; train_edge_recon_loss: 39525.5120; train_gene_expr_recon_loss: 97956.3509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139999.0186; train_optim_loss: 139999.0186; val_kl_reg_loss: 2489.5503; val_edge_recon_loss: 39809.1424; val_gene_expr_recon_loss: 97956.6432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140255.3362; val_optim_loss: 140255.3362
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9917; val_auprc_score: 0.9992; val_best_acc_score: 0.9903; val_best_f1_score: 0.9948; train_kl_reg_loss: 2519.0907; train_edge_recon_loss: 39619.1138; train_gene_expr_recon_loss: 97931.2853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140069.4899; train_optim_loss: 140069.4899; val_kl_reg_loss: 2497.3073; val_edge_recon_loss: 39821.5420; val_gene_expr_recon_loss: 98008.1714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140327.0202; val_optim_loss: 140327.0202
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9915; val_auprc_score: 0.9992; val_best_acc_score: 0.9902; val_best_f1_score: 0.9947; train_kl_reg_loss: 2518.8720; train_edge_recon_loss: 39524.5860; train_gene_expr_recon_loss: 97916.0507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139959.5087; train_optim_loss: 139959.5087; val_kl_reg_loss: 2495.8588; val_edge_recon_loss: 39513.8897; val_gene_expr_recon_loss: 97968.1712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139977.9200; val_optim_loss: 139977.9200

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9916; val_auprc_score: 0.9991; val_best_acc_score: 0.9900; val_best_f1_score: 0.9946; train_kl_reg_loss: 2514.1590; train_edge_recon_loss: 39500.8274; train_gene_expr_recon_loss: 97812.7256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139827.7119; train_optim_loss: 139827.7119; val_kl_reg_loss: 2485.1943; val_edge_recon_loss: 39998.4933; val_gene_expr_recon_loss: 97928.4281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140412.1155; val_optim_loss: 140412.1155
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9913; val_auprc_score: 0.9991; val_best_acc_score: 0.9903; val_best_f1_score: 0.9948; train_kl_reg_loss: 2513.5934; train_edge_recon_loss: 39588.5488; train_gene_expr_recon_loss: 97836.8178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139938.9600; train_optim_loss: 139938.9600; val_kl_reg_loss: 2484.9595; val_edge_recon_loss: 39601.1889; val_gene_expr_recon_loss: 97940.0992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140026.2478; val_optim_loss: 140026.2478
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9917; val_auprc_score: 0.9992; val_best_acc_score: 0.9902; val_best_f1_score: 0.9947; train_kl_reg_loss: 2512.7803; train_edge_recon_loss: 39571.6826; train_gene_expr_recon_loss: 97818.4266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139902.8896; train_optim_loss: 139902.8896; val_kl_reg_loss: 2485.1067; val_edge_recon_loss: 39543.8285; val_gene_expr_recon_loss: 97898.8777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139927.8130; val_optim_loss: 139927.8130
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9916; val_auprc_score: 0.9992; val_best_acc_score: 0.9901; val_best_f1_score: 0.9947; train_kl_reg_loss: 2512.9069; train_edge_recon_loss: 39489.4590; train_gene_expr_recon_loss: 97830.7329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139833.0989; train_optim_loss: 139833.0989; val_kl_reg_loss: 2489.7961; val_edge_recon_loss: 39618.0481; val_gene_expr_recon_loss: 97889.1323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139996.9769; val_optim_loss: 139996.9769
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9914; val_auprc_score: 0.9991; val_best_acc_score: 0.9901; val_best_f1_score: 0.9946; train_kl_reg_loss: 2512.2790; train_edge_recon_loss: 39531.1392; train_gene_expr_recon_loss: 97819.3733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139862.7914; train_optim_loss: 139862.7914; val_kl_reg_loss: 2483.5705; val_edge_recon_loss: 39951.6404; val_gene_expr_recon_loss: 97886.3489; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140321.5597; val_optim_loss: 140321.5597
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9918; val_auprc_score: 0.9992; val_best_acc_score: 0.9901; val_best_f1_score: 0.9947; train_kl_reg_loss: 2513.2106; train_edge_recon_loss: 39558.5188; train_gene_expr_recon_loss: 97822.8198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139894.5492; train_optim_loss: 139894.5492; val_kl_reg_loss: 2488.7626; val_edge_recon_loss: 39611.9803; val_gene_expr_recon_loss: 97952.5957; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140053.3387; val_optim_loss: 140053.3387

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9915; val_auprc_score: 0.9992; val_best_acc_score: 0.9903; val_best_f1_score: 0.9948; train_kl_reg_loss: 2511.7593; train_edge_recon_loss: 39356.7896; train_gene_expr_recon_loss: 97821.4460; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139689.9948; train_optim_loss: 139689.9948; val_kl_reg_loss: 2482.0783; val_edge_recon_loss: 39308.7473; val_gene_expr_recon_loss: 97902.5648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139693.3905; val_optim_loss: 139693.3905
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9916; val_auprc_score: 0.9992; val_best_acc_score: 0.9903; val_best_f1_score: 0.9948; train_kl_reg_loss: 2511.8970; train_edge_recon_loss: 39526.5498; train_gene_expr_recon_loss: 97814.5890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139853.0357; train_optim_loss: 139853.0357; val_kl_reg_loss: 2482.8002; val_edge_recon_loss: 39558.0986; val_gene_expr_recon_loss: 97897.7685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139938.6672; val_optim_loss: 139938.6672
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9916; val_auprc_score: 0.9992; val_best_acc_score: 0.9902; val_best_f1_score: 0.9947; train_kl_reg_loss: 2512.0101; train_edge_recon_loss: 39568.7640; train_gene_expr_recon_loss: 97801.2398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139882.0139; train_optim_loss: 139882.0139; val_kl_reg_loss: 2482.5347; val_edge_recon_loss: 39338.5989; val_gene_expr_recon_loss: 97897.0793; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139718.2129; val_optim_loss: 139718.2129
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9912; val_auprc_score: 0.9991; val_best_acc_score: 0.9902; val_best_f1_score: 0.9947; train_kl_reg_loss: 2511.4749; train_edge_recon_loss: 39508.0016; train_gene_expr_recon_loss: 97803.7033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139823.1799; train_optim_loss: 139823.1799; val_kl_reg_loss: 2483.4980; val_edge_recon_loss: 39639.7748; val_gene_expr_recon_loss: 97914.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140037.8898; val_optim_loss: 140037.8898

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9917; val_auprc_score: 0.9992; val_best_acc_score: 0.9903; val_best_f1_score: 0.9948; train_kl_reg_loss: 2511.9882; train_edge_recon_loss: 39479.5163; train_gene_expr_recon_loss: 97809.1862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139800.6907; train_optim_loss: 139800.6907; val_kl_reg_loss: 2483.8191; val_edge_recon_loss: 39579.9529; val_gene_expr_recon_loss: 97927.9483; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139991.7204; val_optim_loss: 139991.7204
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9919; val_auprc_score: 0.9992; val_best_acc_score: 0.9901; val_best_f1_score: 0.9946; train_kl_reg_loss: 2512.0122; train_edge_recon_loss: 39534.9873; train_gene_expr_recon_loss: 97816.5757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139863.5752; train_optim_loss: 139863.5752; val_kl_reg_loss: 2483.5727; val_edge_recon_loss: 39594.1216; val_gene_expr_recon_loss: 97954.2642; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140031.9586; val_optim_loss: 140031.9586
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9920; val_auprc_score: 0.9992; val_best_acc_score: 0.9904; val_best_f1_score: 0.9948; train_kl_reg_loss: 2511.5732; train_edge_recon_loss: 39324.1531; train_gene_expr_recon_loss: 97796.0186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139631.7449; train_optim_loss: 139631.7449; val_kl_reg_loss: 2482.8586; val_edge_recon_loss: 39372.5637; val_gene_expr_recon_loss: 97928.4046; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139783.8265; val_optim_loss: 139783.8265
First script finished. Launching follow up script.
Run timestamp: 03062023_011924.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '2048', '2048', '1024', '1024', '512', '512', '256', '256', '128', '128', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'Main_molecular_cell_type', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'starmap_plus_mouse_cns_subsample_1pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', 'batch9', 'batch10', 'batch11', 'batch12', 'batch13', 'batch14', 'batch15', 'batch16', 'batch17', 'batch18', 'batch19', 'batch20', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 9813
Number of validation nodes: 1090
Number of training edges: 23576
Number of validation edges: 2619
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8245; val_auprc_score: 0.9799; val_best_acc_score: 0.9335; val_best_f1_score: 0.9650; train_kl_reg_loss: 416.4012; train_edge_recon_loss: 50101.0449; train_gene_expr_recon_loss: 137298.5977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187816.0443; train_optim_loss: 187816.0443; val_kl_reg_loss: 582.6028; val_edge_recon_loss: 59716.2227; val_gene_expr_recon_loss: 119482.3555; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179781.1797; val_optim_loss: 179781.1797
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7924; val_auprc_score: 0.9775; val_best_acc_score: 0.9370; val_best_f1_score: 0.9671; train_kl_reg_loss: 422.3226; train_edge_recon_loss: 48732.4788; train_gene_expr_recon_loss: 114243.7122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163398.5117; train_optim_loss: 163398.5117; val_kl_reg_loss: 398.1467; val_edge_recon_loss: 52130.3105; val_gene_expr_recon_loss: 111555.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164084.1172; val_optim_loss: 164084.1172
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7811; val_auprc_score: 0.9701; val_best_acc_score: 0.9365; val_best_f1_score: 0.9664; train_kl_reg_loss: 566.4603; train_edge_recon_loss: 51551.5658; train_gene_expr_recon_loss: 111295.1576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163413.1836; train_optim_loss: 163413.1836; val_kl_reg_loss: 668.7576; val_edge_recon_loss: 52791.1719; val_gene_expr_recon_loss: 110102.7148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163562.6406; val_optim_loss: 163562.6406
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7347; val_auprc_score: 0.9628; val_best_acc_score: 0.9325; val_best_f1_score: 0.9646; train_kl_reg_loss: 1262.6396; train_edge_recon_loss: 48468.4421; train_gene_expr_recon_loss: 110333.6725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160064.7539; train_optim_loss: 160064.7539; val_kl_reg_loss: 1714.2527; val_edge_recon_loss: 52085.4160; val_gene_expr_recon_loss: 111554.7227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165354.3906; val_optim_loss: 165354.3906
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7375; val_auprc_score: 0.9622; val_best_acc_score: 0.9345; val_best_f1_score: 0.9655; train_kl_reg_loss: 1709.9238; train_edge_recon_loss: 45367.5137; train_gene_expr_recon_loss: 109134.4486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 156211.8867; train_optim_loss: 156211.8867; val_kl_reg_loss: 1353.9184; val_edge_recon_loss: 47101.2324; val_gene_expr_recon_loss: 105693.4648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154148.6172; val_optim_loss: 154148.6172
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7763; val_auprc_score: 0.9701; val_best_acc_score: 0.9467; val_best_f1_score: 0.9720; train_kl_reg_loss: 1456.5424; train_edge_recon_loss: 44966.8060; train_gene_expr_recon_loss: 108732.0573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155155.4049; train_optim_loss: 155155.4049; val_kl_reg_loss: 1561.7964; val_edge_recon_loss: 37114.1631; val_gene_expr_recon_loss: 113089.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 151765.7188; val_optim_loss: 151765.7188
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7491; val_auprc_score: 0.9615; val_best_acc_score: 0.9390; val_best_f1_score: 0.9679; train_kl_reg_loss: 1622.3288; train_edge_recon_loss: 44234.7018; train_gene_expr_recon_loss: 108147.4447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154004.4766; train_optim_loss: 154004.4766; val_kl_reg_loss: 1505.8857; val_edge_recon_loss: 44836.5801; val_gene_expr_recon_loss: 110755.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157097.9219; val_optim_loss: 157097.9219
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7864; val_auprc_score: 0.9678; val_best_acc_score: 0.9447; val_best_f1_score: 0.9707; train_kl_reg_loss: 1571.3408; train_edge_recon_loss: 44727.6930; train_gene_expr_recon_loss: 108150.6380; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154449.6745; train_optim_loss: 154449.6745; val_kl_reg_loss: 1607.1122; val_edge_recon_loss: 44369.8223; val_gene_expr_recon_loss: 103490.1992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 149467.1406; val_optim_loss: 149467.1406
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7354; val_auprc_score: 0.9567; val_best_acc_score: 0.9345; val_best_f1_score: 0.9656; train_kl_reg_loss: 1713.9785; train_edge_recon_loss: 43665.2402; train_gene_expr_recon_loss: 107627.7363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153006.9570; train_optim_loss: 153006.9570; val_kl_reg_loss: 1787.1752; val_edge_recon_loss: 46782.6953; val_gene_expr_recon_loss: 114045.5039; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162615.3672; val_optim_loss: 162615.3672
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7244; val_auprc_score: 0.9598; val_best_acc_score: 0.9288; val_best_f1_score: 0.9628; train_kl_reg_loss: 1744.8813; train_edge_recon_loss: 42930.7949; train_gene_expr_recon_loss: 107402.8294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152078.5039; train_optim_loss: 152078.5039; val_kl_reg_loss: 1672.1923; val_edge_recon_loss: 48068.3340; val_gene_expr_recon_loss: 109469.3164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159209.8438; val_optim_loss: 159209.8438
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7392; val_auprc_score: 0.9628; val_best_acc_score: 0.9372; val_best_f1_score: 0.9673; train_kl_reg_loss: 1642.7303; train_edge_recon_loss: 42540.2337; train_gene_expr_recon_loss: 106910.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 151093.2682; train_optim_loss: 151093.2682; val_kl_reg_loss: 1607.6479; val_edge_recon_loss: 39044.9795; val_gene_expr_recon_loss: 109682.3320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 150334.9531; val_optim_loss: 150334.9531

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8214; val_auprc_score: 0.9796; val_best_acc_score: 0.9408; val_best_f1_score: 0.9689; train_kl_reg_loss: 1668.5300; train_edge_recon_loss: 42811.8089; train_gene_expr_recon_loss: 106884.0664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 151364.4062; train_optim_loss: 151364.4062; val_kl_reg_loss: 1628.2518; val_edge_recon_loss: 40083.0039; val_gene_expr_recon_loss: 101761.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143472.5234; val_optim_loss: 143472.5234
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7897; val_auprc_score: 0.9704; val_best_acc_score: 0.9320; val_best_f1_score: 0.9643; train_kl_reg_loss: 1711.4287; train_edge_recon_loss: 43642.7340; train_gene_expr_recon_loss: 106625.3770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 151979.5391; train_optim_loss: 151979.5391; val_kl_reg_loss: 1625.3858; val_edge_recon_loss: 46035.7246; val_gene_expr_recon_loss: 106576.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154237.4766; val_optim_loss: 154237.4766
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7558; val_auprc_score: 0.9603; val_best_acc_score: 0.9365; val_best_f1_score: 0.9666; train_kl_reg_loss: 1699.5016; train_edge_recon_loss: 43928.9463; train_gene_expr_recon_loss: 106700.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152328.6966; train_optim_loss: 152328.6966; val_kl_reg_loss: 1641.2874; val_edge_recon_loss: 45138.6758; val_gene_expr_recon_loss: 109561.2695; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156341.2344; val_optim_loss: 156341.2344
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7749; val_auprc_score: 0.9709; val_best_acc_score: 0.9349; val_best_f1_score: 0.9659; train_kl_reg_loss: 1693.4120; train_edge_recon_loss: 42436.5758; train_gene_expr_recon_loss: 106575.6868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 150705.6758; train_optim_loss: 150705.6758; val_kl_reg_loss: 1682.7125; val_edge_recon_loss: 43202.7812; val_gene_expr_recon_loss: 104234.5195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 149120.0078; val_optim_loss: 149120.0078

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7812; val_auprc_score: 0.9701; val_best_acc_score: 0.9425; val_best_f1_score: 0.9698; train_kl_reg_loss: 1700.0810; train_edge_recon_loss: 45086.2288; train_gene_expr_recon_loss: 106469.1582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153255.4701; train_optim_loss: 153255.4701; val_kl_reg_loss: 1650.8428; val_edge_recon_loss: 42369.2988; val_gene_expr_recon_loss: 108467.1445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152487.2891; val_optim_loss: 152487.2891
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.7745; val_auprc_score: 0.9659; val_best_acc_score: 0.9338; val_best_f1_score: 0.9651; train_kl_reg_loss: 1702.2225; train_edge_recon_loss: 44633.3844; train_gene_expr_recon_loss: 106645.5931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152981.2018; train_optim_loss: 152981.2018; val_kl_reg_loss: 1672.6487; val_edge_recon_loss: 48152.7500; val_gene_expr_recon_loss: 111299.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161125.1406; val_optim_loss: 161125.1406
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.7621; val_auprc_score: 0.9626; val_best_acc_score: 0.9327; val_best_f1_score: 0.9644; train_kl_reg_loss: 1698.3786; train_edge_recon_loss: 43951.7786; train_gene_expr_recon_loss: 106708.3262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152358.4831; train_optim_loss: 152358.4831; val_kl_reg_loss: 1672.4816; val_edge_recon_loss: 51118.3242; val_gene_expr_recon_loss: 109909.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162700.3281; val_optim_loss: 162700.3281

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 28 sec.
Using best model state, which was in epoch 12.

--- MODEL EVALUATION ---
Val AUROC score: 0.8078
Val AUPRC score: 0.9720
Val best accuracy score: 0.9318
Val best F1 score: 0.9641
Val gene expr MSE score: 1.3919
Duration of model training in run 1: 0 hours, 0 minutes and 35 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 9813
Number of validation nodes: 1090
Number of training edges: 23576
Number of validation edges: 2619
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8406; val_auprc_score: 0.9800; val_best_acc_score: 0.9306; val_best_f1_score: 0.9637; train_kl_reg_loss: 430.3924; train_edge_recon_loss: 50022.7933; train_gene_expr_recon_loss: 141933.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192386.3672; train_optim_loss: 192386.3672; val_kl_reg_loss: 602.7238; val_edge_recon_loss: 65917.1562; val_gene_expr_recon_loss: 125001.6367; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191521.5156; val_optim_loss: 191521.5156
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7938; val_auprc_score: 0.9791; val_best_acc_score: 0.9413; val_best_f1_score: 0.9694; train_kl_reg_loss: 399.8138; train_edge_recon_loss: 51283.3480; train_gene_expr_recon_loss: 116176.9714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167860.1328; train_optim_loss: 167860.1328; val_kl_reg_loss: 420.1451; val_edge_recon_loss: 49742.9531; val_gene_expr_recon_loss: 113928.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164091.1328; val_optim_loss: 164091.1328
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7591; val_auprc_score: 0.9719; val_best_acc_score: 0.9470; val_best_f1_score: 0.9723; train_kl_reg_loss: 521.1053; train_edge_recon_loss: 49244.3551; train_gene_expr_recon_loss: 111762.3991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161527.8568; train_optim_loss: 161527.8568; val_kl_reg_loss: 547.5408; val_edge_recon_loss: 41717.2754; val_gene_expr_recon_loss: 111995.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154260.6641; val_optim_loss: 154260.6641
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7217; val_auprc_score: 0.9635; val_best_acc_score: 0.9324; val_best_f1_score: 0.9645; train_kl_reg_loss: 956.7634; train_edge_recon_loss: 49145.3486; train_gene_expr_recon_loss: 110218.1706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160320.2812; train_optim_loss: 160320.2812; val_kl_reg_loss: 1516.5595; val_edge_recon_loss: 48612.9531; val_gene_expr_recon_loss: 111373.0430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161502.5625; val_optim_loss: 161502.5625
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7806; val_auprc_score: 0.9677; val_best_acc_score: 0.9336; val_best_f1_score: 0.9649; train_kl_reg_loss: 1578.4967; train_edge_recon_loss: 47152.9733; train_gene_expr_recon_loss: 109146.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157878.1602; train_optim_loss: 157878.1602; val_kl_reg_loss: 1488.9213; val_edge_recon_loss: 49154.8789; val_gene_expr_recon_loss: 112517.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163161.4688; val_optim_loss: 163161.4688
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7852; val_auprc_score: 0.9717; val_best_acc_score: 0.9439; val_best_f1_score: 0.9703; train_kl_reg_loss: 1569.1068; train_edge_recon_loss: 46065.4622; train_gene_expr_recon_loss: 108792.3483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 156426.9154; train_optim_loss: 156426.9154; val_kl_reg_loss: 1738.8093; val_edge_recon_loss: 44661.1270; val_gene_expr_recon_loss: 108521.5039; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154921.4453; val_optim_loss: 154921.4453

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7748; val_auprc_score: 0.9708; val_best_acc_score: 0.9453; val_best_f1_score: 0.9713; train_kl_reg_loss: 1699.3041; train_edge_recon_loss: 45945.0387; train_gene_expr_recon_loss: 108188.2585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155832.6003; train_optim_loss: 155832.6003; val_kl_reg_loss: 1614.3950; val_edge_recon_loss: 41983.8652; val_gene_expr_recon_loss: 111099.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154698.1562; val_optim_loss: 154698.1562
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7240; val_auprc_score: 0.9599; val_best_acc_score: 0.9409; val_best_f1_score: 0.9689; train_kl_reg_loss: 1634.5989; train_edge_recon_loss: 46145.3070; train_gene_expr_recon_loss: 108125.7064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155905.6120; train_optim_loss: 155905.6120; val_kl_reg_loss: 1602.3068; val_edge_recon_loss: 44754.7402; val_gene_expr_recon_loss: 110449.5977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156806.6484; val_optim_loss: 156806.6484
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7468; val_auprc_score: 0.9609; val_best_acc_score: 0.9408; val_best_f1_score: 0.9688; train_kl_reg_loss: 1659.1622; train_edge_recon_loss: 44670.5433; train_gene_expr_recon_loss: 108080.3092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154410.0169; train_optim_loss: 154410.0169; val_kl_reg_loss: 1538.0770; val_edge_recon_loss: 44315.7188; val_gene_expr_recon_loss: 108375.9648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154229.7578; val_optim_loss: 154229.7578
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7666; val_auprc_score: 0.9667; val_best_acc_score: 0.9384; val_best_f1_score: 0.9674; train_kl_reg_loss: 1591.7562; train_edge_recon_loss: 45060.3799; train_gene_expr_recon_loss: 108206.8639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154859.0000; train_optim_loss: 154859.0000; val_kl_reg_loss: 1537.6938; val_edge_recon_loss: 44619.1855; val_gene_expr_recon_loss: 113041.0508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159197.9297; val_optim_loss: 159197.9297
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7648; val_auprc_score: 0.9614; val_best_acc_score: 0.9361; val_best_f1_score: 0.9660; train_kl_reg_loss: 1605.9151; train_edge_recon_loss: 46060.1689; train_gene_expr_recon_loss: 107707.4056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155373.4922; train_optim_loss: 155373.4922; val_kl_reg_loss: 1529.1293; val_edge_recon_loss: 50118.3809; val_gene_expr_recon_loss: 110141.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161788.5938; val_optim_loss: 161788.5938
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7679; val_auprc_score: 0.9656; val_best_acc_score: 0.9424; val_best_f1_score: 0.9694; train_kl_reg_loss: 1614.4640; train_edge_recon_loss: 44326.2259; train_gene_expr_recon_loss: 107921.4590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153862.1484; train_optim_loss: 153862.1484; val_kl_reg_loss: 1564.0770; val_edge_recon_loss: 43701.2852; val_gene_expr_recon_loss: 107869.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153135.0938; val_optim_loss: 153135.0938
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7664; val_auprc_score: 0.9677; val_best_acc_score: 0.9434; val_best_f1_score: 0.9702; train_kl_reg_loss: 1600.7786; train_edge_recon_loss: 44317.3040; train_gene_expr_recon_loss: 107855.0365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153773.1185; train_optim_loss: 153773.1185; val_kl_reg_loss: 1503.5844; val_edge_recon_loss: 46938.6621; val_gene_expr_recon_loss: 110906.6602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159348.9062; val_optim_loss: 159348.9062
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7473; val_auprc_score: 0.9590; val_best_acc_score: 0.9383; val_best_f1_score: 0.9673; train_kl_reg_loss: 1575.2398; train_edge_recon_loss: 44858.0719; train_gene_expr_recon_loss: 107686.7910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154120.1055; train_optim_loss: 154120.1055; val_kl_reg_loss: 1582.4922; val_edge_recon_loss: 45251.7246; val_gene_expr_recon_loss: 112565.4570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159399.6797; val_optim_loss: 159399.6797
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7499; val_auprc_score: 0.9677; val_best_acc_score: 0.9471; val_best_f1_score: 0.9722; train_kl_reg_loss: 1576.7828; train_edge_recon_loss: 43884.8473; train_gene_expr_recon_loss: 107709.4154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153171.0430; train_optim_loss: 153171.0430; val_kl_reg_loss: 1530.5266; val_edge_recon_loss: 42704.8789; val_gene_expr_recon_loss: 108815.9023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153051.3047; val_optim_loss: 153051.3047
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7478; val_auprc_score: 0.9630; val_best_acc_score: 0.9366; val_best_f1_score: 0.9666; train_kl_reg_loss: 1585.8089; train_edge_recon_loss: 44185.4671; train_gene_expr_recon_loss: 107341.1191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153112.3932; train_optim_loss: 153112.3932; val_kl_reg_loss: 1501.9835; val_edge_recon_loss: 45965.6465; val_gene_expr_recon_loss: 106466.7539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153934.3750; val_optim_loss: 153934.3750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.7637; val_auprc_score: 0.9651; val_best_acc_score: 0.9402; val_best_f1_score: 0.9685; train_kl_reg_loss: 1582.7152; train_edge_recon_loss: 43964.5938; train_gene_expr_recon_loss: 107270.3424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152817.6497; train_optim_loss: 152817.6497; val_kl_reg_loss: 1564.7283; val_edge_recon_loss: 43617.1562; val_gene_expr_recon_loss: 112026.4727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157208.3594; val_optim_loss: 157208.3594
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.7661; val_auprc_score: 0.9674; val_best_acc_score: 0.9447; val_best_f1_score: 0.9709; train_kl_reg_loss: 1629.7670; train_edge_recon_loss: 44907.2116; train_gene_expr_recon_loss: 107625.8685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154162.8464; train_optim_loss: 154162.8464; val_kl_reg_loss: 1615.9894; val_edge_recon_loss: 43779.0352; val_gene_expr_recon_loss: 110703.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156098.4688; val_optim_loss: 156098.4688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.7816; val_auprc_score: 0.9650; val_best_acc_score: 0.9324; val_best_f1_score: 0.9643; train_kl_reg_loss: 1638.5616; train_edge_recon_loss: 44653.8047; train_gene_expr_recon_loss: 107727.8932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154020.2591; train_optim_loss: 154020.2591; val_kl_reg_loss: 1548.7345; val_edge_recon_loss: 49807.8008; val_gene_expr_recon_loss: 109355.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160712.4609; val_optim_loss: 160712.4609
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.7938; val_auprc_score: 0.9715; val_best_acc_score: 0.9405; val_best_f1_score: 0.9686; train_kl_reg_loss: 1634.2725; train_edge_recon_loss: 43648.5244; train_gene_expr_recon_loss: 107564.1680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152846.9661; train_optim_loss: 152846.9661; val_kl_reg_loss: 1581.1949; val_edge_recon_loss: 39526.5293; val_gene_expr_recon_loss: 113029.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154137.4062; val_optim_loss: 154137.4062
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.7372; val_auprc_score: 0.9563; val_best_acc_score: 0.9315; val_best_f1_score: 0.9638; train_kl_reg_loss: 1638.3516; train_edge_recon_loss: 45225.4521; train_gene_expr_recon_loss: 107603.8359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154467.6393; train_optim_loss: 154467.6393; val_kl_reg_loss: 1580.3092; val_edge_recon_loss: 54107.0234; val_gene_expr_recon_loss: 111526.7539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167214.0859; val_optim_loss: 167214.0859

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 30 sec.
Using best model state, which was in epoch 15.

--- MODEL EVALUATION ---
Val AUROC score: 0.7397
Val AUPRC score: 0.9611
Val best accuracy score: 0.9417
Val best F1 score: 0.9693
Val gene expr MSE score: 1.3750
Duration of model training in run 2: 0 hours, 0 minutes and 32 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 9813
Number of validation nodes: 1090
Number of training edges: 45787
Number of validation edges: 5087
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8012; val_auprc_score: 0.9740; val_best_acc_score: 0.9385; val_best_f1_score: 0.9675; train_kl_reg_loss: 519.7044; train_edge_recon_loss: 51288.0042; train_gene_expr_recon_loss: 120484.8790; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172292.5875; train_optim_loss: 172292.5875; val_kl_reg_loss: 888.7042; val_edge_recon_loss: 51975.7438; val_gene_expr_recon_loss: 111895.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164760.1344; val_optim_loss: 164760.1344
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7694; val_auprc_score: 0.9665; val_best_acc_score: 0.9360; val_best_f1_score: 0.9662; train_kl_reg_loss: 1453.4720; train_edge_recon_loss: 47506.7373; train_gene_expr_recon_loss: 110373.7349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159333.9441; train_optim_loss: 159333.9441; val_kl_reg_loss: 1482.6723; val_edge_recon_loss: 50741.4062; val_gene_expr_recon_loss: 110941.3766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163165.4531; val_optim_loss: 163165.4531
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7985; val_auprc_score: 0.9726; val_best_acc_score: 0.9471; val_best_f1_score: 0.9722; train_kl_reg_loss: 1530.2668; train_edge_recon_loss: 44245.1343; train_gene_expr_recon_loss: 109058.8568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154834.2580; train_optim_loss: 154834.2580; val_kl_reg_loss: 1797.5517; val_edge_recon_loss: 40390.4137; val_gene_expr_recon_loss: 110008.4719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152196.4375; val_optim_loss: 152196.4375
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7736; val_auprc_score: 0.9678; val_best_acc_score: 0.9442; val_best_f1_score: 0.9707; train_kl_reg_loss: 1672.9687; train_edge_recon_loss: 43067.6607; train_gene_expr_recon_loss: 108364.1795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153104.8073; train_optim_loss: 153104.8073; val_kl_reg_loss: 1771.6783; val_edge_recon_loss: 42233.2102; val_gene_expr_recon_loss: 108063.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152068.6938; val_optim_loss: 152068.6938
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8046; val_auprc_score: 0.9713; val_best_acc_score: 0.9431; val_best_f1_score: 0.9698; train_kl_reg_loss: 1717.0015; train_edge_recon_loss: 44427.6883; train_gene_expr_recon_loss: 107557.2552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153701.9455; train_optim_loss: 153701.9455; val_kl_reg_loss: 1597.5695; val_edge_recon_loss: 44388.4797; val_gene_expr_recon_loss: 108267.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154253.8906; val_optim_loss: 154253.8906
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8082; val_auprc_score: 0.9713; val_best_acc_score: 0.9464; val_best_f1_score: 0.9716; train_kl_reg_loss: 1637.1740; train_edge_recon_loss: 43948.5943; train_gene_expr_recon_loss: 107346.7066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152932.4747; train_optim_loss: 152932.4747; val_kl_reg_loss: 1673.3398; val_edge_recon_loss: 42442.0281; val_gene_expr_recon_loss: 107736.3500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 151851.7219; val_optim_loss: 151851.7219
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8131; val_auprc_score: 0.9740; val_best_acc_score: 0.9461; val_best_f1_score: 0.9716; train_kl_reg_loss: 1676.0962; train_edge_recon_loss: 43639.0158; train_gene_expr_recon_loss: 107043.6715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152358.7837; train_optim_loss: 152358.7837; val_kl_reg_loss: 1659.9787; val_edge_recon_loss: 44150.3906; val_gene_expr_recon_loss: 109277.3719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155087.7406; val_optim_loss: 155087.7406
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8366; val_auprc_score: 0.9807; val_best_acc_score: 0.9500; val_best_f1_score: 0.9735; train_kl_reg_loss: 1717.5614; train_edge_recon_loss: 43212.5518; train_gene_expr_recon_loss: 106744.6420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 151674.7559; train_optim_loss: 151674.7559; val_kl_reg_loss: 1710.0616; val_edge_recon_loss: 41216.7574; val_gene_expr_recon_loss: 107561.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 150487.9781; val_optim_loss: 150487.9781
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8617; val_auprc_score: 0.9833; val_best_acc_score: 0.9559; val_best_f1_score: 0.9768; train_kl_reg_loss: 1758.4049; train_edge_recon_loss: 43089.5628; train_gene_expr_recon_loss: 106056.2231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 150904.1934; train_optim_loss: 150904.1934; val_kl_reg_loss: 1806.0651; val_edge_recon_loss: 39091.3371; val_gene_expr_recon_loss: 107483.1859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148380.5875; val_optim_loss: 148380.5875
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8843; val_auprc_score: 0.9867; val_best_acc_score: 0.9523; val_best_f1_score: 0.9748; train_kl_reg_loss: 1817.8514; train_edge_recon_loss: 42642.7503; train_gene_expr_recon_loss: 105783.6217; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 150244.2222; train_optim_loss: 150244.2222; val_kl_reg_loss: 1821.3918; val_edge_recon_loss: 42130.7281; val_gene_expr_recon_loss: 105267.9656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 149220.0906; val_optim_loss: 149220.0906
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8867; val_auprc_score: 0.9868; val_best_acc_score: 0.9504; val_best_f1_score: 0.9736; train_kl_reg_loss: 1755.8690; train_edge_recon_loss: 41333.2391; train_gene_expr_recon_loss: 105384.5380; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 148473.6472; train_optim_loss: 148473.6472; val_kl_reg_loss: 1734.3166; val_edge_recon_loss: 44720.5148; val_gene_expr_recon_loss: 106385.6125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152840.4406; val_optim_loss: 152840.4406
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9065; val_auprc_score: 0.9883; val_best_acc_score: 0.9530; val_best_f1_score: 0.9749; train_kl_reg_loss: 1851.3905; train_edge_recon_loss: 43246.0380; train_gene_expr_recon_loss: 105039.5418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 150136.9701; train_optim_loss: 150136.9701; val_kl_reg_loss: 1845.5230; val_edge_recon_loss: 44524.0703; val_gene_expr_recon_loss: 106169.6031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152539.1969; val_optim_loss: 152539.1969

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9073; val_auprc_score: 0.9891; val_best_acc_score: 0.9555; val_best_f1_score: 0.9764; train_kl_reg_loss: 1895.9812; train_edge_recon_loss: 40996.8417; train_gene_expr_recon_loss: 104587.3521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 147480.1743; train_optim_loss: 147480.1743; val_kl_reg_loss: 1855.5360; val_edge_recon_loss: 41921.9086; val_gene_expr_recon_loss: 105965.4031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 149742.8500; val_optim_loss: 149742.8500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9171; val_auprc_score: 0.9899; val_best_acc_score: 0.9605; val_best_f1_score: 0.9791; train_kl_reg_loss: 1917.8847; train_edge_recon_loss: 41627.2431; train_gene_expr_recon_loss: 104068.1300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 147613.2576; train_optim_loss: 147613.2576; val_kl_reg_loss: 1869.9278; val_edge_recon_loss: 38410.2469; val_gene_expr_recon_loss: 105709.9719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145990.1469; val_optim_loss: 145990.1469
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9274; val_auprc_score: 0.9929; val_best_acc_score: 0.9625; val_best_f1_score: 0.9801; train_kl_reg_loss: 1910.7524; train_edge_recon_loss: 40860.0251; train_gene_expr_recon_loss: 103709.5967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146480.3750; train_optim_loss: 146480.3750; val_kl_reg_loss: 1858.2290; val_edge_recon_loss: 37479.3297; val_gene_expr_recon_loss: 104159.5922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143497.1531; val_optim_loss: 143497.1531
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9291; val_auprc_score: 0.9925; val_best_acc_score: 0.9571; val_best_f1_score: 0.9772; train_kl_reg_loss: 1877.0663; train_edge_recon_loss: 40914.2883; train_gene_expr_recon_loss: 103914.8325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146706.1882; train_optim_loss: 146706.1882; val_kl_reg_loss: 1844.8420; val_edge_recon_loss: 41380.5133; val_gene_expr_recon_loss: 105596.3344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148821.6875; val_optim_loss: 148821.6875
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9111; val_auprc_score: 0.9893; val_best_acc_score: 0.9588; val_best_f1_score: 0.9781; train_kl_reg_loss: 1908.4392; train_edge_recon_loss: 40234.5728; train_gene_expr_recon_loss: 103663.5365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145806.5472; train_optim_loss: 145806.5472; val_kl_reg_loss: 1912.2713; val_edge_recon_loss: 40965.1836; val_gene_expr_recon_loss: 104575.5734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147453.0281; val_optim_loss: 147453.0281
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9229; val_auprc_score: 0.9893; val_best_acc_score: 0.9604; val_best_f1_score: 0.9789; train_kl_reg_loss: 1938.6598; train_edge_recon_loss: 42102.4192; train_gene_expr_recon_loss: 103592.9809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 147634.0583; train_optim_loss: 147634.0583; val_kl_reg_loss: 1911.9922; val_edge_recon_loss: 41115.3789; val_gene_expr_recon_loss: 106336.6984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 149364.0688; val_optim_loss: 149364.0688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9164; val_auprc_score: 0.9911; val_best_acc_score: 0.9591; val_best_f1_score: 0.9784; train_kl_reg_loss: 1945.9303; train_edge_recon_loss: 40132.8113; train_gene_expr_recon_loss: 103757.8719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145836.6146; train_optim_loss: 145836.6146; val_kl_reg_loss: 1899.1244; val_edge_recon_loss: 39459.0469; val_gene_expr_recon_loss: 104922.9734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146281.1437; val_optim_loss: 146281.1437
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9155; val_auprc_score: 0.9909; val_best_acc_score: 0.9568; val_best_f1_score: 0.9771; train_kl_reg_loss: 1939.3400; train_edge_recon_loss: 41552.5336; train_gene_expr_recon_loss: 103688.5658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 147180.4406; train_optim_loss: 147180.4406; val_kl_reg_loss: 1883.6359; val_edge_recon_loss: 40791.3883; val_gene_expr_recon_loss: 103954.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146629.8531; val_optim_loss: 146629.8531
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9187; val_auprc_score: 0.9881; val_best_acc_score: 0.9592; val_best_f1_score: 0.9782; train_kl_reg_loss: 1931.8641; train_edge_recon_loss: 42275.7110; train_gene_expr_recon_loss: 103541.1852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 147748.7601; train_optim_loss: 147748.7601; val_kl_reg_loss: 1896.7645; val_edge_recon_loss: 42424.1766; val_gene_expr_recon_loss: 105283.9906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 149604.9312; val_optim_loss: 149604.9312

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 16 sec.
Using best model state, which was in epoch 15.

--- MODEL EVALUATION ---
Val AUROC score: 0.9233
Val AUPRC score: 0.9911
Val best accuracy score: 0.9635
Val best F1 score: 0.9807
Val gene expr MSE score: 1.2448
Duration of model training in run 3: 0 hours, 1 minutes and 19 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 9813
Number of validation nodes: 1090
Number of training edges: 45787
Number of validation edges: 5087
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7678; val_auprc_score: 0.9695; val_best_acc_score: 0.9412; val_best_f1_score: 0.9691; train_kl_reg_loss: 454.8104; train_edge_recon_loss: 51074.0821; train_gene_expr_recon_loss: 119734.8323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171263.7253; train_optim_loss: 171263.7253; val_kl_reg_loss: 685.9285; val_edge_recon_loss: 49132.6008; val_gene_expr_recon_loss: 114139.3297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163957.8563; val_optim_loss: 163957.8563
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7813; val_auprc_score: 0.9669; val_best_acc_score: 0.9490; val_best_f1_score: 0.9731; train_kl_reg_loss: 1387.0055; train_edge_recon_loss: 47439.1915; train_gene_expr_recon_loss: 109975.9017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158802.1000; train_optim_loss: 158802.1000; val_kl_reg_loss: 1369.3810; val_edge_recon_loss: 43163.9789; val_gene_expr_recon_loss: 110601.4937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155134.8531; val_optim_loss: 155134.8531
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7560; val_auprc_score: 0.9667; val_best_acc_score: 0.9457; val_best_f1_score: 0.9714; train_kl_reg_loss: 1499.4876; train_edge_recon_loss: 45055.9209; train_gene_expr_recon_loss: 108803.0899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155358.4979; train_optim_loss: 155358.4979; val_kl_reg_loss: 1737.0897; val_edge_recon_loss: 44917.2742; val_gene_expr_recon_loss: 110779.6062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157433.9719; val_optim_loss: 157433.9719
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8097; val_auprc_score: 0.9708; val_best_acc_score: 0.9458; val_best_f1_score: 0.9713; train_kl_reg_loss: 1672.0803; train_edge_recon_loss: 44615.5168; train_gene_expr_recon_loss: 107908.3217; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154195.9194; train_optim_loss: 154195.9194; val_kl_reg_loss: 1696.9062; val_edge_recon_loss: 45065.0898; val_gene_expr_recon_loss: 111040.0297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157802.0281; val_optim_loss: 157802.0281
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8029; val_auprc_score: 0.9730; val_best_acc_score: 0.9477; val_best_f1_score: 0.9723; train_kl_reg_loss: 1678.0785; train_edge_recon_loss: 43119.5521; train_gene_expr_recon_loss: 107670.9715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152468.6028; train_optim_loss: 152468.6028; val_kl_reg_loss: 1600.6580; val_edge_recon_loss: 42301.5117; val_gene_expr_recon_loss: 110009.8938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153912.0656; val_optim_loss: 153912.0656
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8156; val_auprc_score: 0.9705; val_best_acc_score: 0.9468; val_best_f1_score: 0.9716; train_kl_reg_loss: 1673.2766; train_edge_recon_loss: 42915.0929; train_gene_expr_recon_loss: 107120.2144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 151708.5844; train_optim_loss: 151708.5844; val_kl_reg_loss: 1648.1281; val_edge_recon_loss: 47156.0711; val_gene_expr_recon_loss: 107826.4234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156630.6219; val_optim_loss: 156630.6219
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8117; val_auprc_score: 0.9766; val_best_acc_score: 0.9464; val_best_f1_score: 0.9718; train_kl_reg_loss: 1667.1062; train_edge_recon_loss: 42897.9110; train_gene_expr_recon_loss: 106814.0911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 151379.1080; train_optim_loss: 151379.1080; val_kl_reg_loss: 1737.9119; val_edge_recon_loss: 43030.2297; val_gene_expr_recon_loss: 108953.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153721.9937; val_optim_loss: 153721.9937
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8399; val_auprc_score: 0.9784; val_best_acc_score: 0.9539; val_best_f1_score: 0.9756; train_kl_reg_loss: 1699.5819; train_edge_recon_loss: 42757.9046; train_gene_expr_recon_loss: 106353.2036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 150810.6889; train_optim_loss: 150810.6889; val_kl_reg_loss: 1700.7244; val_edge_recon_loss: 41912.8180; val_gene_expr_recon_loss: 108384.4859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 151998.0250; val_optim_loss: 151998.0250
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8655; val_auprc_score: 0.9801; val_best_acc_score: 0.9599; val_best_f1_score: 0.9787; train_kl_reg_loss: 1720.1286; train_edge_recon_loss: 41121.8978; train_gene_expr_recon_loss: 106029.0656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 148871.0910; train_optim_loss: 148871.0910; val_kl_reg_loss: 1586.8668; val_edge_recon_loss: 39632.8562; val_gene_expr_recon_loss: 106048.3469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147268.0719; val_optim_loss: 147268.0719
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8767; val_auprc_score: 0.9838; val_best_acc_score: 0.9509; val_best_f1_score: 0.9739; train_kl_reg_loss: 1715.8972; train_edge_recon_loss: 42673.0137; train_gene_expr_recon_loss: 105694.3443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 150083.2559; train_optim_loss: 150083.2559; val_kl_reg_loss: 1888.8331; val_edge_recon_loss: 44264.4648; val_gene_expr_recon_loss: 106922.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153075.8062; val_optim_loss: 153075.8062
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8844; val_auprc_score: 0.9868; val_best_acc_score: 0.9517; val_best_f1_score: 0.9743; train_kl_reg_loss: 1824.8108; train_edge_recon_loss: 41761.7187; train_gene_expr_recon_loss: 105412.3363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 148998.8649; train_optim_loss: 148998.8649; val_kl_reg_loss: 1881.1445; val_edge_recon_loss: 43293.1148; val_gene_expr_recon_loss: 107605.7797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152780.0406; val_optim_loss: 152780.0406
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9060; val_auprc_score: 0.9896; val_best_acc_score: 0.9558; val_best_f1_score: 0.9766; train_kl_reg_loss: 1857.2160; train_edge_recon_loss: 41434.9862; train_gene_expr_recon_loss: 105035.8969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 148328.0997; train_optim_loss: 148328.0997; val_kl_reg_loss: 2003.2202; val_edge_recon_loss: 41735.4062; val_gene_expr_recon_loss: 107334.8641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 151073.4906; val_optim_loss: 151073.4906

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9199; val_auprc_score: 0.9884; val_best_acc_score: 0.9562; val_best_f1_score: 0.9767; train_kl_reg_loss: 1920.8050; train_edge_recon_loss: 41171.8438; train_gene_expr_recon_loss: 104618.9023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 147711.5510; train_optim_loss: 147711.5510; val_kl_reg_loss: 1849.4956; val_edge_recon_loss: 41352.9492; val_gene_expr_recon_loss: 105615.8859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148818.3312; val_optim_loss: 148818.3312
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9189; val_auprc_score: 0.9895; val_best_acc_score: 0.9575; val_best_f1_score: 0.9774; train_kl_reg_loss: 1874.6034; train_edge_recon_loss: 41561.2341; train_gene_expr_recon_loss: 103902.1946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 147338.0323; train_optim_loss: 147338.0323; val_kl_reg_loss: 1850.6722; val_edge_recon_loss: 41245.7688; val_gene_expr_recon_loss: 106613.0984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 149709.5375; val_optim_loss: 149709.5375
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9206; val_auprc_score: 0.9912; val_best_acc_score: 0.9582; val_best_f1_score: 0.9778; train_kl_reg_loss: 1906.1917; train_edge_recon_loss: 41294.4999; train_gene_expr_recon_loss: 104140.4917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 147341.1833; train_optim_loss: 147341.1833; val_kl_reg_loss: 1894.4541; val_edge_recon_loss: 41640.9469; val_gene_expr_recon_loss: 105199.0531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148734.4562; val_optim_loss: 148734.4562

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 55 sec.
Using best model state, which was in epoch 9.

--- MODEL EVALUATION ---
Val AUROC score: 0.8562
Val AUPRC score: 0.9822
Val best accuracy score: 0.9514
Val best F1 score: 0.9743
Val gene expr MSE score: 1.3488
Duration of model training in run 4: 0 hours, 0 minutes and 57 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 9813
Number of validation nodes: 1090
Number of training edges: 67989
Number of validation edges: 7554
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8109; val_auprc_score: 0.9734; val_best_acc_score: 0.9477; val_best_f1_score: 0.9723; train_kl_reg_loss: 999.8596; train_edge_recon_loss: 48290.2465; train_gene_expr_recon_loss: 114851.8729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 164141.9790; train_optim_loss: 164141.9790; val_kl_reg_loss: 1457.4654; val_edge_recon_loss: 45441.9365; val_gene_expr_recon_loss: 114174.5484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161073.9510; val_optim_loss: 161073.9510
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8044; val_auprc_score: 0.9735; val_best_acc_score: 0.9489; val_best_f1_score: 0.9730; train_kl_reg_loss: 1588.6059; train_edge_recon_loss: 43758.0663; train_gene_expr_recon_loss: 108889.7901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154236.4623; train_optim_loss: 154236.4623; val_kl_reg_loss: 1663.6862; val_edge_recon_loss: 44435.9421; val_gene_expr_recon_loss: 112669.7661; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158769.3937; val_optim_loss: 158769.3937
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8316; val_auprc_score: 0.9778; val_best_acc_score: 0.9487; val_best_f1_score: 0.9727; train_kl_reg_loss: 1687.0409; train_edge_recon_loss: 44180.4434; train_gene_expr_recon_loss: 107518.2092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153385.6934; train_optim_loss: 153385.6934; val_kl_reg_loss: 1799.4016; val_edge_recon_loss: 43971.9742; val_gene_expr_recon_loss: 110962.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156733.8438; val_optim_loss: 156733.8438
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8994; val_auprc_score: 0.9876; val_best_acc_score: 0.9526; val_best_f1_score: 0.9747; train_kl_reg_loss: 1740.8219; train_edge_recon_loss: 43639.8313; train_gene_expr_recon_loss: 106287.6382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 151668.2918; train_optim_loss: 151668.2918; val_kl_reg_loss: 1766.1777; val_edge_recon_loss: 42660.3826; val_gene_expr_recon_loss: 110670.4698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155097.0292; val_optim_loss: 155097.0292
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8954; val_auprc_score: 0.9870; val_best_acc_score: 0.9554; val_best_f1_score: 0.9762; train_kl_reg_loss: 1797.9967; train_edge_recon_loss: 42718.0037; train_gene_expr_recon_loss: 105818.5811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 150334.5819; train_optim_loss: 150334.5819; val_kl_reg_loss: 1703.9500; val_edge_recon_loss: 41520.0387; val_gene_expr_recon_loss: 109369.6260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152593.6135; val_optim_loss: 152593.6135
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9157; val_auprc_score: 0.9880; val_best_acc_score: 0.9583; val_best_f1_score: 0.9777; train_kl_reg_loss: 1867.1671; train_edge_recon_loss: 42496.3641; train_gene_expr_recon_loss: 104974.1498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 149337.6815; train_optim_loss: 149337.6815; val_kl_reg_loss: 1825.7547; val_edge_recon_loss: 44703.1021; val_gene_expr_recon_loss: 109750.0786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156278.9344; val_optim_loss: 156278.9344
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9325; val_auprc_score: 0.9913; val_best_acc_score: 0.9613; val_best_f1_score: 0.9793; train_kl_reg_loss: 1881.9851; train_edge_recon_loss: 40511.0825; train_gene_expr_recon_loss: 104644.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 147037.1136; train_optim_loss: 147037.1136; val_kl_reg_loss: 1766.4378; val_edge_recon_loss: 42311.1901; val_gene_expr_recon_loss: 109196.2620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153273.8885; val_optim_loss: 153273.8885
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9409; val_auprc_score: 0.9936; val_best_acc_score: 0.9637; val_best_f1_score: 0.9806; train_kl_reg_loss: 1905.1339; train_edge_recon_loss: 42205.0674; train_gene_expr_recon_loss: 103939.5368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 148049.7378; train_optim_loss: 148049.7378; val_kl_reg_loss: 1826.0018; val_edge_recon_loss: 41497.8042; val_gene_expr_recon_loss: 108641.7437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 151965.5500; val_optim_loss: 151965.5500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9325; val_auprc_score: 0.9902; val_best_acc_score: 0.9646; val_best_f1_score: 0.9810; train_kl_reg_loss: 1929.8896; train_edge_recon_loss: 42698.4174; train_gene_expr_recon_loss: 103865.0684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 148493.3758; train_optim_loss: 148493.3758; val_kl_reg_loss: 1955.1917; val_edge_recon_loss: 42629.5628; val_gene_expr_recon_loss: 108471.7865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153056.5406; val_optim_loss: 153056.5406
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9465; val_auprc_score: 0.9921; val_best_acc_score: 0.9711; val_best_f1_score: 0.9846; train_kl_reg_loss: 1933.2644; train_edge_recon_loss: 40562.3771; train_gene_expr_recon_loss: 103110.5549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145606.1964; train_optim_loss: 145606.1964; val_kl_reg_loss: 1871.6376; val_edge_recon_loss: 38407.2194; val_gene_expr_recon_loss: 106850.5458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147129.4021; val_optim_loss: 147129.4021
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9420; val_auprc_score: 0.9900; val_best_acc_score: 0.9668; val_best_f1_score: 0.9822; train_kl_reg_loss: 1928.5455; train_edge_recon_loss: 41420.5672; train_gene_expr_recon_loss: 102639.6303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145988.7432; train_optim_loss: 145988.7432; val_kl_reg_loss: 1954.9952; val_edge_recon_loss: 41952.4656; val_gene_expr_recon_loss: 107928.2219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 151835.6833; val_optim_loss: 151835.6833
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9504; val_auprc_score: 0.9938; val_best_acc_score: 0.9715; val_best_f1_score: 0.9848; train_kl_reg_loss: 1953.2064; train_edge_recon_loss: 41341.4753; train_gene_expr_recon_loss: 102083.1544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145377.8354; train_optim_loss: 145377.8354; val_kl_reg_loss: 1936.8405; val_edge_recon_loss: 38655.1069; val_gene_expr_recon_loss: 107846.3240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148438.2729; val_optim_loss: 148438.2729
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9475; val_auprc_score: 0.9926; val_best_acc_score: 0.9697; val_best_f1_score: 0.9837; train_kl_reg_loss: 1961.2700; train_edge_recon_loss: 40449.2067; train_gene_expr_recon_loss: 102076.2025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144486.6794; train_optim_loss: 144486.6794; val_kl_reg_loss: 1982.5330; val_edge_recon_loss: 41950.5078; val_gene_expr_recon_loss: 106739.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 150672.2354; val_optim_loss: 150672.2354

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9524; val_auprc_score: 0.9943; val_best_acc_score: 0.9698; val_best_f1_score: 0.9838; train_kl_reg_loss: 1984.6874; train_edge_recon_loss: 40606.4436; train_gene_expr_recon_loss: 100826.7125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143417.8435; train_optim_loss: 143417.8435; val_kl_reg_loss: 1936.9335; val_edge_recon_loss: 41170.2932; val_gene_expr_recon_loss: 105687.3479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148794.5750; val_optim_loss: 148794.5750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9543; val_auprc_score: 0.9942; val_best_acc_score: 0.9705; val_best_f1_score: 0.9842; train_kl_reg_loss: 1967.5435; train_edge_recon_loss: 40389.3853; train_gene_expr_recon_loss: 100509.3943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142866.3228; train_optim_loss: 142866.3228; val_kl_reg_loss: 1948.1508; val_edge_recon_loss: 40633.7201; val_gene_expr_recon_loss: 104712.3146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147294.1875; val_optim_loss: 147294.1875
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9581; val_auprc_score: 0.9937; val_best_acc_score: 0.9717; val_best_f1_score: 0.9848; train_kl_reg_loss: 1947.9254; train_edge_recon_loss: 40959.7704; train_gene_expr_recon_loss: 100204.9549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143112.6508; train_optim_loss: 143112.6508; val_kl_reg_loss: 1932.6437; val_edge_recon_loss: 39704.7161; val_gene_expr_recon_loss: 105064.6760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146702.0365; val_optim_loss: 146702.0365
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9555; val_auprc_score: 0.9942; val_best_acc_score: 0.9705; val_best_f1_score: 0.9841; train_kl_reg_loss: 1954.2480; train_edge_recon_loss: 40169.5886; train_gene_expr_recon_loss: 100103.6824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142227.5197; train_optim_loss: 142227.5197; val_kl_reg_loss: 1947.4776; val_edge_recon_loss: 41645.0026; val_gene_expr_recon_loss: 104637.2349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148229.7146; val_optim_loss: 148229.7146
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9602; val_auprc_score: 0.9957; val_best_acc_score: 0.9710; val_best_f1_score: 0.9844; train_kl_reg_loss: 1958.1681; train_edge_recon_loss: 40762.9218; train_gene_expr_recon_loss: 100283.0969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143004.1869; train_optim_loss: 143004.1869; val_kl_reg_loss: 1951.4739; val_edge_recon_loss: 42277.5242; val_gene_expr_recon_loss: 105037.8943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 149266.8937; val_optim_loss: 149266.8937
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9623; val_auprc_score: 0.9956; val_best_acc_score: 0.9706; val_best_f1_score: 0.9842; train_kl_reg_loss: 1953.6212; train_edge_recon_loss: 40553.7383; train_gene_expr_recon_loss: 100152.6152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142659.9743; train_optim_loss: 142659.9743; val_kl_reg_loss: 1939.6267; val_edge_recon_loss: 40013.1417; val_gene_expr_recon_loss: 105399.2484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147352.0177; val_optim_loss: 147352.0177

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9420; val_auprc_score: 0.9918; val_best_acc_score: 0.9696; val_best_f1_score: 0.9838; train_kl_reg_loss: 1958.4836; train_edge_recon_loss: 41070.4916; train_gene_expr_recon_loss: 99753.3556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142782.3306; train_optim_loss: 142782.3306; val_kl_reg_loss: 1945.8674; val_edge_recon_loss: 40595.2147; val_gene_expr_recon_loss: 104716.4526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147257.5344; val_optim_loss: 147257.5344
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9559; val_auprc_score: 0.9944; val_best_acc_score: 0.9735; val_best_f1_score: 0.9858; train_kl_reg_loss: 1961.4913; train_edge_recon_loss: 40534.2198; train_gene_expr_recon_loss: 100107.6218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142603.3336; train_optim_loss: 142603.3336; val_kl_reg_loss: 1944.5899; val_edge_recon_loss: 38350.8754; val_gene_expr_recon_loss: 105850.8526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146146.3167; val_optim_loss: 146146.3167
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9555; val_auprc_score: 0.9946; val_best_acc_score: 0.9718; val_best_f1_score: 0.9849; train_kl_reg_loss: 1958.9845; train_edge_recon_loss: 40512.3556; train_gene_expr_recon_loss: 99771.7331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142243.0737; train_optim_loss: 142243.0737; val_kl_reg_loss: 1943.7720; val_edge_recon_loss: 39718.1867; val_gene_expr_recon_loss: 105178.8833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146840.8427; val_optim_loss: 146840.8427
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9530; val_auprc_score: 0.9934; val_best_acc_score: 0.9745; val_best_f1_score: 0.9863; train_kl_reg_loss: 1962.7751; train_edge_recon_loss: 40621.5217; train_gene_expr_recon_loss: 100215.8546; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142800.1511; train_optim_loss: 142800.1511; val_kl_reg_loss: 1950.8512; val_edge_recon_loss: 38977.2746; val_gene_expr_recon_loss: 106185.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147113.9552; val_optim_loss: 147113.9552
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9521; val_auprc_score: 0.9931; val_best_acc_score: 0.9721; val_best_f1_score: 0.9851; train_kl_reg_loss: 1965.5927; train_edge_recon_loss: 40495.5862; train_gene_expr_recon_loss: 99794.1214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142255.3009; train_optim_loss: 142255.3009; val_kl_reg_loss: 1949.6532; val_edge_recon_loss: 41077.5650; val_gene_expr_recon_loss: 105405.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148433.1802; val_optim_loss: 148433.1802

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9551; val_auprc_score: 0.9944; val_best_acc_score: 0.9705; val_best_f1_score: 0.9842; train_kl_reg_loss: 1967.7374; train_edge_recon_loss: 40854.6342; train_gene_expr_recon_loss: 99969.2526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142791.6236; train_optim_loss: 142791.6236; val_kl_reg_loss: 1948.9206; val_edge_recon_loss: 41676.7013; val_gene_expr_recon_loss: 105111.6161; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148737.2375; val_optim_loss: 148737.2375
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9630; val_auprc_score: 0.9962; val_best_acc_score: 0.9717; val_best_f1_score: 0.9848; train_kl_reg_loss: 1969.2920; train_edge_recon_loss: 39962.1196; train_gene_expr_recon_loss: 99814.0162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141745.4277; train_optim_loss: 141745.4277; val_kl_reg_loss: 1951.7314; val_edge_recon_loss: 40383.9436; val_gene_expr_recon_loss: 104289.5906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146625.2667; val_optim_loss: 146625.2667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9590; val_auprc_score: 0.9938; val_best_acc_score: 0.9710; val_best_f1_score: 0.9844; train_kl_reg_loss: 1968.1922; train_edge_recon_loss: 40714.1115; train_gene_expr_recon_loss: 100111.7465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142794.0504; train_optim_loss: 142794.0504; val_kl_reg_loss: 1952.3202; val_edge_recon_loss: 41980.7227; val_gene_expr_recon_loss: 105053.3156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148986.3604; val_optim_loss: 148986.3604

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 46 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9567
Val AUPRC score: 0.9936
Val best accuracy score: 0.9742
Val best F1 score: 0.9862
Val gene expr MSE score: 1.5811
Duration of model training in run 5: 0 hours, 4 minutes and 52 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 9813
Number of validation nodes: 1090
Number of training edges: 67989
Number of validation edges: 7554
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7771; val_auprc_score: 0.9675; val_best_acc_score: 0.9458; val_best_f1_score: 0.9714; train_kl_reg_loss: 921.6011; train_edge_recon_loss: 47437.7480; train_gene_expr_recon_loss: 115559.2557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 163918.6044; train_optim_loss: 163918.6044; val_kl_reg_loss: 1303.3835; val_edge_recon_loss: 47705.2659; val_gene_expr_recon_loss: 112533.3557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161542.0042; val_optim_loss: 161542.0042
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8170; val_auprc_score: 0.9747; val_best_acc_score: 0.9473; val_best_f1_score: 0.9721; train_kl_reg_loss: 1505.8193; train_edge_recon_loss: 45640.9758; train_gene_expr_recon_loss: 110127.1732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157273.9682; train_optim_loss: 157273.9682; val_kl_reg_loss: 1654.5796; val_edge_recon_loss: 44272.8422; val_gene_expr_recon_loss: 111304.1052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157231.5271; val_optim_loss: 157231.5271
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8383; val_auprc_score: 0.9785; val_best_acc_score: 0.9457; val_best_f1_score: 0.9713; train_kl_reg_loss: 1644.6721; train_edge_recon_loss: 43909.5157; train_gene_expr_recon_loss: 109035.5685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154589.7561; train_optim_loss: 154589.7561; val_kl_reg_loss: 1642.5979; val_edge_recon_loss: 42557.2691; val_gene_expr_recon_loss: 109199.1047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153398.9719; val_optim_loss: 153398.9719
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8735; val_auprc_score: 0.9843; val_best_acc_score: 0.9503; val_best_f1_score: 0.9736; train_kl_reg_loss: 1724.7031; train_edge_recon_loss: 42691.6032; train_gene_expr_recon_loss: 108093.0250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152509.3304; train_optim_loss: 152509.3304; val_kl_reg_loss: 1681.8228; val_edge_recon_loss: 42621.0112; val_gene_expr_recon_loss: 108831.3193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153134.1552; val_optim_loss: 153134.1552
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8925; val_auprc_score: 0.9875; val_best_acc_score: 0.9526; val_best_f1_score: 0.9748; train_kl_reg_loss: 1798.5754; train_edge_recon_loss: 42558.1203; train_gene_expr_recon_loss: 107166.5942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 151523.2890; train_optim_loss: 151523.2890; val_kl_reg_loss: 1919.2188; val_edge_recon_loss: 43074.5497; val_gene_expr_recon_loss: 107773.0557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152766.8260; val_optim_loss: 152766.8260
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9303; val_auprc_score: 0.9924; val_best_acc_score: 0.9638; val_best_f1_score: 0.9807; train_kl_reg_loss: 1829.5526; train_edge_recon_loss: 41842.0656; train_gene_expr_recon_loss: 106274.1110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 149945.7295; train_optim_loss: 149945.7295; val_kl_reg_loss: 1784.7323; val_edge_recon_loss: 38583.5983; val_gene_expr_recon_loss: 108348.5870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148716.9167; val_optim_loss: 148716.9167
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9249; val_auprc_score: 0.9894; val_best_acc_score: 0.9605; val_best_f1_score: 0.9791; train_kl_reg_loss: 1899.4770; train_edge_recon_loss: 42065.4647; train_gene_expr_recon_loss: 105637.0189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 149601.9602; train_optim_loss: 149601.9602; val_kl_reg_loss: 1794.6477; val_edge_recon_loss: 39495.6632; val_gene_expr_recon_loss: 107259.1823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148549.4958; val_optim_loss: 148549.4958
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9337; val_auprc_score: 0.9923; val_best_acc_score: 0.9617; val_best_f1_score: 0.9795; train_kl_reg_loss: 1892.3388; train_edge_recon_loss: 41493.9713; train_gene_expr_recon_loss: 105321.5018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 148707.8121; train_optim_loss: 148707.8121; val_kl_reg_loss: 1747.3994; val_edge_recon_loss: 41467.0177; val_gene_expr_recon_loss: 106462.3036; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 149676.7219; val_optim_loss: 149676.7219
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9301; val_auprc_score: 0.9909; val_best_acc_score: 0.9632; val_best_f1_score: 0.9804; train_kl_reg_loss: 1916.9052; train_edge_recon_loss: 42175.5247; train_gene_expr_recon_loss: 104466.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 148558.7733; train_optim_loss: 148558.7733; val_kl_reg_loss: 1868.3546; val_edge_recon_loss: 39949.6401; val_gene_expr_recon_loss: 106181.6490; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147999.6448; val_optim_loss: 147999.6448
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9371; val_auprc_score: 0.9918; val_best_acc_score: 0.9634; val_best_f1_score: 0.9804; train_kl_reg_loss: 1913.2479; train_edge_recon_loss: 40578.8474; train_gene_expr_recon_loss: 104403.8350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146895.9290; train_optim_loss: 146895.9290; val_kl_reg_loss: 1893.8966; val_edge_recon_loss: 42504.8289; val_gene_expr_recon_loss: 105831.8807; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 150230.6042; val_optim_loss: 150230.6042
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9386; val_auprc_score: 0.9932; val_best_acc_score: 0.9701; val_best_f1_score: 0.9841; train_kl_reg_loss: 1926.4418; train_edge_recon_loss: 40994.8093; train_gene_expr_recon_loss: 103598.5368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146519.7881; train_optim_loss: 146519.7881; val_kl_reg_loss: 1917.8435; val_edge_recon_loss: 38208.9362; val_gene_expr_recon_loss: 104993.2620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145120.0427; val_optim_loss: 145120.0427
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9412; val_auprc_score: 0.9916; val_best_acc_score: 0.9690; val_best_f1_score: 0.9834; train_kl_reg_loss: 1951.5730; train_edge_recon_loss: 40354.9239; train_gene_expr_recon_loss: 103385.3974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145691.8944; train_optim_loss: 145691.8944; val_kl_reg_loss: 1788.3627; val_edge_recon_loss: 39880.4736; val_gene_expr_recon_loss: 104882.8510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146551.6854; val_optim_loss: 146551.6854
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9471; val_auprc_score: 0.9928; val_best_acc_score: 0.9689; val_best_f1_score: 0.9833; train_kl_reg_loss: 1957.5672; train_edge_recon_loss: 41287.2900; train_gene_expr_recon_loss: 102741.8663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145986.7234; train_optim_loss: 145986.7234; val_kl_reg_loss: 1829.5653; val_edge_recon_loss: 41618.3824; val_gene_expr_recon_loss: 104309.7047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147757.6500; val_optim_loss: 147757.6500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9512; val_auprc_score: 0.9929; val_best_acc_score: 0.9702; val_best_f1_score: 0.9840; train_kl_reg_loss: 1979.7190; train_edge_recon_loss: 41139.1730; train_gene_expr_recon_loss: 102236.8681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145355.7606; train_optim_loss: 145355.7606; val_kl_reg_loss: 2005.3974; val_edge_recon_loss: 41281.7418; val_gene_expr_recon_loss: 104904.7911; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148191.9312; val_optim_loss: 148191.9312

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9504; val_auprc_score: 0.9939; val_best_acc_score: 0.9716; val_best_f1_score: 0.9849; train_kl_reg_loss: 1973.9209; train_edge_recon_loss: 39679.7022; train_gene_expr_recon_loss: 101056.8420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142710.4658; train_optim_loss: 142710.4658; val_kl_reg_loss: 1958.8396; val_edge_recon_loss: 39502.2391; val_gene_expr_recon_loss: 103838.6776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145299.7542; val_optim_loss: 145299.7542
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9461; val_auprc_score: 0.9921; val_best_acc_score: 0.9722; val_best_f1_score: 0.9852; train_kl_reg_loss: 1980.1934; train_edge_recon_loss: 40313.2305; train_gene_expr_recon_loss: 100845.8868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143139.3107; train_optim_loss: 143139.3107; val_kl_reg_loss: 1967.0952; val_edge_recon_loss: 38440.1663; val_gene_expr_recon_loss: 103880.9823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144288.2443; val_optim_loss: 144288.2443
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9553; val_auprc_score: 0.9939; val_best_acc_score: 0.9718; val_best_f1_score: 0.9849; train_kl_reg_loss: 1979.3793; train_edge_recon_loss: 40029.4146; train_gene_expr_recon_loss: 100857.9203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142866.7143; train_optim_loss: 142866.7143; val_kl_reg_loss: 1972.2515; val_edge_recon_loss: 39137.4798; val_gene_expr_recon_loss: 103479.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144589.3344; val_optim_loss: 144589.3344
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9517; val_auprc_score: 0.9937; val_best_acc_score: 0.9715; val_best_f1_score: 0.9847; train_kl_reg_loss: 1975.5733; train_edge_recon_loss: 39378.9429; train_gene_expr_recon_loss: 100576.2909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141930.8076; train_optim_loss: 141930.8076; val_kl_reg_loss: 1922.5632; val_edge_recon_loss: 42482.2000; val_gene_expr_recon_loss: 102067.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146472.0771; val_optim_loss: 146472.0771
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9619; val_auprc_score: 0.9934; val_best_acc_score: 0.9737; val_best_f1_score: 0.9860; train_kl_reg_loss: 1945.1390; train_edge_recon_loss: 40604.4866; train_gene_expr_recon_loss: 100790.0915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143339.7172; train_optim_loss: 143339.7172; val_kl_reg_loss: 1917.7410; val_edge_recon_loss: 38451.2199; val_gene_expr_recon_loss: 102836.0583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143205.0177; val_optim_loss: 143205.0177
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9543; val_auprc_score: 0.9942; val_best_acc_score: 0.9744; val_best_f1_score: 0.9863; train_kl_reg_loss: 1967.3630; train_edge_recon_loss: 40325.5111; train_gene_expr_recon_loss: 100713.1148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143005.9891; train_optim_loss: 143005.9891; val_kl_reg_loss: 1947.6996; val_edge_recon_loss: 39154.5603; val_gene_expr_recon_loss: 103163.8724; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144266.1302; val_optim_loss: 144266.1302
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9449; val_auprc_score: 0.9928; val_best_acc_score: 0.9694; val_best_f1_score: 0.9837; train_kl_reg_loss: 1962.5523; train_edge_recon_loss: 40468.6341; train_gene_expr_recon_loss: 100810.3273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143241.5133; train_optim_loss: 143241.5133; val_kl_reg_loss: 1944.9303; val_edge_recon_loss: 41813.4352; val_gene_expr_recon_loss: 103414.5188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147172.8833; val_optim_loss: 147172.8833
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9571; val_auprc_score: 0.9947; val_best_acc_score: 0.9751; val_best_f1_score: 0.9866; train_kl_reg_loss: 1973.1206; train_edge_recon_loss: 39716.5928; train_gene_expr_recon_loss: 100472.2911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142162.0053; train_optim_loss: 142162.0053; val_kl_reg_loss: 1944.6237; val_edge_recon_loss: 39950.9818; val_gene_expr_recon_loss: 103654.7563; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145550.3635; val_optim_loss: 145550.3635

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9506; val_auprc_score: 0.9930; val_best_acc_score: 0.9722; val_best_f1_score: 0.9851; train_kl_reg_loss: 1968.0812; train_edge_recon_loss: 40401.3456; train_gene_expr_recon_loss: 100562.8794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142932.3056; train_optim_loss: 142932.3056; val_kl_reg_loss: 1948.4764; val_edge_recon_loss: 39945.1818; val_gene_expr_recon_loss: 102982.8776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144876.5365; val_optim_loss: 144876.5365
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9620; val_auprc_score: 0.9956; val_best_acc_score: 0.9734; val_best_f1_score: 0.9857; train_kl_reg_loss: 1973.4523; train_edge_recon_loss: 40199.8971; train_gene_expr_recon_loss: 100190.4425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142363.7928; train_optim_loss: 142363.7928; val_kl_reg_loss: 1950.1013; val_edge_recon_loss: 40905.0397; val_gene_expr_recon_loss: 102930.5651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145785.7073; val_optim_loss: 145785.7073
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9597; val_auprc_score: 0.9951; val_best_acc_score: 0.9724; val_best_f1_score: 0.9852; train_kl_reg_loss: 1968.0332; train_edge_recon_loss: 40224.2031; train_gene_expr_recon_loss: 100620.5243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142812.7605; train_optim_loss: 142812.7605; val_kl_reg_loss: 1946.6058; val_edge_recon_loss: 41358.9219; val_gene_expr_recon_loss: 102610.9464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145916.4719; val_optim_loss: 145916.4719

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 7 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9580
Val AUPRC score: 0.9943
Val best accuracy score: 0.9729
Val best F1 score: 0.9855
Val gene expr MSE score: 1.4480
Duration of model training in run 6: 0 hours, 4 minutes and 14 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 9813
Number of validation nodes: 1090
Number of training edges: 90373
Number of validation edges: 10041
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8214; val_auprc_score: 0.9783; val_best_acc_score: 0.9472; val_best_f1_score: 0.9723; train_kl_reg_loss: 1315.8470; train_edge_recon_loss: 46391.5709; train_gene_expr_recon_loss: 113597.3332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161304.7513; train_optim_loss: 161304.7513; val_kl_reg_loss: 1724.0803; val_edge_recon_loss: 43051.0083; val_gene_expr_recon_loss: 111032.1432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155807.2320; val_optim_loss: 155807.2320
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8498; val_auprc_score: 0.9804; val_best_acc_score: 0.9459; val_best_f1_score: 0.9713; train_kl_reg_loss: 1676.3891; train_edge_recon_loss: 43575.7803; train_gene_expr_recon_loss: 109099.3894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154351.5587; train_optim_loss: 154351.5587; val_kl_reg_loss: 1725.7808; val_edge_recon_loss: 42947.2015; val_gene_expr_recon_loss: 108870.5227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153543.5043; val_optim_loss: 153543.5043
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9123; val_auprc_score: 0.9901; val_best_acc_score: 0.9601; val_best_f1_score: 0.9788; train_kl_reg_loss: 1743.7584; train_edge_recon_loss: 42180.6828; train_gene_expr_recon_loss: 107434.0281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 151358.4694; train_optim_loss: 151358.4694; val_kl_reg_loss: 1771.5626; val_edge_recon_loss: 41525.3169; val_gene_expr_recon_loss: 107549.6311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 150846.5111; val_optim_loss: 150846.5111
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9153; val_auprc_score: 0.9907; val_best_acc_score: 0.9598; val_best_f1_score: 0.9787; train_kl_reg_loss: 1831.0748; train_edge_recon_loss: 41774.4111; train_gene_expr_recon_loss: 106092.4554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 149697.9415; train_optim_loss: 149697.9415; val_kl_reg_loss: 1575.6190; val_edge_recon_loss: 39161.4356; val_gene_expr_recon_loss: 106740.0525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147477.1076; val_optim_loss: 147477.1076
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9403; val_auprc_score: 0.9925; val_best_acc_score: 0.9679; val_best_f1_score: 0.9829; train_kl_reg_loss: 1863.0134; train_edge_recon_loss: 41667.0041; train_gene_expr_recon_loss: 105139.4729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 148669.4904; train_optim_loss: 148669.4904; val_kl_reg_loss: 1831.2538; val_edge_recon_loss: 38494.4346; val_gene_expr_recon_loss: 105450.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145775.7123; val_optim_loss: 145775.7123
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9273; val_auprc_score: 0.9904; val_best_acc_score: 0.9669; val_best_f1_score: 0.9823; train_kl_reg_loss: 1877.0621; train_edge_recon_loss: 41262.9567; train_gene_expr_recon_loss: 104219.3758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 147359.3949; train_optim_loss: 147359.3949; val_kl_reg_loss: 1862.8481; val_edge_recon_loss: 40709.2998; val_gene_expr_recon_loss: 104626.0943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147198.2416; val_optim_loss: 147198.2416
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9444; val_auprc_score: 0.9923; val_best_acc_score: 0.9662; val_best_f1_score: 0.9818; train_kl_reg_loss: 1939.2462; train_edge_recon_loss: 41006.7871; train_gene_expr_recon_loss: 103547.5798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146493.6131; train_optim_loss: 146493.6131; val_kl_reg_loss: 1976.8059; val_edge_recon_loss: 43441.0016; val_gene_expr_recon_loss: 104414.1080; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 149831.9160; val_optim_loss: 149831.9160
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9493; val_auprc_score: 0.9935; val_best_acc_score: 0.9692; val_best_f1_score: 0.9834; train_kl_reg_loss: 1963.2036; train_edge_recon_loss: 41175.8548; train_gene_expr_recon_loss: 102941.6424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146080.7007; train_optim_loss: 146080.7007; val_kl_reg_loss: 1849.9593; val_edge_recon_loss: 40777.6025; val_gene_expr_recon_loss: 104041.0172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146668.5781; val_optim_loss: 146668.5781

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9526; val_auprc_score: 0.9931; val_best_acc_score: 0.9704; val_best_f1_score: 0.9841; train_kl_reg_loss: 1933.5629; train_edge_recon_loss: 40767.8672; train_gene_expr_recon_loss: 101102.0525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143803.4824; train_optim_loss: 143803.4824; val_kl_reg_loss: 1925.2549; val_edge_recon_loss: 41963.6188; val_gene_expr_recon_loss: 102683.6508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146572.5236; val_optim_loss: 146572.5236
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9434; val_auprc_score: 0.9922; val_best_acc_score: 0.9706; val_best_f1_score: 0.9844; train_kl_reg_loss: 1927.8445; train_edge_recon_loss: 39012.1199; train_gene_expr_recon_loss: 100568.6154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141508.5794; train_optim_loss: 141508.5794; val_kl_reg_loss: 1927.5447; val_edge_recon_loss: 39789.7889; val_gene_expr_recon_loss: 102156.8922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143874.2262; val_optim_loss: 143874.2262
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9577; val_auprc_score: 0.9949; val_best_acc_score: 0.9728; val_best_f1_score: 0.9854; train_kl_reg_loss: 1946.5247; train_edge_recon_loss: 40356.6230; train_gene_expr_recon_loss: 100492.7368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142795.8843; train_optim_loss: 142795.8843; val_kl_reg_loss: 1935.2534; val_edge_recon_loss: 40743.2199; val_gene_expr_recon_loss: 101947.4748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144625.9469; val_optim_loss: 144625.9469
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9586; val_auprc_score: 0.9944; val_best_acc_score: 0.9722; val_best_f1_score: 0.9851; train_kl_reg_loss: 1943.9186; train_edge_recon_loss: 40843.1986; train_gene_expr_recon_loss: 100415.2916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143202.4091; train_optim_loss: 143202.4091; val_kl_reg_loss: 1936.7779; val_edge_recon_loss: 39797.6854; val_gene_expr_recon_loss: 102169.1367; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143903.5996; val_optim_loss: 143903.5996
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9538; val_auprc_score: 0.9947; val_best_acc_score: 0.9748; val_best_f1_score: 0.9866; train_kl_reg_loss: 1940.4503; train_edge_recon_loss: 40093.4212; train_gene_expr_recon_loss: 100302.4295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142336.3011; train_optim_loss: 142336.3011; val_kl_reg_loss: 1917.4318; val_edge_recon_loss: 38841.9625; val_gene_expr_recon_loss: 102390.8473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143150.2424; val_optim_loss: 143150.2424
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9511; val_auprc_score: 0.9934; val_best_acc_score: 0.9730; val_best_f1_score: 0.9856; train_kl_reg_loss: 1930.9899; train_edge_recon_loss: 40735.3538; train_gene_expr_recon_loss: 100367.0124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143033.3563; train_optim_loss: 143033.3563; val_kl_reg_loss: 1885.0956; val_edge_recon_loss: 39753.2538; val_gene_expr_recon_loss: 101930.6154; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143568.9650; val_optim_loss: 143568.9650
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9536; val_auprc_score: 0.9925; val_best_acc_score: 0.9724; val_best_f1_score: 0.9852; train_kl_reg_loss: 1923.7428; train_edge_recon_loss: 40262.5715; train_gene_expr_recon_loss: 100306.0779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142492.3922; train_optim_loss: 142492.3922; val_kl_reg_loss: 1937.3170; val_edge_recon_loss: 41462.3311; val_gene_expr_recon_loss: 102053.0986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145452.7475; val_optim_loss: 145452.7475
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9530; val_auprc_score: 0.9936; val_best_acc_score: 0.9750; val_best_f1_score: 0.9866; train_kl_reg_loss: 1982.4855; train_edge_recon_loss: 40342.5079; train_gene_expr_recon_loss: 100238.8911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142563.8846; train_optim_loss: 142563.8846; val_kl_reg_loss: 1966.7494; val_edge_recon_loss: 38893.3922; val_gene_expr_recon_loss: 101944.3703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142804.5115; val_optim_loss: 142804.5115
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9605; val_auprc_score: 0.9947; val_best_acc_score: 0.9741; val_best_f1_score: 0.9861; train_kl_reg_loss: 1952.6976; train_edge_recon_loss: 39618.1115; train_gene_expr_recon_loss: 100177.5528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141748.3620; train_optim_loss: 141748.3620; val_kl_reg_loss: 1948.4669; val_edge_recon_loss: 39479.3216; val_gene_expr_recon_loss: 101683.3629; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143111.1514; val_optim_loss: 143111.1514
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9539; val_auprc_score: 0.9935; val_best_acc_score: 0.9738; val_best_f1_score: 0.9860; train_kl_reg_loss: 1946.4085; train_edge_recon_loss: 41054.7863; train_gene_expr_recon_loss: 100194.5061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143195.7008; train_optim_loss: 143195.7008; val_kl_reg_loss: 1916.7912; val_edge_recon_loss: 39909.5444; val_gene_expr_recon_loss: 102139.7900; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143966.1258; val_optim_loss: 143966.1258
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9452; val_auprc_score: 0.9909; val_best_acc_score: 0.9736; val_best_f1_score: 0.9859; train_kl_reg_loss: 1941.0625; train_edge_recon_loss: 39288.8551; train_gene_expr_recon_loss: 100218.1029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141448.0204; train_optim_loss: 141448.0204; val_kl_reg_loss: 1931.6617; val_edge_recon_loss: 40700.3694; val_gene_expr_recon_loss: 101977.0693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144609.1002; val_optim_loss: 144609.1002

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9591; val_auprc_score: 0.9954; val_best_acc_score: 0.9743; val_best_f1_score: 0.9863; train_kl_reg_loss: 1943.3867; train_edge_recon_loss: 39685.8597; train_gene_expr_recon_loss: 99796.9737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141426.2201; train_optim_loss: 141426.2201; val_kl_reg_loss: 1918.0571; val_edge_recon_loss: 40229.6212; val_gene_expr_recon_loss: 101664.6873; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143812.3660; val_optim_loss: 143812.3660
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9495; val_auprc_score: 0.9916; val_best_acc_score: 0.9733; val_best_f1_score: 0.9857; train_kl_reg_loss: 1935.4854; train_edge_recon_loss: 39421.1063; train_gene_expr_recon_loss: 99872.3321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141228.9236; train_optim_loss: 141228.9236; val_kl_reg_loss: 1925.8924; val_edge_recon_loss: 39955.8830; val_gene_expr_recon_loss: 101541.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143422.9869; val_optim_loss: 143422.9869
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9568; val_auprc_score: 0.9944; val_best_acc_score: 0.9731; val_best_f1_score: 0.9856; train_kl_reg_loss: 1939.0966; train_edge_recon_loss: 40385.6674; train_gene_expr_recon_loss: 99786.9066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142111.6706; train_optim_loss: 142111.6706; val_kl_reg_loss: 1925.6070; val_edge_recon_loss: 41881.4177; val_gene_expr_recon_loss: 101871.0619; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145678.0855; val_optim_loss: 145678.0855

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 9 min 26 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
Val AUROC score: 0.9504
Val AUPRC score: 0.9930
Val best accuracy score: 0.9751
Val best F1 score: 0.9867
Val gene expr MSE score: 1.0359
Duration of model training in run 7: 0 hours, 9 minutes and 43 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 9813
Number of validation nodes: 1090
Number of training edges: 90373
Number of validation edges: 10041
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8147; val_auprc_score: 0.9738; val_best_acc_score: 0.9490; val_best_f1_score: 0.9730; train_kl_reg_loss: 1268.2924; train_edge_recon_loss: 45730.4297; train_gene_expr_recon_loss: 114364.4625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161363.1851; train_optim_loss: 161363.1851; val_kl_reg_loss: 1496.5790; val_edge_recon_loss: 43512.3863; val_gene_expr_recon_loss: 110489.0137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155497.9787; val_optim_loss: 155497.9787
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8390; val_auprc_score: 0.9786; val_best_acc_score: 0.9483; val_best_f1_score: 0.9727; train_kl_reg_loss: 1655.0141; train_edge_recon_loss: 43531.0610; train_gene_expr_recon_loss: 109443.6286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154629.7039; train_optim_loss: 154629.7039; val_kl_reg_loss: 1885.4870; val_edge_recon_loss: 44548.5666; val_gene_expr_recon_loss: 108446.8957; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154880.9508; val_optim_loss: 154880.9508
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8962; val_auprc_score: 0.9870; val_best_acc_score: 0.9542; val_best_f1_score: 0.9757; train_kl_reg_loss: 1774.6816; train_edge_recon_loss: 42646.2882; train_gene_expr_recon_loss: 107699.9079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152120.8774; train_optim_loss: 152120.8774; val_kl_reg_loss: 1749.7635; val_edge_recon_loss: 41467.6312; val_gene_expr_recon_loss: 107167.9633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 150385.3572; val_optim_loss: 150385.3572
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9185; val_auprc_score: 0.9892; val_best_acc_score: 0.9604; val_best_f1_score: 0.9790; train_kl_reg_loss: 1851.5933; train_edge_recon_loss: 42188.5857; train_gene_expr_recon_loss: 106406.0138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 150446.1924; train_optim_loss: 150446.1924; val_kl_reg_loss: 1739.4360; val_edge_recon_loss: 40125.6492; val_gene_expr_recon_loss: 106306.8732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148171.9588; val_optim_loss: 148171.9588
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9279; val_auprc_score: 0.9914; val_best_acc_score: 0.9646; val_best_f1_score: 0.9811; train_kl_reg_loss: 1868.1641; train_edge_recon_loss: 42454.2935; train_gene_expr_recon_loss: 105335.9663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 149658.4241; train_optim_loss: 149658.4241; val_kl_reg_loss: 1806.6403; val_edge_recon_loss: 40029.4115; val_gene_expr_recon_loss: 105247.3889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147083.4404; val_optim_loss: 147083.4404
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9323; val_auprc_score: 0.9905; val_best_acc_score: 0.9667; val_best_f1_score: 0.9822; train_kl_reg_loss: 1907.1954; train_edge_recon_loss: 40270.0092; train_gene_expr_recon_loss: 104379.5846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146556.7893; train_optim_loss: 146556.7893; val_kl_reg_loss: 1900.0243; val_edge_recon_loss: 40035.3979; val_gene_expr_recon_loss: 104157.3400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146092.7617; val_optim_loss: 146092.7617
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9338; val_auprc_score: 0.9911; val_best_acc_score: 0.9673; val_best_f1_score: 0.9825; train_kl_reg_loss: 1922.9252; train_edge_recon_loss: 41466.5723; train_gene_expr_recon_loss: 103671.1296; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 147060.6271; train_optim_loss: 147060.6271; val_kl_reg_loss: 1928.4204; val_edge_recon_loss: 41964.5963; val_gene_expr_recon_loss: 103550.5875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147443.6039; val_optim_loss: 147443.6039
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9409; val_auprc_score: 0.9918; val_best_acc_score: 0.9712; val_best_f1_score: 0.9846; train_kl_reg_loss: 1961.7038; train_edge_recon_loss: 40408.9280; train_gene_expr_recon_loss: 103023.7070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145394.3384; train_optim_loss: 145394.3384; val_kl_reg_loss: 1951.4058; val_edge_recon_loss: 38796.0647; val_gene_expr_recon_loss: 103188.6451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143936.1166; val_optim_loss: 143936.1166
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9508; val_auprc_score: 0.9935; val_best_acc_score: 0.9726; val_best_f1_score: 0.9853; train_kl_reg_loss: 1962.2162; train_edge_recon_loss: 40082.4583; train_gene_expr_recon_loss: 102521.1536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144565.8280; train_optim_loss: 144565.8280; val_kl_reg_loss: 1919.5140; val_edge_recon_loss: 39955.2786; val_gene_expr_recon_loss: 102537.1461; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144411.9383; val_optim_loss: 144411.9383
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9542; val_auprc_score: 0.9949; val_best_acc_score: 0.9721; val_best_f1_score: 0.9851; train_kl_reg_loss: 1964.0491; train_edge_recon_loss: 40284.7165; train_gene_expr_recon_loss: 102007.3445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144256.1103; train_optim_loss: 144256.1103; val_kl_reg_loss: 1980.7838; val_edge_recon_loss: 39396.9606; val_gene_expr_recon_loss: 102623.7518; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144001.4965; val_optim_loss: 144001.4965
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9615; val_auprc_score: 0.9947; val_best_acc_score: 0.9760; val_best_f1_score: 0.9871; train_kl_reg_loss: 1967.8365; train_edge_recon_loss: 40507.9306; train_gene_expr_recon_loss: 101604.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144080.0797; train_optim_loss: 144080.0797; val_kl_reg_loss: 1889.5493; val_edge_recon_loss: 39729.6711; val_gene_expr_recon_loss: 101965.4424; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143584.6627; val_optim_loss: 143584.6627
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9570; val_auprc_score: 0.9946; val_best_acc_score: 0.9739; val_best_f1_score: 0.9860; train_kl_reg_loss: 1977.0066; train_edge_recon_loss: 40151.1661; train_gene_expr_recon_loss: 101220.5425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143348.7152; train_optim_loss: 143348.7152; val_kl_reg_loss: 1997.1546; val_edge_recon_loss: 41975.4614; val_gene_expr_recon_loss: 102377.1074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146349.7252; val_optim_loss: 146349.7252
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9616; val_auprc_score: 0.9938; val_best_acc_score: 0.9770; val_best_f1_score: 0.9877; train_kl_reg_loss: 1993.7939; train_edge_recon_loss: 40609.4186; train_gene_expr_recon_loss: 100875.0109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143478.2235; train_optim_loss: 143478.2235; val_kl_reg_loss: 1985.6154; val_edge_recon_loss: 39294.4908; val_gene_expr_recon_loss: 101653.5355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142933.6414; val_optim_loss: 142933.6414
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9683; val_auprc_score: 0.9960; val_best_acc_score: 0.9769; val_best_f1_score: 0.9876; train_kl_reg_loss: 2010.8163; train_edge_recon_loss: 40205.4810; train_gene_expr_recon_loss: 100619.6470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142835.9443; train_optim_loss: 142835.9443; val_kl_reg_loss: 2079.9196; val_edge_recon_loss: 40720.5789; val_gene_expr_recon_loss: 101327.9697; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144128.4670; val_optim_loss: 144128.4670
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9619; val_auprc_score: 0.9945; val_best_acc_score: 0.9762; val_best_f1_score: 0.9873; train_kl_reg_loss: 2017.2400; train_edge_recon_loss: 39913.8422; train_gene_expr_recon_loss: 100285.4540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142216.5365; train_optim_loss: 142216.5365; val_kl_reg_loss: 2008.1328; val_edge_recon_loss: 39745.9473; val_gene_expr_recon_loss: 101184.5129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142938.5938; val_optim_loss: 142938.5938
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9591; val_auprc_score: 0.9935; val_best_acc_score: 0.9769; val_best_f1_score: 0.9876; train_kl_reg_loss: 2019.3100; train_edge_recon_loss: 40341.4075; train_gene_expr_recon_loss: 99972.4021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142333.1200; train_optim_loss: 142333.1200; val_kl_reg_loss: 2014.2101; val_edge_recon_loss: 40425.4395; val_gene_expr_recon_loss: 100889.7676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143329.4158; val_optim_loss: 143329.4158

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9649; val_auprc_score: 0.9954; val_best_acc_score: 0.9795; val_best_f1_score: 0.9890; train_kl_reg_loss: 2031.4477; train_edge_recon_loss: 40264.5591; train_gene_expr_recon_loss: 98795.9032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141091.9098; train_optim_loss: 141091.9098; val_kl_reg_loss: 2017.9222; val_edge_recon_loss: 38038.4917; val_gene_expr_recon_loss: 100139.1684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140195.5826; val_optim_loss: 140195.5826
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9709; val_auprc_score: 0.9956; val_best_acc_score: 0.9795; val_best_f1_score: 0.9890; train_kl_reg_loss: 2028.5329; train_edge_recon_loss: 40079.4493; train_gene_expr_recon_loss: 98513.8030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140621.7849; train_optim_loss: 140621.7849; val_kl_reg_loss: 2005.7678; val_edge_recon_loss: 40110.6489; val_gene_expr_recon_loss: 100311.4463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142427.8617; val_optim_loss: 142427.8617
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9692; val_auprc_score: 0.9964; val_best_acc_score: 0.9789; val_best_f1_score: 0.9887; train_kl_reg_loss: 2032.6810; train_edge_recon_loss: 39470.9901; train_gene_expr_recon_loss: 98529.0891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140032.7601; train_optim_loss: 140032.7601; val_kl_reg_loss: 2028.2266; val_edge_recon_loss: 38773.1385; val_gene_expr_recon_loss: 100403.6381; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141205.0025; val_optim_loss: 141205.0025
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9715; val_auprc_score: 0.9963; val_best_acc_score: 0.9805; val_best_f1_score: 0.9895; train_kl_reg_loss: 2035.5891; train_edge_recon_loss: 39791.2267; train_gene_expr_recon_loss: 98373.3396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140200.1548; train_optim_loss: 140200.1548; val_kl_reg_loss: 2020.6458; val_edge_recon_loss: 40588.2910; val_gene_expr_recon_loss: 100118.6557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142727.5930; val_optim_loss: 142727.5930

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9791; val_auprc_score: 0.9973; val_best_acc_score: 0.9794; val_best_f1_score: 0.9889; train_kl_reg_loss: 2033.7853; train_edge_recon_loss: 40635.6593; train_gene_expr_recon_loss: 98284.5706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140954.0148; train_optim_loss: 140954.0148; val_kl_reg_loss: 2024.8343; val_edge_recon_loss: 41209.5928; val_gene_expr_recon_loss: 100284.1273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143518.5537; val_optim_loss: 143518.5537
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9651; val_auprc_score: 0.9946; val_best_acc_score: 0.9788; val_best_f1_score: 0.9886; train_kl_reg_loss: 2038.1079; train_edge_recon_loss: 40029.5337; train_gene_expr_recon_loss: 98167.0693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140234.7105; train_optim_loss: 140234.7105; val_kl_reg_loss: 2016.5285; val_edge_recon_loss: 39314.5351; val_gene_expr_recon_loss: 100532.4596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141863.5215; val_optim_loss: 141863.5215
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9715; val_auprc_score: 0.9951; val_best_acc_score: 0.9803; val_best_f1_score: 0.9894; train_kl_reg_loss: 2025.9068; train_edge_recon_loss: 39444.2582; train_gene_expr_recon_loss: 98193.9295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139664.0943; train_optim_loss: 139664.0943; val_kl_reg_loss: 2016.3348; val_edge_recon_loss: 39310.0603; val_gene_expr_recon_loss: 100150.5785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141476.9732; val_optim_loss: 141476.9732

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 10 min 2 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
Val AUROC score: 0.9634
Val AUPRC score: 0.9948
Val best accuracy score: 0.9784
Val best F1 score: 0.9884
Val gene expr MSE score: 1.4745
Duration of model training in run 8: 0 hours, 10 minutes and 19 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 9813
Number of validation nodes: 1090
Number of training edges: 112803
Number of validation edges: 12533
Edge batch size: 128
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8439; val_auprc_score: 0.9786; val_best_acc_score: 0.9509; val_best_f1_score: 0.9739; train_kl_reg_loss: 1371.4037; train_edge_recon_loss: 45834.4867; train_gene_expr_recon_loss: 114601.7670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161807.6576; train_optim_loss: 161807.6576; val_kl_reg_loss: 1335.4526; val_edge_recon_loss: 42015.8163; val_gene_expr_recon_loss: 110542.5835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153893.8517; val_optim_loss: 153893.8517
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9182; val_auprc_score: 0.9912; val_best_acc_score: 0.9582; val_best_f1_score: 0.9778; train_kl_reg_loss: 1782.2357; train_edge_recon_loss: 42574.2487; train_gene_expr_recon_loss: 109275.3305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153631.8146; train_optim_loss: 153631.8146; val_kl_reg_loss: 1784.3296; val_edge_recon_loss: 39521.0304; val_gene_expr_recon_loss: 107418.3431; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148723.7034; val_optim_loss: 148723.7034
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9272; val_auprc_score: 0.9907; val_best_acc_score: 0.9645; val_best_f1_score: 0.9810; train_kl_reg_loss: 1853.1193; train_edge_recon_loss: 41040.1533; train_gene_expr_recon_loss: 106794.8191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 149688.0919; train_optim_loss: 149688.0919; val_kl_reg_loss: 1843.5956; val_edge_recon_loss: 40323.0122; val_gene_expr_recon_loss: 105391.4613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147558.0692; val_optim_loss: 147558.0692
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9264; val_auprc_score: 0.9891; val_best_acc_score: 0.9668; val_best_f1_score: 0.9822; train_kl_reg_loss: 1902.8938; train_edge_recon_loss: 41777.4091; train_gene_expr_recon_loss: 105082.3431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 148762.6457; train_optim_loss: 148762.6457; val_kl_reg_loss: 1899.4149; val_edge_recon_loss: 41497.4894; val_gene_expr_recon_loss: 104375.5357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147772.4406; val_optim_loss: 147772.4406
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9537; val_auprc_score: 0.9949; val_best_acc_score: 0.9717; val_best_f1_score: 0.9848; train_kl_reg_loss: 1924.2661; train_edge_recon_loss: 40678.8963; train_gene_expr_recon_loss: 103852.3344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146455.4971; train_optim_loss: 146455.4971; val_kl_reg_loss: 2011.1440; val_edge_recon_loss: 40065.0778; val_gene_expr_recon_loss: 103353.8115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145430.0340; val_optim_loss: 145430.0340
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9552; val_auprc_score: 0.9949; val_best_acc_score: 0.9732; val_best_f1_score: 0.9857; train_kl_reg_loss: 1959.3638; train_edge_recon_loss: 40602.1879; train_gene_expr_recon_loss: 102838.0527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145399.6044; train_optim_loss: 145399.6044; val_kl_reg_loss: 1922.9338; val_edge_recon_loss: 39097.9391; val_gene_expr_recon_loss: 102444.5241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143465.3968; val_optim_loss: 143465.3968
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9637; val_auprc_score: 0.9952; val_best_acc_score: 0.9756; val_best_f1_score: 0.9869; train_kl_reg_loss: 1973.6225; train_edge_recon_loss: 40615.9221; train_gene_expr_recon_loss: 102100.5890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144690.1334; train_optim_loss: 144690.1334; val_kl_reg_loss: 1897.9396; val_edge_recon_loss: 39027.8697; val_gene_expr_recon_loss: 101817.5127; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142743.3220; val_optim_loss: 142743.3220
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9608; val_auprc_score: 0.9944; val_best_acc_score: 0.9761; val_best_f1_score: 0.9872; train_kl_reg_loss: 1991.8428; train_edge_recon_loss: 40528.6022; train_gene_expr_recon_loss: 101464.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143985.3201; train_optim_loss: 143985.3201; val_kl_reg_loss: 2045.5236; val_edge_recon_loss: 37750.5448; val_gene_expr_recon_loss: 101096.4980; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140892.5662; val_optim_loss: 140892.5662
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9631; val_auprc_score: 0.9949; val_best_acc_score: 0.9779; val_best_f1_score: 0.9882; train_kl_reg_loss: 2013.8530; train_edge_recon_loss: 40507.0103; train_gene_expr_recon_loss: 100891.3349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143412.1984; train_optim_loss: 143412.1984; val_kl_reg_loss: 1938.5843; val_edge_recon_loss: 38751.2973; val_gene_expr_recon_loss: 100910.4377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141600.3194; val_optim_loss: 141600.3194
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9676; val_auprc_score: 0.9948; val_best_acc_score: 0.9812; val_best_f1_score: 0.9899; train_kl_reg_loss: 2012.1081; train_edge_recon_loss: 39936.9737; train_gene_expr_recon_loss: 100510.4317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142459.5135; train_optim_loss: 142459.5135; val_kl_reg_loss: 1968.5675; val_edge_recon_loss: 37195.0999; val_gene_expr_recon_loss: 100561.2223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139724.8893; val_optim_loss: 139724.8893
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9649; val_auprc_score: 0.9933; val_best_acc_score: 0.9783; val_best_f1_score: 0.9883; train_kl_reg_loss: 2026.5620; train_edge_recon_loss: 39931.8913; train_gene_expr_recon_loss: 100022.6109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141981.0642; train_optim_loss: 141981.0642; val_kl_reg_loss: 2013.8494; val_edge_recon_loss: 40293.1989; val_gene_expr_recon_loss: 100642.1236; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142949.1718; val_optim_loss: 142949.1718
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9735; val_auprc_score: 0.9964; val_best_acc_score: 0.9807; val_best_f1_score: 0.9896; train_kl_reg_loss: 2051.0626; train_edge_recon_loss: 40073.2892; train_gene_expr_recon_loss: 99719.0653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141843.4171; train_optim_loss: 141843.4171; val_kl_reg_loss: 2107.7775; val_edge_recon_loss: 40628.4665; val_gene_expr_recon_loss: 100315.8589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143052.1028; val_optim_loss: 143052.1028
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9761; val_auprc_score: 0.9963; val_best_acc_score: 0.9828; val_best_f1_score: 0.9907; train_kl_reg_loss: 2086.5003; train_edge_recon_loss: 40649.1048; train_gene_expr_recon_loss: 99420.8235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142156.4287; train_optim_loss: 142156.4287; val_kl_reg_loss: 2116.6705; val_edge_recon_loss: 37950.1092; val_gene_expr_recon_loss: 99879.2835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139946.0637; val_optim_loss: 139946.0637

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9734; val_auprc_score: 0.9966; val_best_acc_score: 0.9826; val_best_f1_score: 0.9906; train_kl_reg_loss: 2089.4232; train_edge_recon_loss: 39523.9598; train_gene_expr_recon_loss: 98396.4627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140009.8456; train_optim_loss: 140009.8456; val_kl_reg_loss: 2085.9513; val_edge_recon_loss: 40530.7166; val_gene_expr_recon_loss: 99684.7192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142301.3870; val_optim_loss: 142301.3870
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9703; val_auprc_score: 0.9957; val_best_acc_score: 0.9830; val_best_f1_score: 0.9909; train_kl_reg_loss: 2080.2991; train_edge_recon_loss: 39469.0557; train_gene_expr_recon_loss: 98274.4636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139823.8182; train_optim_loss: 139823.8182; val_kl_reg_loss: 2046.0812; val_edge_recon_loss: 37119.3650; val_gene_expr_recon_loss: 99900.6056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139066.0521; val_optim_loss: 139066.0521
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9731; val_auprc_score: 0.9956; val_best_acc_score: 0.9833; val_best_f1_score: 0.9911; train_kl_reg_loss: 2072.7601; train_edge_recon_loss: 40146.4937; train_gene_expr_recon_loss: 98071.0046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140290.2584; train_optim_loss: 140290.2584; val_kl_reg_loss: 2064.6201; val_edge_recon_loss: 37125.5204; val_gene_expr_recon_loss: 99839.2789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139029.4199; val_optim_loss: 139029.4199
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9728; val_auprc_score: 0.9958; val_best_acc_score: 0.9820; val_best_f1_score: 0.9903; train_kl_reg_loss: 2072.5908; train_edge_recon_loss: 39547.3852; train_gene_expr_recon_loss: 98065.7022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139685.6786; train_optim_loss: 139685.6786; val_kl_reg_loss: 2066.0662; val_edge_recon_loss: 39779.7409; val_gene_expr_recon_loss: 99645.9035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141491.7101; val_optim_loss: 141491.7101
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9745; val_auprc_score: 0.9962; val_best_acc_score: 0.9842; val_best_f1_score: 0.9915; train_kl_reg_loss: 2070.7695; train_edge_recon_loss: 39558.5724; train_gene_expr_recon_loss: 97950.0510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139579.3928; train_optim_loss: 139579.3928; val_kl_reg_loss: 2068.6018; val_edge_recon_loss: 38329.4341; val_gene_expr_recon_loss: 99576.6445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139974.6802; val_optim_loss: 139974.6802
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9717; val_auprc_score: 0.9954; val_best_acc_score: 0.9837; val_best_f1_score: 0.9913; train_kl_reg_loss: 2069.0075; train_edge_recon_loss: 39675.4286; train_gene_expr_recon_loss: 98020.4311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139764.8672; train_optim_loss: 139764.8672; val_kl_reg_loss: 2063.0125; val_edge_recon_loss: 38755.7668; val_gene_expr_recon_loss: 99798.9134; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140617.6928; val_optim_loss: 140617.6928

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9705; val_auprc_score: 0.9946; val_best_acc_score: 0.9824; val_best_f1_score: 0.9906; train_kl_reg_loss: 2079.2443; train_edge_recon_loss: 39997.4621; train_gene_expr_recon_loss: 97874.1254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139950.8320; train_optim_loss: 139950.8320; val_kl_reg_loss: 2067.8096; val_edge_recon_loss: 39159.3613; val_gene_expr_recon_loss: 99670.8729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140898.0434; val_optim_loss: 140898.0434
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9743; val_auprc_score: 0.9958; val_best_acc_score: 0.9839; val_best_f1_score: 0.9914; train_kl_reg_loss: 2082.0918; train_edge_recon_loss: 39133.6860; train_gene_expr_recon_loss: 97774.9575; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138990.7352; train_optim_loss: 138990.7352; val_kl_reg_loss: 2069.4077; val_edge_recon_loss: 39430.8170; val_gene_expr_recon_loss: 99549.6842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141049.9082; val_optim_loss: 141049.9082
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9756; val_auprc_score: 0.9967; val_best_acc_score: 0.9820; val_best_f1_score: 0.9903; train_kl_reg_loss: 2083.8173; train_edge_recon_loss: 39584.0375; train_gene_expr_recon_loss: 97831.1095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139498.9646; train_optim_loss: 139498.9646; val_kl_reg_loss: 2071.2806; val_edge_recon_loss: 39729.1352; val_gene_expr_recon_loss: 99392.8111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141193.2270; val_optim_loss: 141193.2270

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 20 min 37 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
Val AUROC score: 0.9772
Val AUPRC score: 0.9965
Val best accuracy score: 0.9823
Val best F1 score: 0.9905
Val gene expr MSE score: 1.2367
Duration of model training in run 9: 0 hours, 21 minutes and 17 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 9813
Number of validation nodes: 1090
Number of training edges: 112803
Number of validation edges: 12533
Edge batch size: 128
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8245; val_auprc_score: 0.9760; val_best_acc_score: 0.9478; val_best_f1_score: 0.9723; train_kl_reg_loss: 1349.0770; train_edge_recon_loss: 44887.5330; train_gene_expr_recon_loss: 114113.2968; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160349.9069; train_optim_loss: 160349.9069; val_kl_reg_loss: 1571.1196; val_edge_recon_loss: 43181.0338; val_gene_expr_recon_loss: 112837.5800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157589.7332; val_optim_loss: 157589.7332
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9092; val_auprc_score: 0.9890; val_best_acc_score: 0.9611; val_best_f1_score: 0.9793; train_kl_reg_loss: 1759.3653; train_edge_recon_loss: 42046.2969; train_gene_expr_recon_loss: 108911.6808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152717.3429; train_optim_loss: 152717.3429; val_kl_reg_loss: 1850.9814; val_edge_recon_loss: 39614.4457; val_gene_expr_recon_loss: 110117.4285; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 151582.8563; val_optim_loss: 151582.8563
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9153; val_auprc_score: 0.9889; val_best_acc_score: 0.9628; val_best_f1_score: 0.9801; train_kl_reg_loss: 1801.4130; train_edge_recon_loss: 41448.3215; train_gene_expr_recon_loss: 106471.5454; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 149721.2800; train_optim_loss: 149721.2800; val_kl_reg_loss: 1759.5749; val_edge_recon_loss: 40262.0143; val_gene_expr_recon_loss: 108145.5521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 150167.1417; val_optim_loss: 150167.1417
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9329; val_auprc_score: 0.9921; val_best_acc_score: 0.9628; val_best_f1_score: 0.9801; train_kl_reg_loss: 1899.5158; train_edge_recon_loss: 41326.1145; train_gene_expr_recon_loss: 104685.4868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 147911.1169; train_optim_loss: 147911.1169; val_kl_reg_loss: 1945.4437; val_edge_recon_loss: 41829.1123; val_gene_expr_recon_loss: 106762.8948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 150537.4513; val_optim_loss: 150537.4513
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9413; val_auprc_score: 0.9925; val_best_acc_score: 0.9704; val_best_f1_score: 0.9842; train_kl_reg_loss: 1928.4937; train_edge_recon_loss: 40483.1942; train_gene_expr_recon_loss: 103493.9666; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145905.6544; train_optim_loss: 145905.6544; val_kl_reg_loss: 1935.4637; val_edge_recon_loss: 39402.5721; val_gene_expr_recon_loss: 105931.9790; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147270.0154; val_optim_loss: 147270.0154
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9617; val_auprc_score: 0.9939; val_best_acc_score: 0.9731; val_best_f1_score: 0.9856; train_kl_reg_loss: 1963.3096; train_edge_recon_loss: 40395.2456; train_gene_expr_recon_loss: 102442.0475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144800.6027; train_optim_loss: 144800.6027; val_kl_reg_loss: 1963.8989; val_edge_recon_loss: 38968.5814; val_gene_expr_recon_loss: 105068.9835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146001.4637; val_optim_loss: 146001.4637
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9578; val_auprc_score: 0.9944; val_best_acc_score: 0.9739; val_best_f1_score: 0.9860; train_kl_reg_loss: 1985.6116; train_edge_recon_loss: 40922.6956; train_gene_expr_recon_loss: 101683.4625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144591.7695; train_optim_loss: 144591.7695; val_kl_reg_loss: 1979.9791; val_edge_recon_loss: 39853.2598; val_gene_expr_recon_loss: 104728.3850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146561.6248; val_optim_loss: 146561.6248
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9572; val_auprc_score: 0.9937; val_best_acc_score: 0.9768; val_best_f1_score: 0.9876; train_kl_reg_loss: 2001.1034; train_edge_recon_loss: 39706.9141; train_gene_expr_recon_loss: 101091.6797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142799.6971; train_optim_loss: 142799.6971; val_kl_reg_loss: 2059.7370; val_edge_recon_loss: 38293.1074; val_gene_expr_recon_loss: 104082.6223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144435.4666; val_optim_loss: 144435.4666
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9535; val_auprc_score: 0.9928; val_best_acc_score: 0.9769; val_best_f1_score: 0.9876; train_kl_reg_loss: 2012.7394; train_edge_recon_loss: 40796.8698; train_gene_expr_recon_loss: 100506.6270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143316.2361; train_optim_loss: 143316.2361; val_kl_reg_loss: 2073.6114; val_edge_recon_loss: 39141.2301; val_gene_expr_recon_loss: 103850.6021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145065.4434; val_optim_loss: 145065.4434
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9694; val_auprc_score: 0.9954; val_best_acc_score: 0.9774; val_best_f1_score: 0.9879; train_kl_reg_loss: 2022.4403; train_edge_recon_loss: 39366.2643; train_gene_expr_recon_loss: 100075.9716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141464.6761; train_optim_loss: 141464.6761; val_kl_reg_loss: 2077.6159; val_edge_recon_loss: 40825.3556; val_gene_expr_recon_loss: 103178.0353; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146081.0075; val_optim_loss: 146081.0075
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9702; val_auprc_score: 0.9961; val_best_acc_score: 0.9797; val_best_f1_score: 0.9891; train_kl_reg_loss: 2052.1478; train_edge_recon_loss: 40674.3031; train_gene_expr_recon_loss: 99723.1049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142449.5556; train_optim_loss: 142449.5556; val_kl_reg_loss: 1965.7663; val_edge_recon_loss: 39790.3558; val_gene_expr_recon_loss: 103585.0786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145341.2000; val_optim_loss: 145341.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9714; val_auprc_score: 0.9963; val_best_acc_score: 0.9826; val_best_f1_score: 0.9906; train_kl_reg_loss: 2046.7785; train_edge_recon_loss: 39444.7716; train_gene_expr_recon_loss: 98607.4200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140098.9702; train_optim_loss: 140098.9702; val_kl_reg_loss: 2050.4848; val_edge_recon_loss: 38909.7662; val_gene_expr_recon_loss: 102773.8817; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143734.1323; val_optim_loss: 143734.1323
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9771; val_auprc_score: 0.9972; val_best_acc_score: 0.9859; val_best_f1_score: 0.9924; train_kl_reg_loss: 2050.7802; train_edge_recon_loss: 39864.7767; train_gene_expr_recon_loss: 98347.0293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140262.5861; train_optim_loss: 140262.5861; val_kl_reg_loss: 2031.1766; val_edge_recon_loss: 37201.8506; val_gene_expr_recon_loss: 102625.8852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141858.9125; val_optim_loss: 141858.9125
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9679; val_auprc_score: 0.9946; val_best_acc_score: 0.9822; val_best_f1_score: 0.9904; train_kl_reg_loss: 2051.0448; train_edge_recon_loss: 39954.9923; train_gene_expr_recon_loss: 98172.9300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140178.9670; train_optim_loss: 140178.9670; val_kl_reg_loss: 2003.4434; val_edge_recon_loss: 39659.5326; val_gene_expr_recon_loss: 102563.8661; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144226.8418; val_optim_loss: 144226.8418
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9745; val_auprc_score: 0.9960; val_best_acc_score: 0.9824; val_best_f1_score: 0.9906; train_kl_reg_loss: 2034.9680; train_edge_recon_loss: 39829.8866; train_gene_expr_recon_loss: 98238.4523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140103.3070; train_optim_loss: 140103.3070; val_kl_reg_loss: 2033.2889; val_edge_recon_loss: 39377.6045; val_gene_expr_recon_loss: 102266.5831; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143677.4766; val_optim_loss: 143677.4766
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9666; val_auprc_score: 0.9949; val_best_acc_score: 0.9830; val_best_f1_score: 0.9908; train_kl_reg_loss: 2046.7289; train_edge_recon_loss: 39919.1394; train_gene_expr_recon_loss: 98204.7170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140170.5856; train_optim_loss: 140170.5856; val_kl_reg_loss: 2030.6573; val_edge_recon_loss: 40288.0864; val_gene_expr_recon_loss: 102149.0960; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144467.8390; val_optim_loss: 144467.8390

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9746; val_auprc_score: 0.9963; val_best_acc_score: 0.9844; val_best_f1_score: 0.9916; train_kl_reg_loss: 2038.4869; train_edge_recon_loss: 39692.7124; train_gene_expr_recon_loss: 97798.4802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139529.6794; train_optim_loss: 139529.6794; val_kl_reg_loss: 2036.6541; val_edge_recon_loss: 39008.6426; val_gene_expr_recon_loss: 102435.9493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143481.2460; val_optim_loss: 143481.2460
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9787; val_auprc_score: 0.9962; val_best_acc_score: 0.9844; val_best_f1_score: 0.9916; train_kl_reg_loss: 2039.4813; train_edge_recon_loss: 39593.0563; train_gene_expr_recon_loss: 97873.0886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139505.6262; train_optim_loss: 139505.6262; val_kl_reg_loss: 2038.8750; val_edge_recon_loss: 37052.6115; val_gene_expr_recon_loss: 102104.3874; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141195.8742; val_optim_loss: 141195.8742
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9730; val_auprc_score: 0.9943; val_best_acc_score: 0.9844; val_best_f1_score: 0.9916; train_kl_reg_loss: 2046.2307; train_edge_recon_loss: 39956.5767; train_gene_expr_recon_loss: 97948.1729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139950.9803; train_optim_loss: 139950.9803; val_kl_reg_loss: 2037.4564; val_edge_recon_loss: 39351.9194; val_gene_expr_recon_loss: 102363.6523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143753.0278; val_optim_loss: 143753.0278
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9768; val_auprc_score: 0.9957; val_best_acc_score: 0.9838; val_best_f1_score: 0.9913; train_kl_reg_loss: 2044.7738; train_edge_recon_loss: 40259.0093; train_gene_expr_recon_loss: 97994.1022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140297.8853; train_optim_loss: 140297.8853; val_kl_reg_loss: 2032.5569; val_edge_recon_loss: 40008.4307; val_gene_expr_recon_loss: 102381.9890; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144422.9765; val_optim_loss: 144422.9765
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9727; val_auprc_score: 0.9958; val_best_acc_score: 0.9845; val_best_f1_score: 0.9917; train_kl_reg_loss: 2040.3965; train_edge_recon_loss: 39853.9803; train_gene_expr_recon_loss: 97903.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139797.4080; train_optim_loss: 139797.4080; val_kl_reg_loss: 2028.4146; val_edge_recon_loss: 39135.2921; val_gene_expr_recon_loss: 102448.2777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143611.9848; val_optim_loss: 143611.9848

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9692; val_auprc_score: 0.9965; val_best_acc_score: 0.9817; val_best_f1_score: 0.9902; train_kl_reg_loss: 2035.1435; train_edge_recon_loss: 39523.3176; train_gene_expr_recon_loss: 97883.2306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139441.6916; train_optim_loss: 139441.6916; val_kl_reg_loss: 2028.3021; val_edge_recon_loss: 40011.4868; val_gene_expr_recon_loss: 102521.6505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144561.4388; val_optim_loss: 144561.4388
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9655; val_auprc_score: 0.9946; val_best_acc_score: 0.9842; val_best_f1_score: 0.9915; train_kl_reg_loss: 2034.5533; train_edge_recon_loss: 39142.2382; train_gene_expr_recon_loss: 97845.1687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139021.9606; train_optim_loss: 139021.9606; val_kl_reg_loss: 2027.6531; val_edge_recon_loss: 37892.6171; val_gene_expr_recon_loss: 102441.6748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142361.9449; val_optim_loss: 142361.9449
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9727; val_auprc_score: 0.9953; val_best_acc_score: 0.9844; val_best_f1_score: 0.9916; train_kl_reg_loss: 2034.4216; train_edge_recon_loss: 39588.4841; train_gene_expr_recon_loss: 97872.3599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139495.2657; train_optim_loss: 139495.2657; val_kl_reg_loss: 2026.0179; val_edge_recon_loss: 40109.9520; val_gene_expr_recon_loss: 102047.2329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144183.2029; val_optim_loss: 144183.2029

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 23 min 46 sec.
Using best model state, which was in epoch 18.

--- MODEL EVALUATION ---
Val AUROC score: 0.9718
Val AUPRC score: 0.9960
Val best accuracy score: 0.9817
Val best F1 score: 0.9902
Val gene expr MSE score: 1.4286
Duration of model training in run 10: 0 hours, 24 minutes and 26 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
First script finished. Launching follow up script.
Run timestamp: 03062023_024419.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '2048', '2048', '1024', '1024', '512', '512', '256', '256', '128', '128', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'Main_molecular_cell_type', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'starmap_plus_mouse_cns_subsample_5pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', 'batch9', 'batch10', 'batch11', 'batch12', 'batch13', 'batch14', 'batch15', 'batch16', 'batch17', 'batch18', 'batch19', 'batch20', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 49099
Number of validation nodes: 5456
Number of training edges: 117324
Number of validation edges: 13036
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7884; val_auprc_score: 0.9717; val_best_acc_score: 0.9408; val_best_f1_score: 0.9687; train_kl_reg_loss: 935.0069; train_edge_recon_loss: 49155.7025; train_gene_expr_recon_loss: 120620.2398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170710.9494; train_optim_loss: 170710.9494; val_kl_reg_loss: 1533.6004; val_edge_recon_loss: 45184.6758; val_gene_expr_recon_loss: 113995.3638; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160713.6429; val_optim_loss: 160713.6429
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8311; val_auprc_score: 0.9790; val_best_acc_score: 0.9449; val_best_f1_score: 0.9708; train_kl_reg_loss: 1803.3631; train_edge_recon_loss: 44485.9842; train_gene_expr_recon_loss: 111549.5787; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157838.9254; train_optim_loss: 157838.9254; val_kl_reg_loss: 1873.5884; val_edge_recon_loss: 42419.5647; val_gene_expr_recon_loss: 111891.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156184.9353; val_optim_loss: 156184.9353
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8611; val_auprc_score: 0.9833; val_best_acc_score: 0.9445; val_best_f1_score: 0.9707; train_kl_reg_loss: 1967.3577; train_edge_recon_loss: 43266.9379; train_gene_expr_recon_loss: 109951.5801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155185.8758; train_optim_loss: 155185.8758; val_kl_reg_loss: 1907.7475; val_edge_recon_loss: 43524.4872; val_gene_expr_recon_loss: 110255.3147; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155687.5536; val_optim_loss: 155687.5536
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8871; val_auprc_score: 0.9876; val_best_acc_score: 0.9440; val_best_f1_score: 0.9703; train_kl_reg_loss: 2034.1018; train_edge_recon_loss: 42085.1818; train_gene_expr_recon_loss: 108670.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152789.9022; train_optim_loss: 152789.9022; val_kl_reg_loss: 1921.8690; val_edge_recon_loss: 43951.8655; val_gene_expr_recon_loss: 109108.7009; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154982.4353; val_optim_loss: 154982.4353
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8935; val_auprc_score: 0.9880; val_best_acc_score: 0.9511; val_best_f1_score: 0.9740; train_kl_reg_loss: 2065.5303; train_edge_recon_loss: 41722.2407; train_gene_expr_recon_loss: 107887.5461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 151675.3163; train_optim_loss: 151675.3163; val_kl_reg_loss: 2064.5949; val_edge_recon_loss: 41760.8934; val_gene_expr_recon_loss: 108147.6116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 151973.0982; val_optim_loss: 151973.0982
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9104; val_auprc_score: 0.9904; val_best_acc_score: 0.9509; val_best_f1_score: 0.9738; train_kl_reg_loss: 2097.4433; train_edge_recon_loss: 41710.3233; train_gene_expr_recon_loss: 107230.8006; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 151038.5676; train_optim_loss: 151038.5676; val_kl_reg_loss: 2068.5296; val_edge_recon_loss: 42090.5960; val_gene_expr_recon_loss: 108346.2589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152505.3839; val_optim_loss: 152505.3839
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9182; val_auprc_score: 0.9908; val_best_acc_score: 0.9506; val_best_f1_score: 0.9737; train_kl_reg_loss: 2104.4987; train_edge_recon_loss: 41459.1811; train_gene_expr_recon_loss: 106731.4124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 150295.0921; train_optim_loss: 150295.0921; val_kl_reg_loss: 2173.4235; val_edge_recon_loss: 41121.6127; val_gene_expr_recon_loss: 107402.6083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 150697.6406; val_optim_loss: 150697.6406
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9215; val_auprc_score: 0.9917; val_best_acc_score: 0.9520; val_best_f1_score: 0.9743; train_kl_reg_loss: 2074.4106; train_edge_recon_loss: 41776.3607; train_gene_expr_recon_loss: 105963.5928; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 149814.3640; train_optim_loss: 149814.3640; val_kl_reg_loss: 1953.5582; val_edge_recon_loss: 43721.5391; val_gene_expr_recon_loss: 107071.7121; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152746.8103; val_optim_loss: 152746.8103
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9134; val_auprc_score: 0.9903; val_best_acc_score: 0.9506; val_best_f1_score: 0.9737; train_kl_reg_loss: 2077.3089; train_edge_recon_loss: 41030.8765; train_gene_expr_recon_loss: 105444.1315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 148552.3157; train_optim_loss: 148552.3157; val_kl_reg_loss: 2022.6277; val_edge_recon_loss: 42575.4989; val_gene_expr_recon_loss: 105861.3192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 150459.4464; val_optim_loss: 150459.4464
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9251; val_auprc_score: 0.9921; val_best_acc_score: 0.9553; val_best_f1_score: 0.9762; train_kl_reg_loss: 2093.7579; train_edge_recon_loss: 40990.1556; train_gene_expr_recon_loss: 104922.0383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 148005.9523; train_optim_loss: 148005.9523; val_kl_reg_loss: 2038.9305; val_edge_recon_loss: 40734.4727; val_gene_expr_recon_loss: 106083.6752; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148857.0759; val_optim_loss: 148857.0759
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9218; val_auprc_score: 0.9908; val_best_acc_score: 0.9558; val_best_f1_score: 0.9764; train_kl_reg_loss: 2097.2996; train_edge_recon_loss: 40933.6370; train_gene_expr_recon_loss: 104584.4911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 147615.4273; train_optim_loss: 147615.4273; val_kl_reg_loss: 2092.0365; val_edge_recon_loss: 42840.9492; val_gene_expr_recon_loss: 105758.2857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 150691.2723; val_optim_loss: 150691.2723
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9302; val_auprc_score: 0.9919; val_best_acc_score: 0.9538; val_best_f1_score: 0.9752; train_kl_reg_loss: 2104.1287; train_edge_recon_loss: 40424.8749; train_gene_expr_recon_loss: 104274.5405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146803.5442; train_optim_loss: 146803.5442; val_kl_reg_loss: 1991.1000; val_edge_recon_loss: 43650.2807; val_gene_expr_recon_loss: 105027.2433; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 150668.6228; val_optim_loss: 150668.6228
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9340; val_auprc_score: 0.9923; val_best_acc_score: 0.9551; val_best_f1_score: 0.9760; train_kl_reg_loss: 2089.5490; train_edge_recon_loss: 40807.0977; train_gene_expr_recon_loss: 103724.9359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146621.5819; train_optim_loss: 146621.5819; val_kl_reg_loss: 2057.8650; val_edge_recon_loss: 43505.3566; val_gene_expr_recon_loss: 104545.9632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 150109.1830; val_optim_loss: 150109.1830

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9341; val_auprc_score: 0.9918; val_best_acc_score: 0.9547; val_best_f1_score: 0.9757; train_kl_reg_loss: 2098.1079; train_edge_recon_loss: 40115.0692; train_gene_expr_recon_loss: 103201.9848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145415.1619; train_optim_loss: 145415.1619; val_kl_reg_loss: 2050.0142; val_edge_recon_loss: 43551.9314; val_gene_expr_recon_loss: 104978.6685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 150580.6161; val_optim_loss: 150580.6161
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9350; val_auprc_score: 0.9933; val_best_acc_score: 0.9579; val_best_f1_score: 0.9776; train_kl_reg_loss: 2097.0209; train_edge_recon_loss: 40588.2943; train_gene_expr_recon_loss: 103097.5578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145782.8718; train_optim_loss: 145782.8718; val_kl_reg_loss: 2078.8042; val_edge_recon_loss: 40234.5491; val_gene_expr_recon_loss: 104078.2835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146391.6339; val_optim_loss: 146391.6339
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9268; val_auprc_score: 0.9915; val_best_acc_score: 0.9541; val_best_f1_score: 0.9755; train_kl_reg_loss: 2100.5934; train_edge_recon_loss: 40524.7476; train_gene_expr_recon_loss: 102810.8176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145436.1595; train_optim_loss: 145436.1595; val_kl_reg_loss: 2096.2903; val_edge_recon_loss: 43813.0742; val_gene_expr_recon_loss: 104498.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 150408.0982; val_optim_loss: 150408.0982
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9336; val_auprc_score: 0.9925; val_best_acc_score: 0.9554; val_best_f1_score: 0.9762; train_kl_reg_loss: 2089.5133; train_edge_recon_loss: 40643.8130; train_gene_expr_recon_loss: 102990.5166; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145723.8438; train_optim_loss: 145723.8438; val_kl_reg_loss: 2038.0333; val_edge_recon_loss: 42251.4994; val_gene_expr_recon_loss: 104379.7879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148669.3214; val_optim_loss: 148669.3214
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9318; val_auprc_score: 0.9931; val_best_acc_score: 0.9542; val_best_f1_score: 0.9756; train_kl_reg_loss: 2097.0474; train_edge_recon_loss: 40905.0684; train_gene_expr_recon_loss: 103060.0385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146062.1544; train_optim_loss: 146062.1544; val_kl_reg_loss: 2025.3193; val_edge_recon_loss: 40979.7065; val_gene_expr_recon_loss: 104301.3471; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147306.3728; val_optim_loss: 147306.3728

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9342; val_auprc_score: 0.9938; val_best_acc_score: 0.9591; val_best_f1_score: 0.9783; train_kl_reg_loss: 2075.9593; train_edge_recon_loss: 40759.6568; train_gene_expr_recon_loss: 102899.8390; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145735.4550; train_optim_loss: 145735.4550; val_kl_reg_loss: 2041.8439; val_edge_recon_loss: 38729.0675; val_gene_expr_recon_loss: 104583.5513; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145354.4598; val_optim_loss: 145354.4598
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9330; val_auprc_score: 0.9932; val_best_acc_score: 0.9550; val_best_f1_score: 0.9760; train_kl_reg_loss: 2091.6087; train_edge_recon_loss: 40420.5614; train_gene_expr_recon_loss: 102856.3623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145368.5321; train_optim_loss: 145368.5321; val_kl_reg_loss: 2043.3308; val_edge_recon_loss: 41837.4107; val_gene_expr_recon_loss: 103785.1150; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147665.8571; val_optim_loss: 147665.8571
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9312; val_auprc_score: 0.9925; val_best_acc_score: 0.9550; val_best_f1_score: 0.9760; train_kl_reg_loss: 2090.9898; train_edge_recon_loss: 40505.8548; train_gene_expr_recon_loss: 102778.7571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145375.6008; train_optim_loss: 145375.6008; val_kl_reg_loss: 2044.4020; val_edge_recon_loss: 42179.3443; val_gene_expr_recon_loss: 104409.3259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148633.0670; val_optim_loss: 148633.0670
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9370; val_auprc_score: 0.9927; val_best_acc_score: 0.9572; val_best_f1_score: 0.9771; train_kl_reg_loss: 2093.0176; train_edge_recon_loss: 41275.8139; train_gene_expr_recon_loss: 102845.9351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146214.7654; train_optim_loss: 146214.7654; val_kl_reg_loss: 2047.9152; val_edge_recon_loss: 41449.5564; val_gene_expr_recon_loss: 104409.2366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147906.7076; val_optim_loss: 147906.7076

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9279; val_auprc_score: 0.9919; val_best_acc_score: 0.9556; val_best_f1_score: 0.9763; train_kl_reg_loss: 2092.8960; train_edge_recon_loss: 40712.8671; train_gene_expr_recon_loss: 102800.6960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145606.4591; train_optim_loss: 145606.4591; val_kl_reg_loss: 2048.9790; val_edge_recon_loss: 41413.9537; val_gene_expr_recon_loss: 104466.3371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147929.2701; val_optim_loss: 147929.2701
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9327; val_auprc_score: 0.9934; val_best_acc_score: 0.9564; val_best_f1_score: 0.9768; train_kl_reg_loss: 2094.0970; train_edge_recon_loss: 40824.1406; train_gene_expr_recon_loss: 102975.7686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145894.0054; train_optim_loss: 145894.0054; val_kl_reg_loss: 2049.3324; val_edge_recon_loss: 40244.3817; val_gene_expr_recon_loss: 104372.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146666.6205; val_optim_loss: 146666.6205
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9354; val_auprc_score: 0.9930; val_best_acc_score: 0.9542; val_best_f1_score: 0.9756; train_kl_reg_loss: 2094.4156; train_edge_recon_loss: 40821.6441; train_gene_expr_recon_loss: 102776.2694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145692.3289; train_optim_loss: 145692.3289; val_kl_reg_loss: 2048.8537; val_edge_recon_loss: 40320.0898; val_gene_expr_recon_loss: 103588.5458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145957.4866; val_optim_loss: 145957.4866

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 15 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9352
Val AUPRC score: 0.9925
Val best accuracy score: 0.9555
Val best F1 score: 0.9762
Val gene expr MSE score: 0.8717
Duration of model training in run 1: 0 hours, 4 minutes and 25 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 49099
Number of validation nodes: 5456
Number of training edges: 117324
Number of validation edges: 13036
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7572; val_auprc_score: 0.9657; val_best_acc_score: 0.9403; val_best_f1_score: 0.9684; train_kl_reg_loss: 974.5847; train_edge_recon_loss: 48163.7375; train_gene_expr_recon_loss: 120070.1957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169208.5183; train_optim_loss: 169208.5183; val_kl_reg_loss: 1525.0229; val_edge_recon_loss: 46536.7422; val_gene_expr_recon_loss: 112923.6987; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160985.4598; val_optim_loss: 160985.4598
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8055; val_auprc_score: 0.9728; val_best_acc_score: 0.9339; val_best_f1_score: 0.9650; train_kl_reg_loss: 1768.9889; train_edge_recon_loss: 43799.2359; train_gene_expr_recon_loss: 111312.4314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 156880.6565; train_optim_loss: 156880.6565; val_kl_reg_loss: 1758.6419; val_edge_recon_loss: 46689.4007; val_gene_expr_recon_loss: 111285.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159733.3996; val_optim_loss: 159733.3996
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8468; val_auprc_score: 0.9806; val_best_acc_score: 0.9463; val_best_f1_score: 0.9716; train_kl_reg_loss: 1972.4572; train_edge_recon_loss: 43228.9319; train_gene_expr_recon_loss: 109714.0350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154915.4256; train_optim_loss: 154915.4256; val_kl_reg_loss: 1926.8155; val_edge_recon_loss: 42477.1032; val_gene_expr_recon_loss: 109106.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153510.8237; val_optim_loss: 153510.8237
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8807; val_auprc_score: 0.9866; val_best_acc_score: 0.9479; val_best_f1_score: 0.9724; train_kl_reg_loss: 1996.3307; train_edge_recon_loss: 41994.9402; train_gene_expr_recon_loss: 108557.7171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152548.9868; train_optim_loss: 152548.9868; val_kl_reg_loss: 2035.7009; val_edge_recon_loss: 41292.1412; val_gene_expr_recon_loss: 108513.0993; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 151840.9442; val_optim_loss: 151840.9442
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8862; val_auprc_score: 0.9870; val_best_acc_score: 0.9446; val_best_f1_score: 0.9706; train_kl_reg_loss: 2017.8316; train_edge_recon_loss: 41243.2633; train_gene_expr_recon_loss: 107922.2730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 151183.3677; train_optim_loss: 151183.3677; val_kl_reg_loss: 2021.3078; val_edge_recon_loss: 43176.6830; val_gene_expr_recon_loss: 107788.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152986.5759; val_optim_loss: 152986.5759
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9017; val_auprc_score: 0.9896; val_best_acc_score: 0.9502; val_best_f1_score: 0.9736; train_kl_reg_loss: 2084.9633; train_edge_recon_loss: 42247.5550; train_gene_expr_recon_loss: 106975.7421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 151308.2600; train_optim_loss: 151308.2600; val_kl_reg_loss: 1972.6383; val_edge_recon_loss: 40070.2935; val_gene_expr_recon_loss: 107190.3158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 149233.2455; val_optim_loss: 149233.2455
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9238; val_auprc_score: 0.9919; val_best_acc_score: 0.9516; val_best_f1_score: 0.9742; train_kl_reg_loss: 2082.7544; train_edge_recon_loss: 41245.4001; train_gene_expr_recon_loss: 106334.1324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 149662.2861; train_optim_loss: 149662.2861; val_kl_reg_loss: 2049.1252; val_edge_recon_loss: 41818.9531; val_gene_expr_recon_loss: 106388.2065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 150256.2857; val_optim_loss: 150256.2857
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9141; val_auprc_score: 0.9903; val_best_acc_score: 0.9534; val_best_f1_score: 0.9752; train_kl_reg_loss: 2090.0532; train_edge_recon_loss: 40888.3421; train_gene_expr_recon_loss: 105715.0818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 148693.4766; train_optim_loss: 148693.4766; val_kl_reg_loss: 2066.8811; val_edge_recon_loss: 40262.1356; val_gene_expr_recon_loss: 106656.6652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148985.6808; val_optim_loss: 148985.6808
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9271; val_auprc_score: 0.9922; val_best_acc_score: 0.9538; val_best_f1_score: 0.9753; train_kl_reg_loss: 2067.2333; train_edge_recon_loss: 40562.2457; train_gene_expr_recon_loss: 105242.7201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 147872.2004; train_optim_loss: 147872.2004; val_kl_reg_loss: 2108.6421; val_edge_recon_loss: 42128.1116; val_gene_expr_recon_loss: 105925.6975; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 150162.4509; val_optim_loss: 150162.4509
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9270; val_auprc_score: 0.9918; val_best_acc_score: 0.9552; val_best_f1_score: 0.9760; train_kl_reg_loss: 2091.4456; train_edge_recon_loss: 40878.6187; train_gene_expr_recon_loss: 104770.7376; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 147740.8028; train_optim_loss: 147740.8028; val_kl_reg_loss: 2053.0281; val_edge_recon_loss: 42776.1244; val_gene_expr_recon_loss: 105078.2054; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 149907.3549; val_optim_loss: 149907.3549
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9271; val_auprc_score: 0.9918; val_best_acc_score: 0.9542; val_best_f1_score: 0.9755; train_kl_reg_loss: 2093.2383; train_edge_recon_loss: 41422.2349; train_gene_expr_recon_loss: 104478.8059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 147994.2791; train_optim_loss: 147994.2791; val_kl_reg_loss: 1997.1210; val_edge_recon_loss: 43632.3371; val_gene_expr_recon_loss: 104719.7790; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 150349.2366; val_optim_loss: 150349.2366

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9248; val_auprc_score: 0.9917; val_best_acc_score: 0.9534; val_best_f1_score: 0.9752; train_kl_reg_loss: 2074.8596; train_edge_recon_loss: 40885.0971; train_gene_expr_recon_loss: 103759.8858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146719.8427; train_optim_loss: 146719.8427; val_kl_reg_loss: 2045.8945; val_edge_recon_loss: 41045.2874; val_gene_expr_recon_loss: 104395.5993; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147486.7835; val_optim_loss: 147486.7835
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9275; val_auprc_score: 0.9924; val_best_acc_score: 0.9571; val_best_f1_score: 0.9772; train_kl_reg_loss: 2087.1925; train_edge_recon_loss: 40880.9962; train_gene_expr_recon_loss: 103653.6664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146621.8553; train_optim_loss: 146621.8553; val_kl_reg_loss: 2047.5385; val_edge_recon_loss: 39263.1217; val_gene_expr_recon_loss: 104483.1763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145793.8348; val_optim_loss: 145793.8348
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9215; val_auprc_score: 0.9913; val_best_acc_score: 0.9548; val_best_f1_score: 0.9759; train_kl_reg_loss: 2086.6970; train_edge_recon_loss: 40663.2471; train_gene_expr_recon_loss: 103583.7419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146333.6859; train_optim_loss: 146333.6859; val_kl_reg_loss: 2037.1353; val_edge_recon_loss: 42194.3929; val_gene_expr_recon_loss: 104637.7467; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148869.2746; val_optim_loss: 148869.2746
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9287; val_auprc_score: 0.9912; val_best_acc_score: 0.9546; val_best_f1_score: 0.9756; train_kl_reg_loss: 2076.4162; train_edge_recon_loss: 40865.0310; train_gene_expr_recon_loss: 103630.6211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146572.0682; train_optim_loss: 146572.0682; val_kl_reg_loss: 2021.8244; val_edge_recon_loss: 42507.8538; val_gene_expr_recon_loss: 104365.0067; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148894.6853; val_optim_loss: 148894.6853
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9356; val_auprc_score: 0.9934; val_best_acc_score: 0.9563; val_best_f1_score: 0.9767; train_kl_reg_loss: 2095.9321; train_edge_recon_loss: 41571.3466; train_gene_expr_recon_loss: 103556.9236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 147224.2015; train_optim_loss: 147224.2015; val_kl_reg_loss: 2037.1892; val_edge_recon_loss: 41327.8069; val_gene_expr_recon_loss: 104893.4085; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148258.4040; val_optim_loss: 148258.4040

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9203; val_auprc_score: 0.9899; val_best_acc_score: 0.9531; val_best_f1_score: 0.9749; train_kl_reg_loss: 2080.0627; train_edge_recon_loss: 39916.6763; train_gene_expr_recon_loss: 103287.9698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145284.7085; train_optim_loss: 145284.7085; val_kl_reg_loss: 2026.4145; val_edge_recon_loss: 42916.5458; val_gene_expr_recon_loss: 104462.1496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 149405.1116; val_optim_loss: 149405.1116
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9308; val_auprc_score: 0.9923; val_best_acc_score: 0.9530; val_best_f1_score: 0.9748; train_kl_reg_loss: 2083.2200; train_edge_recon_loss: 41039.4959; train_gene_expr_recon_loss: 103421.2303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146543.9467; train_optim_loss: 146543.9467; val_kl_reg_loss: 2036.9174; val_edge_recon_loss: 43270.0703; val_gene_expr_recon_loss: 104171.0011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 149477.9866; val_optim_loss: 149477.9866
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9258; val_auprc_score: 0.9923; val_best_acc_score: 0.9562; val_best_f1_score: 0.9766; train_kl_reg_loss: 2085.0142; train_edge_recon_loss: 41033.0569; train_gene_expr_recon_loss: 103275.7761; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146393.8464; train_optim_loss: 146393.8464; val_kl_reg_loss: 2035.8966; val_edge_recon_loss: 40673.5982; val_gene_expr_recon_loss: 104795.4152; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147504.9107; val_optim_loss: 147504.9107

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 16 sec.
Using best model state, which was in epoch 13.

--- MODEL EVALUATION ---
Val AUROC score: 0.9229
Val AUPRC score: 0.9913
Val best accuracy score: 0.9541
Val best F1 score: 0.9755
Val gene expr MSE score: 0.8810
Duration of model training in run 2: 0 hours, 3 minutes and 21 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 49099
Number of validation nodes: 5456
Number of training edges: 226790
Number of validation edges: 25198
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8957; val_auprc_score: 0.9882; val_best_acc_score: 0.9549; val_best_f1_score: 0.9761; train_kl_reg_loss: 1582.0800; train_edge_recon_loss: 44819.1801; train_gene_expr_recon_loss: 115291.9133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161693.1738; train_optim_loss: 161693.1738; val_kl_reg_loss: 1944.3345; val_edge_recon_loss: 41440.8177; val_gene_expr_recon_loss: 111233.3928; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154618.5444; val_optim_loss: 154618.5444
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9346; val_auprc_score: 0.9918; val_best_acc_score: 0.9598; val_best_f1_score: 0.9785; train_kl_reg_loss: 1993.0641; train_edge_recon_loss: 41700.9467; train_gene_expr_recon_loss: 109825.6559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153519.6667; train_optim_loss: 153519.6667; val_kl_reg_loss: 2000.2456; val_edge_recon_loss: 42123.0738; val_gene_expr_recon_loss: 109320.9797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 153444.3006; val_optim_loss: 153444.3006
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9484; val_auprc_score: 0.9941; val_best_acc_score: 0.9658; val_best_f1_score: 0.9817; train_kl_reg_loss: 2043.3229; train_edge_recon_loss: 41506.2140; train_gene_expr_recon_loss: 107804.2920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 151353.8288; train_optim_loss: 151353.8288; val_kl_reg_loss: 2010.1008; val_edge_recon_loss: 39333.9180; val_gene_expr_recon_loss: 107675.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 149019.6594; val_optim_loss: 149019.6594
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9547; val_auprc_score: 0.9952; val_best_acc_score: 0.9666; val_best_f1_score: 0.9820; train_kl_reg_loss: 2063.5993; train_edge_recon_loss: 40688.5248; train_gene_expr_recon_loss: 106506.7709; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 149258.8953; train_optim_loss: 149258.8953; val_kl_reg_loss: 2046.0197; val_edge_recon_loss: 39907.4902; val_gene_expr_recon_loss: 106825.6731; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148779.1831; val_optim_loss: 148779.1831
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9529; val_auprc_score: 0.9951; val_best_acc_score: 0.9677; val_best_f1_score: 0.9828; train_kl_reg_loss: 2074.6156; train_edge_recon_loss: 40958.4877; train_gene_expr_recon_loss: 105405.8963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 148438.9994; train_optim_loss: 148438.9994; val_kl_reg_loss: 2052.8672; val_edge_recon_loss: 39368.0884; val_gene_expr_recon_loss: 105777.9538; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147198.9088; val_optim_loss: 147198.9088
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9596; val_auprc_score: 0.9952; val_best_acc_score: 0.9680; val_best_f1_score: 0.9828; train_kl_reg_loss: 2076.9649; train_edge_recon_loss: 40828.2284; train_gene_expr_recon_loss: 104500.4329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 147405.6263; train_optim_loss: 147405.6263; val_kl_reg_loss: 1963.8644; val_edge_recon_loss: 40530.6373; val_gene_expr_recon_loss: 105168.1487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147662.6519; val_optim_loss: 147662.6519
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9640; val_auprc_score: 0.9959; val_best_acc_score: 0.9722; val_best_f1_score: 0.9851; train_kl_reg_loss: 2078.1443; train_edge_recon_loss: 40479.7194; train_gene_expr_recon_loss: 103817.5637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146375.4279; train_optim_loss: 146375.4279; val_kl_reg_loss: 1999.8121; val_edge_recon_loss: 40756.7337; val_gene_expr_recon_loss: 105038.1316; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147794.6756; val_optim_loss: 147794.6756
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9646; val_auprc_score: 0.9960; val_best_acc_score: 0.9732; val_best_f1_score: 0.9856; train_kl_reg_loss: 2089.6775; train_edge_recon_loss: 40740.7434; train_gene_expr_recon_loss: 103416.5428; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146246.9636; train_optim_loss: 146246.9636; val_kl_reg_loss: 2103.2255; val_edge_recon_loss: 39768.8599; val_gene_expr_recon_loss: 103638.3087; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145510.3931; val_optim_loss: 145510.3931
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9604; val_auprc_score: 0.9957; val_best_acc_score: 0.9732; val_best_f1_score: 0.9856; train_kl_reg_loss: 2106.8129; train_edge_recon_loss: 40545.1272; train_gene_expr_recon_loss: 102709.4841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145361.4243; train_optim_loss: 145361.4243; val_kl_reg_loss: 2089.2676; val_edge_recon_loss: 39873.9004; val_gene_expr_recon_loss: 103472.5597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145435.7269; val_optim_loss: 145435.7269
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9659; val_auprc_score: 0.9964; val_best_acc_score: 0.9734; val_best_f1_score: 0.9858; train_kl_reg_loss: 2106.9682; train_edge_recon_loss: 40480.9409; train_gene_expr_recon_loss: 102348.2635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144936.1721; train_optim_loss: 144936.1721; val_kl_reg_loss: 2133.4392; val_edge_recon_loss: 40144.8067; val_gene_expr_recon_loss: 102980.0275; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145258.2744; val_optim_loss: 145258.2744
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9646; val_auprc_score: 0.9961; val_best_acc_score: 0.9730; val_best_f1_score: 0.9856; train_kl_reg_loss: 2107.7098; train_edge_recon_loss: 40380.6196; train_gene_expr_recon_loss: 101975.7237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144464.0534; train_optim_loss: 144464.0534; val_kl_reg_loss: 2154.8346; val_edge_recon_loss: 40332.8117; val_gene_expr_recon_loss: 103364.4356; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145852.0806; val_optim_loss: 145852.0806
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9644; val_auprc_score: 0.9955; val_best_acc_score: 0.9742; val_best_f1_score: 0.9862; train_kl_reg_loss: 2112.8388; train_edge_recon_loss: 40190.9477; train_gene_expr_recon_loss: 101516.1351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143819.9215; train_optim_loss: 143819.9215; val_kl_reg_loss: 2019.5353; val_edge_recon_loss: 41045.6306; val_gene_expr_recon_loss: 102545.0666; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145610.2313; val_optim_loss: 145610.2313
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9719; val_auprc_score: 0.9966; val_best_acc_score: 0.9762; val_best_f1_score: 0.9872; train_kl_reg_loss: 2130.7665; train_edge_recon_loss: 40790.6340; train_gene_expr_recon_loss: 101210.2849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144131.6856; train_optim_loss: 144131.6856; val_kl_reg_loss: 2132.0688; val_edge_recon_loss: 41532.1981; val_gene_expr_recon_loss: 102386.7803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146051.0463; val_optim_loss: 146051.0463

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9745; val_auprc_score: 0.9975; val_best_acc_score: 0.9763; val_best_f1_score: 0.9873; train_kl_reg_loss: 2136.8798; train_edge_recon_loss: 40790.9526; train_gene_expr_recon_loss: 100418.1829; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143346.0154; train_optim_loss: 143346.0154; val_kl_reg_loss: 2098.7646; val_edge_recon_loss: 39779.4436; val_gene_expr_recon_loss: 101701.7191; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143579.9262; val_optim_loss: 143579.9262
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9693; val_auprc_score: 0.9962; val_best_acc_score: 0.9751; val_best_f1_score: 0.9867; train_kl_reg_loss: 2120.1508; train_edge_recon_loss: 39867.7812; train_gene_expr_recon_loss: 100381.7308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142369.6629; train_optim_loss: 142369.6629; val_kl_reg_loss: 2079.7286; val_edge_recon_loss: 40437.7869; val_gene_expr_recon_loss: 101754.8834; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144272.3981; val_optim_loss: 144272.3981
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9737; val_auprc_score: 0.9972; val_best_acc_score: 0.9764; val_best_f1_score: 0.9873; train_kl_reg_loss: 2116.7774; train_edge_recon_loss: 39906.9419; train_gene_expr_recon_loss: 100431.2722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142454.9920; train_optim_loss: 142454.9920; val_kl_reg_loss: 2078.3199; val_edge_recon_loss: 40562.8360; val_gene_expr_recon_loss: 102098.0459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144739.2013; val_optim_loss: 144739.2013
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9692; val_auprc_score: 0.9966; val_best_acc_score: 0.9742; val_best_f1_score: 0.9861; train_kl_reg_loss: 2124.1601; train_edge_recon_loss: 40119.0196; train_gene_expr_recon_loss: 100273.5430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142516.7227; train_optim_loss: 142516.7227; val_kl_reg_loss: 2110.5938; val_edge_recon_loss: 41883.3354; val_gene_expr_recon_loss: 101514.7137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145508.6419; val_optim_loss: 145508.6419

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9711; val_auprc_score: 0.9968; val_best_acc_score: 0.9746; val_best_f1_score: 0.9864; train_kl_reg_loss: 2127.7457; train_edge_recon_loss: 40003.8488; train_gene_expr_recon_loss: 100067.7158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142199.3108; train_optim_loss: 142199.3108; val_kl_reg_loss: 2100.3400; val_edge_recon_loss: 41973.0331; val_gene_expr_recon_loss: 101903.2394; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145976.6131; val_optim_loss: 145976.6131
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9728; val_auprc_score: 0.9967; val_best_acc_score: 0.9765; val_best_f1_score: 0.9874; train_kl_reg_loss: 2125.7211; train_edge_recon_loss: 40446.7903; train_gene_expr_recon_loss: 100150.3392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142722.8503; train_optim_loss: 142722.8503; val_kl_reg_loss: 2094.4704; val_edge_recon_loss: 40645.4273; val_gene_expr_recon_loss: 101600.3556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144340.2531; val_optim_loss: 144340.2531
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9718; val_auprc_score: 0.9971; val_best_acc_score: 0.9779; val_best_f1_score: 0.9882; train_kl_reg_loss: 2117.5658; train_edge_recon_loss: 40122.5267; train_gene_expr_recon_loss: 100142.0119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142382.1044; train_optim_loss: 142382.1044; val_kl_reg_loss: 2089.5705; val_edge_recon_loss: 39105.6266; val_gene_expr_recon_loss: 101386.8719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142582.0688; val_optim_loss: 142582.0688
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9678; val_auprc_score: 0.9960; val_best_acc_score: 0.9757; val_best_f1_score: 0.9870; train_kl_reg_loss: 2119.9592; train_edge_recon_loss: 40025.7211; train_gene_expr_recon_loss: 100209.5034; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142355.1843; train_optim_loss: 142355.1843; val_kl_reg_loss: 2096.4358; val_edge_recon_loss: 40006.0370; val_gene_expr_recon_loss: 101708.6091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143811.0825; val_optim_loss: 143811.0825
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9710; val_auprc_score: 0.9966; val_best_acc_score: 0.9753; val_best_f1_score: 0.9868; train_kl_reg_loss: 2123.7306; train_edge_recon_loss: 40297.1520; train_gene_expr_recon_loss: 100062.0478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142482.9300; train_optim_loss: 142482.9300; val_kl_reg_loss: 2096.3104; val_edge_recon_loss: 40319.1214; val_gene_expr_recon_loss: 101738.5309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144153.9634; val_optim_loss: 144153.9634
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9685; val_auprc_score: 0.9969; val_best_acc_score: 0.9759; val_best_f1_score: 0.9871; train_kl_reg_loss: 2121.8364; train_edge_recon_loss: 40031.3858; train_gene_expr_recon_loss: 100012.4931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142165.7155; train_optim_loss: 142165.7155; val_kl_reg_loss: 2093.5971; val_edge_recon_loss: 39282.1548; val_gene_expr_recon_loss: 101819.7953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143195.5475; val_optim_loss: 143195.5475

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9724; val_auprc_score: 0.9970; val_best_acc_score: 0.9768; val_best_f1_score: 0.9876; train_kl_reg_loss: 2122.6681; train_edge_recon_loss: 40471.3266; train_gene_expr_recon_loss: 100257.7625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142851.7571; train_optim_loss: 142851.7571; val_kl_reg_loss: 2093.1327; val_edge_recon_loss: 40206.3067; val_gene_expr_recon_loss: 101696.4994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143995.9388; val_optim_loss: 143995.9388
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9685; val_auprc_score: 0.9964; val_best_acc_score: 0.9770; val_best_f1_score: 0.9877; train_kl_reg_loss: 2122.1502; train_edge_recon_loss: 39943.9655; train_gene_expr_recon_loss: 100083.8518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142149.9675; train_optim_loss: 142149.9675; val_kl_reg_loss: 2092.3034; val_edge_recon_loss: 40374.2695; val_gene_expr_recon_loss: 101511.0587; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143977.6306; val_optim_loss: 143977.6306
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9683; val_auprc_score: 0.9963; val_best_acc_score: 0.9750; val_best_f1_score: 0.9866; train_kl_reg_loss: 2121.5223; train_edge_recon_loss: 39895.4514; train_gene_expr_recon_loss: 100135.4565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142152.4304; train_optim_loss: 142152.4304; val_kl_reg_loss: 2091.5193; val_edge_recon_loss: 41568.3352; val_gene_expr_recon_loss: 102062.4694; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145722.3244; val_optim_loss: 145722.3244

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 16 min 11 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
Val AUROC score: 0.9719
Val AUPRC score: 0.9970
Val best accuracy score: 0.9759
Val best F1 score: 0.9871
Val gene expr MSE score: 0.7828
Duration of model training in run 3: 0 hours, 16 minutes and 25 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 49099
Number of validation nodes: 5456
Number of training edges: 226790
Number of validation edges: 25198
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8884; val_auprc_score: 0.9866; val_best_acc_score: 0.9527; val_best_f1_score: 0.9748; train_kl_reg_loss: 1545.5287; train_edge_recon_loss: 45073.3105; train_gene_expr_recon_loss: 114620.7489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161239.5880; train_optim_loss: 161239.5880; val_kl_reg_loss: 1827.3190; val_edge_recon_loss: 42576.7787; val_gene_expr_recon_loss: 112280.5731; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156684.6700; val_optim_loss: 156684.6700
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9219; val_auprc_score: 0.9912; val_best_acc_score: 0.9598; val_best_f1_score: 0.9785; train_kl_reg_loss: 1969.3664; train_edge_recon_loss: 42364.8787; train_gene_expr_recon_loss: 109373.2558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153707.5008; train_optim_loss: 153707.5008; val_kl_reg_loss: 2172.2890; val_edge_recon_loss: 42174.3120; val_gene_expr_recon_loss: 109817.2434; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 154163.8450; val_optim_loss: 154163.8450
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9437; val_auprc_score: 0.9939; val_best_acc_score: 0.9622; val_best_f1_score: 0.9797; train_kl_reg_loss: 2040.7236; train_edge_recon_loss: 41646.6256; train_gene_expr_recon_loss: 107641.6211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 151328.9702; train_optim_loss: 151328.9702; val_kl_reg_loss: 1968.7704; val_edge_recon_loss: 41769.6883; val_gene_expr_recon_loss: 108027.2131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 151765.6719; val_optim_loss: 151765.6719
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9514; val_auprc_score: 0.9945; val_best_acc_score: 0.9653; val_best_f1_score: 0.9814; train_kl_reg_loss: 2052.2410; train_edge_recon_loss: 40709.2706; train_gene_expr_recon_loss: 106063.8268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 148825.3383; train_optim_loss: 148825.3383; val_kl_reg_loss: 2035.9071; val_edge_recon_loss: 41366.2431; val_gene_expr_recon_loss: 107303.6728; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 150705.8225; val_optim_loss: 150705.8225
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9500; val_auprc_score: 0.9943; val_best_acc_score: 0.9678; val_best_f1_score: 0.9828; train_kl_reg_loss: 2072.2102; train_edge_recon_loss: 41282.9255; train_gene_expr_recon_loss: 105251.9251; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 148607.0612; train_optim_loss: 148607.0612; val_kl_reg_loss: 1886.2824; val_edge_recon_loss: 41138.2731; val_gene_expr_recon_loss: 105977.3722; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 149001.9300; val_optim_loss: 149001.9300
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9615; val_auprc_score: 0.9958; val_best_acc_score: 0.9695; val_best_f1_score: 0.9837; train_kl_reg_loss: 2066.2908; train_edge_recon_loss: 40951.6657; train_gene_expr_recon_loss: 104380.1109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 147398.0672; train_optim_loss: 147398.0672; val_kl_reg_loss: 2111.2237; val_edge_recon_loss: 40973.4194; val_gene_expr_recon_loss: 105338.2678; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148422.9113; val_optim_loss: 148422.9113
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9618; val_auprc_score: 0.9959; val_best_acc_score: 0.9709; val_best_f1_score: 0.9844; train_kl_reg_loss: 2073.3659; train_edge_recon_loss: 41055.5362; train_gene_expr_recon_loss: 103750.6930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146879.5951; train_optim_loss: 146879.5951; val_kl_reg_loss: 2100.2852; val_edge_recon_loss: 41592.7902; val_gene_expr_recon_loss: 104805.3347; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148498.4106; val_optim_loss: 148498.4106
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9600; val_auprc_score: 0.9949; val_best_acc_score: 0.9708; val_best_f1_score: 0.9844; train_kl_reg_loss: 2070.4783; train_edge_recon_loss: 40644.6859; train_gene_expr_recon_loss: 103138.1085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145853.2729; train_optim_loss: 145853.2729; val_kl_reg_loss: 2094.3575; val_edge_recon_loss: 41449.5886; val_gene_expr_recon_loss: 103739.5269; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147283.4750; val_optim_loss: 147283.4750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9615; val_auprc_score: 0.9953; val_best_acc_score: 0.9730; val_best_f1_score: 0.9855; train_kl_reg_loss: 2090.8540; train_edge_recon_loss: 40764.4444; train_gene_expr_recon_loss: 102560.0192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145415.3175; train_optim_loss: 145415.3175; val_kl_reg_loss: 2003.3399; val_edge_recon_loss: 40143.5752; val_gene_expr_recon_loss: 104088.4216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146235.3381; val_optim_loss: 146235.3381
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9680; val_auprc_score: 0.9969; val_best_acc_score: 0.9734; val_best_f1_score: 0.9858; train_kl_reg_loss: 2089.7871; train_edge_recon_loss: 40641.8842; train_gene_expr_recon_loss: 102139.7980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144871.4693; train_optim_loss: 144871.4693; val_kl_reg_loss: 2042.5770; val_edge_recon_loss: 39767.3339; val_gene_expr_recon_loss: 103982.3822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145792.2931; val_optim_loss: 145792.2931
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9627; val_auprc_score: 0.9958; val_best_acc_score: 0.9717; val_best_f1_score: 0.9848; train_kl_reg_loss: 2101.5391; train_edge_recon_loss: 40115.0468; train_gene_expr_recon_loss: 101736.9990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143953.5849; train_optim_loss: 143953.5849; val_kl_reg_loss: 2163.6001; val_edge_recon_loss: 41427.2497; val_gene_expr_recon_loss: 103244.7681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146835.6194; val_optim_loss: 146835.6194
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9704; val_auprc_score: 0.9966; val_best_acc_score: 0.9761; val_best_f1_score: 0.9872; train_kl_reg_loss: 2109.4967; train_edge_recon_loss: 40310.4877; train_gene_expr_recon_loss: 101304.2822; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143724.2672; train_optim_loss: 143724.2672; val_kl_reg_loss: 2090.9446; val_edge_recon_loss: 40170.9398; val_gene_expr_recon_loss: 102945.1828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145207.0675; val_optim_loss: 145207.0675
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9694; val_auprc_score: 0.9964; val_best_acc_score: 0.9742; val_best_f1_score: 0.9861; train_kl_reg_loss: 2124.2763; train_edge_recon_loss: 40451.6572; train_gene_expr_recon_loss: 101287.8417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143863.7753; train_optim_loss: 143863.7753; val_kl_reg_loss: 2078.5938; val_edge_recon_loss: 40470.6897; val_gene_expr_recon_loss: 102463.1906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145012.4725; val_optim_loss: 145012.4725
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9726; val_auprc_score: 0.9969; val_best_acc_score: 0.9775; val_best_f1_score: 0.9880; train_kl_reg_loss: 2136.6218; train_edge_recon_loss: 40971.4049; train_gene_expr_recon_loss: 100789.6439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143897.6703; train_optim_loss: 143897.6703; val_kl_reg_loss: 2152.4382; val_edge_recon_loss: 39467.7402; val_gene_expr_recon_loss: 102343.1166; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143963.2950; val_optim_loss: 143963.2950
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9702; val_auprc_score: 0.9964; val_best_acc_score: 0.9760; val_best_f1_score: 0.9871; train_kl_reg_loss: 2127.5532; train_edge_recon_loss: 39973.8088; train_gene_expr_recon_loss: 100627.1759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142728.5376; train_optim_loss: 142728.5376; val_kl_reg_loss: 2121.4071; val_edge_recon_loss: 41323.8723; val_gene_expr_recon_loss: 102126.5116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145571.7931; val_optim_loss: 145571.7931
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9718; val_auprc_score: 0.9968; val_best_acc_score: 0.9775; val_best_f1_score: 0.9879; train_kl_reg_loss: 2149.5331; train_edge_recon_loss: 40735.2362; train_gene_expr_recon_loss: 100349.7463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143234.5151; train_optim_loss: 143234.5151; val_kl_reg_loss: 2152.6825; val_edge_recon_loss: 39931.4783; val_gene_expr_recon_loss: 102010.2191; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144094.3806; val_optim_loss: 144094.3806
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9742; val_auprc_score: 0.9974; val_best_acc_score: 0.9773; val_best_f1_score: 0.9878; train_kl_reg_loss: 2169.0903; train_edge_recon_loss: 40823.8909; train_gene_expr_recon_loss: 100109.0950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143102.0762; train_optim_loss: 143102.0762; val_kl_reg_loss: 2065.3368; val_edge_recon_loss: 40704.6621; val_gene_expr_recon_loss: 102273.9516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145043.9513; val_optim_loss: 145043.9513

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9753; val_auprc_score: 0.9975; val_best_acc_score: 0.9782; val_best_f1_score: 0.9883; train_kl_reg_loss: 2160.1598; train_edge_recon_loss: 40279.4099; train_gene_expr_recon_loss: 99500.0971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141939.6668; train_optim_loss: 141939.6668; val_kl_reg_loss: 2146.4115; val_edge_recon_loss: 40305.4930; val_gene_expr_recon_loss: 101416.7516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143868.6556; val_optim_loss: 143868.6556
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9757; val_auprc_score: 0.9977; val_best_acc_score: 0.9784; val_best_f1_score: 0.9884; train_kl_reg_loss: 2152.8316; train_edge_recon_loss: 39811.2603; train_gene_expr_recon_loss: 99360.3162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141324.4076; train_optim_loss: 141324.4076; val_kl_reg_loss: 2128.5995; val_edge_recon_loss: 39865.7340; val_gene_expr_recon_loss: 100910.9009; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142905.2344; val_optim_loss: 142905.2344
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9776; val_auprc_score: 0.9976; val_best_acc_score: 0.9786; val_best_f1_score: 0.9885; train_kl_reg_loss: 2156.4759; train_edge_recon_loss: 40458.7140; train_gene_expr_recon_loss: 99276.3232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141891.5130; train_optim_loss: 141891.5130; val_kl_reg_loss: 2141.3750; val_edge_recon_loss: 38972.7602; val_gene_expr_recon_loss: 101395.8684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142510.0038; val_optim_loss: 142510.0038
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9713; val_auprc_score: 0.9968; val_best_acc_score: 0.9785; val_best_f1_score: 0.9884; train_kl_reg_loss: 2155.9423; train_edge_recon_loss: 40389.6012; train_gene_expr_recon_loss: 99259.2563; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141804.7997; train_optim_loss: 141804.7997; val_kl_reg_loss: 2130.4500; val_edge_recon_loss: 40758.1155; val_gene_expr_recon_loss: 101346.0406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144234.6075; val_optim_loss: 144234.6075
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9739; val_auprc_score: 0.9969; val_best_acc_score: 0.9791; val_best_f1_score: 0.9888; train_kl_reg_loss: 2142.7301; train_edge_recon_loss: 40138.3377; train_gene_expr_recon_loss: 99217.8475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141498.9153; train_optim_loss: 141498.9153; val_kl_reg_loss: 2118.8123; val_edge_recon_loss: 39476.2492; val_gene_expr_recon_loss: 101627.4019; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143222.4625; val_optim_loss: 143222.4625
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9737; val_auprc_score: 0.9968; val_best_acc_score: 0.9786; val_best_f1_score: 0.9885; train_kl_reg_loss: 2145.0000; train_edge_recon_loss: 40188.2217; train_gene_expr_recon_loss: 99197.1755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141530.3970; train_optim_loss: 141530.3970; val_kl_reg_loss: 2106.4338; val_edge_recon_loss: 40721.9236; val_gene_expr_recon_loss: 101503.2356; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144331.5944; val_optim_loss: 144331.5944

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9759; val_auprc_score: 0.9975; val_best_acc_score: 0.9797; val_best_f1_score: 0.9891; train_kl_reg_loss: 2141.2368; train_edge_recon_loss: 40136.0125; train_gene_expr_recon_loss: 99167.3739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141444.6231; train_optim_loss: 141444.6231; val_kl_reg_loss: 2110.6169; val_edge_recon_loss: 39496.9703; val_gene_expr_recon_loss: 101646.0294; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143253.6162; val_optim_loss: 143253.6162
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9750; val_auprc_score: 0.9973; val_best_acc_score: 0.9784; val_best_f1_score: 0.9884; train_kl_reg_loss: 2143.9955; train_edge_recon_loss: 39958.0777; train_gene_expr_recon_loss: 99189.7030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141291.7763; train_optim_loss: 141291.7763; val_kl_reg_loss: 2109.8747; val_edge_recon_loss: 39878.8705; val_gene_expr_recon_loss: 101373.7703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143362.5159; val_optim_loss: 143362.5159
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9736; val_auprc_score: 0.9972; val_best_acc_score: 0.9784; val_best_f1_score: 0.9884; train_kl_reg_loss: 2142.1953; train_edge_recon_loss: 40161.5372; train_gene_expr_recon_loss: 99156.8441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141460.5765; train_optim_loss: 141460.5765; val_kl_reg_loss: 2114.4277; val_edge_recon_loss: 39978.0214; val_gene_expr_recon_loss: 101004.3313; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143096.7794; val_optim_loss: 143096.7794

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 16 min 38 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
Val AUROC score: 0.9700
Val AUPRC score: 0.9966
Val best accuracy score: 0.9785
Val best F1 score: 0.9885
Val gene expr MSE score: 0.8923
Duration of model training in run 4: 0 hours, 16 minutes and 52 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 49099
Number of validation nodes: 5456
Number of training edges: 336078
Number of validation edges: 37341
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9332; val_auprc_score: 0.9923; val_best_acc_score: 0.9612; val_best_f1_score: 0.9792; train_kl_reg_loss: 1754.8620; train_edge_recon_loss: 43126.7362; train_gene_expr_recon_loss: 112713.7052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157595.3035; train_optim_loss: 157595.3035; val_kl_reg_loss: 1932.6447; val_edge_recon_loss: 41685.1696; val_gene_expr_recon_loss: 109244.4921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152862.3063; val_optim_loss: 152862.3063
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9520; val_auprc_score: 0.9946; val_best_acc_score: 0.9667; val_best_f1_score: 0.9822; train_kl_reg_loss: 2022.3151; train_edge_recon_loss: 40985.2050; train_gene_expr_recon_loss: 107506.5128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 150514.0329; train_optim_loss: 150514.0329; val_kl_reg_loss: 2023.7835; val_edge_recon_loss: 40843.3202; val_gene_expr_recon_loss: 107000.8543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 149867.9571; val_optim_loss: 149867.9571
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9610; val_auprc_score: 0.9954; val_best_acc_score: 0.9731; val_best_f1_score: 0.9856; train_kl_reg_loss: 2052.0649; train_edge_recon_loss: 41121.6568; train_gene_expr_recon_loss: 105337.2612; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 148510.9830; train_optim_loss: 148510.9830; val_kl_reg_loss: 2038.6195; val_edge_recon_loss: 39550.9306; val_gene_expr_recon_loss: 104980.7842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146570.3341; val_optim_loss: 146570.3341
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9626; val_auprc_score: 0.9955; val_best_acc_score: 0.9730; val_best_f1_score: 0.9855; train_kl_reg_loss: 2052.4962; train_edge_recon_loss: 40126.2860; train_gene_expr_recon_loss: 103963.5834; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146142.3655; train_optim_loss: 146142.3655; val_kl_reg_loss: 2087.4273; val_edge_recon_loss: 40733.2687; val_gene_expr_recon_loss: 103750.8745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146571.5700; val_optim_loss: 146571.5700
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9693; val_auprc_score: 0.9963; val_best_acc_score: 0.9765; val_best_f1_score: 0.9874; train_kl_reg_loss: 2058.7084; train_edge_recon_loss: 40138.6938; train_gene_expr_recon_loss: 103015.8098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145213.2123; train_optim_loss: 145213.2123; val_kl_reg_loss: 1977.6252; val_edge_recon_loss: 39827.9064; val_gene_expr_recon_loss: 103069.3754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144874.9067; val_optim_loss: 144874.9067
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9705; val_auprc_score: 0.9969; val_best_acc_score: 0.9759; val_best_f1_score: 0.9870; train_kl_reg_loss: 2079.2362; train_edge_recon_loss: 39767.9763; train_gene_expr_recon_loss: 102485.4800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144332.6924; train_optim_loss: 144332.6924; val_kl_reg_loss: 2107.3036; val_edge_recon_loss: 40241.2190; val_gene_expr_recon_loss: 103231.6464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145580.1689; val_optim_loss: 145580.1689
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9755; val_auprc_score: 0.9975; val_best_acc_score: 0.9784; val_best_f1_score: 0.9884; train_kl_reg_loss: 2082.5826; train_edge_recon_loss: 40372.5689; train_gene_expr_recon_loss: 101880.1462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144335.2974; train_optim_loss: 144335.2974; val_kl_reg_loss: 2128.6143; val_edge_recon_loss: 39198.3610; val_gene_expr_recon_loss: 102494.7992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143821.7738; val_optim_loss: 143821.7738
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9756; val_auprc_score: 0.9971; val_best_acc_score: 0.9781; val_best_f1_score: 0.9883; train_kl_reg_loss: 2099.5755; train_edge_recon_loss: 40417.1755; train_gene_expr_recon_loss: 101647.7260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144164.4768; train_optim_loss: 144164.4768; val_kl_reg_loss: 2036.6849; val_edge_recon_loss: 39891.3122; val_gene_expr_recon_loss: 102308.1327; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144236.1293; val_optim_loss: 144236.1293
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9772; val_auprc_score: 0.9976; val_best_acc_score: 0.9804; val_best_f1_score: 0.9895; train_kl_reg_loss: 2100.0230; train_edge_recon_loss: 39944.5153; train_gene_expr_recon_loss: 101122.3177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143166.8562; train_optim_loss: 143166.8562; val_kl_reg_loss: 2121.3341; val_edge_recon_loss: 39593.6255; val_gene_expr_recon_loss: 101718.5923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143433.5515; val_optim_loss: 143433.5515
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9790; val_auprc_score: 0.9976; val_best_acc_score: 0.9804; val_best_f1_score: 0.9894; train_kl_reg_loss: 2119.3402; train_edge_recon_loss: 40525.1316; train_gene_expr_recon_loss: 101053.7283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143698.2004; train_optim_loss: 143698.2004; val_kl_reg_loss: 2191.3515; val_edge_recon_loss: 40609.7277; val_gene_expr_recon_loss: 101544.8752; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144345.9544; val_optim_loss: 144345.9544
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9809; val_auprc_score: 0.9979; val_best_acc_score: 0.9819; val_best_f1_score: 0.9902; train_kl_reg_loss: 2127.1251; train_edge_recon_loss: 40016.7159; train_gene_expr_recon_loss: 100700.5957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142844.4368; train_optim_loss: 142844.4368; val_kl_reg_loss: 2118.5739; val_edge_recon_loss: 39674.4615; val_gene_expr_recon_loss: 102088.2129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143881.2484; val_optim_loss: 143881.2484
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9771; val_auprc_score: 0.9970; val_best_acc_score: 0.9799; val_best_f1_score: 0.9892; train_kl_reg_loss: 2133.1280; train_edge_recon_loss: 39987.3202; train_gene_expr_recon_loss: 100437.2532; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142557.7016; train_optim_loss: 142557.7016; val_kl_reg_loss: 2168.5535; val_edge_recon_loss: 40048.9625; val_gene_expr_recon_loss: 101325.7496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143543.2654; val_optim_loss: 143543.2654

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9797; val_auprc_score: 0.9977; val_best_acc_score: 0.9812; val_best_f1_score: 0.9899; train_kl_reg_loss: 2141.5085; train_edge_recon_loss: 39500.2513; train_gene_expr_recon_loss: 99714.9019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141356.6615; train_optim_loss: 141356.6615; val_kl_reg_loss: 2124.2398; val_edge_recon_loss: 40398.5498; val_gene_expr_recon_loss: 100664.0527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143186.8429; val_optim_loss: 143186.8429
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9790; val_auprc_score: 0.9974; val_best_acc_score: 0.9813; val_best_f1_score: 0.9900; train_kl_reg_loss: 2137.6435; train_edge_recon_loss: 39272.7898; train_gene_expr_recon_loss: 99711.9241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141122.3574; train_optim_loss: 141122.3574; val_kl_reg_loss: 2096.5681; val_edge_recon_loss: 39528.0375; val_gene_expr_recon_loss: 101180.4273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142805.0333; val_optim_loss: 142805.0333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9823; val_auprc_score: 0.9981; val_best_acc_score: 0.9823; val_best_f1_score: 0.9905; train_kl_reg_loss: 2120.2181; train_edge_recon_loss: 39514.8691; train_gene_expr_recon_loss: 99800.1903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141435.2773; train_optim_loss: 141435.2773; val_kl_reg_loss: 2104.7156; val_edge_recon_loss: 39665.7422; val_gene_expr_recon_loss: 100942.8617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142713.3187; val_optim_loss: 142713.3187
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9834; val_auprc_score: 0.9982; val_best_acc_score: 0.9819; val_best_f1_score: 0.9903; train_kl_reg_loss: 2130.1626; train_edge_recon_loss: 40006.6182; train_gene_expr_recon_loss: 99554.3630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141691.1437; train_optim_loss: 141691.1437; val_kl_reg_loss: 2117.2947; val_edge_recon_loss: 39850.9005; val_gene_expr_recon_loss: 100351.4756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142319.6711; val_optim_loss: 142319.6711
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9814; val_auprc_score: 0.9974; val_best_acc_score: 0.9816; val_best_f1_score: 0.9901; train_kl_reg_loss: 2137.3301; train_edge_recon_loss: 40060.2707; train_gene_expr_recon_loss: 99565.6330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141763.2336; train_optim_loss: 141763.2336; val_kl_reg_loss: 2110.6858; val_edge_recon_loss: 40926.7066; val_gene_expr_recon_loss: 100535.3994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143572.7917; val_optim_loss: 143572.7917
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9825; val_auprc_score: 0.9981; val_best_acc_score: 0.9821; val_best_f1_score: 0.9904; train_kl_reg_loss: 2135.2084; train_edge_recon_loss: 40276.8580; train_gene_expr_recon_loss: 99550.7114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141962.7779; train_optim_loss: 141962.7779; val_kl_reg_loss: 2120.4066; val_edge_recon_loss: 39999.3452; val_gene_expr_recon_loss: 100735.9640; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142855.7154; val_optim_loss: 142855.7154
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9826; val_auprc_score: 0.9981; val_best_acc_score: 0.9826; val_best_f1_score: 0.9906; train_kl_reg_loss: 2142.0585; train_edge_recon_loss: 40139.3331; train_gene_expr_recon_loss: 99587.8661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141869.2578; train_optim_loss: 141869.2578; val_kl_reg_loss: 2123.8602; val_edge_recon_loss: 39258.0836; val_gene_expr_recon_loss: 101036.8580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142418.8017; val_optim_loss: 142418.8017

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9827; val_auprc_score: 0.9980; val_best_acc_score: 0.9835; val_best_f1_score: 0.9911; train_kl_reg_loss: 2139.9623; train_edge_recon_loss: 39887.8288; train_gene_expr_recon_loss: 99479.4596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141507.2507; train_optim_loss: 141507.2507; val_kl_reg_loss: 2117.4086; val_edge_recon_loss: 38727.1796; val_gene_expr_recon_loss: 100608.2245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141452.8130; val_optim_loss: 141452.8130
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9838; val_auprc_score: 0.9980; val_best_acc_score: 0.9827; val_best_f1_score: 0.9907; train_kl_reg_loss: 2131.5790; train_edge_recon_loss: 39539.0283; train_gene_expr_recon_loss: 99338.2997; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141008.9070; train_optim_loss: 141008.9070; val_kl_reg_loss: 2106.7773; val_edge_recon_loss: 39917.4547; val_gene_expr_recon_loss: 101090.1951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143114.4272; val_optim_loss: 143114.4272
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9833; val_auprc_score: 0.9977; val_best_acc_score: 0.9827; val_best_f1_score: 0.9907; train_kl_reg_loss: 2133.9842; train_edge_recon_loss: 40189.6430; train_gene_expr_recon_loss: 99444.6375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141768.2645; train_optim_loss: 141768.2645; val_kl_reg_loss: 2115.2782; val_edge_recon_loss: 39720.7485; val_gene_expr_recon_loss: 100456.5536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142292.5805; val_optim_loss: 142292.5805
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9835; val_auprc_score: 0.9983; val_best_acc_score: 0.9824; val_best_f1_score: 0.9905; train_kl_reg_loss: 2129.6854; train_edge_recon_loss: 39874.1783; train_gene_expr_recon_loss: 99270.9563; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141274.8203; train_optim_loss: 141274.8203; val_kl_reg_loss: 2105.1948; val_edge_recon_loss: 39901.1242; val_gene_expr_recon_loss: 100728.1742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142734.4933; val_optim_loss: 142734.4933

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9841; val_auprc_score: 0.9982; val_best_acc_score: 0.9823; val_best_f1_score: 0.9905; train_kl_reg_loss: 2127.5749; train_edge_recon_loss: 40407.4750; train_gene_expr_recon_loss: 99419.9250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141954.9747; train_optim_loss: 141954.9747; val_kl_reg_loss: 2107.5763; val_edge_recon_loss: 39561.5424; val_gene_expr_recon_loss: 101408.7006; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143077.8201; val_optim_loss: 143077.8201
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9810; val_auprc_score: 0.9976; val_best_acc_score: 0.9821; val_best_f1_score: 0.9904; train_kl_reg_loss: 2129.6168; train_edge_recon_loss: 40229.4428; train_gene_expr_recon_loss: 99411.2721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141770.3317; train_optim_loss: 141770.3317; val_kl_reg_loss: 2109.8054; val_edge_recon_loss: 39627.1976; val_gene_expr_recon_loss: 101206.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142943.5189; val_optim_loss: 142943.5189
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9818; val_auprc_score: 0.9976; val_best_acc_score: 0.9825; val_best_f1_score: 0.9906; train_kl_reg_loss: 2130.5234; train_edge_recon_loss: 40035.5629; train_gene_expr_recon_loss: 99322.8398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141488.9261; train_optim_loss: 141488.9261; val_kl_reg_loss: 2110.0968; val_edge_recon_loss: 39333.0251; val_gene_expr_recon_loss: 100254.3649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141697.4869; val_optim_loss: 141697.4869

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 44 min 49 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
Val AUROC score: 0.9860
Val AUPRC score: 0.9984
Val best accuracy score: 0.9834
Val best F1 score: 0.9911
Val gene expr MSE score: 0.9817
Duration of model training in run 5: 0 hours, 45 minutes and 23 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 49099
Number of validation nodes: 5456
Number of training edges: 336078
Number of validation edges: 37341
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9435; val_auprc_score: 0.9939; val_best_acc_score: 0.9644; val_best_f1_score: 0.9810; train_kl_reg_loss: 1800.1736; train_edge_recon_loss: 43510.9368; train_gene_expr_recon_loss: 113025.0137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158336.1241; train_optim_loss: 158336.1241; val_kl_reg_loss: 1983.2188; val_edge_recon_loss: 39710.0785; val_gene_expr_recon_loss: 109140.6191; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 150833.9153; val_optim_loss: 150833.9153
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9612; val_auprc_score: 0.9959; val_best_acc_score: 0.9702; val_best_f1_score: 0.9840; train_kl_reg_loss: 2053.2295; train_edge_recon_loss: 40861.6317; train_gene_expr_recon_loss: 107605.2049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 150520.0661; train_optim_loss: 150520.0661; val_kl_reg_loss: 2021.6291; val_edge_recon_loss: 40165.1209; val_gene_expr_recon_loss: 106781.5768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148968.3267; val_optim_loss: 148968.3267
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9631; val_auprc_score: 0.9960; val_best_acc_score: 0.9727; val_best_f1_score: 0.9854; train_kl_reg_loss: 2053.8523; train_edge_recon_loss: 40761.2033; train_gene_expr_recon_loss: 105538.5638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 148353.6190; train_optim_loss: 148353.6190; val_kl_reg_loss: 1984.2753; val_edge_recon_loss: 39329.5025; val_gene_expr_recon_loss: 105210.0867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146523.8645; val_optim_loss: 146523.8645
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9661; val_auprc_score: 0.9965; val_best_acc_score: 0.9740; val_best_f1_score: 0.9861; train_kl_reg_loss: 2062.4575; train_edge_recon_loss: 40482.8031; train_gene_expr_recon_loss: 104122.5733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146667.8340; train_optim_loss: 146667.8340; val_kl_reg_loss: 1985.9907; val_edge_recon_loss: 40598.2849; val_gene_expr_recon_loss: 104078.4702; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146662.7458; val_optim_loss: 146662.7458
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9703; val_auprc_score: 0.9964; val_best_acc_score: 0.9756; val_best_f1_score: 0.9869; train_kl_reg_loss: 2064.8202; train_edge_recon_loss: 40171.2556; train_gene_expr_recon_loss: 103177.1481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145413.2240; train_optim_loss: 145413.2240; val_kl_reg_loss: 2098.3737; val_edge_recon_loss: 40278.6004; val_gene_expr_recon_loss: 103461.5858; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145838.5597; val_optim_loss: 145838.5597
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9686; val_auprc_score: 0.9965; val_best_acc_score: 0.9765; val_best_f1_score: 0.9874; train_kl_reg_loss: 2074.3655; train_edge_recon_loss: 40220.9434; train_gene_expr_recon_loss: 102479.4220; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144774.7310; train_optim_loss: 144774.7310; val_kl_reg_loss: 1975.3847; val_edge_recon_loss: 40431.2129; val_gene_expr_recon_loss: 103320.0470; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145726.6445; val_optim_loss: 145726.6445
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9738; val_auprc_score: 0.9972; val_best_acc_score: 0.9777; val_best_f1_score: 0.9880; train_kl_reg_loss: 2090.4031; train_edge_recon_loss: 40752.9782; train_gene_expr_recon_loss: 101979.5139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144822.8950; train_optim_loss: 144822.8950; val_kl_reg_loss: 2136.6722; val_edge_recon_loss: 40089.1519; val_gene_expr_recon_loss: 102451.9960; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144677.8206; val_optim_loss: 144677.8206
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9763; val_auprc_score: 0.9975; val_best_acc_score: 0.9792; val_best_f1_score: 0.9888; train_kl_reg_loss: 2092.5262; train_edge_recon_loss: 40045.0344; train_gene_expr_recon_loss: 101680.5395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143818.1004; train_optim_loss: 143818.1004; val_kl_reg_loss: 2139.6391; val_edge_recon_loss: 40032.8810; val_gene_expr_recon_loss: 102147.0046; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144319.5246; val_optim_loss: 144319.5246
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9776; val_auprc_score: 0.9970; val_best_acc_score: 0.9796; val_best_f1_score: 0.9890; train_kl_reg_loss: 2114.6269; train_edge_recon_loss: 40386.2640; train_gene_expr_recon_loss: 101240.5578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143741.4485; train_optim_loss: 143741.4485; val_kl_reg_loss: 2105.6650; val_edge_recon_loss: 41347.2555; val_gene_expr_recon_loss: 101582.6065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145035.5276; val_optim_loss: 145035.5276
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9771; val_auprc_score: 0.9973; val_best_acc_score: 0.9797; val_best_f1_score: 0.9891; train_kl_reg_loss: 2124.6679; train_edge_recon_loss: 40368.1892; train_gene_expr_recon_loss: 100929.7152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143422.5720; train_optim_loss: 143422.5720; val_kl_reg_loss: 2075.7823; val_edge_recon_loss: 40630.2226; val_gene_expr_recon_loss: 102023.2527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144729.2577; val_optim_loss: 144729.2577
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9791; val_auprc_score: 0.9973; val_best_acc_score: 0.9803; val_best_f1_score: 0.9894; train_kl_reg_loss: 2124.1450; train_edge_recon_loss: 39818.1611; train_gene_expr_recon_loss: 100612.9391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142555.2453; train_optim_loss: 142555.2453; val_kl_reg_loss: 2051.5208; val_edge_recon_loss: 39803.8967; val_gene_expr_recon_loss: 101719.7823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143575.1990; val_optim_loss: 143575.1990
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9804; val_auprc_score: 0.9978; val_best_acc_score: 0.9809; val_best_f1_score: 0.9897; train_kl_reg_loss: 2131.9912; train_edge_recon_loss: 39854.3725; train_gene_expr_recon_loss: 100494.0282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142480.3923; train_optim_loss: 142480.3923; val_kl_reg_loss: 2110.4667; val_edge_recon_loss: 39942.3981; val_gene_expr_recon_loss: 101728.0418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143780.9079; val_optim_loss: 143780.9079
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9785; val_auprc_score: 0.9973; val_best_acc_score: 0.9823; val_best_f1_score: 0.9905; train_kl_reg_loss: 2140.0373; train_edge_recon_loss: 39687.0320; train_gene_expr_recon_loss: 100297.4557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142124.5253; train_optim_loss: 142124.5253; val_kl_reg_loss: 2132.8330; val_edge_recon_loss: 39682.8172; val_gene_expr_recon_loss: 101537.6709; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143353.3218; val_optim_loss: 143353.3218
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9829; val_auprc_score: 0.9979; val_best_acc_score: 0.9822; val_best_f1_score: 0.9904; train_kl_reg_loss: 2149.7087; train_edge_recon_loss: 40006.3443; train_gene_expr_recon_loss: 100002.5694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142158.6221; train_optim_loss: 142158.6221; val_kl_reg_loss: 2144.5899; val_edge_recon_loss: 40222.9320; val_gene_expr_recon_loss: 101136.6008; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143504.1220; val_optim_loss: 143504.1220
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9812; val_auprc_score: 0.9977; val_best_acc_score: 0.9829; val_best_f1_score: 0.9908; train_kl_reg_loss: 2147.7753; train_edge_recon_loss: 39878.8643; train_gene_expr_recon_loss: 99781.1876; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141807.8272; train_optim_loss: 141807.8272; val_kl_reg_loss: 2068.4394; val_edge_recon_loss: 40861.7054; val_gene_expr_recon_loss: 101136.5669; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144066.7113; val_optim_loss: 144066.7113
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9833; val_auprc_score: 0.9979; val_best_acc_score: 0.9833; val_best_f1_score: 0.9910; train_kl_reg_loss: 2171.6258; train_edge_recon_loss: 39913.2569; train_gene_expr_recon_loss: 99733.4494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141818.3322; train_optim_loss: 141818.3322; val_kl_reg_loss: 2136.5518; val_edge_recon_loss: 39890.4805; val_gene_expr_recon_loss: 101103.6457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143130.6784; val_optim_loss: 143130.6784
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9840; val_auprc_score: 0.9981; val_best_acc_score: 0.9834; val_best_f1_score: 0.9911; train_kl_reg_loss: 2186.1255; train_edge_recon_loss: 40280.4561; train_gene_expr_recon_loss: 99600.2192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142066.8012; train_optim_loss: 142066.8012; val_kl_reg_loss: 2204.0502; val_edge_recon_loss: 40281.3043; val_gene_expr_recon_loss: 100977.4620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143462.8181; val_optim_loss: 143462.8181
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9818; val_auprc_score: 0.9975; val_best_acc_score: 0.9841; val_best_f1_score: 0.9915; train_kl_reg_loss: 2193.7710; train_edge_recon_loss: 40126.7373; train_gene_expr_recon_loss: 99426.5952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141747.1033; train_optim_loss: 141747.1033; val_kl_reg_loss: 2188.5355; val_edge_recon_loss: 38324.9266; val_gene_expr_recon_loss: 101497.2262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142010.6891; val_optim_loss: 142010.6891
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9845; val_auprc_score: 0.9983; val_best_acc_score: 0.9853; val_best_f1_score: 0.9921; train_kl_reg_loss: 2207.7544; train_edge_recon_loss: 40333.6375; train_gene_expr_recon_loss: 99143.7540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141685.1459; train_optim_loss: 141685.1459; val_kl_reg_loss: 2192.1984; val_edge_recon_loss: 39152.4550; val_gene_expr_recon_loss: 101009.5925; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142354.2454; val_optim_loss: 142354.2454
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9872; val_auprc_score: 0.9988; val_best_acc_score: 0.9841; val_best_f1_score: 0.9914; train_kl_reg_loss: 2222.3209; train_edge_recon_loss: 39908.4978; train_gene_expr_recon_loss: 99139.8881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141270.7069; train_optim_loss: 141270.7069; val_kl_reg_loss: 2218.2026; val_edge_recon_loss: 40597.0920; val_gene_expr_recon_loss: 101051.9031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143867.1972; val_optim_loss: 143867.1972
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9867; val_auprc_score: 0.9984; val_best_acc_score: 0.9845; val_best_f1_score: 0.9916; train_kl_reg_loss: 2230.2846; train_edge_recon_loss: 40228.7318; train_gene_expr_recon_loss: 99059.5993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141518.6156; train_optim_loss: 141518.6156; val_kl_reg_loss: 2206.2222; val_edge_recon_loss: 40451.5790; val_gene_expr_recon_loss: 101107.1556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143764.9568; val_optim_loss: 143764.9568

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9870; val_auprc_score: 0.9984; val_best_acc_score: 0.9856; val_best_f1_score: 0.9922; train_kl_reg_loss: 2227.3323; train_edge_recon_loss: 39725.5016; train_gene_expr_recon_loss: 98494.9260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140447.7597; train_optim_loss: 140447.7597; val_kl_reg_loss: 2188.7634; val_edge_recon_loss: 40230.2351; val_gene_expr_recon_loss: 100804.0129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143223.0120; val_optim_loss: 143223.0120
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9864; val_auprc_score: 0.9983; val_best_acc_score: 0.9859; val_best_f1_score: 0.9924; train_kl_reg_loss: 2222.1889; train_edge_recon_loss: 39750.9643; train_gene_expr_recon_loss: 98414.6846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140387.8374; train_optim_loss: 140387.8374; val_kl_reg_loss: 2191.7127; val_edge_recon_loss: 39067.0005; val_gene_expr_recon_loss: 100959.9801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142218.6925; val_optim_loss: 142218.6925
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9873; val_auprc_score: 0.9986; val_best_acc_score: 0.9864; val_best_f1_score: 0.9927; train_kl_reg_loss: 2220.4706; train_edge_recon_loss: 39619.4865; train_gene_expr_recon_loss: 98456.9047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140296.8617; train_optim_loss: 140296.8617; val_kl_reg_loss: 2203.6439; val_edge_recon_loss: 39515.9543; val_gene_expr_recon_loss: 100724.6164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142444.2147; val_optim_loss: 142444.2147

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 41 min 5 sec.
Using best model state, which was in epoch 18.

--- MODEL EVALUATION ---
Val AUROC score: 0.9845
Val AUPRC score: 0.9982
Val best accuracy score: 0.9833
Val best F1 score: 0.9910
Val gene expr MSE score: 0.8199
Duration of model training in run 6: 0 hours, 41 minutes and 39 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 49099
Number of validation nodes: 5456
Number of training edges: 445494
Number of validation edges: 49499
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9457; val_auprc_score: 0.9938; val_best_acc_score: 0.9691; val_best_f1_score: 0.9834; train_kl_reg_loss: 1883.4209; train_edge_recon_loss: 42512.7338; train_gene_expr_recon_loss: 111710.1749; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 156106.3297; train_optim_loss: 156106.3297; val_kl_reg_loss: 1909.3248; val_edge_recon_loss: 40960.7878; val_gene_expr_recon_loss: 107700.6321; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 150570.7448; val_optim_loss: 150570.7448
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9632; val_auprc_score: 0.9957; val_best_acc_score: 0.9718; val_best_f1_score: 0.9848; train_kl_reg_loss: 2040.3205; train_edge_recon_loss: 40942.8697; train_gene_expr_recon_loss: 105960.3551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 148943.5453; train_optim_loss: 148943.5453; val_kl_reg_loss: 2083.5483; val_edge_recon_loss: 41302.3431; val_gene_expr_recon_loss: 104900.5192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148286.4108; val_optim_loss: 148286.4108
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9675; val_auprc_score: 0.9964; val_best_acc_score: 0.9750; val_best_f1_score: 0.9866; train_kl_reg_loss: 2041.4362; train_edge_recon_loss: 40261.6504; train_gene_expr_recon_loss: 103876.8576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146179.9442; train_optim_loss: 146179.9442; val_kl_reg_loss: 1927.0730; val_edge_recon_loss: 39860.3569; val_gene_expr_recon_loss: 103535.6903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145323.1203; val_optim_loss: 145323.1203
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9712; val_auprc_score: 0.9967; val_best_acc_score: 0.9786; val_best_f1_score: 0.9885; train_kl_reg_loss: 2063.5595; train_edge_recon_loss: 40328.0254; train_gene_expr_recon_loss: 102758.7964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145150.3812; train_optim_loss: 145150.3812; val_kl_reg_loss: 2067.5048; val_edge_recon_loss: 38296.1920; val_gene_expr_recon_loss: 102617.3481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142981.0453; val_optim_loss: 142981.0453
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9792; val_auprc_score: 0.9976; val_best_acc_score: 0.9815; val_best_f1_score: 0.9900; train_kl_reg_loss: 2081.4415; train_edge_recon_loss: 40074.8168; train_gene_expr_recon_loss: 102015.3044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144171.5627; train_optim_loss: 144171.5627; val_kl_reg_loss: 2004.4893; val_edge_recon_loss: 39794.1593; val_gene_expr_recon_loss: 102212.1972; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144010.8459; val_optim_loss: 144010.8459
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9782; val_auprc_score: 0.9974; val_best_acc_score: 0.9815; val_best_f1_score: 0.9901; train_kl_reg_loss: 2082.7645; train_edge_recon_loss: 39945.0961; train_gene_expr_recon_loss: 101573.9720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143601.8328; train_optim_loss: 143601.8328; val_kl_reg_loss: 2027.4393; val_edge_recon_loss: 39450.5250; val_gene_expr_recon_loss: 101968.4739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143446.4378; val_optim_loss: 143446.4378
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9809; val_auprc_score: 0.9978; val_best_acc_score: 0.9825; val_best_f1_score: 0.9906; train_kl_reg_loss: 2099.1703; train_edge_recon_loss: 40321.1777; train_gene_expr_recon_loss: 101224.7310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143645.0790; train_optim_loss: 143645.0790; val_kl_reg_loss: 2125.1240; val_edge_recon_loss: 39969.5728; val_gene_expr_recon_loss: 101680.4398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143775.1364; val_optim_loss: 143775.1364

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9813; val_auprc_score: 0.9980; val_best_acc_score: 0.9833; val_best_f1_score: 0.9910; train_kl_reg_loss: 2109.0353; train_edge_recon_loss: 39954.3899; train_gene_expr_recon_loss: 100578.0522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142641.4774; train_optim_loss: 142641.4774; val_kl_reg_loss: 2075.7095; val_edge_recon_loss: 39482.6331; val_gene_expr_recon_loss: 101254.6163; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142812.9587; val_optim_loss: 142812.9587
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9817; val_auprc_score: 0.9981; val_best_acc_score: 0.9835; val_best_f1_score: 0.9911; train_kl_reg_loss: 2094.2024; train_edge_recon_loss: 39735.9826; train_gene_expr_recon_loss: 100448.4865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142278.6714; train_optim_loss: 142278.6714; val_kl_reg_loss: 2069.2862; val_edge_recon_loss: 39113.8948; val_gene_expr_recon_loss: 101205.1608; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142388.3416; val_optim_loss: 142388.3416
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9832; val_auprc_score: 0.9977; val_best_acc_score: 0.9839; val_best_f1_score: 0.9913; train_kl_reg_loss: 2093.6412; train_edge_recon_loss: 39795.1474; train_gene_expr_recon_loss: 100398.9840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142287.7725; train_optim_loss: 142287.7725; val_kl_reg_loss: 2079.4535; val_edge_recon_loss: 40196.9363; val_gene_expr_recon_loss: 101120.6173; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143397.0063; val_optim_loss: 143397.0063
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9836; val_auprc_score: 0.9980; val_best_acc_score: 0.9841; val_best_f1_score: 0.9915; train_kl_reg_loss: 2102.1838; train_edge_recon_loss: 39824.4469; train_gene_expr_recon_loss: 100399.3008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142325.9317; train_optim_loss: 142325.9317; val_kl_reg_loss: 2085.7722; val_edge_recon_loss: 39526.9351; val_gene_expr_recon_loss: 101190.2586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142802.9656; val_optim_loss: 142802.9656
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9841; val_auprc_score: 0.9983; val_best_acc_score: 0.9853; val_best_f1_score: 0.9921; train_kl_reg_loss: 2092.6354; train_edge_recon_loss: 39861.0420; train_gene_expr_recon_loss: 100332.7935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142286.4709; train_optim_loss: 142286.4709; val_kl_reg_loss: 2055.1534; val_edge_recon_loss: 38099.1104; val_gene_expr_recon_loss: 101202.9056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141357.1690; val_optim_loss: 141357.1690
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9839; val_auprc_score: 0.9982; val_best_acc_score: 0.9853; val_best_f1_score: 0.9921; train_kl_reg_loss: 2091.7191; train_edge_recon_loss: 39334.5119; train_gene_expr_recon_loss: 100335.0063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141761.2372; train_optim_loss: 141761.2372; val_kl_reg_loss: 2053.7033; val_edge_recon_loss: 38656.6879; val_gene_expr_recon_loss: 101274.9619; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141985.3533; val_optim_loss: 141985.3533
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9860; val_auprc_score: 0.9986; val_best_acc_score: 0.9842; val_best_f1_score: 0.9915; train_kl_reg_loss: 2092.0366; train_edge_recon_loss: 39720.2632; train_gene_expr_recon_loss: 100282.6759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142094.9755; train_optim_loss: 142094.9755; val_kl_reg_loss: 2080.9322; val_edge_recon_loss: 39768.7126; val_gene_expr_recon_loss: 101114.1422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142963.7862; val_optim_loss: 142963.7862
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9835; val_auprc_score: 0.9982; val_best_acc_score: 0.9848; val_best_f1_score: 0.9918; train_kl_reg_loss: 2095.3446; train_edge_recon_loss: 39797.8962; train_gene_expr_recon_loss: 100260.6600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142153.9007; train_optim_loss: 142153.9007; val_kl_reg_loss: 2110.6261; val_edge_recon_loss: 38896.6788; val_gene_expr_recon_loss: 101191.7654; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142199.0700; val_optim_loss: 142199.0700

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9849; val_auprc_score: 0.9984; val_best_acc_score: 0.9851; val_best_f1_score: 0.9920; train_kl_reg_loss: 2101.7777; train_edge_recon_loss: 39677.3705; train_gene_expr_recon_loss: 100175.6839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141954.8321; train_optim_loss: 141954.8321; val_kl_reg_loss: 2077.8373; val_edge_recon_loss: 39045.6492; val_gene_expr_recon_loss: 101203.4441; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142326.9305; val_optim_loss: 142326.9305
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9831; val_auprc_score: 0.9979; val_best_acc_score: 0.9842; val_best_f1_score: 0.9915; train_kl_reg_loss: 2094.3782; train_edge_recon_loss: 39662.9215; train_gene_expr_recon_loss: 100171.8929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141929.1926; train_optim_loss: 141929.1926; val_kl_reg_loss: 2078.2736; val_edge_recon_loss: 38974.1493; val_gene_expr_recon_loss: 101214.1368; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142266.5596; val_optim_loss: 142266.5596
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9843; val_auprc_score: 0.9982; val_best_acc_score: 0.9854; val_best_f1_score: 0.9921; train_kl_reg_loss: 2100.2705; train_edge_recon_loss: 39998.9916; train_gene_expr_recon_loss: 100163.4270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142262.6890; train_optim_loss: 142262.6890; val_kl_reg_loss: 2079.1216; val_edge_recon_loss: 38859.4097; val_gene_expr_recon_loss: 101167.3210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142105.8520; val_optim_loss: 142105.8520

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 69 min 17 sec.
Using best model state, which was in epoch 12.

--- MODEL EVALUATION ---
Val AUROC score: 0.9844
Val AUPRC score: 0.9982
Val best accuracy score: 0.9838
Val best F1 score: 0.9913
Val gene expr MSE score: 0.8384
Duration of model training in run 7: 1 hours, 10 minutes and 45 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 49099
Number of validation nodes: 5456
Number of training edges: 445494
Number of validation edges: 49499
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9464; val_auprc_score: 0.9939; val_best_acc_score: 0.9677; val_best_f1_score: 0.9827; train_kl_reg_loss: 1869.5115; train_edge_recon_loss: 42118.4956; train_gene_expr_recon_loss: 111841.2788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155829.2859; train_optim_loss: 155829.2859; val_kl_reg_loss: 1924.7994; val_edge_recon_loss: 40259.3889; val_gene_expr_recon_loss: 107602.8095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 149786.9979; val_optim_loss: 149786.9979
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9584; val_auprc_score: 0.9951; val_best_acc_score: 0.9729; val_best_f1_score: 0.9855; train_kl_reg_loss: 2028.2485; train_edge_recon_loss: 40884.6785; train_gene_expr_recon_loss: 106007.7381; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 148920.6652; train_optim_loss: 148920.6652; val_kl_reg_loss: 2046.3751; val_edge_recon_loss: 39562.7311; val_gene_expr_recon_loss: 104578.9708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146188.0773; val_optim_loss: 146188.0773
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9680; val_auprc_score: 0.9962; val_best_acc_score: 0.9758; val_best_f1_score: 0.9870; train_kl_reg_loss: 2063.0015; train_edge_recon_loss: 40313.5451; train_gene_expr_recon_loss: 103912.0649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146288.6113; train_optim_loss: 146288.6113; val_kl_reg_loss: 2018.0390; val_edge_recon_loss: 40425.9228; val_gene_expr_recon_loss: 103119.7139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145563.6757; val_optim_loss: 145563.6757
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9729; val_auprc_score: 0.9972; val_best_acc_score: 0.9775; val_best_f1_score: 0.9879; train_kl_reg_loss: 2067.5256; train_edge_recon_loss: 40093.9742; train_gene_expr_recon_loss: 102791.5581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144953.0578; train_optim_loss: 144953.0578; val_kl_reg_loss: 2080.6088; val_edge_recon_loss: 39351.2657; val_gene_expr_recon_loss: 102312.9060; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143744.7806; val_optim_loss: 143744.7806
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9754; val_auprc_score: 0.9974; val_best_acc_score: 0.9800; val_best_f1_score: 0.9892; train_kl_reg_loss: 2077.0245; train_edge_recon_loss: 39740.1786; train_gene_expr_recon_loss: 102050.5233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143867.7265; train_optim_loss: 143867.7265; val_kl_reg_loss: 2122.2675; val_edge_recon_loss: 39279.4043; val_gene_expr_recon_loss: 101781.6395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143183.3114; val_optim_loss: 143183.3114
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9787; val_auprc_score: 0.9974; val_best_acc_score: 0.9817; val_best_f1_score: 0.9901; train_kl_reg_loss: 2085.9127; train_edge_recon_loss: 39779.6222; train_gene_expr_recon_loss: 101591.6878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143457.2229; train_optim_loss: 143457.2229; val_kl_reg_loss: 2018.3445; val_edge_recon_loss: 40143.5973; val_gene_expr_recon_loss: 101568.0310; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143729.9728; val_optim_loss: 143729.9728
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9803; val_auprc_score: 0.9978; val_best_acc_score: 0.9828; val_best_f1_score: 0.9908; train_kl_reg_loss: 2093.9898; train_edge_recon_loss: 39728.5798; train_gene_expr_recon_loss: 101213.7466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143036.3162; train_optim_loss: 143036.3162; val_kl_reg_loss: 2079.7849; val_edge_recon_loss: 39254.3728; val_gene_expr_recon_loss: 101377.8749; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142712.0327; val_optim_loss: 142712.0327
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9823; val_auprc_score: 0.9982; val_best_acc_score: 0.9838; val_best_f1_score: 0.9913; train_kl_reg_loss: 2122.2315; train_edge_recon_loss: 39806.1239; train_gene_expr_recon_loss: 100997.9961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142926.3513; train_optim_loss: 142926.3513; val_kl_reg_loss: 2156.7948; val_edge_recon_loss: 39395.1471; val_gene_expr_recon_loss: 101185.5853; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142737.5273; val_optim_loss: 142737.5273
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9822; val_auprc_score: 0.9979; val_best_acc_score: 0.9838; val_best_f1_score: 0.9913; train_kl_reg_loss: 2125.0855; train_edge_recon_loss: 39834.7905; train_gene_expr_recon_loss: 100812.0307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142771.9067; train_optim_loss: 142771.9067; val_kl_reg_loss: 2064.4518; val_edge_recon_loss: 39668.0253; val_gene_expr_recon_loss: 101115.3371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142847.8144; val_optim_loss: 142847.8144
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9832; val_auprc_score: 0.9980; val_best_acc_score: 0.9842; val_best_f1_score: 0.9915; train_kl_reg_loss: 2136.8142; train_edge_recon_loss: 39836.6806; train_gene_expr_recon_loss: 100595.3277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142568.8226; train_optim_loss: 142568.8226; val_kl_reg_loss: 2111.3687; val_edge_recon_loss: 39621.9627; val_gene_expr_recon_loss: 100998.9570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142732.2879; val_optim_loss: 142732.2879

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9846; val_auprc_score: 0.9983; val_best_acc_score: 0.9852; val_best_f1_score: 0.9920; train_kl_reg_loss: 2139.5746; train_edge_recon_loss: 39781.6426; train_gene_expr_recon_loss: 100100.8852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142022.1022; train_optim_loss: 142022.1022; val_kl_reg_loss: 2121.5606; val_edge_recon_loss: 40325.4879; val_gene_expr_recon_loss: 100873.1796; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143320.2283; val_optim_loss: 143320.2283
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9864; val_auprc_score: 0.9985; val_best_acc_score: 0.9858; val_best_f1_score: 0.9924; train_kl_reg_loss: 2137.3580; train_edge_recon_loss: 39711.7490; train_gene_expr_recon_loss: 99938.1542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141787.2611; train_optim_loss: 141787.2611; val_kl_reg_loss: 2127.0069; val_edge_recon_loss: 38430.6177; val_gene_expr_recon_loss: 100825.8661; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141383.4908; val_optim_loss: 141383.4908
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9879; val_auprc_score: 0.9988; val_best_acc_score: 0.9858; val_best_f1_score: 0.9924; train_kl_reg_loss: 2132.3361; train_edge_recon_loss: 39414.0944; train_gene_expr_recon_loss: 99930.5635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141476.9938; train_optim_loss: 141476.9938; val_kl_reg_loss: 2117.4568; val_edge_recon_loss: 39074.3002; val_gene_expr_recon_loss: 100735.8353; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141927.5923; val_optim_loss: 141927.5923
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9859; val_auprc_score: 0.9984; val_best_acc_score: 0.9863; val_best_f1_score: 0.9927; train_kl_reg_loss: 2133.9551; train_edge_recon_loss: 39711.2880; train_gene_expr_recon_loss: 99901.2371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141746.4803; train_optim_loss: 141746.4803; val_kl_reg_loss: 2144.2130; val_edge_recon_loss: 39112.7707; val_gene_expr_recon_loss: 100715.9603; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141972.9439; val_optim_loss: 141972.9439
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9875; val_auprc_score: 0.9983; val_best_acc_score: 0.9862; val_best_f1_score: 0.9926; train_kl_reg_loss: 2142.0005; train_edge_recon_loss: 40123.3508; train_gene_expr_recon_loss: 99885.8496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142151.2007; train_optim_loss: 142151.2007; val_kl_reg_loss: 2113.6877; val_edge_recon_loss: 39293.3944; val_gene_expr_recon_loss: 100838.0721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142245.1544; val_optim_loss: 142245.1544

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9860; val_auprc_score: 0.9982; val_best_acc_score: 0.9859; val_best_f1_score: 0.9924; train_kl_reg_loss: 2137.0012; train_edge_recon_loss: 39522.5717; train_gene_expr_recon_loss: 99785.3455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141444.9185; train_optim_loss: 141444.9185; val_kl_reg_loss: 2120.1373; val_edge_recon_loss: 39115.7652; val_gene_expr_recon_loss: 100751.9334; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141987.8364; val_optim_loss: 141987.8364
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9857; val_auprc_score: 0.9983; val_best_acc_score: 0.9858; val_best_f1_score: 0.9924; train_kl_reg_loss: 2136.8540; train_edge_recon_loss: 39982.3739; train_gene_expr_recon_loss: 99748.0214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141867.2493; train_optim_loss: 141867.2493; val_kl_reg_loss: 2123.8575; val_edge_recon_loss: 38874.2574; val_gene_expr_recon_loss: 100773.1382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141771.2525; val_optim_loss: 141771.2525
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9870; val_auprc_score: 0.9984; val_best_acc_score: 0.9856; val_best_f1_score: 0.9922; train_kl_reg_loss: 2139.6971; train_edge_recon_loss: 39992.8592; train_gene_expr_recon_loss: 99782.9115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141915.4678; train_optim_loss: 141915.4678; val_kl_reg_loss: 2123.4176; val_edge_recon_loss: 40332.7121; val_gene_expr_recon_loss: 100766.3814; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143222.5118; val_optim_loss: 143222.5118

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 69 min 35 sec.
Using best model state, which was in epoch 12.

--- MODEL EVALUATION ---
Val AUROC score: 0.9870
Val AUPRC score: 0.9986
Val best accuracy score: 0.9853
Val best F1 score: 0.9921
Val gene expr MSE score: 0.8766
Duration of model training in run 8: 1 hours, 11 minutes and 3 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 49099
Number of validation nodes: 5456
Number of training edges: 555301
Number of validation edges: 61700
Edge batch size: 128
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9545; val_auprc_score: 0.9952; val_best_acc_score: 0.9699; val_best_f1_score: 0.9839; train_kl_reg_loss: 1910.6681; train_edge_recon_loss: 41925.9119; train_gene_expr_recon_loss: 110440.6701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154277.2500; train_optim_loss: 154277.2500; val_kl_reg_loss: 2128.8849; val_edge_recon_loss: 39374.5979; val_gene_expr_recon_loss: 105640.1393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147143.6220; val_optim_loss: 147143.6220
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9702; val_auprc_score: 0.9969; val_best_acc_score: 0.9770; val_best_f1_score: 0.9877; train_kl_reg_loss: 2038.5572; train_edge_recon_loss: 40401.0071; train_gene_expr_recon_loss: 104262.6343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146702.1986; train_optim_loss: 146702.1986; val_kl_reg_loss: 2083.2063; val_edge_recon_loss: 39438.7761; val_gene_expr_recon_loss: 102728.4369; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144250.4194; val_optim_loss: 144250.4194
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9769; val_auprc_score: 0.9973; val_best_acc_score: 0.9803; val_best_f1_score: 0.9894; train_kl_reg_loss: 2059.6129; train_edge_recon_loss: 40192.4451; train_gene_expr_recon_loss: 102582.7830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144834.8412; train_optim_loss: 144834.8412; val_kl_reg_loss: 2023.6823; val_edge_recon_loss: 39147.7251; val_gene_expr_recon_loss: 102114.7138; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143286.1212; val_optim_loss: 143286.1212
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9791; val_auprc_score: 0.9973; val_best_acc_score: 0.9822; val_best_f1_score: 0.9904; train_kl_reg_loss: 2073.6332; train_edge_recon_loss: 39665.4825; train_gene_expr_recon_loss: 101879.9238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143619.0394; train_optim_loss: 143619.0394; val_kl_reg_loss: 2059.4260; val_edge_recon_loss: 39577.4928; val_gene_expr_recon_loss: 101377.6765; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143014.5950; val_optim_loss: 143014.5950
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9799; val_auprc_score: 0.9977; val_best_acc_score: 0.9835; val_best_f1_score: 0.9911; train_kl_reg_loss: 2099.6031; train_edge_recon_loss: 39816.7894; train_gene_expr_recon_loss: 101439.3113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143355.7039; train_optim_loss: 143355.7039; val_kl_reg_loss: 2007.0588; val_edge_recon_loss: 38772.8402; val_gene_expr_recon_loss: 101848.6639; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142628.5627; val_optim_loss: 142628.5627
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9826; val_auprc_score: 0.9977; val_best_acc_score: 0.9851; val_best_f1_score: 0.9920; train_kl_reg_loss: 2112.6681; train_edge_recon_loss: 39934.4531; train_gene_expr_recon_loss: 100515.2819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142562.4031; train_optim_loss: 142562.4031; val_kl_reg_loss: 2199.4125; val_edge_recon_loss: 39164.1497; val_gene_expr_recon_loss: 98380.4445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139744.0070; val_optim_loss: 139744.0070
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9851; val_auprc_score: 0.9982; val_best_acc_score: 0.9854; val_best_f1_score: 0.9921; train_kl_reg_loss: 2127.9409; train_edge_recon_loss: 39893.1028; train_gene_expr_recon_loss: 96001.5185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138022.5622; train_optim_loss: 138022.5622; val_kl_reg_loss: 2097.7233; val_edge_recon_loss: 39822.5095; val_gene_expr_recon_loss: 93900.5726; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135820.8054; val_optim_loss: 135820.8054
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9838; val_auprc_score: 0.9976; val_best_acc_score: 0.9861; val_best_f1_score: 0.9925; train_kl_reg_loss: 2134.4523; train_edge_recon_loss: 39444.4412; train_gene_expr_recon_loss: 89389.2832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130968.1768; train_optim_loss: 130968.1768; val_kl_reg_loss: 2155.5397; val_edge_recon_loss: 39167.4920; val_gene_expr_recon_loss: 89259.7112; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130582.7430; val_optim_loss: 130582.7430
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9851; val_auprc_score: 0.9979; val_best_acc_score: 0.9865; val_best_f1_score: 0.9928; train_kl_reg_loss: 2148.8318; train_edge_recon_loss: 39531.0318; train_gene_expr_recon_loss: 87372.4328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129052.2963; train_optim_loss: 129052.2963; val_kl_reg_loss: 2178.8088; val_edge_recon_loss: 39382.4779; val_gene_expr_recon_loss: 84157.2131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125718.4998; val_optim_loss: 125718.4998
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9871; val_auprc_score: 0.9983; val_best_acc_score: 0.9876; val_best_f1_score: 0.9933; train_kl_reg_loss: 2152.1025; train_edge_recon_loss: 39367.4693; train_gene_expr_recon_loss: 86752.7762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128272.3480; train_optim_loss: 128272.3480; val_kl_reg_loss: 2139.8058; val_edge_recon_loss: 38454.5284; val_gene_expr_recon_loss: 86862.9513; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127457.2853; val_optim_loss: 127457.2853
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9882; val_auprc_score: 0.9986; val_best_acc_score: 0.9879; val_best_f1_score: 0.9935; train_kl_reg_loss: 2175.5440; train_edge_recon_loss: 39772.8658; train_gene_expr_recon_loss: 86404.8966; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128353.3063; train_optim_loss: 128353.3063; val_kl_reg_loss: 2227.9340; val_edge_recon_loss: 38698.8636; val_gene_expr_recon_loss: 85665.9486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126592.7461; val_optim_loss: 126592.7461
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9878; val_auprc_score: 0.9983; val_best_acc_score: 0.9882; val_best_f1_score: 0.9936; train_kl_reg_loss: 2174.5590; train_edge_recon_loss: 39258.4347; train_gene_expr_recon_loss: 86169.9655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127602.9592; train_optim_loss: 127602.9592; val_kl_reg_loss: 2154.6806; val_edge_recon_loss: 38956.3611; val_gene_expr_recon_loss: 86166.6975; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127277.7391; val_optim_loss: 127277.7391

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9881; val_auprc_score: 0.9983; val_best_acc_score: 0.9890; val_best_f1_score: 0.9941; train_kl_reg_loss: 2195.4152; train_edge_recon_loss: 39554.7222; train_gene_expr_recon_loss: 85561.2030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127311.3404; train_optim_loss: 127311.3404; val_kl_reg_loss: 2211.2192; val_edge_recon_loss: 38985.9175; val_gene_expr_recon_loss: 86672.0463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127869.1827; val_optim_loss: 127869.1827
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9872; val_auprc_score: 0.9984; val_best_acc_score: 0.9887; val_best_f1_score: 0.9939; train_kl_reg_loss: 2188.2324; train_edge_recon_loss: 39305.1907; train_gene_expr_recon_loss: 85542.0474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127035.4706; train_optim_loss: 127035.4706; val_kl_reg_loss: 2156.3470; val_edge_recon_loss: 39378.0766; val_gene_expr_recon_loss: 86464.5716; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127998.9951; val_optim_loss: 127998.9951
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9901; val_auprc_score: 0.9985; val_best_acc_score: 0.9896; val_best_f1_score: 0.9944; train_kl_reg_loss: 2185.0093; train_edge_recon_loss: 39199.6292; train_gene_expr_recon_loss: 85460.8059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126845.4445; train_optim_loss: 126845.4445; val_kl_reg_loss: 2170.0154; val_edge_recon_loss: 38917.9627; val_gene_expr_recon_loss: 86538.3812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127626.3594; val_optim_loss: 127626.3594

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 126 min 28 sec.
Using best model state, which was in epoch 9.

--- MODEL EVALUATION ---
Val AUROC score: 0.9866
Val AUPRC score: 0.9983
Val best accuracy score: 0.9869
Val best F1 score: 0.9929
Val gene expr MSE score: 0.8735
Duration of model training in run 9: 2 hours, 10 minutes and 5 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 49099
Number of validation nodes: 5456
Number of training edges: 555301
Number of validation edges: 61700
Edge batch size: 128
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9531; val_auprc_score: 0.9947; val_best_acc_score: 0.9680; val_best_f1_score: 0.9829; train_kl_reg_loss: 1909.7369; train_edge_recon_loss: 41977.6891; train_gene_expr_recon_loss: 110848.3389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154735.7649; train_optim_loss: 154735.7649; val_kl_reg_loss: 2102.7181; val_edge_recon_loss: 39824.2902; val_gene_expr_recon_loss: 106057.1997; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147984.2079; val_optim_loss: 147984.2079
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9674; val_auprc_score: 0.9964; val_best_acc_score: 0.9747; val_best_f1_score: 0.9864; train_kl_reg_loss: 2049.1429; train_edge_recon_loss: 40390.6725; train_gene_expr_recon_loss: 104438.8774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146878.6927; train_optim_loss: 146878.6927; val_kl_reg_loss: 1963.9266; val_edge_recon_loss: 39631.8205; val_gene_expr_recon_loss: 103285.5790; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144881.3261; val_optim_loss: 144881.3261
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9756; val_auprc_score: 0.9973; val_best_acc_score: 0.9802; val_best_f1_score: 0.9894; train_kl_reg_loss: 2056.1821; train_edge_recon_loss: 40033.3674; train_gene_expr_recon_loss: 102552.1017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144641.6512; train_optim_loss: 144641.6512; val_kl_reg_loss: 2076.3725; val_edge_recon_loss: 39022.4328; val_gene_expr_recon_loss: 102451.4907; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143550.2961; val_optim_loss: 143550.2961
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9794; val_auprc_score: 0.9976; val_best_acc_score: 0.9819; val_best_f1_score: 0.9903; train_kl_reg_loss: 2076.4431; train_edge_recon_loss: 40085.2268; train_gene_expr_recon_loss: 101915.6400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144077.3098; train_optim_loss: 144077.3098; val_kl_reg_loss: 2083.3148; val_edge_recon_loss: 39602.2257; val_gene_expr_recon_loss: 101873.9320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143559.4725; val_optim_loss: 143559.4725
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9806; val_auprc_score: 0.9975; val_best_acc_score: 0.9836; val_best_f1_score: 0.9912; train_kl_reg_loss: 2090.7185; train_edge_recon_loss: 39776.7431; train_gene_expr_recon_loss: 101455.4232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143322.8849; train_optim_loss: 143322.8849; val_kl_reg_loss: 2123.2907; val_edge_recon_loss: 39195.4462; val_gene_expr_recon_loss: 101186.9816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142505.7184; val_optim_loss: 142505.7184
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9835; val_auprc_score: 0.9980; val_best_acc_score: 0.9843; val_best_f1_score: 0.9915; train_kl_reg_loss: 2110.1280; train_edge_recon_loss: 39726.0714; train_gene_expr_recon_loss: 100875.5681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142711.7675; train_optim_loss: 142711.7675; val_kl_reg_loss: 2044.0287; val_edge_recon_loss: 40349.5934; val_gene_expr_recon_loss: 95964.0172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138357.6392; val_optim_loss: 138357.6392
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9843; val_auprc_score: 0.9982; val_best_acc_score: 0.9853; val_best_f1_score: 0.9921; train_kl_reg_loss: 2120.9150; train_edge_recon_loss: 39719.0201; train_gene_expr_recon_loss: 96454.9576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138294.8926; train_optim_loss: 138294.8926; val_kl_reg_loss: 2153.7777; val_edge_recon_loss: 39360.7363; val_gene_expr_recon_loss: 87738.0948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129252.6090; val_optim_loss: 129252.6090
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9868; val_auprc_score: 0.9982; val_best_acc_score: 0.9867; val_best_f1_score: 0.9928; train_kl_reg_loss: 2133.3802; train_edge_recon_loss: 39424.4144; train_gene_expr_recon_loss: 89683.5822; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131241.3769; train_optim_loss: 131241.3769; val_kl_reg_loss: 2140.7329; val_edge_recon_loss: 38509.1167; val_gene_expr_recon_loss: 85351.6398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126001.4895; val_optim_loss: 126001.4895
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9872; val_auprc_score: 0.9984; val_best_acc_score: 0.9862; val_best_f1_score: 0.9926; train_kl_reg_loss: 2143.4515; train_edge_recon_loss: 39559.5596; train_gene_expr_recon_loss: 87443.2713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129146.2824; train_optim_loss: 129146.2824; val_kl_reg_loss: 2098.8415; val_edge_recon_loss: 38983.1826; val_gene_expr_recon_loss: 91825.2172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132907.2412; val_optim_loss: 132907.2412
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9863; val_auprc_score: 0.9984; val_best_acc_score: 0.9870; val_best_f1_score: 0.9930; train_kl_reg_loss: 2156.0849; train_edge_recon_loss: 39534.0784; train_gene_expr_recon_loss: 86699.3555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128389.5187; train_optim_loss: 128389.5187; val_kl_reg_loss: 2167.1545; val_edge_recon_loss: 38515.5587; val_gene_expr_recon_loss: 87312.0897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127994.8027; val_optim_loss: 127994.8027
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9862; val_auprc_score: 0.9981; val_best_acc_score: 0.9878; val_best_f1_score: 0.9934; train_kl_reg_loss: 2169.0492; train_edge_recon_loss: 39725.0273; train_gene_expr_recon_loss: 86314.3086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128208.3852; train_optim_loss: 128208.3852; val_kl_reg_loss: 2146.8896; val_edge_recon_loss: 38998.6795; val_gene_expr_recon_loss: 86630.2686; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127775.8375; val_optim_loss: 127775.8375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9879; val_auprc_score: 0.9985; val_best_acc_score: 0.9880; val_best_f1_score: 0.9935; train_kl_reg_loss: 2173.5655; train_edge_recon_loss: 39213.9456; train_gene_expr_recon_loss: 85825.6832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127213.1944; train_optim_loss: 127213.1944; val_kl_reg_loss: 2146.1681; val_edge_recon_loss: 40217.7087; val_gene_expr_recon_loss: 86634.1161; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128997.9929; val_optim_loss: 128997.9929
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9906; val_auprc_score: 0.9989; val_best_acc_score: 0.9888; val_best_f1_score: 0.9940; train_kl_reg_loss: 2170.6916; train_edge_recon_loss: 39323.4067; train_gene_expr_recon_loss: 85707.0289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127201.1270; train_optim_loss: 127201.1270; val_kl_reg_loss: 2154.2164; val_edge_recon_loss: 38634.4479; val_gene_expr_recon_loss: 88154.3258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128942.9897; val_optim_loss: 128942.9897
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9890; val_auprc_score: 0.9987; val_best_acc_score: 0.9890; val_best_f1_score: 0.9941; train_kl_reg_loss: 2169.0483; train_edge_recon_loss: 39631.4987; train_gene_expr_recon_loss: 85663.7572; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127464.3041; train_optim_loss: 127464.3041; val_kl_reg_loss: 2160.7430; val_edge_recon_loss: 38513.2918; val_gene_expr_recon_loss: 88223.0181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128897.0531; val_optim_loss: 128897.0531

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 119 min 34 sec.
Using best model state, which was in epoch 8.

--- MODEL EVALUATION ---
Val AUROC score: 0.9846
Val AUPRC score: 0.9981
Val best accuracy score: 0.9853
Val best F1 score: 0.9921
Val gene expr MSE score: 0.8842
Duration of model training in run 10: 2 hours, 3 minutes and 14 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
First script finished. Launching follow up script.
Run timestamp: 03062023_114130.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '2048', '2048', '1024', '1024', '512', '512', '256', '256', '128', '128', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'Main_molecular_cell_type', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'starmap_plus_mouse_cns_subsample_10pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', 'batch9', 'batch10', 'batch11', 'batch12', 'batch13', 'batch14', 'batch15', 'batch16', 'batch17', 'batch18', 'batch19', 'batch20', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
First script finished. Launching follow up script.
Run timestamp: 03062023_114315.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '2048', '2048', '1024', '1024', '512', '512', '256', '256', '128', '128', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'Main_molecular_cell_type', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'starmap_plus_mouse_cns_subsample_25pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', 'batch9', 'batch10', 'batch11', 'batch12', 'batch13', 'batch14', 'batch15', 'batch16', 'batch17', 'batch18', 'batch19', 'batch20', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
First script finished. Launching follow up script.
Run timestamp: 03062023_114500.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '2048', '2048', '1024', '1024', '512', '512', '256', '256', '128', '128', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'Main_molecular_cell_type', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'starmap_plus_mouse_cns_subsample_50pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', 'batch9', 'batch10', 'batch11', 'batch12', 'batch13', 'batch14', 'batch15', 'batch16', 'batch17', 'batch18', 'batch19', 'batch20', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
