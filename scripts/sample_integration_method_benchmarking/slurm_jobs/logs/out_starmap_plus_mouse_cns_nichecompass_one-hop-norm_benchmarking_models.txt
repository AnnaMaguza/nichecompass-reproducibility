First script finished. Launching follow up script.
Run timestamp: 02062023_065414.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '2048', '2048', '1024', '1024', '512', '512', '256', '256', '128', '128', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'Main_molecular_cell_type', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', 'batch9', 'batch10', 'batch11', 'batch12', 'batch13', 'batch14', 'batch15', 'batch16', 'batch17', 'batch18', 'batch19', 'batch20', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 982152
Number of validation nodes: 109128
Number of training edges: 2342808
Number of validation edges: 260312
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9663; val_auprc_score: 0.9962; val_best_acc_score: 0.9773; val_best_f1_score: 0.9878; train_kl_reg_loss: 2095.8679; train_edge_recon_loss: 40750.0709; train_gene_expr_recon_loss: 108395.8553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 151241.7938; train_optim_loss: 151241.7938; val_kl_reg_loss: 2075.2894; val_edge_recon_loss: 40424.1915; val_gene_expr_recon_loss: 103365.2156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145864.6968; val_optim_loss: 145864.6968
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9705; val_auprc_score: 0.9967; val_best_acc_score: 0.9787; val_best_f1_score: 0.9885; train_kl_reg_loss: 2250.8048; train_edge_recon_loss: 40047.8180; train_gene_expr_recon_loss: 101324.7333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143623.3561; train_optim_loss: 143623.3561; val_kl_reg_loss: 2271.8539; val_edge_recon_loss: 41356.3626; val_gene_expr_recon_loss: 99365.9835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142994.1990; val_optim_loss: 142994.1990
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9708; val_auprc_score: 0.9969; val_best_acc_score: 0.9799; val_best_f1_score: 0.9892; train_kl_reg_loss: 2360.8272; train_edge_recon_loss: 40025.3311; train_gene_expr_recon_loss: 98706.4551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141092.6134; train_optim_loss: 141092.6134; val_kl_reg_loss: 2331.3046; val_edge_recon_loss: 40523.1320; val_gene_expr_recon_loss: 97571.3832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140425.8196; val_optim_loss: 140425.8196
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9740; val_auprc_score: 0.9972; val_best_acc_score: 0.9799; val_best_f1_score: 0.9892; train_kl_reg_loss: 2425.2345; train_edge_recon_loss: 40041.1108; train_gene_expr_recon_loss: 97509.0859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139975.4314; train_optim_loss: 139975.4314; val_kl_reg_loss: 2396.2276; val_edge_recon_loss: 41417.5394; val_gene_expr_recon_loss: 96859.3862; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140673.1530; val_optim_loss: 140673.1530
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9732; val_auprc_score: 0.9971; val_best_acc_score: 0.9803; val_best_f1_score: 0.9894; train_kl_reg_loss: 2467.1192; train_edge_recon_loss: 40068.0788; train_gene_expr_recon_loss: 96758.1596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139293.3576; train_optim_loss: 139293.3576; val_kl_reg_loss: 2412.5682; val_edge_recon_loss: 41068.5386; val_gene_expr_recon_loss: 96191.3428; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139672.4501; val_optim_loss: 139672.4501
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9751; val_auprc_score: 0.9974; val_best_acc_score: 0.9807; val_best_f1_score: 0.9896; train_kl_reg_loss: 2498.7238; train_edge_recon_loss: 39945.4965; train_gene_expr_recon_loss: 96288.1204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138732.3405; train_optim_loss: 138732.3405; val_kl_reg_loss: 2451.8193; val_edge_recon_loss: 40842.6700; val_gene_expr_recon_loss: 95813.8868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139108.3762; val_optim_loss: 139108.3762
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9753; val_auprc_score: 0.9974; val_best_acc_score: 0.9810; val_best_f1_score: 0.9898; train_kl_reg_loss: 2521.9440; train_edge_recon_loss: 39996.3667; train_gene_expr_recon_loss: 95917.1142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138435.4249; train_optim_loss: 138435.4249; val_kl_reg_loss: 2465.3172; val_edge_recon_loss: 41284.6487; val_gene_expr_recon_loss: 95558.0494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139308.0154; val_optim_loss: 139308.0154
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9754; val_auprc_score: 0.9974; val_best_acc_score: 0.9813; val_best_f1_score: 0.9899; train_kl_reg_loss: 2540.7379; train_edge_recon_loss: 39952.9285; train_gene_expr_recon_loss: 95630.9160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138124.5824; train_optim_loss: 138124.5824; val_kl_reg_loss: 2557.6690; val_edge_recon_loss: 40764.8539; val_gene_expr_recon_loss: 95254.4099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138576.9332; val_optim_loss: 138576.9332
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9747; val_auprc_score: 0.9974; val_best_acc_score: 0.9815; val_best_f1_score: 0.9901; train_kl_reg_loss: 2559.4008; train_edge_recon_loss: 39936.0344; train_gene_expr_recon_loss: 95414.4020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137909.8372; train_optim_loss: 137909.8372; val_kl_reg_loss: 2560.4719; val_edge_recon_loss: 40485.7560; val_gene_expr_recon_loss: 95059.2202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138105.4490; val_optim_loss: 138105.4490
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9756; val_auprc_score: 0.9974; val_best_acc_score: 0.9819; val_best_f1_score: 0.9903; train_kl_reg_loss: 2573.0642; train_edge_recon_loss: 40096.2062; train_gene_expr_recon_loss: 95281.7213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137950.9917; train_optim_loss: 137950.9917; val_kl_reg_loss: 2571.6768; val_edge_recon_loss: 40635.5317; val_gene_expr_recon_loss: 94910.1088; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138117.3173; val_optim_loss: 138117.3173
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9763; val_auprc_score: 0.9974; val_best_acc_score: 0.9821; val_best_f1_score: 0.9904; train_kl_reg_loss: 2583.1521; train_edge_recon_loss: 40048.1767; train_gene_expr_recon_loss: 95101.8338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137733.1626; train_optim_loss: 137733.1626; val_kl_reg_loss: 2546.7909; val_edge_recon_loss: 41055.7750; val_gene_expr_recon_loss: 94879.9097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138482.4757; val_optim_loss: 138482.4757
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9759; val_auprc_score: 0.9975; val_best_acc_score: 0.9818; val_best_f1_score: 0.9903; train_kl_reg_loss: 2592.2240; train_edge_recon_loss: 40086.3997; train_gene_expr_recon_loss: 95037.5982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137716.2221; train_optim_loss: 137716.2221; val_kl_reg_loss: 2545.3603; val_edge_recon_loss: 40575.8286; val_gene_expr_recon_loss: 94756.2310; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137877.4193; val_optim_loss: 137877.4193
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9771; val_auprc_score: 0.9976; val_best_acc_score: 0.9819; val_best_f1_score: 0.9903; train_kl_reg_loss: 2600.9690; train_edge_recon_loss: 39792.7500; train_gene_expr_recon_loss: 94968.2430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137361.9619; train_optim_loss: 137361.9619; val_kl_reg_loss: 2535.4851; val_edge_recon_loss: 41064.3459; val_gene_expr_recon_loss: 94668.8900; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138268.7217; val_optim_loss: 138268.7217
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9773; val_auprc_score: 0.9976; val_best_acc_score: 0.9824; val_best_f1_score: 0.9906; train_kl_reg_loss: 2607.3688; train_edge_recon_loss: 40020.4739; train_gene_expr_recon_loss: 94873.8561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137501.6989; train_optim_loss: 137501.6989; val_kl_reg_loss: 2561.8647; val_edge_recon_loss: 41513.8340; val_gene_expr_recon_loss: 94536.6896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138612.3885; val_optim_loss: 138612.3885
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9761; val_auprc_score: 0.9975; val_best_acc_score: 0.9828; val_best_f1_score: 0.9908; train_kl_reg_loss: 2613.6053; train_edge_recon_loss: 39849.6020; train_gene_expr_recon_loss: 94809.4321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137272.6396; train_optim_loss: 137272.6396; val_kl_reg_loss: 2564.2935; val_edge_recon_loss: 40499.0849; val_gene_expr_recon_loss: 94563.2082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137626.5869; val_optim_loss: 137626.5869
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9782; val_auprc_score: 0.9977; val_best_acc_score: 0.9824; val_best_f1_score: 0.9906; train_kl_reg_loss: 2621.3124; train_edge_recon_loss: 39860.9230; train_gene_expr_recon_loss: 94735.9600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137218.1955; train_optim_loss: 137218.1955; val_kl_reg_loss: 2578.9771; val_edge_recon_loss: 40994.8697; val_gene_expr_recon_loss: 94495.5085; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138069.3552; val_optim_loss: 138069.3552
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9777; val_auprc_score: 0.9976; val_best_acc_score: 0.9834; val_best_f1_score: 0.9911; train_kl_reg_loss: 2624.0538; train_edge_recon_loss: 39865.8355; train_gene_expr_recon_loss: 94708.7345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137198.6237; train_optim_loss: 137198.6237; val_kl_reg_loss: 2614.6299; val_edge_recon_loss: 40535.4453; val_gene_expr_recon_loss: 94443.7112; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137593.7866; val_optim_loss: 137593.7866
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9774; val_auprc_score: 0.9976; val_best_acc_score: 0.9827; val_best_f1_score: 0.9907; train_kl_reg_loss: 2629.7082; train_edge_recon_loss: 39893.3627; train_gene_expr_recon_loss: 94656.9210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137179.9917; train_optim_loss: 137179.9917; val_kl_reg_loss: 2569.3015; val_edge_recon_loss: 40899.9689; val_gene_expr_recon_loss: 94429.6559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137898.9264; val_optim_loss: 137898.9264
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9783; val_auprc_score: 0.9977; val_best_acc_score: 0.9824; val_best_f1_score: 0.9905; train_kl_reg_loss: 2638.2287; train_edge_recon_loss: 39718.4428; train_gene_expr_recon_loss: 94626.2628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136982.9342; train_optim_loss: 136982.9342; val_kl_reg_loss: 2580.5817; val_edge_recon_loss: 41531.1812; val_gene_expr_recon_loss: 94469.2447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138581.0078; val_optim_loss: 138581.0078
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9776; val_auprc_score: 0.9976; val_best_acc_score: 0.9834; val_best_f1_score: 0.9911; train_kl_reg_loss: 2636.5511; train_edge_recon_loss: 39722.3324; train_gene_expr_recon_loss: 94575.4992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136934.3827; train_optim_loss: 136934.3827; val_kl_reg_loss: 2603.0811; val_edge_recon_loss: 41008.3778; val_gene_expr_recon_loss: 94385.7101; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137997.1696; val_optim_loss: 137997.1696

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9781; val_auprc_score: 0.9977; val_best_acc_score: 0.9835; val_best_f1_score: 0.9911; train_kl_reg_loss: 2603.1495; train_edge_recon_loss: 39814.4479; train_gene_expr_recon_loss: 94241.7286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136659.3259; train_optim_loss: 136659.3259; val_kl_reg_loss: 2548.9738; val_edge_recon_loss: 40348.7522; val_gene_expr_recon_loss: 94199.9494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137097.6757; val_optim_loss: 137097.6757
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9792; val_auprc_score: 0.9978; val_best_acc_score: 0.9838; val_best_f1_score: 0.9913; train_kl_reg_loss: 2595.9827; train_edge_recon_loss: 39752.9505; train_gene_expr_recon_loss: 94225.5844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136574.5177; train_optim_loss: 136574.5177; val_kl_reg_loss: 2546.3419; val_edge_recon_loss: 40683.5552; val_gene_expr_recon_loss: 94053.7463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137283.6440; val_optim_loss: 137283.6440
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9789; val_auprc_score: 0.9978; val_best_acc_score: 0.9837; val_best_f1_score: 0.9912; train_kl_reg_loss: 2592.2449; train_edge_recon_loss: 39597.3719; train_gene_expr_recon_loss: 94205.1525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136394.7692; train_optim_loss: 136394.7692; val_kl_reg_loss: 2553.6183; val_edge_recon_loss: 40725.1343; val_gene_expr_recon_loss: 94061.2014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137339.9547; val_optim_loss: 137339.9547
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9784; val_auprc_score: 0.9976; val_best_acc_score: 0.9837; val_best_f1_score: 0.9912; train_kl_reg_loss: 2593.6236; train_edge_recon_loss: 39690.4881; train_gene_expr_recon_loss: 94198.7435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136482.8551; train_optim_loss: 136482.8551; val_kl_reg_loss: 2529.4524; val_edge_recon_loss: 40826.1793; val_gene_expr_recon_loss: 94067.9012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137423.5330; val_optim_loss: 137423.5330

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9785; val_auprc_score: 0.9976; val_best_acc_score: 0.9837; val_best_f1_score: 0.9912; train_kl_reg_loss: 2585.7767; train_edge_recon_loss: 39687.7111; train_gene_expr_recon_loss: 94120.6165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136394.1042; train_optim_loss: 136394.1042; val_kl_reg_loss: 2545.0818; val_edge_recon_loss: 40996.9785; val_gene_expr_recon_loss: 93990.7964; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137532.8566; val_optim_loss: 137532.8566
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9795; val_auprc_score: 0.9978; val_best_acc_score: 0.9841; val_best_f1_score: 0.9915; train_kl_reg_loss: 2588.1089; train_edge_recon_loss: 39782.9397; train_gene_expr_recon_loss: 94134.8319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136505.8803; train_optim_loss: 136505.8803; val_kl_reg_loss: 2547.7491; val_edge_recon_loss: 40533.4980; val_gene_expr_recon_loss: 94036.7300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137117.9769; val_optim_loss: 137117.9769
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9789; val_auprc_score: 0.9978; val_best_acc_score: 0.9840; val_best_f1_score: 0.9914; train_kl_reg_loss: 2588.3580; train_edge_recon_loss: 39789.2199; train_gene_expr_recon_loss: 94141.9642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136519.5424; train_optim_loss: 136519.5424; val_kl_reg_loss: 2545.7912; val_edge_recon_loss: 40694.5150; val_gene_expr_recon_loss: 94061.5086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137301.8145; val_optim_loss: 137301.8145

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 150 min 26 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9792
Val AUPRC score: 0.9978
Val best accuracy score: 0.9836
Val best F1 score: 0.9912
Val gene expr MSE score: 0.7609
Duration of model training in run 1: 2 hours, 32 minutes and 22 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 982152
Number of validation nodes: 109128
Number of training edges: 2342808
Number of validation edges: 260312
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9669; val_auprc_score: 0.9963; val_best_acc_score: 0.9764; val_best_f1_score: 0.9873; train_kl_reg_loss: 2101.2175; train_edge_recon_loss: 40860.6353; train_gene_expr_recon_loss: 108395.2373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 151357.0903; train_optim_loss: 151357.0903; val_kl_reg_loss: 2139.7948; val_edge_recon_loss: 40667.7442; val_gene_expr_recon_loss: 103378.6075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146186.1469; val_optim_loss: 146186.1469
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9705; val_auprc_score: 0.9967; val_best_acc_score: 0.9782; val_best_f1_score: 0.9883; train_kl_reg_loss: 2256.3804; train_edge_recon_loss: 40075.8886; train_gene_expr_recon_loss: 101244.5199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143576.7887; train_optim_loss: 143576.7887; val_kl_reg_loss: 2285.8378; val_edge_recon_loss: 41179.8584; val_gene_expr_recon_loss: 99607.1553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143072.8510; val_optim_loss: 143072.8510
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9723; val_auprc_score: 0.9970; val_best_acc_score: 0.9788; val_best_f1_score: 0.9886; train_kl_reg_loss: 2354.1449; train_edge_recon_loss: 40036.2548; train_gene_expr_recon_loss: 98649.6653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141040.0648; train_optim_loss: 141040.0648; val_kl_reg_loss: 2355.2794; val_edge_recon_loss: 41524.9135; val_gene_expr_recon_loss: 97894.2190; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141774.4116; val_optim_loss: 141774.4116
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9727; val_auprc_score: 0.9971; val_best_acc_score: 0.9799; val_best_f1_score: 0.9892; train_kl_reg_loss: 2422.1891; train_edge_recon_loss: 39997.0402; train_gene_expr_recon_loss: 97397.8463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139817.0753; train_optim_loss: 139817.0753; val_kl_reg_loss: 2392.1959; val_edge_recon_loss: 40862.8629; val_gene_expr_recon_loss: 96975.4871; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140230.5458; val_optim_loss: 140230.5458
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9728; val_auprc_score: 0.9971; val_best_acc_score: 0.9800; val_best_f1_score: 0.9893; train_kl_reg_loss: 2466.5691; train_edge_recon_loss: 39880.2372; train_gene_expr_recon_loss: 96679.8725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139026.6790; train_optim_loss: 139026.6790; val_kl_reg_loss: 2508.9543; val_edge_recon_loss: 41292.3101; val_gene_expr_recon_loss: 96365.4878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140166.7517; val_optim_loss: 140166.7517
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9740; val_auprc_score: 0.9972; val_best_acc_score: 0.9810; val_best_f1_score: 0.9898; train_kl_reg_loss: 2499.0140; train_edge_recon_loss: 39932.8449; train_gene_expr_recon_loss: 96223.5909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138655.4500; train_optim_loss: 138655.4500; val_kl_reg_loss: 2486.5664; val_edge_recon_loss: 40696.0962; val_gene_expr_recon_loss: 95987.5667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139170.2295; val_optim_loss: 139170.2295
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9735; val_auprc_score: 0.9972; val_best_acc_score: 0.9808; val_best_f1_score: 0.9897; train_kl_reg_loss: 2524.2008; train_edge_recon_loss: 40019.5697; train_gene_expr_recon_loss: 95838.7985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138382.5692; train_optim_loss: 138382.5692; val_kl_reg_loss: 2470.4514; val_edge_recon_loss: 40830.0298; val_gene_expr_recon_loss: 95729.7219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139030.2031; val_optim_loss: 139030.2031
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9756; val_auprc_score: 0.9973; val_best_acc_score: 0.9815; val_best_f1_score: 0.9900; train_kl_reg_loss: 2541.3189; train_edge_recon_loss: 39893.0063; train_gene_expr_recon_loss: 95585.7452; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138020.0704; train_optim_loss: 138020.0704; val_kl_reg_loss: 2558.1179; val_edge_recon_loss: 41461.2022; val_gene_expr_recon_loss: 95513.5253; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139532.8452; val_optim_loss: 139532.8452
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9755; val_auprc_score: 0.9974; val_best_acc_score: 0.9813; val_best_f1_score: 0.9900; train_kl_reg_loss: 2554.9396; train_edge_recon_loss: 40008.9791; train_gene_expr_recon_loss: 95388.7970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137952.7158; train_optim_loss: 137952.7158; val_kl_reg_loss: 2583.4007; val_edge_recon_loss: 40693.4982; val_gene_expr_recon_loss: 95373.4120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138650.3109; val_optim_loss: 138650.3109
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9761; val_auprc_score: 0.9974; val_best_acc_score: 0.9818; val_best_f1_score: 0.9902; train_kl_reg_loss: 2568.7223; train_edge_recon_loss: 39880.5924; train_gene_expr_recon_loss: 95228.5457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137677.8605; train_optim_loss: 137677.8605; val_kl_reg_loss: 2580.9892; val_edge_recon_loss: 41060.8158; val_gene_expr_recon_loss: 95214.4832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138856.2885; val_optim_loss: 138856.2885
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9743; val_auprc_score: 0.9972; val_best_acc_score: 0.9819; val_best_f1_score: 0.9903; train_kl_reg_loss: 2580.2966; train_edge_recon_loss: 39814.2845; train_gene_expr_recon_loss: 95119.7528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137514.3339; train_optim_loss: 137514.3339; val_kl_reg_loss: 2506.2746; val_edge_recon_loss: 40600.6856; val_gene_expr_recon_loss: 95105.8736; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138212.8347; val_optim_loss: 138212.8347
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9760; val_auprc_score: 0.9975; val_best_acc_score: 0.9819; val_best_f1_score: 0.9903; train_kl_reg_loss: 2590.0518; train_edge_recon_loss: 40025.9507; train_gene_expr_recon_loss: 95021.7701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137637.7726; train_optim_loss: 137637.7726; val_kl_reg_loss: 2507.5034; val_edge_recon_loss: 40684.9941; val_gene_expr_recon_loss: 94964.0848; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138156.5825; val_optim_loss: 138156.5825
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9758; val_auprc_score: 0.9974; val_best_acc_score: 0.9820; val_best_f1_score: 0.9903; train_kl_reg_loss: 2593.8801; train_edge_recon_loss: 39968.9293; train_gene_expr_recon_loss: 94931.0617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137493.8711; train_optim_loss: 137493.8711; val_kl_reg_loss: 2623.7957; val_edge_recon_loss: 40756.1176; val_gene_expr_recon_loss: 94919.0835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138298.9968; val_optim_loss: 138298.9968
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9765; val_auprc_score: 0.9975; val_best_acc_score: 0.9827; val_best_f1_score: 0.9907; train_kl_reg_loss: 2604.7123; train_edge_recon_loss: 39906.7425; train_gene_expr_recon_loss: 94860.2384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137371.6933; train_optim_loss: 137371.6933; val_kl_reg_loss: 2531.0106; val_edge_recon_loss: 40967.3082; val_gene_expr_recon_loss: 94852.1038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138350.4219; val_optim_loss: 138350.4219
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9760; val_auprc_score: 0.9975; val_best_acc_score: 0.9833; val_best_f1_score: 0.9910; train_kl_reg_loss: 2609.5078; train_edge_recon_loss: 39873.3609; train_gene_expr_recon_loss: 94777.1026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137259.9714; train_optim_loss: 137259.9714; val_kl_reg_loss: 2540.3031; val_edge_recon_loss: 40246.6511; val_gene_expr_recon_loss: 94830.5284; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137617.4833; val_optim_loss: 137617.4833
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9780; val_auprc_score: 0.9977; val_best_acc_score: 0.9826; val_best_f1_score: 0.9907; train_kl_reg_loss: 2615.8972; train_edge_recon_loss: 39814.9989; train_gene_expr_recon_loss: 94744.4817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137175.3778; train_optim_loss: 137175.3778; val_kl_reg_loss: 2548.0303; val_edge_recon_loss: 41252.9978; val_gene_expr_recon_loss: 94747.4920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138548.5198; val_optim_loss: 138548.5198
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9779; val_auprc_score: 0.9976; val_best_acc_score: 0.9823; val_best_f1_score: 0.9905; train_kl_reg_loss: 2623.1222; train_edge_recon_loss: 39919.2579; train_gene_expr_recon_loss: 94679.5986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137221.9788; train_optim_loss: 137221.9788; val_kl_reg_loss: 2590.0796; val_edge_recon_loss: 40948.7627; val_gene_expr_recon_loss: 94725.7839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138264.6260; val_optim_loss: 138264.6260
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9779; val_auprc_score: 0.9977; val_best_acc_score: 0.9826; val_best_f1_score: 0.9906; train_kl_reg_loss: 2628.9863; train_edge_recon_loss: 39748.9516; train_gene_expr_recon_loss: 94615.9036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136993.8415; train_optim_loss: 136993.8415; val_kl_reg_loss: 2576.8208; val_edge_recon_loss: 41360.8704; val_gene_expr_recon_loss: 94712.5244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138650.2146; val_optim_loss: 138650.2146

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9774; val_auprc_score: 0.9976; val_best_acc_score: 0.9830; val_best_f1_score: 0.9909; train_kl_reg_loss: 2591.3675; train_edge_recon_loss: 39777.5193; train_gene_expr_recon_loss: 94309.1268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136678.0135; train_optim_loss: 136678.0135; val_kl_reg_loss: 2527.3685; val_edge_recon_loss: 41002.2949; val_gene_expr_recon_loss: 94433.5320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137963.1959; val_optim_loss: 137963.1959
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9782; val_auprc_score: 0.9977; val_best_acc_score: 0.9834; val_best_f1_score: 0.9910; train_kl_reg_loss: 2586.6673; train_edge_recon_loss: 39833.9103; train_gene_expr_recon_loss: 94246.7066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136667.2840; train_optim_loss: 136667.2840; val_kl_reg_loss: 2531.1335; val_edge_recon_loss: 40739.5265; val_gene_expr_recon_loss: 94394.5475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137665.2070; val_optim_loss: 137665.2070
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9796; val_auprc_score: 0.9979; val_best_acc_score: 0.9836; val_best_f1_score: 0.9912; train_kl_reg_loss: 2587.1690; train_edge_recon_loss: 39689.9548; train_gene_expr_recon_loss: 94240.7142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136517.8380; train_optim_loss: 136517.8380; val_kl_reg_loss: 2551.4709; val_edge_recon_loss: 40453.6437; val_gene_expr_recon_loss: 94363.4344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137368.5489; val_optim_loss: 137368.5489
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9785; val_auprc_score: 0.9978; val_best_acc_score: 0.9832; val_best_f1_score: 0.9910; train_kl_reg_loss: 2585.2643; train_edge_recon_loss: 39687.4515; train_gene_expr_recon_loss: 94211.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136484.3646; train_optim_loss: 136484.3646; val_kl_reg_loss: 2544.0706; val_edge_recon_loss: 40731.1160; val_gene_expr_recon_loss: 94311.8762; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137587.0624; val_optim_loss: 137587.0624
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9788; val_auprc_score: 0.9977; val_best_acc_score: 0.9837; val_best_f1_score: 0.9912; train_kl_reg_loss: 2586.5182; train_edge_recon_loss: 39752.0889; train_gene_expr_recon_loss: 94242.9858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136581.5929; train_optim_loss: 136581.5929; val_kl_reg_loss: 2557.8535; val_edge_recon_loss: 40925.1033; val_gene_expr_recon_loss: 94300.0714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137783.0278; val_optim_loss: 137783.0278
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9785; val_auprc_score: 0.9977; val_best_acc_score: 0.9836; val_best_f1_score: 0.9912; train_kl_reg_loss: 2584.6994; train_edge_recon_loss: 39616.8170; train_gene_expr_recon_loss: 94199.2863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136400.8030; train_optim_loss: 136400.8030; val_kl_reg_loss: 2545.3993; val_edge_recon_loss: 40749.6500; val_gene_expr_recon_loss: 94260.6971; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137555.7462; val_optim_loss: 137555.7462

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9792; val_auprc_score: 0.9978; val_best_acc_score: 0.9837; val_best_f1_score: 0.9912; train_kl_reg_loss: 2582.7808; train_edge_recon_loss: 39745.6208; train_gene_expr_recon_loss: 94125.3577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136453.7591; train_optim_loss: 136453.7591; val_kl_reg_loss: 2540.1740; val_edge_recon_loss: 40690.6439; val_gene_expr_recon_loss: 94317.5848; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137548.4020; val_optim_loss: 137548.4020
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9787; val_auprc_score: 0.9978; val_best_acc_score: 0.9837; val_best_f1_score: 0.9912; train_kl_reg_loss: 2581.2570; train_edge_recon_loss: 39669.2614; train_gene_expr_recon_loss: 94131.3931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136381.9114; train_optim_loss: 136381.9114; val_kl_reg_loss: 2538.0605; val_edge_recon_loss: 40479.6566; val_gene_expr_recon_loss: 94302.9336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137320.6509; val_optim_loss: 137320.6509
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9783; val_auprc_score: 0.9977; val_best_acc_score: 0.9835; val_best_f1_score: 0.9912; train_kl_reg_loss: 2579.0568; train_edge_recon_loss: 39747.5432; train_gene_expr_recon_loss: 94114.8838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136441.4838; train_optim_loss: 136441.4838; val_kl_reg_loss: 2528.8397; val_edge_recon_loss: 40634.3126; val_gene_expr_recon_loss: 94380.6261; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137543.7783; val_optim_loss: 137543.7783
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9795; val_auprc_score: 0.9979; val_best_acc_score: 0.9836; val_best_f1_score: 0.9912; train_kl_reg_loss: 2579.6963; train_edge_recon_loss: 39785.2273; train_gene_expr_recon_loss: 94114.0171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136478.9407; train_optim_loss: 136478.9407; val_kl_reg_loss: 2528.7528; val_edge_recon_loss: 40658.4833; val_gene_expr_recon_loss: 94313.4512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137500.6871; val_optim_loss: 137500.6871
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9778; val_auprc_score: 0.9976; val_best_acc_score: 0.9831; val_best_f1_score: 0.9909; train_kl_reg_loss: 2579.7242; train_edge_recon_loss: 39717.2995; train_gene_expr_recon_loss: 94133.6124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136430.6361; train_optim_loss: 136430.6361; val_kl_reg_loss: 2541.0807; val_edge_recon_loss: 40966.4975; val_gene_expr_recon_loss: 94353.5003; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137861.0778; val_optim_loss: 137861.0778

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9789; val_auprc_score: 0.9978; val_best_acc_score: 0.9835; val_best_f1_score: 0.9911; train_kl_reg_loss: 2581.0577; train_edge_recon_loss: 39571.2294; train_gene_expr_recon_loss: 94107.7605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136260.0477; train_optim_loss: 136260.0477; val_kl_reg_loss: 2532.7983; val_edge_recon_loss: 40966.7375; val_gene_expr_recon_loss: 94288.7729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137788.3083; val_optim_loss: 137788.3083
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9786; val_auprc_score: 0.9978; val_best_acc_score: 0.9837; val_best_f1_score: 0.9913; train_kl_reg_loss: 2578.6770; train_edge_recon_loss: 39669.2283; train_gene_expr_recon_loss: 94129.8848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136377.7899; train_optim_loss: 136377.7899; val_kl_reg_loss: 2534.5823; val_edge_recon_loss: 40436.3508; val_gene_expr_recon_loss: 94315.2040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137286.1368; val_optim_loss: 137286.1368
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9785; val_auprc_score: 0.9977; val_best_acc_score: 0.9835; val_best_f1_score: 0.9911; train_kl_reg_loss: 2579.7944; train_edge_recon_loss: 39810.2953; train_gene_expr_recon_loss: 94133.8978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136523.9876; train_optim_loss: 136523.9876; val_kl_reg_loss: 2534.3897; val_edge_recon_loss: 40840.3631; val_gene_expr_recon_loss: 94258.7013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137633.4540; val_optim_loss: 137633.4540
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9796; val_auprc_score: 0.9979; val_best_acc_score: 0.9839; val_best_f1_score: 0.9913; train_kl_reg_loss: 2579.9446; train_edge_recon_loss: 39818.6058; train_gene_expr_recon_loss: 94108.9416; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136507.4923; train_optim_loss: 136507.4923; val_kl_reg_loss: 2535.9952; val_edge_recon_loss: 40472.5189; val_gene_expr_recon_loss: 94296.8763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137305.3898; val_optim_loss: 137305.3898
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9786; val_auprc_score: 0.9977; val_best_acc_score: 0.9834; val_best_f1_score: 0.9910; train_kl_reg_loss: 2580.2293; train_edge_recon_loss: 39680.4498; train_gene_expr_recon_loss: 94123.5467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136384.2259; train_optim_loss: 136384.2259; val_kl_reg_loss: 2535.6633; val_edge_recon_loss: 40882.7609; val_gene_expr_recon_loss: 94322.7702; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137741.1942; val_optim_loss: 137741.1942

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9789; val_auprc_score: 0.9977; val_best_acc_score: 0.9836; val_best_f1_score: 0.9912; train_kl_reg_loss: 2580.4883; train_edge_recon_loss: 39785.7849; train_gene_expr_recon_loss: 94129.2804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136495.5534; train_optim_loss: 136495.5534; val_kl_reg_loss: 2535.2769; val_edge_recon_loss: 40965.2174; val_gene_expr_recon_loss: 94364.0872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137864.5823; val_optim_loss: 137864.5823
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9797; val_auprc_score: 0.9979; val_best_acc_score: 0.9838; val_best_f1_score: 0.9913; train_kl_reg_loss: 2580.3911; train_edge_recon_loss: 39714.0432; train_gene_expr_recon_loss: 94098.0598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136392.4940; train_optim_loss: 136392.4940; val_kl_reg_loss: 2535.5037; val_edge_recon_loss: 40567.1677; val_gene_expr_recon_loss: 94325.1994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137427.8710; val_optim_loss: 137427.8710
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9794; val_auprc_score: 0.9979; val_best_acc_score: 0.9834; val_best_f1_score: 0.9911; train_kl_reg_loss: 2580.1661; train_edge_recon_loss: 39600.3565; train_gene_expr_recon_loss: 94122.4351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136302.9579; train_optim_loss: 136302.9579; val_kl_reg_loss: 2535.4547; val_edge_recon_loss: 40832.6939; val_gene_expr_recon_loss: 94288.9370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137657.0859; val_optim_loss: 137657.0859

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 214 min 24 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9785
Val AUPRC score: 0.9977
Val best accuracy score: 0.9834
Val best F1 score: 0.9911
Val gene expr MSE score: 0.7640
Duration of model training in run 2: 3 hours, 36 minutes and 12 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 982152
Number of validation nodes: 109128
Number of training edges: 4503608
Number of validation edges: 500400
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9865; val_auprc_score: 0.9986; val_best_acc_score: 0.9864; val_best_f1_score: 0.9927; train_kl_reg_loss: 2143.9675; train_edge_recon_loss: 40169.6207; train_gene_expr_recon_loss: 105545.9221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 147859.5103; train_optim_loss: 147859.5103; val_kl_reg_loss: 2197.4234; val_edge_recon_loss: 39669.6467; val_gene_expr_recon_loss: 101871.2078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143738.2777; val_optim_loss: 143738.2777
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9891; val_auprc_score: 0.9989; val_best_acc_score: 0.9879; val_best_f1_score: 0.9935; train_kl_reg_loss: 2294.5900; train_edge_recon_loss: 39751.0051; train_gene_expr_recon_loss: 101035.2144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143080.8095; train_optim_loss: 143080.8095; val_kl_reg_loss: 2338.6695; val_edge_recon_loss: 39907.5730; val_gene_expr_recon_loss: 100218.9321; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142465.1748; val_optim_loss: 142465.1748
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9894; val_auprc_score: 0.9989; val_best_acc_score: 0.9883; val_best_f1_score: 0.9937; train_kl_reg_loss: 2373.9607; train_edge_recon_loss: 39748.4124; train_gene_expr_recon_loss: 100013.1563; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142135.5294; train_optim_loss: 142135.5294; val_kl_reg_loss: 2407.2919; val_edge_recon_loss: 39567.7578; val_gene_expr_recon_loss: 99601.6274; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141576.6773; val_optim_loss: 141576.6773
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9898; val_auprc_score: 0.9990; val_best_acc_score: 0.9887; val_best_f1_score: 0.9939; train_kl_reg_loss: 2428.0197; train_edge_recon_loss: 39780.6816; train_gene_expr_recon_loss: 99525.8462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141734.5475; train_optim_loss: 141734.5475; val_kl_reg_loss: 2361.0910; val_edge_recon_loss: 40034.5427; val_gene_expr_recon_loss: 99333.7630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141729.3971; val_optim_loss: 141729.3971
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9898; val_auprc_score: 0.9990; val_best_acc_score: 0.9889; val_best_f1_score: 0.9940; train_kl_reg_loss: 2463.2771; train_edge_recon_loss: 39661.7752; train_gene_expr_recon_loss: 99203.4748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141328.5271; train_optim_loss: 141328.5271; val_kl_reg_loss: 2440.8787; val_edge_recon_loss: 39625.7238; val_gene_expr_recon_loss: 98987.6004; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141054.2031; val_optim_loss: 141054.2031
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9902; val_auprc_score: 0.9990; val_best_acc_score: 0.9892; val_best_f1_score: 0.9942; train_kl_reg_loss: 2487.5122; train_edge_recon_loss: 39689.6193; train_gene_expr_recon_loss: 99025.6244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141202.7559; train_optim_loss: 141202.7559; val_kl_reg_loss: 2489.7419; val_edge_recon_loss: 39908.7321; val_gene_expr_recon_loss: 98877.0379; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141275.5120; val_optim_loss: 141275.5120
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9903; val_auprc_score: 0.9990; val_best_acc_score: 0.9891; val_best_f1_score: 0.9941; train_kl_reg_loss: 2507.6923; train_edge_recon_loss: 39630.6344; train_gene_expr_recon_loss: 98863.0237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141001.3505; train_optim_loss: 141001.3505; val_kl_reg_loss: 2521.6120; val_edge_recon_loss: 39648.0765; val_gene_expr_recon_loss: 98800.2071; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140969.8956; val_optim_loss: 140969.8956
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9906; val_auprc_score: 0.9990; val_best_acc_score: 0.9894; val_best_f1_score: 0.9943; train_kl_reg_loss: 2522.4149; train_edge_recon_loss: 39667.6399; train_gene_expr_recon_loss: 98760.8204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140950.8752; train_optim_loss: 140950.8752; val_kl_reg_loss: 2477.7348; val_edge_recon_loss: 40168.7647; val_gene_expr_recon_loss: 98696.4601; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141342.9592; val_optim_loss: 141342.9592
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9904; val_auprc_score: 0.9991; val_best_acc_score: 0.9897; val_best_f1_score: 0.9945; train_kl_reg_loss: 2534.0392; train_edge_recon_loss: 39662.6758; train_gene_expr_recon_loss: 98667.0979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140863.8128; train_optim_loss: 140863.8128; val_kl_reg_loss: 2507.2305; val_edge_recon_loss: 39312.8661; val_gene_expr_recon_loss: 98572.4393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140392.5360; val_optim_loss: 140392.5360
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9905; val_auprc_score: 0.9990; val_best_acc_score: 0.9895; val_best_f1_score: 0.9943; train_kl_reg_loss: 2544.2488; train_edge_recon_loss: 39713.5864; train_gene_expr_recon_loss: 98589.9627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140847.7980; train_optim_loss: 140847.7980; val_kl_reg_loss: 2546.0882; val_edge_recon_loss: 39745.7157; val_gene_expr_recon_loss: 98542.3081; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140834.1121; val_optim_loss: 140834.1121
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9901; val_auprc_score: 0.9990; val_best_acc_score: 0.9895; val_best_f1_score: 0.9944; train_kl_reg_loss: 2552.0730; train_edge_recon_loss: 39479.9594; train_gene_expr_recon_loss: 98562.5551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140594.5876; train_optim_loss: 140594.5876; val_kl_reg_loss: 2570.7373; val_edge_recon_loss: 39413.4331; val_gene_expr_recon_loss: 98442.3539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140426.5244; val_optim_loss: 140426.5244
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9906; val_auprc_score: 0.9991; val_best_acc_score: 0.9895; val_best_f1_score: 0.9944; train_kl_reg_loss: 2556.2921; train_edge_recon_loss: 39519.7610; train_gene_expr_recon_loss: 98487.2227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140563.2758; train_optim_loss: 140563.2758; val_kl_reg_loss: 2492.3406; val_edge_recon_loss: 39605.4397; val_gene_expr_recon_loss: 98470.5144; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140568.2947; val_optim_loss: 140568.2947

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9914; val_auprc_score: 0.9991; val_best_acc_score: 0.9899; val_best_f1_score: 0.9946; train_kl_reg_loss: 2518.6292; train_edge_recon_loss: 39534.3133; train_gene_expr_recon_loss: 98061.8700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140114.8125; train_optim_loss: 140114.8125; val_kl_reg_loss: 2493.7210; val_edge_recon_loss: 39624.9207; val_gene_expr_recon_loss: 98046.7332; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140165.3750; val_optim_loss: 140165.3750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9912; val_auprc_score: 0.9991; val_best_acc_score: 0.9899; val_best_f1_score: 0.9946; train_kl_reg_loss: 2516.3604; train_edge_recon_loss: 39515.1327; train_gene_expr_recon_loss: 97989.8004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140021.2937; train_optim_loss: 140021.2937; val_kl_reg_loss: 2489.0828; val_edge_recon_loss: 39536.7974; val_gene_expr_recon_loss: 97938.9377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139964.8179; val_optim_loss: 139964.8179
