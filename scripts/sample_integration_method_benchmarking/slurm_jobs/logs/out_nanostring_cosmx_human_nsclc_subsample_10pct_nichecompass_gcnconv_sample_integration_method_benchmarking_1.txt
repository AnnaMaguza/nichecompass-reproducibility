Run timestamp: 02092023_221650_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '4096', '4096', '4096', '4096', '4096', '4096', '4096', '4096', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc_subsample_10pct', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gcnconv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 25413
Number of validation nodes: 2824
Number of training edges: 231162
Number of validation edges: 25684
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8550; val_auprc_score: 0.9443; val_best_acc_score: 0.8470; val_best_f1_score: 0.9068; train_kl_reg_loss: 6536.0053; train_edge_recon_loss: 1703624.0307; train_cat_covariates_contrastive_loss: 690030.5285; train_gene_expr_recon_loss: 3858466.7544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6258657.3158; train_optim_loss: 6258657.3158; val_kl_reg_loss: 20326.0801; val_edge_recon_loss: 1576957.2679; val_cat_covariates_contrastive_loss: 626657.7946; val_gene_expr_recon_loss: 3447648.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5671589.7857; val_optim_loss: 5671589.7857
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8821; val_auprc_score: 0.9548; val_best_acc_score: 0.8630; val_best_f1_score: 0.9159; train_kl_reg_loss: 28666.4431; train_edge_recon_loss: 1507620.6908; train_cat_covariates_contrastive_loss: 627164.7456; train_gene_expr_recon_loss: 3305694.9868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5469146.8596; train_optim_loss: 5469146.8596; val_kl_reg_loss: 26723.9796; val_edge_recon_loss: 1473434.2143; val_cat_covariates_contrastive_loss: 626777.7143; val_gene_expr_recon_loss: 3193489.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5320424.8571; val_optim_loss: 5320424.8571
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9354; val_auprc_score: 0.9726; val_best_acc_score: 0.9052; val_best_f1_score: 0.9397; train_kl_reg_loss: 21804.7542; train_edge_recon_loss: 1452089.4583; train_cat_covariates_contrastive_loss: 629724.0110; train_gene_expr_recon_loss: 3153256.2763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5256874.5000; train_optim_loss: 5256874.5000; val_kl_reg_loss: 19123.1853; val_edge_recon_loss: 1406019.7857; val_cat_covariates_contrastive_loss: 632619.0625; val_gene_expr_recon_loss: 3134536.6071; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5192298.6429; val_optim_loss: 5192298.6429
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9440; val_auprc_score: 0.9762; val_best_acc_score: 0.9183; val_best_f1_score: 0.9478; train_kl_reg_loss: 20208.2236; train_edge_recon_loss: 1374007.3092; train_cat_covariates_contrastive_loss: 635077.6579; train_gene_expr_recon_loss: 3089976.3509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5119269.5526; train_optim_loss: 5119269.5526; val_kl_reg_loss: 20154.1024; val_edge_recon_loss: 1348480.2500; val_cat_covariates_contrastive_loss: 634003.0714; val_gene_expr_recon_loss: 3054877.1071; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5057514.5000; val_optim_loss: 5057514.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9407; val_auprc_score: 0.9738; val_best_acc_score: 0.9197; val_best_f1_score: 0.9487; train_kl_reg_loss: 19685.7535; train_edge_recon_loss: 1350721.8640; train_cat_covariates_contrastive_loss: 634754.8717; train_gene_expr_recon_loss: 3050073.1096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5055235.5526; train_optim_loss: 5055235.5526; val_kl_reg_loss: 18602.4037; val_edge_recon_loss: 1377522.2857; val_cat_covariates_contrastive_loss: 633252.1786; val_gene_expr_recon_loss: 3043570.9286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5072947.7857; val_optim_loss: 5072947.7857
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9489; val_auprc_score: 0.9772; val_best_acc_score: 0.9250; val_best_f1_score: 0.9518; train_kl_reg_loss: 17779.1096; train_edge_recon_loss: 1346780.6776; train_cat_covariates_contrastive_loss: 634740.6579; train_gene_expr_recon_loss: 3020814.0789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5020114.5439; train_optim_loss: 5020114.5439; val_kl_reg_loss: 16501.5020; val_edge_recon_loss: 1359730.5179; val_cat_covariates_contrastive_loss: 633734.8929; val_gene_expr_recon_loss: 2987838.8214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4997805.7143; val_optim_loss: 4997805.7143
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9545; val_auprc_score: 0.9790; val_best_acc_score: 0.9341; val_best_f1_score: 0.9576; train_kl_reg_loss: 15861.7520; train_edge_recon_loss: 1335029.0219; train_cat_covariates_contrastive_loss: 635046.3026; train_gene_expr_recon_loss: 2994923.4693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4980860.5439; train_optim_loss: 4980860.5439; val_kl_reg_loss: 15217.6256; val_edge_recon_loss: 1326223.9464; val_cat_covariates_contrastive_loss: 634041.4286; val_gene_expr_recon_loss: 3002216.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4977699.4286; val_optim_loss: 4977699.4286
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9547; val_auprc_score: 0.9793; val_best_acc_score: 0.9368; val_best_f1_score: 0.9592; train_kl_reg_loss: 14636.1266; train_edge_recon_loss: 1331546.9320; train_cat_covariates_contrastive_loss: 634364.1382; train_gene_expr_recon_loss: 2974886.1053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4955433.3070; train_optim_loss: 4955433.3070; val_kl_reg_loss: 13764.8041; val_edge_recon_loss: 1325915.8571; val_cat_covariates_contrastive_loss: 633043.2857; val_gene_expr_recon_loss: 2959962.8214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4932686.8571; val_optim_loss: 4932686.8571
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9606; val_auprc_score: 0.9809; val_best_acc_score: 0.9447; val_best_f1_score: 0.9641; train_kl_reg_loss: 13795.8836; train_edge_recon_loss: 1316515.7171; train_cat_covariates_contrastive_loss: 634324.6393; train_gene_expr_recon_loss: 2953829.8289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4918466.0351; train_optim_loss: 4918466.0351; val_kl_reg_loss: 13192.0944; val_edge_recon_loss: 1325187.4286; val_cat_covariates_contrastive_loss: 633953.3750; val_gene_expr_recon_loss: 2924088.4286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4896421.3571; val_optim_loss: 4896421.3571
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9577; val_auprc_score: 0.9794; val_best_acc_score: 0.9442; val_best_f1_score: 0.9637; train_kl_reg_loss: 13216.3856; train_edge_recon_loss: 1321559.9518; train_cat_covariates_contrastive_loss: 634023.8827; train_gene_expr_recon_loss: 2938360.8246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4907161.0702; train_optim_loss: 4907161.0702; val_kl_reg_loss: 12739.2868; val_edge_recon_loss: 1329242.7857; val_cat_covariates_contrastive_loss: 634203.1071; val_gene_expr_recon_loss: 2918097.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4894282.6429; val_optim_loss: 4894282.6429
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9556; val_auprc_score: 0.9790; val_best_acc_score: 0.9425; val_best_f1_score: 0.9629; train_kl_reg_loss: 12823.8389; train_edge_recon_loss: 1317398.1316; train_cat_covariates_contrastive_loss: 633673.8235; train_gene_expr_recon_loss: 2922166.7807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4886062.5789; train_optim_loss: 4886062.5789; val_kl_reg_loss: 12433.6264; val_edge_recon_loss: 1322069.6786; val_cat_covariates_contrastive_loss: 632908.9286; val_gene_expr_recon_loss: 2894243.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4861655.2143; val_optim_loss: 4861655.2143
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9583; val_auprc_score: 0.9800; val_best_acc_score: 0.9454; val_best_f1_score: 0.9646; train_kl_reg_loss: 12559.5949; train_edge_recon_loss: 1315515.9496; train_cat_covariates_contrastive_loss: 633825.2675; train_gene_expr_recon_loss: 2907966.5088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4869867.2982; train_optim_loss: 4869867.2982; val_kl_reg_loss: 12135.4484; val_edge_recon_loss: 1316542.8393; val_cat_covariates_contrastive_loss: 633076.0000; val_gene_expr_recon_loss: 2885949.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4847703.4286; val_optim_loss: 4847703.4286
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9575; val_auprc_score: 0.9802; val_best_acc_score: 0.9463; val_best_f1_score: 0.9651; train_kl_reg_loss: 12318.0388; train_edge_recon_loss: 1314531.3136; train_cat_covariates_contrastive_loss: 633813.9934; train_gene_expr_recon_loss: 2895577.4605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4856240.8070; train_optim_loss: 4856240.8070; val_kl_reg_loss: 12124.3259; val_edge_recon_loss: 1313623.1964; val_cat_covariates_contrastive_loss: 633164.1250; val_gene_expr_recon_loss: 2901656.7143; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4860568.4286; val_optim_loss: 4860568.4286
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9571; val_auprc_score: 0.9790; val_best_acc_score: 0.9481; val_best_f1_score: 0.9663; train_kl_reg_loss: 12081.0970; train_edge_recon_loss: 1314900.8553; train_cat_covariates_contrastive_loss: 633511.3520; train_gene_expr_recon_loss: 2881703.5351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4842196.8333; train_optim_loss: 4842196.8333; val_kl_reg_loss: 11813.4524; val_edge_recon_loss: 1316870.2500; val_cat_covariates_contrastive_loss: 633400.6429; val_gene_expr_recon_loss: 2866337.8214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4828422.0714; val_optim_loss: 4828422.0714
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9607; val_auprc_score: 0.9812; val_best_acc_score: 0.9490; val_best_f1_score: 0.9669; train_kl_reg_loss: 11913.3166; train_edge_recon_loss: 1314812.3158; train_cat_covariates_contrastive_loss: 633426.9441; train_gene_expr_recon_loss: 2869391.2456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4829543.8596; train_optim_loss: 4829543.8596; val_kl_reg_loss: 11656.3682; val_edge_recon_loss: 1300786.4464; val_cat_covariates_contrastive_loss: 632653.7411; val_gene_expr_recon_loss: 2844771.8214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4789868.3571; val_optim_loss: 4789868.3571
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9551; val_auprc_score: 0.9776; val_best_acc_score: 0.9489; val_best_f1_score: 0.9669; train_kl_reg_loss: 11842.5650; train_edge_recon_loss: 1315907.0833; train_cat_covariates_contrastive_loss: 633310.0603; train_gene_expr_recon_loss: 2857193.1404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4818252.8421; train_optim_loss: 4818252.8421; val_kl_reg_loss: 11688.2347; val_edge_recon_loss: 1309081.6429; val_cat_covariates_contrastive_loss: 632094.9732; val_gene_expr_recon_loss: 2833502.3571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4786367.2143; val_optim_loss: 4786367.2143
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9584; val_auprc_score: 0.9798; val_best_acc_score: 0.9499; val_best_f1_score: 0.9675; train_kl_reg_loss: 11675.9300; train_edge_recon_loss: 1310413.9781; train_cat_covariates_contrastive_loss: 633151.0811; train_gene_expr_recon_loss: 2848641.1228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4803882.0877; train_optim_loss: 4803882.0877; val_kl_reg_loss: 11702.2849; val_edge_recon_loss: 1324161.2679; val_cat_covariates_contrastive_loss: 632303.7589; val_gene_expr_recon_loss: 2847275.0714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4815442.4286; val_optim_loss: 4815442.4286
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9558; val_auprc_score: 0.9785; val_best_acc_score: 0.9500; val_best_f1_score: 0.9676; train_kl_reg_loss: 11611.9349; train_edge_recon_loss: 1314245.4846; train_cat_covariates_contrastive_loss: 633099.8904; train_gene_expr_recon_loss: 2837490.4561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4796447.7719; train_optim_loss: 4796447.7719; val_kl_reg_loss: 11334.9848; val_edge_recon_loss: 1318442.8929; val_cat_covariates_contrastive_loss: 632345.6786; val_gene_expr_recon_loss: 2820686.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4782810.0714; val_optim_loss: 4782810.0714
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9596; val_auprc_score: 0.9806; val_best_acc_score: 0.9519; val_best_f1_score: 0.9689; train_kl_reg_loss: 11535.8953; train_edge_recon_loss: 1311190.0175; train_cat_covariates_contrastive_loss: 632776.9046; train_gene_expr_recon_loss: 2827857.1009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4783359.9123; train_optim_loss: 4783359.9123; val_kl_reg_loss: 11422.8228; val_edge_recon_loss: 1299779.6786; val_cat_covariates_contrastive_loss: 632046.5089; val_gene_expr_recon_loss: 2830571.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4773820.7857; val_optim_loss: 4773820.7857
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9599; val_auprc_score: 0.9804; val_best_acc_score: 0.9514; val_best_f1_score: 0.9684; train_kl_reg_loss: 11480.0910; train_edge_recon_loss: 1308435.3575; train_cat_covariates_contrastive_loss: 632717.4200; train_gene_expr_recon_loss: 2818262.6974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4770895.5351; train_optim_loss: 4770895.5351; val_kl_reg_loss: 11171.8138; val_edge_recon_loss: 1329432.9107; val_cat_covariates_contrastive_loss: 632810.5446; val_gene_expr_recon_loss: 2807497.8571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4780913.1429; val_optim_loss: 4780913.1429
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9589; val_auprc_score: 0.9797; val_best_acc_score: 0.9502; val_best_f1_score: 0.9676; train_kl_reg_loss: 11450.0186; train_edge_recon_loss: 1311210.2544; train_cat_covariates_contrastive_loss: 632568.8520; train_gene_expr_recon_loss: 2810150.3904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4765379.5000; train_optim_loss: 4765379.5000; val_kl_reg_loss: 11301.5532; val_edge_recon_loss: 1311550.3571; val_cat_covariates_contrastive_loss: 631879.4821; val_gene_expr_recon_loss: 2803991.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4758723.1429; val_optim_loss: 4758723.1429
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9563; val_auprc_score: 0.9781; val_best_acc_score: 0.9519; val_best_f1_score: 0.9687; train_kl_reg_loss: 11400.0350; train_edge_recon_loss: 1305384.1250; train_cat_covariates_contrastive_loss: 632388.1305; train_gene_expr_recon_loss: 2801625.5614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4750797.8333; train_optim_loss: 4750797.8333; val_kl_reg_loss: 11406.7945; val_edge_recon_loss: 1317933.8750; val_cat_covariates_contrastive_loss: 631808.2679; val_gene_expr_recon_loss: 2783839.8929; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4744988.7857; val_optim_loss: 4744988.7857
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9570; val_auprc_score: 0.9786; val_best_acc_score: 0.9544; val_best_f1_score: 0.9704; train_kl_reg_loss: 11345.9371; train_edge_recon_loss: 1302889.6425; train_cat_covariates_contrastive_loss: 632244.7785; train_gene_expr_recon_loss: 2792917.6930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4739398.0526; train_optim_loss: 4739398.0526; val_kl_reg_loss: 11280.5700; val_edge_recon_loss: 1315969.2857; val_cat_covariates_contrastive_loss: 631263.4196; val_gene_expr_recon_loss: 2778630.8214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4737144.0714; val_optim_loss: 4737144.0714
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9579; val_auprc_score: 0.9794; val_best_acc_score: 0.9534; val_best_f1_score: 0.9697; train_kl_reg_loss: 11321.4167; train_edge_recon_loss: 1311315.0154; train_cat_covariates_contrastive_loss: 632318.6919; train_gene_expr_recon_loss: 2786149.5088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4741104.6754; train_optim_loss: 4741104.6754; val_kl_reg_loss: 11295.0657; val_edge_recon_loss: 1323189.3036; val_cat_covariates_contrastive_loss: 631596.9554; val_gene_expr_recon_loss: 2769216.7143; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4735297.9286; val_optim_loss: 4735297.9286
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9564; val_auprc_score: 0.9784; val_best_acc_score: 0.9548; val_best_f1_score: 0.9706; train_kl_reg_loss: 11387.4098; train_edge_recon_loss: 1305724.3355; train_cat_covariates_contrastive_loss: 632348.7697; train_gene_expr_recon_loss: 2776342.3772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4725802.8860; train_optim_loss: 4725802.8860; val_kl_reg_loss: 11200.4093; val_edge_recon_loss: 1294542.6607; val_cat_covariates_contrastive_loss: 631698.4107; val_gene_expr_recon_loss: 2751923.1786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4689364.5714; val_optim_loss: 4689364.5714
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9596; val_auprc_score: 0.9797; val_best_acc_score: 0.9555; val_best_f1_score: 0.9710; train_kl_reg_loss: 11353.2870; train_edge_recon_loss: 1303007.3575; train_cat_covariates_contrastive_loss: 632177.0713; train_gene_expr_recon_loss: 2768301.8728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4714839.6316; train_optim_loss: 4714839.6316; val_kl_reg_loss: 11108.5361; val_edge_recon_loss: 1331527.6786; val_cat_covariates_contrastive_loss: 632200.4732; val_gene_expr_recon_loss: 2764739.6429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4739576.2857; val_optim_loss: 4739576.2857
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9643; val_auprc_score: 0.9824; val_best_acc_score: 0.9569; val_best_f1_score: 0.9718; train_kl_reg_loss: 11325.6419; train_edge_recon_loss: 1302935.0219; train_cat_covariates_contrastive_loss: 632029.3498; train_gene_expr_recon_loss: 2762762.1930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4709052.1579; train_optim_loss: 4709052.1579; val_kl_reg_loss: 11169.8687; val_edge_recon_loss: 1306485.1607; val_cat_covariates_contrastive_loss: 631747.7500; val_gene_expr_recon_loss: 2772121.8929; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4721524.7143; val_optim_loss: 4721524.7143
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9549; val_auprc_score: 0.9779; val_best_acc_score: 0.9548; val_best_f1_score: 0.9707; train_kl_reg_loss: 11343.9680; train_edge_recon_loss: 1307052.9057; train_cat_covariates_contrastive_loss: 631859.3958; train_gene_expr_recon_loss: 2756512.2412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4706768.5000; train_optim_loss: 4706768.5000; val_kl_reg_loss: 11286.0504; val_edge_recon_loss: 1305074.7321; val_cat_covariates_contrastive_loss: 631277.4464; val_gene_expr_recon_loss: 2752283.4643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4699921.6429; val_optim_loss: 4699921.6429
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9605; val_auprc_score: 0.9800; val_best_acc_score: 0.9565; val_best_f1_score: 0.9715; train_kl_reg_loss: 11310.1727; train_edge_recon_loss: 1306463.1140; train_cat_covariates_contrastive_loss: 631985.5450; train_gene_expr_recon_loss: 2747936.6623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4697695.4649; train_optim_loss: 4697695.4649; val_kl_reg_loss: 11228.2178; val_edge_recon_loss: 1318726.0536; val_cat_covariates_contrastive_loss: 631584.3214; val_gene_expr_recon_loss: 2733625.7857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4695164.3571; val_optim_loss: 4695164.3571

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9576; val_auprc_score: 0.9783; val_best_acc_score: 0.9553; val_best_f1_score: 0.9708; train_kl_reg_loss: 11404.9879; train_edge_recon_loss: 1303108.6513; train_cat_covariates_contrastive_loss: 631897.7434; train_gene_expr_recon_loss: 2744124.7149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4690536.1053; train_optim_loss: 4690536.1053; val_kl_reg_loss: 11350.5211; val_edge_recon_loss: 1314883.7500; val_cat_covariates_contrastive_loss: 631310.6429; val_gene_expr_recon_loss: 2741084.0714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4698628.9286; val_optim_loss: 4698628.9286
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9569; val_auprc_score: 0.9778; val_best_acc_score: 0.9550; val_best_f1_score: 0.9706; train_kl_reg_loss: 11457.9423; train_edge_recon_loss: 1306826.5241; train_cat_covariates_contrastive_loss: 631852.5208; train_gene_expr_recon_loss: 2741763.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4691900.0439; train_optim_loss: 4691900.0439; val_kl_reg_loss: 11300.2398; val_edge_recon_loss: 1314308.4643; val_cat_covariates_contrastive_loss: 631656.3571; val_gene_expr_recon_loss: 2734055.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4691320.3571; val_optim_loss: 4691320.3571
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9572; val_auprc_score: 0.9789; val_best_acc_score: 0.9551; val_best_f1_score: 0.9707; train_kl_reg_loss: 11465.7970; train_edge_recon_loss: 1305339.6075; train_cat_covariates_contrastive_loss: 631782.1458; train_gene_expr_recon_loss: 2739560.3991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4688147.9825; train_optim_loss: 4688147.9825; val_kl_reg_loss: 11318.6249; val_edge_recon_loss: 1303403.1071; val_cat_covariates_contrastive_loss: 631256.6786; val_gene_expr_recon_loss: 2747499.7857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4693478.3571; val_optim_loss: 4693478.3571
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9581; val_auprc_score: 0.9791; val_best_acc_score: 0.9543; val_best_f1_score: 0.9702; train_kl_reg_loss: 11448.9168; train_edge_recon_loss: 1303121.4232; train_cat_covariates_contrastive_loss: 631993.6283; train_gene_expr_recon_loss: 2741005.8684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4687569.8070; train_optim_loss: 4687569.8070; val_kl_reg_loss: 11361.5640; val_edge_recon_loss: 1313991.9464; val_cat_covariates_contrastive_loss: 631672.5625; val_gene_expr_recon_loss: 2752687.6429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4709713.7143; val_optim_loss: 4709713.7143

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 20 min 45 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9483
val AUPRC score: 0.9738
val best accuracy score: 0.9503
val best F1 score: 0.9677
val target rna MSE score: 1.0505
val source rna MSE score: 0.1530
Val cat covariate0 mean sim diff: 0.0018
Val cat covariate1 mean sim diff: -0.0919
Duration of model training in run 8: 0 hours, 21 minutes and 1 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 25413
Number of validation nodes: 2824
Number of training edges: 231162
Number of validation edges: 25684
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8481; val_auprc_score: 0.9436; val_best_acc_score: 0.8438; val_best_f1_score: 0.9055; train_kl_reg_loss: 3841.9253; train_edge_recon_loss: 1738359.6184; train_cat_covariates_contrastive_loss: 696890.3454; train_gene_expr_recon_loss: 3915129.7412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6354221.6404; train_optim_loss: 6354221.6404; val_kl_reg_loss: 12029.9849; val_edge_recon_loss: 1587065.0000; val_cat_covariates_contrastive_loss: 626679.6696; val_gene_expr_recon_loss: 3542623.1786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5768397.7857; val_optim_loss: 5768397.7857
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8735; val_auprc_score: 0.9513; val_best_acc_score: 0.8603; val_best_f1_score: 0.9141; train_kl_reg_loss: 24330.4194; train_edge_recon_loss: 1520171.1579; train_cat_covariates_contrastive_loss: 627409.9134; train_gene_expr_recon_loss: 3346227.5746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5518139.0702; train_optim_loss: 5518139.0702; val_kl_reg_loss: 26986.6677; val_edge_recon_loss: 1496902.3750; val_cat_covariates_contrastive_loss: 626704.7500; val_gene_expr_recon_loss: 3227257.8214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5377851.6429; val_optim_loss: 5377851.6429
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9051; val_auprc_score: 0.9630; val_best_acc_score: 0.8686; val_best_f1_score: 0.9194; train_kl_reg_loss: 23889.3703; train_edge_recon_loss: 1464072.2478; train_cat_covariates_contrastive_loss: 627902.4167; train_gene_expr_recon_loss: 3172593.1711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5288457.2105; train_optim_loss: 5288457.2105; val_kl_reg_loss: 19149.3624; val_edge_recon_loss: 1436206.2143; val_cat_covariates_contrastive_loss: 627595.6161; val_gene_expr_recon_loss: 3113752.6071; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5196703.7857; val_optim_loss: 5196703.7857
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9446; val_auprc_score: 0.9766; val_best_acc_score: 0.9197; val_best_f1_score: 0.9488; train_kl_reg_loss: 18056.2022; train_edge_recon_loss: 1395028.0461; train_cat_covariates_contrastive_loss: 633163.0296; train_gene_expr_recon_loss: 3109955.0132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5156202.2544; train_optim_loss: 5156202.2544; val_kl_reg_loss: 18487.7807; val_edge_recon_loss: 1358168.8036; val_cat_covariates_contrastive_loss: 633844.4732; val_gene_expr_recon_loss: 3080867.9286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5091369.0714; val_optim_loss: 5091369.0714
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9484; val_auprc_score: 0.9781; val_best_acc_score: 0.9243; val_best_f1_score: 0.9514; train_kl_reg_loss: 18567.1519; train_edge_recon_loss: 1355869.7039; train_cat_covariates_contrastive_loss: 635496.3596; train_gene_expr_recon_loss: 3064325.8026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5074259.0263; train_optim_loss: 5074259.0263; val_kl_reg_loss: 17906.7157; val_edge_recon_loss: 1350948.8214; val_cat_covariates_contrastive_loss: 634262.1429; val_gene_expr_recon_loss: 3024449.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5027566.9286; val_optim_loss: 5027566.9286
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9506; val_auprc_score: 0.9783; val_best_acc_score: 0.9272; val_best_f1_score: 0.9531; train_kl_reg_loss: 17640.4444; train_edge_recon_loss: 1355536.6031; train_cat_covariates_contrastive_loss: 635649.0121; train_gene_expr_recon_loss: 3033988.6316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5042814.6930; train_optim_loss: 5042814.6930; val_kl_reg_loss: 17036.0536; val_edge_recon_loss: 1351636.5179; val_cat_covariates_contrastive_loss: 634372.1161; val_gene_expr_recon_loss: 3020353.1429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5023397.7857; val_optim_loss: 5023397.7857
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9509; val_auprc_score: 0.9780; val_best_acc_score: 0.9305; val_best_f1_score: 0.9552; train_kl_reg_loss: 16336.3038; train_edge_recon_loss: 1341237.7061; train_cat_covariates_contrastive_loss: 635538.6590; train_gene_expr_recon_loss: 3007056.1096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5000168.7895; train_optim_loss: 5000168.7895; val_kl_reg_loss: 15790.2958; val_edge_recon_loss: 1347907.3214; val_cat_covariates_contrastive_loss: 634670.3571; val_gene_expr_recon_loss: 3016954.1429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5015322.0714; val_optim_loss: 5015322.0714
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9560; val_auprc_score: 0.9794; val_best_acc_score: 0.9353; val_best_f1_score: 0.9581; train_kl_reg_loss: 15229.1585; train_edge_recon_loss: 1333235.8575; train_cat_covariates_contrastive_loss: 635276.8169; train_gene_expr_recon_loss: 2988036.2456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4971778.0702; train_optim_loss: 4971778.0702; val_kl_reg_loss: 14534.5642; val_edge_recon_loss: 1340139.2679; val_cat_covariates_contrastive_loss: 635362.6875; val_gene_expr_recon_loss: 2962417.7143; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4952454.2857; val_optim_loss: 4952454.2857
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9593; val_auprc_score: 0.9807; val_best_acc_score: 0.9410; val_best_f1_score: 0.9618; train_kl_reg_loss: 14112.3245; train_edge_recon_loss: 1327606.4167; train_cat_covariates_contrastive_loss: 634887.5329; train_gene_expr_recon_loss: 2968254.5439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4944860.8158; train_optim_loss: 4944860.8158; val_kl_reg_loss: 13709.9708; val_edge_recon_loss: 1319770.1250; val_cat_covariates_contrastive_loss: 634499.6875; val_gene_expr_recon_loss: 2947779.3214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4915759.0000; val_optim_loss: 4915759.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9585; val_auprc_score: 0.9802; val_best_acc_score: 0.9428; val_best_f1_score: 0.9628; train_kl_reg_loss: 13438.4885; train_edge_recon_loss: 1322532.0439; train_cat_covariates_contrastive_loss: 634766.4375; train_gene_expr_recon_loss: 2947076.3509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4917813.3421; train_optim_loss: 4917813.3421; val_kl_reg_loss: 13099.8136; val_edge_recon_loss: 1327161.5357; val_cat_covariates_contrastive_loss: 633637.4911; val_gene_expr_recon_loss: 2936604.4643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4910503.2857; val_optim_loss: 4910503.2857
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9583; val_auprc_score: 0.9806; val_best_acc_score: 0.9470; val_best_f1_score: 0.9657; train_kl_reg_loss: 12971.4837; train_edge_recon_loss: 1323643.3355; train_cat_covariates_contrastive_loss: 634385.8564; train_gene_expr_recon_loss: 2933681.3465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4904682.0439; train_optim_loss: 4904682.0439; val_kl_reg_loss: 12402.4210; val_edge_recon_loss: 1305121.5714; val_cat_covariates_contrastive_loss: 634595.6786; val_gene_expr_recon_loss: 2916344.9286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4868464.5714; val_optim_loss: 4868464.5714
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9588; val_auprc_score: 0.9800; val_best_acc_score: 0.9464; val_best_f1_score: 0.9654; train_kl_reg_loss: 12651.1254; train_edge_recon_loss: 1317771.9496; train_cat_covariates_contrastive_loss: 634313.4287; train_gene_expr_recon_loss: 2917648.5526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4882385.0526; train_optim_loss: 4882385.0526; val_kl_reg_loss: 12361.2642; val_edge_recon_loss: 1324906.7500; val_cat_covariates_contrastive_loss: 634280.2946; val_gene_expr_recon_loss: 2910604.3929; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4882152.6429; val_optim_loss: 4882152.6429
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9591; val_auprc_score: 0.9808; val_best_acc_score: 0.9464; val_best_f1_score: 0.9653; train_kl_reg_loss: 12365.9213; train_edge_recon_loss: 1323212.9342; train_cat_covariates_contrastive_loss: 634163.3706; train_gene_expr_recon_loss: 2903737.6491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4873479.8860; train_optim_loss: 4873479.8860; val_kl_reg_loss: 12137.2119; val_edge_recon_loss: 1314805.3571; val_cat_covariates_contrastive_loss: 633403.2768; val_gene_expr_recon_loss: 2900625.5714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4860971.3571; val_optim_loss: 4860971.3571
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9562; val_auprc_score: 0.9789; val_best_acc_score: 0.9469; val_best_f1_score: 0.9656; train_kl_reg_loss: 12115.8024; train_edge_recon_loss: 1315645.1491; train_cat_covariates_contrastive_loss: 633992.4748; train_gene_expr_recon_loss: 2891056.1754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4852809.5965; train_optim_loss: 4852809.5965; val_kl_reg_loss: 11988.4919; val_edge_recon_loss: 1314519.0179; val_cat_covariates_contrastive_loss: 633741.7321; val_gene_expr_recon_loss: 2885106.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4845355.2857; val_optim_loss: 4845355.2857
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9576; val_auprc_score: 0.9793; val_best_acc_score: 0.9465; val_best_f1_score: 0.9654; train_kl_reg_loss: 11991.8350; train_edge_recon_loss: 1314031.1711; train_cat_covariates_contrastive_loss: 633742.3684; train_gene_expr_recon_loss: 2878192.5351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4837957.9035; train_optim_loss: 4837957.9035; val_kl_reg_loss: 11768.5114; val_edge_recon_loss: 1329822.1607; val_cat_covariates_contrastive_loss: 633763.5089; val_gene_expr_recon_loss: 2883861.3929; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4859215.5000; val_optim_loss: 4859215.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9559; val_auprc_score: 0.9787; val_best_acc_score: 0.9483; val_best_f1_score: 0.9665; train_kl_reg_loss: 11813.5139; train_edge_recon_loss: 1320002.3640; train_cat_covariates_contrastive_loss: 633698.9002; train_gene_expr_recon_loss: 2867168.6272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4832683.3947; train_optim_loss: 4832683.3947; val_kl_reg_loss: 11651.6959; val_edge_recon_loss: 1329750.5893; val_cat_covariates_contrastive_loss: 633002.2768; val_gene_expr_recon_loss: 2858372.0714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4832776.7143; val_optim_loss: 4832776.7143
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9544; val_auprc_score: 0.9778; val_best_acc_score: 0.9492; val_best_f1_score: 0.9672; train_kl_reg_loss: 11692.1490; train_edge_recon_loss: 1316272.0132; train_cat_covariates_contrastive_loss: 633420.2511; train_gene_expr_recon_loss: 2855006.4079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4816390.8421; train_optim_loss: 4816390.8421; val_kl_reg_loss: 11478.6934; val_edge_recon_loss: 1315446.3214; val_cat_covariates_contrastive_loss: 632636.8571; val_gene_expr_recon_loss: 2847757.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4807319.7143; val_optim_loss: 4807319.7143
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9588; val_auprc_score: 0.9797; val_best_acc_score: 0.9505; val_best_f1_score: 0.9679; train_kl_reg_loss: 11620.5434; train_edge_recon_loss: 1311594.9101; train_cat_covariates_contrastive_loss: 633065.6754; train_gene_expr_recon_loss: 2843916.2675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4800197.3947; train_optim_loss: 4800197.3947; val_kl_reg_loss: 11463.6024; val_edge_recon_loss: 1320652.3929; val_cat_covariates_contrastive_loss: 633239.9464; val_gene_expr_recon_loss: 2863379.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4828735.2143; val_optim_loss: 4828735.2143
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9563; val_auprc_score: 0.9788; val_best_acc_score: 0.9519; val_best_f1_score: 0.9688; train_kl_reg_loss: 11418.8178; train_edge_recon_loss: 1305358.2325; train_cat_covariates_contrastive_loss: 633078.3136; train_gene_expr_recon_loss: 2835324.5175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4785179.9035; train_optim_loss: 4785179.9035; val_kl_reg_loss: 11421.0322; val_edge_recon_loss: 1312639.8393; val_cat_covariates_contrastive_loss: 632275.4911; val_gene_expr_recon_loss: 2831393.6786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4787730.0000; val_optim_loss: 4787730.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9580; val_auprc_score: 0.9798; val_best_acc_score: 0.9505; val_best_f1_score: 0.9679; train_kl_reg_loss: 11428.7425; train_edge_recon_loss: 1313212.1996; train_cat_covariates_contrastive_loss: 633080.6700; train_gene_expr_recon_loss: 2827321.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4785043.2807; train_optim_loss: 4785043.2807; val_kl_reg_loss: 11247.7997; val_edge_recon_loss: 1305971.5536; val_cat_covariates_contrastive_loss: 632813.3036; val_gene_expr_recon_loss: 2816193.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4766226.0000; val_optim_loss: 4766226.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9588; val_auprc_score: 0.9795; val_best_acc_score: 0.9532; val_best_f1_score: 0.9695; train_kl_reg_loss: 11330.6445; train_edge_recon_loss: 1312786.0680; train_cat_covariates_contrastive_loss: 632972.5548; train_gene_expr_recon_loss: 2816508.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4773597.2544; train_optim_loss: 4773597.2544; val_kl_reg_loss: 11440.8203; val_edge_recon_loss: 1313561.8750; val_cat_covariates_contrastive_loss: 631909.6786; val_gene_expr_recon_loss: 2835943.6429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4792856.0000; val_optim_loss: 4792856.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9611; val_auprc_score: 0.9812; val_best_acc_score: 0.9523; val_best_f1_score: 0.9690; train_kl_reg_loss: 11302.5977; train_edge_recon_loss: 1309945.0768; train_cat_covariates_contrastive_loss: 632743.6568; train_gene_expr_recon_loss: 2807815.1886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4761806.5088; train_optim_loss: 4761806.5088; val_kl_reg_loss: 11052.9100; val_edge_recon_loss: 1320251.7500; val_cat_covariates_contrastive_loss: 631852.1339; val_gene_expr_recon_loss: 2814387.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4777544.5000; val_optim_loss: 4777544.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9580; val_auprc_score: 0.9796; val_best_acc_score: 0.9536; val_best_f1_score: 0.9699; train_kl_reg_loss: 11277.2791; train_edge_recon_loss: 1304858.1338; train_cat_covariates_contrastive_loss: 632841.5987; train_gene_expr_recon_loss: 2800281.5877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4749258.6404; train_optim_loss: 4749258.6404; val_kl_reg_loss: 11297.4351; val_edge_recon_loss: 1304693.9643; val_cat_covariates_contrastive_loss: 631849.3750; val_gene_expr_recon_loss: 2788159.3929; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4736000.2857; val_optim_loss: 4736000.2857
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9583; val_auprc_score: 0.9793; val_best_acc_score: 0.9528; val_best_f1_score: 0.9693; train_kl_reg_loss: 11225.7585; train_edge_recon_loss: 1307592.1491; train_cat_covariates_contrastive_loss: 632649.2204; train_gene_expr_recon_loss: 2791293.6316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4742760.7632; train_optim_loss: 4742760.7632; val_kl_reg_loss: 11107.7539; val_edge_recon_loss: 1319555.0714; val_cat_covariates_contrastive_loss: 631475.3482; val_gene_expr_recon_loss: 2805717.1429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4767855.2143; val_optim_loss: 4767855.2143
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9549; val_auprc_score: 0.9772; val_best_acc_score: 0.9518; val_best_f1_score: 0.9687; train_kl_reg_loss: 11177.4039; train_edge_recon_loss: 1309826.2368; train_cat_covariates_contrastive_loss: 632298.2346; train_gene_expr_recon_loss: 2784934.4123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4738236.2719; train_optim_loss: 4738236.2719; val_kl_reg_loss: 10955.5995; val_edge_recon_loss: 1322969.1964; val_cat_covariates_contrastive_loss: 631717.7411; val_gene_expr_recon_loss: 2786886.4286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4752529.0000; val_optim_loss: 4752529.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9556; val_auprc_score: 0.9782; val_best_acc_score: 0.9524; val_best_f1_score: 0.9691; train_kl_reg_loss: 11165.6615; train_edge_recon_loss: 1303985.4561; train_cat_covariates_contrastive_loss: 632362.0186; train_gene_expr_recon_loss: 2776424.2939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4723937.4386; train_optim_loss: 4723937.4386; val_kl_reg_loss: 11287.6051; val_edge_recon_loss: 1317499.9464; val_cat_covariates_contrastive_loss: 631749.0000; val_gene_expr_recon_loss: 2795536.4286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4756073.0000; val_optim_loss: 4756073.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9587; val_auprc_score: 0.9794; val_best_acc_score: 0.9538; val_best_f1_score: 0.9701; train_kl_reg_loss: 11164.2953; train_edge_recon_loss: 1309356.4846; train_cat_covariates_contrastive_loss: 632401.5987; train_gene_expr_recon_loss: 2770125.1623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4723047.5702; train_optim_loss: 4723047.5702; val_kl_reg_loss: 11013.9088; val_edge_recon_loss: 1321854.1071; val_cat_covariates_contrastive_loss: 632391.4821; val_gene_expr_recon_loss: 2768159.6429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4733419.2143; val_optim_loss: 4733419.2143
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9576; val_auprc_score: 0.9788; val_best_acc_score: 0.9563; val_best_f1_score: 0.9716; train_kl_reg_loss: 11145.0007; train_edge_recon_loss: 1309409.3816; train_cat_covariates_contrastive_loss: 632102.9989; train_gene_expr_recon_loss: 2761162.5746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4713819.9737; train_optim_loss: 4713819.9737; val_kl_reg_loss: 10952.7980; val_edge_recon_loss: 1297933.1964; val_cat_covariates_contrastive_loss: 632158.0268; val_gene_expr_recon_loss: 2781888.8214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4722932.7143; val_optim_loss: 4722932.7143
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9598; val_auprc_score: 0.9789; val_best_acc_score: 0.9552; val_best_f1_score: 0.9708; train_kl_reg_loss: 11110.1939; train_edge_recon_loss: 1309011.3706; train_cat_covariates_contrastive_loss: 632196.5647; train_gene_expr_recon_loss: 2755521.2325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4707839.3684; train_optim_loss: 4707839.3684; val_kl_reg_loss: 10876.9162; val_edge_recon_loss: 1313188.5893; val_cat_covariates_contrastive_loss: 631856.7768; val_gene_expr_recon_loss: 2765592.5357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4721514.7857; val_optim_loss: 4721514.7857
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9583; val_auprc_score: 0.9791; val_best_acc_score: 0.9548; val_best_f1_score: 0.9706; train_kl_reg_loss: 11185.3440; train_edge_recon_loss: 1306227.0504; train_cat_covariates_contrastive_loss: 632052.3794; train_gene_expr_recon_loss: 2749829.9123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4699294.6930; train_optim_loss: 4699294.6930; val_kl_reg_loss: 11069.8711; val_edge_recon_loss: 1305007.6607; val_cat_covariates_contrastive_loss: 631597.3036; val_gene_expr_recon_loss: 2765031.6071; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4712706.4286; val_optim_loss: 4712706.4286
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9580; val_auprc_score: 0.9796; val_best_acc_score: 0.9548; val_best_f1_score: 0.9706; train_kl_reg_loss: 11157.6947; train_edge_recon_loss: 1308416.4627; train_cat_covariates_contrastive_loss: 631770.0965; train_gene_expr_recon_loss: 2743108.9868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4694453.2105; train_optim_loss: 4694453.2105; val_kl_reg_loss: 10977.7462; val_edge_recon_loss: 1300595.2321; val_cat_covariates_contrastive_loss: 632040.2768; val_gene_expr_recon_loss: 2733297.5714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4676910.8571; val_optim_loss: 4676910.8571
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9581; val_auprc_score: 0.9788; val_best_acc_score: 0.9576; val_best_f1_score: 0.9724; train_kl_reg_loss: 11142.0667; train_edge_recon_loss: 1307078.3048; train_cat_covariates_contrastive_loss: 632021.8498; train_gene_expr_recon_loss: 2737810.3904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4688052.6228; train_optim_loss: 4688052.6228; val_kl_reg_loss: 11281.8871; val_edge_recon_loss: 1314939.2143; val_cat_covariates_contrastive_loss: 631885.5357; val_gene_expr_recon_loss: 2737313.0714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4695419.6429; val_optim_loss: 4695419.6429
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9581; val_auprc_score: 0.9790; val_best_acc_score: 0.9580; val_best_f1_score: 0.9727; train_kl_reg_loss: 11146.0794; train_edge_recon_loss: 1306560.1228; train_cat_covariates_contrastive_loss: 631962.6250; train_gene_expr_recon_loss: 2732868.7895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4682537.6228; train_optim_loss: 4682537.6228; val_kl_reg_loss: 10926.8938; val_edge_recon_loss: 1290051.3929; val_cat_covariates_contrastive_loss: 631974.0179; val_gene_expr_recon_loss: 2747306.6429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4680258.9286; val_optim_loss: 4680258.9286
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9582; val_auprc_score: 0.9789; val_best_acc_score: 0.9579; val_best_f1_score: 0.9725; train_kl_reg_loss: 11189.1066; train_edge_recon_loss: 1304154.4298; train_cat_covariates_contrastive_loss: 631756.7774; train_gene_expr_recon_loss: 2728547.0351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4675647.3509; train_optim_loss: 4675647.3509; val_kl_reg_loss: 11257.1656; val_edge_recon_loss: 1318629.8036; val_cat_covariates_contrastive_loss: 631118.9732; val_gene_expr_recon_loss: 2715555.2857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4676561.2143; val_optim_loss: 4676561.2143
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9581; val_auprc_score: 0.9789; val_best_acc_score: 0.9578; val_best_f1_score: 0.9725; train_kl_reg_loss: 11268.9363; train_edge_recon_loss: 1308824.1689; train_cat_covariates_contrastive_loss: 631738.6250; train_gene_expr_recon_loss: 2722012.9649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4673844.6667; train_optim_loss: 4673844.6667; val_kl_reg_loss: 11069.8602; val_edge_recon_loss: 1316944.7500; val_cat_covariates_contrastive_loss: 631319.4464; val_gene_expr_recon_loss: 2717448.6786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4676782.6429; val_optim_loss: 4676782.6429
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9601; val_auprc_score: 0.9803; val_best_acc_score: 0.9581; val_best_f1_score: 0.9728; train_kl_reg_loss: 11286.5727; train_edge_recon_loss: 1304945.6689; train_cat_covariates_contrastive_loss: 631608.2917; train_gene_expr_recon_loss: 2717178.9079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4665019.4123; train_optim_loss: 4665019.4123; val_kl_reg_loss: 11212.7743; val_edge_recon_loss: 1291790.7321; val_cat_covariates_contrastive_loss: 631193.1607; val_gene_expr_recon_loss: 2734244.1071; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4668440.7857; val_optim_loss: 4668440.7857
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9616; val_auprc_score: 0.9813; val_best_acc_score: 0.9596; val_best_f1_score: 0.9736; train_kl_reg_loss: 11275.2732; train_edge_recon_loss: 1307769.2851; train_cat_covariates_contrastive_loss: 631792.2884; train_gene_expr_recon_loss: 2710209.6930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4661046.5526; train_optim_loss: 4661046.5526; val_kl_reg_loss: 11160.5432; val_edge_recon_loss: 1308650.9464; val_cat_covariates_contrastive_loss: 631532.0625; val_gene_expr_recon_loss: 2720353.1429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4671696.7143; val_optim_loss: 4671696.7143
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9583; val_auprc_score: 0.9786; val_best_acc_score: 0.9583; val_best_f1_score: 0.9728; train_kl_reg_loss: 11282.8305; train_edge_recon_loss: 1306243.6053; train_cat_covariates_contrastive_loss: 631803.0910; train_gene_expr_recon_loss: 2705567.9386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4654897.4649; train_optim_loss: 4654897.4649; val_kl_reg_loss: 11125.2991; val_edge_recon_loss: 1314731.7321; val_cat_covariates_contrastive_loss: 631729.2232; val_gene_expr_recon_loss: 2715346.6071; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4672932.8571; val_optim_loss: 4672932.8571
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9589; val_auprc_score: 0.9785; val_best_acc_score: 0.9599; val_best_f1_score: 0.9738; train_kl_reg_loss: 11295.2985; train_edge_recon_loss: 1309896.6031; train_cat_covariates_contrastive_loss: 631779.2050; train_gene_expr_recon_loss: 2701505.8772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4654476.9474; train_optim_loss: 4654476.9474; val_kl_reg_loss: 11286.1564; val_edge_recon_loss: 1313362.3393; val_cat_covariates_contrastive_loss: 631136.2500; val_gene_expr_recon_loss: 2724029.3571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4679814.0000; val_optim_loss: 4679814.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9595; val_auprc_score: 0.9797; val_best_acc_score: 0.9594; val_best_f1_score: 0.9735; train_kl_reg_loss: 11390.4312; train_edge_recon_loss: 1307303.9978; train_cat_covariates_contrastive_loss: 631554.1831; train_gene_expr_recon_loss: 2695736.3684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4645984.9912; train_optim_loss: 4645984.9912; val_kl_reg_loss: 11422.9971; val_edge_recon_loss: 1316318.5000; val_cat_covariates_contrastive_loss: 631365.1607; val_gene_expr_recon_loss: 2705003.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4664109.6429; val_optim_loss: 4664109.6429
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9568; val_auprc_score: 0.9777; val_best_acc_score: 0.9587; val_best_f1_score: 0.9731; train_kl_reg_loss: 11439.2341; train_edge_recon_loss: 1306124.6316; train_cat_covariates_contrastive_loss: 631604.0373; train_gene_expr_recon_loss: 2693375.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4642543.5965; train_optim_loss: 4642543.5965; val_kl_reg_loss: 11423.1226; val_edge_recon_loss: 1304855.3750; val_cat_covariates_contrastive_loss: 631743.0625; val_gene_expr_recon_loss: 2692471.8929; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4640493.4286; val_optim_loss: 4640493.4286
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9593; val_auprc_score: 0.9799; val_best_acc_score: 0.9593; val_best_f1_score: 0.9736; train_kl_reg_loss: 11419.8487; train_edge_recon_loss: 1304670.8684; train_cat_covariates_contrastive_loss: 631631.3805; train_gene_expr_recon_loss: 2687729.4298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4635451.5614; train_optim_loss: 4635451.5614; val_kl_reg_loss: 11573.0400; val_edge_recon_loss: 1294038.0536; val_cat_covariates_contrastive_loss: 631154.1250; val_gene_expr_recon_loss: 2692863.3571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4629628.5000; val_optim_loss: 4629628.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9581; val_auprc_score: 0.9783; val_best_acc_score: 0.9606; val_best_f1_score: 0.9743; train_kl_reg_loss: 11463.8148; train_edge_recon_loss: 1301509.3618; train_cat_covariates_contrastive_loss: 631679.2039; train_gene_expr_recon_loss: 2681798.5702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4626450.9474; train_optim_loss: 4626450.9474; val_kl_reg_loss: 11330.8786; val_edge_recon_loss: 1317963.8036; val_cat_covariates_contrastive_loss: 631504.4821; val_gene_expr_recon_loss: 2687227.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4648026.8571; val_optim_loss: 4648026.8571
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9612; val_auprc_score: 0.9805; val_best_acc_score: 0.9603; val_best_f1_score: 0.9742; train_kl_reg_loss: 11446.9718; train_edge_recon_loss: 1300662.4912; train_cat_covariates_contrastive_loss: 631612.8432; train_gene_expr_recon_loss: 2679884.1404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4623606.4474; train_optim_loss: 4623606.4474; val_kl_reg_loss: 11398.5706; val_edge_recon_loss: 1311657.9107; val_cat_covariates_contrastive_loss: 631322.5000; val_gene_expr_recon_loss: 2683351.1071; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4637730.2143; val_optim_loss: 4637730.2143
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9609; val_auprc_score: 0.9796; val_best_acc_score: 0.9614; val_best_f1_score: 0.9748; train_kl_reg_loss: 11501.4391; train_edge_recon_loss: 1302107.4496; train_cat_covariates_contrastive_loss: 631636.6239; train_gene_expr_recon_loss: 2674525.2588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4619770.7719; train_optim_loss: 4619770.7719; val_kl_reg_loss: 11722.2352; val_edge_recon_loss: 1317494.4643; val_cat_covariates_contrastive_loss: 630576.0268; val_gene_expr_recon_loss: 2692296.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4652089.5000; val_optim_loss: 4652089.5000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9610; val_auprc_score: 0.9807; val_best_acc_score: 0.9612; val_best_f1_score: 0.9748; train_kl_reg_loss: 11558.5478; train_edge_recon_loss: 1302611.2917; train_cat_covariates_contrastive_loss: 631597.9507; train_gene_expr_recon_loss: 2670041.0789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4615808.8684; train_optim_loss: 4615808.8684; val_kl_reg_loss: 11329.7871; val_edge_recon_loss: 1296536.6786; val_cat_covariates_contrastive_loss: 631644.2679; val_gene_expr_recon_loss: 2690883.1786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4630393.8571; val_optim_loss: 4630393.8571

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9584; val_auprc_score: 0.9782; val_best_acc_score: 0.9612; val_best_f1_score: 0.9747; train_kl_reg_loss: 11641.1396; train_edge_recon_loss: 1303386.8114; train_cat_covariates_contrastive_loss: 631915.4419; train_gene_expr_recon_loss: 2664645.0789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4611588.4912; train_optim_loss: 4611588.4912; val_kl_reg_loss: 11727.8545; val_edge_recon_loss: 1304778.7857; val_cat_covariates_contrastive_loss: 631411.0179; val_gene_expr_recon_loss: 2676607.4643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4624525.0714; val_optim_loss: 4624525.0714
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9582; val_auprc_score: 0.9794; val_best_acc_score: 0.9596; val_best_f1_score: 0.9737; train_kl_reg_loss: 11746.2181; train_edge_recon_loss: 1302998.9320; train_cat_covariates_contrastive_loss: 631679.1689; train_gene_expr_recon_loss: 2663894.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4610319.0965; train_optim_loss: 4610319.0965; val_kl_reg_loss: 11623.7349; val_edge_recon_loss: 1300434.1607; val_cat_covariates_contrastive_loss: 631629.1964; val_gene_expr_recon_loss: 2679146.4643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4622833.5714; val_optim_loss: 4622833.5714
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9609; val_auprc_score: 0.9799; val_best_acc_score: 0.9622; val_best_f1_score: 0.9754; train_kl_reg_loss: 11736.1528; train_edge_recon_loss: 1300198.2982; train_cat_covariates_contrastive_loss: 631677.6107; train_gene_expr_recon_loss: 2663421.5921; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4607033.6754; train_optim_loss: 4607033.6754; val_kl_reg_loss: 11620.9588; val_edge_recon_loss: 1299910.4643; val_cat_covariates_contrastive_loss: 631313.0000; val_gene_expr_recon_loss: 2676371.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4619215.9286; val_optim_loss: 4619215.9286
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9592; val_auprc_score: 0.9798; val_best_acc_score: 0.9597; val_best_f1_score: 0.9738; train_kl_reg_loss: 11671.3813; train_edge_recon_loss: 1300867.2610; train_cat_covariates_contrastive_loss: 631716.2697; train_gene_expr_recon_loss: 2661532.3026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4605787.2368; train_optim_loss: 4605787.2368; val_kl_reg_loss: 11630.1558; val_edge_recon_loss: 1302676.4643; val_cat_covariates_contrastive_loss: 632448.8125; val_gene_expr_recon_loss: 2669687.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4616442.3571; val_optim_loss: 4616442.3571
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9587; val_auprc_score: 0.9793; val_best_acc_score: 0.9611; val_best_f1_score: 0.9747; train_kl_reg_loss: 11653.4573; train_edge_recon_loss: 1301629.3246; train_cat_covariates_contrastive_loss: 631571.3410; train_gene_expr_recon_loss: 2660343.5658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4605197.6842; train_optim_loss: 4605197.6842; val_kl_reg_loss: 11604.7001; val_edge_recon_loss: 1298709.9464; val_cat_covariates_contrastive_loss: 631120.5714; val_gene_expr_recon_loss: 2684386.3929; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4625821.6429; val_optim_loss: 4625821.6429
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9627; val_auprc_score: 0.9807; val_best_acc_score: 0.9636; val_best_f1_score: 0.9762; train_kl_reg_loss: 11702.9577; train_edge_recon_loss: 1307247.1996; train_cat_covariates_contrastive_loss: 631638.0932; train_gene_expr_recon_loss: 2662466.5921; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4613054.8596; train_optim_loss: 4613054.8596; val_kl_reg_loss: 11572.1037; val_edge_recon_loss: 1297055.7321; val_cat_covariates_contrastive_loss: 630906.9464; val_gene_expr_recon_loss: 2675380.9643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4614915.8571; val_optim_loss: 4614915.8571
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9578; val_auprc_score: 0.9791; val_best_acc_score: 0.9610; val_best_f1_score: 0.9746; train_kl_reg_loss: 11624.2324; train_edge_recon_loss: 1295023.0175; train_cat_covariates_contrastive_loss: 631584.2906; train_gene_expr_recon_loss: 2659700.6360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4597932.1754; train_optim_loss: 4597932.1754; val_kl_reg_loss: 11469.7028; val_edge_recon_loss: 1303541.0714; val_cat_covariates_contrastive_loss: 632541.3214; val_gene_expr_recon_loss: 2662244.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4609796.4286; val_optim_loss: 4609796.4286
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9596; val_auprc_score: 0.9795; val_best_acc_score: 0.9614; val_best_f1_score: 0.9748; train_kl_reg_loss: 11649.5528; train_edge_recon_loss: 1300323.4232; train_cat_covariates_contrastive_loss: 631807.6458; train_gene_expr_recon_loss: 2659086.1140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4602866.7281; train_optim_loss: 4602866.7281; val_kl_reg_loss: 11616.8994; val_edge_recon_loss: 1299189.7500; val_cat_covariates_contrastive_loss: 631351.7500; val_gene_expr_recon_loss: 2687089.5357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4629247.9286; val_optim_loss: 4629247.9286
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9595; val_auprc_score: 0.9795; val_best_acc_score: 0.9602; val_best_f1_score: 0.9740; train_kl_reg_loss: 11690.6008; train_edge_recon_loss: 1299358.1053; train_cat_covariates_contrastive_loss: 631699.9825; train_gene_expr_recon_loss: 2659075.8596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4601824.5526; train_optim_loss: 4601824.5526; val_kl_reg_loss: 11651.6496; val_edge_recon_loss: 1322637.4821; val_cat_covariates_contrastive_loss: 631142.5804; val_gene_expr_recon_loss: 2685611.3214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4651043.0714; val_optim_loss: 4651043.0714
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9597; val_auprc_score: 0.9796; val_best_acc_score: 0.9607; val_best_f1_score: 0.9744; train_kl_reg_loss: 11627.6677; train_edge_recon_loss: 1310534.3004; train_cat_covariates_contrastive_loss: 631691.6612; train_gene_expr_recon_loss: 2657626.1491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4611479.7807; train_optim_loss: 4611479.7807; val_kl_reg_loss: 11654.9993; val_edge_recon_loss: 1324379.9464; val_cat_covariates_contrastive_loss: 631097.3393; val_gene_expr_recon_loss: 2685917.0357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4653049.3571; val_optim_loss: 4653049.3571
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9633; val_auprc_score: 0.9815; val_best_acc_score: 0.9640; val_best_f1_score: 0.9764; train_kl_reg_loss: 11715.3639; train_edge_recon_loss: 1298584.6382; train_cat_covariates_contrastive_loss: 631567.1228; train_gene_expr_recon_loss: 2659211.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4601078.3246; train_optim_loss: 4601078.3246; val_kl_reg_loss: 11595.2134; val_edge_recon_loss: 1311895.3393; val_cat_covariates_contrastive_loss: 631361.9732; val_gene_expr_recon_loss: 2683605.9643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4638458.5000; val_optim_loss: 4638458.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9582; val_auprc_score: 0.9786; val_best_acc_score: 0.9623; val_best_f1_score: 0.9754; train_kl_reg_loss: 11646.3688; train_edge_recon_loss: 1299782.8816; train_cat_covariates_contrastive_loss: 631705.4221; train_gene_expr_recon_loss: 2655040.2807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4598174.9561; train_optim_loss: 4598174.9561; val_kl_reg_loss: 11677.0133; val_edge_recon_loss: 1316469.8214; val_cat_covariates_contrastive_loss: 631872.4464; val_gene_expr_recon_loss: 2664423.8571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4624443.0714; val_optim_loss: 4624443.0714
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9601; val_auprc_score: 0.9803; val_best_acc_score: 0.9610; val_best_f1_score: 0.9746; train_kl_reg_loss: 11682.5601; train_edge_recon_loss: 1302129.5285; train_cat_covariates_contrastive_loss: 631651.7511; train_gene_expr_recon_loss: 2658314.6272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4603778.4912; train_optim_loss: 4603778.4912; val_kl_reg_loss: 11671.9925; val_edge_recon_loss: 1294135.1250; val_cat_covariates_contrastive_loss: 631757.0179; val_gene_expr_recon_loss: 2662253.1071; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4599817.2143; val_optim_loss: 4599817.2143
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9619; val_auprc_score: 0.9809; val_best_acc_score: 0.9626; val_best_f1_score: 0.9756; train_kl_reg_loss: 11689.4017; train_edge_recon_loss: 1302053.7061; train_cat_covariates_contrastive_loss: 631547.1349; train_gene_expr_recon_loss: 2656056.3114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4601346.5351; train_optim_loss: 4601346.5351; val_kl_reg_loss: 11598.4039; val_edge_recon_loss: 1309464.5893; val_cat_covariates_contrastive_loss: 631759.2054; val_gene_expr_recon_loss: 2669632.2143; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4622454.4286; val_optim_loss: 4622454.4286
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9606; val_auprc_score: 0.9802; val_best_acc_score: 0.9620; val_best_f1_score: 0.9752; train_kl_reg_loss: 11673.7698; train_edge_recon_loss: 1297688.0702; train_cat_covariates_contrastive_loss: 631649.1140; train_gene_expr_recon_loss: 2656650.2149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4597661.1754; train_optim_loss: 4597661.1754; val_kl_reg_loss: 11584.7768; val_edge_recon_loss: 1306043.8929; val_cat_covariates_contrastive_loss: 631601.6161; val_gene_expr_recon_loss: 2682312.6429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4631543.0000; val_optim_loss: 4631543.0000
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9621; val_auprc_score: 0.9812; val_best_acc_score: 0.9631; val_best_f1_score: 0.9760; train_kl_reg_loss: 11678.1176; train_edge_recon_loss: 1305677.4825; train_cat_covariates_contrastive_loss: 631803.0143; train_gene_expr_recon_loss: 2655954.8114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4605113.4474; train_optim_loss: 4605113.4474; val_kl_reg_loss: 11602.2960; val_edge_recon_loss: 1297826.9464; val_cat_covariates_contrastive_loss: 631602.2946; val_gene_expr_recon_loss: 2683464.5714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4624496.0714; val_optim_loss: 4624496.0714
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9594; val_auprc_score: 0.9794; val_best_acc_score: 0.9621; val_best_f1_score: 0.9752; train_kl_reg_loss: 11676.6315; train_edge_recon_loss: 1300472.7039; train_cat_covariates_contrastive_loss: 631563.4868; train_gene_expr_recon_loss: 2658126.5088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4601839.3684; train_optim_loss: 4601839.3684; val_kl_reg_loss: 11607.4143; val_edge_recon_loss: 1312132.6071; val_cat_covariates_contrastive_loss: 631706.8482; val_gene_expr_recon_loss: 2679748.7143; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4635195.5000; val_optim_loss: 4635195.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9613; val_auprc_score: 0.9807; val_best_acc_score: 0.9621; val_best_f1_score: 0.9753; train_kl_reg_loss: 11683.3555; train_edge_recon_loss: 1301560.5000; train_cat_covariates_contrastive_loss: 631585.5658; train_gene_expr_recon_loss: 2657443.7982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4602273.2105; train_optim_loss: 4602273.2105; val_kl_reg_loss: 11654.7411; val_edge_recon_loss: 1303096.3929; val_cat_covariates_contrastive_loss: 631699.2679; val_gene_expr_recon_loss: 2663949.0357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4610399.5000; val_optim_loss: 4610399.5000
Epoch 65/400 |███-----------------| 16.2% val_auroc_score: 0.9634; val_auprc_score: 0.9814; val_best_acc_score: 0.9622; val_best_f1_score: 0.9754; train_kl_reg_loss: 11679.9209; train_edge_recon_loss: 1300907.6009; train_cat_covariates_contrastive_loss: 631620.9912; train_gene_expr_recon_loss: 2656845.2456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4601053.7544; train_optim_loss: 4601053.7544; val_kl_reg_loss: 11622.0315; val_edge_recon_loss: 1291069.1250; val_cat_covariates_contrastive_loss: 631331.2500; val_gene_expr_recon_loss: 2680816.8214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4614839.3571; val_optim_loss: 4614839.3571
Epoch 66/400 |███-----------------| 16.5% val_auroc_score: 0.9601; val_auprc_score: 0.9799; val_best_acc_score: 0.9625; val_best_f1_score: 0.9756; train_kl_reg_loss: 11682.7774; train_edge_recon_loss: 1299017.4408; train_cat_covariates_contrastive_loss: 631869.5384; train_gene_expr_recon_loss: 2656937.4956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4599507.2632; train_optim_loss: 4599507.2632; val_kl_reg_loss: 11628.4475; val_edge_recon_loss: 1296333.2500; val_cat_covariates_contrastive_loss: 631465.6250; val_gene_expr_recon_loss: 2689242.9286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4628670.2143; val_optim_loss: 4628670.2143
Epoch 67/400 |███-----------------| 16.8% val_auroc_score: 0.9620; val_auprc_score: 0.9808; val_best_acc_score: 0.9627; val_best_f1_score: 0.9757; train_kl_reg_loss: 11693.2517; train_edge_recon_loss: 1295300.1908; train_cat_covariates_contrastive_loss: 631739.0581; train_gene_expr_recon_loss: 2657643.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4596375.7719; train_optim_loss: 4596375.7719; val_kl_reg_loss: 11620.9548; val_edge_recon_loss: 1299298.7679; val_cat_covariates_contrastive_loss: 631169.8036; val_gene_expr_recon_loss: 2669705.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4611794.7857; val_optim_loss: 4611794.7857

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 47 min 12 sec.
Using best model state, which was in epoch 59.

--- MODEL EVALUATION ---
val AUROC score: 0.9480
val AUPRC score: 0.9725
val best accuracy score: 0.9564
val best F1 score: 0.9714
val target rna MSE score: 1.1633
val source rna MSE score: 0.1146
Val cat covariate0 mean sim diff: 0.0000
Val cat covariate1 mean sim diff: -0.0886
Duration of model training in run 7: 0 hours, 47 minutes and 26 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 25413
Number of validation nodes: 2824
Number of training edges: 174662
Number of validation edges: 19406
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8489; val_auprc_score: 0.9436; val_best_acc_score: 0.8429; val_best_f1_score: 0.9047; train_kl_reg_loss: 3522.9099; train_edge_recon_loss: 1769330.4215; train_cat_covariates_contrastive_loss: 712329.5174; train_gene_expr_recon_loss: 3953366.3372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6438549.2326; train_optim_loss: 6438549.2326; val_kl_reg_loss: 8443.1177; val_edge_recon_loss: 1642319.3750; val_cat_covariates_contrastive_loss: 626791.1125; val_gene_expr_recon_loss: 3596360.9000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5873914.5000; val_optim_loss: 5873914.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8742; val_auprc_score: 0.9515; val_best_acc_score: 0.8618; val_best_f1_score: 0.9143; train_kl_reg_loss: 21227.1463; train_edge_recon_loss: 1536687.6337; train_cat_covariates_contrastive_loss: 628139.2180; train_gene_expr_recon_loss: 3390395.6860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5576449.7442; train_optim_loss: 5576449.7442; val_kl_reg_loss: 30341.1484; val_edge_recon_loss: 1489555.2250; val_cat_covariates_contrastive_loss: 626732.7750; val_gene_expr_recon_loss: 3252152.8500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5398782.0000; val_optim_loss: 5398782.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8886; val_auprc_score: 0.9571; val_best_acc_score: 0.8667; val_best_f1_score: 0.9183; train_kl_reg_loss: 27122.9353; train_edge_recon_loss: 1471650.3692; train_cat_covariates_contrastive_loss: 627386.1773; train_gene_expr_recon_loss: 3189285.7965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5315445.2558; train_optim_loss: 5315445.2558; val_kl_reg_loss: 21902.9887; val_edge_recon_loss: 1452797.0000; val_cat_covariates_contrastive_loss: 627152.7500; val_gene_expr_recon_loss: 3180966.3000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5282819.1000; val_optim_loss: 5282819.1000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9294; val_auprc_score: 0.9699; val_best_acc_score: 0.9035; val_best_f1_score: 0.9387; train_kl_reg_loss: 19677.0114; train_edge_recon_loss: 1425946.9419; train_cat_covariates_contrastive_loss: 630538.6352; train_gene_expr_recon_loss: 3112175.7209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5188338.2791; train_optim_loss: 5188338.2791; val_kl_reg_loss: 17645.3750; val_edge_recon_loss: 1383253.0250; val_cat_covariates_contrastive_loss: 633037.1875; val_gene_expr_recon_loss: 3140663.9500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5174599.5000; val_optim_loss: 5174599.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9388; val_auprc_score: 0.9744; val_best_acc_score: 0.9151; val_best_f1_score: 0.9463; train_kl_reg_loss: 18701.5841; train_edge_recon_loss: 1359455.8692; train_cat_covariates_contrastive_loss: 635823.1788; train_gene_expr_recon_loss: 3060602.2791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5074582.9419; train_optim_loss: 5074582.9419; val_kl_reg_loss: 19125.9945; val_edge_recon_loss: 1343204.1500; val_cat_covariates_contrastive_loss: 635204.5500; val_gene_expr_recon_loss: 3104794.9000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5102329.6000; val_optim_loss: 5102329.6000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9427; val_auprc_score: 0.9749; val_best_acc_score: 0.9167; val_best_f1_score: 0.9469; train_kl_reg_loss: 19102.3339; train_edge_recon_loss: 1348536.5552; train_cat_covariates_contrastive_loss: 635961.3096; train_gene_expr_recon_loss: 3031462.3256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5035062.5581; train_optim_loss: 5035062.5581; val_kl_reg_loss: 18834.1320; val_edge_recon_loss: 1356907.7500; val_cat_covariates_contrastive_loss: 633247.5625; val_gene_expr_recon_loss: 3044917.4500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5053906.8000; val_optim_loss: 5053906.8000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9447; val_auprc_score: 0.9748; val_best_acc_score: 0.9226; val_best_f1_score: 0.9504; train_kl_reg_loss: 17821.6884; train_edge_recon_loss: 1345032.8081; train_cat_covariates_contrastive_loss: 635328.0029; train_gene_expr_recon_loss: 3006490.9884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5004673.5233; train_optim_loss: 5004673.5233; val_kl_reg_loss: 16766.8785; val_edge_recon_loss: 1358862.4500; val_cat_covariates_contrastive_loss: 634634.9125; val_gene_expr_recon_loss: 3041234.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5051498.8000; val_optim_loss: 5051498.8000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9422; val_auprc_score: 0.9738; val_best_acc_score: 0.9241; val_best_f1_score: 0.9517; train_kl_reg_loss: 16497.1656; train_edge_recon_loss: 1338754.1076; train_cat_covariates_contrastive_loss: 635402.8823; train_gene_expr_recon_loss: 2986029.4360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4976683.5698; train_optim_loss: 4976683.5698; val_kl_reg_loss: 15874.4682; val_edge_recon_loss: 1326388.7000; val_cat_covariates_contrastive_loss: 634692.6500; val_gene_expr_recon_loss: 3015013.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4991969.6000; val_optim_loss: 4991969.6000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9510; val_auprc_score: 0.9773; val_best_acc_score: 0.9298; val_best_f1_score: 0.9550; train_kl_reg_loss: 15430.9276; train_edge_recon_loss: 1329654.4506; train_cat_covariates_contrastive_loss: 635353.5058; train_gene_expr_recon_loss: 2964973.1570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4945412.0465; train_optim_loss: 4945412.0465; val_kl_reg_loss: 14635.5586; val_edge_recon_loss: 1338144.9000; val_cat_covariates_contrastive_loss: 635221.1375; val_gene_expr_recon_loss: 2992296.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4980297.6000; val_optim_loss: 4980297.6000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9568; val_auprc_score: 0.9803; val_best_acc_score: 0.9412; val_best_f1_score: 0.9622; train_kl_reg_loss: 14478.9036; train_edge_recon_loss: 1337338.3924; train_cat_covariates_contrastive_loss: 635215.7078; train_gene_expr_recon_loss: 2955237.9186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4942270.9070; train_optim_loss: 4942270.9070; val_kl_reg_loss: 13534.8797; val_edge_recon_loss: 1308504.8500; val_cat_covariates_contrastive_loss: 635423.8375; val_gene_expr_recon_loss: 2995026.3000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4952490.0000; val_optim_loss: 4952490.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9507; val_auprc_score: 0.9759; val_best_acc_score: 0.9384; val_best_f1_score: 0.9602; train_kl_reg_loss: 13831.7689; train_edge_recon_loss: 1320573.0320; train_cat_covariates_contrastive_loss: 635135.9099; train_gene_expr_recon_loss: 2936089.2791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4905630.0000; train_optim_loss: 4905630.0000; val_kl_reg_loss: 13537.1377; val_edge_recon_loss: 1338999.4250; val_cat_covariates_contrastive_loss: 633813.3750; val_gene_expr_recon_loss: 2967020.8500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4953370.8000; val_optim_loss: 4953370.8000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9516; val_auprc_score: 0.9765; val_best_acc_score: 0.9400; val_best_f1_score: 0.9612; train_kl_reg_loss: 13465.8074; train_edge_recon_loss: 1320878.9041; train_cat_covariates_contrastive_loss: 634546.2093; train_gene_expr_recon_loss: 2922834.1279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4891725.0698; train_optim_loss: 4891725.0698; val_kl_reg_loss: 13016.5488; val_edge_recon_loss: 1327333.3000; val_cat_covariates_contrastive_loss: 634431.4125; val_gene_expr_recon_loss: 2942027.1000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4916808.4000; val_optim_loss: 4916808.4000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9551; val_auprc_score: 0.9788; val_best_acc_score: 0.9439; val_best_f1_score: 0.9638; train_kl_reg_loss: 13160.1493; train_edge_recon_loss: 1320703.9738; train_cat_covariates_contrastive_loss: 634482.3648; train_gene_expr_recon_loss: 2914094.5930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4882441.0698; train_optim_loss: 4882441.0698; val_kl_reg_loss: 12991.3414; val_edge_recon_loss: 1326415.4500; val_cat_covariates_contrastive_loss: 632957.5250; val_gene_expr_recon_loss: 2940693.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4913058.2000; val_optim_loss: 4913058.2000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9512; val_auprc_score: 0.9756; val_best_acc_score: 0.9429; val_best_f1_score: 0.9632; train_kl_reg_loss: 12828.8451; train_edge_recon_loss: 1324300.1715; train_cat_covariates_contrastive_loss: 634231.7267; train_gene_expr_recon_loss: 2901251.0465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4872611.7674; train_optim_loss: 4872611.7674; val_kl_reg_loss: 12486.4057; val_edge_recon_loss: 1329067.1500; val_cat_covariates_contrastive_loss: 634635.5375; val_gene_expr_recon_loss: 2930990.3500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4907179.5000; val_optim_loss: 4907179.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9548; val_auprc_score: 0.9785; val_best_acc_score: 0.9438; val_best_f1_score: 0.9638; train_kl_reg_loss: 12679.2302; train_edge_recon_loss: 1318995.4622; train_cat_covariates_contrastive_loss: 634459.0480; train_gene_expr_recon_loss: 2892730.6570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4858864.3721; train_optim_loss: 4858864.3721; val_kl_reg_loss: 12563.9443; val_edge_recon_loss: 1317777.5250; val_cat_covariates_contrastive_loss: 633506.3500; val_gene_expr_recon_loss: 2916161.3000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4880009.0000; val_optim_loss: 4880009.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9568; val_auprc_score: 0.9793; val_best_acc_score: 0.9478; val_best_f1_score: 0.9661; train_kl_reg_loss: 12401.2792; train_edge_recon_loss: 1318885.2442; train_cat_covariates_contrastive_loss: 634277.1134; train_gene_expr_recon_loss: 2880750.5465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4846314.1977; train_optim_loss: 4846314.1977; val_kl_reg_loss: 12155.7182; val_edge_recon_loss: 1317302.3500; val_cat_covariates_contrastive_loss: 632796.0750; val_gene_expr_recon_loss: 2925567.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4887821.8000; val_optim_loss: 4887821.8000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9562; val_auprc_score: 0.9784; val_best_acc_score: 0.9464; val_best_f1_score: 0.9651; train_kl_reg_loss: 12274.4750; train_edge_recon_loss: 1318868.3576; train_cat_covariates_contrastive_loss: 633978.4055; train_gene_expr_recon_loss: 2869738.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4834860.0000; train_optim_loss: 4834860.0000; val_kl_reg_loss: 11762.9277; val_edge_recon_loss: 1334521.1500; val_cat_covariates_contrastive_loss: 633185.4500; val_gene_expr_recon_loss: 2878584.3000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4858053.8000; val_optim_loss: 4858053.8000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9540; val_auprc_score: 0.9775; val_best_acc_score: 0.9475; val_best_f1_score: 0.9660; train_kl_reg_loss: 12132.1323; train_edge_recon_loss: 1317194.9622; train_cat_covariates_contrastive_loss: 633920.5160; train_gene_expr_recon_loss: 2863403.5349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4826651.1279; train_optim_loss: 4826651.1279; val_kl_reg_loss: 11895.2797; val_edge_recon_loss: 1312531.0500; val_cat_covariates_contrastive_loss: 633291.4250; val_gene_expr_recon_loss: 2886989.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4844707.6000; val_optim_loss: 4844707.6000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9531; val_auprc_score: 0.9766; val_best_acc_score: 0.9460; val_best_f1_score: 0.9651; train_kl_reg_loss: 12019.8236; train_edge_recon_loss: 1310313.2616; train_cat_covariates_contrastive_loss: 633833.3270; train_gene_expr_recon_loss: 2848759.4709; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4804925.8721; train_optim_loss: 4804925.8721; val_kl_reg_loss: 11995.6865; val_edge_recon_loss: 1311711.2500; val_cat_covariates_contrastive_loss: 633204.4750; val_gene_expr_recon_loss: 2877398.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4834309.7000; val_optim_loss: 4834309.7000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9530; val_auprc_score: 0.9767; val_best_acc_score: 0.9453; val_best_f1_score: 0.9645; train_kl_reg_loss: 11880.2941; train_edge_recon_loss: 1317763.9797; train_cat_covariates_contrastive_loss: 633858.6206; train_gene_expr_recon_loss: 2843303.8314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4806806.7674; train_optim_loss: 4806806.7674; val_kl_reg_loss: 11711.6672; val_edge_recon_loss: 1338418.8750; val_cat_covariates_contrastive_loss: 632755.7250; val_gene_expr_recon_loss: 2867189.8500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4850076.1000; val_optim_loss: 4850076.1000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9548; val_auprc_score: 0.9776; val_best_acc_score: 0.9465; val_best_f1_score: 0.9653; train_kl_reg_loss: 11819.1401; train_edge_recon_loss: 1321842.7733; train_cat_covariates_contrastive_loss: 633783.9637; train_gene_expr_recon_loss: 2833870.2093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4801316.0814; train_optim_loss: 4801316.0814; val_kl_reg_loss: 11590.7053; val_edge_recon_loss: 1327028.1000; val_cat_covariates_contrastive_loss: 632375.3750; val_gene_expr_recon_loss: 2854694.4500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4825688.6000; val_optim_loss: 4825688.6000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9527; val_auprc_score: 0.9766; val_best_acc_score: 0.9491; val_best_f1_score: 0.9673; train_kl_reg_loss: 11734.9552; train_edge_recon_loss: 1320163.5756; train_cat_covariates_contrastive_loss: 633516.5363; train_gene_expr_recon_loss: 2828617.8605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4794032.9070; train_optim_loss: 4794032.9070; val_kl_reg_loss: 11466.6064; val_edge_recon_loss: 1285598.7500; val_cat_covariates_contrastive_loss: 632540.4375; val_gene_expr_recon_loss: 2859461.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4789067.3000; val_optim_loss: 4789067.3000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9571; val_auprc_score: 0.9794; val_best_acc_score: 0.9509; val_best_f1_score: 0.9683; train_kl_reg_loss: 11694.8209; train_edge_recon_loss: 1310243.2907; train_cat_covariates_contrastive_loss: 633420.2602; train_gene_expr_recon_loss: 2818372.7326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4773731.0814; train_optim_loss: 4773731.0814; val_kl_reg_loss: 11529.1820; val_edge_recon_loss: 1299552.2000; val_cat_covariates_contrastive_loss: 632625.6250; val_gene_expr_recon_loss: 2823856.5500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4767563.6000; val_optim_loss: 4767563.6000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9526; val_auprc_score: 0.9756; val_best_acc_score: 0.9479; val_best_f1_score: 0.9661; train_kl_reg_loss: 11675.5368; train_edge_recon_loss: 1311758.9942; train_cat_covariates_contrastive_loss: 633372.1773; train_gene_expr_recon_loss: 2813350.6221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4770157.3488; train_optim_loss: 4770157.3488; val_kl_reg_loss: 11443.2299; val_edge_recon_loss: 1335823.2750; val_cat_covariates_contrastive_loss: 633482.1750; val_gene_expr_recon_loss: 2872835.9000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4853584.7000; val_optim_loss: 4853584.7000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9554; val_auprc_score: 0.9786; val_best_acc_score: 0.9476; val_best_f1_score: 0.9660; train_kl_reg_loss: 11568.2960; train_edge_recon_loss: 1318766.4855; train_cat_covariates_contrastive_loss: 633156.9026; train_gene_expr_recon_loss: 2804873.8198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4768365.4767; train_optim_loss: 4768365.4767; val_kl_reg_loss: 11341.7395; val_edge_recon_loss: 1331321.8750; val_cat_covariates_contrastive_loss: 632951.3500; val_gene_expr_recon_loss: 2843253.7000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4818868.8000; val_optim_loss: 4818868.8000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9577; val_auprc_score: 0.9786; val_best_acc_score: 0.9525; val_best_f1_score: 0.9692; train_kl_reg_loss: 11524.4131; train_edge_recon_loss: 1309749.5523; train_cat_covariates_contrastive_loss: 633232.0320; train_gene_expr_recon_loss: 2793175.5291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4747681.5233; train_optim_loss: 4747681.5233; val_kl_reg_loss: 11018.2941; val_edge_recon_loss: 1298585.5750; val_cat_covariates_contrastive_loss: 632866.6375; val_gene_expr_recon_loss: 2828130.9000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4770601.4000; val_optim_loss: 4770601.4000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9543; val_auprc_score: 0.9766; val_best_acc_score: 0.9501; val_best_f1_score: 0.9676; train_kl_reg_loss: 11570.0252; train_edge_recon_loss: 1316644.4971; train_cat_covariates_contrastive_loss: 632941.0349; train_gene_expr_recon_loss: 2793016.4419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4754171.9884; train_optim_loss: 4754171.9884; val_kl_reg_loss: 11404.9717; val_edge_recon_loss: 1328040.7000; val_cat_covariates_contrastive_loss: 632213.0375; val_gene_expr_recon_loss: 2832922.7000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4804581.4000; val_optim_loss: 4804581.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9526; val_auprc_score: 0.9758; val_best_acc_score: 0.9492; val_best_f1_score: 0.9670; train_kl_reg_loss: 11553.1596; train_edge_recon_loss: 1305161.3256; train_cat_covariates_contrastive_loss: 633005.6715; train_gene_expr_recon_loss: 2788165.3837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4737885.5581; train_optim_loss: 4737885.5581; val_kl_reg_loss: 11398.0664; val_edge_recon_loss: 1322892.7250; val_cat_covariates_contrastive_loss: 632348.7750; val_gene_expr_recon_loss: 2788830.6500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4755470.3000; val_optim_loss: 4755470.3000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9572; val_auprc_score: 0.9784; val_best_acc_score: 0.9527; val_best_f1_score: 0.9693; train_kl_reg_loss: 11581.2075; train_edge_recon_loss: 1311076.7674; train_cat_covariates_contrastive_loss: 633045.5640; train_gene_expr_recon_loss: 2782155.1860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4737858.7209; train_optim_loss: 4737858.7209; val_kl_reg_loss: 11415.5451; val_edge_recon_loss: 1310607.8000; val_cat_covariates_contrastive_loss: 632458.3875; val_gene_expr_recon_loss: 2832490.1500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4786971.8000; val_optim_loss: 4786971.8000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9552; val_auprc_score: 0.9785; val_best_acc_score: 0.9508; val_best_f1_score: 0.9682; train_kl_reg_loss: 11605.3732; train_edge_recon_loss: 1312104.4535; train_cat_covariates_contrastive_loss: 633121.4855; train_gene_expr_recon_loss: 2782760.7035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4739592.0116; train_optim_loss: 4739592.0116; val_kl_reg_loss: 11389.0715; val_edge_recon_loss: 1304996.7500; val_cat_covariates_contrastive_loss: 631900.2750; val_gene_expr_recon_loss: 2826597.5500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4774883.6000; val_optim_loss: 4774883.6000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9527; val_auprc_score: 0.9755; val_best_acc_score: 0.9497; val_best_f1_score: 0.9674; train_kl_reg_loss: 11572.6307; train_edge_recon_loss: 1304836.3750; train_cat_covariates_contrastive_loss: 633312.6076; train_gene_expr_recon_loss: 2784487.4302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4734209.0465; train_optim_loss: 4734209.0465; val_kl_reg_loss: 11417.4328; val_edge_recon_loss: 1328683.4500; val_cat_covariates_contrastive_loss: 632389.0500; val_gene_expr_recon_loss: 2825361.5500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4797851.4000; val_optim_loss: 4797851.4000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9567; val_auprc_score: 0.9782; val_best_acc_score: 0.9515; val_best_f1_score: 0.9685; train_kl_reg_loss: 11585.7649; train_edge_recon_loss: 1304434.5785; train_cat_covariates_contrastive_loss: 633020.5349; train_gene_expr_recon_loss: 2788073.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4737113.9884; train_optim_loss: 4737113.9884; val_kl_reg_loss: 11355.7385; val_edge_recon_loss: 1320394.7750; val_cat_covariates_contrastive_loss: 632998.5375; val_gene_expr_recon_loss: 2825409.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4790158.6000; val_optim_loss: 4790158.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9566; val_auprc_score: 0.9782; val_best_acc_score: 0.9511; val_best_f1_score: 0.9682; train_kl_reg_loss: 11563.4425; train_edge_recon_loss: 1311244.5901; train_cat_covariates_contrastive_loss: 632978.8358; train_gene_expr_recon_loss: 2781987.2326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4737774.0930; train_optim_loss: 4737774.0930; val_kl_reg_loss: 11382.1314; val_edge_recon_loss: 1325238.6250; val_cat_covariates_contrastive_loss: 633067.2000; val_gene_expr_recon_loss: 2826090.0500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4795777.9000; val_optim_loss: 4795777.9000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9535; val_auprc_score: 0.9762; val_best_acc_score: 0.9509; val_best_f1_score: 0.9681; train_kl_reg_loss: 11570.7612; train_edge_recon_loss: 1307863.9884; train_cat_covariates_contrastive_loss: 632829.6148; train_gene_expr_recon_loss: 2780022.0756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4732286.4302; train_optim_loss: 4732286.4302; val_kl_reg_loss: 11373.1004; val_edge_recon_loss: 1325653.3000; val_cat_covariates_contrastive_loss: 633306.0875; val_gene_expr_recon_loss: 2826726.0500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4797058.5000; val_optim_loss: 4797058.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9548; val_auprc_score: 0.9782; val_best_acc_score: 0.9526; val_best_f1_score: 0.9694; train_kl_reg_loss: 11576.8762; train_edge_recon_loss: 1311543.4971; train_cat_covariates_contrastive_loss: 633187.3198; train_gene_expr_recon_loss: 2782237.2965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4738544.9884; train_optim_loss: 4738544.9884; val_kl_reg_loss: 11422.3328; val_edge_recon_loss: 1290492.2500; val_cat_covariates_contrastive_loss: 632029.3875; val_gene_expr_recon_loss: 2811276.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4745220.2000; val_optim_loss: 4745220.2000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9558; val_auprc_score: 0.9778; val_best_acc_score: 0.9505; val_best_f1_score: 0.9678; train_kl_reg_loss: 11558.5902; train_edge_recon_loss: 1310546.7936; train_cat_covariates_contrastive_loss: 633119.3939; train_gene_expr_recon_loss: 2780861.7907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4736086.6163; train_optim_loss: 4736086.6163; val_kl_reg_loss: 11420.2084; val_edge_recon_loss: 1322720.6250; val_cat_covariates_contrastive_loss: 632881.7875; val_gene_expr_recon_loss: 2820639.1000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4787661.7000; val_optim_loss: 4787661.7000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9566; val_auprc_score: 0.9783; val_best_acc_score: 0.9515; val_best_f1_score: 0.9684; train_kl_reg_loss: 11559.4915; train_edge_recon_loss: 1314342.9971; train_cat_covariates_contrastive_loss: 633284.3256; train_gene_expr_recon_loss: 2782185.3837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4741372.2209; train_optim_loss: 4741372.2209; val_kl_reg_loss: 11386.3439; val_edge_recon_loss: 1332987.1000; val_cat_covariates_contrastive_loss: 633191.3500; val_gene_expr_recon_loss: 2783999.1500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4761563.9000; val_optim_loss: 4761563.9000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9513; val_auprc_score: 0.9757; val_best_acc_score: 0.9495; val_best_f1_score: 0.9672; train_kl_reg_loss: 11584.5029; train_edge_recon_loss: 1308867.3314; train_cat_covariates_contrastive_loss: 633224.7006; train_gene_expr_recon_loss: 2779556.7267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4733233.2558; train_optim_loss: 4733233.2558; val_kl_reg_loss: 11433.9010; val_edge_recon_loss: 1319963.4750; val_cat_covariates_contrastive_loss: 633145.0125; val_gene_expr_recon_loss: 2839756.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4804299.0000; val_optim_loss: 4804299.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9556; val_auprc_score: 0.9781; val_best_acc_score: 0.9513; val_best_f1_score: 0.9683; train_kl_reg_loss: 11592.4566; train_edge_recon_loss: 1304522.7616; train_cat_covariates_contrastive_loss: 632872.2006; train_gene_expr_recon_loss: 2781903.8081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4730891.2326; train_optim_loss: 4730891.2326; val_kl_reg_loss: 11403.3582; val_edge_recon_loss: 1327333.0250; val_cat_covariates_contrastive_loss: 632225.9250; val_gene_expr_recon_loss: 2808159.9000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4779122.2000; val_optim_loss: 4779122.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9595; val_auprc_score: 0.9796; val_best_acc_score: 0.9527; val_best_f1_score: 0.9693; train_kl_reg_loss: 11600.1431; train_edge_recon_loss: 1308155.5814; train_cat_covariates_contrastive_loss: 632851.1221; train_gene_expr_recon_loss: 2786557.2267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4739164.0581; train_optim_loss: 4739164.0581; val_kl_reg_loss: 11333.4492; val_edge_recon_loss: 1327811.7750; val_cat_covariates_contrastive_loss: 633337.4875; val_gene_expr_recon_loss: 2809463.9000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4781946.5000; val_optim_loss: 4781946.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9544; val_auprc_score: 0.9776; val_best_acc_score: 0.9522; val_best_f1_score: 0.9691; train_kl_reg_loss: 11578.5833; train_edge_recon_loss: 1315936.8547; train_cat_covariates_contrastive_loss: 632949.2791; train_gene_expr_recon_loss: 2782946.9302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4743411.6395; train_optim_loss: 4743411.6395; val_kl_reg_loss: 11449.9918; val_edge_recon_loss: 1303301.9500; val_cat_covariates_contrastive_loss: 632621.9750; val_gene_expr_recon_loss: 2823870.3500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4771244.3000; val_optim_loss: 4771244.3000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9534; val_auprc_score: 0.9768; val_best_acc_score: 0.9508; val_best_f1_score: 0.9682; train_kl_reg_loss: 11574.7710; train_edge_recon_loss: 1305108.0233; train_cat_covariates_contrastive_loss: 632919.3648; train_gene_expr_recon_loss: 2784975.4302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4734577.5814; train_optim_loss: 4734577.5814; val_kl_reg_loss: 11367.3842; val_edge_recon_loss: 1319348.5750; val_cat_covariates_contrastive_loss: 632765.6250; val_gene_expr_recon_loss: 2803969.7000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4767451.3000; val_optim_loss: 4767451.3000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9547; val_auprc_score: 0.9769; val_best_acc_score: 0.9516; val_best_f1_score: 0.9686; train_kl_reg_loss: 11577.8430; train_edge_recon_loss: 1304715.6686; train_cat_covariates_contrastive_loss: 633026.3009; train_gene_expr_recon_loss: 2783849.9012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4733169.6744; train_optim_loss: 4733169.6744; val_kl_reg_loss: 11372.4324; val_edge_recon_loss: 1318978.6500; val_cat_covariates_contrastive_loss: 632708.1750; val_gene_expr_recon_loss: 2800588.3500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4763647.6000; val_optim_loss: 4763647.6000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 21 min 18 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
val AUROC score: 0.9415
val AUPRC score: 0.9693
val best accuracy score: 0.9468
val best F1 score: 0.9653
val target rna MSE score: 1.1737
val source rna MSE score: 0.1764
Val cat covariate0 mean sim diff: 0.0003
Val cat covariate1 mean sim diff: -0.0908
Duration of model training in run 6: 0 hours, 21 minutes and 28 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 25413
Number of validation nodes: 2824
Number of training edges: 174662
Number of validation edges: 19406
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8464; val_auprc_score: 0.9430; val_best_acc_score: 0.8450; val_best_f1_score: 0.9062; train_kl_reg_loss: 2873.7983; train_edge_recon_loss: 1760031.7238; train_cat_covariates_contrastive_loss: 716621.3547; train_gene_expr_recon_loss: 4007241.9709; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6486768.8256; train_optim_loss: 6486768.8256; val_kl_reg_loss: 6215.7221; val_edge_recon_loss: 1627755.1500; val_cat_covariates_contrastive_loss: 626798.2750; val_gene_expr_recon_loss: 3618966.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5879735.5000; val_optim_loss: 5879735.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8593; val_auprc_score: 0.9438; val_best_acc_score: 0.8536; val_best_f1_score: 0.9096; train_kl_reg_loss: 18971.9493; train_edge_recon_loss: 1533369.0843; train_cat_covariates_contrastive_loss: 627976.0494; train_gene_expr_recon_loss: 3417952.1512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5598269.1744; train_optim_loss: 5598269.1744; val_kl_reg_loss: 28248.9887; val_edge_recon_loss: 1513379.4750; val_cat_covariates_contrastive_loss: 626648.3375; val_gene_expr_recon_loss: 3220650.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5388927.6000; val_optim_loss: 5388927.6000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8777; val_auprc_score: 0.9530; val_best_acc_score: 0.8618; val_best_f1_score: 0.9152; train_kl_reg_loss: 26912.6798; train_edge_recon_loss: 1477508.9128; train_cat_covariates_contrastive_loss: 627148.1032; train_gene_expr_recon_loss: 3189854.8314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5321424.5116; train_optim_loss: 5321424.5116; val_kl_reg_loss: 22983.4598; val_edge_recon_loss: 1480415.8250; val_cat_covariates_contrastive_loss: 626849.1875; val_gene_expr_recon_loss: 3136366.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5266614.9000; val_optim_loss: 5266614.9000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9081; val_auprc_score: 0.9632; val_best_acc_score: 0.8672; val_best_f1_score: 0.9181; train_kl_reg_loss: 20116.9038; train_edge_recon_loss: 1453674.9128; train_cat_covariates_contrastive_loss: 628689.4535; train_gene_expr_recon_loss: 3103391.2267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5205872.5581; train_optim_loss: 5205872.5581; val_kl_reg_loss: 16832.2961; val_edge_recon_loss: 1453333.1750; val_cat_covariates_contrastive_loss: 628540.9125; val_gene_expr_recon_loss: 3066715.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5165421.4000; val_optim_loss: 5165421.4000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9351; val_auprc_score: 0.9732; val_best_acc_score: 0.9076; val_best_f1_score: 0.9410; train_kl_reg_loss: 17048.8307; train_edge_recon_loss: 1388746.7500; train_cat_covariates_contrastive_loss: 633532.4608; train_gene_expr_recon_loss: 3059152.9244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5098480.9535; train_optim_loss: 5098480.9535; val_kl_reg_loss: 18226.3770; val_edge_recon_loss: 1369598.4750; val_cat_covariates_contrastive_loss: 633491.9125; val_gene_expr_recon_loss: 3044871.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5066188.2000; val_optim_loss: 5066188.2000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9460; val_auprc_score: 0.9773; val_best_acc_score: 0.9221; val_best_f1_score: 0.9501; train_kl_reg_loss: 18056.3540; train_edge_recon_loss: 1358537.1919; train_cat_covariates_contrastive_loss: 635888.8227; train_gene_expr_recon_loss: 3025320.3198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5037802.7093; train_optim_loss: 5037802.7093; val_kl_reg_loss: 17617.9359; val_edge_recon_loss: 1344714.8250; val_cat_covariates_contrastive_loss: 635281.0375; val_gene_expr_recon_loss: 3016868.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5014482.4000; val_optim_loss: 5014482.4000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9506; val_auprc_score: 0.9784; val_best_acc_score: 0.9238; val_best_f1_score: 0.9513; train_kl_reg_loss: 17540.3015; train_edge_recon_loss: 1349671.5552; train_cat_covariates_contrastive_loss: 636553.7282; train_gene_expr_recon_loss: 3005126.2442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5008891.8372; train_optim_loss: 5008891.8372; val_kl_reg_loss: 16509.9873; val_edge_recon_loss: 1335961.0250; val_cat_covariates_contrastive_loss: 635881.0625; val_gene_expr_recon_loss: 3000891.0500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4989243.1000; val_optim_loss: 4989243.1000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9522; val_auprc_score: 0.9788; val_best_acc_score: 0.9268; val_best_f1_score: 0.9527; train_kl_reg_loss: 16483.3883; train_edge_recon_loss: 1340600.3692; train_cat_covariates_contrastive_loss: 636496.8779; train_gene_expr_recon_loss: 2983248.4302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4976829.0465; train_optim_loss: 4976829.0465; val_kl_reg_loss: 15578.2189; val_edge_recon_loss: 1346558.6500; val_cat_covariates_contrastive_loss: 636644.5500; val_gene_expr_recon_loss: 2970395.6500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4969177.1000; val_optim_loss: 4969177.1000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9522; val_auprc_score: 0.9781; val_best_acc_score: 0.9300; val_best_f1_score: 0.9548; train_kl_reg_loss: 15464.8393; train_edge_recon_loss: 1335989.6686; train_cat_covariates_contrastive_loss: 636064.3619; train_gene_expr_recon_loss: 2966980.0174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4954498.8721; train_optim_loss: 4954498.8721; val_kl_reg_loss: 14769.2691; val_edge_recon_loss: 1342988.9500; val_cat_covariates_contrastive_loss: 635687.5750; val_gene_expr_recon_loss: 2952046.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4945492.4000; val_optim_loss: 4945492.4000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9559; val_auprc_score: 0.9792; val_best_acc_score: 0.9351; val_best_f1_score: 0.9579; train_kl_reg_loss: 14558.8861; train_edge_recon_loss: 1332837.2122; train_cat_covariates_contrastive_loss: 635981.6701; train_gene_expr_recon_loss: 2948478.2674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4931856.0349; train_optim_loss: 4931856.0349; val_kl_reg_loss: 14002.8770; val_edge_recon_loss: 1357811.6750; val_cat_covariates_contrastive_loss: 634514.3125; val_gene_expr_recon_loss: 2933930.9500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4940259.9000; val_optim_loss: 4940259.9000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9576; val_auprc_score: 0.9807; val_best_acc_score: 0.9361; val_best_f1_score: 0.9586; train_kl_reg_loss: 13864.8551; train_edge_recon_loss: 1325018.4942; train_cat_covariates_contrastive_loss: 635981.9273; train_gene_expr_recon_loss: 2937064.4186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4911929.6744; train_optim_loss: 4911929.6744; val_kl_reg_loss: 13467.4813; val_edge_recon_loss: 1343610.0250; val_cat_covariates_contrastive_loss: 634849.6750; val_gene_expr_recon_loss: 2913648.9500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4905576.0000; val_optim_loss: 4905576.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9544; val_auprc_score: 0.9778; val_best_acc_score: 0.9377; val_best_f1_score: 0.9597; train_kl_reg_loss: 13378.8422; train_edge_recon_loss: 1316030.2587; train_cat_covariates_contrastive_loss: 634839.5610; train_gene_expr_recon_loss: 2924827.8837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4889076.5116; train_optim_loss: 4889076.5116; val_kl_reg_loss: 12854.3506; val_edge_recon_loss: 1337067.3750; val_cat_covariates_contrastive_loss: 635087.8375; val_gene_expr_recon_loss: 2893904.3500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4878914.0000; val_optim_loss: 4878914.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9552; val_auprc_score: 0.9784; val_best_acc_score: 0.9415; val_best_f1_score: 0.9621; train_kl_reg_loss: 13027.3150; train_edge_recon_loss: 1313677.8343; train_cat_covariates_contrastive_loss: 634808.0233; train_gene_expr_recon_loss: 2905830.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4867343.6047; train_optim_loss: 4867343.6047; val_kl_reg_loss: 12835.7020; val_edge_recon_loss: 1331420.3000; val_cat_covariates_contrastive_loss: 633596.1750; val_gene_expr_recon_loss: 2887628.6500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4865480.9000; val_optim_loss: 4865480.9000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9587; val_auprc_score: 0.9803; val_best_acc_score: 0.9424; val_best_f1_score: 0.9627; train_kl_reg_loss: 12813.8893; train_edge_recon_loss: 1319285.5233; train_cat_covariates_contrastive_loss: 634678.7078; train_gene_expr_recon_loss: 2898989.5814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4865767.7093; train_optim_loss: 4865767.7093; val_kl_reg_loss: 12449.8336; val_edge_recon_loss: 1328652.7750; val_cat_covariates_contrastive_loss: 634055.2500; val_gene_expr_recon_loss: 2883551.1000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4858708.8000; val_optim_loss: 4858708.8000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9534; val_auprc_score: 0.9779; val_best_acc_score: 0.9423; val_best_f1_score: 0.9629; train_kl_reg_loss: 12575.8622; train_edge_recon_loss: 1315742.5581; train_cat_covariates_contrastive_loss: 634643.2122; train_gene_expr_recon_loss: 2885894.8663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4848856.4419; train_optim_loss: 4848856.4419; val_kl_reg_loss: 12457.7740; val_edge_recon_loss: 1321253.3500; val_cat_covariates_contrastive_loss: 634466.0000; val_gene_expr_recon_loss: 2874074.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4842251.7000; val_optim_loss: 4842251.7000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9570; val_auprc_score: 0.9799; val_best_acc_score: 0.9441; val_best_f1_score: 0.9641; train_kl_reg_loss: 12386.8133; train_edge_recon_loss: 1313358.2820; train_cat_covariates_contrastive_loss: 634498.2006; train_gene_expr_recon_loss: 2873930.8953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4834174.1860; train_optim_loss: 4834174.1860; val_kl_reg_loss: 12224.7367; val_edge_recon_loss: 1293103.1000; val_cat_covariates_contrastive_loss: 634053.5875; val_gene_expr_recon_loss: 2872824.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4812206.2000; val_optim_loss: 4812206.2000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9575; val_auprc_score: 0.9797; val_best_acc_score: 0.9429; val_best_f1_score: 0.9628; train_kl_reg_loss: 12281.4767; train_edge_recon_loss: 1318844.1628; train_cat_covariates_contrastive_loss: 634446.1875; train_gene_expr_recon_loss: 2869246.1105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4834817.9302; train_optim_loss: 4834817.9302; val_kl_reg_loss: 11882.8482; val_edge_recon_loss: 1325177.3000; val_cat_covariates_contrastive_loss: 633598.5500; val_gene_expr_recon_loss: 2861067.3000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4831726.0000; val_optim_loss: 4831726.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9538; val_auprc_score: 0.9775; val_best_acc_score: 0.9447; val_best_f1_score: 0.9643; train_kl_reg_loss: 12091.9760; train_edge_recon_loss: 1313612.4186; train_cat_covariates_contrastive_loss: 634483.4695; train_gene_expr_recon_loss: 2858213.0291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4818400.8953; train_optim_loss: 4818400.8953; val_kl_reg_loss: 11767.1854; val_edge_recon_loss: 1314602.5250; val_cat_covariates_contrastive_loss: 633666.5250; val_gene_expr_recon_loss: 2853126.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4813163.0000; val_optim_loss: 4813163.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9577; val_auprc_score: 0.9799; val_best_acc_score: 0.9453; val_best_f1_score: 0.9648; train_kl_reg_loss: 11972.6592; train_edge_recon_loss: 1313013.0291; train_cat_covariates_contrastive_loss: 634291.4753; train_gene_expr_recon_loss: 2851616.8721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4810894.0814; train_optim_loss: 4810894.0814; val_kl_reg_loss: 11722.9475; val_edge_recon_loss: 1312837.9750; val_cat_covariates_contrastive_loss: 633578.1125; val_gene_expr_recon_loss: 2832165.1000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4790304.1000; val_optim_loss: 4790304.1000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9552; val_auprc_score: 0.9781; val_best_acc_score: 0.9464; val_best_f1_score: 0.9654; train_kl_reg_loss: 11868.5887; train_edge_recon_loss: 1324032.9826; train_cat_covariates_contrastive_loss: 634065.0843; train_gene_expr_recon_loss: 2839825.3605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4809792.0233; train_optim_loss: 4809792.0233; val_kl_reg_loss: 11825.5359; val_edge_recon_loss: 1310764.2250; val_cat_covariates_contrastive_loss: 632971.6000; val_gene_expr_recon_loss: 2826943.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4782505.2000; val_optim_loss: 4782505.2000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9560; val_auprc_score: 0.9779; val_best_acc_score: 0.9466; val_best_f1_score: 0.9654; train_kl_reg_loss: 11835.0678; train_edge_recon_loss: 1321317.0320; train_cat_covariates_contrastive_loss: 633951.6497; train_gene_expr_recon_loss: 2830049.4593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4797153.1628; train_optim_loss: 4797153.1628; val_kl_reg_loss: 11526.8014; val_edge_recon_loss: 1319602.6500; val_cat_covariates_contrastive_loss: 633599.3375; val_gene_expr_recon_loss: 2820476.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4785205.3000; val_optim_loss: 4785205.3000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9579; val_auprc_score: 0.9792; val_best_acc_score: 0.9489; val_best_f1_score: 0.9671; train_kl_reg_loss: 11729.1882; train_edge_recon_loss: 1314556.3401; train_cat_covariates_contrastive_loss: 633837.0422; train_gene_expr_recon_loss: 2823745.2674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4783867.8140; train_optim_loss: 4783867.8140; val_kl_reg_loss: 11546.7922; val_edge_recon_loss: 1299940.8750; val_cat_covariates_contrastive_loss: 633243.2250; val_gene_expr_recon_loss: 2797150.3000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4741881.1000; val_optim_loss: 4741881.1000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9586; val_auprc_score: 0.9803; val_best_acc_score: 0.9491; val_best_f1_score: 0.9669; train_kl_reg_loss: 11694.4566; train_edge_recon_loss: 1317123.0727; train_cat_covariates_contrastive_loss: 633869.7151; train_gene_expr_recon_loss: 2816449.6279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4779136.8488; train_optim_loss: 4779136.8488; val_kl_reg_loss: 11639.9395; val_edge_recon_loss: 1325731.6000; val_cat_covariates_contrastive_loss: 632509.5750; val_gene_expr_recon_loss: 2832209.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4802090.4000; val_optim_loss: 4802090.4000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9547; val_auprc_score: 0.9775; val_best_acc_score: 0.9464; val_best_f1_score: 0.9653; train_kl_reg_loss: 11636.8822; train_edge_recon_loss: 1311864.3023; train_cat_covariates_contrastive_loss: 633680.4753; train_gene_expr_recon_loss: 2808979.1977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4766160.8721; train_optim_loss: 4766160.8721; val_kl_reg_loss: 11421.3836; val_edge_recon_loss: 1327323.7000; val_cat_covariates_contrastive_loss: 632749.9000; val_gene_expr_recon_loss: 2798704.4500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4770199.4000; val_optim_loss: 4770199.4000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9581; val_auprc_score: 0.9786; val_best_acc_score: 0.9485; val_best_f1_score: 0.9666; train_kl_reg_loss: 11584.5227; train_edge_recon_loss: 1312067.2064; train_cat_covariates_contrastive_loss: 633453.9346; train_gene_expr_recon_loss: 2804250.0291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4761355.6860; train_optim_loss: 4761355.6860; val_kl_reg_loss: 11325.0357; val_edge_recon_loss: 1326696.7000; val_cat_covariates_contrastive_loss: 633093.3750; val_gene_expr_recon_loss: 2783757.5500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4754872.7000; val_optim_loss: 4754872.7000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9548; val_auprc_score: 0.9775; val_best_acc_score: 0.9498; val_best_f1_score: 0.9675; train_kl_reg_loss: 11565.2736; train_edge_recon_loss: 1313995.8663; train_cat_covariates_contrastive_loss: 633334.3227; train_gene_expr_recon_loss: 2797907.1337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4756802.6047; train_optim_loss: 4756802.6047; val_kl_reg_loss: 11531.7496; val_edge_recon_loss: 1323507.4750; val_cat_covariates_contrastive_loss: 632854.2625; val_gene_expr_recon_loss: 2794783.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4762677.0000; val_optim_loss: 4762677.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9552; val_auprc_score: 0.9784; val_best_acc_score: 0.9495; val_best_f1_score: 0.9672; train_kl_reg_loss: 11525.2324; train_edge_recon_loss: 1307901.8343; train_cat_covariates_contrastive_loss: 633245.6599; train_gene_expr_recon_loss: 2786161.6860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4738834.3721; train_optim_loss: 4738834.3721; val_kl_reg_loss: 11353.0104; val_edge_recon_loss: 1313732.1500; val_cat_covariates_contrastive_loss: 632855.3250; val_gene_expr_recon_loss: 2805906.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4763847.0000; val_optim_loss: 4763847.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9529; val_auprc_score: 0.9772; val_best_acc_score: 0.9455; val_best_f1_score: 0.9646; train_kl_reg_loss: 11498.8325; train_edge_recon_loss: 1317919.9186; train_cat_covariates_contrastive_loss: 633390.8924; train_gene_expr_recon_loss: 2788308.9593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4751118.5930; train_optim_loss: 4751118.5930; val_kl_reg_loss: 11353.1328; val_edge_recon_loss: 1337603.9500; val_cat_covariates_contrastive_loss: 632482.6000; val_gene_expr_recon_loss: 2787561.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4769001.0000; val_optim_loss: 4769001.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9570; val_auprc_score: 0.9791; val_best_acc_score: 0.9500; val_best_f1_score: 0.9677; train_kl_reg_loss: 11521.7437; train_edge_recon_loss: 1318546.9797; train_cat_covariates_contrastive_loss: 633446.4869; train_gene_expr_recon_loss: 2789024.3547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4752539.5930; train_optim_loss: 4752539.5930; val_kl_reg_loss: 11392.6107; val_edge_recon_loss: 1306672.9250; val_cat_covariates_contrastive_loss: 632587.6000; val_gene_expr_recon_loss: 2788174.3500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4738827.4000; val_optim_loss: 4738827.4000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9532; val_auprc_score: 0.9774; val_best_acc_score: 0.9472; val_best_f1_score: 0.9658; train_kl_reg_loss: 11538.3026; train_edge_recon_loss: 1315875.9564; train_cat_covariates_contrastive_loss: 633346.9157; train_gene_expr_recon_loss: 2786540.2791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4747301.4535; train_optim_loss: 4747301.4535; val_kl_reg_loss: 11397.7000; val_edge_recon_loss: 1323561.8000; val_cat_covariates_contrastive_loss: 632454.7625; val_gene_expr_recon_loss: 2772949.7000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4740363.8000; val_optim_loss: 4740363.8000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9540; val_auprc_score: 0.9772; val_best_acc_score: 0.9490; val_best_f1_score: 0.9669; train_kl_reg_loss: 11516.9828; train_edge_recon_loss: 1312500.5116; train_cat_covariates_contrastive_loss: 633421.4549; train_gene_expr_recon_loss: 2785726.3081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4743165.2558; train_optim_loss: 4743165.2558; val_kl_reg_loss: 11445.1895; val_edge_recon_loss: 1328051.3250; val_cat_covariates_contrastive_loss: 632535.9750; val_gene_expr_recon_loss: 2793545.6500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4765578.1000; val_optim_loss: 4765578.1000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9562; val_auprc_score: 0.9782; val_best_acc_score: 0.9495; val_best_f1_score: 0.9673; train_kl_reg_loss: 11480.8467; train_edge_recon_loss: 1306835.4302; train_cat_covariates_contrastive_loss: 633421.0058; train_gene_expr_recon_loss: 2787754.8663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4739492.1744; train_optim_loss: 4739492.1744; val_kl_reg_loss: 11368.7529; val_edge_recon_loss: 1323867.3500; val_cat_covariates_contrastive_loss: 633213.0000; val_gene_expr_recon_loss: 2761819.7000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4730268.8000; val_optim_loss: 4730268.8000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9547; val_auprc_score: 0.9782; val_best_acc_score: 0.9473; val_best_f1_score: 0.9660; train_kl_reg_loss: 11496.3704; train_edge_recon_loss: 1315874.3169; train_cat_covariates_contrastive_loss: 633395.5203; train_gene_expr_recon_loss: 2786841.6686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4747607.9302; train_optim_loss: 4747607.9302; val_kl_reg_loss: 11347.9590; val_edge_recon_loss: 1318638.0000; val_cat_covariates_contrastive_loss: 633055.3250; val_gene_expr_recon_loss: 2784150.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4747191.9000; val_optim_loss: 4747191.9000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9548; val_auprc_score: 0.9781; val_best_acc_score: 0.9489; val_best_f1_score: 0.9669; train_kl_reg_loss: 11440.1579; train_edge_recon_loss: 1308632.8750; train_cat_covariates_contrastive_loss: 633253.5247; train_gene_expr_recon_loss: 2785180.7849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4738507.3023; train_optim_loss: 4738507.3023; val_kl_reg_loss: 11282.7469; val_edge_recon_loss: 1323371.5500; val_cat_covariates_contrastive_loss: 632467.4375; val_gene_expr_recon_loss: 2818765.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4785887.3000; val_optim_loss: 4785887.3000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9552; val_auprc_score: 0.9773; val_best_acc_score: 0.9502; val_best_f1_score: 0.9677; train_kl_reg_loss: 11484.2518; train_edge_recon_loss: 1310838.9680; train_cat_covariates_contrastive_loss: 633400.2413; train_gene_expr_recon_loss: 2781771.6570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4737495.0930; train_optim_loss: 4737495.0930; val_kl_reg_loss: 11308.8717; val_edge_recon_loss: 1312604.7500; val_cat_covariates_contrastive_loss: 631662.1750; val_gene_expr_recon_loss: 2767362.9500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4722938.7000; val_optim_loss: 4722938.7000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9584; val_auprc_score: 0.9796; val_best_acc_score: 0.9521; val_best_f1_score: 0.9688; train_kl_reg_loss: 11492.4837; train_edge_recon_loss: 1311024.5000; train_cat_covariates_contrastive_loss: 633386.4084; train_gene_expr_recon_loss: 2781482.8372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4737386.2442; train_optim_loss: 4737386.2442; val_kl_reg_loss: 11344.5752; val_edge_recon_loss: 1314571.6500; val_cat_covariates_contrastive_loss: 632436.1125; val_gene_expr_recon_loss: 2779407.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4737759.7000; val_optim_loss: 4737759.7000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9549; val_auprc_score: 0.9770; val_best_acc_score: 0.9482; val_best_f1_score: 0.9663; train_kl_reg_loss: 11491.9842; train_edge_recon_loss: 1305830.6831; train_cat_covariates_contrastive_loss: 633380.6977; train_gene_expr_recon_loss: 2783256.7267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4733960.0814; train_optim_loss: 4733960.0814; val_kl_reg_loss: 11266.4678; val_edge_recon_loss: 1330898.0000; val_cat_covariates_contrastive_loss: 632108.8125; val_gene_expr_recon_loss: 2776239.8500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4750513.1000; val_optim_loss: 4750513.1000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9533; val_auprc_score: 0.9774; val_best_acc_score: 0.9496; val_best_f1_score: 0.9674; train_kl_reg_loss: 11451.4819; train_edge_recon_loss: 1313295.6599; train_cat_covariates_contrastive_loss: 633203.2980; train_gene_expr_recon_loss: 2783047.6395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4740998.0930; train_optim_loss: 4740998.0930; val_kl_reg_loss: 11303.0990; val_edge_recon_loss: 1313919.8750; val_cat_covariates_contrastive_loss: 632723.9125; val_gene_expr_recon_loss: 2764405.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4722352.2000; val_optim_loss: 4722352.2000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9584; val_auprc_score: 0.9796; val_best_acc_score: 0.9491; val_best_f1_score: 0.9670; train_kl_reg_loss: 11443.9685; train_edge_recon_loss: 1313592.1541; train_cat_covariates_contrastive_loss: 633428.2791; train_gene_expr_recon_loss: 2780981.6802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4739446.1395; train_optim_loss: 4739446.1395; val_kl_reg_loss: 11354.2131; val_edge_recon_loss: 1320224.3750; val_cat_covariates_contrastive_loss: 632722.1750; val_gene_expr_recon_loss: 2783355.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4747655.9000; val_optim_loss: 4747655.9000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9580; val_auprc_score: 0.9796; val_best_acc_score: 0.9512; val_best_f1_score: 0.9685; train_kl_reg_loss: 11446.7502; train_edge_recon_loss: 1311022.0058; train_cat_covariates_contrastive_loss: 633426.0828; train_gene_expr_recon_loss: 2780050.9884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4735945.8372; train_optim_loss: 4735945.8372; val_kl_reg_loss: 11227.3715; val_edge_recon_loss: 1306351.0750; val_cat_covariates_contrastive_loss: 632403.5750; val_gene_expr_recon_loss: 2765833.0500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4715815.0000; val_optim_loss: 4715815.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9531; val_auprc_score: 0.9767; val_best_acc_score: 0.9494; val_best_f1_score: 0.9672; train_kl_reg_loss: 11429.1721; train_edge_recon_loss: 1310709.3052; train_cat_covariates_contrastive_loss: 633295.4506; train_gene_expr_recon_loss: 2779600.9477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4735034.9302; train_optim_loss: 4735034.9302; val_kl_reg_loss: 11304.9607; val_edge_recon_loss: 1326043.1750; val_cat_covariates_contrastive_loss: 633203.6750; val_gene_expr_recon_loss: 2816265.4500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4786817.3000; val_optim_loss: 4786817.3000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9565; val_auprc_score: 0.9780; val_best_acc_score: 0.9517; val_best_f1_score: 0.9687; train_kl_reg_loss: 11446.8012; train_edge_recon_loss: 1316161.8110; train_cat_covariates_contrastive_loss: 633317.5392; train_gene_expr_recon_loss: 2779516.7384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4740442.9070; train_optim_loss: 4740442.9070; val_kl_reg_loss: 11387.3342; val_edge_recon_loss: 1314323.9250; val_cat_covariates_contrastive_loss: 632893.7750; val_gene_expr_recon_loss: 2802811.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4761416.8000; val_optim_loss: 4761416.8000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9547; val_auprc_score: 0.9771; val_best_acc_score: 0.9497; val_best_f1_score: 0.9674; train_kl_reg_loss: 11444.3377; train_edge_recon_loss: 1308013.3314; train_cat_covariates_contrastive_loss: 632979.8430; train_gene_expr_recon_loss: 2776681.7791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4729119.2907; train_optim_loss: 4729119.2907; val_kl_reg_loss: 11291.6734; val_edge_recon_loss: 1317953.2000; val_cat_covariates_contrastive_loss: 632763.9500; val_gene_expr_recon_loss: 2779995.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4742004.0000; val_optim_loss: 4742004.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9556; val_auprc_score: 0.9785; val_best_acc_score: 0.9499; val_best_f1_score: 0.9676; train_kl_reg_loss: 11389.2119; train_edge_recon_loss: 1311106.6977; train_cat_covariates_contrastive_loss: 633425.7369; train_gene_expr_recon_loss: 2776249.5814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4732171.2209; train_optim_loss: 4732171.2209; val_kl_reg_loss: 11180.8252; val_edge_recon_loss: 1316943.4250; val_cat_covariates_contrastive_loss: 632968.5625; val_gene_expr_recon_loss: 2788473.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4749565.7000; val_optim_loss: 4749565.7000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9577; val_auprc_score: 0.9797; val_best_acc_score: 0.9507; val_best_f1_score: 0.9681; train_kl_reg_loss: 11376.3494; train_edge_recon_loss: 1306292.2500; train_cat_covariates_contrastive_loss: 633093.0799; train_gene_expr_recon_loss: 2775206.6163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4725968.3372; train_optim_loss: 4725968.3372; val_kl_reg_loss: 11309.5639; val_edge_recon_loss: 1312776.7500; val_cat_covariates_contrastive_loss: 632877.2375; val_gene_expr_recon_loss: 2790934.6500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4747898.1000; val_optim_loss: 4747898.1000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9585; val_auprc_score: 0.9795; val_best_acc_score: 0.9527; val_best_f1_score: 0.9693; train_kl_reg_loss: 11410.8021; train_edge_recon_loss: 1306199.1570; train_cat_covariates_contrastive_loss: 633266.7020; train_gene_expr_recon_loss: 2777947.4942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4728824.1395; train_optim_loss: 4728824.1395; val_kl_reg_loss: 11290.0672; val_edge_recon_loss: 1310613.2250; val_cat_covariates_contrastive_loss: 633603.8625; val_gene_expr_recon_loss: 2769998.6500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4725505.8000; val_optim_loss: 4725505.8000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9591; val_auprc_score: 0.9793; val_best_acc_score: 0.9534; val_best_f1_score: 0.9697; train_kl_reg_loss: 11396.5844; train_edge_recon_loss: 1313778.8721; train_cat_covariates_contrastive_loss: 633214.5233; train_gene_expr_recon_loss: 2774583.3198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4732973.2791; train_optim_loss: 4732973.2791; val_kl_reg_loss: 11276.2391; val_edge_recon_loss: 1315669.2750; val_cat_covariates_contrastive_loss: 633354.8250; val_gene_expr_recon_loss: 2806413.9000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4766714.2000; val_optim_loss: 4766714.2000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9590; val_auprc_score: 0.9798; val_best_acc_score: 0.9511; val_best_f1_score: 0.9683; train_kl_reg_loss: 11421.0953; train_edge_recon_loss: 1313109.6424; train_cat_covariates_contrastive_loss: 633407.0320; train_gene_expr_recon_loss: 2779683.9884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4737621.7558; train_optim_loss: 4737621.7558; val_kl_reg_loss: 11295.3242; val_edge_recon_loss: 1313774.5000; val_cat_covariates_contrastive_loss: 632427.2500; val_gene_expr_recon_loss: 2782526.3000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4740023.3000; val_optim_loss: 4740023.3000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 24 min 1 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
val AUROC score: 0.9386
val AUPRC score: 0.9677
val best accuracy score: 0.9434
val best F1 score: 0.9632
val target rna MSE score: 1.0865
val source rna MSE score: 0.1661
Val cat covariate0 mean sim diff: -0.0007
Val cat covariate1 mean sim diff: -0.0866
Duration of model training in run 5: 0 hours, 24 minutes and 11 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 25413
Number of validation nodes: 2824
Number of training edges: 117816
Number of validation edges: 13090
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8687; val_auprc_score: 0.9496; val_best_acc_score: 0.8502; val_best_f1_score: 0.9078; train_kl_reg_loss: 3002.1359; train_edge_recon_loss: 1820253.0862; train_cat_covariates_contrastive_loss: 741491.9203; train_gene_expr_recon_loss: 4002888.8534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6567636.0000; train_optim_loss: 6567636.0000; val_kl_reg_loss: 4513.4008; val_edge_recon_loss: 1736339.0625; val_cat_covariates_contrastive_loss: 627215.3750; val_gene_expr_recon_loss: 3689657.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6057725.7500; val_optim_loss: 6057725.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8474; val_auprc_score: 0.9409; val_best_acc_score: 0.8420; val_best_f1_score: 0.9035; train_kl_reg_loss: 14767.5204; train_edge_recon_loss: 1586452.7414; train_cat_covariates_contrastive_loss: 631848.4591; train_gene_expr_recon_loss: 3536153.3276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5769222.0862; train_optim_loss: 5769222.0862; val_kl_reg_loss: 28049.4536; val_edge_recon_loss: 1571974.4062; val_cat_covariates_contrastive_loss: 626675.3750; val_gene_expr_recon_loss: 3342847.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5569546.6250; val_optim_loss: 5569546.6250
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8665; val_auprc_score: 0.9477; val_best_acc_score: 0.8593; val_best_f1_score: 0.9138; train_kl_reg_loss: 31957.2231; train_edge_recon_loss: 1498234.6552; train_cat_covariates_contrastive_loss: 627090.4957; train_gene_expr_recon_loss: 3267807.6810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5425090.0000; train_optim_loss: 5425090.0000; val_kl_reg_loss: 31318.1567; val_edge_recon_loss: 1479225.6875; val_cat_covariates_contrastive_loss: 626764.7188; val_gene_expr_recon_loss: 3186850.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5324158.6250; val_optim_loss: 5324158.6250
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8832; val_auprc_score: 0.9541; val_best_acc_score: 0.8632; val_best_f1_score: 0.9158; train_kl_reg_loss: 26618.2854; train_edge_recon_loss: 1469597.7371; train_cat_covariates_contrastive_loss: 627702.8168; train_gene_expr_recon_loss: 3144816.5776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5268735.4138; train_optim_loss: 5268735.4138; val_kl_reg_loss: 22704.1621; val_edge_recon_loss: 1456872.4375; val_cat_covariates_contrastive_loss: 627282.8125; val_gene_expr_recon_loss: 3118441.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5225300.2500; val_optim_loss: 5225300.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9089; val_auprc_score: 0.9616; val_best_acc_score: 0.8805; val_best_f1_score: 0.9236; train_kl_reg_loss: 21049.6709; train_edge_recon_loss: 1427222.2543; train_cat_covariates_contrastive_loss: 629609.8168; train_gene_expr_recon_loss: 3086689.7931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5164571.5862; train_optim_loss: 5164571.5862; val_kl_reg_loss: 19067.4717; val_edge_recon_loss: 1458434.3125; val_cat_covariates_contrastive_loss: 630317.7812; val_gene_expr_recon_loss: 3050496.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5158316.0000; val_optim_loss: 5158316.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9284; val_auprc_score: 0.9698; val_best_acc_score: 0.8999; val_best_f1_score: 0.9359; train_kl_reg_loss: 19133.9515; train_edge_recon_loss: 1377748.8491; train_cat_covariates_contrastive_loss: 633623.3103; train_gene_expr_recon_loss: 3049042.8793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5079548.9655; train_optim_loss: 5079548.9655; val_kl_reg_loss: 18828.2114; val_edge_recon_loss: 1396552.2188; val_cat_covariates_contrastive_loss: 634492.4375; val_gene_expr_recon_loss: 3017197.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5067070.7500; val_optim_loss: 5067070.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9303; val_auprc_score: 0.9688; val_best_acc_score: 0.9086; val_best_f1_score: 0.9416; train_kl_reg_loss: 19048.2083; train_edge_recon_loss: 1374672.5172; train_cat_covariates_contrastive_loss: 635784.5647; train_gene_expr_recon_loss: 3017639.9397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5047145.2414; train_optim_loss: 5047145.2414; val_kl_reg_loss: 19056.4102; val_edge_recon_loss: 1368394.0938; val_cat_covariates_contrastive_loss: 634575.2812; val_gene_expr_recon_loss: 3013784.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5035809.7500; val_optim_loss: 5035809.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9368; val_auprc_score: 0.9715; val_best_acc_score: 0.9110; val_best_f1_score: 0.9428; train_kl_reg_loss: 18943.7454; train_edge_recon_loss: 1356889.2328; train_cat_covariates_contrastive_loss: 636190.6013; train_gene_expr_recon_loss: 2997257.6552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5009281.2759; train_optim_loss: 5009281.2759; val_kl_reg_loss: 18584.1792; val_edge_recon_loss: 1379587.0625; val_cat_covariates_contrastive_loss: 635332.0312; val_gene_expr_recon_loss: 2973857.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5007360.8750; val_optim_loss: 5007360.8750
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9346; val_auprc_score: 0.9720; val_best_acc_score: 0.9114; val_best_f1_score: 0.9444; train_kl_reg_loss: 17981.9874; train_edge_recon_loss: 1347722.5086; train_cat_covariates_contrastive_loss: 635422.7069; train_gene_expr_recon_loss: 2982183.7759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4983311.0345; train_optim_loss: 4983311.0345; val_kl_reg_loss: 17267.9897; val_edge_recon_loss: 1336924.6250; val_cat_covariates_contrastive_loss: 634608.1094; val_gene_expr_recon_loss: 2959515.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4948316.7500; val_optim_loss: 4948316.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9410; val_auprc_score: 0.9750; val_best_acc_score: 0.9174; val_best_f1_score: 0.9474; train_kl_reg_loss: 16939.8559; train_edge_recon_loss: 1348376.8750; train_cat_covariates_contrastive_loss: 635438.9181; train_gene_expr_recon_loss: 2968300.0086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4969055.6207; train_optim_loss: 4969055.6207; val_kl_reg_loss: 16147.6213; val_edge_recon_loss: 1336744.3125; val_cat_covariates_contrastive_loss: 635566.2969; val_gene_expr_recon_loss: 2961109.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4949567.7500; val_optim_loss: 4949567.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9413; val_auprc_score: 0.9732; val_best_acc_score: 0.9165; val_best_f1_score: 0.9467; train_kl_reg_loss: 15883.5167; train_edge_recon_loss: 1332506.1767; train_cat_covariates_contrastive_loss: 636056.7155; train_gene_expr_recon_loss: 2955539.7069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4939986.0862; train_optim_loss: 4939986.0862; val_kl_reg_loss: 15443.6719; val_edge_recon_loss: 1361687.5000; val_cat_covariates_contrastive_loss: 634318.0312; val_gene_expr_recon_loss: 2945482.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4956931.3750; val_optim_loss: 4956931.3750
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9470; val_auprc_score: 0.9744; val_best_acc_score: 0.9294; val_best_f1_score: 0.9542; train_kl_reg_loss: 14946.7043; train_edge_recon_loss: 1324554.6552; train_cat_covariates_contrastive_loss: 635581.7198; train_gene_expr_recon_loss: 2942581.2241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4917664.2586; train_optim_loss: 4917664.2586; val_kl_reg_loss: 14494.1729; val_edge_recon_loss: 1338195.5938; val_cat_covariates_contrastive_loss: 634850.2969; val_gene_expr_recon_loss: 2936140.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4923680.0000; val_optim_loss: 4923680.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9526; val_auprc_score: 0.9772; val_best_acc_score: 0.9364; val_best_f1_score: 0.9592; train_kl_reg_loss: 14316.7572; train_edge_recon_loss: 1320991.5517; train_cat_covariates_contrastive_loss: 635150.3793; train_gene_expr_recon_loss: 2934873.0776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4905331.7759; train_optim_loss: 4905331.7759; val_kl_reg_loss: 13735.2988; val_edge_recon_loss: 1333496.3438; val_cat_covariates_contrastive_loss: 634244.0000; val_gene_expr_recon_loss: 2929340.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4910816.3750; val_optim_loss: 4910816.3750
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9527; val_auprc_score: 0.9785; val_best_acc_score: 0.9359; val_best_f1_score: 0.9587; train_kl_reg_loss: 13886.7479; train_edge_recon_loss: 1317279.6897; train_cat_covariates_contrastive_loss: 635373.9547; train_gene_expr_recon_loss: 2924484.3534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4891024.7586; train_optim_loss: 4891024.7586; val_kl_reg_loss: 13595.7827; val_edge_recon_loss: 1334025.9375; val_cat_covariates_contrastive_loss: 634811.4688; val_gene_expr_recon_loss: 2911764.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4894197.7500; val_optim_loss: 4894197.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9528; val_auprc_score: 0.9774; val_best_acc_score: 0.9384; val_best_f1_score: 0.9602; train_kl_reg_loss: 13579.3757; train_edge_recon_loss: 1316763.8621; train_cat_covariates_contrastive_loss: 634384.4310; train_gene_expr_recon_loss: 2912977.5862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4877705.3103; train_optim_loss: 4877705.3103; val_kl_reg_loss: 13588.0723; val_edge_recon_loss: 1318321.0000; val_cat_covariates_contrastive_loss: 633798.5781; val_gene_expr_recon_loss: 2905299.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4871007.3750; val_optim_loss: 4871007.3750
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9525; val_auprc_score: 0.9770; val_best_acc_score: 0.9398; val_best_f1_score: 0.9611; train_kl_reg_loss: 13440.8701; train_edge_recon_loss: 1318563.4138; train_cat_covariates_contrastive_loss: 635095.7457; train_gene_expr_recon_loss: 2904489.1121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4871589.1034; train_optim_loss: 4871589.1034; val_kl_reg_loss: 13056.4639; val_edge_recon_loss: 1309740.0625; val_cat_covariates_contrastive_loss: 633207.5938; val_gene_expr_recon_loss: 2883838.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4839842.3750; val_optim_loss: 4839842.3750
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9543; val_auprc_score: 0.9780; val_best_acc_score: 0.9403; val_best_f1_score: 0.9616; train_kl_reg_loss: 13206.9429; train_edge_recon_loss: 1316029.5216; train_cat_covariates_contrastive_loss: 634150.9397; train_gene_expr_recon_loss: 2896943.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4860331.1724; train_optim_loss: 4860331.1724; val_kl_reg_loss: 12947.2983; val_edge_recon_loss: 1334249.2500; val_cat_covariates_contrastive_loss: 633471.9219; val_gene_expr_recon_loss: 2889392.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4870060.6250; val_optim_loss: 4870060.6250
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9529; val_auprc_score: 0.9762; val_best_acc_score: 0.9407; val_best_f1_score: 0.9614; train_kl_reg_loss: 13004.4742; train_edge_recon_loss: 1318161.2629; train_cat_covariates_contrastive_loss: 634569.7996; train_gene_expr_recon_loss: 2888840.9483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4854576.5172; train_optim_loss: 4854576.5172; val_kl_reg_loss: 12972.9624; val_edge_recon_loss: 1359183.9688; val_cat_covariates_contrastive_loss: 634516.4531; val_gene_expr_recon_loss: 2885848.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4892521.2500; val_optim_loss: 4892521.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9541; val_auprc_score: 0.9789; val_best_acc_score: 0.9399; val_best_f1_score: 0.9614; train_kl_reg_loss: 12916.6733; train_edge_recon_loss: 1315776.0603; train_cat_covariates_contrastive_loss: 634255.4741; train_gene_expr_recon_loss: 2884228.7931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4847177.0000; train_optim_loss: 4847177.0000; val_kl_reg_loss: 12592.3301; val_edge_recon_loss: 1317910.2188; val_cat_covariates_contrastive_loss: 633542.3594; val_gene_expr_recon_loss: 2870188.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4834233.6250; val_optim_loss: 4834233.6250
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9549; val_auprc_score: 0.9785; val_best_acc_score: 0.9400; val_best_f1_score: 0.9613; train_kl_reg_loss: 12701.1854; train_edge_recon_loss: 1318212.8750; train_cat_covariates_contrastive_loss: 633978.4655; train_gene_expr_recon_loss: 2874648.6293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4839541.1724; train_optim_loss: 4839541.1724; val_kl_reg_loss: 12340.1047; val_edge_recon_loss: 1336765.9062; val_cat_covariates_contrastive_loss: 632949.2812; val_gene_expr_recon_loss: 2872974.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4855029.6250; val_optim_loss: 4855029.6250
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9538; val_auprc_score: 0.9778; val_best_acc_score: 0.9416; val_best_f1_score: 0.9621; train_kl_reg_loss: 12564.7114; train_edge_recon_loss: 1320805.0431; train_cat_covariates_contrastive_loss: 634552.4957; train_gene_expr_recon_loss: 2865742.8017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4833665.0690; train_optim_loss: 4833665.0690; val_kl_reg_loss: 12349.0264; val_edge_recon_loss: 1338996.1562; val_cat_covariates_contrastive_loss: 633607.0781; val_gene_expr_recon_loss: 2863862.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4848814.6250; val_optim_loss: 4848814.6250
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9563; val_auprc_score: 0.9792; val_best_acc_score: 0.9435; val_best_f1_score: 0.9634; train_kl_reg_loss: 12445.2902; train_edge_recon_loss: 1320860.5603; train_cat_covariates_contrastive_loss: 634085.5496; train_gene_expr_recon_loss: 2861229.6552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4828621.1207; train_optim_loss: 4828621.1207; val_kl_reg_loss: 12211.1392; val_edge_recon_loss: 1340555.5938; val_cat_covariates_contrastive_loss: 632839.8438; val_gene_expr_recon_loss: 2859777.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4845384.2500; val_optim_loss: 4845384.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9535; val_auprc_score: 0.9766; val_best_acc_score: 0.9435; val_best_f1_score: 0.9634; train_kl_reg_loss: 12379.6011; train_edge_recon_loss: 1317604.9138; train_cat_covariates_contrastive_loss: 633978.4698; train_gene_expr_recon_loss: 2850001.8707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4813964.8621; train_optim_loss: 4813964.8621; val_kl_reg_loss: 12156.6323; val_edge_recon_loss: 1318022.8750; val_cat_covariates_contrastive_loss: 634211.7969; val_gene_expr_recon_loss: 2838100.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4802491.5000; val_optim_loss: 4802491.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9521; val_auprc_score: 0.9766; val_best_acc_score: 0.9421; val_best_f1_score: 0.9625; train_kl_reg_loss: 12243.4978; train_edge_recon_loss: 1319215.6121; train_cat_covariates_contrastive_loss: 633758.1034; train_gene_expr_recon_loss: 2848755.6983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4813972.9483; train_optim_loss: 4813972.9483; val_kl_reg_loss: 12072.2146; val_edge_recon_loss: 1332811.0938; val_cat_covariates_contrastive_loss: 632886.8281; val_gene_expr_recon_loss: 2832301.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4810071.1250; val_optim_loss: 4810071.1250
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9567; val_auprc_score: 0.9795; val_best_acc_score: 0.9437; val_best_f1_score: 0.9637; train_kl_reg_loss: 12184.1264; train_edge_recon_loss: 1312165.0690; train_cat_covariates_contrastive_loss: 633788.3578; train_gene_expr_recon_loss: 2843233.1379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4801370.7414; train_optim_loss: 4801370.7414; val_kl_reg_loss: 11939.9521; val_edge_recon_loss: 1335412.6562; val_cat_covariates_contrastive_loss: 631441.2344; val_gene_expr_recon_loss: 2827885.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4806679.0000; val_optim_loss: 4806679.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9565; val_auprc_score: 0.9779; val_best_acc_score: 0.9493; val_best_f1_score: 0.9671; train_kl_reg_loss: 12109.0238; train_edge_recon_loss: 1319548.6422; train_cat_covariates_contrastive_loss: 633960.8254; train_gene_expr_recon_loss: 2835557.2586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4801175.7241; train_optim_loss: 4801175.7241; val_kl_reg_loss: 12081.7744; val_edge_recon_loss: 1304186.6562; val_cat_covariates_contrastive_loss: 633005.1875; val_gene_expr_recon_loss: 2834441.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4783715.2500; val_optim_loss: 4783715.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9532; val_auprc_score: 0.9773; val_best_acc_score: 0.9440; val_best_f1_score: 0.9638; train_kl_reg_loss: 12069.7704; train_edge_recon_loss: 1312923.7328; train_cat_covariates_contrastive_loss: 633671.3793; train_gene_expr_recon_loss: 2828171.3276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4786836.1897; train_optim_loss: 4786836.1897; val_kl_reg_loss: 11709.8716; val_edge_recon_loss: 1328632.3438; val_cat_covariates_contrastive_loss: 633023.6406; val_gene_expr_recon_loss: 2819357.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4792723.0000; val_optim_loss: 4792723.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9586; val_auprc_score: 0.9796; val_best_acc_score: 0.9456; val_best_f1_score: 0.9647; train_kl_reg_loss: 12007.8295; train_edge_recon_loss: 1312825.4741; train_cat_covariates_contrastive_loss: 633591.4397; train_gene_expr_recon_loss: 2823565.7845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4781990.4828; train_optim_loss: 4781990.4828; val_kl_reg_loss: 11875.3633; val_edge_recon_loss: 1321448.6562; val_cat_covariates_contrastive_loss: 632234.0156; val_gene_expr_recon_loss: 2822834.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4788392.6250; val_optim_loss: 4788392.6250
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9522; val_auprc_score: 0.9764; val_best_acc_score: 0.9454; val_best_f1_score: 0.9645; train_kl_reg_loss: 12035.6735; train_edge_recon_loss: 1314735.1078; train_cat_covariates_contrastive_loss: 633655.3233; train_gene_expr_recon_loss: 2817528.3190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4777954.4655; train_optim_loss: 4777954.4655; val_kl_reg_loss: 11945.7793; val_edge_recon_loss: 1353578.6875; val_cat_covariates_contrastive_loss: 632506.8125; val_gene_expr_recon_loss: 2810156.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4808187.2500; val_optim_loss: 4808187.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9557; val_auprc_score: 0.9782; val_best_acc_score: 0.9467; val_best_f1_score: 0.9655; train_kl_reg_loss: 11957.8363; train_edge_recon_loss: 1306331.3836; train_cat_covariates_contrastive_loss: 633305.2888; train_gene_expr_recon_loss: 2809953.1379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4761547.6034; train_optim_loss: 4761547.6034; val_kl_reg_loss: 11874.1621; val_edge_recon_loss: 1322721.5938; val_cat_covariates_contrastive_loss: 633168.7344; val_gene_expr_recon_loss: 2801920.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4769684.7500; val_optim_loss: 4769684.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9529; val_auprc_score: 0.9767; val_best_acc_score: 0.9452; val_best_f1_score: 0.9644; train_kl_reg_loss: 11903.1397; train_edge_recon_loss: 1310792.6121; train_cat_covariates_contrastive_loss: 633464.0647; train_gene_expr_recon_loss: 2804558.1379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4760717.8793; train_optim_loss: 4760717.8793; val_kl_reg_loss: 11711.0217; val_edge_recon_loss: 1356089.0625; val_cat_covariates_contrastive_loss: 633792.8125; val_gene_expr_recon_loss: 2794595.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4796187.8750; val_optim_loss: 4796187.8750
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9565; val_auprc_score: 0.9788; val_best_acc_score: 0.9490; val_best_f1_score: 0.9670; train_kl_reg_loss: 11780.8826; train_edge_recon_loss: 1313043.4914; train_cat_covariates_contrastive_loss: 633472.2220; train_gene_expr_recon_loss: 2802729.1983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4761025.8103; train_optim_loss: 4761025.8103; val_kl_reg_loss: 11694.1079; val_edge_recon_loss: 1312422.6250; val_cat_covariates_contrastive_loss: 632645.6719; val_gene_expr_recon_loss: 2796899.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4753661.3750; val_optim_loss: 4753661.3750
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9530; val_auprc_score: 0.9772; val_best_acc_score: 0.9450; val_best_f1_score: 0.9643; train_kl_reg_loss: 11884.1829; train_edge_recon_loss: 1311987.7457; train_cat_covariates_contrastive_loss: 633606.0927; train_gene_expr_recon_loss: 2795790.3621; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4753268.3966; train_optim_loss: 4753268.3966; val_kl_reg_loss: 11764.0459; val_edge_recon_loss: 1324333.6875; val_cat_covariates_contrastive_loss: 632105.6094; val_gene_expr_recon_loss: 2790437.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4758641.2500; val_optim_loss: 4758641.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9563; val_auprc_score: 0.9785; val_best_acc_score: 0.9480; val_best_f1_score: 0.9664; train_kl_reg_loss: 11867.8128; train_edge_recon_loss: 1314160.0000; train_cat_covariates_contrastive_loss: 633507.1487; train_gene_expr_recon_loss: 2788853.9914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4748388.9828; train_optim_loss: 4748388.9828; val_kl_reg_loss: 11831.3745; val_edge_recon_loss: 1330795.1562; val_cat_covariates_contrastive_loss: 633172.6406; val_gene_expr_recon_loss: 2794348.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4770147.7500; val_optim_loss: 4770147.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9535; val_auprc_score: 0.9775; val_best_acc_score: 0.9459; val_best_f1_score: 0.9649; train_kl_reg_loss: 11898.2958; train_edge_recon_loss: 1312973.6853; train_cat_covariates_contrastive_loss: 633351.7953; train_gene_expr_recon_loss: 2786091.8017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4744315.5517; train_optim_loss: 4744315.5517; val_kl_reg_loss: 11555.0918; val_edge_recon_loss: 1338328.7812; val_cat_covariates_contrastive_loss: 633258.6094; val_gene_expr_recon_loss: 2779116.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4762259.1250; val_optim_loss: 4762259.1250
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9525; val_auprc_score: 0.9770; val_best_acc_score: 0.9444; val_best_f1_score: 0.9641; train_kl_reg_loss: 11904.8327; train_edge_recon_loss: 1310233.3534; train_cat_covariates_contrastive_loss: 633213.3901; train_gene_expr_recon_loss: 2781456.6724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4736808.1897; train_optim_loss: 4736808.1897; val_kl_reg_loss: 11768.6050; val_edge_recon_loss: 1349276.4062; val_cat_covariates_contrastive_loss: 632491.7344; val_gene_expr_recon_loss: 2782593.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4776130.6250; val_optim_loss: 4776130.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9512; val_auprc_score: 0.9768; val_best_acc_score: 0.9471; val_best_f1_score: 0.9658; train_kl_reg_loss: 11928.2514; train_edge_recon_loss: 1307568.3362; train_cat_covariates_contrastive_loss: 632913.8642; train_gene_expr_recon_loss: 2777967.7241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4730378.1379; train_optim_loss: 4730378.1379; val_kl_reg_loss: 11793.4763; val_edge_recon_loss: 1293316.7500; val_cat_covariates_contrastive_loss: 632123.4375; val_gene_expr_recon_loss: 2776001.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4713234.8750; val_optim_loss: 4713234.8750
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9496; val_auprc_score: 0.9752; val_best_acc_score: 0.9451; val_best_f1_score: 0.9645; train_kl_reg_loss: 11972.2395; train_edge_recon_loss: 1314227.6724; train_cat_covariates_contrastive_loss: 632690.1164; train_gene_expr_recon_loss: 2776142.8103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4735032.8793; train_optim_loss: 4735032.8793; val_kl_reg_loss: 11807.8606; val_edge_recon_loss: 1333987.4688; val_cat_covariates_contrastive_loss: 631835.7344; val_gene_expr_recon_loss: 2777813.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4755444.2500; val_optim_loss: 4755444.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9551; val_auprc_score: 0.9783; val_best_acc_score: 0.9493; val_best_f1_score: 0.9672; train_kl_reg_loss: 11854.1226; train_edge_recon_loss: 1311019.8190; train_cat_covariates_contrastive_loss: 632891.7004; train_gene_expr_recon_loss: 2773944.3879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4729710.0517; train_optim_loss: 4729710.0517; val_kl_reg_loss: 11714.3452; val_edge_recon_loss: 1311479.2188; val_cat_covariates_contrastive_loss: 632955.8125; val_gene_expr_recon_loss: 2784037.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4740186.8750; val_optim_loss: 4740186.8750
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9518; val_auprc_score: 0.9767; val_best_acc_score: 0.9471; val_best_f1_score: 0.9658; train_kl_reg_loss: 11831.1241; train_edge_recon_loss: 1305535.4741; train_cat_covariates_contrastive_loss: 633284.8966; train_gene_expr_recon_loss: 2772917.5603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4723569.1034; train_optim_loss: 4723569.1034; val_kl_reg_loss: 11780.6409; val_edge_recon_loss: 1320727.6875; val_cat_covariates_contrastive_loss: 632778.9062; val_gene_expr_recon_loss: 2776455.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4741742.5000; val_optim_loss: 4741742.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9569; val_auprc_score: 0.9794; val_best_acc_score: 0.9492; val_best_f1_score: 0.9671; train_kl_reg_loss: 11854.0325; train_edge_recon_loss: 1309995.7241; train_cat_covariates_contrastive_loss: 633339.9116; train_gene_expr_recon_loss: 2776708.1552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4731897.8448; train_optim_loss: 4731897.8448; val_kl_reg_loss: 11865.0859; val_edge_recon_loss: 1309131.9062; val_cat_covariates_contrastive_loss: 633114.9219; val_gene_expr_recon_loss: 2773812.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4727924.2500; val_optim_loss: 4727924.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9522; val_auprc_score: 0.9767; val_best_acc_score: 0.9476; val_best_f1_score: 0.9661; train_kl_reg_loss: 11914.1363; train_edge_recon_loss: 1308864.4914; train_cat_covariates_contrastive_loss: 633029.5797; train_gene_expr_recon_loss: 2774857.4828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4728665.7069; train_optim_loss: 4728665.7069; val_kl_reg_loss: 11793.4478; val_edge_recon_loss: 1309337.5938; val_cat_covariates_contrastive_loss: 631889.0156; val_gene_expr_recon_loss: 2773592.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4726612.2500; val_optim_loss: 4726612.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9516; val_auprc_score: 0.9752; val_best_acc_score: 0.9460; val_best_f1_score: 0.9649; train_kl_reg_loss: 11888.3783; train_edge_recon_loss: 1308799.3190; train_cat_covariates_contrastive_loss: 632864.4526; train_gene_expr_recon_loss: 2771616.1724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4725168.3448; train_optim_loss: 4725168.3448; val_kl_reg_loss: 11817.0000; val_edge_recon_loss: 1339328.2812; val_cat_covariates_contrastive_loss: 632575.8750; val_gene_expr_recon_loss: 2779479.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4763200.5000; val_optim_loss: 4763200.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9521; val_auprc_score: 0.9774; val_best_acc_score: 0.9463; val_best_f1_score: 0.9652; train_kl_reg_loss: 11880.2789; train_edge_recon_loss: 1315193.3405; train_cat_covariates_contrastive_loss: 633120.4634; train_gene_expr_recon_loss: 2774806.8448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4735000.9828; train_optim_loss: 4735000.9828; val_kl_reg_loss: 11775.4912; val_edge_recon_loss: 1309711.3125; val_cat_covariates_contrastive_loss: 632252.1719; val_gene_expr_recon_loss: 2776364.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4730103.6250; val_optim_loss: 4730103.6250
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9574; val_auprc_score: 0.9794; val_best_acc_score: 0.9487; val_best_f1_score: 0.9667; train_kl_reg_loss: 11879.6720; train_edge_recon_loss: 1306297.1207; train_cat_covariates_contrastive_loss: 632847.4116; train_gene_expr_recon_loss: 2771197.4397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4722221.6724; train_optim_loss: 4722221.6724; val_kl_reg_loss: 11783.2734; val_edge_recon_loss: 1318748.3750; val_cat_covariates_contrastive_loss: 632369.2188; val_gene_expr_recon_loss: 2769202.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4732103.0000; val_optim_loss: 4732103.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 14 min 56 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.9310
val AUPRC score: 0.9640
val best accuracy score: 0.9399
val best F1 score: 0.9609
val target rna MSE score: 0.9961
val source rna MSE score: 0.2177
Val cat covariate0 mean sim diff: 0.0017
Val cat covariate1 mean sim diff: -0.0802
Duration of model training in run 4: 0 hours, 15 minutes and 4 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 25413
Number of validation nodes: 2824
Number of training edges: 117816
Number of validation edges: 13090
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8682; val_auprc_score: 0.9496; val_best_acc_score: 0.8464; val_best_f1_score: 0.9057; train_kl_reg_loss: 2435.5738; train_edge_recon_loss: 1814565.9741; train_cat_covariates_contrastive_loss: 745354.9612; train_gene_expr_recon_loss: 4083385.8534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6645742.3621; train_optim_loss: 6645742.3621; val_kl_reg_loss: 3428.8217; val_edge_recon_loss: 1866683.6875; val_cat_covariates_contrastive_loss: 627347.1250; val_gene_expr_recon_loss: 3792651.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6290110.7500; val_optim_loss: 6290110.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8465; val_auprc_score: 0.9408; val_best_acc_score: 0.8419; val_best_f1_score: 0.9036; train_kl_reg_loss: 10640.0647; train_edge_recon_loss: 1585862.5086; train_cat_covariates_contrastive_loss: 632263.1185; train_gene_expr_recon_loss: 3603575.3190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5832341.0172; train_optim_loss: 5832341.0172; val_kl_reg_loss: 20549.8271; val_edge_recon_loss: 1560882.7812; val_cat_covariates_contrastive_loss: 626678.9219; val_gene_expr_recon_loss: 3401623.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5609735.2500; val_optim_loss: 5609735.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8651; val_auprc_score: 0.9470; val_best_acc_score: 0.8559; val_best_f1_score: 0.9112; train_kl_reg_loss: 27903.8039; train_edge_recon_loss: 1525022.0647; train_cat_covariates_contrastive_loss: 627213.6422; train_gene_expr_recon_loss: 3309692.8966; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5489832.4310; train_optim_loss: 5489832.4310; val_kl_reg_loss: 28975.9341; val_edge_recon_loss: 1497744.6250; val_cat_covariates_contrastive_loss: 626746.3750; val_gene_expr_recon_loss: 3230559.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5384026.7500; val_optim_loss: 5384026.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8772; val_auprc_score: 0.9518; val_best_acc_score: 0.8647; val_best_f1_score: 0.9172; train_kl_reg_loss: 26428.3862; train_edge_recon_loss: 1477854.1552; train_cat_covariates_contrastive_loss: 627403.8922; train_gene_expr_recon_loss: 3173857.4224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5305543.8621; train_optim_loss: 5305543.8621; val_kl_reg_loss: 23165.8096; val_edge_recon_loss: 1454235.8125; val_cat_covariates_contrastive_loss: 627067.6562; val_gene_expr_recon_loss: 3124374.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5228844.1250; val_optim_loss: 5228844.1250
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9003; val_auprc_score: 0.9595; val_best_acc_score: 0.8691; val_best_f1_score: 0.9188; train_kl_reg_loss: 21282.6282; train_edge_recon_loss: 1439284.4698; train_cat_covariates_contrastive_loss: 629315.9159; train_gene_expr_recon_loss: 3103068.8448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5192951.8793; train_optim_loss: 5192951.8793; val_kl_reg_loss: 18876.1753; val_edge_recon_loss: 1424464.7188; val_cat_covariates_contrastive_loss: 629293.5938; val_gene_expr_recon_loss: 3065322.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5137957.0000; val_optim_loss: 5137957.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9239; val_auprc_score: 0.9660; val_best_acc_score: 0.8996; val_best_f1_score: 0.9363; train_kl_reg_loss: 18401.3820; train_edge_recon_loss: 1392623.6078; train_cat_covariates_contrastive_loss: 634169.5991; train_gene_expr_recon_loss: 3065888.0431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5111082.6552; train_optim_loss: 5111082.6552; val_kl_reg_loss: 18600.6934; val_edge_recon_loss: 1381098.9375; val_cat_covariates_contrastive_loss: 635399.6406; val_gene_expr_recon_loss: 3049926.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5085025.2500; val_optim_loss: 5085025.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9302; val_auprc_score: 0.9710; val_best_acc_score: 0.9036; val_best_f1_score: 0.9387; train_kl_reg_loss: 19268.1510; train_edge_recon_loss: 1356701.7500; train_cat_covariates_contrastive_loss: 636393.2629; train_gene_expr_recon_loss: 3033853.4310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5046216.5862; train_optim_loss: 5046216.5862; val_kl_reg_loss: 19138.9419; val_edge_recon_loss: 1370624.9375; val_cat_covariates_contrastive_loss: 634802.9844; val_gene_expr_recon_loss: 3019693.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5044260.6250; val_optim_loss: 5044260.6250
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9349; val_auprc_score: 0.9724; val_best_acc_score: 0.9058; val_best_f1_score: 0.9401; train_kl_reg_loss: 19262.6533; train_edge_recon_loss: 1359246.2888; train_cat_covariates_contrastive_loss: 636445.3578; train_gene_expr_recon_loss: 3012044.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5026998.5517; train_optim_loss: 5026998.5517; val_kl_reg_loss: 18715.6328; val_edge_recon_loss: 1369415.8125; val_cat_covariates_contrastive_loss: 636081.2500; val_gene_expr_recon_loss: 3002304.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5026517.6250; val_optim_loss: 5026517.6250
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9369; val_auprc_score: 0.9733; val_best_acc_score: 0.9084; val_best_f1_score: 0.9413; train_kl_reg_loss: 18585.8300; train_edge_recon_loss: 1354428.6940; train_cat_covariates_contrastive_loss: 636220.2091; train_gene_expr_recon_loss: 2995449.4138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5004684.2069; train_optim_loss: 5004684.2069; val_kl_reg_loss: 17667.4341; val_edge_recon_loss: 1362572.3125; val_cat_covariates_contrastive_loss: 635269.4375; val_gene_expr_recon_loss: 2977931.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4993440.8750; val_optim_loss: 4993440.8750
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9376; val_auprc_score: 0.9735; val_best_acc_score: 0.9108; val_best_f1_score: 0.9434; train_kl_reg_loss: 17588.3046; train_edge_recon_loss: 1344489.7026; train_cat_covariates_contrastive_loss: 635786.9052; train_gene_expr_recon_loss: 2983488.7845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4981353.6379; train_optim_loss: 4981353.6379; val_kl_reg_loss: 16705.4844; val_edge_recon_loss: 1340218.5625; val_cat_covariates_contrastive_loss: 636244.2812; val_gene_expr_recon_loss: 2979217.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4972386.2500; val_optim_loss: 4972386.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9397; val_auprc_score: 0.9739; val_best_acc_score: 0.9155; val_best_f1_score: 0.9460; train_kl_reg_loss: 16729.7489; train_edge_recon_loss: 1336413.9440; train_cat_covariates_contrastive_loss: 636343.9871; train_gene_expr_recon_loss: 2968408.1810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4957895.8448; train_optim_loss: 4957895.8448; val_kl_reg_loss: 15944.0791; val_edge_recon_loss: 1371380.0312; val_cat_covariates_contrastive_loss: 635327.4688; val_gene_expr_recon_loss: 2960490.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4983141.6250; val_optim_loss: 4983141.6250
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9453; val_auprc_score: 0.9753; val_best_acc_score: 0.9196; val_best_f1_score: 0.9485; train_kl_reg_loss: 15941.8551; train_edge_recon_loss: 1340782.3190; train_cat_covariates_contrastive_loss: 636352.6530; train_gene_expr_recon_loss: 2956706.5345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4949783.3621; train_optim_loss: 4949783.3621; val_kl_reg_loss: 15045.9419; val_edge_recon_loss: 1363370.0938; val_cat_covariates_contrastive_loss: 635247.8750; val_gene_expr_recon_loss: 2960114.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4973778.3750; val_optim_loss: 4973778.3750
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9502; val_auprc_score: 0.9766; val_best_acc_score: 0.9281; val_best_f1_score: 0.9538; train_kl_reg_loss: 15111.9394; train_edge_recon_loss: 1331207.7845; train_cat_covariates_contrastive_loss: 636956.8254; train_gene_expr_recon_loss: 2944930.3448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4928206.9310; train_optim_loss: 4928206.9310; val_kl_reg_loss: 14445.2581; val_edge_recon_loss: 1341790.3438; val_cat_covariates_contrastive_loss: 636246.4375; val_gene_expr_recon_loss: 2936565.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4929047.1250; val_optim_loss: 4929047.1250
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9463; val_auprc_score: 0.9741; val_best_acc_score: 0.9324; val_best_f1_score: 0.9564; train_kl_reg_loss: 14500.5339; train_edge_recon_loss: 1334159.0819; train_cat_covariates_contrastive_loss: 636563.0948; train_gene_expr_recon_loss: 2935905.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4921128.1897; train_optim_loss: 4921128.1897; val_kl_reg_loss: 14012.5552; val_edge_recon_loss: 1342484.5312; val_cat_covariates_contrastive_loss: 636466.5000; val_gene_expr_recon_loss: 2913769.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4906733.0000; val_optim_loss: 4906733.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9566; val_auprc_score: 0.9795; val_best_acc_score: 0.9378; val_best_f1_score: 0.9599; train_kl_reg_loss: 14073.7914; train_edge_recon_loss: 1324187.4224; train_cat_covariates_contrastive_loss: 635944.2198; train_gene_expr_recon_loss: 2921171.4052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4895376.8103; train_optim_loss: 4895376.8103; val_kl_reg_loss: 13770.1118; val_edge_recon_loss: 1298252.2500; val_cat_covariates_contrastive_loss: 634672.9062; val_gene_expr_recon_loss: 2919688.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4866383.7500; val_optim_loss: 4866383.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9498; val_auprc_score: 0.9744; val_best_acc_score: 0.9366; val_best_f1_score: 0.9592; train_kl_reg_loss: 13829.0455; train_edge_recon_loss: 1325044.8362; train_cat_covariates_contrastive_loss: 635343.8017; train_gene_expr_recon_loss: 2915797.7586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4890015.3966; train_optim_loss: 4890015.3966; val_kl_reg_loss: 13405.8926; val_edge_recon_loss: 1330584.2812; val_cat_covariates_contrastive_loss: 633144.1250; val_gene_expr_recon_loss: 2920887.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4898021.5000; val_optim_loss: 4898021.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9522; val_auprc_score: 0.9755; val_best_acc_score: 0.9359; val_best_f1_score: 0.9584; train_kl_reg_loss: 13514.4430; train_edge_recon_loss: 1324013.2328; train_cat_covariates_contrastive_loss: 635072.9052; train_gene_expr_recon_loss: 2910501.9483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4883102.5000; train_optim_loss: 4883102.5000; val_kl_reg_loss: 13258.5974; val_edge_recon_loss: 1352847.7812; val_cat_covariates_contrastive_loss: 636718.8125; val_gene_expr_recon_loss: 2914912.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4917737.8750; val_optim_loss: 4917737.8750
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9539; val_auprc_score: 0.9775; val_best_acc_score: 0.9403; val_best_f1_score: 0.9616; train_kl_reg_loss: 13248.3632; train_edge_recon_loss: 1325144.7802; train_cat_covariates_contrastive_loss: 634856.7371; train_gene_expr_recon_loss: 2897487.2241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4870737.1897; train_optim_loss: 4870737.1897; val_kl_reg_loss: 13195.6919; val_edge_recon_loss: 1320939.8750; val_cat_covariates_contrastive_loss: 634632.2656; val_gene_expr_recon_loss: 2886693.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4855461.0000; val_optim_loss: 4855461.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9512; val_auprc_score: 0.9757; val_best_acc_score: 0.9380; val_best_f1_score: 0.9602; train_kl_reg_loss: 13114.6032; train_edge_recon_loss: 1315034.2586; train_cat_covariates_contrastive_loss: 634557.7931; train_gene_expr_recon_loss: 2892395.5431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4855102.2241; train_optim_loss: 4855102.2241; val_kl_reg_loss: 12778.4109; val_edge_recon_loss: 1315261.8125; val_cat_covariates_contrastive_loss: 635528.3438; val_gene_expr_recon_loss: 2874501.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4838070.2500; val_optim_loss: 4838070.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9603; val_auprc_score: 0.9810; val_best_acc_score: 0.9426; val_best_f1_score: 0.9626; train_kl_reg_loss: 12924.9848; train_edge_recon_loss: 1322258.5560; train_cat_covariates_contrastive_loss: 634513.2457; train_gene_expr_recon_loss: 2882787.3966; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4852484.1724; train_optim_loss: 4852484.1724; val_kl_reg_loss: 12521.0249; val_edge_recon_loss: 1313993.6875; val_cat_covariates_contrastive_loss: 635659.5781; val_gene_expr_recon_loss: 2877679.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4839854.1250; val_optim_loss: 4839854.1250
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9537; val_auprc_score: 0.9770; val_best_acc_score: 0.9404; val_best_f1_score: 0.9614; train_kl_reg_loss: 12753.7732; train_edge_recon_loss: 1319233.3147; train_cat_covariates_contrastive_loss: 634928.7500; train_gene_expr_recon_loss: 2875848.5086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4842764.3621; train_optim_loss: 4842764.3621; val_kl_reg_loss: 12446.6230; val_edge_recon_loss: 1341221.2812; val_cat_covariates_contrastive_loss: 633993.1094; val_gene_expr_recon_loss: 2868392.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4856053.5000; val_optim_loss: 4856053.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9543; val_auprc_score: 0.9766; val_best_acc_score: 0.9428; val_best_f1_score: 0.9629; train_kl_reg_loss: 12615.0159; train_edge_recon_loss: 1319352.6853; train_cat_covariates_contrastive_loss: 634610.2284; train_gene_expr_recon_loss: 2868465.3966; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4835043.3448; train_optim_loss: 4835043.3448; val_kl_reg_loss: 12170.9341; val_edge_recon_loss: 1319932.4688; val_cat_covariates_contrastive_loss: 635728.3438; val_gene_expr_recon_loss: 2871555.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4839387.0000; val_optim_loss: 4839387.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9520; val_auprc_score: 0.9760; val_best_acc_score: 0.9407; val_best_f1_score: 0.9615; train_kl_reg_loss: 12442.5353; train_edge_recon_loss: 1314489.9397; train_cat_covariates_contrastive_loss: 634424.3642; train_gene_expr_recon_loss: 2863703.2586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4825060.1207; train_optim_loss: 4825060.1207; val_kl_reg_loss: 12175.8726; val_edge_recon_loss: 1354172.9688; val_cat_covariates_contrastive_loss: 633629.8594; val_gene_expr_recon_loss: 2854831.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4854810.5000; val_optim_loss: 4854810.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9514; val_auprc_score: 0.9750; val_best_acc_score: 0.9396; val_best_f1_score: 0.9609; train_kl_reg_loss: 12442.6210; train_edge_recon_loss: 1322256.9828; train_cat_covariates_contrastive_loss: 634563.0065; train_gene_expr_recon_loss: 2852981.9052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4822244.5172; train_optim_loss: 4822244.5172; val_kl_reg_loss: 12274.2783; val_edge_recon_loss: 1320921.9688; val_cat_covariates_contrastive_loss: 633075.7344; val_gene_expr_recon_loss: 2854562.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4820834.2500; val_optim_loss: 4820834.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9547; val_auprc_score: 0.9779; val_best_acc_score: 0.9427; val_best_f1_score: 0.9629; train_kl_reg_loss: 12502.4731; train_edge_recon_loss: 1314186.1034; train_cat_covariates_contrastive_loss: 634148.6810; train_gene_expr_recon_loss: 2855755.3017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4816592.6034; train_optim_loss: 4816592.6034; val_kl_reg_loss: 12259.3337; val_edge_recon_loss: 1340104.2812; val_cat_covariates_contrastive_loss: 633849.5156; val_gene_expr_recon_loss: 2849637.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4835850.7500; val_optim_loss: 4835850.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9524; val_auprc_score: 0.9772; val_best_acc_score: 0.9425; val_best_f1_score: 0.9630; train_kl_reg_loss: 12449.1412; train_edge_recon_loss: 1319477.5647; train_cat_covariates_contrastive_loss: 633904.3901; train_gene_expr_recon_loss: 2857374.9310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4823206.0172; train_optim_loss: 4823206.0172; val_kl_reg_loss: 12232.5398; val_edge_recon_loss: 1301662.1250; val_cat_covariates_contrastive_loss: 633195.8438; val_gene_expr_recon_loss: 2858606.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4805696.6250; val_optim_loss: 4805696.6250
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9552; val_auprc_score: 0.9780; val_best_acc_score: 0.9422; val_best_f1_score: 0.9625; train_kl_reg_loss: 12451.3688; train_edge_recon_loss: 1311476.5948; train_cat_covariates_contrastive_loss: 634013.1466; train_gene_expr_recon_loss: 2852088.5172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4810029.6379; train_optim_loss: 4810029.6379; val_kl_reg_loss: 12275.4590; val_edge_recon_loss: 1340309.9062; val_cat_covariates_contrastive_loss: 633817.2344; val_gene_expr_recon_loss: 2854535.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4840937.6250; val_optim_loss: 4840937.6250
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9481; val_auprc_score: 0.9750; val_best_acc_score: 0.9400; val_best_f1_score: 0.9613; train_kl_reg_loss: 12443.7622; train_edge_recon_loss: 1317342.9957; train_cat_covariates_contrastive_loss: 634074.1789; train_gene_expr_recon_loss: 2855218.9655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4819079.8793; train_optim_loss: 4819079.8793; val_kl_reg_loss: 12116.0742; val_edge_recon_loss: 1320894.7500; val_cat_covariates_contrastive_loss: 633710.4219; val_gene_expr_recon_loss: 2855272.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4821993.6250; val_optim_loss: 4821993.6250
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9549; val_auprc_score: 0.9783; val_best_acc_score: 0.9414; val_best_f1_score: 0.9621; train_kl_reg_loss: 12381.0052; train_edge_recon_loss: 1310627.8534; train_cat_covariates_contrastive_loss: 634162.6185; train_gene_expr_recon_loss: 2854275.2069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4811446.7069; train_optim_loss: 4811446.7069; val_kl_reg_loss: 12191.0698; val_edge_recon_loss: 1320819.3750; val_cat_covariates_contrastive_loss: 634101.3438; val_gene_expr_recon_loss: 2855111.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4822223.8750; val_optim_loss: 4822223.8750
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9490; val_auprc_score: 0.9743; val_best_acc_score: 0.9411; val_best_f1_score: 0.9620; train_kl_reg_loss: 12404.8619; train_edge_recon_loss: 1316172.5819; train_cat_covariates_contrastive_loss: 634388.5625; train_gene_expr_recon_loss: 2850823.3017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4813789.2931; train_optim_loss: 4813789.2931; val_kl_reg_loss: 12181.7573; val_edge_recon_loss: 1343730.5312; val_cat_covariates_contrastive_loss: 634296.5469; val_gene_expr_recon_loss: 2845766.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4835975.5000; val_optim_loss: 4835975.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9527; val_auprc_score: 0.9773; val_best_acc_score: 0.9422; val_best_f1_score: 0.9626; train_kl_reg_loss: 12414.4383; train_edge_recon_loss: 1310649.0862; train_cat_covariates_contrastive_loss: 633963.5431; train_gene_expr_recon_loss: 2853123.2328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4810150.2759; train_optim_loss: 4810150.2759; val_kl_reg_loss: 12217.2373; val_edge_recon_loss: 1324023.0000; val_cat_covariates_contrastive_loss: 633603.8281; val_gene_expr_recon_loss: 2861539.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4831383.0000; val_optim_loss: 4831383.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9523; val_auprc_score: 0.9764; val_best_acc_score: 0.9420; val_best_f1_score: 0.9626; train_kl_reg_loss: 12375.3540; train_edge_recon_loss: 1316372.2500; train_cat_covariates_contrastive_loss: 633824.1444; train_gene_expr_recon_loss: 2851097.6207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4813669.3621; train_optim_loss: 4813669.3621; val_kl_reg_loss: 12132.5225; val_edge_recon_loss: 1303071.4375; val_cat_covariates_contrastive_loss: 632846.7188; val_gene_expr_recon_loss: 2851306.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4799357.1250; val_optim_loss: 4799357.1250
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9534; val_auprc_score: 0.9773; val_best_acc_score: 0.9407; val_best_f1_score: 0.9617; train_kl_reg_loss: 12392.0567; train_edge_recon_loss: 1312282.2931; train_cat_covariates_contrastive_loss: 634186.5453; train_gene_expr_recon_loss: 2850776.1983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4809637.1379; train_optim_loss: 4809637.1379; val_kl_reg_loss: 12187.3030; val_edge_recon_loss: 1350652.3750; val_cat_covariates_contrastive_loss: 632516.0625; val_gene_expr_recon_loss: 2855390.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4850746.5000; val_optim_loss: 4850746.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9541; val_auprc_score: 0.9771; val_best_acc_score: 0.9408; val_best_f1_score: 0.9617; train_kl_reg_loss: 12388.8382; train_edge_recon_loss: 1315759.7371; train_cat_covariates_contrastive_loss: 634354.1099; train_gene_expr_recon_loss: 2851558.7759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4814061.5517; train_optim_loss: 4814061.5517; val_kl_reg_loss: 12140.2170; val_edge_recon_loss: 1341592.7188; val_cat_covariates_contrastive_loss: 633363.9062; val_gene_expr_recon_loss: 2853403.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4840499.8750; val_optim_loss: 4840499.8750
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9544; val_auprc_score: 0.9772; val_best_acc_score: 0.9418; val_best_f1_score: 0.9622; train_kl_reg_loss: 12393.5908; train_edge_recon_loss: 1312066.0776; train_cat_covariates_contrastive_loss: 634092.1832; train_gene_expr_recon_loss: 2850859.8707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4809411.6897; train_optim_loss: 4809411.6897; val_kl_reg_loss: 12190.0271; val_edge_recon_loss: 1356624.1250; val_cat_covariates_contrastive_loss: 632902.7812; val_gene_expr_recon_loss: 2840443.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4842160.0000; val_optim_loss: 4842160.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9543; val_auprc_score: 0.9767; val_best_acc_score: 0.9430; val_best_f1_score: 0.9632; train_kl_reg_loss: 12391.4389; train_edge_recon_loss: 1316027.2155; train_cat_covariates_contrastive_loss: 633946.8491; train_gene_expr_recon_loss: 2852617.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4814983.0517; train_optim_loss: 4814983.0517; val_kl_reg_loss: 12160.4138; val_edge_recon_loss: 1331121.4688; val_cat_covariates_contrastive_loss: 634236.9688; val_gene_expr_recon_loss: 2841888.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4819407.6250; val_optim_loss: 4819407.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9504; val_auprc_score: 0.9756; val_best_acc_score: 0.9405; val_best_f1_score: 0.9614; train_kl_reg_loss: 12405.0198; train_edge_recon_loss: 1318248.8017; train_cat_covariates_contrastive_loss: 634132.9009; train_gene_expr_recon_loss: 2852735.6466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4817522.3621; train_optim_loss: 4817522.3621; val_kl_reg_loss: 12212.0273; val_edge_recon_loss: 1358280.8750; val_cat_covariates_contrastive_loss: 633189.0000; val_gene_expr_recon_loss: 2856166.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4859848.3750; val_optim_loss: 4859848.3750
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9561; val_auprc_score: 0.9787; val_best_acc_score: 0.9426; val_best_f1_score: 0.9629; train_kl_reg_loss: 12399.4525; train_edge_recon_loss: 1323076.5776; train_cat_covariates_contrastive_loss: 634284.9246; train_gene_expr_recon_loss: 2848319.0172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4818079.9138; train_optim_loss: 4818079.9138; val_kl_reg_loss: 12117.0024; val_edge_recon_loss: 1320570.8125; val_cat_covariates_contrastive_loss: 635037.1094; val_gene_expr_recon_loss: 2850280.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4818005.8750; val_optim_loss: 4818005.8750
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9543; val_auprc_score: 0.9775; val_best_acc_score: 0.9431; val_best_f1_score: 0.9634; train_kl_reg_loss: 12395.6202; train_edge_recon_loss: 1318016.5388; train_cat_covariates_contrastive_loss: 634095.8341; train_gene_expr_recon_loss: 2852884.1552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4817392.1552; train_optim_loss: 4817392.1552; val_kl_reg_loss: 12189.5222; val_edge_recon_loss: 1322586.9375; val_cat_covariates_contrastive_loss: 632552.8438; val_gene_expr_recon_loss: 2838565.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4805895.0000; val_optim_loss: 4805895.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9559; val_auprc_score: 0.9791; val_best_acc_score: 0.9464; val_best_f1_score: 0.9656; train_kl_reg_loss: 12385.1552; train_edge_recon_loss: 1321117.1466; train_cat_covariates_contrastive_loss: 634549.0345; train_gene_expr_recon_loss: 2847800.8707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4815852.1724; train_optim_loss: 4815852.1724; val_kl_reg_loss: 12154.3865; val_edge_recon_loss: 1284017.9375; val_cat_covariates_contrastive_loss: 634038.1094; val_gene_expr_recon_loss: 2844761.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4774971.7500; val_optim_loss: 4774971.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9502; val_auprc_score: 0.9749; val_best_acc_score: 0.9409; val_best_f1_score: 0.9617; train_kl_reg_loss: 12399.3133; train_edge_recon_loss: 1321147.6379; train_cat_covariates_contrastive_loss: 634003.1875; train_gene_expr_recon_loss: 2848275.6897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4815825.8276; train_optim_loss: 4815825.8276; val_kl_reg_loss: 12194.7192; val_edge_recon_loss: 1333793.4375; val_cat_covariates_contrastive_loss: 633530.7969; val_gene_expr_recon_loss: 2856975.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4836494.7500; val_optim_loss: 4836494.7500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9532; val_auprc_score: 0.9761; val_best_acc_score: 0.9431; val_best_f1_score: 0.9629; train_kl_reg_loss: 12386.5467; train_edge_recon_loss: 1320459.4267; train_cat_covariates_contrastive_loss: 633965.0453; train_gene_expr_recon_loss: 2850429.4052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4817240.3966; train_optim_loss: 4817240.3966; val_kl_reg_loss: 12183.6516; val_edge_recon_loss: 1338220.1562; val_cat_covariates_contrastive_loss: 632156.1875; val_gene_expr_recon_loss: 2841159.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4823719.6250; val_optim_loss: 4823719.6250
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9530; val_auprc_score: 0.9764; val_best_acc_score: 0.9426; val_best_f1_score: 0.9628; train_kl_reg_loss: 12404.7883; train_edge_recon_loss: 1316969.8147; train_cat_covariates_contrastive_loss: 633975.5453; train_gene_expr_recon_loss: 2850402.7155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4813752.8448; train_optim_loss: 4813752.8448; val_kl_reg_loss: 12171.8508; val_edge_recon_loss: 1314584.3750; val_cat_covariates_contrastive_loss: 632665.2031; val_gene_expr_recon_loss: 2847557.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4806979.0000; val_optim_loss: 4806979.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9550; val_auprc_score: 0.9783; val_best_acc_score: 0.9424; val_best_f1_score: 0.9628; train_kl_reg_loss: 12390.6480; train_edge_recon_loss: 1317278.0517; train_cat_covariates_contrastive_loss: 634139.8405; train_gene_expr_recon_loss: 2851880.7759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4815689.2759; train_optim_loss: 4815689.2759; val_kl_reg_loss: 12191.3533; val_edge_recon_loss: 1298018.3750; val_cat_covariates_contrastive_loss: 633080.1250; val_gene_expr_recon_loss: 2846824.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4790113.8750; val_optim_loss: 4790113.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9544; val_auprc_score: 0.9779; val_best_acc_score: 0.9432; val_best_f1_score: 0.9631; train_kl_reg_loss: 12400.0451; train_edge_recon_loss: 1314477.0129; train_cat_covariates_contrastive_loss: 634190.0172; train_gene_expr_recon_loss: 2853979.4914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4815046.5345; train_optim_loss: 4815046.5345; val_kl_reg_loss: 12157.6741; val_edge_recon_loss: 1346632.5938; val_cat_covariates_contrastive_loss: 633162.9375; val_gene_expr_recon_loss: 2857572.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4849525.3750; val_optim_loss: 4849525.3750
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9526; val_auprc_score: 0.9770; val_best_acc_score: 0.9429; val_best_f1_score: 0.9632; train_kl_reg_loss: 12392.8066; train_edge_recon_loss: 1327753.0647; train_cat_covariates_contrastive_loss: 633866.4763; train_gene_expr_recon_loss: 2852505.0690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4826517.3966; train_optim_loss: 4826517.3966; val_kl_reg_loss: 12191.7246; val_edge_recon_loss: 1319261.1562; val_cat_covariates_contrastive_loss: 634649.2500; val_gene_expr_recon_loss: 2853093.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4819195.0000; val_optim_loss: 4819195.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9541; val_auprc_score: 0.9771; val_best_acc_score: 0.9440; val_best_f1_score: 0.9638; train_kl_reg_loss: 12386.9009; train_edge_recon_loss: 1314582.1853; train_cat_covariates_contrastive_loss: 633760.5323; train_gene_expr_recon_loss: 2852998.8966; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4813728.5345; train_optim_loss: 4813728.5345; val_kl_reg_loss: 12176.1001; val_edge_recon_loss: 1332476.5625; val_cat_covariates_contrastive_loss: 633466.9062; val_gene_expr_recon_loss: 2847758.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4825878.6250; val_optim_loss: 4825878.6250
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9546; val_auprc_score: 0.9780; val_best_acc_score: 0.9405; val_best_f1_score: 0.9614; train_kl_reg_loss: 12397.4849; train_edge_recon_loss: 1317539.7155; train_cat_covariates_contrastive_loss: 634323.1444; train_gene_expr_recon_loss: 2849480.2414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4813740.5862; train_optim_loss: 4813740.5862; val_kl_reg_loss: 12182.7371; val_edge_recon_loss: 1346622.0000; val_cat_covariates_contrastive_loss: 633543.7344; val_gene_expr_recon_loss: 2849260.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4841609.2500; val_optim_loss: 4841609.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 15 min 58 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
val AUROC score: 0.9310
val AUPRC score: 0.9616
val best accuracy score: 0.9342
val best F1 score: 0.9572
val target rna MSE score: 1.0540
val source rna MSE score: 0.2378
Val cat covariate0 mean sim diff: 0.0005
Val cat covariate1 mean sim diff: -0.0720
Duration of model training in run 3: 0 hours, 16 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 25413
Number of validation nodes: 2824
Number of training edges: 60794
Number of validation edges: 6754
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8928; val_auprc_score: 0.9607; val_best_acc_score: 0.8465; val_best_f1_score: 0.9021; train_kl_reg_loss: 2637.3317; train_edge_recon_loss: 1853435.7417; train_cat_covariates_contrastive_loss: 807882.5167; train_gene_expr_recon_loss: 4229879.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6893835.0000; train_optim_loss: 6893835.0000; val_kl_reg_loss: 2951.8740; val_edge_recon_loss: 2016319.7500; val_cat_covariates_contrastive_loss: 627469.0000; val_gene_expr_recon_loss: 3984596.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6631337.7500; val_optim_loss: 6631337.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8398; val_auprc_score: 0.9410; val_best_acc_score: 0.8355; val_best_f1_score: 0.9013; train_kl_reg_loss: 2687.9603; train_edge_recon_loss: 1763109.1417; train_cat_covariates_contrastive_loss: 668789.4917; train_gene_expr_recon_loss: 3892634.2667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6327220.9667; train_optim_loss: 6327220.9667; val_kl_reg_loss: 4388.5515; val_edge_recon_loss: 1693586.6875; val_cat_covariates_contrastive_loss: 627561.5625; val_gene_expr_recon_loss: 3785906.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6111443.0000; val_optim_loss: 6111443.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8286; val_auprc_score: 0.9332; val_best_acc_score: 0.8283; val_best_f1_score: 0.8960; train_kl_reg_loss: 8523.4855; train_edge_recon_loss: 1603949.8417; train_cat_covariates_contrastive_loss: 634635.5292; train_gene_expr_recon_loss: 3649421.4333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5896530.2667; train_optim_loss: 5896530.2667; val_kl_reg_loss: 13998.5869; val_edge_recon_loss: 1594456.1250; val_cat_covariates_contrastive_loss: 626845.8438; val_gene_expr_recon_loss: 3526842.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5762142.7500; val_optim_loss: 5762142.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8268; val_auprc_score: 0.9320; val_best_acc_score: 0.8266; val_best_f1_score: 0.8951; train_kl_reg_loss: 21349.2757; train_edge_recon_loss: 1527729.7250; train_cat_covariates_contrastive_loss: 628103.1875; train_gene_expr_recon_loss: 3443609.8833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5620792.0667; train_optim_loss: 5620792.0667; val_kl_reg_loss: 28221.7334; val_edge_recon_loss: 1569098.6250; val_cat_covariates_contrastive_loss: 626743.9688; val_gene_expr_recon_loss: 3361169.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5585234.0000; val_optim_loss: 5585234.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8321; val_auprc_score: 0.9349; val_best_acc_score: 0.8353; val_best_f1_score: 0.8996; train_kl_reg_loss: 32465.9255; train_edge_recon_loss: 1502382.0667; train_cat_covariates_contrastive_loss: 627335.2125; train_gene_expr_recon_loss: 3295803.2167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5457986.4000; train_optim_loss: 5457986.4000; val_kl_reg_loss: 33769.4453; val_edge_recon_loss: 1538400.3125; val_cat_covariates_contrastive_loss: 626784.5000; val_gene_expr_recon_loss: 3229162.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5428116.7500; val_optim_loss: 5428116.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8308; val_auprc_score: 0.9332; val_best_acc_score: 0.8403; val_best_f1_score: 0.9021; train_kl_reg_loss: 33288.1556; train_edge_recon_loss: 1500104.2167; train_cat_covariates_contrastive_loss: 627451.3375; train_gene_expr_recon_loss: 3200312.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5361156.2333; train_optim_loss: 5361156.2333; val_kl_reg_loss: 31233.4883; val_edge_recon_loss: 1503246.1875; val_cat_covariates_contrastive_loss: 626841.9062; val_gene_expr_recon_loss: 3161377.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5322698.7500; val_optim_loss: 5322698.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8439; val_auprc_score: 0.9356; val_best_acc_score: 0.8427; val_best_f1_score: 0.9034; train_kl_reg_loss: 30558.2090; train_edge_recon_loss: 1477183.5667; train_cat_covariates_contrastive_loss: 628227.3542; train_gene_expr_recon_loss: 3141773.7167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5277742.8667; train_optim_loss: 5277742.8667; val_kl_reg_loss: 28091.8887; val_edge_recon_loss: 1528176.4375; val_cat_covariates_contrastive_loss: 627189.4688; val_gene_expr_recon_loss: 3113826.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5297284.0000; val_optim_loss: 5297284.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8486; val_auprc_score: 0.9371; val_best_acc_score: 0.8446; val_best_f1_score: 0.9043; train_kl_reg_loss: 27314.6693; train_edge_recon_loss: 1452518.6083; train_cat_covariates_contrastive_loss: 628779.9250; train_gene_expr_recon_loss: 3103791.1500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5212404.4000; train_optim_loss: 5212404.4000; val_kl_reg_loss: 25140.5254; val_edge_recon_loss: 1504160.0000; val_cat_covariates_contrastive_loss: 627889.0938; val_gene_expr_recon_loss: 3084642.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5241831.5000; val_optim_loss: 5241831.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8612; val_auprc_score: 0.9394; val_best_acc_score: 0.8468; val_best_f1_score: 0.9044; train_kl_reg_loss: 25263.3462; train_edge_recon_loss: 1434046.5333; train_cat_covariates_contrastive_loss: 629506.6167; train_gene_expr_recon_loss: 3075962.0500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5164778.5000; train_optim_loss: 5164778.5000; val_kl_reg_loss: 24489.3975; val_edge_recon_loss: 1496560.6250; val_cat_covariates_contrastive_loss: 628785.2188; val_gene_expr_recon_loss: 3077995.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5227830.2500; val_optim_loss: 5227830.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8696; val_auprc_score: 0.9466; val_best_acc_score: 0.8531; val_best_f1_score: 0.9081; train_kl_reg_loss: 24194.8395; train_edge_recon_loss: 1416666.8583; train_cat_covariates_contrastive_loss: 630739.1708; train_gene_expr_recon_loss: 3051002.0667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5122602.9000; train_optim_loss: 5122602.9000; val_kl_reg_loss: 23179.2129; val_edge_recon_loss: 1461787.3125; val_cat_covariates_contrastive_loss: 630852.1250; val_gene_expr_recon_loss: 3044849.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5160667.7500; val_optim_loss: 5160667.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8810; val_auprc_score: 0.9502; val_best_acc_score: 0.8625; val_best_f1_score: 0.9133; train_kl_reg_loss: 23500.3126; train_edge_recon_loss: 1396098.4667; train_cat_covariates_contrastive_loss: 632227.5125; train_gene_expr_recon_loss: 3033440.3167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5085266.6000; train_optim_loss: 5085266.6000; val_kl_reg_loss: 22634.2520; val_edge_recon_loss: 1452454.1250; val_cat_covariates_contrastive_loss: 631455.8750; val_gene_expr_recon_loss: 3033016.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5139560.5000; val_optim_loss: 5139560.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9025; val_auprc_score: 0.9618; val_best_acc_score: 0.8764; val_best_f1_score: 0.9219; train_kl_reg_loss: 22815.1332; train_edge_recon_loss: 1392428.4333; train_cat_covariates_contrastive_loss: 634097.3125; train_gene_expr_recon_loss: 3018161.6167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5067502.5000; train_optim_loss: 5067502.5000; val_kl_reg_loss: 22023.1035; val_edge_recon_loss: 1380956.6250; val_cat_covariates_contrastive_loss: 633494.3750; val_gene_expr_recon_loss: 3012546.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5049020.5000; val_optim_loss: 5049020.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8973; val_auprc_score: 0.9571; val_best_acc_score: 0.8772; val_best_f1_score: 0.9217; train_kl_reg_loss: 22190.5421; train_edge_recon_loss: 1374846.8833; train_cat_covariates_contrastive_loss: 635590.0042; train_gene_expr_recon_loss: 3002627.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5035255.2667; train_optim_loss: 5035255.2667; val_kl_reg_loss: 21812.1445; val_edge_recon_loss: 1433489.4375; val_cat_covariates_contrastive_loss: 634606.7812; val_gene_expr_recon_loss: 3007874.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5097783.2500; val_optim_loss: 5097783.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9013; val_auprc_score: 0.9596; val_best_acc_score: 0.8813; val_best_f1_score: 0.9253; train_kl_reg_loss: 22544.0781; train_edge_recon_loss: 1362961.4000; train_cat_covariates_contrastive_loss: 635870.0042; train_gene_expr_recon_loss: 2990929.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5012304.8667; train_optim_loss: 5012304.8667; val_kl_reg_loss: 21890.5508; val_edge_recon_loss: 1382322.2500; val_cat_covariates_contrastive_loss: 636206.8750; val_gene_expr_recon_loss: 2997380.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5037800.5000; val_optim_loss: 5037800.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9097; val_auprc_score: 0.9627; val_best_acc_score: 0.8852; val_best_f1_score: 0.9271; train_kl_reg_loss: 22287.7794; train_edge_recon_loss: 1364201.9000; train_cat_covariates_contrastive_loss: 635827.1208; train_gene_expr_recon_loss: 2980317.9500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5002634.7333; train_optim_loss: 5002634.7333; val_kl_reg_loss: 21760.3965; val_edge_recon_loss: 1407737.6250; val_cat_covariates_contrastive_loss: 635715.5938; val_gene_expr_recon_loss: 2995157.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5060371.2500; val_optim_loss: 5060371.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9050; val_auprc_score: 0.9577; val_best_acc_score: 0.8850; val_best_f1_score: 0.9268; train_kl_reg_loss: 21889.9646; train_edge_recon_loss: 1352236.3583; train_cat_covariates_contrastive_loss: 635797.2625; train_gene_expr_recon_loss: 2965923.4333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4975847.0333; train_optim_loss: 4975847.0333; val_kl_reg_loss: 21031.7275; val_edge_recon_loss: 1390144.2500; val_cat_covariates_contrastive_loss: 634782.5625; val_gene_expr_recon_loss: 2975975.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5021933.7500; val_optim_loss: 5021933.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9155; val_auprc_score: 0.9633; val_best_acc_score: 0.8880; val_best_f1_score: 0.9284; train_kl_reg_loss: 21293.0984; train_edge_recon_loss: 1368985.5250; train_cat_covariates_contrastive_loss: 635604.2875; train_gene_expr_recon_loss: 2960057.8667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4985940.8000; train_optim_loss: 4985940.8000; val_kl_reg_loss: 20271.8535; val_edge_recon_loss: 1407474.3125; val_cat_covariates_contrastive_loss: 636643.7188; val_gene_expr_recon_loss: 2954100.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5018490.5000; val_optim_loss: 5018490.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9079; val_auprc_score: 0.9571; val_best_acc_score: 0.8862; val_best_f1_score: 0.9271; train_kl_reg_loss: 20631.4419; train_edge_recon_loss: 1358078.2500; train_cat_covariates_contrastive_loss: 636314.6708; train_gene_expr_recon_loss: 2951655.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4966679.8000; train_optim_loss: 4966679.8000; val_kl_reg_loss: 20103.4336; val_edge_recon_loss: 1431823.6250; val_cat_covariates_contrastive_loss: 636535.6562; val_gene_expr_recon_loss: 2957823.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5046285.7500; val_optim_loss: 5046285.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9172; val_auprc_score: 0.9638; val_best_acc_score: 0.8908; val_best_f1_score: 0.9298; train_kl_reg_loss: 19868.6629; train_edge_recon_loss: 1349524.5333; train_cat_covariates_contrastive_loss: 635693.9292; train_gene_expr_recon_loss: 2937709.4333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4942796.5667; train_optim_loss: 4942796.5667; val_kl_reg_loss: 18938.7285; val_edge_recon_loss: 1404259.0000; val_cat_covariates_contrastive_loss: 635341.2812; val_gene_expr_recon_loss: 2931941.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4990480.5000; val_optim_loss: 4990480.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9198; val_auprc_score: 0.9666; val_best_acc_score: 0.8952; val_best_f1_score: 0.9332; train_kl_reg_loss: 19384.3729; train_edge_recon_loss: 1356677.3500; train_cat_covariates_contrastive_loss: 636174.8000; train_gene_expr_recon_loss: 2935263.4667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4947500.0333; train_optim_loss: 4947500.0333; val_kl_reg_loss: 18448.4551; val_edge_recon_loss: 1368497.1875; val_cat_covariates_contrastive_loss: 635558.0938; val_gene_expr_recon_loss: 2934683.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4957187.0000; val_optim_loss: 4957187.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9228; val_auprc_score: 0.9667; val_best_acc_score: 0.8967; val_best_f1_score: 0.9340; train_kl_reg_loss: 18409.7072; train_edge_recon_loss: 1343636.9917; train_cat_covariates_contrastive_loss: 636606.5542; train_gene_expr_recon_loss: 2929646.7333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4928300.0333; train_optim_loss: 4928300.0333; val_kl_reg_loss: 17529.0547; val_edge_recon_loss: 1373244.7500; val_cat_covariates_contrastive_loss: 635039.5625; val_gene_expr_recon_loss: 2924300.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4950114.0000; val_optim_loss: 4950114.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9291; val_auprc_score: 0.9687; val_best_acc_score: 0.8993; val_best_f1_score: 0.9363; train_kl_reg_loss: 18169.4359; train_edge_recon_loss: 1336883.8167; train_cat_covariates_contrastive_loss: 637210.7583; train_gene_expr_recon_loss: 2922672.6167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4914936.6333; train_optim_loss: 4914936.6333; val_kl_reg_loss: 17327.4521; val_edge_recon_loss: 1386434.0000; val_cat_covariates_contrastive_loss: 638433.3750; val_gene_expr_recon_loss: 2913198.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4955393.0000; val_optim_loss: 4955393.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9219; val_auprc_score: 0.9671; val_best_acc_score: 0.8993; val_best_f1_score: 0.9364; train_kl_reg_loss: 17382.7871; train_edge_recon_loss: 1347520.0750; train_cat_covariates_contrastive_loss: 636967.8375; train_gene_expr_recon_loss: 2914873.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4916744.3333; train_optim_loss: 4916744.3333; val_kl_reg_loss: 16795.8535; val_edge_recon_loss: 1359992.1875; val_cat_covariates_contrastive_loss: 637513.6875; val_gene_expr_recon_loss: 2919660.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4933962.5000; val_optim_loss: 4933962.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9217; val_auprc_score: 0.9634; val_best_acc_score: 0.8976; val_best_f1_score: 0.9337; train_kl_reg_loss: 17290.7066; train_edge_recon_loss: 1341876.1667; train_cat_covariates_contrastive_loss: 637161.1000; train_gene_expr_recon_loss: 2910211.0667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4906539.0667; train_optim_loss: 4906539.0667; val_kl_reg_loss: 16504.8271; val_edge_recon_loss: 1412803.1875; val_cat_covariates_contrastive_loss: 635923.9062; val_gene_expr_recon_loss: 2920600.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4985832.5000; val_optim_loss: 4985832.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9342; val_auprc_score: 0.9701; val_best_acc_score: 0.9089; val_best_f1_score: 0.9415; train_kl_reg_loss: 16767.8191; train_edge_recon_loss: 1330311.9250; train_cat_covariates_contrastive_loss: 637440.4167; train_gene_expr_recon_loss: 2899554.5500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4884074.7000; train_optim_loss: 4884074.7000; val_kl_reg_loss: 16354.2197; val_edge_recon_loss: 1375979.6875; val_cat_covariates_contrastive_loss: 635891.9375; val_gene_expr_recon_loss: 2899891.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4928117.7500; val_optim_loss: 4928117.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9285; val_auprc_score: 0.9672; val_best_acc_score: 0.9056; val_best_f1_score: 0.9397; train_kl_reg_loss: 16465.0751; train_edge_recon_loss: 1350713.6000; train_cat_covariates_contrastive_loss: 637590.4083; train_gene_expr_recon_loss: 2897430.6833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4902199.7667; train_optim_loss: 4902199.7667; val_kl_reg_loss: 15849.9771; val_edge_recon_loss: 1385165.0625; val_cat_covariates_contrastive_loss: 634882.5625; val_gene_expr_recon_loss: 2913228.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4949126.5000; val_optim_loss: 4949126.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9347; val_auprc_score: 0.9692; val_best_acc_score: 0.9147; val_best_f1_score: 0.9449; train_kl_reg_loss: 15978.6843; train_edge_recon_loss: 1327293.6000; train_cat_covariates_contrastive_loss: 637088.4708; train_gene_expr_recon_loss: 2893478.6500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4873839.4667; train_optim_loss: 4873839.4667; val_kl_reg_loss: 15428.3979; val_edge_recon_loss: 1359712.8125; val_cat_covariates_contrastive_loss: 636789.4062; val_gene_expr_recon_loss: 2906217.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4918147.7500; val_optim_loss: 4918147.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9378; val_auprc_score: 0.9720; val_best_acc_score: 0.9174; val_best_f1_score: 0.9468; train_kl_reg_loss: 15778.0260; train_edge_recon_loss: 1328967.7750; train_cat_covariates_contrastive_loss: 636927.3042; train_gene_expr_recon_loss: 2886556.7667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4868229.8000; train_optim_loss: 4868229.8000; val_kl_reg_loss: 15326.0049; val_edge_recon_loss: 1369793.5000; val_cat_covariates_contrastive_loss: 637243.5000; val_gene_expr_recon_loss: 2898403.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4920766.2500; val_optim_loss: 4920766.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9463; val_auprc_score: 0.9768; val_best_acc_score: 0.9219; val_best_f1_score: 0.9502; train_kl_reg_loss: 15606.6330; train_edge_recon_loss: 1332940.0417; train_cat_covariates_contrastive_loss: 637085.0625; train_gene_expr_recon_loss: 2887166.2833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4872798.0333; train_optim_loss: 4872798.0333; val_kl_reg_loss: 15049.4355; val_edge_recon_loss: 1338892.0000; val_cat_covariates_contrastive_loss: 638036.3750; val_gene_expr_recon_loss: 2883024.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4875002.0000; val_optim_loss: 4875002.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9391; val_auprc_score: 0.9693; val_best_acc_score: 0.9204; val_best_f1_score: 0.9490; train_kl_reg_loss: 15333.1917; train_edge_recon_loss: 1331998.8917; train_cat_covariates_contrastive_loss: 636400.4000; train_gene_expr_recon_loss: 2880085.7000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4863818.2333; train_optim_loss: 4863818.2333; val_kl_reg_loss: 15113.3359; val_edge_recon_loss: 1358618.0000; val_cat_covariates_contrastive_loss: 637739.2500; val_gene_expr_recon_loss: 2907839.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4919310.5000; val_optim_loss: 4919310.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9393; val_auprc_score: 0.9706; val_best_acc_score: 0.9219; val_best_f1_score: 0.9498; train_kl_reg_loss: 15190.2008; train_edge_recon_loss: 1323800.2917; train_cat_covariates_contrastive_loss: 636712.8750; train_gene_expr_recon_loss: 2873776.0500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4849479.3667; train_optim_loss: 4849479.3667; val_kl_reg_loss: 14922.4111; val_edge_recon_loss: 1373632.5000; val_cat_covariates_contrastive_loss: 635325.6250; val_gene_expr_recon_loss: 2888635.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4912515.7500; val_optim_loss: 4912515.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9420; val_auprc_score: 0.9731; val_best_acc_score: 0.9262; val_best_f1_score: 0.9528; train_kl_reg_loss: 15105.4298; train_edge_recon_loss: 1333239.4000; train_cat_covariates_contrastive_loss: 636862.6083; train_gene_expr_recon_loss: 2870496.8667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4855704.2667; train_optim_loss: 4855704.2667; val_kl_reg_loss: 14650.0234; val_edge_recon_loss: 1338628.5625; val_cat_covariates_contrastive_loss: 636416.4375; val_gene_expr_recon_loss: 2884891.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4874586.7500; val_optim_loss: 4874586.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9372; val_auprc_score: 0.9695; val_best_acc_score: 0.9226; val_best_f1_score: 0.9501; train_kl_reg_loss: 15029.4317; train_edge_recon_loss: 1327557.9250; train_cat_covariates_contrastive_loss: 636599.5917; train_gene_expr_recon_loss: 2871909.6500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4851096.6333; train_optim_loss: 4851096.6333; val_kl_reg_loss: 14205.3379; val_edge_recon_loss: 1363365.0625; val_cat_covariates_contrastive_loss: 636834.5938; val_gene_expr_recon_loss: 2862433.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4876838.2500; val_optim_loss: 4876838.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9449; val_auprc_score: 0.9740; val_best_acc_score: 0.9282; val_best_f1_score: 0.9540; train_kl_reg_loss: 14824.3619; train_edge_recon_loss: 1326363.8000; train_cat_covariates_contrastive_loss: 636516.9750; train_gene_expr_recon_loss: 2859604.8167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4837309.9667; train_optim_loss: 4837309.9667; val_kl_reg_loss: 14590.4980; val_edge_recon_loss: 1315147.8125; val_cat_covariates_contrastive_loss: 635998.8750; val_gene_expr_recon_loss: 2861638.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4827375.7500; val_optim_loss: 4827375.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9359; val_auprc_score: 0.9685; val_best_acc_score: 0.9258; val_best_f1_score: 0.9524; train_kl_reg_loss: 14712.2576; train_edge_recon_loss: 1317359.6333; train_cat_covariates_contrastive_loss: 636587.4125; train_gene_expr_recon_loss: 2855628.5167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4824287.8667; train_optim_loss: 4824287.8667; val_kl_reg_loss: 14380.9634; val_edge_recon_loss: 1330514.0625; val_cat_covariates_contrastive_loss: 635778.1875; val_gene_expr_recon_loss: 2854561.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4835234.5000; val_optim_loss: 4835234.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9478; val_auprc_score: 0.9761; val_best_acc_score: 0.9262; val_best_f1_score: 0.9523; train_kl_reg_loss: 14646.4983; train_edge_recon_loss: 1329541.2500; train_cat_covariates_contrastive_loss: 636843.6042; train_gene_expr_recon_loss: 2850981.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4832012.3667; train_optim_loss: 4832012.3667; val_kl_reg_loss: 14076.7661; val_edge_recon_loss: 1351858.6875; val_cat_covariates_contrastive_loss: 635888.4688; val_gene_expr_recon_loss: 2860666.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4862490.5000; val_optim_loss: 4862490.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9457; val_auprc_score: 0.9754; val_best_acc_score: 0.9286; val_best_f1_score: 0.9542; train_kl_reg_loss: 14447.3079; train_edge_recon_loss: 1313162.0417; train_cat_covariates_contrastive_loss: 636258.4958; train_gene_expr_recon_loss: 2846190.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4810058.4000; train_optim_loss: 4810058.4000; val_kl_reg_loss: 13911.5049; val_edge_recon_loss: 1335703.3750; val_cat_covariates_contrastive_loss: 637622.7812; val_gene_expr_recon_loss: 2853043.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4840281.2500; val_optim_loss: 4840281.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9421; val_auprc_score: 0.9714; val_best_acc_score: 0.9280; val_best_f1_score: 0.9535; train_kl_reg_loss: 14365.2167; train_edge_recon_loss: 1318076.2750; train_cat_covariates_contrastive_loss: 636506.3167; train_gene_expr_recon_loss: 2844995.3500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4813943.2000; train_optim_loss: 4813943.2000; val_kl_reg_loss: 13913.8389; val_edge_recon_loss: 1358063.8750; val_cat_covariates_contrastive_loss: 634929.0938; val_gene_expr_recon_loss: 2857417.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4864324.0000; val_optim_loss: 4864324.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9418; val_auprc_score: 0.9729; val_best_acc_score: 0.9285; val_best_f1_score: 0.9541; train_kl_reg_loss: 14346.3839; train_edge_recon_loss: 1325868.9500; train_cat_covariates_contrastive_loss: 635936.2250; train_gene_expr_recon_loss: 2841503.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4817655.4000; train_optim_loss: 4817655.4000; val_kl_reg_loss: 14049.0347; val_edge_recon_loss: 1335309.2500; val_cat_covariates_contrastive_loss: 633486.2188; val_gene_expr_recon_loss: 2867261.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4850105.7500; val_optim_loss: 4850105.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9402; val_auprc_score: 0.9708; val_best_acc_score: 0.9280; val_best_f1_score: 0.9542; train_kl_reg_loss: 14308.0758; train_edge_recon_loss: 1337398.5583; train_cat_covariates_contrastive_loss: 636222.5417; train_gene_expr_recon_loss: 2840000.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4827929.2667; train_optim_loss: 4827929.2667; val_kl_reg_loss: 14057.9092; val_edge_recon_loss: 1324685.7500; val_cat_covariates_contrastive_loss: 635302.7812; val_gene_expr_recon_loss: 2867150.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4841196.7500; val_optim_loss: 4841196.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9378; val_auprc_score: 0.9703; val_best_acc_score: 0.9286; val_best_f1_score: 0.9545; train_kl_reg_loss: 14376.0673; train_edge_recon_loss: 1325082.1583; train_cat_covariates_contrastive_loss: 636336.5667; train_gene_expr_recon_loss: 2838282.0333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4814076.8667; train_optim_loss: 4814076.8667; val_kl_reg_loss: 13951.2759; val_edge_recon_loss: 1336722.2500; val_cat_covariates_contrastive_loss: 633952.3125; val_gene_expr_recon_loss: 2846848.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4831474.2500; val_optim_loss: 4831474.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9402; val_auprc_score: 0.9706; val_best_acc_score: 0.9280; val_best_f1_score: 0.9540; train_kl_reg_loss: 14281.7432; train_edge_recon_loss: 1319272.1500; train_cat_covariates_contrastive_loss: 635906.8833; train_gene_expr_recon_loss: 2839744.1333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4809205.0333; train_optim_loss: 4809205.0333; val_kl_reg_loss: 13931.8882; val_edge_recon_loss: 1339696.0625; val_cat_covariates_contrastive_loss: 636391.2812; val_gene_expr_recon_loss: 2855444.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4845464.0000; val_optim_loss: 4845464.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 56 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
val AUROC score: 0.9231
val AUPRC score: 0.9571
val best accuracy score: 0.9189
val best F1 score: 0.9470
val target rna MSE score: 1.0243
val source rna MSE score: 0.3339
Val cat covariate0 mean sim diff: 0.0034
Val cat covariate1 mean sim diff: -0.0598
Duration of model training in run 2: 0 hours, 7 minutes and 1 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 25413
Number of validation nodes: 2824
Number of training edges: 60794
Number of validation edges: 6754
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8988; val_auprc_score: 0.9599; val_best_acc_score: 0.8337; val_best_f1_score: 0.8867; train_kl_reg_loss: 3001.9268; train_edge_recon_loss: 1868016.1833; train_cat_covariates_contrastive_loss: 794825.2000; train_gene_expr_recon_loss: 4147046.4500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6812889.7000; train_optim_loss: 6812889.7000; val_kl_reg_loss: 2523.3809; val_edge_recon_loss: 2045975.0625; val_cat_covariates_contrastive_loss: 627637.8750; val_gene_expr_recon_loss: 3938429.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6614565.7500; val_optim_loss: 6614565.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8211; val_auprc_score: 0.9301; val_best_acc_score: 0.8292; val_best_f1_score: 0.8971; train_kl_reg_loss: 3123.4670; train_edge_recon_loss: 1736438.2750; train_cat_covariates_contrastive_loss: 664931.3583; train_gene_expr_recon_loss: 3833799.0500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6238292.2000; train_optim_loss: 6238292.2000; val_kl_reg_loss: 5334.4038; val_edge_recon_loss: 1701087.0000; val_cat_covariates_contrastive_loss: 627401.1562; val_gene_expr_recon_loss: 3698999.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6032822.0000; val_optim_loss: 6032822.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8169; val_auprc_score: 0.9279; val_best_acc_score: 0.8279; val_best_f1_score: 0.8966; train_kl_reg_loss: 9622.9110; train_edge_recon_loss: 1583949.9500; train_cat_covariates_contrastive_loss: 633105.6917; train_gene_expr_recon_loss: 3622769.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5849447.7333; train_optim_loss: 5849447.7333; val_kl_reg_loss: 15757.0532; val_edge_recon_loss: 1596790.5625; val_cat_covariates_contrastive_loss: 626930.2500; val_gene_expr_recon_loss: 3517172.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5756649.7500; val_optim_loss: 5756649.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8198; val_auprc_score: 0.9294; val_best_acc_score: 0.8267; val_best_f1_score: 0.8954; train_kl_reg_loss: 22694.1651; train_edge_recon_loss: 1524782.6250; train_cat_covariates_contrastive_loss: 627542.1542; train_gene_expr_recon_loss: 3435491.3667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5610510.2667; train_optim_loss: 5610510.2667; val_kl_reg_loss: 28565.7803; val_edge_recon_loss: 1556061.6250; val_cat_covariates_contrastive_loss: 626794.6562; val_gene_expr_recon_loss: 3352418.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5563840.5000; val_optim_loss: 5563840.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8308; val_auprc_score: 0.9335; val_best_acc_score: 0.8346; val_best_f1_score: 0.8992; train_kl_reg_loss: 30975.0430; train_edge_recon_loss: 1504448.1500; train_cat_covariates_contrastive_loss: 627094.0500; train_gene_expr_recon_loss: 3302130.2667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5464647.5000; train_optim_loss: 5464647.5000; val_kl_reg_loss: 32091.6758; val_edge_recon_loss: 1545137.3750; val_cat_covariates_contrastive_loss: 626858.7188; val_gene_expr_recon_loss: 3265877.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5469965.2500; val_optim_loss: 5469965.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8408; val_auprc_score: 0.9370; val_best_acc_score: 0.8415; val_best_f1_score: 0.9038; train_kl_reg_loss: 30913.5802; train_edge_recon_loss: 1486460.1750; train_cat_covariates_contrastive_loss: 627521.7042; train_gene_expr_recon_loss: 3215631.1833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5360526.6333; train_optim_loss: 5360526.6333; val_kl_reg_loss: 28240.7021; val_edge_recon_loss: 1490522.8750; val_cat_covariates_contrastive_loss: 626976.3750; val_gene_expr_recon_loss: 3164794.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5310534.5000; val_optim_loss: 5310534.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8574; val_auprc_score: 0.9395; val_best_acc_score: 0.8454; val_best_f1_score: 0.9039; train_kl_reg_loss: 27626.5132; train_edge_recon_loss: 1465494.8333; train_cat_covariates_contrastive_loss: 628353.1458; train_gene_expr_recon_loss: 3152773.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5274247.7667; train_optim_loss: 5274247.7667; val_kl_reg_loss: 25258.3438; val_edge_recon_loss: 1526614.2500; val_cat_covariates_contrastive_loss: 627701.0000; val_gene_expr_recon_loss: 3141080.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5320654.0000; val_optim_loss: 5320654.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8744; val_auprc_score: 0.9482; val_best_acc_score: 0.8600; val_best_f1_score: 0.9134; train_kl_reg_loss: 24725.4512; train_edge_recon_loss: 1442077.1333; train_cat_covariates_contrastive_loss: 629681.3583; train_gene_expr_recon_loss: 3112167.1833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5208651.0667; train_optim_loss: 5208651.0667; val_kl_reg_loss: 23153.1270; val_edge_recon_loss: 1426326.1875; val_cat_covariates_contrastive_loss: 628764.8750; val_gene_expr_recon_loss: 3084399.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5162643.5000; val_optim_loss: 5162643.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8729; val_auprc_score: 0.9471; val_best_acc_score: 0.8466; val_best_f1_score: 0.9042; train_kl_reg_loss: 23779.9510; train_edge_recon_loss: 1397313.8500; train_cat_covariates_contrastive_loss: 630857.5208; train_gene_expr_recon_loss: 3070344.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5122295.5000; train_optim_loss: 5122295.5000; val_kl_reg_loss: 22658.1816; val_edge_recon_loss: 1459522.3750; val_cat_covariates_contrastive_loss: 629797.9375; val_gene_expr_recon_loss: 3059658.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5171637.0000; val_optim_loss: 5171637.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8839; val_auprc_score: 0.9525; val_best_acc_score: 0.8561; val_best_f1_score: 0.9099; train_kl_reg_loss: 23397.8563; train_edge_recon_loss: 1410749.7833; train_cat_covariates_contrastive_loss: 632466.0000; train_gene_expr_recon_loss: 3045627.5333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5112241.1333; train_optim_loss: 5112241.1333; val_kl_reg_loss: 22187.3252; val_edge_recon_loss: 1440038.5000; val_cat_covariates_contrastive_loss: 631727.7500; val_gene_expr_recon_loss: 3034956.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5128910.5000; val_optim_loss: 5128910.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8931; val_auprc_score: 0.9574; val_best_acc_score: 0.8610; val_best_f1_score: 0.9129; train_kl_reg_loss: 22556.6224; train_edge_recon_loss: 1391587.0083; train_cat_covariates_contrastive_loss: 633865.2583; train_gene_expr_recon_loss: 3023172.9000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5071181.8000; train_optim_loss: 5071181.8000; val_kl_reg_loss: 21863.8359; val_edge_recon_loss: 1429174.6250; val_cat_covariates_contrastive_loss: 634289.7812; val_gene_expr_recon_loss: 3010874.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5096202.2500; val_optim_loss: 5096202.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8951; val_auprc_score: 0.9558; val_best_acc_score: 0.8723; val_best_f1_score: 0.9194; train_kl_reg_loss: 22029.2975; train_edge_recon_loss: 1375149.6000; train_cat_covariates_contrastive_loss: 635671.8500; train_gene_expr_recon_loss: 3010370.3167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5043221.0000; train_optim_loss: 5043221.0000; val_kl_reg_loss: 21414.7979; val_edge_recon_loss: 1437053.0625; val_cat_covariates_contrastive_loss: 633916.6250; val_gene_expr_recon_loss: 3007971.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5100356.5000; val_optim_loss: 5100356.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9033; val_auprc_score: 0.9595; val_best_acc_score: 0.8871; val_best_f1_score: 0.9286; train_kl_reg_loss: 21469.8572; train_edge_recon_loss: 1379148.2750; train_cat_covariates_contrastive_loss: 636520.8917; train_gene_expr_recon_loss: 3002535.7833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5039674.7667; train_optim_loss: 5039674.7667; val_kl_reg_loss: 20663.8701; val_edge_recon_loss: 1363499.0625; val_cat_covariates_contrastive_loss: 635165.3438; val_gene_expr_recon_loss: 2988989.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5008317.5000; val_optim_loss: 5008317.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9073; val_auprc_score: 0.9595; val_best_acc_score: 0.8818; val_best_f1_score: 0.9254; train_kl_reg_loss: 21212.6115; train_edge_recon_loss: 1373891.2667; train_cat_covariates_contrastive_loss: 636421.0833; train_gene_expr_recon_loss: 2982077.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5013602.6333; train_optim_loss: 5013602.6333; val_kl_reg_loss: 20770.0684; val_edge_recon_loss: 1424080.1875; val_cat_covariates_contrastive_loss: 635955.8438; val_gene_expr_recon_loss: 2977601.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5058407.7500; val_optim_loss: 5058407.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9104; val_auprc_score: 0.9610; val_best_acc_score: 0.8906; val_best_f1_score: 0.9307; train_kl_reg_loss: 21082.8681; train_edge_recon_loss: 1352962.7583; train_cat_covariates_contrastive_loss: 636820.5958; train_gene_expr_recon_loss: 2972286.1333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4983152.2667; train_optim_loss: 4983152.2667; val_kl_reg_loss: 20615.2988; val_edge_recon_loss: 1373451.3125; val_cat_covariates_contrastive_loss: 635367.8438; val_gene_expr_recon_loss: 2967256.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4996691.2500; val_optim_loss: 4996691.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9115; val_auprc_score: 0.9599; val_best_acc_score: 0.8836; val_best_f1_score: 0.9266; train_kl_reg_loss: 20310.3681; train_edge_recon_loss: 1354775.3417; train_cat_covariates_contrastive_loss: 636677.5917; train_gene_expr_recon_loss: 2959309.7333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4971073.0000; train_optim_loss: 4971073.0000; val_kl_reg_loss: 19663.5254; val_edge_recon_loss: 1421022.2500; val_cat_covariates_contrastive_loss: 634653.3438; val_gene_expr_recon_loss: 2955201.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5030541.0000; val_optim_loss: 5030541.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9155; val_auprc_score: 0.9633; val_best_acc_score: 0.8878; val_best_f1_score: 0.9285; train_kl_reg_loss: 19795.5857; train_edge_recon_loss: 1352494.9417; train_cat_covariates_contrastive_loss: 636974.8750; train_gene_expr_recon_loss: 2954029.3000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4963294.7000; train_optim_loss: 4963294.7000; val_kl_reg_loss: 18872.6641; val_edge_recon_loss: 1398291.0625; val_cat_covariates_contrastive_loss: 636386.5312; val_gene_expr_recon_loss: 2956047.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5009597.5000; val_optim_loss: 5009597.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9182; val_auprc_score: 0.9650; val_best_acc_score: 0.8913; val_best_f1_score: 0.9312; train_kl_reg_loss: 18958.3553; train_edge_recon_loss: 1345507.0083; train_cat_covariates_contrastive_loss: 636249.9250; train_gene_expr_recon_loss: 2943097.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4943812.9000; train_optim_loss: 4943812.9000; val_kl_reg_loss: 18547.2012; val_edge_recon_loss: 1388377.1250; val_cat_covariates_contrastive_loss: 637923.0000; val_gene_expr_recon_loss: 2952759.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4997606.7500; val_optim_loss: 4997606.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9205; val_auprc_score: 0.9663; val_best_acc_score: 0.8930; val_best_f1_score: 0.9321; train_kl_reg_loss: 18250.3090; train_edge_recon_loss: 1348988.8417; train_cat_covariates_contrastive_loss: 636858.9917; train_gene_expr_recon_loss: 2938111.3833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4942209.5667; train_optim_loss: 4942209.5667; val_kl_reg_loss: 17432.3418; val_edge_recon_loss: 1357292.1250; val_cat_covariates_contrastive_loss: 636047.1250; val_gene_expr_recon_loss: 2941337.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4952108.5000; val_optim_loss: 4952108.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9248; val_auprc_score: 0.9647; val_best_acc_score: 0.8988; val_best_f1_score: 0.9354; train_kl_reg_loss: 17705.0729; train_edge_recon_loss: 1344511.6917; train_cat_covariates_contrastive_loss: 637170.3000; train_gene_expr_recon_loss: 2926810.6333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4926197.7000; train_optim_loss: 4926197.7000; val_kl_reg_loss: 17176.0215; val_edge_recon_loss: 1405348.1250; val_cat_covariates_contrastive_loss: 635374.1250; val_gene_expr_recon_loss: 2933605.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4991504.2500; val_optim_loss: 4991504.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9246; val_auprc_score: 0.9678; val_best_acc_score: 0.9004; val_best_f1_score: 0.9370; train_kl_reg_loss: 17153.1941; train_edge_recon_loss: 1344737.2917; train_cat_covariates_contrastive_loss: 636861.1417; train_gene_expr_recon_loss: 2924345.4833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4923097.1000; train_optim_loss: 4923097.1000; val_kl_reg_loss: 16351.4585; val_edge_recon_loss: 1364256.3750; val_cat_covariates_contrastive_loss: 638740.2500; val_gene_expr_recon_loss: 2908672.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4928020.2500; val_optim_loss: 4928020.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9247; val_auprc_score: 0.9666; val_best_acc_score: 0.8975; val_best_f1_score: 0.9344; train_kl_reg_loss: 16645.9368; train_edge_recon_loss: 1336725.8167; train_cat_covariates_contrastive_loss: 637656.8917; train_gene_expr_recon_loss: 2917174.9000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4908203.6000; train_optim_loss: 4908203.6000; val_kl_reg_loss: 15884.7183; val_edge_recon_loss: 1382168.1250; val_cat_covariates_contrastive_loss: 637109.6875; val_gene_expr_recon_loss: 2911307.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4946469.5000; val_optim_loss: 4946469.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9358; val_auprc_score: 0.9727; val_best_acc_score: 0.9124; val_best_f1_score: 0.9441; train_kl_reg_loss: 15826.3516; train_edge_recon_loss: 1342136.9833; train_cat_covariates_contrastive_loss: 637431.3125; train_gene_expr_recon_loss: 2909058.6500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4904453.2667; train_optim_loss: 4904453.2667; val_kl_reg_loss: 15785.1445; val_edge_recon_loss: 1320918.3125; val_cat_covariates_contrastive_loss: 640932.9688; val_gene_expr_recon_loss: 2914519.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4892155.5000; val_optim_loss: 4892155.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9362; val_auprc_score: 0.9708; val_best_acc_score: 0.9127; val_best_f1_score: 0.9433; train_kl_reg_loss: 15911.7606; train_edge_recon_loss: 1331966.5917; train_cat_covariates_contrastive_loss: 638606.9875; train_gene_expr_recon_loss: 2909333.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4895818.9667; train_optim_loss: 4895818.9667; val_kl_reg_loss: 15587.5098; val_edge_recon_loss: 1378123.3125; val_cat_covariates_contrastive_loss: 635361.1875; val_gene_expr_recon_loss: 2921555.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4950627.0000; val_optim_loss: 4950627.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9411; val_auprc_score: 0.9729; val_best_acc_score: 0.9131; val_best_f1_score: 0.9443; train_kl_reg_loss: 15516.9370; train_edge_recon_loss: 1325677.3250; train_cat_covariates_contrastive_loss: 637394.6542; train_gene_expr_recon_loss: 2900682.7667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4879271.7333; train_optim_loss: 4879271.7333; val_kl_reg_loss: 15025.3940; val_edge_recon_loss: 1340817.9375; val_cat_covariates_contrastive_loss: 636701.5000; val_gene_expr_recon_loss: 2911257.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4903802.7500; val_optim_loss: 4903802.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9325; val_auprc_score: 0.9687; val_best_acc_score: 0.9136; val_best_f1_score: 0.9450; train_kl_reg_loss: 15274.0506; train_edge_recon_loss: 1334061.8333; train_cat_covariates_contrastive_loss: 637482.5625; train_gene_expr_recon_loss: 2893417.8667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4880236.3333; train_optim_loss: 4880236.3333; val_kl_reg_loss: 14907.1353; val_edge_recon_loss: 1355788.0625; val_cat_covariates_contrastive_loss: 641410.3438; val_gene_expr_recon_loss: 2895336.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4907442.0000; val_optim_loss: 4907442.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9414; val_auprc_score: 0.9719; val_best_acc_score: 0.9161; val_best_f1_score: 0.9458; train_kl_reg_loss: 14981.1465; train_edge_recon_loss: 1322447.7250; train_cat_covariates_contrastive_loss: 637642.5875; train_gene_expr_recon_loss: 2888737.4333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4863808.9333; train_optim_loss: 4863808.9333; val_kl_reg_loss: 14598.3433; val_edge_recon_loss: 1404052.1875; val_cat_covariates_contrastive_loss: 637217.1250; val_gene_expr_recon_loss: 2889440.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4945308.2500; val_optim_loss: 4945308.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9442; val_auprc_score: 0.9751; val_best_acc_score: 0.9185; val_best_f1_score: 0.9477; train_kl_reg_loss: 14960.7900; train_edge_recon_loss: 1330740.7417; train_cat_covariates_contrastive_loss: 637987.0792; train_gene_expr_recon_loss: 2881937.4333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4865626.1333; train_optim_loss: 4865626.1333; val_kl_reg_loss: 14827.0059; val_edge_recon_loss: 1361753.1875; val_cat_covariates_contrastive_loss: 637469.9375; val_gene_expr_recon_loss: 2900047.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4914097.0000; val_optim_loss: 4914097.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9410; val_auprc_score: 0.9720; val_best_acc_score: 0.9212; val_best_f1_score: 0.9491; train_kl_reg_loss: 14938.3894; train_edge_recon_loss: 1330412.3667; train_cat_covariates_contrastive_loss: 638475.6042; train_gene_expr_recon_loss: 2884439.8667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4868266.3333; train_optim_loss: 4868266.3333; val_kl_reg_loss: 14727.1714; val_edge_recon_loss: 1369015.3125; val_cat_covariates_contrastive_loss: 635036.5312; val_gene_expr_recon_loss: 2890278.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4909057.0000; val_optim_loss: 4909057.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9379; val_auprc_score: 0.9720; val_best_acc_score: 0.9209; val_best_f1_score: 0.9496; train_kl_reg_loss: 14942.3702; train_edge_recon_loss: 1326382.0333; train_cat_covariates_contrastive_loss: 637782.4333; train_gene_expr_recon_loss: 2884012.5500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4863119.3000; train_optim_loss: 4863119.3000; val_kl_reg_loss: 14691.1719; val_edge_recon_loss: 1321812.2500; val_cat_covariates_contrastive_loss: 635018.5625; val_gene_expr_recon_loss: 2896770.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4868292.0000; val_optim_loss: 4868292.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9437; val_auprc_score: 0.9745; val_best_acc_score: 0.9220; val_best_f1_score: 0.9499; train_kl_reg_loss: 14890.2521; train_edge_recon_loss: 1328308.6167; train_cat_covariates_contrastive_loss: 636765.8833; train_gene_expr_recon_loss: 2884025.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4863990.5333; train_optim_loss: 4863990.5333; val_kl_reg_loss: 14709.1138; val_edge_recon_loss: 1354484.6250; val_cat_covariates_contrastive_loss: 635592.9688; val_gene_expr_recon_loss: 2900536.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4905323.0000; val_optim_loss: 4905323.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9379; val_auprc_score: 0.9700; val_best_acc_score: 0.9182; val_best_f1_score: 0.9470; train_kl_reg_loss: 14850.4615; train_edge_recon_loss: 1314238.9583; train_cat_covariates_contrastive_loss: 637077.0083; train_gene_expr_recon_loss: 2882306.3167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4848472.7667; train_optim_loss: 4848472.7667; val_kl_reg_loss: 14661.5010; val_edge_recon_loss: 1370769.8125; val_cat_covariates_contrastive_loss: 638667.8125; val_gene_expr_recon_loss: 2908701.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4932800.2500; val_optim_loss: 4932800.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9373; val_auprc_score: 0.9711; val_best_acc_score: 0.9205; val_best_f1_score: 0.9491; train_kl_reg_loss: 14882.8851; train_edge_recon_loss: 1330274.5750; train_cat_covariates_contrastive_loss: 637254.5708; train_gene_expr_recon_loss: 2882216.2833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4864628.3333; train_optim_loss: 4864628.3333; val_kl_reg_loss: 14587.3105; val_edge_recon_loss: 1313199.1875; val_cat_covariates_contrastive_loss: 637740.1250; val_gene_expr_recon_loss: 2876099.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4841626.5000; val_optim_loss: 4841626.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9394; val_auprc_score: 0.9712; val_best_acc_score: 0.9187; val_best_f1_score: 0.9477; train_kl_reg_loss: 14788.8036; train_edge_recon_loss: 1324341.2917; train_cat_covariates_contrastive_loss: 636924.1417; train_gene_expr_recon_loss: 2881072.5500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4857126.7333; train_optim_loss: 4857126.7333; val_kl_reg_loss: 14661.2134; val_edge_recon_loss: 1364139.9375; val_cat_covariates_contrastive_loss: 635950.4062; val_gene_expr_recon_loss: 2891473.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4906224.7500; val_optim_loss: 4906224.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9377; val_auprc_score: 0.9705; val_best_acc_score: 0.9170; val_best_f1_score: 0.9464; train_kl_reg_loss: 14768.2004; train_edge_recon_loss: 1331003.4667; train_cat_covariates_contrastive_loss: 638012.1125; train_gene_expr_recon_loss: 2877788.1167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4861571.9000; train_optim_loss: 4861571.9000; val_kl_reg_loss: 14550.2822; val_edge_recon_loss: 1385590.7500; val_cat_covariates_contrastive_loss: 636631.0938; val_gene_expr_recon_loss: 2907144.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4943916.7500; val_optim_loss: 4943916.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9381; val_auprc_score: 0.9721; val_best_acc_score: 0.9186; val_best_f1_score: 0.9481; train_kl_reg_loss: 14776.0411; train_edge_recon_loss: 1320335.5667; train_cat_covariates_contrastive_loss: 636914.4917; train_gene_expr_recon_loss: 2881409.4333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4853435.5667; train_optim_loss: 4853435.5667; val_kl_reg_loss: 14537.2573; val_edge_recon_loss: 1336186.3125; val_cat_covariates_contrastive_loss: 637302.0312; val_gene_expr_recon_loss: 2892105.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4880131.0000; val_optim_loss: 4880131.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9422; val_auprc_score: 0.9731; val_best_acc_score: 0.9219; val_best_f1_score: 0.9499; train_kl_reg_loss: 14717.7956; train_edge_recon_loss: 1324136.6667; train_cat_covariates_contrastive_loss: 637618.2500; train_gene_expr_recon_loss: 2881490.1500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4857962.8667; train_optim_loss: 4857962.8667; val_kl_reg_loss: 14570.6309; val_edge_recon_loss: 1333615.0000; val_cat_covariates_contrastive_loss: 635490.4688; val_gene_expr_recon_loss: 2900347.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4884023.5000; val_optim_loss: 4884023.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9406; val_auprc_score: 0.9706; val_best_acc_score: 0.9186; val_best_f1_score: 0.9474; train_kl_reg_loss: 14722.7341; train_edge_recon_loss: 1312402.2500; train_cat_covariates_contrastive_loss: 636893.1000; train_gene_expr_recon_loss: 2878134.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4842152.8667; train_optim_loss: 4842152.8667; val_kl_reg_loss: 14507.3496; val_edge_recon_loss: 1374638.1875; val_cat_covariates_contrastive_loss: 637468.4062; val_gene_expr_recon_loss: 2871384.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4897998.2500; val_optim_loss: 4897998.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9386; val_auprc_score: 0.9701; val_best_acc_score: 0.9215; val_best_f1_score: 0.9501; train_kl_reg_loss: 14719.1035; train_edge_recon_loss: 1322954.4250; train_cat_covariates_contrastive_loss: 637493.8667; train_gene_expr_recon_loss: 2874902.2333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4850069.6000; train_optim_loss: 4850069.6000; val_kl_reg_loss: 14513.1147; val_edge_recon_loss: 1321677.4375; val_cat_covariates_contrastive_loss: 636854.7500; val_gene_expr_recon_loss: 2878236.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4851281.5000; val_optim_loss: 4851281.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9410; val_auprc_score: 0.9717; val_best_acc_score: 0.9199; val_best_f1_score: 0.9485; train_kl_reg_loss: 14724.8178; train_edge_recon_loss: 1324740.1583; train_cat_covariates_contrastive_loss: 636889.8958; train_gene_expr_recon_loss: 2879289.1000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4855644.0000; train_optim_loss: 4855644.0000; val_kl_reg_loss: 14506.6284; val_edge_recon_loss: 1359569.1250; val_cat_covariates_contrastive_loss: 636961.1250; val_gene_expr_recon_loss: 2870401.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4881437.7500; val_optim_loss: 4881437.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9428; val_auprc_score: 0.9723; val_best_acc_score: 0.9223; val_best_f1_score: 0.9502; train_kl_reg_loss: 14717.2683; train_edge_recon_loss: 1326903.7750; train_cat_covariates_contrastive_loss: 637909.5000; train_gene_expr_recon_loss: 2878249.9500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4857780.5000; train_optim_loss: 4857780.5000; val_kl_reg_loss: 14545.5605; val_edge_recon_loss: 1346207.9375; val_cat_covariates_contrastive_loss: 637306.9688; val_gene_expr_recon_loss: 2883280.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4881341.2500; val_optim_loss: 4881341.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 43 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
val AUROC score: 0.9142
val AUPRC score: 0.9529
val best accuracy score: 0.9100
val best F1 score: 0.9415
val target rna MSE score: 1.1403
val source rna MSE score: 0.3895
Val cat covariate0 mean sim diff: -0.0000
Val cat covariate1 mean sim diff: -0.0590
Duration of model training in run 1: 0 hours, 6 minutes and 47 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
