Run timestamp: 02092023_154045_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc_subsample_10pct', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gcnconv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 25413
Number of validation nodes: 2824
Number of training edges: 231162
Number of validation edges: 25684
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8922; val_auprc_score: 0.9601; val_best_acc_score: 0.8560; val_best_f1_score: 0.9108; train_kl_reg_loss: 2381.3625; train_edge_recon_loss: 1819738.2414; train_cat_covariates_contrastive_loss: 743786.1983; train_gene_expr_recon_loss: 4122953.2759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6688859.0862; train_optim_loss: 6688859.0862; val_kl_reg_loss: 3152.7438; val_edge_recon_loss: 1880644.4375; val_cat_covariates_contrastive_loss: 627234.7656; val_gene_expr_recon_loss: 3884058.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6395090.7500; val_optim_loss: 6395090.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8527; val_auprc_score: 0.9436; val_best_acc_score: 0.8456; val_best_f1_score: 0.9064; train_kl_reg_loss: 8979.6774; train_edge_recon_loss: 1618229.8147; train_cat_covariates_contrastive_loss: 631704.9030; train_gene_expr_recon_loss: 3661221.8276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5920136.2414; train_optim_loss: 5920136.2414; val_kl_reg_loss: 21116.3931; val_edge_recon_loss: 1574745.6875; val_cat_covariates_contrastive_loss: 626657.0469; val_gene_expr_recon_loss: 3502783.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5725302.2500; val_optim_loss: 5725302.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8631; val_auprc_score: 0.9469; val_best_acc_score: 0.8507; val_best_f1_score: 0.9087; train_kl_reg_loss: 29229.4784; train_edge_recon_loss: 1540644.2759; train_cat_covariates_contrastive_loss: 627696.8944; train_gene_expr_recon_loss: 3351852.6121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5549423.3276; train_optim_loss: 5549423.3276; val_kl_reg_loss: 36920.4980; val_edge_recon_loss: 1556614.1562; val_cat_covariates_contrastive_loss: 626688.3906; val_gene_expr_recon_loss: 3292772.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5512995.7500; val_optim_loss: 5512995.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8815; val_auprc_score: 0.9545; val_best_acc_score: 0.8638; val_best_f1_score: 0.9162; train_kl_reg_loss: 34421.5756; train_edge_recon_loss: 1508796.8319; train_cat_covariates_contrastive_loss: 627369.3879; train_gene_expr_recon_loss: 3208027.6379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5378615.4310; train_optim_loss: 5378615.4310; val_kl_reg_loss: 31604.6655; val_edge_recon_loss: 1479911.5312; val_cat_covariates_contrastive_loss: 626781.1562; val_gene_expr_recon_loss: 3180412.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5318709.7500; val_optim_loss: 5318709.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8956; val_auprc_score: 0.9594; val_best_acc_score: 0.8661; val_best_f1_score: 0.9179; train_kl_reg_loss: 28544.7701; train_edge_recon_loss: 1469850.8578; train_cat_covariates_contrastive_loss: 627722.8879; train_gene_expr_recon_loss: 3143086.7672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5269205.2586; train_optim_loss: 5269205.2586; val_kl_reg_loss: 26210.1440; val_edge_recon_loss: 1467830.0625; val_cat_covariates_contrastive_loss: 627164.2812; val_gene_expr_recon_loss: 3166839.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5288044.3750; val_optim_loss: 5288044.3750
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9186; val_auprc_score: 0.9680; val_best_acc_score: 0.8813; val_best_f1_score: 0.9248; train_kl_reg_loss: 23274.5710; train_edge_recon_loss: 1447644.3922; train_cat_covariates_contrastive_loss: 629627.3448; train_gene_expr_recon_loss: 3101040.1121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5201586.4138; train_optim_loss: 5201586.4138; val_kl_reg_loss: 21599.2451; val_edge_recon_loss: 1437124.6875; val_cat_covariates_contrastive_loss: 629378.7969; val_gene_expr_recon_loss: 3116925.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5205027.7500; val_optim_loss: 5205027.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9374; val_auprc_score: 0.9723; val_best_acc_score: 0.9110; val_best_f1_score: 0.9434; train_kl_reg_loss: 21639.8600; train_edge_recon_loss: 1398729.5776; train_cat_covariates_contrastive_loss: 633836.5453; train_gene_expr_recon_loss: 3073758.6638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5127964.6897; train_optim_loss: 5127964.6897; val_kl_reg_loss: 23103.7124; val_edge_recon_loss: 1383978.0625; val_cat_covariates_contrastive_loss: 633393.1250; val_gene_expr_recon_loss: 3110829.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5151304.3750; val_optim_loss: 5151304.3750
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9432; val_auprc_score: 0.9758; val_best_acc_score: 0.9178; val_best_f1_score: 0.9472; train_kl_reg_loss: 22955.8823; train_edge_recon_loss: 1376388.7543; train_cat_covariates_contrastive_loss: 635439.4203; train_gene_expr_recon_loss: 3047998.2672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5082782.3103; train_optim_loss: 5082782.3103; val_kl_reg_loss: 23174.3848; val_edge_recon_loss: 1376995.4688; val_cat_covariates_contrastive_loss: 635194.1406; val_gene_expr_recon_loss: 3079549.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5114914.0000; val_optim_loss: 5114914.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9449; val_auprc_score: 0.9753; val_best_acc_score: 0.9220; val_best_f1_score: 0.9501; train_kl_reg_loss: 22946.7922; train_edge_recon_loss: 1366548.4181; train_cat_covariates_contrastive_loss: 636010.8211; train_gene_expr_recon_loss: 3027456.1207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5052962.2069; train_optim_loss: 5052962.2069; val_kl_reg_loss: 23079.2407; val_edge_recon_loss: 1356378.9062; val_cat_covariates_contrastive_loss: 635593.0312; val_gene_expr_recon_loss: 3068676.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5083727.6250; val_optim_loss: 5083727.6250
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9483; val_auprc_score: 0.9776; val_best_acc_score: 0.9235; val_best_f1_score: 0.9507; train_kl_reg_loss: 22182.3320; train_edge_recon_loss: 1355953.5129; train_cat_covariates_contrastive_loss: 636062.8599; train_gene_expr_recon_loss: 3011176.3707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5025375.0517; train_optim_loss: 5025375.0517; val_kl_reg_loss: 21751.0059; val_edge_recon_loss: 1370418.7812; val_cat_covariates_contrastive_loss: 634677.9219; val_gene_expr_recon_loss: 2998434.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5025282.2500; val_optim_loss: 5025282.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9485; val_auprc_score: 0.9767; val_best_acc_score: 0.9244; val_best_f1_score: 0.9515; train_kl_reg_loss: 20885.3972; train_edge_recon_loss: 1350852.8922; train_cat_covariates_contrastive_loss: 635605.3147; train_gene_expr_recon_loss: 2995473.1897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5002816.8276; train_optim_loss: 5002816.8276; val_kl_reg_loss: 20301.1763; val_edge_recon_loss: 1359800.1250; val_cat_covariates_contrastive_loss: 634704.8125; val_gene_expr_recon_loss: 3011781.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5026587.8750; val_optim_loss: 5026587.8750
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9507; val_auprc_score: 0.9780; val_best_acc_score: 0.9272; val_best_f1_score: 0.9531; train_kl_reg_loss: 19754.1709; train_edge_recon_loss: 1342659.5905; train_cat_covariates_contrastive_loss: 635694.8556; train_gene_expr_recon_loss: 2981382.3621; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4979491.0172; train_optim_loss: 4979491.0172; val_kl_reg_loss: 19509.1592; val_edge_recon_loss: 1378122.6875; val_cat_covariates_contrastive_loss: 634838.6562; val_gene_expr_recon_loss: 2996224.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5028694.6250; val_optim_loss: 5028694.6250
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9549; val_auprc_score: 0.9798; val_best_acc_score: 0.9286; val_best_f1_score: 0.9540; train_kl_reg_loss: 18579.8214; train_edge_recon_loss: 1340340.0776; train_cat_covariates_contrastive_loss: 635768.1293; train_gene_expr_recon_loss: 2971466.5776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4966154.5690; train_optim_loss: 4966154.5690; val_kl_reg_loss: 18295.1709; val_edge_recon_loss: 1364079.9062; val_cat_covariates_contrastive_loss: 634024.1406; val_gene_expr_recon_loss: 3002209.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5018608.5000; val_optim_loss: 5018608.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9577; val_auprc_score: 0.9806; val_best_acc_score: 0.9332; val_best_f1_score: 0.9568; train_kl_reg_loss: 17625.8924; train_edge_recon_loss: 1331599.4440; train_cat_covariates_contrastive_loss: 635896.8793; train_gene_expr_recon_loss: 2961488.2241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4946610.4138; train_optim_loss: 4946610.4138; val_kl_reg_loss: 17305.7676; val_edge_recon_loss: 1355664.0625; val_cat_covariates_contrastive_loss: 634130.0938; val_gene_expr_recon_loss: 2998445.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5005545.7500; val_optim_loss: 5005545.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9574; val_auprc_score: 0.9801; val_best_acc_score: 0.9363; val_best_f1_score: 0.9589; train_kl_reg_loss: 16600.8963; train_edge_recon_loss: 1327780.8060; train_cat_covariates_contrastive_loss: 635423.8858; train_gene_expr_recon_loss: 2952352.3793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4932157.9828; train_optim_loss: 4932157.9828; val_kl_reg_loss: 16179.4998; val_edge_recon_loss: 1333774.2188; val_cat_covariates_contrastive_loss: 634384.5625; val_gene_expr_recon_loss: 2939141.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4923480.2500; val_optim_loss: 4923480.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9604; val_auprc_score: 0.9814; val_best_acc_score: 0.9401; val_best_f1_score: 0.9612; train_kl_reg_loss: 15802.6742; train_edge_recon_loss: 1330094.6293; train_cat_covariates_contrastive_loss: 634943.4828; train_gene_expr_recon_loss: 2941059.9655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4921900.7414; train_optim_loss: 4921900.7414; val_kl_reg_loss: 15460.4871; val_edge_recon_loss: 1330571.1250; val_cat_covariates_contrastive_loss: 635087.3750; val_gene_expr_recon_loss: 2969071.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4950190.5000; val_optim_loss: 4950190.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9592; val_auprc_score: 0.9807; val_best_acc_score: 0.9425; val_best_f1_score: 0.9629; train_kl_reg_loss: 15097.7172; train_edge_recon_loss: 1322479.2931; train_cat_covariates_contrastive_loss: 634621.2284; train_gene_expr_recon_loss: 2932822.9224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4905021.1552; train_optim_loss: 4905021.1552; val_kl_reg_loss: 14867.5420; val_edge_recon_loss: 1321799.8125; val_cat_covariates_contrastive_loss: 633150.9375; val_gene_expr_recon_loss: 2898813.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4868631.6250; val_optim_loss: 4868631.6250
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9572; val_auprc_score: 0.9799; val_best_acc_score: 0.9413; val_best_f1_score: 0.9621; train_kl_reg_loss: 14605.6281; train_edge_recon_loss: 1324193.9526; train_cat_covariates_contrastive_loss: 634612.9914; train_gene_expr_recon_loss: 2922029.4052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4895441.9483; train_optim_loss: 4895441.9483; val_kl_reg_loss: 14448.6790; val_edge_recon_loss: 1328122.2188; val_cat_covariates_contrastive_loss: 634042.3906; val_gene_expr_recon_loss: 2943948.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4920561.5000; val_optim_loss: 4920561.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9644; val_auprc_score: 0.9836; val_best_acc_score: 0.9466; val_best_f1_score: 0.9654; train_kl_reg_loss: 14170.4699; train_edge_recon_loss: 1319634.6810; train_cat_covariates_contrastive_loss: 634394.2263; train_gene_expr_recon_loss: 2912863.6379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4881063.0000; train_optim_loss: 4881063.0000; val_kl_reg_loss: 13792.8027; val_edge_recon_loss: 1328495.6250; val_cat_covariates_contrastive_loss: 632796.4531; val_gene_expr_recon_loss: 2933163.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4908248.7500; val_optim_loss: 4908248.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9571; val_auprc_score: 0.9784; val_best_acc_score: 0.9446; val_best_f1_score: 0.9640; train_kl_reg_loss: 13782.1979; train_edge_recon_loss: 1319019.6638; train_cat_covariates_contrastive_loss: 634407.0647; train_gene_expr_recon_loss: 2908023.3707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4875232.3276; train_optim_loss: 4875232.3276; val_kl_reg_loss: 13613.8037; val_edge_recon_loss: 1335609.8438; val_cat_covariates_contrastive_loss: 633866.7812; val_gene_expr_recon_loss: 2908025.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4891116.3750; val_optim_loss: 4891116.3750
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9568; val_auprc_score: 0.9793; val_best_acc_score: 0.9441; val_best_f1_score: 0.9640; train_kl_reg_loss: 13515.6610; train_edge_recon_loss: 1317024.0603; train_cat_covariates_contrastive_loss: 634230.7328; train_gene_expr_recon_loss: 2899229.3793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4863999.8103; train_optim_loss: 4863999.8103; val_kl_reg_loss: 13411.4766; val_edge_recon_loss: 1304918.4688; val_cat_covariates_contrastive_loss: 633908.9375; val_gene_expr_recon_loss: 2901498.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4853736.8750; val_optim_loss: 4853736.8750
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9610; val_auprc_score: 0.9814; val_best_acc_score: 0.9461; val_best_f1_score: 0.9649; train_kl_reg_loss: 13270.8923; train_edge_recon_loss: 1314078.7716; train_cat_covariates_contrastive_loss: 634189.2888; train_gene_expr_recon_loss: 2890302.3362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4851841.3448; train_optim_loss: 4851841.3448; val_kl_reg_loss: 12981.4294; val_edge_recon_loss: 1337352.9062; val_cat_covariates_contrastive_loss: 632824.1562; val_gene_expr_recon_loss: 2870894.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4854053.2500; val_optim_loss: 4854053.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9586; val_auprc_score: 0.9801; val_best_acc_score: 0.9467; val_best_f1_score: 0.9653; train_kl_reg_loss: 13030.7232; train_edge_recon_loss: 1312255.2328; train_cat_covariates_contrastive_loss: 634093.4224; train_gene_expr_recon_loss: 2882205.0517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4841584.4138; train_optim_loss: 4841584.4138; val_kl_reg_loss: 12806.8623; val_edge_recon_loss: 1325687.4062; val_cat_covariates_contrastive_loss: 632607.5938; val_gene_expr_recon_loss: 2877158.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4848260.5000; val_optim_loss: 4848260.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9592; val_auprc_score: 0.9802; val_best_acc_score: 0.9474; val_best_f1_score: 0.9659; train_kl_reg_loss: 12879.2780; train_edge_recon_loss: 1320452.1034; train_cat_covariates_contrastive_loss: 634032.4332; train_gene_expr_recon_loss: 2877068.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4844432.0517; train_optim_loss: 4844432.0517; val_kl_reg_loss: 12756.8069; val_edge_recon_loss: 1313968.4062; val_cat_covariates_contrastive_loss: 633522.8281; val_gene_expr_recon_loss: 2905149.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4865397.7500; val_optim_loss: 4865397.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9604; val_auprc_score: 0.9806; val_best_acc_score: 0.9486; val_best_f1_score: 0.9666; train_kl_reg_loss: 12628.9202; train_edge_recon_loss: 1314531.2241; train_cat_covariates_contrastive_loss: 633967.7888; train_gene_expr_recon_loss: 2868545.1983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4829673.1034; train_optim_loss: 4829673.1034; val_kl_reg_loss: 12636.2219; val_edge_recon_loss: 1303278.4688; val_cat_covariates_contrastive_loss: 633694.2969; val_gene_expr_recon_loss: 2888325.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4837934.2500; val_optim_loss: 4837934.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9571; val_auprc_score: 0.9796; val_best_acc_score: 0.9467; val_best_f1_score: 0.9653; train_kl_reg_loss: 12559.1556; train_edge_recon_loss: 1314859.3362; train_cat_covariates_contrastive_loss: 633771.0431; train_gene_expr_recon_loss: 2861666.2586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4822855.8621; train_optim_loss: 4822855.8621; val_kl_reg_loss: 12451.3806; val_edge_recon_loss: 1321218.4062; val_cat_covariates_contrastive_loss: 633635.5000; val_gene_expr_recon_loss: 2907729.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4875035.0000; val_optim_loss: 4875035.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9590; val_auprc_score: 0.9799; val_best_acc_score: 0.9498; val_best_f1_score: 0.9674; train_kl_reg_loss: 12460.7460; train_edge_recon_loss: 1318352.8190; train_cat_covariates_contrastive_loss: 633656.3039; train_gene_expr_recon_loss: 2858687.9655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4823157.8103; train_optim_loss: 4823157.8103; val_kl_reg_loss: 12374.8962; val_edge_recon_loss: 1316106.1562; val_cat_covariates_contrastive_loss: 634237.1562; val_gene_expr_recon_loss: 2895099.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4857817.6250; val_optim_loss: 4857817.6250
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9611; val_auprc_score: 0.9805; val_best_acc_score: 0.9488; val_best_f1_score: 0.9667; train_kl_reg_loss: 12280.9339; train_edge_recon_loss: 1313568.4698; train_cat_covariates_contrastive_loss: 633563.1078; train_gene_expr_recon_loss: 2852039.3276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4811451.8448; train_optim_loss: 4811451.8448; val_kl_reg_loss: 12137.6621; val_edge_recon_loss: 1321651.6250; val_cat_covariates_contrastive_loss: 632990.1250; val_gene_expr_recon_loss: 2873690.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4840469.3750; val_optim_loss: 4840469.3750
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9598; val_auprc_score: 0.9805; val_best_acc_score: 0.9488; val_best_f1_score: 0.9667; train_kl_reg_loss: 12161.6521; train_edge_recon_loss: 1310686.8276; train_cat_covariates_contrastive_loss: 633411.9720; train_gene_expr_recon_loss: 2847031.9828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4803292.4138; train_optim_loss: 4803292.4138; val_kl_reg_loss: 12121.3005; val_edge_recon_loss: 1308709.2188; val_cat_covariates_contrastive_loss: 632910.2188; val_gene_expr_recon_loss: 2858492.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4812233.5000; val_optim_loss: 4812233.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9582; val_auprc_score: 0.9801; val_best_acc_score: 0.9478; val_best_f1_score: 0.9662; train_kl_reg_loss: 12044.7309; train_edge_recon_loss: 1319415.2198; train_cat_covariates_contrastive_loss: 633542.5690; train_gene_expr_recon_loss: 2839586.6552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4804589.1379; train_optim_loss: 4804589.1379; val_kl_reg_loss: 11971.5591; val_edge_recon_loss: 1324994.5312; val_cat_covariates_contrastive_loss: 632751.8906; val_gene_expr_recon_loss: 2850547.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4820265.2500; val_optim_loss: 4820265.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9592; val_auprc_score: 0.9798; val_best_acc_score: 0.9489; val_best_f1_score: 0.9668; train_kl_reg_loss: 12008.8401; train_edge_recon_loss: 1310131.3405; train_cat_covariates_contrastive_loss: 633697.3060; train_gene_expr_recon_loss: 2835225.9224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4791063.3448; train_optim_loss: 4791063.3448; val_kl_reg_loss: 11999.0720; val_edge_recon_loss: 1321201.2812; val_cat_covariates_contrastive_loss: 632808.0312; val_gene_expr_recon_loss: 2857220.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4823228.5000; val_optim_loss: 4823228.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9592; val_auprc_score: 0.9803; val_best_acc_score: 0.9502; val_best_f1_score: 0.9678; train_kl_reg_loss: 11918.9139; train_edge_recon_loss: 1317240.0862; train_cat_covariates_contrastive_loss: 633358.2284; train_gene_expr_recon_loss: 2829470.6724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4791987.8793; train_optim_loss: 4791987.8793; val_kl_reg_loss: 11769.9861; val_edge_recon_loss: 1316863.8750; val_cat_covariates_contrastive_loss: 632368.2969; val_gene_expr_recon_loss: 2881049.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4842051.7500; val_optim_loss: 4842051.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9580; val_auprc_score: 0.9798; val_best_acc_score: 0.9490; val_best_f1_score: 0.9669; train_kl_reg_loss: 11826.6124; train_edge_recon_loss: 1313433.5733; train_cat_covariates_contrastive_loss: 633448.7155; train_gene_expr_recon_loss: 2823891.6466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4782600.6034; train_optim_loss: 4782600.6034; val_kl_reg_loss: 11761.3313; val_edge_recon_loss: 1316943.8438; val_cat_covariates_contrastive_loss: 632389.1719; val_gene_expr_recon_loss: 2845884.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4806979.1250; val_optim_loss: 4806979.1250
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9574; val_auprc_score: 0.9791; val_best_acc_score: 0.9492; val_best_f1_score: 0.9669; train_kl_reg_loss: 11759.7657; train_edge_recon_loss: 1315881.3362; train_cat_covariates_contrastive_loss: 633014.5302; train_gene_expr_recon_loss: 2817439.4828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4778095.1724; train_optim_loss: 4778095.1724; val_kl_reg_loss: 11670.6633; val_edge_recon_loss: 1323518.5938; val_cat_covariates_contrastive_loss: 633261.5938; val_gene_expr_recon_loss: 2857387.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4825837.8750; val_optim_loss: 4825837.8750
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9546; val_auprc_score: 0.9772; val_best_acc_score: 0.9476; val_best_f1_score: 0.9661; train_kl_reg_loss: 11701.5853; train_edge_recon_loss: 1308152.6940; train_cat_covariates_contrastive_loss: 632989.7435; train_gene_expr_recon_loss: 2816855.9914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4769700.0000; train_optim_loss: 4769700.0000; val_kl_reg_loss: 11508.2368; val_edge_recon_loss: 1315188.4688; val_cat_covariates_contrastive_loss: 633306.0781; val_gene_expr_recon_loss: 2834215.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4794217.7500; val_optim_loss: 4794217.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9605; val_auprc_score: 0.9799; val_best_acc_score: 0.9516; val_best_f1_score: 0.9685; train_kl_reg_loss: 11687.6800; train_edge_recon_loss: 1310480.6681; train_cat_covariates_contrastive_loss: 632900.4483; train_gene_expr_recon_loss: 2808345.6983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4763414.5345; train_optim_loss: 4763414.5345; val_kl_reg_loss: 11669.7649; val_edge_recon_loss: 1317752.5000; val_cat_covariates_contrastive_loss: 632131.3906; val_gene_expr_recon_loss: 2796794.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4758348.2500; val_optim_loss: 4758348.2500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9560; val_auprc_score: 0.9785; val_best_acc_score: 0.9498; val_best_f1_score: 0.9674; train_kl_reg_loss: 11630.3966; train_edge_recon_loss: 1312077.9138; train_cat_covariates_contrastive_loss: 632878.5647; train_gene_expr_recon_loss: 2804494.4655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4761081.3448; train_optim_loss: 4761081.3448; val_kl_reg_loss: 11666.4944; val_edge_recon_loss: 1306479.4688; val_cat_covariates_contrastive_loss: 632864.2188; val_gene_expr_recon_loss: 2829495.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4780505.5000; val_optim_loss: 4780505.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9563; val_auprc_score: 0.9782; val_best_acc_score: 0.9513; val_best_f1_score: 0.9684; train_kl_reg_loss: 11595.4545; train_edge_recon_loss: 1308057.3578; train_cat_covariates_contrastive_loss: 632709.5172; train_gene_expr_recon_loss: 2802379.7155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4754742.0345; train_optim_loss: 4754742.0345; val_kl_reg_loss: 11499.5264; val_edge_recon_loss: 1297678.9688; val_cat_covariates_contrastive_loss: 633150.4375; val_gene_expr_recon_loss: 2800667.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4742996.0000; val_optim_loss: 4742996.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9570; val_auprc_score: 0.9788; val_best_acc_score: 0.9511; val_best_f1_score: 0.9684; train_kl_reg_loss: 11488.5486; train_edge_recon_loss: 1314691.2371; train_cat_covariates_contrastive_loss: 632745.8147; train_gene_expr_recon_loss: 2797897.0603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4756822.6379; train_optim_loss: 4756822.6379; val_kl_reg_loss: 11536.2883; val_edge_recon_loss: 1301287.8438; val_cat_covariates_contrastive_loss: 634255.6562; val_gene_expr_recon_loss: 2875225.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4822305.1250; val_optim_loss: 4822305.1250
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9569; val_auprc_score: 0.9794; val_best_acc_score: 0.9497; val_best_f1_score: 0.9675; train_kl_reg_loss: 11489.6510; train_edge_recon_loss: 1309671.2845; train_cat_covariates_contrastive_loss: 632773.0841; train_gene_expr_recon_loss: 2791721.4828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4745655.4310; train_optim_loss: 4745655.4310; val_kl_reg_loss: 11435.8750; val_edge_recon_loss: 1320418.1562; val_cat_covariates_contrastive_loss: 631446.8281; val_gene_expr_recon_loss: 2804335.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4767636.0000; val_optim_loss: 4767636.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9553; val_auprc_score: 0.9773; val_best_acc_score: 0.9519; val_best_f1_score: 0.9686; train_kl_reg_loss: 11412.5189; train_edge_recon_loss: 1308985.7629; train_cat_covariates_contrastive_loss: 632728.4914; train_gene_expr_recon_loss: 2784798.3707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4737925.1724; train_optim_loss: 4737925.1724; val_kl_reg_loss: 11477.8064; val_edge_recon_loss: 1329005.0625; val_cat_covariates_contrastive_loss: 632318.8438; val_gene_expr_recon_loss: 2835069.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4807871.1250; val_optim_loss: 4807871.1250
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9579; val_auprc_score: 0.9788; val_best_acc_score: 0.9518; val_best_f1_score: 0.9685; train_kl_reg_loss: 11379.0322; train_edge_recon_loss: 1305885.0216; train_cat_covariates_contrastive_loss: 632776.3405; train_gene_expr_recon_loss: 2782558.1466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4732598.5517; train_optim_loss: 4732598.5517; val_kl_reg_loss: 11400.6509; val_edge_recon_loss: 1323759.3125; val_cat_covariates_contrastive_loss: 632473.9375; val_gene_expr_recon_loss: 2832630.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4800264.7500; val_optim_loss: 4800264.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9565; val_auprc_score: 0.9787; val_best_acc_score: 0.9528; val_best_f1_score: 0.9695; train_kl_reg_loss: 11435.5377; train_edge_recon_loss: 1311217.4052; train_cat_covariates_contrastive_loss: 632425.8664; train_gene_expr_recon_loss: 2780013.1897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4735092.0172; train_optim_loss: 4735092.0172; val_kl_reg_loss: 11412.2234; val_edge_recon_loss: 1294710.9375; val_cat_covariates_contrastive_loss: 632729.5625; val_gene_expr_recon_loss: 2843435.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4782288.3750; val_optim_loss: 4782288.3750
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9591; val_auprc_score: 0.9801; val_best_acc_score: 0.9525; val_best_f1_score: 0.9693; train_kl_reg_loss: 11454.1038; train_edge_recon_loss: 1308563.1940; train_cat_covariates_contrastive_loss: 632484.2586; train_gene_expr_recon_loss: 2777735.8017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4730237.3621; train_optim_loss: 4730237.3621; val_kl_reg_loss: 11478.5076; val_edge_recon_loss: 1294266.0000; val_cat_covariates_contrastive_loss: 632034.2188; val_gene_expr_recon_loss: 2854668.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4792447.1250; val_optim_loss: 4792447.1250
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9578; val_auprc_score: 0.9791; val_best_acc_score: 0.9530; val_best_f1_score: 0.9695; train_kl_reg_loss: 11432.3543; train_edge_recon_loss: 1310536.6853; train_cat_covariates_contrastive_loss: 632451.3103; train_gene_expr_recon_loss: 2777870.7759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4732291.1724; train_optim_loss: 4732291.1724; val_kl_reg_loss: 11478.4424; val_edge_recon_loss: 1300960.0000; val_cat_covariates_contrastive_loss: 632367.8281; val_gene_expr_recon_loss: 2821601.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4766408.0000; val_optim_loss: 4766408.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9579; val_auprc_score: 0.9789; val_best_acc_score: 0.9522; val_best_f1_score: 0.9689; train_kl_reg_loss: 11401.1251; train_edge_recon_loss: 1312637.2586; train_cat_covariates_contrastive_loss: 632584.0086; train_gene_expr_recon_loss: 2774955.1293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4731577.5517; train_optim_loss: 4731577.5517; val_kl_reg_loss: 11450.1138; val_edge_recon_loss: 1294338.9375; val_cat_covariates_contrastive_loss: 631804.7656; val_gene_expr_recon_loss: 2825687.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4763280.8750; val_optim_loss: 4763280.8750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 20 min 12 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
val AUROC score: 0.9439
val AUPRC score: 0.9715
val best accuracy score: 0.9456
val best F1 score: 0.9645
val target rna MSE score: 1.0853
val source rna MSE score: 0.1547
Val cat covariate0 mean sim diff: -0.0017
Val cat covariate1 mean sim diff: -0.0900
Duration of model training in run 8: 0 hours, 20 minutes and 26 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 25413
Number of validation nodes: 2824
Number of training edges: 231162
Number of validation edges: 25684
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8965; val_auprc_score: 0.9610; val_best_acc_score: 0.8516; val_best_f1_score: 0.9083; train_kl_reg_loss: 2127.7981; train_edge_recon_loss: 1813716.7198; train_cat_covariates_contrastive_loss: 749274.7672; train_gene_expr_recon_loss: 4083614.4741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6648733.7931; train_optim_loss: 6648733.7931; val_kl_reg_loss: 2398.2374; val_edge_recon_loss: 1908234.5000; val_cat_covariates_contrastive_loss: 627339.9688; val_gene_expr_recon_loss: 3785070.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6323042.6250; val_optim_loss: 6323042.6250
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8477; val_auprc_score: 0.9419; val_best_acc_score: 0.8448; val_best_f1_score: 0.9057; train_kl_reg_loss: 7853.5702; train_edge_recon_loss: 1618898.9569; train_cat_covariates_contrastive_loss: 632344.2522; train_gene_expr_recon_loss: 3622622.2241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5881719.0690; train_optim_loss: 5881719.0690; val_kl_reg_loss: 16414.9180; val_edge_recon_loss: 1596018.1562; val_cat_covariates_contrastive_loss: 626678.6719; val_gene_expr_recon_loss: 3390302.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5629414.0000; val_optim_loss: 5629414.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8681; val_auprc_score: 0.9474; val_best_acc_score: 0.8559; val_best_f1_score: 0.9109; train_kl_reg_loss: 24791.1987; train_edge_recon_loss: 1536056.6336; train_cat_covariates_contrastive_loss: 627130.3060; train_gene_expr_recon_loss: 3334677.7155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5522655.8793; train_optim_loss: 5522655.8793; val_kl_reg_loss: 29906.1152; val_edge_recon_loss: 1515878.0312; val_cat_covariates_contrastive_loss: 626674.1719; val_gene_expr_recon_loss: 3210776.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5383234.3750; val_optim_loss: 5383234.3750
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8816; val_auprc_score: 0.9539; val_best_acc_score: 0.8626; val_best_f1_score: 0.9156; train_kl_reg_loss: 30122.1958; train_edge_recon_loss: 1482463.6897; train_cat_covariates_contrastive_loss: 627060.0560; train_gene_expr_recon_loss: 3195921.8190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5335567.8103; train_optim_loss: 5335567.8103; val_kl_reg_loss: 26831.0425; val_edge_recon_loss: 1471472.0625; val_cat_covariates_contrastive_loss: 626769.3125; val_gene_expr_recon_loss: 3092538.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5217611.2500; val_optim_loss: 5217611.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8958; val_auprc_score: 0.9589; val_best_acc_score: 0.8661; val_best_f1_score: 0.9178; train_kl_reg_loss: 24131.0917; train_edge_recon_loss: 1457189.3750; train_cat_covariates_contrastive_loss: 627512.1336; train_gene_expr_recon_loss: 3129541.0517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5238373.6379; train_optim_loss: 5238373.6379; val_kl_reg_loss: 20888.7539; val_edge_recon_loss: 1455993.1875; val_cat_covariates_contrastive_loss: 627140.9531; val_gene_expr_recon_loss: 3124147.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5228170.6250; val_optim_loss: 5228170.6250
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9231; val_auprc_score: 0.9690; val_best_acc_score: 0.8923; val_best_f1_score: 0.9316; train_kl_reg_loss: 19462.0213; train_edge_recon_loss: 1431250.0733; train_cat_covariates_contrastive_loss: 629162.0151; train_gene_expr_recon_loss: 3089217.8362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5169091.9310; train_optim_loss: 5169091.9310; val_kl_reg_loss: 17611.7578; val_edge_recon_loss: 1393137.9062; val_cat_covariates_contrastive_loss: 629479.3281; val_gene_expr_recon_loss: 3031356.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5071585.1250; val_optim_loss: 5071585.1250
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9441; val_auprc_score: 0.9763; val_best_acc_score: 0.9174; val_best_f1_score: 0.9473; train_kl_reg_loss: 17211.8299; train_edge_recon_loss: 1384798.2371; train_cat_covariates_contrastive_loss: 633359.8341; train_gene_expr_recon_loss: 3059298.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5094668.1207; train_optim_loss: 5094668.1207; val_kl_reg_loss: 17270.6558; val_edge_recon_loss: 1371433.9688; val_cat_covariates_contrastive_loss: 636281.6562; val_gene_expr_recon_loss: 3003461.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5028448.0000; val_optim_loss: 5028448.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9473; val_auprc_score: 0.9775; val_best_acc_score: 0.9230; val_best_f1_score: 0.9508; train_kl_reg_loss: 17531.5871; train_edge_recon_loss: 1360595.8664; train_cat_covariates_contrastive_loss: 636099.4009; train_gene_expr_recon_loss: 3037723.6983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5051950.5862; train_optim_loss: 5051950.5862; val_kl_reg_loss: 17750.9424; val_edge_recon_loss: 1339268.6562; val_cat_covariates_contrastive_loss: 635459.1875; val_gene_expr_recon_loss: 3007427.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4999906.2500; val_optim_loss: 4999906.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9461; val_auprc_score: 0.9763; val_best_acc_score: 0.9210; val_best_f1_score: 0.9492; train_kl_reg_loss: 17658.6553; train_edge_recon_loss: 1348288.3491; train_cat_covariates_contrastive_loss: 635372.1013; train_gene_expr_recon_loss: 3018709.3621; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5020028.4828; train_optim_loss: 5020028.4828; val_kl_reg_loss: 17316.9492; val_edge_recon_loss: 1355449.4062; val_cat_covariates_contrastive_loss: 633903.3125; val_gene_expr_recon_loss: 2948498.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4955168.3750; val_optim_loss: 4955168.3750
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9471; val_auprc_score: 0.9764; val_best_acc_score: 0.9233; val_best_f1_score: 0.9507; train_kl_reg_loss: 17204.3425; train_edge_recon_loss: 1349625.1336; train_cat_covariates_contrastive_loss: 634968.5884; train_gene_expr_recon_loss: 3006457.9655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5008256.0172; train_optim_loss: 5008256.0172; val_kl_reg_loss: 16814.0815; val_edge_recon_loss: 1332911.3125; val_cat_covariates_contrastive_loss: 633207.2656; val_gene_expr_recon_loss: 2957963.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4940895.6250; val_optim_loss: 4940895.6250
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9509; val_auprc_score: 0.9781; val_best_acc_score: 0.9280; val_best_f1_score: 0.9538; train_kl_reg_loss: 16441.4034; train_edge_recon_loss: 1333513.3664; train_cat_covariates_contrastive_loss: 634782.9418; train_gene_expr_recon_loss: 2992265.9397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4977003.6552; train_optim_loss: 4977003.6552; val_kl_reg_loss: 16109.6562; val_edge_recon_loss: 1334616.7812; val_cat_covariates_contrastive_loss: 633013.7656; val_gene_expr_recon_loss: 2994607.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4978348.1250; val_optim_loss: 4978348.1250
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9512; val_auprc_score: 0.9777; val_best_acc_score: 0.9290; val_best_f1_score: 0.9544; train_kl_reg_loss: 15744.1243; train_edge_recon_loss: 1331957.0819; train_cat_covariates_contrastive_loss: 634852.7694; train_gene_expr_recon_loss: 2980609.6293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4963163.6207; train_optim_loss: 4963163.6207; val_kl_reg_loss: 15234.5320; val_edge_recon_loss: 1329365.3750; val_cat_covariates_contrastive_loss: 633262.5312; val_gene_expr_recon_loss: 2973948.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4951810.8750; val_optim_loss: 4951810.8750
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9531; val_auprc_score: 0.9785; val_best_acc_score: 0.9337; val_best_f1_score: 0.9571; train_kl_reg_loss: 15015.8081; train_edge_recon_loss: 1331186.9784; train_cat_covariates_contrastive_loss: 634546.6336; train_gene_expr_recon_loss: 2969655.4052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4950404.8621; train_optim_loss: 4950404.8621; val_kl_reg_loss: 14721.7131; val_edge_recon_loss: 1357373.7500; val_cat_covariates_contrastive_loss: 633155.2188; val_gene_expr_recon_loss: 2959450.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4964701.6250; val_optim_loss: 4964701.6250
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9557; val_auprc_score: 0.9787; val_best_acc_score: 0.9399; val_best_f1_score: 0.9610; train_kl_reg_loss: 14370.5217; train_edge_recon_loss: 1340085.3491; train_cat_covariates_contrastive_loss: 634609.7802; train_gene_expr_recon_loss: 2956729.9310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4945795.5862; train_optim_loss: 4945795.5862; val_kl_reg_loss: 14076.0471; val_edge_recon_loss: 1331453.0312; val_cat_covariates_contrastive_loss: 633232.9219; val_gene_expr_recon_loss: 2915759.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4894521.3750; val_optim_loss: 4894521.3750
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9567; val_auprc_score: 0.9801; val_best_acc_score: 0.9410; val_best_f1_score: 0.9620; train_kl_reg_loss: 13924.7818; train_edge_recon_loss: 1322278.2112; train_cat_covariates_contrastive_loss: 634151.7328; train_gene_expr_recon_loss: 2947177.1466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4917531.8621; train_optim_loss: 4917531.8621; val_kl_reg_loss: 13484.2390; val_edge_recon_loss: 1326183.2188; val_cat_covariates_contrastive_loss: 634552.0312; val_gene_expr_recon_loss: 2925724.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4899944.5000; val_optim_loss: 4899944.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9579; val_auprc_score: 0.9800; val_best_acc_score: 0.9427; val_best_f1_score: 0.9628; train_kl_reg_loss: 13480.6477; train_edge_recon_loss: 1318361.7414; train_cat_covariates_contrastive_loss: 634013.9892; train_gene_expr_recon_loss: 2936914.1724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4902770.5172; train_optim_loss: 4902770.5172; val_kl_reg_loss: 13224.2310; val_edge_recon_loss: 1321025.0312; val_cat_covariates_contrastive_loss: 633464.3906; val_gene_expr_recon_loss: 2931409.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4899123.5000; val_optim_loss: 4899123.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9587; val_auprc_score: 0.9806; val_best_acc_score: 0.9449; val_best_f1_score: 0.9645; train_kl_reg_loss: 13216.1549; train_edge_recon_loss: 1325918.7931; train_cat_covariates_contrastive_loss: 633835.4655; train_gene_expr_recon_loss: 2931489.1379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4904459.5345; train_optim_loss: 4904459.5345; val_kl_reg_loss: 13137.5354; val_edge_recon_loss: 1300048.2812; val_cat_covariates_contrastive_loss: 634457.5938; val_gene_expr_recon_loss: 2929526.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4877170.0000; val_optim_loss: 4877170.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9562; val_auprc_score: 0.9791; val_best_acc_score: 0.9442; val_best_f1_score: 0.9639; train_kl_reg_loss: 12907.2567; train_edge_recon_loss: 1317184.0431; train_cat_covariates_contrastive_loss: 633751.0388; train_gene_expr_recon_loss: 2920118.4310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4883960.8621; train_optim_loss: 4883960.8621; val_kl_reg_loss: 12717.4370; val_edge_recon_loss: 1338989.7500; val_cat_covariates_contrastive_loss: 634101.0156; val_gene_expr_recon_loss: 2911882.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4897690.8750; val_optim_loss: 4897690.8750
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9575; val_auprc_score: 0.9795; val_best_acc_score: 0.9456; val_best_f1_score: 0.9649; train_kl_reg_loss: 12679.1848; train_edge_recon_loss: 1322358.8621; train_cat_covariates_contrastive_loss: 633930.7565; train_gene_expr_recon_loss: 2911631.0345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4880599.8276; train_optim_loss: 4880599.8276; val_kl_reg_loss: 12550.1951; val_edge_recon_loss: 1319676.7188; val_cat_covariates_contrastive_loss: 632937.8750; val_gene_expr_recon_loss: 2890314.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4855479.0000; val_optim_loss: 4855479.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9609; val_auprc_score: 0.9814; val_best_acc_score: 0.9468; val_best_f1_score: 0.9655; train_kl_reg_loss: 12456.9374; train_edge_recon_loss: 1317868.2931; train_cat_covariates_contrastive_loss: 633728.3750; train_gene_expr_recon_loss: 2902977.4569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4867031.1379; train_optim_loss: 4867031.1379; val_kl_reg_loss: 12235.1597; val_edge_recon_loss: 1325932.0938; val_cat_covariates_contrastive_loss: 632594.9062; val_gene_expr_recon_loss: 2897598.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4868360.2500; val_optim_loss: 4868360.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9592; val_auprc_score: 0.9808; val_best_acc_score: 0.9455; val_best_f1_score: 0.9648; train_kl_reg_loss: 12358.2095; train_edge_recon_loss: 1319405.8448; train_cat_covariates_contrastive_loss: 633632.1832; train_gene_expr_recon_loss: 2898164.9569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4863561.1552; train_optim_loss: 4863561.1552; val_kl_reg_loss: 12171.1968; val_edge_recon_loss: 1306040.3750; val_cat_covariates_contrastive_loss: 632708.2188; val_gene_expr_recon_loss: 2850782.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4801702.6250; val_optim_loss: 4801702.6250
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9555; val_auprc_score: 0.9778; val_best_acc_score: 0.9464; val_best_f1_score: 0.9653; train_kl_reg_loss: 12210.6345; train_edge_recon_loss: 1315367.8793; train_cat_covariates_contrastive_loss: 633878.8922; train_gene_expr_recon_loss: 2890072.1552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4851529.5345; train_optim_loss: 4851529.5345; val_kl_reg_loss: 12199.6531; val_edge_recon_loss: 1332803.8750; val_cat_covariates_contrastive_loss: 633140.5938; val_gene_expr_recon_loss: 2880621.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4858765.1250; val_optim_loss: 4858765.1250
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9549; val_auprc_score: 0.9785; val_best_acc_score: 0.9450; val_best_f1_score: 0.9645; train_kl_reg_loss: 12105.1764; train_edge_recon_loss: 1320985.7802; train_cat_covariates_contrastive_loss: 633831.2996; train_gene_expr_recon_loss: 2884497.4397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4851419.6724; train_optim_loss: 4851419.6724; val_kl_reg_loss: 12056.6533; val_edge_recon_loss: 1322519.3125; val_cat_covariates_contrastive_loss: 632577.2344; val_gene_expr_recon_loss: 2845743.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4812897.1250; val_optim_loss: 4812897.1250
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9562; val_auprc_score: 0.9789; val_best_acc_score: 0.9461; val_best_f1_score: 0.9652; train_kl_reg_loss: 12065.7008; train_edge_recon_loss: 1311271.6897; train_cat_covariates_contrastive_loss: 633711.0108; train_gene_expr_recon_loss: 2877143.3707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4834191.8103; train_optim_loss: 4834191.8103; val_kl_reg_loss: 12008.9856; val_edge_recon_loss: 1318025.0625; val_cat_covariates_contrastive_loss: 632305.4062; val_gene_expr_recon_loss: 2864850.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4827190.2500; val_optim_loss: 4827190.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9558; val_auprc_score: 0.9790; val_best_acc_score: 0.9461; val_best_f1_score: 0.9651; train_kl_reg_loss: 11942.5388; train_edge_recon_loss: 1320170.1509; train_cat_covariates_contrastive_loss: 633512.0539; train_gene_expr_recon_loss: 2869732.4483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4835357.2414; train_optim_loss: 4835357.2414; val_kl_reg_loss: 11603.3389; val_edge_recon_loss: 1331214.6562; val_cat_covariates_contrastive_loss: 632565.6562; val_gene_expr_recon_loss: 2854696.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4830080.5000; val_optim_loss: 4830080.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9584; val_auprc_score: 0.9804; val_best_acc_score: 0.9483; val_best_f1_score: 0.9664; train_kl_reg_loss: 11840.2986; train_edge_recon_loss: 1314749.0345; train_cat_covariates_contrastive_loss: 633835.3211; train_gene_expr_recon_loss: 2864976.0603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4825400.6897; train_optim_loss: 4825400.6897; val_kl_reg_loss: 11762.8525; val_edge_recon_loss: 1326456.0312; val_cat_covariates_contrastive_loss: 632933.8438; val_gene_expr_recon_loss: 2840176.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4811329.0000; val_optim_loss: 4811329.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9565; val_auprc_score: 0.9792; val_best_acc_score: 0.9482; val_best_f1_score: 0.9663; train_kl_reg_loss: 11873.4585; train_edge_recon_loss: 1312140.2931; train_cat_covariates_contrastive_loss: 633401.8815; train_gene_expr_recon_loss: 2864614.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4822030.3448; train_optim_loss: 4822030.3448; val_kl_reg_loss: 11762.0151; val_edge_recon_loss: 1320483.0625; val_cat_covariates_contrastive_loss: 633742.5312; val_gene_expr_recon_loss: 2858509.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4824496.8750; val_optim_loss: 4824496.8750
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9558; val_auprc_score: 0.9793; val_best_acc_score: 0.9475; val_best_f1_score: 0.9661; train_kl_reg_loss: 11841.3215; train_edge_recon_loss: 1308824.3405; train_cat_covariates_contrastive_loss: 633378.6746; train_gene_expr_recon_loss: 2866075.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4820119.3793; train_optim_loss: 4820119.3793; val_kl_reg_loss: 11695.9878; val_edge_recon_loss: 1300031.8125; val_cat_covariates_contrastive_loss: 633312.6875; val_gene_expr_recon_loss: 2848110.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4793151.0000; val_optim_loss: 4793151.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9562; val_auprc_score: 0.9794; val_best_acc_score: 0.9459; val_best_f1_score: 0.9650; train_kl_reg_loss: 11810.2020; train_edge_recon_loss: 1314883.0776; train_cat_covariates_contrastive_loss: 633603.9849; train_gene_expr_recon_loss: 2862533.6552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4822830.9138; train_optim_loss: 4822830.9138; val_kl_reg_loss: 11860.0046; val_edge_recon_loss: 1333287.5312; val_cat_covariates_contrastive_loss: 633231.3281; val_gene_expr_recon_loss: 2843980.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4822359.6250; val_optim_loss: 4822359.6250
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9561; val_auprc_score: 0.9786; val_best_acc_score: 0.9465; val_best_f1_score: 0.9651; train_kl_reg_loss: 11830.5788; train_edge_recon_loss: 1310189.8491; train_cat_covariates_contrastive_loss: 633366.0474; train_gene_expr_recon_loss: 2862430.8448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4817817.2759; train_optim_loss: 4817817.2759; val_kl_reg_loss: 11732.2041; val_edge_recon_loss: 1327133.7812; val_cat_covariates_contrastive_loss: 633281.4844; val_gene_expr_recon_loss: 2809002.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4781149.6250; val_optim_loss: 4781149.6250
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9563; val_auprc_score: 0.9786; val_best_acc_score: 0.9490; val_best_f1_score: 0.9670; train_kl_reg_loss: 11795.6636; train_edge_recon_loss: 1312713.0991; train_cat_covariates_contrastive_loss: 633407.5733; train_gene_expr_recon_loss: 2860979.8448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4818896.2414; train_optim_loss: 4818896.2414; val_kl_reg_loss: 11686.4146; val_edge_recon_loss: 1304382.9688; val_cat_covariates_contrastive_loss: 632972.6562; val_gene_expr_recon_loss: 2840107.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4789149.6250; val_optim_loss: 4789149.6250
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9582; val_auprc_score: 0.9796; val_best_acc_score: 0.9465; val_best_f1_score: 0.9651; train_kl_reg_loss: 11789.1311; train_edge_recon_loss: 1315488.7845; train_cat_covariates_contrastive_loss: 633405.6961; train_gene_expr_recon_loss: 2860842.3707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4821525.9828; train_optim_loss: 4821525.9828; val_kl_reg_loss: 11764.7817; val_edge_recon_loss: 1328503.4375; val_cat_covariates_contrastive_loss: 632597.2500; val_gene_expr_recon_loss: 2846774.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4819639.5000; val_optim_loss: 4819639.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9549; val_auprc_score: 0.9781; val_best_acc_score: 0.9462; val_best_f1_score: 0.9654; train_kl_reg_loss: 11766.4487; train_edge_recon_loss: 1316068.3836; train_cat_covariates_contrastive_loss: 633617.7931; train_gene_expr_recon_loss: 2859578.3707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4821030.9828; train_optim_loss: 4821030.9828; val_kl_reg_loss: 11780.1455; val_edge_recon_loss: 1327173.1562; val_cat_covariates_contrastive_loss: 632874.6094; val_gene_expr_recon_loss: 2864261.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4836089.7500; val_optim_loss: 4836089.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9574; val_auprc_score: 0.9798; val_best_acc_score: 0.9475; val_best_f1_score: 0.9661; train_kl_reg_loss: 11762.0874; train_edge_recon_loss: 1317940.2155; train_cat_covariates_contrastive_loss: 633445.4763; train_gene_expr_recon_loss: 2859372.4310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4822520.2069; train_optim_loss: 4822520.2069; val_kl_reg_loss: 11808.3062; val_edge_recon_loss: 1321912.6875; val_cat_covariates_contrastive_loss: 632495.2656; val_gene_expr_recon_loss: 2878731.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4844947.8750; val_optim_loss: 4844947.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9543; val_auprc_score: 0.9777; val_best_acc_score: 0.9466; val_best_f1_score: 0.9654; train_kl_reg_loss: 11782.0442; train_edge_recon_loss: 1317193.4267; train_cat_covariates_contrastive_loss: 633264.0539; train_gene_expr_recon_loss: 2858495.8017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4820735.2759; train_optim_loss: 4820735.2759; val_kl_reg_loss: 11755.9866; val_edge_recon_loss: 1334187.8125; val_cat_covariates_contrastive_loss: 633597.3281; val_gene_expr_recon_loss: 2867773.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4847314.6250; val_optim_loss: 4847314.6250
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9580; val_auprc_score: 0.9804; val_best_acc_score: 0.9480; val_best_f1_score: 0.9663; train_kl_reg_loss: 11757.1301; train_edge_recon_loss: 1309108.1853; train_cat_covariates_contrastive_loss: 633396.8664; train_gene_expr_recon_loss: 2859504.3276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4813766.4828; train_optim_loss: 4813766.4828; val_kl_reg_loss: 11745.6335; val_edge_recon_loss: 1327936.0000; val_cat_covariates_contrastive_loss: 632798.7656; val_gene_expr_recon_loss: 2853453.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4825933.8750; val_optim_loss: 4825933.8750
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9591; val_auprc_score: 0.9794; val_best_acc_score: 0.9477; val_best_f1_score: 0.9659; train_kl_reg_loss: 11750.9601; train_edge_recon_loss: 1314866.1293; train_cat_covariates_contrastive_loss: 633470.7909; train_gene_expr_recon_loss: 2859830.1724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4819918.0690; train_optim_loss: 4819918.0690; val_kl_reg_loss: 11798.9810; val_edge_recon_loss: 1328237.7500; val_cat_covariates_contrastive_loss: 632479.1094; val_gene_expr_recon_loss: 2839501.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4812017.3750; val_optim_loss: 4812017.3750
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9582; val_auprc_score: 0.9795; val_best_acc_score: 0.9481; val_best_f1_score: 0.9663; train_kl_reg_loss: 11751.3834; train_edge_recon_loss: 1314406.5129; train_cat_covariates_contrastive_loss: 633502.9634; train_gene_expr_recon_loss: 2859103.1552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4818764.0345; train_optim_loss: 4818764.0345; val_kl_reg_loss: 11710.0994; val_edge_recon_loss: 1308292.8438; val_cat_covariates_contrastive_loss: 633093.9219; val_gene_expr_recon_loss: 2840335.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4793432.2500; val_optim_loss: 4793432.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 17 min 7 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
val AUROC score: 0.9435
val AUPRC score: 0.9709
val best accuracy score: 0.9411
val best F1 score: 0.9617
val target rna MSE score: 1.1007
val source rna MSE score: 0.2017
Val cat covariate0 mean sim diff: 0.0001
Val cat covariate1 mean sim diff: -0.0934
Duration of model training in run 7: 0 hours, 17 minutes and 17 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 25413
Number of validation nodes: 2824
Number of training edges: 174662
Number of validation edges: 19406
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9118; val_auprc_score: 0.9679; val_best_acc_score: 0.8536; val_best_f1_score: 0.9093; train_kl_reg_loss: 2506.7791; train_edge_recon_loss: 1841450.1818; train_cat_covariates_contrastive_loss: 760380.5597; train_gene_expr_recon_loss: 4137316.9205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6741654.3636; train_optim_loss: 6741654.3636; val_kl_reg_loss: 2577.1582; val_edge_recon_loss: 1970596.4167; val_cat_covariates_contrastive_loss: 627269.1667; val_gene_expr_recon_loss: 3917534.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6517977.1667; val_optim_loss: 6517977.1667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8450; val_auprc_score: 0.9417; val_best_acc_score: 0.8436; val_best_f1_score: 0.9051; train_kl_reg_loss: 6258.1324; train_edge_recon_loss: 1646113.8409; train_cat_covariates_contrastive_loss: 636489.3210; train_gene_expr_recon_loss: 3734050.4318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6022911.7273; train_optim_loss: 6022911.7273; val_kl_reg_loss: 13935.7061; val_edge_recon_loss: 1560945.0833; val_cat_covariates_contrastive_loss: 626709.7917; val_gene_expr_recon_loss: 3615547.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5817137.8333; val_optim_loss: 5817137.8333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8551; val_auprc_score: 0.9432; val_best_acc_score: 0.8488; val_best_f1_score: 0.9073; train_kl_reg_loss: 22826.4327; train_edge_recon_loss: 1532670.2330; train_cat_covariates_contrastive_loss: 627370.9148; train_gene_expr_recon_loss: 3442135.7955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5625003.4318; train_optim_loss: 5625003.4318; val_kl_reg_loss: 32258.1927; val_edge_recon_loss: 1532276.3333; val_cat_covariates_contrastive_loss: 626656.8125; val_gene_expr_recon_loss: 3365075.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5556267.0000; val_optim_loss: 5556267.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8688; val_auprc_score: 0.9483; val_best_acc_score: 0.8609; val_best_f1_score: 0.9144; train_kl_reg_loss: 31567.4871; train_edge_recon_loss: 1495090.8523; train_cat_covariates_contrastive_loss: 626997.4744; train_gene_expr_recon_loss: 3275361.2614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5429017.0227; train_optim_loss: 5429017.0227; val_kl_reg_loss: 31585.7806; val_edge_recon_loss: 1495889.4583; val_cat_covariates_contrastive_loss: 626732.5417; val_gene_expr_recon_loss: 3261630.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5415838.1667; val_optim_loss: 5415838.1667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8817; val_auprc_score: 0.9544; val_best_acc_score: 0.8628; val_best_f1_score: 0.9159; train_kl_reg_loss: 27588.5566; train_edge_recon_loss: 1470703.8466; train_cat_covariates_contrastive_loss: 627321.3920; train_gene_expr_recon_loss: 3180955.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5306569.2500; train_optim_loss: 5306569.2500; val_kl_reg_loss: 25788.7865; val_edge_recon_loss: 1491941.6250; val_cat_covariates_contrastive_loss: 626982.6042; val_gene_expr_recon_loss: 3190400.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5335113.0000; val_optim_loss: 5335113.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8971; val_auprc_score: 0.9609; val_best_acc_score: 0.8692; val_best_f1_score: 0.9198; train_kl_reg_loss: 23378.1483; train_edge_recon_loss: 1456101.3920; train_cat_covariates_contrastive_loss: 628492.7983; train_gene_expr_recon_loss: 3126875.2614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5234847.6136; train_optim_loss: 5234847.6136; val_kl_reg_loss: 22045.7988; val_edge_recon_loss: 1441095.0000; val_cat_covariates_contrastive_loss: 627500.2708; val_gene_expr_recon_loss: 3148191.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5238833.0000; val_optim_loss: 5238833.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9234; val_auprc_score: 0.9677; val_best_acc_score: 0.8975; val_best_f1_score: 0.9350; train_kl_reg_loss: 20285.1172; train_edge_recon_loss: 1425724.0682; train_cat_covariates_contrastive_loss: 630947.6250; train_gene_expr_recon_loss: 3089892.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5166849.5227; train_optim_loss: 5166849.5227; val_kl_reg_loss: 19583.5312; val_edge_recon_loss: 1421145.7917; val_cat_covariates_contrastive_loss: 631901.9167; val_gene_expr_recon_loss: 3073252.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5145883.8333; val_optim_loss: 5145883.8333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9347; val_auprc_score: 0.9730; val_best_acc_score: 0.9072; val_best_f1_score: 0.9411; train_kl_reg_loss: 21105.7072; train_edge_recon_loss: 1384763.1136; train_cat_covariates_contrastive_loss: 634175.4602; train_gene_expr_recon_loss: 3060896.4091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5100940.5909; train_optim_loss: 5100940.5909; val_kl_reg_loss: 21695.1068; val_edge_recon_loss: 1367836.5833; val_cat_covariates_contrastive_loss: 632771.0000; val_gene_expr_recon_loss: 3127607.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5149910.5000; val_optim_loss: 5149910.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9412; val_auprc_score: 0.9744; val_best_acc_score: 0.9144; val_best_f1_score: 0.9453; train_kl_reg_loss: 21866.5815; train_edge_recon_loss: 1367633.5909; train_cat_covariates_contrastive_loss: 635177.5426; train_gene_expr_recon_loss: 3036915.7386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5061593.4545; train_optim_loss: 5061593.4545; val_kl_reg_loss: 22303.7148; val_edge_recon_loss: 1385170.0833; val_cat_covariates_contrastive_loss: 633359.1458; val_gene_expr_recon_loss: 3098020.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5138853.5000; val_optim_loss: 5138853.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9464; val_auprc_score: 0.9766; val_best_acc_score: 0.9211; val_best_f1_score: 0.9492; train_kl_reg_loss: 21787.2036; train_edge_recon_loss: 1357924.8636; train_cat_covariates_contrastive_loss: 636049.0114; train_gene_expr_recon_loss: 3020209.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5035970.9318; train_optim_loss: 5035970.9318; val_kl_reg_loss: 21702.3600; val_edge_recon_loss: 1351563.2083; val_cat_covariates_contrastive_loss: 634522.3750; val_gene_expr_recon_loss: 3003298.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5011086.3333; val_optim_loss: 5011086.3333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9468; val_auprc_score: 0.9758; val_best_acc_score: 0.9231; val_best_f1_score: 0.9510; train_kl_reg_loss: 21074.0910; train_edge_recon_loss: 1347317.0455; train_cat_covariates_contrastive_loss: 635994.7784; train_gene_expr_recon_loss: 3004521.5682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5008907.4773; train_optim_loss: 5008907.4773; val_kl_reg_loss: 21249.1380; val_edge_recon_loss: 1338016.0417; val_cat_covariates_contrastive_loss: 634310.1458; val_gene_expr_recon_loss: 3086944.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5080520.0000; val_optim_loss: 5080520.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9469; val_auprc_score: 0.9755; val_best_acc_score: 0.9209; val_best_f1_score: 0.9491; train_kl_reg_loss: 20107.7320; train_edge_recon_loss: 1352732.2614; train_cat_covariates_contrastive_loss: 636036.2188; train_gene_expr_recon_loss: 2994924.6818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5003800.9318; train_optim_loss: 5003800.9318; val_kl_reg_loss: 19828.0091; val_edge_recon_loss: 1361846.4583; val_cat_covariates_contrastive_loss: 634022.0000; val_gene_expr_recon_loss: 3022942.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5038639.0000; val_optim_loss: 5038639.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9509; val_auprc_score: 0.9777; val_best_acc_score: 0.9266; val_best_f1_score: 0.9526; train_kl_reg_loss: 19216.1170; train_edge_recon_loss: 1339459.3977; train_cat_covariates_contrastive_loss: 635365.7955; train_gene_expr_recon_loss: 2982199.9205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4976241.2045; train_optim_loss: 4976241.2045; val_kl_reg_loss: 18763.4310; val_edge_recon_loss: 1348668.4167; val_cat_covariates_contrastive_loss: 634107.0208; val_gene_expr_recon_loss: 3043302.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5044841.3333; val_optim_loss: 5044841.3333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9531; val_auprc_score: 0.9792; val_best_acc_score: 0.9290; val_best_f1_score: 0.9539; train_kl_reg_loss: 18218.3256; train_edge_recon_loss: 1343529.7102; train_cat_covariates_contrastive_loss: 634889.0369; train_gene_expr_recon_loss: 2972030.2841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4968667.3636; train_optim_loss: 4968667.3636; val_kl_reg_loss: 17795.3685; val_edge_recon_loss: 1351766.1667; val_cat_covariates_contrastive_loss: 634160.8125; val_gene_expr_recon_loss: 3015402.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5019125.1667; val_optim_loss: 5019125.1667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9525; val_auprc_score: 0.9781; val_best_acc_score: 0.9281; val_best_f1_score: 0.9535; train_kl_reg_loss: 17694.5924; train_edge_recon_loss: 1345612.3977; train_cat_covariates_contrastive_loss: 635088.1364; train_gene_expr_recon_loss: 2967222.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4965617.9773; train_optim_loss: 4965617.9773; val_kl_reg_loss: 17878.3255; val_edge_recon_loss: 1360641.4583; val_cat_covariates_contrastive_loss: 633783.6875; val_gene_expr_recon_loss: 3038618.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5050922.3333; val_optim_loss: 5050922.3333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9512; val_auprc_score: 0.9777; val_best_acc_score: 0.9276; val_best_f1_score: 0.9530; train_kl_reg_loss: 17733.4102; train_edge_recon_loss: 1338102.6193; train_cat_covariates_contrastive_loss: 634745.6250; train_gene_expr_recon_loss: 2961435.6932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4952017.3636; train_optim_loss: 4952017.3636; val_kl_reg_loss: 17286.8516; val_edge_recon_loss: 1363166.5833; val_cat_covariates_contrastive_loss: 634826.7292; val_gene_expr_recon_loss: 2962570.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4977850.5000; val_optim_loss: 4977850.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9502; val_auprc_score: 0.9769; val_best_acc_score: 0.9270; val_best_f1_score: 0.9529; train_kl_reg_loss: 17584.7579; train_edge_recon_loss: 1336921.8693; train_cat_covariates_contrastive_loss: 634865.3608; train_gene_expr_recon_loss: 2961022.9886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4950394.9545; train_optim_loss: 4950394.9545; val_kl_reg_loss: 17486.3242; val_edge_recon_loss: 1342750.3750; val_cat_covariates_contrastive_loss: 633786.8750; val_gene_expr_recon_loss: 2976873.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4970897.0000; val_optim_loss: 4970897.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9555; val_auprc_score: 0.9800; val_best_acc_score: 0.9302; val_best_f1_score: 0.9549; train_kl_reg_loss: 17510.7102; train_edge_recon_loss: 1336630.8807; train_cat_covariates_contrastive_loss: 634820.7756; train_gene_expr_recon_loss: 2963700.7159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4952663.0682; train_optim_loss: 4952663.0682; val_kl_reg_loss: 17460.5182; val_edge_recon_loss: 1339791.5417; val_cat_covariates_contrastive_loss: 634926.6042; val_gene_expr_recon_loss: 3000043.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4992222.1667; val_optim_loss: 4992222.1667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9526; val_auprc_score: 0.9789; val_best_acc_score: 0.9285; val_best_f1_score: 0.9539; train_kl_reg_loss: 17483.5195; train_edge_recon_loss: 1341402.7841; train_cat_covariates_contrastive_loss: 634823.5284; train_gene_expr_recon_loss: 2964529.1932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4958239.0000; train_optim_loss: 4958239.0000; val_kl_reg_loss: 17548.6393; val_edge_recon_loss: 1345769.0833; val_cat_covariates_contrastive_loss: 634718.8542; val_gene_expr_recon_loss: 2983835.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4981871.6667; val_optim_loss: 4981871.6667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9527; val_auprc_score: 0.9782; val_best_acc_score: 0.9298; val_best_f1_score: 0.9546; train_kl_reg_loss: 17369.2678; train_edge_recon_loss: 1338692.4034; train_cat_covariates_contrastive_loss: 634760.7415; train_gene_expr_recon_loss: 2959891.0341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4950713.4545; train_optim_loss: 4950713.4545; val_kl_reg_loss: 17236.4479; val_edge_recon_loss: 1349660.1667; val_cat_covariates_contrastive_loss: 633627.0000; val_gene_expr_recon_loss: 3003104.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5003627.6667; val_optim_loss: 5003627.6667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9527; val_auprc_score: 0.9782; val_best_acc_score: 0.9286; val_best_f1_score: 0.9537; train_kl_reg_loss: 17243.2627; train_edge_recon_loss: 1340153.6534; train_cat_covariates_contrastive_loss: 634752.2585; train_gene_expr_recon_loss: 2958381.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4950530.7727; train_optim_loss: 4950530.7727; val_kl_reg_loss: 17368.3646; val_edge_recon_loss: 1359909.1250; val_cat_covariates_contrastive_loss: 633928.9375; val_gene_expr_recon_loss: 3028011.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5039218.0000; val_optim_loss: 5039218.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9513; val_auprc_score: 0.9774; val_best_acc_score: 0.9289; val_best_f1_score: 0.9541; train_kl_reg_loss: 17143.9343; train_edge_recon_loss: 1342081.5000; train_cat_covariates_contrastive_loss: 634829.3381; train_gene_expr_recon_loss: 2956473.7045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4950528.4318; train_optim_loss: 4950528.4318; val_kl_reg_loss: 17272.1960; val_edge_recon_loss: 1350624.9583; val_cat_covariates_contrastive_loss: 633533.6875; val_gene_expr_recon_loss: 3012354.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5013785.3333; val_optim_loss: 5013785.3333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9541; val_auprc_score: 0.9792; val_best_acc_score: 0.9316; val_best_f1_score: 0.9557; train_kl_reg_loss: 17136.4862; train_edge_recon_loss: 1338195.5568; train_cat_covariates_contrastive_loss: 634877.0256; train_gene_expr_recon_loss: 2957542.8295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4947751.9318; train_optim_loss: 4947751.9318; val_kl_reg_loss: 17250.1693; val_edge_recon_loss: 1336696.5833; val_cat_covariates_contrastive_loss: 634770.9792; val_gene_expr_recon_loss: 3002832.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4991550.3333; val_optim_loss: 4991550.3333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9545; val_auprc_score: 0.9794; val_best_acc_score: 0.9292; val_best_f1_score: 0.9541; train_kl_reg_loss: 17127.5544; train_edge_recon_loss: 1337110.5909; train_cat_covariates_contrastive_loss: 635270.9290; train_gene_expr_recon_loss: 2956205.0568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4945714.1136; train_optim_loss: 4945714.1136; val_kl_reg_loss: 17221.4870; val_edge_recon_loss: 1362962.5833; val_cat_covariates_contrastive_loss: 634162.0625; val_gene_expr_recon_loss: 3018254.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5032600.8333; val_optim_loss: 5032600.8333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9527; val_auprc_score: 0.9788; val_best_acc_score: 0.9310; val_best_f1_score: 0.9555; train_kl_reg_loss: 17171.1337; train_edge_recon_loss: 1339377.8352; train_cat_covariates_contrastive_loss: 635101.4460; train_gene_expr_recon_loss: 2960477.8864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4952128.3409; train_optim_loss: 4952128.3409; val_kl_reg_loss: 17158.8652; val_edge_recon_loss: 1343650.6667; val_cat_covariates_contrastive_loss: 634584.1458; val_gene_expr_recon_loss: 2990968.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4986362.3333; val_optim_loss: 4986362.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 8 min 6 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
val AUROC score: 0.9326
val AUPRC score: 0.9673
val best accuracy score: 0.9215
val best F1 score: 0.9493
val target rna MSE score: 1.1390
val source rna MSE score: 0.3430
Val cat covariate0 mean sim diff: -0.0014
Val cat covariate1 mean sim diff: -0.0813
Duration of model training in run 6: 0 hours, 8 minutes and 14 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 25413
Number of validation nodes: 2824
Number of training edges: 174662
Number of validation edges: 19406
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9267; val_auprc_score: 0.9726; val_best_acc_score: 0.8592; val_best_f1_score: 0.9080; train_kl_reg_loss: 2459.2471; train_edge_recon_loss: 1844700.4489; train_cat_covariates_contrastive_loss: 758965.0398; train_gene_expr_recon_loss: 4170182.8295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6776307.5000; train_optim_loss: 6776307.5000; val_kl_reg_loss: 2369.9378; val_edge_recon_loss: 2016370.3750; val_cat_covariates_contrastive_loss: 627255.2083; val_gene_expr_recon_loss: 4020059.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6666055.3333; val_optim_loss: 6666055.3333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8451; val_auprc_score: 0.9402; val_best_acc_score: 0.8403; val_best_f1_score: 0.9028; train_kl_reg_loss: 5196.2074; train_edge_recon_loss: 1660928.4261; train_cat_covariates_contrastive_loss: 639702.7188; train_gene_expr_recon_loss: 3773951.4886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6079778.8409; train_optim_loss: 6079778.8409; val_kl_reg_loss: 10656.2415; val_edge_recon_loss: 1613745.4167; val_cat_covariates_contrastive_loss: 626740.7917; val_gene_expr_recon_loss: 3667382.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5918524.6667; val_optim_loss: 5918524.6667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8503; val_auprc_score: 0.9406; val_best_acc_score: 0.8470; val_best_f1_score: 0.9059; train_kl_reg_loss: 18453.1584; train_edge_recon_loss: 1543984.1023; train_cat_covariates_contrastive_loss: 627747.9773; train_gene_expr_recon_loss: 3489108.0114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5679293.2273; train_optim_loss: 5679293.2273; val_kl_reg_loss: 25459.1211; val_edge_recon_loss: 1540356.6250; val_cat_covariates_contrastive_loss: 626666.2917; val_gene_expr_recon_loss: 3367800.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5560282.8333; val_optim_loss: 5560282.8333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8702; val_auprc_score: 0.9498; val_best_acc_score: 0.8590; val_best_f1_score: 0.9131; train_kl_reg_loss: 29981.9178; train_edge_recon_loss: 1511624.4205; train_cat_covariates_contrastive_loss: 627002.5938; train_gene_expr_recon_loss: 3315563.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5484172.4773; train_optim_loss: 5484172.4773; val_kl_reg_loss: 31235.5970; val_edge_recon_loss: 1489610.7083; val_cat_covariates_contrastive_loss: 626702.8542; val_gene_expr_recon_loss: 3251862.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5399411.6667; val_optim_loss: 5399411.6667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8789; val_auprc_score: 0.9532; val_best_acc_score: 0.8620; val_best_f1_score: 0.9156; train_kl_reg_loss: 29043.8162; train_edge_recon_loss: 1474689.9148; train_cat_covariates_contrastive_loss: 627109.8750; train_gene_expr_recon_loss: 3216293.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5347137.2955; train_optim_loss: 5347137.2955; val_kl_reg_loss: 25841.1230; val_edge_recon_loss: 1476964.0000; val_cat_covariates_contrastive_loss: 626886.8333; val_gene_expr_recon_loss: 3163945.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5293637.0000; val_optim_loss: 5293637.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8950; val_auprc_score: 0.9595; val_best_acc_score: 0.8649; val_best_f1_score: 0.9171; train_kl_reg_loss: 24055.5424; train_edge_recon_loss: 1452545.5568; train_cat_covariates_contrastive_loss: 627873.5909; train_gene_expr_recon_loss: 3158496.5909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5262971.2727; train_optim_loss: 5262971.2727; val_kl_reg_loss: 22849.1257; val_edge_recon_loss: 1451719.6250; val_cat_covariates_contrastive_loss: 627329.8542; val_gene_expr_recon_loss: 3165313.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5267211.6667; val_optim_loss: 5267211.6667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9122; val_auprc_score: 0.9636; val_best_acc_score: 0.8783; val_best_f1_score: 0.9236; train_kl_reg_loss: 20332.7555; train_edge_recon_loss: 1448478.6420; train_cat_covariates_contrastive_loss: 629572.7415; train_gene_expr_recon_loss: 3123519.7955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5221903.9091; train_optim_loss: 5221903.9091; val_kl_reg_loss: 19071.2604; val_edge_recon_loss: 1419205.7500; val_cat_covariates_contrastive_loss: 629263.3542; val_gene_expr_recon_loss: 3111768.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5179308.6667; val_optim_loss: 5179308.6667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9355; val_auprc_score: 0.9730; val_best_acc_score: 0.9052; val_best_f1_score: 0.9394; train_kl_reg_loss: 18382.7991; train_edge_recon_loss: 1392669.6989; train_cat_covariates_contrastive_loss: 633315.2955; train_gene_expr_recon_loss: 3096871.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5141239.0000; train_optim_loss: 5141239.0000; val_kl_reg_loss: 18426.5579; val_edge_recon_loss: 1392532.5417; val_cat_covariates_contrastive_loss: 635881.4167; val_gene_expr_recon_loss: 3075030.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5121871.5000; val_optim_loss: 5121871.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9408; val_auprc_score: 0.9748; val_best_acc_score: 0.9102; val_best_f1_score: 0.9427; train_kl_reg_loss: 18891.2122; train_edge_recon_loss: 1365355.1136; train_cat_covariates_contrastive_loss: 636256.5057; train_gene_expr_recon_loss: 3074609.7614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5095112.5682; train_optim_loss: 5095112.5682; val_kl_reg_loss: 19468.2025; val_edge_recon_loss: 1369191.6667; val_cat_covariates_contrastive_loss: 634550.0208; val_gene_expr_recon_loss: 3071115.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5094325.8333; val_optim_loss: 5094325.8333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9389; val_auprc_score: 0.9725; val_best_acc_score: 0.9104; val_best_f1_score: 0.9423; train_kl_reg_loss: 19523.3295; train_edge_recon_loss: 1363438.8580; train_cat_covariates_contrastive_loss: 636051.2841; train_gene_expr_recon_loss: 3051862.5114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5070875.9545; train_optim_loss: 5070875.9545; val_kl_reg_loss: 19210.7285; val_edge_recon_loss: 1390734.8333; val_cat_covariates_contrastive_loss: 635419.1458; val_gene_expr_recon_loss: 2987874.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5033238.5000; val_optim_loss: 5033238.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9402; val_auprc_score: 0.9746; val_best_acc_score: 0.9130; val_best_f1_score: 0.9442; train_kl_reg_loss: 19358.0286; train_edge_recon_loss: 1364590.2955; train_cat_covariates_contrastive_loss: 635940.7955; train_gene_expr_recon_loss: 3037710.9318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5057600.0227; train_optim_loss: 5057600.0227; val_kl_reg_loss: 19226.5534; val_edge_recon_loss: 1366223.9583; val_cat_covariates_contrastive_loss: 633912.5000; val_gene_expr_recon_loss: 3006854.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5026217.6667; val_optim_loss: 5026217.6667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9424; val_auprc_score: 0.9745; val_best_acc_score: 0.9165; val_best_f1_score: 0.9464; train_kl_reg_loss: 18807.7361; train_edge_recon_loss: 1345186.2102; train_cat_covariates_contrastive_loss: 635699.9091; train_gene_expr_recon_loss: 3025646.8523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5025340.7727; train_optim_loss: 5025340.7727; val_kl_reg_loss: 18228.8249; val_edge_recon_loss: 1361129.4583; val_cat_covariates_contrastive_loss: 634311.9792; val_gene_expr_recon_loss: 3032493.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5046163.6667; val_optim_loss: 5046163.6667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9468; val_auprc_score: 0.9764; val_best_acc_score: 0.9199; val_best_f1_score: 0.9482; train_kl_reg_loss: 17947.7047; train_edge_recon_loss: 1342501.6420; train_cat_covariates_contrastive_loss: 635783.3040; train_gene_expr_recon_loss: 3011031.3523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5007264.0000; train_optim_loss: 5007264.0000; val_kl_reg_loss: 17797.1829; val_edge_recon_loss: 1357502.7500; val_cat_covariates_contrastive_loss: 634960.8542; val_gene_expr_recon_loss: 3001587.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5011848.6667; val_optim_loss: 5011848.6667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9496; val_auprc_score: 0.9771; val_best_acc_score: 0.9243; val_best_f1_score: 0.9512; train_kl_reg_loss: 17305.1483; train_edge_recon_loss: 1346331.6136; train_cat_covariates_contrastive_loss: 635375.4602; train_gene_expr_recon_loss: 2995937.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4994950.0455; train_optim_loss: 4994950.0455; val_kl_reg_loss: 16854.0046; val_edge_recon_loss: 1345881.0000; val_cat_covariates_contrastive_loss: 635473.5417; val_gene_expr_recon_loss: 2978489.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4976698.0000; val_optim_loss: 4976698.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9512; val_auprc_score: 0.9775; val_best_acc_score: 0.9276; val_best_f1_score: 0.9529; train_kl_reg_loss: 16688.8973; train_edge_recon_loss: 1338557.2898; train_cat_covariates_contrastive_loss: 635902.2415; train_gene_expr_recon_loss: 2988067.0682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4979215.5000; train_optim_loss: 4979215.5000; val_kl_reg_loss: 16263.9613; val_edge_recon_loss: 1352494.5833; val_cat_covariates_contrastive_loss: 635071.1458; val_gene_expr_recon_loss: 2954514.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4958344.1667; val_optim_loss: 4958344.1667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9496; val_auprc_score: 0.9764; val_best_acc_score: 0.9283; val_best_f1_score: 0.9535; train_kl_reg_loss: 16058.6389; train_edge_recon_loss: 1332066.5682; train_cat_covariates_contrastive_loss: 635240.9261; train_gene_expr_recon_loss: 2978060.6023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4961426.7500; train_optim_loss: 4961426.7500; val_kl_reg_loss: 15551.4141; val_edge_recon_loss: 1349075.0000; val_cat_covariates_contrastive_loss: 634849.0208; val_gene_expr_recon_loss: 2969001.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4968477.3333; val_optim_loss: 4968477.3333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9505; val_auprc_score: 0.9762; val_best_acc_score: 0.9347; val_best_f1_score: 0.9574; train_kl_reg_loss: 15467.5547; train_edge_recon_loss: 1326832.3636; train_cat_covariates_contrastive_loss: 635606.2131; train_gene_expr_recon_loss: 2968234.1023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4946140.2273; train_optim_loss: 4946140.2273; val_kl_reg_loss: 15489.3721; val_edge_recon_loss: 1349526.0417; val_cat_covariates_contrastive_loss: 635270.0208; val_gene_expr_recon_loss: 2966650.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4966935.8333; val_optim_loss: 4966935.8333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9534; val_auprc_score: 0.9783; val_best_acc_score: 0.9364; val_best_f1_score: 0.9590; train_kl_reg_loss: 15038.5823; train_edge_recon_loss: 1336151.7386; train_cat_covariates_contrastive_loss: 635252.3977; train_gene_expr_recon_loss: 2959062.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4945505.5000; train_optim_loss: 4945505.5000; val_kl_reg_loss: 14603.9548; val_edge_recon_loss: 1327356.1667; val_cat_covariates_contrastive_loss: 635292.4792; val_gene_expr_recon_loss: 2932568.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4909821.1667; val_optim_loss: 4909821.1667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9527; val_auprc_score: 0.9775; val_best_acc_score: 0.9381; val_best_f1_score: 0.9600; train_kl_reg_loss: 14644.8535; train_edge_recon_loss: 1320894.1136; train_cat_covariates_contrastive_loss: 635187.6278; train_gene_expr_recon_loss: 2951307.4659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4922034.0227; train_optim_loss: 4922034.0227; val_kl_reg_loss: 14336.4378; val_edge_recon_loss: 1323252.6667; val_cat_covariates_contrastive_loss: 635975.7292; val_gene_expr_recon_loss: 2933346.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4906911.3333; val_optim_loss: 4906911.3333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9538; val_auprc_score: 0.9780; val_best_acc_score: 0.9387; val_best_f1_score: 0.9604; train_kl_reg_loss: 14472.9643; train_edge_recon_loss: 1324671.9432; train_cat_covariates_contrastive_loss: 634877.4432; train_gene_expr_recon_loss: 2944894.2614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4918916.6591; train_optim_loss: 4918916.6591; val_kl_reg_loss: 14162.2064; val_edge_recon_loss: 1333931.5417; val_cat_covariates_contrastive_loss: 634544.0208; val_gene_expr_recon_loss: 2906866.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4889504.1667; val_optim_loss: 4889504.1667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9528; val_auprc_score: 0.9776; val_best_acc_score: 0.9416; val_best_f1_score: 0.9624; train_kl_reg_loss: 14269.1661; train_edge_recon_loss: 1324217.5966; train_cat_covariates_contrastive_loss: 634676.1733; train_gene_expr_recon_loss: 2940480.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4913643.0000; train_optim_loss: 4913643.0000; val_kl_reg_loss: 14069.6227; val_edge_recon_loss: 1322648.9583; val_cat_covariates_contrastive_loss: 633265.3333; val_gene_expr_recon_loss: 2979846.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4949830.3333; val_optim_loss: 4949830.3333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9516; val_auprc_score: 0.9773; val_best_acc_score: 0.9414; val_best_f1_score: 0.9624; train_kl_reg_loss: 13992.0352; train_edge_recon_loss: 1316572.4432; train_cat_covariates_contrastive_loss: 634839.4972; train_gene_expr_recon_loss: 2930514.3295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4895918.2500; train_optim_loss: 4895918.2500; val_kl_reg_loss: 13980.3258; val_edge_recon_loss: 1310517.6667; val_cat_covariates_contrastive_loss: 633616.6667; val_gene_expr_recon_loss: 2946204.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4904318.6667; val_optim_loss: 4904318.6667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9520; val_auprc_score: 0.9772; val_best_acc_score: 0.9418; val_best_f1_score: 0.9625; train_kl_reg_loss: 13853.3418; train_edge_recon_loss: 1321911.0057; train_cat_covariates_contrastive_loss: 634880.0511; train_gene_expr_recon_loss: 2922370.8068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4893015.2045; train_optim_loss: 4893015.2045; val_kl_reg_loss: 13916.6497; val_edge_recon_loss: 1328065.3750; val_cat_covariates_contrastive_loss: 634179.8750; val_gene_expr_recon_loss: 2911444.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4887606.5000; val_optim_loss: 4887606.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9553; val_auprc_score: 0.9790; val_best_acc_score: 0.9414; val_best_f1_score: 0.9623; train_kl_reg_loss: 13521.5919; train_edge_recon_loss: 1320812.9034; train_cat_covariates_contrastive_loss: 634607.5966; train_gene_expr_recon_loss: 2915526.3977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4884468.5909; train_optim_loss: 4884468.5909; val_kl_reg_loss: 13487.0459; val_edge_recon_loss: 1329077.9583; val_cat_covariates_contrastive_loss: 634423.3125; val_gene_expr_recon_loss: 2905144.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4882133.1667; val_optim_loss: 4882133.1667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9540; val_auprc_score: 0.9772; val_best_acc_score: 0.9440; val_best_f1_score: 0.9639; train_kl_reg_loss: 13498.1526; train_edge_recon_loss: 1311241.6761; train_cat_covariates_contrastive_loss: 634291.2102; train_gene_expr_recon_loss: 2910203.4091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4869234.4318; train_optim_loss: 4869234.4318; val_kl_reg_loss: 13319.8431; val_edge_recon_loss: 1321723.9583; val_cat_covariates_contrastive_loss: 634139.6250; val_gene_expr_recon_loss: 2875600.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4844783.5000; val_optim_loss: 4844783.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9574; val_auprc_score: 0.9797; val_best_acc_score: 0.9429; val_best_f1_score: 0.9631; train_kl_reg_loss: 13257.9470; train_edge_recon_loss: 1326877.7898; train_cat_covariates_contrastive_loss: 634420.7699; train_gene_expr_recon_loss: 2905055.8523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4879612.3864; train_optim_loss: 4879612.3864; val_kl_reg_loss: 12812.5531; val_edge_recon_loss: 1325080.8750; val_cat_covariates_contrastive_loss: 635519.1667; val_gene_expr_recon_loss: 2888786.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4862199.3333; val_optim_loss: 4862199.3333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9530; val_auprc_score: 0.9781; val_best_acc_score: 0.9424; val_best_f1_score: 0.9629; train_kl_reg_loss: 13134.0091; train_edge_recon_loss: 1315892.4432; train_cat_covariates_contrastive_loss: 634243.5966; train_gene_expr_recon_loss: 2896410.6023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4859680.7273; train_optim_loss: 4859680.7273; val_kl_reg_loss: 12896.1982; val_edge_recon_loss: 1323935.2917; val_cat_covariates_contrastive_loss: 634401.5417; val_gene_expr_recon_loss: 2926644.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4897877.5000; val_optim_loss: 4897877.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9557; val_auprc_score: 0.9783; val_best_acc_score: 0.9439; val_best_f1_score: 0.9637; train_kl_reg_loss: 13040.1566; train_edge_recon_loss: 1318876.0909; train_cat_covariates_contrastive_loss: 634245.1960; train_gene_expr_recon_loss: 2894124.2841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4860285.6818; train_optim_loss: 4860285.6818; val_kl_reg_loss: 12892.0459; val_edge_recon_loss: 1328762.2917; val_cat_covariates_contrastive_loss: 634466.3125; val_gene_expr_recon_loss: 2830085.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4806205.6667; val_optim_loss: 4806205.6667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9534; val_auprc_score: 0.9774; val_best_acc_score: 0.9418; val_best_f1_score: 0.9624; train_kl_reg_loss: 12954.8566; train_edge_recon_loss: 1320453.5909; train_cat_covariates_contrastive_loss: 634161.4915; train_gene_expr_recon_loss: 2887107.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4854677.8182; train_optim_loss: 4854677.8182; val_kl_reg_loss: 12911.7786; val_edge_recon_loss: 1329430.5417; val_cat_covariates_contrastive_loss: 633575.0417; val_gene_expr_recon_loss: 2906778.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4882696.1667; val_optim_loss: 4882696.1667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9543; val_auprc_score: 0.9782; val_best_acc_score: 0.9454; val_best_f1_score: 0.9649; train_kl_reg_loss: 12828.2526; train_edge_recon_loss: 1315204.5511; train_cat_covariates_contrastive_loss: 634089.3920; train_gene_expr_recon_loss: 2879986.1364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4842108.3409; train_optim_loss: 4842108.3409; val_kl_reg_loss: 12596.7754; val_edge_recon_loss: 1310838.8750; val_cat_covariates_contrastive_loss: 633500.5000; val_gene_expr_recon_loss: 2854045.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4810982.0000; val_optim_loss: 4810982.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9573; val_auprc_score: 0.9794; val_best_acc_score: 0.9446; val_best_f1_score: 0.9642; train_kl_reg_loss: 12680.9623; train_edge_recon_loss: 1320871.2159; train_cat_covariates_contrastive_loss: 634030.4773; train_gene_expr_recon_loss: 2876485.5682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4844068.2955; train_optim_loss: 4844068.2955; val_kl_reg_loss: 12487.9463; val_edge_recon_loss: 1320102.3750; val_cat_covariates_contrastive_loss: 633397.1250; val_gene_expr_recon_loss: 2860119.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4826107.0000; val_optim_loss: 4826107.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9564; val_auprc_score: 0.9792; val_best_acc_score: 0.9465; val_best_f1_score: 0.9655; train_kl_reg_loss: 12598.9758; train_edge_recon_loss: 1319038.3580; train_cat_covariates_contrastive_loss: 634187.5710; train_gene_expr_recon_loss: 2870736.2045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4836561.1136; train_optim_loss: 4836561.1136; val_kl_reg_loss: 12426.7370; val_edge_recon_loss: 1304271.1667; val_cat_covariates_contrastive_loss: 633452.3750; val_gene_expr_recon_loss: 2853467.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4803618.0000; val_optim_loss: 4803618.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9566; val_auprc_score: 0.9796; val_best_acc_score: 0.9468; val_best_f1_score: 0.9655; train_kl_reg_loss: 12582.2537; train_edge_recon_loss: 1316232.9261; train_cat_covariates_contrastive_loss: 633820.3239; train_gene_expr_recon_loss: 2865161.3523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4827796.8409; train_optim_loss: 4827796.8409; val_kl_reg_loss: 12514.8734; val_edge_recon_loss: 1307975.7083; val_cat_covariates_contrastive_loss: 633376.3750; val_gene_expr_recon_loss: 2875593.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4829460.8333; val_optim_loss: 4829460.8333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9542; val_auprc_score: 0.9774; val_best_acc_score: 0.9467; val_best_f1_score: 0.9655; train_kl_reg_loss: 12435.5581; train_edge_recon_loss: 1310520.9602; train_cat_covariates_contrastive_loss: 633952.4631; train_gene_expr_recon_loss: 2859777.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4816686.5000; train_optim_loss: 4816686.5000; val_kl_reg_loss: 12345.5254; val_edge_recon_loss: 1343481.9583; val_cat_covariates_contrastive_loss: 632991.8750; val_gene_expr_recon_loss: 2871113.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4859933.0000; val_optim_loss: 4859933.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9542; val_auprc_score: 0.9773; val_best_acc_score: 0.9459; val_best_f1_score: 0.9651; train_kl_reg_loss: 12381.0320; train_edge_recon_loss: 1317308.2841; train_cat_covariates_contrastive_loss: 634008.0028; train_gene_expr_recon_loss: 2857277.1591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4820974.5000; train_optim_loss: 4820974.5000; val_kl_reg_loss: 12176.7217; val_edge_recon_loss: 1306990.5417; val_cat_covariates_contrastive_loss: 632754.3542; val_gene_expr_recon_loss: 2878415.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4830336.8333; val_optim_loss: 4830336.8333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9569; val_auprc_score: 0.9791; val_best_acc_score: 0.9488; val_best_f1_score: 0.9668; train_kl_reg_loss: 12363.5293; train_edge_recon_loss: 1315817.5057; train_cat_covariates_contrastive_loss: 633938.0369; train_gene_expr_recon_loss: 2853634.3295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4815753.4545; train_optim_loss: 4815753.4545; val_kl_reg_loss: 12076.5853; val_edge_recon_loss: 1314128.3750; val_cat_covariates_contrastive_loss: 633580.1875; val_gene_expr_recon_loss: 2849940.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4809725.8333; val_optim_loss: 4809725.8333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9571; val_auprc_score: 0.9793; val_best_acc_score: 0.9468; val_best_f1_score: 0.9655; train_kl_reg_loss: 12310.9442; train_edge_recon_loss: 1313165.4602; train_cat_covariates_contrastive_loss: 633761.5057; train_gene_expr_recon_loss: 2844588.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4803825.9773; train_optim_loss: 4803825.9773; val_kl_reg_loss: 12207.6204; val_edge_recon_loss: 1321379.3333; val_cat_covariates_contrastive_loss: 633415.4792; val_gene_expr_recon_loss: 2826492.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4793494.5000; val_optim_loss: 4793494.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9569; val_auprc_score: 0.9796; val_best_acc_score: 0.9482; val_best_f1_score: 0.9665; train_kl_reg_loss: 12312.7959; train_edge_recon_loss: 1314583.5682; train_cat_covariates_contrastive_loss: 633758.9205; train_gene_expr_recon_loss: 2849365.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4810020.5455; train_optim_loss: 4810020.5455; val_kl_reg_loss: 12280.7419; val_edge_recon_loss: 1316980.5417; val_cat_covariates_contrastive_loss: 633105.0833; val_gene_expr_recon_loss: 2851277.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4813644.1667; val_optim_loss: 4813644.1667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9559; val_auprc_score: 0.9773; val_best_acc_score: 0.9485; val_best_f1_score: 0.9666; train_kl_reg_loss: 12310.8043; train_edge_recon_loss: 1311564.4716; train_cat_covariates_contrastive_loss: 633865.2188; train_gene_expr_recon_loss: 2844878.2045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4802618.7727; train_optim_loss: 4802618.7727; val_kl_reg_loss: 12227.7575; val_edge_recon_loss: 1310216.0000; val_cat_covariates_contrastive_loss: 633862.2292; val_gene_expr_recon_loss: 2858825.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4815131.1667; val_optim_loss: 4815131.1667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9529; val_auprc_score: 0.9760; val_best_acc_score: 0.9445; val_best_f1_score: 0.9641; train_kl_reg_loss: 12291.7823; train_edge_recon_loss: 1314728.0625; train_cat_covariates_contrastive_loss: 633606.6335; train_gene_expr_recon_loss: 2844631.6477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4805258.1591; train_optim_loss: 4805258.1591; val_kl_reg_loss: 12181.2132; val_edge_recon_loss: 1334400.1667; val_cat_covariates_contrastive_loss: 634026.2708; val_gene_expr_recon_loss: 2849804.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4830411.8333; val_optim_loss: 4830411.8333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9551; val_auprc_score: 0.9781; val_best_acc_score: 0.9474; val_best_f1_score: 0.9660; train_kl_reg_loss: 12262.0374; train_edge_recon_loss: 1311406.6420; train_cat_covariates_contrastive_loss: 633559.2585; train_gene_expr_recon_loss: 2844023.5341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4801251.5000; train_optim_loss: 4801251.5000; val_kl_reg_loss: 12264.2269; val_edge_recon_loss: 1317825.2083; val_cat_covariates_contrastive_loss: 633310.7292; val_gene_expr_recon_loss: 2885726.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4849126.5000; val_optim_loss: 4849126.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9538; val_auprc_score: 0.9772; val_best_acc_score: 0.9458; val_best_f1_score: 0.9649; train_kl_reg_loss: 12250.4085; train_edge_recon_loss: 1315245.4148; train_cat_covariates_contrastive_loss: 633598.3011; train_gene_expr_recon_loss: 2843352.2614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4804446.4091; train_optim_loss: 4804446.4091; val_kl_reg_loss: 12104.2702; val_edge_recon_loss: 1326734.4167; val_cat_covariates_contrastive_loss: 633500.7500; val_gene_expr_recon_loss: 2794126.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4766465.5000; val_optim_loss: 4766465.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9516; val_auprc_score: 0.9758; val_best_acc_score: 0.9461; val_best_f1_score: 0.9651; train_kl_reg_loss: 12241.2757; train_edge_recon_loss: 1312642.2159; train_cat_covariates_contrastive_loss: 633666.9716; train_gene_expr_recon_loss: 2839692.2841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4798242.7045; train_optim_loss: 4798242.7045; val_kl_reg_loss: 12318.1706; val_edge_recon_loss: 1325863.2500; val_cat_covariates_contrastive_loss: 633470.7708; val_gene_expr_recon_loss: 2884309.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4855962.1667; val_optim_loss: 4855962.1667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9571; val_auprc_score: 0.9795; val_best_acc_score: 0.9477; val_best_f1_score: 0.9661; train_kl_reg_loss: 12255.8377; train_edge_recon_loss: 1316073.9545; train_cat_covariates_contrastive_loss: 633629.6023; train_gene_expr_recon_loss: 2842159.3523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4804118.7045; train_optim_loss: 4804118.7045; val_kl_reg_loss: 12276.0000; val_edge_recon_loss: 1319220.0833; val_cat_covariates_contrastive_loss: 632752.3542; val_gene_expr_recon_loss: 2839086.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4803335.0000; val_optim_loss: 4803335.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9576; val_auprc_score: 0.9793; val_best_acc_score: 0.9481; val_best_f1_score: 0.9664; train_kl_reg_loss: 12227.1080; train_edge_recon_loss: 1317094.0000; train_cat_covariates_contrastive_loss: 633917.1534; train_gene_expr_recon_loss: 2845539.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4808777.2955; train_optim_loss: 4808777.2955; val_kl_reg_loss: 12291.5114; val_edge_recon_loss: 1313033.5833; val_cat_covariates_contrastive_loss: 632979.5833; val_gene_expr_recon_loss: 2893264.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4851568.6667; val_optim_loss: 4851568.6667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9554; val_auprc_score: 0.9788; val_best_acc_score: 0.9473; val_best_f1_score: 0.9660; train_kl_reg_loss: 12244.2442; train_edge_recon_loss: 1308795.5170; train_cat_covariates_contrastive_loss: 633959.5426; train_gene_expr_recon_loss: 2842157.2159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4797156.6136; train_optim_loss: 4797156.6136; val_kl_reg_loss: 12224.4180; val_edge_recon_loss: 1303658.3750; val_cat_covariates_contrastive_loss: 632389.6042; val_gene_expr_recon_loss: 2827239.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4775511.8333; val_optim_loss: 4775511.8333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9537; val_auprc_score: 0.9777; val_best_acc_score: 0.9468; val_best_f1_score: 0.9657; train_kl_reg_loss: 12247.9833; train_edge_recon_loss: 1315444.1420; train_cat_covariates_contrastive_loss: 633772.4375; train_gene_expr_recon_loss: 2841657.2614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4803121.8636; train_optim_loss: 4803121.8636; val_kl_reg_loss: 12185.9147; val_edge_recon_loss: 1313422.8750; val_cat_covariates_contrastive_loss: 632787.1042; val_gene_expr_recon_loss: 2793124.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4751520.5000; val_optim_loss: 4751520.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9588; val_auprc_score: 0.9805; val_best_acc_score: 0.9487; val_best_f1_score: 0.9667; train_kl_reg_loss: 12250.8946; train_edge_recon_loss: 1317754.0568; train_cat_covariates_contrastive_loss: 633884.9688; train_gene_expr_recon_loss: 2844653.2614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4808543.1364; train_optim_loss: 4808543.1364; val_kl_reg_loss: 12267.8132; val_edge_recon_loss: 1319423.6667; val_cat_covariates_contrastive_loss: 632828.2083; val_gene_expr_recon_loss: 2831731.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4796251.3333; val_optim_loss: 4796251.3333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9584; val_auprc_score: 0.9794; val_best_acc_score: 0.9491; val_best_f1_score: 0.9669; train_kl_reg_loss: 12238.0522; train_edge_recon_loss: 1320778.1932; train_cat_covariates_contrastive_loss: 633688.6562; train_gene_expr_recon_loss: 2841285.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4807990.5455; train_optim_loss: 4807990.5455; val_kl_reg_loss: 12038.5882; val_edge_recon_loss: 1325439.2083; val_cat_covariates_contrastive_loss: 633183.3125; val_gene_expr_recon_loss: 2809466.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4780127.3333; val_optim_loss: 4780127.3333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9547; val_auprc_score: 0.9779; val_best_acc_score: 0.9473; val_best_f1_score: 0.9658; train_kl_reg_loss: 12247.9685; train_edge_recon_loss: 1316160.3125; train_cat_covariates_contrastive_loss: 633851.7216; train_gene_expr_recon_loss: 2844409.7727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4806669.7955; train_optim_loss: 4806669.7955; val_kl_reg_loss: 12150.7598; val_edge_recon_loss: 1318404.5417; val_cat_covariates_contrastive_loss: 633082.5000; val_gene_expr_recon_loss: 2846398.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4810036.5000; val_optim_loss: 4810036.5000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9572; val_auprc_score: 0.9795; val_best_acc_score: 0.9490; val_best_f1_score: 0.9669; train_kl_reg_loss: 12251.7221; train_edge_recon_loss: 1313269.4602; train_cat_covariates_contrastive_loss: 633684.2756; train_gene_expr_recon_loss: 2841229.1023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4800434.6136; train_optim_loss: 4800434.6136; val_kl_reg_loss: 12292.5492; val_edge_recon_loss: 1310173.7917; val_cat_covariates_contrastive_loss: 634060.4792; val_gene_expr_recon_loss: 2850182.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4806708.8333; val_optim_loss: 4806708.8333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9568; val_auprc_score: 0.9789; val_best_acc_score: 0.9484; val_best_f1_score: 0.9667; train_kl_reg_loss: 12252.1475; train_edge_recon_loss: 1312110.2102; train_cat_covariates_contrastive_loss: 633781.9347; train_gene_expr_recon_loss: 2845669.8295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4803814.0909; train_optim_loss: 4803814.0909; val_kl_reg_loss: 12137.7038; val_edge_recon_loss: 1312526.7500; val_cat_covariates_contrastive_loss: 633919.8958; val_gene_expr_recon_loss: 2864099.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4822684.0000; val_optim_loss: 4822684.0000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9562; val_auprc_score: 0.9788; val_best_acc_score: 0.9485; val_best_f1_score: 0.9667; train_kl_reg_loss: 12238.7951; train_edge_recon_loss: 1311417.8011; train_cat_covariates_contrastive_loss: 633709.0170; train_gene_expr_recon_loss: 2843874.1591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4801239.7500; train_optim_loss: 4801239.7500; val_kl_reg_loss: 12248.8158; val_edge_recon_loss: 1323675.3333; val_cat_covariates_contrastive_loss: 633352.8958; val_gene_expr_recon_loss: 2873895.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4843172.8333; val_optim_loss: 4843172.8333
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9547; val_auprc_score: 0.9786; val_best_acc_score: 0.9470; val_best_f1_score: 0.9657; train_kl_reg_loss: 12251.1084; train_edge_recon_loss: 1304393.6534; train_cat_covariates_contrastive_loss: 633729.1619; train_gene_expr_recon_loss: 2847572.4659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4797946.3636; train_optim_loss: 4797946.3636; val_kl_reg_loss: 12050.7848; val_edge_recon_loss: 1332076.1250; val_cat_covariates_contrastive_loss: 633103.5625; val_gene_expr_recon_loss: 2812356.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4789586.6667; val_optim_loss: 4789586.6667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9567; val_auprc_score: 0.9785; val_best_acc_score: 0.9484; val_best_f1_score: 0.9665; train_kl_reg_loss: 12243.7738; train_edge_recon_loss: 1312348.6193; train_cat_covariates_contrastive_loss: 633347.3551; train_gene_expr_recon_loss: 2843351.1136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4801290.8182; train_optim_loss: 4801290.8182; val_kl_reg_loss: 12243.5299; val_edge_recon_loss: 1320772.0417; val_cat_covariates_contrastive_loss: 633981.8333; val_gene_expr_recon_loss: 2876941.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4843938.6667; val_optim_loss: 4843938.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 19 min 24 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
val AUROC score: 0.9390
val AUPRC score: 0.9688
val best accuracy score: 0.9417
val best F1 score: 0.9622
val target rna MSE score: 1.0508
val source rna MSE score: 0.1702
Val cat covariate0 mean sim diff: 0.0001
Val cat covariate1 mean sim diff: -0.0869
Duration of model training in run 5: 0 hours, 19 minutes and 32 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 25413
Number of validation nodes: 2824
Number of training edges: 117816
Number of validation edges: 13090
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9513; val_auprc_score: 0.9813; val_best_acc_score: 0.8499; val_best_f1_score: 0.9090; train_kl_reg_loss: 2286.3099; train_edge_recon_loss: 1824537.1417; train_cat_covariates_contrastive_loss: 818607.3000; train_gene_expr_recon_loss: 4259618.5167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6905049.2667; train_optim_loss: 6905049.2667; val_kl_reg_loss: 2869.6582; val_edge_recon_loss: 2048845.7500; val_cat_covariates_contrastive_loss: 627180.6250; val_gene_expr_recon_loss: 4049002.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6727898.2500; val_optim_loss: 6727898.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8715; val_auprc_score: 0.9508; val_best_acc_score: 0.8477; val_best_f1_score: 0.9062; train_kl_reg_loss: 2429.0398; train_edge_recon_loss: 1775377.2167; train_cat_covariates_contrastive_loss: 664759.5167; train_gene_expr_recon_loss: 3912498.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6355063.8333; train_optim_loss: 6355063.8333; val_kl_reg_loss: 3259.3259; val_edge_recon_loss: 1841212.9375; val_cat_covariates_contrastive_loss: 627349.9062; val_gene_expr_recon_loss: 3777711.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6249533.5000; val_optim_loss: 6249533.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8398; val_auprc_score: 0.9398; val_best_acc_score: 0.8431; val_best_f1_score: 0.9052; train_kl_reg_loss: 6032.1570; train_edge_recon_loss: 1647781.0917; train_cat_covariates_contrastive_loss: 636909.2958; train_gene_expr_recon_loss: 3693270.0500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5983992.5333; train_optim_loss: 5983992.5333; val_kl_reg_loss: 9711.1792; val_edge_recon_loss: 1611011.5000; val_cat_covariates_contrastive_loss: 626787.0312; val_gene_expr_recon_loss: 3579924.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5827433.7500; val_optim_loss: 5827433.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8427; val_auprc_score: 0.9384; val_best_acc_score: 0.8434; val_best_f1_score: 0.9049; train_kl_reg_loss: 14944.8529; train_edge_recon_loss: 1555342.0333; train_cat_covariates_contrastive_loss: 628721.5542; train_gene_expr_recon_loss: 3485548.4833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5684556.9333; train_optim_loss: 5684556.9333; val_kl_reg_loss: 20980.0410; val_edge_recon_loss: 1548226.6875; val_cat_covariates_contrastive_loss: 626707.9062; val_gene_expr_recon_loss: 3410661.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5606576.2500; val_optim_loss: 5606576.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8462; val_auprc_score: 0.9382; val_best_acc_score: 0.8479; val_best_f1_score: 0.9066; train_kl_reg_loss: 25773.7634; train_edge_recon_loss: 1528972.6750; train_cat_covariates_contrastive_loss: 627230.2792; train_gene_expr_recon_loss: 3348879.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5530856.1333; train_optim_loss: 5530856.1333; val_kl_reg_loss: 30149.8975; val_edge_recon_loss: 1503908.1875; val_cat_covariates_contrastive_loss: 626658.6562; val_gene_expr_recon_loss: 3295561.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5456277.7500; val_optim_loss: 5456277.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8548; val_auprc_score: 0.9426; val_best_acc_score: 0.8524; val_best_f1_score: 0.9095; train_kl_reg_loss: 31556.0486; train_edge_recon_loss: 1491524.1667; train_cat_covariates_contrastive_loss: 627038.2333; train_gene_expr_recon_loss: 3254835.9333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5404954.3333; train_optim_loss: 5404954.3333; val_kl_reg_loss: 31200.6494; val_edge_recon_loss: 1510397.0625; val_cat_covariates_contrastive_loss: 626692.2500; val_gene_expr_recon_loss: 3232781.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5401071.5000; val_optim_loss: 5401071.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8631; val_auprc_score: 0.9472; val_best_acc_score: 0.8556; val_best_f1_score: 0.9117; train_kl_reg_loss: 31012.2793; train_edge_recon_loss: 1494504.4833; train_cat_covariates_contrastive_loss: 627162.7542; train_gene_expr_recon_loss: 3193012.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5345692.3333; train_optim_loss: 5345692.3333; val_kl_reg_loss: 29188.2812; val_edge_recon_loss: 1491817.6250; val_cat_covariates_contrastive_loss: 626754.2188; val_gene_expr_recon_loss: 3172156.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5319916.0000; val_optim_loss: 5319916.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8693; val_auprc_score: 0.9499; val_best_acc_score: 0.8621; val_best_f1_score: 0.9154; train_kl_reg_loss: 27436.7174; train_edge_recon_loss: 1470479.6250; train_cat_covariates_contrastive_loss: 627419.1417; train_gene_expr_recon_loss: 3147684.7333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5273020.2667; train_optim_loss: 5273020.2667; val_kl_reg_loss: 25737.0225; val_edge_recon_loss: 1464312.0625; val_cat_covariates_contrastive_loss: 626870.3750; val_gene_expr_recon_loss: 3128732.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5245651.5000; val_optim_loss: 5245651.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8824; val_auprc_score: 0.9554; val_best_acc_score: 0.8612; val_best_f1_score: 0.9152; train_kl_reg_loss: 24932.3527; train_edge_recon_loss: 1463673.1167; train_cat_covariates_contrastive_loss: 627943.7750; train_gene_expr_recon_loss: 3108858.6833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5225407.9333; train_optim_loss: 5225407.9333; val_kl_reg_loss: 23912.8545; val_edge_recon_loss: 1457514.1875; val_cat_covariates_contrastive_loss: 627134.2812; val_gene_expr_recon_loss: 3101577.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5210139.2500; val_optim_loss: 5210139.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8916; val_auprc_score: 0.9562; val_best_acc_score: 0.8677; val_best_f1_score: 0.9187; train_kl_reg_loss: 23142.4505; train_edge_recon_loss: 1435402.1167; train_cat_covariates_contrastive_loss: 628778.2083; train_gene_expr_recon_loss: 3089988.0667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5177310.9000; train_optim_loss: 5177310.9000; val_kl_reg_loss: 21586.1035; val_edge_recon_loss: 1448018.7500; val_cat_covariates_contrastive_loss: 627851.1562; val_gene_expr_recon_loss: 3078074.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5175530.0000; val_optim_loss: 5175530.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9136; val_auprc_score: 0.9651; val_best_acc_score: 0.8798; val_best_f1_score: 0.9236; train_kl_reg_loss: 20814.1354; train_edge_recon_loss: 1421000.8667; train_cat_covariates_contrastive_loss: 630209.2000; train_gene_expr_recon_loss: 3067199.2833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5139223.4667; train_optim_loss: 5139223.4667; val_kl_reg_loss: 19355.1895; val_edge_recon_loss: 1418558.4375; val_cat_covariates_contrastive_loss: 630092.8125; val_gene_expr_recon_loss: 3074076.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5142083.2500; val_optim_loss: 5142083.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9241; val_auprc_score: 0.9678; val_best_acc_score: 0.8971; val_best_f1_score: 0.9340; train_kl_reg_loss: 19068.9671; train_edge_recon_loss: 1390678.3833; train_cat_covariates_contrastive_loss: 632922.3417; train_gene_expr_recon_loss: 3055542.2833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5098212.0333; train_optim_loss: 5098212.0333; val_kl_reg_loss: 18503.0293; val_edge_recon_loss: 1413171.8125; val_cat_covariates_contrastive_loss: 633843.9062; val_gene_expr_recon_loss: 3050358.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5115877.5000; val_optim_loss: 5115877.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9272; val_auprc_score: 0.9685; val_best_acc_score: 0.9042; val_best_f1_score: 0.9395; train_kl_reg_loss: 19278.3833; train_edge_recon_loss: 1375052.7500; train_cat_covariates_contrastive_loss: 635852.8167; train_gene_expr_recon_loss: 3034336.8833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5064520.8000; train_optim_loss: 5064520.8000; val_kl_reg_loss: 19812.3848; val_edge_recon_loss: 1368546.9375; val_cat_covariates_contrastive_loss: 634901.9062; val_gene_expr_recon_loss: 3049329.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5072590.5000; val_optim_loss: 5072590.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9318; val_auprc_score: 0.9713; val_best_acc_score: 0.9077; val_best_f1_score: 0.9414; train_kl_reg_loss: 20302.6249; train_edge_recon_loss: 1369457.7000; train_cat_covariates_contrastive_loss: 636687.6417; train_gene_expr_recon_loss: 3025604.7167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5052052.7333; train_optim_loss: 5052052.7333; val_kl_reg_loss: 20435.6221; val_edge_recon_loss: 1366686.0625; val_cat_covariates_contrastive_loss: 635165.6875; val_gene_expr_recon_loss: 3041299.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5063587.2500; val_optim_loss: 5063587.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9339; val_auprc_score: 0.9713; val_best_acc_score: 0.9079; val_best_f1_score: 0.9409; train_kl_reg_loss: 20863.7355; train_edge_recon_loss: 1360363.2250; train_cat_covariates_contrastive_loss: 635805.2583; train_gene_expr_recon_loss: 3011586.5333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5028618.7667; train_optim_loss: 5028618.7667; val_kl_reg_loss: 20663.6719; val_edge_recon_loss: 1395108.2500; val_cat_covariates_contrastive_loss: 634507.5938; val_gene_expr_recon_loss: 3034332.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5084612.0000; val_optim_loss: 5084612.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9340; val_auprc_score: 0.9720; val_best_acc_score: 0.9074; val_best_f1_score: 0.9410; train_kl_reg_loss: 20820.0215; train_edge_recon_loss: 1350622.8750; train_cat_covariates_contrastive_loss: 635635.9917; train_gene_expr_recon_loss: 2998305.7833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5005384.6667; train_optim_loss: 5005384.6667; val_kl_reg_loss: 20391.9297; val_edge_recon_loss: 1370726.7500; val_cat_covariates_contrastive_loss: 633845.6875; val_gene_expr_recon_loss: 2991159.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5016124.2500; val_optim_loss: 5016124.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9313; val_auprc_score: 0.9694; val_best_acc_score: 0.9082; val_best_f1_score: 0.9414; train_kl_reg_loss: 20578.8421; train_edge_recon_loss: 1358279.4167; train_cat_covariates_contrastive_loss: 635576.9000; train_gene_expr_recon_loss: 2990062.7333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5004497.8667; train_optim_loss: 5004497.8667; val_kl_reg_loss: 20150.3867; val_edge_recon_loss: 1359091.9375; val_cat_covariates_contrastive_loss: 634558.3438; val_gene_expr_recon_loss: 2991095.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5004896.5000; val_optim_loss: 5004896.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9331; val_auprc_score: 0.9698; val_best_acc_score: 0.9108; val_best_f1_score: 0.9430; train_kl_reg_loss: 20027.2108; train_edge_recon_loss: 1349342.8833; train_cat_covariates_contrastive_loss: 635379.1292; train_gene_expr_recon_loss: 2982570.4667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4987319.6667; train_optim_loss: 4987319.6667; val_kl_reg_loss: 19197.3721; val_edge_recon_loss: 1380761.3125; val_cat_covariates_contrastive_loss: 634237.4375; val_gene_expr_recon_loss: 2970064.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5004260.7500; val_optim_loss: 5004260.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9351; val_auprc_score: 0.9710; val_best_acc_score: 0.9107; val_best_f1_score: 0.9426; train_kl_reg_loss: 19445.8001; train_edge_recon_loss: 1343134.0333; train_cat_covariates_contrastive_loss: 635214.9250; train_gene_expr_recon_loss: 2969806.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4967601.0000; train_optim_loss: 4967601.0000; val_kl_reg_loss: 18953.4873; val_edge_recon_loss: 1376306.1875; val_cat_covariates_contrastive_loss: 634613.2812; val_gene_expr_recon_loss: 2969065.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4998938.7500; val_optim_loss: 4998938.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9336; val_auprc_score: 0.9703; val_best_acc_score: 0.9107; val_best_f1_score: 0.9429; train_kl_reg_loss: 18913.7108; train_edge_recon_loss: 1357797.7583; train_cat_covariates_contrastive_loss: 635406.3958; train_gene_expr_recon_loss: 2966997.3167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4979115.1667; train_optim_loss: 4979115.1667; val_kl_reg_loss: 18442.6455; val_edge_recon_loss: 1377964.6250; val_cat_covariates_contrastive_loss: 633940.2812; val_gene_expr_recon_loss: 2973397.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5003744.5000; val_optim_loss: 5003744.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9327; val_auprc_score: 0.9703; val_best_acc_score: 0.9135; val_best_f1_score: 0.9449; train_kl_reg_loss: 18427.2398; train_edge_recon_loss: 1338258.5667; train_cat_covariates_contrastive_loss: 635151.9958; train_gene_expr_recon_loss: 2958393.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4950231.1000; train_optim_loss: 4950231.1000; val_kl_reg_loss: 17902.7861; val_edge_recon_loss: 1381585.7500; val_cat_covariates_contrastive_loss: 633804.7812; val_gene_expr_recon_loss: 2950966.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4984259.2500; val_optim_loss: 4984259.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9381; val_auprc_score: 0.9733; val_best_acc_score: 0.9134; val_best_f1_score: 0.9448; train_kl_reg_loss: 17862.5648; train_edge_recon_loss: 1339241.9000; train_cat_covariates_contrastive_loss: 635425.0000; train_gene_expr_recon_loss: 2954871.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4947400.6667; train_optim_loss: 4947400.6667; val_kl_reg_loss: 17329.7256; val_edge_recon_loss: 1366817.7500; val_cat_covariates_contrastive_loss: 634799.9688; val_gene_expr_recon_loss: 2961558.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4980505.7500; val_optim_loss: 4980505.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9379; val_auprc_score: 0.9711; val_best_acc_score: 0.9155; val_best_f1_score: 0.9458; train_kl_reg_loss: 17488.2887; train_edge_recon_loss: 1348759.4750; train_cat_covariates_contrastive_loss: 635225.5958; train_gene_expr_recon_loss: 2942859.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4944332.5333; train_optim_loss: 4944332.5333; val_kl_reg_loss: 16830.7637; val_edge_recon_loss: 1367851.0000; val_cat_covariates_contrastive_loss: 634735.8125; val_gene_expr_recon_loss: 2959208.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4978625.5000; val_optim_loss: 4978625.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9411; val_auprc_score: 0.9722; val_best_acc_score: 0.9174; val_best_f1_score: 0.9469; train_kl_reg_loss: 16868.7384; train_edge_recon_loss: 1341195.2417; train_cat_covariates_contrastive_loss: 635441.9208; train_gene_expr_recon_loss: 2946650.6500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4940156.5333; train_optim_loss: 4940156.5333; val_kl_reg_loss: 16522.5635; val_edge_recon_loss: 1374290.3125; val_cat_covariates_contrastive_loss: 634407.3750; val_gene_expr_recon_loss: 2941953.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4967173.2500; val_optim_loss: 4967173.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9375; val_auprc_score: 0.9716; val_best_acc_score: 0.9198; val_best_f1_score: 0.9485; train_kl_reg_loss: 16328.6209; train_edge_recon_loss: 1336851.4583; train_cat_covariates_contrastive_loss: 635471.4542; train_gene_expr_recon_loss: 2932982.6167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4921634.1000; train_optim_loss: 4921634.1000; val_kl_reg_loss: 16030.7944; val_edge_recon_loss: 1354727.8750; val_cat_covariates_contrastive_loss: 634973.5625; val_gene_expr_recon_loss: 2951061.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4956794.0000; val_optim_loss: 4956794.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9433; val_auprc_score: 0.9737; val_best_acc_score: 0.9211; val_best_f1_score: 0.9497; train_kl_reg_loss: 15989.7723; train_edge_recon_loss: 1332363.3333; train_cat_covariates_contrastive_loss: 636044.6917; train_gene_expr_recon_loss: 2927859.5167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4912257.3000; train_optim_loss: 4912257.3000; val_kl_reg_loss: 15657.5537; val_edge_recon_loss: 1343257.1875; val_cat_covariates_contrastive_loss: 634482.1250; val_gene_expr_recon_loss: 2940252.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4933648.7500; val_optim_loss: 4933648.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9437; val_auprc_score: 0.9745; val_best_acc_score: 0.9238; val_best_f1_score: 0.9513; train_kl_reg_loss: 15624.4622; train_edge_recon_loss: 1338899.4417; train_cat_covariates_contrastive_loss: 636133.9208; train_gene_expr_recon_loss: 2921328.9000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4911986.7000; train_optim_loss: 4911986.7000; val_kl_reg_loss: 15200.8291; val_edge_recon_loss: 1333208.7500; val_cat_covariates_contrastive_loss: 635607.3125; val_gene_expr_recon_loss: 2925902.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4909919.2500; val_optim_loss: 4909919.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9442; val_auprc_score: 0.9749; val_best_acc_score: 0.9208; val_best_f1_score: 0.9491; train_kl_reg_loss: 15231.2296; train_edge_recon_loss: 1336830.4083; train_cat_covariates_contrastive_loss: 635878.7667; train_gene_expr_recon_loss: 2914641.2333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4902581.6333; train_optim_loss: 4902581.6333; val_kl_reg_loss: 14816.4209; val_edge_recon_loss: 1359637.4375; val_cat_covariates_contrastive_loss: 634510.0000; val_gene_expr_recon_loss: 2928718.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4937682.0000; val_optim_loss: 4937682.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9473; val_auprc_score: 0.9762; val_best_acc_score: 0.9268; val_best_f1_score: 0.9530; train_kl_reg_loss: 14900.0602; train_edge_recon_loss: 1332096.8833; train_cat_covariates_contrastive_loss: 636093.7042; train_gene_expr_recon_loss: 2915019.1333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4898109.7333; train_optim_loss: 4898109.7333; val_kl_reg_loss: 14597.9575; val_edge_recon_loss: 1350765.5625; val_cat_covariates_contrastive_loss: 634705.8750; val_gene_expr_recon_loss: 2911435.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4911504.5000; val_optim_loss: 4911504.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9476; val_auprc_score: 0.9742; val_best_acc_score: 0.9263; val_best_f1_score: 0.9525; train_kl_reg_loss: 14559.7554; train_edge_recon_loss: 1327564.4750; train_cat_covariates_contrastive_loss: 635540.0042; train_gene_expr_recon_loss: 2905589.0333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4883253.2000; train_optim_loss: 4883253.2000; val_kl_reg_loss: 14289.7178; val_edge_recon_loss: 1351081.8750; val_cat_covariates_contrastive_loss: 635374.8750; val_gene_expr_recon_loss: 2925014.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4925761.2500; val_optim_loss: 4925761.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9499; val_auprc_score: 0.9755; val_best_acc_score: 0.9331; val_best_f1_score: 0.9570; train_kl_reg_loss: 14400.5435; train_edge_recon_loss: 1320494.5083; train_cat_covariates_contrastive_loss: 635545.1375; train_gene_expr_recon_loss: 2900736.7667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4871176.9333; train_optim_loss: 4871176.9333; val_kl_reg_loss: 14078.2563; val_edge_recon_loss: 1333440.1875; val_cat_covariates_contrastive_loss: 635079.9062; val_gene_expr_recon_loss: 2910654.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4893252.5000; val_optim_loss: 4893252.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9495; val_auprc_score: 0.9743; val_best_acc_score: 0.9305; val_best_f1_score: 0.9550; train_kl_reg_loss: 14131.6009; train_edge_recon_loss: 1327100.7250; train_cat_covariates_contrastive_loss: 635443.3917; train_gene_expr_recon_loss: 2899138.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4875813.8333; train_optim_loss: 4875813.8333; val_kl_reg_loss: 13863.2056; val_edge_recon_loss: 1362342.6875; val_cat_covariates_contrastive_loss: 634815.3438; val_gene_expr_recon_loss: 2893583.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4904605.0000; val_optim_loss: 4904605.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9526; val_auprc_score: 0.9762; val_best_acc_score: 0.9366; val_best_f1_score: 0.9589; train_kl_reg_loss: 13891.0598; train_edge_recon_loss: 1323599.7500; train_cat_covariates_contrastive_loss: 635166.5917; train_gene_expr_recon_loss: 2894656.5167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4867313.9000; train_optim_loss: 4867313.9000; val_kl_reg_loss: 13641.7017; val_edge_recon_loss: 1328669.5000; val_cat_covariates_contrastive_loss: 634463.1875; val_gene_expr_recon_loss: 2892286.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4869061.2500; val_optim_loss: 4869061.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9531; val_auprc_score: 0.9775; val_best_acc_score: 0.9383; val_best_f1_score: 0.9601; train_kl_reg_loss: 13794.2208; train_edge_recon_loss: 1321335.9083; train_cat_covariates_contrastive_loss: 634962.6417; train_gene_expr_recon_loss: 2888534.2833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4858627.0667; train_optim_loss: 4858627.0667; val_kl_reg_loss: 13703.1489; val_edge_recon_loss: 1341429.4375; val_cat_covariates_contrastive_loss: 634041.5938; val_gene_expr_recon_loss: 2903103.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4892277.5000; val_optim_loss: 4892277.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9560; val_auprc_score: 0.9788; val_best_acc_score: 0.9394; val_best_f1_score: 0.9608; train_kl_reg_loss: 13619.1319; train_edge_recon_loss: 1316765.3833; train_cat_covariates_contrastive_loss: 635200.4792; train_gene_expr_recon_loss: 2884895.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4850480.1000; train_optim_loss: 4850480.1000; val_kl_reg_loss: 13505.5112; val_edge_recon_loss: 1339397.2500; val_cat_covariates_contrastive_loss: 633682.7812; val_gene_expr_recon_loss: 2893832.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4880418.2500; val_optim_loss: 4880418.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9489; val_auprc_score: 0.9745; val_best_acc_score: 0.9381; val_best_f1_score: 0.9598; train_kl_reg_loss: 13520.4507; train_edge_recon_loss: 1323098.3417; train_cat_covariates_contrastive_loss: 635064.7167; train_gene_expr_recon_loss: 2876620.1333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4848303.6667; train_optim_loss: 4848303.6667; val_kl_reg_loss: 13293.9722; val_edge_recon_loss: 1342353.1875; val_cat_covariates_contrastive_loss: 634128.4062; val_gene_expr_recon_loss: 2896162.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4885938.0000; val_optim_loss: 4885938.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9502; val_auprc_score: 0.9761; val_best_acc_score: 0.9384; val_best_f1_score: 0.9601; train_kl_reg_loss: 13489.0415; train_edge_recon_loss: 1322271.9000; train_cat_covariates_contrastive_loss: 634808.7083; train_gene_expr_recon_loss: 2875316.3500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4845885.9667; train_optim_loss: 4845885.9667; val_kl_reg_loss: 13165.3223; val_edge_recon_loss: 1321508.1875; val_cat_covariates_contrastive_loss: 633691.8750; val_gene_expr_recon_loss: 2873079.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4841444.7500; val_optim_loss: 4841444.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9561; val_auprc_score: 0.9788; val_best_acc_score: 0.9419; val_best_f1_score: 0.9623; train_kl_reg_loss: 13363.9704; train_edge_recon_loss: 1328941.2667; train_cat_covariates_contrastive_loss: 634464.5792; train_gene_expr_recon_loss: 2872293.8833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4849063.7000; train_optim_loss: 4849063.7000; val_kl_reg_loss: 13228.7021; val_edge_recon_loss: 1334188.7500; val_cat_covariates_contrastive_loss: 634010.0625; val_gene_expr_recon_loss: 2884332.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4865759.5000; val_optim_loss: 4865759.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9511; val_auprc_score: 0.9746; val_best_acc_score: 0.9402; val_best_f1_score: 0.9610; train_kl_reg_loss: 13248.4786; train_edge_recon_loss: 1318563.1250; train_cat_covariates_contrastive_loss: 634351.2458; train_gene_expr_recon_loss: 2870743.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4836906.0000; train_optim_loss: 4836906.0000; val_kl_reg_loss: 12978.8413; val_edge_recon_loss: 1344931.5625; val_cat_covariates_contrastive_loss: 633490.8750; val_gene_expr_recon_loss: 2867411.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4858812.5000; val_optim_loss: 4858812.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9493; val_auprc_score: 0.9752; val_best_acc_score: 0.9400; val_best_f1_score: 0.9611; train_kl_reg_loss: 13243.4819; train_edge_recon_loss: 1314380.1083; train_cat_covariates_contrastive_loss: 634521.1417; train_gene_expr_recon_loss: 2862652.1333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4824796.9333; train_optim_loss: 4824796.9333; val_kl_reg_loss: 13048.9370; val_edge_recon_loss: 1332446.6250; val_cat_covariates_contrastive_loss: 633962.8125; val_gene_expr_recon_loss: 2878454.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4857912.2500; val_optim_loss: 4857912.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9513; val_auprc_score: 0.9751; val_best_acc_score: 0.9386; val_best_f1_score: 0.9601; train_kl_reg_loss: 13107.8887; train_edge_recon_loss: 1309839.9000; train_cat_covariates_contrastive_loss: 634961.1375; train_gene_expr_recon_loss: 2859173.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4817082.6333; train_optim_loss: 4817082.6333; val_kl_reg_loss: 12958.7998; val_edge_recon_loss: 1369644.6875; val_cat_covariates_contrastive_loss: 634094.7188; val_gene_expr_recon_loss: 2863111.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4879809.5000; val_optim_loss: 4879809.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9506; val_auprc_score: 0.9754; val_best_acc_score: 0.9391; val_best_f1_score: 0.9607; train_kl_reg_loss: 13132.6260; train_edge_recon_loss: 1320188.6417; train_cat_covariates_contrastive_loss: 634412.7083; train_gene_expr_recon_loss: 2855333.6333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4823067.7000; train_optim_loss: 4823067.7000; val_kl_reg_loss: 12873.8145; val_edge_recon_loss: 1306766.0000; val_cat_covariates_contrastive_loss: 634607.7812; val_gene_expr_recon_loss: 2867157.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4821405.0000; val_optim_loss: 4821405.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9479; val_auprc_score: 0.9732; val_best_acc_score: 0.9400; val_best_f1_score: 0.9611; train_kl_reg_loss: 13092.0858; train_edge_recon_loss: 1326193.0833; train_cat_covariates_contrastive_loss: 634539.9583; train_gene_expr_recon_loss: 2860622.3500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4834447.4667; train_optim_loss: 4834447.4667; val_kl_reg_loss: 12852.5854; val_edge_recon_loss: 1343245.0625; val_cat_covariates_contrastive_loss: 633343.3438; val_gene_expr_recon_loss: 2881644.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4871085.7500; val_optim_loss: 4871085.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9496; val_auprc_score: 0.9745; val_best_acc_score: 0.9394; val_best_f1_score: 0.9610; train_kl_reg_loss: 13077.0483; train_edge_recon_loss: 1326627.7917; train_cat_covariates_contrastive_loss: 634282.1208; train_gene_expr_recon_loss: 2857963.4833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4831950.4667; train_optim_loss: 4831950.4667; val_kl_reg_loss: 12844.1533; val_edge_recon_loss: 1316163.0000; val_cat_covariates_contrastive_loss: 633790.0000; val_gene_expr_recon_loss: 2857341.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4820138.7500; val_optim_loss: 4820138.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9565; val_auprc_score: 0.9782; val_best_acc_score: 0.9410; val_best_f1_score: 0.9618; train_kl_reg_loss: 13048.6960; train_edge_recon_loss: 1319918.1917; train_cat_covariates_contrastive_loss: 634180.4042; train_gene_expr_recon_loss: 2856927.8500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4824075.1333; train_optim_loss: 4824075.1333; val_kl_reg_loss: 12743.3237; val_edge_recon_loss: 1329734.3125; val_cat_covariates_contrastive_loss: 634407.0312; val_gene_expr_recon_loss: 2865551.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4842435.5000; val_optim_loss: 4842435.5000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9474; val_auprc_score: 0.9745; val_best_acc_score: 0.9390; val_best_f1_score: 0.9606; train_kl_reg_loss: 13013.5667; train_edge_recon_loss: 1308491.1167; train_cat_covariates_contrastive_loss: 634577.6792; train_gene_expr_recon_loss: 2855046.0333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4811128.4333; train_optim_loss: 4811128.4333; val_kl_reg_loss: 12908.1099; val_edge_recon_loss: 1336847.3125; val_cat_covariates_contrastive_loss: 633104.5312; val_gene_expr_recon_loss: 2882635.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4865495.2500; val_optim_loss: 4865495.2500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9551; val_auprc_score: 0.9782; val_best_acc_score: 0.9434; val_best_f1_score: 0.9633; train_kl_reg_loss: 13006.6620; train_edge_recon_loss: 1320530.1083; train_cat_covariates_contrastive_loss: 634231.7083; train_gene_expr_recon_loss: 2859108.6833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4826877.1333; train_optim_loss: 4826877.1333; val_kl_reg_loss: 12752.9839; val_edge_recon_loss: 1308045.6250; val_cat_covariates_contrastive_loss: 634003.8438; val_gene_expr_recon_loss: 2858423.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4813226.0000; val_optim_loss: 4813226.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9540; val_auprc_score: 0.9769; val_best_acc_score: 0.9417; val_best_f1_score: 0.9622; train_kl_reg_loss: 13002.3618; train_edge_recon_loss: 1323675.4417; train_cat_covariates_contrastive_loss: 634595.6208; train_gene_expr_recon_loss: 2856108.4667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4827381.9667; train_optim_loss: 4827381.9667; val_kl_reg_loss: 12914.6724; val_edge_recon_loss: 1338604.3750; val_cat_covariates_contrastive_loss: 634003.8125; val_gene_expr_recon_loss: 2874703.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4860226.5000; val_optim_loss: 4860226.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9519; val_auprc_score: 0.9767; val_best_acc_score: 0.9427; val_best_f1_score: 0.9631; train_kl_reg_loss: 13000.4605; train_edge_recon_loss: 1317671.1750; train_cat_covariates_contrastive_loss: 634262.9125; train_gene_expr_recon_loss: 2855288.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4820222.6333; train_optim_loss: 4820222.6333; val_kl_reg_loss: 12821.1831; val_edge_recon_loss: 1314288.3750; val_cat_covariates_contrastive_loss: 635278.8125; val_gene_expr_recon_loss: 2865717.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4828106.5000; val_optim_loss: 4828106.5000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9471; val_auprc_score: 0.9730; val_best_acc_score: 0.9401; val_best_f1_score: 0.9612; train_kl_reg_loss: 13018.6910; train_edge_recon_loss: 1313119.2917; train_cat_covariates_contrastive_loss: 634244.9000; train_gene_expr_recon_loss: 2857961.0167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4818343.9000; train_optim_loss: 4818343.9000; val_kl_reg_loss: 12824.9634; val_edge_recon_loss: 1360916.0625; val_cat_covariates_contrastive_loss: 633000.7188; val_gene_expr_recon_loss: 2864880.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4871622.5000; val_optim_loss: 4871622.5000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9523; val_auprc_score: 0.9765; val_best_acc_score: 0.9399; val_best_f1_score: 0.9612; train_kl_reg_loss: 12968.8639; train_edge_recon_loss: 1314654.7333; train_cat_covariates_contrastive_loss: 634194.6958; train_gene_expr_recon_loss: 2853959.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4815777.6667; train_optim_loss: 4815777.6667; val_kl_reg_loss: 12903.0693; val_edge_recon_loss: 1339684.3125; val_cat_covariates_contrastive_loss: 634619.7188; val_gene_expr_recon_loss: 2868774.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4855981.2500; val_optim_loss: 4855981.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9507; val_auprc_score: 0.9766; val_best_acc_score: 0.9407; val_best_f1_score: 0.9620; train_kl_reg_loss: 12957.6029; train_edge_recon_loss: 1322009.5167; train_cat_covariates_contrastive_loss: 634470.8708; train_gene_expr_recon_loss: 2855564.6833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4825002.6333; train_optim_loss: 4825002.6333; val_kl_reg_loss: 12777.6997; val_edge_recon_loss: 1322464.8125; val_cat_covariates_contrastive_loss: 633888.8125; val_gene_expr_recon_loss: 2849374.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4818505.2500; val_optim_loss: 4818505.2500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9533; val_auprc_score: 0.9762; val_best_acc_score: 0.9404; val_best_f1_score: 0.9613; train_kl_reg_loss: 12972.2115; train_edge_recon_loss: 1318137.0250; train_cat_covariates_contrastive_loss: 634204.5625; train_gene_expr_recon_loss: 2853836.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4819150.5000; train_optim_loss: 4819150.5000; val_kl_reg_loss: 12785.6689; val_edge_recon_loss: 1338279.3125; val_cat_covariates_contrastive_loss: 632961.2500; val_gene_expr_recon_loss: 2868852.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4852878.5000; val_optim_loss: 4852878.5000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9472; val_auprc_score: 0.9735; val_best_acc_score: 0.9399; val_best_f1_score: 0.9612; train_kl_reg_loss: 12973.0880; train_edge_recon_loss: 1322547.1250; train_cat_covariates_contrastive_loss: 634159.7583; train_gene_expr_recon_loss: 2855520.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4825200.3333; train_optim_loss: 4825200.3333; val_kl_reg_loss: 12778.7012; val_edge_recon_loss: 1329846.0000; val_cat_covariates_contrastive_loss: 634104.9062; val_gene_expr_recon_loss: 2858029.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4834759.2500; val_optim_loss: 4834759.2500
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9513; val_auprc_score: 0.9766; val_best_acc_score: 0.9415; val_best_f1_score: 0.9623; train_kl_reg_loss: 12962.2337; train_edge_recon_loss: 1325151.9333; train_cat_covariates_contrastive_loss: 634545.2583; train_gene_expr_recon_loss: 2850455.0333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4823114.4667; train_optim_loss: 4823114.4667; val_kl_reg_loss: 12852.7515; val_edge_recon_loss: 1317415.6875; val_cat_covariates_contrastive_loss: 633999.9062; val_gene_expr_recon_loss: 2867530.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4831798.7500; val_optim_loss: 4831798.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 13 min 2 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
val AUROC score: 0.9308
val AUPRC score: 0.9624
val best accuracy score: 0.9332
val best F1 score: 0.9568
val target rna MSE score: 1.1612
val source rna MSE score: 0.2293
Val cat covariate0 mean sim diff: 0.0013
Val cat covariate1 mean sim diff: -0.0843
Duration of model training in run 4: 0 hours, 13 minutes and 8 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 25413
Number of validation nodes: 2824
Number of training edges: 117816
Number of validation edges: 13090
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9520; val_auprc_score: 0.9820; val_best_acc_score: 0.8637; val_best_f1_score: 0.9161; train_kl_reg_loss: 2793.8737; train_edge_recon_loss: 1862614.0000; train_cat_covariates_contrastive_loss: 800140.2083; train_gene_expr_recon_loss: 4130466.1500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6796014.2000; train_optim_loss: 6796014.2000; val_kl_reg_loss: 2279.8182; val_edge_recon_loss: 2053197.1250; val_cat_covariates_contrastive_loss: 627294.8750; val_gene_expr_recon_loss: 3944029.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6626801.2500; val_optim_loss: 6626801.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8604; val_auprc_score: 0.9471; val_best_acc_score: 0.8418; val_best_f1_score: 0.9035; train_kl_reg_loss: 2624.7662; train_edge_recon_loss: 1765792.7583; train_cat_covariates_contrastive_loss: 668127.2208; train_gene_expr_recon_loss: 3860501.8833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6297046.6000; train_optim_loss: 6297046.6000; val_kl_reg_loss: 4226.5864; val_edge_recon_loss: 1794024.9375; val_cat_covariates_contrastive_loss: 627242.6875; val_gene_expr_recon_loss: 3751783.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6177277.7500; val_optim_loss: 6177277.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8426; val_auprc_score: 0.9394; val_best_acc_score: 0.8391; val_best_f1_score: 0.9024; train_kl_reg_loss: 8424.8344; train_edge_recon_loss: 1615287.6583; train_cat_covariates_contrastive_loss: 634642.0625; train_gene_expr_recon_loss: 3663257.2833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5921611.7667; train_optim_loss: 5921611.7667; val_kl_reg_loss: 13908.9395; val_edge_recon_loss: 1618484.7500; val_cat_covariates_contrastive_loss: 626741.6875; val_gene_expr_recon_loss: 3572762.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5831898.0000; val_optim_loss: 5831898.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8500; val_auprc_score: 0.9422; val_best_acc_score: 0.8470; val_best_f1_score: 0.9073; train_kl_reg_loss: 20852.4417; train_edge_recon_loss: 1545783.3000; train_cat_covariates_contrastive_loss: 627998.7833; train_gene_expr_recon_loss: 3485905.1167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5680539.6333; train_optim_loss: 5680539.6333; val_kl_reg_loss: 27741.8965; val_edge_recon_loss: 1528781.8750; val_cat_covariates_contrastive_loss: 626697.8750; val_gene_expr_recon_loss: 3413232.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5596453.7500; val_optim_loss: 5596453.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8665; val_auprc_score: 0.9476; val_best_acc_score: 0.8548; val_best_f1_score: 0.9104; train_kl_reg_loss: 32612.8299; train_edge_recon_loss: 1527599.9750; train_cat_covariates_contrastive_loss: 627399.3542; train_gene_expr_recon_loss: 3345687.8500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5533300.0333; train_optim_loss: 5533300.0333; val_kl_reg_loss: 35579.5547; val_edge_recon_loss: 1501467.6250; val_cat_covariates_contrastive_loss: 626749.0938; val_gene_expr_recon_loss: 3293575.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5457371.5000; val_optim_loss: 5457371.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8678; val_auprc_score: 0.9458; val_best_acc_score: 0.8567; val_best_f1_score: 0.9123; train_kl_reg_loss: 35844.1836; train_edge_recon_loss: 1491310.6167; train_cat_covariates_contrastive_loss: 627251.6458; train_gene_expr_recon_loss: 3255635.4500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5410041.9000; train_optim_loss: 5410041.9000; val_kl_reg_loss: 33802.4688; val_edge_recon_loss: 1500215.5625; val_cat_covariates_contrastive_loss: 626863.0312; val_gene_expr_recon_loss: 3224731.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5385612.5000; val_optim_loss: 5385612.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8765; val_auprc_score: 0.9502; val_best_acc_score: 0.8594; val_best_f1_score: 0.9136; train_kl_reg_loss: 33061.7198; train_edge_recon_loss: 1475872.1583; train_cat_covariates_contrastive_loss: 627556.5750; train_gene_expr_recon_loss: 3192623.2833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5329113.7000; train_optim_loss: 5329113.7000; val_kl_reg_loss: 30807.3154; val_edge_recon_loss: 1499965.7500; val_cat_covariates_contrastive_loss: 627127.1875; val_gene_expr_recon_loss: 3164497.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5322397.7500; val_optim_loss: 5322397.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8848; val_auprc_score: 0.9544; val_best_acc_score: 0.8637; val_best_f1_score: 0.9162; train_kl_reg_loss: 29594.3883; train_edge_recon_loss: 1462762.6917; train_cat_covariates_contrastive_loss: 628230.1625; train_gene_expr_recon_loss: 3151254.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5271841.9333; train_optim_loss: 5271841.9333; val_kl_reg_loss: 27280.2998; val_edge_recon_loss: 1463795.5000; val_cat_covariates_contrastive_loss: 627663.2500; val_gene_expr_recon_loss: 3138461.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5257200.7500; val_optim_loss: 5257200.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9002; val_auprc_score: 0.9586; val_best_acc_score: 0.8712; val_best_f1_score: 0.9200; train_kl_reg_loss: 26721.6462; train_edge_recon_loss: 1451590.9333; train_cat_covariates_contrastive_loss: 629485.4500; train_gene_expr_recon_loss: 3124016.8500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5231814.8667; train_optim_loss: 5231814.8667; val_kl_reg_loss: 25672.4512; val_edge_recon_loss: 1446476.3750; val_cat_covariates_contrastive_loss: 628768.4375; val_gene_expr_recon_loss: 3126228.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5227145.5000; val_optim_loss: 5227145.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9125; val_auprc_score: 0.9643; val_best_acc_score: 0.8829; val_best_f1_score: 0.9261; train_kl_reg_loss: 24689.1814; train_edge_recon_loss: 1422579.9000; train_cat_covariates_contrastive_loss: 630866.0208; train_gene_expr_recon_loss: 3097288.2667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5175423.3667; train_optim_loss: 5175423.3667; val_kl_reg_loss: 24224.2500; val_edge_recon_loss: 1412656.3750; val_cat_covariates_contrastive_loss: 630635.5938; val_gene_expr_recon_loss: 3101763.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5169279.2500; val_optim_loss: 5169279.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9224; val_auprc_score: 0.9688; val_best_acc_score: 0.8923; val_best_f1_score: 0.9316; train_kl_reg_loss: 23835.9232; train_edge_recon_loss: 1407728.6250; train_cat_covariates_contrastive_loss: 633313.0708; train_gene_expr_recon_loss: 3074182.4667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5139060.1000; train_optim_loss: 5139060.1000; val_kl_reg_loss: 23804.1631; val_edge_recon_loss: 1399474.3125; val_cat_covariates_contrastive_loss: 633012.5000; val_gene_expr_recon_loss: 3065499.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5121790.7500; val_optim_loss: 5121790.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9287; val_auprc_score: 0.9691; val_best_acc_score: 0.9014; val_best_f1_score: 0.9372; train_kl_reg_loss: 23650.0961; train_edge_recon_loss: 1385473.7250; train_cat_covariates_contrastive_loss: 635373.4208; train_gene_expr_recon_loss: 3063461.8667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5107959.1333; train_optim_loss: 5107959.1333; val_kl_reg_loss: 24027.6240; val_edge_recon_loss: 1392160.3750; val_cat_covariates_contrastive_loss: 635637.9062; val_gene_expr_recon_loss: 3048409.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5100235.5000; val_optim_loss: 5100235.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9304; val_auprc_score: 0.9698; val_best_acc_score: 0.9038; val_best_f1_score: 0.9386; train_kl_reg_loss: 24418.7971; train_edge_recon_loss: 1378226.6917; train_cat_covariates_contrastive_loss: 636459.5542; train_gene_expr_recon_loss: 3043718.5500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5082823.6333; train_optim_loss: 5082823.6333; val_kl_reg_loss: 24842.4814; val_edge_recon_loss: 1402517.9375; val_cat_covariates_contrastive_loss: 635743.8750; val_gene_expr_recon_loss: 3037489.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5100593.2500; val_optim_loss: 5100593.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9316; val_auprc_score: 0.9714; val_best_acc_score: 0.9050; val_best_f1_score: 0.9396; train_kl_reg_loss: 24925.8701; train_edge_recon_loss: 1372897.8667; train_cat_covariates_contrastive_loss: 636475.6125; train_gene_expr_recon_loss: 3033653.9333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5067953.3000; train_optim_loss: 5067953.3000; val_kl_reg_loss: 24583.0479; val_edge_recon_loss: 1393515.9375; val_cat_covariates_contrastive_loss: 636241.1250; val_gene_expr_recon_loss: 3023574.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5077914.2500; val_optim_loss: 5077914.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9362; val_auprc_score: 0.9727; val_best_acc_score: 0.9091; val_best_f1_score: 0.9419; train_kl_reg_loss: 24685.4492; train_edge_recon_loss: 1360752.8083; train_cat_covariates_contrastive_loss: 636223.6583; train_gene_expr_recon_loss: 3018347.2333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5040009.1667; train_optim_loss: 5040009.1667; val_kl_reg_loss: 24367.0195; val_edge_recon_loss: 1366702.8750; val_cat_covariates_contrastive_loss: 635292.9375; val_gene_expr_recon_loss: 3007332.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5033695.2500; val_optim_loss: 5033695.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9353; val_auprc_score: 0.9721; val_best_acc_score: 0.9059; val_best_f1_score: 0.9402; train_kl_reg_loss: 24264.4191; train_edge_recon_loss: 1357740.7000; train_cat_covariates_contrastive_loss: 636088.7125; train_gene_expr_recon_loss: 3011710.8167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5029804.6000; train_optim_loss: 5029804.6000; val_kl_reg_loss: 23634.7285; val_edge_recon_loss: 1377984.8750; val_cat_covariates_contrastive_loss: 633592.5938; val_gene_expr_recon_loss: 3008419.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5043631.2500; val_optim_loss: 5043631.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9409; val_auprc_score: 0.9745; val_best_acc_score: 0.9146; val_best_f1_score: 0.9457; train_kl_reg_loss: 23427.7848; train_edge_recon_loss: 1357925.5333; train_cat_covariates_contrastive_loss: 636264.6625; train_gene_expr_recon_loss: 3002070.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5019688.2667; train_optim_loss: 5019688.2667; val_kl_reg_loss: 22893.9697; val_edge_recon_loss: 1351625.5000; val_cat_covariates_contrastive_loss: 633690.9688; val_gene_expr_recon_loss: 2994372.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5002582.5000; val_optim_loss: 5002582.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9389; val_auprc_score: 0.9722; val_best_acc_score: 0.9120; val_best_f1_score: 0.9434; train_kl_reg_loss: 22529.0341; train_edge_recon_loss: 1358405.3750; train_cat_covariates_contrastive_loss: 636628.4083; train_gene_expr_recon_loss: 2989749.2667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5007312.1333; train_optim_loss: 5007312.1333; val_kl_reg_loss: 22210.0098; val_edge_recon_loss: 1384097.4375; val_cat_covariates_contrastive_loss: 634600.9688; val_gene_expr_recon_loss: 3001886.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5042795.0000; val_optim_loss: 5042795.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9387; val_auprc_score: 0.9723; val_best_acc_score: 0.9163; val_best_f1_score: 0.9464; train_kl_reg_loss: 21878.1587; train_edge_recon_loss: 1354936.6500; train_cat_covariates_contrastive_loss: 635611.2458; train_gene_expr_recon_loss: 2986122.3833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4998548.4333; train_optim_loss: 4998548.4333; val_kl_reg_loss: 21291.8057; val_edge_recon_loss: 1351093.8125; val_cat_covariates_contrastive_loss: 634615.0625; val_gene_expr_recon_loss: 2999389.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5006390.5000; val_optim_loss: 5006390.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9426; val_auprc_score: 0.9728; val_best_acc_score: 0.9181; val_best_f1_score: 0.9473; train_kl_reg_loss: 20882.4460; train_edge_recon_loss: 1348756.1500; train_cat_covariates_contrastive_loss: 636325.7500; train_gene_expr_recon_loss: 2975866.5167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4981830.8667; train_optim_loss: 4981830.8667; val_kl_reg_loss: 20710.6592; val_edge_recon_loss: 1362421.3750; val_cat_covariates_contrastive_loss: 636728.6562; val_gene_expr_recon_loss: 2980579.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5000440.2500; val_optim_loss: 5000440.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9439; val_auprc_score: 0.9740; val_best_acc_score: 0.9195; val_best_f1_score: 0.9485; train_kl_reg_loss: 20153.4109; train_edge_recon_loss: 1338351.8083; train_cat_covariates_contrastive_loss: 636021.6625; train_gene_expr_recon_loss: 2967145.1500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4961672.0667; train_optim_loss: 4961672.0667; val_kl_reg_loss: 19581.5625; val_edge_recon_loss: 1334056.0000; val_cat_covariates_contrastive_loss: 635040.9062; val_gene_expr_recon_loss: 2967311.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4955990.2500; val_optim_loss: 4955990.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9488; val_auprc_score: 0.9765; val_best_acc_score: 0.9220; val_best_f1_score: 0.9498; train_kl_reg_loss: 19413.6615; train_edge_recon_loss: 1348166.2417; train_cat_covariates_contrastive_loss: 635781.3750; train_gene_expr_recon_loss: 2963032.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4966393.7000; train_optim_loss: 4966393.7000; val_kl_reg_loss: 19066.6953; val_edge_recon_loss: 1353154.3750; val_cat_covariates_contrastive_loss: 636357.4375; val_gene_expr_recon_loss: 2962702.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4971280.5000; val_optim_loss: 4971280.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9489; val_auprc_score: 0.9761; val_best_acc_score: 0.9245; val_best_f1_score: 0.9514; train_kl_reg_loss: 18748.1895; train_edge_recon_loss: 1350271.4167; train_cat_covariates_contrastive_loss: 636327.7917; train_gene_expr_recon_loss: 2957207.6833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4962555.1000; train_optim_loss: 4962555.1000; val_kl_reg_loss: 18399.2305; val_edge_recon_loss: 1345916.1875; val_cat_covariates_contrastive_loss: 636342.7500; val_gene_expr_recon_loss: 2969954.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4970612.7500; val_optim_loss: 4970612.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9525; val_auprc_score: 0.9779; val_best_acc_score: 0.9285; val_best_f1_score: 0.9537; train_kl_reg_loss: 18226.2236; train_edge_recon_loss: 1325646.8667; train_cat_covariates_contrastive_loss: 635615.7333; train_gene_expr_recon_loss: 2946809.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4926298.8000; train_optim_loss: 4926298.8000; val_kl_reg_loss: 17987.7920; val_edge_recon_loss: 1356017.1250; val_cat_covariates_contrastive_loss: 633829.5312; val_gene_expr_recon_loss: 2950146.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4957980.5000; val_optim_loss: 4957980.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9494; val_auprc_score: 0.9761; val_best_acc_score: 0.9290; val_best_f1_score: 0.9542; train_kl_reg_loss: 17625.7669; train_edge_recon_loss: 1330519.0833; train_cat_covariates_contrastive_loss: 635848.0208; train_gene_expr_recon_loss: 2943812.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4927805.6667; train_optim_loss: 4927805.6667; val_kl_reg_loss: 17110.4902; val_edge_recon_loss: 1331960.0625; val_cat_covariates_contrastive_loss: 635625.9688; val_gene_expr_recon_loss: 2941650.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4926346.5000; val_optim_loss: 4926346.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9492; val_auprc_score: 0.9766; val_best_acc_score: 0.9309; val_best_f1_score: 0.9555; train_kl_reg_loss: 17169.3646; train_edge_recon_loss: 1326219.9167; train_cat_covariates_contrastive_loss: 635329.9208; train_gene_expr_recon_loss: 2936678.9333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4915398.1667; train_optim_loss: 4915398.1667; val_kl_reg_loss: 16734.0439; val_edge_recon_loss: 1319981.1250; val_cat_covariates_contrastive_loss: 635285.8125; val_gene_expr_recon_loss: 2918944.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4890945.7500; val_optim_loss: 4890945.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9509; val_auprc_score: 0.9757; val_best_acc_score: 0.9308; val_best_f1_score: 0.9550; train_kl_reg_loss: 16756.4557; train_edge_recon_loss: 1331518.2000; train_cat_covariates_contrastive_loss: 635284.2917; train_gene_expr_recon_loss: 2934077.9000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4917636.9000; train_optim_loss: 4917636.9000; val_kl_reg_loss: 16409.5293; val_edge_recon_loss: 1359110.7500; val_cat_covariates_contrastive_loss: 635713.6250; val_gene_expr_recon_loss: 2942098.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4953332.0000; val_optim_loss: 4953332.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9504; val_auprc_score: 0.9765; val_best_acc_score: 0.9351; val_best_f1_score: 0.9580; train_kl_reg_loss: 16323.1111; train_edge_recon_loss: 1326354.6750; train_cat_covariates_contrastive_loss: 635883.8583; train_gene_expr_recon_loss: 2922786.4333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4901348.0000; train_optim_loss: 4901348.0000; val_kl_reg_loss: 16136.7656; val_edge_recon_loss: 1331861.1875; val_cat_covariates_contrastive_loss: 634127.9688; val_gene_expr_recon_loss: 2924005.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4906130.7500; val_optim_loss: 4906130.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9537; val_auprc_score: 0.9768; val_best_acc_score: 0.9384; val_best_f1_score: 0.9603; train_kl_reg_loss: 16159.4807; train_edge_recon_loss: 1326565.4333; train_cat_covariates_contrastive_loss: 635993.5750; train_gene_expr_recon_loss: 2921456.8167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4900175.2667; train_optim_loss: 4900175.2667; val_kl_reg_loss: 15852.9629; val_edge_recon_loss: 1330873.1250; val_cat_covariates_contrastive_loss: 634742.9375; val_gene_expr_recon_loss: 2919292.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4900761.0000; val_optim_loss: 4900761.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9495; val_auprc_score: 0.9749; val_best_acc_score: 0.9350; val_best_f1_score: 0.9578; train_kl_reg_loss: 15695.1891; train_edge_recon_loss: 1321723.0750; train_cat_covariates_contrastive_loss: 635071.4708; train_gene_expr_recon_loss: 2919747.1333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4892236.8667; train_optim_loss: 4892236.8667; val_kl_reg_loss: 15226.1050; val_edge_recon_loss: 1347196.3125; val_cat_covariates_contrastive_loss: 635130.8438; val_gene_expr_recon_loss: 2913802.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4911355.7500; val_optim_loss: 4911355.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9504; val_auprc_score: 0.9753; val_best_acc_score: 0.9362; val_best_f1_score: 0.9584; train_kl_reg_loss: 15385.5770; train_edge_recon_loss: 1323490.2250; train_cat_covariates_contrastive_loss: 635144.2167; train_gene_expr_recon_loss: 2915429.1500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4889449.1667; train_optim_loss: 4889449.1667; val_kl_reg_loss: 15321.4980; val_edge_recon_loss: 1343333.6875; val_cat_covariates_contrastive_loss: 634712.5312; val_gene_expr_recon_loss: 2936399.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4929766.5000; val_optim_loss: 4929766.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9478; val_auprc_score: 0.9736; val_best_acc_score: 0.9368; val_best_f1_score: 0.9590; train_kl_reg_loss: 15489.7430; train_edge_recon_loss: 1315977.9667; train_cat_covariates_contrastive_loss: 634953.9958; train_gene_expr_recon_loss: 2915090.3833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4881512.0333; train_optim_loss: 4881512.0333; val_kl_reg_loss: 15398.2578; val_edge_recon_loss: 1333894.2500; val_cat_covariates_contrastive_loss: 635014.3125; val_gene_expr_recon_loss: 2933204.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4917510.7500; val_optim_loss: 4917510.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9515; val_auprc_score: 0.9769; val_best_acc_score: 0.9344; val_best_f1_score: 0.9575; train_kl_reg_loss: 15456.9301; train_edge_recon_loss: 1319353.7500; train_cat_covariates_contrastive_loss: 635215.8708; train_gene_expr_recon_loss: 2916586.9500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4886613.5333; train_optim_loss: 4886613.5333; val_kl_reg_loss: 15355.3428; val_edge_recon_loss: 1343867.0000; val_cat_covariates_contrastive_loss: 635129.8750; val_gene_expr_recon_loss: 2924442.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4918795.0000; val_optim_loss: 4918795.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9526; val_auprc_score: 0.9765; val_best_acc_score: 0.9388; val_best_f1_score: 0.9605; train_kl_reg_loss: 15393.6831; train_edge_recon_loss: 1319549.2333; train_cat_covariates_contrastive_loss: 635260.2750; train_gene_expr_recon_loss: 2910089.7333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4880293.0000; train_optim_loss: 4880293.0000; val_kl_reg_loss: 15271.8242; val_edge_recon_loss: 1331846.8750; val_cat_covariates_contrastive_loss: 634171.3125; val_gene_expr_recon_loss: 2915383.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4896673.5000; val_optim_loss: 4896673.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 7 min 41 sec.
Using best model state, which was in epoch 26.

--- MODEL EVALUATION ---
val AUROC score: 0.9294
val AUPRC score: 0.9626
val best accuracy score: 0.9234
val best F1 score: 0.9503
val target rna MSE score: 1.3338
val source rna MSE score: 0.4248
Val cat covariate0 mean sim diff: -0.0032
Val cat covariate1 mean sim diff: -0.0779
Duration of model training in run 3: 0 hours, 7 minutes and 46 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 25413
Number of validation nodes: 2824
Number of training edges: 60794
Number of validation edges: 6754
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8947; val_auprc_score: 0.9630; val_best_acc_score: 0.8385; val_best_f1_score: 0.8980; train_kl_reg_loss: 1378.3374; train_edge_recon_loss: 1783664.3438; train_cat_covariates_contrastive_loss: 929094.1797; train_gene_expr_recon_loss: 4218627.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6932764.8125; train_optim_loss: 6932764.8125; val_kl_reg_loss: 3035.2163; val_edge_recon_loss: 2057951.0000; val_cat_covariates_contrastive_loss: 627709.1250; val_gene_expr_recon_loss: 4033165.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6721861.0000; val_optim_loss: 6721861.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8976; val_auprc_score: 0.9610; val_best_acc_score: 0.8246; val_best_f1_score: 0.8795; train_kl_reg_loss: 3324.7642; train_edge_recon_loss: 1909586.1094; train_cat_covariates_contrastive_loss: 649735.8359; train_gene_expr_recon_loss: 3984118.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6546765.2500; train_optim_loss: 6546765.2500; val_kl_reg_loss: 2350.8167; val_edge_recon_loss: 2034694.3750; val_cat_covariates_contrastive_loss: 627749.8125; val_gene_expr_recon_loss: 3858155.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6522950.5000; val_optim_loss: 6522950.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8572; val_auprc_score: 0.9437; val_best_acc_score: 0.8354; val_best_f1_score: 0.8998; train_kl_reg_loss: 2160.0022; train_edge_recon_loss: 1803802.1719; train_cat_covariates_contrastive_loss: 676547.0000; train_gene_expr_recon_loss: 3838084.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6320594.0625; train_optim_loss: 6320594.0625; val_kl_reg_loss: 2351.0032; val_edge_recon_loss: 1970053.0000; val_cat_covariates_contrastive_loss: 627643.8125; val_gene_expr_recon_loss: 3737996.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6338044.0000; val_optim_loss: 6338044.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8243; val_auprc_score: 0.9310; val_best_acc_score: 0.8295; val_best_f1_score: 0.8977; train_kl_reg_loss: 3114.9719; train_edge_recon_loss: 1696754.4531; train_cat_covariates_contrastive_loss: 652916.7500; train_gene_expr_recon_loss: 3723389.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6076175.5000; train_optim_loss: 6076175.5000; val_kl_reg_loss: 4375.0820; val_edge_recon_loss: 1766544.1250; val_cat_covariates_contrastive_loss: 627461.8125; val_gene_expr_recon_loss: 3635221.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6033602.0000; val_optim_loss: 6033602.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8233; val_auprc_score: 0.9300; val_best_acc_score: 0.8308; val_best_f1_score: 0.8976; train_kl_reg_loss: 6230.7202; train_edge_recon_loss: 1620970.3594; train_cat_covariates_contrastive_loss: 636390.5312; train_gene_expr_recon_loss: 3619033.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5882625.0625; train_optim_loss: 5882625.0625; val_kl_reg_loss: 8381.3477; val_edge_recon_loss: 1665215.2500; val_cat_covariates_contrastive_loss: 626938.3750; val_gene_expr_recon_loss: 3531955.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5832490.5000; val_optim_loss: 5832490.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8202; val_auprc_score: 0.9303; val_best_acc_score: 0.8323; val_best_f1_score: 0.8989; train_kl_reg_loss: 11443.0425; train_edge_recon_loss: 1561479.3906; train_cat_covariates_contrastive_loss: 631038.9609; train_gene_expr_recon_loss: 3509100.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5713062.0625; train_optim_loss: 5713062.0625; val_kl_reg_loss: 14935.8281; val_edge_recon_loss: 1563762.1250; val_cat_covariates_contrastive_loss: 626768.0000; val_gene_expr_recon_loss: 3439137.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5644603.0000; val_optim_loss: 5644603.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8132; val_auprc_score: 0.9250; val_best_acc_score: 0.8247; val_best_f1_score: 0.8942; train_kl_reg_loss: 18389.7745; train_edge_recon_loss: 1535563.4688; train_cat_covariates_contrastive_loss: 627540.5859; train_gene_expr_recon_loss: 3428561.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5610054.8125; train_optim_loss: 5610054.8125; val_kl_reg_loss: 20877.4473; val_edge_recon_loss: 1590302.0000; val_cat_covariates_contrastive_loss: 626728.5625; val_gene_expr_recon_loss: 3359631.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5597539.5000; val_optim_loss: 5597539.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8234; val_auprc_score: 0.9302; val_best_acc_score: 0.8260; val_best_f1_score: 0.8939; train_kl_reg_loss: 24213.1372; train_edge_recon_loss: 1516964.3438; train_cat_covariates_contrastive_loss: 627305.8359; train_gene_expr_recon_loss: 3348123.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5516606.5000; train_optim_loss: 5516606.5000; val_kl_reg_loss: 25875.2109; val_edge_recon_loss: 1572769.6250; val_cat_covariates_contrastive_loss: 626730.3125; val_gene_expr_recon_loss: 3292238.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5517613.0000; val_optim_loss: 5517613.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8304; val_auprc_score: 0.9310; val_best_acc_score: 0.8348; val_best_f1_score: 0.8980; train_kl_reg_loss: 28398.8389; train_edge_recon_loss: 1500084.1250; train_cat_covariates_contrastive_loss: 627201.2031; train_gene_expr_recon_loss: 3294880.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5450565.0000; train_optim_loss: 5450565.0000; val_kl_reg_loss: 29090.7617; val_edge_recon_loss: 1538287.3750; val_cat_covariates_contrastive_loss: 626729.1250; val_gene_expr_recon_loss: 3241622.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5435730.0000; val_optim_loss: 5435730.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8372; val_auprc_score: 0.9358; val_best_acc_score: 0.8352; val_best_f1_score: 0.8993; train_kl_reg_loss: 30367.0901; train_edge_recon_loss: 1491359.8594; train_cat_covariates_contrastive_loss: 627252.8047; train_gene_expr_recon_loss: 3241544.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5390524.3750; train_optim_loss: 5390524.3750; val_kl_reg_loss: 28845.1797; val_edge_recon_loss: 1557060.7500; val_cat_covariates_contrastive_loss: 626795.0625; val_gene_expr_recon_loss: 3199829.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5412530.5000; val_optim_loss: 5412530.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8444; val_auprc_score: 0.9404; val_best_acc_score: 0.8477; val_best_f1_score: 0.9071; train_kl_reg_loss: 29738.6016; train_edge_recon_loss: 1483794.5781; train_cat_covariates_contrastive_loss: 627490.5703; train_gene_expr_recon_loss: 3214742.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5355766.0000; train_optim_loss: 5355766.0000; val_kl_reg_loss: 28007.2891; val_edge_recon_loss: 1460163.0000; val_cat_covariates_contrastive_loss: 626831.5625; val_gene_expr_recon_loss: 3166510.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5281512.5000; val_optim_loss: 5281512.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8448; val_auprc_score: 0.9360; val_best_acc_score: 0.8412; val_best_f1_score: 0.9026; train_kl_reg_loss: 28270.3601; train_edge_recon_loss: 1484974.4688; train_cat_covariates_contrastive_loss: 627678.3516; train_gene_expr_recon_loss: 3168802.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5309725.6250; train_optim_loss: 5309725.6250; val_kl_reg_loss: 26022.8125; val_edge_recon_loss: 1514784.2500; val_cat_covariates_contrastive_loss: 626925.6875; val_gene_expr_recon_loss: 3139153.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5306886.0000; val_optim_loss: 5306886.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8463; val_auprc_score: 0.9372; val_best_acc_score: 0.8441; val_best_f1_score: 0.9041; train_kl_reg_loss: 26150.2151; train_edge_recon_loss: 1478995.5938; train_cat_covariates_contrastive_loss: 628302.2188; train_gene_expr_recon_loss: 3150369.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5283817.2500; train_optim_loss: 5283817.2500; val_kl_reg_loss: 24563.4531; val_edge_recon_loss: 1510626.1250; val_cat_covariates_contrastive_loss: 627050.9375; val_gene_expr_recon_loss: 3114288.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5276528.5000; val_optim_loss: 5276528.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8479; val_auprc_score: 0.9410; val_best_acc_score: 0.8459; val_best_f1_score: 0.9065; train_kl_reg_loss: 25281.0056; train_edge_recon_loss: 1466609.9062; train_cat_covariates_contrastive_loss: 628266.1094; train_gene_expr_recon_loss: 3124812.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5244969.3125; train_optim_loss: 5244969.3125; val_kl_reg_loss: 23716.4375; val_edge_recon_loss: 1468605.7500; val_cat_covariates_contrastive_loss: 627306.3125; val_gene_expr_recon_loss: 3098587.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5218216.0000; val_optim_loss: 5218216.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8488; val_auprc_score: 0.9397; val_best_acc_score: 0.8462; val_best_f1_score: 0.9062; train_kl_reg_loss: 23908.5347; train_edge_recon_loss: 1460995.5625; train_cat_covariates_contrastive_loss: 629059.0859; train_gene_expr_recon_loss: 3106951.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5220914.8125; train_optim_loss: 5220914.8125; val_kl_reg_loss: 22788.9062; val_edge_recon_loss: 1460534.6250; val_cat_covariates_contrastive_loss: 627699.1875; val_gene_expr_recon_loss: 3082214.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5193237.0000; val_optim_loss: 5193237.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8705; val_auprc_score: 0.9476; val_best_acc_score: 0.8537; val_best_f1_score: 0.9100; train_kl_reg_loss: 23162.9126; train_edge_recon_loss: 1442490.5312; train_cat_covariates_contrastive_loss: 629289.3828; train_gene_expr_recon_loss: 3100740.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5195683.3125; train_optim_loss: 5195683.3125; val_kl_reg_loss: 21980.0547; val_edge_recon_loss: 1435967.5000; val_cat_covariates_contrastive_loss: 628147.3750; val_gene_expr_recon_loss: 3067954.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5154049.5000; val_optim_loss: 5154049.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8676; val_auprc_score: 0.9422; val_best_acc_score: 0.8514; val_best_f1_score: 0.9075; train_kl_reg_loss: 22839.0891; train_edge_recon_loss: 1416019.4219; train_cat_covariates_contrastive_loss: 629684.8125; train_gene_expr_recon_loss: 3072992.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5141536.3125; train_optim_loss: 5141536.3125; val_kl_reg_loss: 21778.5176; val_edge_recon_loss: 1456448.1250; val_cat_covariates_contrastive_loss: 628822.5625; val_gene_expr_recon_loss: 3055344.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5162394.0000; val_optim_loss: 5162394.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8768; val_auprc_score: 0.9518; val_best_acc_score: 0.8528; val_best_f1_score: 0.9079; train_kl_reg_loss: 22125.3684; train_edge_recon_loss: 1415922.9688; train_cat_covariates_contrastive_loss: 630510.3203; train_gene_expr_recon_loss: 3068836.4688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5137395.0000; train_optim_loss: 5137395.0000; val_kl_reg_loss: 21184.4238; val_edge_recon_loss: 1439772.5000; val_cat_covariates_contrastive_loss: 629674.8125; val_gene_expr_recon_loss: 3046351.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5136983.0000; val_optim_loss: 5136983.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8806; val_auprc_score: 0.9528; val_best_acc_score: 0.8550; val_best_f1_score: 0.9089; train_kl_reg_loss: 21853.1506; train_edge_recon_loss: 1415162.8438; train_cat_covariates_contrastive_loss: 631099.7500; train_gene_expr_recon_loss: 3061160.4688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5129276.1875; train_optim_loss: 5129276.1875; val_kl_reg_loss: 20847.9238; val_edge_recon_loss: 1433040.5000; val_cat_covariates_contrastive_loss: 630311.5000; val_gene_expr_recon_loss: 3033014.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5117214.5000; val_optim_loss: 5117214.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8845; val_auprc_score: 0.9513; val_best_acc_score: 0.8547; val_best_f1_score: 0.9084; train_kl_reg_loss: 21467.3350; train_edge_recon_loss: 1407841.4531; train_cat_covariates_contrastive_loss: 631652.0078; train_gene_expr_recon_loss: 3047588.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5108549.3750; train_optim_loss: 5108549.3750; val_kl_reg_loss: 20670.2480; val_edge_recon_loss: 1431670.0000; val_cat_covariates_contrastive_loss: 630907.5000; val_gene_expr_recon_loss: 3026276.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5109524.0000; val_optim_loss: 5109524.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8867; val_auprc_score: 0.9563; val_best_acc_score: 0.8613; val_best_f1_score: 0.9138; train_kl_reg_loss: 21360.6570; train_edge_recon_loss: 1387646.5312; train_cat_covariates_contrastive_loss: 632246.0703; train_gene_expr_recon_loss: 3037868.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5079121.3750; train_optim_loss: 5079121.3750; val_kl_reg_loss: 20506.9688; val_edge_recon_loss: 1380127.3750; val_cat_covariates_contrastive_loss: 631046.6250; val_gene_expr_recon_loss: 3014383.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5046064.0000; val_optim_loss: 5046064.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8869; val_auprc_score: 0.9551; val_best_acc_score: 0.8574; val_best_f1_score: 0.9105; train_kl_reg_loss: 20931.9211; train_edge_recon_loss: 1398095.2812; train_cat_covariates_contrastive_loss: 632412.9453; train_gene_expr_recon_loss: 3023721.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5075161.6250; train_optim_loss: 5075161.6250; val_kl_reg_loss: 20023.5273; val_edge_recon_loss: 1421172.5000; val_cat_covariates_contrastive_loss: 630817.5625; val_gene_expr_recon_loss: 3006496.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5078510.0000; val_optim_loss: 5078510.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8942; val_auprc_score: 0.9575; val_best_acc_score: 0.8614; val_best_f1_score: 0.9126; train_kl_reg_loss: 20310.5696; train_edge_recon_loss: 1387948.6094; train_cat_covariates_contrastive_loss: 633541.1250; train_gene_expr_recon_loss: 3022034.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5063835.1250; train_optim_loss: 5063835.1250; val_kl_reg_loss: 19317.0977; val_edge_recon_loss: 1421741.8750; val_cat_covariates_contrastive_loss: 632917.6250; val_gene_expr_recon_loss: 2999032.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5073009.0000; val_optim_loss: 5073009.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8955; val_auprc_score: 0.9581; val_best_acc_score: 0.8692; val_best_f1_score: 0.9173; train_kl_reg_loss: 19856.5122; train_edge_recon_loss: 1388828.9844; train_cat_covariates_contrastive_loss: 633862.0781; train_gene_expr_recon_loss: 3017228.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5059775.8750; train_optim_loss: 5059775.8750; val_kl_reg_loss: 19008.2266; val_edge_recon_loss: 1390789.7500; val_cat_covariates_contrastive_loss: 632830.8125; val_gene_expr_recon_loss: 2991447.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5034076.0000; val_optim_loss: 5034076.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9070; val_auprc_score: 0.9631; val_best_acc_score: 0.8780; val_best_f1_score: 0.9216; train_kl_reg_loss: 19410.4595; train_edge_recon_loss: 1381985.3906; train_cat_covariates_contrastive_loss: 634513.4531; train_gene_expr_recon_loss: 3009201.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5045111.0000; train_optim_loss: 5045111.0000; val_kl_reg_loss: 18453.3789; val_edge_recon_loss: 1404925.3750; val_cat_covariates_contrastive_loss: 633126.3750; val_gene_expr_recon_loss: 2988358.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5044864.0000; val_optim_loss: 5044864.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9093; val_auprc_score: 0.9629; val_best_acc_score: 0.8835; val_best_f1_score: 0.9258; train_kl_reg_loss: 18970.6929; train_edge_recon_loss: 1355969.0312; train_cat_covariates_contrastive_loss: 635938.2031; train_gene_expr_recon_loss: 2999265.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5010143.4375; train_optim_loss: 5010143.4375; val_kl_reg_loss: 18272.1953; val_edge_recon_loss: 1365434.3750; val_cat_covariates_contrastive_loss: 635470.3750; val_gene_expr_recon_loss: 2980967.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5000144.5000; val_optim_loss: 5000144.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9099; val_auprc_score: 0.9601; val_best_acc_score: 0.8865; val_best_f1_score: 0.9279; train_kl_reg_loss: 19037.5371; train_edge_recon_loss: 1350001.4375; train_cat_covariates_contrastive_loss: 636159.4062; train_gene_expr_recon_loss: 2993812.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4999010.9375; train_optim_loss: 4999010.9375; val_kl_reg_loss: 18583.8555; val_edge_recon_loss: 1390556.1250; val_cat_covariates_contrastive_loss: 634278.6250; val_gene_expr_recon_loss: 2977789.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5021207.5000; val_optim_loss: 5021207.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9137; val_auprc_score: 0.9638; val_best_acc_score: 0.8854; val_best_f1_score: 0.9271; train_kl_reg_loss: 19047.0239; train_edge_recon_loss: 1356884.4844; train_cat_covariates_contrastive_loss: 636106.4844; train_gene_expr_recon_loss: 2988615.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5000653.6250; train_optim_loss: 5000653.6250; val_kl_reg_loss: 18234.6328; val_edge_recon_loss: 1396523.7500; val_cat_covariates_contrastive_loss: 635934.8125; val_gene_expr_recon_loss: 2971774.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5022468.0000; val_optim_loss: 5022468.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9099; val_auprc_score: 0.9615; val_best_acc_score: 0.8864; val_best_f1_score: 0.9274; train_kl_reg_loss: 19021.9912; train_edge_recon_loss: 1357298.6094; train_cat_covariates_contrastive_loss: 636358.0859; train_gene_expr_recon_loss: 2986632.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4999311.3750; train_optim_loss: 4999311.3750; val_kl_reg_loss: 18241.7109; val_edge_recon_loss: 1406679.5000; val_cat_covariates_contrastive_loss: 635046.5000; val_gene_expr_recon_loss: 2964532.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5024500.0000; val_optim_loss: 5024500.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9177; val_auprc_score: 0.9660; val_best_acc_score: 0.8942; val_best_f1_score: 0.9329; train_kl_reg_loss: 18716.4036; train_edge_recon_loss: 1351982.2500; train_cat_covariates_contrastive_loss: 636449.6953; train_gene_expr_recon_loss: 2978448.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4985596.5625; train_optim_loss: 4985596.5625; val_kl_reg_loss: 18204.2520; val_edge_recon_loss: 1359183.3750; val_cat_covariates_contrastive_loss: 635840.8750; val_gene_expr_recon_loss: 2959079.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4972308.0000; val_optim_loss: 4972308.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9226; val_auprc_score: 0.9681; val_best_acc_score: 0.8937; val_best_f1_score: 0.9323; train_kl_reg_loss: 18937.0647; train_edge_recon_loss: 1357977.7656; train_cat_covariates_contrastive_loss: 636277.8359; train_gene_expr_recon_loss: 2979728.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4992921.1250; train_optim_loss: 4992921.1250; val_kl_reg_loss: 17909.3320; val_edge_recon_loss: 1372851.6250; val_cat_covariates_contrastive_loss: 634437.0625; val_gene_expr_recon_loss: 2956013.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4981211.0000; val_optim_loss: 4981211.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9217; val_auprc_score: 0.9665; val_best_acc_score: 0.8960; val_best_f1_score: 0.9332; train_kl_reg_loss: 18370.2036; train_edge_recon_loss: 1354147.3438; train_cat_covariates_contrastive_loss: 636421.8359; train_gene_expr_recon_loss: 2967057.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4975997.1250; train_optim_loss: 4975997.1250; val_kl_reg_loss: 17638.2715; val_edge_recon_loss: 1380626.3750; val_cat_covariates_contrastive_loss: 636174.1875; val_gene_expr_recon_loss: 2949789.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4984228.0000; val_optim_loss: 4984228.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9165; val_auprc_score: 0.9624; val_best_acc_score: 0.8919; val_best_f1_score: 0.9303; train_kl_reg_loss: 18120.3450; train_edge_recon_loss: 1355823.2031; train_cat_covariates_contrastive_loss: 635992.7500; train_gene_expr_recon_loss: 2964221.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4974158.0625; train_optim_loss: 4974158.0625; val_kl_reg_loss: 17368.3242; val_edge_recon_loss: 1399674.2500; val_cat_covariates_contrastive_loss: 635015.2500; val_gene_expr_recon_loss: 2948743.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5000801.0000; val_optim_loss: 5000801.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9181; val_auprc_score: 0.9662; val_best_acc_score: 0.8949; val_best_f1_score: 0.9333; train_kl_reg_loss: 17905.0847; train_edge_recon_loss: 1359677.1250; train_cat_covariates_contrastive_loss: 636303.5234; train_gene_expr_recon_loss: 2960070.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4973955.9375; train_optim_loss: 4973955.9375; val_kl_reg_loss: 17150.6133; val_edge_recon_loss: 1363484.5000; val_cat_covariates_contrastive_loss: 634792.3125; val_gene_expr_recon_loss: 2944197.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4959624.5000; val_optim_loss: 4959624.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9151; val_auprc_score: 0.9604; val_best_acc_score: 0.8947; val_best_f1_score: 0.9320; train_kl_reg_loss: 17720.8342; train_edge_recon_loss: 1353127.3750; train_cat_covariates_contrastive_loss: 636452.6797; train_gene_expr_recon_loss: 2957618.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4964919.5625; train_optim_loss: 4964919.5625; val_kl_reg_loss: 17130.3164; val_edge_recon_loss: 1408501.7500; val_cat_covariates_contrastive_loss: 636886.6875; val_gene_expr_recon_loss: 2937435.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4999954.0000; val_optim_loss: 4999954.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9141; val_auprc_score: 0.9624; val_best_acc_score: 0.8953; val_best_f1_score: 0.9335; train_kl_reg_loss: 17572.1951; train_edge_recon_loss: 1350725.6250; train_cat_covariates_contrastive_loss: 636061.6016; train_gene_expr_recon_loss: 2951605.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4955964.9375; train_optim_loss: 4955964.9375; val_kl_reg_loss: 16874.8164; val_edge_recon_loss: 1356412.8750; val_cat_covariates_contrastive_loss: 634094.7500; val_gene_expr_recon_loss: 2931985.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4939368.0000; val_optim_loss: 4939368.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9284; val_auprc_score: 0.9700; val_best_acc_score: 0.9032; val_best_f1_score: 0.9388; train_kl_reg_loss: 17424.9055; train_edge_recon_loss: 1348993.2656; train_cat_covariates_contrastive_loss: 636123.0781; train_gene_expr_recon_loss: 2951505.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4954046.5000; train_optim_loss: 4954046.5000; val_kl_reg_loss: 16595.6914; val_edge_recon_loss: 1338202.5000; val_cat_covariates_contrastive_loss: 635410.5625; val_gene_expr_recon_loss: 2928769.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4918978.0000; val_optim_loss: 4918978.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9228; val_auprc_score: 0.9658; val_best_acc_score: 0.9014; val_best_f1_score: 0.9371; train_kl_reg_loss: 16940.9937; train_edge_recon_loss: 1335071.5938; train_cat_covariates_contrastive_loss: 636288.4375; train_gene_expr_recon_loss: 2948405.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4936706.8750; train_optim_loss: 4936706.8750; val_kl_reg_loss: 16380.0586; val_edge_recon_loss: 1368806.2500; val_cat_covariates_contrastive_loss: 638773.5625; val_gene_expr_recon_loss: 2926614.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4950574.5000; val_optim_loss: 4950574.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9179; val_auprc_score: 0.9644; val_best_acc_score: 0.9014; val_best_f1_score: 0.9372; train_kl_reg_loss: 16775.9688; train_edge_recon_loss: 1346287.7656; train_cat_covariates_contrastive_loss: 636302.6641; train_gene_expr_recon_loss: 2932747.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4932113.5625; train_optim_loss: 4932113.5625; val_kl_reg_loss: 16237.4180; val_edge_recon_loss: 1378561.8750; val_cat_covariates_contrastive_loss: 635031.0000; val_gene_expr_recon_loss: 2922110.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4951941.0000; val_optim_loss: 4951941.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9186; val_auprc_score: 0.9635; val_best_acc_score: 0.9003; val_best_f1_score: 0.9364; train_kl_reg_loss: 16571.5276; train_edge_recon_loss: 1345149.3906; train_cat_covariates_contrastive_loss: 636020.3672; train_gene_expr_recon_loss: 2931251.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4928992.7500; train_optim_loss: 4928992.7500; val_kl_reg_loss: 15874.6309; val_edge_recon_loss: 1367813.2500; val_cat_covariates_contrastive_loss: 635575.6250; val_gene_expr_recon_loss: 2918972.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4938236.0000; val_optim_loss: 4938236.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9224; val_auprc_score: 0.9665; val_best_acc_score: 0.9003; val_best_f1_score: 0.9367; train_kl_reg_loss: 16376.3223; train_edge_recon_loss: 1339274.3750; train_cat_covariates_contrastive_loss: 636898.4141; train_gene_expr_recon_loss: 2934671.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4927220.7500; train_optim_loss: 4927220.7500; val_kl_reg_loss: 15792.3320; val_edge_recon_loss: 1375179.8750; val_cat_covariates_contrastive_loss: 635031.2500; val_gene_expr_recon_loss: 2916258.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4942262.0000; val_optim_loss: 4942262.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9209; val_auprc_score: 0.9652; val_best_acc_score: 0.8983; val_best_f1_score: 0.9346; train_kl_reg_loss: 16255.8673; train_edge_recon_loss: 1352523.5469; train_cat_covariates_contrastive_loss: 636671.8203; train_gene_expr_recon_loss: 2928915.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4934366.8750; train_optim_loss: 4934366.8750; val_kl_reg_loss: 15781.8496; val_edge_recon_loss: 1387470.2500; val_cat_covariates_contrastive_loss: 632775.0625; val_gene_expr_recon_loss: 2912537.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4948564.0000; val_optim_loss: 4948564.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9236; val_auprc_score: 0.9663; val_best_acc_score: 0.9035; val_best_f1_score: 0.9382; train_kl_reg_loss: 16264.0048; train_edge_recon_loss: 1338328.8594; train_cat_covariates_contrastive_loss: 636823.7344; train_gene_expr_recon_loss: 2933918.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4925335.0000; train_optim_loss: 4925335.0000; val_kl_reg_loss: 15757.5391; val_edge_recon_loss: 1363976.7500; val_cat_covariates_contrastive_loss: 635339.6250; val_gene_expr_recon_loss: 2915025.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4930099.5000; val_optim_loss: 4930099.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9316; val_auprc_score: 0.9707; val_best_acc_score: 0.9029; val_best_f1_score: 0.9376; train_kl_reg_loss: 16211.8221; train_edge_recon_loss: 1330053.3750; train_cat_covariates_contrastive_loss: 636596.4531; train_gene_expr_recon_loss: 2929547.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4912409.0625; train_optim_loss: 4912409.0625; val_kl_reg_loss: 15656.1572; val_edge_recon_loss: 1394828.0000; val_cat_covariates_contrastive_loss: 637944.9375; val_gene_expr_recon_loss: 2912743.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4961172.5000; val_optim_loss: 4961172.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9206; val_auprc_score: 0.9643; val_best_acc_score: 0.8994; val_best_f1_score: 0.9354; train_kl_reg_loss: 16164.9563; train_edge_recon_loss: 1346572.8438; train_cat_covariates_contrastive_loss: 636685.4453; train_gene_expr_recon_loss: 2925852.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4925275.3125; train_optim_loss: 4925275.3125; val_kl_reg_loss: 15654.8096; val_edge_recon_loss: 1412537.8750; val_cat_covariates_contrastive_loss: 636178.5000; val_gene_expr_recon_loss: 2914336.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4978708.0000; val_optim_loss: 4978708.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 29 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.8897
val AUPRC score: 0.9428
val best accuracy score: 0.8832
val best F1 score: 0.9245
val target rna MSE score: 1.2060
val source rna MSE score: 0.4673
Val cat covariate0 mean sim diff: -0.0078
Val cat covariate1 mean sim diff: -0.0494
Duration of model training in run 2: 0 hours, 5 minutes and 33 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 25413
Number of validation nodes: 2824
Number of training edges: 60794
Number of validation edges: 6754
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8924; val_auprc_score: 0.9614; val_best_acc_score: 0.8324; val_best_f1_score: 0.8978; train_kl_reg_loss: 1613.6951; train_edge_recon_loss: 1806100.7344; train_cat_covariates_contrastive_loss: 930437.9609; train_gene_expr_recon_loss: 4220709.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6958861.5625; train_optim_loss: 6958861.5625; val_kl_reg_loss: 3965.7280; val_edge_recon_loss: 2070917.6250; val_cat_covariates_contrastive_loss: 627409.9375; val_gene_expr_recon_loss: 4069682.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6771976.0000; val_optim_loss: 6771976.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8888; val_auprc_score: 0.9596; val_best_acc_score: 0.8239; val_best_f1_score: 0.8825; train_kl_reg_loss: 3913.9901; train_edge_recon_loss: 1914752.0469; train_cat_covariates_contrastive_loss: 647357.8984; train_gene_expr_recon_loss: 3955365.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6521389.2500; train_optim_loss: 6521389.2500; val_kl_reg_loss: 2337.3667; val_edge_recon_loss: 1984678.0000; val_cat_covariates_contrastive_loss: 627690.0625; val_gene_expr_recon_loss: 3879020.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6493725.5000; val_optim_loss: 6493725.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8572; val_auprc_score: 0.9457; val_best_acc_score: 0.8378; val_best_f1_score: 0.9026; train_kl_reg_loss: 2269.8702; train_edge_recon_loss: 1793863.0781; train_cat_covariates_contrastive_loss: 681128.6719; train_gene_expr_recon_loss: 3798340.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6275602.0000; train_optim_loss: 6275602.0000; val_kl_reg_loss: 2565.7632; val_edge_recon_loss: 1911835.5000; val_cat_covariates_contrastive_loss: 627709.6875; val_gene_expr_recon_loss: 3750962.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6293073.5000; val_optim_loss: 6293073.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8304; val_auprc_score: 0.9331; val_best_acc_score: 0.8339; val_best_f1_score: 0.8990; train_kl_reg_loss: 3830.6075; train_edge_recon_loss: 1685415.4375; train_cat_covariates_contrastive_loss: 648718.2578; train_gene_expr_recon_loss: 3681930.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6019895.2500; train_optim_loss: 6019895.2500; val_kl_reg_loss: 5720.3779; val_edge_recon_loss: 1703527.7500; val_cat_covariates_contrastive_loss: 627229.0000; val_gene_expr_recon_loss: 3638715.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5975192.0000; val_optim_loss: 5975192.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8198; val_auprc_score: 0.9312; val_best_acc_score: 0.8324; val_best_f1_score: 0.8994; train_kl_reg_loss: 7717.3323; train_edge_recon_loss: 1601397.1250; train_cat_covariates_contrastive_loss: 634097.4453; train_gene_expr_recon_loss: 3575253.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5818464.9375; train_optim_loss: 5818464.9375; val_kl_reg_loss: 10253.3770; val_edge_recon_loss: 1612583.1250; val_cat_covariates_contrastive_loss: 626886.6250; val_gene_expr_recon_loss: 3530086.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5779809.5000; val_optim_loss: 5779809.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8190; val_auprc_score: 0.9284; val_best_acc_score: 0.8255; val_best_f1_score: 0.8947; train_kl_reg_loss: 13788.0406; train_edge_recon_loss: 1551376.0469; train_cat_covariates_contrastive_loss: 629475.1172; train_gene_expr_recon_loss: 3469373.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5664012.6250; train_optim_loss: 5664012.6250; val_kl_reg_loss: 17824.4023; val_edge_recon_loss: 1612497.2500; val_cat_covariates_contrastive_loss: 626827.5625; val_gene_expr_recon_loss: 3435017.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5692166.5000; val_optim_loss: 5692166.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8169; val_auprc_score: 0.9292; val_best_acc_score: 0.8339; val_best_f1_score: 0.9002; train_kl_reg_loss: 21009.3054; train_edge_recon_loss: 1534389.3750; train_cat_covariates_contrastive_loss: 627365.9375; train_gene_expr_recon_loss: 3377596.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5560361.5000; train_optim_loss: 5560361.5000; val_kl_reg_loss: 23736.3047; val_edge_recon_loss: 1517515.8750; val_cat_covariates_contrastive_loss: 626775.9375; val_gene_expr_recon_loss: 3356005.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5524033.0000; val_optim_loss: 5524033.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8300; val_auprc_score: 0.9358; val_best_acc_score: 0.8332; val_best_f1_score: 0.8993; train_kl_reg_loss: 26578.5706; train_edge_recon_loss: 1504424.0938; train_cat_covariates_contrastive_loss: 627190.7500; train_gene_expr_recon_loss: 3310329.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5468522.9375; train_optim_loss: 5468522.9375; val_kl_reg_loss: 28491.8164; val_edge_recon_loss: 1517546.5000; val_cat_covariates_contrastive_loss: 626806.8125; val_gene_expr_recon_loss: 3295870.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5468715.5000; val_optim_loss: 5468715.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8343; val_auprc_score: 0.9327; val_best_acc_score: 0.8404; val_best_f1_score: 0.9027; train_kl_reg_loss: 29704.5791; train_edge_recon_loss: 1491267.9688; train_cat_covariates_contrastive_loss: 627139.5938; train_gene_expr_recon_loss: 3254475.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5402588.0000; train_optim_loss: 5402588.0000; val_kl_reg_loss: 29781.5273; val_edge_recon_loss: 1517446.2500; val_cat_covariates_contrastive_loss: 626823.6875; val_gene_expr_recon_loss: 3248636.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5422687.5000; val_optim_loss: 5422687.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8389; val_auprc_score: 0.9382; val_best_acc_score: 0.8424; val_best_f1_score: 0.9047; train_kl_reg_loss: 29767.3459; train_edge_recon_loss: 1474824.2969; train_cat_covariates_contrastive_loss: 627423.5469; train_gene_expr_recon_loss: 3208822.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5340837.7500; train_optim_loss: 5340837.7500; val_kl_reg_loss: 28701.4648; val_edge_recon_loss: 1476057.6250; val_cat_covariates_contrastive_loss: 626910.1875; val_gene_expr_recon_loss: 3207458.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5339128.0000; val_optim_loss: 5339128.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8414; val_auprc_score: 0.9350; val_best_acc_score: 0.8391; val_best_f1_score: 0.9016; train_kl_reg_loss: 28191.6001; train_edge_recon_loss: 1462311.5625; train_cat_covariates_contrastive_loss: 627699.0469; train_gene_expr_recon_loss: 3176360.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5294563.0000; train_optim_loss: 5294563.0000; val_kl_reg_loss: 26526.3848; val_edge_recon_loss: 1542127.2500; val_cat_covariates_contrastive_loss: 626969.7500; val_gene_expr_recon_loss: 3176563.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5372187.0000; val_optim_loss: 5372187.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8530; val_auprc_score: 0.9444; val_best_acc_score: 0.8463; val_best_f1_score: 0.9070; train_kl_reg_loss: 26144.4763; train_edge_recon_loss: 1448297.3594; train_cat_covariates_contrastive_loss: 627955.9688; train_gene_expr_recon_loss: 3153539.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5255937.5000; train_optim_loss: 5255937.5000; val_kl_reg_loss: 24644.6543; val_edge_recon_loss: 1462494.6250; val_cat_covariates_contrastive_loss: 627424.1250; val_gene_expr_recon_loss: 3153267.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5267831.0000; val_optim_loss: 5267831.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8587; val_auprc_score: 0.9443; val_best_acc_score: 0.8522; val_best_f1_score: 0.9097; train_kl_reg_loss: 24506.7656; train_edge_recon_loss: 1456374.2969; train_cat_covariates_contrastive_loss: 628809.5312; train_gene_expr_recon_loss: 3131305.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5240995.5625; train_optim_loss: 5240995.5625; val_kl_reg_loss: 23224.7637; val_edge_recon_loss: 1452134.5000; val_cat_covariates_contrastive_loss: 627625.1250; val_gene_expr_recon_loss: 3133977.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5236962.0000; val_optim_loss: 5236962.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8652; val_auprc_score: 0.9463; val_best_acc_score: 0.8507; val_best_f1_score: 0.9078; train_kl_reg_loss: 23046.9744; train_edge_recon_loss: 1439363.9375; train_cat_covariates_contrastive_loss: 629369.8984; train_gene_expr_recon_loss: 3103742.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5195523.1875; train_optim_loss: 5195523.1875; val_kl_reg_loss: 22142.4336; val_edge_recon_loss: 1455587.7500; val_cat_covariates_contrastive_loss: 628368.0000; val_gene_expr_recon_loss: 3118725.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5224823.0000; val_optim_loss: 5224823.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8680; val_auprc_score: 0.9450; val_best_acc_score: 0.8547; val_best_f1_score: 0.9102; train_kl_reg_loss: 22448.2444; train_edge_recon_loss: 1417201.7812; train_cat_covariates_contrastive_loss: 629709.4844; train_gene_expr_recon_loss: 3093997.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5163356.5000; train_optim_loss: 5163356.5000; val_kl_reg_loss: 21852.6445; val_edge_recon_loss: 1437239.0000; val_cat_covariates_contrastive_loss: 628716.5625; val_gene_expr_recon_loss: 3103232.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5191041.0000; val_optim_loss: 5191041.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8659; val_auprc_score: 0.9433; val_best_acc_score: 0.8525; val_best_f1_score: 0.9084; train_kl_reg_loss: 22171.0586; train_edge_recon_loss: 1421022.4844; train_cat_covariates_contrastive_loss: 630666.6250; train_gene_expr_recon_loss: 3075483.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5149343.3125; train_optim_loss: 5149343.3125; val_kl_reg_loss: 21514.6523; val_edge_recon_loss: 1446378.3750; val_cat_covariates_contrastive_loss: 629485.4375; val_gene_expr_recon_loss: 3086019.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5183397.5000; val_optim_loss: 5183397.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8778; val_auprc_score: 0.9492; val_best_acc_score: 0.8558; val_best_f1_score: 0.9101; train_kl_reg_loss: 21711.9832; train_edge_recon_loss: 1400304.7812; train_cat_covariates_contrastive_loss: 631250.6172; train_gene_expr_recon_loss: 3064282.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5117550.0000; train_optim_loss: 5117550.0000; val_kl_reg_loss: 21073.8242; val_edge_recon_loss: 1430251.0000; val_cat_covariates_contrastive_loss: 630501.1875; val_gene_expr_recon_loss: 3072170.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5153996.0000; val_optim_loss: 5153996.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8797; val_auprc_score: 0.9514; val_best_acc_score: 0.8571; val_best_f1_score: 0.9093; train_kl_reg_loss: 21225.1306; train_edge_recon_loss: 1385302.0156; train_cat_covariates_contrastive_loss: 632005.4219; train_gene_expr_recon_loss: 3054810.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5093343.2500; train_optim_loss: 5093343.2500; val_kl_reg_loss: 20732.3320; val_edge_recon_loss: 1429558.3750; val_cat_covariates_contrastive_loss: 630633.5000; val_gene_expr_recon_loss: 3062553.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5143478.0000; val_optim_loss: 5143478.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8843; val_auprc_score: 0.9530; val_best_acc_score: 0.8597; val_best_f1_score: 0.9102; train_kl_reg_loss: 21010.8406; train_edge_recon_loss: 1399307.9219; train_cat_covariates_contrastive_loss: 632752.7344; train_gene_expr_recon_loss: 3042451.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5095522.5625; train_optim_loss: 5095522.5625; val_kl_reg_loss: 20440.3535; val_edge_recon_loss: 1433342.8750; val_cat_covariates_contrastive_loss: 631513.9375; val_gene_expr_recon_loss: 3054081.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5139378.5000; val_optim_loss: 5139378.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8934; val_auprc_score: 0.9575; val_best_acc_score: 0.8651; val_best_f1_score: 0.9139; train_kl_reg_loss: 20618.6809; train_edge_recon_loss: 1389372.2031; train_cat_covariates_contrastive_loss: 633853.5625; train_gene_expr_recon_loss: 3031939.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5075784.2500; train_optim_loss: 5075784.2500; val_kl_reg_loss: 20123.4043; val_edge_recon_loss: 1422285.2500; val_cat_covariates_contrastive_loss: 632795.9375; val_gene_expr_recon_loss: 3042184.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5117388.5000; val_optim_loss: 5117388.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9018; val_auprc_score: 0.9618; val_best_acc_score: 0.8729; val_best_f1_score: 0.9196; train_kl_reg_loss: 20372.3958; train_edge_recon_loss: 1382294.0469; train_cat_covariates_contrastive_loss: 634608.1484; train_gene_expr_recon_loss: 3028991.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5066266.5000; train_optim_loss: 5066266.5000; val_kl_reg_loss: 19723.2910; val_edge_recon_loss: 1376199.1250; val_cat_covariates_contrastive_loss: 634286.0625; val_gene_expr_recon_loss: 3036972.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5067181.0000; val_optim_loss: 5067181.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9065; val_auprc_score: 0.9607; val_best_acc_score: 0.8764; val_best_f1_score: 0.9205; train_kl_reg_loss: 20084.9026; train_edge_recon_loss: 1377287.2188; train_cat_covariates_contrastive_loss: 634875.5078; train_gene_expr_recon_loss: 3015960.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5048208.2500; train_optim_loss: 5048208.2500; val_kl_reg_loss: 19592.0625; val_edge_recon_loss: 1437982.3750; val_cat_covariates_contrastive_loss: 636805.8750; val_gene_expr_recon_loss: 3028355.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5122736.0000; val_optim_loss: 5122736.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9060; val_auprc_score: 0.9611; val_best_acc_score: 0.8786; val_best_f1_score: 0.9229; train_kl_reg_loss: 19873.8567; train_edge_recon_loss: 1363302.5625; train_cat_covariates_contrastive_loss: 636227.4844; train_gene_expr_recon_loss: 3010947.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5030351.1250; train_optim_loss: 5030351.1250; val_kl_reg_loss: 19603.4375; val_edge_recon_loss: 1431170.5000; val_cat_covariates_contrastive_loss: 634314.6875; val_gene_expr_recon_loss: 3019097.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5104186.0000; val_optim_loss: 5104186.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9007; val_auprc_score: 0.9560; val_best_acc_score: 0.8840; val_best_f1_score: 0.9264; train_kl_reg_loss: 20112.3772; train_edge_recon_loss: 1360690.0625; train_cat_covariates_contrastive_loss: 635943.2031; train_gene_expr_recon_loss: 2998572.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5015318.0000; train_optim_loss: 5015318.0000; val_kl_reg_loss: 19637.8477; val_edge_recon_loss: 1410677.6250; val_cat_covariates_contrastive_loss: 634074.5625; val_gene_expr_recon_loss: 3012287.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5076677.5000; val_optim_loss: 5076677.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9071; val_auprc_score: 0.9600; val_best_acc_score: 0.8778; val_best_f1_score: 0.9218; train_kl_reg_loss: 20004.8347; train_edge_recon_loss: 1351344.6562; train_cat_covariates_contrastive_loss: 636044.0938; train_gene_expr_recon_loss: 2987759.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4995153.3750; train_optim_loss: 4995153.3750; val_kl_reg_loss: 19719.1758; val_edge_recon_loss: 1432396.3750; val_cat_covariates_contrastive_loss: 635991.5000; val_gene_expr_recon_loss: 3007423.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5095531.0000; val_optim_loss: 5095531.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9062; val_auprc_score: 0.9586; val_best_acc_score: 0.8819; val_best_f1_score: 0.9255; train_kl_reg_loss: 20021.5562; train_edge_recon_loss: 1367680.8281; train_cat_covariates_contrastive_loss: 635469.6562; train_gene_expr_recon_loss: 2987331.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5010503.2500; train_optim_loss: 5010503.2500; val_kl_reg_loss: 19556.0840; val_edge_recon_loss: 1414701.0000; val_cat_covariates_contrastive_loss: 634918.3125; val_gene_expr_recon_loss: 3006635.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5075811.0000; val_optim_loss: 5075811.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9029; val_auprc_score: 0.9586; val_best_acc_score: 0.8808; val_best_f1_score: 0.9251; train_kl_reg_loss: 19863.2019; train_edge_recon_loss: 1346659.7969; train_cat_covariates_contrastive_loss: 635424.6719; train_gene_expr_recon_loss: 2988518.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4990466.6875; train_optim_loss: 4990466.6875; val_kl_reg_loss: 19402.2207; val_edge_recon_loss: 1372652.3750; val_cat_covariates_contrastive_loss: 635679.7500; val_gene_expr_recon_loss: 3003574.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5031309.0000; val_optim_loss: 5031309.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9102; val_auprc_score: 0.9621; val_best_acc_score: 0.8818; val_best_f1_score: 0.9247; train_kl_reg_loss: 19783.5300; train_edge_recon_loss: 1372081.9062; train_cat_covariates_contrastive_loss: 636104.7734; train_gene_expr_recon_loss: 2987556.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5015526.3750; train_optim_loss: 5015526.3750; val_kl_reg_loss: 19380.1113; val_edge_recon_loss: 1428174.6250; val_cat_covariates_contrastive_loss: 636120.7500; val_gene_expr_recon_loss: 3003919.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5087594.5000; val_optim_loss: 5087594.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9098; val_auprc_score: 0.9622; val_best_acc_score: 0.8835; val_best_f1_score: 0.9259; train_kl_reg_loss: 19850.9688; train_edge_recon_loss: 1367547.3750; train_cat_covariates_contrastive_loss: 635604.3750; train_gene_expr_recon_loss: 2992944.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5015947.1250; train_optim_loss: 5015947.1250; val_kl_reg_loss: 19366.5820; val_edge_recon_loss: 1402194.2500; val_cat_covariates_contrastive_loss: 633894.1875; val_gene_expr_recon_loss: 3003228.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5058683.5000; val_optim_loss: 5058683.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9098; val_auprc_score: 0.9621; val_best_acc_score: 0.8849; val_best_f1_score: 0.9272; train_kl_reg_loss: 19741.8542; train_edge_recon_loss: 1350961.0938; train_cat_covariates_contrastive_loss: 636294.7344; train_gene_expr_recon_loss: 2983552.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4990550.0625; train_optim_loss: 4990550.0625; val_kl_reg_loss: 19329.7500; val_edge_recon_loss: 1369696.3750; val_cat_covariates_contrastive_loss: 635350.9375; val_gene_expr_recon_loss: 3003217.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5027594.5000; val_optim_loss: 5027594.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9129; val_auprc_score: 0.9638; val_best_acc_score: 0.8830; val_best_f1_score: 0.9257; train_kl_reg_loss: 19725.8550; train_edge_recon_loss: 1354166.7812; train_cat_covariates_contrastive_loss: 635575.4375; train_gene_expr_recon_loss: 2983964.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4993432.7500; train_optim_loss: 4993432.7500; val_kl_reg_loss: 19266.5195; val_edge_recon_loss: 1433169.7500; val_cat_covariates_contrastive_loss: 634358.8750; val_gene_expr_recon_loss: 3000522.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5087317.0000; val_optim_loss: 5087317.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9057; val_auprc_score: 0.9586; val_best_acc_score: 0.8844; val_best_f1_score: 0.9272; train_kl_reg_loss: 19699.0269; train_edge_recon_loss: 1363527.5312; train_cat_covariates_contrastive_loss: 635846.6484; train_gene_expr_recon_loss: 2989065.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5008139.1875; train_optim_loss: 5008139.1875; val_kl_reg_loss: 19281.9062; val_edge_recon_loss: 1379490.3750; val_cat_covariates_contrastive_loss: 634674.1875; val_gene_expr_recon_loss: 3001139.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5034586.0000; val_optim_loss: 5034586.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9139; val_auprc_score: 0.9620; val_best_acc_score: 0.8853; val_best_f1_score: 0.9268; train_kl_reg_loss: 19660.4089; train_edge_recon_loss: 1354643.0469; train_cat_covariates_contrastive_loss: 635952.2266; train_gene_expr_recon_loss: 2983447.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4993702.7500; train_optim_loss: 4993702.7500; val_kl_reg_loss: 19212.8047; val_edge_recon_loss: 1427841.8750; val_cat_covariates_contrastive_loss: 634046.5625; val_gene_expr_recon_loss: 3000562.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5081663.0000; val_optim_loss: 5081663.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9051; val_auprc_score: 0.9589; val_best_acc_score: 0.8824; val_best_f1_score: 0.9255; train_kl_reg_loss: 19604.0916; train_edge_recon_loss: 1360851.4531; train_cat_covariates_contrastive_loss: 635742.6406; train_gene_expr_recon_loss: 2984427.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5000625.5625; train_optim_loss: 5000625.5625; val_kl_reg_loss: 19138.9688; val_edge_recon_loss: 1416977.7500; val_cat_covariates_contrastive_loss: 634300.0000; val_gene_expr_recon_loss: 2998311.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5068728.0000; val_optim_loss: 5068728.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9009; val_auprc_score: 0.9579; val_best_acc_score: 0.8795; val_best_f1_score: 0.9245; train_kl_reg_loss: 19613.0420; train_edge_recon_loss: 1358785.9375; train_cat_covariates_contrastive_loss: 634912.2578; train_gene_expr_recon_loss: 2982626.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4995937.8125; train_optim_loss: 4995937.8125; val_kl_reg_loss: 19191.5469; val_edge_recon_loss: 1395564.2500; val_cat_covariates_contrastive_loss: 634000.0625; val_gene_expr_recon_loss: 2999768.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5048524.0000; val_optim_loss: 5048524.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9097; val_auprc_score: 0.9619; val_best_acc_score: 0.8827; val_best_f1_score: 0.9255; train_kl_reg_loss: 19563.2546; train_edge_recon_loss: 1342581.4844; train_cat_covariates_contrastive_loss: 635461.2031; train_gene_expr_recon_loss: 2985582.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4983188.3125; train_optim_loss: 4983188.3125; val_kl_reg_loss: 19180.8047; val_edge_recon_loss: 1407532.3750; val_cat_covariates_contrastive_loss: 633106.1250; val_gene_expr_recon_loss: 2998929.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5058748.0000; val_optim_loss: 5058748.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9090; val_auprc_score: 0.9616; val_best_acc_score: 0.8850; val_best_f1_score: 0.9267; train_kl_reg_loss: 19559.8364; train_edge_recon_loss: 1354274.0781; train_cat_covariates_contrastive_loss: 636088.8828; train_gene_expr_recon_loss: 2983168.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4993091.7500; train_optim_loss: 4993091.7500; val_kl_reg_loss: 19204.0078; val_edge_recon_loss: 1386739.6250; val_cat_covariates_contrastive_loss: 633629.0625; val_gene_expr_recon_loss: 2998314.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5037887.5000; val_optim_loss: 5037887.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9047; val_auprc_score: 0.9588; val_best_acc_score: 0.8828; val_best_f1_score: 0.9261; train_kl_reg_loss: 19543.1045; train_edge_recon_loss: 1351426.4375; train_cat_covariates_contrastive_loss: 635364.3203; train_gene_expr_recon_loss: 2984584.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4990918.3750; train_optim_loss: 4990918.3750; val_kl_reg_loss: 19123.8672; val_edge_recon_loss: 1405844.2500; val_cat_covariates_contrastive_loss: 638052.4375; val_gene_expr_recon_loss: 2998134.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5061154.5000; val_optim_loss: 5061154.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 32 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
val AUROC score: 0.8853
val AUPRC score: 0.9444
val best accuracy score: 0.8780
val best F1 score: 0.9224
val target rna MSE score: 1.2915
val source rna MSE score: 0.6311
Val cat covariate0 mean sim diff: 0.0002
Val cat covariate1 mean sim diff: -0.0555
Duration of model training in run 1: 0 hours, 4 minutes and 36 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
