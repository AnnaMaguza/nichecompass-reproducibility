Run timestamp: 26082023_174438_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '512', '512', '512', '512', '512', '512', '512', '512', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'celltype_mapped_refined', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_50pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 212411
Number of validation edges: 23601
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9601; val_auprc_score: 0.9916; val_best_acc_score: 0.9472; val_best_f1_score: 0.9696; train_kl_reg_loss: 9745.3035; train_edge_recon_loss: 873110.6691; train_gene_expr_recon_loss: 1885576.8738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2768432.8446; train_optim_loss: 2768432.8446; val_kl_reg_loss: 10481.6956; val_edge_recon_loss: 791736.9654; val_gene_expr_recon_loss: 1728569.2872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2530787.9415; val_optim_loss: 2530787.9415
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9811; val_auprc_score: 0.9951; val_best_acc_score: 0.9713; val_best_f1_score: 0.9833; train_kl_reg_loss: 10346.9809; train_edge_recon_loss: 787400.4453; train_gene_expr_recon_loss: 1672180.5831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2469928.0066; train_optim_loss: 2469928.0066; val_kl_reg_loss: 10134.9115; val_edge_recon_loss: 785145.7553; val_gene_expr_recon_loss: 1626724.8617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2422005.5319; val_optim_loss: 2422005.5319
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9852; val_auprc_score: 0.9960; val_best_acc_score: 0.9767; val_best_f1_score: 0.9864; train_kl_reg_loss: 10003.1406; train_edge_recon_loss: 773321.5392; train_gene_expr_recon_loss: 1591049.6422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2374374.3163; train_optim_loss: 2374374.3163; val_kl_reg_loss: 9555.5864; val_edge_recon_loss: 786680.0718; val_gene_expr_recon_loss: 1559540.1995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2355775.8617; val_optim_loss: 2355775.8617
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9834; val_auprc_score: 0.9959; val_best_acc_score: 0.9778; val_best_f1_score: 0.9871; train_kl_reg_loss: 9597.5346; train_edge_recon_loss: 771263.2467; train_gene_expr_recon_loss: 1525721.2913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2306582.0801; train_optim_loss: 2306582.0801; val_kl_reg_loss: 9335.1771; val_edge_recon_loss: 769824.3524; val_gene_expr_recon_loss: 1493403.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2272563.0160; val_optim_loss: 2272563.0160
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9877; val_auprc_score: 0.9969; val_best_acc_score: 0.9812; val_best_f1_score: 0.9890; train_kl_reg_loss: 9391.8081; train_edge_recon_loss: 772467.8682; train_gene_expr_recon_loss: 1468816.0404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2250675.7163; train_optim_loss: 2250675.7163; val_kl_reg_loss: 9510.9494; val_edge_recon_loss: 781406.7287; val_gene_expr_recon_loss: 1444225.2154; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2235142.9043; val_optim_loss: 2235142.9043
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9875; val_auprc_score: 0.9967; val_best_acc_score: 0.9813; val_best_f1_score: 0.9891; train_kl_reg_loss: 9532.8086; train_edge_recon_loss: 772214.0086; train_gene_expr_recon_loss: 1418732.4569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2200479.2771; train_optim_loss: 2200479.2771; val_kl_reg_loss: 9580.0533; val_edge_recon_loss: 776239.7487; val_gene_expr_recon_loss: 1405492.5186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2191312.3457; val_optim_loss: 2191312.3457
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9882; val_auprc_score: 0.9967; val_best_acc_score: 0.9824; val_best_f1_score: 0.9897; train_kl_reg_loss: 9696.6599; train_edge_recon_loss: 766245.7014; train_gene_expr_recon_loss: 1380248.9596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2156191.3190; train_optim_loss: 2156191.3190; val_kl_reg_loss: 9958.1232; val_edge_recon_loss: 764472.3524; val_gene_expr_recon_loss: 1366807.1170; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2141237.6064; val_optim_loss: 2141237.6064
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9885; val_auprc_score: 0.9961; val_best_acc_score: 0.9843; val_best_f1_score: 0.9909; train_kl_reg_loss: 9958.3305; train_edge_recon_loss: 769488.6443; train_gene_expr_recon_loss: 1348636.5880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2128083.5608; train_optim_loss: 2128083.5608; val_kl_reg_loss: 10082.2004; val_edge_recon_loss: 748070.7500; val_gene_expr_recon_loss: 1338266.9149; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2096419.8644; val_optim_loss: 2096419.8644
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9878; val_auprc_score: 0.9962; val_best_acc_score: 0.9839; val_best_f1_score: 0.9906; train_kl_reg_loss: 10100.3783; train_edge_recon_loss: 763584.2980; train_gene_expr_recon_loss: 1322902.2024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2096586.8861; train_optim_loss: 2096586.8861; val_kl_reg_loss: 10032.4085; val_edge_recon_loss: 782029.4269; val_gene_expr_recon_loss: 1310893.3138; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2102955.1516; val_optim_loss: 2102955.1516
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9906; val_auprc_score: 0.9974; val_best_acc_score: 0.9848; val_best_f1_score: 0.9911; train_kl_reg_loss: 10203.5052; train_edge_recon_loss: 765804.1902; train_gene_expr_recon_loss: 1302801.1596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2078808.8581; train_optim_loss: 2078808.8581; val_kl_reg_loss: 10139.3540; val_edge_recon_loss: 781767.3098; val_gene_expr_recon_loss: 1300900.8856; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2092807.5532; val_optim_loss: 2092807.5532
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9886; val_auprc_score: 0.9973; val_best_acc_score: 0.9838; val_best_f1_score: 0.9906; train_kl_reg_loss: 10376.5598; train_edge_recon_loss: 765740.4059; train_gene_expr_recon_loss: 1286223.1714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2062340.1364; train_optim_loss: 2062340.1364; val_kl_reg_loss: 10514.7024; val_edge_recon_loss: 768181.4761; val_gene_expr_recon_loss: 1287650.2633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2066346.4495; val_optim_loss: 2066346.4495
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9906; val_auprc_score: 0.9974; val_best_acc_score: 0.9867; val_best_f1_score: 0.9923; train_kl_reg_loss: 10508.3418; train_edge_recon_loss: 767821.5581; train_gene_expr_recon_loss: 1271601.1503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2049931.0476; train_optim_loss: 2049931.0476; val_kl_reg_loss: 10654.6207; val_edge_recon_loss: 752656.0545; val_gene_expr_recon_loss: 1279367.5771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2042678.2500; val_optim_loss: 2042678.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9898; val_auprc_score: 0.9970; val_best_acc_score: 0.9855; val_best_f1_score: 0.9916; train_kl_reg_loss: 10563.4441; train_edge_recon_loss: 771624.8803; train_gene_expr_recon_loss: 1261073.5009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2043261.8292; train_optim_loss: 2043261.8292; val_kl_reg_loss: 10538.7865; val_edge_recon_loss: 762218.5093; val_gene_expr_recon_loss: 1261089.2181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2033846.5080; val_optim_loss: 2033846.5080
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9891; val_auprc_score: 0.9969; val_best_acc_score: 0.9859; val_best_f1_score: 0.9918; train_kl_reg_loss: 10630.0867; train_edge_recon_loss: 763592.2348; train_gene_expr_recon_loss: 1249224.0154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2023446.3367; train_optim_loss: 2023446.3367; val_kl_reg_loss: 10826.7665; val_edge_recon_loss: 761225.3670; val_gene_expr_recon_loss: 1252204.8059; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2024256.9335; val_optim_loss: 2024256.9335
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9898; val_auprc_score: 0.9966; val_best_acc_score: 0.9853; val_best_f1_score: 0.9914; train_kl_reg_loss: 10700.9609; train_edge_recon_loss: 769139.7693; train_gene_expr_recon_loss: 1243442.3172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2023283.0434; train_optim_loss: 2023283.0434; val_kl_reg_loss: 10546.1793; val_edge_recon_loss: 770172.2460; val_gene_expr_recon_loss: 1246889.1596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2027607.6011; val_optim_loss: 2027607.6011
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9893; val_auprc_score: 0.9971; val_best_acc_score: 0.9865; val_best_f1_score: 0.9922; train_kl_reg_loss: 10713.5822; train_edge_recon_loss: 766245.3486; train_gene_expr_recon_loss: 1234825.6663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2011784.5991; train_optim_loss: 2011784.5991; val_kl_reg_loss: 10765.3662; val_edge_recon_loss: 762977.7035; val_gene_expr_recon_loss: 1235255.6223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2008998.6941; val_optim_loss: 2008998.6941
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9896; val_auprc_score: 0.9965; val_best_acc_score: 0.9867; val_best_f1_score: 0.9923; train_kl_reg_loss: 10826.0054; train_edge_recon_loss: 770296.0154; train_gene_expr_recon_loss: 1229846.5114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2010968.5349; train_optim_loss: 2010968.5349; val_kl_reg_loss: 10777.9426; val_edge_recon_loss: 763316.8225; val_gene_expr_recon_loss: 1238216.3324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2012311.0824; val_optim_loss: 2012311.0824
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9888; val_auprc_score: 0.9970; val_best_acc_score: 0.9859; val_best_f1_score: 0.9918; train_kl_reg_loss: 10755.5152; train_edge_recon_loss: 764727.5488; train_gene_expr_recon_loss: 1225713.1931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2001196.2611; train_optim_loss: 2001196.2611; val_kl_reg_loss: 10690.7298; val_edge_recon_loss: 759462.2181; val_gene_expr_recon_loss: 1226841.5904; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1996994.5239; val_optim_loss: 1996994.5239
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9894; val_auprc_score: 0.9967; val_best_acc_score: 0.9872; val_best_f1_score: 0.9926; train_kl_reg_loss: 10804.3560; train_edge_recon_loss: 766796.6312; train_gene_expr_recon_loss: 1222527.4527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2000128.4383; train_optim_loss: 2000128.4383; val_kl_reg_loss: 11069.9381; val_edge_recon_loss: 754847.5705; val_gene_expr_recon_loss: 1236069.3324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2001986.8324; val_optim_loss: 2001986.8324
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9911; val_auprc_score: 0.9977; val_best_acc_score: 0.9875; val_best_f1_score: 0.9927; train_kl_reg_loss: 10908.6536; train_edge_recon_loss: 760920.6773; train_gene_expr_recon_loss: 1217136.7596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1988966.0922; train_optim_loss: 1988966.0922; val_kl_reg_loss: 10796.2317; val_edge_recon_loss: 756289.6755; val_gene_expr_recon_loss: 1223310.9122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1990396.8191; val_optim_loss: 1990396.8191
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9930; val_auprc_score: 0.9983; val_best_acc_score: 0.9876; val_best_f1_score: 0.9928; train_kl_reg_loss: 10883.9959; train_edge_recon_loss: 768817.1630; train_gene_expr_recon_loss: 1213424.0202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1993125.1759; train_optim_loss: 1993125.1759; val_kl_reg_loss: 10956.5503; val_edge_recon_loss: 771330.3843; val_gene_expr_recon_loss: 1221796.1223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2004083.0585; val_optim_loss: 2004083.0585
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9910; val_auprc_score: 0.9976; val_best_acc_score: 0.9868; val_best_f1_score: 0.9923; train_kl_reg_loss: 10920.6185; train_edge_recon_loss: 763302.3904; train_gene_expr_recon_loss: 1210073.9337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1984296.9401; train_optim_loss: 1984296.9401; val_kl_reg_loss: 11025.4615; val_edge_recon_loss: 769139.9202; val_gene_expr_recon_loss: 1224602.6197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2004767.9973; val_optim_loss: 2004767.9973
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9907; val_auprc_score: 0.9974; val_best_acc_score: 0.9872; val_best_f1_score: 0.9925; train_kl_reg_loss: 10970.3153; train_edge_recon_loss: 765049.5741; train_gene_expr_recon_loss: 1209299.1367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1985319.0283; train_optim_loss: 1985319.0283; val_kl_reg_loss: 11152.0201; val_edge_recon_loss: 763390.4189; val_gene_expr_recon_loss: 1215942.5053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1990484.9335; val_optim_loss: 1990484.9335
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9918; val_auprc_score: 0.9978; val_best_acc_score: 0.9873; val_best_f1_score: 0.9926; train_kl_reg_loss: 10986.0921; train_edge_recon_loss: 762238.0236; train_gene_expr_recon_loss: 1207408.9642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1980633.0768; train_optim_loss: 1980633.0768; val_kl_reg_loss: 11274.8776; val_edge_recon_loss: 768887.5319; val_gene_expr_recon_loss: 1217766.4947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1997928.9016; val_optim_loss: 1997928.9016

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9907; val_auprc_score: 0.9974; val_best_acc_score: 0.9872; val_best_f1_score: 0.9926; train_kl_reg_loss: 10964.4381; train_edge_recon_loss: 765661.3485; train_gene_expr_recon_loss: 1194494.4729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1971120.2581; train_optim_loss: 1971120.2581; val_kl_reg_loss: 10941.4854; val_edge_recon_loss: 753222.6144; val_gene_expr_recon_loss: 1212967.6649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1977131.7553; val_optim_loss: 1977131.7553
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9915; val_auprc_score: 0.9973; val_best_acc_score: 0.9870; val_best_f1_score: 0.9924; train_kl_reg_loss: 10934.2910; train_edge_recon_loss: 763148.4486; train_gene_expr_recon_loss: 1192766.2497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1966848.9886; train_optim_loss: 1966848.9886; val_kl_reg_loss: 10972.1680; val_edge_recon_loss: 763575.4548; val_gene_expr_recon_loss: 1209588.2660; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1984135.8883; val_optim_loss: 1984135.8883
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9909; val_auprc_score: 0.9972; val_best_acc_score: 0.9865; val_best_f1_score: 0.9921; train_kl_reg_loss: 10970.4147; train_edge_recon_loss: 764195.1738; train_gene_expr_recon_loss: 1191105.9232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1966271.5136; train_optim_loss: 1966271.5136; val_kl_reg_loss: 10952.1652; val_edge_recon_loss: 752714.3444; val_gene_expr_recon_loss: 1209141.4574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1972807.9521; val_optim_loss: 1972807.9521
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9910; val_auprc_score: 0.9970; val_best_acc_score: 0.9863; val_best_f1_score: 0.9920; train_kl_reg_loss: 10971.7033; train_edge_recon_loss: 758653.7726; train_gene_expr_recon_loss: 1191741.4648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1961366.9404; train_optim_loss: 1961366.9404; val_kl_reg_loss: 11019.6362; val_edge_recon_loss: 772576.6569; val_gene_expr_recon_loss: 1213893.0027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1997489.3032; val_optim_loss: 1997489.3032
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9919; val_auprc_score: 0.9977; val_best_acc_score: 0.9865; val_best_f1_score: 0.9921; train_kl_reg_loss: 10982.7897; train_edge_recon_loss: 766427.1596; train_gene_expr_recon_loss: 1190040.2536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1967450.2036; train_optim_loss: 1967450.2036; val_kl_reg_loss: 10999.4195; val_edge_recon_loss: 759592.1556; val_gene_expr_recon_loss: 1207167.9309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1977759.5213; val_optim_loss: 1977759.5213
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9902; val_auprc_score: 0.9968; val_best_acc_score: 0.9881; val_best_f1_score: 0.9930; train_kl_reg_loss: 10990.8800; train_edge_recon_loss: 767836.8608; train_gene_expr_recon_loss: 1188932.6828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1967760.4238; train_optim_loss: 1967760.4238; val_kl_reg_loss: 11113.7215; val_edge_recon_loss: 755876.7487; val_gene_expr_recon_loss: 1203655.5957; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1970646.0638; val_optim_loss: 1970646.0638
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9904; val_auprc_score: 0.9972; val_best_acc_score: 0.9869; val_best_f1_score: 0.9923; train_kl_reg_loss: 11045.4090; train_edge_recon_loss: 762475.9030; train_gene_expr_recon_loss: 1189116.3235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1962637.6380; train_optim_loss: 1962637.6380; val_kl_reg_loss: 11080.3812; val_edge_recon_loss: 762669.4973; val_gene_expr_recon_loss: 1201708.5585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1975458.4388; val_optim_loss: 1975458.4388
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9911; val_auprc_score: 0.9972; val_best_acc_score: 0.9873; val_best_f1_score: 0.9926; train_kl_reg_loss: 11053.5179; train_edge_recon_loss: 763112.7422; train_gene_expr_recon_loss: 1189115.1151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1963281.3750; train_optim_loss: 1963281.3750; val_kl_reg_loss: 11040.1751; val_edge_recon_loss: 769098.6184; val_gene_expr_recon_loss: 1206338.8112; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1986477.5984; val_optim_loss: 1986477.5984
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9924; val_auprc_score: 0.9979; val_best_acc_score: 0.9879; val_best_f1_score: 0.9930; train_kl_reg_loss: 11038.8415; train_edge_recon_loss: 767198.1044; train_gene_expr_recon_loss: 1188559.7991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1966796.7476; train_optim_loss: 1966796.7476; val_kl_reg_loss: 11049.2087; val_edge_recon_loss: 764494.9574; val_gene_expr_recon_loss: 1201712.1090; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1977256.2793; val_optim_loss: 1977256.2793
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9910; val_auprc_score: 0.9969; val_best_acc_score: 0.9875; val_best_f1_score: 0.9927; train_kl_reg_loss: 11046.0427; train_edge_recon_loss: 764182.7938; train_gene_expr_recon_loss: 1187685.6735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1962914.5045; train_optim_loss: 1962914.5045; val_kl_reg_loss: 11084.4790; val_edge_recon_loss: 767303.8165; val_gene_expr_recon_loss: 1205839.4521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1984227.7447; val_optim_loss: 1984227.7447

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9889; val_auprc_score: 0.9962; val_best_acc_score: 0.9869; val_best_f1_score: 0.9924; train_kl_reg_loss: 11034.3515; train_edge_recon_loss: 762874.7446; train_gene_expr_recon_loss: 1186536.6639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1960445.7623; train_optim_loss: 1960445.7623; val_kl_reg_loss: 11024.7415; val_edge_recon_loss: 755759.5346; val_gene_expr_recon_loss: 1201532.5346; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1968316.8059; val_optim_loss: 1968316.8059
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9914; val_auprc_score: 0.9975; val_best_acc_score: 0.9869; val_best_f1_score: 0.9923; train_kl_reg_loss: 11020.8080; train_edge_recon_loss: 767399.3505; train_gene_expr_recon_loss: 1185778.1386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1964198.2979; train_optim_loss: 1964198.2979; val_kl_reg_loss: 11057.5939; val_edge_recon_loss: 777012.2261; val_gene_expr_recon_loss: 1208976.3723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1997046.1888; val_optim_loss: 1997046.1888
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9915; val_auprc_score: 0.9978; val_best_acc_score: 0.9874; val_best_f1_score: 0.9926; train_kl_reg_loss: 11019.2952; train_edge_recon_loss: 758916.0568; train_gene_expr_recon_loss: 1186672.7123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1956608.0696; train_optim_loss: 1956608.0696; val_kl_reg_loss: 11045.0739; val_edge_recon_loss: 776700.5293; val_gene_expr_recon_loss: 1202913.4441; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1990659.0559; val_optim_loss: 1990659.0559
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9920; val_auprc_score: 0.9976; val_best_acc_score: 0.9871; val_best_f1_score: 0.9925; train_kl_reg_loss: 11040.2367; train_edge_recon_loss: 764183.1556; train_gene_expr_recon_loss: 1187174.7024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1962398.0970; train_optim_loss: 1962398.0970; val_kl_reg_loss: 11065.7244; val_edge_recon_loss: 768195.5638; val_gene_expr_recon_loss: 1204584.1809; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1983845.4654; val_optim_loss: 1983845.4654
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9906; val_auprc_score: 0.9962; val_best_acc_score: 0.9877; val_best_f1_score: 0.9928; train_kl_reg_loss: 11028.1614; train_edge_recon_loss: 764670.8681; train_gene_expr_recon_loss: 1187834.0337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1963533.0672; train_optim_loss: 1963533.0672; val_kl_reg_loss: 11047.5086; val_edge_recon_loss: 759141.8703; val_gene_expr_recon_loss: 1204387.1968; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1974576.5771; val_optim_loss: 1974576.5771

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9899; val_auprc_score: 0.9971; val_best_acc_score: 0.9870; val_best_f1_score: 0.9924; train_kl_reg_loss: 11034.3635; train_edge_recon_loss: 767831.8036; train_gene_expr_recon_loss: 1185860.7175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1964726.8855; train_optim_loss: 1964726.8855; val_kl_reg_loss: 11059.8268; val_edge_recon_loss: 786377.4761; val_gene_expr_recon_loss: 1207201.4787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2004638.7819; val_optim_loss: 2004638.7819
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9915; val_auprc_score: 0.9979; val_best_acc_score: 0.9881; val_best_f1_score: 0.9931; train_kl_reg_loss: 11034.0422; train_edge_recon_loss: 763840.9014; train_gene_expr_recon_loss: 1185691.1584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1960566.1012; train_optim_loss: 1960566.1012; val_kl_reg_loss: 11058.8063; val_edge_recon_loss: 761264.9136; val_gene_expr_recon_loss: 1205056.5027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1977380.2367; val_optim_loss: 1977380.2367
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9906; val_auprc_score: 0.9974; val_best_acc_score: 0.9882; val_best_f1_score: 0.9931; train_kl_reg_loss: 11034.6952; train_edge_recon_loss: 763877.9556; train_gene_expr_recon_loss: 1185434.4303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1960347.0840; train_optim_loss: 1960347.0840; val_kl_reg_loss: 11051.2004; val_edge_recon_loss: 763963.3338; val_gene_expr_recon_loss: 1210013.7846; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1985028.3191; val_optim_loss: 1985028.3191
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9940; val_auprc_score: 0.9987; val_best_acc_score: 0.9877; val_best_f1_score: 0.9928; train_kl_reg_loss: 11034.9596; train_edge_recon_loss: 765073.4423; train_gene_expr_recon_loss: 1185657.1590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1961765.5669; train_optim_loss: 1961765.5669; val_kl_reg_loss: 11049.5607; val_edge_recon_loss: 762128.4229; val_gene_expr_recon_loss: 1202851.0984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1976029.0798; val_optim_loss: 1976029.0798

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 134 min 31 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
val AUROC score: 0.9921
val AUPRC score: 0.9979
val best accuracy score: 0.9869
val best F1 score: 0.9924
val target rna MSE score: 0.8586
val source rna MSE score: 0.1634
Val cat covariate0 mean sim diff: -0.0010
Duration of model training in run 8: 2 hours, 15 minutes and 12 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 212411
Number of validation edges: 23601
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9594; val_auprc_score: 0.9912; val_best_acc_score: 0.9440; val_best_f1_score: 0.9677; train_kl_reg_loss: 9761.1542; train_edge_recon_loss: 878287.6488; train_gene_expr_recon_loss: 1883277.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2771325.8506; train_optim_loss: 2771325.8506; val_kl_reg_loss: 11115.5647; val_edge_recon_loss: 797878.1090; val_gene_expr_recon_loss: 1741623.7207; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2550617.3830; val_optim_loss: 2550617.3830
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9769; val_auprc_score: 0.9933; val_best_acc_score: 0.9690; val_best_f1_score: 0.9820; train_kl_reg_loss: 10108.6392; train_edge_recon_loss: 785948.1821; train_gene_expr_recon_loss: 1683544.6681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2479601.4861; train_optim_loss: 2479601.4861; val_kl_reg_loss: 9402.9457; val_edge_recon_loss: 780675.4229; val_gene_expr_recon_loss: 1634772.6223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2424850.9787; val_optim_loss: 2424850.9787
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9839; val_auprc_score: 0.9960; val_best_acc_score: 0.9752; val_best_f1_score: 0.9856; train_kl_reg_loss: 9368.9051; train_edge_recon_loss: 779982.2694; train_gene_expr_recon_loss: 1601195.9584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2390547.1380; train_optim_loss: 2390547.1380; val_kl_reg_loss: 9226.4980; val_edge_recon_loss: 779003.3697; val_gene_expr_recon_loss: 1564053.5612; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2352283.4362; val_optim_loss: 2352283.4362
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9876; val_auprc_score: 0.9969; val_best_acc_score: 0.9796; val_best_f1_score: 0.9881; train_kl_reg_loss: 9032.1268; train_edge_recon_loss: 774697.1840; train_gene_expr_recon_loss: 1537798.4605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2321527.7717; train_optim_loss: 2321527.7717; val_kl_reg_loss: 9070.3995; val_edge_recon_loss: 773587.3830; val_gene_expr_recon_loss: 1512004.2686; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2294662.0426; val_optim_loss: 2294662.0426
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9864; val_auprc_score: 0.9965; val_best_acc_score: 0.9811; val_best_f1_score: 0.9890; train_kl_reg_loss: 8911.0714; train_edge_recon_loss: 767146.9242; train_gene_expr_recon_loss: 1477732.0554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2253790.0566; train_optim_loss: 2253790.0566; val_kl_reg_loss: 8802.7591; val_edge_recon_loss: 761477.6290; val_gene_expr_recon_loss: 1458843.9574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2229124.3457; val_optim_loss: 2229124.3457
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9884; val_auprc_score: 0.9966; val_best_acc_score: 0.9809; val_best_f1_score: 0.9888; train_kl_reg_loss: 9142.9100; train_edge_recon_loss: 773053.5259; train_gene_expr_recon_loss: 1427631.2199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2209827.6614; train_optim_loss: 2209827.6614; val_kl_reg_loss: 9201.5373; val_edge_recon_loss: 801185.4681; val_gene_expr_recon_loss: 1417849.0027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2228236.0319; val_optim_loss: 2228236.0319
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9879; val_auprc_score: 0.9966; val_best_acc_score: 0.9823; val_best_f1_score: 0.9896; train_kl_reg_loss: 9404.0618; train_edge_recon_loss: 760604.0783; train_gene_expr_recon_loss: 1384874.9886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2154883.1226; train_optim_loss: 2154883.1226; val_kl_reg_loss: 9361.9316; val_edge_recon_loss: 783114.8816; val_gene_expr_recon_loss: 1389367.8138; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2181844.6197; val_optim_loss: 2181844.6197
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9884; val_auprc_score: 0.9968; val_best_acc_score: 0.9825; val_best_f1_score: 0.9898; train_kl_reg_loss: 9618.6264; train_edge_recon_loss: 766128.7586; train_gene_expr_recon_loss: 1351666.3223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2127413.7003; train_optim_loss: 2127413.7003; val_kl_reg_loss: 9663.5397; val_edge_recon_loss: 770054.4561; val_gene_expr_recon_loss: 1340482.2753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2120200.2606; val_optim_loss: 2120200.2606
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9875; val_auprc_score: 0.9960; val_best_acc_score: 0.9840; val_best_f1_score: 0.9907; train_kl_reg_loss: 9854.1800; train_edge_recon_loss: 762700.3516; train_gene_expr_recon_loss: 1327205.8922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2099760.4181; train_optim_loss: 2099760.4181; val_kl_reg_loss: 9920.0813; val_edge_recon_loss: 766251.6449; val_gene_expr_recon_loss: 1324392.5984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2100564.3271; val_optim_loss: 2100564.3271
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9866; val_auprc_score: 0.9953; val_best_acc_score: 0.9835; val_best_f1_score: 0.9904; train_kl_reg_loss: 10038.3470; train_edge_recon_loss: 771438.7402; train_gene_expr_recon_loss: 1303352.4304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2084829.5196; train_optim_loss: 2084829.5196; val_kl_reg_loss: 10443.9294; val_edge_recon_loss: 770627.2952; val_gene_expr_recon_loss: 1296673.9787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2077745.2074; val_optim_loss: 2077745.2074
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9888; val_auprc_score: 0.9967; val_best_acc_score: 0.9839; val_best_f1_score: 0.9906; train_kl_reg_loss: 10203.6150; train_edge_recon_loss: 768551.6938; train_gene_expr_recon_loss: 1287032.0524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2065787.3675; train_optim_loss: 2065787.3675; val_kl_reg_loss: 10228.2954; val_edge_recon_loss: 764288.1848; val_gene_expr_recon_loss: 1289423.2633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2063939.7314; val_optim_loss: 2063939.7314
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9907; val_auprc_score: 0.9972; val_best_acc_score: 0.9856; val_best_f1_score: 0.9916; train_kl_reg_loss: 10313.1027; train_edge_recon_loss: 772206.3855; train_gene_expr_recon_loss: 1273728.5867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2056248.0732; train_optim_loss: 2056248.0732; val_kl_reg_loss: 10431.7353; val_edge_recon_loss: 757048.4774; val_gene_expr_recon_loss: 1276831.4947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2044311.7101; val_optim_loss: 2044311.7101
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9890; val_auprc_score: 0.9964; val_best_acc_score: 0.9850; val_best_f1_score: 0.9913; train_kl_reg_loss: 10424.9365; train_edge_recon_loss: 769749.4690; train_gene_expr_recon_loss: 1259710.7768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2039885.1837; train_optim_loss: 2039885.1837; val_kl_reg_loss: 10335.8411; val_edge_recon_loss: 771048.6769; val_gene_expr_recon_loss: 1272436.7633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2053821.2872; val_optim_loss: 2053821.2872
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9891; val_auprc_score: 0.9972; val_best_acc_score: 0.9844; val_best_f1_score: 0.9909; train_kl_reg_loss: 10555.4817; train_edge_recon_loss: 769876.1340; train_gene_expr_recon_loss: 1251875.1467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2032306.7602; train_optim_loss: 2032306.7602; val_kl_reg_loss: 10661.4804; val_edge_recon_loss: 770940.4096; val_gene_expr_recon_loss: 1251167.1915; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2032769.0798; val_optim_loss: 2032769.0798
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9915; val_auprc_score: 0.9979; val_best_acc_score: 0.9859; val_best_f1_score: 0.9917; train_kl_reg_loss: 10601.9776; train_edge_recon_loss: 771970.7962; train_gene_expr_recon_loss: 1243499.3768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2026072.1527; train_optim_loss: 2026072.1527; val_kl_reg_loss: 10628.3506; val_edge_recon_loss: 777699.3218; val_gene_expr_recon_loss: 1244329.4894; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2032657.1489; val_optim_loss: 2032657.1489
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9903; val_auprc_score: 0.9973; val_best_acc_score: 0.9857; val_best_f1_score: 0.9916; train_kl_reg_loss: 10618.1159; train_edge_recon_loss: 768451.4658; train_gene_expr_recon_loss: 1238197.0524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2017266.6325; train_optim_loss: 2017266.6325; val_kl_reg_loss: 10721.2229; val_edge_recon_loss: 781393.9468; val_gene_expr_recon_loss: 1248506.8378; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2040622.0080; val_optim_loss: 2040622.0080
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9890; val_auprc_score: 0.9961; val_best_acc_score: 0.9856; val_best_f1_score: 0.9916; train_kl_reg_loss: 10662.2798; train_edge_recon_loss: 761946.4325; train_gene_expr_recon_loss: 1230871.2452; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2003479.9539; train_optim_loss: 2003479.9539; val_kl_reg_loss: 10777.1199; val_edge_recon_loss: 776457.3444; val_gene_expr_recon_loss: 1238535.3271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2025769.8032; val_optim_loss: 2025769.8032
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9892; val_auprc_score: 0.9969; val_best_acc_score: 0.9843; val_best_f1_score: 0.9909; train_kl_reg_loss: 10728.6887; train_edge_recon_loss: 763082.6539; train_gene_expr_recon_loss: 1224313.5127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1998124.8536; train_optim_loss: 1998124.8536; val_kl_reg_loss: 10923.7598; val_edge_recon_loss: 761782.4840; val_gene_expr_recon_loss: 1235877.5053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2008583.7473; val_optim_loss: 2008583.7473
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9889; val_auprc_score: 0.9964; val_best_acc_score: 0.9856; val_best_f1_score: 0.9916; train_kl_reg_loss: 10726.3237; train_edge_recon_loss: 771203.8172; train_gene_expr_recon_loss: 1225823.3548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2007753.4958; train_optim_loss: 2007753.4958; val_kl_reg_loss: 11033.3276; val_edge_recon_loss: 766935.6702; val_gene_expr_recon_loss: 1243937.0691; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2021906.0638; val_optim_loss: 2021906.0638
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9906; val_auprc_score: 0.9971; val_best_acc_score: 0.9857; val_best_f1_score: 0.9917; train_kl_reg_loss: 10848.4702; train_edge_recon_loss: 770193.2577; train_gene_expr_recon_loss: 1217151.6084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1998193.3398; train_optim_loss: 1998193.3398; val_kl_reg_loss: 11016.0117; val_edge_recon_loss: 762067.6436; val_gene_expr_recon_loss: 1234246.3777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2007330.0239; val_optim_loss: 2007330.0239
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9916; val_auprc_score: 0.9978; val_best_acc_score: 0.9864; val_best_f1_score: 0.9921; train_kl_reg_loss: 10865.5507; train_edge_recon_loss: 767911.6774; train_gene_expr_recon_loss: 1217185.7630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1995962.9943; train_optim_loss: 1995962.9943; val_kl_reg_loss: 10963.0075; val_edge_recon_loss: 752849.6051; val_gene_expr_recon_loss: 1230621.4707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1994434.0851; val_optim_loss: 1994434.0851
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9903; val_auprc_score: 0.9964; val_best_acc_score: 0.9855; val_best_f1_score: 0.9915; train_kl_reg_loss: 10880.8329; train_edge_recon_loss: 769877.0447; train_gene_expr_recon_loss: 1212931.9190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1993689.7973; train_optim_loss: 1993689.7973; val_kl_reg_loss: 10810.7882; val_edge_recon_loss: 772213.1410; val_gene_expr_recon_loss: 1225578.2899; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2008602.2207; val_optim_loss: 2008602.2207
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9915; val_auprc_score: 0.9973; val_best_acc_score: 0.9864; val_best_f1_score: 0.9921; train_kl_reg_loss: 10865.7108; train_edge_recon_loss: 765329.5053; train_gene_expr_recon_loss: 1213801.8738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1989997.0883; train_optim_loss: 1989997.0883; val_kl_reg_loss: 10698.9254; val_edge_recon_loss: 776941.1423; val_gene_expr_recon_loss: 1229162.4681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2016802.5293; val_optim_loss: 2016802.5293
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9915; val_auprc_score: 0.9976; val_best_acc_score: 0.9859; val_best_f1_score: 0.9917; train_kl_reg_loss: 10898.7299; train_edge_recon_loss: 765680.6902; train_gene_expr_recon_loss: 1210399.9334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1986979.3548; train_optim_loss: 1986979.3548; val_kl_reg_loss: 11002.3409; val_edge_recon_loss: 776137.4043; val_gene_expr_recon_loss: 1216323.6277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2003463.3777; val_optim_loss: 2003463.3777
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9902; val_auprc_score: 0.9966; val_best_acc_score: 0.9863; val_best_f1_score: 0.9920; train_kl_reg_loss: 10970.7234; train_edge_recon_loss: 762360.8200; train_gene_expr_recon_loss: 1205414.7024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1978746.2431; train_optim_loss: 1978746.2431; val_kl_reg_loss: 10985.6025; val_edge_recon_loss: 781041.5186; val_gene_expr_recon_loss: 1218252.3165; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2010279.4309; val_optim_loss: 2010279.4309

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9918; val_auprc_score: 0.9979; val_best_acc_score: 0.9862; val_best_f1_score: 0.9919; train_kl_reg_loss: 10903.9710; train_edge_recon_loss: 762314.0807; train_gene_expr_recon_loss: 1194178.3105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1967396.3636; train_optim_loss: 1967396.3636; val_kl_reg_loss: 10860.8275; val_edge_recon_loss: 761472.4601; val_gene_expr_recon_loss: 1209451.4894; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1981784.7819; val_optim_loss: 1981784.7819
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9936; val_auprc_score: 0.9984; val_best_acc_score: 0.9873; val_best_f1_score: 0.9926; train_kl_reg_loss: 10865.0601; train_edge_recon_loss: 760685.7111; train_gene_expr_recon_loss: 1192112.7313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1963663.4985; train_optim_loss: 1963663.4985; val_kl_reg_loss: 10829.7530; val_edge_recon_loss: 771650.7314; val_gene_expr_recon_loss: 1210851.1729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1993331.6410; val_optim_loss: 1993331.6410
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9892; val_auprc_score: 0.9966; val_best_acc_score: 0.9858; val_best_f1_score: 0.9917; train_kl_reg_loss: 10875.4413; train_edge_recon_loss: 769377.3369; train_gene_expr_recon_loss: 1191525.2518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1971778.0316; train_optim_loss: 1971778.0316; val_kl_reg_loss: 10876.9637; val_edge_recon_loss: 763677.2194; val_gene_expr_recon_loss: 1206202.0319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1980756.2101; val_optim_loss: 1980756.2101
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9919; val_auprc_score: 0.9979; val_best_acc_score: 0.9869; val_best_f1_score: 0.9923; train_kl_reg_loss: 10904.6798; train_edge_recon_loss: 767024.2575; train_gene_expr_recon_loss: 1190701.2214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1968630.1578; train_optim_loss: 1968630.1578; val_kl_reg_loss: 10944.2988; val_edge_recon_loss: 765302.3138; val_gene_expr_recon_loss: 1212046.8378; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1988293.4468; val_optim_loss: 1988293.4468
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9915; val_auprc_score: 0.9973; val_best_acc_score: 0.9867; val_best_f1_score: 0.9922; train_kl_reg_loss: 10952.7900; train_edge_recon_loss: 764920.8276; train_gene_expr_recon_loss: 1189312.7907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1965186.4087; train_optim_loss: 1965186.4087; val_kl_reg_loss: 10901.8077; val_edge_recon_loss: 777438.6848; val_gene_expr_recon_loss: 1209024.5718; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1997365.0638; val_optim_loss: 1997365.0638
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9906; val_auprc_score: 0.9972; val_best_acc_score: 0.9862; val_best_f1_score: 0.9920; train_kl_reg_loss: 10958.5989; train_edge_recon_loss: 763548.3770; train_gene_expr_recon_loss: 1189964.3819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1964471.3551; train_optim_loss: 1964471.3551; val_kl_reg_loss: 11022.9653; val_edge_recon_loss: 760857.9415; val_gene_expr_recon_loss: 1211050.1117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1982931.0186; val_optim_loss: 1982931.0186
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9910; val_auprc_score: 0.9976; val_best_acc_score: 0.9870; val_best_f1_score: 0.9924; train_kl_reg_loss: 10952.4446; train_edge_recon_loss: 756000.0352; train_gene_expr_recon_loss: 1189089.0133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1956041.4943; train_optim_loss: 1956041.4943; val_kl_reg_loss: 11036.9369; val_edge_recon_loss: 762311.4628; val_gene_expr_recon_loss: 1206349.6303; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1979698.0160; val_optim_loss: 1979698.0160
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9916; val_auprc_score: 0.9975; val_best_acc_score: 0.9867; val_best_f1_score: 0.9922; train_kl_reg_loss: 10986.5508; train_edge_recon_loss: 766371.9111; train_gene_expr_recon_loss: 1189166.2527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1966524.7175; train_optim_loss: 1966524.7175; val_kl_reg_loss: 11064.3915; val_edge_recon_loss: 774924.4880; val_gene_expr_recon_loss: 1203522.7234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1989511.6037; val_optim_loss: 1989511.6037
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9919; val_auprc_score: 0.9976; val_best_acc_score: 0.9873; val_best_f1_score: 0.9926; train_kl_reg_loss: 10991.4996; train_edge_recon_loss: 760326.6200; train_gene_expr_recon_loss: 1188973.8554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1960291.9744; train_optim_loss: 1960291.9744; val_kl_reg_loss: 10999.4245; val_edge_recon_loss: 762584.0638; val_gene_expr_recon_loss: 1213563.7580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1987147.2473; val_optim_loss: 1987147.2473
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9926; val_auprc_score: 0.9982; val_best_acc_score: 0.9858; val_best_f1_score: 0.9917; train_kl_reg_loss: 10993.7371; train_edge_recon_loss: 764787.9467; train_gene_expr_recon_loss: 1188350.6214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1964132.3045; train_optim_loss: 1964132.3045; val_kl_reg_loss: 11019.1949; val_edge_recon_loss: 775648.0226; val_gene_expr_recon_loss: 1200875.6383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1987542.8750; val_optim_loss: 1987542.8750
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9924; val_auprc_score: 0.9976; val_best_acc_score: 0.9864; val_best_f1_score: 0.9921; train_kl_reg_loss: 11005.7331; train_edge_recon_loss: 766139.0761; train_gene_expr_recon_loss: 1187688.7852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1964833.5952; train_optim_loss: 1964833.5952; val_kl_reg_loss: 10956.0870; val_edge_recon_loss: 779003.1676; val_gene_expr_recon_loss: 1207782.9282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1997742.2021; val_optim_loss: 1997742.2021

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9920; val_auprc_score: 0.9980; val_best_acc_score: 0.9869; val_best_f1_score: 0.9923; train_kl_reg_loss: 10979.7085; train_edge_recon_loss: 763769.6679; train_gene_expr_recon_loss: 1186312.3410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1961061.7175; train_optim_loss: 1961061.7175; val_kl_reg_loss: 10998.2017; val_edge_recon_loss: 766007.9528; val_gene_expr_recon_loss: 1211233.1011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1988239.2500; val_optim_loss: 1988239.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9897; val_auprc_score: 0.9969; val_best_acc_score: 0.9859; val_best_f1_score: 0.9918; train_kl_reg_loss: 10972.3089; train_edge_recon_loss: 761691.4127; train_gene_expr_recon_loss: 1185607.5732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1958271.2946; train_optim_loss: 1958271.2946; val_kl_reg_loss: 10978.3251; val_edge_recon_loss: 768269.8737; val_gene_expr_recon_loss: 1203139.9654; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1982388.1622; val_optim_loss: 1982388.1622
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9907; val_auprc_score: 0.9975; val_best_acc_score: 0.9869; val_best_f1_score: 0.9924; train_kl_reg_loss: 10963.9491; train_edge_recon_loss: 763725.7069; train_gene_expr_recon_loss: 1184921.4880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1959611.1461; train_optim_loss: 1959611.1461; val_kl_reg_loss: 10998.8399; val_edge_recon_loss: 749393.1383; val_gene_expr_recon_loss: 1210021.4096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1970413.3883; val_optim_loss: 1970413.3883
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9908; val_auprc_score: 0.9972; val_best_acc_score: 0.9869; val_best_f1_score: 0.9924; train_kl_reg_loss: 10974.1652; train_edge_recon_loss: 761308.4819; train_gene_expr_recon_loss: 1184956.7169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1957239.3675; train_optim_loss: 1957239.3675; val_kl_reg_loss: 10989.2870; val_edge_recon_loss: 748525.1915; val_gene_expr_recon_loss: 1199786.0279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1959300.5239; val_optim_loss: 1959300.5239
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9915; val_auprc_score: 0.9975; val_best_acc_score: 0.9863; val_best_f1_score: 0.9920; train_kl_reg_loss: 10976.0395; train_edge_recon_loss: 763431.2693; train_gene_expr_recon_loss: 1186461.0024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1960868.3123; train_optim_loss: 1960868.3123; val_kl_reg_loss: 10994.1154; val_edge_recon_loss: 771785.7766; val_gene_expr_recon_loss: 1209623.6915; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1992403.5851; val_optim_loss: 1992403.5851
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9906; val_auprc_score: 0.9971; val_best_acc_score: 0.9868; val_best_f1_score: 0.9923; train_kl_reg_loss: 10964.1051; train_edge_recon_loss: 767384.7619; train_gene_expr_recon_loss: 1185532.3392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1963881.2063; train_optim_loss: 1963881.2063; val_kl_reg_loss: 11001.1209; val_edge_recon_loss: 762902.5811; val_gene_expr_recon_loss: 1203833.9973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1977737.6888; val_optim_loss: 1977737.6888
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9936; val_auprc_score: 0.9983; val_best_acc_score: 0.9867; val_best_f1_score: 0.9923; train_kl_reg_loss: 10979.8522; train_edge_recon_loss: 755169.2041; train_gene_expr_recon_loss: 1186180.8009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1952329.8560; train_optim_loss: 1952329.8560; val_kl_reg_loss: 10989.8021; val_edge_recon_loss: 733857.3444; val_gene_expr_recon_loss: 1205034.9495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1949882.0931; val_optim_loss: 1949882.0931
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9914; val_auprc_score: 0.9968; val_best_acc_score: 0.9861; val_best_f1_score: 0.9919; train_kl_reg_loss: 10984.9955; train_edge_recon_loss: 764965.1389; train_gene_expr_recon_loss: 1185228.8175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1961178.9503; train_optim_loss: 1961178.9503; val_kl_reg_loss: 10989.4959; val_edge_recon_loss: 777209.7114; val_gene_expr_recon_loss: 1208804.3537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1997003.5585; val_optim_loss: 1997003.5585
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9887; val_auprc_score: 0.9963; val_best_acc_score: 0.9852; val_best_f1_score: 0.9914; train_kl_reg_loss: 10959.8988; train_edge_recon_loss: 765516.8752; train_gene_expr_recon_loss: 1184887.0729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1961363.8431; train_optim_loss: 1961363.8431; val_kl_reg_loss: 10948.7845; val_edge_recon_loss: 760127.6263; val_gene_expr_recon_loss: 1204577.3777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1975653.7872; val_optim_loss: 1975653.7872
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9921; val_auprc_score: 0.9981; val_best_acc_score: 0.9866; val_best_f1_score: 0.9922; train_kl_reg_loss: 10964.2681; train_edge_recon_loss: 761568.6373; train_gene_expr_recon_loss: 1185533.1271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1958066.0304; train_optim_loss: 1958066.0304; val_kl_reg_loss: 10998.5881; val_edge_recon_loss: 770217.7154; val_gene_expr_recon_loss: 1213245.2886; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1994461.6011; val_optim_loss: 1994461.6011
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9909; val_auprc_score: 0.9976; val_best_acc_score: 0.9863; val_best_f1_score: 0.9920; train_kl_reg_loss: 10988.7926; train_edge_recon_loss: 761259.6893; train_gene_expr_recon_loss: 1185965.5208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1958214.0084; train_optim_loss: 1958214.0084; val_kl_reg_loss: 11014.7437; val_edge_recon_loss: 771370.3777; val_gene_expr_recon_loss: 1204499.0133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1986884.1356; val_optim_loss: 1986884.1356

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9906; val_auprc_score: 0.9972; val_best_acc_score: 0.9863; val_best_f1_score: 0.9920; train_kl_reg_loss: 10992.4936; train_edge_recon_loss: 764265.9602; train_gene_expr_recon_loss: 1185618.0283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1960876.4831; train_optim_loss: 1960876.4831; val_kl_reg_loss: 11010.1562; val_edge_recon_loss: 749499.3604; val_gene_expr_recon_loss: 1204933.4734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1965442.9973; val_optim_loss: 1965442.9973
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9912; val_auprc_score: 0.9973; val_best_acc_score: 0.9871; val_best_f1_score: 0.9925; train_kl_reg_loss: 10991.0435; train_edge_recon_loss: 764117.5030; train_gene_expr_recon_loss: 1185542.5690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1960651.1178; train_optim_loss: 1960651.1178; val_kl_reg_loss: 11021.1293; val_edge_recon_loss: 749310.6662; val_gene_expr_recon_loss: 1210044.5399; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1970376.3298; val_optim_loss: 1970376.3298
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9924; val_auprc_score: 0.9980; val_best_acc_score: 0.9864; val_best_f1_score: 0.9920; train_kl_reg_loss: 10985.5003; train_edge_recon_loss: 757383.1324; train_gene_expr_recon_loss: 1184775.6976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1953144.3292; train_optim_loss: 1953144.3292; val_kl_reg_loss: 10994.5684; val_edge_recon_loss: 767518.9455; val_gene_expr_recon_loss: 1208392.1170; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1986905.6463; val_optim_loss: 1986905.6463
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9903; val_auprc_score: 0.9969; val_best_acc_score: 0.9866; val_best_f1_score: 0.9922; train_kl_reg_loss: 10983.8539; train_edge_recon_loss: 757576.3813; train_gene_expr_recon_loss: 1185514.8729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1954075.1123; train_optim_loss: 1954075.1123; val_kl_reg_loss: 10982.1500; val_edge_recon_loss: 759968.7793; val_gene_expr_recon_loss: 1209773.2952; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1980724.2207; val_optim_loss: 1980724.2207

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 162 min 44 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.9916
val AUPRC score: 0.9973
val best accuracy score: 0.9874
val best F1 score: 0.9926
val target rna MSE score: 0.7139
val source rna MSE score: 0.1658
Val cat covariate0 mean sim diff: -0.0004
Duration of model training in run 7: 2 hours, 43 minutes and 22 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 159885
Number of validation edges: 17764
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9522; val_auprc_score: 0.9898; val_best_acc_score: 0.9325; val_best_f1_score: 0.9612; train_kl_reg_loss: 9385.4806; train_edge_recon_loss: 890468.7375; train_gene_expr_recon_loss: 1908153.2875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2808007.5120; train_optim_loss: 2808007.5120; val_kl_reg_loss: 10467.7599; val_edge_recon_loss: 825673.9161; val_gene_expr_recon_loss: 1776830.1500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2612971.8000; val_optim_loss: 2612971.8000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9736; val_auprc_score: 0.9929; val_best_acc_score: 0.9604; val_best_f1_score: 0.9770; train_kl_reg_loss: 10966.2872; train_edge_recon_loss: 796075.8091; train_gene_expr_recon_loss: 1721434.7360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2528476.8355; train_optim_loss: 2528476.8355; val_kl_reg_loss: 10637.2962; val_edge_recon_loss: 796392.7696; val_gene_expr_recon_loss: 1670925.2536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2477955.3143; val_optim_loss: 2477955.3143
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9789; val_auprc_score: 0.9943; val_best_acc_score: 0.9702; val_best_f1_score: 0.9827; train_kl_reg_loss: 10412.8975; train_edge_recon_loss: 786888.3876; train_gene_expr_recon_loss: 1643554.0184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2440855.2931; train_optim_loss: 2440855.2931; val_kl_reg_loss: 10345.7616; val_edge_recon_loss: 779341.7161; val_gene_expr_recon_loss: 1611355.1321; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2401042.6143; val_optim_loss: 2401042.6143
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9810; val_auprc_score: 0.9953; val_best_acc_score: 0.9727; val_best_f1_score: 0.9841; train_kl_reg_loss: 10100.7139; train_edge_recon_loss: 775430.5599; train_gene_expr_recon_loss: 1589294.3047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2374825.5847; train_optim_loss: 2374825.5847; val_kl_reg_loss: 9967.3439; val_edge_recon_loss: 781775.3500; val_gene_expr_recon_loss: 1558553.8286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2350296.5143; val_optim_loss: 2350296.5143
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9823; val_auprc_score: 0.9951; val_best_acc_score: 0.9757; val_best_f1_score: 0.9859; train_kl_reg_loss: 9765.6635; train_edge_recon_loss: 769975.8860; train_gene_expr_recon_loss: 1540240.5966; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2319982.1490; train_optim_loss: 2319982.1490; val_kl_reg_loss: 9519.9849; val_edge_recon_loss: 781746.0679; val_gene_expr_recon_loss: 1518144.6893; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2309410.7429; val_optim_loss: 2309410.7429
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9855; val_auprc_score: 0.9959; val_best_acc_score: 0.9798; val_best_f1_score: 0.9882; train_kl_reg_loss: 9479.5656; train_edge_recon_loss: 774710.0867; train_gene_expr_recon_loss: 1492198.0296; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2276387.6777; train_optim_loss: 2276387.6777; val_kl_reg_loss: 9557.8645; val_edge_recon_loss: 767659.5911; val_gene_expr_recon_loss: 1468354.3250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2245571.7786; val_optim_loss: 2245571.7786
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9874; val_auprc_score: 0.9962; val_best_acc_score: 0.9821; val_best_f1_score: 0.9896; train_kl_reg_loss: 9600.5381; train_edge_recon_loss: 766321.9573; train_gene_expr_recon_loss: 1449316.2224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2225238.7153; train_optim_loss: 2225238.7153; val_kl_reg_loss: 9738.9735; val_edge_recon_loss: 748379.2393; val_gene_expr_recon_loss: 1428840.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2186958.8321; val_optim_loss: 2186958.8321
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9886; val_auprc_score: 0.9970; val_best_acc_score: 0.9812; val_best_f1_score: 0.9891; train_kl_reg_loss: 9621.2918; train_edge_recon_loss: 759791.5531; train_gene_expr_recon_loss: 1410600.8263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2180013.6733; train_optim_loss: 2180013.6733; val_kl_reg_loss: 9852.4130; val_edge_recon_loss: 767951.7607; val_gene_expr_recon_loss: 1392575.8500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2170380.0000; val_optim_loss: 2170380.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9880; val_auprc_score: 0.9968; val_best_acc_score: 0.9825; val_best_f1_score: 0.9898; train_kl_reg_loss: 9848.2892; train_edge_recon_loss: 765646.9968; train_gene_expr_recon_loss: 1379548.3279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2155043.6142; train_optim_loss: 2155043.6142; val_kl_reg_loss: 10001.5246; val_edge_recon_loss: 757185.8214; val_gene_expr_recon_loss: 1365730.0714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2132917.4107; val_optim_loss: 2132917.4107
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9876; val_auprc_score: 0.9970; val_best_acc_score: 0.9822; val_best_f1_score: 0.9896; train_kl_reg_loss: 9974.7847; train_edge_recon_loss: 772506.7718; train_gene_expr_recon_loss: 1352800.2208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2135281.7796; train_optim_loss: 2135281.7796; val_kl_reg_loss: 10081.9059; val_edge_recon_loss: 764437.7875; val_gene_expr_recon_loss: 1341942.1893; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2116461.8857; val_optim_loss: 2116461.8857
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9893; val_auprc_score: 0.9965; val_best_acc_score: 0.9822; val_best_f1_score: 0.9896; train_kl_reg_loss: 10143.1468; train_edge_recon_loss: 768926.5767; train_gene_expr_recon_loss: 1329218.5587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2108288.2823; train_optim_loss: 2108288.2823; val_kl_reg_loss: 10283.4698; val_edge_recon_loss: 772619.8464; val_gene_expr_recon_loss: 1319969.2821; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2102872.5893; val_optim_loss: 2102872.5893
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9882; val_auprc_score: 0.9966; val_best_acc_score: 0.9817; val_best_f1_score: 0.9894; train_kl_reg_loss: 10225.3495; train_edge_recon_loss: 767740.7320; train_gene_expr_recon_loss: 1311384.0982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2089350.1833; train_optim_loss: 2089350.1833; val_kl_reg_loss: 10485.4501; val_edge_recon_loss: 765701.1607; val_gene_expr_recon_loss: 1305320.5179; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2081507.1321; val_optim_loss: 2081507.1321
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9881; val_auprc_score: 0.9964; val_best_acc_score: 0.9833; val_best_f1_score: 0.9903; train_kl_reg_loss: 10338.8513; train_edge_recon_loss: 767928.3902; train_gene_expr_recon_loss: 1296884.3063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2075151.5471; train_optim_loss: 2075151.5471; val_kl_reg_loss: 10491.5803; val_edge_recon_loss: 761708.3982; val_gene_expr_recon_loss: 1296729.4786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2068929.4643; val_optim_loss: 2068929.4643
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9874; val_auprc_score: 0.9957; val_best_acc_score: 0.9815; val_best_f1_score: 0.9892; train_kl_reg_loss: 10506.0659; train_edge_recon_loss: 771083.6320; train_gene_expr_recon_loss: 1281781.3470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2063371.0519; train_optim_loss: 2063371.0519; val_kl_reg_loss: 10516.6287; val_edge_recon_loss: 788170.7518; val_gene_expr_recon_loss: 1277861.0357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2076548.4393; val_optim_loss: 2076548.4393
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9878; val_auprc_score: 0.9962; val_best_acc_score: 0.9840; val_best_f1_score: 0.9907; train_kl_reg_loss: 10596.0284; train_edge_recon_loss: 771516.9962; train_gene_expr_recon_loss: 1270208.1589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2052321.1801; train_optim_loss: 2052321.1801; val_kl_reg_loss: 10651.4295; val_edge_recon_loss: 760329.6089; val_gene_expr_recon_loss: 1274975.6536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2045956.6750; val_optim_loss: 2045956.6750
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9890; val_auprc_score: 0.9973; val_best_acc_score: 0.9818; val_best_f1_score: 0.9894; train_kl_reg_loss: 10618.5265; train_edge_recon_loss: 767012.2348; train_gene_expr_recon_loss: 1261804.3530; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2039435.1118; train_optim_loss: 2039435.1118; val_kl_reg_loss: 10934.2277; val_edge_recon_loss: 770076.8500; val_gene_expr_recon_loss: 1263404.3393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2044415.4036; val_optim_loss: 2044415.4036
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9893; val_auprc_score: 0.9969; val_best_acc_score: 0.9836; val_best_f1_score: 0.9905; train_kl_reg_loss: 10691.3698; train_edge_recon_loss: 769891.0020; train_gene_expr_recon_loss: 1252440.3554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2033022.7304; train_optim_loss: 2033022.7304; val_kl_reg_loss: 10641.8245; val_edge_recon_loss: 763071.7339; val_gene_expr_recon_loss: 1255369.7321; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2029083.2821; val_optim_loss: 2029083.2821
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9908; val_auprc_score: 0.9976; val_best_acc_score: 0.9826; val_best_f1_score: 0.9899; train_kl_reg_loss: 10701.1335; train_edge_recon_loss: 768932.3698; train_gene_expr_recon_loss: 1245926.1082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2025559.6118; train_optim_loss: 2025559.6118; val_kl_reg_loss: 10999.2855; val_edge_recon_loss: 776446.2018; val_gene_expr_recon_loss: 1252298.0393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2039743.5250; val_optim_loss: 2039743.5250
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9873; val_auprc_score: 0.9963; val_best_acc_score: 0.9826; val_best_f1_score: 0.9899; train_kl_reg_loss: 10718.8781; train_edge_recon_loss: 769905.9195; train_gene_expr_recon_loss: 1238964.6018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2019589.3990; train_optim_loss: 2019589.3990; val_kl_reg_loss: 10835.7974; val_edge_recon_loss: 767724.2696; val_gene_expr_recon_loss: 1244211.6857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2022771.7429; val_optim_loss: 2022771.7429
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9890; val_auprc_score: 0.9965; val_best_acc_score: 0.9852; val_best_f1_score: 0.9914; train_kl_reg_loss: 10849.3657; train_edge_recon_loss: 759534.4455; train_gene_expr_recon_loss: 1231131.0044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2001514.8147; train_optim_loss: 2001514.8147; val_kl_reg_loss: 10752.1831; val_edge_recon_loss: 763844.2571; val_gene_expr_recon_loss: 1235983.1321; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2010579.5750; val_optim_loss: 2010579.5750
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9902; val_auprc_score: 0.9970; val_best_acc_score: 0.9833; val_best_f1_score: 0.9902; train_kl_reg_loss: 10833.0353; train_edge_recon_loss: 774721.1050; train_gene_expr_recon_loss: 1228666.6637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2014220.8055; train_optim_loss: 2014220.8055; val_kl_reg_loss: 10840.3546; val_edge_recon_loss: 774394.3946; val_gene_expr_recon_loss: 1230673.8071; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2015908.5643; val_optim_loss: 2015908.5643
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9892; val_auprc_score: 0.9965; val_best_acc_score: 0.9852; val_best_f1_score: 0.9914; train_kl_reg_loss: 10871.3228; train_edge_recon_loss: 759705.4790; train_gene_expr_recon_loss: 1223908.8243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1994485.6274; train_optim_loss: 1994485.6274; val_kl_reg_loss: 10873.2201; val_edge_recon_loss: 763527.0929; val_gene_expr_recon_loss: 1226951.7464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2001352.0571; val_optim_loss: 2001352.0571
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9900; val_auprc_score: 0.9969; val_best_acc_score: 0.9838; val_best_f1_score: 0.9905; train_kl_reg_loss: 10888.5296; train_edge_recon_loss: 763268.5937; train_gene_expr_recon_loss: 1218518.5671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1992675.6921; train_optim_loss: 1992675.6921; val_kl_reg_loss: 10795.2931; val_edge_recon_loss: 775958.9786; val_gene_expr_recon_loss: 1222972.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2009726.5250; val_optim_loss: 2009726.5250
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9922; val_auprc_score: 0.9983; val_best_acc_score: 0.9852; val_best_f1_score: 0.9913; train_kl_reg_loss: 10877.3528; train_edge_recon_loss: 766104.0270; train_gene_expr_recon_loss: 1215130.3502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1992111.7300; train_optim_loss: 1992111.7300; val_kl_reg_loss: 10928.9609; val_edge_recon_loss: 764891.9393; val_gene_expr_recon_loss: 1230947.8393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2006768.7571; val_optim_loss: 2006768.7571
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9912; val_auprc_score: 0.9978; val_best_acc_score: 0.9851; val_best_f1_score: 0.9913; train_kl_reg_loss: 10955.7723; train_edge_recon_loss: 771337.8243; train_gene_expr_recon_loss: 1214006.5767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1996300.1733; train_optim_loss: 1996300.1733; val_kl_reg_loss: 11306.6171; val_edge_recon_loss: 777602.6946; val_gene_expr_recon_loss: 1223772.8607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2012682.1750; val_optim_loss: 2012682.1750
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9880; val_auprc_score: 0.9967; val_best_acc_score: 0.9841; val_best_f1_score: 0.9907; train_kl_reg_loss: 11001.9877; train_edge_recon_loss: 763497.3143; train_gene_expr_recon_loss: 1210902.8027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1985402.1094; train_optim_loss: 1985402.1094; val_kl_reg_loss: 10957.5793; val_edge_recon_loss: 746625.5036; val_gene_expr_recon_loss: 1218786.5893; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1976369.6571; val_optim_loss: 1976369.6571
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9886; val_auprc_score: 0.9966; val_best_acc_score: 0.9839; val_best_f1_score: 0.9906; train_kl_reg_loss: 10910.3258; train_edge_recon_loss: 761808.2049; train_gene_expr_recon_loss: 1207571.2320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1980289.7656; train_optim_loss: 1980289.7656; val_kl_reg_loss: 10924.4842; val_edge_recon_loss: 769044.5339; val_gene_expr_recon_loss: 1213122.9786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1993092.0000; val_optim_loss: 1993092.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9881; val_auprc_score: 0.9967; val_best_acc_score: 0.9843; val_best_f1_score: 0.9908; train_kl_reg_loss: 10923.9121; train_edge_recon_loss: 766355.1965; train_gene_expr_recon_loss: 1205456.9449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1982736.0555; train_optim_loss: 1982736.0555; val_kl_reg_loss: 10906.6515; val_edge_recon_loss: 763138.1161; val_gene_expr_recon_loss: 1215731.8107; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1989776.5964; val_optim_loss: 1989776.5964
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9898; val_auprc_score: 0.9968; val_best_acc_score: 0.9856; val_best_f1_score: 0.9916; train_kl_reg_loss: 10981.3138; train_edge_recon_loss: 766157.6474; train_gene_expr_recon_loss: 1203864.4141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1981003.3806; train_optim_loss: 1981003.3806; val_kl_reg_loss: 11004.1739; val_edge_recon_loss: 753869.5196; val_gene_expr_recon_loss: 1211244.3214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1976118.0071; val_optim_loss: 1976118.0071
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9865; val_auprc_score: 0.9960; val_best_acc_score: 0.9842; val_best_f1_score: 0.9908; train_kl_reg_loss: 10937.2683; train_edge_recon_loss: 767893.1821; train_gene_expr_recon_loss: 1203659.9858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1982490.4417; train_optim_loss: 1982490.4417; val_kl_reg_loss: 10903.8592; val_edge_recon_loss: 770778.3679; val_gene_expr_recon_loss: 1229236.9786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2010919.2000; val_optim_loss: 2010919.2000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9895; val_auprc_score: 0.9970; val_best_acc_score: 0.9840; val_best_f1_score: 0.9906; train_kl_reg_loss: 11069.3170; train_edge_recon_loss: 765091.1258; train_gene_expr_recon_loss: 1203523.0459; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1979683.4852; train_optim_loss: 1979683.4852; val_kl_reg_loss: 11330.7352; val_edge_recon_loss: 772256.2982; val_gene_expr_recon_loss: 1213705.9357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1997292.9857; val_optim_loss: 1997292.9857
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9908; val_auprc_score: 0.9978; val_best_acc_score: 0.9853; val_best_f1_score: 0.9914; train_kl_reg_loss: 11077.4699; train_edge_recon_loss: 762611.5244; train_gene_expr_recon_loss: 1199626.1094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1973315.1082; train_optim_loss: 1973315.1082; val_kl_reg_loss: 11036.2297; val_edge_recon_loss: 759000.6625; val_gene_expr_recon_loss: 1212918.5607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1982955.4750; val_optim_loss: 1982955.4750
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9906; val_auprc_score: 0.9975; val_best_acc_score: 0.9862; val_best_f1_score: 0.9920; train_kl_reg_loss: 10989.0238; train_edge_recon_loss: 767194.5156; train_gene_expr_recon_loss: 1197406.7169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1975590.2512; train_optim_loss: 1975590.2512; val_kl_reg_loss: 11166.0899; val_edge_recon_loss: 754132.1964; val_gene_expr_recon_loss: 1205237.2429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1970535.5286; val_optim_loss: 1970535.5286
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9912; val_auprc_score: 0.9980; val_best_acc_score: 0.9858; val_best_f1_score: 0.9917; train_kl_reg_loss: 10998.9777; train_edge_recon_loss: 763182.5529; train_gene_expr_recon_loss: 1195788.5144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1969970.0459; train_optim_loss: 1969970.0459; val_kl_reg_loss: 10935.7024; val_edge_recon_loss: 760332.5821; val_gene_expr_recon_loss: 1208504.3286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1979772.6107; val_optim_loss: 1979772.6107
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9913; val_auprc_score: 0.9976; val_best_acc_score: 0.9852; val_best_f1_score: 0.9913; train_kl_reg_loss: 11066.9320; train_edge_recon_loss: 768947.2137; train_gene_expr_recon_loss: 1195462.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1975477.1398; train_optim_loss: 1975477.1398; val_kl_reg_loss: 11105.3992; val_edge_recon_loss: 784566.2232; val_gene_expr_recon_loss: 1207025.1714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2002696.7893; val_optim_loss: 2002696.7893
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9904; val_auprc_score: 0.9962; val_best_acc_score: 0.9849; val_best_f1_score: 0.9912; train_kl_reg_loss: 11045.0600; train_edge_recon_loss: 772751.1066; train_gene_expr_recon_loss: 1193295.0607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1977091.2268; train_optim_loss: 1977091.2268; val_kl_reg_loss: 11039.5125; val_edge_recon_loss: 770648.0143; val_gene_expr_recon_loss: 1206958.6393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1988646.1821; val_optim_loss: 1988646.1821
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9875; val_auprc_score: 0.9964; val_best_acc_score: 0.9853; val_best_f1_score: 0.9914; train_kl_reg_loss: 11105.4585; train_edge_recon_loss: 763219.9002; train_gene_expr_recon_loss: 1196630.9944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1970956.3514; train_optim_loss: 1970956.3514; val_kl_reg_loss: 11154.5447; val_edge_recon_loss: 781532.1357; val_gene_expr_recon_loss: 1206057.4429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1998744.1321; val_optim_loss: 1998744.1321

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9917; val_auprc_score: 0.9977; val_best_acc_score: 0.9860; val_best_f1_score: 0.9919; train_kl_reg_loss: 11019.8750; train_edge_recon_loss: 762494.6849; train_gene_expr_recon_loss: 1183767.8486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1957282.4058; train_optim_loss: 1957282.4058; val_kl_reg_loss: 11072.0846; val_edge_recon_loss: 740488.5411; val_gene_expr_recon_loss: 1192720.6321; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1944281.2786; val_optim_loss: 1944281.2786
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9915; val_auprc_score: 0.9978; val_best_acc_score: 0.9854; val_best_f1_score: 0.9915; train_kl_reg_loss: 10988.1040; train_edge_recon_loss: 763941.0421; train_gene_expr_recon_loss: 1181389.3151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1956318.4633; train_optim_loss: 1956318.4633; val_kl_reg_loss: 10956.1013; val_edge_recon_loss: 753550.0786; val_gene_expr_recon_loss: 1194966.7357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1959472.9143; val_optim_loss: 1959472.9143
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9906; val_auprc_score: 0.9968; val_best_acc_score: 0.9866; val_best_f1_score: 0.9921; train_kl_reg_loss: 10990.5924; train_edge_recon_loss: 767524.7310; train_gene_expr_recon_loss: 1180218.9812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1958734.3107; train_optim_loss: 1958734.3107; val_kl_reg_loss: 11029.5063; val_edge_recon_loss: 768489.9054; val_gene_expr_recon_loss: 1194581.5429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1974100.9571; val_optim_loss: 1974100.9571
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9909; val_auprc_score: 0.9977; val_best_acc_score: 0.9850; val_best_f1_score: 0.9912; train_kl_reg_loss: 11027.8576; train_edge_recon_loss: 763511.2092; train_gene_expr_recon_loss: 1179797.2113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1954336.2819; train_optim_loss: 1954336.2819; val_kl_reg_loss: 11039.4614; val_edge_recon_loss: 781882.0321; val_gene_expr_recon_loss: 1195184.6464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1988106.1357; val_optim_loss: 1988106.1357
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9916; val_auprc_score: 0.9978; val_best_acc_score: 0.9857; val_best_f1_score: 0.9917; train_kl_reg_loss: 11039.3631; train_edge_recon_loss: 758939.8063; train_gene_expr_recon_loss: 1179441.6294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1949420.8027; train_optim_loss: 1949420.8027; val_kl_reg_loss: 11064.7032; val_edge_recon_loss: 756876.9518; val_gene_expr_recon_loss: 1192616.9429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1960558.5929; val_optim_loss: 1960558.5929

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9912; val_auprc_score: 0.9973; val_best_acc_score: 0.9859; val_best_f1_score: 0.9917; train_kl_reg_loss: 11032.4036; train_edge_recon_loss: 761369.0457; train_gene_expr_recon_loss: 1177843.9621; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1950245.4141; train_optim_loss: 1950245.4141; val_kl_reg_loss: 11035.8974; val_edge_recon_loss: 786668.5625; val_gene_expr_recon_loss: 1188804.0857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1986508.5321; val_optim_loss: 1986508.5321
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9908; val_auprc_score: 0.9977; val_best_acc_score: 0.9853; val_best_f1_score: 0.9914; train_kl_reg_loss: 11022.9818; train_edge_recon_loss: 765552.4726; train_gene_expr_recon_loss: 1179205.6306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1955781.0835; train_optim_loss: 1955781.0835; val_kl_reg_loss: 11019.3760; val_edge_recon_loss: 761469.5143; val_gene_expr_recon_loss: 1196564.6893; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1969053.5679; val_optim_loss: 1969053.5679
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9892; val_auprc_score: 0.9970; val_best_acc_score: 0.9841; val_best_f1_score: 0.9908; train_kl_reg_loss: 11018.0765; train_edge_recon_loss: 764209.1322; train_gene_expr_recon_loss: 1178324.0236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1953551.2336; train_optim_loss: 1953551.2336; val_kl_reg_loss: 11013.0343; val_edge_recon_loss: 766261.6911; val_gene_expr_recon_loss: 1192992.5857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1970267.3143; val_optim_loss: 1970267.3143
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9898; val_auprc_score: 0.9965; val_best_acc_score: 0.9852; val_best_f1_score: 0.9913; train_kl_reg_loss: 11020.9555; train_edge_recon_loss: 756431.0741; train_gene_expr_recon_loss: 1177760.2161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1945212.2480; train_optim_loss: 1945212.2480; val_kl_reg_loss: 11028.7294; val_edge_recon_loss: 783940.1107; val_gene_expr_recon_loss: 1189183.1429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1984151.9893; val_optim_loss: 1984151.9893

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 89 min 24 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
val AUROC score: 0.9906
val AUPRC score: 0.9975
val best accuracy score: 0.9847
val best F1 score: 0.9910
val target rna MSE score: 0.8708
val source rna MSE score: 0.1782
Val cat covariate0 mean sim diff: -0.0004
Duration of model training in run 6: 1 hours, 29 minutes and 51 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 159885
Number of validation edges: 17764
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9504; val_auprc_score: 0.9880; val_best_acc_score: 0.9367; val_best_f1_score: 0.9634; train_kl_reg_loss: 8995.6298; train_edge_recon_loss: 879890.7300; train_gene_expr_recon_loss: 1916810.7256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2805697.0775; train_optim_loss: 2805697.0775; val_kl_reg_loss: 10979.0390; val_edge_recon_loss: 830356.2000; val_gene_expr_recon_loss: 1779106.5429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2620441.7786; val_optim_loss: 2620441.7786
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9767; val_auprc_score: 0.9944; val_best_acc_score: 0.9614; val_best_f1_score: 0.9777; train_kl_reg_loss: 10728.1294; train_edge_recon_loss: 797128.0345; train_gene_expr_recon_loss: 1723739.9441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2531596.1014; train_optim_loss: 2531596.1014; val_kl_reg_loss: 10568.5351; val_edge_recon_loss: 781134.3893; val_gene_expr_recon_loss: 1679458.2036; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2471161.1214; val_optim_loss: 2471161.1214
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9779; val_auprc_score: 0.9948; val_best_acc_score: 0.9687; val_best_f1_score: 0.9818; train_kl_reg_loss: 10478.2882; train_edge_recon_loss: 777969.0347; train_gene_expr_recon_loss: 1643504.6338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2431951.9569; train_optim_loss: 2431951.9569; val_kl_reg_loss: 10351.2552; val_edge_recon_loss: 789041.4482; val_gene_expr_recon_loss: 1615322.8786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2414715.5714; val_optim_loss: 2414715.5714
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9859; val_auprc_score: 0.9969; val_best_acc_score: 0.9756; val_best_f1_score: 0.9858; train_kl_reg_loss: 10149.7196; train_edge_recon_loss: 771338.0164; train_gene_expr_recon_loss: 1582057.5491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2363545.2859; train_optim_loss: 2363545.2859; val_kl_reg_loss: 10290.7758; val_edge_recon_loss: 779137.6143; val_gene_expr_recon_loss: 1559464.0214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2348892.4071; val_optim_loss: 2348892.4071
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9843; val_auprc_score: 0.9958; val_best_acc_score: 0.9770; val_best_f1_score: 0.9866; train_kl_reg_loss: 9862.1214; train_edge_recon_loss: 773361.4016; train_gene_expr_recon_loss: 1530809.0503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2314032.5735; train_optim_loss: 2314032.5735; val_kl_reg_loss: 9651.0662; val_edge_recon_loss: 775050.1625; val_gene_expr_recon_loss: 1507836.4786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2292537.7071; val_optim_loss: 2292537.7071
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9863; val_auprc_score: 0.9962; val_best_acc_score: 0.9789; val_best_f1_score: 0.9877; train_kl_reg_loss: 9516.3168; train_edge_recon_loss: 773423.6773; train_gene_expr_recon_loss: 1482692.7823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2265632.7792; train_optim_loss: 2265632.7792; val_kl_reg_loss: 9461.2080; val_edge_recon_loss: 772062.1857; val_gene_expr_recon_loss: 1462605.3393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2244128.7179; val_optim_loss: 2244128.7179
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9864; val_auprc_score: 0.9958; val_best_acc_score: 0.9802; val_best_f1_score: 0.9885; train_kl_reg_loss: 9537.5319; train_edge_recon_loss: 764566.7041; train_gene_expr_recon_loss: 1443046.2484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2217150.4796; train_optim_loss: 2217150.4796; val_kl_reg_loss: 9556.9454; val_edge_recon_loss: 749949.3571; val_gene_expr_recon_loss: 1429268.1571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2188774.4536; val_optim_loss: 2188774.4536
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9865; val_auprc_score: 0.9962; val_best_acc_score: 0.9794; val_best_f1_score: 0.9881; train_kl_reg_loss: 9694.1723; train_edge_recon_loss: 769695.5102; train_gene_expr_recon_loss: 1405907.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2185297.1354; train_optim_loss: 2185297.1354; val_kl_reg_loss: 10007.7799; val_edge_recon_loss: 771110.2661; val_gene_expr_recon_loss: 1401675.7250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2182793.7536; val_optim_loss: 2182793.7536
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9877; val_auprc_score: 0.9968; val_best_acc_score: 0.9810; val_best_f1_score: 0.9889; train_kl_reg_loss: 9860.3421; train_edge_recon_loss: 774585.9918; train_gene_expr_recon_loss: 1375954.6002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2160400.9357; train_optim_loss: 2160400.9357; val_kl_reg_loss: 10007.2735; val_edge_recon_loss: 778548.6089; val_gene_expr_recon_loss: 1372799.4036; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2161355.2786; val_optim_loss: 2161355.2786
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9892; val_auprc_score: 0.9973; val_best_acc_score: 0.9808; val_best_f1_score: 0.9888; train_kl_reg_loss: 9970.8783; train_edge_recon_loss: 763586.0988; train_gene_expr_recon_loss: 1350504.8111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2124061.7863; train_optim_loss: 2124061.7863; val_kl_reg_loss: 10208.7370; val_edge_recon_loss: 767319.9286; val_gene_expr_recon_loss: 1344494.2571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2122022.9429; val_optim_loss: 2122022.9429
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9874; val_auprc_score: 0.9966; val_best_acc_score: 0.9829; val_best_f1_score: 0.9901; train_kl_reg_loss: 10073.7240; train_edge_recon_loss: 767793.9042; train_gene_expr_recon_loss: 1327850.5363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2105718.1653; train_optim_loss: 2105718.1653; val_kl_reg_loss: 10107.3910; val_edge_recon_loss: 762214.9661; val_gene_expr_recon_loss: 1324814.7679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2097137.1357; val_optim_loss: 2097137.1357
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9881; val_auprc_score: 0.9970; val_best_acc_score: 0.9835; val_best_f1_score: 0.9904; train_kl_reg_loss: 10300.9363; train_edge_recon_loss: 769339.1957; train_gene_expr_recon_loss: 1310126.3466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2089766.4812; train_optim_loss: 2089766.4812; val_kl_reg_loss: 10417.9539; val_edge_recon_loss: 757577.4464; val_gene_expr_recon_loss: 1309663.4500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2077658.8429; val_optim_loss: 2077658.8429
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9897; val_auprc_score: 0.9975; val_best_acc_score: 0.9818; val_best_f1_score: 0.9894; train_kl_reg_loss: 10370.9558; train_edge_recon_loss: 761803.3286; train_gene_expr_recon_loss: 1293888.1178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2066062.4026; train_optim_loss: 2066062.4026; val_kl_reg_loss: 10299.6747; val_edge_recon_loss: 773035.8411; val_gene_expr_recon_loss: 1297164.2571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2080499.7786; val_optim_loss: 2080499.7786
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9880; val_auprc_score: 0.9959; val_best_acc_score: 0.9833; val_best_f1_score: 0.9903; train_kl_reg_loss: 10436.4210; train_edge_recon_loss: 766001.6593; train_gene_expr_recon_loss: 1282304.9321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2058743.0116; train_optim_loss: 2058743.0116; val_kl_reg_loss: 10437.5259; val_edge_recon_loss: 770870.4214; val_gene_expr_recon_loss: 1290539.2179; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2071847.1643; val_optim_loss: 2071847.1643
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9869; val_auprc_score: 0.9959; val_best_acc_score: 0.9821; val_best_f1_score: 0.9896; train_kl_reg_loss: 10535.6522; train_edge_recon_loss: 767900.3233; train_gene_expr_recon_loss: 1271771.5607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2050207.5387; train_optim_loss: 2050207.5387; val_kl_reg_loss: 10611.5604; val_edge_recon_loss: 773769.5946; val_gene_expr_recon_loss: 1273990.3429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2058371.5036; val_optim_loss: 2058371.5036
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9883; val_auprc_score: 0.9970; val_best_acc_score: 0.9819; val_best_f1_score: 0.9895; train_kl_reg_loss: 10627.3991; train_edge_recon_loss: 766892.0296; train_gene_expr_recon_loss: 1259114.2432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2036633.6701; train_optim_loss: 2036633.6701; val_kl_reg_loss: 10744.1049; val_edge_recon_loss: 762293.4268; val_gene_expr_recon_loss: 1264786.2429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2037823.7964; val_optim_loss: 2037823.7964
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9885; val_auprc_score: 0.9966; val_best_acc_score: 0.9820; val_best_f1_score: 0.9895; train_kl_reg_loss: 10641.7965; train_edge_recon_loss: 767951.2728; train_gene_expr_recon_loss: 1252565.2955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2031158.3650; train_optim_loss: 2031158.3650; val_kl_reg_loss: 10606.5593; val_edge_recon_loss: 792091.2929; val_gene_expr_recon_loss: 1256017.7107; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2058715.5607; val_optim_loss: 2058715.5607
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9910; val_auprc_score: 0.9975; val_best_acc_score: 0.9841; val_best_f1_score: 0.9908; train_kl_reg_loss: 10710.5742; train_edge_recon_loss: 764431.5292; train_gene_expr_recon_loss: 1244082.1470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2019224.2520; train_optim_loss: 2019224.2520; val_kl_reg_loss: 10737.1600; val_edge_recon_loss: 768413.6893; val_gene_expr_recon_loss: 1253654.1143; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2032804.9714; val_optim_loss: 2032804.9714
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9881; val_auprc_score: 0.9966; val_best_acc_score: 0.9838; val_best_f1_score: 0.9906; train_kl_reg_loss: 10719.4574; train_edge_recon_loss: 761224.0745; train_gene_expr_recon_loss: 1236381.1082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2008324.6442; train_optim_loss: 2008324.6442; val_kl_reg_loss: 10720.0470; val_edge_recon_loss: 766067.9179; val_gene_expr_recon_loss: 1242216.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2019004.3393; val_optim_loss: 2019004.3393
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9911; val_auprc_score: 0.9979; val_best_acc_score: 0.9845; val_best_f1_score: 0.9909; train_kl_reg_loss: 10715.7911; train_edge_recon_loss: 768880.0102; train_gene_expr_recon_loss: 1233592.8411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2013188.6390; train_optim_loss: 2013188.6390; val_kl_reg_loss: 10576.4141; val_edge_recon_loss: 778878.7393; val_gene_expr_recon_loss: 1240265.1821; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2029720.3393; val_optim_loss: 2029720.3393
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9907; val_auprc_score: 0.9976; val_best_acc_score: 0.9839; val_best_f1_score: 0.9906; train_kl_reg_loss: 10711.8339; train_edge_recon_loss: 766272.5479; train_gene_expr_recon_loss: 1230981.0459; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2007965.4321; train_optim_loss: 2007965.4321; val_kl_reg_loss: 10764.9828; val_edge_recon_loss: 779627.9125; val_gene_expr_recon_loss: 1237947.4786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2028340.3679; val_optim_loss: 2028340.3679
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9911; val_auprc_score: 0.9979; val_best_acc_score: 0.9837; val_best_f1_score: 0.9905; train_kl_reg_loss: 10779.7520; train_edge_recon_loss: 772590.0921; train_gene_expr_recon_loss: 1226035.8351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2009405.6797; train_optim_loss: 2009405.6797; val_kl_reg_loss: 10698.2156; val_edge_recon_loss: 786674.2911; val_gene_expr_recon_loss: 1234275.0786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2031647.5893; val_optim_loss: 2031647.5893
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9907; val_auprc_score: 0.9978; val_best_acc_score: 0.9863; val_best_f1_score: 0.9920; train_kl_reg_loss: 10754.4564; train_edge_recon_loss: 760810.7450; train_gene_expr_recon_loss: 1221961.8043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1993527.0048; train_optim_loss: 1993527.0048; val_kl_reg_loss: 10721.9382; val_edge_recon_loss: 756830.5893; val_gene_expr_recon_loss: 1227523.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1995075.7321; val_optim_loss: 1995075.7321
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9891; val_auprc_score: 0.9972; val_best_acc_score: 0.9839; val_best_f1_score: 0.9906; train_kl_reg_loss: 10767.2295; train_edge_recon_loss: 762888.9657; train_gene_expr_recon_loss: 1218983.1801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1992639.3682; train_optim_loss: 1992639.3682; val_kl_reg_loss: 11024.9014; val_edge_recon_loss: 780137.0446; val_gene_expr_recon_loss: 1226364.5286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2017526.4679; val_optim_loss: 2017526.4679
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9910; val_auprc_score: 0.9979; val_best_acc_score: 0.9860; val_best_f1_score: 0.9919; train_kl_reg_loss: 10781.3448; train_edge_recon_loss: 764387.5004; train_gene_expr_recon_loss: 1214728.6681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1989897.5120; train_optim_loss: 1989897.5120; val_kl_reg_loss: 10948.5949; val_edge_recon_loss: 750624.0232; val_gene_expr_recon_loss: 1222261.4107; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1983834.0393; val_optim_loss: 1983834.0393
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9894; val_auprc_score: 0.9967; val_best_acc_score: 0.9851; val_best_f1_score: 0.9913; train_kl_reg_loss: 10836.2153; train_edge_recon_loss: 769175.9269; train_gene_expr_recon_loss: 1211346.1721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1991358.3123; train_optim_loss: 1991358.3123; val_kl_reg_loss: 10874.0704; val_edge_recon_loss: 771421.9821; val_gene_expr_recon_loss: 1224205.5107; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2006501.5607; val_optim_loss: 2006501.5607
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9908; val_auprc_score: 0.9975; val_best_acc_score: 0.9857; val_best_f1_score: 0.9917; train_kl_reg_loss: 10867.4480; train_edge_recon_loss: 772425.1092; train_gene_expr_recon_loss: 1208269.5527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1991562.1078; train_optim_loss: 1991562.1078; val_kl_reg_loss: 10711.9524; val_edge_recon_loss: 766720.7964; val_gene_expr_recon_loss: 1216434.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1993866.9464; val_optim_loss: 1993866.9464
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9900; val_auprc_score: 0.9967; val_best_acc_score: 0.9833; val_best_f1_score: 0.9902; train_kl_reg_loss: 10862.8455; train_edge_recon_loss: 767891.3742; train_gene_expr_recon_loss: 1206265.8107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1985020.0296; train_optim_loss: 1985020.0296; val_kl_reg_loss: 10956.7351; val_edge_recon_loss: 787657.6357; val_gene_expr_recon_loss: 1216968.5893; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2015582.9643; val_optim_loss: 2015582.9643
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9902; val_auprc_score: 0.9976; val_best_acc_score: 0.9856; val_best_f1_score: 0.9916; train_kl_reg_loss: 10839.0143; train_edge_recon_loss: 760641.4832; train_gene_expr_recon_loss: 1206174.8211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1977655.3179; train_optim_loss: 1977655.3179; val_kl_reg_loss: 11013.4275; val_edge_recon_loss: 772106.6054; val_gene_expr_recon_loss: 1225236.1929; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2008356.2429; val_optim_loss: 2008356.2429

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9917; val_auprc_score: 0.9975; val_best_acc_score: 0.9850; val_best_f1_score: 0.9913; train_kl_reg_loss: 10814.3500; train_edge_recon_loss: 770863.1811; train_gene_expr_recon_loss: 1195144.8854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1976822.4205; train_optim_loss: 1976822.4205; val_kl_reg_loss: 10859.8819; val_edge_recon_loss: 762157.8393; val_gene_expr_recon_loss: 1209841.8643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1982859.5786; val_optim_loss: 1982859.5786
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9911; val_auprc_score: 0.9971; val_best_acc_score: 0.9855; val_best_f1_score: 0.9916; train_kl_reg_loss: 10779.5488; train_edge_recon_loss: 761723.7580; train_gene_expr_recon_loss: 1193569.4633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1966072.7736; train_optim_loss: 1966072.7736; val_kl_reg_loss: 10844.4458; val_edge_recon_loss: 752774.3411; val_gene_expr_recon_loss: 1207273.6536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1970892.4286; val_optim_loss: 1970892.4286
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9909; val_auprc_score: 0.9979; val_best_acc_score: 0.9858; val_best_f1_score: 0.9918; train_kl_reg_loss: 10821.6245; train_edge_recon_loss: 761402.9930; train_gene_expr_recon_loss: 1193203.1689; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1965427.7879; train_optim_loss: 1965427.7879; val_kl_reg_loss: 10823.7726; val_edge_recon_loss: 750124.6661; val_gene_expr_recon_loss: 1207747.1107; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1968695.5500; val_optim_loss: 1968695.5500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9919; val_auprc_score: 0.9981; val_best_acc_score: 0.9867; val_best_f1_score: 0.9923; train_kl_reg_loss: 10853.0671; train_edge_recon_loss: 762251.6665; train_gene_expr_recon_loss: 1190992.1809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1964096.9145; train_optim_loss: 1964096.9145; val_kl_reg_loss: 10884.0246; val_edge_recon_loss: 743093.0268; val_gene_expr_recon_loss: 1205921.8143; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1959898.8607; val_optim_loss: 1959898.8607
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9913; val_auprc_score: 0.9979; val_best_acc_score: 0.9856; val_best_f1_score: 0.9916; train_kl_reg_loss: 10842.0370; train_edge_recon_loss: 761379.6504; train_gene_expr_recon_loss: 1190407.9541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1962629.6366; train_optim_loss: 1962629.6366; val_kl_reg_loss: 10923.2236; val_edge_recon_loss: 766693.4179; val_gene_expr_recon_loss: 1209095.2036; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1986711.8429; val_optim_loss: 1986711.8429
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9893; val_auprc_score: 0.9966; val_best_acc_score: 0.9846; val_best_f1_score: 0.9910; train_kl_reg_loss: 10880.4186; train_edge_recon_loss: 764943.7496; train_gene_expr_recon_loss: 1190417.9601; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1966242.1318; train_optim_loss: 1966242.1318; val_kl_reg_loss: 10896.8997; val_edge_recon_loss: 763695.8214; val_gene_expr_recon_loss: 1207952.9643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1982545.6750; val_optim_loss: 1982545.6750
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9909; val_auprc_score: 0.9977; val_best_acc_score: 0.9857; val_best_f1_score: 0.9917; train_kl_reg_loss: 10903.7718; train_edge_recon_loss: 766827.3932; train_gene_expr_recon_loss: 1191071.7943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1968802.9601; train_optim_loss: 1968802.9601; val_kl_reg_loss: 10911.6232; val_edge_recon_loss: 778668.9357; val_gene_expr_recon_loss: 1204605.5714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1994186.1143; val_optim_loss: 1994186.1143
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9907; val_auprc_score: 0.9972; val_best_acc_score: 0.9859; val_best_f1_score: 0.9917; train_kl_reg_loss: 10923.3186; train_edge_recon_loss: 759640.7187; train_gene_expr_recon_loss: 1188715.3710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1959279.4113; train_optim_loss: 1959279.4113; val_kl_reg_loss: 10982.8129; val_edge_recon_loss: 792038.0750; val_gene_expr_recon_loss: 1205320.1643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2008341.0464; val_optim_loss: 2008341.0464

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9917; val_auprc_score: 0.9977; val_best_acc_score: 0.9853; val_best_f1_score: 0.9915; train_kl_reg_loss: 10932.5765; train_edge_recon_loss: 761130.9024; train_gene_expr_recon_loss: 1189557.1078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1961620.5847; train_optim_loss: 1961620.5847; val_kl_reg_loss: 10943.1440; val_edge_recon_loss: 755024.6607; val_gene_expr_recon_loss: 1206231.0750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1972198.8857; val_optim_loss: 1972198.8857
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9908; val_auprc_score: 0.9979; val_best_acc_score: 0.9851; val_best_f1_score: 0.9913; train_kl_reg_loss: 10907.2020; train_edge_recon_loss: 760804.2103; train_gene_expr_recon_loss: 1187742.2600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1959453.6713; train_optim_loss: 1959453.6713; val_kl_reg_loss: 10928.9216; val_edge_recon_loss: 765975.1929; val_gene_expr_recon_loss: 1207701.6786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1984605.7964; val_optim_loss: 1984605.7964
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9893; val_auprc_score: 0.9974; val_best_acc_score: 0.9854; val_best_f1_score: 0.9915; train_kl_reg_loss: 10900.5196; train_edge_recon_loss: 766665.3796; train_gene_expr_recon_loss: 1188337.6338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1965903.5331; train_optim_loss: 1965903.5331; val_kl_reg_loss: 10915.4215; val_edge_recon_loss: 769849.8286; val_gene_expr_recon_loss: 1204578.2607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1985343.5179; val_optim_loss: 1985343.5179
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9914; val_auprc_score: 0.9975; val_best_acc_score: 0.9868; val_best_f1_score: 0.9923; train_kl_reg_loss: 10903.0964; train_edge_recon_loss: 767584.2881; train_gene_expr_recon_loss: 1187895.2324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1966382.6162; train_optim_loss: 1966382.6162; val_kl_reg_loss: 10920.8402; val_edge_recon_loss: 761427.7196; val_gene_expr_recon_loss: 1205410.9107; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1977759.4750; val_optim_loss: 1977759.4750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 78 min 3 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
val AUROC score: 0.9914
val AUPRC score: 0.9980
val best accuracy score: 0.9858
val best F1 score: 0.9917
val target rna MSE score: 0.7131
val source rna MSE score: 0.1818
Val cat covariate0 mean sim diff: 0.0021
Duration of model training in run 5: 1 hours, 18 minutes and 30 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 107073
Number of validation edges: 11897
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9154; val_auprc_score: 0.9822; val_best_acc_score: 0.9152; val_best_f1_score: 0.9517; train_kl_reg_loss: 8369.8252; train_edge_recon_loss: 916865.4423; train_gene_expr_recon_loss: 1921344.6464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2846579.9119; train_optim_loss: 2846579.9119; val_kl_reg_loss: 11991.7629; val_edge_recon_loss: 827751.0911; val_gene_expr_recon_loss: 1792289.6042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2632032.4583; val_optim_loss: 2632032.4583
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9594; val_auprc_score: 0.9916; val_best_acc_score: 0.9458; val_best_f1_score: 0.9686; train_kl_reg_loss: 11492.3171; train_edge_recon_loss: 816611.7628; train_gene_expr_recon_loss: 1749169.5470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2577273.6214; train_optim_loss: 2577273.6214; val_kl_reg_loss: 11128.8381; val_edge_recon_loss: 788864.1250; val_gene_expr_recon_loss: 1708211.4740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2508204.4167; val_optim_loss: 2508204.4167
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9685; val_auprc_score: 0.9924; val_best_acc_score: 0.9597; val_best_f1_score: 0.9766; train_kl_reg_loss: 10758.2714; train_edge_recon_loss: 792975.8676; train_gene_expr_recon_loss: 1683555.9161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2487290.0583; train_optim_loss: 2487290.0583; val_kl_reg_loss: 10502.8540; val_edge_recon_loss: 776572.8229; val_gene_expr_recon_loss: 1651707.6823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2438783.3542; val_optim_loss: 2438783.3542
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9763; val_auprc_score: 0.9941; val_best_acc_score: 0.9660; val_best_f1_score: 0.9803; train_kl_reg_loss: 9942.1637; train_edge_recon_loss: 789812.7756; train_gene_expr_recon_loss: 1634768.8720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2434523.8131; train_optim_loss: 2434523.8131; val_kl_reg_loss: 9548.9919; val_edge_recon_loss: 777689.9349; val_gene_expr_recon_loss: 1607491.2604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2394730.2083; val_optim_loss: 2394730.2083
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9836; val_auprc_score: 0.9953; val_best_acc_score: 0.9726; val_best_f1_score: 0.9840; train_kl_reg_loss: 9615.7177; train_edge_recon_loss: 772838.4506; train_gene_expr_recon_loss: 1596645.1036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2379099.2655; train_optim_loss: 2379099.2655; val_kl_reg_loss: 9581.4051; val_edge_recon_loss: 779597.3385; val_gene_expr_recon_loss: 1575262.4427; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2364441.1771; val_optim_loss: 2364441.1771
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9841; val_auprc_score: 0.9964; val_best_acc_score: 0.9760; val_best_f1_score: 0.9860; train_kl_reg_loss: 9413.9413; train_edge_recon_loss: 774583.5911; train_gene_expr_recon_loss: 1559814.4095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2343811.9440; train_optim_loss: 2343811.9440; val_kl_reg_loss: 9153.8905; val_edge_recon_loss: 771919.9453; val_gene_expr_recon_loss: 1540668.3490; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2321742.1562; val_optim_loss: 2321742.1562
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9830; val_auprc_score: 0.9957; val_best_acc_score: 0.9761; val_best_f1_score: 0.9862; train_kl_reg_loss: 9414.1903; train_edge_recon_loss: 777763.8744; train_gene_expr_recon_loss: 1526931.4619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2314109.5250; train_optim_loss: 2314109.5250; val_kl_reg_loss: 9342.3964; val_edge_recon_loss: 753718.2904; val_gene_expr_recon_loss: 1501792.8646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2264853.5312; val_optim_loss: 2264853.5312
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9881; val_auprc_score: 0.9971; val_best_acc_score: 0.9799; val_best_f1_score: 0.9883; train_kl_reg_loss: 9210.8348; train_edge_recon_loss: 776542.1146; train_gene_expr_recon_loss: 1489536.9220; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2275289.8732; train_optim_loss: 2275289.8732; val_kl_reg_loss: 9048.5295; val_edge_recon_loss: 773181.7839; val_gene_expr_recon_loss: 1470981.3802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2253211.6927; val_optim_loss: 2253211.6927
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9892; val_auprc_score: 0.9977; val_best_acc_score: 0.9781; val_best_f1_score: 0.9872; train_kl_reg_loss: 9202.5265; train_edge_recon_loss: 767594.3345; train_gene_expr_recon_loss: 1459166.0917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2235962.9560; train_optim_loss: 2235962.9560; val_kl_reg_loss: 9353.3690; val_edge_recon_loss: 767058.7995; val_gene_expr_recon_loss: 1437596.0052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2214008.1979; val_optim_loss: 2214008.1979
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9861; val_auprc_score: 0.9966; val_best_acc_score: 0.9776; val_best_f1_score: 0.9869; train_kl_reg_loss: 9309.6199; train_edge_recon_loss: 772817.3357; train_gene_expr_recon_loss: 1426295.3369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2208422.2940; train_optim_loss: 2208422.2940; val_kl_reg_loss: 9337.2646; val_edge_recon_loss: 781754.5833; val_gene_expr_recon_loss: 1408991.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2200083.8177; val_optim_loss: 2200083.8177
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9870; val_auprc_score: 0.9965; val_best_acc_score: 0.9791; val_best_f1_score: 0.9878; train_kl_reg_loss: 9418.8258; train_edge_recon_loss: 773580.0211; train_gene_expr_recon_loss: 1402123.4929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2185122.3381; train_optim_loss: 2185122.3381; val_kl_reg_loss: 9884.3227; val_edge_recon_loss: 785652.8880; val_gene_expr_recon_loss: 1386158.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2181696.1250; val_optim_loss: 2181696.1250
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9851; val_auprc_score: 0.9963; val_best_acc_score: 0.9786; val_best_f1_score: 0.9876; train_kl_reg_loss: 9609.5982; train_edge_recon_loss: 780148.5595; train_gene_expr_recon_loss: 1380113.6810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2169871.8452; train_optim_loss: 2169871.8452; val_kl_reg_loss: 9624.3489; val_edge_recon_loss: 765304.2604; val_gene_expr_recon_loss: 1364823.7292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2139752.3281; val_optim_loss: 2139752.3281
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9882; val_auprc_score: 0.9967; val_best_acc_score: 0.9798; val_best_f1_score: 0.9882; train_kl_reg_loss: 9727.1001; train_edge_recon_loss: 773514.5929; train_gene_expr_recon_loss: 1361122.9482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2144364.6369; train_optim_loss: 2144364.6369; val_kl_reg_loss: 9760.7600; val_edge_recon_loss: 812556.0911; val_gene_expr_recon_loss: 1351868.6510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2174185.4896; val_optim_loss: 2174185.4896
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9877; val_auprc_score: 0.9963; val_best_acc_score: 0.9804; val_best_f1_score: 0.9886; train_kl_reg_loss: 9758.2622; train_edge_recon_loss: 764386.8640; train_gene_expr_recon_loss: 1341003.5798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2115148.7077; train_optim_loss: 2115148.7077; val_kl_reg_loss: 9657.6330; val_edge_recon_loss: 766030.7422; val_gene_expr_recon_loss: 1330257.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2105946.0521; val_optim_loss: 2105946.0521
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9879; val_auprc_score: 0.9960; val_best_acc_score: 0.9809; val_best_f1_score: 0.9888; train_kl_reg_loss: 9909.5999; train_edge_recon_loss: 769778.0940; train_gene_expr_recon_loss: 1326584.4958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2106272.1893; train_optim_loss: 2106272.1893; val_kl_reg_loss: 10022.7218; val_edge_recon_loss: 791695.5573; val_gene_expr_recon_loss: 1321315.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2123033.5781; val_optim_loss: 2123033.5781
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9914; val_auprc_score: 0.9980; val_best_acc_score: 0.9819; val_best_f1_score: 0.9894; train_kl_reg_loss: 10038.3807; train_edge_recon_loss: 767916.7753; train_gene_expr_recon_loss: 1309707.8792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2087663.0327; train_optim_loss: 2087663.0327; val_kl_reg_loss: 10154.0780; val_edge_recon_loss: 773433.3151; val_gene_expr_recon_loss: 1305939.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2089526.5521; val_optim_loss: 2089526.5521
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9896; val_auprc_score: 0.9969; val_best_acc_score: 0.9826; val_best_f1_score: 0.9899; train_kl_reg_loss: 10147.7741; train_edge_recon_loss: 769198.2493; train_gene_expr_recon_loss: 1297968.0452; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2077314.0649; train_optim_loss: 2077314.0649; val_kl_reg_loss: 10364.1604; val_edge_recon_loss: 772524.4531; val_gene_expr_recon_loss: 1293699.8958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2076588.5156; val_optim_loss: 2076588.5156
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9897; val_auprc_score: 0.9973; val_best_acc_score: 0.9817; val_best_f1_score: 0.9893; train_kl_reg_loss: 10217.1618; train_edge_recon_loss: 771745.7568; train_gene_expr_recon_loss: 1286506.2810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2068469.1976; train_optim_loss: 2068469.1976; val_kl_reg_loss: 10262.3088; val_edge_recon_loss: 774686.5365; val_gene_expr_recon_loss: 1279564.7135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2064513.5625; val_optim_loss: 2064513.5625
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9895; val_auprc_score: 0.9976; val_best_acc_score: 0.9822; val_best_f1_score: 0.9896; train_kl_reg_loss: 10319.0524; train_edge_recon_loss: 769462.6259; train_gene_expr_recon_loss: 1276135.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2055917.2750; train_optim_loss: 2055917.2750; val_kl_reg_loss: 10420.5691; val_edge_recon_loss: 771127.8802; val_gene_expr_recon_loss: 1273643.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2055192.2552; val_optim_loss: 2055192.2552
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9870; val_auprc_score: 0.9968; val_best_acc_score: 0.9809; val_best_f1_score: 0.9888; train_kl_reg_loss: 10406.7044; train_edge_recon_loss: 768432.6518; train_gene_expr_recon_loss: 1268766.9845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2047606.3435; train_optim_loss: 2047606.3435; val_kl_reg_loss: 10561.6113; val_edge_recon_loss: 777689.9505; val_gene_expr_recon_loss: 1263987.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2052239.4896; val_optim_loss: 2052239.4896
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9891; val_auprc_score: 0.9976; val_best_acc_score: 0.9823; val_best_f1_score: 0.9897; train_kl_reg_loss: 10511.1999; train_edge_recon_loss: 763881.0851; train_gene_expr_recon_loss: 1259844.6190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2034236.9030; train_optim_loss: 2034236.9030; val_kl_reg_loss: 10454.0246; val_edge_recon_loss: 761429.0703; val_gene_expr_recon_loss: 1260035.1823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2031918.2760; val_optim_loss: 2031918.2760
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9910; val_auprc_score: 0.9976; val_best_acc_score: 0.9823; val_best_f1_score: 0.9896; train_kl_reg_loss: 10516.6581; train_edge_recon_loss: 757823.8762; train_gene_expr_recon_loss: 1253478.2375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2021818.7798; train_optim_loss: 2021818.7798; val_kl_reg_loss: 10520.6930; val_edge_recon_loss: 793447.0026; val_gene_expr_recon_loss: 1252574.3229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2056542.0208; val_optim_loss: 2056542.0208
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9891; val_auprc_score: 0.9956; val_best_acc_score: 0.9831; val_best_f1_score: 0.9901; train_kl_reg_loss: 10523.3878; train_edge_recon_loss: 765975.3740; train_gene_expr_recon_loss: 1247364.0387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2023862.7988; train_optim_loss: 2023862.7988; val_kl_reg_loss: 10424.2708; val_edge_recon_loss: 769125.9297; val_gene_expr_recon_loss: 1247687.0573; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2027237.2708; val_optim_loss: 2027237.2708
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9898; val_auprc_score: 0.9972; val_best_acc_score: 0.9823; val_best_f1_score: 0.9897; train_kl_reg_loss: 10558.4799; train_edge_recon_loss: 765889.6664; train_gene_expr_recon_loss: 1240839.5560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2017287.7065; train_optim_loss: 2017287.7065; val_kl_reg_loss: 10731.0114; val_edge_recon_loss: 759058.4323; val_gene_expr_recon_loss: 1241787.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2011576.8698; val_optim_loss: 2011576.8698
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9885; val_auprc_score: 0.9965; val_best_acc_score: 0.9820; val_best_f1_score: 0.9895; train_kl_reg_loss: 10559.1562; train_edge_recon_loss: 766623.5321; train_gene_expr_recon_loss: 1235839.7458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2013022.4333; train_optim_loss: 2013022.4333; val_kl_reg_loss: 10598.0344; val_edge_recon_loss: 769497.6536; val_gene_expr_recon_loss: 1238349.1979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2018444.8750; val_optim_loss: 2018444.8750
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9899; val_auprc_score: 0.9971; val_best_acc_score: 0.9838; val_best_f1_score: 0.9905; train_kl_reg_loss: 10652.9069; train_edge_recon_loss: 767117.4106; train_gene_expr_recon_loss: 1234091.8202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2011862.1405; train_optim_loss: 2011862.1405; val_kl_reg_loss: 10618.5679; val_edge_recon_loss: 771653.0599; val_gene_expr_recon_loss: 1232317.8229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2014589.4531; val_optim_loss: 2014589.4531
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9885; val_auprc_score: 0.9972; val_best_acc_score: 0.9811; val_best_f1_score: 0.9890; train_kl_reg_loss: 10724.7611; train_edge_recon_loss: 759189.5295; train_gene_expr_recon_loss: 1228642.1833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1998556.4774; train_optim_loss: 1998556.4774; val_kl_reg_loss: 10647.5084; val_edge_recon_loss: 797834.2057; val_gene_expr_recon_loss: 1230429.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2038911.5885; val_optim_loss: 2038911.5885
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9866; val_auprc_score: 0.9961; val_best_acc_score: 0.9819; val_best_f1_score: 0.9895; train_kl_reg_loss: 10738.3340; train_edge_recon_loss: 769578.4830; train_gene_expr_recon_loss: 1223644.2792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2003961.0952; train_optim_loss: 2003961.0952; val_kl_reg_loss: 10684.1034; val_edge_recon_loss: 776069.0990; val_gene_expr_recon_loss: 1233468.7708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2020221.9844; val_optim_loss: 2020221.9844

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9904; val_auprc_score: 0.9976; val_best_acc_score: 0.9849; val_best_f1_score: 0.9912; train_kl_reg_loss: 10612.9488; train_edge_recon_loss: 764103.0530; train_gene_expr_recon_loss: 1213353.3661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1988069.3667; train_optim_loss: 1988069.3667; val_kl_reg_loss: 10591.0916; val_edge_recon_loss: 759936.1562; val_gene_expr_recon_loss: 1223769.2240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1994296.4635; val_optim_loss: 1994296.4635
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9903; val_auprc_score: 0.9976; val_best_acc_score: 0.9826; val_best_f1_score: 0.9898; train_kl_reg_loss: 10637.8727; train_edge_recon_loss: 771378.0789; train_gene_expr_recon_loss: 1211601.6238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1993617.5744; train_optim_loss: 1993617.5744; val_kl_reg_loss: 10667.0399; val_edge_recon_loss: 763919.7786; val_gene_expr_recon_loss: 1216000.5052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1990587.3333; val_optim_loss: 1990587.3333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9902; val_auprc_score: 0.9973; val_best_acc_score: 0.9843; val_best_f1_score: 0.9909; train_kl_reg_loss: 10642.2781; train_edge_recon_loss: 774589.6042; train_gene_expr_recon_loss: 1211416.0821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1996647.9625; train_optim_loss: 1996647.9625; val_kl_reg_loss: 10630.2422; val_edge_recon_loss: 744466.2474; val_gene_expr_recon_loss: 1216673.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1971769.9948; val_optim_loss: 1971769.9948
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9896; val_auprc_score: 0.9968; val_best_acc_score: 0.9825; val_best_f1_score: 0.9898; train_kl_reg_loss: 10647.1495; train_edge_recon_loss: 768758.2682; train_gene_expr_recon_loss: 1212519.5030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1991924.9220; train_optim_loss: 1991924.9220; val_kl_reg_loss: 10614.6908; val_edge_recon_loss: 767582.6276; val_gene_expr_recon_loss: 1219663.5573; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1997860.8698; val_optim_loss: 1997860.8698
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9896; val_auprc_score: 0.9967; val_best_acc_score: 0.9832; val_best_f1_score: 0.9903; train_kl_reg_loss: 10656.8704; train_edge_recon_loss: 752270.9930; train_gene_expr_recon_loss: 1210172.4262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1973100.2893; train_optim_loss: 1973100.2893; val_kl_reg_loss: 10678.2876; val_edge_recon_loss: 762592.8802; val_gene_expr_recon_loss: 1217473.3177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1990744.4896; val_optim_loss: 1990744.4896
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9904; val_auprc_score: 0.9972; val_best_acc_score: 0.9830; val_best_f1_score: 0.9901; train_kl_reg_loss: 10677.4869; train_edge_recon_loss: 761590.1735; train_gene_expr_recon_loss: 1209419.1357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1981686.7964; train_optim_loss: 1981686.7964; val_kl_reg_loss: 10603.7863; val_edge_recon_loss: 759620.8438; val_gene_expr_recon_loss: 1217583.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1987808.2760; val_optim_loss: 1987808.2760
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9923; val_auprc_score: 0.9983; val_best_acc_score: 0.9844; val_best_f1_score: 0.9909; train_kl_reg_loss: 10679.3200; train_edge_recon_loss: 765455.6461; train_gene_expr_recon_loss: 1208998.5369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1985133.5018; train_optim_loss: 1985133.5018; val_kl_reg_loss: 10798.2426; val_edge_recon_loss: 758070.2474; val_gene_expr_recon_loss: 1218229.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1987097.6458; val_optim_loss: 1987097.6458

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9896; val_auprc_score: 0.9967; val_best_acc_score: 0.9823; val_best_f1_score: 0.9896; train_kl_reg_loss: 10734.5390; train_edge_recon_loss: 765516.9036; train_gene_expr_recon_loss: 1208116.1494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1984367.5923; train_optim_loss: 1984367.5923; val_kl_reg_loss: 10714.8447; val_edge_recon_loss: 797491.0729; val_gene_expr_recon_loss: 1218391.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2026597.4844; val_optim_loss: 2026597.4844
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9905; val_auprc_score: 0.9970; val_best_acc_score: 0.9841; val_best_f1_score: 0.9907; train_kl_reg_loss: 10691.0648; train_edge_recon_loss: 764537.8807; train_gene_expr_recon_loss: 1208128.8506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1983357.7964; train_optim_loss: 1983357.7964; val_kl_reg_loss: 10678.7274; val_edge_recon_loss: 777329.9974; val_gene_expr_recon_loss: 1210994.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1999002.8906; val_optim_loss: 1999002.8906
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9907; val_auprc_score: 0.9979; val_best_acc_score: 0.9820; val_best_f1_score: 0.9895; train_kl_reg_loss: 10672.2223; train_edge_recon_loss: 762486.1973; train_gene_expr_recon_loss: 1206680.3274; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1979838.7476; train_optim_loss: 1979838.7476; val_kl_reg_loss: 10665.8502; val_edge_recon_loss: 776118.0755; val_gene_expr_recon_loss: 1217542.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2004326.4271; val_optim_loss: 2004326.4271
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9900; val_auprc_score: 0.9974; val_best_acc_score: 0.9839; val_best_f1_score: 0.9906; train_kl_reg_loss: 10689.4881; train_edge_recon_loss: 764157.7890; train_gene_expr_recon_loss: 1207634.2071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1982481.4911; train_optim_loss: 1982481.4911; val_kl_reg_loss: 10682.5933; val_edge_recon_loss: 772302.1146; val_gene_expr_recon_loss: 1215814.3542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1998799.0521; val_optim_loss: 1998799.0521

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 14 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
val AUROC score: 0.9877
val AUPRC score: 0.9964
val best accuracy score: 0.9837
val best F1 score: 0.9905
val target rna MSE score: 0.7360
val source rna MSE score: 0.2119
Val cat covariate0 mean sim diff: 0.0007
Duration of model training in run 4: 0 hours, 38 minutes and 32 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 107073
Number of validation edges: 11897
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9119; val_auprc_score: 0.9802; val_best_acc_score: 0.9169; val_best_f1_score: 0.9528; train_kl_reg_loss: 8842.3914; train_edge_recon_loss: 906349.1621; train_gene_expr_recon_loss: 1930030.1815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2845221.7405; train_optim_loss: 2845221.7405; val_kl_reg_loss: 11971.1346; val_edge_recon_loss: 824569.6771; val_gene_expr_recon_loss: 1805367.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2641908.4583; val_optim_loss: 2641908.4583
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9579; val_auprc_score: 0.9895; val_best_acc_score: 0.9459; val_best_f1_score: 0.9685; train_kl_reg_loss: 11096.5827; train_edge_recon_loss: 815719.6399; train_gene_expr_recon_loss: 1741348.0399; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2568164.2726; train_optim_loss: 2568164.2726; val_kl_reg_loss: 10252.4881; val_edge_recon_loss: 814510.3255; val_gene_expr_recon_loss: 1718941.0052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2543703.8333; val_optim_loss: 2543703.8333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9786; val_auprc_score: 0.9952; val_best_acc_score: 0.9646; val_best_f1_score: 0.9793; train_kl_reg_loss: 10368.5904; train_edge_recon_loss: 791005.4437; train_gene_expr_recon_loss: 1671572.7423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2472946.7786; train_optim_loss: 2472946.7786; val_kl_reg_loss: 10470.6012; val_edge_recon_loss: 805427.4661; val_gene_expr_recon_loss: 1661667.6458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2477565.7188; val_optim_loss: 2477565.7188
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9840; val_auprc_score: 0.9966; val_best_acc_score: 0.9713; val_best_f1_score: 0.9833; train_kl_reg_loss: 10143.6186; train_edge_recon_loss: 778537.3241; train_gene_expr_recon_loss: 1622146.5536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2410827.4917; train_optim_loss: 2410827.4917; val_kl_reg_loss: 10128.9289; val_edge_recon_loss: 777081.2031; val_gene_expr_recon_loss: 1610499.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2397709.8542; val_optim_loss: 2397709.8542
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9823; val_auprc_score: 0.9960; val_best_acc_score: 0.9740; val_best_f1_score: 0.9850; train_kl_reg_loss: 9988.9404; train_edge_recon_loss: 771319.7926; train_gene_expr_recon_loss: 1580921.5524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2362230.2893; train_optim_loss: 2362230.2893; val_kl_reg_loss: 9814.3815; val_edge_recon_loss: 761686.1146; val_gene_expr_recon_loss: 1575368.5365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2346869.0417; val_optim_loss: 2346869.0417
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9865; val_auprc_score: 0.9970; val_best_acc_score: 0.9753; val_best_f1_score: 0.9855; train_kl_reg_loss: 9977.2033; train_edge_recon_loss: 777052.9479; train_gene_expr_recon_loss: 1542207.5429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2329237.7036; train_optim_loss: 2329237.7036; val_kl_reg_loss: 9767.3583; val_edge_recon_loss: 803764.1615; val_gene_expr_recon_loss: 1535113.7292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2348645.2500; val_optim_loss: 2348645.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9843; val_auprc_score: 0.9962; val_best_acc_score: 0.9771; val_best_f1_score: 0.9867; train_kl_reg_loss: 9980.8761; train_edge_recon_loss: 774406.2640; train_gene_expr_recon_loss: 1503182.4702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2287569.6107; train_optim_loss: 2287569.6107; val_kl_reg_loss: 10204.1016; val_edge_recon_loss: 762927.5286; val_gene_expr_recon_loss: 1504484.6823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2277616.3333; val_optim_loss: 2277616.3333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9871; val_auprc_score: 0.9969; val_best_acc_score: 0.9776; val_best_f1_score: 0.9869; train_kl_reg_loss: 9933.2703; train_edge_recon_loss: 776416.7363; train_gene_expr_recon_loss: 1468843.8613; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2255193.8726; train_optim_loss: 2255193.8726; val_kl_reg_loss: 10142.0605; val_edge_recon_loss: 796327.6094; val_gene_expr_recon_loss: 1475150.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2281619.7604; val_optim_loss: 2281619.7604
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9862; val_auprc_score: 0.9968; val_best_acc_score: 0.9778; val_best_f1_score: 0.9871; train_kl_reg_loss: 9950.2615; train_edge_recon_loss: 773201.6985; train_gene_expr_recon_loss: 1440098.1929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2223250.1643; train_optim_loss: 2223250.1643; val_kl_reg_loss: 10125.8669; val_edge_recon_loss: 761638.6380; val_gene_expr_recon_loss: 1439372.0208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2211136.5208; val_optim_loss: 2211136.5208
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9851; val_auprc_score: 0.9954; val_best_acc_score: 0.9784; val_best_f1_score: 0.9874; train_kl_reg_loss: 9876.4321; train_edge_recon_loss: 768945.1054; train_gene_expr_recon_loss: 1411638.9387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2190460.4643; train_optim_loss: 2190460.4643; val_kl_reg_loss: 9804.6601; val_edge_recon_loss: 797230.0859; val_gene_expr_recon_loss: 1415963.9479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2222998.6875; val_optim_loss: 2222998.6875
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9852; val_auprc_score: 0.9956; val_best_acc_score: 0.9786; val_best_f1_score: 0.9876; train_kl_reg_loss: 9836.7637; train_edge_recon_loss: 772228.0845; train_gene_expr_recon_loss: 1391527.9226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2173592.7685; train_optim_loss: 2173592.7685; val_kl_reg_loss: 10154.3949; val_edge_recon_loss: 755252.7552; val_gene_expr_recon_loss: 1391992.8229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2157399.9792; val_optim_loss: 2157399.9792
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9882; val_auprc_score: 0.9973; val_best_acc_score: 0.9806; val_best_f1_score: 0.9887; train_kl_reg_loss: 10015.5132; train_edge_recon_loss: 769877.8542; train_gene_expr_recon_loss: 1366764.0512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2146657.4208; train_optim_loss: 2146657.4208; val_kl_reg_loss: 9870.2745; val_edge_recon_loss: 759897.1484; val_gene_expr_recon_loss: 1374140.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2143907.4635; val_optim_loss: 2143907.4635
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9864; val_auprc_score: 0.9963; val_best_acc_score: 0.9812; val_best_f1_score: 0.9890; train_kl_reg_loss: 10052.3747; train_edge_recon_loss: 782314.7690; train_gene_expr_recon_loss: 1347326.9542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2139694.0952; train_optim_loss: 2139694.0952; val_kl_reg_loss: 10126.7405; val_edge_recon_loss: 772274.2812; val_gene_expr_recon_loss: 1353466.8646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2135867.8750; val_optim_loss: 2135867.8750
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9865; val_auprc_score: 0.9965; val_best_acc_score: 0.9807; val_best_f1_score: 0.9887; train_kl_reg_loss: 10246.0742; train_edge_recon_loss: 762765.8247; train_gene_expr_recon_loss: 1330307.1435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2103319.0405; train_optim_loss: 2103319.0405; val_kl_reg_loss: 10563.3324; val_edge_recon_loss: 783961.1693; val_gene_expr_recon_loss: 1344047.3698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2138571.8906; val_optim_loss: 2138571.8906
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9888; val_auprc_score: 0.9968; val_best_acc_score: 0.9818; val_best_f1_score: 0.9894; train_kl_reg_loss: 10319.8426; train_edge_recon_loss: 768562.5318; train_gene_expr_recon_loss: 1319500.4315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2098382.8065; train_optim_loss: 2098382.8065; val_kl_reg_loss: 10609.1602; val_edge_recon_loss: 757029.6823; val_gene_expr_recon_loss: 1332339.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2099978.2188; val_optim_loss: 2099978.2188
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9878; val_auprc_score: 0.9974; val_best_acc_score: 0.9815; val_best_f1_score: 0.9893; train_kl_reg_loss: 10400.2627; train_edge_recon_loss: 767183.4057; train_gene_expr_recon_loss: 1301871.1738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2079454.8393; train_optim_loss: 2079454.8393; val_kl_reg_loss: 10166.7395; val_edge_recon_loss: 756068.5182; val_gene_expr_recon_loss: 1309923.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2076159.0469; val_optim_loss: 2076159.0469
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9884; val_auprc_score: 0.9972; val_best_acc_score: 0.9828; val_best_f1_score: 0.9900; train_kl_reg_loss: 10427.6733; train_edge_recon_loss: 763241.1137; train_gene_expr_recon_loss: 1290257.1958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2063925.9851; train_optim_loss: 2063925.9851; val_kl_reg_loss: 10531.4006; val_edge_recon_loss: 761830.8490; val_gene_expr_recon_loss: 1304743.8854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2077106.1510; val_optim_loss: 2077106.1510
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9869; val_auprc_score: 0.9963; val_best_acc_score: 0.9798; val_best_f1_score: 0.9882; train_kl_reg_loss: 10501.1314; train_edge_recon_loss: 767876.0429; train_gene_expr_recon_loss: 1281738.2875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2060115.4643; train_optim_loss: 2060115.4643; val_kl_reg_loss: 10499.6524; val_edge_recon_loss: 774495.4219; val_gene_expr_recon_loss: 1295618.7396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2080613.8177; val_optim_loss: 2080613.8177
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9879; val_auprc_score: 0.9962; val_best_acc_score: 0.9818; val_best_f1_score: 0.9894; train_kl_reg_loss: 10533.5776; train_edge_recon_loss: 774238.8958; train_gene_expr_recon_loss: 1271613.5792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2056386.0530; train_optim_loss: 2056386.0530; val_kl_reg_loss: 10460.1549; val_edge_recon_loss: 791822.2422; val_gene_expr_recon_loss: 1285842.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2088124.8385; val_optim_loss: 2088124.8385
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9875; val_auprc_score: 0.9967; val_best_acc_score: 0.9822; val_best_f1_score: 0.9896; train_kl_reg_loss: 10593.5567; train_edge_recon_loss: 773150.1042; train_gene_expr_recon_loss: 1265043.0470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2048786.7167; train_optim_loss: 2048786.7167; val_kl_reg_loss: 11013.2266; val_edge_recon_loss: 786497.4297; val_gene_expr_recon_loss: 1279148.7865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2076659.4531; val_optim_loss: 2076659.4531

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9906; val_auprc_score: 0.9974; val_best_acc_score: 0.9833; val_best_f1_score: 0.9902; train_kl_reg_loss: 10619.2019; train_edge_recon_loss: 767093.4033; train_gene_expr_recon_loss: 1250711.7810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2028424.3893; train_optim_loss: 2028424.3893; val_kl_reg_loss: 10573.9454; val_edge_recon_loss: 784647.9271; val_gene_expr_recon_loss: 1272062.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2067284.3125; val_optim_loss: 2067284.3125
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9890; val_auprc_score: 0.9973; val_best_acc_score: 0.9831; val_best_f1_score: 0.9902; train_kl_reg_loss: 10591.0810; train_edge_recon_loss: 771745.8458; train_gene_expr_recon_loss: 1250087.6643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2032424.5988; train_optim_loss: 2032424.5988; val_kl_reg_loss: 10669.3052; val_edge_recon_loss: 762522.4661; val_gene_expr_recon_loss: 1271384.1927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2044575.9583; val_optim_loss: 2044575.9583
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9865; val_auprc_score: 0.9964; val_best_acc_score: 0.9819; val_best_f1_score: 0.9895; train_kl_reg_loss: 10586.3567; train_edge_recon_loss: 759538.6338; train_gene_expr_recon_loss: 1247782.2583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2017907.2560; train_optim_loss: 2017907.2560; val_kl_reg_loss: 10672.4193; val_edge_recon_loss: 754808.6745; val_gene_expr_recon_loss: 1269907.2552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2035388.3333; val_optim_loss: 2035388.3333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9904; val_auprc_score: 0.9979; val_best_acc_score: 0.9845; val_best_f1_score: 0.9910; train_kl_reg_loss: 10608.0493; train_edge_recon_loss: 763922.5048; train_gene_expr_recon_loss: 1247603.9661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2022134.5226; train_optim_loss: 2022134.5226; val_kl_reg_loss: 10647.3937; val_edge_recon_loss: 752453.1823; val_gene_expr_recon_loss: 1268682.3021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2031782.8750; val_optim_loss: 2031782.8750
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9882; val_auprc_score: 0.9971; val_best_acc_score: 0.9832; val_best_f1_score: 0.9902; train_kl_reg_loss: 10647.5571; train_edge_recon_loss: 762547.8568; train_gene_expr_recon_loss: 1247501.4863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2020696.9012; train_optim_loss: 2020696.9012; val_kl_reg_loss: 10658.8894; val_edge_recon_loss: 772484.3542; val_gene_expr_recon_loss: 1267861.7865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2051005.0104; val_optim_loss: 2051005.0104
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9914; val_auprc_score: 0.9977; val_best_acc_score: 0.9847; val_best_f1_score: 0.9910; train_kl_reg_loss: 10649.0714; train_edge_recon_loss: 769258.6661; train_gene_expr_recon_loss: 1244515.0387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2024422.7756; train_optim_loss: 2024422.7756; val_kl_reg_loss: 10701.3596; val_edge_recon_loss: 769112.3594; val_gene_expr_recon_loss: 1260712.0521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2040525.7760; val_optim_loss: 2040525.7760
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9889; val_auprc_score: 0.9968; val_best_acc_score: 0.9829; val_best_f1_score: 0.9900; train_kl_reg_loss: 10619.2281; train_edge_recon_loss: 772305.3521; train_gene_expr_recon_loss: 1243826.9381; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2026751.5202; train_optim_loss: 2026751.5202; val_kl_reg_loss: 10767.9198; val_edge_recon_loss: 777308.7422; val_gene_expr_recon_loss: 1264718.8490; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2052795.5208; val_optim_loss: 2052795.5208
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9867; val_auprc_score: 0.9962; val_best_acc_score: 0.9824; val_best_f1_score: 0.9898; train_kl_reg_loss: 10640.6682; train_edge_recon_loss: 768434.6961; train_gene_expr_recon_loss: 1243083.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2022158.7792; train_optim_loss: 2022158.7792; val_kl_reg_loss: 10693.1170; val_edge_recon_loss: 768898.0078; val_gene_expr_recon_loss: 1263829.6615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2043420.7865; val_optim_loss: 2043420.7865

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9903; val_auprc_score: 0.9979; val_best_acc_score: 0.9819; val_best_f1_score: 0.9895; train_kl_reg_loss: 10622.4698; train_edge_recon_loss: 767219.9979; train_gene_expr_recon_loss: 1241495.5238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2019337.9958; train_optim_loss: 2019337.9958; val_kl_reg_loss: 10670.5691; val_edge_recon_loss: 758055.0781; val_gene_expr_recon_loss: 1262127.0885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2030852.7240; val_optim_loss: 2030852.7240
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9892; val_auprc_score: 0.9974; val_best_acc_score: 0.9837; val_best_f1_score: 0.9905; train_kl_reg_loss: 10628.1464; train_edge_recon_loss: 771672.4015; train_gene_expr_recon_loss: 1241335.6571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2023636.2018; train_optim_loss: 2023636.2018; val_kl_reg_loss: 10673.5081; val_edge_recon_loss: 759442.7995; val_gene_expr_recon_loss: 1264187.0260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2034303.3385; val_optim_loss: 2034303.3385
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9898; val_auprc_score: 0.9966; val_best_acc_score: 0.9839; val_best_f1_score: 0.9906; train_kl_reg_loss: 10633.7372; train_edge_recon_loss: 762802.0997; train_gene_expr_recon_loss: 1241371.6131; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2014807.4464; train_optim_loss: 2014807.4464; val_kl_reg_loss: 10698.3365; val_edge_recon_loss: 768587.4714; val_gene_expr_recon_loss: 1262118.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2041404.4062; val_optim_loss: 2041404.4062
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9893; val_auprc_score: 0.9972; val_best_acc_score: 0.9842; val_best_f1_score: 0.9908; train_kl_reg_loss: 10630.6502; train_edge_recon_loss: 759832.2640; train_gene_expr_recon_loss: 1240226.2577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2010689.1667; train_optim_loss: 2010689.1667; val_kl_reg_loss: 10678.1684; val_edge_recon_loss: 742503.9036; val_gene_expr_recon_loss: 1266802.2552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2019984.3438; val_optim_loss: 2019984.3438
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9868; val_auprc_score: 0.9968; val_best_acc_score: 0.9829; val_best_f1_score: 0.9901; train_kl_reg_loss: 10629.9898; train_edge_recon_loss: 770095.9988; train_gene_expr_recon_loss: 1241723.4560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2022449.4393; train_optim_loss: 2022449.4393; val_kl_reg_loss: 10682.0144; val_edge_recon_loss: 759307.4531; val_gene_expr_recon_loss: 1260419.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2030408.9115; val_optim_loss: 2030408.9115
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9886; val_auprc_score: 0.9964; val_best_acc_score: 0.9837; val_best_f1_score: 0.9905; train_kl_reg_loss: 10654.8759; train_edge_recon_loss: 766602.1768; train_gene_expr_recon_loss: 1239766.5369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2017023.5887; train_optim_loss: 2017023.5887; val_kl_reg_loss: 10682.4243; val_edge_recon_loss: 756339.5677; val_gene_expr_recon_loss: 1264725.9010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2031747.8958; val_optim_loss: 2031747.8958
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9880; val_auprc_score: 0.9971; val_best_acc_score: 0.9815; val_best_f1_score: 0.9892; train_kl_reg_loss: 10632.4775; train_edge_recon_loss: 769003.5893; train_gene_expr_recon_loss: 1240661.6524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2020297.7155; train_optim_loss: 2020297.7155; val_kl_reg_loss: 10668.1831; val_edge_recon_loss: 791376.0312; val_gene_expr_recon_loss: 1263943.4792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2065987.7031; val_optim_loss: 2065987.7031
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9881; val_auprc_score: 0.9972; val_best_acc_score: 0.9825; val_best_f1_score: 0.9898; train_kl_reg_loss: 10631.5318; train_edge_recon_loss: 771766.3292; train_gene_expr_recon_loss: 1240889.0315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2023286.8976; train_optim_loss: 2023286.8976; val_kl_reg_loss: 10672.7852; val_edge_recon_loss: 770581.8984; val_gene_expr_recon_loss: 1261639.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2042894.2344; val_optim_loss: 2042894.2344

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9883; val_auprc_score: 0.9972; val_best_acc_score: 0.9833; val_best_f1_score: 0.9903; train_kl_reg_loss: 10616.8395; train_edge_recon_loss: 753175.0646; train_gene_expr_recon_loss: 1240552.8286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2004344.7333; train_optim_loss: 2004344.7333; val_kl_reg_loss: 10670.5157; val_edge_recon_loss: 759797.1432; val_gene_expr_recon_loss: 1260378.1354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2030845.7865; val_optim_loss: 2030845.7865
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9873; val_auprc_score: 0.9952; val_best_acc_score: 0.9825; val_best_f1_score: 0.9898; train_kl_reg_loss: 10629.4570; train_edge_recon_loss: 761304.4134; train_gene_expr_recon_loss: 1241671.8708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2013605.7464; train_optim_loss: 2013605.7464; val_kl_reg_loss: 10675.7270; val_edge_recon_loss: 780150.2031; val_gene_expr_recon_loss: 1262436.6510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2053262.5729; val_optim_loss: 2053262.5729
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9879; val_auprc_score: 0.9963; val_best_acc_score: 0.9832; val_best_f1_score: 0.9902; train_kl_reg_loss: 10630.1158; train_edge_recon_loss: 774206.8054; train_gene_expr_recon_loss: 1239850.6893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2024687.6113; train_optim_loss: 2024687.6113; val_kl_reg_loss: 10688.9040; val_edge_recon_loss: 788064.8542; val_gene_expr_recon_loss: 1262523.4271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2061277.1875; val_optim_loss: 2061277.1875
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9895; val_auprc_score: 0.9964; val_best_acc_score: 0.9828; val_best_f1_score: 0.9899; train_kl_reg_loss: 10633.1837; train_edge_recon_loss: 761987.7289; train_gene_expr_recon_loss: 1240737.8762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2013358.7893; train_optim_loss: 2013358.7893; val_kl_reg_loss: 10682.5045; val_edge_recon_loss: 804226.5469; val_gene_expr_recon_loss: 1261297.9271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2076206.9583; val_optim_loss: 2076206.9583

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 39 min 26 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
val AUROC score: 0.9866
val AUPRC score: 0.9964
val best accuracy score: 0.9837
val best F1 score: 0.9906
val target rna MSE score: 0.8908
val source rna MSE score: 0.2253
Val cat covariate0 mean sim diff: -0.0009
Duration of model training in run 3: 0 hours, 39 minutes and 44 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 54907
Number of validation edges: 6100
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8790; val_auprc_score: 0.9720; val_best_acc_score: 0.9091; val_best_f1_score: 0.9480; train_kl_reg_loss: 4348.3657; train_edge_recon_loss: 956008.7841; train_gene_expr_recon_loss: 2020086.9699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2980444.1296; train_optim_loss: 2980444.1296; val_kl_reg_loss: 13186.2469; val_edge_recon_loss: 808856.0885; val_gene_expr_recon_loss: 1871721.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2693764.1250; val_optim_loss: 2693764.1250
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9109; val_auprc_score: 0.9794; val_best_acc_score: 0.9165; val_best_f1_score: 0.9528; train_kl_reg_loss: 13650.9598; train_edge_recon_loss: 848502.8594; train_gene_expr_recon_loss: 1808221.8194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2670375.6505; train_optim_loss: 2670375.6505; val_kl_reg_loss: 13165.6984; val_edge_recon_loss: 834551.0000; val_gene_expr_recon_loss: 1768349.4896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2616066.2292; val_optim_loss: 2616066.2292
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9430; val_auprc_score: 0.9873; val_best_acc_score: 0.9303; val_best_f1_score: 0.9599; train_kl_reg_loss: 12525.4026; train_edge_recon_loss: 823009.0475; train_gene_expr_recon_loss: 1736878.8495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2572413.3079; train_optim_loss: 2572413.3079; val_kl_reg_loss: 11611.7624; val_edge_recon_loss: 788511.4010; val_gene_expr_recon_loss: 1706105.1042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2506228.3125; val_optim_loss: 2506228.3125
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9555; val_auprc_score: 0.9910; val_best_acc_score: 0.9444; val_best_f1_score: 0.9682; train_kl_reg_loss: 11489.1797; train_edge_recon_loss: 807803.6707; train_gene_expr_recon_loss: 1689705.6829; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2508998.5255; train_optim_loss: 2508998.5255; val_kl_reg_loss: 10992.2611; val_edge_recon_loss: 773273.1198; val_gene_expr_recon_loss: 1675247.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2459512.8542; val_optim_loss: 2459512.8542
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9669; val_auprc_score: 0.9926; val_best_acc_score: 0.9529; val_best_f1_score: 0.9725; train_kl_reg_loss: 11230.0755; train_edge_recon_loss: 780961.8819; train_gene_expr_recon_loss: 1657742.2176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2449934.1644; train_optim_loss: 2449934.1644; val_kl_reg_loss: 11198.5124; val_edge_recon_loss: 828923.3438; val_gene_expr_recon_loss: 1644327.1354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2484449.0000; val_optim_loss: 2484449.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9704; val_auprc_score: 0.9932; val_best_acc_score: 0.9594; val_best_f1_score: 0.9766; train_kl_reg_loss: 11072.8116; train_edge_recon_loss: 788268.4334; train_gene_expr_recon_loss: 1631584.8310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2430926.0810; train_optim_loss: 2430926.0810; val_kl_reg_loss: 11177.9662; val_edge_recon_loss: 771511.1250; val_gene_expr_recon_loss: 1617140.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2399829.9583; val_optim_loss: 2399829.9583
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9734; val_auprc_score: 0.9930; val_best_acc_score: 0.9632; val_best_f1_score: 0.9784; train_kl_reg_loss: 10975.0346; train_edge_recon_loss: 782402.0278; train_gene_expr_recon_loss: 1606869.2292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2400246.2894; train_optim_loss: 2400246.2894; val_kl_reg_loss: 10864.9701; val_edge_recon_loss: 831379.0469; val_gene_expr_recon_loss: 1589097.7604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2431341.7500; val_optim_loss: 2431341.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9788; val_auprc_score: 0.9954; val_best_acc_score: 0.9660; val_best_f1_score: 0.9803; train_kl_reg_loss: 10856.0487; train_edge_recon_loss: 778999.0289; train_gene_expr_recon_loss: 1581984.3958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2371839.4861; train_optim_loss: 2371839.4861; val_kl_reg_loss: 10694.1776; val_edge_recon_loss: 765663.0938; val_gene_expr_recon_loss: 1572662.2604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2349019.5000; val_optim_loss: 2349019.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9712; val_auprc_score: 0.9928; val_best_acc_score: 0.9632; val_best_f1_score: 0.9786; train_kl_reg_loss: 10796.3243; train_edge_recon_loss: 783720.9543; train_gene_expr_recon_loss: 1558845.1238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2353362.3958; train_optim_loss: 2353362.3958; val_kl_reg_loss: 10938.2363; val_edge_recon_loss: 789962.4948; val_gene_expr_recon_loss: 1545345.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2346246.4583; val_optim_loss: 2346246.4583
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9759; val_auprc_score: 0.9948; val_best_acc_score: 0.9684; val_best_f1_score: 0.9818; train_kl_reg_loss: 10770.3432; train_edge_recon_loss: 783401.2650; train_gene_expr_recon_loss: 1539616.9664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2333788.5764; train_optim_loss: 2333788.5764; val_kl_reg_loss: 10751.1195; val_edge_recon_loss: 745657.3073; val_gene_expr_recon_loss: 1526061.2708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2282469.7396; val_optim_loss: 2282469.7396
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9767; val_auprc_score: 0.9950; val_best_acc_score: 0.9676; val_best_f1_score: 0.9814; train_kl_reg_loss: 10588.4710; train_edge_recon_loss: 783409.8148; train_gene_expr_recon_loss: 1516744.0718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2310742.3611; train_optim_loss: 2310742.3611; val_kl_reg_loss: 10652.3519; val_edge_recon_loss: 756724.7500; val_gene_expr_recon_loss: 1505732.6458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2273109.7292; val_optim_loss: 2273109.7292
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9772; val_auprc_score: 0.9935; val_best_acc_score: 0.9694; val_best_f1_score: 0.9822; train_kl_reg_loss: 10775.3161; train_edge_recon_loss: 774344.3698; train_gene_expr_recon_loss: 1495808.0741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2280927.7662; train_optim_loss: 2280927.7662; val_kl_reg_loss: 10755.1846; val_edge_recon_loss: 783108.1875; val_gene_expr_recon_loss: 1493299.3542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2287162.7500; val_optim_loss: 2287162.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9788; val_auprc_score: 0.9949; val_best_acc_score: 0.9711; val_best_f1_score: 0.9832; train_kl_reg_loss: 10648.8166; train_edge_recon_loss: 774096.3646; train_gene_expr_recon_loss: 1477054.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2261800.0648; train_optim_loss: 2261800.0648; val_kl_reg_loss: 10677.1320; val_edge_recon_loss: 772462.7500; val_gene_expr_recon_loss: 1463177.1979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2246317.0417; val_optim_loss: 2246317.0417
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9816; val_auprc_score: 0.9952; val_best_acc_score: 0.9708; val_best_f1_score: 0.9830; train_kl_reg_loss: 10550.2110; train_edge_recon_loss: 769700.8860; train_gene_expr_recon_loss: 1457232.5243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2237483.6250; train_optim_loss: 2237483.6250; val_kl_reg_loss: 10644.5095; val_edge_recon_loss: 778653.1198; val_gene_expr_recon_loss: 1451057.1979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2240354.8542; val_optim_loss: 2240354.8542
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9824; val_auprc_score: 0.9953; val_best_acc_score: 0.9724; val_best_f1_score: 0.9840; train_kl_reg_loss: 10457.0924; train_edge_recon_loss: 767017.6696; train_gene_expr_recon_loss: 1440617.6296; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2218092.3935; train_optim_loss: 2218092.3935; val_kl_reg_loss: 10627.4359; val_edge_recon_loss: 770057.2760; val_gene_expr_recon_loss: 1436662.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2217347.6875; val_optim_loss: 2217347.6875
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9767; val_auprc_score: 0.9937; val_best_acc_score: 0.9710; val_best_f1_score: 0.9832; train_kl_reg_loss: 10568.2674; train_edge_recon_loss: 773212.7124; train_gene_expr_recon_loss: 1420814.1516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2204595.1308; train_optim_loss: 2204595.1308; val_kl_reg_loss: 10609.6443; val_edge_recon_loss: 769065.4948; val_gene_expr_recon_loss: 1417621.5521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2197296.7083; val_optim_loss: 2197296.7083
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9783; val_auprc_score: 0.9943; val_best_acc_score: 0.9719; val_best_f1_score: 0.9836; train_kl_reg_loss: 10512.5913; train_edge_recon_loss: 783100.4809; train_gene_expr_recon_loss: 1407447.0683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2201060.1308; train_optim_loss: 2201060.1308; val_kl_reg_loss: 10505.5374; val_edge_recon_loss: 801606.2812; val_gene_expr_recon_loss: 1399653.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2211765.3958; val_optim_loss: 2211765.3958
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9770; val_auprc_score: 0.9930; val_best_acc_score: 0.9729; val_best_f1_score: 0.9842; train_kl_reg_loss: 10492.6971; train_edge_recon_loss: 771652.6447; train_gene_expr_recon_loss: 1391404.8229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2173550.1644; train_optim_loss: 2173550.1644; val_kl_reg_loss: 10581.0891; val_edge_recon_loss: 789331.8281; val_gene_expr_recon_loss: 1390633.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2190546.6875; val_optim_loss: 2190546.6875
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9808; val_auprc_score: 0.9945; val_best_acc_score: 0.9759; val_best_f1_score: 0.9860; train_kl_reg_loss: 10587.2427; train_edge_recon_loss: 773641.2425; train_gene_expr_recon_loss: 1375947.4306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2160175.9028; train_optim_loss: 2160175.9028; val_kl_reg_loss: 10508.5487; val_edge_recon_loss: 771982.4219; val_gene_expr_recon_loss: 1376496.9271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2158987.9167; val_optim_loss: 2158987.9167
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9810; val_auprc_score: 0.9940; val_best_acc_score: 0.9734; val_best_f1_score: 0.9845; train_kl_reg_loss: 10629.4204; train_edge_recon_loss: 777271.2454; train_gene_expr_recon_loss: 1364693.6759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2152594.3403; train_optim_loss: 2152594.3403; val_kl_reg_loss: 10729.3919; val_edge_recon_loss: 800478.7344; val_gene_expr_recon_loss: 1364391.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2175599.6458; val_optim_loss: 2175599.6458
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9835; val_auprc_score: 0.9963; val_best_acc_score: 0.9726; val_best_f1_score: 0.9841; train_kl_reg_loss: 10670.4228; train_edge_recon_loss: 773585.8576; train_gene_expr_recon_loss: 1353530.3576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2137786.6458; train_optim_loss: 2137786.6458; val_kl_reg_loss: 10627.5768; val_edge_recon_loss: 793006.8177; val_gene_expr_recon_loss: 1350999.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2154633.9792; val_optim_loss: 2154633.9792
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9760; val_auprc_score: 0.9938; val_best_acc_score: 0.9703; val_best_f1_score: 0.9827; train_kl_reg_loss: 10703.0376; train_edge_recon_loss: 765139.5156; train_gene_expr_recon_loss: 1341354.3796; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2117196.9294; train_optim_loss: 2117196.9294; val_kl_reg_loss: 10738.9374; val_edge_recon_loss: 782515.0781; val_gene_expr_recon_loss: 1340527.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2133781.0729; val_optim_loss: 2133781.0729
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9827; val_auprc_score: 0.9947; val_best_acc_score: 0.9743; val_best_f1_score: 0.9849; train_kl_reg_loss: 10766.4612; train_edge_recon_loss: 759217.0394; train_gene_expr_recon_loss: 1329782.2292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2099765.7350; train_optim_loss: 2099765.7350; val_kl_reg_loss: 11052.3082; val_edge_recon_loss: 800738.3854; val_gene_expr_recon_loss: 1328418.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2140209.5417; val_optim_loss: 2140209.5417
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9790; val_auprc_score: 0.9926; val_best_acc_score: 0.9746; val_best_f1_score: 0.9853; train_kl_reg_loss: 10754.2286; train_edge_recon_loss: 769928.4896; train_gene_expr_recon_loss: 1321388.4421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2102071.1597; train_optim_loss: 2102071.1597; val_kl_reg_loss: 10921.0215; val_edge_recon_loss: 763452.1458; val_gene_expr_recon_loss: 1317726.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2092099.7292; val_optim_loss: 2092099.7292
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9851; val_auprc_score: 0.9968; val_best_acc_score: 0.9726; val_best_f1_score: 0.9842; train_kl_reg_loss: 10806.7493; train_edge_recon_loss: 762513.4977; train_gene_expr_recon_loss: 1313927.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2087248.0278; train_optim_loss: 2087248.0278; val_kl_reg_loss: 10651.7961; val_edge_recon_loss: 758278.1719; val_gene_expr_recon_loss: 1312193.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2081123.9062; val_optim_loss: 2081123.9062
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9833; val_auprc_score: 0.9943; val_best_acc_score: 0.9758; val_best_f1_score: 0.9858; train_kl_reg_loss: 10867.5620; train_edge_recon_loss: 772765.2222; train_gene_expr_recon_loss: 1304625.4398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2088258.2234; train_optim_loss: 2088258.2234; val_kl_reg_loss: 11032.4837; val_edge_recon_loss: 808835.0469; val_gene_expr_recon_loss: 1306920.0104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2126787.5417; val_optim_loss: 2126787.5417
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9805; val_auprc_score: 0.9958; val_best_acc_score: 0.9746; val_best_f1_score: 0.9853; train_kl_reg_loss: 10900.2705; train_edge_recon_loss: 769709.6742; train_gene_expr_recon_loss: 1296815.8368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2077425.7731; train_optim_loss: 2077425.7731; val_kl_reg_loss: 10692.0484; val_edge_recon_loss: 747851.5417; val_gene_expr_recon_loss: 1299433.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2057977.5312; val_optim_loss: 2057977.5312
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9799; val_auprc_score: 0.9941; val_best_acc_score: 0.9741; val_best_f1_score: 0.9851; train_kl_reg_loss: 10902.2500; train_edge_recon_loss: 772897.6082; train_gene_expr_recon_loss: 1288721.4583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2072521.3148; train_optim_loss: 2072521.3148; val_kl_reg_loss: 10743.0658; val_edge_recon_loss: 745068.8125; val_gene_expr_recon_loss: 1293691.2292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2049503.1042; val_optim_loss: 2049503.1042
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9896; val_auprc_score: 0.9980; val_best_acc_score: 0.9758; val_best_f1_score: 0.9859; train_kl_reg_loss: 10899.5684; train_edge_recon_loss: 766395.9340; train_gene_expr_recon_loss: 1280760.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2058055.8796; train_optim_loss: 2058055.8796; val_kl_reg_loss: 10910.8117; val_edge_recon_loss: 779294.8438; val_gene_expr_recon_loss: 1280772.5521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2070978.2188; val_optim_loss: 2070978.2188
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9799; val_auprc_score: 0.9941; val_best_acc_score: 0.9718; val_best_f1_score: 0.9835; train_kl_reg_loss: 10882.1910; train_edge_recon_loss: 764230.0787; train_gene_expr_recon_loss: 1276190.8947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2051303.1597; train_optim_loss: 2051303.1597; val_kl_reg_loss: 11159.1346; val_edge_recon_loss: 807107.8594; val_gene_expr_recon_loss: 1280636.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2098903.0312; val_optim_loss: 2098903.0312
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9807; val_auprc_score: 0.9951; val_best_acc_score: 0.9753; val_best_f1_score: 0.9857; train_kl_reg_loss: 10923.3446; train_edge_recon_loss: 764784.1476; train_gene_expr_recon_loss: 1271001.1528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2046708.6458; train_optim_loss: 2046708.6458; val_kl_reg_loss: 11121.7707; val_edge_recon_loss: 768701.0104; val_gene_expr_recon_loss: 1271211.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2051034.3333; val_optim_loss: 2051034.3333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9812; val_auprc_score: 0.9943; val_best_acc_score: 0.9743; val_best_f1_score: 0.9850; train_kl_reg_loss: 11010.6301; train_edge_recon_loss: 775357.7037; train_gene_expr_recon_loss: 1263099.5243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2049467.8472; train_optim_loss: 2049467.8472; val_kl_reg_loss: 11118.0057; val_edge_recon_loss: 791012.6875; val_gene_expr_recon_loss: 1273919.8646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2076050.5417; val_optim_loss: 2076050.5417

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9859; val_auprc_score: 0.9962; val_best_acc_score: 0.9791; val_best_f1_score: 0.9878; train_kl_reg_loss: 10926.2672; train_edge_recon_loss: 774578.9977; train_gene_expr_recon_loss: 1257355.0093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2042860.2812; train_optim_loss: 2042860.2812; val_kl_reg_loss: 10929.0439; val_edge_recon_loss: 786958.8333; val_gene_expr_recon_loss: 1266069.5521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2063957.4375; val_optim_loss: 2063957.4375
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9852; val_auprc_score: 0.9958; val_best_acc_score: 0.9753; val_best_f1_score: 0.9857; train_kl_reg_loss: 10874.3309; train_edge_recon_loss: 765848.7998; train_gene_expr_recon_loss: 1253452.9873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2030176.1157; train_optim_loss: 2030176.1157; val_kl_reg_loss: 10872.7118; val_edge_recon_loss: 755342.0677; val_gene_expr_recon_loss: 1262479.8958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2028694.6771; val_optim_loss: 2028694.6771
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9839; val_auprc_score: 0.9959; val_best_acc_score: 0.9739; val_best_f1_score: 0.9847; train_kl_reg_loss: 10879.4733; train_edge_recon_loss: 768422.3021; train_gene_expr_recon_loss: 1254530.1690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2033831.9468; train_optim_loss: 2033831.9468; val_kl_reg_loss: 10846.5247; val_edge_recon_loss: 811243.6823; val_gene_expr_recon_loss: 1263930.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2086021.1354; val_optim_loss: 2086021.1354
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9786; val_auprc_score: 0.9950; val_best_acc_score: 0.9723; val_best_f1_score: 0.9839; train_kl_reg_loss: 10864.2452; train_edge_recon_loss: 775380.3310; train_gene_expr_recon_loss: 1252564.5139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2038809.0856; train_optim_loss: 2038809.0856; val_kl_reg_loss: 10854.7244; val_edge_recon_loss: 782004.4792; val_gene_expr_recon_loss: 1264287.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2057146.5729; val_optim_loss: 2057146.5729
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9786; val_auprc_score: 0.9946; val_best_acc_score: 0.9743; val_best_f1_score: 0.9849; train_kl_reg_loss: 10875.2031; train_edge_recon_loss: 773288.5735; train_gene_expr_recon_loss: 1252424.5243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2036588.3056; train_optim_loss: 2036588.3056; val_kl_reg_loss: 10865.6464; val_edge_recon_loss: 800950.6667; val_gene_expr_recon_loss: 1255623.2917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2067439.6354; val_optim_loss: 2067439.6354
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9831; val_auprc_score: 0.9956; val_best_acc_score: 0.9770; val_best_f1_score: 0.9866; train_kl_reg_loss: 10857.0991; train_edge_recon_loss: 776540.5417; train_gene_expr_recon_loss: 1251709.5567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2039107.1968; train_optim_loss: 2039107.1968; val_kl_reg_loss: 10916.9250; val_edge_recon_loss: 765572.7656; val_gene_expr_recon_loss: 1261935.1146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2038424.8229; val_optim_loss: 2038424.8229

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9854; val_auprc_score: 0.9964; val_best_acc_score: 0.9769; val_best_f1_score: 0.9865; train_kl_reg_loss: 10870.2133; train_edge_recon_loss: 764318.5466; train_gene_expr_recon_loss: 1251056.6644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2026245.4167; train_optim_loss: 2026245.4167; val_kl_reg_loss: 10873.2891; val_edge_recon_loss: 794619.3333; val_gene_expr_recon_loss: 1262594.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2068087.0625; val_optim_loss: 2068087.0625
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9858; val_auprc_score: 0.9965; val_best_acc_score: 0.9743; val_best_f1_score: 0.9850; train_kl_reg_loss: 10850.4240; train_edge_recon_loss: 752984.7888; train_gene_expr_recon_loss: 1249913.9479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2013749.1667; train_optim_loss: 2013749.1667; val_kl_reg_loss: 10859.5878; val_edge_recon_loss: 808876.4271; val_gene_expr_recon_loss: 1258751.4479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2078487.4479; val_optim_loss: 2078487.4479
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9855; val_auprc_score: 0.9949; val_best_acc_score: 0.9777; val_best_f1_score: 0.9870; train_kl_reg_loss: 10851.6674; train_edge_recon_loss: 760839.7170; train_gene_expr_recon_loss: 1250015.5926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2021706.9803; train_optim_loss: 2021706.9803; val_kl_reg_loss: 10879.9102; val_edge_recon_loss: 779545.3906; val_gene_expr_recon_loss: 1264322.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2054747.6250; val_optim_loss: 2054747.6250
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9806; val_auprc_score: 0.9937; val_best_acc_score: 0.9730; val_best_f1_score: 0.9844; train_kl_reg_loss: 10841.3127; train_edge_recon_loss: 764277.8519; train_gene_expr_recon_loss: 1249305.3681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2024424.5347; train_optim_loss: 2024424.5347; val_kl_reg_loss: 10897.2037; val_edge_recon_loss: 758271.6302; val_gene_expr_recon_loss: 1258342.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2027511.2708; val_optim_loss: 2027511.2708
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9837; val_auprc_score: 0.9957; val_best_acc_score: 0.9761; val_best_f1_score: 0.9861; train_kl_reg_loss: 10876.9946; train_edge_recon_loss: 770835.6487; train_gene_expr_recon_loss: 1250620.5775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2032333.2153; train_optim_loss: 2032333.2153; val_kl_reg_loss: 10897.8062; val_edge_recon_loss: 775948.4635; val_gene_expr_recon_loss: 1262100.7292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2048946.9792; val_optim_loss: 2048946.9792
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9845; val_auprc_score: 0.9964; val_best_acc_score: 0.9758; val_best_f1_score: 0.9859; train_kl_reg_loss: 10863.6904; train_edge_recon_loss: 768840.2442; train_gene_expr_recon_loss: 1249894.1007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2029598.0278; train_optim_loss: 2029598.0278; val_kl_reg_loss: 10862.7577; val_edge_recon_loss: 775810.5990; val_gene_expr_recon_loss: 1259374.3542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2046047.7083; val_optim_loss: 2046047.7083
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9829; val_auprc_score: 0.9960; val_best_acc_score: 0.9757; val_best_f1_score: 0.9858; train_kl_reg_loss: 10843.5170; train_edge_recon_loss: 771670.9225; train_gene_expr_recon_loss: 1249239.3970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2031753.8426; train_optim_loss: 2031753.8426; val_kl_reg_loss: 10865.2109; val_edge_recon_loss: 779270.1458; val_gene_expr_recon_loss: 1261033.3854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2051168.7396; val_optim_loss: 2051168.7396
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9847; val_auprc_score: 0.9957; val_best_acc_score: 0.9752; val_best_f1_score: 0.9856; train_kl_reg_loss: 10839.0175; train_edge_recon_loss: 769905.6869; train_gene_expr_recon_loss: 1249521.4410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2030266.1447; train_optim_loss: 2030266.1447; val_kl_reg_loss: 10853.9213; val_edge_recon_loss: 769248.6510; val_gene_expr_recon_loss: 1259368.3646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2039470.9479; val_optim_loss: 2039470.9479

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9841; val_auprc_score: 0.9965; val_best_acc_score: 0.9733; val_best_f1_score: 0.9845; train_kl_reg_loss: 10849.7865; train_edge_recon_loss: 771827.9502; train_gene_expr_recon_loss: 1250056.9120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2032734.6447; train_optim_loss: 2032734.6447; val_kl_reg_loss: 10868.8195; val_edge_recon_loss: 789732.4062; val_gene_expr_recon_loss: 1258968.1354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2059569.3542; val_optim_loss: 2059569.3542
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9803; val_auprc_score: 0.9939; val_best_acc_score: 0.9747; val_best_f1_score: 0.9853; train_kl_reg_loss: 10843.9839; train_edge_recon_loss: 765362.3877; train_gene_expr_recon_loss: 1249861.9479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2026068.3125; train_optim_loss: 2026068.3125; val_kl_reg_loss: 10848.8575; val_edge_recon_loss: 787159.4219; val_gene_expr_recon_loss: 1255082.2708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2053090.5833; val_optim_loss: 2053090.5833
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9825; val_auprc_score: 0.9957; val_best_acc_score: 0.9743; val_best_f1_score: 0.9850; train_kl_reg_loss: 10856.7067; train_edge_recon_loss: 764536.0683; train_gene_expr_recon_loss: 1250789.8345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2026182.6065; train_optim_loss: 2026182.6065; val_kl_reg_loss: 10860.9064; val_edge_recon_loss: 781158.5938; val_gene_expr_recon_loss: 1254624.0521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2046643.5521; val_optim_loss: 2046643.5521
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9861; val_auprc_score: 0.9967; val_best_acc_score: 0.9773; val_best_f1_score: 0.9867; train_kl_reg_loss: 10847.7303; train_edge_recon_loss: 768591.1684; train_gene_expr_recon_loss: 1249598.0231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2029036.9306; train_optim_loss: 2029036.9306; val_kl_reg_loss: 10861.0326; val_edge_recon_loss: 785712.6875; val_gene_expr_recon_loss: 1264611.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2061185.4896; val_optim_loss: 2061185.4896

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 19 min 11 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
val AUROC score: 0.9861
val AUPRC score: 0.9969
val best accuracy score: 0.9761
val best F1 score: 0.9862
val target rna MSE score: 0.9451
val source rna MSE score: 0.2721
Val cat covariate0 mean sim diff: 0.0045
Duration of model training in run 2: 0 hours, 19 minutes and 20 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 54907
Number of validation edges: 6100
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8777; val_auprc_score: 0.9714; val_best_acc_score: 0.8930; val_best_f1_score: 0.9395; train_kl_reg_loss: 4557.5747; train_edge_recon_loss: 973791.5191; train_gene_expr_recon_loss: 2048313.6424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3026662.7338; train_optim_loss: 3026662.7338; val_kl_reg_loss: 11632.8733; val_edge_recon_loss: 897870.3490; val_gene_expr_recon_loss: 1884896.1354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2794399.3542; val_optim_loss: 2794399.3542
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8983; val_auprc_score: 0.9790; val_best_acc_score: 0.9067; val_best_f1_score: 0.9478; train_kl_reg_loss: 12349.6626; train_edge_recon_loss: 840760.6481; train_gene_expr_recon_loss: 1819312.6088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2672422.9259; train_optim_loss: 2672422.9259; val_kl_reg_loss: 12425.8970; val_edge_recon_loss: 830000.3854; val_gene_expr_recon_loss: 1781591.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2624017.7083; val_optim_loss: 2624017.7083
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9449; val_auprc_score: 0.9859; val_best_acc_score: 0.9292; val_best_f1_score: 0.9584; train_kl_reg_loss: 11700.4918; train_edge_recon_loss: 813422.7211; train_gene_expr_recon_loss: 1742493.7905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2567617.0093; train_optim_loss: 2567617.0093; val_kl_reg_loss: 10661.2816; val_edge_recon_loss: 849081.5312; val_gene_expr_recon_loss: 1718209.8958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2577952.6875; val_optim_loss: 2577952.6875
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9586; val_auprc_score: 0.9914; val_best_acc_score: 0.9456; val_best_f1_score: 0.9687; train_kl_reg_loss: 10836.2794; train_edge_recon_loss: 793016.8941; train_gene_expr_recon_loss: 1695679.7558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2499532.9282; train_optim_loss: 2499532.9282; val_kl_reg_loss: 10822.7636; val_edge_recon_loss: 776506.8854; val_gene_expr_recon_loss: 1686397.1979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2473726.8958; val_optim_loss: 2473726.8958
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9618; val_auprc_score: 0.9915; val_best_acc_score: 0.9453; val_best_f1_score: 0.9684; train_kl_reg_loss: 10982.2818; train_edge_recon_loss: 787376.7859; train_gene_expr_recon_loss: 1659300.6887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2457659.7616; train_optim_loss: 2457659.7616; val_kl_reg_loss: 10869.1437; val_edge_recon_loss: 803882.5417; val_gene_expr_recon_loss: 1650274.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2465026.3125; val_optim_loss: 2465026.3125
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9660; val_auprc_score: 0.9925; val_best_acc_score: 0.9544; val_best_f1_score: 0.9737; train_kl_reg_loss: 10652.9581; train_edge_recon_loss: 771585.7541; train_gene_expr_recon_loss: 1628062.2801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2410300.9838; train_optim_loss: 2410300.9838; val_kl_reg_loss: 10522.0841; val_edge_recon_loss: 773098.6198; val_gene_expr_recon_loss: 1623737.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2407357.7708; val_optim_loss: 2407357.7708
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9708; val_auprc_score: 0.9921; val_best_acc_score: 0.9579; val_best_f1_score: 0.9757; train_kl_reg_loss: 10461.0717; train_edge_recon_loss: 792992.3611; train_gene_expr_recon_loss: 1604429.9097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2407883.3380; train_optim_loss: 2407883.3380; val_kl_reg_loss: 10538.7768; val_edge_recon_loss: 793158.1979; val_gene_expr_recon_loss: 1598941.8229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2402638.7917; val_optim_loss: 2402638.7917
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9720; val_auprc_score: 0.9928; val_best_acc_score: 0.9629; val_best_f1_score: 0.9786; train_kl_reg_loss: 10382.4239; train_edge_recon_loss: 761349.3519; train_gene_expr_recon_loss: 1578186.0671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2349917.8472; train_optim_loss: 2349917.8472; val_kl_reg_loss: 10580.4072; val_edge_recon_loss: 783072.7396; val_gene_expr_recon_loss: 1571117.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2364770.3125; val_optim_loss: 2364770.3125
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9782; val_auprc_score: 0.9950; val_best_acc_score: 0.9656; val_best_f1_score: 0.9800; train_kl_reg_loss: 10390.1435; train_edge_recon_loss: 763992.8455; train_gene_expr_recon_loss: 1555496.1169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2329879.1227; train_optim_loss: 2329879.1227; val_kl_reg_loss: 10180.2580; val_edge_recon_loss: 800850.5990; val_gene_expr_recon_loss: 1549481.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2360511.9167; val_optim_loss: 2360511.9167
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9790; val_auprc_score: 0.9954; val_best_acc_score: 0.9682; val_best_f1_score: 0.9815; train_kl_reg_loss: 10187.7297; train_edge_recon_loss: 789863.7899; train_gene_expr_recon_loss: 1533122.6204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2333174.1389; train_optim_loss: 2333174.1389; val_kl_reg_loss: 10280.0495; val_edge_recon_loss: 771080.2500; val_gene_expr_recon_loss: 1534951.8854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2316312.1667; val_optim_loss: 2316312.1667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9797; val_auprc_score: 0.9957; val_best_acc_score: 0.9669; val_best_f1_score: 0.9807; train_kl_reg_loss: 10164.9555; train_edge_recon_loss: 779188.4352; train_gene_expr_recon_loss: 1509454.9340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2298808.3264; train_optim_loss: 2298808.3264; val_kl_reg_loss: 9895.4050; val_edge_recon_loss: 789310.9896; val_gene_expr_recon_loss: 1511149.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2310356.1458; val_optim_loss: 2310356.1458
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9803; val_auprc_score: 0.9956; val_best_acc_score: 0.9705; val_best_f1_score: 0.9828; train_kl_reg_loss: 10142.7939; train_edge_recon_loss: 774314.8194; train_gene_expr_recon_loss: 1491485.3877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2275942.9884; train_optim_loss: 2275942.9884; val_kl_reg_loss: 9851.9755; val_edge_recon_loss: 775045.4167; val_gene_expr_recon_loss: 1493479.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2278377.2917; val_optim_loss: 2278377.2917
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9769; val_auprc_score: 0.9944; val_best_acc_score: 0.9710; val_best_f1_score: 0.9832; train_kl_reg_loss: 10103.2900; train_edge_recon_loss: 766783.1580; train_gene_expr_recon_loss: 1469651.5567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2246537.9954; train_optim_loss: 2246537.9954; val_kl_reg_loss: 9838.2619; val_edge_recon_loss: 770633.7865; val_gene_expr_recon_loss: 1471968.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2252440.9375; val_optim_loss: 2252440.9375
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9797; val_auprc_score: 0.9956; val_best_acc_score: 0.9715; val_best_f1_score: 0.9835; train_kl_reg_loss: 10110.8965; train_edge_recon_loss: 771607.7726; train_gene_expr_recon_loss: 1451713.0741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2233431.7419; train_optim_loss: 2233431.7419; val_kl_reg_loss: 10077.6514; val_edge_recon_loss: 762996.7448; val_gene_expr_recon_loss: 1452732.3646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2225806.7292; val_optim_loss: 2225806.7292
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9811; val_auprc_score: 0.9953; val_best_acc_score: 0.9715; val_best_f1_score: 0.9834; train_kl_reg_loss: 10027.8919; train_edge_recon_loss: 771516.0920; train_gene_expr_recon_loss: 1436366.2419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2217910.2257; train_optim_loss: 2217910.2257; val_kl_reg_loss: 10168.6261; val_edge_recon_loss: 793599.5625; val_gene_expr_recon_loss: 1434848.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2238616.8542; val_optim_loss: 2238616.8542
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9836; val_auprc_score: 0.9951; val_best_acc_score: 0.9741; val_best_f1_score: 0.9851; train_kl_reg_loss: 9981.4099; train_edge_recon_loss: 775568.7778; train_gene_expr_recon_loss: 1418748.5347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2204298.7130; train_optim_loss: 2204298.7130; val_kl_reg_loss: 10246.9530; val_edge_recon_loss: 741949.4271; val_gene_expr_recon_loss: 1421786.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2173983.2917; val_optim_loss: 2173983.2917
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9769; val_auprc_score: 0.9929; val_best_acc_score: 0.9726; val_best_f1_score: 0.9840; train_kl_reg_loss: 10044.8529; train_edge_recon_loss: 773766.8304; train_gene_expr_recon_loss: 1403942.3877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2187754.0683; train_optim_loss: 2187754.0683; val_kl_reg_loss: 10169.3872; val_edge_recon_loss: 803656.6354; val_gene_expr_recon_loss: 1408140.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2221966.6250; val_optim_loss: 2221966.6250
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9809; val_auprc_score: 0.9959; val_best_acc_score: 0.9742; val_best_f1_score: 0.9851; train_kl_reg_loss: 10113.8384; train_edge_recon_loss: 763473.9120; train_gene_expr_recon_loss: 1390390.4306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2163978.1863; train_optim_loss: 2163978.1863; val_kl_reg_loss: 10068.0677; val_edge_recon_loss: 737684.8281; val_gene_expr_recon_loss: 1398150.6979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2145903.5729; val_optim_loss: 2145903.5729
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9847; val_auprc_score: 0.9969; val_best_acc_score: 0.9733; val_best_f1_score: 0.9846; train_kl_reg_loss: 10075.8834; train_edge_recon_loss: 770084.4786; train_gene_expr_recon_loss: 1375903.9213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2156064.2847; train_optim_loss: 2156064.2847; val_kl_reg_loss: 10203.2825; val_edge_recon_loss: 752974.9115; val_gene_expr_recon_loss: 1379152.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2142331.0833; val_optim_loss: 2142331.0833
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9812; val_auprc_score: 0.9941; val_best_acc_score: 0.9745; val_best_f1_score: 0.9851; train_kl_reg_loss: 10111.0991; train_edge_recon_loss: 761352.6811; train_gene_expr_recon_loss: 1364121.9780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2135585.7685; train_optim_loss: 2135585.7685; val_kl_reg_loss: 10185.5820; val_edge_recon_loss: 767853.9531; val_gene_expr_recon_loss: 1372144.1458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2150183.6562; val_optim_loss: 2150183.6562
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9836; val_auprc_score: 0.9965; val_best_acc_score: 0.9746; val_best_f1_score: 0.9853; train_kl_reg_loss: 10209.2661; train_edge_recon_loss: 768721.2743; train_gene_expr_recon_loss: 1352145.5301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2131076.0775; train_optim_loss: 2131076.0775; val_kl_reg_loss: 10117.8824; val_edge_recon_loss: 771447.3854; val_gene_expr_recon_loss: 1361762.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2143327.9167; val_optim_loss: 2143327.9167
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9803; val_auprc_score: 0.9940; val_best_acc_score: 0.9764; val_best_f1_score: 0.9863; train_kl_reg_loss: 10241.6774; train_edge_recon_loss: 774440.8333; train_gene_expr_recon_loss: 1340873.5127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2125556.0347; train_optim_loss: 2125556.0347; val_kl_reg_loss: 10152.9856; val_edge_recon_loss: 787328.1354; val_gene_expr_recon_loss: 1344703.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2142184.5938; val_optim_loss: 2142184.5938
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9841; val_auprc_score: 0.9967; val_best_acc_score: 0.9782; val_best_f1_score: 0.9874; train_kl_reg_loss: 10297.9867; train_edge_recon_loss: 777787.4716; train_gene_expr_recon_loss: 1331231.6435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2119317.1065; train_optim_loss: 2119317.1065; val_kl_reg_loss: 10248.7655; val_edge_recon_loss: 751367.0938; val_gene_expr_recon_loss: 1347208.0208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2108823.8958; val_optim_loss: 2108823.8958
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9833; val_auprc_score: 0.9962; val_best_acc_score: 0.9754; val_best_f1_score: 0.9857; train_kl_reg_loss: 10390.6946; train_edge_recon_loss: 776302.4757; train_gene_expr_recon_loss: 1320361.6296; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2107054.7951; train_optim_loss: 2107054.7951; val_kl_reg_loss: 10454.1716; val_edge_recon_loss: 789869.7500; val_gene_expr_recon_loss: 1330589.7292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2130913.6250; val_optim_loss: 2130913.6250
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9765; val_auprc_score: 0.9948; val_best_acc_score: 0.9734; val_best_f1_score: 0.9846; train_kl_reg_loss: 10435.7300; train_edge_recon_loss: 771560.7280; train_gene_expr_recon_loss: 1310730.6308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2092727.0845; train_optim_loss: 2092727.0845; val_kl_reg_loss: 10441.7279; val_edge_recon_loss: 750442.9115; val_gene_expr_recon_loss: 1325699.4271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2086584.0312; val_optim_loss: 2086584.0312
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9831; val_auprc_score: 0.9950; val_best_acc_score: 0.9763; val_best_f1_score: 0.9862; train_kl_reg_loss: 10469.1565; train_edge_recon_loss: 771121.3686; train_gene_expr_recon_loss: 1301478.6840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2083069.2014; train_optim_loss: 2083069.2014; val_kl_reg_loss: 10638.3745; val_edge_recon_loss: 770938.0729; val_gene_expr_recon_loss: 1318123.6042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2099700.0521; val_optim_loss: 2099700.0521
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9819; val_auprc_score: 0.9957; val_best_acc_score: 0.9749; val_best_f1_score: 0.9854; train_kl_reg_loss: 10492.6594; train_edge_recon_loss: 762526.6505; train_gene_expr_recon_loss: 1294846.5359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2067865.8507; train_optim_loss: 2067865.8507; val_kl_reg_loss: 10464.3910; val_edge_recon_loss: 788733.7240; val_gene_expr_recon_loss: 1310329.8021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2109527.8958; val_optim_loss: 2109527.8958
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9837; val_auprc_score: 0.9953; val_best_acc_score: 0.9755; val_best_f1_score: 0.9857; train_kl_reg_loss: 10591.6104; train_edge_recon_loss: 766073.6215; train_gene_expr_recon_loss: 1287210.1400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2063875.3611; train_optim_loss: 2063875.3611; val_kl_reg_loss: 10424.0205; val_edge_recon_loss: 794778.5885; val_gene_expr_recon_loss: 1304833.8229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2110036.4479; val_optim_loss: 2110036.4479
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9856; val_auprc_score: 0.9966; val_best_acc_score: 0.9804; val_best_f1_score: 0.9886; train_kl_reg_loss: 10597.6642; train_edge_recon_loss: 774078.4977; train_gene_expr_recon_loss: 1282141.5359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2066817.6887; train_optim_loss: 2066817.6887; val_kl_reg_loss: 10728.8261; val_edge_recon_loss: 761391.9115; val_gene_expr_recon_loss: 1289622.6146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2061743.3542; val_optim_loss: 2061743.3542
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9851; val_auprc_score: 0.9955; val_best_acc_score: 0.9751; val_best_f1_score: 0.9854; train_kl_reg_loss: 10704.7764; train_edge_recon_loss: 769596.4473; train_gene_expr_recon_loss: 1276571.6921; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2056872.9167; train_optim_loss: 2056872.9167; val_kl_reg_loss: 10973.0664; val_edge_recon_loss: 828916.6146; val_gene_expr_recon_loss: 1286210.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2126100.4062; val_optim_loss: 2126100.4062
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9854; val_auprc_score: 0.9967; val_best_acc_score: 0.9780; val_best_f1_score: 0.9873; train_kl_reg_loss: 10712.2665; train_edge_recon_loss: 777814.6800; train_gene_expr_recon_loss: 1269184.3600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2057711.3067; train_optim_loss: 2057711.3067; val_kl_reg_loss: 10563.9343; val_edge_recon_loss: 776608.2083; val_gene_expr_recon_loss: 1282251.8646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2069424.0208; val_optim_loss: 2069424.0208
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9833; val_auprc_score: 0.9961; val_best_acc_score: 0.9783; val_best_f1_score: 0.9875; train_kl_reg_loss: 10789.0138; train_edge_recon_loss: 775840.5041; train_gene_expr_recon_loss: 1261710.2662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2048339.7789; train_optim_loss: 2048339.7789; val_kl_reg_loss: 10764.2415; val_edge_recon_loss: 744436.3854; val_gene_expr_recon_loss: 1279460.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2034661.4271; val_optim_loss: 2034661.4271
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9793; val_auprc_score: 0.9944; val_best_acc_score: 0.9742; val_best_f1_score: 0.9849; train_kl_reg_loss: 10803.2398; train_edge_recon_loss: 765549.3924; train_gene_expr_recon_loss: 1258173.8229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2034526.4560; train_optim_loss: 2034526.4560; val_kl_reg_loss: 10743.5913; val_edge_recon_loss: 812437.4323; val_gene_expr_recon_loss: 1272738.3646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2095919.3854; val_optim_loss: 2095919.3854
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9887; val_auprc_score: 0.9974; val_best_acc_score: 0.9772; val_best_f1_score: 0.9866; train_kl_reg_loss: 10780.5182; train_edge_recon_loss: 763153.8287; train_gene_expr_recon_loss: 1254769.1748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2028703.5220; train_optim_loss: 2028703.5220; val_kl_reg_loss: 10836.0581; val_edge_recon_loss: 804971.3229; val_gene_expr_recon_loss: 1267640.8542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2083448.2500; val_optim_loss: 2083448.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9875; val_auprc_score: 0.9974; val_best_acc_score: 0.9791; val_best_f1_score: 0.9879; train_kl_reg_loss: 10707.5396; train_edge_recon_loss: 776277.3646; train_gene_expr_recon_loss: 1249874.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2036859.5729; train_optim_loss: 2036859.5729; val_kl_reg_loss: 10709.3167; val_edge_recon_loss: 759098.4427; val_gene_expr_recon_loss: 1258518.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2028325.7604; val_optim_loss: 2028325.7604
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9852; val_auprc_score: 0.9951; val_best_acc_score: 0.9759; val_best_f1_score: 0.9860; train_kl_reg_loss: 10763.5351; train_edge_recon_loss: 769273.5833; train_gene_expr_recon_loss: 1244076.1470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2024113.2639; train_optim_loss: 2024113.2639; val_kl_reg_loss: 10867.4181; val_edge_recon_loss: 779455.6823; val_gene_expr_recon_loss: 1262041.7396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2052364.8542; val_optim_loss: 2052364.8542
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9836; val_auprc_score: 0.9938; val_best_acc_score: 0.9782; val_best_f1_score: 0.9873; train_kl_reg_loss: 10759.9563; train_edge_recon_loss: 771441.1285; train_gene_expr_recon_loss: 1240410.9699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2022612.0532; train_optim_loss: 2022612.0532; val_kl_reg_loss: 10745.6379; val_edge_recon_loss: 775786.3594; val_gene_expr_recon_loss: 1252112.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2038644.1667; val_optim_loss: 2038644.1667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9845; val_auprc_score: 0.9965; val_best_acc_score: 0.9796; val_best_f1_score: 0.9881; train_kl_reg_loss: 10818.9323; train_edge_recon_loss: 777288.5174; train_gene_expr_recon_loss: 1235813.2130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2023920.6690; train_optim_loss: 2023920.6690; val_kl_reg_loss: 10737.2160; val_edge_recon_loss: 772515.6250; val_gene_expr_recon_loss: 1250703.3542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2033956.2188; val_optim_loss: 2033956.2188
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9838; val_auprc_score: 0.9956; val_best_acc_score: 0.9777; val_best_f1_score: 0.9871; train_kl_reg_loss: 10803.1979; train_edge_recon_loss: 767740.1238; train_gene_expr_recon_loss: 1234830.2975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2013373.6146; train_optim_loss: 2013373.6146; val_kl_reg_loss: 10910.7778; val_edge_recon_loss: 734704.2135; val_gene_expr_recon_loss: 1242899.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1988514.8125; val_optim_loss: 1988514.8125
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9851; val_auprc_score: 0.9964; val_best_acc_score: 0.9775; val_best_f1_score: 0.9869; train_kl_reg_loss: 10792.7896; train_edge_recon_loss: 765577.8189; train_gene_expr_recon_loss: 1230474.2905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2006844.9028; train_optim_loss: 2006844.9028; val_kl_reg_loss: 10729.7337; val_edge_recon_loss: 771564.0052; val_gene_expr_recon_loss: 1244399.6354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2026693.3750; val_optim_loss: 2026693.3750
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9823; val_auprc_score: 0.9954; val_best_acc_score: 0.9791; val_best_f1_score: 0.9879; train_kl_reg_loss: 10824.1786; train_edge_recon_loss: 763004.0394; train_gene_expr_recon_loss: 1226837.2905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2000665.5104; train_optim_loss: 2000665.5104; val_kl_reg_loss: 10837.7105; val_edge_recon_loss: 767351.5417; val_gene_expr_recon_loss: 1238129.0729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2016318.3125; val_optim_loss: 2016318.3125
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9879; val_auprc_score: 0.9972; val_best_acc_score: 0.9798; val_best_f1_score: 0.9883; train_kl_reg_loss: 10814.1809; train_edge_recon_loss: 760247.7500; train_gene_expr_recon_loss: 1221860.4549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1992922.3819; train_optim_loss: 1992922.3819; val_kl_reg_loss: 10857.9206; val_edge_recon_loss: 756501.6406; val_gene_expr_recon_loss: 1241944.5104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2009304.0625; val_optim_loss: 2009304.0625
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9853; val_auprc_score: 0.9954; val_best_acc_score: 0.9785; val_best_f1_score: 0.9875; train_kl_reg_loss: 10882.4336; train_edge_recon_loss: 777035.2321; train_gene_expr_recon_loss: 1222079.0035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2009996.6759; train_optim_loss: 2009996.6759; val_kl_reg_loss: 11030.1510; val_edge_recon_loss: 772300.1562; val_gene_expr_recon_loss: 1241955.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2025286.2396; val_optim_loss: 2025286.2396

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9879; val_auprc_score: 0.9966; val_best_acc_score: 0.9792; val_best_f1_score: 0.9879; train_kl_reg_loss: 10886.4105; train_edge_recon_loss: 762392.6991; train_gene_expr_recon_loss: 1213677.8993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1986957.0046; train_optim_loss: 1986957.0046; val_kl_reg_loss: 10791.7214; val_edge_recon_loss: 778426.6510; val_gene_expr_recon_loss: 1236803.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2026021.3854; val_optim_loss: 2026021.3854
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9803; val_auprc_score: 0.9951; val_best_acc_score: 0.9767; val_best_f1_score: 0.9864; train_kl_reg_loss: 10828.7921; train_edge_recon_loss: 765906.5122; train_gene_expr_recon_loss: 1212817.9016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1989553.2037; train_optim_loss: 1989553.2037; val_kl_reg_loss: 10841.5161; val_edge_recon_loss: 786220.9167; val_gene_expr_recon_loss: 1228369.1771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2025431.6042; val_optim_loss: 2025431.6042
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9852; val_auprc_score: 0.9967; val_best_acc_score: 0.9768; val_best_f1_score: 0.9865; train_kl_reg_loss: 10810.0053; train_edge_recon_loss: 759207.4873; train_gene_expr_recon_loss: 1212634.9873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1982652.4826; train_optim_loss: 1982652.4826; val_kl_reg_loss: 10845.2485; val_edge_recon_loss: 795386.2552; val_gene_expr_recon_loss: 1232969.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2039201.1354; val_optim_loss: 2039201.1354
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9857; val_auprc_score: 0.9966; val_best_acc_score: 0.9779; val_best_f1_score: 0.9871; train_kl_reg_loss: 10805.2072; train_edge_recon_loss: 769978.0932; train_gene_expr_recon_loss: 1211685.0116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1992468.3160; train_optim_loss: 1992468.3160; val_kl_reg_loss: 10819.6764; val_edge_recon_loss: 775945.7917; val_gene_expr_recon_loss: 1231860.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2018625.7083; val_optim_loss: 2018625.7083

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 17 min 45 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
val AUROC score: 0.9787
val AUPRC score: 0.9947
val best accuracy score: 0.9739
val best F1 score: 0.9848
val target rna MSE score: 0.8957
val source rna MSE score: 0.2675
Val cat covariate0 mean sim diff: -0.0046
Duration of model training in run 1: 0 hours, 17 minutes and 54 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
