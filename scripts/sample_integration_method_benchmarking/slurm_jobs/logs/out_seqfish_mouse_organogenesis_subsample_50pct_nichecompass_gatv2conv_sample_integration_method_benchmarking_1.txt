Run timestamp: 26082023_174438_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '512', '512', '512', '512', '512', '512', '512', '512', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'celltype_mapped_refined', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_50pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 212411
Number of validation edges: 23601
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9601; val_auprc_score: 0.9916; val_best_acc_score: 0.9472; val_best_f1_score: 0.9696; train_kl_reg_loss: 9745.3035; train_edge_recon_loss: 873110.6691; train_gene_expr_recon_loss: 1885576.8738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2768432.8446; train_optim_loss: 2768432.8446; val_kl_reg_loss: 10481.6956; val_edge_recon_loss: 791736.9654; val_gene_expr_recon_loss: 1728569.2872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2530787.9415; val_optim_loss: 2530787.9415
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9811; val_auprc_score: 0.9951; val_best_acc_score: 0.9713; val_best_f1_score: 0.9833; train_kl_reg_loss: 10346.9809; train_edge_recon_loss: 787400.4453; train_gene_expr_recon_loss: 1672180.5831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2469928.0066; train_optim_loss: 2469928.0066; val_kl_reg_loss: 10134.9115; val_edge_recon_loss: 785145.7553; val_gene_expr_recon_loss: 1626724.8617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2422005.5319; val_optim_loss: 2422005.5319
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9852; val_auprc_score: 0.9960; val_best_acc_score: 0.9767; val_best_f1_score: 0.9864; train_kl_reg_loss: 10003.1406; train_edge_recon_loss: 773321.5392; train_gene_expr_recon_loss: 1591049.6422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2374374.3163; train_optim_loss: 2374374.3163; val_kl_reg_loss: 9555.5864; val_edge_recon_loss: 786680.0718; val_gene_expr_recon_loss: 1559540.1995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2355775.8617; val_optim_loss: 2355775.8617
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9834; val_auprc_score: 0.9959; val_best_acc_score: 0.9778; val_best_f1_score: 0.9871; train_kl_reg_loss: 9597.5346; train_edge_recon_loss: 771263.2467; train_gene_expr_recon_loss: 1525721.2913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2306582.0801; train_optim_loss: 2306582.0801; val_kl_reg_loss: 9335.1771; val_edge_recon_loss: 769824.3524; val_gene_expr_recon_loss: 1493403.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2272563.0160; val_optim_loss: 2272563.0160
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9877; val_auprc_score: 0.9969; val_best_acc_score: 0.9812; val_best_f1_score: 0.9890; train_kl_reg_loss: 9391.8081; train_edge_recon_loss: 772467.8682; train_gene_expr_recon_loss: 1468816.0404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2250675.7163; train_optim_loss: 2250675.7163; val_kl_reg_loss: 9510.9494; val_edge_recon_loss: 781406.7287; val_gene_expr_recon_loss: 1444225.2154; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2235142.9043; val_optim_loss: 2235142.9043
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9875; val_auprc_score: 0.9967; val_best_acc_score: 0.9813; val_best_f1_score: 0.9891; train_kl_reg_loss: 9532.8086; train_edge_recon_loss: 772214.0086; train_gene_expr_recon_loss: 1418732.4569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2200479.2771; train_optim_loss: 2200479.2771; val_kl_reg_loss: 9580.0533; val_edge_recon_loss: 776239.7487; val_gene_expr_recon_loss: 1405492.5186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2191312.3457; val_optim_loss: 2191312.3457
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9882; val_auprc_score: 0.9967; val_best_acc_score: 0.9824; val_best_f1_score: 0.9897; train_kl_reg_loss: 9696.6599; train_edge_recon_loss: 766245.7014; train_gene_expr_recon_loss: 1380248.9596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2156191.3190; train_optim_loss: 2156191.3190; val_kl_reg_loss: 9958.1232; val_edge_recon_loss: 764472.3524; val_gene_expr_recon_loss: 1366807.1170; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2141237.6064; val_optim_loss: 2141237.6064
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9885; val_auprc_score: 0.9961; val_best_acc_score: 0.9843; val_best_f1_score: 0.9909; train_kl_reg_loss: 9958.3305; train_edge_recon_loss: 769488.6443; train_gene_expr_recon_loss: 1348636.5880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2128083.5608; train_optim_loss: 2128083.5608; val_kl_reg_loss: 10082.2004; val_edge_recon_loss: 748070.7500; val_gene_expr_recon_loss: 1338266.9149; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2096419.8644; val_optim_loss: 2096419.8644
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9878; val_auprc_score: 0.9962; val_best_acc_score: 0.9839; val_best_f1_score: 0.9906; train_kl_reg_loss: 10100.3783; train_edge_recon_loss: 763584.2980; train_gene_expr_recon_loss: 1322902.2024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2096586.8861; train_optim_loss: 2096586.8861; val_kl_reg_loss: 10032.4085; val_edge_recon_loss: 782029.4269; val_gene_expr_recon_loss: 1310893.3138; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2102955.1516; val_optim_loss: 2102955.1516
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9906; val_auprc_score: 0.9974; val_best_acc_score: 0.9848; val_best_f1_score: 0.9911; train_kl_reg_loss: 10203.5052; train_edge_recon_loss: 765804.1902; train_gene_expr_recon_loss: 1302801.1596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2078808.8581; train_optim_loss: 2078808.8581; val_kl_reg_loss: 10139.3540; val_edge_recon_loss: 781767.3098; val_gene_expr_recon_loss: 1300900.8856; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2092807.5532; val_optim_loss: 2092807.5532
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9886; val_auprc_score: 0.9973; val_best_acc_score: 0.9838; val_best_f1_score: 0.9906; train_kl_reg_loss: 10376.5598; train_edge_recon_loss: 765740.4059; train_gene_expr_recon_loss: 1286223.1714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2062340.1364; train_optim_loss: 2062340.1364; val_kl_reg_loss: 10514.7024; val_edge_recon_loss: 768181.4761; val_gene_expr_recon_loss: 1287650.2633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2066346.4495; val_optim_loss: 2066346.4495
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9906; val_auprc_score: 0.9974; val_best_acc_score: 0.9867; val_best_f1_score: 0.9923; train_kl_reg_loss: 10508.3418; train_edge_recon_loss: 767821.5581; train_gene_expr_recon_loss: 1271601.1503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2049931.0476; train_optim_loss: 2049931.0476; val_kl_reg_loss: 10654.6207; val_edge_recon_loss: 752656.0545; val_gene_expr_recon_loss: 1279367.5771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2042678.2500; val_optim_loss: 2042678.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9898; val_auprc_score: 0.9970; val_best_acc_score: 0.9855; val_best_f1_score: 0.9916; train_kl_reg_loss: 10563.4441; train_edge_recon_loss: 771624.8803; train_gene_expr_recon_loss: 1261073.5009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2043261.8292; train_optim_loss: 2043261.8292; val_kl_reg_loss: 10538.7865; val_edge_recon_loss: 762218.5093; val_gene_expr_recon_loss: 1261089.2181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2033846.5080; val_optim_loss: 2033846.5080
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9891; val_auprc_score: 0.9969; val_best_acc_score: 0.9859; val_best_f1_score: 0.9918; train_kl_reg_loss: 10630.0867; train_edge_recon_loss: 763592.2348; train_gene_expr_recon_loss: 1249224.0154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2023446.3367; train_optim_loss: 2023446.3367; val_kl_reg_loss: 10826.7665; val_edge_recon_loss: 761225.3670; val_gene_expr_recon_loss: 1252204.8059; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2024256.9335; val_optim_loss: 2024256.9335
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9898; val_auprc_score: 0.9966; val_best_acc_score: 0.9853; val_best_f1_score: 0.9914; train_kl_reg_loss: 10700.9609; train_edge_recon_loss: 769139.7693; train_gene_expr_recon_loss: 1243442.3172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2023283.0434; train_optim_loss: 2023283.0434; val_kl_reg_loss: 10546.1793; val_edge_recon_loss: 770172.2460; val_gene_expr_recon_loss: 1246889.1596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2027607.6011; val_optim_loss: 2027607.6011
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9893; val_auprc_score: 0.9971; val_best_acc_score: 0.9865; val_best_f1_score: 0.9922; train_kl_reg_loss: 10713.5822; train_edge_recon_loss: 766245.3486; train_gene_expr_recon_loss: 1234825.6663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2011784.5991; train_optim_loss: 2011784.5991; val_kl_reg_loss: 10765.3662; val_edge_recon_loss: 762977.7035; val_gene_expr_recon_loss: 1235255.6223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2008998.6941; val_optim_loss: 2008998.6941
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9896; val_auprc_score: 0.9965; val_best_acc_score: 0.9867; val_best_f1_score: 0.9923; train_kl_reg_loss: 10826.0054; train_edge_recon_loss: 770296.0154; train_gene_expr_recon_loss: 1229846.5114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2010968.5349; train_optim_loss: 2010968.5349; val_kl_reg_loss: 10777.9426; val_edge_recon_loss: 763316.8225; val_gene_expr_recon_loss: 1238216.3324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2012311.0824; val_optim_loss: 2012311.0824
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9888; val_auprc_score: 0.9970; val_best_acc_score: 0.9859; val_best_f1_score: 0.9918; train_kl_reg_loss: 10755.5152; train_edge_recon_loss: 764727.5488; train_gene_expr_recon_loss: 1225713.1931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2001196.2611; train_optim_loss: 2001196.2611; val_kl_reg_loss: 10690.7298; val_edge_recon_loss: 759462.2181; val_gene_expr_recon_loss: 1226841.5904; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1996994.5239; val_optim_loss: 1996994.5239
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9894; val_auprc_score: 0.9967; val_best_acc_score: 0.9872; val_best_f1_score: 0.9926; train_kl_reg_loss: 10804.3560; train_edge_recon_loss: 766796.6312; train_gene_expr_recon_loss: 1222527.4527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2000128.4383; train_optim_loss: 2000128.4383; val_kl_reg_loss: 11069.9381; val_edge_recon_loss: 754847.5705; val_gene_expr_recon_loss: 1236069.3324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2001986.8324; val_optim_loss: 2001986.8324
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9911; val_auprc_score: 0.9977; val_best_acc_score: 0.9875; val_best_f1_score: 0.9927; train_kl_reg_loss: 10908.6536; train_edge_recon_loss: 760920.6773; train_gene_expr_recon_loss: 1217136.7596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1988966.0922; train_optim_loss: 1988966.0922; val_kl_reg_loss: 10796.2317; val_edge_recon_loss: 756289.6755; val_gene_expr_recon_loss: 1223310.9122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1990396.8191; val_optim_loss: 1990396.8191
