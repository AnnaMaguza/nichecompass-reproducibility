Run timestamp: 22082023_190833_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '512', '512', '512', '512', '512', '512', '512', '512', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'celltype_mapped_refined', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_5pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 21883
Number of validation edges: 2431
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8660; val_auprc_score: 0.9697; val_best_acc_score: 0.8691; val_best_f1_score: 0.9279; train_kl_reg_loss: 1837.8480; train_edge_recon_loss: 1044949.6206; train_gene_expr_recon_loss: 2330984.6977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3377772.1628; train_optim_loss: 3377772.1628; val_kl_reg_loss: 4194.7098; val_edge_recon_loss: 1220723.7000; val_gene_expr_recon_loss: 2162319.9500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3387238.4000; val_optim_loss: 3387238.4000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8189; val_auprc_score: 0.9565; val_best_acc_score: 0.8729; val_best_f1_score: 0.9304; train_kl_reg_loss: 5942.5744; train_edge_recon_loss: 1004108.0581; train_gene_expr_recon_loss: 2094910.9651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3104961.6105; train_optim_loss: 3104961.6105; val_kl_reg_loss: 7792.4029; val_edge_recon_loss: 1076162.5375; val_gene_expr_recon_loss: 1994205.6500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3078160.6000; val_optim_loss: 3078160.6000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8260; val_auprc_score: 0.9566; val_best_acc_score: 0.8810; val_best_f1_score: 0.9345; train_kl_reg_loss: 7619.3124; train_edge_recon_loss: 964003.8256; train_gene_expr_recon_loss: 1969736.5320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2941359.6802; train_optim_loss: 2941359.6802; val_kl_reg_loss: 8428.4571; val_edge_recon_loss: 963843.2250; val_gene_expr_recon_loss: 1917646.5250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2889918.1500; val_optim_loss: 2889918.1500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8490; val_auprc_score: 0.9658; val_best_acc_score: 0.9007; val_best_f1_score: 0.9440; train_kl_reg_loss: 8170.0822; train_edge_recon_loss: 929657.2762; train_gene_expr_recon_loss: 1911525.3895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2849352.7267; train_optim_loss: 2849352.7267; val_kl_reg_loss: 7786.3312; val_edge_recon_loss: 870772.8875; val_gene_expr_recon_loss: 1877199.7000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2755758.9000; val_optim_loss: 2755758.9000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8455; val_auprc_score: 0.9604; val_best_acc_score: 0.9056; val_best_f1_score: 0.9469; train_kl_reg_loss: 8953.2481; train_edge_recon_loss: 902865.8837; train_gene_expr_recon_loss: 1881278.8576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2793098.0000; train_optim_loss: 2793098.0000; val_kl_reg_loss: 10345.9652; val_edge_recon_loss: 889639.7500; val_gene_expr_recon_loss: 1867532.3500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2767518.0500; val_optim_loss: 2767518.0500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8639; val_auprc_score: 0.9581; val_best_acc_score: 0.9173; val_best_f1_score: 0.9529; train_kl_reg_loss: 11101.9956; train_edge_recon_loss: 825944.1453; train_gene_expr_recon_loss: 1856648.5494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2693694.6628; train_optim_loss: 2693694.6628; val_kl_reg_loss: 12208.1846; val_edge_recon_loss: 860240.5500; val_gene_expr_recon_loss: 1836983.2250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2709432.0000; val_optim_loss: 2709432.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8754; val_auprc_score: 0.9663; val_best_acc_score: 0.9205; val_best_f1_score: 0.9545; train_kl_reg_loss: 12514.0925; train_edge_recon_loss: 862556.9172; train_gene_expr_recon_loss: 1835223.5116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2710294.5465; train_optim_loss: 2710294.5465; val_kl_reg_loss: 12407.2588; val_edge_recon_loss: 872642.3375; val_gene_expr_recon_loss: 1811082.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2696132.0000; val_optim_loss: 2696132.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8732; val_auprc_score: 0.9679; val_best_acc_score: 0.9305; val_best_f1_score: 0.9607; train_kl_reg_loss: 12684.1190; train_edge_recon_loss: 827744.7049; train_gene_expr_recon_loss: 1811176.2035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2651605.0174; train_optim_loss: 2651605.0174; val_kl_reg_loss: 13330.6717; val_edge_recon_loss: 794793.2125; val_gene_expr_recon_loss: 1796108.8250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2604232.7500; val_optim_loss: 2604232.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8933; val_auprc_score: 0.9688; val_best_acc_score: 0.9327; val_best_f1_score: 0.9615; train_kl_reg_loss: 13158.9286; train_edge_recon_loss: 810839.3328; train_gene_expr_recon_loss: 1794215.1919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2618213.4593; train_optim_loss: 2618213.4593; val_kl_reg_loss: 12671.9465; val_edge_recon_loss: 823828.2500; val_gene_expr_recon_loss: 1771298.6750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2607798.8500; val_optim_loss: 2607798.8500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8876; val_auprc_score: 0.9644; val_best_acc_score: 0.9236; val_best_f1_score: 0.9558; train_kl_reg_loss: 12566.4800; train_edge_recon_loss: 812850.2180; train_gene_expr_recon_loss: 1774300.7791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2599717.4826; train_optim_loss: 2599717.4826; val_kl_reg_loss: 12819.3121; val_edge_recon_loss: 895530.7875; val_gene_expr_recon_loss: 1775790.6500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2684140.7500; val_optim_loss: 2684140.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9044; val_auprc_score: 0.9723; val_best_acc_score: 0.9281; val_best_f1_score: 0.9590; train_kl_reg_loss: 12725.3995; train_edge_recon_loss: 828157.5087; train_gene_expr_recon_loss: 1761259.1424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2602142.0523; train_optim_loss: 2602142.0523; val_kl_reg_loss: 12124.7857; val_edge_recon_loss: 823788.4000; val_gene_expr_recon_loss: 1746112.4250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2582025.7000; val_optim_loss: 2582025.7000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8907; val_auprc_score: 0.9732; val_best_acc_score: 0.9286; val_best_f1_score: 0.9595; train_kl_reg_loss: 12103.1110; train_edge_recon_loss: 836658.9346; train_gene_expr_recon_loss: 1749662.3721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2598424.4128; train_optim_loss: 2598424.4128; val_kl_reg_loss: 12457.0666; val_edge_recon_loss: 811913.5875; val_gene_expr_recon_loss: 1751101.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2575472.0500; val_optim_loss: 2575472.0500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9082; val_auprc_score: 0.9755; val_best_acc_score: 0.9230; val_best_f1_score: 0.9562; train_kl_reg_loss: 12031.0821; train_edge_recon_loss: 822916.1584; train_gene_expr_recon_loss: 1741489.1337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2576436.3779; train_optim_loss: 2576436.3779; val_kl_reg_loss: 12262.6635; val_edge_recon_loss: 825680.0875; val_gene_expr_recon_loss: 1729436.5750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2567379.3000; val_optim_loss: 2567379.3000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9004; val_auprc_score: 0.9688; val_best_acc_score: 0.9350; val_best_f1_score: 0.9626; train_kl_reg_loss: 12056.5600; train_edge_recon_loss: 811944.1090; train_gene_expr_recon_loss: 1726962.1860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2550962.8547; train_optim_loss: 2550962.8547; val_kl_reg_loss: 11885.8318; val_edge_recon_loss: 812201.6375; val_gene_expr_recon_loss: 1710130.2250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2534217.6500; val_optim_loss: 2534217.6500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9148; val_auprc_score: 0.9732; val_best_acc_score: 0.9396; val_best_f1_score: 0.9650; train_kl_reg_loss: 11766.6187; train_edge_recon_loss: 806709.6003; train_gene_expr_recon_loss: 1712292.3285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2530768.5349; train_optim_loss: 2530768.5349; val_kl_reg_loss: 11895.0605; val_edge_recon_loss: 831068.0250; val_gene_expr_recon_loss: 1706594.8500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2549557.9000; val_optim_loss: 2549557.9000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9204; val_auprc_score: 0.9775; val_best_acc_score: 0.9427; val_best_f1_score: 0.9670; train_kl_reg_loss: 11854.0731; train_edge_recon_loss: 786889.2297; train_gene_expr_recon_loss: 1702705.3081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2501448.6047; train_optim_loss: 2501448.6047; val_kl_reg_loss: 11374.2117; val_edge_recon_loss: 795416.4250; val_gene_expr_recon_loss: 1687016.9250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2493807.5500; val_optim_loss: 2493807.5500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9106; val_auprc_score: 0.9717; val_best_acc_score: 0.9395; val_best_f1_score: 0.9652; train_kl_reg_loss: 11652.0378; train_edge_recon_loss: 809694.0480; train_gene_expr_recon_loss: 1689389.2674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2510735.3605; train_optim_loss: 2510735.3605; val_kl_reg_loss: 11674.5756; val_edge_recon_loss: 836459.1875; val_gene_expr_recon_loss: 1679208.1750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2527341.9500; val_optim_loss: 2527341.9500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9147; val_auprc_score: 0.9776; val_best_acc_score: 0.9444; val_best_f1_score: 0.9681; train_kl_reg_loss: 11471.1083; train_edge_recon_loss: 790031.5988; train_gene_expr_recon_loss: 1688322.4099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2489825.1279; train_optim_loss: 2489825.1279; val_kl_reg_loss: 11704.6855; val_edge_recon_loss: 802812.6125; val_gene_expr_recon_loss: 1673965.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2488483.1500; val_optim_loss: 2488483.1500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9297; val_auprc_score: 0.9781; val_best_acc_score: 0.9454; val_best_f1_score: 0.9687; train_kl_reg_loss: 11371.7532; train_edge_recon_loss: 800060.2631; train_gene_expr_recon_loss: 1680029.6686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2491461.6744; train_optim_loss: 2491461.6744; val_kl_reg_loss: 11314.1660; val_edge_recon_loss: 814417.8500; val_gene_expr_recon_loss: 1671263.4250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2496995.4500; val_optim_loss: 2496995.4500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9202; val_auprc_score: 0.9724; val_best_acc_score: 0.9474; val_best_f1_score: 0.9698; train_kl_reg_loss: 11222.9365; train_edge_recon_loss: 804663.7166; train_gene_expr_recon_loss: 1665355.6308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2481242.2791; train_optim_loss: 2481242.2791; val_kl_reg_loss: 11593.2016; val_edge_recon_loss: 812715.3000; val_gene_expr_recon_loss: 1665004.0500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2489312.5500; val_optim_loss: 2489312.5500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9305; val_auprc_score: 0.9779; val_best_acc_score: 0.9466; val_best_f1_score: 0.9688; train_kl_reg_loss: 11457.8456; train_edge_recon_loss: 801574.8765; train_gene_expr_recon_loss: 1661348.2936; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2474381.0174; train_optim_loss: 2474381.0174; val_kl_reg_loss: 11736.1785; val_edge_recon_loss: 885974.9625; val_gene_expr_recon_loss: 1653161.8250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2550873.0000; val_optim_loss: 2550873.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9404; val_auprc_score: 0.9793; val_best_acc_score: 0.9581; val_best_f1_score: 0.9760; train_kl_reg_loss: 11478.3583; train_edge_recon_loss: 792317.3140; train_gene_expr_recon_loss: 1651569.2180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2455364.9186; train_optim_loss: 2455364.9186; val_kl_reg_loss: 11398.2686; val_edge_recon_loss: 750816.2750; val_gene_expr_recon_loss: 1653710.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2415925.1500; val_optim_loss: 2415925.1500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9401; val_auprc_score: 0.9801; val_best_acc_score: 0.9549; val_best_f1_score: 0.9738; train_kl_reg_loss: 10964.1587; train_edge_recon_loss: 793796.4942; train_gene_expr_recon_loss: 1648932.2209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2453692.8488; train_optim_loss: 2453692.8488; val_kl_reg_loss: 10929.1072; val_edge_recon_loss: 798902.1875; val_gene_expr_recon_loss: 1650238.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2460069.5000; val_optim_loss: 2460069.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9287; val_auprc_score: 0.9735; val_best_acc_score: 0.9531; val_best_f1_score: 0.9729; train_kl_reg_loss: 10922.1936; train_edge_recon_loss: 802840.8416; train_gene_expr_recon_loss: 1642375.8430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2456138.8721; train_optim_loss: 2456138.8721; val_kl_reg_loss: 10887.7818; val_edge_recon_loss: 803900.4250; val_gene_expr_recon_loss: 1638646.9500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2453435.2000; val_optim_loss: 2453435.2000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9358; val_auprc_score: 0.9802; val_best_acc_score: 0.9511; val_best_f1_score: 0.9716; train_kl_reg_loss: 10844.4520; train_edge_recon_loss: 782698.8634; train_gene_expr_recon_loss: 1632924.6919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2426467.9942; train_optim_loss: 2426467.9942; val_kl_reg_loss: 10652.4695; val_edge_recon_loss: 815378.0000; val_gene_expr_recon_loss: 1626025.9500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2452056.4000; val_optim_loss: 2452056.4000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9453; val_auprc_score: 0.9867; val_best_acc_score: 0.9545; val_best_f1_score: 0.9740; train_kl_reg_loss: 10705.9703; train_edge_recon_loss: 798769.4578; train_gene_expr_recon_loss: 1621590.2820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2431065.7035; train_optim_loss: 2431065.7035; val_kl_reg_loss: 10702.4734; val_edge_recon_loss: 765337.7875; val_gene_expr_recon_loss: 1620476.6500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2396516.9000; val_optim_loss: 2396516.9000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9350; val_auprc_score: 0.9788; val_best_acc_score: 0.9556; val_best_f1_score: 0.9745; train_kl_reg_loss: 10842.7997; train_edge_recon_loss: 785095.5727; train_gene_expr_recon_loss: 1624193.8663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2420132.1977; train_optim_loss: 2420132.1977; val_kl_reg_loss: 10685.5287; val_edge_recon_loss: 771944.5500; val_gene_expr_recon_loss: 1621801.3250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2404431.4000; val_optim_loss: 2404431.4000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9263; val_auprc_score: 0.9773; val_best_acc_score: 0.9454; val_best_f1_score: 0.9685; train_kl_reg_loss: 10872.2420; train_edge_recon_loss: 804061.8299; train_gene_expr_recon_loss: 1612574.8343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2427508.9012; train_optim_loss: 2427508.9012; val_kl_reg_loss: 11486.4396; val_edge_recon_loss: 845870.3000; val_gene_expr_recon_loss: 1609262.3250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2466619.0500; val_optim_loss: 2466619.0500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9396; val_auprc_score: 0.9807; val_best_acc_score: 0.9618; val_best_f1_score: 0.9779; train_kl_reg_loss: 10922.8866; train_edge_recon_loss: 774170.0872; train_gene_expr_recon_loss: 1605926.1308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2391019.1047; train_optim_loss: 2391019.1047; val_kl_reg_loss: 11117.8037; val_edge_recon_loss: 773385.1500; val_gene_expr_recon_loss: 1606615.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2391118.6000; val_optim_loss: 2391118.6000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9322; val_auprc_score: 0.9764; val_best_acc_score: 0.9481; val_best_f1_score: 0.9700; train_kl_reg_loss: 10825.1958; train_edge_recon_loss: 770554.0015; train_gene_expr_recon_loss: 1596166.2209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2377545.4070; train_optim_loss: 2377545.4070; val_kl_reg_loss: 10732.4867; val_edge_recon_loss: 831370.7375; val_gene_expr_recon_loss: 1586427.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2428530.5500; val_optim_loss: 2428530.5500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9318; val_auprc_score: 0.9812; val_best_acc_score: 0.9578; val_best_f1_score: 0.9759; train_kl_reg_loss: 10628.7496; train_edge_recon_loss: 793892.3198; train_gene_expr_recon_loss: 1591942.0988; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2396463.1686; train_optim_loss: 2396463.1686; val_kl_reg_loss: 10748.8930; val_edge_recon_loss: 732178.6750; val_gene_expr_recon_loss: 1593791.2750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2336718.8500; val_optim_loss: 2336718.8500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9291; val_auprc_score: 0.9792; val_best_acc_score: 0.9592; val_best_f1_score: 0.9767; train_kl_reg_loss: 10677.3656; train_edge_recon_loss: 799365.9041; train_gene_expr_recon_loss: 1586694.7151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2396737.9942; train_optim_loss: 2396737.9942; val_kl_reg_loss: 10884.1088; val_edge_recon_loss: 751297.9500; val_gene_expr_recon_loss: 1588625.9750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2350807.9500; val_optim_loss: 2350807.9500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9397; val_auprc_score: 0.9845; val_best_acc_score: 0.9561; val_best_f1_score: 0.9748; train_kl_reg_loss: 10718.0952; train_edge_recon_loss: 769735.8038; train_gene_expr_recon_loss: 1576455.0669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2356908.9709; train_optim_loss: 2356908.9709; val_kl_reg_loss: 10881.1391; val_edge_recon_loss: 788636.5625; val_gene_expr_recon_loss: 1578246.1750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2377763.8500; val_optim_loss: 2377763.8500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9264; val_auprc_score: 0.9775; val_best_acc_score: 0.9531; val_best_f1_score: 0.9730; train_kl_reg_loss: 10748.9739; train_edge_recon_loss: 771871.8285; train_gene_expr_recon_loss: 1573609.4390; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2356230.2500; train_optim_loss: 2356230.2500; val_kl_reg_loss: 10860.5656; val_edge_recon_loss: 806915.4000; val_gene_expr_recon_loss: 1586554.5500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2404330.4500; val_optim_loss: 2404330.4500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9484; val_auprc_score: 0.9859; val_best_acc_score: 0.9586; val_best_f1_score: 0.9760; train_kl_reg_loss: 10706.4108; train_edge_recon_loss: 790239.4942; train_gene_expr_recon_loss: 1563861.2209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2364807.1221; train_optim_loss: 2364807.1221; val_kl_reg_loss: 10570.9424; val_edge_recon_loss: 779944.1375; val_gene_expr_recon_loss: 1563865.5250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2354380.6500; val_optim_loss: 2354380.6500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9412; val_auprc_score: 0.9814; val_best_acc_score: 0.9568; val_best_f1_score: 0.9749; train_kl_reg_loss: 10531.1958; train_edge_recon_loss: 793374.1323; train_gene_expr_recon_loss: 1553545.5756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2357450.8895; train_optim_loss: 2357450.8895; val_kl_reg_loss: 10657.5443; val_edge_recon_loss: 816058.9750; val_gene_expr_recon_loss: 1574961.7250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2401678.2500; val_optim_loss: 2401678.2500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9423; val_auprc_score: 0.9859; val_best_acc_score: 0.9542; val_best_f1_score: 0.9734; train_kl_reg_loss: 10655.6745; train_edge_recon_loss: 787857.9738; train_gene_expr_recon_loss: 1549774.4622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2348288.1279; train_optim_loss: 2348288.1279; val_kl_reg_loss: 10793.4434; val_edge_recon_loss: 813697.2875; val_gene_expr_recon_loss: 1559712.3250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2384203.0500; val_optim_loss: 2384203.0500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9287; val_auprc_score: 0.9808; val_best_acc_score: 0.9507; val_best_f1_score: 0.9714; train_kl_reg_loss: 10723.1997; train_edge_recon_loss: 776868.6584; train_gene_expr_recon_loss: 1552539.6686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2340131.5000; train_optim_loss: 2340131.5000; val_kl_reg_loss: 10775.3842; val_edge_recon_loss: 826651.0625; val_gene_expr_recon_loss: 1575106.8250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2412533.3000; val_optim_loss: 2412533.3000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9314; val_auprc_score: 0.9760; val_best_acc_score: 0.9545; val_best_f1_score: 0.9737; train_kl_reg_loss: 10766.4513; train_edge_recon_loss: 780398.6221; train_gene_expr_recon_loss: 1548547.0029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2339712.0930; train_optim_loss: 2339712.0930; val_kl_reg_loss: 10857.5428; val_edge_recon_loss: 805026.2875; val_gene_expr_recon_loss: 1570550.8500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2386434.7000; val_optim_loss: 2386434.7000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 34 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
val AUROC score: 0.9333
val AUPRC score: 0.9795
val best accuracy score: 0.9605
val best F1 score: 0.9773
val target rna MSE score: 0.9529
val source rna MSE score: 0.1632
Val cat covariate0 mean sim diff: 0.0099
Duration of model training in run 8: 0 hours, 4 minutes and 44 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 21883
Number of validation edges: 2431
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8703; val_auprc_score: 0.9672; val_best_acc_score: 0.8759; val_best_f1_score: 0.9324; train_kl_reg_loss: 3371.9548; train_edge_recon_loss: 1028732.2849; train_gene_expr_recon_loss: 2357679.4651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3389783.6977; train_optim_loss: 3389783.6977; val_kl_reg_loss: 6535.9684; val_edge_recon_loss: 1154587.6500; val_gene_expr_recon_loss: 2183015.9500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3344139.6500; val_optim_loss: 3344139.6500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8118; val_auprc_score: 0.9567; val_best_acc_score: 0.8819; val_best_f1_score: 0.9361; train_kl_reg_loss: 8807.3800; train_edge_recon_loss: 1019914.8081; train_gene_expr_recon_loss: 2121824.9709; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3150547.1570; train_optim_loss: 3150547.1570; val_kl_reg_loss: 9511.1027; val_edge_recon_loss: 987314.0750; val_gene_expr_recon_loss: 2012624.1500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3009449.3000; val_optim_loss: 3009449.3000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8357; val_auprc_score: 0.9598; val_best_acc_score: 0.8865; val_best_f1_score: 0.9370; train_kl_reg_loss: 10003.7686; train_edge_recon_loss: 1020410.7064; train_gene_expr_recon_loss: 1996894.9535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3027309.4186; train_optim_loss: 3027309.4186; val_kl_reg_loss: 7578.3958; val_edge_recon_loss: 994929.7250; val_gene_expr_recon_loss: 1939757.9000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2942266.1000; val_optim_loss: 2942266.1000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8524; val_auprc_score: 0.9663; val_best_acc_score: 0.8934; val_best_f1_score: 0.9404; train_kl_reg_loss: 7846.1335; train_edge_recon_loss: 905053.1599; train_gene_expr_recon_loss: 1945378.5698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2858277.8663; train_optim_loss: 2858277.8663; val_kl_reg_loss: 8692.4044; val_edge_recon_loss: 872674.3250; val_gene_expr_recon_loss: 1903407.2250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2784773.9500; val_optim_loss: 2784773.9500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8760; val_auprc_score: 0.9707; val_best_acc_score: 0.9048; val_best_f1_score: 0.9466; train_kl_reg_loss: 10119.3223; train_edge_recon_loss: 875823.9346; train_gene_expr_recon_loss: 1909341.7006; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2795284.9593; train_optim_loss: 2795284.9593; val_kl_reg_loss: 11570.3596; val_edge_recon_loss: 879143.7125; val_gene_expr_recon_loss: 1852029.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2742743.9000; val_optim_loss: 2742743.9000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8787; val_auprc_score: 0.9669; val_best_acc_score: 0.9225; val_best_f1_score: 0.9556; train_kl_reg_loss: 12539.7682; train_edge_recon_loss: 846115.6163; train_gene_expr_recon_loss: 1872424.7413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2731080.1105; train_optim_loss: 2731080.1105; val_kl_reg_loss: 12696.2936; val_edge_recon_loss: 845824.1375; val_gene_expr_recon_loss: 1837913.1000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2696433.4500; val_optim_loss: 2696433.4500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8845; val_auprc_score: 0.9691; val_best_acc_score: 0.9226; val_best_f1_score: 0.9563; train_kl_reg_loss: 13117.9227; train_edge_recon_loss: 829572.3692; train_gene_expr_recon_loss: 1845496.1628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2688186.4593; train_optim_loss: 2688186.4593; val_kl_reg_loss: 14179.1838; val_edge_recon_loss: 810542.9375; val_gene_expr_recon_loss: 1808766.5750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2633488.7000; val_optim_loss: 2633488.7000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9009; val_auprc_score: 0.9753; val_best_acc_score: 0.9337; val_best_f1_score: 0.9623; train_kl_reg_loss: 13640.5801; train_edge_recon_loss: 830205.3198; train_gene_expr_recon_loss: 1818996.0378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2662841.9593; train_optim_loss: 2662841.9593; val_kl_reg_loss: 13097.6574; val_edge_recon_loss: 818488.9750; val_gene_expr_recon_loss: 1774068.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2605655.3000; val_optim_loss: 2605655.3000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8974; val_auprc_score: 0.9743; val_best_acc_score: 0.9379; val_best_f1_score: 0.9646; train_kl_reg_loss: 14073.2713; train_edge_recon_loss: 817068.1395; train_gene_expr_recon_loss: 1796867.6366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2628009.0872; train_optim_loss: 2628009.0872; val_kl_reg_loss: 13805.1541; val_edge_recon_loss: 795896.2375; val_gene_expr_recon_loss: 1763582.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2573283.9500; val_optim_loss: 2573283.9500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8978; val_auprc_score: 0.9726; val_best_acc_score: 0.9324; val_best_f1_score: 0.9614; train_kl_reg_loss: 14270.6796; train_edge_recon_loss: 838201.5291; train_gene_expr_recon_loss: 1778384.8721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2630857.0872; train_optim_loss: 2630857.0872; val_kl_reg_loss: 13663.6695; val_edge_recon_loss: 843263.7250; val_gene_expr_recon_loss: 1746146.7000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2603074.0500; val_optim_loss: 2603074.0500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9147; val_auprc_score: 0.9792; val_best_acc_score: 0.9396; val_best_f1_score: 0.9653; train_kl_reg_loss: 14403.8291; train_edge_recon_loss: 823982.8488; train_gene_expr_recon_loss: 1771065.1977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2609451.8837; train_optim_loss: 2609451.8837; val_kl_reg_loss: 13867.1115; val_edge_recon_loss: 807624.4625; val_gene_expr_recon_loss: 1740705.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2562197.3000; val_optim_loss: 2562197.3000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9000; val_auprc_score: 0.9721; val_best_acc_score: 0.9384; val_best_f1_score: 0.9648; train_kl_reg_loss: 13644.2077; train_edge_recon_loss: 829816.4157; train_gene_expr_recon_loss: 1753038.6541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2596499.2733; train_optim_loss: 2596499.2733; val_kl_reg_loss: 13135.7881; val_edge_recon_loss: 797231.3000; val_gene_expr_recon_loss: 1726232.4250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2536599.5000; val_optim_loss: 2536599.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9028; val_auprc_score: 0.9709; val_best_acc_score: 0.9338; val_best_f1_score: 0.9624; train_kl_reg_loss: 13589.1997; train_edge_recon_loss: 803881.5596; train_gene_expr_recon_loss: 1744943.5930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2562414.3430; train_optim_loss: 2562414.3430; val_kl_reg_loss: 14030.6350; val_edge_recon_loss: 783459.7500; val_gene_expr_recon_loss: 1722683.1500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2520173.5500; val_optim_loss: 2520173.5500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9058; val_auprc_score: 0.9775; val_best_acc_score: 0.9311; val_best_f1_score: 0.9608; train_kl_reg_loss: 13497.3155; train_edge_recon_loss: 815804.0480; train_gene_expr_recon_loss: 1726668.9855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2555970.3605; train_optim_loss: 2555970.3605; val_kl_reg_loss: 13349.0387; val_edge_recon_loss: 815452.8125; val_gene_expr_recon_loss: 1703924.3000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2532726.2000; val_optim_loss: 2532726.2000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9070; val_auprc_score: 0.9740; val_best_acc_score: 0.9348; val_best_f1_score: 0.9630; train_kl_reg_loss: 13598.9340; train_edge_recon_loss: 812830.7791; train_gene_expr_recon_loss: 1714313.1366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2540742.8663; train_optim_loss: 2540742.8663; val_kl_reg_loss: 13699.7771; val_edge_recon_loss: 803794.4500; val_gene_expr_recon_loss: 1696383.1750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2513877.4000; val_optim_loss: 2513877.4000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9028; val_auprc_score: 0.9737; val_best_acc_score: 0.9361; val_best_f1_score: 0.9637; train_kl_reg_loss: 13523.0788; train_edge_recon_loss: 793397.0785; train_gene_expr_recon_loss: 1705160.2413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2512080.4128; train_optim_loss: 2512080.4128; val_kl_reg_loss: 12924.2129; val_edge_recon_loss: 812402.6250; val_gene_expr_recon_loss: 1693646.7750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2518973.6000; val_optim_loss: 2518973.6000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9375; val_auprc_score: 0.9839; val_best_acc_score: 0.9496; val_best_f1_score: 0.9710; train_kl_reg_loss: 13318.0287; train_edge_recon_loss: 798144.1672; train_gene_expr_recon_loss: 1700098.5640; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2511560.7558; train_optim_loss: 2511560.7558; val_kl_reg_loss: 12821.1328; val_edge_recon_loss: 791546.5875; val_gene_expr_recon_loss: 1674007.9000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2478375.5500; val_optim_loss: 2478375.5500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9176; val_auprc_score: 0.9753; val_best_acc_score: 0.9397; val_best_f1_score: 0.9653; train_kl_reg_loss: 13136.7510; train_edge_recon_loss: 797589.7020; train_gene_expr_recon_loss: 1687337.4593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2498063.9244; train_optim_loss: 2498063.9244; val_kl_reg_loss: 12910.2570; val_edge_recon_loss: 847474.2375; val_gene_expr_recon_loss: 1669084.2250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2529468.7000; val_optim_loss: 2529468.7000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9267; val_auprc_score: 0.9759; val_best_acc_score: 0.9525; val_best_f1_score: 0.9725; train_kl_reg_loss: 12889.0394; train_edge_recon_loss: 813044.4782; train_gene_expr_recon_loss: 1679760.5843; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2505694.1163; train_optim_loss: 2505694.1163; val_kl_reg_loss: 13018.8953; val_edge_recon_loss: 810619.5000; val_gene_expr_recon_loss: 1660332.9750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2483971.4000; val_optim_loss: 2483971.4000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9281; val_auprc_score: 0.9775; val_best_acc_score: 0.9463; val_best_f1_score: 0.9695; train_kl_reg_loss: 12649.5189; train_edge_recon_loss: 792735.2311; train_gene_expr_recon_loss: 1666867.0669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2472251.8256; train_optim_loss: 2472251.8256; val_kl_reg_loss: 12611.0748; val_edge_recon_loss: 780875.5250; val_gene_expr_recon_loss: 1652883.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2446370.4000; val_optim_loss: 2446370.4000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9379; val_auprc_score: 0.9835; val_best_acc_score: 0.9459; val_best_f1_score: 0.9687; train_kl_reg_loss: 12467.4458; train_edge_recon_loss: 823368.7456; train_gene_expr_recon_loss: 1659636.5727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2495472.7558; train_optim_loss: 2495472.7558; val_kl_reg_loss: 12589.3514; val_edge_recon_loss: 860452.8500; val_gene_expr_recon_loss: 1639205.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2512247.6500; val_optim_loss: 2512247.6500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9279; val_auprc_score: 0.9798; val_best_acc_score: 0.9510; val_best_f1_score: 0.9720; train_kl_reg_loss: 12379.2109; train_edge_recon_loss: 811040.1541; train_gene_expr_recon_loss: 1653417.4302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2476836.8023; train_optim_loss: 2476836.8023; val_kl_reg_loss: 12588.5680; val_edge_recon_loss: 779871.9625; val_gene_expr_recon_loss: 1637646.4500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2430106.9500; val_optim_loss: 2430106.9500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9342; val_auprc_score: 0.9803; val_best_acc_score: 0.9516; val_best_f1_score: 0.9722; train_kl_reg_loss: 12360.3037; train_edge_recon_loss: 794000.6948; train_gene_expr_recon_loss: 1646538.4070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2452899.4128; train_optim_loss: 2452899.4128; val_kl_reg_loss: 12089.6156; val_edge_recon_loss: 808541.9375; val_gene_expr_recon_loss: 1633660.0250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2454291.6000; val_optim_loss: 2454291.6000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9291; val_auprc_score: 0.9817; val_best_acc_score: 0.9575; val_best_f1_score: 0.9758; train_kl_reg_loss: 12274.1484; train_edge_recon_loss: 788574.1933; train_gene_expr_recon_loss: 1634911.3837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2435759.7326; train_optim_loss: 2435759.7326; val_kl_reg_loss: 12188.0625; val_edge_recon_loss: 742433.1375; val_gene_expr_recon_loss: 1626637.0500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2381258.2000; val_optim_loss: 2381258.2000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9396; val_auprc_score: 0.9832; val_best_acc_score: 0.9543; val_best_f1_score: 0.9738; train_kl_reg_loss: 12328.3420; train_edge_recon_loss: 805205.3750; train_gene_expr_recon_loss: 1629982.1192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2447515.8372; train_optim_loss: 2447515.8372; val_kl_reg_loss: 12190.2592; val_edge_recon_loss: 791949.7625; val_gene_expr_recon_loss: 1619429.1500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2423569.1000; val_optim_loss: 2423569.1000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9324; val_auprc_score: 0.9817; val_best_acc_score: 0.9541; val_best_f1_score: 0.9737; train_kl_reg_loss: 12217.6779; train_edge_recon_loss: 782874.1381; train_gene_expr_recon_loss: 1619517.9331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2414609.7442; train_optim_loss: 2414609.7442; val_kl_reg_loss: 12118.9248; val_edge_recon_loss: 786819.1375; val_gene_expr_recon_loss: 1597938.6500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2396876.7500; val_optim_loss: 2396876.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9369; val_auprc_score: 0.9810; val_best_acc_score: 0.9584; val_best_f1_score: 0.9763; train_kl_reg_loss: 11941.2150; train_edge_recon_loss: 795590.7616; train_gene_expr_recon_loss: 1617583.7791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2425115.7442; train_optim_loss: 2425115.7442; val_kl_reg_loss: 11790.7271; val_edge_recon_loss: 724116.4125; val_gene_expr_recon_loss: 1607362.1000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2343269.2500; val_optim_loss: 2343269.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9356; val_auprc_score: 0.9840; val_best_acc_score: 0.9565; val_best_f1_score: 0.9751; train_kl_reg_loss: 11796.8601; train_edge_recon_loss: 795607.3154; train_gene_expr_recon_loss: 1613751.1308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2421155.3140; train_optim_loss: 2421155.3140; val_kl_reg_loss: 11464.8721; val_edge_recon_loss: 760518.5875; val_gene_expr_recon_loss: 1591098.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2363081.5500; val_optim_loss: 2363081.5500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9297; val_auprc_score: 0.9776; val_best_acc_score: 0.9540; val_best_f1_score: 0.9736; train_kl_reg_loss: 11601.8007; train_edge_recon_loss: 798790.2485; train_gene_expr_recon_loss: 1601768.8052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2412160.8605; train_optim_loss: 2412160.8605; val_kl_reg_loss: 11824.6254; val_edge_recon_loss: 801403.7500; val_gene_expr_recon_loss: 1590543.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2403772.0500; val_optim_loss: 2403772.0500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9517; val_auprc_score: 0.9830; val_best_acc_score: 0.9602; val_best_f1_score: 0.9770; train_kl_reg_loss: 11556.3856; train_edge_recon_loss: 783576.9346; train_gene_expr_recon_loss: 1601259.1512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2396392.4826; train_optim_loss: 2396392.4826; val_kl_reg_loss: 11631.1020; val_edge_recon_loss: 784109.5250; val_gene_expr_recon_loss: 1595857.3250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2391597.9500; val_optim_loss: 2391597.9500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9472; val_auprc_score: 0.9859; val_best_acc_score: 0.9622; val_best_f1_score: 0.9783; train_kl_reg_loss: 11576.9078; train_edge_recon_loss: 812548.1541; train_gene_expr_recon_loss: 1592340.2849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2416465.3372; train_optim_loss: 2416465.3372; val_kl_reg_loss: 11705.2234; val_edge_recon_loss: 753286.1625; val_gene_expr_recon_loss: 1581686.5500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2346677.9000; val_optim_loss: 2346677.9000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9160; val_auprc_score: 0.9753; val_best_acc_score: 0.9472; val_best_f1_score: 0.9701; train_kl_reg_loss: 11645.4272; train_edge_recon_loss: 783033.6424; train_gene_expr_recon_loss: 1585658.3052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2380337.3605; train_optim_loss: 2380337.3605; val_kl_reg_loss: 11732.7496; val_edge_recon_loss: 784257.3625; val_gene_expr_recon_loss: 1578511.7750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2374501.8500; val_optim_loss: 2374501.8500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9180; val_auprc_score: 0.9759; val_best_acc_score: 0.9569; val_best_f1_score: 0.9756; train_kl_reg_loss: 11726.1381; train_edge_recon_loss: 792823.3605; train_gene_expr_recon_loss: 1577056.1337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2381605.6337; train_optim_loss: 2381605.6337; val_kl_reg_loss: 11764.7689; val_edge_recon_loss: 730708.4000; val_gene_expr_recon_loss: 1568349.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2310822.4000; val_optim_loss: 2310822.4000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9496; val_auprc_score: 0.9861; val_best_acc_score: 0.9650; val_best_f1_score: 0.9799; train_kl_reg_loss: 11794.7771; train_edge_recon_loss: 789489.1352; train_gene_expr_recon_loss: 1577570.3663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2378854.2674; train_optim_loss: 2378854.2674; val_kl_reg_loss: 11826.2373; val_edge_recon_loss: 749088.8000; val_gene_expr_recon_loss: 1569761.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2330676.4000; val_optim_loss: 2330676.4000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9361; val_auprc_score: 0.9803; val_best_acc_score: 0.9558; val_best_f1_score: 0.9744; train_kl_reg_loss: 11910.4871; train_edge_recon_loss: 790890.7820; train_gene_expr_recon_loss: 1578775.5610; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2381576.8140; train_optim_loss: 2381576.8140; val_kl_reg_loss: 11924.9754; val_edge_recon_loss: 835281.9875; val_gene_expr_recon_loss: 1574053.4500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2421260.4500; val_optim_loss: 2421260.4500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9335; val_auprc_score: 0.9805; val_best_acc_score: 0.9560; val_best_f1_score: 0.9750; train_kl_reg_loss: 11990.4683; train_edge_recon_loss: 796096.0741; train_gene_expr_recon_loss: 1575940.5436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2384027.0698; train_optim_loss: 2384027.0698; val_kl_reg_loss: 12008.8928; val_edge_recon_loss: 748103.7000; val_gene_expr_recon_loss: 1580649.7000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2340762.3500; val_optim_loss: 2340762.3500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9498; val_auprc_score: 0.9843; val_best_acc_score: 0.9614; val_best_f1_score: 0.9774; train_kl_reg_loss: 11947.2262; train_edge_recon_loss: 809704.1250; train_gene_expr_recon_loss: 1573836.8808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2395488.2500; train_optim_loss: 2395488.2500; val_kl_reg_loss: 11999.1381; val_edge_recon_loss: 804755.8000; val_gene_expr_recon_loss: 1572188.8500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2388943.8000; val_optim_loss: 2388943.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9443; val_auprc_score: 0.9813; val_best_acc_score: 0.9549; val_best_f1_score: 0.9739; train_kl_reg_loss: 11933.2169; train_edge_recon_loss: 789331.3866; train_gene_expr_recon_loss: 1573641.9448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2374906.5233; train_optim_loss: 2374906.5233; val_kl_reg_loss: 12083.9908; val_edge_recon_loss: 806563.8125; val_gene_expr_recon_loss: 1575027.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2393675.5500; val_optim_loss: 2393675.5500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9471; val_auprc_score: 0.9874; val_best_acc_score: 0.9587; val_best_f1_score: 0.9761; train_kl_reg_loss: 11967.0613; train_edge_recon_loss: 799167.8023; train_gene_expr_recon_loss: 1577491.8547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2388626.7209; train_optim_loss: 2388626.7209; val_kl_reg_loss: 11916.5020; val_edge_recon_loss: 798009.6625; val_gene_expr_recon_loss: 1581434.0750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2391360.2500; val_optim_loss: 2391360.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9280; val_auprc_score: 0.9808; val_best_acc_score: 0.9495; val_best_f1_score: 0.9712; train_kl_reg_loss: 11962.0378; train_edge_recon_loss: 799644.6134; train_gene_expr_recon_loss: 1570367.2122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2381973.8721; train_optim_loss: 2381973.8721; val_kl_reg_loss: 11951.2803; val_edge_recon_loss: 788820.0125; val_gene_expr_recon_loss: 1575547.6750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2376319.0000; val_optim_loss: 2376319.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9377; val_auprc_score: 0.9773; val_best_acc_score: 0.9576; val_best_f1_score: 0.9755; train_kl_reg_loss: 11952.7970; train_edge_recon_loss: 782239.2907; train_gene_expr_recon_loss: 1574418.9012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2368610.9826; train_optim_loss: 2368610.9826; val_kl_reg_loss: 12077.0330; val_edge_recon_loss: 794610.8375; val_gene_expr_recon_loss: 1575683.3250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2382371.2000; val_optim_loss: 2382371.2000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 53 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
val AUROC score: 0.9464
val AUPRC score: 0.9834
val best accuracy score: 0.9573
val best F1 score: 0.9752
val target rna MSE score: 0.9081
val source rna MSE score: 0.1655
Val cat covariate0 mean sim diff: 0.0016
Duration of model training in run 7: 0 hours, 4 minutes and 57 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 16450
Number of validation edges: 1827
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8507; val_auprc_score: 0.9656; val_best_acc_score: 0.8785; val_best_f1_score: 0.9325; train_kl_reg_loss: 2601.5863; train_edge_recon_loss: 970668.0379; train_gene_expr_recon_loss: 2316099.6780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3289369.2879; train_optim_loss: 3289369.2879; val_kl_reg_loss: 5810.9722; val_edge_recon_loss: 1135024.4688; val_gene_expr_recon_loss: 2213001.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3353836.6875; val_optim_loss: 3353836.6875
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8217; val_auprc_score: 0.9641; val_best_acc_score: 0.8851; val_best_f1_score: 0.9366; train_kl_reg_loss: 8238.6106; train_edge_recon_loss: 1012471.3163; train_gene_expr_recon_loss: 2125824.4811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3146534.4091; train_optim_loss: 3146534.4091; val_kl_reg_loss: 9455.4417; val_edge_recon_loss: 1043279.2969; val_gene_expr_recon_loss: 2071724.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3124459.3750; val_optim_loss: 3124459.3750
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8247; val_auprc_score: 0.9608; val_best_acc_score: 0.8828; val_best_f1_score: 0.9345; train_kl_reg_loss: 9515.6289; train_edge_recon_loss: 1015329.6439; train_gene_expr_recon_loss: 1996036.7917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3020882.0682; train_optim_loss: 3020882.0682; val_kl_reg_loss: 9787.8381; val_edge_recon_loss: 943741.6094; val_gene_expr_recon_loss: 1976785.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2930315.2500; val_optim_loss: 2930315.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8235; val_auprc_score: 0.9585; val_best_acc_score: 0.8704; val_best_f1_score: 0.9269; train_kl_reg_loss: 8667.3071; train_edge_recon_loss: 936131.0170; train_gene_expr_recon_loss: 1939830.0720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2884628.4015; train_optim_loss: 2884628.4015; val_kl_reg_loss: 8412.8474; val_edge_recon_loss: 983545.5000; val_gene_expr_recon_loss: 1932930.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2924888.5000; val_optim_loss: 2924888.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8299; val_auprc_score: 0.9634; val_best_acc_score: 0.8862; val_best_f1_score: 0.9359; train_kl_reg_loss: 9122.6634; train_edge_recon_loss: 897852.3144; train_gene_expr_recon_loss: 1908031.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2815006.1818; train_optim_loss: 2815006.1818; val_kl_reg_loss: 9388.0591; val_edge_recon_loss: 898736.5781; val_gene_expr_recon_loss: 1910772.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2818897.0000; val_optim_loss: 2818897.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8953; val_auprc_score: 0.9736; val_best_acc_score: 0.8996; val_best_f1_score: 0.9422; train_kl_reg_loss: 9146.5949; train_edge_recon_loss: 878170.0436; train_gene_expr_recon_loss: 1879224.7727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2766541.4091; train_optim_loss: 2766541.4091; val_kl_reg_loss: 8926.9875; val_edge_recon_loss: 866517.9531; val_gene_expr_recon_loss: 1869924.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2745369.4375; val_optim_loss: 2745369.4375
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8731; val_auprc_score: 0.9632; val_best_acc_score: 0.9177; val_best_f1_score: 0.9531; train_kl_reg_loss: 9919.6399; train_edge_recon_loss: 854509.3996; train_gene_expr_recon_loss: 1859508.4280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2723937.4924; train_optim_loss: 2723937.4924; val_kl_reg_loss: 10858.8567; val_edge_recon_loss: 826065.5469; val_gene_expr_recon_loss: 1893638.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2730562.5000; val_optim_loss: 2730562.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8875; val_auprc_score: 0.9639; val_best_acc_score: 0.9225; val_best_f1_score: 0.9557; train_kl_reg_loss: 11767.7335; train_edge_recon_loss: 835734.3920; train_gene_expr_recon_loss: 1844561.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2692063.4167; train_optim_loss: 2692063.4167; val_kl_reg_loss: 12569.6428; val_edge_recon_loss: 865392.4844; val_gene_expr_recon_loss: 1892649.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2770611.4375; val_optim_loss: 2770611.4375
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8980; val_auprc_score: 0.9716; val_best_acc_score: 0.9223; val_best_f1_score: 0.9548; train_kl_reg_loss: 13162.6260; train_edge_recon_loss: 822570.5057; train_gene_expr_recon_loss: 1824132.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2659865.7727; train_optim_loss: 2659865.7727; val_kl_reg_loss: 14405.2197; val_edge_recon_loss: 913989.9062; val_gene_expr_recon_loss: 1834519.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2762914.6250; val_optim_loss: 2762914.6250
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8928; val_auprc_score: 0.9728; val_best_acc_score: 0.9287; val_best_f1_score: 0.9592; train_kl_reg_loss: 13902.9781; train_edge_recon_loss: 796349.6799; train_gene_expr_recon_loss: 1803845.7917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2614098.4621; train_optim_loss: 2614098.4621; val_kl_reg_loss: 13495.3486; val_edge_recon_loss: 816180.5000; val_gene_expr_recon_loss: 1765586.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2595262.5625; val_optim_loss: 2595262.5625
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9004; val_auprc_score: 0.9715; val_best_acc_score: 0.9264; val_best_f1_score: 0.9578; train_kl_reg_loss: 13887.6261; train_edge_recon_loss: 815495.6761; train_gene_expr_recon_loss: 1791208.7311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2620592.0227; train_optim_loss: 2620592.0227; val_kl_reg_loss: 14210.8337; val_edge_recon_loss: 831195.5625; val_gene_expr_recon_loss: 1770413.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2615819.5000; val_optim_loss: 2615819.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8927; val_auprc_score: 0.9721; val_best_acc_score: 0.9331; val_best_f1_score: 0.9622; train_kl_reg_loss: 13894.0570; train_edge_recon_loss: 788345.2140; train_gene_expr_recon_loss: 1777798.3144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2580037.6212; train_optim_loss: 2580037.6212; val_kl_reg_loss: 14083.0659; val_edge_recon_loss: 754341.7656; val_gene_expr_recon_loss: 1868617.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2637042.8125; val_optim_loss: 2637042.8125
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9107; val_auprc_score: 0.9777; val_best_acc_score: 0.9293; val_best_f1_score: 0.9593; train_kl_reg_loss: 14640.4653; train_edge_recon_loss: 810145.3125; train_gene_expr_recon_loss: 1767071.6591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2591857.4318; train_optim_loss: 2591857.4318; val_kl_reg_loss: 14982.5288; val_edge_recon_loss: 808591.4688; val_gene_expr_recon_loss: 1724684.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2548258.6250; val_optim_loss: 2548258.6250
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9244; val_auprc_score: 0.9773; val_best_acc_score: 0.9287; val_best_f1_score: 0.9587; train_kl_reg_loss: 15184.0350; train_edge_recon_loss: 810720.5095; train_gene_expr_recon_loss: 1754014.1136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2579918.6515; train_optim_loss: 2579918.6515; val_kl_reg_loss: 15106.8225; val_edge_recon_loss: 877891.1562; val_gene_expr_recon_loss: 1770553.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2663551.8750; val_optim_loss: 2663551.8750
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8915; val_auprc_score: 0.9700; val_best_acc_score: 0.9234; val_best_f1_score: 0.9558; train_kl_reg_loss: 15277.1891; train_edge_recon_loss: 811280.7955; train_gene_expr_recon_loss: 1744871.5758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2571429.5606; train_optim_loss: 2571429.5606; val_kl_reg_loss: 14959.9072; val_edge_recon_loss: 845926.8906; val_gene_expr_recon_loss: 1801377.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2662264.1250; val_optim_loss: 2662264.1250
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9206; val_auprc_score: 0.9766; val_best_acc_score: 0.9332; val_best_f1_score: 0.9614; train_kl_reg_loss: 14544.9171; train_edge_recon_loss: 819018.4886; train_gene_expr_recon_loss: 1733704.9886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2567268.3939; train_optim_loss: 2567268.3939; val_kl_reg_loss: 14132.3816; val_edge_recon_loss: 810853.1406; val_gene_expr_recon_loss: 1782152.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2607138.1875; val_optim_loss: 2607138.1875
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9045; val_auprc_score: 0.9723; val_best_acc_score: 0.9366; val_best_f1_score: 0.9638; train_kl_reg_loss: 14333.9175; train_edge_recon_loss: 818667.7405; train_gene_expr_recon_loss: 1721951.4735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2554953.1212; train_optim_loss: 2554953.1212; val_kl_reg_loss: 14656.3508; val_edge_recon_loss: 744556.0625; val_gene_expr_recon_loss: 1771547.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2530759.8750; val_optim_loss: 2530759.8750
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8947; val_auprc_score: 0.9702; val_best_acc_score: 0.9316; val_best_f1_score: 0.9611; train_kl_reg_loss: 14018.4765; train_edge_recon_loss: 800691.8258; train_gene_expr_recon_loss: 1717275.1591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2531985.4545; train_optim_loss: 2531985.4545; val_kl_reg_loss: 14763.9341; val_edge_recon_loss: 805079.9688; val_gene_expr_recon_loss: 1758654.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2578498.5625; val_optim_loss: 2578498.5625
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9142; val_auprc_score: 0.9739; val_best_acc_score: 0.9406; val_best_f1_score: 0.9663; train_kl_reg_loss: 14316.8668; train_edge_recon_loss: 800351.1458; train_gene_expr_recon_loss: 1708376.1061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2523044.1212; train_optim_loss: 2523044.1212; val_kl_reg_loss: 14282.1128; val_edge_recon_loss: 749613.9062; val_gene_expr_recon_loss: 1787016.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2550912.6875; val_optim_loss: 2550912.6875
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9073; val_auprc_score: 0.9734; val_best_acc_score: 0.9372; val_best_f1_score: 0.9636; train_kl_reg_loss: 14273.2656; train_edge_recon_loss: 807214.0549; train_gene_expr_recon_loss: 1702114.7879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2523602.1212; train_optim_loss: 2523602.1212; val_kl_reg_loss: 13783.3105; val_edge_recon_loss: 809021.7812; val_gene_expr_recon_loss: 1702792.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2525597.3750; val_optim_loss: 2525597.3750
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9030; val_auprc_score: 0.9747; val_best_acc_score: 0.9432; val_best_f1_score: 0.9675; train_kl_reg_loss: 14106.5234; train_edge_recon_loss: 805642.9773; train_gene_expr_recon_loss: 1685872.7727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2505622.2727; train_optim_loss: 2505622.2727; val_kl_reg_loss: 13893.6716; val_edge_recon_loss: 748226.8906; val_gene_expr_recon_loss: 1722718.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2484839.2500; val_optim_loss: 2484839.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9121; val_auprc_score: 0.9770; val_best_acc_score: 0.9378; val_best_f1_score: 0.9642; train_kl_reg_loss: 14114.4825; train_edge_recon_loss: 786674.9015; train_gene_expr_recon_loss: 1686188.1174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2486977.5152; train_optim_loss: 2486977.5152; val_kl_reg_loss: 13978.8164; val_edge_recon_loss: 843427.5000; val_gene_expr_recon_loss: 1715069.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2572475.5625; val_optim_loss: 2572475.5625
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9255; val_auprc_score: 0.9817; val_best_acc_score: 0.9441; val_best_f1_score: 0.9676; train_kl_reg_loss: 14153.9115; train_edge_recon_loss: 833352.9754; train_gene_expr_recon_loss: 1674103.0492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2521609.9545; train_optim_loss: 2521609.9545; val_kl_reg_loss: 13816.0994; val_edge_recon_loss: 821160.4219; val_gene_expr_recon_loss: 1702103.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2537079.9375; val_optim_loss: 2537079.9375
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9109; val_auprc_score: 0.9739; val_best_acc_score: 0.9437; val_best_f1_score: 0.9681; train_kl_reg_loss: 13825.8195; train_edge_recon_loss: 808283.4706; train_gene_expr_recon_loss: 1668541.4773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2490650.7879; train_optim_loss: 2490650.7879; val_kl_reg_loss: 13830.7451; val_edge_recon_loss: 751188.8125; val_gene_expr_recon_loss: 1665101.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2430120.6875; val_optim_loss: 2430120.6875
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9393; val_auprc_score: 0.9817; val_best_acc_score: 0.9505; val_best_f1_score: 0.9713; train_kl_reg_loss: 13928.4408; train_edge_recon_loss: 805609.6553; train_gene_expr_recon_loss: 1660916.9697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2480455.0758; train_optim_loss: 2480455.0758; val_kl_reg_loss: 13568.6311; val_edge_recon_loss: 766828.1250; val_gene_expr_recon_loss: 1669716.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2450113.5000; val_optim_loss: 2450113.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9545; val_auprc_score: 0.9879; val_best_acc_score: 0.9490; val_best_f1_score: 0.9707; train_kl_reg_loss: 13447.4648; train_edge_recon_loss: 789962.1856; train_gene_expr_recon_loss: 1653271.0152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2456680.6439; train_optim_loss: 2456680.6439; val_kl_reg_loss: 13229.3953; val_edge_recon_loss: 778767.5000; val_gene_expr_recon_loss: 1691450.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2483447.3125; val_optim_loss: 2483447.3125
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9328; val_auprc_score: 0.9750; val_best_acc_score: 0.9481; val_best_f1_score: 0.9700; train_kl_reg_loss: 13219.6687; train_edge_recon_loss: 806590.7216; train_gene_expr_recon_loss: 1651128.6932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2470939.0909; train_optim_loss: 2470939.0909; val_kl_reg_loss: 13198.9053; val_edge_recon_loss: 822261.1094; val_gene_expr_recon_loss: 1660352.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2495812.7500; val_optim_loss: 2495812.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9147; val_auprc_score: 0.9711; val_best_acc_score: 0.9450; val_best_f1_score: 0.9687; train_kl_reg_loss: 13192.4824; train_edge_recon_loss: 817118.2519; train_gene_expr_recon_loss: 1638524.6515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2468835.3939; train_optim_loss: 2468835.3939; val_kl_reg_loss: 13395.6184; val_edge_recon_loss: 781333.8438; val_gene_expr_recon_loss: 1676474.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2471203.8125; val_optim_loss: 2471203.8125

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9333; val_auprc_score: 0.9818; val_best_acc_score: 0.9447; val_best_f1_score: 0.9683; train_kl_reg_loss: 13240.9744; train_edge_recon_loss: 820131.9905; train_gene_expr_recon_loss: 1637277.4394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2470650.4091; train_optim_loss: 2470650.4091; val_kl_reg_loss: 13217.3511; val_edge_recon_loss: 758605.7344; val_gene_expr_recon_loss: 1712537.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2484360.6250; val_optim_loss: 2484360.6250
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9241; val_auprc_score: 0.9791; val_best_acc_score: 0.9405; val_best_f1_score: 0.9661; train_kl_reg_loss: 13342.0840; train_edge_recon_loss: 799074.3580; train_gene_expr_recon_loss: 1639866.1326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2452282.5758; train_optim_loss: 2452282.5758; val_kl_reg_loss: 13328.1711; val_edge_recon_loss: 807253.6875; val_gene_expr_recon_loss: 1686831.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2507412.9375; val_optim_loss: 2507412.9375
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9216; val_auprc_score: 0.9775; val_best_acc_score: 0.9447; val_best_f1_score: 0.9680; train_kl_reg_loss: 13375.4614; train_edge_recon_loss: 793473.2178; train_gene_expr_recon_loss: 1631204.2424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2438052.9091; train_optim_loss: 2438052.9091; val_kl_reg_loss: 13344.8174; val_edge_recon_loss: 814076.6406; val_gene_expr_recon_loss: 1674406.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2501828.0625; val_optim_loss: 2501828.0625
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9243; val_auprc_score: 0.9788; val_best_acc_score: 0.9349; val_best_f1_score: 0.9621; train_kl_reg_loss: 13455.6333; train_edge_recon_loss: 808430.2121; train_gene_expr_recon_loss: 1630263.2917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2452149.1439; train_optim_loss: 2452149.1439; val_kl_reg_loss: 13291.3865; val_edge_recon_loss: 876771.6094; val_gene_expr_recon_loss: 1668695.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2558758.6875; val_optim_loss: 2558758.6875

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 23 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9386
val AUPRC score: 0.9847
val best accuracy score: 0.9441
val best F1 score: 0.9674
val target rna MSE score: 1.0963
val source rna MSE score: 0.2439
Val cat covariate0 mean sim diff: 0.0033
Duration of model training in run 6: 0 hours, 2 minutes and 27 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 16450
Number of validation edges: 1827
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8752; val_auprc_score: 0.9628; val_best_acc_score: 0.8750; val_best_f1_score: 0.9302; train_kl_reg_loss: 2108.1077; train_edge_recon_loss: 1004669.1572; train_gene_expr_recon_loss: 2278987.3030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3285764.5833; train_optim_loss: 3285764.5833; val_kl_reg_loss: 4524.5787; val_edge_recon_loss: 1249055.3125; val_gene_expr_recon_loss: 2205249.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3458829.7500; val_optim_loss: 3458829.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8457; val_auprc_score: 0.9634; val_best_acc_score: 0.8811; val_best_f1_score: 0.9337; train_kl_reg_loss: 6451.0914; train_edge_recon_loss: 1033621.3788; train_gene_expr_recon_loss: 2099048.4394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3139120.9167; train_optim_loss: 3139120.9167; val_kl_reg_loss: 6387.8427; val_edge_recon_loss: 1132515.0781; val_gene_expr_recon_loss: 1952840.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3091743.2500; val_optim_loss: 3091743.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8159; val_auprc_score: 0.9565; val_best_acc_score: 0.8779; val_best_f1_score: 0.9320; train_kl_reg_loss: 7880.8138; train_edge_recon_loss: 983880.9716; train_gene_expr_recon_loss: 1986162.9962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2977924.7955; train_optim_loss: 2977924.7955; val_kl_reg_loss: 6466.2771; val_edge_recon_loss: 980180.0781; val_gene_expr_recon_loss: 1967338.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2953984.3750; val_optim_loss: 2953984.3750
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8300; val_auprc_score: 0.9600; val_best_acc_score: 0.8914; val_best_f1_score: 0.9396; train_kl_reg_loss: 7238.6078; train_edge_recon_loss: 964148.7121; train_gene_expr_recon_loss: 1938070.7689; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2909458.0682; train_optim_loss: 2909458.0682; val_kl_reg_loss: 6593.8070; val_edge_recon_loss: 867404.3281; val_gene_expr_recon_loss: 1856929.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2730927.7500; val_optim_loss: 2730927.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8368; val_auprc_score: 0.9576; val_best_acc_score: 0.8960; val_best_f1_score: 0.9419; train_kl_reg_loss: 7665.7549; train_edge_recon_loss: 897593.9261; train_gene_expr_recon_loss: 1907378.8144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2812638.5000; train_optim_loss: 2812638.5000; val_kl_reg_loss: 9643.7388; val_edge_recon_loss: 824672.9062; val_gene_expr_recon_loss: 1954275.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2788591.9375; val_optim_loss: 2788591.9375
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8728; val_auprc_score: 0.9681; val_best_acc_score: 0.9103; val_best_f1_score: 0.9491; train_kl_reg_loss: 9630.6480; train_edge_recon_loss: 853796.1742; train_gene_expr_recon_loss: 1881864.8295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2745291.6667; train_optim_loss: 2745291.6667; val_kl_reg_loss: 10338.7507; val_edge_recon_loss: 858329.5625; val_gene_expr_recon_loss: 1901235.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2769904.1250; val_optim_loss: 2769904.1250
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8762; val_auprc_score: 0.9674; val_best_acc_score: 0.9295; val_best_f1_score: 0.9601; train_kl_reg_loss: 11026.5452; train_edge_recon_loss: 839051.0303; train_gene_expr_recon_loss: 1860215.2348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2710292.7955; train_optim_loss: 2710292.7955; val_kl_reg_loss: 11861.0391; val_edge_recon_loss: 806577.3125; val_gene_expr_recon_loss: 1850003.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2668441.7500; val_optim_loss: 2668441.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8890; val_auprc_score: 0.9655; val_best_acc_score: 0.9270; val_best_f1_score: 0.9585; train_kl_reg_loss: 11903.8052; train_edge_recon_loss: 851352.8580; train_gene_expr_recon_loss: 1832830.1629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2696086.8182; train_optim_loss: 2696086.8182; val_kl_reg_loss: 12543.8972; val_edge_recon_loss: 826403.4531; val_gene_expr_recon_loss: 1794577.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2633524.8750; val_optim_loss: 2633524.8750
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8878; val_auprc_score: 0.9694; val_best_acc_score: 0.9268; val_best_f1_score: 0.9581; train_kl_reg_loss: 12870.3928; train_edge_recon_loss: 825102.3845; train_gene_expr_recon_loss: 1811951.4280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2649924.1818; train_optim_loss: 2649924.1818; val_kl_reg_loss: 12786.2229; val_edge_recon_loss: 852358.3750; val_gene_expr_recon_loss: 1830706.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2695851.1875; val_optim_loss: 2695851.1875
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8607; val_auprc_score: 0.9644; val_best_acc_score: 0.9250; val_best_f1_score: 0.9579; train_kl_reg_loss: 12398.3410; train_edge_recon_loss: 796352.3722; train_gene_expr_recon_loss: 1800479.5795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2609230.2879; train_optim_loss: 2609230.2879; val_kl_reg_loss: 13509.6431; val_edge_recon_loss: 809333.1094; val_gene_expr_recon_loss: 1878705.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2701548.6250; val_optim_loss: 2701548.6250
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8959; val_auprc_score: 0.9714; val_best_acc_score: 0.9276; val_best_f1_score: 0.9589; train_kl_reg_loss: 12768.2625; train_edge_recon_loss: 818579.7614; train_gene_expr_recon_loss: 1786804.2803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2618152.3030; train_optim_loss: 2618152.3030; val_kl_reg_loss: 12797.1553; val_edge_recon_loss: 805561.2500; val_gene_expr_recon_loss: 1850589.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2668947.6875; val_optim_loss: 2668947.6875
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9015; val_auprc_score: 0.9714; val_best_acc_score: 0.9346; val_best_f1_score: 0.9625; train_kl_reg_loss: 13634.0230; train_edge_recon_loss: 821936.8258; train_gene_expr_recon_loss: 1777360.8220; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2612931.6288; train_optim_loss: 2612931.6288; val_kl_reg_loss: 14898.5332; val_edge_recon_loss: 839960.2031; val_gene_expr_recon_loss: 1823190.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2678048.8125; val_optim_loss: 2678048.8125

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9008; val_auprc_score: 0.9730; val_best_acc_score: 0.9344; val_best_f1_score: 0.9625; train_kl_reg_loss: 14434.7530; train_edge_recon_loss: 827130.5947; train_gene_expr_recon_loss: 1762976.9053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2604542.2424; train_optim_loss: 2604542.2424; val_kl_reg_loss: 14403.7278; val_edge_recon_loss: 824084.5156; val_gene_expr_recon_loss: 1779467.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2617956.0625; val_optim_loss: 2617956.0625
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9055; val_auprc_score: 0.9732; val_best_acc_score: 0.9321; val_best_f1_score: 0.9613; train_kl_reg_loss: 14260.3045; train_edge_recon_loss: 839886.2254; train_gene_expr_recon_loss: 1762547.5265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2616694.0606; train_optim_loss: 2616694.0606; val_kl_reg_loss: 13875.4814; val_edge_recon_loss: 847803.9844; val_gene_expr_recon_loss: 1797287.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2658966.8125; val_optim_loss: 2658966.8125
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8971; val_auprc_score: 0.9698; val_best_acc_score: 0.9299; val_best_f1_score: 0.9596; train_kl_reg_loss: 14027.7967; train_edge_recon_loss: 814385.9413; train_gene_expr_recon_loss: 1754660.2008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2583073.9091; train_optim_loss: 2583073.9091; val_kl_reg_loss: 14325.1567; val_edge_recon_loss: 883915.0469; val_gene_expr_recon_loss: 1724475.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2622715.9375; val_optim_loss: 2622715.9375
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9053; val_auprc_score: 0.9728; val_best_acc_score: 0.9358; val_best_f1_score: 0.9632; train_kl_reg_loss: 13802.3418; train_edge_recon_loss: 830031.9148; train_gene_expr_recon_loss: 1760159.4508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2603993.7197; train_optim_loss: 2603993.7197; val_kl_reg_loss: 13766.1819; val_edge_recon_loss: 810315.2969; val_gene_expr_recon_loss: 1814676.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2638757.7500; val_optim_loss: 2638757.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9123; val_auprc_score: 0.9724; val_best_acc_score: 0.9318; val_best_f1_score: 0.9606; train_kl_reg_loss: 13730.3938; train_edge_recon_loss: 810988.3352; train_gene_expr_recon_loss: 1754751.0341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2579469.7803; train_optim_loss: 2579469.7803; val_kl_reg_loss: 13853.2354; val_edge_recon_loss: 853965.1875; val_gene_expr_recon_loss: 1798517.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2666336.3750; val_optim_loss: 2666336.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8870; val_auprc_score: 0.9665; val_best_acc_score: 0.9295; val_best_f1_score: 0.9597; train_kl_reg_loss: 13699.5156; train_edge_recon_loss: 829065.4678; train_gene_expr_recon_loss: 1763218.1023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2605983.0909; train_optim_loss: 2605983.0909; val_kl_reg_loss: 13660.0393; val_edge_recon_loss: 843108.7656; val_gene_expr_recon_loss: 1737943.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2594712.2500; val_optim_loss: 2594712.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9041; val_auprc_score: 0.9691; val_best_acc_score: 0.9356; val_best_f1_score: 0.9633; train_kl_reg_loss: 13654.8664; train_edge_recon_loss: 807649.2027; train_gene_expr_recon_loss: 1759277.2652; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2580581.3182; train_optim_loss: 2580581.3182; val_kl_reg_loss: 13464.5471; val_edge_recon_loss: 808791.8281; val_gene_expr_recon_loss: 1740194.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2562450.8750; val_optim_loss: 2562450.8750
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9079; val_auprc_score: 0.9767; val_best_acc_score: 0.9411; val_best_f1_score: 0.9667; train_kl_reg_loss: 13680.1508; train_edge_recon_loss: 811711.8352; train_gene_expr_recon_loss: 1754525.3409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2579917.3258; train_optim_loss: 2579917.3258; val_kl_reg_loss: 13794.5576; val_edge_recon_loss: 753020.3125; val_gene_expr_recon_loss: 1804676.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2571491.2500; val_optim_loss: 2571491.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9199; val_auprc_score: 0.9797; val_best_acc_score: 0.9372; val_best_f1_score: 0.9637; train_kl_reg_loss: 13734.3655; train_edge_recon_loss: 825494.8163; train_gene_expr_recon_loss: 1751145.5909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2590374.7879; train_optim_loss: 2590374.7879; val_kl_reg_loss: 13688.2156; val_edge_recon_loss: 822965.3125; val_gene_expr_recon_loss: 1767179.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2603832.6875; val_optim_loss: 2603832.6875
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9093; val_auprc_score: 0.9761; val_best_acc_score: 0.9340; val_best_f1_score: 0.9622; train_kl_reg_loss: 13741.8887; train_edge_recon_loss: 813528.3883; train_gene_expr_recon_loss: 1758157.2424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2585427.5303; train_optim_loss: 2585427.5303; val_kl_reg_loss: 13716.9883; val_edge_recon_loss: 829975.7812; val_gene_expr_recon_loss: 1749768.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2593461.4375; val_optim_loss: 2593461.4375
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8974; val_auprc_score: 0.9680; val_best_acc_score: 0.9309; val_best_f1_score: 0.9604; train_kl_reg_loss: 13722.3526; train_edge_recon_loss: 808567.3693; train_gene_expr_recon_loss: 1754080.7311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2576370.4697; train_optim_loss: 2576370.4697; val_kl_reg_loss: 13705.8337; val_edge_recon_loss: 828010.3438; val_gene_expr_recon_loss: 1762583.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2604299.2500; val_optim_loss: 2604299.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9003; val_auprc_score: 0.9710; val_best_acc_score: 0.9333; val_best_f1_score: 0.9620; train_kl_reg_loss: 13677.0677; train_edge_recon_loss: 838356.9621; train_gene_expr_recon_loss: 1751661.3030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2603695.3258; train_optim_loss: 2603695.3258; val_kl_reg_loss: 14245.1077; val_edge_recon_loss: 822895.2969; val_gene_expr_recon_loss: 1799504.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2636645.3750; val_optim_loss: 2636645.3750
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8876; val_auprc_score: 0.9652; val_best_acc_score: 0.9333; val_best_f1_score: 0.9619; train_kl_reg_loss: 13711.2115; train_edge_recon_loss: 815604.0019; train_gene_expr_recon_loss: 1758129.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2587445.0833; train_optim_loss: 2587445.0833; val_kl_reg_loss: 13924.1594; val_edge_recon_loss: 840816.1562; val_gene_expr_recon_loss: 1762324.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2617064.5000; val_optim_loss: 2617064.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9173; val_auprc_score: 0.9793; val_best_acc_score: 0.9429; val_best_f1_score: 0.9674; train_kl_reg_loss: 13693.1777; train_edge_recon_loss: 823928.3636; train_gene_expr_recon_loss: 1753689.0227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2591310.5682; train_optim_loss: 2591310.5682; val_kl_reg_loss: 13624.0425; val_edge_recon_loss: 774760.6250; val_gene_expr_recon_loss: 1782212.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2570597.3125; val_optim_loss: 2570597.3125
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8976; val_auprc_score: 0.9672; val_best_acc_score: 0.9306; val_best_f1_score: 0.9601; train_kl_reg_loss: 13693.8598; train_edge_recon_loss: 819492.6402; train_gene_expr_recon_loss: 1755805.7917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2588992.2879; train_optim_loss: 2588992.2879; val_kl_reg_loss: 13585.6826; val_edge_recon_loss: 820726.3906; val_gene_expr_recon_loss: 1739842.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2574154.5625; val_optim_loss: 2574154.5625

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 47 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
val AUROC score: 0.9178
val AUPRC score: 0.9806
val best accuracy score: 0.9402
val best F1 score: 0.9660
val target rna MSE score: 1.2488
val source rna MSE score: 0.3710
Val cat covariate0 mean sim diff: 0.0073
Duration of model training in run 5: 0 hours, 1 minutes and 50 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 10975
Number of validation edges: 1219
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8372; val_auprc_score: 0.9568; val_best_acc_score: 0.8648; val_best_f1_score: 0.9246; train_kl_reg_loss: 1600.6321; train_edge_recon_loss: 1023221.0938; train_gene_expr_recon_loss: 2347254.1477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3372075.8523; train_optim_loss: 3372075.8523; val_kl_reg_loss: 4584.0129; val_edge_recon_loss: 1322145.8333; val_gene_expr_recon_loss: 2428149.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3754879.4167; val_optim_loss: 3754879.4167
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8582; val_auprc_score: 0.9692; val_best_acc_score: 0.8891; val_best_f1_score: 0.9398; train_kl_reg_loss: 5241.4766; train_edge_recon_loss: 1030007.4375; train_gene_expr_recon_loss: 2216513.3693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3251762.2500; train_optim_loss: 3251762.2500; val_kl_reg_loss: 5847.9538; val_edge_recon_loss: 994531.1458; val_gene_expr_recon_loss: 2209327.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3209706.0833; val_optim_loss: 3209706.0833
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8488; val_auprc_score: 0.9657; val_best_acc_score: 0.8726; val_best_f1_score: 0.9296; train_kl_reg_loss: 6553.9806; train_edge_recon_loss: 1025032.1165; train_gene_expr_recon_loss: 2109733.0852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3141319.1591; train_optim_loss: 3141319.1591; val_kl_reg_loss: 8895.4412; val_edge_recon_loss: 1137533.6250; val_gene_expr_recon_loss: 2111913.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3258342.1667; val_optim_loss: 3258342.1667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8197; val_auprc_score: 0.9537; val_best_acc_score: 0.8642; val_best_f1_score: 0.9243; train_kl_reg_loss: 9258.9786; train_edge_recon_loss: 1032484.3210; train_gene_expr_recon_loss: 2023783.9886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3065527.2841; train_optim_loss: 3065527.2841; val_kl_reg_loss: 8582.0804; val_edge_recon_loss: 1048964.3125; val_gene_expr_recon_loss: 2035043.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3092589.7500; val_optim_loss: 3092589.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8108; val_auprc_score: 0.9569; val_best_acc_score: 0.8908; val_best_f1_score: 0.9401; train_kl_reg_loss: 8444.7904; train_edge_recon_loss: 976882.6477; train_gene_expr_recon_loss: 1967395.4943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2952722.9432; train_optim_loss: 2952722.9432; val_kl_reg_loss: 8364.1325; val_edge_recon_loss: 952902.9167; val_gene_expr_recon_loss: 2028636.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2989903.9167; val_optim_loss: 2989903.9167
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8325; val_auprc_score: 0.9580; val_best_acc_score: 0.8864; val_best_f1_score: 0.9361; train_kl_reg_loss: 8368.5334; train_edge_recon_loss: 924078.3239; train_gene_expr_recon_loss: 1938628.7102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2871075.5568; train_optim_loss: 2871075.5568; val_kl_reg_loss: 8451.7539; val_edge_recon_loss: 968673.1458; val_gene_expr_recon_loss: 1966638.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2943763.0833; val_optim_loss: 2943763.0833
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8306; val_auprc_score: 0.9615; val_best_acc_score: 0.8914; val_best_f1_score: 0.9395; train_kl_reg_loss: 8503.7109; train_edge_recon_loss: 900569.3920; train_gene_expr_recon_loss: 1916566.0284; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2825639.1250; train_optim_loss: 2825639.1250; val_kl_reg_loss: 9636.0205; val_edge_recon_loss: 876855.2500; val_gene_expr_recon_loss: 1960551.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2847042.5000; val_optim_loss: 2847042.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8585; val_auprc_score: 0.9656; val_best_acc_score: 0.9017; val_best_f1_score: 0.9445; train_kl_reg_loss: 9743.2553; train_edge_recon_loss: 864988.0426; train_gene_expr_recon_loss: 1891139.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2765870.8409; train_optim_loss: 2765870.8409; val_kl_reg_loss: 9797.1214; val_edge_recon_loss: 840841.5208; val_gene_expr_recon_loss: 1959825.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2810464.1667; val_optim_loss: 2810464.1667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8758; val_auprc_score: 0.9634; val_best_acc_score: 0.9026; val_best_f1_score: 0.9439; train_kl_reg_loss: 10486.4367; train_edge_recon_loss: 879807.4943; train_gene_expr_recon_loss: 1882400.6761; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2772694.5909; train_optim_loss: 2772694.5909; val_kl_reg_loss: 10330.1439; val_edge_recon_loss: 962037.0208; val_gene_expr_recon_loss: 1892163.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2864530.9167; val_optim_loss: 2864530.9167
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8808; val_auprc_score: 0.9698; val_best_acc_score: 0.9078; val_best_f1_score: 0.9471; train_kl_reg_loss: 11531.2728; train_edge_recon_loss: 862271.4830; train_gene_expr_recon_loss: 1862033.7784; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2735836.5455; train_optim_loss: 2735836.5455; val_kl_reg_loss: 11121.0283; val_edge_recon_loss: 884529.8542; val_gene_expr_recon_loss: 1818226.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2713877.7500; val_optim_loss: 2713877.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8853; val_auprc_score: 0.9723; val_best_acc_score: 0.9208; val_best_f1_score: 0.9554; train_kl_reg_loss: 11743.9866; train_edge_recon_loss: 855027.7443; train_gene_expr_recon_loss: 1841470.7216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2708242.4318; train_optim_loss: 2708242.4318; val_kl_reg_loss: 11200.3109; val_edge_recon_loss: 800476.7708; val_gene_expr_recon_loss: 1896511.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2708188.7500; val_optim_loss: 2708188.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8539; val_auprc_score: 0.9586; val_best_acc_score: 0.9188; val_best_f1_score: 0.9544; train_kl_reg_loss: 12795.8544; train_edge_recon_loss: 816230.1051; train_gene_expr_recon_loss: 1836393.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2665419.8409; train_optim_loss: 2665419.8409; val_kl_reg_loss: 13769.6647; val_edge_recon_loss: 853267.1667; val_gene_expr_recon_loss: 1865239.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2732276.4167; val_optim_loss: 2732276.4167
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8920; val_auprc_score: 0.9719; val_best_acc_score: 0.9061; val_best_f1_score: 0.9470; train_kl_reg_loss: 13284.8506; train_edge_recon_loss: 818700.1818; train_gene_expr_recon_loss: 1823283.7159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2655268.7159; train_optim_loss: 2655268.7159; val_kl_reg_loss: 12635.9756; val_edge_recon_loss: 950809.4792; val_gene_expr_recon_loss: 1806179.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2769625.2500; val_optim_loss: 2769625.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9041; val_auprc_score: 0.9753; val_best_acc_score: 0.9298; val_best_f1_score: 0.9599; train_kl_reg_loss: 13421.4900; train_edge_recon_loss: 839268.1278; train_gene_expr_recon_loss: 1811529.6136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2664219.2159; train_optim_loss: 2664219.2159; val_kl_reg_loss: 13610.6130; val_edge_recon_loss: 813332.4792; val_gene_expr_recon_loss: 1796569.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2623512.3333; val_optim_loss: 2623512.3333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8773; val_auprc_score: 0.9609; val_best_acc_score: 0.9206; val_best_f1_score: 0.9545; train_kl_reg_loss: 14119.6812; train_edge_recon_loss: 806658.5455; train_gene_expr_recon_loss: 1799695.0795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2620473.2841; train_optim_loss: 2620473.2841; val_kl_reg_loss: 13905.6387; val_edge_recon_loss: 861728.6667; val_gene_expr_recon_loss: 1879814.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2755449.1667; val_optim_loss: 2755449.1667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8965; val_auprc_score: 0.9718; val_best_acc_score: 0.9255; val_best_f1_score: 0.9581; train_kl_reg_loss: 14558.5241; train_edge_recon_loss: 808909.9858; train_gene_expr_recon_loss: 1788494.6534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2611963.1364; train_optim_loss: 2611963.1364; val_kl_reg_loss: 13689.7897; val_edge_recon_loss: 811751.7292; val_gene_expr_recon_loss: 1799457.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2624899.2500; val_optim_loss: 2624899.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8809; val_auprc_score: 0.9648; val_best_acc_score: 0.9219; val_best_f1_score: 0.9560; train_kl_reg_loss: 14348.8736; train_edge_recon_loss: 817684.7898; train_gene_expr_recon_loss: 1779400.7443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2611434.4432; train_optim_loss: 2611434.4432; val_kl_reg_loss: 14006.8451; val_edge_recon_loss: 841180.6667; val_gene_expr_recon_loss: 1753077.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2608265.4167; val_optim_loss: 2608265.4167
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9042; val_auprc_score: 0.9689; val_best_acc_score: 0.9328; val_best_f1_score: 0.9614; train_kl_reg_loss: 14794.4411; train_edge_recon_loss: 808374.0142; train_gene_expr_recon_loss: 1777475.5398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2600644.0000; train_optim_loss: 2600644.0000; val_kl_reg_loss: 14503.8320; val_edge_recon_loss: 785749.5208; val_gene_expr_recon_loss: 1816751.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2617004.7500; val_optim_loss: 2617004.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9089; val_auprc_score: 0.9734; val_best_acc_score: 0.9322; val_best_f1_score: 0.9608; train_kl_reg_loss: 14838.1003; train_edge_recon_loss: 840826.2557; train_gene_expr_recon_loss: 1771048.1705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2626712.5341; train_optim_loss: 2626712.5341; val_kl_reg_loss: 13920.0645; val_edge_recon_loss: 895909.8750; val_gene_expr_recon_loss: 1793223.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2703053.7500; val_optim_loss: 2703053.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9094; val_auprc_score: 0.9757; val_best_acc_score: 0.9314; val_best_f1_score: 0.9608; train_kl_reg_loss: 14469.8129; train_edge_recon_loss: 792576.7358; train_gene_expr_recon_loss: 1763498.9432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2570545.4886; train_optim_loss: 2570545.4886; val_kl_reg_loss: 14952.5472; val_edge_recon_loss: 829576.9583; val_gene_expr_recon_loss: 1754540.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2599069.5000; val_optim_loss: 2599069.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9074; val_auprc_score: 0.9746; val_best_acc_score: 0.9360; val_best_f1_score: 0.9634; train_kl_reg_loss: 14805.7964; train_edge_recon_loss: 779775.5710; train_gene_expr_recon_loss: 1753311.0057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2547892.3523; train_optim_loss: 2547892.3523; val_kl_reg_loss: 14547.1019; val_edge_recon_loss: 802566.7500; val_gene_expr_recon_loss: 1721752.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2538866.3333; val_optim_loss: 2538866.3333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8955; val_auprc_score: 0.9721; val_best_acc_score: 0.9322; val_best_f1_score: 0.9612; train_kl_reg_loss: 14665.1116; train_edge_recon_loss: 811966.3153; train_gene_expr_recon_loss: 1742360.8352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2568992.2841; train_optim_loss: 2568992.2841; val_kl_reg_loss: 14622.5358; val_edge_recon_loss: 839220.3958; val_gene_expr_recon_loss: 1761258.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2615101.6667; val_optim_loss: 2615101.6667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9057; val_auprc_score: 0.9714; val_best_acc_score: 0.9406; val_best_f1_score: 0.9658; train_kl_reg_loss: 14806.2626; train_edge_recon_loss: 806709.4858; train_gene_expr_recon_loss: 1734186.1136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2555701.8523; train_optim_loss: 2555701.8523; val_kl_reg_loss: 14268.0173; val_edge_recon_loss: 789036.8125; val_gene_expr_recon_loss: 1755854.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2559159.0000; val_optim_loss: 2559159.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9457; val_auprc_score: 0.9888; val_best_acc_score: 0.9499; val_best_f1_score: 0.9712; train_kl_reg_loss: 14848.6475; train_edge_recon_loss: 796633.6591; train_gene_expr_recon_loss: 1728585.8409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2540068.1705; train_optim_loss: 2540068.1705; val_kl_reg_loss: 14028.5469; val_edge_recon_loss: 729386.6458; val_gene_expr_recon_loss: 1725614.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2469030.0833; val_optim_loss: 2469030.0833
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9004; val_auprc_score: 0.9728; val_best_acc_score: 0.9408; val_best_f1_score: 0.9662; train_kl_reg_loss: 14821.7282; train_edge_recon_loss: 808839.0739; train_gene_expr_recon_loss: 1730538.7841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2554199.5909; train_optim_loss: 2554199.5909; val_kl_reg_loss: 14806.3870; val_edge_recon_loss: 809133.2292; val_gene_expr_recon_loss: 1796049.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2619989.0833; val_optim_loss: 2619989.0833
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9077; val_auprc_score: 0.9745; val_best_acc_score: 0.9369; val_best_f1_score: 0.9644; train_kl_reg_loss: 15023.4213; train_edge_recon_loss: 801403.0114; train_gene_expr_recon_loss: 1714174.0682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2530600.5114; train_optim_loss: 2530600.5114; val_kl_reg_loss: 14447.8424; val_edge_recon_loss: 786490.5000; val_gene_expr_recon_loss: 1801057.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2601996.0000; val_optim_loss: 2601996.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9260; val_auprc_score: 0.9801; val_best_acc_score: 0.9381; val_best_f1_score: 0.9638; train_kl_reg_loss: 14742.6229; train_edge_recon_loss: 794348.2102; train_gene_expr_recon_loss: 1707945.6420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2517036.4659; train_optim_loss: 2517036.4659; val_kl_reg_loss: 14419.3337; val_edge_recon_loss: 869544.6458; val_gene_expr_recon_loss: 1772231.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2656195.5833; val_optim_loss: 2656195.5833
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9172; val_auprc_score: 0.9728; val_best_acc_score: 0.9436; val_best_f1_score: 0.9675; train_kl_reg_loss: 14637.1159; train_edge_recon_loss: 822085.4659; train_gene_expr_recon_loss: 1698141.8920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2534864.4659; train_optim_loss: 2534864.4659; val_kl_reg_loss: 14036.3877; val_edge_recon_loss: 792977.2292; val_gene_expr_recon_loss: 1706430.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2513444.3333; val_optim_loss: 2513444.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9285; val_auprc_score: 0.9827; val_best_acc_score: 0.9509; val_best_f1_score: 0.9723; train_kl_reg_loss: 14493.5133; train_edge_recon_loss: 790284.0312; train_gene_expr_recon_loss: 1699005.2557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2503782.7727; train_optim_loss: 2503782.7727; val_kl_reg_loss: 14419.1755; val_edge_recon_loss: 714454.2500; val_gene_expr_recon_loss: 1741043.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2469916.4167; val_optim_loss: 2469916.4167
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9093; val_auprc_score: 0.9725; val_best_acc_score: 0.9375; val_best_f1_score: 0.9645; train_kl_reg_loss: 14576.1716; train_edge_recon_loss: 795162.0994; train_gene_expr_recon_loss: 1692463.0739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2502201.3636; train_optim_loss: 2502201.3636; val_kl_reg_loss: 14307.5199; val_edge_recon_loss: 800313.8333; val_gene_expr_recon_loss: 1651384.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2466005.8333; val_optim_loss: 2466005.8333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9365; val_auprc_score: 0.9836; val_best_acc_score: 0.9466; val_best_f1_score: 0.9691; train_kl_reg_loss: 14725.3855; train_edge_recon_loss: 796523.3438; train_gene_expr_recon_loss: 1696063.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2507311.8295; train_optim_loss: 2507311.8295; val_kl_reg_loss: 14673.1276; val_edge_recon_loss: 838684.6042; val_gene_expr_recon_loss: 1715432.2917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2568790.0000; val_optim_loss: 2568790.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9199; val_auprc_score: 0.9788; val_best_acc_score: 0.9406; val_best_f1_score: 0.9660; train_kl_reg_loss: 14680.3644; train_edge_recon_loss: 762694.0909; train_gene_expr_recon_loss: 1692013.5795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2469388.0227; train_optim_loss: 2469388.0227; val_kl_reg_loss: 14363.5671; val_edge_recon_loss: 798639.0000; val_gene_expr_recon_loss: 1686538.2917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2499540.9167; val_optim_loss: 2499540.9167
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9408; val_auprc_score: 0.9818; val_best_acc_score: 0.9503; val_best_f1_score: 0.9715; train_kl_reg_loss: 14723.2486; train_edge_recon_loss: 793507.6392; train_gene_expr_recon_loss: 1694984.6705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2503215.5682; train_optim_loss: 2503215.5682; val_kl_reg_loss: 14688.4772; val_edge_recon_loss: 806075.9583; val_gene_expr_recon_loss: 1741601.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2562366.0000; val_optim_loss: 2562366.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9308; val_auprc_score: 0.9798; val_best_acc_score: 0.9402; val_best_f1_score: 0.9655; train_kl_reg_loss: 14760.6658; train_edge_recon_loss: 814180.0511; train_gene_expr_recon_loss: 1692806.3523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2521747.0568; train_optim_loss: 2521747.0568; val_kl_reg_loss: 13993.4170; val_edge_recon_loss: 805032.8958; val_gene_expr_recon_loss: 1720555.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2539582.0833; val_optim_loss: 2539582.0833

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9220; val_auprc_score: 0.9814; val_best_acc_score: 0.9537; val_best_f1_score: 0.9737; train_kl_reg_loss: 14814.4209; train_edge_recon_loss: 792566.5028; train_gene_expr_recon_loss: 1693343.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2500724.7841; train_optim_loss: 2500724.7841; val_kl_reg_loss: 14280.4655; val_edge_recon_loss: 727905.4167; val_gene_expr_recon_loss: 1664632.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2406817.9167; val_optim_loss: 2406817.9167
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9356; val_auprc_score: 0.9814; val_best_acc_score: 0.9472; val_best_f1_score: 0.9699; train_kl_reg_loss: 14725.4686; train_edge_recon_loss: 812167.7045; train_gene_expr_recon_loss: 1695198.0852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2522091.2614; train_optim_loss: 2522091.2614; val_kl_reg_loss: 14822.7559; val_edge_recon_loss: 782794.0625; val_gene_expr_recon_loss: 1788903.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2586520.3333; val_optim_loss: 2586520.3333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9175; val_auprc_score: 0.9743; val_best_acc_score: 0.9416; val_best_f1_score: 0.9663; train_kl_reg_loss: 14768.1199; train_edge_recon_loss: 786682.7102; train_gene_expr_recon_loss: 1698683.7159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2500134.5568; train_optim_loss: 2500134.5568; val_kl_reg_loss: 14621.8496; val_edge_recon_loss: 852312.6250; val_gene_expr_recon_loss: 1769175.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2636109.5000; val_optim_loss: 2636109.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9312; val_auprc_score: 0.9738; val_best_acc_score: 0.9492; val_best_f1_score: 0.9707; train_kl_reg_loss: 14796.9258; train_edge_recon_loss: 788293.9460; train_gene_expr_recon_loss: 1695924.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2499015.7841; train_optim_loss: 2499015.7841; val_kl_reg_loss: 14725.0996; val_edge_recon_loss: 841083.8125; val_gene_expr_recon_loss: 1788597.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2644406.4167; val_optim_loss: 2644406.4167
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9081; val_auprc_score: 0.9696; val_best_acc_score: 0.9430; val_best_f1_score: 0.9672; train_kl_reg_loss: 14779.6194; train_edge_recon_loss: 783903.9489; train_gene_expr_recon_loss: 1688646.2102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2487329.7955; train_optim_loss: 2487329.7955; val_kl_reg_loss: 14595.0423; val_edge_recon_loss: 813429.8750; val_gene_expr_recon_loss: 1746867.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2574892.0833; val_optim_loss: 2574892.0833

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9275; val_auprc_score: 0.9834; val_best_acc_score: 0.9450; val_best_f1_score: 0.9688; train_kl_reg_loss: 14775.9810; train_edge_recon_loss: 783644.6506; train_gene_expr_recon_loss: 1694802.2841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2493222.9091; train_optim_loss: 2493222.9091; val_kl_reg_loss: 14326.3949; val_edge_recon_loss: 799640.8958; val_gene_expr_recon_loss: 1702074.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2516042.0000; val_optim_loss: 2516042.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9422; val_auprc_score: 0.9860; val_best_acc_score: 0.9506; val_best_f1_score: 0.9715; train_kl_reg_loss: 14771.3650; train_edge_recon_loss: 775987.2557; train_gene_expr_recon_loss: 1687826.6136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2478585.2614; train_optim_loss: 2478585.2614; val_kl_reg_loss: 14546.1712; val_edge_recon_loss: 810137.5833; val_gene_expr_recon_loss: 1712320.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2537004.6667; val_optim_loss: 2537004.6667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9185; val_auprc_score: 0.9789; val_best_acc_score: 0.9398; val_best_f1_score: 0.9655; train_kl_reg_loss: 14810.9018; train_edge_recon_loss: 802314.2330; train_gene_expr_recon_loss: 1688360.3352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2505485.4773; train_optim_loss: 2505485.4773; val_kl_reg_loss: 14681.3353; val_edge_recon_loss: 840947.5000; val_gene_expr_recon_loss: 1705980.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2561609.5833; val_optim_loss: 2561609.5833
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9144; val_auprc_score: 0.9674; val_best_acc_score: 0.9447; val_best_f1_score: 0.9681; train_kl_reg_loss: 14731.0313; train_edge_recon_loss: 792705.9460; train_gene_expr_recon_loss: 1692997.3011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2500434.3182; train_optim_loss: 2500434.3182; val_kl_reg_loss: 14669.7617; val_edge_recon_loss: 866424.1458; val_gene_expr_recon_loss: 1736584.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2617678.4167; val_optim_loss: 2617678.4167

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 18 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
val AUROC score: 0.9094
val AUPRC score: 0.9724
val best accuracy score: 0.9380
val best F1 score: 0.9644
val target rna MSE score: 0.9554
val source rna MSE score: 0.2970
Val cat covariate0 mean sim diff: -0.0041
Duration of model training in run 4: 0 hours, 2 minutes and 21 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 10975
Number of validation edges: 1219
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8564; val_auprc_score: 0.9613; val_best_acc_score: 0.8659; val_best_f1_score: 0.9263; train_kl_reg_loss: 1571.3819; train_edge_recon_loss: 1030199.2386; train_gene_expr_recon_loss: 2355669.3864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3387440.0000; train_optim_loss: 3387440.0000; val_kl_reg_loss: 5717.1507; val_edge_recon_loss: 1225586.4167; val_gene_expr_recon_loss: 2187717.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3419020.5833; val_optim_loss: 3419020.5833
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8642; val_auprc_score: 0.9615; val_best_acc_score: 0.8783; val_best_f1_score: 0.9332; train_kl_reg_loss: 5497.2825; train_edge_recon_loss: 1044827.0483; train_gene_expr_recon_loss: 2197633.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3247957.5909; train_optim_loss: 3247957.5909; val_kl_reg_loss: 6730.5200; val_edge_recon_loss: 1133345.7500; val_gene_expr_recon_loss: 2195382.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3335458.5000; val_optim_loss: 3335458.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8514; val_auprc_score: 0.9747; val_best_acc_score: 0.8889; val_best_f1_score: 0.9400; train_kl_reg_loss: 8008.7416; train_edge_recon_loss: 1037681.7330; train_gene_expr_recon_loss: 2086564.2159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3132254.7045; train_optim_loss: 3132254.7045; val_kl_reg_loss: 6881.9590; val_edge_recon_loss: 961320.7292; val_gene_expr_recon_loss: 1987727.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2955930.4167; val_optim_loss: 2955930.4167
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8086; val_auprc_score: 0.9584; val_best_acc_score: 0.8844; val_best_f1_score: 0.9361; train_kl_reg_loss: 8328.4295; train_edge_recon_loss: 993627.6506; train_gene_expr_recon_loss: 2002367.6080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3004323.7045; train_optim_loss: 3004323.7045; val_kl_reg_loss: 6871.1104; val_edge_recon_loss: 981019.4375; val_gene_expr_recon_loss: 1974040.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2961930.7500; val_optim_loss: 2961930.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8279; val_auprc_score: 0.9630; val_best_acc_score: 0.8856; val_best_f1_score: 0.9360; train_kl_reg_loss: 8191.5607; train_edge_recon_loss: 948836.7443; train_gene_expr_recon_loss: 1953179.2784; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2910207.6250; train_optim_loss: 2910207.6250; val_kl_reg_loss: 7526.4429; val_edge_recon_loss: 986155.6875; val_gene_expr_recon_loss: 1979786.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2973468.8333; val_optim_loss: 2973468.8333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8228; val_auprc_score: 0.9533; val_best_acc_score: 0.8796; val_best_f1_score: 0.9322; train_kl_reg_loss: 8924.5061; train_edge_recon_loss: 929645.1080; train_gene_expr_recon_loss: 1912172.6591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2850742.2841; train_optim_loss: 2850742.2841; val_kl_reg_loss: 8061.2909; val_edge_recon_loss: 1028829.6458; val_gene_expr_recon_loss: 1851819.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2888710.9167; val_optim_loss: 2888710.9167
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8344; val_auprc_score: 0.9658; val_best_acc_score: 0.8912; val_best_f1_score: 0.9394; train_kl_reg_loss: 8560.3406; train_edge_recon_loss: 915669.1506; train_gene_expr_recon_loss: 1893370.5057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2817599.9886; train_optim_loss: 2817599.9886; val_kl_reg_loss: 8846.8949; val_edge_recon_loss: 900481.2708; val_gene_expr_recon_loss: 1931707.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2841035.9167; val_optim_loss: 2841035.9167
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8408; val_auprc_score: 0.9566; val_best_acc_score: 0.8880; val_best_f1_score: 0.9369; train_kl_reg_loss: 9139.2698; train_edge_recon_loss: 907479.1335; train_gene_expr_recon_loss: 1868474.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2785092.4545; train_optim_loss: 2785092.4545; val_kl_reg_loss: 9767.4867; val_edge_recon_loss: 924368.5000; val_gene_expr_recon_loss: 1895526.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2829662.7500; val_optim_loss: 2829662.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8253; val_auprc_score: 0.9602; val_best_acc_score: 0.8866; val_best_f1_score: 0.9352; train_kl_reg_loss: 10782.5688; train_edge_recon_loss: 878751.5398; train_gene_expr_recon_loss: 1855602.8807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2745137.0114; train_optim_loss: 2745137.0114; val_kl_reg_loss: 11011.3607; val_edge_recon_loss: 892264.8958; val_gene_expr_recon_loss: 1749588.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2652864.9167; val_optim_loss: 2652864.9167
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8415; val_auprc_score: 0.9584; val_best_acc_score: 0.8955; val_best_f1_score: 0.9411; train_kl_reg_loss: 11625.9969; train_edge_recon_loss: 863251.3381; train_gene_expr_recon_loss: 1837428.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2712305.5341; train_optim_loss: 2712305.5341; val_kl_reg_loss: 12114.4541; val_edge_recon_loss: 880082.6458; val_gene_expr_recon_loss: 1836635.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2728833.0000; val_optim_loss: 2728833.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8568; val_auprc_score: 0.9635; val_best_acc_score: 0.8967; val_best_f1_score: 0.9423; train_kl_reg_loss: 11401.4193; train_edge_recon_loss: 839147.4261; train_gene_expr_recon_loss: 1816624.7841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2667173.6364; train_optim_loss: 2667173.6364; val_kl_reg_loss: 10439.0316; val_edge_recon_loss: 789879.3958; val_gene_expr_recon_loss: 1759490.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2559808.5833; val_optim_loss: 2559808.5833
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8347; val_auprc_score: 0.9520; val_best_acc_score: 0.9033; val_best_f1_score: 0.9456; train_kl_reg_loss: 11952.5872; train_edge_recon_loss: 835932.9091; train_gene_expr_recon_loss: 1810465.4830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2658350.9773; train_optim_loss: 2658350.9773; val_kl_reg_loss: 12310.0124; val_edge_recon_loss: 880273.4167; val_gene_expr_recon_loss: 1802660.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2695243.6667; val_optim_loss: 2695243.6667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8803; val_auprc_score: 0.9672; val_best_acc_score: 0.9129; val_best_f1_score: 0.9508; train_kl_reg_loss: 12608.4216; train_edge_recon_loss: 852804.4744; train_gene_expr_recon_loss: 1793353.8977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2658766.7614; train_optim_loss: 2658766.7614; val_kl_reg_loss: 12800.4180; val_edge_recon_loss: 836058.8542; val_gene_expr_recon_loss: 1756027.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2604886.5833; val_optim_loss: 2604886.5833
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8819; val_auprc_score: 0.9686; val_best_acc_score: 0.9229; val_best_f1_score: 0.9563; train_kl_reg_loss: 13482.3439; train_edge_recon_loss: 829206.3068; train_gene_expr_recon_loss: 1786699.9716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2629388.6023; train_optim_loss: 2629388.6023; val_kl_reg_loss: 13288.7497; val_edge_recon_loss: 816130.1042; val_gene_expr_recon_loss: 1760452.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2589871.5000; val_optim_loss: 2589871.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8803; val_auprc_score: 0.9721; val_best_acc_score: 0.9153; val_best_f1_score: 0.9522; train_kl_reg_loss: 13531.9634; train_edge_recon_loss: 834642.8381; train_gene_expr_recon_loss: 1773652.7614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2621827.5795; train_optim_loss: 2621827.5795; val_kl_reg_loss: 12919.7965; val_edge_recon_loss: 838281.0833; val_gene_expr_recon_loss: 1744060.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2595261.8333; val_optim_loss: 2595261.8333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8896; val_auprc_score: 0.9749; val_best_acc_score: 0.9229; val_best_f1_score: 0.9561; train_kl_reg_loss: 13460.9007; train_edge_recon_loss: 804507.5455; train_gene_expr_recon_loss: 1766959.1477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2584927.5909; train_optim_loss: 2584927.5909; val_kl_reg_loss: 13648.0944; val_edge_recon_loss: 814984.4583; val_gene_expr_recon_loss: 1671071.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2499703.6667; val_optim_loss: 2499703.6667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9285; val_auprc_score: 0.9819; val_best_acc_score: 0.9381; val_best_f1_score: 0.9653; train_kl_reg_loss: 13488.2072; train_edge_recon_loss: 800955.6562; train_gene_expr_recon_loss: 1766252.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2580696.4659; train_optim_loss: 2580696.4659; val_kl_reg_loss: 13519.4443; val_edge_recon_loss: 747170.9167; val_gene_expr_recon_loss: 1720498.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2481189.3333; val_optim_loss: 2481189.3333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8933; val_auprc_score: 0.9706; val_best_acc_score: 0.9278; val_best_f1_score: 0.9591; train_kl_reg_loss: 13614.3577; train_edge_recon_loss: 826781.8210; train_gene_expr_recon_loss: 1765934.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2606330.9318; train_optim_loss: 2606330.9318; val_kl_reg_loss: 12988.6826; val_edge_recon_loss: 838441.5625; val_gene_expr_recon_loss: 1750879.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2602310.0000; val_optim_loss: 2602310.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9193; val_auprc_score: 0.9739; val_best_acc_score: 0.9338; val_best_f1_score: 0.9619; train_kl_reg_loss: 13683.3978; train_edge_recon_loss: 801033.3438; train_gene_expr_recon_loss: 1765391.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2580108.3182; train_optim_loss: 2580108.3182; val_kl_reg_loss: 13292.0990; val_edge_recon_loss: 818053.6458; val_gene_expr_recon_loss: 1725241.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2556587.0000; val_optim_loss: 2556587.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8743; val_auprc_score: 0.9655; val_best_acc_score: 0.9152; val_best_f1_score: 0.9520; train_kl_reg_loss: 13804.8987; train_edge_recon_loss: 784658.1023; train_gene_expr_recon_loss: 1764043.4659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2562506.4432; train_optim_loss: 2562506.4432; val_kl_reg_loss: 13327.6517; val_edge_recon_loss: 923088.6667; val_gene_expr_recon_loss: 1730314.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2666731.0000; val_optim_loss: 2666731.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8961; val_auprc_score: 0.9762; val_best_acc_score: 0.9233; val_best_f1_score: 0.9564; train_kl_reg_loss: 13814.2413; train_edge_recon_loss: 847827.1420; train_gene_expr_recon_loss: 1762510.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2624151.6477; train_optim_loss: 2624151.6477; val_kl_reg_loss: 13422.9668; val_edge_recon_loss: 791941.5000; val_gene_expr_recon_loss: 1732855.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2538220.0833; val_optim_loss: 2538220.0833

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8902; val_auprc_score: 0.9747; val_best_acc_score: 0.9274; val_best_f1_score: 0.9590; train_kl_reg_loss: 13759.7248; train_edge_recon_loss: 824208.9659; train_gene_expr_recon_loss: 1753713.5795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2591682.2386; train_optim_loss: 2591682.2386; val_kl_reg_loss: 13430.2337; val_edge_recon_loss: 820079.6042; val_gene_expr_recon_loss: 1676906.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2510416.5000; val_optim_loss: 2510416.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8914; val_auprc_score: 0.9750; val_best_acc_score: 0.9255; val_best_f1_score: 0.9580; train_kl_reg_loss: 13775.4203; train_edge_recon_loss: 801622.3636; train_gene_expr_recon_loss: 1755277.4716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2570675.2841; train_optim_loss: 2570675.2841; val_kl_reg_loss: 13807.1445; val_edge_recon_loss: 819873.4375; val_gene_expr_recon_loss: 1807976.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2641657.1667; val_optim_loss: 2641657.1667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8818; val_auprc_score: 0.9698; val_best_acc_score: 0.9158; val_best_f1_score: 0.9523; train_kl_reg_loss: 13812.3860; train_edge_recon_loss: 834565.0341; train_gene_expr_recon_loss: 1759211.1705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2607588.5682; train_optim_loss: 2607588.5682; val_kl_reg_loss: 13198.4479; val_edge_recon_loss: 875439.1667; val_gene_expr_recon_loss: 1713867.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2602504.5833; val_optim_loss: 2602504.5833
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8899; val_auprc_score: 0.9661; val_best_acc_score: 0.9219; val_best_f1_score: 0.9554; train_kl_reg_loss: 13827.0601; train_edge_recon_loss: 827980.7301; train_gene_expr_recon_loss: 1758790.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2600597.8750; train_optim_loss: 2600597.8750; val_kl_reg_loss: 13196.4167; val_edge_recon_loss: 847875.5833; val_gene_expr_recon_loss: 1700816.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2561888.9167; val_optim_loss: 2561888.9167

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 55 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
val AUROC score: 0.8908
val AUPRC score: 0.9699
val best accuracy score: 0.9316
val best F1 score: 0.9613
val target rna MSE score: 1.1925
val source rna MSE score: 0.4337
Val cat covariate0 mean sim diff: -0.0021
Duration of model training in run 3: 0 hours, 0 minutes and 58 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 5553
Number of validation edges: 617
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7897; val_auprc_score: 0.9378; val_best_acc_score: 0.8474; val_best_f1_score: 0.9160; train_kl_reg_loss: 360.2311; train_edge_recon_loss: 1045939.5398; train_gene_expr_recon_loss: 2333453.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3379753.6818; train_optim_loss: 3379753.6818; val_kl_reg_loss: 1164.1896; val_edge_recon_loss: 1206417.0625; val_gene_expr_recon_loss: 2406310.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3613891.7500; val_optim_loss: 3613891.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8289; val_auprc_score: 0.9560; val_best_acc_score: 0.8829; val_best_f1_score: 0.9349; train_kl_reg_loss: 2090.4695; train_edge_recon_loss: 1056950.5000; train_gene_expr_recon_loss: 2223617.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3282658.7500; train_optim_loss: 3282658.7500; val_kl_reg_loss: 4541.4287; val_edge_recon_loss: 1159831.1250; val_gene_expr_recon_loss: 2178135.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3342508.2500; val_optim_loss: 3342508.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8526; val_auprc_score: 0.9682; val_best_acc_score: 0.8783; val_best_f1_score: 0.9333; train_kl_reg_loss: 3593.8951; train_edge_recon_loss: 1034272.1477; train_gene_expr_recon_loss: 2157092.7614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3194958.7727; train_optim_loss: 3194958.7727; val_kl_reg_loss: 4436.7217; val_edge_recon_loss: 1154584.0000; val_gene_expr_recon_loss: 2178654.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3337674.7500; val_optim_loss: 3337674.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8428; val_auprc_score: 0.9627; val_best_acc_score: 0.8811; val_best_f1_score: 0.9336; train_kl_reg_loss: 5978.7533; train_edge_recon_loss: 1001041.3239; train_gene_expr_recon_loss: 2104479.2159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3111499.2955; train_optim_loss: 3111499.2955; val_kl_reg_loss: 4658.4062; val_edge_recon_loss: 973590.5000; val_gene_expr_recon_loss: 2058063.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3036312.3750; val_optim_loss: 3036312.3750
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8247; val_auprc_score: 0.9598; val_best_acc_score: 0.8779; val_best_f1_score: 0.9328; train_kl_reg_loss: 6743.9361; train_edge_recon_loss: 1012546.2955; train_gene_expr_recon_loss: 2062438.8523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3081729.1136; train_optim_loss: 3081729.1136; val_kl_reg_loss: 8016.0344; val_edge_recon_loss: 1099131.0625; val_gene_expr_recon_loss: 2093002.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3200149.5000; val_optim_loss: 3200149.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8257; val_auprc_score: 0.9625; val_best_acc_score: 0.8862; val_best_f1_score: 0.9381; train_kl_reg_loss: 7785.3542; train_edge_recon_loss: 1009883.3011; train_gene_expr_recon_loss: 2017420.5909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3035089.2727; train_optim_loss: 3035089.2727; val_kl_reg_loss: 9722.5508; val_edge_recon_loss: 981389.0938; val_gene_expr_recon_loss: 2128053.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3119165.0000; val_optim_loss: 3119165.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8351; val_auprc_score: 0.9672; val_best_acc_score: 0.8797; val_best_f1_score: 0.9341; train_kl_reg_loss: 8609.0276; train_edge_recon_loss: 1010299.2443; train_gene_expr_recon_loss: 1975777.3068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2994685.5682; train_optim_loss: 2994685.5682; val_kl_reg_loss: 7312.3652; val_edge_recon_loss: 1000984.5625; val_gene_expr_recon_loss: 1811763.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2820060.0000; val_optim_loss: 2820060.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.7873; val_auprc_score: 0.9565; val_best_acc_score: 0.8841; val_best_f1_score: 0.9357; train_kl_reg_loss: 7679.2817; train_edge_recon_loss: 968717.4659; train_gene_expr_recon_loss: 1945527.1364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2921923.9091; train_optim_loss: 2921923.9091; val_kl_reg_loss: 10343.7285; val_edge_recon_loss: 865698.5938; val_gene_expr_recon_loss: 1928011.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2804053.6250; val_optim_loss: 2804053.6250
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8311; val_auprc_score: 0.9642; val_best_acc_score: 0.8892; val_best_f1_score: 0.9381; train_kl_reg_loss: 8343.6485; train_edge_recon_loss: 931695.8977; train_gene_expr_recon_loss: 1923591.9773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2863631.5227; train_optim_loss: 2863631.5227; val_kl_reg_loss: 8047.5708; val_edge_recon_loss: 874693.2812; val_gene_expr_recon_loss: 2000225.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2882966.3750; val_optim_loss: 2882966.3750
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.7787; val_auprc_score: 0.9431; val_best_acc_score: 0.8776; val_best_f1_score: 0.9319; train_kl_reg_loss: 8396.8399; train_edge_recon_loss: 924363.7898; train_gene_expr_recon_loss: 1909074.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2841834.8409; train_optim_loss: 2841834.8409; val_kl_reg_loss: 9358.2949; val_edge_recon_loss: 1118468.4688; val_gene_expr_recon_loss: 2017057.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3144883.8750; val_optim_loss: 3144883.8750
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.7984; val_auprc_score: 0.9457; val_best_acc_score: 0.8918; val_best_f1_score: 0.9397; train_kl_reg_loss: 9475.2052; train_edge_recon_loss: 930125.6591; train_gene_expr_recon_loss: 1894062.6477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2833663.5455; train_optim_loss: 2833663.5455; val_kl_reg_loss: 9438.7109; val_edge_recon_loss: 843696.6562; val_gene_expr_recon_loss: 1796476.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2649611.3750; val_optim_loss: 2649611.3750
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8081; val_auprc_score: 0.9539; val_best_acc_score: 0.8840; val_best_f1_score: 0.9359; train_kl_reg_loss: 9551.4680; train_edge_recon_loss: 893172.6591; train_gene_expr_recon_loss: 1882541.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2785265.2955; train_optim_loss: 2785265.2955; val_kl_reg_loss: 9728.0591; val_edge_recon_loss: 970174.4688; val_gene_expr_recon_loss: 1764264.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2744166.7500; val_optim_loss: 2744166.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8020; val_auprc_score: 0.9491; val_best_acc_score: 0.8731; val_best_f1_score: 0.9288; train_kl_reg_loss: 10148.8012; train_edge_recon_loss: 855787.7727; train_gene_expr_recon_loss: 1879703.4091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2745639.9773; train_optim_loss: 2745639.9773; val_kl_reg_loss: 13645.0742; val_edge_recon_loss: 960890.8438; val_gene_expr_recon_loss: 1816524.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2791060.5000; val_optim_loss: 2791060.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8247; val_auprc_score: 0.9558; val_best_acc_score: 0.8745; val_best_f1_score: 0.9292; train_kl_reg_loss: 10173.0109; train_edge_recon_loss: 883675.1080; train_gene_expr_recon_loss: 1872014.4091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2765862.5000; train_optim_loss: 2765862.5000; val_kl_reg_loss: 10991.4473; val_edge_recon_loss: 986944.5625; val_gene_expr_recon_loss: 2076501.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3074437.6250; val_optim_loss: 3074437.6250
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8831; val_auprc_score: 0.9747; val_best_acc_score: 0.8959; val_best_f1_score: 0.9408; train_kl_reg_loss: 10130.7114; train_edge_recon_loss: 891298.5114; train_gene_expr_recon_loss: 1855854.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2757284.0909; train_optim_loss: 2757284.0909; val_kl_reg_loss: 10029.3154; val_edge_recon_loss: 928302.6562; val_gene_expr_recon_loss: 1927337.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2865669.7500; val_optim_loss: 2865669.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8606; val_auprc_score: 0.9687; val_best_acc_score: 0.8954; val_best_f1_score: 0.9420; train_kl_reg_loss: 10249.2615; train_edge_recon_loss: 860450.6193; train_gene_expr_recon_loss: 1852999.9659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2723699.8409; train_optim_loss: 2723699.8409; val_kl_reg_loss: 10238.7290; val_edge_recon_loss: 841078.3750; val_gene_expr_recon_loss: 1918360.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2769677.5000; val_optim_loss: 2769677.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8151; val_auprc_score: 0.9492; val_best_acc_score: 0.8831; val_best_f1_score: 0.9339; train_kl_reg_loss: 10302.2478; train_edge_recon_loss: 869193.9205; train_gene_expr_recon_loss: 1844651.1364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2724147.3409; train_optim_loss: 2724147.3409; val_kl_reg_loss: 9811.7070; val_edge_recon_loss: 961646.2500; val_gene_expr_recon_loss: 1826395.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2797853.1250; val_optim_loss: 2797853.1250
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.7914; val_auprc_score: 0.9358; val_best_acc_score: 0.8731; val_best_f1_score: 0.9296; train_kl_reg_loss: 10391.3608; train_edge_recon_loss: 863924.4375; train_gene_expr_recon_loss: 1833236.9773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2707552.7727; train_optim_loss: 2707552.7727; val_kl_reg_loss: 9328.5703; val_edge_recon_loss: 913513.5312; val_gene_expr_recon_loss: 1715980.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2638822.7500; val_optim_loss: 2638822.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8601; val_auprc_score: 0.9662; val_best_acc_score: 0.8959; val_best_f1_score: 0.9403; train_kl_reg_loss: 10356.6287; train_edge_recon_loss: 863081.5852; train_gene_expr_recon_loss: 1844125.7614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2717563.9545; train_optim_loss: 2717563.9545; val_kl_reg_loss: 10160.6201; val_edge_recon_loss: 901585.5938; val_gene_expr_recon_loss: 1811399.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2723146.1250; val_optim_loss: 2723146.1250
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.7972; val_auprc_score: 0.9551; val_best_acc_score: 0.8839; val_best_f1_score: 0.9360; train_kl_reg_loss: 10446.4394; train_edge_recon_loss: 892272.1534; train_gene_expr_recon_loss: 1859011.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2761730.5227; train_optim_loss: 2761730.5227; val_kl_reg_loss: 11217.2617; val_edge_recon_loss: 1004582.7188; val_gene_expr_recon_loss: 1952464.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2968264.6250; val_optim_loss: 2968264.6250
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8482; val_auprc_score: 0.9639; val_best_acc_score: 0.8843; val_best_f1_score: 0.9344; train_kl_reg_loss: 10424.0581; train_edge_recon_loss: 891089.5114; train_gene_expr_recon_loss: 1841377.2386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2742890.7727; train_optim_loss: 2742890.7727; val_kl_reg_loss: 9766.7900; val_edge_recon_loss: 814860.9688; val_gene_expr_recon_loss: 1813129.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2637757.7500; val_optim_loss: 2637757.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8269; val_auprc_score: 0.9551; val_best_acc_score: 0.8694; val_best_f1_score: 0.9265; train_kl_reg_loss: 10420.5779; train_edge_recon_loss: 871959.0114; train_gene_expr_recon_loss: 1840366.9773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2722746.5682; train_optim_loss: 2722746.5682; val_kl_reg_loss: 10851.7422; val_edge_recon_loss: 1080900.5625; val_gene_expr_recon_loss: 1869949.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2961702.2500; val_optim_loss: 2961702.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8522; val_auprc_score: 0.9699; val_best_acc_score: 0.9004; val_best_f1_score: 0.9461; train_kl_reg_loss: 10566.8321; train_edge_recon_loss: 849675.4602; train_gene_expr_recon_loss: 1841098.5568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2701340.8409; train_optim_loss: 2701340.8409; val_kl_reg_loss: 9669.6353; val_edge_recon_loss: 782724.1562; val_gene_expr_recon_loss: 1858412.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2650806.5000; val_optim_loss: 2650806.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8475; val_auprc_score: 0.9615; val_best_acc_score: 0.8792; val_best_f1_score: 0.9310; train_kl_reg_loss: 10497.7691; train_edge_recon_loss: 842817.8693; train_gene_expr_recon_loss: 1840573.5568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2693889.1818; train_optim_loss: 2693889.1818; val_kl_reg_loss: 9995.5869; val_edge_recon_loss: 945052.9375; val_gene_expr_recon_loss: 1868276.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2823324.6250; val_optim_loss: 2823324.6250
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8384; val_auprc_score: 0.9647; val_best_acc_score: 0.8887; val_best_f1_score: 0.9376; train_kl_reg_loss: 10574.1712; train_edge_recon_loss: 852056.2841; train_gene_expr_recon_loss: 1841313.4886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2703943.9318; train_optim_loss: 2703943.9318; val_kl_reg_loss: 10775.9346; val_edge_recon_loss: 918105.0938; val_gene_expr_recon_loss: 1863646.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2792527.6250; val_optim_loss: 2792527.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8407; val_auprc_score: 0.9657; val_best_acc_score: 0.8884; val_best_f1_score: 0.9373; train_kl_reg_loss: 10552.3651; train_edge_recon_loss: 893560.5114; train_gene_expr_recon_loss: 1844551.7841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2748664.6818; train_optim_loss: 2748664.6818; val_kl_reg_loss: 10558.8174; val_edge_recon_loss: 879986.0000; val_gene_expr_recon_loss: 1984277.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2874822.3750; val_optim_loss: 2874822.3750
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8532; val_auprc_score: 0.9661; val_best_acc_score: 0.8875; val_best_f1_score: 0.9360; train_kl_reg_loss: 10561.2382; train_edge_recon_loss: 844478.4602; train_gene_expr_recon_loss: 1826742.7727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2681782.4545; train_optim_loss: 2681782.4545; val_kl_reg_loss: 10974.4409; val_edge_recon_loss: 878573.2812; val_gene_expr_recon_loss: 1814147.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2703695.3750; val_optim_loss: 2703695.3750
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8395; val_auprc_score: 0.9581; val_best_acc_score: 0.8725; val_best_f1_score: 0.9280; train_kl_reg_loss: 10616.5365; train_edge_recon_loss: 829110.1193; train_gene_expr_recon_loss: 1837156.8523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2676883.5227; train_optim_loss: 2676883.5227; val_kl_reg_loss: 10364.7798; val_edge_recon_loss: 1078000.0000; val_gene_expr_recon_loss: 2004428.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3092793.5000; val_optim_loss: 3092793.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8438; val_auprc_score: 0.9541; val_best_acc_score: 0.8869; val_best_f1_score: 0.9354; train_kl_reg_loss: 10541.5547; train_edge_recon_loss: 902043.0852; train_gene_expr_recon_loss: 1829530.7159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2742115.3409; train_optim_loss: 2742115.3409; val_kl_reg_loss: 9931.1968; val_edge_recon_loss: 893057.2500; val_gene_expr_recon_loss: 1910946.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2813935.0000; val_optim_loss: 2813935.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 35 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
val AUROC score: 0.8028
val AUPRC score: 0.9413
val best accuracy score: 0.8889
val best F1 score: 0.9384
val target rna MSE score: 1.6010
val source rna MSE score: 0.8539
Val cat covariate0 mean sim diff: -0.0434
Duration of model training in run 2: 0 hours, 0 minutes and 37 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 5553
Number of validation edges: 617
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8677; val_auprc_score: 0.9713; val_best_acc_score: 0.8632; val_best_f1_score: 0.9249; train_kl_reg_loss: 435.1294; train_edge_recon_loss: 1027289.4602; train_gene_expr_recon_loss: 2431121.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3458845.8182; train_optim_loss: 3458845.8182; val_kl_reg_loss: 1355.2664; val_edge_recon_loss: 1279764.7500; val_gene_expr_recon_loss: 2276712.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3557832.8750; val_optim_loss: 3557832.8750
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7995; val_auprc_score: 0.9484; val_best_acc_score: 0.8790; val_best_f1_score: 0.9327; train_kl_reg_loss: 2777.2840; train_edge_recon_loss: 1030853.4830; train_gene_expr_recon_loss: 2332362.6136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3365993.3864; train_optim_loss: 3365993.3864; val_kl_reg_loss: 3726.5674; val_edge_recon_loss: 1229581.6250; val_gene_expr_recon_loss: 2441790.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3675098.3750; val_optim_loss: 3675098.3750
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7755; val_auprc_score: 0.9471; val_best_acc_score: 0.8799; val_best_f1_score: 0.9347; train_kl_reg_loss: 5612.3412; train_edge_recon_loss: 1061006.1648; train_gene_expr_recon_loss: 2251824.3864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3318442.9318; train_optim_loss: 3318442.9318; val_kl_reg_loss: 6130.9751; val_edge_recon_loss: 1141738.0625; val_gene_expr_recon_loss: 2105448.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3253317.5000; val_optim_loss: 3253317.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8053; val_auprc_score: 0.9521; val_best_acc_score: 0.8661; val_best_f1_score: 0.9263; train_kl_reg_loss: 7017.5548; train_edge_recon_loss: 1032250.7841; train_gene_expr_recon_loss: 2192247.6818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3231516.0227; train_optim_loss: 3231516.0227; val_kl_reg_loss: 7595.2957; val_edge_recon_loss: 1116220.1562; val_gene_expr_recon_loss: 2282255.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3406070.5000; val_optim_loss: 3406070.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8002; val_auprc_score: 0.9511; val_best_acc_score: 0.8819; val_best_f1_score: 0.9349; train_kl_reg_loss: 9759.9724; train_edge_recon_loss: 1065488.1705; train_gene_expr_recon_loss: 2123812.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3199060.1818; train_optim_loss: 3199060.1818; val_kl_reg_loss: 9484.5176; val_edge_recon_loss: 988585.0312; val_gene_expr_recon_loss: 2103138.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3101207.7500; val_optim_loss: 3101207.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8262; val_auprc_score: 0.9566; val_best_acc_score: 0.8598; val_best_f1_score: 0.9216; train_kl_reg_loss: 10597.3643; train_edge_recon_loss: 1000287.8182; train_gene_expr_recon_loss: 2067903.3295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3078788.5227; train_optim_loss: 3078788.5227; val_kl_reg_loss: 9752.2837; val_edge_recon_loss: 1289160.7500; val_gene_expr_recon_loss: 1991114.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3290027.7500; val_optim_loss: 3290027.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8014; val_auprc_score: 0.9421; val_best_acc_score: 0.8510; val_best_f1_score: 0.9172; train_kl_reg_loss: 11776.4558; train_edge_recon_loss: 976016.6307; train_gene_expr_recon_loss: 2022777.6818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3010570.7500; train_optim_loss: 3010570.7500; val_kl_reg_loss: 13191.0840; val_edge_recon_loss: 1356010.0000; val_gene_expr_recon_loss: 2173838.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3543039.7500; val_optim_loss: 3543039.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.7902; val_auprc_score: 0.9564; val_best_acc_score: 0.8796; val_best_f1_score: 0.9347; train_kl_reg_loss: 11729.6231; train_edge_recon_loss: 966924.9943; train_gene_expr_recon_loss: 1975551.8864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2954206.5000; train_optim_loss: 2954206.5000; val_kl_reg_loss: 12210.4277; val_edge_recon_loss: 956796.4375; val_gene_expr_recon_loss: 2012489.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2981496.5000; val_optim_loss: 2981496.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.7751; val_auprc_score: 0.9287; val_best_acc_score: 0.8439; val_best_f1_score: 0.9137; train_kl_reg_loss: 10953.3382; train_edge_recon_loss: 1017901.0511; train_gene_expr_recon_loss: 1954777.3523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2983631.7273; train_optim_loss: 2983631.7273; val_kl_reg_loss: 9137.8438; val_edge_recon_loss: 1211267.0625; val_gene_expr_recon_loss: 2022856.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3243261.0000; val_optim_loss: 3243261.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.7821; val_auprc_score: 0.9451; val_best_acc_score: 0.8683; val_best_f1_score: 0.9266; train_kl_reg_loss: 9362.4827; train_edge_recon_loss: 923602.6477; train_gene_expr_recon_loss: 1934397.6932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2867362.8636; train_optim_loss: 2867362.8636; val_kl_reg_loss: 10339.1846; val_edge_recon_loss: 1009439.8438; val_gene_expr_recon_loss: 1977587.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2997366.0000; val_optim_loss: 2997366.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8052; val_auprc_score: 0.9475; val_best_acc_score: 0.8728; val_best_f1_score: 0.9285; train_kl_reg_loss: 10566.0158; train_edge_recon_loss: 939876.2159; train_gene_expr_recon_loss: 1920508.8409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2870951.0909; train_optim_loss: 2870951.0909; val_kl_reg_loss: 10248.1162; val_edge_recon_loss: 1055433.4062; val_gene_expr_recon_loss: 1880731.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2946412.7500; val_optim_loss: 2946412.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.7912; val_auprc_score: 0.9541; val_best_acc_score: 0.8842; val_best_f1_score: 0.9375; train_kl_reg_loss: 9980.1385; train_edge_recon_loss: 921092.1136; train_gene_expr_recon_loss: 1910459.3068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2841531.5682; train_optim_loss: 2841531.5682; val_kl_reg_loss: 9432.6113; val_edge_recon_loss: 898341.2500; val_gene_expr_recon_loss: 1893742.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2801516.7500; val_optim_loss: 2801516.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8280; val_auprc_score: 0.9536; val_best_acc_score: 0.8797; val_best_f1_score: 0.9330; train_kl_reg_loss: 10481.1744; train_edge_recon_loss: 927855.0057; train_gene_expr_recon_loss: 1891743.7955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2830080.0000; train_optim_loss: 2830080.0000; val_kl_reg_loss: 10041.7251; val_edge_recon_loss: 902658.4688; val_gene_expr_recon_loss: 1858276.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2770976.7500; val_optim_loss: 2770976.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8639; val_auprc_score: 0.9631; val_best_acc_score: 0.8795; val_best_f1_score: 0.9317; train_kl_reg_loss: 10291.4395; train_edge_recon_loss: 881506.1477; train_gene_expr_recon_loss: 1879930.8409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2771728.4545; train_optim_loss: 2771728.4545; val_kl_reg_loss: 9585.9668; val_edge_recon_loss: 879297.5625; val_gene_expr_recon_loss: 1798391.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2687275.0000; val_optim_loss: 2687275.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8585; val_auprc_score: 0.9662; val_best_acc_score: 0.8841; val_best_f1_score: 0.9334; train_kl_reg_loss: 11060.5430; train_edge_recon_loss: 895384.6307; train_gene_expr_recon_loss: 1869327.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2775772.3182; train_optim_loss: 2775772.3182; val_kl_reg_loss: 11238.6992; val_edge_recon_loss: 946971.5000; val_gene_expr_recon_loss: 1925922.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2884133.0000; val_optim_loss: 2884133.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8328; val_auprc_score: 0.9543; val_best_acc_score: 0.8853; val_best_f1_score: 0.9352; train_kl_reg_loss: 11857.3028; train_edge_recon_loss: 847298.1080; train_gene_expr_recon_loss: 1864685.4205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2723840.8636; train_optim_loss: 2723840.8636; val_kl_reg_loss: 12916.3921; val_edge_recon_loss: 808899.5625; val_gene_expr_recon_loss: 1926807.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2748623.3750; val_optim_loss: 2748623.3750
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8208; val_auprc_score: 0.9597; val_best_acc_score: 0.8875; val_best_f1_score: 0.9373; train_kl_reg_loss: 12673.1318; train_edge_recon_loss: 793301.4489; train_gene_expr_recon_loss: 1847080.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2653054.6591; train_optim_loss: 2653054.6591; val_kl_reg_loss: 12701.8594; val_edge_recon_loss: 935751.0938; val_gene_expr_recon_loss: 1781435.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2729888.5000; val_optim_loss: 2729888.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8495; val_auprc_score: 0.9614; val_best_acc_score: 0.9008; val_best_f1_score: 0.9437; train_kl_reg_loss: 12817.1421; train_edge_recon_loss: 889620.3239; train_gene_expr_recon_loss: 1834489.1364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2736926.6136; train_optim_loss: 2736926.6136; val_kl_reg_loss: 12073.9287; val_edge_recon_loss: 782733.9688; val_gene_expr_recon_loss: 1784552.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2579360.3750; val_optim_loss: 2579360.3750
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8414; val_auprc_score: 0.9567; val_best_acc_score: 0.8847; val_best_f1_score: 0.9345; train_kl_reg_loss: 13549.9096; train_edge_recon_loss: 875401.8920; train_gene_expr_recon_loss: 1842287.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2731239.0455; train_optim_loss: 2731239.0455; val_kl_reg_loss: 13876.6631; val_edge_recon_loss: 1025065.9062; val_gene_expr_recon_loss: 1888922.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2927864.6250; val_optim_loss: 2927864.6250
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8455; val_auprc_score: 0.9562; val_best_acc_score: 0.8889; val_best_f1_score: 0.9371; train_kl_reg_loss: 13859.7647; train_edge_recon_loss: 868524.9830; train_gene_expr_recon_loss: 1816307.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2698692.4091; train_optim_loss: 2698692.4091; val_kl_reg_loss: 13346.6675; val_edge_recon_loss: 953757.2500; val_gene_expr_recon_loss: 1744791.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2711895.7500; val_optim_loss: 2711895.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8711; val_auprc_score: 0.9731; val_best_acc_score: 0.8961; val_best_f1_score: 0.9415; train_kl_reg_loss: 14343.1966; train_edge_recon_loss: 869522.9602; train_gene_expr_recon_loss: 1814100.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2697966.7727; train_optim_loss: 2697966.7727; val_kl_reg_loss: 14989.0762; val_edge_recon_loss: 696124.4062; val_gene_expr_recon_loss: 1680750.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2391864.3750; val_optim_loss: 2391864.3750
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8721; val_auprc_score: 0.9714; val_best_acc_score: 0.8909; val_best_f1_score: 0.9372; train_kl_reg_loss: 15315.4252; train_edge_recon_loss: 850938.4034; train_gene_expr_recon_loss: 1808231.5909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2674485.4091; train_optim_loss: 2674485.4091; val_kl_reg_loss: 15351.9531; val_edge_recon_loss: 1031492.5625; val_gene_expr_recon_loss: 1900264.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2947108.5000; val_optim_loss: 2947108.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8658; val_auprc_score: 0.9600; val_best_acc_score: 0.9062; val_best_f1_score: 0.9465; train_kl_reg_loss: 15000.7522; train_edge_recon_loss: 838319.8182; train_gene_expr_recon_loss: 1807414.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2660735.3864; train_optim_loss: 2660735.3864; val_kl_reg_loss: 14083.9697; val_edge_recon_loss: 801058.9688; val_gene_expr_recon_loss: 1868702.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2683845.1250; val_optim_loss: 2683845.1250
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8564; val_auprc_score: 0.9698; val_best_acc_score: 0.8918; val_best_f1_score: 0.9393; train_kl_reg_loss: 14906.7427; train_edge_recon_loss: 852324.5795; train_gene_expr_recon_loss: 1801571.3864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2668802.7727; train_optim_loss: 2668802.7727; val_kl_reg_loss: 14067.5967; val_edge_recon_loss: 885422.7188; val_gene_expr_recon_loss: 1612161.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2511651.8750; val_optim_loss: 2511651.8750
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8660; val_auprc_score: 0.9711; val_best_acc_score: 0.9074; val_best_f1_score: 0.9488; train_kl_reg_loss: 15136.3115; train_edge_recon_loss: 826043.0511; train_gene_expr_recon_loss: 1790805.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2631985.2500; train_optim_loss: 2631985.2500; val_kl_reg_loss: 15603.0410; val_edge_recon_loss: 738690.6562; val_gene_expr_recon_loss: 1761977.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2516270.6250; val_optim_loss: 2516270.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8963; val_auprc_score: 0.9736; val_best_acc_score: 0.9130; val_best_f1_score: 0.9500; train_kl_reg_loss: 15258.6325; train_edge_recon_loss: 798620.3352; train_gene_expr_recon_loss: 1778987.4886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2592866.4318; train_optim_loss: 2592866.4318; val_kl_reg_loss: 14053.5234; val_edge_recon_loss: 787739.5938; val_gene_expr_recon_loss: 1892671.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2694464.3750; val_optim_loss: 2694464.3750
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8937; val_auprc_score: 0.9750; val_best_acc_score: 0.9100; val_best_f1_score: 0.9485; train_kl_reg_loss: 15205.6712; train_edge_recon_loss: 830549.6932; train_gene_expr_recon_loss: 1780773.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2626529.0000; train_optim_loss: 2626529.0000; val_kl_reg_loss: 15302.3613; val_edge_recon_loss: 864122.7188; val_gene_expr_recon_loss: 1779993.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2659418.6250; val_optim_loss: 2659418.6250
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8695; val_auprc_score: 0.9626; val_best_acc_score: 0.9003; val_best_f1_score: 0.9435; train_kl_reg_loss: 15117.8543; train_edge_recon_loss: 809923.8352; train_gene_expr_recon_loss: 1772750.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2597791.7955; train_optim_loss: 2597791.7955; val_kl_reg_loss: 16730.6621; val_edge_recon_loss: 916401.4375; val_gene_expr_recon_loss: 1820880.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2754012.7500; val_optim_loss: 2754012.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8615; val_auprc_score: 0.9613; val_best_acc_score: 0.8996; val_best_f1_score: 0.9425; train_kl_reg_loss: 15202.8403; train_edge_recon_loss: 833684.8011; train_gene_expr_recon_loss: 1779592.5568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2628480.1818; train_optim_loss: 2628480.1818; val_kl_reg_loss: 15525.8682; val_edge_recon_loss: 758190.8125; val_gene_expr_recon_loss: 1895160.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2668876.6250; val_optim_loss: 2668876.6250

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 35 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
val AUROC score: 0.8707
val AUPRC score: 0.9643
val best accuracy score: 0.8889
val best F1 score: 0.9374
val target rna MSE score: 1.2034
val source rna MSE score: 0.6414
Val cat covariate0 mean sim diff: -0.0248
Duration of model training in run 1: 0 hours, 0 minutes and 37 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
