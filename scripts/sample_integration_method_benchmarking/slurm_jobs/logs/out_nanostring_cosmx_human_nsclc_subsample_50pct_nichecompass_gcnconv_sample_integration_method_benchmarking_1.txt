Run timestamp: 02092023_195702_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '--edge_batch_size_list', '4096', '--node_batch_size_list', 'None', '--seeds', '7', '--run_index', '8', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc_subsample_50pct', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gcnconv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 127072
Number of validation nodes: 14119
Number of training edges: 1142524
Number of validation edges: 126947
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9555; val_auprc_score: 0.9836; val_best_acc_score: 0.9225; val_best_f1_score: 0.9505; train_kl_reg_loss: 23165.9500; train_edge_recon_loss: 1500608.6120; train_cat_covariates_contrastive_loss: 641014.0775; train_gene_expr_recon_loss: 3444120.3154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5608908.9516; train_optim_loss: 5608908.9516; val_kl_reg_loss: 21641.7694; val_edge_recon_loss: 1364387.8589; val_cat_covariates_contrastive_loss: 630963.8327; val_gene_expr_recon_loss: 3150425.2581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5167418.7258; val_optim_loss: 5167418.7258
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9658; val_auprc_score: 0.9868; val_best_acc_score: 0.9342; val_best_f1_score: 0.9578; train_kl_reg_loss: 18020.2404; train_edge_recon_loss: 1342992.4574; train_cat_covariates_contrastive_loss: 633265.6107; train_gene_expr_recon_loss: 3093156.5349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5087434.8423; train_optim_loss: 5087434.8423; val_kl_reg_loss: 14390.5480; val_edge_recon_loss: 1341191.3871; val_cat_covariates_contrastive_loss: 633017.6190; val_gene_expr_recon_loss: 3033386.7419; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5021986.2419; val_optim_loss: 5021986.2419
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9690; val_auprc_score: 0.9878; val_best_acc_score: 0.9407; val_best_f1_score: 0.9619; train_kl_reg_loss: 13629.3372; train_edge_recon_loss: 1326650.7478; train_cat_covariates_contrastive_loss: 633487.4442; train_gene_expr_recon_loss: 3004088.2518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4977855.7796; train_optim_loss: 4977855.7796; val_kl_reg_loss: 12725.6458; val_edge_recon_loss: 1329689.4839; val_cat_covariates_contrastive_loss: 632867.0282; val_gene_expr_recon_loss: 2969092.9758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4944375.1613; val_optim_loss: 4944375.1613
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9710; val_auprc_score: 0.9882; val_best_acc_score: 0.9445; val_best_f1_score: 0.9643; train_kl_reg_loss: 12390.5163; train_edge_recon_loss: 1324305.5815; train_cat_covariates_contrastive_loss: 633091.4987; train_gene_expr_recon_loss: 2946531.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4916319.1900; train_optim_loss: 4916319.1900; val_kl_reg_loss: 12029.9869; val_edge_recon_loss: 1329815.8508; val_cat_covariates_contrastive_loss: 632563.3770; val_gene_expr_recon_loss: 2920440.9274; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4894850.1129; val_optim_loss: 4894850.1129
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9716; val_auprc_score: 0.9883; val_best_acc_score: 0.9462; val_best_f1_score: 0.9653; train_kl_reg_loss: 11910.9142; train_edge_recon_loss: 1321920.2599; train_cat_covariates_contrastive_loss: 632884.6297; train_gene_expr_recon_loss: 2901050.7124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4867766.5197; train_optim_loss: 4867766.5197; val_kl_reg_loss: 11635.5187; val_edge_recon_loss: 1329970.6694; val_cat_covariates_contrastive_loss: 632036.7540; val_gene_expr_recon_loss: 2877320.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4850963.1613; val_optim_loss: 4850963.1613
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9726; val_auprc_score: 0.9888; val_best_acc_score: 0.9495; val_best_f1_score: 0.9675; train_kl_reg_loss: 11703.2568; train_edge_recon_loss: 1317617.9480; train_cat_covariates_contrastive_loss: 632682.7088; train_gene_expr_recon_loss: 2863333.0188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4825336.9355; train_optim_loss: 4825336.9355; val_kl_reg_loss: 11726.8251; val_edge_recon_loss: 1318189.1855; val_cat_covariates_contrastive_loss: 631739.7258; val_gene_expr_recon_loss: 2843197.1371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4804852.9194; val_optim_loss: 4804852.9194
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9750; val_auprc_score: 0.9897; val_best_acc_score: 0.9514; val_best_f1_score: 0.9685; train_kl_reg_loss: 11692.5790; train_edge_recon_loss: 1313356.8401; train_cat_covariates_contrastive_loss: 632589.1920; train_gene_expr_recon_loss: 2835159.6228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4792798.2240; train_optim_loss: 4792798.2240; val_kl_reg_loss: 11435.5978; val_edge_recon_loss: 1321852.9919; val_cat_covariates_contrastive_loss: 632290.6028; val_gene_expr_recon_loss: 2812801.1210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4778380.3548; val_optim_loss: 4778380.3548
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9751; val_auprc_score: 0.9899; val_best_acc_score: 0.9512; val_best_f1_score: 0.9685; train_kl_reg_loss: 11734.5924; train_edge_recon_loss: 1315751.3401; train_cat_covariates_contrastive_loss: 632352.9964; train_gene_expr_recon_loss: 2808701.2204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4768540.1667; train_optim_loss: 4768540.1667; val_kl_reg_loss: 11849.7433; val_edge_recon_loss: 1316974.3992; val_cat_covariates_contrastive_loss: 631752.6734; val_gene_expr_recon_loss: 2790997.2016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4751574.0000; val_optim_loss: 4751574.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9753; val_auprc_score: 0.9899; val_best_acc_score: 0.9520; val_best_f1_score: 0.9690; train_kl_reg_loss: 11783.8846; train_edge_recon_loss: 1314216.9104; train_cat_covariates_contrastive_loss: 632276.7343; train_gene_expr_recon_loss: 2785930.5923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4744208.1201; train_optim_loss: 4744208.1201; val_kl_reg_loss: 11821.5991; val_edge_recon_loss: 1320711.1452; val_cat_covariates_contrastive_loss: 631726.1794; val_gene_expr_recon_loss: 2771726.9355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4735985.8548; val_optim_loss: 4735985.8548
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9778; val_auprc_score: 0.9907; val_best_acc_score: 0.9552; val_best_f1_score: 0.9710; train_kl_reg_loss: 11861.0424; train_edge_recon_loss: 1314889.9135; train_cat_covariates_contrastive_loss: 632151.4153; train_gene_expr_recon_loss: 2766272.5170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4725174.8996; train_optim_loss: 4725174.8996; val_kl_reg_loss: 11740.5659; val_edge_recon_loss: 1316440.0524; val_cat_covariates_contrastive_loss: 631797.0504; val_gene_expr_recon_loss: 2756701.7097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4716679.3387; val_optim_loss: 4716679.3387
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9769; val_auprc_score: 0.9902; val_best_acc_score: 0.9532; val_best_f1_score: 0.9697; train_kl_reg_loss: 11942.9260; train_edge_recon_loss: 1313806.3136; train_cat_covariates_contrastive_loss: 632135.6472; train_gene_expr_recon_loss: 2749192.5036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4707077.4014; train_optim_loss: 4707077.4014; val_kl_reg_loss: 11990.5090; val_edge_recon_loss: 1320255.5040; val_cat_covariates_contrastive_loss: 632076.8024; val_gene_expr_recon_loss: 2744454.9597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4708777.7258; val_optim_loss: 4708777.7258
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9759; val_auprc_score: 0.9896; val_best_acc_score: 0.9554; val_best_f1_score: 0.9711; train_kl_reg_loss: 12062.7859; train_edge_recon_loss: 1311385.7823; train_cat_covariates_contrastive_loss: 632050.8687; train_gene_expr_recon_loss: 2735170.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4690669.7724; train_optim_loss: 4690669.7724; val_kl_reg_loss: 12173.0007; val_edge_recon_loss: 1318804.6734; val_cat_covariates_contrastive_loss: 631276.4355; val_gene_expr_recon_loss: 2728073.0403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4690327.1290; val_optim_loss: 4690327.1290
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9773; val_auprc_score: 0.9907; val_best_acc_score: 0.9552; val_best_f1_score: 0.9711; train_kl_reg_loss: 12122.8287; train_edge_recon_loss: 1314804.1599; train_cat_covariates_contrastive_loss: 632007.1996; train_gene_expr_recon_loss: 2722706.5269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4681640.7043; train_optim_loss: 4681640.7043; val_kl_reg_loss: 12117.0836; val_edge_recon_loss: 1319150.5040; val_cat_covariates_contrastive_loss: 631526.9839; val_gene_expr_recon_loss: 2717682.6694; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4680477.2419; val_optim_loss: 4680477.2419
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9797; val_auprc_score: 0.9914; val_best_acc_score: 0.9566; val_best_f1_score: 0.9719; train_kl_reg_loss: 12224.4258; train_edge_recon_loss: 1311422.4435; train_cat_covariates_contrastive_loss: 632066.0582; train_gene_expr_recon_loss: 2710736.7276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4666449.6595; train_optim_loss: 4666449.6595; val_kl_reg_loss: 12118.5252; val_edge_recon_loss: 1312113.9960; val_cat_covariates_contrastive_loss: 632034.1815; val_gene_expr_recon_loss: 2710660.3952; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4666927.1452; val_optim_loss: 4666927.1452
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9793; val_auprc_score: 0.9914; val_best_acc_score: 0.9575; val_best_f1_score: 0.9724; train_kl_reg_loss: 12319.4501; train_edge_recon_loss: 1316218.8239; train_cat_covariates_contrastive_loss: 632068.8483; train_gene_expr_recon_loss: 2701950.8297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4662557.9642; train_optim_loss: 4662557.9642; val_kl_reg_loss: 12427.6310; val_edge_recon_loss: 1314215.8710; val_cat_covariates_contrastive_loss: 631582.7500; val_gene_expr_recon_loss: 2696170.5403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4654396.8226; val_optim_loss: 4654396.8226
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9781; val_auprc_score: 0.9906; val_best_acc_score: 0.9579; val_best_f1_score: 0.9728; train_kl_reg_loss: 12404.8036; train_edge_recon_loss: 1310948.8875; train_cat_covariates_contrastive_loss: 631950.9536; train_gene_expr_recon_loss: 2691188.9086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4646493.5466; train_optim_loss: 4646493.5466; val_kl_reg_loss: 12406.2644; val_edge_recon_loss: 1312337.3266; val_cat_covariates_contrastive_loss: 631274.6573; val_gene_expr_recon_loss: 2695138.1855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4651156.4677; val_optim_loss: 4651156.4677
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9784; val_auprc_score: 0.9907; val_best_acc_score: 0.9589; val_best_f1_score: 0.9734; train_kl_reg_loss: 12436.3228; train_edge_recon_loss: 1314366.5466; train_cat_covariates_contrastive_loss: 631851.9684; train_gene_expr_recon_loss: 2685692.1022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4644346.9606; train_optim_loss: 4644346.9606; val_kl_reg_loss: 12675.6055; val_edge_recon_loss: 1319912.1734; val_cat_covariates_contrastive_loss: 631114.3508; val_gene_expr_recon_loss: 2684169.3306; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4647871.4516; val_optim_loss: 4647871.4516
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9802; val_auprc_score: 0.9915; val_best_acc_score: 0.9598; val_best_f1_score: 0.9740; train_kl_reg_loss: 12486.2794; train_edge_recon_loss: 1309873.3244; train_cat_covariates_contrastive_loss: 631779.6700; train_gene_expr_recon_loss: 2678737.0529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4632876.3190; train_optim_loss: 4632876.3190; val_kl_reg_loss: 12241.5980; val_edge_recon_loss: 1311269.9556; val_cat_covariates_contrastive_loss: 631704.0847; val_gene_expr_recon_loss: 2679080.6210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4634296.2903; val_optim_loss: 4634296.2903
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9800; val_auprc_score: 0.9914; val_best_acc_score: 0.9612; val_best_f1_score: 0.9748; train_kl_reg_loss: 12542.9850; train_edge_recon_loss: 1313959.2769; train_cat_covariates_contrastive_loss: 631676.8174; train_gene_expr_recon_loss: 2672262.5484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4630441.6344; train_optim_loss: 4630441.6344; val_kl_reg_loss: 12551.0948; val_edge_recon_loss: 1309681.0524; val_cat_covariates_contrastive_loss: 631000.2520; val_gene_expr_recon_loss: 2675515.4839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4628747.8548; val_optim_loss: 4628747.8548
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9811; val_auprc_score: 0.9918; val_best_acc_score: 0.9620; val_best_f1_score: 0.9754; train_kl_reg_loss: 12579.3082; train_edge_recon_loss: 1311297.7800; train_cat_covariates_contrastive_loss: 631655.4500; train_gene_expr_recon_loss: 2667703.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4623235.9588; train_optim_loss: 4623235.9588; val_kl_reg_loss: 12366.7073; val_edge_recon_loss: 1312466.7500; val_cat_covariates_contrastive_loss: 631504.1169; val_gene_expr_recon_loss: 2669442.8790; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4625780.4032; val_optim_loss: 4625780.4032
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9812; val_auprc_score: 0.9918; val_best_acc_score: 0.9616; val_best_f1_score: 0.9751; train_kl_reg_loss: 12645.2498; train_edge_recon_loss: 1308207.4606; train_cat_covariates_contrastive_loss: 631596.2115; train_gene_expr_recon_loss: 2661652.4498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4614101.3763; train_optim_loss: 4614101.3763; val_kl_reg_loss: 12259.4996; val_edge_recon_loss: 1319262.9234; val_cat_covariates_contrastive_loss: 632106.4052; val_gene_expr_recon_loss: 2665675.2258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4629304.0161; val_optim_loss: 4629304.0161
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9808; val_auprc_score: 0.9915; val_best_acc_score: 0.9626; val_best_f1_score: 0.9758; train_kl_reg_loss: 12711.7088; train_edge_recon_loss: 1311200.9651; train_cat_covariates_contrastive_loss: 631587.9418; train_gene_expr_recon_loss: 2656655.3082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4612155.9265; train_optim_loss: 4612155.9265; val_kl_reg_loss: 12465.0988; val_edge_recon_loss: 1311632.6855; val_cat_covariates_contrastive_loss: 631635.2117; val_gene_expr_recon_loss: 2663659.2016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4619392.2258; val_optim_loss: 4619392.2258
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9818; val_auprc_score: 0.9920; val_best_acc_score: 0.9627; val_best_f1_score: 0.9758; train_kl_reg_loss: 12737.9993; train_edge_recon_loss: 1307145.4108; train_cat_covariates_contrastive_loss: 631620.6888; train_gene_expr_recon_loss: 2653781.2643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4605285.3584; train_optim_loss: 4605285.3584; val_kl_reg_loss: 12733.3524; val_edge_recon_loss: 1307301.3468; val_cat_covariates_contrastive_loss: 631211.1895; val_gene_expr_recon_loss: 2656413.6935; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4607659.5968; val_optim_loss: 4607659.5968
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9816; val_auprc_score: 0.9917; val_best_acc_score: 0.9648; val_best_f1_score: 0.9771; train_kl_reg_loss: 12798.6652; train_edge_recon_loss: 1307305.6259; train_cat_covariates_contrastive_loss: 631573.4682; train_gene_expr_recon_loss: 2650329.4964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4602007.2437; train_optim_loss: 4602007.2437; val_kl_reg_loss: 12828.0395; val_edge_recon_loss: 1313294.1210; val_cat_covariates_contrastive_loss: 631258.3669; val_gene_expr_recon_loss: 2656678.3790; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4614058.9194; val_optim_loss: 4614058.9194
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9821; val_auprc_score: 0.9920; val_best_acc_score: 0.9639; val_best_f1_score: 0.9765; train_kl_reg_loss: 12848.0286; train_edge_recon_loss: 1307437.3342; train_cat_covariates_contrastive_loss: 631385.4149; train_gene_expr_recon_loss: 2646465.5681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4598136.3477; train_optim_loss: 4598136.3477; val_kl_reg_loss: 12956.8609; val_edge_recon_loss: 1317050.9556; val_cat_covariates_contrastive_loss: 630732.4274; val_gene_expr_recon_loss: 2654720.4355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4615460.6774; val_optim_loss: 4615460.6774
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9815; val_auprc_score: 0.9918; val_best_acc_score: 0.9639; val_best_f1_score: 0.9765; train_kl_reg_loss: 12910.6446; train_edge_recon_loss: 1308202.4628; train_cat_covariates_contrastive_loss: 631584.4162; train_gene_expr_recon_loss: 2643694.3530; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4596391.8996; train_optim_loss: 4596391.8996; val_kl_reg_loss: 12489.0650; val_edge_recon_loss: 1315798.7339; val_cat_covariates_contrastive_loss: 631593.3589; val_gene_expr_recon_loss: 2652653.4919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4612534.6613; val_optim_loss: 4612534.6613
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9828; val_auprc_score: 0.9923; val_best_acc_score: 0.9662; val_best_f1_score: 0.9781; train_kl_reg_loss: 12937.0887; train_edge_recon_loss: 1308831.6720; train_cat_covariates_contrastive_loss: 631452.9095; train_gene_expr_recon_loss: 2641634.0224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4594855.7097; train_optim_loss: 4594855.7097; val_kl_reg_loss: 12868.5704; val_edge_recon_loss: 1308747.8790; val_cat_covariates_contrastive_loss: 631216.7097; val_gene_expr_recon_loss: 2649356.0161; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4602189.1452; val_optim_loss: 4602189.1452
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9836; val_auprc_score: 0.9926; val_best_acc_score: 0.9666; val_best_f1_score: 0.9782; train_kl_reg_loss: 12965.1675; train_edge_recon_loss: 1307507.7961; train_cat_covariates_contrastive_loss: 631479.2516; train_gene_expr_recon_loss: 2639747.5099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4591699.7258; train_optim_loss: 4591699.7258; val_kl_reg_loss: 12888.9810; val_edge_recon_loss: 1311269.4960; val_cat_covariates_contrastive_loss: 631126.9113; val_gene_expr_recon_loss: 2647214.3710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4602499.7097; val_optim_loss: 4602499.7097
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9828; val_auprc_score: 0.9923; val_best_acc_score: 0.9666; val_best_f1_score: 0.9782; train_kl_reg_loss: 12975.5627; train_edge_recon_loss: 1307033.2285; train_cat_covariates_contrastive_loss: 631445.5802; train_gene_expr_recon_loss: 2637174.7805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4588629.1380; train_optim_loss: 4588629.1380; val_kl_reg_loss: 13140.2398; val_edge_recon_loss: 1311252.5282; val_cat_covariates_contrastive_loss: 630948.2601; val_gene_expr_recon_loss: 2643172.7742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4598513.8226; val_optim_loss: 4598513.8226
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9839; val_auprc_score: 0.9928; val_best_acc_score: 0.9673; val_best_f1_score: 0.9788; train_kl_reg_loss: 13004.9480; train_edge_recon_loss: 1304517.8289; train_cat_covariates_contrastive_loss: 631365.9465; train_gene_expr_recon_loss: 2636395.6729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4585284.3996; train_optim_loss: 4585284.3996; val_kl_reg_loss: 12902.0395; val_edge_recon_loss: 1309200.4879; val_cat_covariates_contrastive_loss: 631302.8286; val_gene_expr_recon_loss: 2644714.0081; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4598119.3710; val_optim_loss: 4598119.3710
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9824; val_auprc_score: 0.9920; val_best_acc_score: 0.9651; val_best_f1_score: 0.9773; train_kl_reg_loss: 13068.1152; train_edge_recon_loss: 1306654.9740; train_cat_covariates_contrastive_loss: 631391.5679; train_gene_expr_recon_loss: 2632969.7366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4584084.3978; train_optim_loss: 4584084.3978; val_kl_reg_loss: 12803.1860; val_edge_recon_loss: 1318437.7661; val_cat_covariates_contrastive_loss: 631289.6371; val_gene_expr_recon_loss: 2642161.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4604691.8226; val_optim_loss: 4604691.8226
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9833; val_auprc_score: 0.9926; val_best_acc_score: 0.9664; val_best_f1_score: 0.9782; train_kl_reg_loss: 13072.1520; train_edge_recon_loss: 1304568.2213; train_cat_covariates_contrastive_loss: 631379.3674; train_gene_expr_recon_loss: 2632682.9122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4581702.6577; train_optim_loss: 4581702.6577; val_kl_reg_loss: 12804.6042; val_edge_recon_loss: 1306670.8992; val_cat_covariates_contrastive_loss: 631513.0766; val_gene_expr_recon_loss: 2642162.0242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4593150.5968; val_optim_loss: 4593150.5968
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9839; val_auprc_score: 0.9927; val_best_acc_score: 0.9683; val_best_f1_score: 0.9794; train_kl_reg_loss: 13093.6508; train_edge_recon_loss: 1306373.0766; train_cat_covariates_contrastive_loss: 631273.6875; train_gene_expr_recon_loss: 2630707.4758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4581447.9050; train_optim_loss: 4581447.9050; val_kl_reg_loss: 12916.3794; val_edge_recon_loss: 1303886.9234; val_cat_covariates_contrastive_loss: 630959.3044; val_gene_expr_recon_loss: 2635915.6290; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4583678.2742; val_optim_loss: 4583678.2742
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9828; val_auprc_score: 0.9923; val_best_acc_score: 0.9670; val_best_f1_score: 0.9785; train_kl_reg_loss: 13127.6841; train_edge_recon_loss: 1306690.0211; train_cat_covariates_contrastive_loss: 631244.6669; train_gene_expr_recon_loss: 2630132.0699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4581194.4588; train_optim_loss: 4581194.4588; val_kl_reg_loss: 13230.2585; val_edge_recon_loss: 1309166.1935; val_cat_covariates_contrastive_loss: 630829.3891; val_gene_expr_recon_loss: 2642646.6129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4595872.4677; val_optim_loss: 4595872.4677
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9846; val_auprc_score: 0.9930; val_best_acc_score: 0.9683; val_best_f1_score: 0.9794; train_kl_reg_loss: 13140.4198; train_edge_recon_loss: 1305389.5959; train_cat_covariates_contrastive_loss: 631197.9507; train_gene_expr_recon_loss: 2626587.2670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4576315.2473; train_optim_loss: 4576315.2473; val_kl_reg_loss: 12787.6275; val_edge_recon_loss: 1314312.4556; val_cat_covariates_contrastive_loss: 631367.6734; val_gene_expr_recon_loss: 2639919.8629; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4598387.6613; val_optim_loss: 4598387.6613
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9830; val_auprc_score: 0.9920; val_best_acc_score: 0.9677; val_best_f1_score: 0.9790; train_kl_reg_loss: 13151.7877; train_edge_recon_loss: 1305144.5515; train_cat_covariates_contrastive_loss: 631246.3616; train_gene_expr_recon_loss: 2625849.2079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4575391.9211; train_optim_loss: 4575391.9211; val_kl_reg_loss: 13296.1056; val_edge_recon_loss: 1311089.5040; val_cat_covariates_contrastive_loss: 630535.2903; val_gene_expr_recon_loss: 2638466.5323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4593387.4839; val_optim_loss: 4593387.4839
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9833; val_auprc_score: 0.9924; val_best_acc_score: 0.9681; val_best_f1_score: 0.9793; train_kl_reg_loss: 13187.5362; train_edge_recon_loss: 1306744.7814; train_cat_covariates_contrastive_loss: 631068.3103; train_gene_expr_recon_loss: 2624988.1774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4575988.7921; train_optim_loss: 4575988.7921; val_kl_reg_loss: 12991.6048; val_edge_recon_loss: 1303402.9435; val_cat_covariates_contrastive_loss: 631110.0847; val_gene_expr_recon_loss: 2636478.4032; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4583982.9677; val_optim_loss: 4583982.9677

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9835; val_auprc_score: 0.9924; val_best_acc_score: 0.9689; val_best_f1_score: 0.9798; train_kl_reg_loss: 13152.6246; train_edge_recon_loss: 1303428.4879; train_cat_covariates_contrastive_loss: 631172.9429; train_gene_expr_recon_loss: 2616723.2706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4564477.3118; train_optim_loss: 4564477.3118; val_kl_reg_loss: 12884.4797; val_edge_recon_loss: 1302620.2984; val_cat_covariates_contrastive_loss: 631264.7560; val_gene_expr_recon_loss: 2630904.6855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4577674.2097; val_optim_loss: 4577674.2097
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9851; val_auprc_score: 0.9931; val_best_acc_score: 0.9694; val_best_f1_score: 0.9801; train_kl_reg_loss: 13115.4724; train_edge_recon_loss: 1305661.9086; train_cat_covariates_contrastive_loss: 631307.4823; train_gene_expr_recon_loss: 2617059.8262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4567144.6900; train_optim_loss: 4567144.6900; val_kl_reg_loss: 13019.6507; val_edge_recon_loss: 1304888.0927; val_cat_covariates_contrastive_loss: 631255.9899; val_gene_expr_recon_loss: 2629935.9113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4579099.6452; val_optim_loss: 4579099.6452
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9838; val_auprc_score: 0.9926; val_best_acc_score: 0.9693; val_best_f1_score: 0.9801; train_kl_reg_loss: 13131.9408; train_edge_recon_loss: 1304655.8925; train_cat_covariates_contrastive_loss: 631273.6351; train_gene_expr_recon_loss: 2615278.8154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4564340.2634; train_optim_loss: 4564340.2634; val_kl_reg_loss: 12959.2786; val_edge_recon_loss: 1303042.6613; val_cat_covariates_contrastive_loss: 631187.0786; val_gene_expr_recon_loss: 2626581.2984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4573770.3387; val_optim_loss: 4573770.3387
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9834; val_auprc_score: 0.9924; val_best_acc_score: 0.9687; val_best_f1_score: 0.9797; train_kl_reg_loss: 13141.7913; train_edge_recon_loss: 1302178.8163; train_cat_covariates_contrastive_loss: 631320.6564; train_gene_expr_recon_loss: 2614357.3513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4560998.6093; train_optim_loss: 4560998.6093; val_kl_reg_loss: 12904.4099; val_edge_recon_loss: 1306420.1129; val_cat_covariates_contrastive_loss: 631066.3246; val_gene_expr_recon_loss: 2629511.1532; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4579901.9677; val_optim_loss: 4579901.9677
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9845; val_auprc_score: 0.9929; val_best_acc_score: 0.9700; val_best_f1_score: 0.9805; train_kl_reg_loss: 13162.2472; train_edge_recon_loss: 1304865.4091; train_cat_covariates_contrastive_loss: 631365.3698; train_gene_expr_recon_loss: 2614504.1604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4563897.1918; train_optim_loss: 4563897.1918; val_kl_reg_loss: 13059.2373; val_edge_recon_loss: 1301939.8024; val_cat_covariates_contrastive_loss: 631164.0081; val_gene_expr_recon_loss: 2629311.8065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4575474.8226; val_optim_loss: 4575474.8226
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9839; val_auprc_score: 0.9925; val_best_acc_score: 0.9697; val_best_f1_score: 0.9803; train_kl_reg_loss: 13154.7451; train_edge_recon_loss: 1304071.5668; train_cat_covariates_contrastive_loss: 631418.6324; train_gene_expr_recon_loss: 2613379.1066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4562024.0627; train_optim_loss: 4562024.0627; val_kl_reg_loss: 13149.5341; val_edge_recon_loss: 1303283.8105; val_cat_covariates_contrastive_loss: 630963.5887; val_gene_expr_recon_loss: 2627197.4113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4574594.3226; val_optim_loss: 4574594.3226
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9841; val_auprc_score: 0.9926; val_best_acc_score: 0.9699; val_best_f1_score: 0.9804; train_kl_reg_loss: 13199.0886; train_edge_recon_loss: 1301588.1214; train_cat_covariates_contrastive_loss: 631280.1871; train_gene_expr_recon_loss: 2613930.3871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4559997.7796; train_optim_loss: 4559997.7796; val_kl_reg_loss: 13075.6509; val_edge_recon_loss: 1304737.3629; val_cat_covariates_contrastive_loss: 631025.6250; val_gene_expr_recon_loss: 2625858.2419; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4574696.9194; val_optim_loss: 4574696.9194

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9833; val_auprc_score: 0.9920; val_best_acc_score: 0.9695; val_best_f1_score: 0.9802; train_kl_reg_loss: 13148.0252; train_edge_recon_loss: 1303907.8763; train_cat_covariates_contrastive_loss: 631209.3094; train_gene_expr_recon_loss: 2612828.5484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4561093.7527; train_optim_loss: 4561093.7527; val_kl_reg_loss: 13036.5949; val_edge_recon_loss: 1309531.2097; val_cat_covariates_contrastive_loss: 630790.1048; val_gene_expr_recon_loss: 2629792.0726; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4583150.0161; val_optim_loss: 4583150.0161
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9834; val_auprc_score: 0.9923; val_best_acc_score: 0.9694; val_best_f1_score: 0.9801; train_kl_reg_loss: 13132.2867; train_edge_recon_loss: 1301827.4485; train_cat_covariates_contrastive_loss: 631242.2448; train_gene_expr_recon_loss: 2612154.9489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4558356.9283; train_optim_loss: 4558356.9283; val_kl_reg_loss: 12991.0678; val_edge_recon_loss: 1308423.3266; val_cat_covariates_contrastive_loss: 631125.1976; val_gene_expr_recon_loss: 2630454.7984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4582994.3548; val_optim_loss: 4582994.3548
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9843; val_auprc_score: 0.9928; val_best_acc_score: 0.9695; val_best_f1_score: 0.9802; train_kl_reg_loss: 13137.1618; train_edge_recon_loss: 1304916.7513; train_cat_covariates_contrastive_loss: 631292.9449; train_gene_expr_recon_loss: 2613382.5618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4562729.4068; train_optim_loss: 4562729.4068; val_kl_reg_loss: 12988.6964; val_edge_recon_loss: 1308758.4395; val_cat_covariates_contrastive_loss: 631429.4698; val_gene_expr_recon_loss: 2629965.6129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4583142.2097; val_optim_loss: 4583142.2097
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9835; val_auprc_score: 0.9923; val_best_acc_score: 0.9694; val_best_f1_score: 0.9801; train_kl_reg_loss: 13124.3959; train_edge_recon_loss: 1301595.1613; train_cat_covariates_contrastive_loss: 631248.4435; train_gene_expr_recon_loss: 2611862.8961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4557830.8961; train_optim_loss: 4557830.8961; val_kl_reg_loss: 13011.1981; val_edge_recon_loss: 1317570.2137; val_cat_covariates_contrastive_loss: 631019.5121; val_gene_expr_recon_loss: 2628420.7339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4590021.6452; val_optim_loss: 4590021.6452

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 356 min 32 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
val AUROC score: 0.9464
val AUPRC score: 0.9687
val best accuracy score: 0.9569
val best F1 score: 0.9717
val target rna MSE score: 1.1644
val source rna MSE score: 0.1062
Val cat covariate0 mean sim diff: -0.0003
Val cat covariate1 mean sim diff: -0.0880
Duration of model training in run 8: 5 hours, 58 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
