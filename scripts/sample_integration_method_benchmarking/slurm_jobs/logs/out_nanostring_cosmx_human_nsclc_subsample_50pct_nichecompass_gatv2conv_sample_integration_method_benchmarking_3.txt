Run timestamp: 23082023_214330_3.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '12', '--edge_batch_size_list', '256', '--node_batch_size_list', 'None', '--seeds', '5', '--run_index', '6', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc_subsample_50pct', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 127072
Number of validation nodes: 14119
Number of training edges: 863288
Number of validation edges: 95920
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9575; val_auprc_score: 0.9815; val_best_acc_score: 0.9293; val_best_f1_score: 0.9541; train_kl_reg_loss: 13839.0893; train_edge_recon_loss: 1366756.3941; train_gene_expr_recon_loss: 2882749.0571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4263344.5389; train_optim_loss: 4263344.5389; val_kl_reg_loss: 12949.6399; val_edge_recon_loss: 1340594.2933; val_gene_expr_recon_loss: 2583319.6640; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3936863.5980; val_optim_loss: 3936863.5980
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9672; val_auprc_score: 0.9855; val_best_acc_score: 0.9434; val_best_f1_score: 0.9630; train_kl_reg_loss: 15824.6293; train_edge_recon_loss: 1328405.8000; train_gene_expr_recon_loss: 2429917.9954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3774148.4277; train_optim_loss: 3774148.4277; val_kl_reg_loss: 18162.5920; val_edge_recon_loss: 1332765.3187; val_gene_expr_recon_loss: 2318042.6247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3668970.5440; val_optim_loss: 3668970.5440
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9697; val_auprc_score: 0.9870; val_best_acc_score: 0.9424; val_best_f1_score: 0.9624; train_kl_reg_loss: 19418.7385; train_edge_recon_loss: 1324135.8079; train_gene_expr_recon_loss: 2278248.2808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3621802.8286; train_optim_loss: 3621802.8286; val_kl_reg_loss: 20966.3805; val_edge_recon_loss: 1341247.7913; val_gene_expr_recon_loss: 2245192.1393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3607406.3113; val_optim_loss: 3607406.3113
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9736; val_auprc_score: 0.9889; val_best_acc_score: 0.9454; val_best_f1_score: 0.9641; train_kl_reg_loss: 21709.4573; train_edge_recon_loss: 1324829.0531; train_gene_expr_recon_loss: 2215817.0500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3562355.5587; train_optim_loss: 3562355.5587; val_kl_reg_loss: 22391.0369; val_edge_recon_loss: 1331461.2670; val_gene_expr_recon_loss: 2202761.3380; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3556613.6473; val_optim_loss: 3556613.6473
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9743; val_auprc_score: 0.9891; val_best_acc_score: 0.9467; val_best_f1_score: 0.9650; train_kl_reg_loss: 23249.4470; train_edge_recon_loss: 1325640.3917; train_gene_expr_recon_loss: 2184955.6396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3533845.4807; train_optim_loss: 3533845.4807; val_kl_reg_loss: 23924.2587; val_edge_recon_loss: 1343213.7228; val_gene_expr_recon_loss: 2179363.2093; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3546501.1907; val_optim_loss: 3546501.1907
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9757; val_auprc_score: 0.9898; val_best_acc_score: 0.9486; val_best_f1_score: 0.9663; train_kl_reg_loss: 24552.1594; train_edge_recon_loss: 1323179.4784; train_gene_expr_recon_loss: 2167078.2315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3514809.8698; train_optim_loss: 3514809.8698; val_kl_reg_loss: 25763.6489; val_edge_recon_loss: 1336416.7025; val_gene_expr_recon_loss: 2157513.2197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3519693.5760; val_optim_loss: 3519693.5760
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9775; val_auprc_score: 0.9904; val_best_acc_score: 0.9506; val_best_f1_score: 0.9675; train_kl_reg_loss: 25379.2425; train_edge_recon_loss: 1326629.6167; train_gene_expr_recon_loss: 2149497.2371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3501506.0960; train_optim_loss: 3501506.0960; val_kl_reg_loss: 26268.0487; val_edge_recon_loss: 1337262.3212; val_gene_expr_recon_loss: 2169540.0747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3533070.4427; val_optim_loss: 3533070.4427
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9789; val_auprc_score: 0.9911; val_best_acc_score: 0.9504; val_best_f1_score: 0.9674; train_kl_reg_loss: 26295.3028; train_edge_recon_loss: 1323394.7218; train_gene_expr_recon_loss: 2139831.0809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3489521.1072; train_optim_loss: 3489521.1072; val_kl_reg_loss: 26690.7588; val_edge_recon_loss: 1340181.0703; val_gene_expr_recon_loss: 2138501.0823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3505372.9113; val_optim_loss: 3505372.9113
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9769; val_auprc_score: 0.9897; val_best_acc_score: 0.9526; val_best_f1_score: 0.9689; train_kl_reg_loss: 27418.4243; train_edge_recon_loss: 1325427.3373; train_gene_expr_recon_loss: 2137574.8775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3490420.6371; train_optim_loss: 3490420.6371; val_kl_reg_loss: 28620.4846; val_edge_recon_loss: 1338059.0733; val_gene_expr_recon_loss: 2135274.4497; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3501954.0067; val_optim_loss: 3501954.0067
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9791; val_auprc_score: 0.9912; val_best_acc_score: 0.9527; val_best_f1_score: 0.9689; train_kl_reg_loss: 28174.7302; train_edge_recon_loss: 1327843.6934; train_gene_expr_recon_loss: 2126552.2056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3482570.6289; train_optim_loss: 3482570.6289; val_kl_reg_loss: 28601.5266; val_edge_recon_loss: 1342015.1968; val_gene_expr_recon_loss: 2132406.0077; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3503022.7380; val_optim_loss: 3503022.7380
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9795; val_auprc_score: 0.9916; val_best_acc_score: 0.9495; val_best_f1_score: 0.9669; train_kl_reg_loss: 28785.1928; train_edge_recon_loss: 1323042.7786; train_gene_expr_recon_loss: 2118200.2957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3470028.2693; train_optim_loss: 3470028.2693; val_kl_reg_loss: 28990.8488; val_edge_recon_loss: 1334044.9603; val_gene_expr_recon_loss: 2123818.7290; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3486854.5293; val_optim_loss: 3486854.5293
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9814; val_auprc_score: 0.9922; val_best_acc_score: 0.9537; val_best_f1_score: 0.9695; train_kl_reg_loss: 29812.0127; train_edge_recon_loss: 1327495.6173; train_gene_expr_recon_loss: 2121438.9739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3478746.6043; train_optim_loss: 3478746.6043; val_kl_reg_loss: 31062.9731; val_edge_recon_loss: 1334088.6010; val_gene_expr_recon_loss: 2128875.3137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3494026.8793; val_optim_loss: 3494026.8793
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9376; val_auprc_score: 0.9731; val_best_acc_score: 0.9097; val_best_f1_score: 0.9414; train_kl_reg_loss: 34955.6942; train_edge_recon_loss: 1342131.1267; train_gene_expr_recon_loss: 2308737.2542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3685824.0754; train_optim_loss: 3685824.0754; val_kl_reg_loss: 25472.0581; val_edge_recon_loss: 1386139.6637; val_gene_expr_recon_loss: 2982301.2167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4393912.9480; val_optim_loss: 4393912.9480
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9812; val_auprc_score: 0.9921; val_best_acc_score: 0.9551; val_best_f1_score: 0.9704; train_kl_reg_loss: 30249.5692; train_edge_recon_loss: 1325126.8696; train_gene_expr_recon_loss: 2257259.4687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3612635.9085; train_optim_loss: 3612635.9085; val_kl_reg_loss: 33472.9378; val_edge_recon_loss: 1334638.9243; val_gene_expr_recon_loss: 2150516.4243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3518628.2833; val_optim_loss: 3518628.2833
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9808; val_auprc_score: 0.9919; val_best_acc_score: 0.9558; val_best_f1_score: 0.9709; train_kl_reg_loss: 45403.2208; train_edge_recon_loss: 1332925.1383; train_gene_expr_recon_loss: 2182806.2372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3561134.5970; train_optim_loss: 3561134.5970; val_kl_reg_loss: 36690.0253; val_edge_recon_loss: 1332418.8433; val_gene_expr_recon_loss: 2173295.4133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3542404.2827; val_optim_loss: 3542404.2827

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9826; val_auprc_score: 0.9927; val_best_acc_score: 0.9572; val_best_f1_score: 0.9719; train_kl_reg_loss: 34832.3630; train_edge_recon_loss: 1324391.0687; train_gene_expr_recon_loss: 2097800.6432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3457024.0756; train_optim_loss: 3457024.0756; val_kl_reg_loss: 34606.0345; val_edge_recon_loss: 1338387.7653; val_gene_expr_recon_loss: 2100300.9473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3473294.7493; val_optim_loss: 3473294.7493
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9842; val_auprc_score: 0.9935; val_best_acc_score: 0.9580; val_best_f1_score: 0.9722; train_kl_reg_loss: 34204.9177; train_edge_recon_loss: 1321564.1377; train_gene_expr_recon_loss: 2067458.0245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3423227.0798; train_optim_loss: 3423227.0798; val_kl_reg_loss: 34032.2217; val_edge_recon_loss: 1338237.1195; val_gene_expr_recon_loss: 2081570.2530; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3453839.5973; val_optim_loss: 3453839.5973
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9838; val_auprc_score: 0.9933; val_best_acc_score: 0.9592; val_best_f1_score: 0.9732; train_kl_reg_loss: 33728.6852; train_edge_recon_loss: 1321604.9577; train_gene_expr_recon_loss: 2054717.4500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3410051.0931; train_optim_loss: 3410051.0931; val_kl_reg_loss: 33493.7806; val_edge_recon_loss: 1326439.0607; val_gene_expr_recon_loss: 2075301.5277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3435234.3740; val_optim_loss: 3435234.3740
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9844; val_auprc_score: 0.9935; val_best_acc_score: 0.9598; val_best_f1_score: 0.9735; train_kl_reg_loss: 33191.7643; train_edge_recon_loss: 1323077.3689; train_gene_expr_recon_loss: 2045374.4752; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3401643.6054; train_optim_loss: 3401643.6054; val_kl_reg_loss: 32990.5408; val_edge_recon_loss: 1331662.8470; val_gene_expr_recon_loss: 2064515.6973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3429169.0880; val_optim_loss: 3429169.0880
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9845; val_auprc_score: 0.9934; val_best_acc_score: 0.9599; val_best_f1_score: 0.9735; train_kl_reg_loss: 32446.9686; train_edge_recon_loss: 1322903.1139; train_gene_expr_recon_loss: 2037898.4174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3393248.5027; train_optim_loss: 3393248.5027; val_kl_reg_loss: 32167.1646; val_edge_recon_loss: 1339897.1013; val_gene_expr_recon_loss: 2062963.6527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3435027.9133; val_optim_loss: 3435027.9133
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9841; val_auprc_score: 0.9935; val_best_acc_score: 0.9583; val_best_f1_score: 0.9726; train_kl_reg_loss: 31972.9830; train_edge_recon_loss: 1320873.4070; train_gene_expr_recon_loss: 2033303.6714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3386150.0617; train_optim_loss: 3386150.0617; val_kl_reg_loss: 31669.4432; val_edge_recon_loss: 1335799.2720; val_gene_expr_recon_loss: 2060377.9390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3427846.6540; val_optim_loss: 3427846.6540
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9849; val_auprc_score: 0.9938; val_best_acc_score: 0.9593; val_best_f1_score: 0.9731; train_kl_reg_loss: 31354.9955; train_edge_recon_loss: 1320780.1265; train_gene_expr_recon_loss: 2030324.8987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3382460.0193; train_optim_loss: 3382460.0193; val_kl_reg_loss: 31194.9983; val_edge_recon_loss: 1332148.0670; val_gene_expr_recon_loss: 2053301.1770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3416644.2447; val_optim_loss: 3416644.2447
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9847; val_auprc_score: 0.9937; val_best_acc_score: 0.9591; val_best_f1_score: 0.9730; train_kl_reg_loss: 30866.3689; train_edge_recon_loss: 1320485.8433; train_gene_expr_recon_loss: 2027743.7743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3379095.9871; train_optim_loss: 3379095.9871; val_kl_reg_loss: 30736.2131; val_edge_recon_loss: 1334943.7007; val_gene_expr_recon_loss: 2054641.0933; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3420321.0087; val_optim_loss: 3420321.0087
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9852; val_auprc_score: 0.9939; val_best_acc_score: 0.9595; val_best_f1_score: 0.9733; train_kl_reg_loss: 30642.6614; train_edge_recon_loss: 1319553.4466; train_gene_expr_recon_loss: 2024432.9258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3374629.0346; train_optim_loss: 3374629.0346; val_kl_reg_loss: 30374.9901; val_edge_recon_loss: 1334989.3490; val_gene_expr_recon_loss: 2050858.6237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3416222.9700; val_optim_loss: 3416222.9700
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9857; val_auprc_score: 0.9941; val_best_acc_score: 0.9613; val_best_f1_score: 0.9745; train_kl_reg_loss: 1210404071785.8296; train_edge_recon_loss: 1319410.0899; train_gene_expr_recon_loss: 2023880.0603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1210407414009.7588; train_optim_loss: 1210407414009.7588; val_kl_reg_loss: 29941.2384; val_edge_recon_loss: 1323395.5543; val_gene_expr_recon_loss: 2053715.7140; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3407052.5087; val_optim_loss: 3407052.5087
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9851; val_auprc_score: 0.9939; val_best_acc_score: 0.9602; val_best_f1_score: 0.9739; train_kl_reg_loss: 29733.9423; train_edge_recon_loss: 1319527.3288; train_gene_expr_recon_loss: 2022721.5902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3371982.8635; train_optim_loss: 3371982.8635; val_kl_reg_loss: 29536.0429; val_edge_recon_loss: 1326936.8902; val_gene_expr_recon_loss: 2050049.0987; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3406522.0400; val_optim_loss: 3406522.0400
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9852; val_auprc_score: 0.9938; val_best_acc_score: 0.9600; val_best_f1_score: 0.9737; train_kl_reg_loss: 29580.4050; train_edge_recon_loss: 1319575.4107; train_gene_expr_recon_loss: 2020937.4830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3370093.2964; train_optim_loss: 3370093.2964; val_kl_reg_loss: 29663.8238; val_edge_recon_loss: 1328830.0303; val_gene_expr_recon_loss: 2049762.4847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3408256.3353; val_optim_loss: 3408256.3353
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9853; val_auprc_score: 0.9939; val_best_acc_score: 0.9602; val_best_f1_score: 0.9737; train_kl_reg_loss: 29419.5215; train_edge_recon_loss: 1318695.3490; train_gene_expr_recon_loss: 2019192.5169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3367307.3895; train_optim_loss: 3367307.3895; val_kl_reg_loss: 29396.4626; val_edge_recon_loss: 1336381.2780; val_gene_expr_recon_loss: 2049215.6237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3414993.3687; val_optim_loss: 3414993.3687
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9859; val_auprc_score: 0.9943; val_best_acc_score: 0.9602; val_best_f1_score: 0.9738; train_kl_reg_loss: 29235.6209; train_edge_recon_loss: 1317663.2677; train_gene_expr_recon_loss: 2018232.1867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3365131.0747; train_optim_loss: 3365131.0747; val_kl_reg_loss: 29039.1943; val_edge_recon_loss: 1325061.7537; val_gene_expr_recon_loss: 2050611.7817; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3404712.7253; val_optim_loss: 3404712.7253
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9857; val_auprc_score: 0.9941; val_best_acc_score: 0.9608; val_best_f1_score: 0.9741; train_kl_reg_loss: 29048.9587; train_edge_recon_loss: 1319883.3617; train_gene_expr_recon_loss: 2017598.1226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3366530.4428; train_optim_loss: 3366530.4428; val_kl_reg_loss: 29097.4000; val_edge_recon_loss: 1325335.7592; val_gene_expr_recon_loss: 2051849.0037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3406282.1527; val_optim_loss: 3406282.1527
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9857; val_auprc_score: 0.9942; val_best_acc_score: 0.9608; val_best_f1_score: 0.9741; train_kl_reg_loss: 28971.4675; train_edge_recon_loss: 1315037.9266; train_gene_expr_recon_loss: 2015872.6828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3359882.0769; train_optim_loss: 3359882.0769; val_kl_reg_loss: 29201.0736; val_edge_recon_loss: 1328020.8693; val_gene_expr_recon_loss: 2047985.8040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3405207.7507; val_optim_loss: 3405207.7507
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9849; val_auprc_score: 0.9937; val_best_acc_score: 0.9606; val_best_f1_score: 0.9741; train_kl_reg_loss: 28978.8900; train_edge_recon_loss: 1317616.2186; train_gene_expr_recon_loss: 2015144.8631; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3361739.9704; train_optim_loss: 3361739.9704; val_kl_reg_loss: 29035.2032; val_edge_recon_loss: 1325144.0862; val_gene_expr_recon_loss: 2048821.4857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3403000.7733; val_optim_loss: 3403000.7733
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9862; val_auprc_score: 0.9943; val_best_acc_score: 0.9617; val_best_f1_score: 0.9747; train_kl_reg_loss: 28753.3394; train_edge_recon_loss: 1320413.3005; train_gene_expr_recon_loss: 2014537.0578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3363703.6971; train_optim_loss: 3363703.6971; val_kl_reg_loss: 28717.3694; val_edge_recon_loss: 1323904.1160; val_gene_expr_recon_loss: 2048447.8487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3401069.3333; val_optim_loss: 3401069.3333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9856; val_auprc_score: 0.9940; val_best_acc_score: 0.9609; val_best_f1_score: 0.9743; train_kl_reg_loss: 28620.4829; train_edge_recon_loss: 1322269.6610; train_gene_expr_recon_loss: 2014425.4240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3365315.5683; train_optim_loss: 3365315.5683; val_kl_reg_loss: 28692.0093; val_edge_recon_loss: 1320750.5053; val_gene_expr_recon_loss: 2046475.1523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3395917.6767; val_optim_loss: 3395917.6767
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9863; val_auprc_score: 0.9944; val_best_acc_score: 0.9610; val_best_f1_score: 0.9742; train_kl_reg_loss: 28459.9852; train_edge_recon_loss: 1315503.1177; train_gene_expr_recon_loss: 2013140.7241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3357103.8272; train_optim_loss: 3357103.8272; val_kl_reg_loss: 28859.3144; val_edge_recon_loss: 1332898.4820; val_gene_expr_recon_loss: 2045688.1660; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3407445.9573; val_optim_loss: 3407445.9573
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9862; val_auprc_score: 0.9943; val_best_acc_score: 0.9625; val_best_f1_score: 0.9752; train_kl_reg_loss: 28511.4608; train_edge_recon_loss: 1319440.3506; train_gene_expr_recon_loss: 2012726.8718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3360678.6822; train_optim_loss: 3360678.6822; val_kl_reg_loss: 28497.4928; val_edge_recon_loss: 1330406.6657; val_gene_expr_recon_loss: 2043528.9113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3402433.0733; val_optim_loss: 3402433.0733
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9861; val_auprc_score: 0.9943; val_best_acc_score: 0.9612; val_best_f1_score: 0.9744; train_kl_reg_loss: 28342.0791; train_edge_recon_loss: 1314429.7791; train_gene_expr_recon_loss: 2010766.5256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3353538.3847; train_optim_loss: 3353538.3847; val_kl_reg_loss: 28573.2705; val_edge_recon_loss: 1328594.0150; val_gene_expr_recon_loss: 2043535.3187; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3400702.6053; val_optim_loss: 3400702.6053
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9859; val_auprc_score: 0.9942; val_best_acc_score: 0.9610; val_best_f1_score: 0.9742; train_kl_reg_loss: 28199.7916; train_edge_recon_loss: 1315005.2590; train_gene_expr_recon_loss: 2010260.8893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3353465.9387; train_optim_loss: 3353465.9387; val_kl_reg_loss: 28406.4685; val_edge_recon_loss: 1333637.0307; val_gene_expr_recon_loss: 2045894.3917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3407937.8900; val_optim_loss: 3407937.8900

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9865; val_auprc_score: 0.9944; val_best_acc_score: 0.9622; val_best_f1_score: 0.9750; train_kl_reg_loss: 28061.6284; train_edge_recon_loss: 1317120.2345; train_gene_expr_recon_loss: 2004547.7663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3349729.6275; train_optim_loss: 3349729.6275; val_kl_reg_loss: 28014.9254; val_edge_recon_loss: 1330827.4117; val_gene_expr_recon_loss: 2039183.5493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3398025.8787; val_optim_loss: 3398025.8787
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9869; val_auprc_score: 0.9945; val_best_acc_score: 0.9624; val_best_f1_score: 0.9751; train_kl_reg_loss: 27928.0813; train_edge_recon_loss: 1315038.8452; train_gene_expr_recon_loss: 2003568.0241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3346534.9501; train_optim_loss: 3346534.9501; val_kl_reg_loss: 27958.8846; val_edge_recon_loss: 1327221.1717; val_gene_expr_recon_loss: 2042718.9197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3397898.9747; val_optim_loss: 3397898.9747
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9863; val_auprc_score: 0.9943; val_best_acc_score: 0.9629; val_best_f1_score: 0.9755; train_kl_reg_loss: 27823.8178; train_edge_recon_loss: 1319637.7151; train_gene_expr_recon_loss: 2003598.8122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3351060.3461; train_optim_loss: 3351060.3461; val_kl_reg_loss: 27850.7783; val_edge_recon_loss: 1324894.8097; val_gene_expr_recon_loss: 2037995.2823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3390740.8607; val_optim_loss: 3390740.8607
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9869; val_auprc_score: 0.9946; val_best_acc_score: 0.9625; val_best_f1_score: 0.9752; train_kl_reg_loss: 27733.0299; train_edge_recon_loss: 1317908.8083; train_gene_expr_recon_loss: 2002715.1609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3348357.0026; train_optim_loss: 3348357.0026; val_kl_reg_loss: 27782.0924; val_edge_recon_loss: 1328094.3140; val_gene_expr_recon_loss: 2038520.2300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3394396.6427; val_optim_loss: 3394396.6427
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9870; val_auprc_score: 0.9947; val_best_acc_score: 0.9622; val_best_f1_score: 0.9750; train_kl_reg_loss: 27685.1481; train_edge_recon_loss: 1316478.9369; train_gene_expr_recon_loss: 2002622.4827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3346786.5683; train_optim_loss: 3346786.5683; val_kl_reg_loss: 27650.8692; val_edge_recon_loss: 1336826.9473; val_gene_expr_recon_loss: 2037835.7417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3402313.5600; val_optim_loss: 3402313.5600
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9870; val_auprc_score: 0.9948; val_best_acc_score: 0.9626; val_best_f1_score: 0.9753; train_kl_reg_loss: 27522.8052; train_edge_recon_loss: 1315565.4356; train_gene_expr_recon_loss: 2001798.7733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3344887.0132; train_optim_loss: 3344887.0132; val_kl_reg_loss: 27535.7167; val_edge_recon_loss: 1322540.7690; val_gene_expr_recon_loss: 2036974.7417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3387051.2307; val_optim_loss: 3387051.2307
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9869; val_auprc_score: 0.9946; val_best_acc_score: 0.9627; val_best_f1_score: 0.9754; train_kl_reg_loss: 27479.7145; train_edge_recon_loss: 1315905.8663; train_gene_expr_recon_loss: 2002013.8331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3345399.4145; train_optim_loss: 3345399.4145; val_kl_reg_loss: 27522.9031; val_edge_recon_loss: 1324137.0143; val_gene_expr_recon_loss: 2040437.7167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3392097.6367; val_optim_loss: 3392097.6367
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9867; val_auprc_score: 0.9944; val_best_acc_score: 0.9620; val_best_f1_score: 0.9749; train_kl_reg_loss: 27270.5132; train_edge_recon_loss: 1318700.0027; train_gene_expr_recon_loss: 2001912.6408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3347883.1549; train_optim_loss: 3347883.1549; val_kl_reg_loss: 27228.4535; val_edge_recon_loss: 1334170.4177; val_gene_expr_recon_loss: 2038079.2350; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3399478.1047; val_optim_loss: 3399478.1047
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9868; val_auprc_score: 0.9946; val_best_acc_score: 0.9625; val_best_f1_score: 0.9753; train_kl_reg_loss: 27138.6193; train_edge_recon_loss: 1317327.8975; train_gene_expr_recon_loss: 2001891.9098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3346358.4277; train_optim_loss: 3346358.4277; val_kl_reg_loss: 27164.7356; val_edge_recon_loss: 1328290.7013; val_gene_expr_recon_loss: 2039089.3927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3394544.8280; val_optim_loss: 3394544.8280
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9867; val_auprc_score: 0.9946; val_best_acc_score: 0.9623; val_best_f1_score: 0.9751; train_kl_reg_loss: 27036.5000; train_edge_recon_loss: 1316563.8501; train_gene_expr_recon_loss: 2000402.5871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3344002.9372; train_optim_loss: 3344002.9372; val_kl_reg_loss: 26980.7389; val_edge_recon_loss: 1327325.3907; val_gene_expr_recon_loss: 2039300.6723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3393606.7947; val_optim_loss: 3393606.7947

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9873; val_auprc_score: 0.9949; val_best_acc_score: 0.9625; val_best_f1_score: 0.9752; train_kl_reg_loss: 26955.4412; train_edge_recon_loss: 1315158.9977; train_gene_expr_recon_loss: 2001091.9648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3343206.4065; train_optim_loss: 3343206.4065; val_kl_reg_loss: 27004.6219; val_edge_recon_loss: 1328982.5107; val_gene_expr_recon_loss: 2039878.1043; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3395865.2373; val_optim_loss: 3395865.2373
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9867; val_auprc_score: 0.9945; val_best_acc_score: 0.9626; val_best_f1_score: 0.9753; train_kl_reg_loss: 26964.5417; train_edge_recon_loss: 1317709.0789; train_gene_expr_recon_loss: 2000594.0961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3345267.7151; train_optim_loss: 3345267.7151; val_kl_reg_loss: 27011.1505; val_edge_recon_loss: 1332246.3728; val_gene_expr_recon_loss: 2039363.7273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3398621.2453; val_optim_loss: 3398621.2453
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9868; val_auprc_score: 0.9945; val_best_acc_score: 0.9632; val_best_f1_score: 0.9758; train_kl_reg_loss: 26936.6530; train_edge_recon_loss: 1317681.1108; train_gene_expr_recon_loss: 2000771.4461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3345389.2106; train_optim_loss: 3345389.2106; val_kl_reg_loss: 26982.3659; val_edge_recon_loss: 1316628.2643; val_gene_expr_recon_loss: 2037325.9473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3380936.5753; val_optim_loss: 3380936.5753
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9870; val_auprc_score: 0.9946; val_best_acc_score: 0.9630; val_best_f1_score: 0.9756; train_kl_reg_loss: 26923.8360; train_edge_recon_loss: 1316550.3937; train_gene_expr_recon_loss: 1999766.2844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3343240.5135; train_optim_loss: 3343240.5135; val_kl_reg_loss: 26974.2845; val_edge_recon_loss: 1323001.3272; val_gene_expr_recon_loss: 2037955.9533; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3387931.5667; val_optim_loss: 3387931.5667
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9863; val_auprc_score: 0.9943; val_best_acc_score: 0.9616; val_best_f1_score: 0.9747; train_kl_reg_loss: 26915.5618; train_edge_recon_loss: 1317068.6740; train_gene_expr_recon_loss: 2000805.3885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3344789.6259; train_optim_loss: 3344789.6259; val_kl_reg_loss: 26961.2257; val_edge_recon_loss: 1325313.2590; val_gene_expr_recon_loss: 2038491.5563; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3390766.0473; val_optim_loss: 3390766.0473
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9867; val_auprc_score: 0.9945; val_best_acc_score: 0.9625; val_best_f1_score: 0.9753; train_kl_reg_loss: 26926.1143; train_edge_recon_loss: 1317116.7774; train_gene_expr_recon_loss: 2000594.4550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3344637.3461; train_optim_loss: 3344637.3461; val_kl_reg_loss: 26981.0749; val_edge_recon_loss: 1325530.7400; val_gene_expr_recon_loss: 2038009.9423; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3390521.7567; val_optim_loss: 3390521.7567
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9868; val_auprc_score: 0.9945; val_best_acc_score: 0.9626; val_best_f1_score: 0.9753; train_kl_reg_loss: 26915.3026; train_edge_recon_loss: 1315598.1856; train_gene_expr_recon_loss: 1999601.4732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3342114.9626; train_optim_loss: 3342114.9626; val_kl_reg_loss: 27006.7800; val_edge_recon_loss: 1325470.2027; val_gene_expr_recon_loss: 2040013.6757; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3392490.6620; val_optim_loss: 3392490.6620

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9867; val_auprc_score: 0.9944; val_best_acc_score: 0.9621; val_best_f1_score: 0.9750; train_kl_reg_loss: 26940.7917; train_edge_recon_loss: 1318763.8513; train_gene_expr_recon_loss: 1999976.2142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3345680.8557; train_optim_loss: 3345680.8557; val_kl_reg_loss: 26980.4928; val_edge_recon_loss: 1323364.3913; val_gene_expr_recon_loss: 2033952.8767; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3384297.7573; val_optim_loss: 3384297.7573
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9868; val_auprc_score: 0.9948; val_best_acc_score: 0.9620; val_best_f1_score: 0.9749; train_kl_reg_loss: 26932.8047; train_edge_recon_loss: 1314625.5470; train_gene_expr_recon_loss: 2001051.6975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3342610.0492; train_optim_loss: 3342610.0492; val_kl_reg_loss: 26964.0829; val_edge_recon_loss: 1326836.4367; val_gene_expr_recon_loss: 2038669.9477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3392470.4613; val_optim_loss: 3392470.4613
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9863; val_auprc_score: 0.9941; val_best_acc_score: 0.9619; val_best_f1_score: 0.9748; train_kl_reg_loss: 26932.4316; train_edge_recon_loss: 1317058.7899; train_gene_expr_recon_loss: 1999997.8934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3343989.1148; train_optim_loss: 3343989.1148; val_kl_reg_loss: 26974.8360; val_edge_recon_loss: 1336391.3990; val_gene_expr_recon_loss: 2035339.7747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3398706.0153; val_optim_loss: 3398706.0153
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9867; val_auprc_score: 0.9946; val_best_acc_score: 0.9622; val_best_f1_score: 0.9751; train_kl_reg_loss: 26923.4797; train_edge_recon_loss: 1312970.0915; train_gene_expr_recon_loss: 1999704.2408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3339597.8107; train_optim_loss: 3339597.8107; val_kl_reg_loss: 27000.8344; val_edge_recon_loss: 1321550.3648; val_gene_expr_recon_loss: 2038022.8467; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3386574.0400; val_optim_loss: 3386574.0400

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1623 min 33 sec.
Using best model state, which was in epoch 51.

--- MODEL EVALUATION ---
val AUROC score: 0.9866
val AUPRC score: 0.9944
val best accuracy score: 0.9627
val best F1 score: 0.9755
val target rna MSE score: 0.9837
val source rna MSE score: 0.0797
Val cat covariate0 mean sim diff: -0.0004
Val cat covariate1 mean sim diff: -0.0742
Duration of model training in run 6: 27 hours, 10 minutes and 23 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
